WARNING:tensorflow:From main.py:92: The name tf.reset_default_graph is deprecated. Please use tf.compat.v1.reset_default_graph instead.

WARNING From main.py:92: The name tf.reset_default_graph is deprecated. Please use tf.compat.v1.reset_default_graph instead.

WARNING:tensorflow:From main.py:93: The name tf.Session is deprecated. Please use tf.compat.v1.Session instead.

WARNING From main.py:93: The name tf.Session is deprecated. Please use tf.compat.v1.Session instead.

2019-12-17 23:45:16.616030: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcuda.so.1
2019-12-17 23:45:16.633659: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1618] Found device 0 with properties: 
name: Tesla P100-PCIE-16GB major: 6 minor: 0 memoryClockRate(GHz): 1.3285
pciBusID: 0000:83:00.0
2019-12-17 23:45:16.634263: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcudart.so.10.0
2019-12-17 23:45:16.636400: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcublas.so.10.0
2019-12-17 23:45:16.638437: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcufft.so.10.0
2019-12-17 23:45:16.639033: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcurand.so.10.0
2019-12-17 23:45:16.641394: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcusolver.so.10.0
2019-12-17 23:45:16.643371: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcusparse.so.10.0
2019-12-17 23:45:16.648479: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcudnn.so.7
2019-12-17 23:45:16.650437: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1746] Adding visible gpu devices: 0
2019-12-17 23:45:16.650863: I tensorflow/core/platform/cpu_feature_guard.cc:142] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX AVX2 FMA
2019-12-17 23:45:16.657262: I tensorflow/core/platform/profile_utils/cpu_utils.cc:94] CPU Frequency: 2399805000 Hz
2019-12-17 23:45:16.657462: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x5625a7bfb390 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2019-12-17 23:45:16.657480: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2019-12-17 23:45:16.658539: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1618] Found device 0 with properties: 
name: Tesla P100-PCIE-16GB major: 6 minor: 0 memoryClockRate(GHz): 1.3285
pciBusID: 0000:83:00.0
2019-12-17 23:45:16.658562: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcudart.so.10.0
2019-12-17 23:45:16.658573: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcublas.so.10.0
2019-12-17 23:45:16.658583: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcufft.so.10.0
2019-12-17 23:45:16.658592: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcurand.so.10.0
2019-12-17 23:45:16.658602: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcusolver.so.10.0
2019-12-17 23:45:16.658611: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcusparse.so.10.0
2019-12-17 23:45:16.658621: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcudnn.so.7
2019-12-17 23:45:16.660538: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1746] Adding visible gpu devices: 0
2019-12-17 23:45:16.660568: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcudart.so.10.0
2019-12-17 23:45:16.752119: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1159] Device interconnect StreamExecutor with strength 1 edge matrix:
2019-12-17 23:45:16.752152: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1165]      0 
2019-12-17 23:45:16.752163: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1178] 0:   N 
2019-12-17 23:45:16.755167: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1304] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 15216 MB memory) -> physical GPU (device: 0, name: Tesla P100-PCIE-16GB, pci bus id: 0000:83:00.0, compute capability: 6.0)
2019-12-17 23:45:16.757293: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x5625a82346c0 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2019-12-17 23:45:16.757310: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Tesla P100-PCIE-16GB, Compute Capability 6.0
INFO   Y0_true: -1.0000e+00
WARNING:tensorflow:From /home/dz4/DeepBSDE/solver.py:229: The name tf.placeholder is deprecated. Please use tf.compat.v1.placeholder instead.

WARNING From /home/dz4/DeepBSDE/solver.py:229: The name tf.placeholder is deprecated. Please use tf.compat.v1.placeholder instead.

WARNING:tensorflow:From /home/dz4/DeepBSDE/solver.py:234: The name tf.random_uniform is deprecated. Please use tf.random.uniform instead.

WARNING From /home/dz4/DeepBSDE/solver.py:234: The name tf.random_uniform is deprecated. Please use tf.random.uniform instead.

WARNING:tensorflow:From /home/dz4/DeepBSDE/solver.py:308: The name tf.variable_scope is deprecated. Please use tf.compat.v1.variable_scope instead.

WARNING From /home/dz4/DeepBSDE/solver.py:308: The name tf.variable_scope is deprecated. Please use tf.compat.v1.variable_scope instead.

WARNING:tensorflow:From /home/dz4/DeepBSDE/solver.py:314: calling reduce_sum_v1 (from tensorflow.python.ops.math_ops) with keep_dims is deprecated and will be removed in a future version.
Instructions for updating:
keep_dims is deprecated, use keepdims instead
WARNING From /home/dz4/DeepBSDE/solver.py:314: calling reduce_sum_v1 (from tensorflow.python.ops.math_ops) with keep_dims is deprecated and will be removed in a future version.
Instructions for updating:
keep_dims is deprecated, use keepdims instead
WARNING:tensorflow:From /home/dz4/DeepBSDE/solver.py:484: The name tf.get_variable is deprecated. Please use tf.compat.v1.get_variable instead.

WARNING From /home/dz4/DeepBSDE/solver.py:484: The name tf.get_variable is deprecated. Please use tf.compat.v1.get_variable instead.

WARNING:tensorflow:From /home/dz4/DeepBSDE/solver.py:486: calling RandomNormal.__init__ (from tensorflow.python.ops.init_ops) with dtype is deprecated and will be removed in a future version.
Instructions for updating:
Call initializer instance with the dtype argument instead of passing it to the constructor
WARNING From /home/dz4/DeepBSDE/solver.py:486: calling RandomNormal.__init__ (from tensorflow.python.ops.init_ops) with dtype is deprecated and will be removed in a future version.
Instructions for updating:
Call initializer instance with the dtype argument instead of passing it to the constructor
WARNING:tensorflow:From /home/dz4/DeepBSDE/solver.py:489: calling RandomUniform.__init__ (from tensorflow.python.ops.init_ops) with dtype is deprecated and will be removed in a future version.
Instructions for updating:
Call initializer instance with the dtype argument instead of passing it to the constructor
WARNING From /home/dz4/DeepBSDE/solver.py:489: calling RandomUniform.__init__ (from tensorflow.python.ops.init_ops) with dtype is deprecated and will be removed in a future version.
Instructions for updating:
Call initializer instance with the dtype argument instead of passing it to the constructor
WARNING:tensorflow:From /home/dz4/DeepBSDE/solver.py:491: calling Constant.__init__ (from tensorflow.python.ops.init_ops) with dtype is deprecated and will be removed in a future version.
Instructions for updating:
Call initializer instance with the dtype argument instead of passing it to the constructor
WARNING From /home/dz4/DeepBSDE/solver.py:491: calling Constant.__init__ (from tensorflow.python.ops.init_ops) with dtype is deprecated and will be removed in a future version.
Instructions for updating:
Call initializer instance with the dtype argument instead of passing it to the constructor
WARNING:tensorflow:From /home/dz4/DeepBSDE/solver.py:327: where (from tensorflow.python.ops.array_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.where in 2.0, which has the same broadcast rule as np.where
WARNING From /home/dz4/DeepBSDE/solver.py:327: where (from tensorflow.python.ops.array_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.where in 2.0, which has the same broadcast rule as np.where
WARNING:tensorflow:From /home/dz4/DeepBSDE/solver.py:334: The name tf.train.piecewise_constant is deprecated. Please use tf.compat.v1.train.piecewise_constant instead.

WARNING From /home/dz4/DeepBSDE/solver.py:334: The name tf.train.piecewise_constant is deprecated. Please use tf.compat.v1.train.piecewise_constant instead.

WARNING:tensorflow:From /home/dz4/DeepBSDE/solver.py:337: The name tf.trainable_variables is deprecated. Please use tf.compat.v1.trainable_variables instead.

WARNING From /home/dz4/DeepBSDE/solver.py:337: The name tf.trainable_variables is deprecated. Please use tf.compat.v1.trainable_variables instead.

WARNING:tensorflow:From /home/dz4/DeepBSDE/solver.py:339: The name tf.train.AdamOptimizer is deprecated. Please use tf.compat.v1.train.AdamOptimizer instead.

WARNING From /home/dz4/DeepBSDE/solver.py:339: The name tf.train.AdamOptimizer is deprecated. Please use tf.compat.v1.train.AdamOptimizer instead.

WARNING:tensorflow:From /home/dz4/DeepBSDE/solver.py:192: The name tf.global_variables_initializer is deprecated. Please use tf.compat.v1.global_variables_initializer instead.

WARNING From /home/dz4/DeepBSDE/solver.py:192: The name tf.global_variables_initializer is deprecated. Please use tf.compat.v1.global_variables_initializer instead.

2019-12-17 23:45:34.816836: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcublas.so.10.0
INFO   step:     0,    loss: 1.4738e+02,   Y0: 2.4986e+00,  elapsed time  18
INFO   step:     1,    loss: 1.0510e+02,   Y0: 2.4936e+00,  elapsed time  26
INFO   step:     2,    loss: 1.0509e+02,   Y0: 2.4935e+00,  elapsed time  28
INFO   step:     3,    loss: 1.0507e+02,   Y0: 2.4913e+00,  elapsed time  29
INFO   step:     4,    loss: 1.0506e+02,   Y0: 2.4898e+00,  elapsed time  31
INFO   step:     5,    loss: 1.0504e+02,   Y0: 2.4890e+00,  elapsed time  33
INFO   step:     6,    loss: 1.0503e+02,   Y0: 2.4886e+00,  elapsed time  34
INFO   step:     7,    loss: 1.0502e+02,   Y0: 2.4887e+00,  elapsed time  36
INFO   step:     8,    loss: 1.0501e+02,   Y0: 2.4884e+00,  elapsed time  37
INFO   step:     9,    loss: 1.0500e+02,   Y0: 2.4871e+00,  elapsed time  39
INFO   step:    10,    loss: 1.0500e+02,   Y0: 2.4858e+00,  elapsed time  41
INFO   step:    11,    loss: 1.0499e+02,   Y0: 2.4847e+00,  elapsed time  42
INFO   step:    12,    loss: 1.0498e+02,   Y0: 2.4840e+00,  elapsed time  44
INFO   step:    13,    loss: 1.0497e+02,   Y0: 2.4840e+00,  elapsed time  46
INFO   step:    14,    loss: 1.0496e+02,   Y0: 2.4856e+00,  elapsed time  47
INFO   step:    15,    loss: 1.0495e+02,   Y0: 2.4870e+00,  elapsed time  49
INFO   step:    16,    loss: 1.0494e+02,   Y0: 2.4871e+00,  elapsed time  50
INFO   step:    17,    loss: 1.0492e+02,   Y0: 2.4877e+00,  elapsed time  52
INFO   step:    18,    loss: 1.0491e+02,   Y0: 2.4886e+00,  elapsed time  54
INFO   step:    19,    loss: 1.0490e+02,   Y0: 2.4903e+00,  elapsed time  55
INFO   step:    20,    loss: 1.0489e+02,   Y0: 2.4918e+00,  elapsed time  57
INFO   step:    21,    loss: 1.0487e+02,   Y0: 2.4933e+00,  elapsed time  59
INFO   step:    22,    loss: 1.0486e+02,   Y0: 2.4952e+00,  elapsed time  60
INFO   step:    23,    loss: 1.0485e+02,   Y0: 2.4972e+00,  elapsed time  62
INFO   step:    24,    loss: 1.0484e+02,   Y0: 2.4978e+00,  elapsed time  63
INFO   step:    25,    loss: 1.0483e+02,   Y0: 2.4983e+00,  elapsed time  65
INFO   step:    26,    loss: 1.0482e+02,   Y0: 2.4991e+00,  elapsed time  67
INFO   step:    27,    loss: 1.0481e+02,   Y0: 2.4995e+00,  elapsed time  68
INFO   step:    28,    loss: 1.0480e+02,   Y0: 2.4992e+00,  elapsed time  70
INFO   step:    29,    loss: 1.0479e+02,   Y0: 2.4992e+00,  elapsed time  72
INFO   step:    30,    loss: 1.0479e+02,   Y0: 2.4988e+00,  elapsed time  73
INFO   step:    31,    loss: 1.0478e+02,   Y0: 2.4983e+00,  elapsed time  75
INFO   step:    32,    loss: 1.0477e+02,   Y0: 2.4973e+00,  elapsed time  77
INFO   step:    33,    loss: 1.0476e+02,   Y0: 2.4963e+00,  elapsed time  78
INFO   step:    34,    loss: 1.0475e+02,   Y0: 2.4960e+00,  elapsed time  80
INFO   step:    35,    loss: 1.0474e+02,   Y0: 2.4955e+00,  elapsed time  81
INFO   step:    36,    loss: 1.0473e+02,   Y0: 2.4962e+00,  elapsed time  83
INFO   step:    37,    loss: 1.0472e+02,   Y0: 2.4967e+00,  elapsed time  85
INFO   step:    38,    loss: 1.0471e+02,   Y0: 2.4975e+00,  elapsed time  86
INFO   step:    39,    loss: 1.0470e+02,   Y0: 2.4980e+00,  elapsed time  88
INFO   step:    40,    loss: 1.0469e+02,   Y0: 2.4988e+00,  elapsed time  90
INFO   step:    41,    loss: 1.0468e+02,   Y0: 2.5003e+00,  elapsed time  91
INFO   step:    42,    loss: 1.0467e+02,   Y0: 2.5009e+00,  elapsed time  93
INFO   step:    43,    loss: 1.0466e+02,   Y0: 2.5018e+00,  elapsed time  94
INFO   step:    44,    loss: 1.0464e+02,   Y0: 2.5016e+00,  elapsed time  96
INFO   step:    45,    loss: 1.0463e+02,   Y0: 2.5009e+00,  elapsed time  98
INFO   step:    46,    loss: 1.0462e+02,   Y0: 2.5006e+00,  elapsed time  99
INFO   step:    47,    loss: 1.0460e+02,   Y0: 2.5011e+00,  elapsed time 101
INFO   step:    48,    loss: 1.0459e+02,   Y0: 2.5009e+00,  elapsed time 103
INFO   step:    49,    loss: 1.0457e+02,   Y0: 2.5007e+00,  elapsed time 104
INFO   step:    50,    loss: 1.0456e+02,   Y0: 2.5006e+00,  elapsed time 106
INFO   step:    51,    loss: 1.0455e+02,   Y0: 2.5016e+00,  elapsed time 108
INFO   step:    52,    loss: 1.0454e+02,   Y0: 2.5027e+00,  elapsed time 109
INFO   step:    53,    loss: 1.0453e+02,   Y0: 2.5039e+00,  elapsed time 111
INFO   step:    54,    loss: 1.0452e+02,   Y0: 2.5046e+00,  elapsed time 112
INFO   step:    55,    loss: 1.0450e+02,   Y0: 2.5050e+00,  elapsed time 114
INFO   step:    56,    loss: 1.0449e+02,   Y0: 2.5052e+00,  elapsed time 116
INFO   step:    57,    loss: 1.0448e+02,   Y0: 2.5054e+00,  elapsed time 117
INFO   step:    58,    loss: 1.0446e+02,   Y0: 2.5059e+00,  elapsed time 119
INFO   step:    59,    loss: 1.0445e+02,   Y0: 2.5065e+00,  elapsed time 121
INFO   step:    60,    loss: 1.0443e+02,   Y0: 2.5065e+00,  elapsed time 122
INFO   step:    61,    loss: 1.0442e+02,   Y0: 2.5063e+00,  elapsed time 124
INFO   step:    62,    loss: 1.0441e+02,   Y0: 2.5056e+00,  elapsed time 125
INFO   step:    63,    loss: 1.0439e+02,   Y0: 2.5054e+00,  elapsed time 127
INFO   step:    64,    loss: 1.0438e+02,   Y0: 2.5047e+00,  elapsed time 129
INFO   step:    65,    loss: 1.0437e+02,   Y0: 2.5043e+00,  elapsed time 130
INFO   step:    66,    loss: 1.0436e+02,   Y0: 2.5040e+00,  elapsed time 132
INFO   step:    67,    loss: 1.0435e+02,   Y0: 2.5036e+00,  elapsed time 134
INFO   step:    68,    loss: 1.0434e+02,   Y0: 2.5035e+00,  elapsed time 135
INFO   step:    69,    loss: 1.0433e+02,   Y0: 2.5038e+00,  elapsed time 137
INFO   step:    70,    loss: 1.0433e+02,   Y0: 2.5039e+00,  elapsed time 139
INFO   step:    71,    loss: 1.0432e+02,   Y0: 2.5037e+00,  elapsed time 140
INFO   step:    72,    loss: 1.0431e+02,   Y0: 2.5036e+00,  elapsed time 142
INFO   step:    73,    loss: 1.0430e+02,   Y0: 2.5031e+00,  elapsed time 143
INFO   step:    74,    loss: 1.0428e+02,   Y0: 2.5021e+00,  elapsed time 145
INFO   step:    75,    loss: 1.0427e+02,   Y0: 2.5008e+00,  elapsed time 147
INFO   step:    76,    loss: 1.0426e+02,   Y0: 2.4996e+00,  elapsed time 148
INFO   step:    77,    loss: 1.0425e+02,   Y0: 2.4987e+00,  elapsed time 150
INFO   step:    78,    loss: 1.0423e+02,   Y0: 2.4979e+00,  elapsed time 152
INFO   step:    79,    loss: 1.0422e+02,   Y0: 2.4969e+00,  elapsed time 153
INFO   step:    80,    loss: 1.0421e+02,   Y0: 2.4965e+00,  elapsed time 155
INFO   step:    81,    loss: 1.0419e+02,   Y0: 2.4961e+00,  elapsed time 156
INFO   step:    82,    loss: 1.0418e+02,   Y0: 2.4951e+00,  elapsed time 158
INFO   step:    83,    loss: 1.0417e+02,   Y0: 2.4936e+00,  elapsed time 160
INFO   step:    84,    loss: 1.0415e+02,   Y0: 2.4929e+00,  elapsed time 161
INFO   step:    85,    loss: 1.0414e+02,   Y0: 2.4924e+00,  elapsed time 163
INFO   step:    86,    loss: 1.0413e+02,   Y0: 2.4924e+00,  elapsed time 165
INFO   step:    87,    loss: 1.0412e+02,   Y0: 2.4926e+00,  elapsed time 166
INFO   step:    88,    loss: 1.0412e+02,   Y0: 2.4922e+00,  elapsed time 168
INFO   step:    89,    loss: 1.0411e+02,   Y0: 2.4913e+00,  elapsed time 169
INFO   step:    90,    loss: 1.0409e+02,   Y0: 2.4893e+00,  elapsed time 171
INFO   step:    91,    loss: 1.0408e+02,   Y0: 2.4879e+00,  elapsed time 173
INFO   step:    92,    loss: 1.0407e+02,   Y0: 2.4873e+00,  elapsed time 174
INFO   step:    93,    loss: 1.0406e+02,   Y0: 2.4864e+00,  elapsed time 176
INFO   step:    94,    loss: 1.0405e+02,   Y0: 2.4861e+00,  elapsed time 178
INFO   step:    95,    loss: 1.0404e+02,   Y0: 2.4867e+00,  elapsed time 179
INFO   step:    96,    loss: 1.0402e+02,   Y0: 2.4867e+00,  elapsed time 181
INFO   step:    97,    loss: 1.0401e+02,   Y0: 2.4870e+00,  elapsed time 182
INFO   step:    98,    loss: 1.0400e+02,   Y0: 2.4882e+00,  elapsed time 184
INFO   step:    99,    loss: 1.0399e+02,   Y0: 2.4901e+00,  elapsed time 186
INFO   step:   100,    loss: 1.0397e+02,   Y0: 2.4924e+00,  elapsed time 187
INFO   step:   101,    loss: 1.0396e+02,   Y0: 2.4938e+00,  elapsed time 189
INFO   step:   102,    loss: 1.0395e+02,   Y0: 2.4958e+00,  elapsed time 191
INFO   step:   103,    loss: 1.0394e+02,   Y0: 2.4973e+00,  elapsed time 192
INFO   step:   104,    loss: 1.0392e+02,   Y0: 2.4982e+00,  elapsed time 194
INFO   step:   105,    loss: 1.0391e+02,   Y0: 2.4991e+00,  elapsed time 195
INFO   step:   106,    loss: 1.0390e+02,   Y0: 2.4996e+00,  elapsed time 197
INFO   step:   107,    loss: 1.0389e+02,   Y0: 2.5000e+00,  elapsed time 199
INFO   step:   108,    loss: 1.0388e+02,   Y0: 2.4999e+00,  elapsed time 200
INFO   step:   109,    loss: 1.0386e+02,   Y0: 2.4999e+00,  elapsed time 202
INFO   step:   110,    loss: 1.0385e+02,   Y0: 2.4992e+00,  elapsed time 204
INFO   step:   111,    loss: 1.0384e+02,   Y0: 2.4984e+00,  elapsed time 205
INFO   step:   112,    loss: 1.0383e+02,   Y0: 2.4979e+00,  elapsed time 207
INFO   step:   113,    loss: 1.0382e+02,   Y0: 2.4976e+00,  elapsed time 208
INFO   step:   114,    loss: 1.0381e+02,   Y0: 2.4971e+00,  elapsed time 210
INFO   step:   115,    loss: 1.0380e+02,   Y0: 2.4966e+00,  elapsed time 212
INFO   step:   116,    loss: 1.0378e+02,   Y0: 2.4957e+00,  elapsed time 213
INFO   step:   117,    loss: 1.0377e+02,   Y0: 2.4943e+00,  elapsed time 215
INFO   step:   118,    loss: 1.0376e+02,   Y0: 2.4938e+00,  elapsed time 217
INFO   step:   119,    loss: 1.0375e+02,   Y0: 2.4939e+00,  elapsed time 218
INFO   step:   120,    loss: 1.0373e+02,   Y0: 2.4943e+00,  elapsed time 220
INFO   step:   121,    loss: 1.0372e+02,   Y0: 2.4948e+00,  elapsed time 221
INFO   step:   122,    loss: 1.0371e+02,   Y0: 2.4944e+00,  elapsed time 223
INFO   step:   123,    loss: 1.0370e+02,   Y0: 2.4945e+00,  elapsed time 225
INFO   step:   124,    loss: 1.0369e+02,   Y0: 2.4945e+00,  elapsed time 226
INFO   step:   125,    loss: 1.0368e+02,   Y0: 2.4946e+00,  elapsed time 228
INFO   step:   126,    loss: 1.0367e+02,   Y0: 2.4949e+00,  elapsed time 230
INFO   step:   127,    loss: 1.0366e+02,   Y0: 2.4950e+00,  elapsed time 231
INFO   step:   128,    loss: 1.0365e+02,   Y0: 2.4948e+00,  elapsed time 233
INFO   step:   129,    loss: 1.0364e+02,   Y0: 2.4937e+00,  elapsed time 234
INFO   step:   130,    loss: 1.0362e+02,   Y0: 2.4931e+00,  elapsed time 236
INFO   step:   131,    loss: 1.0361e+02,   Y0: 2.4923e+00,  elapsed time 238
INFO   step:   132,    loss: 1.0360e+02,   Y0: 2.4920e+00,  elapsed time 239
INFO   step:   133,    loss: 1.0359e+02,   Y0: 2.4910e+00,  elapsed time 241
INFO   step:   134,    loss: 1.0357e+02,   Y0: 2.4894e+00,  elapsed time 243
INFO   step:   135,    loss: 1.0356e+02,   Y0: 2.4880e+00,  elapsed time 244
INFO   step:   136,    loss: 1.0355e+02,   Y0: 2.4863e+00,  elapsed time 246
INFO   step:   137,    loss: 1.0353e+02,   Y0: 2.4845e+00,  elapsed time 247
INFO   step:   138,    loss: 1.0352e+02,   Y0: 2.4833e+00,  elapsed time 249
INFO   step:   139,    loss: 1.0350e+02,   Y0: 2.4822e+00,  elapsed time 251
INFO   step:   140,    loss: 1.0349e+02,   Y0: 2.4808e+00,  elapsed time 252
INFO   step:   141,    loss: 1.0348e+02,   Y0: 2.4803e+00,  elapsed time 254
INFO   step:   142,    loss: 1.0347e+02,   Y0: 2.4810e+00,  elapsed time 256
INFO   step:   143,    loss: 1.0345e+02,   Y0: 2.4818e+00,  elapsed time 257
INFO   step:   144,    loss: 1.0344e+02,   Y0: 2.4837e+00,  elapsed time 259
INFO   step:   145,    loss: 1.0343e+02,   Y0: 2.4857e+00,  elapsed time 260
INFO   step:   146,    loss: 1.0342e+02,   Y0: 2.4875e+00,  elapsed time 262
INFO   step:   147,    loss: 1.0340e+02,   Y0: 2.4892e+00,  elapsed time 264
INFO   step:   148,    loss: 1.0339e+02,   Y0: 2.4905e+00,  elapsed time 265
INFO   step:   149,    loss: 1.0338e+02,   Y0: 2.4914e+00,  elapsed time 267
Delta:  120 ,  120.05
Other1:  -30.05 ,  -30
Other2:  -30.05 ,  -30
all_one_vec:  Tensor("ones:0", shape=(?, 1), dtype=float64)
y:  Tensor("mul:0", shape=(?, 1), dtype=float64)
z output:  [<tf.Tensor 'MatMul:0' shape=(?, 3) dtype=float64>, <tf.Tensor 'MatMul_1:0' shape=(?, 3) dtype=float64>, <tf.Tensor 'MatMul_2:0' shape=(?, 3) dtype=float64>, <tf.Tensor 'MatMul_3:0' shape=(?, 3) dtype=float64>, <tf.Tensor 'MatMul_4:0' shape=(?, 3) dtype=float64>, <tf.Tensor 'MatMul_5:0' shape=(?, 3) dtype=float64>, <tf.Tensor 'MatMul_6:0' shape=(?, 3) dtype=float64>, <tf.Tensor 'MatMul_7:0' shape=(?, 3) dtype=float64>, <tf.Tensor 'MatMul_8:0' shape=(?, 3) dtype=float64>, <tf.Tensor 'MatMul_9:0' shape=(?, 3) dtype=float64>, <tf.Tensor 'MatMul_10:0' shape=(?, 3) dtype=float64>, <tf.Tensor 'MatMul_11:0' shape=(?, 3) dtype=float64>, <tf.Tensor 'MatMul_12:0' shape=(?, 3) dtype=float64>, <tf.Tensor 'MatMul_13:0' shape=(?, 3) dtype=float64>, <tf.Tensor 'MatMul_14:0' shape=(?, 3) dtype=float64>, <tf.Tensor 'MatMul_15:0' shape=(?, 3) dtype=float64>, <tf.Tensor 'MatMul_16:0' shape=(?, 3) dtype=float64>, <tf.Tensor 'MatMul_17:0' shape=(?, 3) dtype=float64>, <tf.Tensor 'MatMul_18:0' shape=(?, 3) dtype=float64>, <tf.Tensor 'MatMul_19:0' shape=(?, 3) dtype=float64>]
num_iterations:  150
total time intervals:  20
# of dimensions:  3
Loss out:  108.05959668816267
Output_Z_Vals:  [[[ 1.19251512e+02 -2.92846752e+01 -2.92776944e+01]
  [ 1.19251512e+02 -2.92846752e+01 -2.92776944e+01]
  [ 1.19251512e+02 -2.92846752e+01 -2.92776944e+01]
  ...
  [ 1.19251512e+02 -2.92846752e+01 -2.92776944e+01]
  [ 1.19251512e+02 -2.92846752e+01 -2.92776944e+01]
  [ 1.19251512e+02 -2.92846752e+01 -2.92776944e+01]]

 [[-2.65962619e-01  7.98580800e-02  1.40986736e-01]
  [-4.41791480e-01  1.61342437e-01  4.72141047e-01]
  [-6.11512501e-02 -1.54440605e-02 -8.39301801e-02]
  ...
  [ 1.58050266e-02 -1.53562794e-02 -8.28177081e-03]
  [-1.28910151e-01  9.26864128e-03 -9.19951053e-02]
  [-5.21979085e-02  5.70273592e-03 -8.17212895e-02]]

 [[-9.03378442e-02  4.24122408e-03  1.94979117e-02]
  [-1.45588851e-01 -1.84677327e-02  6.43582354e-02]
  [-3.02418936e-01 -4.20730530e-02  1.98591709e-01]
  ...
  [-1.44131519e-01  9.12844140e-04  1.31514508e-01]
  [-2.95891829e-01 -4.03004956e-02  1.95825727e-01]
  [-3.75460120e-01 -5.98339831e-02  2.45954427e-01]]

 ...

 [[ 4.16196696e-02 -2.49874608e-02  6.99696018e-02]
  [ 4.54584805e-02 -2.33369957e-02  3.19881434e-02]
  [-2.53565860e-01  3.80289904e-01 -1.05069781e-01]
  ...
  [ 3.00540199e-02 -3.23610597e-03 -2.26792658e-02]
  [-2.10563600e-01  3.29658242e-01 -7.98446208e-02]
  [ 3.41813318e-02 -2.81855128e-02  1.43565026e-01]]

 [[-3.88400224e-01 -9.77583684e-01 -2.51701836e-01]
  [-2.21170299e-01 -6.53545366e-01 -6.01147256e-02]
  [-4.06154842e-01 -1.15497654e+00 -3.22815233e-01]
  ...
  [-2.61116725e-01 -7.21729429e-01 -9.40852387e-02]
  [-2.96980770e-01 -9.54488760e-01 -1.34390345e-01]
  [-4.39011753e-01 -1.10800216e+00 -3.30861265e-01]]

 [[ 1.51250282e-01 -2.71514115e-01 -4.87137980e-01]
  [ 8.31753467e-02 -5.97321649e-02 -1.14505065e-01]
  [ 9.38628714e-02 -6.09204115e-02 -1.23313069e-01]
  ...
  [ 7.49795995e-02 -4.08975401e-02 -9.01634687e-02]
  [ 9.09886644e-02 -4.50087368e-02 -1.05644721e-01]
  [ 1.42333846e-01 -2.91638410e-01 -5.41931275e-01]]]
Z_Vals dimensionality:  (20, 200, 3)
X_test:  [[[ 1.00000000e+02  9.91272717e+01  9.83892688e+01 ...  9.10760710e+01
    8.94759293e+01  8.75653920e+01]
  [-1.00000000e+00 -1.18311485e+00 -1.39136099e+00 ... -3.48848632e-01
   -6.35977539e-01 -4.62171420e-01]
  [-1.00000000e+00 -9.98325695e-01 -9.48218866e-01 ... -9.53978201e-01
   -9.17556196e-01 -9.07158666e-01]]

 [[ 1.00000000e+02  9.79070907e+01  9.80083747e+01 ...  9.82908282e+01
    9.83216827e+01  9.83322498e+01]
  [-1.00000000e+00 -1.17687920e+00 -1.00262226e+00 ... -1.65067523e+00
   -1.60031405e+00 -1.80620574e+00]
  [-1.00000000e+00 -9.96094688e-01 -1.03093289e+00 ... -1.02872558e+00
   -1.00329833e+00 -9.73404063e-01]]

 [[ 1.00000000e+02  1.00239464e+02  1.00489503e+02 ...  1.04003502e+02
    1.04087756e+02  9.89621771e+01]
  [-1.00000000e+00 -1.15044827e+00 -1.17359280e+00 ...  2.40572152e-01
    1.78770686e-01  3.39929567e-01]
  [-1.00000000e+00 -9.87358239e-01 -1.02548458e+00 ... -1.14014618e+00
   -1.11977053e+00 -1.11443290e+00]]

 ...

 [[ 1.00000000e+02  1.00412206e+02  9.98681006e+01 ...  9.86478249e+01
    1.00335840e+02  1.00898327e+02]
  [-1.00000000e+00 -8.81841059e-01 -7.83334782e-01 ... -1.31820400e+00
   -1.50138958e+00 -1.73083497e+00]
  [-1.00000000e+00 -9.86765453e-01 -1.00977269e+00 ... -9.83334108e-01
   -9.80642320e-01 -9.19411721e-01]]

 [[ 1.00000000e+02  9.99667042e+01  1.00445506e+02 ...  1.06707935e+02
    1.06486070e+02  1.07228237e+02]
  [-1.00000000e+00 -1.13564420e+00 -1.23938762e+00 ... -9.88113499e-01
   -1.18858614e+00 -8.12946994e-01]
  [-1.00000000e+00 -9.72494942e-01 -9.91523643e-01 ... -9.17713708e-01
   -9.74564788e-01 -1.00543592e+00]]

 [[ 1.00000000e+02  1.00107301e+02  1.01746355e+02 ...  8.75705118e+01
    8.83726551e+01  9.13799837e+01]
  [-1.00000000e+00 -6.09298345e-01 -4.34568127e-01 ... -1.64712549e-01
   -9.94301407e-02 -4.93698226e-01]
  [-1.00000000e+00 -9.85040795e-01 -1.02208649e+00 ... -1.02931328e+00
   -1.02420294e+00 -1.04595980e+00]]]
X_test type:  <class 'numpy.ndarray'>
first element:  100.0
first element type:  <class 'float'>
---------------------------- TESTING DELTA HEDGING ----------------------------

Test sample:  0
output_Z_Vals[:, i, :]:  [[ 1.19251512e+02 -2.92846752e+01 -2.92776944e+01]
 [-2.65962619e-01  7.98580800e-02  1.40986736e-01]
 [-9.03378442e-02  4.24122408e-03  1.94979117e-02]
 [-1.92360491e-02  3.21633294e-02  4.77835598e-02]
 [-9.07885486e-02 -1.74716966e-01  1.46954483e-01]
 [-2.54701737e-02  1.00125906e-02 -2.45895514e-03]
 [-1.12331838e-01 -7.61563091e-02  7.43699772e-02]
 [-5.75166359e-02  9.39245305e-02 -1.14424162e-01]
 [-2.07020565e-01 -1.25600464e-01  2.69710160e-01]
 [ 3.41807521e-02  2.52464196e-02  5.27269117e-03]
 [-5.93955546e-02  1.29384152e-01  1.53941493e-02]
 [-7.15299685e-02 -9.29783315e-03 -1.16088547e-01]
 [-1.24033270e-02 -2.85390503e-01 -3.09321443e-01]
 [ 7.50769131e-02 -4.23632311e-02  5.62096840e-03]
 [ 1.11348156e-02 -5.79141975e-02 -1.09473076e-01]
 [ 1.83241303e-01  4.96987366e-02 -1.43427636e-01]
 [ 1.32086921e-02 -4.50795251e-02  8.59819221e-02]
 [ 4.16196696e-02 -2.49874608e-02  6.99696018e-02]
 [-3.88400224e-01 -9.77583684e-01 -2.51701836e-01]
 [ 1.51250282e-01 -2.71514115e-01 -4.87137980e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.25151208 -29.28467519 -29.2776944 ]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  8.31409947  -9.26062741 -83.52111278]
init_Out:  [2.49223638]
Stock Position:  8.314099471154409
Bond position:  [-828.91771073]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-4.97096861]
curr_Stock_Price:  99.1272717278204
curr_Factors:  [99.12727173 -1.18311485 -0.99832569]
mat_Sqrt:  [[11.18936815  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02101297  0.02525334  0.40219592]
Stock Position:  -0.021012973389805522
Bond Position:  [-2.88800989]


portfolio before change:  [-4.95618307]
curr_Stock_Price:  98.38926878230174
curr_Factors:  [98.38926878 -1.39136099 -0.94821887]
mat_Sqrt:  [[ 9.48158873  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0090964   0.00134119  0.05562211]
Stock Position:  -0.009096401898828217
Bond Position:  [-4.06119474]


portfolio before change:  [-4.96019502]
curr_Stock_Price:  98.71868686929112
curr_Factors:  [98.71868687 -1.39666578 -0.91359467]
mat_Sqrt:  [[ 9.7963886   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00088316  0.01017094  0.1363132 ]
Stock Position:  -0.0008831639453423209
Bond Position:  [-4.87301023]


portfolio before change:  [-4.96156297]
curr_Stock_Price:  98.88802413687111
curr_Factors:  [98.88802414 -1.16323614 -0.89014409]
mat_Sqrt:  [[12.6873814   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00514706 -0.05525036  0.41922024]
Stock Position:  -0.005147063920389142
Bond Position:  [-4.45257999]


portfolio before change:  [-4.95608364]
curr_Stock_Price:  97.60717319091745
curr_Factors:  [97.60717319 -1.3753495  -0.8886137 ]
mat_Sqrt:  [[10.14506911  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00253459  0.00316626 -0.00701471]
Stock Position:  -0.002534589126075855
Bond Position:  [-4.70868956]


portfolio before change:  [-4.95748425]
curr_Stock_Price:  97.69527344432203
curr_Factors:  [97.69527344 -1.37914838 -0.90135144]
mat_Sqrt:  [[ 9.98769019  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00992396 -0.02408274  0.21215684]
Stock Position:  -0.009923963951753262
Bond Position:  [-3.98795988]


portfolio before change:  [-4.96871898]
curr_Stock_Price:  98.72687848617316
curr_Factors:  [98.72687849 -1.35191215 -0.88895533]
mat_Sqrt:  [[10.50120224  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00747041  0.02970154 -0.32642028]
Stock Position:  -0.007470406476827953
Bond Position:  [-4.23118907]


portfolio before change:  [-4.95711842]
curr_Stock_Price:  97.0323943992055
curr_Factors:  [97.0323944  -1.22556627 -0.9055598 ]
mat_Sqrt:  [[11.51808972  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01347526 -0.03971835  0.76940801]
Stock Position:  -0.013475255293216824
Bond Position:  [-3.64958214]


portfolio before change:  [-4.96168368]
curr_Stock_Price:  97.30346499082722
curr_Factors:  [97.30346499 -0.96602343 -0.92522658]
mat_Sqrt:  [[14.68144709  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00244587 0.00798362 0.01504152]
Stock Position:  0.002445868939970402
Bond Position:  [-5.1996752]


portfolio before change:  [-4.96392585]
curr_Stock_Price:  96.91828963810035
curr_Factors:  [96.91828964 -1.0914427  -0.96472531]
mat_Sqrt:  [[12.40004679  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00426713  0.04091486  0.04391522]
Stock Position:  -0.00426712523881125
Bond Position:  [-4.55036337]


portfolio before change:  [-4.96211974]
curr_Stock_Price:  96.22840190136218
curr_Factors:  [96.2284019  -0.87059434 -0.95512138]
mat_Sqrt:  [[15.50261669  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00615809 -0.00294023 -0.33116831]
Stock Position:  -0.006158090271082389
Bond Position:  [-4.36953656]


portfolio before change:  [-4.96067647]
curr_Stock_Price:  95.81661894441505
curr_Factors:  [95.81661894 -0.69161456 -0.9862798 ]
mat_Sqrt:  [[17.8953658   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00463316 -0.0902484  -0.88240798]
Stock Position:  -0.004633157779596085
Bond Position:  [-4.51674296]


portfolio before change:  [-4.95576379]
curr_Stock_Price:  94.51254017118498
curr_Factors:  [94.51254017 -0.68412516 -0.95158471]
mat_Sqrt:  [[18.41236862  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00408044 -0.01339643  0.01603506]
Stock Position:  0.004080435063234455
Bond Position:  [-5.34141608]


portfolio before change:  [-4.96069377]
curr_Stock_Price:  93.63163970403576
curr_Factors:  [93.6316397  -1.1108013  -0.99184004]
mat_Sqrt:  [[11.43555108  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00111115 -0.01831408 -0.31229621]
Stock Position:  -0.001111150706741087
Bond Position:  [-4.85665491]


portfolio before change:  [-4.96168768]
curr_Stock_Price:  93.43328412108849
curr_Factors:  [93.43328412 -0.85678426 -0.95385586]
mat_Sqrt:  [[15.28095867  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01015954  0.01571612 -0.40915912]
Stock Position:  0.010159537687874289
Bond Position:  [-5.91092665]


portfolio before change:  [-4.97258066]
curr_Stock_Price:  92.50656271456734
curr_Factors:  [92.50656271 -0.8214021  -0.92645156]
mat_Sqrt:  [[16.10977012  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00183713 -0.0142554   0.24528249]
Stock Position:  0.0018371292644562519
Bond Position:  [-5.14252717]


portfolio before change:  [-4.9733961]
curr_Stock_Price:  92.76258881481945
curr_Factors:  [92.76258881 -0.76865341 -0.9608495 ]
mat_Sqrt:  [[16.45353768  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00335836 -0.00790173  0.1996038 ]
Stock Position:  0.003358364769197253
Bond Position:  [-5.28492671]


portfolio before change:  [-4.98038144]
curr_Stock_Price:  91.07607103317359
curr_Factors:  [91.07607103 -0.34884863 -0.9539782 ]
mat_Sqrt:  [[24.75105885  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01878787 -0.3091391  -0.71803528]
Stock Position:  -0.018787872929353806
Bond Position:  [-3.26925579]


portfolio before change:  [-4.9511356]
curr_Stock_Price:  89.47592928614868
curr_Factors:  [89.47592929 -0.63597754 -0.9175562 ]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-4.9511356]
Stock Price:  87.56539198273242
PL:  [-4.9511356]
Settle:  Tensor("sub:0", shape=(), dtype=float64)
PL:  Tensor("sub_1:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  1
output_Z_Vals[:, i, :]:  [[ 1.19251512e+02 -2.92846752e+01 -2.92776944e+01]
 [-4.41791480e-01  1.61342437e-01  4.72141047e-01]
 [-1.45588851e-01 -1.84677327e-02  6.43582354e-02]
 [-3.61966938e-02  3.84632154e-02  5.79061195e-02]
 [-8.39830522e-02 -1.17848054e-01  8.92718389e-02]
 [-2.53392631e-02  7.32659117e-03 -4.21585033e-04]
 [-1.37235835e-01 -9.72059339e-02  9.03276697e-02]
 [ 5.59006737e-02 -6.69000291e-02 -1.36784545e-02]
 [-1.03086972e-01 -8.42042242e-02  1.77179126e-01]
 [ 2.51534052e-02  1.15607478e-02  9.51774417e-03]
 [-7.82049635e-02  1.43401322e-01  1.02313412e-02]
 [-4.67852490e-02 -9.07344884e-03 -1.07087075e-01]
 [ 4.85501833e-02  3.60677657e-03 -3.64865555e-02]
 [-5.29500315e-02  2.30847064e-02 -1.53140423e-02]
 [ 1.00741710e-02 -6.35271545e-02 -2.39352569e-02]
 [ 4.25803249e-02 -6.94263457e-03  8.56015588e-02]
 [-2.35647895e-02  1.03259148e-01  6.82888801e-02]
 [ 4.54584805e-02 -2.33369957e-02  3.19881434e-02]
 [-2.21170299e-01 -6.53545366e-01 -6.01147256e-02]
 [ 8.31753467e-02 -5.97321649e-02 -1.14505065e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.25151208 -29.28467519 -29.2776944 ]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  8.31409947  -9.26062741 -83.52111278]
init_Out:  [2.49223638]
Stock Position:  8.314099471154409
Bond position:  [-828.91771073]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-15.1156749]
curr_Stock_Price:  97.9070907189162
curr_Factors:  [97.90709072 -1.1768792  -0.99609469]
mat_Sqrt:  [[11.1456032   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.03061748  0.05102096  1.34688699]
Stock Position:  -0.030617476924603225
Bond Position:  [-12.1180068]


portfolio before change:  [-15.12180583]
curr_Stock_Price:  98.00837465127105
curr_Factors:  [98.00837465 -1.00262226 -1.03093289]
mat_Sqrt:  [[12.82630034  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01036375 -0.00584001  0.18359613]
Stock Position:  -0.010363753599286056
Bond Position:  [-14.10607119]


portfolio before change:  [-15.12252648]
curr_Stock_Price:  97.73759280083254
curr_Factors:  [97.7375928  -0.96382989 -1.02922719]
mat_Sqrt:  [[13.3195007   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00175559  0.01216314  0.16519004]
Stock Position:  -0.0017555868802816028
Bond Position:  [-14.95093964]


portfolio before change:  [-15.12731802]
curr_Stock_Price:  98.33758634422492
curr_Factors:  [98.33758634 -1.15821725 -1.01664956]
mat_Sqrt:  [[11.17343967  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00615776 -0.03726683  0.25466771]
Stock Position:  -0.006157758044852573
Bond Position:  [-14.52177896]


portfolio before change:  [-15.12568091]
curr_Stock_Price:  97.48207943238437
curr_Factors:  [97.48207943 -1.39107912 -1.00252   ]
mat_Sqrt:  [[ 8.90016166  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00283547  0.00231687 -0.00120266]
Stock Position:  -0.002835470638486906
Bond Position:  [-14.84927334]


portfolio before change:  [-15.12847193]
curr_Stock_Price:  97.15699487401108
curr_Factors:  [97.15699487 -1.71632887 -1.01639501]
mat_Sqrt:  [[ 6.31927378  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01919645 -0.03073922  0.2576797 ]
Stock Position:  -0.019196449967733443
Bond Position:  [-13.26340254]


portfolio before change:  [-15.13190594]
curr_Stock_Price:  97.16312879881023
curr_Factors:  [97.1631288  -2.14305452 -0.98821016]
mat_Sqrt:  [[ 4.24238931  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01211139 -0.02115565 -0.03902082]
Stock Position:  0.012111387197036092
Bond Position:  [-16.30868622]


portfolio before change:  [-15.13290879]
curr_Stock_Price:  97.41700820620886
curr_Factors:  [97.41700821 -1.97156207 -0.99491125]
mat_Sqrt:  [[ 5.01547181  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01377629 -0.02662771  0.50544273]
Stock Position:  -0.013776286726134828
Bond Position:  [-13.79086416]


portfolio before change:  [-15.13870694]
curr_Stock_Price:  97.58759153220703
curr_Factors:  [97.58759153 -1.91906257 -1.03519298]
mat_Sqrt:  [[ 5.08601591  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00538628 0.00365583 0.02715147]
Stock Position:  0.00538627961844251
Bond Position:  [-15.664341]


portfolio before change:  [-15.14013514]
curr_Stock_Price:  98.04957562648755
curr_Factors:  [98.04957563 -1.70754309 -1.05329053]
mat_Sqrt:  [[ 6.20055996  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01167861  0.04534748  0.02918717]
Stock Position:  -0.011678605485009047
Bond Position:  [-13.99505283]


portfolio before change:  [-15.14285316]
curr_Stock_Price:  97.9826857688725
curr_Factors:  [97.98268577 -1.86302303 -1.03039208]
mat_Sqrt:  [[ 5.4269413   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01269197 -0.00286928 -0.30548962]
Stock Position:  -0.012691971106795631
Bond Position:  [-13.89925975]


portfolio before change:  [-15.15165476]
curr_Stock_Price:  98.40234860502524
curr_Factors:  [98.40234861 -1.90806777 -1.01675426]
mat_Sqrt:  [[ 5.28167164  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00779971  0.00114056 -0.10408599]
Stock Position:  0.007799712994233864
Bond Position:  [-15.91916484]


portfolio before change:  [-15.15228338]
curr_Stock_Price:  98.83206587041884
curr_Factors:  [98.83206587 -1.82275739 -0.98934963]
mat_Sqrt:  [[ 5.93765985  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00934374  0.00730003 -0.0436867 ]
Stock Position:  -0.009343740479218782
Bond Position:  [-14.2288222]


portfolio before change:  [-15.15890456]
curr_Stock_Price:  99.15993564860003
curr_Factors:  [99.15993565 -1.45573124 -0.97526419]
mat_Sqrt:  [[ 8.72104116  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00040685 -0.02008905 -0.06828063]
Stock Position:  0.0004068485593649175
Bond Position:  [-15.19924764]


portfolio before change:  [-15.16259855]
curr_Stock_Price:  99.42119744339182
curr_Factors:  [99.42119744 -1.91357029 -1.02638212]
mat_Sqrt:  [[ 5.25622421  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01139114 -0.00219545  0.24419742]
Stock Position:  0.011391144940737582
Bond Position:  [-16.29511982]


portfolio before change:  [-15.16813014]
curr_Stock_Price:  99.29326487818804
curr_Factors:  [99.29326488 -1.75871101 -1.0402778 ]
mat_Sqrt:  [[ 6.04413835  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0011514   0.03265341  0.19480917]
Stock Position:  -0.001151403244958261
Bond Position:  [-15.05380355]


portfolio before change:  [-15.17173026]
curr_Stock_Price:  99.15100389894944
curr_Factors:  [99.1510039  -1.69514512 -1.04981701]
mat_Sqrt:  [[ 6.37052482  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00806613 -0.00737981  0.09125327]
Stock Position:  0.008066128878469013
Bond Position:  [-15.97149504]


portfolio before change:  [-15.18266192]
curr_Stock_Price:  98.2908282358452
curr_Factors:  [98.29082824 -1.65067523 -1.02872558]
mat_Sqrt:  [[ 6.74316842  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.03712137 -0.20666919 -0.17149058]
Stock Position:  -0.037121367819501
Bond Position:  [-11.53397193]


portfolio before change:  [-15.18669113]
curr_Stock_Price:  98.32168265875826
curr_Factors:  [98.32168266 -1.60031405 -1.00329833]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-15.18669113]
Stock Price:  98.33224980694335
PL:  [-15.18669113]
Settle:  Tensor("sub_2:0", shape=(), dtype=float64)
PL:  Tensor("sub_3:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  2
output_Z_Vals[:, i, :]:  [[ 1.19251512e+02 -2.92846752e+01 -2.92776944e+01]
 [-6.11512501e-02 -1.54440605e-02 -8.39301801e-02]
 [-3.02418936e-01 -4.20730530e-02  1.98591709e-01]
 [-4.77659010e-02 -4.64130082e-02 -1.72584642e-01]
 [-9.88296441e-02 -2.41910939e-01  2.15109929e-01]
 [-2.03830800e-02 -1.57250622e-01  2.52757048e-02]
 [ 5.54110358e-02  3.68419614e-02 -1.93095146e-02]
 [-1.31371548e-01  2.04728880e-01 -7.62354046e-02]
 [-3.36944124e-02 -4.53139754e-03 -9.38374274e-03]
 [ 4.82119667e-02  3.09622642e-02 -6.31324567e-03]
 [ 1.01450571e-01  2.97815757e-02 -2.28223549e-02]
 [ 2.07622573e-01 -1.37876286e-02 -1.78944295e-01]
 [ 3.69539194e-02 -1.67943216e-02 -3.96615031e-01]
 [-8.45720117e-02  2.97281712e-02 -3.59999752e-02]
 [-1.25851799e-01  7.71158770e-02  2.48615151e-01]
 [-1.10215193e-01 -2.11159787e-01  1.88601889e-01]
 [-4.57618807e-02 -1.15223152e-01  2.66481584e-01]
 [-2.53565860e-01  3.80289904e-01 -1.05069781e-01]
 [-4.06154842e-01 -1.15497654e+00 -3.22815233e-01]
 [ 9.38628714e-02 -6.09204115e-02 -1.23313069e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.25151208 -29.28467519 -29.2776944 ]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  8.31409947  -9.26062741 -83.52111278]
init_Out:  [2.49223638]
Stock Position:  8.314099471154409
Bond position:  [-828.91771073]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [4.27591169]
curr_Stock_Price:  100.23946437612203
curr_Factors:  [100.23946438  -1.15044827  -0.98735824]
mat_Sqrt:  [[11.81955614  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00665695 -0.00488384 -0.23942944]
Stock Position:  -0.006656949665323165
Bond Position:  [4.94320076]


portfolio before change:  [4.27548315]
curr_Stock_Price:  100.48950314665429
curr_Factors:  [100.48950315  -1.1735928   -1.02548458]
mat_Sqrt:  [[11.14483208  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0235955  -0.01330467  0.56652687]
Stock Position:  -0.02359550081201357
Bond Position:  [6.64658331]


portfolio before change:  [4.27513515]
curr_Stock_Price:  100.57468295460356
curr_Factors:  [100.57468295  -1.24533102  -1.03199455]
mat_Sqrt:  [[10.31475095  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00816239 -0.01467708 -0.49233595]
Stock Position:  -0.008162385374151612
Bond Position:  [5.09606447]


portfolio before change:  [4.27366095]
curr_Stock_Price:  100.91139466465299
curr_Factors:  [100.91139466  -1.09266786  -1.06161033]
mat_Sqrt:  [[11.70439783  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00522595 -0.07649896  0.61364875]
Stock Position:  -0.0052259525115102
Bond Position:  [4.80101911]


portfolio before change:  [4.27623846]
curr_Stock_Price:  100.64788186590398
curr_Factors:  [100.64788187  -1.08523527  -1.04605049]
mat_Sqrt:  [[11.94535318  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00161434 -0.04972701  0.07210455]
Stock Position:  -0.0016143425559025535
Bond Position:  [4.43871862]


portfolio before change:  [4.27596121]
curr_Stock_Price:  101.50709721889362
curr_Factors:  [101.50709722  -1.02118741  -1.05068654]
mat_Sqrt:  [[12.78477181  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00410025  0.01165045 -0.05508467]
Stock Position:  0.0041002494053205855
Bond Position:  [3.8597568]


portfolio before change:  [4.27988694]
curr_Stock_Price:  102.22916750615781
curr_Factors:  [102.22916751  -1.02373943  -1.03724684]
mat_Sqrt:  [[13.01666901  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01088197  0.06474096 -0.21747839]
Stock Position:  -0.010881966594736923
Bond Position:  [5.39234133]


portfolio before change:  [4.26574831]
curr_Stock_Price:  103.65233734587676
curr_Factors:  [103.65233735  -0.88582267  -1.03971893]
mat_Sqrt:  [[15.11217614  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00236411 -0.00143295 -0.02676921]
Stock Position:  -0.002364110946293294
Bond Position:  [4.51079393]


portfolio before change:  [4.26866231]
curr_Stock_Price:  102.8968038763192
curr_Factors:  [102.89680388  -0.86724281  -1.02935328]
mat_Sqrt:  [[15.44260876  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00309033  0.00979113 -0.01800993]
Stock Position:  0.003090327791165472
Bond Position:  [3.95067746]


portfolio before change:  [4.26839189]
curr_Stock_Price:  102.48965626689666
curr_Factors:  [102.48965627  -0.50862658  -1.04388378]
mat_Sqrt:  [[21.69868183  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00449617  0.00941776 -0.06510583]
Stock Position:  0.0044961686927716
Bond Position:  [3.8075811]


portfolio before change:  [4.26916577]
curr_Stock_Price:  102.45003876470047
curr_Factors:  [102.45003876  -0.40327904  -1.0589722 ]
mat_Sqrt:  [[23.7391129   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00719234 -0.00436003 -0.51047826]
Stock Position:  0.00719233811472141
Bond Position:  [3.53231045]


portfolio before change:  [4.26319955]
curr_Stock_Price:  101.4977187428306
curr_Factors:  [101.49771874  -0.41821174  -1.07286975]
mat_Sqrt:  [[22.85008499  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00194478 -0.00531083 -1.13143229]
Stock Position:  -0.0019447810497549027
Bond Position:  [4.46059039]


portfolio before change:  [4.26143532]
curr_Stock_Price:  102.97835974497255
curr_Factors:  [102.97835974  -0.46840278  -1.10333514]
mat_Sqrt:  [[21.38695061  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00426208  0.00940087 -0.10269791]
Stock Position:  -0.004262080154288051
Bond Position:  [4.70033734]


portfolio before change:  [4.25572358]
curr_Stock_Price:  104.5942294909462
curr_Factors:  [104.59422949  -0.56138671  -1.10603794]
mat_Sqrt:  [[19.74032955  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0037037   0.02438618  0.70922982]
Stock Position:  -0.0037037031586844857
Bond Position:  [4.64310956]


portfolio before change:  [4.25290535]
curr_Stock_Price:  105.66860176271582
curr_Factors:  [105.66860176  -0.3222584   -1.10540127]
mat_Sqrt:  [[25.34668926  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00304454 -0.06677459  0.53802869]
Stock Position:  -0.0030445442176259565
Bond Position:  [4.57461808]


portfolio before change:  [4.25061696]
curr_Stock_Price:  106.79592405486446
curr_Factors:  [ 1.06795924e+02 -5.44998035e-02 -1.16453576e+00]
mat_Sqrt:  [[31.55980133  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 1.79291238e-04 -3.64367598e-02  7.60197785e-01]
Stock Position:  0.00017929123777099
Bond Position:  [4.23146939]


portfolio before change:  [4.25187153]
curr_Stock_Price:  107.89225834794168
curr_Factors:  [ 1.07892258e+02 -1.10540209e-02 -1.13110701e+00]
mat_Sqrt:  [[34.43150846  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00770208  0.12025823 -0.29973484]
Stock Position:  -0.007702076030157549
Bond Position:  [5.0828659]


portfolio before change:  [4.2830939]
curr_Stock_Price:  104.0035016972729
curr_Factors:  [104.0035017    0.24057215  -1.14014618]
mat_Sqrt:  [[42.30268431  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0118638  -0.36523565 -0.920902  ]
Stock Position:  -0.0118638001280949
Bond Position:  [5.51697066]


portfolio before change:  [4.28347374]
curr_Stock_Price:  104.08775595786543
curr_Factors:  [104.08775596   0.17877069  -1.11977053]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [4.28347374]
Stock Price:  98.96217713708741
PL:  [4.28347374]
Settle:  Tensor("sub_4:0", shape=(), dtype=float64)
PL:  Tensor("sub_5:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  3
output_Z_Vals[:, i, :]:  [[ 1.19251512e+02 -2.92846752e+01 -2.92776944e+01]
 [-1.64622997e-01  2.37019754e-02 -1.06075321e-01]
 [-8.60698420e-02  6.69798859e-03  2.79533869e-02]
 [-5.65082809e-02 -8.37637355e-02 -2.78137904e-01]
 [-9.27349640e-02 -1.90981837e-01  1.63452087e-01]
 [-8.20352587e-02  3.93649172e-02 -1.92506698e-02]
 [ 5.25320714e-02  8.47408476e-02 -3.80938736e-02]
 [-1.55481151e-01  2.23245742e-01 -4.74493205e-02]
 [-1.66721775e-01 -5.47270664e-02  1.01999358e-01]
 [ 2.79647634e-02  3.08891894e-02 -1.02507886e-02]
 [ 1.48842083e-01 -2.31516134e-02 -4.82690058e-02]
 [ 1.99119575e-01 -1.35382692e-02 -1.75272105e-01]
 [ 2.46669824e-02 -2.14626262e-02 -4.03005724e-01]
 [-5.73554293e-02  1.33829293e-02 -2.89873501e-02]
 [-1.42914716e-01  1.01163113e-01  2.73223256e-01]
 [-1.22507168e-01 -2.33207950e-01  1.98856804e-01]
 [-3.25356609e-02 -6.43384377e-02  2.60674817e-01]
 [-1.32632832e-01  2.18649216e-01 -8.74216521e-02]
 [-3.15909706e-01 -9.83916278e-01 -1.35897286e-01]
 [ 6.00632981e-02  3.68598799e-03 -3.57505417e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.25151208 -29.28467519 -29.2776944 ]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  8.31409947  -9.26062741 -83.52111278]
init_Out:  [2.49223638]
Stock Position:  8.314099471154409
Bond position:  [-828.91771073]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-0.09753296]
curr_Stock_Price:  99.71343691279006
curr_Factors:  [99.71343691 -0.88109667 -0.98416523]
mat_Sqrt:  [[15.44118892  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01202392  0.00749522 -0.30260337]
Stock Position:  -0.012023915354122186
Bond Position:  [1.10141296]


portfolio before change:  [-0.08229818]
curr_Stock_Price:  98.46930016864688
curr_Factors:  [98.46930017 -0.67800232 -0.99441866]
mat_Sqrt:  [[18.49173444  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00433658  0.00211809  0.07974323]
Stock Position:  -0.0043365829062884465
Bond Position:  [0.34472211]


portfolio before change:  [-0.09205253]
curr_Stock_Price:  100.73849320230353
curr_Factors:  [100.7384932   -0.5962512   -1.00324864]
mat_Sqrt:  [[20.34892613  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00567331 -0.02648842 -0.79345002]
Stock Position:  -0.005673307395997868
Bond Position:  [0.47946791]


portfolio before change:  [-0.08398666]
curr_Stock_Price:  99.33790053497239
curr_Factors:  [99.33790053 -0.51970733 -0.98089174]
mat_Sqrt:  [[22.15200708  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00290274 -0.06039376  0.46628331]
Stock Position:  -0.0029027426738728163
Bond Position:  [0.20436571]


portfolio before change:  [-0.08344951]
curr_Stock_Price:  99.17045462648194
curr_Factors:  [99.17045463 -0.19763999 -1.00105793]
mat_Sqrt:  [[29.90848457  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00284028  0.01244828 -0.0549168 ]
Stock Position:  -0.00284027721986885
Bond Position:  [0.19822208]


portfolio before change:  [-0.09359982]
curr_Stock_Price:  102.76160927362214
curr_Factors:  [102.76160927  -0.31445031  -0.98852854]
mat_Sqrt:  [[27.92250463  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00168123  0.02679741 -0.10867122]
Stock Position:  0.001681231389220512
Bond Position:  [-0.26636586]


portfolio before change:  [-0.0932815]
curr_Stock_Price:  102.9905570482091
curr_Factors:  [102.99055705  -0.43872098  -1.01088642]
mat_Sqrt:  [[24.1680113   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0065956  0.0705965 -0.1353597]
Stock Position:  -0.0065955994967670075
Bond Position:  [0.58600296]


portfolio before change:  [-0.09750447]
curr_Stock_Price:  103.65304191394365
curr_Factors:  [ 1.03653042e+02 -7.80046917e-02 -1.03101223e+00]
mat_Sqrt:  [[34.19338714  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00430827 -0.01730622  0.29097578]
Stock Position:  -0.004308268431160664
Bond Position:  [0.34906066]


portfolio before change:  [-0.09721691]
curr_Stock_Price:  103.60655313376235
curr_Factors:  [103.60655313  -0.15541643  -1.03033424]
mat_Sqrt:  [[31.65353753  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00084256  0.00976802 -0.02924265]
Stock Position:  0.0008425562336099889
Bond Position:  [-0.18451125]


portfolio before change:  [-0.09713984]
curr_Stock_Price:  103.75277202364705
curr_Factors:  [103.75277202   0.21967475  -1.06962388]
mat_Sqrt:  [[44.34774005  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0031206  -0.00732118 -0.13769804]
Stock Position:  0.0031205973837190324
Bond Position:  [-0.42091047]


portfolio before change:  [-0.10012844]
curr_Stock_Price:  102.82879653784308
curr_Factors:  [ 1.02828797e+02  5.63302699e-02 -1.10664838e+00]
mat_Sqrt:  [[35.9722328   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00453107 -0.00428118 -0.50000253]
Stock Position:  0.004531071249221774
Bond Position:  [-0.56605304]


portfolio before change:  [-0.09945901]
curr_Stock_Price:  103.00777467478254
curr_Factors:  [ 1.03007775e+02  7.42671416e-02 -1.16044080e+00]
mat_Sqrt:  [[34.76568399  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00167264 -0.00678708 -1.14966316]
Stock Position:  -0.001672637283827941
Bond Position:  [0.07283564]


portfolio before change:  [-0.10255215]
curr_Stock_Price:  104.86792472823151
curr_Factors:  [104.86792473  -0.19392799  -1.18246908]
mat_Sqrt:  [[26.47774657  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0023766   0.00423205 -0.08269284]
Stock Position:  -0.002376595813177316
Bond Position:  [0.14667652]


portfolio before change:  [-0.10400893]
curr_Stock_Price:  105.49632234541262
curr_Factors:  [105.49632235  -0.15452774  -1.11722252]
mat_Sqrt:  [[29.57489418  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00285821  0.03199059  0.7794299 ]
Stock Position:  -0.0028582091274488713
Bond Position:  [0.19752162]


portfolio before change:  [-0.10557741]
curr_Stock_Price:  106.06236454487566
curr_Factors:  [106.06236454  -0.44870042  -1.1240847 ]
mat_Sqrt:  [[22.00439373  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00399634 -0.07374683  0.56728311]
Stock Position:  -0.003996342595714244
Bond Position:  [0.31828414]


portfolio before change:  [-0.10412267]
curr_Stock_Price:  105.71826126114682
curr_Factors:  [105.71826126  -0.39753351  -1.13304905]
mat_Sqrt:  [[22.87844238  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00083105 -0.0203456   0.7436327 ]
Stock Position:  0.0008310509825948561
Bond Position:  [-0.19197994]


portfolio before change:  [-0.10434841]
curr_Stock_Price:  105.50439037481033
curr_Factors:  [105.50439037  -1.05989275  -1.15568604]
mat_Sqrt:  [[11.50951145  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0125837   0.06914295 -0.24938964]
Stock Position:  -0.012583696873381534
Bond Position:  [1.22328686]


portfolio before change:  [-0.10887568]
curr_Stock_Price:  105.88846927919408
curr_Factors:  [105.88846928  -1.13241005  -1.16565798]
mat_Sqrt:  [[10.63678555  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.03469603 -0.31114165 -0.38767713]
Stock Position:  -0.03469603018363525
Bond Position:  [3.56503384]


portfolio before change:  [-0.08180499]
curr_Stock_Price:  105.13393568753355
curr_Factors:  [105.13393569  -1.01153245  -1.20932984]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-0.08180499]
Stock Price:  104.54062616721704
PL:  [-4.62243116]
Settle:  Tensor("sub_6:0", shape=(), dtype=float64)
PL:  Tensor("sub_7:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  4
output_Z_Vals[:, i, :]:  [[ 1.19251512e+02 -2.92846752e+01 -2.92776944e+01]
 [-1.65475053e-01  5.49158446e-02  8.19139640e-02]
 [-1.98527296e-01 -1.38593426e-02  1.54565718e-01]
 [-4.25973110e-02  6.74651324e-03 -2.41070266e-02]
 [-9.88296441e-02 -2.41910939e-01  2.15109929e-01]
 [-1.65295120e-01  9.35920586e-02 -9.26345734e-03]
 [-1.10947923e-01 -8.87595104e-02  8.10828383e-02]
 [-1.93902959e-02  3.44333149e-02 -8.82699552e-02]
 [-3.04863980e-01 -1.49608705e-01  3.20561505e-01]
 [ 4.50470017e-02  4.74936917e-02 -1.18045691e-02]
 [ 3.45967553e-02  7.74299463e-02  2.69350769e-03]
 [ 4.04939095e-02 -1.02633766e-02 -1.30204223e-01]
 [ 4.03156123e-02 -1.59288593e-02 -4.15956088e-01]
 [-4.16694037e-03  5.94946678e-03 -5.07321877e-03]
 [ 1.11348156e-02 -5.79141975e-02 -1.09473076e-01]
 [ 1.77432831e-01  4.33138973e-02 -1.19196238e-01]
 [ 1.19347922e-02 -1.33499419e-04  9.52257992e-02]
 [ 4.21524229e-02 -2.47584079e-02  6.46985042e-02]
 [-2.60085178e-01 -6.76963614e-01 -1.23869238e-01]
 [ 1.29934601e-01 -1.56269913e-01 -2.59552600e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.25151208 -29.28467519 -29.2776944 ]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  8.31409947  -9.26062741 -83.52111278]
init_Out:  [2.49223638]
Stock Position:  8.314099471154409
Bond position:  [-828.91771073]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-7.74062395]
curr_Stock_Price:  98.7941442083765
curr_Factors:  [98.79414421 -0.59762558 -0.99841561]
mat_Sqrt:  [[20.02531342  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00735751  0.01736591  0.23367774]
Stock Position:  -0.007357513502991294
Bond Position:  [-7.0137447]


portfolio before change:  [-7.75523454]
curr_Stock_Price:  100.54160115155352
curr_Factors:  [100.54160115  -0.60815803  -0.9430745 ]
mat_Sqrt:  [[21.31346543  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00785112 -0.00438271  0.44093297]
Stock Position:  -0.00785111873619809
Bond Position:  [-6.96587049]


portfolio before change:  [-7.74930465]
curr_Stock_Price:  99.56446890935257
curr_Factors:  [99.56446891 -0.64538327 -0.91931213]
mat_Sqrt:  [[20.82407897  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00227352  0.00213343 -0.06877064]
Stock Position:  -0.0022735191786441766
Bond Position:  [-7.52294292]


portfolio before change:  [-7.75268337]
curr_Stock_Price:  100.22325083938847
curr_Factors:  [100.22325084  -0.50653513  -0.89627226]
mat_Sqrt:  [[24.64546264  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00248186 -0.07649896  0.61364875]
Stock Position:  -0.002481861597020228
Bond Position:  [-7.50394313]


portfolio before change:  [-7.74685386]
curr_Stock_Price:  97.1184327111449
curr_Factors:  [97.11843271 -0.14952846 -0.89637515]
mat_Sqrt:  [[34.12490876  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00482842  0.02959641 -0.02642607]
Stock Position:  -0.004828422534605109
Bond Position:  [-7.27792503]


portfolio before change:  [-7.75303402]
curr_Stock_Price:  98.0215113566676
curr_Factors:  [98.02151136 -0.29629927 -0.89354781]
mat_Sqrt:  [[29.82478837  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00324189 -0.02806822  0.23130677]
Stock Position:  -0.0032418911875714378
Bond Position:  [-7.43525894]


portfolio before change:  [-7.74893539]
curr_Stock_Price:  96.18379499170497
curr_Factors:  [96.18379499 -0.26953676 -0.88451711]
mat_Sqrt:  [[30.33211418  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00120398  0.01088877 -0.25180961]
Stock Position:  -0.001203980059840705
Bond Position:  [-7.63313201]


portfolio before change:  [-7.75254649]
curr_Stock_Price:  97.59792335894534
curr_Factors:  [97.59792336 -0.52128326 -0.88337629]
mat_Sqrt:  [[23.95546937  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01015603 -0.04731043  0.91447275]
Stock Position:  -0.01015603214941708
Bond Position:  [-6.76133884]


portfolio before change:  [-7.77171485]
curr_Stock_Price:  99.31885238319316
curr_Factors:  [99.31885238 -0.32554103 -0.87529336]
mat_Sqrt:  [[29.88931355  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00146754  0.01501882 -0.03367515]
Stock Position:  0.001467537416808355
Bond Position:  [-7.91746898]


portfolio before change:  [-7.7768594]
curr_Stock_Price:  97.16221800705044
curr_Factors:  [97.16221801 -0.27085082 -0.87589099]
mat_Sqrt:  [[30.86553287  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00120347 0.0244855  0.00768383]
Stock Position:  0.001203471782869871
Bond Position:  [-7.89379139]


portfolio before change:  [-7.77904809]
curr_Stock_Price:  96.98357663036919
curr_Factors:  [96.98357663 -0.28650075 -0.91027133]
mat_Sqrt:  [[29.30533456  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00046582 -0.00324556 -0.37143641]
Stock Position:  0.00046582250762162834
Bond Position:  [-7.82422522]


portfolio before change:  [-7.77922123]
curr_Stock_Price:  100.81154285039423
curr_Factors:  [100.81154285  -0.47381133  -0.94293554]
mat_Sqrt:  [[24.44696288  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00184082 -0.00503715 -1.18660694]
Stock Position:  -0.0018408155717531763
Bond Position:  [-7.59364578]


portfolio before change:  [-7.773814]
curr_Stock_Price:  96.84271065344129
curr_Factors:  [96.84271065 -0.46210891 -0.93663525]
mat_Sqrt:  [[23.91112814  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00021115  0.00188139 -0.01447248]
Stock Position:  -0.00021115240614080245
Bond Position:  [-7.75336542]


portfolio before change:  [-7.77538737]
curr_Stock_Price:  95.11310470688781
curr_Factors:  [95.11310471 -1.0072761  -0.95624095]
mat_Sqrt:  [[13.35044488  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00095178 -0.01831408 -0.31229621]
Stock Position:  -0.0009517750741896629
Bond Position:  [-7.68486109]


portfolio before change:  [-7.77700663]
curr_Stock_Price:  94.795599192796
curr_Factors:  [94.79559919 -0.76840075 -0.95444324]
mat_Sqrt:  [[16.92647555  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00911119  0.01369706 -0.34003369]
Stock Position:  0.00911119154025427
Bond Position:  [-8.64070749]


portfolio before change:  [-7.77141673]
curr_Stock_Price:  95.64623998104393
curr_Factors:  [95.64623998 -0.97824751 -0.96358237]
mat_Sqrt:  [[13.7196143   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 2.28645131e-03 -4.22162230e-05  2.71652699e-01]
Stock Position:  0.002286451314158447
Bond Position:  [-7.9901072]


portfolio before change:  [-7.77192433]
curr_Stock_Price:  96.29797926590734
curr_Factors:  [96.29797927 -1.05982943 -1.00010815]
mat_Sqrt:  [[12.27432589  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00445806 -0.0078293   0.18456682]
Stock Position:  0.004458060740767586
Bond Position:  [-8.20122657]


portfolio before change:  [-7.77936143]
curr_Stock_Price:  95.08971102615534
curr_Factors:  [95.08971103 -1.13681191 -1.01757116]
mat_Sqrt:  [[11.02800235  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02746182 -0.21407469 -0.35336446]
Stock Position:  -0.027461819093298798
Bond Position:  [-5.16802499]


portfolio before change:  [-7.76991988]
curr_Stock_Price:  94.69885153403654
curr_Factors:  [94.69885153 -0.96401806 -0.96830102]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-7.76991988]
Stock Price:  94.30488742350941
PL:  [-7.76991988]
Settle:  Tensor("sub_8:0", shape=(), dtype=float64)
PL:  Tensor("sub_9:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  5
output_Z_Vals[:, i, :]:  [[ 1.19251512e+02 -2.92846752e+01 -2.92776944e+01]
 [-1.47221964e-01  1.61480311e-02 -1.30598455e-01]
 [-8.77805581e-02  5.71325931e-03  2.45642326e-02]
 [-3.26152518e-02  3.19837752e-02  4.28851319e-02]
 [-9.88296441e-02 -2.41910939e-01  2.15109929e-01]
 [-5.74912026e-02  3.47415617e-02 -1.25778161e-02]
 [-9.54781711e-02 -6.44403063e-02  6.49662632e-02]
 [-8.94485495e-02  1.48021390e-01 -8.00675302e-02]
 [-2.84039783e-01 -1.31329911e-01  2.78046051e-01]
 [ 1.98146497e-04 -4.95537440e-02  2.80806259e-02]
 [-1.21111886e-02  1.01010800e-01  1.35240875e-02]
 [-7.12547123e-02 -9.32450000e-03 -1.22987419e-01]
 [-7.83548804e-03 -2.65508860e-01 -3.00685021e-01]
 [ 4.17373385e-02 -1.71190952e-02  5.63849195e-03]
 [ 1.11348156e-02 -5.79141975e-02 -1.09473076e-01]
 [ 1.37889933e-01  5.65864603e-03 -9.02432027e-03]
 [-2.70817379e-02  1.00892514e-01  8.38246777e-02]
 [ 8.81080217e-03  2.05395495e-02 -6.75050999e-02]
 [-3.78839608e-01 -1.00401694e+00 -2.33630932e-01]
 [ 9.71971713e-02 -9.19556828e-02 -1.56150272e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.25151208 -29.28467519 -29.2776944 ]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  8.31409947  -9.26062741 -83.52111278]
init_Out:  [2.49223638]
Stock Position:  8.314099471154409
Bond position:  [-828.91771073]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [0.99024945]
curr_Stock_Price:  99.84427277895931
curr_Factors:  [99.84427278 -0.89299218 -0.97691286]
mat_Sqrt:  [[15.3898263   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0112713   0.00510646 -0.37256104]
Stock Position:  -0.011271298221933823
Bond Position:  [2.11562402]


portfolio before change:  [1.00664187]
curr_Stock_Price:  98.43685299405257
curr_Factors:  [98.43685299 -0.6843125  -1.00201787]
mat_Sqrt:  [[18.23029721  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00453196  0.00180669  0.07007492]
Stock Position:  -0.004531955156354748
Bond Position:  [1.45275327]


portfolio before change:  [1.00498909]
curr_Stock_Price:  98.88169515020513
curr_Factors:  [98.88169515 -0.67215803 -1.00041177]
mat_Sqrt:  [[18.56641573  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00124071  0.01011416  0.12233934]
Stock Position:  -0.001240710308577535
Bond Position:  [1.12767263]


portfolio before change:  [1.00316007]
curr_Stock_Price:  100.58312422843757
curr_Factors:  [100.58312423  -0.43465479  -1.04264145]
mat_Sqrt:  [[22.95850044  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00266423 -0.07649896  0.61364875]
Stock Position:  -0.0026642257151320583
Bond Position:  [1.27113621]


portfolio before change:  [1.00819408]
curr_Stock_Price:  98.81293181220694
curr_Factors:  [98.81293181 -0.53942849 -1.03291821]
mat_Sqrt:  [[20.50936856  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00288461  0.01098625 -0.03588101]
Stock Position:  -0.002884614178975484
Bond Position:  [1.29323127]


portfolio before change:  [1.01014578]
curr_Stock_Price:  98.24843675604819
curr_Factors:  [98.24843676 -0.53983375 -1.02228431]
mat_Sqrt:  [[20.6018583   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00407152 -0.02037781  0.18533067]
Stock Position:  -0.0040715176503961555
Bond Position:  [1.41016603]


portfolio before change:  [1.0040208]
curr_Stock_Price:  99.83938325532638
curr_Factors:  [99.83938326 -0.58119771 -1.01546941]
mat_Sqrt:  [[20.22451734  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00504192  0.04680847 -0.22841038]
Stock Position:  -0.00504191857986293
Bond Position:  [1.50740284]


portfolio before change:  [1.01120879]
curr_Stock_Price:  98.48848984397988
curr_Factors:  [98.48848984 -0.58546418 -1.05289897]
mat_Sqrt:  [[19.13609873  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01205443 -0.04153016  0.79318799]
Stock Position:  -0.012054431668183525
Bond Position:  [2.19843156]


portfolio before change:  [1.05328083]
curr_Stock_Price:  95.0439179960141
curr_Factors:  [95.043918   -0.52795881 -1.00675277]
mat_Sqrt:  [[20.48366007  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00022704 -0.01567027  0.08010621]
Stock Position:  0.00022703989756756013
Bond Position:  [1.03170206]


portfolio before change:  [1.05383495]
curr_Stock_Price:  96.34838597207099
curr_Factors:  [96.34838597 -0.73766854 -1.082261  ]
mat_Sqrt:  [[15.61201948  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00043188  0.03194242  0.03858046]
Stock Position:  -0.0004318793081277597
Bond Position:  [1.09544582]


portfolio before change:  [1.05429601]
curr_Stock_Price:  95.91501492881227
curr_Factors:  [95.91501493 -0.76665508 -1.07418855]
mat_Sqrt:  [[15.22013018  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00634687 -0.00294867 -0.35084887]
Stock Position:  -0.006346868948782738
Bond Position:  [1.66305604]


portfolio before change:  [1.05398954]
curr_Stock_Price:  96.02881740271252
curr_Factors:  [96.0288174  -0.75470652 -1.04721181]
mat_Sqrt:  [[15.84303532  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00480135 -0.08396127 -0.85777067]
Stock Position:  -0.00480135079056278
Bond Position:  [1.51505757]


portfolio before change:  [1.05492332]
curr_Stock_Price:  95.91323026268559
curr_Factors:  [95.91323026 -0.48662423 -1.02915215]
mat_Sqrt:  [[21.0661514   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0020149  -0.00541353  0.01608505]
Stock Position:  0.0020149042365084566
Bond Position:  [0.86166735]


portfolio before change:  [1.05534967]
curr_Stock_Price:  96.01790238280302
curr_Factors:  [96.01790238 -0.3430429  -1.01359195]
mat_Sqrt:  [[24.72709984  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00051387 -0.01831408 -0.31229621]
Stock Position:  -0.000513874281480904
Bond Position:  [1.1046908]


portfolio before change:  [1.05467769]
curr_Stock_Price:  97.86308433126051
curr_Factors:  [97.86308433 -0.67627098 -1.03346696]
mat_Sqrt:  [[17.70472348  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00769252  0.00178942 -0.02574387]
Stock Position:  0.007692520997560129
Bond Position:  [0.30186385]


portfolio before change:  [1.07188345]
curr_Stock_Price:  100.08995956427381
curr_Factors:  [100.08995956  -0.70609993  -1.05691231]
mat_Sqrt:  [[17.16817085  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00042905  0.03190501  0.23912847]
Stock Position:  -0.0004290534922008644
Bond Position:  [1.11482739]


portfolio before change:  [1.07238394]
curr_Stock_Price:  99.57312897999074
curr_Factors:  [99.57312898 -0.25717494 -1.0394506 ]
mat_Sqrt:  [[27.22857015  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-1.63001206e-04  6.49517584e-03 -1.92573260e-01]
Stock Position:  -0.00016300120550426063
Bond Position:  [1.08861448]


portfolio before change:  [1.07239207]
curr_Stock_Price:  101.19307635305874
curr_Factors:  [101.19307635  -0.35357566  -1.07104684]
mat_Sqrt:  [[24.34698053  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01858353 -0.31749803 -0.66648402]
Stock Position:  -0.018583533506985675
Bond Position:  [2.95291699]


portfolio before change:  [1.1150691]
curr_Stock_Price:  98.93630925830035
curr_Factors:  [98.93630926 -0.39230536 -1.08740212]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [1.1150691]
Stock Price:  98.26708112904153
PL:  [1.1150691]
Settle:  Tensor("sub_10:0", shape=(), dtype=float64)
PL:  Tensor("sub_11:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  6
output_Z_Vals[:, i, :]:  [[ 1.19251512e+02 -2.92846752e+01 -2.92776944e+01]
 [-7.98938618e-02  3.21766208e-03 -5.51574421e-02]
 [-1.48007295e-01 -1.39694868e-04  1.33156939e-01]
 [-4.33041196e-02 -2.71724779e-02 -1.18064847e-01]
 [-9.88296441e-02 -2.41910939e-01  2.15109929e-01]
 [-8.85624592e-02 -1.11959391e-01  2.26361242e-02]
 [ 5.57321001e-02  3.15002422e-02 -1.72146690e-02]
 [-1.31482912e-01  2.04128034e-01 -7.50217185e-02]
 [-5.07487328e-03 -8.59576171e-03  2.05039974e-03]
 [ 4.84825992e-02  4.43939141e-02 -1.02677687e-02]
 [ 1.07878029e-01  2.62259623e-02 -2.10307373e-02]
 [ 1.25743265e-01 -1.13864308e-02 -1.43583078e-01]
 [ 4.98417454e-02 -7.40866477e-03 -1.60003057e-01]
 [-8.45720117e-02  2.97281712e-02 -3.59999752e-02]
 [-8.89572848e-02  1.66474625e-02  1.57714978e-01]
 [-4.66670732e-02 -1.03028407e-01  1.36928249e-01]
 [-2.36165885e-02  5.47712324e-02  1.28222765e-01]
 [ 6.14958079e-03  2.73297124e-02 -8.32821136e-02]
 [-3.52804929e-01 -9.30541717e-01 -1.78746573e-01]
 [ 7.96161268e-02 -5.15527311e-02 -1.03934083e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.25151208 -29.28467519 -29.2776944 ]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  8.31409947  -9.26062741 -83.52111278]
init_Out:  [2.49223638]
Stock Position:  8.314099471154409
Bond position:  [-828.91771073]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [1.46465319]
curr_Stock_Price:  99.90133292628212
curr_Factors:  [99.90133293 -1.28479243 -1.03065223]
mat_Sqrt:  [[ 9.86248699  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00923395  0.00101751 -0.15734883]
Stock Position:  -0.009233953667753385
Bond Position:  [2.38713747]


portfolio before change:  [1.46779787]
curr_Stock_Price:  99.62541326591138
curr_Factors:  [99.62541327 -1.07913653 -0.99185692]
mat_Sqrt:  [[12.55882787  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-9.62114908e-03 -4.41753961e-05  3.79859683e-01]
Stock Position:  -0.009621149076620057
Bond Position:  [2.42630883]


portfolio before change:  [1.4622271]
curr_Stock_Price:  100.26748035254715
curr_Factors:  [100.26748035  -1.04521148  -0.98582478]
mat_Sqrt:  [[13.15504266  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00517715 -0.00859269 -0.33680614]
Stock Position:  -0.005177147475069934
Bond Position:  [1.98132664]


portfolio before change:  [1.46109466]
curr_Stock_Price:  100.58190770159547
curr_Factors:  [100.5819077   -0.98200133  -0.95855436]
mat_Sqrt:  [[14.44598768  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00423416 -0.07649896  0.61364875]
Stock Position:  -0.004234160282221437
Bond Position:  [1.88697458]


portfolio before change:  [1.45872861]
curr_Stock_Price:  101.25213496162154
curr_Factors:  [101.25213496  -1.03453542  -0.98413149]
mat_Sqrt:  [[13.44956653  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00645617 -0.03540467  0.06457456]
Stock Position:  -0.006456167826334578
Bond Position:  [2.11242939]


portfolio before change:  [1.45977752]
curr_Stock_Price:  101.17147794064701
curr_Factors:  [101.17147794  -0.91630494  -0.93365665]
mat_Sqrt:  [[15.90852745  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00333353  0.00996125 -0.04910866]
Stock Position:  0.0033335268397169686
Bond Position:  [1.12251969]


portfolio before change:  [1.46369959]
curr_Stock_Price:  102.26383666251061
curr_Factors:  [102.26383666  -1.00805377  -0.98286421]
mat_Sqrt:  [[13.96617214  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01013349  0.06455095 -0.21401608]
Stock Position:  -0.010133491985529498
Bond Position:  [2.49998936]


portfolio before change:  [1.46379131]
curr_Stock_Price:  102.31647033090871
curr_Factors:  [102.31647033  -1.3468065   -0.99232697]
mat_Sqrt:  [[ 9.86444807  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00049453 -0.00271822  0.00584922]
Stock Position:  -0.0004945313479741797
Bond Position:  [1.51439001]


portfolio before change:  [1.46426219]
curr_Stock_Price:  102.12996010525518
curr_Factors:  [102.12996011  -0.98286488  -1.03791187]
mat_Sqrt:  [[13.5375779   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00351119  0.01403859 -0.02929109]
Stock Position:  0.0035111853797587687
Bond Position:  [1.10566496]


portfolio before change:  [1.46659453]
curr_Stock_Price:  102.71548637534354
curr_Factors:  [102.71548638  -1.14500872  -1.04897589]
mat_Sqrt:  [[11.44986889  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00910598  0.00829338 -0.05999484]
Stock Position:  0.009105981932984116
Bond Position:  [0.53126917]


portfolio before change:  [1.46711364]
curr_Stock_Price:  102.75790679447995
curr_Factors:  [102.75790679  -1.31597336  -1.04893475]
mat_Sqrt:  [[ 9.65492063  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00995767 -0.00360071 -0.40960256]
Stock Position:  0.009957668163098446
Bond Position:  [0.44388451]


portfolio before change:  [1.46756605]
curr_Stock_Price:  102.79219442348105
curr_Factors:  [102.79219442  -1.33328785  -1.08251986]
mat_Sqrt:  [[ 9.178848    0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00185099 -0.00234283 -0.45644419]
Stock Position:  0.0018509912400859927
Bond Position:  [1.2772986]


portfolio before change:  [1.46871706]
curr_Stock_Price:  103.24148953882961
curr_Factors:  [103.24148954  -1.35589922  -1.08281859]
mat_Sqrt:  [[ 9.01016148  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01011668  0.00940087 -0.10269791]
Stock Position:  -0.010116677487264846
Bond Position:  [2.51317791]


portfolio before change:  [1.47710546]
curr_Stock_Price:  102.47443633305716
curr_Factors:  [102.47443633  -0.99011315  -1.07709168]
mat_Sqrt:  [[12.96701123  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00434441  0.00526439  0.44991693]
Stock Position:  -0.004344410061016839
Bond Position:  [1.92229643]


portfolio before change:  [1.47606903]
curr_Stock_Price:  102.82363641254888
curr_Factors:  [102.82363641  -0.99935162  -1.09416261]
mat_Sqrt:  [[12.67334565  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00168676 -0.03258044  0.39061818]
Stock Position:  -0.001686760069379446
Bond Position:  [1.64950783]


portfolio before change:  [1.4779743]
curr_Stock_Price:  101.93860079747567
curr_Factors:  [101.9386008   -0.78380963  -1.07411476]
mat_Sqrt:  [[15.90202219  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [2.49714216e-04 1.73201845e-02 3.65783859e-01]
Stock Position:  0.0002497142158587337
Bond Position:  [1.45251878]


portfolio before change:  [1.47818839]
curr_Stock_Price:  101.34160245335283
curr_Factors:  [101.34160245  -1.02926548  -1.09340135]
mat_Sqrt:  [[12.13180094  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0008362   0.00864241 -0.23758069]
Stock Position:  -0.0008362039052169747
Bond Position:  [1.56293064]


portfolio before change:  [1.47871085]
curr_Stock_Price:  101.184136429858
curr_Factors:  [101.18413643  -0.76099724  -1.10201126]
mat_Sqrt:  [[15.70428317  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0263188  -0.29426313 -0.50991422]
Stock Position:  -0.026318801067474838
Bond Position:  [4.14175601]


portfolio before change:  [1.50299656]
curr_Stock_Price:  100.30073217377038
curr_Factors:  [100.30073217  -0.98826356  -1.05605488]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [1.50299656]
Stock Price:  101.70241125053452
PL:  [-0.19941469]
Settle:  Tensor("sub_12:0", shape=(), dtype=float64)
PL:  Tensor("sub_13:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  7
output_Z_Vals[:, i, :]:  [[ 1.19251512e+02 -2.92846752e+01 -2.92776944e+01]
 [-1.32405904e-02 -9.64925646e-02 -2.91083280e-01]
 [-3.32234441e-01 -5.01700090e-02  2.11226577e-01]
 [-4.07136332e-02 -1.60015290e-02 -8.64109451e-02]
 [-8.79309670e-02 -1.50838097e-01  1.22733933e-01]
 [-2.76817138e-02  1.64265637e-02 -9.55123020e-03]
 [-1.27717182e-01 -9.70034232e-02  8.85560019e-02]
 [-3.48550551e-02  4.75974010e-02 -1.12398669e-01]
 [-1.88511711e-01 -9.68636825e-02  2.01862622e-01]
 [ 4.71682320e-02  3.72506812e-02  1.41920853e-03]
 [-1.38822465e-01  1.71317577e-01  3.05931242e-02]
 [-2.39896270e-02 -8.64859362e-03 -1.01799330e-01]
 [ 3.80774565e-02 -9.47305836e-02 -1.45266269e-01]
 [-2.00999695e-02  1.45624866e-02  7.98320928e-04]
 [-2.67244245e-02 -4.45558442e-02  2.25108937e-02]
 [ 4.54033840e-02 -4.89939883e-03  8.38254080e-02]
 [-2.75148596e-02  1.06657383e-01  7.82751979e-02]
 [ 8.59493355e-03  2.63314129e-02 -7.66411234e-02]
 [-2.20420321e-01 -7.01020119e-01 -2.53565048e-02]
 [ 7.53389049e-02 -4.17232588e-02 -9.12306156e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.25151208 -29.28467519 -29.2776944 ]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  8.31409947  -9.26062741 -83.52111278]
init_Out:  [2.49223638]
Stock Position:  8.314099471154409
Bond position:  [-828.91771073]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [14.2543287]
curr_Stock_Price:  101.43964450876098
curr_Factors:  [101.43964451  -1.16851092  -0.99703151]
mat_Sqrt:  [[11.6338803   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00645951 -0.03051363 -0.83037958]
Stock Position:  -0.006459508049408525
Bond Position:  [14.9095789]


portfolio before change:  [14.26355803]
curr_Stock_Price:  100.58795930140506
curr_Factors:  [100.5879593   -1.33104012  -0.99417556]
mat_Sqrt:  [[ 9.83371587  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02953242 -0.01586515  0.60257063]
Stock Position:  -0.029532415229729915
Bond Position:  [17.23416341]


portfolio before change:  [14.2808217]
curr_Stock_Price:  100.14930271811389
curr_Factors:  [100.14930272  -1.12923281  -0.99530096]
mat_Sqrt:  [[11.96670641  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00491074 -0.00506013 -0.24650637]
Stock Position:  -0.004910737274352959
Bond Position:  [14.77262861]


portfolio before change:  [14.29051757]
curr_Stock_Price:  98.92703185313879
curr_Factors:  [98.92703185 -0.95359116 -0.98249705]
mat_Sqrt:  [[14.2719249   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0046786  -0.04769919  0.35012575]
Stock Position:  -0.004678600197980954
Bond Position:  [14.7533576]


portfolio before change:  [14.2958168]
curr_Stock_Price:  98.58281955283017
curr_Factors:  [98.58281955 -0.9583734  -0.9377058 ]
mat_Sqrt:  [[14.80282151  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00197308  0.00519454 -0.027247  ]
Stock Position:  -0.001973084554197019
Bond Position:  [14.49032904]


portfolio before change:  [14.30156882]
curr_Stock_Price:  97.50380314568781
curr_Factors:  [97.50380315 -1.06704505 -0.93066062]
mat_Sqrt:  [[13.22601486  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00847915 -0.03067518  0.25262562]
Stock Position:  -0.008479151290741348
Bond Position:  [15.12831832]


portfolio before change:  [14.30436542]
curr_Stock_Price:  97.62008359574018
curr_Factors:  [97.6200836  -1.36360747 -0.90309267]
mat_Sqrt:  [[10.11867883  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00559059  0.01505162 -0.32064212]
Stock Position:  -0.005590589303003999
Bond Position:  [14.85011921]


portfolio before change:  [14.30298079]
curr_Stock_Price:  98.53190451674101
curr_Factors:  [98.53190452 -1.3449983  -0.84292137]
mat_Sqrt:  [[11.0503348   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01355685 -0.03063099  0.57585787]
Stock Position:  -0.013556845834316423
Bond Position:  [15.63876263]


portfolio before change:  [14.3142473]
curr_Stock_Price:  97.98927671551307
curr_Factors:  [97.98927672 -1.11729126 -0.83194962]
mat_Sqrt:  [[13.95192064  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00347047 0.0117797  0.00404861]
Stock Position:  0.003470470944917669
Bond Position:  [13.97417836]


portfolio before change:  [14.31093639]
curr_Stock_Price:  96.02847930762005
curr_Factors:  [96.02847931 -1.15410689 -0.76691259]
mat_Sqrt:  [[14.06409826  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00911216  0.05417537  0.08727367]
Stock Position:  -0.009112156853934184
Bond Position:  [15.18596295]


portfolio before change:  [14.29510258]
curr_Stock_Price:  98.18282867073418
curr_Factors:  [98.18282867 -1.2109525  -0.77812217]
mat_Sqrt:  [[13.43356836  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00334927 -0.00273493 -0.29040515]
Stock Position:  -0.003349268997769128
Bond Position:  [14.62394329]


portfolio before change:  [14.29944792]
curr_Stock_Price:  97.9771430631484
curr_Factors:  [97.97714306 -1.53253804 -0.76919949]
mat_Sqrt:  [[ 9.80602196  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00060974 -0.02995644 -0.41440423]
Stock Position:  0.0006097447378449656
Bond Position:  [14.23970687]


portfolio before change:  [14.30268069]
curr_Stock_Price:  97.4398666012087
curr_Factors:  [97.4398666  -1.43963208 -0.72439724]
mat_Sqrt:  [[11.19207695  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00174776  0.00460506  0.00227739]
Stock Position:  -0.0017477552406072537
Bond Position:  [14.47298173]


portfolio before change:  [14.30327136]
curr_Stock_Price:  99.17239349517531
curr_Factors:  [99.1723935  -1.56284094 -0.7313017 ]
mat_Sqrt:  [[10.00131952  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00232768 -0.0140898   0.06421731]
Stock Position:  -0.002327676309771883
Bond Position:  [14.53411259]


portfolio before change:  [14.30559889]
curr_Stock_Price:  99.73365947090925
curr_Factors:  [99.73365947 -1.73905063 -0.72148575]
mat_Sqrt:  [[ 8.51617111  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00732579 -0.00154933  0.23913056]
Stock Position:  0.0073257889102529535
Bond Position:  [13.57497116]


portfolio before change:  [14.31703123]
curr_Stock_Price:  100.83090243840579
curr_Factors:  [100.83090244  -1.50924654  -0.80928332]
mat_Sqrt:  [[ 9.92359262  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00088507  0.03372803  0.22329735]
Stock Position:  -0.0008850746189368471
Bond Position:  [14.4062741]


portfolio before change:  [14.31945392]
curr_Stock_Price:  102.16336854698453
curr_Factors:  [102.16336855  -1.67435252  -0.86273949]
mat_Sqrt:  [[ 8.08072163  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00078823  0.00832672 -0.21863579]
Stock Position:  -0.0007882335768164922
Bond Position:  [14.39998252]


portfolio before change:  [14.32385096]
curr_Stock_Price:  101.15275256564192
curr_Factors:  [101.15275257  -1.7725014   -0.84940536]
mat_Sqrt:  [[ 7.35018154  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.03315516 -0.22168203 -0.07233505]
Stock Position:  -0.03315516177882067
Bond Position:  [17.67758684]


portfolio before change:  [14.33144445]
curr_Stock_Price:  101.05703482915311
curr_Factors:  [101.05703483  -1.65039652  -0.88234547]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [14.33144445]
Stock Price:  101.69819623070251
PL:  [12.63324822]
Settle:  Tensor("sub_14:0", shape=(), dtype=float64)
PL:  Tensor("sub_15:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  8
output_Z_Vals[:, i, :]:  [[ 1.19251512e+02 -2.92846752e+01 -2.92776944e+01]
 [-1.82932168e-01  4.31518536e-02  4.57023070e-03]
 [-6.53612612e-02  2.17558581e-02  9.37957124e-02]
 [-2.12615283e-02  3.58278638e-02  5.63656966e-02]
 [-8.50612774e-02 -1.26858050e-01  9.84107583e-02]
 [-1.87510858e-02  7.02414674e-03 -2.93249606e-03]
 [-1.84548001e-03  6.18870431e-03  7.85976328e-03]
 [-8.48908919e-02  1.53039028e-01 -1.03879473e-01]
 [-1.33507704e-01 -6.67031264e-02  1.33172309e-01]
 [ 6.84299530e-02  5.69027817e-02 -4.88930344e-03]
 [ 2.26575317e-02  9.05810914e-02 -1.19902450e-02]
 [ 6.50617134e-02 -9.60687963e-03 -1.17376537e-01]
 [ 3.18003439e-02 -9.86144882e-02 -2.73732369e-01]
 [-7.87892227e-02  3.15199090e-02 -2.29161899e-02]
 [-8.56288889e-02  9.58559793e-03  1.42366127e-01]
 [-1.58996579e-02 -5.90822193e-02  1.13838377e-01]
 [-2.43401498e-02  6.44018634e-02  1.18951956e-01]
 [-1.18738117e-02  5.15248924e-02 -8.56220181e-02]
 [-3.03745367e-01 -9.06443598e-01 -1.27283350e-01]
 [ 8.26091595e-02 -5.06177719e-02 -1.05156814e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.25151208 -29.28467519 -29.2776944 ]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  8.31409947  -9.26062741 -83.52111278]
init_Out:  [2.49223638]
Stock Position:  8.314099471154409
Bond position:  [-828.91771073]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-1.37097874]
curr_Stock_Price:  99.56026989998125
curr_Factors:  [99.5602699  -1.24287986 -0.98580729]
mat_Sqrt:  [[10.71962361  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0168742   0.01364581  0.0130376 ]
Stock Position:  -0.016874202335984082
Bond Position:  [0.3090214]


portfolio before change:  [-1.36207584]
curr_Stock_Price:  99.0372446525081
curr_Factors:  [99.03724465 -1.18111829 -0.95206657]
mat_Sqrt:  [[11.73189417  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00389141  0.00687981  0.26757306]
Stock Position:  -0.0038914055199474047
Bond Position:  [-0.97668176]


portfolio before change:  [-1.36111313]
curr_Stock_Price:  98.72709685390922
curr_Factors:  [98.72709685 -1.17436777 -0.93612297]
mat_Sqrt:  [[11.96360001  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00073814  0.01132977  0.16079564]
Stock Position:  -0.0007381438022322523
Bond Position:  [-1.28823834]


portfolio before change:  [-1.36087173]
curr_Stock_Price:  97.96369089483692
curr_Factors:  [97.96369089 -1.07781159 -0.89558304]
mat_Sqrt:  [[13.61541054  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00501261 -0.04011604  0.2807385 ]
Stock Position:  -0.005012608768216378
Bond Position:  [-0.86981807]


portfolio before change:  [-1.36001252]
curr_Stock_Price:  97.74889470722772
curr_Factors:  [97.74889471 -1.38312294 -0.89593024]
mat_Sqrt:  [[10.00763919  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00191537  0.00222123 -0.0083656 ]
Stock Position:  -0.0019153684461332761
Bond Position:  [-1.17278737]


portfolio before change:  [-1.36327136]
curr_Stock_Price:  99.29721789940963
curr_Factors:  [99.2972179  -1.20601795 -0.85372595]
mat_Sqrt:  [[12.65906621  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-6.42392518e-06  1.95704014e-03  2.24217169e-02]
Stock Position:  -6.423925183034292e-06
Bond Position:  [-1.36263349]


portfolio before change:  [-1.36361882]
curr_Stock_Price:  100.34950219964813
curr_Factors:  [100.3495022   -1.36220319  -0.82609625]
mat_Sqrt:  [[11.24990486  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00907952  0.04839519 -0.29633922]
Stock Position:  -0.009079521214566951
Bond Position:  [-0.45249339]


portfolio before change:  [-1.35915787]
curr_Stock_Price:  99.84572075775003
curr_Factors:  [99.84572076 -1.39238641 -0.85898653]
mat_Sqrt:  [[10.50922304  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01028109 -0.02109338  0.37990353]
Stock Position:  -0.010281091827292614
Bond Position:  [-0.33263484]


portfolio before change:  [-1.35196344]
curr_Stock_Price:  99.13785854900347
curr_Factors:  [99.13785855 -1.4172242  -0.84222973]
mat_Sqrt:  [[10.35073424  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00665664  0.01799424 -0.01394782]
Stock Position:  0.0066566438656728705
Bond Position:  [-2.01188886]


portfolio before change:  [-1.34431441]
curr_Stock_Price:  100.36250882810234
curr_Factors:  [100.36250883  -1.62838813  -0.85111901]
mat_Sqrt:  [[ 8.40882359  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00268157  0.02864426 -0.03420483]
Stock Position:  0.002681567368712284
Bond Position:  [-1.61344324]


portfolio before change:  [-1.34449198]
curr_Stock_Price:  100.44673014511774
curr_Factors:  [100.44673015  -1.27261249  -0.79557266]
mat_Sqrt:  [[12.69797319  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00321739 -0.00303796 -0.33484259]
Stock Position:  0.0032173858773302715
Bond Position:  [-1.66766787]


portfolio before change:  [-1.35138268]
curr_Stock_Price:  98.43462021436441
curr_Factors:  [98.43462021 -1.06190944 -0.81030759]
mat_Sqrt:  [[15.1375066   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00175863 -0.03118464 -0.78088226]
Stock Position:  -0.0017586289378265156
Bond Position:  [-1.17827271]


portfolio before change:  [-1.35297258]
curr_Stock_Price:  99.17115685693075
curr_Factors:  [99.17115686 -1.07955363 -0.79650843]
mat_Sqrt:  [[15.19224584  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00544048  0.00996747 -0.06537351]
Stock Position:  -0.005440481326882066
Bond Position:  [-0.81343376]


portfolio before change:  [-1.36345033]
curr_Stock_Price:  101.05965984196251
curr_Factors:  [101.05965984  -1.28373587  -0.76600452]
mat_Sqrt:  [[13.01328351  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00432796  0.00303123  0.40613093]
Stock Position:  -0.004327964254359146
Bond Position:  [-0.92606774]


portfolio before change:  [-1.36680682]
curr_Stock_Price:  101.78169370549496
curr_Factors:  [101.78169371  -1.21174881  -0.78103551]
mat_Sqrt:  [[13.87440728  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0004189  -0.01868344  0.3247492 ]
Stock Position:  0.0004189012997341855
Bond Position:  [-1.4094433]


portfolio before change:  [-1.36727101]
curr_Stock_Price:  101.5148293179803
curr_Factors:  [101.51482932  -0.87543018  -0.79514516]
mat_Sqrt:  [[19.0988772   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [8.39664838e-05 2.03656574e-02 3.39336822e-01]
Stock Position:  8.396648380981754e-05
Bond Position:  [-1.37579485]


portfolio before change:  [-1.36755485]
curr_Stock_Price:  102.2312174564311
curr_Factors:  [102.23121746  -1.10411124  -0.83783499]
mat_Sqrt:  [[14.66246545  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00191107  0.0162936  -0.24425579]
Stock Position:  -0.001911067826458039
Bond Position:  [-1.17218406]


portfolio before change:  [-1.37220019]
curr_Stock_Price:  104.50861309278739
curr_Factors:  [104.50861309  -1.00970223  -0.87886021]
mat_Sqrt:  [[15.81101821  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0223345  -0.28664263 -0.36310397]
Stock Position:  -0.022334503746697244
Bond Position:  [0.96194782]


portfolio before change:  [-1.37237969]
curr_Stock_Price:  104.52741879868154
curr_Factors:  [104.5274188   -1.13575242  -0.9088688 ]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-1.37237969]
Stock Price:  103.12257814261876
PL:  [-4.49495783]
Settle:  Tensor("sub_16:0", shape=(), dtype=float64)
PL:  Tensor("sub_17:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  9
output_Z_Vals[:, i, :]:  [[ 1.19251512e+02 -2.92846752e+01 -2.92776944e+01]
 [-8.88813871e-02 -1.57368556e-02 -8.66172523e-02]
 [-3.06259779e-01 -4.31161056e-02  2.00219337e-01]
 [-2.20610065e-02  3.72742946e-02  5.97531575e-02]
 [-8.34449289e-02 -1.13351324e-01  8.47107650e-02]
 [-4.83642728e-02  3.04044577e-02 -8.79676481e-03]
 [-1.36603191e-02  2.09142234e-03  1.22486959e-02]
 [-7.44285766e-02  1.31375388e-01 -8.80787766e-02]
 [-3.03401798e-01 -1.37278202e-01  2.90990460e-01]
 [ 3.86987443e-02  2.94223768e-02  3.93216901e-03]
 [-1.58961009e-03  9.94684947e-02  3.10297389e-03]
 [-1.08114741e-02 -9.39271028e-03 -1.12440623e-01]
 [ 1.66415787e-02 -1.49979798e-01 -3.51795746e-01]
 [-3.81554881e-02  1.52352142e-02 -2.03233585e-02]
 [ 1.86229258e-02 -6.22587922e-02 -7.54246249e-02]
 [ 1.47961944e-01  1.28511757e-02 -2.21000356e-02]
 [-2.40033451e-02  1.03857272e-01  6.91254884e-02]
 [ 1.40683036e-02  1.46884500e-02 -5.66680467e-02]
 [-3.92969842e-01 -1.00493443e+00 -2.48077675e-01]
 [ 1.15878138e-01 -1.25863891e-01 -2.02780055e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.25151208 -29.28467519 -29.2776944 ]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  8.31409947  -9.26062741 -83.52111278]
init_Out:  [2.49223638]
Stock Position:  8.314099471154409
Bond position:  [-828.91771073]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [3.51206858]
curr_Stock_Price:  100.14759115278007
curr_Factors:  [100.14759115  -1.25355315  -0.99853103]
mat_Sqrt:  [[10.53350183  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01015506 -0.00497643 -0.24709491]
Stock Position:  -0.010155063838640005
Bond Position:  [4.52907376]


portfolio before change:  [3.50921124]
curr_Stock_Price:  100.54047389114265
curr_Factors:  [100.54047389  -1.22916614  -0.98367889]
mat_Sqrt:  [[10.99802084  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02423194 -0.01363451  0.57117004]
Stock Position:  -0.024231944530084246
Bond Position:  [5.94550242]


portfolio before change:  [3.56262998]
curr_Stock_Price:  98.39734503006525
curr_Factors:  [98.39734503 -1.29655287 -1.01603022]
mat_Sqrt:  [[ 9.74184701  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00091374  0.01178717  0.17045913]
Stock Position:  -0.0009137411193050211
Bond Position:  [3.65253968]


portfolio before change:  [3.56341091]
curr_Stock_Price:  98.54215129335856
curr_Factors:  [98.54215129 -1.25202737 -1.04865855]
mat_Sqrt:  [[ 9.87294771  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00699691 -0.03584484  0.24165623]
Stock Position:  -0.006996910853183835
Bond Position:  [4.25290156]


portfolio before change:  [3.56484091]
curr_Stock_Price:  98.48975064382886
curr_Factors:  [98.48975064 -0.72455213 -1.06781895]
mat_Sqrt:  [[16.40492189  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00300976  0.00961473 -0.02509472]
Stock Position:  -0.003009759236971568
Bond Position:  [3.86127135]


portfolio before change:  [3.56337484]
curr_Stock_Price:  99.2976280586093
curr_Factors:  [99.29762806 -0.70041838 -1.09432374]
mat_Sqrt:  [[16.50031651  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00067308  0.00066137  0.03494212]
Stock Position:  -0.0006730818898617348
Bond Position:  [3.63021027]


portfolio before change:  [3.56444139]
curr_Stock_Price:  99.06156850989305
curr_Factors:  [99.06156851 -0.60412845 -1.08754487]
mat_Sqrt:  [[18.24823279  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00487803  0.04154455 -0.25126423]
Stock Position:  -0.004878033104131727
Bond Position:  [4.047667]


portfolio before change:  [3.56801774]
curr_Stock_Price:  98.53588393244937
curr_Factors:  [98.53588393 -0.43860575 -1.07314325]
mat_Sqrt:  [[21.72952191  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01139225 -0.04341118  0.83011479]
Stock Position:  -0.011392249142697791
Bond Position:  [4.69056308]


portfolio before change:  [3.58152628]
curr_Stock_Price:  97.45306368770181
curr_Factors:  [97.45306369 -0.85317093 -1.08986377]
mat_Sqrt:  [[13.96195542  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00288363 0.00930417 0.01121738]
Stock Position:  0.002883627418553922
Bond Position:  [3.30050796]


portfolio before change:  [3.58322018]
curr_Stock_Price:  97.75430380774718
curr_Factors:  [97.75430381 -1.04585279 -1.07466219]
mat_Sqrt:  [[11.72756733  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00013746 0.0314547  0.00885192]
Stock Position:  0.00013745794392158758
Bond Position:  [3.56978307]


portfolio before change:  [3.58412617]
curr_Stock_Price:  97.85200954095775
curr_Factors:  [97.85200954 -0.96080222 -1.10074224]
mat_Sqrt:  [[12.45238008  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00273087 -0.00297024 -0.3207618 ]
Stock Position:  -0.0027308706131293206
Bond Position:  [3.85134734]


portfolio before change:  [3.58501684]
curr_Stock_Price:  97.87847913934434
curr_Factors:  [97.87847914 -0.75263123 -1.12353085]
mat_Sqrt:  [[14.99271803  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00393797 -0.04742778 -1.00357534]
Stock Position:  -0.003937971015672152
Bond Position:  [3.97045945]


portfolio before change:  [3.58508925]
curr_Stock_Price:  98.11218532340528
curr_Factors:  [98.11218532 -0.76389175 -1.1035254 ]
mat_Sqrt:  [[15.16051613  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00276446  0.0048178  -0.05797689]
Stock Position:  -0.002764457648042014
Bond Position:  [3.85631623]


portfolio before change:  [3.58906049]
curr_Stock_Price:  97.02443354300232
curr_Factors:  [97.02443354 -1.05339901 -1.1218782 ]
mat_Sqrt:  [[11.01971154  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 1.46956989e-04 -1.96879588e-02 -2.15165461e-01]
Stock Position:  0.00014695698851952484
Bond Position:  [3.57480207]


portfolio before change:  [3.58997987]
curr_Stock_Price:  97.19840464123075
curr_Factors:  [97.19840464 -1.27577198 -1.10334148]
mat_Sqrt:  [[ 9.00374715  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0159692   0.0040639  -0.06304525]
Stock Position:  0.015969196709215615
Bond Position:  [2.03779943]


portfolio before change:  [3.61721742]
curr_Stock_Price:  98.8721293821935
curr_Factors:  [98.87212938 -0.60929125 -1.07280751]
mat_Sqrt:  [[18.38855817  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00039218  0.03284255  0.19719578]
Stock Position:  -0.00039217759954557417
Bond Position:  [3.65599286]


portfolio before change:  [3.6178272]
curr_Stock_Price:  99.64815208052893
curr_Factors:  [99.64815208 -0.48253801 -1.10587927]
mat_Sqrt:  [[20.35299795  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 1.41514342e-04  4.64489572e-03 -1.61658164e-01]
Stock Position:  0.00014151434218839966
Bond Position:  [3.60372556]


portfolio before change:  [3.61859442]
curr_Stock_Price:  98.70251094426642
curr_Factors:  [98.70251094 -0.19751464 -1.05880807]
mat_Sqrt:  [[28.1005085   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01670987 -0.31778817 -0.70769656]
Stock Position:  -0.016709867766437386
Bond Position:  [5.26790033]


portfolio before change:  [3.63360467]
curr_Stock_Price:  97.88304829914313
curr_Factors:  [ 9.78830483e+01 -6.02829591e-02 -1.06684869e+00]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [3.63360467]
Stock Price:  98.77850950179466
PL:  [3.63360467]
Settle:  Tensor("sub_18:0", shape=(), dtype=float64)
PL:  Tensor("sub_19:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  10
output_Z_Vals[:, i, :]:  [[ 1.19251512e+02 -2.92846752e+01 -2.92776944e+01]
 [-1.23108014e-01  3.25239760e-02  1.82310332e-02]
 [-7.27993497e-02  1.43368025e-02  5.42439824e-02]
 [-2.27327683e-02  2.65231951e-02  3.26600530e-02]
 [-9.14040997e-02 -1.79860708e-01  1.52171827e-01]
 [-1.67471407e-02 -3.32923472e-02 -1.62647951e-02]
 [ 5.54259349e-02  3.65940783e-02 -1.92123031e-02]
 [-1.70109734e-01  2.50252246e-01 -5.95989556e-02]
 [-5.13661938e-02 -6.32299402e-03 -6.32316581e-03]
 [ 5.14474846e-02  3.38493679e-02 -6.59356640e-03]
 [ 1.08777800e-01  2.44891690e-02 -2.24877212e-02]
 [ 2.97319401e-02 -8.57079641e-03 -1.02118667e-01]
 [ 5.21971464e-02 -5.93880942e-03 -1.29331986e-01]
 [-8.45720117e-02  2.97281712e-02 -3.59999752e-02]
 [-1.14507014e-01  6.11273604e-02  2.32253724e-01]
 [-1.19574461e-01 -2.34007273e-01  1.97800159e-01]
 [-2.95668389e-02 -9.96976243e-03  2.36608411e-01]
 [-1.06093937e-01  1.86865288e-01 -7.33391150e-02]
 [-3.05872552e-01 -9.41953013e-01 -1.06583567e-01]
 [ 6.65760559e-02 -2.15853788e-02 -6.52047114e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.25151208 -29.28467519 -29.2776944 ]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  8.31409947  -9.26062741 -83.52111278]
init_Out:  [2.49223638]
Stock Position:  8.314099471154409
Bond position:  [-828.91771073]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-0.29807861]
curr_Stock_Price:  99.68931576210643
curr_Factors:  [99.68931576 -1.39093113 -1.04468898]
mat_Sqrt:  [[ 8.72714599  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01358369  0.01028498  0.05200806]
Stock Position:  -0.01358369097115385
Bond Position:  [1.05607025]


portfolio before change:  [-0.2843841]
curr_Stock_Price:  98.70059659941623
curr_Factors:  [98.7005966  -1.16333947 -1.03687033]
mat_Sqrt:  [[10.93404358  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00561153  0.0045337   0.15474298]
Stock Position:  -0.005611525883425127
Bond Position:  [0.26947685]


portfolio before change:  [-0.2884618]
curr_Stock_Price:  99.43926800223612
curr_Factors:  [99.439268   -1.11115225 -1.03027204]
mat_Sqrt:  [[11.68285987  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00131656  0.00838737  0.09317004]
Stock Position:  -0.0013165643650123668
Bond Position:  [-0.1575436]


portfolio before change:  [-0.28882414]
curr_Stock_Price:  99.68456941782584
curr_Factors:  [99.68456942 -0.90816042 -1.01546699]
mat_Sqrt:  [[14.56153543  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00446286 -0.05687695  0.43410386]
Stock Position:  -0.0044628631017381605
Bond Position:  [0.15605444]


portfolio before change:  [-0.29001572]
curr_Stock_Price:  99.96030996639877
curr_Factors:  [99.96030997 -0.63655995 -1.04177419]
mat_Sqrt:  [[18.66106137  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00112141 -0.01052796 -0.04639893]
Stock Position:  -0.0011214143945671741
Bond Position:  [-0.17791879]


portfolio before change:  [-0.29160896]
curr_Stock_Price:  101.34138740745279
curr_Factors:  [101.34138741  -0.67383369  -1.04868534]
mat_Sqrt:  [[18.10115703  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00289755  0.01157206 -0.05480735]
Stock Position:  0.0028975548285448895
Bond Position:  [-0.58525119]


portfolio before change:  [-0.2837564]
curr_Stock_Price:  104.10195541881583
curr_Factors:  [104.10195542  -1.00645377  -1.06967062]
mat_Sqrt:  [[13.05598142  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01346615  0.07913671 -0.17001923]
Stock Position:  -0.013466152361441549
Bond Position:  [1.1180964]


portfolio before change:  [-0.28179764]
curr_Stock_Price:  103.9772577627356
curr_Factors:  [103.97725776  -0.71322694  -1.07725372]
mat_Sqrt:  [[17.35171841  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00304409 -0.00199951 -0.01803823]
Stock Position:  -0.0030440883341980854
Bond Position:  [0.03471832]


portfolio before change:  [-0.27749628]
curr_Stock_Price:  102.5670878941874
curr_Factors:  [102.56708789  -0.59668853  -1.06685696]
mat_Sqrt:  [[19.43297985  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00262315  0.01070411 -0.01880961]
Stock Position:  0.0026231471336362736
Bond Position:  [-0.54654484]


portfolio before change:  [-0.27716223]
curr_Stock_Price:  102.74652789759315
curr_Factors:  [102.7465279   -1.05687628  -1.07357036]
mat_Sqrt:  [[12.20466701  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0085885   0.00774416 -0.06415121]
Stock Position:  0.00858850313058022
Bond Position:  [-1.15960111]


portfolio before change:  [-0.2673612]
curr_Stock_Price:  103.9214671783424
curr_Factors:  [103.92146718  -1.04071813  -1.10273742]
mat_Sqrt:  [[12.18468626  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0007112  -0.00271032 -0.29131613]
Stock Position:  0.0007112006967270835
Bond Position:  [-0.34127022]


portfolio before change:  [-0.26777444]
curr_Stock_Price:  103.46040118483077
curr_Factors:  [103.46040118  -1.45667398  -1.14861893]
mat_Sqrt:  [[ 7.64380895  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00335488 -0.00187802 -0.36894816]
Stock Position:  0.0033548752967947613
Bond Position:  [-0.61487118]


portfolio before change:  [-0.26513669]
curr_Stock_Price:  104.29246845608644
curr_Factors:  [104.29246846  -1.71482501  -1.17868438]
mat_Sqrt:  [[ 5.77587498  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01578166  0.00940087 -0.10269791]
Stock Position:  -0.015781660448418718
Bond Position:  [1.38077163]


portfolio before change:  [-0.26280968]
curr_Stock_Price:  104.1668940044903
curr_Factors:  [104.166894    -1.38523263  -1.15617763]
mat_Sqrt:  [[ 8.20369039  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00798666  0.01933017  0.66255523]
Stock Position:  -0.007986664115132824
Bond Position:  [0.56913631]


portfolio before change:  [-0.2711214]
curr_Stock_Price:  105.22541063922135
curr_Factors:  [105.22541064  -1.66791329  -1.18080224]
mat_Sqrt:  [[ 6.0945156   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01398646 -0.0739996   0.5642688 ]
Stock Position:  -0.013986462624543
Bond Position:  [1.20060987]


portfolio before change:  [-0.27994149]
curr_Stock_Price:  105.87749013208071
curr_Factors:  [105.87749013  -1.76831174  -1.18756197]
mat_Sqrt:  [[ 5.5091424   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0033532  -0.00315272  0.67497794]
Stock Position:  0.003353195699950139
Bond Position:  [-0.63496944]


portfolio before change:  [-0.28193742]
curr_Stock_Price:  105.32960493381714
curr_Factors:  [105.32960493  -1.70245064  -1.15175918]
mat_Sqrt:  [[ 6.06712411  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01915889  0.05909199 -0.20921608]
Stock Position:  -0.019158892819044607
Bond Position:  [1.73606119]


portfolio before change:  [-0.27718239]
curr_Stock_Price:  105.10407179771268
curr_Factors:  [105.1040718   -1.32173645  -1.13854698]
mat_Sqrt:  [[ 8.97701645  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.03920567 -0.2978717  -0.30405325]
Stock Position:  -0.039205671037320255
Bond Position:  [3.84349328]


portfolio before change:  [-0.23347807]
curr_Stock_Price:  104.0138384780591
curr_Factors:  [104.01383848  -0.86295104  -1.10272855]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-0.23347807]
Stock Price:  104.0021595593388
PL:  [-4.23563762]
Settle:  Tensor("sub_20:0", shape=(), dtype=float64)
PL:  Tensor("sub_21:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  11
output_Z_Vals[:, i, :]:  [[ 1.19251512e+02 -2.92846752e+01 -2.92776944e+01]
 [ 6.67760945e-02 -1.96709202e-02  4.65726261e-02]
 [-5.32383689e-02  2.55965727e-02  9.29968654e-02]
 [-4.98320820e-02  2.99765431e-02  3.17336562e-02]
 [-8.59812794e-02 -1.34545882e-01  1.06208595e-01]
 [-1.18051359e-01  5.21054965e-02  3.35275537e-03]
 [-2.48283173e-01 -2.34896985e-01  1.85668048e-01]
 [ 1.77849814e-03 -1.61656523e-02 -9.27521545e-02]
 [-2.94906718e-01 -1.68734924e-01  3.67295545e-01]
 [ 1.38675017e-02  2.29139384e-03  1.25255330e-02]
 [ 2.04861196e-02  8.17083322e-02  8.58892636e-03]
 [ 2.10781945e-02 -1.01190417e-02 -1.34259252e-01]
 [-3.87306952e-02 -3.91770024e-01 -3.90625672e-01]
 [ 2.32017666e-02 -1.00931133e-02 -2.97537548e-03]
 [ 1.11348156e-02 -5.79141975e-02 -1.09473076e-01]
 [ 1.71403893e-01  3.49982047e-02 -9.21319073e-02]
 [-2.35647895e-02  1.03259148e-01  6.82888801e-02]
 [ 4.38963809e-02 -2.40086075e-02  4.74436642e-02]
 [-3.16293787e-01 -8.21211486e-01 -1.42032687e-01]
 [ 9.87043710e-02 -9.54193744e-02 -1.60626697e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.25151208 -29.28467519 -29.2776944 ]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  8.31409947  -9.26062741 -83.52111278]
init_Out:  [2.49223638]
Stock Position:  8.314099471154409
Bond position:  [-828.91771073]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [7.3821371]
curr_Stock_Price:  100.61307373877719
curr_Factors:  [100.61307374  -0.70473728  -1.04039777]
mat_Sqrt:  [[17.5691963   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00431293 -0.00622049  0.13285874]
Stock Position:  0.004312934392019023
Bond Position:  [6.94819951]


portfolio before change:  [7.37803168]
curr_Stock_Price:  99.2583834009165
curr_Factors:  [99.2583834  -0.77835379 -0.98197452]
mat_Sqrt:  [[17.07128942  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0019679   0.00809435  0.26529417]
Stock Position:  -0.00196789836717861
Bond Position:  [7.57336209]


portfolio before change:  [7.38401713]
curr_Stock_Price:  97.17907169975915
curr_Factors:  [97.1790717  -0.88935557 -0.95624878]
mat_Sqrt:  [[15.34747597  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00277443  0.00947942  0.09052729]
Stock Position:  -0.0027744292030886073
Bond Position:  [7.65363358]


portfolio before change:  [7.38487934]
curr_Stock_Price:  97.55804616684863
curr_Factors:  [97.55804617 -0.71003502 -0.9538235 ]
mat_Sqrt:  [[18.47815145  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00366787 -0.04254714  0.30298356]
Stock Position:  -0.0036678723371642873
Bond Position:  [7.7427098]


portfolio before change:  [7.39251608]
curr_Stock_Price:  96.00378636538645
curr_Factors:  [96.00378637 -1.06499196 -0.97487012]
mat_Sqrt:  [[12.4849703   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0092929   0.0164772   0.00956448]
Stock Position:  -0.009292903351233315
Bond Position:  [8.28466999]


portfolio before change:  [7.40096272]
curr_Stock_Price:  95.31775673024833
curr_Factors:  [95.31775673 -1.01459341 -0.95934386]
mat_Sqrt:  [[13.24048066  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01634751 -0.07428095  0.52965926]
Stock Position:  -0.016347507393439608
Bond Position:  [8.95917045]


portfolio before change:  [7.40168948]
curr_Stock_Price:  95.41032781114619
curr_Factors:  [95.41032781 -0.73790701 -1.02303114]
mat_Sqrt:  [[16.39946442  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00107149 -0.00511203 -0.26459608]
Stock Position:  -0.0010714893492202039
Bond Position:  [7.50392063]


portfolio before change:  [7.40280159]
curr_Stock_Price:  96.1234507331422
curr_Factors:  [96.12345073 -0.56474736 -1.02584696]
mat_Sqrt:  [[19.59038706  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01144896 -0.05335867  1.04779195]
Stock Position:  -0.0114489593997115
Bond Position:  [8.50331508]


portfolio before change:  [7.40286684]
curr_Stock_Price:  96.30345407572764
curr_Factors:  [96.30345408 -0.56101846 -0.99546119]
mat_Sqrt:  [[20.30819583  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00081166 0.0007246  0.03573186]
Stock Position:  0.000811663876566249
Bond Position:  [7.3247008]


portfolio before change:  [7.40472373]
curr_Stock_Price:  96.33485195805856
curr_Factors:  [96.33485196 -0.32551456 -0.98951381]
mat_Sqrt:  [[25.86270048  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00094147 0.02583844 0.02450182]
Stock Position:  0.000941472719829738
Bond Position:  [7.31402709]


portfolio before change:  [7.40666697]
curr_Stock_Price:  96.45647540689123
curr_Factors:  [96.45647541 -0.26108002 -0.96353577]
mat_Sqrt:  [[28.34572113  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-2.32438367e-04 -3.19992195e-03 -3.83004276e-01]
Stock Position:  -0.0002324383673653506
Bond Position:  [7.42908715]


portfolio before change:  [7.40893537]
curr_Stock_Price:  94.68869454577131
curr_Factors:  [94.68869455 -0.25861085 -0.92962761]
mat_Sqrt:  [[28.8571028   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00445583 -0.12388856 -1.11434631]
Stock Position:  -0.004455827951179462
Bond Position:  [7.8308519]


portfolio before change:  [7.40492965]
curr_Stock_Price:  96.02709364120243
curr_Factors:  [ 9.60270936e+01  4.28261163e-02 -9.20780441e-01]
mat_Sqrt:  [[39.91196096  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00055958 -0.00319172 -0.00848792]
Stock Position:  0.0005595770558032592
Bond Position:  [7.35119509]


portfolio before change:  [7.40730598]
curr_Stock_Price:  96.98906811861534
curr_Factors:  [96.98906812 -0.16181032 -0.96437097]
mat_Sqrt:  [[31.45056605  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00040402 -0.01831408 -0.31229621]
Stock Position:  -0.00040401882242623613
Bond Position:  [7.44649139]


portfolio before change:  [7.40940453]
curr_Stock_Price:  96.40322010864357
curr_Factors:  [96.40322011 -0.14965698 -0.95939596]
mat_Sqrt:  [[31.80064799  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00482698  0.0110674  -0.26282669]
Stock Position:  0.004826983278439869
Bond Position:  [6.9440678]


portfolio before change:  [7.41795879]
curr_Stock_Price:  97.81570331978376
curr_Factors:  [97.81570332 -0.65431038 -0.94027332]
mat_Sqrt:  [[19.85590468  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00035049  0.03265341  0.19480917]
Stock Position:  -0.000350487203569339
Bond Position:  [7.45224195]


portfolio before change:  [7.42001041]
curr_Stock_Price:  97.27840307399214
curr_Factors:  [97.27840307 -0.95536936 -0.9328994 ]
mat_Sqrt:  [[14.72148868  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00359752 -0.00759219  0.13534357]
Stock Position:  0.0035975219505498873
Bond Position:  [7.07004921]


portfolio before change:  [7.42571125]
curr_Stock_Price:  98.37168765257849
curr_Factors:  [98.37168765 -0.84502489 -0.94473929]
mat_Sqrt:  [[16.42802724  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02230881 -0.25968987 -0.40517972]
Stock Position:  -0.022308806274036596
Bond Position:  [9.62026618]


portfolio before change:  [7.41688495]
curr_Stock_Price:  98.87515112001388
curr_Factors:  [98.87515112 -0.95692343 -0.92672262]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [7.41688495]
Stock Price:  99.4141877535815
PL:  [7.41688495]
Settle:  Tensor("sub_22:0", shape=(), dtype=float64)
PL:  Tensor("sub_23:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  12
output_Z_Vals[:, i, :]:  [[ 1.19251512e+02 -2.92846752e+01 -2.92776944e+01]
 [-9.54228174e-02 -1.21482135e-02 -8.30992980e-02]
 [-2.90275350e-01 -3.87752361e-02  1.93445641e-01]
 [-3.86249214e-02 -6.99438174e-03 -6.08883727e-02]
 [-9.88296441e-02 -2.41910939e-01  2.15109929e-01]
 [-1.94856923e-02  1.34293140e-02 -7.61480780e-03]
 [-8.25087985e-02 -4.56553874e-02  5.23394303e-02]
 [-1.67990432e-02  2.23303023e-02 -9.56222640e-02]
 [-2.95561911e-01 -1.39417358e-01  2.96693574e-01]
 [ 4.50470017e-02  4.74936917e-02 -1.18045691e-02]
 [ 3.27708599e-02  8.50094778e-02 -1.22855146e-02]
 [ 1.31935863e-01 -1.15680353e-02 -1.46257475e-01]
 [ 4.31492805e-02 -1.83729846e-02 -4.00700929e-01]
 [-8.45720117e-02  2.97281712e-02 -3.59999752e-02]
 [-1.26713082e-01  7.83297055e-02  2.49857290e-01]
 [-4.55919454e-02 -1.05581496e-01  1.37059321e-01]
 [-2.44937605e-02  2.51362325e-03  1.98987750e-01]
 [-7.21921168e-02  1.35437658e-01 -8.53159437e-02]
 [-2.74967994e-01 -8.38541930e-01 -6.42778771e-02]
 [ 8.32702242e-02 -5.85541011e-02 -1.13416944e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.25151208 -29.28467519 -29.2776944 ]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  8.31409947  -9.26062741 -83.52111278]
init_Out:  [2.49223638]
Stock Position:  8.314099471154409
Bond position:  [-828.91771073]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [2.69747008]
curr_Stock_Price:  100.04961319360075
curr_Factors:  [100.04961319  -1.31077629  -1.01360936]
mat_Sqrt:  [[ 9.78920787  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01151258 -0.0038416  -0.23705917]
Stock Position:  -0.011512581778964933
Bond Position:  [3.84929943]


portfolio before change:  [2.69560974]
curr_Stock_Price:  100.29480444622838
curr_Factors:  [100.29480445  -1.33399079  -0.99971197]
mat_Sqrt:  [[ 9.72219221  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02589844 -0.01226181  0.55184657]
Stock Position:  -0.025898438384588718
Bond Position:  [5.29308855]


portfolio before change:  [2.70139931]
curr_Stock_Price:  100.12235643268575
curr_Factors:  [100.12235643  -1.34083772  -1.00906767]
mat_Sqrt:  [[ 9.54948874  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00536514 -0.00221182 -0.17369758]
Stock Position:  -0.005365135662900668
Bond Position:  [3.23856934]


portfolio before change:  [2.70477515]
curr_Stock_Price:  99.64406601007992
curr_Factors:  [99.64406601 -1.39143009 -1.01441187]
mat_Sqrt:  [[ 8.98685121  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00680624 -0.07649896  0.61364875]
Stock Position:  -0.006806235666419017
Bond Position:  [3.38297614]


portfolio before change:  [2.71318732]
curr_Stock_Price:  98.53239049467625
curr_Factors:  [98.53239049 -1.01964598 -1.00626591]
mat_Sqrt:  [[12.99381456  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00159255  0.00424672 -0.02172293]
Stock Position:  -0.0015925512063072022
Bond Position:  [2.8701052]


portfolio before change:  [2.71416427]
curr_Stock_Price:  98.36955314403946
curr_Factors:  [98.36955314 -0.94049551 -0.97664822]
mat_Sqrt:  [[14.46291232  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00504766 -0.0144375   0.14930983]
Stock Position:  -0.0050476606925897545
Bond Position:  [3.21070039]


portfolio before change:  [2.72533491]
curr_Stock_Price:  96.31555902994553
curr_Factors:  [96.31555903 -0.68680807 -0.92115914]
mat_Sqrt:  [[19.29146292  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0018527   0.00706146 -0.2727837 ]
Stock Position:  -0.0018526998352225244
Bond Position:  [2.90377873]


portfolio before change:  [2.72268748]
curr_Stock_Price:  98.13639233402976
curr_Factors:  [98.13639233 -0.56728479 -0.92225518]
mat_Sqrt:  [[22.12743636  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01078296 -0.04408764  0.84638418]
Stock Position:  -0.010782963079635527
Bond Position:  [3.78088858]


portfolio before change:  [2.70355094]
curr_Stock_Price:  99.99876388545891
curr_Factors:  [99.99876389 -0.85356703 -0.93065654]
mat_Sqrt:  [[16.79253188  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00261209  0.01501882 -0.03367515]
Stock Position:  0.002612094847154646
Bond Position:  [2.44234468]


portfolio before change:  [2.7059019]
curr_Stock_Price:  100.6650101209511
curr_Factors:  [100.66501012  -0.45002143  -0.9389991 ]
mat_Sqrt:  [[25.09773845  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00129326  0.02688236 -0.03504715]
Stock Position:  0.0012932649324127927
Bond Position:  [2.57571537]


portfolio before change:  [2.70615801]
curr_Stock_Price:  100.36506923417473
curr_Factors:  [100.36506923  -0.67414638  -0.96738938]
mat_Sqrt:  [[19.43894403  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00523601 -0.00365813 -0.41723187]
Stock Position:  0.005236009475657098
Bond Position:  [2.18064555]


portfolio before change:  [2.70645795]
curr_Stock_Price:  100.31822282093387
curr_Factors:  [100.31822282  -0.63569879  -0.95536082]
mat_Sqrt:  [[20.43578959  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00191418 -0.00581005 -1.14308822]
Stock Position:  -0.0019141830696419405
Bond Position:  [2.89848539]


portfolio before change:  [2.70285748]
curr_Stock_Price:  102.57776907670753
curr_Factors:  [102.57776908  -0.64011899  -0.93076456]
mat_Sqrt:  [[21.32196328  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00427507  0.00940087 -0.10269791]
Stock Position:  -0.004275070573005153
Bond Position:  [3.14138468]


portfolio before change:  [2.69767177]
curr_Stock_Price:  103.97450617106392
curr_Factors:  [103.97450617  -0.78783175  -0.93438165]
mat_Sqrt:  [[18.57715003  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00396663  0.02477003  0.7127733 ]
Stock Position:  -0.00396663165855164
Bond Position:  [3.11010034]


portfolio before change:  [2.70216007]
curr_Stock_Price:  103.03903258410766
curr_Factors:  [103.03903258  -0.8306934   -0.90810299]
mat_Sqrt:  [[18.10723324  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00112336 -0.0333878   0.39099209]
Stock Position:  -0.0011233594325425929
Bond Position:  [2.81790994]


portfolio before change:  [2.7020676]
curr_Stock_Price:  103.74854897349607
curr_Factors:  [103.74854897  -0.72482158  -0.94441048]
mat_Sqrt:  [[19.54536398  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.0008283  0.00079488 0.56765666]
Stock Position:  0.0008282959279494318
Bond Position:  [2.61613309]


portfolio before change:  [2.70286827]
curr_Stock_Price:  103.92549492774415
curr_Factors:  [103.92549493  -1.17442313  -0.92112854]
mat_Sqrt:  [[12.78308193  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00673626  0.04282915 -0.24338264]
Stock Position:  -0.006736260949169638
Bond Position:  [3.40293753]


portfolio before change:  [2.70635611]
curr_Stock_Price:  103.53403204068665
curr_Factors:  [103.53403204  -1.44292251  -0.92377254]
mat_Sqrt:  [[ 9.71047611  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.03189748 -0.26517024 -0.18336689]
Stock Position:  -0.03189748030160384
Bond Position:  [6.00883086]


portfolio before change:  [2.69166675]
curr_Stock_Price:  104.041650737356
curr_Factors:  [104.04165074  -1.0469486   -0.88006963]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [2.69166675]
Stock Price:  105.72832217769856
PL:  [-3.03665543]
Settle:  Tensor("sub_24:0", shape=(), dtype=float64)
PL:  Tensor("sub_25:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  13
output_Z_Vals[:, i, :]:  [[ 1.19251512e+02 -2.92846752e+01 -2.92776944e+01]
 [ 7.68552365e-02 -2.98613322e-02  2.03037796e-02]
 [-1.55430658e-01 -2.15564742e-03  1.36302725e-01]
 [-4.73461310e-02  1.37096471e-02 -8.28384665e-03]
 [-9.13435688e-02 -1.79354892e-01  1.51658773e-01]
 [-1.11019575e-01  6.35292759e-02 -8.47585039e-03]
 [-2.78190845e-01 -2.77404227e-01  2.14338204e-01]
 [ 1.11845782e-02 -2.95589950e-02 -8.42783205e-02]
 [-4.30410711e-01 -2.63721469e-01  5.86296934e-01]
 [-5.80418634e-03 -2.89679540e-01  9.86561760e-02]
 [-2.62909099e-01  1.47619005e-01  2.94486687e-02]
 [-1.83983985e-01 -1.16791662e-02 -1.76563794e-01]
 [-1.46782200e-01 -6.98094587e-01 -1.04937707e-01]
 [ 1.99191016e-01 -1.79055146e-01 -5.99191217e-02]
 [ 1.11348156e-02 -5.79141975e-02 -1.09473076e-01]
 [ 1.93183776e-01  6.18155888e-02 -1.87352634e-01]
 [ 2.01140851e-02 -3.89239149e-02  1.06348240e-01]
 [ 2.70483462e-02 -2.87840010e-03 -5.72633673e-03]
 [-3.65852881e-01 -1.01112310e+00 -2.30230947e-01]
 [ 1.00708329e-01 -5.85059950e-02 -1.25838751e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.25151208 -29.28467519 -29.2776944 ]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  8.31409947  -9.26062741 -83.52111278]
init_Out:  [2.49223638]
Stock Position:  8.314099471154409
Bond position:  [-828.91771073]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [7.70832511]
curr_Stock_Price:  100.65230685260845
curr_Factors:  [100.65230685  -0.77674608  -1.01245831]
mat_Sqrt:  [[16.8183018   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00477032 -0.00944298  0.05792103]
Stock Position:  0.004770321811790567
Bond Position:  [7.22818121]


portfolio before change:  [7.7061815]
curr_Stock_Price:  99.8240860440936
curr_Factors:  [99.82408604 -0.84496714 -1.0380982 ]
mat_Sqrt:  [[15.1855475   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00840692 -0.00068168  0.38883374]
Stock Position:  -0.008406917099974733
Bond Position:  [8.54539432]


portfolio before change:  [7.71544159]
curr_Stock_Price:  98.9767516819992
curr_Factors:  [98.97675168 -0.46603805 -1.06454566]
mat_Sqrt:  [[21.41949052  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00227284  0.00433537 -0.02363151]
Stock Position:  -0.0022728403598227666
Bond Position:  [7.94039994]


portfolio before change:  [7.71832126]
curr_Stock_Price:  98.58326642558336
curr_Factors:  [98.58326643 -0.31555395 -1.03154201]
mat_Sqrt:  [[25.63107738  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00253666 -0.056717    0.43264027]
Stock Position:  -0.002536657893034667
Bond Position:  [7.96839328]


portfolio before change:  [7.72244707]
curr_Stock_Price:  97.74221390066981
curr_Factors:  [97.7422139  -0.41439242 -1.00863508]
mat_Sqrt:  [[23.55424466  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00471717  0.02008972 -0.02417924]
Stock Position:  -0.0047171702295330485
Bond Position:  [8.18351374]


portfolio before change:  [7.73760056]
curr_Stock_Price:  94.96356647608518
curr_Factors:  [94.96356648 -0.33091128 -0.97963991]
mat_Sqrt:  [[25.60895556  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00943427 -0.08772292  0.61144724]
Stock Position:  -0.009434269508263338
Bond Position:  [8.63351244]


portfolio before change:  [7.75091347]
curr_Stock_Price:  93.78125338303892
curr_Factors:  [93.78125338 -0.23249746 -0.97129722]
mat_Sqrt:  [[28.13938775  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00024101 -0.00934737 -0.24042259]
Stock Position:  -0.00024100993205183275
Bond Position:  [7.77351568]


portfolio before change:  [7.75318416]
curr_Stock_Price:  92.42415989081668
curr_Factors:  [92.42415989  0.33937512 -0.93684837]
mat_Sqrt:  [[50.85178195  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00624447 -0.08339605  1.67254196]
Stock Position:  -0.00624447359712694
Bond Position:  [8.33032439]


portfolio before change:  [7.77777937]
curr_Stock_Price:  88.81899393189624
curr_Factors:  [88.81899393  0.32413081 -0.94090135]
mat_Sqrt:  [[47.93423619  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 1.42996494e-04 -9.16047137e-02  2.81438609e-01]
Stock Position:  0.00014299649362418466
Bond Position:  [7.76507856]


portfolio before change:  [7.77945174]
curr_Stock_Price:  86.9368219595306
curr_Factors:  [86.93682196  0.18136288 -0.98046728]
mat_Sqrt:  [[39.09823294  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00647309  0.04668123  0.08400885]
Stock Position:  -0.006473090714151823
Bond Position:  [8.34220167]


portfolio before change:  [7.77616825]
curr_Stock_Price:  87.76630187503525
curr_Factors:  [87.76630188  0.1519363  -0.96931092]
mat_Sqrt:  [[38.75667491  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00568487 -0.00369328 -0.50368736]
Stock Position:  -0.005684865228579058
Bond Position:  [8.27510785]


portfolio before change:  [7.78482291]
curr_Stock_Price:  86.60785310412084
curr_Factors:  [ 8.66078531e+01 -1.87748907e-02 -9.65822573e-01]
mat_Sqrt:  [[32.35579147  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00575561 -0.22075689 -0.29935807]
Stock Position:  -0.005755607753762715
Bond Position:  [8.28330374]


portfolio before change:  [7.78638704]
curr_Stock_Price:  86.6959340520328
curr_Factors:  [86.69593405 -0.17924718 -0.98317027]
mat_Sqrt:  [[27.11235532  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00672523 -0.05662221 -0.17093258]
Stock Position:  0.0067252324685589246
Bond Position:  [7.20333673]


portfolio before change:  [7.80886377]
curr_Stock_Price:  89.7702774400706
curr_Factors:  [ 8.97702774e+01 -3.52807199e-02 -9.90985579e-01]
mat_Sqrt:  [[32.16849752  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.000395   -0.01831408 -0.31229621]
Stock Position:  -0.0003950019939659908
Bond Position:  [7.84432321]


portfolio before change:  [7.81022303]
curr_Stock_Price:  91.2944951002565
curr_Factors:  [91.2944951  -0.24895011 -1.01043304]
mat_Sqrt:  [[25.91203007  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00604108  0.01954781 -0.53446492]
Stock Position:  0.0060410801796936305
Bond Position:  [7.25870566]


portfolio before change:  [7.81946074]
curr_Stock_Price:  92.52321799706105
curr_Factors:  [92.523218   -0.41433232 -0.99515603]
mat_Sqrt:  [[22.6004829   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00180604 -0.01230882  0.30338193]
Stock Position:  0.0018060374052072258
Bond Position:  [7.65236035]


portfolio before change:  [7.83106312]
curr_Stock_Price:  97.88802954968479
curr_Factors:  [97.88802955 -0.28669602 -1.04781839]
mat_Sqrt:  [[25.77254715  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00100126 -0.00091023 -0.01633564]
Stock Position:  0.001001264738524326
Bond Position:  [7.73305129]


portfolio before change:  [7.83832883]
curr_Stock_Price:  103.21349409548726
curr_Factors:  [103.2134941   -0.38631629  -1.05987381]
mat_Sqrt:  [[24.3032357   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01806161 -0.3197452  -0.65678481]
Stock Position:  -0.018061614015297784
Bond Position:  [9.70253112]


portfolio before change:  [7.79936788]
curr_Stock_Price:  105.5049216167924
curr_Factors:  [105.50492162  -0.31422737  -1.05631872]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [7.79936788]
Stock Price:  106.43593169735233
PL:  [1.36343619]
Settle:  Tensor("sub_26:0", shape=(), dtype=float64)
PL:  Tensor("sub_27:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  14
output_Z_Vals[:, i, :]:  [[ 1.19251512e+02 -2.92846752e+01 -2.92776944e+01]
 [-1.50197479e-01  3.10494156e-02 -4.56478725e-02]
 [-8.66952463e-02  6.33799087e-03  2.67143785e-02]
 [-6.14724627e-02  2.27315644e-02  9.39051261e-03]
 [-8.72126336e-02 -1.44835472e-01  1.16645418e-01]
 [-2.11775762e-01  1.02903442e-01  2.86127995e-03]
 [-3.77703044e-01 -3.88650265e-01  2.93075172e-01]
 [ 7.36593291e-03 -2.63701619e-02 -9.03073765e-02]
 [-3.15617809e-01 -2.03964706e-01  4.50613215e-01]
 [-2.21072175e-03 -1.45921510e-01  5.64041472e-02]
 [-1.14107418e-01  1.14909375e-01  1.94552599e-02]
 [-1.27911731e-01 -9.38185048e-03 -1.47660344e-01]
 [-4.78658513e-02 -4.54442200e-01 -3.04606346e-01]
 [ 4.98340198e-02 -2.23417343e-02  7.02608719e-03]
 [ 9.32740997e-03 -6.36427983e-02 -2.33580420e-02]
 [ 8.36123506e-02 -1.08125801e-02  5.46695124e-02]
 [-2.35647895e-02  1.03259148e-01  6.82888801e-02]
 [ 1.62638498e-02  1.08927856e-02 -4.16642058e-02]
 [-3.78624833e-01 -9.99771741e-01 -2.31255685e-01]
 [ 9.14889467e-02 -7.88376269e-02 -1.39196687e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.25151208 -29.28467519 -29.2776944 ]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  8.31409947  -9.26062741 -83.52111278]
init_Out:  [2.49223638]
Stock Position:  8.314099471154409
Bond position:  [-828.91771073]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-4.60598421]
curr_Stock_Price:  99.17117117918345
curr_Factors:  [99.17117118 -0.47517385 -0.9810295 ]
mat_Sqrt:  [[23.11875084  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00686515  0.00981869 -0.13022067]
Stock Position:  -0.006865146828001154
Bond Position:  [-3.92515956]


portfolio before change:  [-4.60209845]
curr_Stock_Price:  98.46220279268421
curr_Factors:  [98.46220279 -0.11271658 -1.01069583]
mat_Sqrt:  [[32.01678631  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00253238  0.00200425  0.07620869]
Stock Position:  -0.0025323762851368545
Bond Position:  [-4.3527551]


portfolio before change:  [-4.60156925]
curr_Stock_Price:  97.82346310486805
curr_Factors:  [ 9.78234631e+01 -6.39864353e-02 -1.03575422e+00]
mat_Sqrt:  [[32.57104815  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00181046  0.00718835  0.02678852]
Stock Position:  -0.0018104638688626463
Bond Position:  [-4.4244634]


portfolio before change:  [-4.59748432]
curr_Stock_Price:  94.95614299688877
curr_Factors:  [94.956143   -0.52781668 -1.02969525]
mat_Sqrt:  [[20.0034188   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00335653 -0.045801    0.33275691]
Stock Position:  -0.003356532393329555
Bond Position:  [-4.27876095]


portfolio before change:  [-4.59809004]
curr_Stock_Price:  94.81787494766766
curr_Factors:  [94.81787495 -0.52213888 -1.03061359]
mat_Sqrt:  [[20.06958482  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01039059  0.03254093  0.00816244]
Stock Position:  -0.010390586133743383
Bond Position:  [-3.61287675]


portfolio before change:  [-4.58113461]
curr_Stock_Price:  93.09913065044923
curr_Factors:  [93.09913065 -0.50109969 -0.99635651]
mat_Sqrt:  [[20.82613414  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01574532 -0.122902    0.83606189]
Stock Position:  -0.015745324100302164
Bond Position:  [-3.11525863]


portfolio before change:  [-4.59234439]
curr_Stock_Price:  93.76160433559922
curr_Factors:  [93.76160434 -0.43657647 -0.98036325]
mat_Sqrt:  [[22.732957    0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00051682 -0.00833898 -0.25762181]
Stock Position:  -0.000516820481044111
Bond Position:  [-4.54388647]


portfolio before change:  [-4.5936365]
curr_Stock_Price:  94.06344349519433
curr_Factors:  [94.0634435  -0.44718502 -1.00258982]
mat_Sqrt:  [[22.06945774  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01037194 -0.0644993   1.28547408]
Stock Position:  -0.010371941196981035
Bond Position:  [-3.61801599]


portfolio before change:  [-4.58344785]
curr_Stock_Price:  92.99389723591092
curr_Factors:  [92.99389724 -0.7694968  -0.98186223]
mat_Sqrt:  [[16.13796923  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00034298 -0.04614443  0.16090533]
Stock Position:  0.00034298301798114115
Bond Position:  [-4.61534317]


portfolio before change:  [-4.58494459]
curr_Stock_Price:  91.99453319321572
curr_Factors:  [91.99453319 -0.14945809 -1.00286953]
mat_Sqrt:  [[29.06112972  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00368772  0.03633753  0.05550044]
Stock Position:  -0.003687715626634536
Bond Position:  [-4.24569491]


portfolio before change:  [-4.58910787]
curr_Stock_Price:  92.83562994286427
curr_Factors:  [92.83562994 -0.30563212 -1.03334068]
mat_Sqrt:  [[24.33359029  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00650521 -0.0029668  -0.42123386]
Stock Position:  -0.006505205738741138
Bond Position:  [-3.985193]


portfolio before change:  [-4.59329285]
curr_Stock_Price:  93.32578469439976
curr_Factors:  [93.32578469 -0.46937831 -1.02055068]
mat_Sqrt:  [[21.03457352  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00578937 -0.14370724 -0.86895712]
Stock Position:  -0.005789373777944407
Bond Position:  [-4.052995]


portfolio before change:  [-4.60756131]
curr_Stock_Price:  95.61533849960068
curr_Factors:  [95.6153385  -0.30483867 -1.0728175 ]
mat_Sqrt:  [[24.11121485  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0021024  -0.00706508  0.02004347]
Stock Position:  0.0021023972908154674
Bond Position:  [-4.80858274]


portfolio before change:  [-4.60043747]
curr_Stock_Price:  99.57564353680861
curr_Factors:  [99.57564354 -0.5778956  -1.0805495 ]
mat_Sqrt:  [[18.96267336  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00015379 -0.02012562 -0.06663399]
Stock Position:  0.00015378736750464101
Bond Position:  [-4.61575095]


portfolio before change:  [-4.6016619]
curr_Stock_Price:  99.11820636944837
curr_Factors:  [99.11820637 -0.58964016 -1.08764432]
mat_Sqrt:  [[18.52328631  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00510128 -0.00341924  0.1559569 ]
Stock Position:  0.005101283698003423
Bond Position:  [-5.10729199]


portfolio before change:  [-4.61192976]
curr_Stock_Price:  97.35573382907494
curr_Factors:  [97.35573383 -0.12977385 -1.0864443 ]
mat_Sqrt:  [[28.85125437  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00024121  0.03265341  0.19480917]
Stock Position:  -0.00024121102031926807
Bond Position:  [-4.58844648]


portfolio before change:  [-4.6135101]
curr_Stock_Price:  99.15120031912573
curr_Factors:  [99.15120032 -0.36978122 -1.03620187]
mat_Sqrt:  [[24.30453271  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00033082  0.0034446  -0.11885638]
Stock Position:  0.00033082018166747805
Bond Position:  [-4.64631132]


portfolio before change:  [-4.61404505]
curr_Stock_Price:  101.04579902645989
curr_Factors:  [101.04579903  -0.37030883  -1.07138909]
mat_Sqrt:  [[23.89994013  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01889727 -0.31615558 -0.6597081 ]
Stock Position:  -0.018897273158296937
Bond Position:  [-2.70455498]


portfolio before change:  [-4.5920975]
curr_Stock_Price:  99.84860100227844
curr_Factors:  [99.848601   -0.43823199 -1.0794664 ]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-4.5920975]
Stock Price:  100.78951775654505
PL:  [-5.38161525]
Settle:  Tensor("sub_28:0", shape=(), dtype=float64)
PL:  Tensor("sub_29:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  15
output_Z_Vals[:, i, :]:  [[ 1.19251512e+02 -2.92846752e+01 -2.92776944e+01]
 [ 3.45074112e-02 -6.34249680e-02 -1.40976248e-01]
 [-5.79585492e-02  2.28795236e-02  8.36455657e-02]
 [-4.69064738e-02 -4.27069018e-02 -1.62083052e-01]
 [-9.88296441e-02 -2.41910939e-01  2.15109929e-01]
 [-3.37536410e-02 -5.58076018e-02 -8.36822791e-03]
 [ 3.56521109e-02  1.69647120e-02 -5.08351822e-03]
 [-9.03384405e-02  1.52885165e-01 -8.64524439e-02]
 [-6.69047113e-02 -3.84185517e-02  6.98178797e-02]
 [ 5.01494719e-02  3.84657200e-02 -8.20211465e-03]
 [ 8.52261270e-02  4.62031340e-02 -1.62249740e-02]
 [ 1.37830819e-01 -1.17409111e-02 -1.48803330e-01]
 [ 4.36067964e-02 -1.15736109e-02 -2.55230823e-01]
 [-8.45720117e-02  2.97281712e-02 -3.59999752e-02]
 [-4.66676898e-02 -2.88059968e-02  6.66482496e-02]
 [-1.96103280e-02 -5.36080556e-02  1.14151594e-01]
 [-2.50608473e-02  7.39943763e-02  1.09717841e-01]
 [-1.41413481e-02  5.35999824e-02 -8.85984871e-02]
 [-3.19672645e-01 -8.99438937e-01 -1.16491599e-01]
 [ 6.96332568e-02 -2.86111242e-02 -7.42846829e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.25151208 -29.28467519 -29.2776944 ]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  8.31409947  -9.26062741 -83.52111278]
init_Out:  [2.49223638]
Stock Position:  8.314099471154409
Bond position:  [-828.91771073]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [9.29248928]
curr_Stock_Price:  100.84284632970002
curr_Factors:  [100.84284633  -1.09732342  -1.02360302]
mat_Sqrt:  [[12.09312238  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 3.38467550e-04 -2.00567359e-02 -4.02165995e-01]
Stock Position:  0.0003384675503522315
Bond Position:  [9.25835724]


portfolio before change:  [9.29417284]
curr_Stock_Price:  98.97763058742412
curr_Factors:  [98.97763059 -0.95339506 -1.0158826 ]
mat_Sqrt:  [[13.8130834   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00291707  0.00723514  0.23861752]
Stock Position:  -0.002917069393578644
Bond Position:  [9.58289746]


portfolio before change:  [9.29254071]
curr_Stock_Price:  100.35851991063974
curr_Factors:  [100.35851991  -0.94814     -1.03920175]
mat_Sqrt:  [[13.75506637  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00589559 -0.01350511 -0.46237783]
Stock Position:  -0.0058955895577220765
Bond Position:  [9.88421335]


portfolio before change:  [9.29296094]
curr_Stock_Price:  100.7064302089428
curr_Factors:  [100.70643021  -0.94287943  -1.04243849]
mat_Sqrt:  [[13.83071349  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00442252 -0.07649896  0.61364875]
Stock Position:  -0.0044225214628325375
Bond Position:  [9.73833729]


portfolio before change:  [9.29662178]
curr_Stock_Price:  100.42922320032007
curr_Factors:  [100.4292232   -0.56327389  -1.0218663 ]
mat_Sqrt:  [[20.57986236  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00179315 -0.01764791 -0.02387222]
Stock Position:  -0.001793148264322574
Bond Position:  [9.47670627]


portfolio before change:  [9.29965959]
curr_Stock_Price:  100.05650553983682
curr_Factors:  [100.05650554  -0.32832367  -1.08904136]
mat_Sqrt:  [[24.24887068  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00144553  0.00536471 -0.01450186]
Stock Position:  0.0014455299598452786
Bond Position:  [9.15502492]


portfolio before change:  [9.30175819]
curr_Stock_Price:  99.9247549355563
curr_Factors:  [99.92475494 -0.75163962 -1.13292611]
mat_Sqrt:  [[15.17807163  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00685449  0.04834653 -0.24662476]
Stock Position:  -0.006854493528220526
Bond Position:  [9.98669177]


portfolio before change:  [9.29238627]
curr_Stock_Price:  101.65630486324171
curr_Factors:  [101.65630486  -0.99073662  -1.1936618 ]
mat_Sqrt:  [[11.44095128  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00468887 -0.01214901  0.19917098]
Stock Position:  -0.0046888722563209135
Bond Position:  [9.7690397]


portfolio before change:  [9.29126051]
curr_Stock_Price:  102.41732459220366
curr_Factors:  [102.41732459  -0.76758844  -1.15499489]
mat_Sqrt:  [[14.97635391  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0033031   0.01216393 -0.02339835]
Stock Position:  0.0033031005505958374
Bond Position:  [8.95296579]


portfolio before change:  [9.29246778]
curr_Stock_Price:  102.10511777388695
curr_Factors:  [102.10511777  -0.71457385  -1.13363619]
mat_Sqrt:  [[16.08348239  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00516724  0.01461071 -0.04628533]
Stock Position:  0.005167237776530389
Bond Position:  [8.76486636]


portfolio before change:  [9.29849345]
curr_Stock_Price:  102.84713468091054
curr_Factors:  [102.84713468  -0.99343902  -1.114867  ]
mat_Sqrt:  [[12.49011755  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00857905 -0.0037128  -0.42449448]
Stock Position:  0.008579047988574489
Bond Position:  [8.41616295]


portfolio before change:  [9.29084125]
curr_Stock_Price:  101.70988628598417
curr_Factors:  [101.70988629  -0.96343847  -1.12929982]
mat_Sqrt:  [[12.54580345  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-7.00696977e-04 -3.65989714e-03 -7.28102496e-01]
Stock Position:  -0.0007006969769008577
Bond Position:  [9.36210906]


portfolio before change:  [9.29319322]
curr_Stock_Price:  101.69396646278642
curr_Factors:  [101.69396646  -1.13965678  -1.15581334]
mat_Sqrt:  [[10.24200966  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0088999   0.00940087 -0.10269791]
Stock Position:  -0.008899903513064777
Bond Position:  [10.19825971]


portfolio before change:  [9.29876076]
curr_Stock_Price:  101.35490093386484
curr_Factors:  [101.35490093  -1.3099624   -1.1818025 ]
mat_Sqrt:  [[ 8.38851353  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00403015 -0.00910926  0.1901289 ]
Stock Position:  -0.004030146748164418
Bond Position:  [9.70723588]


portfolio before change:  [9.30031831]
curr_Stock_Price:  101.57066332037186
curr_Factors:  [101.57066332  -1.20786908  -1.18634471]
mat_Sqrt:  [[ 9.26775305  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 2.48886054e-04 -1.69523557e-02  3.25642724e-01]
Stock Position:  0.0002488860538321792
Bond Position:  [9.27503879]


portfolio before change:  [9.3026619]
curr_Stock_Price:  101.66925581437528
curr_Factors:  [101.66925581  -1.05876496  -1.16876322]
mat_Sqrt:  [[10.95939168  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-6.88231754e-05  2.33990763e-02  3.12994461e-01]
Stock Position:  -6.88231754285998e-05
Bond Position:  [9.3096591]


portfolio before change:  [9.30497891]
curr_Stock_Price:  101.82467409047182
curr_Factors:  [101.82467409  -0.74863756  -1.18893901]
mat_Sqrt:  [[14.66811205  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00210269  0.0169498  -0.25274682]
Stock Position:  -0.0021026900299607604
Bond Position:  [9.51908464]


portfolio before change:  [9.30733261]
curr_Stock_Price:  101.83721692564689
curr_Factors:  [101.83721693  -1.23150363  -1.20065889]
mat_Sqrt:  [[ 8.94605904  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0409873  -0.28442757 -0.33231811]
Stock Position:  -0.040987300155956634
Bond Position:  [13.48136518]


portfolio before change:  [9.36933396]
curr_Stock_Price:  100.40675943320134
curr_Factors:  [100.40675943  -1.15958713  -1.13256826]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [9.36933396]
Stock Price:  100.5795529904082
PL:  [8.78978097]
Settle:  Tensor("sub_30:0", shape=(), dtype=float64)
PL:  Tensor("sub_31:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  16
output_Z_Vals[:, i, :]:  [[ 1.19251512e+02 -2.92846752e+01 -2.92776944e+01]
 [-2.19713824e-01  5.99007242e-02  5.12441673e-02]
 [-5.32383689e-02  2.55965727e-02  9.29968654e-02]
 [-2.58264073e-02  4.40867270e-02  7.57074977e-02]
 [-8.95752719e-02 -1.64578436e-01  1.36670882e-01]
 [-1.65633603e-03 -7.74287396e-02 -9.83617001e-04]
 [ 5.50531191e-02  4.27968159e-02 -2.16448116e-02]
 [-9.92690238e-02  1.64253999e-01 -8.47661869e-02]
 [-1.49777384e-01 -7.30625197e-02  1.47324997e-01]
 [ 4.50470017e-02  4.74936917e-02 -1.18045691e-02]
 [ 4.17030837e-02  7.68848149e-02 -1.32383358e-02]
 [ 7.74257935e-02 -9.96946944e-03 -1.22716212e-01]
 [ 5.65679571e-02 -2.97749394e-03 -6.04443535e-02]
 [-8.45720117e-02  2.97281712e-02 -3.59999752e-02]
 [-6.73684882e-02 -1.69555303e-02  8.90501752e-02]
 [ 2.94998448e-02 -6.25269464e-03  8.82849694e-02]
 [-2.66269767e-02  1.07435516e-01  7.41304462e-02]
 [ 3.79588311e-02 -1.58086857e-02  2.28687044e-02]
 [-3.83149450e-01 -9.77126810e-01 -2.36627967e-01]
 [ 1.18003034e-01 -1.34902855e-01 -2.13168837e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.25151208 -29.28467519 -29.2776944 ]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  8.31409947  -9.26062741 -83.52111278]
init_Out:  [2.49223638]
Stock Position:  8.314099471154409
Bond position:  [-828.91771073]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-5.53623334]
curr_Stock_Price:  99.05928303871865
curr_Factors:  [99.05928304 -0.8451657  -0.97115123]
mat_Sqrt:  [[16.10937756  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01289355  0.01894227  0.14618535]
Stock Position:  -0.012893547334497869
Bond Position:  [-4.25900778]


portfolio before change:  [-5.53881535]
curr_Stock_Price:  99.17694878026995
curr_Factors:  [99.17694878 -0.8121018  -0.9754552 ]
mat_Sqrt:  [[16.5991023   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00202388  0.00809435  0.26529417]
Stock Position:  -0.002023878277495878
Bond Position:  [-5.33809328]


portfolio before change:  [-5.53839523]
curr_Stock_Price:  98.30989287796955
curr_Factors:  [98.30989288 -0.96498721 -0.96439099]
mat_Sqrt:  [[14.27837938  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00064674  0.01394145  0.21597242]
Stock Position:  -0.0006467375863747645
Bond Position:  [-5.47481452]


portfolio before change:  [-5.54037278]
curr_Stock_Price:  99.25103966657043
curr_Factors:  [99.25103967 -0.86958758 -0.98611803]
mat_Sqrt:  [[15.5171643   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00424864 -0.05204427  0.38988398]
Stock Position:  -0.004248639801708077
Bond Position:  [-5.11869086]


portfolio before change:  [-5.54425264]
curr_Stock_Price:  99.86300803709975
curr_Factors:  [99.86300804 -0.92686357 -0.99241762]
mat_Sqrt:  [[14.65113991  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00026321 -0.02448512 -0.00280599]
Stock Position:  -0.00026320938084462936
Bond Position:  [-5.51796776]


portfolio before change:  [-5.54610067]
curr_Stock_Price:  101.64245173820161
curr_Factors:  [101.64245174  -0.82041289  -1.02932579]
mat_Sqrt:  [[15.98614803  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00323655  0.01353354 -0.06174662]
Stock Position:  0.003236545748151603
Bond Position:  [-5.87507112]


portfolio before change:  [-5.55114608]
curr_Stock_Price:  100.53743058133354
curr_Factors:  [100.53743058  -0.86507434  -1.02011896]
mat_Sqrt:  [[15.26155325  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00736038  0.05194168 -0.24181434]
Stock Position:  -0.00736037986375063
Bond Position:  [-4.8111524]


portfolio before change:  [-5.54899909]
curr_Stock_Price:  100.08230160549653
curr_Factors:  [100.08230161  -1.09050665  -1.02284691]
mat_Sqrt:  [[12.09315164  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01005456 -0.0231044   0.42027721]
Stock Position:  -0.010054555210254702
Bond Position:  [-4.54271607]


portfolio before change:  [-5.55965849]
curr_Stock_Price:  101.02949138624925
curr_Factors:  [101.02949139  -0.9647885   -1.01272844]
mat_Sqrt:  [[13.98374429  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00313676  0.01501882 -0.03367515]
Stock Position:  0.0031367625923010016
Bond Position:  [-5.87656402]


portfolio before change:  [-5.56149847]
curr_Stock_Price:  100.91132354085114
curr_Factors:  [100.91132354  -1.22312856  -0.97148931]
mat_Sqrt:  [[11.24163485  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00364591  0.02431311 -0.03776529]
Stock Position:  0.003645908945619036
Bond Position:  [-5.92941197]


portfolio before change:  [-5.56041357]
curr_Stock_Price:  101.61552319935633
curr_Factors:  [101.6155232   -1.54145063  -0.96241337]
mat_Sqrt:  [[ 8.30894216  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00627264 -0.00315262 -0.35007519]
Stock Position:  0.006272644591445598
Bond Position:  [-6.19781163]


portfolio before change:  [-5.56050046]
curr_Stock_Price:  101.8487183615457
curr_Factors:  [101.84871836  -1.90250453  -0.92395025]
mat_Sqrt:  [[ 6.03172948  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00732011 -0.00094157 -0.17243092]
Stock Position:  0.007320110532364487
Bond Position:  [-6.30604434]


portfolio before change:  [-5.56327978]
curr_Stock_Price:  101.68443029149245
curr_Factors:  [101.68443029  -1.65382555  -0.9540778 ]
mat_Sqrt:  [[ 7.49301193  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01216505  0.00940087 -0.10269791]
Stock Position:  -0.01216505440610948
Bond Position:  [-4.32628315]


portfolio before change:  [-5.55488471]
curr_Stock_Price:  100.90541431647256
curr_Factors:  [100.90541432  -1.37770162  -0.94041331]
mat_Sqrt:  [[ 9.93504741  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00499534 -0.00536181  0.25403536]
Stock Position:  -0.004995344780728056
Bond Position:  [-5.05082738]


portfolio before change:  [-5.55284602]
curr_Stock_Price:  100.24448804710777
curr_Factors:  [100.24448805  -1.2742139   -0.94685269]
mat_Sqrt:  [[10.8758582   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00435455 -0.00197728  0.25185244]
Stock Position:  0.004354552437316457
Bond Position:  [-5.9893659]


portfolio before change:  [-5.55574655]
curr_Stock_Price:  99.9222957141085
curr_Factors:  [99.92229571 -0.9960361  -0.98714036]
mat_Sqrt:  [[13.75244164  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00063416  0.03397409  0.21147353]
Stock Position:  -0.0006341557298317585
Bond Position:  [-5.49238026]


portfolio before change:  [-5.55595377]
curr_Stock_Price:  98.0835495772188
curr_Factors:  [98.08354958 -0.79602467 -0.96467798]
mat_Sqrt:  [[16.86291803  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00250364 -0.00499915  0.06523805]
Stock Position:  0.0025036418529076183
Bond Position:  [-5.80151985]


portfolio before change:  [-5.55720567]
curr_Stock_Price:  98.16289708517878
curr_Factors:  [98.16289709 -0.21857377 -0.99978149]
mat_Sqrt:  [[29.0283532   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01573221 -0.30899463 -0.67503373]
Stock Position:  -0.015732213066016854
Bond Position:  [-4.01288606]


portfolio before change:  [-5.57664444]
curr_Stock_Price:  99.33472311998882
curr_Factors:  [99.33472312  0.18516931 -0.9719451 ]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-5.57664444]
Stock Price:  93.4005280006899
PL:  [-5.57664444]
Settle:  Tensor("sub_32:0", shape=(), dtype=float64)
PL:  Tensor("sub_33:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  17
output_Z_Vals[:, i, :]:  [[ 1.19251512e+02 -2.92846752e+01 -2.92776944e+01]
 [-3.01946317e-02  3.28407762e-03 -7.04035468e-02]
 [-5.72090408e-02  2.33109586e-02  8.51304407e-02]
 [-6.73976770e-02 -1.13785423e-01 -3.63644721e-01]
 [-9.15470549e-02 -1.81055288e-01  1.53383500e-01]
 [-6.83891171e-02  4.37196228e-02 -1.08191369e-02]
 [-1.15643189e-01 -8.37468801e-02  7.91357598e-02]
 [-5.62922652e-02  1.04582420e-01 -9.44726596e-02]
 [-2.31646738e-01 -1.06872210e-01  2.22895374e-01]
 [ 5.69950616e-02  5.33452549e-02 -9.53051097e-03]
 [-1.19251857e-02  1.07879754e-01 -1.02716323e-03]
 [ 5.33628458e-02 -9.26379788e-03 -1.12324147e-01]
 [ 3.95038592e-02 -5.85133277e-02 -3.23883969e-01]
 [-1.65468749e-02  1.12411063e-02 -4.77481633e-03]
 [ 1.37562859e-02 -5.94351722e-02 -9.75532456e-02]
 [ 1.69066944e-01  3.26938868e-02 -8.31120327e-02]
 [-7.21328110e-03  5.56353263e-02  8.06963294e-02]
 [ 4.38615088e-02 -2.40236005e-02  4.77886912e-02]
 [-2.84399226e-01 -7.36555053e-01 -1.34418519e-01]
 [ 1.33815504e-01 -1.50596698e-01 -2.39874865e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.25151208 -29.28467519 -29.2776944 ]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  8.31409947  -9.26062741 -83.52111278]
init_Out:  [2.49223638]
Stock Position:  8.314099471154409
Bond position:  [-828.91771073]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [3.48868015]
curr_Stock_Price:  100.14477804906687
curr_Factors:  [100.14477805  -0.86387552  -1.02582396]
mat_Sqrt:  [[15.13360005  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00293921  0.00103852 -0.20084172]
Stock Position:  -0.0029392147799932474
Bond Position:  [3.78302716]


portfolio before change:  [3.49301446]
curr_Stock_Price:  98.99194311326622
curr_Factors:  [98.99194311 -0.56924767 -1.04387838]
mat_Sqrt:  [[19.72550391  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00198879  0.00737157  0.24285345]
Stock Position:  -0.0019887946147408796
Bond Position:  [3.6898891]


portfolio before change:  [3.49022135]
curr_Stock_Price:  100.86025839944648
curr_Factors:  [100.8602584   -0.12433181  -1.07829872]
mat_Sqrt:  [[30.29871924  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0047713  -0.03598211 -1.03737717]
Stock Position:  -0.0047712997588669325
Bond Position:  [3.97145588]


portfolio before change:  [3.50423082]
curr_Stock_Price:  98.13217958598183
curr_Factors:  [ 9.81321796e+01 -5.53047628e-02 -1.06771946e+00]
mat_Sqrt:  [[31.9218626   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00203348 -0.05725471  0.43756043]
Stock Position:  -0.002033484305653414
Bond Position:  [3.70378107]


portfolio before change:  [3.50436821]
curr_Stock_Price:  98.52002053676874
curr_Factors:  [98.52002054 -0.52070584 -1.03225983]
mat_Sqrt:  [[20.84875246  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00333203  0.01382536 -0.03086399]
Stock Position:  -0.0033320328654962987
Bond Position:  [3.83264016]


portfolio before change:  [3.50762983]
curr_Stock_Price:  97.82874784631917
curr_Factors:  [97.82874785 -0.73857767 -1.06707172]
mat_Sqrt:  [[16.07988456  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00632169 -0.02648309  0.2257523 ]
Stock Position:  -0.006321687466317252
Bond Position:  [4.1260726]


portfolio before change:  [3.5066719]
curr_Stock_Price:  98.14347169200477
curr_Factors:  [98.14347169 -0.5856466  -1.04925211]
mat_Sqrt:  [[19.13524073  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00380848  0.03307186 -0.2695042 ]
Stock Position:  -0.003808476236946566
Bond Position:  [3.88044898]


portfolio before change:  [3.50443935]
curr_Stock_Price:  98.98443355006363
curr_Factors:  [98.98443355 -0.92191055 -1.01368988]
mat_Sqrt:  [[14.28717347  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0132222  -0.03379596  0.63585846]
Stock Position:  -0.013222198139056835
Bond Position:  [4.81323114]


portfolio before change:  [3.49971442]
curr_Stock_Price:  99.43279931682352
curr_Factors:  [99.43279932 -1.11057016 -0.97924239]
mat_Sqrt:  [[12.30086377  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00458724  0.01686925 -0.0271879 ]
Stock Position:  0.00458724068246168
Bond Position:  [3.04359224]


portfolio before change:  [3.49653763]
curr_Stock_Price:  98.5743779212309
curr_Factors:  [98.57437792 -1.17072227 -0.95320092]
mat_Sqrt:  [[11.78571472  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00079328  0.03411457 -0.00293021]
Stock Position:  -0.0007932833474658985
Bond Position:  [3.57473504]


portfolio before change:  [3.49683876]
curr_Stock_Price:  99.32148177884334
curr_Factors:  [99.32148178 -1.0025497  -0.94440541]
mat_Sqrt:  [[14.17396407  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00213036 -0.00292947 -0.32042953]
Stock Position:  0.0021303556972469685
Bond Position:  [3.28524868]


portfolio before change:  [3.49728086]
curr_Stock_Price:  99.1434274832414
curr_Factors:  [99.14342748 -0.97252374 -0.99486321]
mat_Sqrt:  [[13.86240668  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00202847 -0.01850354 -0.92395081]
Stock Position:  -0.0020284707664646132
Bond Position:  [3.6983904]


portfolio before change:  [3.50135245]
curr_Stock_Price:  97.59207307709563
curr_Factors:  [97.59207308 -1.25837307 -0.99308281]
mat_Sqrt:  [[10.27116431  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00167764  0.00355475 -0.01362122]
Stock Position:  -0.0016776370814230892
Bond Position:  [3.66507653]


portfolio before change:  [3.50402718]
curr_Stock_Price:  96.54396283081931
curr_Factors:  [96.54396283 -1.2082818  -1.01203205]
mat_Sqrt:  [[10.48226333  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00073374 -0.01879505 -0.27829226]
Stock Position:  -0.0007337438728696027
Bond Position:  [3.57486572]


portfolio before change:  [3.50516559]
curr_Stock_Price:  96.21063283368288
curr_Factors:  [96.21063283 -0.98952841 -1.01002079]
mat_Sqrt:  [[13.02656429  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01174108  0.01033871 -0.2370955 ]
Stock Position:  0.011741079251209216
Bond Position:  [2.37554892]


portfolio before change:  [3.5080545]
curr_Stock_Price:  96.40609633072505
curr_Factors:  [96.40609633 -0.94178738 -0.96772232]
mat_Sqrt:  [[14.28285329  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00074882 0.01759343 0.23020417]
Stock Position:  0.0007488199931600062
Bond Position:  [3.43586369]


portfolio before change:  [3.50936749]
curr_Stock_Price:  97.0122757923021
curr_Factors:  [97.01227579 -0.84929957 -1.0142556 ]
mat_Sqrt:  [[15.04856078  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00352167 -0.00759693  0.13632783]
Stock Position:  0.0035216688534869967
Bond Position:  [3.16772238]


portfolio before change:  [3.50692129]
curr_Stock_Price:  96.09275831526513
curr_Factors:  [96.09275832 -0.99030874 -0.98983984]
mat_Sqrt:  [[13.26548278  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02494105 -0.23291916 -0.38345862]
Stock Position:  -0.02494104935777209
Bond Position:  [5.90357552]


portfolio before change:  [3.52122145]
curr_Stock_Price:  95.57858257084477
curr_Factors:  [95.57858257 -0.81551205 -0.94249488]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [3.52122145]
Stock Price:  96.8427613583009
PL:  [3.52122145]
Settle:  Tensor("sub_34:0", shape=(), dtype=float64)
PL:  Tensor("sub_35:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  18
output_Z_Vals[:, i, :]:  [[ 1.19251512e+02 -2.92846752e+01 -2.92776944e+01]
 [-2.20877977e-01  6.99482875e-02  1.23504031e-01]
 [-5.32383689e-02  2.55965727e-02  9.29968654e-02]
 [-5.66597189e-02  2.57270185e-02  1.86283398e-02]
 [-9.00580934e-02 -1.68613047e-01  1.40763224e-01]
 [-8.60545962e-02  5.19032291e-02 -9.82845076e-03]
 [-6.55774655e-02 -3.32079543e-02  4.25185836e-02]
 [-1.00724880e-01  1.50602428e-01 -5.50333680e-02]
 [-1.00251405e-01 -2.67666341e-02  3.94156197e-02]
 [ 5.13944740e-02  3.40378988e-02 -6.65925921e-03]
 [ 1.66082336e-01 -3.86796951e-02 -5.24083010e-02]
 [ 2.45597419e-01 -1.49012814e-02 -1.95344491e-01]
 [ 3.25648733e-02 -4.35499001e-02 -4.92889299e-01]
 [-5.34734654e-02  2.04596639e-02 -2.35761251e-02]
 [ 1.75751920e-02 -6.16508980e-02 -8.01886725e-02]
 [ 1.74426263e-01  3.83619031e-02 -1.04411105e-01]
 [ 4.78477686e-03  2.06909435e-02  8.98004005e-02]
 [ 3.85894990e-02 -1.65561058e-02  2.45216074e-02]
 [-3.61846362e-01 -9.26090975e-01 -2.05737663e-01]
 [ 1.17615497e-01 -1.32470391e-01 -2.10504901e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.25151208 -29.28467519 -29.2776944 ]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  8.31409947  -9.26062741 -83.52111278]
init_Out:  [2.49223638]
Stock Position:  8.314099471154409
Bond position:  [-828.91771073]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-5.48123682]
curr_Stock_Price:  99.06589788788112
curr_Factors:  [99.06589789 -0.98927916 -1.02050297]
mat_Sqrt:  [[13.27660056  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01460176  0.02211959  0.35232262]
Stock Position:  -0.014601762251780974
Bond Position:  [-4.03470014]


portfolio before change:  [-5.48289634]
curr_Stock_Price:  99.11046174450584
curr_Factors:  [99.11046174 -0.74481454 -1.01220153]
mat_Sqrt:  [[17.1024022   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00196432  0.00809435  0.26529417]
Stock Position:  -0.001964318355858342
Bond Position:  [-5.28821184]


portfolio before change:  [-5.48135372]
curr_Stock_Price:  97.65202341854139
curr_Factors:  [97.65202342 -0.33848997 -1.03016416]
mat_Sqrt:  [[24.84747782  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00210053  0.0081356   0.05314147]
Stock Position:  -0.0021005333654178105
Bond Position:  [-5.27623238]


portfolio before change:  [-5.48403234]
curr_Stock_Price:  98.29918956761766
curr_Factors:  [98.29918957 -0.40359276 -1.00781267]
mat_Sqrt:  [[23.96538155  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00274056 -0.05332013  0.4015583 ]
Stock Position:  -0.002740556856470178
Bond Position:  [-5.21463782]


portfolio before change:  [-5.48503474]
curr_Stock_Price:  98.18920732187622
curr_Factors:  [98.18920732 -0.48152038 -1.01815392]
mat_Sqrt:  [[21.91611064  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00395694  0.01641324 -0.02803783]
Stock Position:  -0.0039569377134193685
Bond Position:  [-5.09650617]


portfolio before change:  [-5.48892949]
curr_Stock_Price:  98.85145066940714
curr_Factors:  [98.85145067 -0.33279546 -1.01051844]
mat_Sqrt:  [[25.79818987  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00223875 -0.01050128  0.12129368]
Stock Position:  -0.002238754810777229
Bond Position:  [-5.26762533]


portfolio before change:  [-5.49259644]
curr_Stock_Price:  99.90108991368879
curr_Factors:  [ 9.99010899e+01  6.82532527e-02 -1.01214382e+00]
mat_Sqrt:  [[38.87261527  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00278011  0.04762467 -0.15699488]
Stock Position:  -0.0027801057445341645
Bond Position:  [-5.21486085]


portfolio before change:  [-5.50755218]
curr_Stock_Price:  104.8116432292483
curr_Factors:  [104.81164323  -0.29549926  -1.04335804]
mat_Sqrt:  [[27.4758534   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00338104 -0.00846435  0.11244179]
Stock Position:  -0.003381035524765978
Bond Position:  [-5.15318029]


portfolio before change:  [-5.50090516]
curr_Stock_Price:  102.46458919826313
curr_Factors:  [102.4645892   -0.26717619  -1.03934699]
mat_Sqrt:  [[27.74329209  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00183518  0.01076373 -0.01899701]
Stock Position:  0.001835182825356026
Bond Position:  [-5.68894642]


portfolio before change:  [-5.49912519]
curr_Stock_Price:  104.20958308202052
curr_Factors:  [ 1.04209583e+02 -3.05054718e-02 -1.00116782e+00]
mat_Sqrt:  [[37.14134603  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00415671 -0.01223159 -0.1495063 ]
Stock Position:  0.0041567107128918125
Bond Position:  [-5.93229428]


portfolio before change:  [-5.51334915]
curr_Stock_Price:  101.14449077877086
curr_Factors:  [ 1.01144491e+02  3.76696844e-02 -1.00510113e+00]
mat_Sqrt:  [[38.44077128  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00534168 -0.0047122  -0.55726346]
Stock Position:  0.005341675912627651
Bond Position:  [-6.05363024]


portfolio before change:  [-5.51896533]
curr_Stock_Price:  100.37645895549907
curr_Factors:  [100.37645896  -0.2333203   -0.98747279]
mat_Sqrt:  [[29.61066551  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00233599 -0.01377169 -1.40607598]
Stock Position:  -0.0023359889443388673
Bond Position:  [-5.28448703]


portfolio before change:  [-5.51492708]
curr_Stock_Price:  98.08212694381969
curr_Factors:  [98.08212694 -0.09809221 -0.97387614]
mat_Sqrt:  [[33.57684892  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00172016  0.00646991 -0.06725612]
Stock Position:  -0.0017201630699841992
Bond Position:  [-5.34620983]


portfolio before change:  [-5.51605535]
curr_Stock_Price:  97.96094736350395
curr_Factors:  [ 9.79609474e+01 -7.41582988e-02 -9.50367494e-01]
mat_Sqrt:  [[35.16471305  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-1.09505107e-05 -1.94957257e-02 -2.28755962e-01]
Stock Position:  -1.0950510684888175e-05
Bond Position:  [-5.51498263]


portfolio before change:  [-5.51740996]
curr_Stock_Price:  95.74080392346968
curr_Factors:  [95.74080392 -0.35377016 -0.93292417]
mat_Sqrt:  [[26.44191003  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00582802  0.0121311  -0.29785582]
Stock Position:  0.005828018282830888
Bond Position:  [-6.07538911]


portfolio before change:  [-5.51913837]
curr_Stock_Price:  95.70487793685403
curr_Factors:  [95.70487794 -0.58301929 -0.91300081]
mat_Sqrt:  [[21.43980344  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00110306 0.00654305 0.25617555]
Stock Position:  0.0011030625717763415
Bond Position:  [-5.62470684]


portfolio before change:  [-5.5184069]
curr_Stock_Price:  97.64295793586098
curr_Factors:  [97.64295794 -0.65293113 -0.96969316]
mat_Sqrt:  [[19.27277043  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00223982 -0.0052355   0.06995332]
Stock Position:  0.0022398167670322003
Bond Position:  [-5.73710924]


portfolio before change:  [-5.51871951]
curr_Stock_Price:  98.14382483896895
curr_Factors:  [98.14382484 -0.38939005 -0.94849461]
mat_Sqrt:  [[25.75295395  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0166099  -0.29285568 -0.58691229]
Stock Position:  -0.016609898559516587
Bond Position:  [-3.88856053]


portfolio before change:  [-5.52982938]
curr_Stock_Price:  98.75416060371646
curr_Factors:  [98.7541606  -0.13645733 -0.94914629]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-5.52982938]
Stock Price:  100.76032737803465
PL:  [-6.29015676]
Settle:  Tensor("sub_36:0", shape=(), dtype=float64)
PL:  Tensor("sub_37:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  19
output_Z_Vals[:, i, :]:  [[ 1.19251512e+02 -2.92846752e+01 -2.92776944e+01]
 [-2.29789717e-01  5.36543711e-02  1.03339321e-02]
 [-8.07551334e-02  1.81238826e-02  1.04657600e-01]
 [-3.55642052e-02  9.15794227e-03 -1.55502789e-02]
 [-9.88296441e-02 -2.41910939e-01  2.15109929e-01]
 [-3.91281541e-01  6.93452999e-02  2.08073941e-02]
 [ 5.15213164e-02  1.01557324e-01 -4.46887396e-02]
 [-1.77026755e-01  2.61185978e-01 -6.25872109e-02]
 [-3.33260893e-02  8.61558742e-05 -2.31650949e-02]
 [ 4.26018681e-02  3.01909574e-02 -7.20867074e-03]
 [ 7.59439736e-02  5.26002302e-02 -1.54089455e-02]
 [ 1.42342263e-01 -1.18732140e-02 -1.50751688e-01]
 [ 3.26769049e-02 -8.40059472e-02 -3.38679078e-01]
 [-8.05761085e-02  3.09662608e-02 -2.69590886e-02]
 [ 1.49739709e-02 -6.01416719e-02 -9.20164297e-02]
 [ 1.05498990e-01 -8.13954012e-03  3.03816666e-02]
 [-2.55099998e-02  1.05912125e-01  7.19996508e-02]
 [ 2.39965681e-02  5.05811536e-03 -4.71980829e-02]
 [-3.31280290e-01 -8.62229226e-01 -1.53496033e-01]
 [ 1.00733259e-01 -1.00081956e-01 -1.66652549e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.25151208 -29.28467519 -29.2776944 ]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  8.31409947  -9.26062741 -83.52111278]
init_Out:  [2.49223638]
Stock Position:  8.314099471154409
Bond position:  [-828.91771073]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-2.34678435]
curr_Stock_Price:  99.44290233504329
curr_Factors:  [99.44290234 -1.1559589  -0.94808365]
mat_Sqrt:  [[12.12829412  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01865843  0.016967    0.02947983]
Stock Position:  -0.018658432893375744
Bond Position:  [-0.49133563]


portfolio before change:  [-2.34680356]
curr_Stock_Price:  99.43734754255904
curr_Factors:  [99.43734754 -0.85554859 -0.97676592]
mat_Sqrt:  [[15.91422338  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0037026   0.00573127  0.298559  ]
Stock Position:  -0.0037026018935033688
Bond Position:  [-1.97862664]


portfolio before change:  [-2.34825228]
curr_Stock_Price:  99.6950056778191
curr_Factors:  [99.69500568 -0.86503124 -0.95670351]
mat_Sqrt:  [[16.12516089  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00238769  0.002896   -0.04436062]
Stock Position:  -0.002387693111515041
Bond Position:  [-2.1102112]


portfolio before change:  [-2.35590061]
curr_Stock_Price:  102.67725952727226
curr_Factors:  [102.67725953  -1.26627524  -0.92051765]
mat_Sqrt:  [[11.52821808  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00530582 -0.07649896  0.61364875]
Stock Position:  -0.005305818023552243
Bond Position:  [-1.81111375]


portfolio before change:  [-2.36534076]
curr_Stock_Price:  104.37112116348568
curr_Factors:  [104.37112116  -1.41862737  -0.92291288]
mat_Sqrt:  [[10.0383501   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0383772   0.02192891  0.0593577 ]
Stock Position:  -0.03837719926413035
Bond Position:  [1.64013055]


portfolio before change:  [-2.36256274]
curr_Stock_Price:  104.30941952378193
curr_Factors:  [104.30941952  -1.1891597   -0.90709152]
mat_Sqrt:  [[12.82133341  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00351145  0.03211525 -0.12748454]
Stock Position:  0.003511449471552251
Bond Position:  [-2.72884]


portfolio before change:  [-2.36170091]
curr_Stock_Price:  104.74915886962303
curr_Factors:  [104.74915887  -1.25771092  -0.91939063]
mat_Sqrt:  [[11.87537566  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01541497  0.08259426 -0.17854389]
Stock Position:  -0.01541496689508005
Bond Position:  [-0.7469961]


portfolio before change:  [-2.35138071]
curr_Stock_Price:  104.06755000690133
curr_Factors:  [104.06755001  -1.094357    -0.929781  ]
mat_Sqrt:  [[13.74812164  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-2.76782683e-03  2.72448796e-05 -6.60835677e-02]
Stock Position:  -0.0027678268307011786
Bond Position:  [-2.06333975]


portfolio before change:  [-2.34949168]
curr_Stock_Price:  103.19866422243291
curr_Factors:  [103.19866422  -0.97135176  -0.95205204]
mat_Sqrt:  [[15.07823192  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0027795   0.00954722 -0.02056433]
Stock Position:  0.00277949906254588
Bond Position:  [-2.63633227]


portfolio before change:  [-2.35407649]
curr_Stock_Price:  101.78630906807643
curr_Factors:  [101.78630907  -0.92357743  -0.94622176]
mat_Sqrt:  [[15.69082918  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00472612  0.01663365 -0.04395743]
Stock Position:  0.004726121674664919
Bond Position:  [-2.83513097]


portfolio before change:  [-2.35780792]
curr_Stock_Price:  101.1467650953502
curr_Factors:  [101.1467651   -0.83989829  -0.94670815]
mat_Sqrt:  [[16.94488702  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00656621 -0.00375464 -0.4300526 ]
Stock Position:  0.006566207184958632
Bond Position:  [-3.02195854]


portfolio before change:  [-2.37360151]
curr_Stock_Price:  98.85655399799829
curr_Factors:  [98.856554   -0.8666129  -0.93779686]
mat_Sqrt:  [[16.26897768  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00237413 -0.02656501 -0.96615714]
Stock Position:  -0.002374131764513527
Bond Position:  [-2.13890302]


portfolio before change:  [-2.37517537]
curr_Stock_Price:  99.29421886628307
curr_Factors:  [99.29421887 -0.57936503 -0.96007217]
mat_Sqrt:  [[21.29878748  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00400396  0.00979239 -0.07690678]
Stock Position:  -0.004003963326657532
Bond Position:  [-1.97760496]


portfolio before change:  [-2.36713152]
curr_Stock_Price:  97.16175186119588
curr_Factors:  [97.16175186 -0.77016934 -0.93368426]
mat_Sqrt:  [[17.68158201  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00030323 -0.01901847 -0.26249726]
Stock Position:  -0.0003032339225417569
Bond Position:  [-2.33766878]


portfolio before change:  [-2.36817302]
curr_Stock_Price:  98.66886723565463
curr_Factors:  [98.66886724 -0.77747665 -0.95801681]
mat_Sqrt:  [[17.39662123  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00640874 -0.00257395  0.08667044]
Stock Position:  0.006408742148842578
Bond Position:  [-3.00051634]


portfolio before change:  [-2.36297334]
curr_Stock_Price:  99.59727037843167
curr_Factors:  [99.59727038 -0.94132663 -0.97672197]
mat_Sqrt:  [[14.63017471  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00055218  0.03349235  0.20539496]
Stock Position:  -0.000552180236576699
Bond Position:  [-2.3079777]


portfolio before change:  [-2.36394549]
curr_Stock_Price:  100.31275646766973
curr_Factors:  [100.31275647  -1.17901115  -0.98413949]
mat_Sqrt:  [[11.53218973  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00125673  0.00159952 -0.13464299]
Stock Position:  0.0012567344222586267
Bond Position:  [-2.49001198]


portfolio before change:  [-2.36585581]
curr_Stock_Price:  99.28808126076704
curr_Factors:  [99.28808126 -0.78755878 -0.97582127]
mat_Sqrt:  [[17.02436386  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02260732 -0.27266082 -0.43788146]
Stock Position:  -0.022607317548954356
Bond Position:  [-0.12121863]


portfolio before change:  [-2.35177281]
curr_Stock_Price:  98.6638006615801
curr_Factors:  [98.66380066 -0.77323142 -0.96415623]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-2.35177281]
Stock Price:  98.21547933578121
PL:  [-2.35177281]
Settle:  Tensor("sub_38:0", shape=(), dtype=float64)
PL:  Tensor("sub_39:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  20
output_Z_Vals[:, i, :]:  [[ 1.19251512e+02 -2.92846752e+01 -2.92776944e+01]
 [-1.29178263e-01  5.16592263e-02  1.05252840e-01]
 [-2.25456776e-01 -2.11725446e-02  1.65977580e-01]
 [-6.55822303e-02 -1.15392661e-01 -3.67802953e-01]
 [-9.88296441e-02 -2.41910939e-01  2.15109929e-01]
 [-3.25312709e-01  9.01446161e-02 -3.52549854e-03]
 [ 5.52731693e-02  3.91357206e-02 -2.02090511e-02]
 [-6.59049443e-02  1.18136611e-01 -8.62768613e-02]
 [-3.32573381e-01 -1.63853805e-01  3.52882043e-01]
 [ 4.96397281e-02  3.95350725e-02  6.85897110e-04]
 [ 5.81453700e-03  9.62395440e-02  4.50610664e-04]
 [-2.24593734e-02 -9.22353485e-03 -1.09796480e-01]
 [ 2.15713658e-02 -1.41603601e-01 -2.77239064e-01]
 [-1.59664366e-03  6.30070509e-03 -6.86950679e-04]
 [ 1.11348156e-02 -5.79141975e-02 -1.09473076e-01]
 [ 1.92767919e-01  5.95720427e-02 -1.82542648e-01]
 [-2.41202214e-02 -7.83552914e-02 -2.41135521e-02]
 [ 4.16196696e-02 -2.49874608e-02  6.99696018e-02]
 [-3.27541790e-01 -8.28199595e-01 -1.68446350e-01]
 [ 1.12765064e-01 -1.76044513e-01 -3.29761601e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.25151208 -29.28467519 -29.2776944 ]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  8.31409947  -9.26062741 -83.52111278]
init_Out:  [2.49223638]
Stock Position:  8.314099471154409
Bond position:  [-828.91771073]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-8.34597299]
curr_Stock_Price:  98.72133427295257
curr_Factors:  [98.72133427 -0.51756212 -1.02966202]
mat_Sqrt:  [[21.01164775  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00506194  0.01633608  0.30025706]
Stock Position:  -0.0050619438877221095
Bond Position:  [-7.84625114]


portfolio before change:  [-8.35798271]
curr_Stock_Price:  100.7063239811495
curr_Factors:  [100.70632398  -0.49151978  -1.01111891]
mat_Sqrt:  [[22.41140334  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00857257 -0.00669535  0.47348784]
Stock Position:  -0.008572574164400212
Bond Position:  [-7.49467028]


portfolio before change:  [-8.36342335]
curr_Stock_Price:  101.12238804930496
curr_Factors:  [101.12238805  -0.42857989  -0.97771797]
mat_Sqrt:  [[24.77992084  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00579659 -0.03649036 -1.04923945]
Stock Position:  -0.005796593151015722
Bond Position:  [-7.77725801]


portfolio before change:  [-8.37627384]
curr_Stock_Price:  103.00382551781924
curr_Factors:  [103.00382552  -0.52547001  -0.95144937]
mat_Sqrt:  [[23.51989698  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00260063 -0.07649896  0.61364875]
Stock Position:  -0.002600633297865118
Bond Position:  [-8.10839866]


portfolio before change:  [-8.37835119]
curr_Stock_Price:  103.0230507559342
curr_Factors:  [103.02305076  -0.39657708  -0.93369922]
mat_Sqrt:  [[27.23972701  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01188356  0.02850623 -0.01005727]
Stock Position:  -0.011883556108721206
Bond Position:  [-7.15407098]


portfolio before change:  [-8.35370585]
curr_Stock_Price:  100.79862624775532
curr_Factors:  [100.79862625  -0.32490562  -0.94273511]
mat_Sqrt:  [[28.37430533  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00183823  0.0123758  -0.0576508 ]
Stock Position:  0.0018382298143329928
Bond Position:  [-8.53899689]


portfolio before change:  [-8.35972675]
curr_Stock_Price:  98.68470239891516
curr_Factors:  [98.6847024  -0.49620031 -0.92100564]
mat_Sqrt:  [[23.92021681  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00336393  0.03735808 -0.24612387]
Stock Position:  -0.0033639268985548817
Bond Position:  [-8.02775862]


portfolio before change:  [-8.35697406]
curr_Stock_Price:  97.26972472689897
curr_Factors:  [97.26972473 -0.31181602 -0.92632905]
mat_Sqrt:  [[28.2005849   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00938889 -0.05181512  1.00667424]
Stock Position:  -0.0093888947110057
Bond Position:  [-7.44371885]


portfolio before change:  [-8.36465208]
curr_Stock_Price:  97.88927206845983
curr_Factors:  [97.88927207 -0.7093661  -0.90762687]
mat_Sqrt:  [[19.43049994  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00261447 0.01250209 0.00195667]
Stock Position:  0.002614473513751009
Bond Position:  [-8.62058099]


portfolio before change:  [-8.3664478]
curr_Stock_Price:  98.02685035259807
curr_Factors:  [98.02685035 -0.82805701 -0.92565229]
mat_Sqrt:  [[16.97144322  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00049444 0.03043362 0.00128547]
Stock Position:  0.0004944430327022875
Bond Position:  [-8.4149165]


portfolio before change:  [-8.36875466]
curr_Stock_Price:  97.61655691885451
curr_Factors:  [97.61655692 -0.97978523 -0.92041693]
mat_Sqrt:  [[14.59742234  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00309025 -0.00291674 -0.3132188 ]
Stock Position:  -0.003090246727304754
Bond Position:  [-8.06709542]


portfolio before change:  [-8.37126682]
curr_Stock_Price:  97.77678226643164
curr_Factors:  [97.77678227 -1.00660332 -0.93187214]
mat_Sqrt:  [[14.07234734  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00274837 -0.04477899 -0.79088588]
Stock Position:  -0.002748369521084166
Bond Position:  [-8.1025401]


portfolio before change:  [-8.37107009]
curr_Stock_Price:  96.96807745631132
curr_Factors:  [96.96807746 -0.88662824 -0.94935641]
mat_Sqrt:  [[15.46218197  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00010181  0.00199246 -0.00195968]
Stock Position:  -0.00010180861785881817
Bond Position:  [-8.36119791]


portfolio before change:  [-8.37304204]
curr_Stock_Price:  95.80304281842326
curr_Factors:  [95.80304282 -0.74170401 -0.96127985]
mat_Sqrt:  [[17.44949283  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00072819 -0.01831408 -0.31229621]
Stock Position:  -0.0007281942683191302
Bond Position:  [-8.30327882]


portfolio before change:  [-8.37183186]
curr_Stock_Price:  91.29015540730978
curr_Factors:  [91.29015541 -0.75190647 -0.95698518]
mat_Sqrt:  [[16.52957672  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00950083  0.01883833 -0.52074336]
Stock Position:  0.009500830108749409
Bond Position:  [-9.23916412]


portfolio before change:  [-8.39075139]
curr_Stock_Price:  89.54194538130848
curr_Factors:  [89.54194538 -0.71543454 -0.98340778]
mat_Sqrt:  [[16.37678616  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00189692 -0.02477812 -0.06878925]
Stock Position:  -0.0018969231370261146
Bond Position:  [-8.2208972]


portfolio before change:  [-8.3971843]
curr_Stock_Price:  91.84959044566004
curr_Factors:  [91.84959045 -0.96316427 -1.024837  ]
mat_Sqrt:  [[12.58053878  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00439226 -0.00790173  0.1996038 ]
Stock Position:  0.00439225872653585
Bond Position:  [-8.80061146]


portfolio before change:  [-8.39554071]
curr_Stock_Price:  92.72476976109135
curr_Factors:  [92.72476976 -0.84692352 -1.04937867]
mat_Sqrt:  [[13.92009455  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02753643 -0.26189971 -0.48053055]
Stock Position:  -0.027536434977971706
Bond Position:  [-5.84223112]


portfolio before change:  [-8.38381136]
curr_Stock_Price:  92.24576490403075
curr_Factors:  [92.2457649  -1.20695727 -1.06468442]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-8.38381136]
Stock Price:  93.03611311517821
PL:  [-8.38381136]
Settle:  Tensor("sub_40:0", shape=(), dtype=float64)
PL:  Tensor("sub_41:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  21
output_Z_Vals[:, i, :]:  [[ 1.19251512e+02 -2.92846752e+01 -2.92776944e+01]
 [ 3.61760358e-02 -1.33235346e-02  1.95790520e-02]
 [-1.58081354e-01 -2.33440552e-02  7.92856853e-02]
 [-4.77746199e-02  3.12571085e-02  3.56828544e-02]
 [-8.43923220e-02 -1.21268044e-01  9.27407655e-02]
 [-5.46607964e-02  2.02167398e-02 -1.68160861e-02]
 [-6.19994885e-02 -2.33611196e-02  3.64613432e-02]
 [-4.85639161e-02  8.14607752e-02 -1.07339321e-01]
 [-2.58517715e-01 -1.17234252e-01  2.45930309e-01]
 [ 4.50470017e-02  4.74936917e-02 -1.18045691e-02]
 [ 3.28959957e-02  8.56034470e-02 -1.21459742e-02]
 [ 1.47453307e-01 -1.20231008e-02 -1.52958994e-01]
 [ 4.17030131e-02 -4.55030928e-02 -3.40239245e-01]
 [-8.14964625e-02  3.06810985e-02 -2.90414255e-02]
 [-8.08736835e-02  3.59490197e-04  1.24277064e-01]
 [-1.74303774e-02 -5.97176353e-02  1.14631352e-01]
 [-2.56066730e-02  8.12593392e-02  1.02724314e-01]
 [ 1.52951930e-02  1.64363447e-02 -7.82637286e-02]
 [-3.31208987e-01 -8.89948132e-01 -1.58184528e-01]
 [ 8.57156006e-02 -6.55699157e-02 -1.22049689e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.25151208 -29.28467519 -29.2776944 ]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  8.31409947  -9.26062741 -83.52111278]
init_Out:  [2.49223638]
Stock Position:  8.314099471154409
Bond position:  [-828.91771073]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [5.68923922]
curr_Stock_Price:  100.40945603041591
curr_Factors:  [100.40945603  -0.81035754  -1.00731273]
mat_Sqrt:  [[16.30686394  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00244244 -0.00421327  0.05585359]
Stock Position:  0.0024424427041024738
Bond Position:  [5.44399487]


portfolio before change:  [5.68461199]
curr_Stock_Price:  97.95765095201249
curr_Factors:  [97.95765095 -0.41276326 -0.99248056]
mat_Sqrt:  [[24.02972073  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00593016 -0.00738204  0.22617999]
Stock Position:  -0.005930155138683826
Bond Position:  [6.26551606]


portfolio before change:  [5.68801371]
curr_Stock_Price:  97.64819158288311
curr_Factors:  [97.64819158 -0.6426538  -0.99146716]
mat_Sqrt:  [[19.05348787  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00208276  0.00988437  0.10179325]
Stock Position:  -0.002082759492562845
Bond Position:  [5.89139141]


portfolio before change:  [5.69286288]
curr_Stock_Price:  96.02719702109677
curr_Factors:  [96.02719702 -0.52276096 -0.9835428 ]
mat_Sqrt:  [[21.29192067  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00322154 -0.03834832  0.26456359]
Stock Position:  -0.003221542154054111
Bond Position:  [6.00221855]


portfolio before change:  [5.68428364]
curr_Stock_Price:  99.15612788303483
curr_Factors:  [99.15612788 -0.54093138 -0.98151657]
mat_Sqrt:  [[21.63360098  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0026612   0.00639309 -0.04797161]
Stock Position:  -0.0026612015127998106
Bond Position:  [5.94815808]


portfolio before change:  [5.68678213]
curr_Stock_Price:  98.7761278674764
curr_Factors:  [98.77612787 -0.82961834 -0.98600204]
mat_Sqrt:  [[16.07452261  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00343152 -0.00738743  0.10401406]
Stock Position:  -0.0034315189866980867
Bond Position:  [6.02573428]


portfolio before change:  [5.69122693]
curr_Stock_Price:  97.91989294807132
curr_Factors:  [97.91989295 -0.9488052  -1.00269635]
mat_Sqrt:  [[13.91055874  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00491505  0.02576016 -0.3062092 ]
Stock Position:  -0.004915054544433583
Bond Position:  [6.17250855]


portfolio before change:  [5.68846125]
curr_Stock_Price:  98.79658726240683
curr_Factors:  [98.79658726 -0.79798962 -0.9487195 ]
mat_Sqrt:  [[17.22486434  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01226973 -0.03707273  0.70157072]
Stock Position:  -0.012269726615603086
Bond Position:  [6.90066837]


portfolio before change:  [5.67473532]
curr_Stock_Price:  100.05589134281925
curr_Factors:  [100.05589134  -0.66782387  -0.9490469 ]
mat_Sqrt:  [[19.86298955  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00220831  0.01501882 -0.03367515]
Stock Position:  0.0022083123932510927
Bond Position:  [5.45378065]


portfolio before change:  [5.67496801]
curr_Stock_Price:  99.54377034752265
curr_Factors:  [99.54377035 -0.66618318 -0.87820791]
mat_Sqrt:  [[21.24680129  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00153562  0.02707019 -0.03464908]
Stock Position:  0.0015356184768822356
Bond Position:  [5.52210676]


portfolio before change:  [5.67937867]
curr_Stock_Price:  101.51689345201292
curr_Factors:  [101.51689345  -0.91848589  -0.88282879]
mat_Sqrt:  [[16.75858297  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00691707 -0.00380204 -0.43634943]
Stock Position:  0.006917067396283406
Bond Position:  [4.97717948]


portfolio before change:  [5.66630934]
curr_Stock_Price:  99.44755007859163
curr_Factors:  [99.44755008 -0.90696534 -0.87143801]
mat_Sqrt:  [[16.79744885  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00172186 -0.01438934 -0.97060786]
Stock Position:  -0.0017218636615370872
Bond Position:  [5.83754446]


portfolio before change:  [5.66657245]
curr_Stock_Price:  100.14241099486539
curr_Factors:  [100.14241099  -1.14979163  -0.8338994 ]
mat_Sqrt:  [[13.775646    0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0062888   0.00970222 -0.0828471 ]
Stock Position:  -0.0062888038845407895
Bond Position:  [6.29634843]


portfolio before change:  [5.66165276]
curr_Stock_Price:  101.17503510937988
curr_Factors:  [101.17503511  -1.19302087  -0.86874853]
mat_Sqrt:  [[12.87236346  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-4.31128691e-03  1.13680782e-04  3.54527871e-01]
Stock Position:  -0.004311286908801526
Bond Position:  [6.09784737]


portfolio before change:  [5.66098357]
curr_Stock_Price:  101.68389538303846
curr_Factors:  [101.68389538  -1.34120388  -0.87859073]
mat_Sqrt:  [[11.04606571  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00040075 -0.01888437  0.32701134]
Stock Position:  0.0004007532458384588
Bond Position:  [5.62023342]


portfolio before change:  [5.66235371]
curr_Stock_Price:  101.5963140242391
curr_Factors:  [101.59631402  -1.3359787   -0.89240427]
mat_Sqrt:  [[10.94217162  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-2.32134283e-04  2.56964593e-02  2.93043873e-01]
Stock Position:  -0.00023213428343250836
Bond Position:  [5.6859377]


portfolio before change:  [5.66391269]
curr_Stock_Price:  101.00477887263358
curr_Factors:  [101.00477887  -1.15989726  -0.90138694]
mat_Sqrt:  [[12.85693845  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-1.99066922e-05  5.19762856e-03 -2.23264633e-01]
Stock Position:  -1.9906692174822442e-05
Bond Position:  [5.66592336]


portfolio before change:  [5.66531556]
curr_Stock_Price:  101.69746898125847
curr_Factors:  [101.69746898  -0.79026985  -0.90927047]
mat_Sqrt:  [[18.58699415  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02079285 -0.28142631 -0.45125643]
Stock Position:  -0.020792852666872863
Bond Position:  [7.77989604]


portfolio before change:  [5.67252434]
curr_Stock_Price:  101.44432591721741
curr_Factors:  [101.44432592  -1.00500722  -0.88551813]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [5.67252434]
Stock Price:  101.0212670896313
PL:  [4.65125725]
Settle:  Tensor("sub_42:0", shape=(), dtype=float64)
PL:  Tensor("sub_43:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  22
output_Z_Vals[:, i, :]:  [[ 1.19251512e+02 -2.92846752e+01 -2.92776944e+01]
 [-1.09455609e-01  7.17464894e-03 -8.22552254e-02]
 [-1.15735244e-01 -6.81467742e-03  2.86857798e-02]
 [-2.52467927e-02  4.30380777e-02  7.32516190e-02]
 [-8.70103541e-02 -1.43145160e-01  1.14930919e-01]
 [-8.27790139e-02  4.11957437e-02 -2.85462977e-03]
 [-1.83325829e-01 -1.66416441e-01  1.36554141e-01]
 [-4.85437781e-02  8.57829087e-02 -1.00547456e-01]
 [-3.07812193e-01 -1.54051091e-01  3.31043822e-01]
 [ 4.62560766e-02  3.64075806e-02  1.68985188e-03]
 [ 3.68958148e-02  8.36213673e-02 -1.22149091e-02]
 [ 6.59757903e-02 -1.05095496e-02 -1.40914456e-01]
 [-5.47778474e-02 -4.40898192e-01 -4.95815408e-01]
 [ 1.18286974e-01 -8.99522309e-02 -1.71966747e-02]
 [ 1.11348156e-02 -5.79141975e-02 -1.09473076e-01]
 [ 2.05525442e-01  6.92799276e-02 -2.28908617e-01]
 [ 2.25003301e-02 -3.67967667e-02  1.13386076e-01]
 [-1.05486206e-02  4.51923722e-02 -9.80546623e-02]
 [-3.54897975e-01 -1.04657964e+00 -2.69879142e-01]
 [ 1.31274097e-01 -1.28648246e-01 -2.16520961e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.25151208 -29.28467519 -29.2776944 ]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  8.31409947  -9.26062741 -83.52111278]
init_Out:  [2.49223638]
Stock Position:  8.314099471154409
Bond position:  [-828.91771073]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [1.80321729]
curr_Stock_Price:  99.94205460746645
curr_Factors:  [99.94205461 -1.16937792 -0.99890583]
mat_Sqrt:  [[11.43074687  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01102821  0.00226882 -0.23465126]
Stock Position:  -0.011028206575386126
Bond Position:  [2.90539892]


portfolio before change:  [1.82353196]
curr_Stock_Price:  98.16586147370207
curr_Factors:  [98.16586147 -1.24185    -0.96110151]
mat_Sqrt:  [[10.84503104  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01014803 -0.00215499  0.08183255]
Stock Position:  -0.010148033424634325
Bond Position:  [2.8197224]


portfolio before change:  [1.82377849]
curr_Stock_Price:  98.21104147286337
curr_Factors:  [98.21104147 -1.09403761 -0.94638039]
mat_Sqrt:  [[12.76491835  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0007194   0.01360984  0.20896648]
Stock Position:  -0.000719403758069545
Bond Position:  [1.89443188]


portfolio before change:  [1.82476796]
curr_Stock_Price:  97.49405478984043
curr_Factors:  [97.49405479 -0.54349395 -0.96227094]
mat_Sqrt:  [[21.62881616  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0031091  -0.04526647  0.32786592]
Stock Position:  -0.0031091008457244445
Bond Position:  [2.12788681]


portfolio before change:  [1.82620846]
curr_Stock_Price:  97.20186053176795
curr_Factors:  [97.20186053 -0.93365426 -0.97123376]
mat_Sqrt:  [[14.4674577   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00568849  0.01302724 -0.00814346]
Stock Position:  -0.0056884937879549576
Bond Position:  [2.37914064]


portfolio before change:  [1.83002619]
curr_Stock_Price:  96.63530006143039
curr_Factors:  [96.63530006 -0.54829536 -0.96507407]
mat_Sqrt:  [[21.27589345  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00750844 -0.0526255   0.38955096]
Stock Position:  -0.007508436063531546
Bond Position:  [2.55560617]


portfolio before change:  [1.82162714]
curr_Stock_Price:  97.83901759820507
curr_Factors:  [97.8390176  -0.72739869 -0.97099638]
mat_Sqrt:  [[17.9022854   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00373433  0.02712694 -0.2868339 ]
Stock Position:  -0.0037343297129174436
Bond Position:  [2.18699029]


portfolio before change:  [1.82379292]
curr_Stock_Price:  97.40548215994616
curr_Factors:  [97.40548216 -0.48280124 -0.94437134]
mat_Sqrt:  [[23.37600156  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01044728 -0.04871523  0.94437588]
Stock Position:  -0.010447284459918015
Bond Position:  [2.8414157]


portfolio before change:  [1.82431356]
curr_Stock_Price:  97.4236499807462
curr_Factors:  [97.42364998 -0.12522642 -0.99067121]
mat_Sqrt:  [[31.91803979  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00148947 0.01151309 0.00482068]
Stock Position:  0.0014894729172377924
Bond Position:  [1.67920367]


portfolio before change:  [1.82758192]
curr_Stock_Price:  99.33607565934574
curr_Factors:  [99.33607566 -0.22998246 -0.95218872]
mat_Sqrt:  [[30.45766307  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00120041  0.0264434  -0.03484574]
Stock Position:  0.0012004056660056236
Bond Position:  [1.70833833]


portfolio before change:  [1.82476763]
curr_Stock_Price:  96.6358029049624
curr_Factors:  [ 9.66358029e+01  1.13904217e-02 -9.09383379e-01]
mat_Sqrt:  [[39.36811976  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00093833 -0.00332341 -0.40198972]
Stock Position:  0.0009383326496662403
Bond Position:  [1.7340911]


portfolio before change:  [1.82313342]
curr_Stock_Price:  94.43211882843545
curr_Factors:  [94.43211883  0.21264715 -0.87969227]
mat_Sqrt:  [[48.46472151  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00345343 -0.13942425 -1.41442335]
Stock Position:  -0.0034534333608903225
Bond Position:  [2.14924845]


portfolio before change:  [1.83297473]
curr_Stock_Price:  91.73800824403995
curr_Factors:  [91.73800824 -0.21243367 -0.83845185]
mat_Sqrt:  [[32.07417741  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00350607 -0.02844539 -0.04905733]
Stock Position:  0.0035060653180630764
Bond Position:  [1.51133528]


portfolio before change:  [1.82444075]
curr_Stock_Price:  89.19616766505932
curr_Factors:  [ 8.91961677e+01  4.61224644e-02 -8.52517022e-01]
mat_Sqrt:  [[39.8229555   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00031908 -0.01831408 -0.31229621]
Stock Position:  -0.000319077790729746
Bond Position:  [1.85290127]


portfolio before change:  [1.82479211]
curr_Stock_Price:  89.54696155231228
curr_Factors:  [89.54696155  0.35829361 -0.81476907]
mat_Sqrt:  [[56.72912431  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00283079  0.02190824 -0.65301257]
Stock Position:  0.0028307940313535536
Bond Position:  [1.5713031]


portfolio before change:  [1.83727431]
curr_Stock_Price:  93.81760998342995
curr_Factors:  [93.81760998  0.51843835 -0.79090383]
mat_Sqrt:  [[71.44208344  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00062561 -0.01163616  0.32345891]
Stock Position:  0.0006256127383700381
Bond Position:  [1.77858082]


portfolio before change:  [1.84131091]
curr_Stock_Price:  99.55901574645611
curr_Factors:  [99.55901575  0.32431339 -0.76309279]
mat_Sqrt:  [[64.19794474  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00045791  0.01429108 -0.27972266]
Stock Position:  -0.0004579131443970996
Bond Position:  [1.88690029]


portfolio before change:  [1.83914701]
curr_Stock_Price:  105.31486242099328
curr_Factors:  [ 1.05314862e+02  9.00994372e-02 -7.60481161e-01]
mat_Sqrt:  [[53.86995108  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0081123  -0.33095754 -0.76989007]
Stock Position:  -0.00811230352563982
Bond Position:  [2.69349314]


portfolio before change:  [1.84849882]
curr_Stock_Price:  104.24508645082508
curr_Factors:  [104.24508645   0.22041695  -0.80071641]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [1.84849882]
Stock Price:  104.33986513998748
PL:  [-2.49136632]
Settle:  Tensor("sub_44:0", shape=(), dtype=float64)
PL:  Tensor("sub_45:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  23
output_Z_Vals[:, i, :]:  [[ 1.19251512e+02 -2.92846752e+01 -2.92776944e+01]
 [ 2.97437821e-02 -8.64630358e-03 -7.53859822e-03]
 [-2.59418078e-01 -3.03953689e-02  1.80369305e-01]
 [-5.86761778e-02 -1.37129527e-01 -4.32067148e-01]
 [-9.88296441e-02 -2.41910939e-01  2.15109929e-01]
 [-5.06326214e-01  1.58601365e-01  6.18013994e-03]
 [ 5.10615817e-02  1.09206178e-01 -4.76883669e-02]
 [-1.88202935e-01  2.71915404e-01 -5.27054676e-02]
 [-2.41008533e-02  3.06997659e-03 -3.15531366e-02]
 [ 5.13586915e-02  3.41651586e-02 -6.70360231e-03]
 [ 1.07966106e-01  2.60387698e-02 -2.13635868e-02]
 [ 1.71972347e-01 -1.27421478e-02 -1.63548032e-01]
 [ 8.07610647e-03 -1.65410513e-01 -4.58340868e-01]
 [-4.09752600e-02  1.54658895e-02 -2.31780635e-02]
 [ 1.11348156e-02 -5.79141975e-02 -1.09473076e-01]
 [ 1.60658465e-01  1.82836553e-02 -4.15232813e-02]
 [-2.43017319e-02  6.38905187e-02  1.19444196e-01]
 [-4.40500259e-02  9.11924590e-02 -9.95619273e-02]
 [-3.86568580e-01 -1.01798662e+00 -2.54474538e-01]
 [ 1.39148398e-01 -1.63581220e-01 -2.56429044e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.25151208 -29.28467519 -29.2776944 ]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  8.31409947  -9.26062741 -83.52111278]
init_Out:  [2.49223638]
Stock Position:  8.314099471154409
Bond position:  [-828.91771073]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [5.47758449]
curr_Stock_Price:  100.38399870659443
curr_Factors:  [100.38399871  -0.7887947   -1.00420806]
mat_Sqrt:  [[16.70987833  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00167456 -0.0027342  -0.02150552]
Stock Position:  0.0016745619007080353
Bond Position:  [5.30948528]


portfolio before change:  [5.47927178]
curr_Stock_Price:  100.59882770154577
curr_Factors:  [100.5988277   -0.79099896  -1.02422895]
mat_Sqrt:  [[16.37756971  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0136397  -0.00961186  0.51454342]
Stock Position:  -0.013639700923943782
Bond Position:  [6.8514097]


portfolio before change:  [5.46758523]
curr_Stock_Price:  101.58122534298559
curr_Factors:  [101.58122534  -0.77534624  -1.02190311]
mat_Sqrt:  [[16.83751404  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00893316 -0.04336416 -1.23256731]
Stock Position:  -0.008933158646443437
Bond Position:  [6.37502643]


portfolio before change:  [5.45222566]
curr_Stock_Price:  103.47904574948578
curr_Factors:  [103.47904575  -0.71685315  -1.04694865]
mat_Sqrt:  [[17.73548326  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00344883 -0.07649896  0.61364875]
Stock Position:  -0.0034488277735475986
Bond Position:  [5.80910707]


portfolio before change:  [5.44820806]
curr_Stock_Price:  105.06510718411651
curr_Factors:  [105.06510718  -1.12003112  -1.05072419]
mat_Sqrt:  [[11.9870262   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.04179265  0.05015416  0.01763022]
Stock Position:  -0.04179265319474458
Bond Position:  [9.83915765]


portfolio before change:  [5.45255687]
curr_Stock_Price:  105.01991477163529
curr_Factors:  [105.01991477  -0.95465728  -1.04750952]
mat_Sqrt:  [[14.18213665  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00311285  0.03453403 -0.13604164]
Stock Position:  0.003112854363336726
Bond Position:  [5.12564517]


portfolio before change:  [5.45386543]
curr_Stock_Price:  105.02858542925853
curr_Factors:  [105.02858543  -1.03802725  -1.05631421]
mat_Sqrt:  [[12.93440868  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01483953  0.0859872  -0.15035403]
Stock Position:  -0.014839531740601384
Bond Position:  [7.01244046]


portfolio before change:  [5.46157153]
curr_Stock_Price:  104.62744316354923
curr_Factors:  [104.62744316  -0.95879756  -1.02292187]
mat_Sqrt:  [[14.4210141   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00211236  0.00097081 -0.09001232]
Stock Position:  -0.0021123579582034524
Bond Position:  [5.68258214]


portfolio before change:  [5.4672252]
curr_Stock_Price:  102.62359149287774
curr_Factors:  [102.62359149  -0.96627923  -1.01836163]
mat_Sqrt:  [[14.10355629  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00360707  0.01080397 -0.01912351]
Stock Position:  0.0036070664683226427
Bond Position:  [5.09705509]


portfolio before change:  [5.46871432]
curr_Stock_Price:  102.6831128982439
curr_Factors:  [102.6831129   -0.98861266  -1.0038547 ]
mat_Sqrt:  [[14.00172187  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00744748  0.00823418 -0.06094437]
Stock Position:  0.007447484076734618
Bond Position:  [4.70398347]


portfolio before change:  [5.45596445]
curr_Stock_Price:  100.81321711077094
curr_Factors:  [100.81321711  -0.47842858  -1.02106039]
mat_Sqrt:  [[22.50596775  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00614323 -0.00402942 -0.46655701]
Stock Position:  0.0061432259105601
Bond Position:  [4.83664608]


portfolio before change:  [5.44079055]
curr_Stock_Price:  98.14634346977643
curr_Factors:  [98.14634347 -0.29957919 -0.96862634]
mat_Sqrt:  [[27.6121015   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0032505  -0.0523074  -1.30751892]
Stock Position:  -0.003250502771574678
Bond Position:  [5.75981551]


portfolio before change:  [5.44336003]
curr_Stock_Price:  97.798906551397
curr_Factors:  [97.79890655 -0.16523358 -0.99342131]
mat_Sqrt:  [[30.69987276  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00147581  0.00489074 -0.06612056]
Stock Position:  -0.001475808555973311
Bond Position:  [5.58769249]


portfolio before change:  [5.44690339]
curr_Stock_Price:  96.3446086329796
curr_Factors:  [96.34460863 -0.23840601 -0.95127475]
mat_Sqrt:  [[29.31943716  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00043339 -0.01831408 -0.31229621]
Stock Position:  -0.0004333855589057656
Bond Position:  [5.48865775]


portfolio before change:  [5.44772776]
curr_Stock_Price:  97.60900177529291
curr_Factors:  [97.60900178 -0.12358041 -0.94114112]
mat_Sqrt:  [[33.65791326  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00453548  0.0057818  -0.11845436]
Stock Position:  0.004535475563123005
Bond Position:  [5.00502452]


portfolio before change:  [5.46080593]
curr_Stock_Price:  100.21661376941118
curr_Factors:  [100.21661377   0.14033923  -0.95229591]
mat_Sqrt:  [[44.49502135  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [3.88663406e-05 2.02039560e-02 3.40741044e-01]
Stock Position:  3.8866340574852795e-05
Bond Position:  [5.45691088]


portfolio before change:  [5.46223422]
curr_Stock_Price:  101.86056758813393
curr_Factors:  [ 1.01860568e+02 -3.24334617e-02 -9.79056662e-01]
mat_Sqrt:  [[37.04431023  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00167417  0.02883759 -0.28402247]
Stock Position:  -0.0016741691134443766
Bond Position:  [5.63276604]


portfolio before change:  [5.46598065]
curr_Stock_Price:  100.46402081868699
curr_Factors:  [100.46402082  -0.13212427  -0.9779529 ]
mat_Sqrt:  [[33.10626331  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01403956 -0.32191563 -0.72594502]
Stock Position:  -0.014039557241584923
Bond Position:  [6.87645102]


portfolio before change:  [5.52172937]
curr_Stock_Price:  96.61565218540404
curr_Factors:  [96.61565219 -0.28154334 -0.92714923]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [5.52172937]
Stock Price:  95.21833079595028
PL:  [5.52172937]
Settle:  Tensor("sub_46:0", shape=(), dtype=float64)
PL:  Tensor("sub_47:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  24
output_Z_Vals[:, i, :]:  [[ 1.19251512e+02 -2.92846752e+01 -2.92776944e+01]
 [-2.09430715e-01  5.73751007e-02  5.13367527e-02]
 [-6.14613872e-02  2.08632059e-02  7.67059815e-02]
 [-2.07567218e-02  3.49145585e-02  5.42267862e-02]
 [-8.40297712e-02 -1.18238453e-01  8.96678243e-02]
 [-3.32186970e-02  1.59617200e-02 -1.14820820e-02]
 [ 5.54413831e-02  3.63370582e-02 -1.91115083e-02]
 [-1.11594665e-01  1.75796404e-01 -7.38845242e-02]
 [-8.67422783e-02 -4.37366002e-02  8.12118812e-02]
 [ 4.99454531e-02  3.91913081e-02 -8.45494276e-03]
 [ 8.71324617e-02  4.42564258e-02 -1.62064751e-02]
 [ 1.49778043e-01 -1.20912762e-02 -1.53962978e-01]
 [ 4.90540671e-02 -1.12381967e-02 -3.41216672e-01]
 [-8.15607444e-02  3.06611814e-02 -2.91868657e-02]
 [-5.84339850e-02 -2.34799599e-02  7.20431695e-02]
 [-4.08633424e-03 -3.02622707e-02  1.02232460e-01]
 [-2.36045392e-02  5.46108560e-02  1.28377150e-01]
 [-8.08141442e-02  1.44045841e-01 -9.46463515e-02]
 [-3.74287450e-01 -1.03529294e+00 -2.56300749e-01]
 [ 9.90199537e-02 -8.22842517e-02 -1.47963652e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.25151208 -29.28467519 -29.2776944 ]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  8.31409947  -9.26062741 -83.52111278]
init_Out:  [2.49223638]
Stock Position:  8.314099471154409
Bond position:  [-828.91771073]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-3.66821421]
curr_Stock_Price:  99.28396391145105
curr_Factors:  [99.28396391 -0.99832613 -1.00152051]
mat_Sqrt:  [[13.43868426  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01469416  0.0181436   0.14644947]
Stock Position:  -0.014694163665621821
Bond Position:  [-2.2093194]


portfolio before change:  [-3.66340216]
curr_Stock_Price:  98.91889043223604
curr_Factors:  [98.91889043 -0.82116609 -0.98845083]
mat_Sqrt:  [[16.19468832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00279506  0.00659752  0.21882081]
Stock Position:  -0.002795062044883219
Bond Position:  [-3.38691773]


portfolio before change:  [-3.66371119]
curr_Stock_Price:  98.72647722743163
curr_Factors:  [98.72647723 -1.21697277 -1.01218752]
mat_Sqrt:  [[10.62482112  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00082695  0.01104095  0.15469393]
Stock Position:  -0.0008269537230418208
Bond Position:  [-3.58206896]


portfolio before change:  [-3.66408137]
curr_Stock_Price:  98.09107480223956
curr_Factors:  [98.0910748  -1.09976334 -0.99031665]
mat_Sqrt:  [[12.13163375  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00566942 -0.03739028  0.25579734]
Stock Position:  -0.0056694183460367755
Bond Position:  [-3.10796203]


portfolio before change:  [-3.66901761]
curr_Stock_Price:  98.82468705976746
curr_Factors:  [98.82468706 -0.81139972 -1.00856989]
mat_Sqrt:  [[16.0126308   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00219516  0.00504754 -0.03275518]
Stock Position:  -0.002195163169524373
Bond Position:  [-3.4520813]


portfolio before change:  [-3.67405145]
curr_Stock_Price:  100.72463853353773
curr_Factors:  [100.72463853  -0.51605094  -1.00345283]
mat_Sqrt:  [[22.04061033  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00238099  0.01149079 -0.05451981]
Stock Position:  0.002380990398014211
Bond Position:  [-3.91387584]


portfolio before change:  [-3.67438862]
curr_Stock_Price:  100.99402978461592
curr_Factors:  [100.99402978  -0.67915427  -1.03205101]
mat_Sqrt:  [[18.24436242  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00669452  0.0555917  -0.21077198]
Stock Position:  -0.006694519298482047
Bond Position:  [-2.99828214]


portfolio before change:  [-3.6810168]
curr_Stock_Price:  101.87213829416031
curr_Factors:  [101.87213829  -0.78609222  -1.04373153]
mat_Sqrt:  [[16.34455365  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00436196 -0.01383073  0.23167489]
Stock Position:  -0.004361957390483425
Bond Position:  [-3.23665487]


portfolio before change:  [-3.68395891]
curr_Stock_Price:  102.36110453131653
curr_Factors:  [102.36110453  -0.90506505  -1.02140591]
mat_Sqrt:  [[14.91005523  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0033019   0.01239338 -0.0241196 ]
Stock Position:  0.003301899932174738
Bond Position:  [-4.02194504]


portfolio before change:  [-3.68570457]
curr_Stock_Price:  102.13697736673265
curr_Factors:  [102.13697737  -1.12931588  -1.01652647]
mat_Sqrt:  [[11.9469077   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00711205  0.01399511 -0.04623256]
Stock Position:  0.007112051663844206
Bond Position:  [-4.41210803]


portfolio before change:  [-3.68648998]
curr_Stock_Price:  102.1816562631928
curr_Factors:  [102.18165626  -1.10956158  -1.03377837]
mat_Sqrt:  [[11.9820802   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00985123 -0.0038236  -0.43921352]
Stock Position:  0.009851234857570815
Bond Position:  [-4.69310547]


portfolio before change:  [-3.70862121]
curr_Stock_Price:  100.05422678764842
curr_Factors:  [100.05422679  -0.9379737   -0.96287213]
mat_Sqrt:  [[14.9523201   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00139688 -0.00355383 -0.97339619]
Stock Position:  -0.0013968844510720874
Bond Position:  [-3.56885701]


portfolio before change:  [-3.70889065]
curr_Stock_Price:  99.60831891840164
curr_Factors:  [99.60831892 -0.48288216 -0.95369533]
mat_Sqrt:  [[23.68088542  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00366231  0.00969592 -0.083262  ]
Stock Position:  -0.0036623132341733022
Bond Position:  [-3.34409379]


portfolio before change:  [-3.7135147]
curr_Stock_Price:  100.64261683925797
curr_Factors:  [100.64261684  -0.67160185  -0.92980301]
mat_Sqrt:  [[20.29086803  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00218495 -0.00742502  0.20551911]
Stock Position:  -0.0021849476575895293
Bond Position:  [-3.49361585]


portfolio before change:  [-3.71599555]
curr_Stock_Price:  101.37825638450892
curr_Factors:  [101.37825638  -0.81681722  -0.96204969]
mat_Sqrt:  [[17.11562386  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00093484 -0.00956977  0.29164075]
Stock Position:  0.0009348423935311841
Bond Position:  [-3.81076824]


portfolio before change:  [-3.71680642]
curr_Stock_Price:  101.5300923129448
curr_Factors:  [101.53009231  -0.54480739  -0.95882435]
mat_Sqrt:  [[22.57230006  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [1.77668336e-04 1.72694690e-02 3.66224275e-01]
Stock Position:  0.00017766833557718466
Bond Position:  [-3.7348451]


portfolio before change:  [-3.71734177]
curr_Stock_Price:  103.77287647283165
curr_Factors:  [103.77287647  -0.59255971  -0.98520052]
mat_Sqrt:  [[21.42255635  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00450061  0.04555129 -0.2699997 ]
Stock Position:  -0.004500606774549546
Bond Position:  [-3.25030086]


portfolio before change:  [-3.71391575]
curr_Stock_Price:  102.83106923572002
curr_Factors:  [102.83106924  -0.13240415  -0.97235434]
mat_Sqrt:  [[34.06699588  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01330718 -0.32738837 -0.7311547 ]
Stock Position:  -0.01330718363395032
Bond Position:  [-2.34552383]


portfolio before change:  [-3.7223594]
curr_Stock_Price:  103.4215171920473
curr_Factors:  [103.42151719   0.12498991  -0.99330085]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-3.7223594]
Stock Price:  99.37844489225816
PL:  [-3.7223594]
Settle:  Tensor("sub_48:0", shape=(), dtype=float64)
PL:  Tensor("sub_49:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  25
output_Z_Vals[:, i, :]:  [[ 1.19251512e+02 -2.92846752e+01 -2.92776944e+01]
 [ 3.23070056e-02 -5.88452682e-02 -1.57840611e-01]
 [-2.43425299e-01 -2.60522319e-02  1.73592071e-01]
 [-6.05539356e-02 -1.01038340e-01 -3.26947829e-01]
 [-8.68172650e-02 -1.41531646e-01  1.13294317e-01]
 [-2.33812855e-02 -7.39541817e-03 -1.66113637e-02]
 [-2.68650517e-02 -3.18820151e-03  1.80443703e-02]
 [-8.22049071e-02  1.49021037e-01 -1.00984186e-01]
 [-1.35862887e-01 -6.81304808e-02  1.36440642e-01]
 [ 4.50470017e-02  4.74936917e-02 -1.18045691e-02]
 [ 1.67620355e-02  8.97500284e-02 -1.99985625e-04]
 [ 8.24291995e-02 -1.01161997e-02 -1.24877033e-01]
 [ 2.84086708e-02 -9.57561212e-02 -3.72832270e-01]
 [-8.12567112e-02  3.07553830e-02 -2.84989788e-02]
 [ 1.27358003e-02 -5.88430873e-02 -1.02193396e-01]
 [ 1.65771938e-01  2.60424428e-02 -6.52153608e-02]
 [-2.35647895e-02  1.03259148e-01  6.82888801e-02]
 [ 4.42820755e-02 -2.38427813e-02  4.36275750e-02]
 [-3.19329170e-01 -8.15185638e-01 -1.55776270e-01]
 [ 1.39094046e-01 -1.59704373e-01 -2.52586064e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.25151208 -29.28467519 -29.2776944 ]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  8.31409947  -9.26062741 -83.52111278]
init_Out:  [2.49223638]
Stock Position:  8.314099471154409
Bond position:  [-828.91771073]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [7.61825593]
curr_Stock_Price:  100.64147354760087
curr_Factors:  [100.64147355  -1.23794674  -1.01635896]
mat_Sqrt:  [[10.5619586   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-1.35529064e-04 -1.86085077e-02 -4.50275327e-01]
Stock Position:  -0.00013552906395641935
Bond Position:  [7.63189578]


portfolio before change:  [7.62021764]
curr_Stock_Price:  100.24680264895362
curr_Factors:  [100.24680265  -0.99004973  -1.04508466]
mat_Sqrt:  [[13.09854006  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0159303  -0.00823844  0.49520986]
Stock Position:  -0.015930296882242005
Bond Position:  [9.21717896]


portfolio before change:  [7.60851107]
curr_Stock_Price:  101.12633090059931
curr_Factors:  [101.1263309   -1.05395613  -1.05959282]
mat_Sqrt:  [[12.21691643  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01063285 -0.03195113 -0.93269115]
Stock Position:  -0.01063285333214803
Bond Position:  [8.68377252]


portfolio before change:  [7.63296443]
curr_Stock_Price:  99.03073687059131
curr_Factors:  [99.03073687 -1.0883869  -1.00916492]
mat_Sqrt:  [[12.15667561  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00553979 -0.04475624  0.32319715]
Stock Position:  -0.005539794997278752
Bond Position:  [8.18157441]


portfolio before change:  [7.63314733]
curr_Stock_Price:  99.3669866475864
curr_Factors:  [99.36698665 -0.81739384 -1.01196796]
mat_Sqrt:  [[15.94998887  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00169047 -0.00233864 -0.0473876 ]
Stock Position:  -0.001690472329395396
Bond Position:  [7.80112447]


portfolio before change:  [7.6354548]
curr_Stock_Price:  99.15583088278903
curr_Factors:  [99.15583088 -0.80751901 -1.02283759]
mat_Sqrt:  [[15.90026965  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00146312 -0.0010082   0.05147557]
Stock Position:  -0.001463124813394163
Bond Position:  [7.78053216]


portfolio before change:  [7.63636277]
curr_Stock_Price:  99.86486702844286
curr_Factors:  [99.86486703 -1.13360798 -1.06824747]
mat_Sqrt:  [[11.04483056  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0089608   0.04712459 -0.28807977]
Stock Position:  -0.008960799407578993
Bond Position:  [8.53123181]


portfolio before change:  [7.63564991]
curr_Stock_Price:  100.18246582438492
curr_Factors:  [100.18246582  -1.13409592  -1.08962343]
mat_Sqrt:  [[10.84033418  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01012618 -0.02154475  0.38922717]
Stock Position:  -0.010126180390212569
Bond Position:  [8.65011563]


portfolio before change:  [7.63633284]
curr_Stock_Price:  100.32860835984657
curr_Factors:  [100.32860836  -1.01956164  -1.02202406]
mat_Sqrt:  [[13.02492962  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00336767  0.01501882 -0.03367515]
Stock Position:  0.0033676716319735404
Bond Position:  [7.29845903]


portfolio before change:  [7.63007376]
curr_Stock_Price:  97.92815844718359
curr_Factors:  [97.92815845 -0.82365282 -0.99556232]
mat_Sqrt:  [[15.87934154  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00119895  0.02838145 -0.0005705 ]
Stock Position:  0.0011989508055101768
Bond Position:  [7.51266271]


portfolio before change:  [7.63377541]
curr_Stock_Price:  99.44886896033395
curr_Factors:  [99.44886896 -0.79685425 -0.9656169 ]
mat_Sqrt:  [[17.06743882  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0033208  -0.00319902 -0.35623942]
Stock Position:  0.003320801871798107
Bond Position:  [7.30352542]


portfolio before change:  [7.63350678]
curr_Stock_Price:  98.81807448451215
curr_Factors:  [98.81807448 -0.72354379 -0.95206045]
mat_Sqrt:  [[18.49825288  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00271203 -0.03028074 -1.06358669]
Stock Position:  -0.002712029640142818
Bond Position:  [7.90150433]


portfolio before change:  [7.63350976]
curr_Stock_Price:  99.54544161653503
curr_Factors:  [99.54544162 -0.62570182 -0.97560139]
mat_Sqrt:  [[20.0717032   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00429859  0.00972571 -0.08129965]
Stock Position:  -0.004298585898360269
Bond Position:  [8.06141439]


portfolio before change:  [7.64585614]
curr_Stock_Price:  97.1421470824407
curr_Factors:  [97.14214708 -0.42156642 -0.94677932]
mat_Sqrt:  [[24.72536398  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00039003 -0.01860782 -0.29152931]
Stock Position:  -0.0003900311132972835
Bond Position:  [7.6837446]


portfolio before change:  [7.64791451]
curr_Stock_Price:  96.7903768391791
curr_Factors:  [96.79037684 -0.71408871 -0.95745797]
mat_Sqrt:  [[18.19234485  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0084174   0.00823534 -0.18604127]
Stock Position:  0.008417404277692142
Bond Position:  [6.83319078]


portfolio before change:  [7.65398714]
curr_Stock_Price:  97.30884007285664
curr_Factors:  [97.30884007 -0.75172097 -0.96866393]
mat_Sqrt:  [[17.41801362  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00039954  0.03265341  0.19480917]
Stock Position:  -0.00039954271800346773
Bond Position:  [7.69286618]


portfolio before change:  [7.6560818]
curr_Stock_Price:  96.88033182020122
curr_Factors:  [96.88033182 -0.70020743 -0.91697051]
mat_Sqrt:  [[19.22667395  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00273432 -0.00753975  0.12445733]
Stock Position:  0.0027343210327116165
Bond Position:  [7.39117987]


portfolio before change:  [7.65700994]
curr_Stock_Price:  96.54391025714772
curr_Factors:  [96.54391026 -0.71591729 -0.93963121]
mat_Sqrt:  [[18.43865794  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02018449 -0.25778433 -0.44438634]
Stock Position:  -0.02018448804952788
Bond Position:  [9.60569935]


portfolio before change:  [7.67929072]
curr_Stock_Price:  95.55904278151522
curr_Factors:  [95.55904278 -0.56567431 -0.96177648]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [7.67929072]
Stock Price:  97.64184176319445
PL:  [7.67929072]
Settle:  Tensor("sub_50:0", shape=(), dtype=float64)
PL:  Tensor("sub_51:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  26
output_Z_Vals[:, i, :]:  [[ 1.19251512e+02 -2.92846752e+01 -2.92776944e+01]
 [ 1.88970280e-02 -7.45215999e-02 -1.86232156e-01]
 [-4.03182945e-01 -6.58331542e-02  2.69799764e-01]
 [-3.12600187e-02 -1.49176103e-01 -4.72575593e-01]
 [-9.88296441e-02 -2.41910939e-01  2.15109929e-01]
 [-2.93221935e-01  5.17778528e-02  8.57970578e-03]
 [ 5.53594900e-02  3.76995571e-02 -1.96458353e-02]
 [-1.12569189e-01  1.75482333e-01 -7.09495572e-02]
 [-2.43190016e-01 -1.31033874e-01  2.80225572e-01]
 [ 6.88290260e-02  5.72716429e-02 -5.00771142e-03]
 [ 3.27588825e-02  8.55881356e-02 -1.20795906e-02]
 [ 3.06536537e-02 -9.37713710e-03 -1.13302650e-01]
 [ 2.12035640e-02 -1.29433598e-01 -3.52213342e-01]
 [-8.00146518e-02  3.11402223e-02 -2.56887711e-02]
 [ 2.10398709e-02 -6.36611015e-02 -6.44347710e-02]
 [ 1.75998939e-01  4.11957299e-02 -1.12534683e-01]
 [-8.13937014e-03  5.83325636e-02  7.99936173e-02]
 [ 4.16196696e-02 -2.49874608e-02  6.99696018e-02]
 [-3.77680066e-01 -9.49955546e-01 -2.35119387e-01]
 [ 1.54536667e-01 -1.95035975e-01 -3.09885478e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.25151208 -29.28467519 -29.2776944 ]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  8.31409947  -9.26062741 -83.52111278]
init_Out:  [2.49223638]
Stock Position:  8.314099471154409
Bond position:  [-828.91771073]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [13.05116643]
curr_Stock_Price:  101.29493102791005
curr_Factors:  [101.29493103  -0.98008901  -1.03058794]
mat_Sqrt:  [[13.56318892  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00155137 -0.0235658  -0.53126851]
Stock Position:  -0.0015513749263115538
Bond Position:  [13.20831284]


portfolio before change:  [13.05431781]
curr_Stock_Price:  101.39233195210241
curr_Factors:  [101.39233195  -0.92329916  -1.04246565]
mat_Sqrt:  [[14.19986781  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02463474 -0.02081827  0.76966363]
Stock Position:  -0.024634743638155498
Bond Position:  [15.55209192]


portfolio before change:  [13.03909478]
curr_Stock_Price:  102.16812827303633
curr_Factors:  [102.16812827  -0.84672817  -1.0366712 ]
mat_Sqrt:  [[15.53693974  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00846858 -0.04717363 -1.34812663]
Stock Position:  -0.008468580067625745
Bond Position:  [13.90431375]


portfolio before change:  [13.04687761]
curr_Stock_Price:  101.65962329734295
curr_Factors:  [101.6596233   -1.01601462  -1.02454534]
mat_Sqrt:  [[13.21126983  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00462988 -0.07649896  0.61364875]
Stock Position:  -0.004629882520085961
Bond Position:  [13.51754972]


portfolio before change:  [13.04417746]
curr_Stock_Price:  102.97282134622874
curr_Factors:  [102.97282135  -0.80586979  -1.04532066]
mat_Sqrt:  [[16.17189135  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01794062  0.01637359  0.02447551]
Stock Position:  -0.01794061717248249
Bond Position:  [14.89157343]


portfolio before change:  [13.07443504]
curr_Stock_Price:  101.49381881375054
curr_Factors:  [101.49381881  -0.8674281   -1.00346778]
mat_Sqrt:  [[15.62859138  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00334788  0.01192165 -0.0560441 ]
Stock Position:  0.003347883234759331
Bond Position:  [12.73464558]


portfolio before change:  [13.07611629]
curr_Stock_Price:  101.04493699953291
curr_Factors:  [101.044937    -0.62256079  -0.97110519]
mat_Sqrt:  [[20.53024905  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00596782  0.05549239 -0.20239934]
Stock Position:  -0.005967817136129432
Bond Position:  [13.679134]


portfolio before change:  [13.10055527]
curr_Stock_Price:  97.52291814361072
curr_Factors:  [97.52291814 -0.95000053 -0.93461046]
mat_Sqrt:  [[14.81257406  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01278458 -0.04143655  0.79940556]
Stock Position:  -0.012784576809259896
Bond Position:  [14.34734451]


portfolio before change:  [13.08425837]
curr_Stock_Price:  99.07824389235113
curr_Factors:  [99.07824389 -1.27021182 -0.93474882]
mat_Sqrt:  [[10.92385836  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00634259  0.01811088 -0.01428561]
Stock Position:  0.006342592186610865
Bond Position:  [12.45584548]


portfolio before change:  [13.08977278]
curr_Stock_Price:  99.45664746006294
curr_Factors:  [99.45664746 -0.98135854 -0.96895952]
mat_Sqrt:  [[14.14560226  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00229775  0.02706534 -0.03445971]
Stock Position:  0.0022977475216225843
Bond Position:  [12.86124652]


portfolio before change:  [13.09057776]
curr_Stock_Price:  98.40747358262828
curr_Factors:  [98.40747358 -0.85792746 -0.95573624]
mat_Sqrt:  [[16.04589504  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00045393 -0.00296531 -0.32322092]
Stock Position:  0.00045393107939629886
Bond Position:  [13.04590755]


portfolio before change:  [13.09377273]
curr_Stock_Price:  98.26006073696495
curr_Factors:  [98.26006074 -0.74239036 -0.9195679 ]
mat_Sqrt:  [[18.6465172   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00289779 -0.0409305  -1.00476663]
Stock Position:  -0.0028977875060792455
Bond Position:  [13.37850951]


portfolio before change:  [13.09451517]
curr_Stock_Price:  99.15819699603608
curr_Factors:  [99.158197   -0.64729582 -0.93987201]
mat_Sqrt:  [[20.27824613  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00416477  0.0098474  -0.07328291]
Stock Position:  -0.004164774045610732
Bond Position:  [13.50748665]


portfolio before change:  [13.10255391]
curr_Stock_Price:  98.0389402930491
curr_Factors:  [98.03894029 -0.58368323 -0.91661114]
mat_Sqrt:  [[21.86900577  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00028549 -0.02013141 -0.18381447]
Stock Position:  0.0002854933525301261
Bond Position:  [13.07456445]


portfolio before change:  [13.10500937]
curr_Stock_Price:  95.1891655099703
curr_Factors:  [95.18916551 -0.62304924 -0.95188897]
mat_Sqrt:  [[19.70609393  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00781949  0.01302723 -0.32103013]
Stock Position:  0.007819487842471523
Bond Position:  [12.36067885]


portfolio before change:  [13.11601423]
curr_Stock_Price:  96.20129117008997
curr_Factors:  [96.20129117 -0.58773752 -0.93637577]
mat_Sqrt:  [[20.95399842  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.0004627  0.01844638 0.22819952]
Stock Position:  0.00046269922974778537
Bond Position:  [13.07150197]


portfolio before change:  [13.118035]
curr_Stock_Price:  93.50511342894961
curr_Factors:  [93.50511343 -0.58874538 -0.91476672]
mat_Sqrt:  [[20.79066354  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00265778 -0.00790173  0.1996038 ]
Stock Position:  0.0026577786300974265
Bond Position:  [12.8695191]


portfolio before change:  [13.1208074]
curr_Stock_Price:  93.33753914365465
curr_Factors:  [93.33753914 -0.29557905 -0.92583131]
mat_Sqrt:  [[27.51722061  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01636071 -0.30040232 -0.67073017]
Stock Position:  -0.016360713266459284
Bond Position:  [14.64787612]


portfolio before change:  [13.10718437]
curr_Stock_Price:  94.39406163999489
curr_Factors:  [94.39406164 -0.34566786 -0.91613345]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [13.10718437]
Stock Price:  94.53890564043012
PL:  [13.10718437]
Settle:  Tensor("sub_52:0", shape=(), dtype=float64)
PL:  Tensor("sub_53:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  27
output_Z_Vals[:, i, :]:  [[ 1.19251512e+02 -2.92846752e+01 -2.92776944e+01]
 [ 5.29347497e-02 -5.04790417e-02 -8.55071154e-02]
 [-2.84188689e-01 -3.71222899e-02  1.90866307e-01]
 [-4.81230228e-03 -1.54896154e-01 -4.85145483e-01]
 [-9.88296441e-02 -2.41910939e-01  2.15109929e-01]
 [-2.76343923e-01  1.32794638e-02  2.50325927e-02]
 [ 5.35297248e-02  6.81423491e-02 -3.15844915e-02]
 [-1.48077575e-01  2.29862499e-01 -7.97907502e-02]
 [ 1.40089760e-03 -1.91715112e-03 -1.73266575e-02]
 [ 3.49923157e-02  3.68301018e-02 -1.12061326e-02]
 [ 1.09368752e-01  2.61790215e-02 -1.97958892e-02]
 [ 1.10730877e-01 -1.09461765e-02 -1.37099678e-01]
 [ 3.91662396e-02 -1.28607345e-02 -2.37053052e-01]
 [-8.45720117e-02  2.97281712e-02 -3.59999752e-02]
 [-9.49688480e-02  2.82037942e-02  1.80105586e-01]
 [-7.21179858e-02 -1.50785590e-01  1.58644414e-01]
 [-2.70974714e-02 -4.14385310e-03  2.18617506e-01]
 [-9.55322153e-02  1.68076455e-01 -8.47301159e-02]
 [-2.98122933e-01 -9.29368026e-01 -1.11098282e-01]
 [ 5.96440001e-02 -5.65483987e-03 -4.46163140e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.25151208 -29.28467519 -29.2776944 ]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  8.31409947  -9.26062741 -83.52111278]
init_Out:  [2.49223638]
Stock Position:  8.314099471154409
Bond position:  [-828.91771073]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [8.38018656]
curr_Stock_Price:  100.73311674117578
curr_Factors:  [100.73311674  -1.01078668  -0.99252306]
mat_Sqrt:  [[13.58769865  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00251531 -0.01596287 -0.243928  ]
Stock Position:  0.002515313335790591
Bond Position:  [8.12681121]


portfolio before change:  [8.38213105]
curr_Stock_Price:  100.6983423702444
curr_Factors:  [100.69834237  -0.95088478  -0.97410256]
mat_Sqrt:  [[14.68963288  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01675922 -0.0117391   0.54448845]
Stock Position:  -0.01675921807107368
Bond Position:  [10.06975653]


portfolio before change:  [8.35132081]
curr_Stock_Price:  102.68697871595381
curr_Factors:  [102.68697872  -1.1586941   -0.9708844 ]
mat_Sqrt:  [[12.20818735  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00883355 -0.04898246 -1.38398502]
Stock Position:  -0.008833548141468665
Bond Position:  [9.25841118]


portfolio before change:  [8.34787708]
curr_Stock_Price:  103.33888258303004
curr_Factors:  [103.33888258  -1.31592694  -0.9950295 ]
mat_Sqrt:  [[10.24774085  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00596879 -0.07649896  0.61364875]
Stock Position:  -0.005968791381864784
Bond Position:  [8.96468531]


portfolio before change:  [8.35038327]
curr_Stock_Price:  103.29452915724357
curr_Factors:  [103.29452916  -1.35437889  -0.99589167]
mat_Sqrt:  [[ 9.84844771  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02750599  0.00419934  0.07141102]
Stock Position:  -0.027505988764015284
Bond Position:  [11.19160143]


portfolio before change:  [8.36420483]
curr_Stock_Price:  102.89376871299308
curr_Factors:  [102.89376871  -1.47671892  -0.98498001]
mat_Sqrt:  [[ 8.77580198  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00556553  0.0215485  -0.09010176]
Stock Position:  0.005565530701361975
Bond Position:  [7.7915464]


portfolio before change:  [8.36884397]
curr_Stock_Price:  103.37728234002998
curr_Factors:  [103.37728234  -1.39024926  -0.97950822]
mat_Sqrt:  [[ 9.66612736  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0163902  0.0726889 -0.2276208]
Stock Position:  -0.016390200938090037
Bond Position:  [10.0632184]


portfolio before change:  [8.37270752]
curr_Stock_Price:  103.29507316420558
curr_Factors:  [103.29507316  -1.6476929   -0.98798199]
mat_Sqrt:  [[ 7.40321817  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00029519 -0.00060626 -0.04942813]
Stock Position:  -0.00029519489075998935
Bond Position:  [8.40319969]


portfolio before change:  [8.37471871]
curr_Stock_Price:  103.59951930309406
curr_Factors:  [103.5995193   -1.45947894  -0.9642115 ]
mat_Sqrt:  [[ 9.17830231  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00366689  0.0116467  -0.03196798]
Stock Position:  0.0036668897402742377
Bond Position:  [7.99483069]


portfolio before change:  [8.37347248]
curr_Stock_Price:  102.71452295836283
curr_Factors:  [102.71452296  -1.18343806  -0.96257554]
mat_Sqrt:  [[12.01240567  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00882453  0.00827853 -0.05647216]
Stock Position:  0.008824533157131595
Bond Position:  [7.46706477]


portfolio before change:  [8.37801922]
curr_Stock_Price:  103.01819276817095
curr_Factors:  [103.01819277  -1.11109387  -0.99900433]
mat_Sqrt:  [[12.48848982  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00660311 -0.00346148 -0.39110722]
Stock Position:  0.006603111676376604
Bond Position:  [7.69777859]


portfolio before change:  [8.39006147]
curr_Stock_Price:  104.55043377479268
curr_Factors:  [104.55043377  -0.70236633  -1.03508562]
mat_Sqrt:  [[18.39755232  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-5.19312283e-04 -4.06692134e-03 -6.76246376e-01]
Stock Position:  -0.0005193122827640129
Bond Position:  [8.44435579]


portfolio before change:  [8.39363906]
curr_Stock_Price:  101.72701676267341
curr_Factors:  [101.72701676  -0.51919413  -1.00797989]
mat_Sqrt:  [[22.08986488  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00412646  0.00940087 -0.10269791]
Stock Position:  -0.004126457914645138
Bond Position:  [8.81341131]


portfolio before change:  [8.39319175]
curr_Stock_Price:  102.36944153281678
curr_Factors:  [102.36944153  -0.56106478  -0.96271834]
mat_Sqrt:  [[22.3048718   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00257687  0.00891882  0.51379111]
Stock Position:  -0.002576868897056249
Bond Position:  [8.65698438]


portfolio before change:  [8.39088112]
curr_Stock_Price:  104.10609983409572
curr_Factors:  [104.10609983  -0.71381965  -0.94569192]
mat_Sqrt:  [[19.8042983   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00220296 -0.04768259  0.45256836]
Stock Position:  -0.0022029610392872065
Bond Position:  [8.6202228]


portfolio before change:  [8.39149637]
curr_Stock_Price:  104.80519444003336
curr_Factors:  [104.80519444  -1.28410028  -0.95448356]
mat_Sqrt:  [[11.17321618  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00155914 -0.0013104   0.62365489]
Stock Position:  0.0015591434086073706
Bond Position:  [8.22809004]


portfolio before change:  [8.39320718]
curr_Stock_Price:  104.58297419152095
curr_Factors:  [104.58297419  -1.2206218   -0.97753804]
mat_Sqrt:  [[11.60946747  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00934478  0.05315044 -0.24171144]
Stock Position:  -0.009344783700684142
Bond Position:  [9.37051245]


portfolio before change:  [8.38700937]
curr_Stock_Price:  105.49693059831384
curr_Factors:  [105.4969306   -1.20443404  -1.00231403]
mat_Sqrt:  [[11.61077784  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02969628 -0.29389197 -0.31693247]
Stock Position:  -0.029696283838881107
Bond Position:  [11.51987617]


portfolio before change:  [8.41354876]
curr_Stock_Price:  104.70022948209112
curr_Factors:  [104.70022948  -1.78680027  -1.01041018]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [8.41354876]
Stock Price:  105.43527471234579
PL:  [2.97827405]
Settle:  Tensor("sub_54:0", shape=(), dtype=float64)
PL:  Tensor("sub_55:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  28
output_Z_Vals[:, i, :]:  [[ 1.19251512e+02 -2.92846752e+01 -2.92776944e+01]
 [ 1.23759378e-02 -7.85613249e-02 -2.13099883e-01]
 [-4.84472968e-01 -8.34241739e-02  3.39720056e-01]
 [-5.00154188e-02 -5.60397620e-02 -1.99802966e-01]
 [-9.88296441e-02 -2.41910939e-01  2.15109929e-01]
 [-3.42185539e-02  2.17362782e-02 -7.94273977e-03]
 [-1.32426970e-01 -1.07495293e-01  9.51665328e-02]
 [-4.19796821e-02  7.61832659e-02 -9.58592105e-02]
 [-2.87838589e-01 -1.31606121e-01  2.78441842e-01]
 [ 3.18479499e-02  2.30902224e-02  5.96485108e-03]
 [-4.57172081e-03  9.82926760e-02  9.64625770e-03]
 [-8.01686622e-02 -9.24450430e-03 -1.20969794e-01]
 [-2.20656198e-02 -3.35546911e-01 -2.91598284e-01]
 [ 6.39951769e-02 -3.01584638e-02  1.14728254e-02]
 [ 1.11348156e-02 -5.79141975e-02 -1.09473076e-01]
 [ 1.76123208e-01  3.84096616e-02 -1.08359252e-01]
 [ 2.25003301e-02 -3.67967667e-02  1.13386076e-01]
 [ 4.16196696e-02 -2.49874608e-02  6.99696018e-02]
 [-3.38672746e-01 -8.49936155e-01 -1.74976812e-01]
 [ 1.18714122e-01 -1.28900118e-01 -2.07787174e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.25151208 -29.28467519 -29.2776944 ]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  8.31409947  -9.26062741 -83.52111278]
init_Out:  [2.49223638]
Stock Position:  8.314099471154409
Bond position:  [-828.91771073]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [10.49802595]
curr_Stock_Price:  100.9878453975962
curr_Factors:  [100.9878454   -1.20596634  -1.02743061]
mat_Sqrt:  [[10.8222394   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00306326 -0.02484327 -0.60791465]
Stock Position:  -0.0030632604872407624
Bond Position:  [10.80737803]


portfolio before change:  [10.49892683]
curr_Stock_Price:  101.57588095867655
curr_Factors:  [101.57588096  -1.32587144  -1.01954033]
mat_Sqrt:  [[ 9.73175594  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.04287838 -0.02638104  0.96912676]
Stock Position:  -0.04287837745359415
Bond Position:  [14.85433579]


portfolio before change:  [10.53887669]
curr_Stock_Price:  100.73079740269681
curr_Factors:  [100.7307974   -1.16746117  -0.97285444]
mat_Sqrt:  [[11.84772633  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00778605 -0.01772133 -0.56998225]
Stock Position:  -0.007786048245480378
Bond Position:  [11.32317153]


portfolio before change:  [10.53894282]
curr_Stock_Price:  101.08592117739636
curr_Factors:  [101.08592118  -0.73191901  -0.98266255]
mat_Sqrt:  [[18.19941217  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00336091 -0.07649896  0.61364875]
Stock Position:  -0.0033609122468636074
Bond Position:  [10.87868373]


portfolio before change:  [10.55083523]
curr_Stock_Price:  98.35678312576883
curr_Factors:  [98.35678313 -0.95988868 -0.95130902]
mat_Sqrt:  [[14.54727675  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0024251   0.00687361 -0.02265843]
Stock Position:  -0.0024251020461614615
Bond Position:  [10.78936046]


portfolio before change:  [10.55558865]
curr_Stock_Price:  97.50908950601742
curr_Factors:  [97.50908951 -0.72978674 -0.90290157]
mat_Sqrt:  [[19.05362344  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00607636 -0.033993    0.27148363]
Stock Position:  -0.0060763612640178715
Bond Position:  [11.1480891]


portfolio before change:  [10.55874461]
curr_Stock_Price:  97.44843001653355
curr_Factors:  [97.44843002 -0.52079746 -0.87501396]
mat_Sqrt:  [[24.13135159  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00246898  0.02409126 -0.27345965]
Stock Position:  -0.0024689797330285828
Bond Position:  [10.7993428]


portfolio before change:  [10.55890741]
curr_Stock_Price:  98.47613061440059
curr_Factors:  [98.47613061 -0.61506191 -0.91221403]
mat_Sqrt:  [[21.38176052  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01096261 -0.04161751  0.79431707]
Stock Position:  -0.010962611866789169
Bond Position:  [11.63846301]


portfolio before change:  [10.57916486]
curr_Stock_Price:  96.89370885792101
curr_Factors:  [96.89370886 -0.39275631 -0.89240251]
mat_Sqrt:  [[26.80144417  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00125597 0.00730177 0.01701606]
Stock Position:  0.001255966161780494
Bond Position:  [10.45746964]


portfolio before change:  [10.58166972]
curr_Stock_Price:  96.80625494602312
curr_Factors:  [96.80625495 -0.53697107 -0.91119483]
mat_Sqrt:  [[22.74955768  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-2.84755953e-06  3.10828733e-02  2.75180882e-02]
Stock Position:  -2.847559530029924e-06
Bond Position:  [10.58194538]


portfolio before change:  [10.58431879]
curr_Stock_Price:  95.66295831537023
curr_Factors:  [95.66295832 -0.77580695 -0.89141968]
mat_Sqrt:  [[18.05828413  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00582006 -0.00292337 -0.34509315]
Stock Position:  -0.005820055177860251
Bond Position:  [11.14108249]


portfolio before change:  [10.59061826]
curr_Stock_Price:  95.05920966220289
curr_Factors:  [95.05920966 -0.67233081 -0.89681038]
mat_Sqrt:  [[19.79360241  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00455964 -0.10610925 -0.83184874]
Stock Position:  -0.004559637627881343
Bond Position:  [11.02405381]


portfolio before change:  [10.59259924]
curr_Stock_Price:  95.22926214571628
curr_Factors:  [95.22926215 -0.96836169 -0.91951083]
mat_Sqrt:  [[14.41709633  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00454727 -0.00953694  0.03272878]
Stock Position:  0.004547265824784909
Bond Position:  [10.15956647]


portfolio before change:  [10.59993226]
curr_Stock_Price:  96.28325976954636
curr_Factors:  [96.28325977 -1.04258114 -0.88908576]
mat_Sqrt:  [[13.95206557  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00091073 -0.01831408 -0.31229621]
Stock Position:  -0.0009107340127081587
Bond Position:  [10.6876207]


portfolio before change:  [10.6034275]
curr_Stock_Price:  95.37958431505533
curr_Factors:  [95.37958432 -0.69260117 -0.87358867]
mat_Sqrt:  [[19.91901327  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00778132  0.0121462  -0.30911879]
Stock Position:  0.007781319229823356
Bond Position:  [9.86124851]


portfolio before change:  [10.59572093]
curr_Stock_Price:  94.07232647785156
curr_Factors:  [94.07232648 -0.75115625 -0.91110395]
mat_Sqrt:  [[17.84643401  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00250443 -0.01163616  0.32345891]
Stock Position:  0.0025044262312987767
Bond Position:  [10.36012373]


portfolio before change:  [10.59745329]
curr_Stock_Price:  93.72973352456624
curr_Factors:  [93.72973352 -0.64099181 -0.91246865]
mat_Sqrt:  [[19.82522279  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00278721 -0.00790173  0.1996038 ]
Stock Position:  0.002787206068520368
Bond Position:  [10.33620921]


portfolio before change:  [10.59916201]
curr_Stock_Price:  93.4155653321217
curr_Factors:  [93.41556533 -0.59934274 -0.89514344]
mat_Sqrt:  [[20.95907661  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01890995 -0.26877341 -0.49916014]
Stock Position:  -0.01890994545535195
Bond Position:  [12.36564526]


portfolio before change:  [10.53361148]
curr_Stock_Price:  97.04552454645159
curr_Factors:  [97.04552455 -0.83358572 -0.92860715]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [10.53361148]
Stock Price:  96.06079480787417
PL:  [10.53361148]
Settle:  Tensor("sub_56:0", shape=(), dtype=float64)
PL:  Tensor("sub_57:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  29
output_Z_Vals[:, i, :]:  [[ 1.19251512e+02 -2.92846752e+01 -2.92776944e+01]
 [-4.02685678e-03  3.72288206e-04 -5.67316825e-02]
 [-3.80904172e-01 -6.10120664e-02  2.50637039e-01]
 [-3.94595093e-02 -1.05933732e-02 -7.10864428e-02]
 [-9.88296441e-02 -2.41910939e-01  2.15109929e-01]
 [-1.12233905e-02 -1.57870300e-02 -1.54301229e-02]
 [-6.11213340e-02 -1.72760084e-02  3.29505607e-02]
 [-6.55762235e-02  1.20714194e-01 -9.69975481e-02]
 [-3.06438440e-01 -1.70776751e-01  3.71393013e-01]
 [ 4.42579948e-04 -3.97750832e-02  2.52065725e-02]
 [-1.79508791e-02  8.70068357e-02  1.06507211e-02]
 [-1.16505616e-01 -9.02074474e-03 -1.41659358e-01]
 [-3.25561675e-02 -3.24733522e-01 -1.18859595e-01]
 [ 9.67073217e-02 -6.61856809e-02 -5.80125439e-03]
 [ 1.11348156e-02 -5.79141975e-02 -1.09473076e-01]
 [ 1.71084770e-01  3.93946428e-02 -9.84400780e-02]
 [ 2.25003301e-02 -3.67967667e-02  1.13386076e-01]
 [ 4.16196696e-02 -2.49874608e-02  6.99696018e-02]
 [-2.47621576e-01 -6.49153176e-01 -1.18643023e-01]
 [ 1.02792656e-01 -1.26470501e-01 -2.31588237e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.25151208 -29.28467519 -29.2776944 ]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  8.31409947  -9.26062741 -83.52111278]
init_Out:  [2.49223638]
Stock Position:  8.314099471154409
Bond position:  [-828.91771073]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [4.54040652]
curr_Stock_Price:  100.2712771812772
curr_Factors:  [100.27127718  -0.82848012  -1.0047047 ]
mat_Sqrt:  [[16.03372737  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-9.72796292e-04  1.17727868e-04 -1.61839699e-01]
Stock Position:  -0.0009727962923038083
Bond Position:  [4.63795005]


portfolio before change:  [4.54060797]
curr_Stock_Price:  101.2562547452248
curr_Factors:  [101.25625475  -0.97508588  -1.00782987]
mat_Sqrt:  [[13.93966999  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02376803 -0.01929371  0.71499771]
Stock Position:  -0.023768025009639284
Bond Position:  [6.94726917]


portfolio before change:  [4.57418902]
curr_Stock_Price:  99.91647081502938
curr_Factors:  [99.91647082 -0.85345027 -1.00650504]
mat_Sqrt:  [[15.55495498  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00348722 -0.00334992 -0.20278983]
Stock Position:  -0.003487216032289425
Bond Position:  [4.92261934]


portfolio before change:  [4.57352278]
curr_Stock_Price:  100.46047384227528
curr_Factors:  [100.46047384  -0.71074065  -0.98540559]
mat_Sqrt:  [[18.42333602  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00332006 -0.07649896  0.61364875]
Stock Position:  -0.003320062511345729
Bond Position:  [4.90705783]


portfolio before change:  [4.57860352]
curr_Stock_Price:  99.29970418286176
curr_Factors:  [99.29970418 -0.98356543 -0.97653304]
mat_Sqrt:  [[13.98582222  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00105683 -0.0049923  -0.04401785]
Stock Position:  -0.0010568324341258557
Bond Position:  [4.68354667]


portfolio before change:  [4.58042013]
curr_Stock_Price:  98.68884871312828
curr_Factors:  [98.68884871 -1.20365133 -0.99535977]
mat_Sqrt:  [[10.94585515  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00501024 -0.00546315  0.09399878]
Stock Position:  -0.005010242950188661
Bond Position:  [5.07487523]


portfolio before change:  [4.58130814]
curr_Stock_Price:  98.76486632374397
curr_Factors:  [98.76486632 -0.78763851 -1.0568032 ]
mat_Sqrt:  [[15.61606562  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00526758  0.03817318 -0.27670701]
Stock Position:  -0.00526758403725829
Bond Position:  [5.10156037]


portfolio before change:  [4.59566858]
curr_Stock_Price:  96.2808257199576
curr_Factors:  [96.28082572 -0.46889632 -1.0600703 ]
mat_Sqrt:  [[20.86978801  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0112621  -0.05400435  1.05948089]
Stock Position:  -0.011262097861786361
Bond Position:  [5.67999266]


portfolio before change:  [4.61058913]
curr_Stock_Price:  95.08208153314725
curr_Factors:  [95.08208153 -0.28489103 -1.06243529]
mat_Sqrt:  [[24.71509581  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00018454 -0.01257799  0.07190734]
Stock Position:  0.00018453749101874194
Bond Position:  [4.59304292]


portfolio before change:  [4.61167159]
curr_Stock_Price:  94.724723921497
curr_Factors:  [94.72472392 -0.28071484 -1.06520125]
mat_Sqrt:  [[24.65695372  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00054874  0.02751398  0.03038354]
Stock Position:  -0.0005487418732096353
Bond Position:  [4.66365101]


portfolio before change:  [4.61320355]
curr_Stock_Price:  94.05791088770647
curr_Factors:  [94.05791089 -0.73628232 -1.10245732]
mat_Sqrt:  [[14.95687447  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00973831 -0.00285261 -0.40411472]
Stock Position:  -0.00973830635471402
Bond Position:  [5.52916831]


portfolio before change:  [4.62030545]
curr_Stock_Price:  93.47059833099443
curr_Factors:  [93.47059833 -1.00456733 -1.06601925]
mat_Sqrt:  [[11.787744    0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00553141 -0.10268976 -0.33907334]
Stock Position:  -0.005531411630350201
Bond Position:  [5.1373298]


portfolio before change:  [4.62290239]
curr_Stock_Price:  93.23332731551034
curr_Factors:  [93.23332732 -1.21161843 -1.0674706 ]
mat_Sqrt:  [[ 9.54498816  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00982864 -0.02092975 -0.01654936]
Stock Position:  0.009828638559661934
Bond Position:  [3.70654571]


portfolio before change:  [4.63082239]
curr_Stock_Price:  93.9448454952574
curr_Factors:  [93.9448455  -1.60059456 -1.10849464]
mat_Sqrt:  [[ 6.25648585  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00203095 -0.01831408 -0.31229621]
Stock Position:  -0.0020309517140122855
Bond Position:  [4.82161984]


portfolio before change:  [4.63028127]
curr_Stock_Price:  94.80487513515988
curr_Factors:  [94.80487514 -1.96185745 -1.13063948]
mat_Sqrt:  [[ 4.30304928  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.03532563  0.01245768 -0.28082214]
Stock Position:  0.035325632856890145
Bond Position:  [1.28123906]


portfolio before change:  [4.62679502]
curr_Stock_Price:  94.69711757186788
curr_Factors:  [94.69711757 -1.60907016 -1.13683402]
mat_Sqrt:  [[ 6.07863027  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00735282 -0.01163616  0.32345891]
Stock Position:  0.007352820537501247
Bond Position:  [3.9305041]


portfolio before change:  [4.62388576]
curr_Stock_Price:  94.16779661219402
curr_Factors:  [94.16779661 -1.44210034 -1.1435299 ]
mat_Sqrt:  [[ 7.09540946  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00778771 -0.00790173  0.1996038 ]
Stock Position:  0.0077877086027740225
Bond Position:  [3.8905344]


portfolio before change:  [4.62914113]
curr_Stock_Price:  94.71771584703515
curr_Factors:  [94.71771585 -1.30799831 -1.14010857]
mat_Sqrt:  [[ 8.18901955  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.03524238 -0.20528026 -0.33845552]
Stock Position:  -0.035242380720640426
Bond Position:  [7.96721893]


portfolio before change:  [4.62899855]
curr_Stock_Price:  94.77828600245891
curr_Factors:  [94.778286   -0.99597306 -1.13458421]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [4.62899855]
Stock Price:  95.40123551400944
PL:  [4.62899855]
Settle:  Tensor("sub_58:0", shape=(), dtype=float64)
PL:  Tensor("sub_59:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  30
output_Z_Vals[:, i, :]:  [[ 1.19251512e+02 -2.92846752e+01 -2.92776944e+01]
 [ 1.16754201e-02 -7.85341079e-02 -2.22149585e-01]
 [-2.06438077e-01 -1.60076626e-02  1.57918057e-01]
 [-3.77827159e-02  7.47706080e-03 -2.05630754e-02]
 [-9.08495343e-02 -1.75226582e-01  1.47471391e-01]
 [-1.18197820e-01  6.16131939e-02 -3.99109268e-03]
 [-1.35785400e-01 -1.07767248e-01  9.59022574e-02]
 [-3.78835350e-02  6.52420934e-02 -9.97765984e-02]
 [-2.77522966e-01 -1.24198260e-01  2.61344395e-01]
 [ 4.50470017e-02  4.74936917e-02 -1.18045691e-02]
 [ 3.02876913e-02  8.68959724e-02 -1.21010214e-02]
 [ 1.02059433e-01 -1.06918772e-02 -1.33354742e-01]
 [ 1.90869090e-02 -1.44783704e-01 -3.19930690e-01]
 [-6.62248664e-03  7.72016430e-03 -2.79278198e-03]
 [ 2.37334521e-02 -6.51237719e-02 -4.95381252e-02]
 [ 1.18830723e-01 -3.57844677e-03  1.43873889e-02]
 [-2.35647895e-02  1.03259148e-01  6.82888801e-02]
 [ 3.80881026e-02 -1.59618885e-02  2.32075091e-02]
 [-3.73393907e-01 -9.49998248e-01 -2.13448012e-01]
 [ 8.50199442e-02 -6.39712296e-02 -1.19983570e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.25151208 -29.28467519 -29.2776944 ]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  8.31409947  -9.26062741 -83.52111278]
init_Out:  [2.49223638]
Stock Position:  8.314099471154409
Bond position:  [-828.91771073]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [9.88254293]
curr_Stock_Price:  100.91381657167358
curr_Factors:  [100.91381657  -1.26882482  -1.0426255 ]
mat_Sqrt:  [[10.00231461  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00356902 -0.02483467 -0.63373093]
Stock Position:  -0.0035690155091708405
Bond Position:  [10.2427059]


portfolio before change:  [9.88878332]
curr_Stock_Price:  99.88288973208185
curr_Factors:  [99.88288973 -1.14425015 -1.02451577]
mat_Sqrt:  [[11.418473    0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01529246 -0.00506207  0.45049626]
Stock Position:  -0.01529245681184469
Bond Position:  [11.41623809]


portfolio before change:  [9.89575245]
curr_Stock_Price:  99.61382134992851
curr_Factors:  [99.61382135 -0.84721517 -1.02119121]
mat_Sqrt:  [[15.37733316  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00271745  0.00236445 -0.05866073]
Stock Position:  -0.0027174464367907447
Bond Position:  [10.16644767]


portfolio before change:  [9.89966126]
curr_Stock_Price:  99.11081806303737
curr_Factors:  [99.11081806 -0.61448052 -1.01188541]
mat_Sqrt:  [[19.48943781  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00334906 -0.05541151  0.42069483]
Stock Position:  -0.0033490649752868254
Bond Position:  [10.23158983]


portfolio before change:  [9.90898422]
curr_Stock_Price:  97.09092935440623
curr_Factors:  [97.09092935 -0.59946875 -1.03507706]
mat_Sqrt:  [[18.93670587  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00620074  0.0194838  -0.01138548]
Stock Position:  -0.006200743315057705
Bond Position:  [10.51102015]


portfolio before change:  [9.90932017]
curr_Stock_Price:  97.46058354320907
curr_Factors:  [97.46058354 -0.7283836  -1.03607137]
mat_Sqrt:  [[16.69305993  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00712823 -0.034079    0.27358245]
Stock Position:  -0.0071282300607519115
Bond Position:  [10.60404163]


portfolio before change:  [9.91396855]
curr_Stock_Price:  97.18042421746352
curr_Factors:  [97.18042422 -0.61266014 -0.99890667]
mat_Sqrt:  [[19.39475154  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00291655  0.02063136 -0.28463486]
Stock Position:  -0.002916552146579507
Bond Position:  [10.19740033]


portfolio before change:  [9.91180563]
curr_Stock_Price:  98.7962329020379
curr_Factors:  [98.7962329  -0.63743491 -0.99792201]
mat_Sqrt:  [[19.25368669  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01180984 -0.03927494  0.74554281]
Stock Position:  -0.011809844710211431
Bond Position:  [11.0785738]


portfolio before change:  [9.89770295]
curr_Stock_Price:  100.22492834117149
curr_Factors:  [100.22492834  -0.73238863  -1.01039763]
mat_Sqrt:  [[17.5425732   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00250041  0.01501882 -0.03367515]
Stock Position:  0.0025004134512434948
Bond Position:  [9.64709919]


portfolio before change:  [9.89905178]
curr_Stock_Price:  99.79969889042529
curr_Factors:  [99.79969889 -0.79676056 -1.02479405]
mat_Sqrt:  [[16.1450024   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00186195  0.02747892 -0.03452085]
Stock Position:  0.0018619523378514025
Bond Position:  [9.7132295]


portfolio before change:  [9.90017029]
curr_Stock_Price:  99.09608555927454
curr_Factors:  [99.09608556 -0.51443988 -1.02223987]
mat_Sqrt:  [[21.31498168  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00349812 -0.00338107 -0.38042396]
Stock Position:  0.003498123929271915
Bond Position:  [9.55351991]


portfolio before change:  [9.8982712]
curr_Stock_Price:  97.87035062487779
curr_Factors:  [97.87035062 -0.85781734 -1.01203269]
mat_Sqrt:  [[15.08639914  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00331139 -0.04578463 -0.91267321]
Stock Position:  -0.003311391155180515
Bond Position:  [10.22235821]


portfolio before change:  [9.90278487]
curr_Stock_Price:  97.27912966131562
curr_Factors:  [97.27912966 -1.07469149 -1.02512559]
mat_Sqrt:  [[11.91463398  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00058694  0.00244133 -0.00796703]
Stock Position:  -0.00058694434925083
Bond Position:  [9.95988231]


portfolio before change:  [9.90479179]
curr_Stock_Price:  98.10266052988868
curr_Factors:  [98.10266053 -0.82734057 -1.06268281]
mat_Sqrt:  [[14.82019999  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00080566 -0.02059394 -0.14131848]
Stock Position:  0.0008056595799239824
Bond Position:  [9.82575444]


portfolio before change:  [9.90740587]
curr_Stock_Price:  98.29795464807239
curr_Factors:  [98.29795465 -0.59170282 -1.11313194]
mat_Sqrt:  [[17.87080647  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0068086  -0.0011316   0.04104322]
Stock Position:  0.006808598247515256
Bond Position:  [9.23813459]


portfolio before change:  [9.91499949]
curr_Stock_Price:  99.07400102668896
curr_Factors:  [99.07400103 -0.93015732 -1.12490255]
mat_Sqrt:  [[12.68990993  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00054841  0.03265341  0.19480917]
Stock Position:  -0.0005484073994653114
Bond Position:  [9.9693324]


portfolio before change:  [9.91797089]
curr_Stock_Price:  98.20099462857564
curr_Factors:  [98.20099463 -0.81907239 -1.10450582]
mat_Sqrt:  [[14.34552619  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00295654 -0.00504759  0.06620456]
Stock Position:  0.0029565441404699076
Bond Position:  [9.62763532]


portfolio before change:  [9.91905542]
curr_Stock_Price:  97.75361960391926
curr_Factors:  [97.7536196  -0.41620052 -1.09390852]
mat_Sqrt:  [[21.59239529  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02044667 -0.30041582 -0.60890777]
Stock Position:  -0.0204466731446179
Bond Position:  [11.91779173]


portfolio before change:  [9.85524792]
curr_Stock_Price:  101.02003448138395
curr_Factors:  [101.02003448  -0.38093098  -1.08820898]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [9.85524792]
Stock Price:  102.37725615865041
PL:  [7.47799176]
Settle:  Tensor("sub_60:0", shape=(), dtype=float64)
PL:  Tensor("sub_61:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  31
output_Z_Vals[:, i, :]:  [[ 1.19251512e+02 -2.92846752e+01 -2.92776944e+01]
 [-7.79329760e-02  8.53160251e-03 -9.49585393e-02]
 [-2.24798384e-01 -4.93863762e-02  1.59006713e-01]
 [-5.10813535e-02  2.91989959e-02  2.93357404e-02]
 [-8.63623613e-02 -1.37730324e-01  1.09438603e-01]
 [-2.38619856e-01  1.20071523e-01  6.80924608e-04]
 [-3.02805178e-01 -3.01779333e-01  2.32080318e-01]
 [-3.19273591e-02  5.58341849e-02 -9.54779309e-02]
 [-2.84762850e-01 -1.25453397e-01  2.63852458e-01]
 [ 4.50470017e-02  4.74936917e-02 -1.18045691e-02]
 [ 3.90079192e-02  8.08752779e-02 -1.26184062e-02]
 [-3.64181158e-02 -5.09518034e-03 -7.91172029e-02]
 [ 3.85732228e-02 -1.33530154e-02 -2.51034478e-01]
 [-2.64476433e-02  1.65796493e-03  9.24998118e-04]
 [-1.72562456e-01  1.42946485e-01  3.15981168e-01]
 [-9.01186627e-02 -1.80501372e-01  1.73071953e-01]
 [-2.42223867e-02  2.34832832e-04  2.00754746e-01]
 [-5.36603926e-02  1.06927604e-01 -9.29651185e-02]
 [-3.65868494e-01 -1.00304557e+00 -2.23198718e-01]
 [ 7.07965421e-02 -3.12844670e-02 -7.77396725e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.25151208 -29.28467519 -29.2776944 ]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  8.31409947  -9.26062741 -83.52111278]
init_Out:  [2.49223638]
Stock Position:  8.314099471154409
Bond position:  [-828.91771073]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [2.52200632]
curr_Stock_Price:  100.02850883186622
curr_Factors:  [100.02850883  -0.695087    -0.98737652]
mat_Sqrt:  [[18.59684062  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0052211   0.00269793 -0.27089028]
Stock Position:  -0.005221103071774771
Bond Position:  [3.04426547]


portfolio before change:  [2.53532416]
curr_Stock_Price:  97.62352126287563
curr_Factors:  [97.62352126 -0.54584173 -0.96473959]
mat_Sqrt:  [[21.55347676  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00898307 -0.01561734  0.45360189]
Stock Position:  -0.008983071598059077
Bond Position:  [3.41228325]


portfolio before change:  [2.54123758]
curr_Stock_Price:  97.06021272184596
curr_Factors:  [97.06021272 -0.93098599 -0.9239786 ]
mat_Sqrt:  [[15.18589364  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00291977  0.00923353  0.0836867 ]
Stock Position:  -0.0029197692773979527
Bond Position:  [2.82463101]


portfolio before change:  [2.54721609]
curr_Stock_Price:  95.25449977279685
curr_Factors:  [95.25449977 -0.70616319 -0.93396156]
mat_Sqrt:  [[18.47516682  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00365786 -0.04355415  0.31219787]
Stock Position:  -0.0036578550207071892
Bond Position:  [2.89564324]


portfolio before change:  [2.55212705]
curr_Stock_Price:  94.1098518661603
curr_Factors:  [94.10985187 -0.48591249 -0.91924114]
mat_Sqrt:  [[23.08791014  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01019497  0.03796995  0.00194249]
Stock Position:  -0.010194973368748417
Bond Position:  [3.51157449]


portfolio before change:  [2.55019875]
curr_Stock_Price:  94.38511550525986
curr_Factors:  [94.38511551 -0.76935348 -0.91054118]
mat_Sqrt:  [[17.59278237  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01496204 -0.095431    0.66206055]
Stock Position:  -0.014962038701205452
Bond Position:  [3.9623925]


portfolio before change:  [2.51454427]
curr_Stock_Price:  96.83432736177886
curr_Factors:  [96.83432736 -0.46901415 -0.96568819]
mat_Sqrt:  [[23.06460551  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00216674  0.01765632 -0.27237196]
Stock Position:  -0.0021667432223083194
Bond Position:  [2.72435939]


portfolio before change:  [2.51038921]
curr_Stock_Price:  99.06635738854288
curr_Factors:  [99.06635739 -0.47566557 -0.94362768]
mat_Sqrt:  [[23.96265681  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00977118 -0.03967185  0.75269762]
Stock Position:  -0.009771178031916428
Bond Position:  [3.47838422]


portfolio before change:  [2.49536572]
curr_Stock_Price:  100.69289549960125
curr_Factors:  [100.6928955   -0.41523701  -0.9200961 ]
mat_Sqrt:  [[26.48933325  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0016559   0.01501882 -0.03367515]
Stock Position:  0.0016558999646551886
Bond Position:  [2.32862836]


portfolio before change:  [2.49616861]
curr_Stock_Price:  100.82615016233552
curr_Factors:  [100.82615016  -0.22459912  -0.91233521]
mat_Sqrt:  [[32.34512832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00119092  0.02557501 -0.0359968 ]
Stock Position:  0.001190917783728272
Bond Position:  [2.37609295]


portfolio before change:  [2.50140888]
curr_Stock_Price:  104.72749136513403
curr_Factors:  [104.72749137  -0.52267362  -0.92749244]
mat_Sqrt:  [[24.56187878  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00214558 -0.00161124 -0.22569936]
Stock Position:  -0.0021455770830471474
Bond Position:  [2.72610979]


portfolio before change:  [2.50404553]
curr_Stock_Price:  103.81629706382827
curr_Factors:  [103.81629706  -0.67758896  -0.94806074]
mat_Sqrt:  [[20.42936364  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-6.37011948e-04 -4.22259424e-03 -7.16131490e-01]
Stock Position:  -0.0006370119475499296
Bond Position:  [2.57017775]


portfolio before change:  [2.50385509]
curr_Stock_Price:  105.12405894072414
curr_Factors:  [105.12405894  -0.412516    -0.93943197]
mat_Sqrt:  [[27.19935325  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00096385  0.00052429  0.00263876]
Stock Position:  -0.0009638471959247835
Bond Position:  [2.60517862]


portfolio before change:  [2.50307449]
curr_Stock_Price:  106.60975538852284
curr_Factors:  [106.60975539  -0.68995584  -0.98964687]
mat_Sqrt:  [[19.87717953  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00525086  0.04520365  0.90140632]
Stock Position:  -0.005250856017786799
Bond Position:  [3.06286696]


portfolio before change:  [2.5129668]
curr_Stock_Price:  104.87165832617438
curr_Factors:  [104.87165833  -0.53978022  -0.98341904]
mat_Sqrt:  [[22.86341514  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00260027 -0.05707955  0.49372611]
Stock Position:  -0.002600268732637659
Bond Position:  [2.78566129]


portfolio before change:  [2.51662294]
curr_Stock_Price:  103.73345313789245
curr_Factors:  [103.73345314  -0.62824733  -0.99618119]
mat_Sqrt:  [[20.43800459  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [8.20166544e-04 7.42606618e-05 5.72697410e-01]
Stock Position:  0.0008201665438344201
Bond Position:  [2.43154423]


portfolio before change:  [2.51676522]
curr_Stock_Price:  103.16566447530417
curr_Factors:  [103.16566448  -0.6771659   -1.06671196]
mat_Sqrt:  [[18.03759583  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00387391  0.03381348 -0.26520361]
Stock Position:  -0.0038739064650584547
Bond Position:  [2.91641935]


portfolio before change:  [2.51828696]
curr_Stock_Price:  102.96107982787201
curr_Factors:  [102.96107983  -0.45659916  -1.0901605 ]
mat_Sqrt:  [[21.92420734  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01994723 -0.31719086 -0.63672382]
Stock Position:  -0.01994723274740857
Bond Position:  [4.57207558]


portfolio before change:  [2.49774859]
curr_Stock_Price:  104.04802422804785
curr_Factors:  [104.04802423  -0.83417977  -1.05758404]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [2.49774859]
Stock Price:  104.61951415864863
PL:  [-2.12176557]
Settle:  Tensor("sub_62:0", shape=(), dtype=float64)
PL:  Tensor("sub_63:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  32
output_Z_Vals[:, i, :]:  [[ 1.19251512e+02 -2.92846752e+01 -2.92776944e+01]
 [ 7.26344319e-03 -8.24749298e-02 -2.24187503e-01]
 [-6.32122310e-01 -1.15375235e-01  4.66718238e-01]
 [ 1.06031663e-01 -1.56249067e-01 -4.63377201e-01]
 [-9.57534345e-02 -2.16205145e-01  1.89036313e-01]
 [-1.01505190e-01  2.33272698e-02 -3.19976292e-02]
 [ 5.52288924e-02  3.98723798e-02 -2.04979445e-02]
 [-1.06278951e-01  1.49898867e-01 -3.90097920e-02]
 [-4.61795958e-01 -2.01352077e-01  4.33976975e-01]
 [ 5.12686751e-02  4.10406999e-02  2.02576322e-04]
 [ 3.32502613e-01 -2.21345874e-01 -1.35191738e-01]
 [-1.05115269e-01  1.10758062e-01  8.78015714e-02]
 [ 3.41901756e-02 -1.35058464e-02 -1.75852554e-01]
 [ 5.00433673e-02  7.47174191e-03  2.30543679e-01]
 [-2.95779607e-01  3.16599791e-01  4.93684702e-01]
 [-2.83468428e-01 -5.22845974e-01  3.33354436e-01]
 [-1.57727686e-01 -4.79670727e-01  1.05269202e-01]
 [-5.47946777e-01  7.56951486e-01 -1.43891642e-01]
 [-2.90381022e-01 -1.20008064e+00 -2.24571132e-01]
 [ 1.76997724e-01 -1.17460073e-01 -2.38237085e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.25151208 -29.28467519 -29.2776944 ]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  8.31409947  -9.26062741 -83.52111278]
init_Out:  [2.49223638]
Stock Position:  8.314099471154409
Bond position:  [-828.91771073]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [16.98466093]
curr_Stock_Price:  101.76804233984016
curr_Factors:  [101.76804234  -0.83160756  -1.00950303]
mat_Sqrt:  [[16.14459855  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00251652 -0.02608086 -0.63954454]
Stock Position:  -0.0025165155154911116
Bond Position:  [17.24076179]


portfolio before change:  [16.98553419]
curr_Stock_Price:  103.13400743054443
curr_Factors:  [103.13400743  -0.79819529  -1.01251543]
mat_Sqrt:  [[16.86631541  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.03200657 -0.03648485  1.33141722]
Stock Position:  -0.032006565243755516
Bond Position:  [20.28649953]


portfolio before change:  [16.98146197]
curr_Stock_Price:  103.41971384141124
curr_Factors:  [103.41971384  -0.58354383  -1.04912576]
mat_Sqrt:  [[20.20895867  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 3.66711342e-04 -4.94102935e-02 -1.32188617e+00]
Stock Position:  0.0003667113422672143
Bond Position:  [16.94353679]


portfolio before change:  [16.98436003]
curr_Stock_Price:  99.77011711079457
curr_Factors:  [99.77011711 -0.22953473 -1.03178116]
mat_Sqrt:  [[28.26297986  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00222018 -0.06837007  0.53926798]
Stock Position:  -0.002220181730627854
Bond Position:  [17.20586783]


portfolio before change:  [16.98826621]
curr_Stock_Price:  99.94840159393488
curr_Factors:  [99.94840159  0.16339464 -1.02919659]
mat_Sqrt:  [[42.04969436  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00255494  0.00737673 -0.09128033]
Stock Position:  -0.0025549382271417656
Bond Position:  [17.24362821]


portfolio before change:  [16.99089486]
curr_Stock_Price:  100.60704985885903
curr_Factors:  [100.60704986   0.27270385  -1.00590612]
mat_Sqrt:  [[48.32843279  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00107751  0.01260875 -0.05847493]
Stock Position:  0.001077507885748779
Bond Position:  [16.88248997]


portfolio before change:  [16.99430513]
curr_Stock_Price:  99.8544989273545
curr_Factors:  [99.85449893  0.50168982 -0.99742141]
mat_Sqrt:  [[60.82388356  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00181461  0.04740218 -0.11128408]
Stock Position:  -0.0018146065791017013
Bond Position:  [17.17550176]


portfolio before change:  [17.00254626]
curr_Stock_Price:  97.67952766833385
curr_Factors:  [97.67952767  0.64131773 -0.98126802]
mat_Sqrt:  [[69.52884478  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00544248 -0.06367312  1.23801552]
Stock Position:  -0.005442484600918717
Bond Position:  [17.53416558]


portfolio before change:  [17.0087467]
curr_Stock_Price:  97.34579057711291
curr_Factors:  [97.34579058  0.46797008 -0.95772653]
mat_Sqrt:  [[59.65112662  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00087793 0.01297821 0.00057789]
Stock Position:  0.0008779329935891967
Bond Position:  [16.92328362]


portfolio before change:  [17.02327901]
curr_Stock_Price:  109.07898821887889
curr_Factors:  [109.07898822   0.11657885  -0.97141527]
mat_Sqrt:  [[46.3970491   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0064485  -0.06999571 -0.3856644 ]
Stock Position:  0.006448504690987807
Bond Position:  [16.31988265]


portfolio before change:  [17.03320003]
curr_Stock_Price:  109.98470800969983
curr_Factors:  [ 1.09984708e+02 -5.20555995e-02 -9.90486531e-01]
mat_Sqrt:  [[38.77591115  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00217488  0.03502477  0.25047344]
Stock Position:  -0.002174883439056496
Bond Position:  [17.27240395]


portfolio before change:  [17.0327942]
curr_Stock_Price:  112.15699877915955
curr_Factors:  [112.15699878  -0.28761895  -1.01795314]
mat_Sqrt:  [[30.39650343  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-6.75833049e-05 -4.27092363e-03 -5.01658390e-01]
Stock Position:  -6.758330490877337e-05
Bond Position:  [17.04037414]


portfolio before change:  [17.03706885]
curr_Stock_Price:  111.94948978071218
curr_Factors:  [111.94948978  -0.20224835  -1.0305126 ]
mat_Sqrt:  [[32.63178563  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00298163 0.00236277 0.65767695]
Stock Position:  0.0029816271566073314
Bond Position:  [16.70327721]


portfolio before change:  [17.04273615]
curr_Stock_Price:  112.44954075957394
curr_Factors:  [112.44954076  -0.25461953  -1.00294274]
mat_Sqrt:  [[31.97461543  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00584314  0.10011764  1.40834504]
Stock Position:  -0.005843137297249156
Bond Position:  [17.69979426]


portfolio before change:  [17.04738953]
curr_Stock_Price:  112.41054233574422
curr_Factors:  [112.41054234  -0.52872331  -1.00312013]
mat_Sqrt:  [[24.29606201  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00942221 -0.16533841  0.95096742]
Stock Position:  -0.009422208589852552
Bond Position:  [18.1065451]


portfolio before change:  [17.00933841]
curr_Stock_Price:  116.92947414245042
curr_Factors:  [116.92947414  -0.57741695  -1.04255112]
mat_Sqrt:  [[23.14092975  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00642259 -0.1516852   0.30030373]
Stock Position:  -0.006422591771575329
Bond Position:  [17.76032869]


portfolio before change:  [17.02045507]
curr_Stock_Price:  115.89001472848138
curr_Factors:  [115.89001473  -0.59251971  -1.01560889]
mat_Sqrt:  [[23.20837012  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02403332  0.23936908 -0.4104828 ]
Stock Position:  -0.024033317697464
Bond Position:  [19.80567661]


portfolio before change:  [17.01874831]
curr_Stock_Price:  116.16708003393167
curr_Factors:  [116.16708003  -0.45559745  -1.0038082 ]
mat_Sqrt:  [[26.99424936  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01360317 -0.37949882 -0.64063893]
Stock Position:  -0.013603169920934525
Bond Position:  [18.59898884]


portfolio before change:  [17.01066003]
curr_Stock_Price:  117.10352391473481
curr_Factors:  [117.10352391  -0.68727412  -1.05057511]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [17.01066003]
Stock Price:  116.94462569322614
PL:  [0.06603434]
Settle:  Tensor("sub_64:0", shape=(), dtype=float64)
PL:  Tensor("sub_65:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  33
output_Z_Vals[:, i, :]:  [[ 1.19251512e+02 -2.92846752e+01 -2.92776944e+01]
 [ 2.34362470e-02 -7.14183513e-02 -1.71422651e-01]
 [-4.17924252e-01 -6.90231475e-02  2.82479260e-01]
 [-3.82672984e-02 -1.43516330e-01 -4.57874914e-01]
 [-9.88296441e-02 -2.41910939e-01  2.15109929e-01]
 [-3.51924096e-01  9.36408607e-02  8.52744942e-03]
 [ 5.10615817e-02  1.09206178e-01 -4.76883669e-02]
 [-1.91326293e-01  2.70132114e-01 -4.15630660e-02]
 [-7.67958130e-02 -2.09819128e-02  1.86869560e-02]
 [-1.08591062e-01 -8.36967192e-02 -4.79404627e-02]
 [ 2.62903711e-01 -1.45526371e-01 -1.00444797e-01]
 [-1.03945141e-01  2.10799771e-02 -1.39621438e-02]
 [ 3.25663178e-02 -1.59401774e-02 -2.69774164e-01]
 [ 2.45010782e-02  1.09614253e-02  1.67648792e-01]
 [-2.44667188e-01  2.44565659e-01  4.19970472e-01]
 [-2.25980355e-01 -4.23628381e-01  2.86287835e-01]
 [-5.57064061e-02 -1.17696236e-01  2.50867290e-01]
 [-2.24720494e-01  3.49407319e-01 -7.96219488e-02]
 [-2.69340175e-01 -9.76147918e-01 -8.89304202e-02]
 [ 1.12217559e-01 -5.63720756e-02 -1.31974470e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.25151208 -29.28467519 -29.2776944 ]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  8.31409947  -9.26062741 -83.52111278]
init_Out:  [2.49223638]
Stock Position:  8.314099471154409
Bond position:  [-828.91771073]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [13.52538952]
curr_Stock_Price:  101.3519694474055
curr_Factors:  [101.35196945  -0.90869394  -0.97823265]
mat_Sqrt:  [[15.35855614  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00087243 -0.02258447 -0.48902111]
Stock Position:  -0.0008724302577943416
Bond Position:  [13.61381204]


portfolio before change:  [13.52860407]
curr_Stock_Price:  101.56898469283912
curr_Factors:  [101.56898469  -1.05097137  -0.93719837]
mat_Sqrt:  [[13.90945012  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02602875 -0.02182704  0.8058347 ]
Stock Position:  -0.026028748889886922
Bond Position:  [16.17231766]


portfolio before change:  [13.5164618]
curr_Stock_Price:  102.1908299967551
curr_Factors:  [102.19083     -1.01361941  -0.93794231]
mat_Sqrt:  [[14.51641725  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00932986 -0.04538385 -1.30618968]
Stock Position:  -0.009329864053465715
Bond Position:  [14.46988835]


portfolio before change:  [13.50453969]
curr_Stock_Price:  103.85645289701219
curr_Factors:  [103.8564529   -1.17196531  -0.94451545]
mat_Sqrt:  [[12.51000743  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00488942 -0.07649896  0.61364875]
Stock Position:  -0.004889415742080175
Bond Position:  [14.01233706]


portfolio before change:  [13.50917167]
curr_Stock_Price:  103.6256549714742
curr_Factors:  [103.62565497  -0.85674257  -0.989499  ]
mat_Sqrt:  [[16.35515862  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02126336  0.02961184  0.02432644]
Stock Position:  -0.02126336097333225
Bond Position:  [15.71260138]


portfolio before change:  [13.47148082]
curr_Stock_Price:  105.58298895005477
curr_Factors:  [105.58298895  -0.70800326  -0.93894636]
mat_Sqrt:  [[20.33915106  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00217054  0.03453403 -0.13604164]
Stock Position:  0.0021705392634594205
Bond Position:  [13.24230879]


portfolio before change:  [13.47370137]
curr_Stock_Price:  105.08060819815546
curr_Factors:  [105.0806082   -0.77500519  -0.92525051]
mat_Sqrt:  [[19.19158805  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01004792  0.08542327 -0.11856786]
Stock Position:  -0.010047919791627476
Bond Position:  [14.52954289]


portfolio before change:  [13.46541434]
curr_Stock_Price:  106.26691015711285
curr_Factors:  [106.26691016  -0.55195762  -0.95047721]
mat_Sqrt:  [[23.65368991  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00310831 -0.00663506  0.05330868]
Stock Position:  -0.003108314391365421
Bond Position:  [13.79572531]


portfolio before change:  [13.46623473]
curr_Stock_Price:  107.11269815841376
curr_Factors:  [107.11269816  -0.60938863  -0.9215291 ]
mat_Sqrt:  [[23.17244392  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00520178 -0.02646723 -0.1367608 ]
Stock Position:  -0.00520177796724274
Bond Position:  [14.0234112]


portfolio before change:  [13.46914889]
curr_Stock_Price:  107.22653060246118
curr_Factors:  [107.2265306   -0.69818924  -0.95547747]
mat_Sqrt:  [[20.51747568  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01163121 -0.04601948 -0.28654105]
Stock Position:  0.011631208049291075
Bond Position:  [12.22197481]


portfolio before change:  [13.46050296]
curr_Stock_Price:  106.22046119640132
curr_Factors:  [106.2204612   -0.39948211  -0.98054174]
mat_Sqrt:  [[26.72215243  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00397613  0.00666607 -0.03983011]
Stock Position:  -0.00397613437919612
Bond Position:  [13.88284979]


portfolio before change:  [13.46241368]
curr_Stock_Price:  106.61290942361485
curr_Factors:  [106.61290942  -0.29300752  -0.97010505]
mat_Sqrt:  [[30.14719955  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-7.60026696e-04 -5.04072669e-03 -7.69590600e-01]
Stock Position:  -0.0007600266964024392
Bond Position:  [13.54344234]


portfolio before change:  [13.46293699]
curr_Stock_Price:  110.37984757957011
curr_Factors:  [110.37984758  -0.59171172  -0.95229362]
mat_Sqrt:  [[23.56876323  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00250354 0.00346631 0.47825534]
Stock Position:  0.002503536854655025
Bond Position:  [13.18659698]


portfolio before change:  [13.46515538]
curr_Stock_Price:  109.94898805237904
curr_Factors:  [109.94898805  -0.60662247  -0.9472649 ]
mat_Sqrt:  [[23.2459088   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00656573  0.07733845  1.19805886]
Stock Position:  -0.0065657324063649975
Bond Position:  [14.18705102]


portfolio before change:  [13.46855899]
curr_Stock_Price:  109.9708587541946
curr_Factors:  [109.97085875  -0.90367095  -0.98958987]
mat_Sqrt:  [[16.5594112   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01077817 -0.13396306  0.81669951]
Stock Position:  -0.010778169040795477
Bond Position:  [14.6538435]


portfolio before change:  [13.48776395]
curr_Stock_Price:  108.52895887912199
curr_Factors:  [108.52895888  -1.2884222   -0.96697314]
mat_Sqrt:  [[11.37731765  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-6.62479411e-04 -3.72188178e-02  7.15654550e-01]
Stock Position:  -0.0006624794108118037
Bond Position:  [13.55966215]


portfolio before change:  [13.49148865]
curr_Stock_Price:  108.024242705089
curr_Factors:  [108.02424271  -1.16484716  -1.01165906]
mat_Sqrt:  [[12.25396372  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0189287   0.1104923  -0.22713926]
Stock Position:  -0.018928699556936986
Bond Position:  [15.53624709]


portfolio before change:  [13.47203104]
curr_Stock_Price:  109.25740501805765
curr_Factors:  [109.25740502  -1.39208296  -1.02958905]
mat_Sqrt:  [[ 9.69911455  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.03223975 -0.30868508 -0.25369374]
Stock Position:  -0.03223975241389136
Bond Position:  [16.99446273]


portfolio before change:  [13.45522378]
curr_Stock_Price:  109.91052444177477
curr_Factors:  [109.91052444  -1.04762147  -1.05345019]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [13.45522378]
Stock Price:  110.89052354384995
PL:  [2.56470024]
Settle:  Tensor("sub_66:0", shape=(), dtype=float64)
PL:  Tensor("sub_67:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  34
output_Z_Vals[:, i, :]:  [[ 1.19251512e+02 -2.92846752e+01 -2.92776944e+01]
 [-2.85423186e-02  3.10245101e-03 -6.95536527e-02]
 [-6.37299118e-02  1.95573887e-02  7.22117351e-02]
 [-4.37422043e-02 -2.90616293e-02 -1.23417929e-01]
 [-9.88296441e-02 -2.41910939e-01  2.15109929e-01]
 [ 2.24368694e-02 -1.79273981e-01  2.93674321e-02]
 [-1.41758095e-02  5.38851412e-04  1.32917619e-02]
 [-1.46219626e-01  2.24159859e-01 -7.39687875e-02]
 [-5.90560986e-03  1.74890551e-03 -2.25305955e-02]
 [ 3.13140585e-02  3.68601405e-02 -1.18899019e-02]
 [ 1.16990164e-01  1.79691798e-02 -2.34564892e-02]
 [ 1.28724479e-01 -1.14738580e-02 -1.44870575e-01]
 [ 4.70427571e-02 -9.31942529e-03 -2.04854318e-01]
 [-8.45720117e-02  2.97281712e-02 -3.59999752e-02]
 [-9.69097601e-02  3.20764398e-02  1.87964351e-01]
 [ 7.53784291e-02 -9.87698212e-03  6.33635500e-02]
 [-2.50025580e-02  1.05220050e-01  7.10316320e-02]
 [ 1.26910159e-02  1.90136171e-02 -8.11447629e-02]
 [-3.37655473e-01 -9.16357801e-01 -1.55759860e-01]
 [ 7.73459615e-02 -4.63356702e-02 -9.71916291e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.25151208 -29.28467519 -29.2776944 ]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  8.31409947  -9.26062741 -83.52111278]
init_Out:  [2.49223638]
Stock Position:  8.314099471154409
Bond position:  [-828.91771073]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [3.95581734]
curr_Stock_Price:  100.20096419293571
curr_Factors:  [100.20096419  -0.8135563   -0.99631884]
mat_Sqrt:  [[16.40034986  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00260115  0.00098108 -0.19841721]
Stock Position:  -0.0026011514332720744
Bond Position:  [4.21645522]


portfolio before change:  [3.96031444]
curr_Stock_Price:  98.87737791969117
curr_Factors:  [98.87737792 -0.90868947 -0.98102657]
mat_Sqrt:  [[14.94182652  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0032449   0.00618459  0.20599998]
Stock Position:  -0.003244903388636404
Bond Position:  [4.28116197]


portfolio before change:  [3.95659057]
curr_Stock_Price:  100.35486212864606
curr_Factors:  [100.35486213  -1.14841398  -0.97998819]
mat_Sqrt:  [[11.94497104  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00583385 -0.00919009 -0.352077  ]
Stock Position:  -0.0058338485173925255
Bond Position:  [4.54204563]


portfolio before change:  [3.95674014]
curr_Stock_Price:  100.5238885830512
curr_Factors:  [100.52388858  -1.32186012  -0.96180569]
mat_Sqrt:  [[10.24438334  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00597075 -0.07649896  0.61364875]
Stock Position:  -0.005970747604268643
Bond Position:  [4.55694291]


portfolio before change:  [3.95950833]
curr_Stock_Price:  100.25109095991877
curr_Factors:  [100.25109096  -1.28009154  -0.97339032]
mat_Sqrt:  [[10.52966059  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00226053 -0.05669141  0.08377711]
Stock Position:  0.0022605322303924993
Bond Position:  [3.73288751]


portfolio before change:  [3.95824222]
curr_Stock_Price:  99.27811289456118
curr_Factors:  [99.27811289 -0.77272832 -0.95991855]
mat_Sqrt:  [[17.55393709  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0006522  0.0001704  0.0379177]
Stock Position:  -0.0006522027963604389
Bond Position:  [4.02299168]


portfolio before change:  [3.95672981]
curr_Stock_Price:  103.13930866701125
curr_Factors:  [103.13930867  -1.18370488  -0.96404612]
mat_Sqrt:  [[12.04114563  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0129166   0.07088557 -0.21101236]
Stock Position:  -0.012916599774713612
Bond Position:  [5.28893898]


portfolio before change:  [3.95412996]
curr_Stock_Price:  103.44296797939231
curr_Factors:  [103.44296798  -1.10163758  -1.00614562]
mat_Sqrt:  [[12.5690473   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00083216  0.00055305 -0.06427352]
Stock Position:  -0.0008321626616687607
Bond Position:  [4.04021134]


portfolio before change:  [3.95493643]
curr_Stock_Price:  103.68777183071701
curr_Factors:  [103.68777183  -1.22870163  -1.00121685]
mat_Sqrt:  [[11.15029227  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00267605  0.0116562  -0.03391858]
Stock Position:  0.0026760524677645757
Bond Position:  [3.67746251]


portfolio before change:  [3.95380358]
curr_Stock_Price:  102.92084894351275
curr_Factors:  [102.92084894  -1.12215506  -0.96500821]
mat_Sqrt:  [[12.76614781  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00882538  0.00568235 -0.06691483]
Stock Position:  0.008825378800199762
Bond Position:  [3.0454881]


portfolio before change:  [3.94758873]
curr_Stock_Price:  102.13036564390949
curr_Factors:  [102.13036564  -1.27384327  -0.95293665]
mat_Sqrt:  [[11.01733754  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00897283 -0.00362835 -0.41327543]
Stock Position:  0.008972825112548162
Bond Position:  [3.03119082]


portfolio before change:  [3.94437983]
curr_Stock_Price:  101.68827584006522
curr_Factors:  [101.68827584  -1.17324436  -0.97840199]
mat_Sqrt:  [[11.82558802  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 4.21663425e-04 -2.94706104e-03 -5.84392350e-01]
Stock Position:  0.00042166342509499216
Bond Position:  [3.90150161]


portfolio before change:  [3.9454394]
curr_Stock_Price:  101.88765948077453
curr_Factors:  [101.88765948  -0.73637239  -0.97484528]
mat_Sqrt:  [[18.40556669  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00495246  0.00940087 -0.10269791]
Stock Position:  -0.004952463529764416
Bond Position:  [4.45003432]


portfolio before change:  [3.94322624]
curr_Stock_Price:  102.55920650186505
curr_Factors:  [102.5592065   -0.58978132  -0.98098391]
mat_Sqrt:  [[21.32062719  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00270693  0.01014346  0.53620997]
Stock Position:  -0.002706931973962859
Bond Position:  [4.22084703]


portfolio before change:  [3.95321741]
curr_Stock_Price:  99.25811699736074
curr_Factors:  [99.258117   -0.80571468 -0.9968681 ]
mat_Sqrt:  [[16.36493468  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00538086 -0.00312338  0.18075857]
Stock Position:  0.005380860890261052
Bond Position:  [3.41912329]


portfolio before change:  [3.95496656]
curr_Stock_Price:  99.42431063034172
curr_Factors:  [99.42431063 -0.87640873 -1.01701212]
mat_Sqrt:  [[14.96891639  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00052018  0.0332735   0.20263347]
Stock Position:  -0.0005201790590785703
Bond Position:  [4.006685]


portfolio before change:  [3.95505117]
curr_Stock_Price:  101.18752331936324
curr_Factors:  [101.18752332  -1.13269895  -1.02834281]
mat_Sqrt:  [[11.65731286  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00029009  0.00601263 -0.23148342]
Stock Position:  -0.00029008914619614665
Bond Position:  [3.98440457]


portfolio before change:  [3.95587241]
curr_Stock_Price:  101.79073783577194
curr_Factors:  [101.79073784  -0.90737679  -1.07599834]
mat_Sqrt:  [[14.00681476  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02806563 -0.28977778 -0.44433952]
Stock Position:  -0.02806562980536575
Bond Position:  [6.81269357]


portfolio before change:  [3.98161681]
curr_Stock_Price:  100.93413809089778
curr_Factors:  [100.93413809  -0.88976222  -1.06237763]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [3.98161681]
Stock Price:  100.8224659630688
PL:  [3.15915084]
Settle:  Tensor("sub_68:0", shape=(), dtype=float64)
PL:  Tensor("sub_69:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  35
output_Z_Vals[:, i, :]:  [[ 1.19251512e+02 -2.92846752e+01 -2.92776944e+01]
 [-2.87902768e-01  1.03102993e-01  2.58542698e-01]
 [-5.56718796e-02  2.41957855e-02  8.81757597e-02]
 [-4.34289113e-02 -1.59830060e-02 -8.67565896e-02]
 [-9.63507820e-02 -2.21196772e-01  1.94099365e-01]
 [-3.45923468e-01  1.88246235e-01 -7.68327265e-03]
 [-8.02932255e-01 -8.86220932e-01  6.41779147e-01]
 [ 1.42080609e-02 -3.94175509e-02 -7.66569587e-02]
 [-3.86364253e-01 -3.33435495e-01  7.57188823e-01]
 [-1.06120714e-02 -4.82020959e-01  1.55187385e-01]
 [-2.89296056e-01  1.98651947e-01  4.90484955e-02]
 [-1.71856104e-01 -1.16080563e-02 -1.69825190e-01]
 [-8.17513163e-02 -4.27752907e-01 -1.83474703e-02]
 [ 1.75026683e-01 -1.52441982e-01 -4.71588267e-02]
 [ 1.11348156e-02 -5.79141975e-02 -1.09473076e-01]
 [ 2.07426514e-01  7.13643049e-02 -2.36909506e-01]
 [-5.79366485e-02 -1.08499954e-01 -1.23849527e-01]
 [ 3.52247922e-02 -2.77368856e-02  1.33240957e-01]
 [-2.83792840e-01 -7.23966727e-01 -1.40990214e-01]
 [ 1.34892313e-01 -3.00269643e-01 -5.77431844e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.25151208 -29.28467519 -29.2776944 ]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  8.31409947  -9.26062741 -83.52111278]
init_Out:  [2.49223638]
Stock Position:  8.314099471154409
Bond position:  [-828.91771073]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-12.50491442]
curr_Stock_Price:  98.2211067451682
curr_Factors:  [98.22110675 -0.72324526 -0.98087781]
mat_Sqrt:  [[17.86954834  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01300905  0.03260403  0.73755035]
Stock Position:  -0.013009050311994359
Bond Position:  [-11.2271511]


portfolio before change:  [-12.51828056]
curr_Stock_Price:  99.03277272579092
curr_Factors:  [99.03277273 -0.72809268 -0.93956324]
mat_Sqrt:  [[18.68637994  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00198264  0.00765138  0.2515409 ]
Stock Position:  -0.0019826389955216114
Bond Position:  [-12.32193432]


portfolio before change:  [-12.52323609]
curr_Stock_Price:  99.97830923503922
curr_Factors:  [99.97830924 -0.64882846 -0.91228573]
mat_Sqrt:  [[20.98565406  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00293299 -0.00505427 -0.2474924 ]
Stock Position:  -0.002932989618368499
Bond Position:  [-12.23000074]


portfolio before change:  [-12.52399784]
curr_Stock_Price:  99.19544657192013
curr_Factors:  [99.19544657 -0.10923543 -0.92377612]
mat_Sqrt:  [[35.30697557  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00176854 -0.06994856  0.55371146]
Stock Position:  -0.001768536956349296
Bond Position:  [-12.34856703]


portfolio before change:  [-12.51687119]
curr_Stock_Price:  93.41995145339246
curr_Factors:  [93.41995145  0.42262416 -0.89336078]
mat_Sqrt:  [[58.34468805  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00587254  0.05952869 -0.02191824]
Stock Position:  -0.005872536537076376
Bond Position:  [-11.96825911]


portfolio before change:  [-12.47335348]
curr_Stock_Price:  85.50000969033485
curr_Factors:  [85.50000969  0.14752091 -0.90299565]
mat_Sqrt:  [[40.16683861  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01729814 -0.28024767  1.83081727]
Stock Position:  -0.017298144063322873
Bond Position:  [-10.994362]


portfolio before change:  [-12.44092992]
curr_Stock_Price:  83.46669930560677
curr_Factors:  [ 8.34666993e+01 -3.80166192e-02 -8.68748496e-01]
mat_Sqrt:  [[33.70622798  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-7.29014241e-05 -1.24649241e-02 -2.18680966e-01]
Stock Position:  -7.290142413402606e-05
Bond Position:  [-12.43484508]


portfolio before change:  [-12.44424892]
curr_Stock_Price:  86.34596383742971
curr_Factors:  [ 8.63459638e+01 -6.24949412e-02 -8.95320530e-01]
mat_Sqrt:  [[33.13355751  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00725588 -0.10544156  2.16004895]
Stock Position:  -0.007255876441245498
Bond Position:  [-11.81773328]


portfolio before change:  [-12.43569084]
curr_Stock_Price:  84.75926536243175
curr_Factors:  [84.75926536 -0.19960961 -0.89304889]
mat_Sqrt:  [[28.42180297  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 3.03277496e-04 -1.52428411e-01  4.42706413e-01]
Stock Position:  0.00030327749627116307
Bond Position:  [-12.46139642]


portfolio before change:  [-12.43738701]
curr_Stock_Price:  89.44000952617624
curr_Factors:  [89.44000953 -0.60659329 -0.87723247]
mat_Sqrt:  [[20.28217369  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01351704  0.06281926  0.13992171]
Stock Position:  -0.013517037536335956
Bond Position:  [-11.22842305]


portfolio before change:  [-12.43130045]
curr_Stock_Price:  88.78202365729624
curr_Factors:  [88.78202366 -0.52215552 -0.88444471]
mat_Sqrt:  [[21.74935205  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00950931 -0.00367079 -0.484464  ]
Stock Position:  -0.009509306010760684
Bond Position:  [-11.58704502]


portfolio before change:  [-12.44879466]
curr_Stock_Price:  90.31705546937428
curr_Factors:  [90.31705547 -0.74250531 -0.88380944]
mat_Sqrt:  [[17.76111585  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00543553 -0.13526735 -0.05234023]
Stock Position:  -0.0054355261995225465
Bond Position:  [-11.95787394]


portfolio before change:  [-12.44051709]
curr_Stock_Price:  88.24413463702017
curr_Factors:  [88.24413464 -0.70416801 -0.88631311]
mat_Sqrt:  [[17.98658335  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00897694 -0.04820639 -0.13453101]
Stock Position:  0.008976935153540687
Bond Position:  [-13.23267896]


portfolio before change:  [-12.4332608]
curr_Stock_Price:  89.4210250852233
curr_Factors:  [89.42102509 -0.69236117 -0.89399038]
mat_Sqrt:  [[18.30188923  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00069428 -0.01831408 -0.31229621]
Stock Position:  -0.0006942791808419253
Bond Position:  [-12.37117764]


portfolio before change:  [-12.43554748]
curr_Stock_Price:  88.25939022864652
curr_Factors:  [88.25939023 -0.86291783 -0.84707299]
mat_Sqrt:  [[15.96325101  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01008004  0.02256737 -0.67583688]
Stock Position:  0.010080038334998218
Bond Position:  [-13.32520552]


portfolio before change:  [-12.44457971]
curr_Stock_Price:  87.69386559497542
curr_Factors:  [87.69386559 -1.26109218 -0.89723632]
mat_Sqrt:  [[10.13022416  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0084913  -0.0343107  -0.35330823]
Stock Position:  -0.008491301162163466
Bond Position:  [-11.69994469]


portfolio before change:  [-12.43874491]
curr_Stock_Price:  86.66220404145868
curr_Factors:  [86.66220404 -0.92313579 -0.88427351]
mat_Sqrt:  [[14.21941881  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00433958 -0.00877117  0.38009936]
Stock Position:  0.00433958139997388
Bond Position:  [-12.8148226]


portfolio before change:  [-12.44192246]
curr_Stock_Price:  86.66832414837211
curr_Factors:  [86.66832415 -1.28742617 -0.90538848]
mat_Sqrt:  [[ 9.67237442  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.03424858 -0.22893838 -0.40220584]
Stock Position:  -0.034248579860026405
Bond Position:  [-9.47365544]


portfolio before change:  [-12.42920552]
curr_Stock_Price:  86.22784903026064
curr_Factors:  [86.22784903 -1.26952889 -0.9518689 ]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-12.42920552]
Stock Price:  84.87684431517633
PL:  [-12.42920552]
Settle:  Tensor("sub_70:0", shape=(), dtype=float64)
PL:  Tensor("sub_71:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  36
output_Z_Vals[:, i, :]:  [[ 1.19251512e+02 -2.92846752e+01 -2.92776944e+01]
 [ 9.68317250e-03 -8.08206757e-02 -2.16292975e-01]
 [-4.02031278e-01 -6.55839356e-02  2.68809177e-01]
 [-3.63289483e-02 -1.29618305e-01 -4.16000449e-01]
 [-9.88296441e-02 -2.41910939e-01  2.15109929e-01]
 [-2.08111111e-01 -8.54355908e-03  8.36315020e-03]
 [ 5.21645254e-02  9.08559088e-02 -4.04919984e-02]
 [-1.15782110e-01  1.87092060e-01 -8.38971014e-02]
 [-2.47203258e-01 -1.11495517e-01  2.32920488e-01]
 [ 4.50470017e-02  4.74936917e-02 -1.18045691e-02]
 [ 4.90991565e-02  7.29846898e-02 -1.34165779e-02]
 [ 1.54144486e-01 -1.22193268e-02 -1.55848714e-01]
 [ 3.13963285e-02 -4.48443409e-02 -4.99883723e-01]
 [-4.09012796e-02  1.49385506e-02 -2.46724382e-02]
 [ 1.24373399e-02 -5.86699209e-02 -1.03550495e-01]
 [ 1.72736676e-01  4.07405058e-02 -1.04363013e-01]
 [ 1.73448315e-03  2.95749339e-02  8.74858517e-02]
 [ 2.70656426e-02 -2.89889845e-03 -5.68100510e-03]
 [-5.10056609e-01 -1.29105689e+00 -4.42811640e-01]
 [ 1.47762143e-01 -3.70385719e-01 -7.06758862e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.25151208 -29.28467519 -29.2776944 ]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  8.31409947  -9.26062741 -83.52111278]
init_Out:  [2.49223638]
Stock Position:  8.314099471154409
Bond position:  [-828.91771073]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [11.13818673]
curr_Stock_Price:  101.06484240577626
curr_Factors:  [101.06484241  -1.17513962  -1.03989796]
mat_Sqrt:  [[11.03116821  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00331372 -0.02555774 -0.61702365]
Stock Position:  -0.0033137221961076543
Bond Position:  [11.47308755]


portfolio before change:  [11.1389841]
curr_Stock_Price:  101.68989852871383
curr_Factors:  [101.68989853  -0.63050971  -1.04011014]
mat_Sqrt:  [[19.13096305  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01823506 -0.02073946  0.76683776]
Stock Position:  -0.01823505716086574
Bond Position:  [12.99330521]


portfolio before change:  [11.14287165]
curr_Stock_Price:  101.65486645420857
curr_Factors:  [101.65486645  -0.24435699  -1.0590391 ]
mat_Sqrt:  [[27.61025657  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0045125  -0.04098891 -1.18673349]
Stock Position:  -0.00451250477707372
Bond Position:  [11.60158972]


portfolio before change:  [11.14367411]
curr_Stock_Price:  102.11986317012398
curr_Factors:  [102.11986317  -0.53787911  -1.04813159]
mat_Sqrt:  [[20.90809822  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0029255  -0.07649896  0.61364875]
Stock Position:  -0.002925499325691121
Bond Position:  [11.4424257]


portfolio before change:  [11.14671246]
curr_Stock_Price:  102.05922794787301
curr_Factors:  [102.05922795  -0.70242318  -1.05493182]
mat_Sqrt:  [[17.60527047  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01173652 -0.00270171  0.02385774]
Stock Position:  -0.011736518601391719
Bond Position:  [12.34453249]


portfolio before change:  [11.13300573]
curr_Stock_Price:  103.4900826466032
curr_Factors:  [103.49008265  -0.7181691   -1.09868585]
mat_Sqrt:  [[16.82087777  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00274926  0.02873116 -0.1155124 ]
Stock Position:  0.0027492632020197664
Bond Position:  [10.84848425]


portfolio before change:  [11.13000878]
curr_Stock_Price:  101.41337936356328
curr_Factors:  [101.41337936  -1.02938936  -1.10491684]
mat_Sqrt:  [[11.9999062   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01067315  0.0591637  -0.23933508]
Stock Position:  -0.010673153238585533
Bond Position:  [12.21240932]


portfolio before change:  [11.15431443]
curr_Stock_Price:  99.42220017196135
curr_Factors:  [99.42220017 -0.57079972 -1.08018382]
mat_Sqrt:  [[19.07525405  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01061781 -0.03525798  0.66445732]
Stock Position:  -0.01061780692672061
Bond Position:  [12.20996015]


portfolio before change:  [11.14043928]
curr_Stock_Price:  101.01650447837407
curr_Factors:  [101.01650448  -0.75492608  -1.10051203]
mat_Sqrt:  [[15.79740683  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00277664  0.01501882 -0.03367515]
Stock Position:  0.002776638372531268
Bond Position:  [10.85995298]


portfolio before change:  [11.14342876]
curr_Stock_Price:  101.11523862322085
curr_Factors:  [101.11523862  -0.49019118  -1.12417879]
mat_Sqrt:  [[20.12355205  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00239744  0.02307979 -0.03827376]
Stock Position:  0.002397437862270549
Bond Position:  [10.90101126]


portfolio before change:  [11.14355057]
curr_Stock_Price:  100.02917115031076
curr_Factors:  [100.02917115  -0.37258264  -1.11419164]
mat_Sqrt:  [[22.61667758  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00539498 -0.00386409 -0.444593  ]
Stock Position:  0.005394978944242416
Bond Position:  [10.6038953]


portfolio before change:  [11.14828335]
curr_Stock_Price:  100.41498706361182
curr_Factors:  [100.41498706  -0.19921868  -1.11332345]
mat_Sqrt:  [[27.02518849  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00265678 -0.01418103 -1.42602912]
Stock Position:  -0.0026567764774637005
Bond Position:  [11.41506352]


portfolio before change:  [11.15780603]
curr_Stock_Price:  97.90496743749927
curr_Factors:  [97.90496744 -0.17231103 -1.07996379]
mat_Sqrt:  [[27.98650614  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00162763  0.00472398 -0.0703836 ]
Stock Position:  -0.0016276346892809828
Bond Position:  [11.31715955]


portfolio before change:  [11.16186104]
curr_Stock_Price:  97.15211776808836
curr_Factors:  [ 9.71521178e+01  2.36391891e-03 -1.09727746e+00]
mat_Sqrt:  [[32.50404133  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00031426 -0.01855306 -0.29540074]
Stock Position:  -0.0003142583770949585
Bond Position:  [11.19239191]


portfolio before change:  [11.16502667]
curr_Stock_Price:  95.9837119203268
curr_Factors:  [95.98371192  0.12818895 -1.05397252]
mat_Sqrt:  [[38.03074626  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00400953  0.01288328 -0.29771863]
Stock Position:  0.004009534261018379
Bond Position:  [10.78017669]


portfolio before change:  [11.16296693]
curr_Stock_Price:  94.79775972374192
curr_Factors:  [94.79775972  0.22816055 -1.07522597]
mat_Sqrt:  [[40.63705579  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00050092 0.00935242 0.24957278]
Stock Position:  0.0005009240694238145
Bond Position:  [11.11548045]


portfolio before change:  [11.16620714]
curr_Stock_Price:  95.71804224815874
curr_Factors:  [95.71804225  0.53355656 -1.05459895]
mat_Sqrt:  [[56.84705552  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0004544  -0.00091671 -0.01620633]
Stock Position:  0.0004543975553443372
Bond Position:  [11.1227131]


portfolio before change:  [11.1658055]
curr_Stock_Price:  88.71388958861007
curr_Factors:  [88.71388959  0.46361615 -1.08515677]
mat_Sqrt:  [[47.64967649  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01330083 -0.40826803 -1.26321835]
Stock Position:  -0.013300826968626308
Bond Position:  [12.34577359]


portfolio before change:  [11.21900001]
curr_Stock_Price:  84.94662912832632
curr_Factors:  [84.94662913  0.69180135 -1.08362707]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [11.21900001]
Stock Price:  91.35642491790877
PL:  [11.21900001]
Settle:  Tensor("sub_72:0", shape=(), dtype=float64)
PL:  Tensor("sub_73:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  37
output_Z_Vals[:, i, :]:  [[ 1.19251512e+02 -2.92846752e+01 -2.92776944e+01]
 [-1.56628380e-01  1.71820091e-02 -1.35436798e-01]
 [-9.13141078e-02  1.52563964e-02  1.09132159e-01]
 [-4.14481732e-02 -1.91690843e-02 -9.53865016e-02]
 [-9.88296441e-02 -2.41910939e-01  2.15109929e-01]
 [-1.09856173e-01 -1.15638760e-01  3.73330612e-02]
 [ 5.29005010e-02  7.86110844e-02 -3.56899833e-02]
 [-1.36758640e-01  2.22595329e-01 -9.58311231e-02]
 [ 1.34056957e-03 -1.94367461e-03 -1.72963464e-02]
 [ 3.78057291e-02  3.66580056e-02 -1.04374641e-02]
 [ 1.48409194e-01 -1.84396424e-02 -4.08851443e-02]
 [-6.07577478e-02 -3.46514563e-04 -5.02280540e-02]
 [ 5.40781851e-02 -4.82427896e-03 -1.07875237e-01]
 [-8.45720117e-02  2.97281712e-02 -3.59999752e-02]
 [-1.06695174e-01  4.48181554e-02  1.97409345e-01]
 [-6.73906008e-02 -1.44252155e-01  1.55146880e-01]
 [-2.70177735e-02  4.55917190e-02  1.54484269e-01]
 [-4.15700689e-02  9.66111810e-02 -7.50248540e-02]
 [-2.78081731e-01 -8.54445550e-01 -5.50446420e-02]
 [ 5.48358273e-02  5.39480944e-03 -3.03359074e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.25151208 -29.28467519 -29.2776944 ]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  8.31409947  -9.26062741 -83.52111278]
init_Out:  [2.49223638]
Stock Position:  8.314099471154409
Bond position:  [-828.91771073]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [0.83043789]
curr_Stock_Price:  99.82505102696618
curr_Factors:  [99.82505103 -0.94375598 -0.97445902]
mat_Sqrt:  [[14.66119444  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01253859  0.00543343 -0.38636349]
Stock Position:  -0.012538587038762166
Bond Position:  [2.08210298]


portfolio before change:  [0.83633801]
curr_Stock_Price:  99.39601291376233
curr_Factors:  [99.39601291 -0.95846743 -0.97974706]
mat_Sqrt:  [[14.3091259   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0047972   0.0048245   0.31132367]
Stock Position:  -0.004797195932536386
Bond Position:  [1.31316016]


portfolio before change:  [0.8322855]
curr_Stock_Price:  100.30922163026561
curr_Factors:  [100.30922163  -1.27174186  -0.96203563]
mat_Sqrt:  [[10.74542562  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00571534 -0.0060618  -0.27211114]
Stock Position:  -0.0057153440996747604
Bond Position:  [1.40558722]


portfolio before change:  [0.83124271]
curr_Stock_Price:  100.5531666828764
curr_Factors:  [100.55316668  -1.27873733  -0.93477386]
mat_Sqrt:  [[10.99208435  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00556461 -0.07649896  0.61364875]
Stock Position:  -0.005564606792512987
Bond Position:  [1.39078154]


portfolio before change:  [0.82406277]
curr_Stock_Price:  101.90594517471516
curr_Factors:  [101.90594517  -1.56510457  -0.98824771]
mat_Sqrt:  [[ 7.93035658  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01326818 -0.03656819  0.10650083]
Stock Position:  -0.013268176903571263
Bond Position:  [2.17616888]


portfolio before change:  [0.80705914]
curr_Stock_Price:  103.22848817028208
curr_Factors:  [103.22848817  -1.44367893  -1.03620545]
mat_Sqrt:  [[ 8.64568618  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00551085  0.02485901 -0.10181359]
Stock Position:  0.0055108457751003375
Bond Position:  [0.23818287]


portfolio before change:  [0.80605331]
curr_Stock_Price:  103.03516266325452
curr_Factors:  [103.03516266  -1.7284934   -1.03589181]
mat_Sqrt:  [[ 6.49274307  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02319092  0.07039082 -0.27337952]
Stock Position:  -0.023190922265228356
Bond Position:  [3.19553376]


portfolio before change:  [0.80494978]
curr_Stock_Price:  103.11719956576192
curr_Factors:  [103.11719957  -1.7649654   -1.01868824]
mat_Sqrt:  [[ 6.37390658  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00035147 -0.00061464 -0.04934166]
Stock Position:  -0.00035146699713067267
Bond Position:  [0.84119208]


portfolio before change:  [0.80504231]
curr_Stock_Price:  103.45234860178861
curr_Factors:  [103.4523486   -1.57932287  -1.06353008]
mat_Sqrt:  [[ 7.36145914  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00497479  0.01159228 -0.02977518]
Stock Position:  0.004974787685032506
Bond Position:  [0.29038884]


portfolio before change:  [0.80790737]
curr_Stock_Price:  104.01366987394545
curr_Factors:  [104.01366987  -1.58269505  -1.05884715]
mat_Sqrt:  [[ 7.4111093   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01883489 -0.00583113 -0.11663394]
Stock Position:  0.018834891423946863
Bond Position:  [-1.1511788]


portfolio before change:  [0.81665625]
curr_Stock_Price:  104.49345546579366
curr_Factors:  [104.49345547  -1.51481979  -1.08503946]
mat_Sqrt:  [[ 7.76219524  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-9.14940312e-03 -1.09577526e-04 -1.43286657e-01]
Stock Position:  -0.009149403118349175
Bond Position:  [1.772709]


portfolio before change:  [0.82581627]
curr_Stock_Price:  103.54073901666503
curr_Factors:  [103.54073902  -1.55618964  -1.06979053]
mat_Sqrt:  [[ 7.49311783  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00426173 -0.00152557 -0.30773802]
Stock Position:  0.004261734968331156
Bond Position:  [0.38455308]


portfolio before change:  [0.82144284]
curr_Stock_Price:  102.49196850409714
curr_Factors:  [102.4919685   -1.30838345  -1.0318143 ]
mat_Sqrt:  [[ 9.87085716  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00923455  0.00940087 -0.10269791]
Stock Position:  -0.009234547347244139
Bond Position:  [1.76790978]


portfolio before change:  [0.81591826]
curr_Stock_Price:  103.13808697091483
curr_Factors:  [103.13808697  -1.76419325  -1.06381804]
mat_Sqrt:  [[ 6.09858911  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01069788  0.01417275  0.56315391]
Stock Position:  -0.010697877771352495
Bond Position:  [1.91927691]


portfolio before change:  [0.8146419]
curr_Stock_Price:  103.30225424161537
curr_Factors:  [103.30225424  -1.62633634  -1.07704445]
mat_Sqrt:  [[ 6.91904951  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00570107 -0.04561654  0.44259086]
Stock Position:  -0.005701065021195773
Bond Position:  [1.40357477]


portfolio before change:  [0.81343981]
curr_Stock_Price:  103.57466449173579
curr_Factors:  [103.57466449  -1.66904903  -1.11712281]
mat_Sqrt:  [[ 6.38608181  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00089153 0.01441737 0.44070062]
Stock Position:  0.0008915277212096397
Bond Position:  [0.72110012]


portfolio before change:  [0.8136714]
curr_Stock_Price:  103.6321946579166
curr_Factors:  [103.63219466  -1.78929777  -1.09031079]
mat_Sqrt:  [[ 5.81964628  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00934592  0.03055114 -0.21402503]
Stock Position:  -0.00934592249768329
Bond Position:  [1.78220986]


portfolio before change:  [0.81733091]
curr_Stock_Price:  103.28831145535283
curr_Factors:  [103.28831146  -1.60476439  -1.10851921]
mat_Sqrt:  [[ 6.849945    0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.04545721 -0.27019941 -0.15702704]
Stock Position:  -0.04545720600825457
Bond Position:  [5.51252896]


portfolio before change:  [0.79353049]
curr_Stock_Price:  103.84221100396424
curr_Factors:  [103.842211    -1.40727436  -1.1445702 ]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [0.79353049]
Stock Price:  103.61463796769914
PL:  [-2.82110748]
Settle:  Tensor("sub_74:0", shape=(), dtype=float64)
PL:  Tensor("sub_75:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  38
output_Z_Vals[:, i, :]:  [[ 1.19251512e+02 -2.92846752e+01 -2.92776944e+01]
 [-2.53316849e-01  8.87879816e-02  2.08031186e-01]
 [-4.50917155e-01 -1.37649563e-01  4.29198909e-01]
 [-4.63816390e-02  3.21241005e-02  3.83566134e-02]
 [-8.36527121e-02 -1.15087626e-01  8.64719123e-02]
 [-1.79486373e-01  8.69833210e-02  1.79966063e-03]
 [-2.81936445e-01 -2.79795205e-01  2.16310681e-01]
 [ 9.77643436e-03 -2.83830975e-02 -8.65015639e-02]
 [-3.43568751e-01 -1.91516815e-01  4.18677360e-01]
 [ 1.46065312e-02  5.03930962e-03  1.17007037e-02]
 [ 3.91671649e-02  8.24958172e-02 -1.22540547e-02]
 [ 2.41758182e-01 -1.47886917e-02 -1.93686440e-01]
 [ 2.84181064e-02 -1.91214040e-02 -3.54140386e-01]
 [-8.45720117e-02  2.97281712e-02 -3.59999752e-02]
 [-1.03984895e-01  4.61193434e-02  2.16282806e-01]
 [-4.80477207e-02 -1.05146519e-01  1.37997888e-01]
 [-2.29742464e-02  2.11156856e-02  1.68655295e-01]
 [-8.85927530e-02  1.55290441e-01 -9.34352365e-02]
 [-3.23026548e-01 -9.17009759e-01 -1.48729127e-01]
 [ 8.31993950e-02 -5.48229091e-02 -1.09705105e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.25151208 -29.28467519 -29.2776944 ]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  8.31409947  -9.26062741 -83.52111278]
init_Out:  [2.49223638]
Stock Position:  8.314099471154409
Bond position:  [-828.91771073]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-9.39251399]
curr_Stock_Price:  98.59545882512447
curr_Factors:  [98.59545883 -0.84959146 -1.00790869]
mat_Sqrt:  [[15.38703165  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01355428  0.02807723  0.59345507]
Stock Position:  -0.01355428195295527
Bond Position:  [-8.05612334]


portfolio before change:  [-9.36588579]
curr_Stock_Price:  96.48229065687102
curr_Factors:  [96.48229066 -0.49434711 -0.97591812]
mat_Sqrt:  [[22.17785448  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01654179 -0.04352861  1.22438502]
Stock Position:  -0.016541789094924774
Bond Position:  [-7.76989609]


portfolio before change:  [-9.39024141]
curr_Stock_Price:  97.83721693101786
curr_Factors:  [97.83721693 -0.55783009 -1.03473351]
mat_Sqrt:  [[19.90043204  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00189557  0.01015853  0.10942074]
Stock Position:  -0.0018955712772059548
Bond Position:  [-9.204784]


portfolio before change:  [-9.38961878]
curr_Stock_Price:  96.29461363301395
curr_Factors:  [96.29461363 -0.59276078 -1.04040109]
mat_Sqrt:  [[18.80740199  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00366735 -0.0363939   0.2466803 ]
Stock Position:  -0.003667346327609805
Bond Position:  [-9.03647309]


portfolio before change:  [-9.38978058]
curr_Stock_Price:  95.72264610722182
curr_Factors:  [95.72264611 -0.52914872 -1.06228848]
mat_Sqrt:  [[19.49226489  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00907402  0.02750654  0.00513393]
Stock Position:  -0.009074015793034934
Bond Position:  [-8.52119178]


portfolio before change:  [-9.38418631]
curr_Stock_Price:  94.8713319893284
curr_Factors:  [94.87133199 -0.42481314 -1.00500926]
mat_Sqrt:  [[22.70758856  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01078963 -0.08847901  0.61707416]
Stock Position:  -0.010789630649901802
Bond Position:  [-8.36055968]


portfolio before change:  [-9.38468979]
curr_Stock_Price:  94.7242541629335
curr_Factors:  [94.72425416 -0.47951209 -0.99366339]
mat_Sqrt:  [[21.71046942  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00039674 -0.00897552 -0.24676488]
Stock Position:  -0.000396742773398473
Bond Position:  [-9.34710863]


portfolio before change:  [-9.38736711]
curr_Stock_Price:  95.58184853906093
curr_Factors:  [95.58184854 -0.23969921 -0.96613519]
mat_Sqrt:  [[28.62122379  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00919079 -0.06056293  1.19436997]
Stock Position:  -0.0091907857556507
Bond Position:  [-8.50889482]


portfolio before change:  [-9.39350227]
curr_Stock_Price:  96.01790162822158
curr_Factors:  [96.01790163 -0.10231205 -0.95778683]
mat_Sqrt:  [[33.26267093  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00051484 0.00159357 0.03337885]
Stock Position:  0.000514842654544285
Bond Position:  [-9.44293638]


portfolio before change:  [-9.39424187]
curr_Stock_Price:  99.16726463717761
curr_Factors:  [ 9.91672646e+01 -7.47743202e-02 -9.84096546e-01]
mat_Sqrt:  [[34.39589067  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00112792  0.02608747 -0.03495741]
Stock Position:  0.0011279210539285446
Bond Position:  [-9.50609472]


portfolio before change:  [-9.39324133]
curr_Stock_Price:  102.16159147244053
curr_Factors:  [102.16159147  -0.26293057  -1.0145389 ]
mat_Sqrt:  [[28.47670325  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00708791 -0.00467659 -0.5525335 ]
Stock Position:  0.007087908273754394
Bond Position:  [-10.11735332]


portfolio before change:  [-9.38526457]
curr_Stock_Price:  103.64389250627453
curr_Factors:  [103.64389251  -0.11722853  -1.03149389]
mat_Sqrt:  [[32.85942085  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00135012 -0.00604672 -1.01026395]
Stock Position:  -0.0013501214745973633
Bond Position:  [-9.24533272]


portfolio before change:  [-9.38422265]
curr_Stock_Price:  101.16001301633803
curr_Factors:  [101.16001302  -0.29820172  -1.02032257]
mat_Sqrt:  [[27.06331861  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00336813  0.00940087 -0.10269791]
Stock Position:  -0.0033681345249409835
Bond Position:  [-9.04350212]


portfolio before change:  [-9.39302036]
curr_Stock_Price:  103.10071619554127
curr_Factors:  [103.1007162   -0.67332315  -1.00963158]
mat_Sqrt:  [[19.15859816  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00306106  0.01458422  0.61699464]
Stock Position:  -0.0030610567367666884
Bond Position:  [-9.07742322]


portfolio before change:  [-9.3958392]
curr_Stock_Price:  103.28013233997449
curr_Factors:  [103.28013234  -0.44127824  -0.98681408]
mat_Sqrt:  [[24.7630521   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0009124  -0.03325025  0.39366956]
Stock Position:  -0.0009124033350245795
Bond Position:  [-9.30160606]


portfolio before change:  [-9.39769553]
curr_Stock_Price:  102.76570539902552
curr_Factors:  [102.7657054   -0.5241255   -0.95936878]
mat_Sqrt:  [[23.31174745  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00051466 0.00667737 0.48112661]
Stock Position:  0.0005146579467792862
Bond Position:  [-9.45058472]


portfolio before change:  [-9.39940986]
curr_Stock_Price:  104.02597348443047
curr_Factors:  [104.02597348  -0.67302736  -0.97800552]
mat_Sqrt:  [[19.95755443  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0051938   0.04910715 -0.26654472]
Stock Position:  -0.005193800630652944
Bond Position:  [-8.8591197]


portfolio before change:  [-9.39819204]
curr_Stock_Price:  103.36501598118133
curr_Factors:  [103.36501598  -0.89669878  -0.94439585]
mat_Sqrt:  [[16.3982061   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02299415 -0.28998395 -0.4242828 ]
Stock Position:  -0.022994152053839506
Bond Position:  [-7.02140114]


portfolio before change:  [-9.41468674]
curr_Stock_Price:  104.00601085588946
curr_Factors:  [104.00601086  -0.74481876  -0.95939284]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-9.41468674]
Stock Price:  103.16566117272191
PL:  [-12.58034791]
Settle:  Tensor("sub_76:0", shape=(), dtype=float64)
PL:  Tensor("sub_77:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  39
output_Z_Vals[:, i, :]:  [[ 1.19251512e+02 -2.92846752e+01 -2.92776944e+01]
 [-1.28006167e-01  1.40357799e-02 -1.20714498e-01]
 [-8.90719149e-02  1.58653056e-02  1.08181989e-01]
 [-4.02193080e-02  3.59595384e-02  5.01849075e-02]
 [-8.20318572e-02 -1.01543243e-01  7.27337240e-02]
 [-4.21044244e-02  1.81539309e-02 -1.86524707e-03]
 [-8.89785930e-02 -4.84096100e-02  5.49874019e-02]
 [-4.91276944e-02  8.36868848e-02 -1.05624900e-01]
 [-2.99849861e-01 -1.42513613e-01  3.03841448e-01]
 [ 6.04364201e-02  4.95144000e-02 -2.51756233e-03]
 [ 3.18728030e-02  8.61104824e-02 -1.21283400e-02]
 [ 1.02688116e-02 -9.46905891e-03 -1.14045133e-01]
 [ 2.80323154e-02 -1.05286058e-01 -3.33330700e-01]
 [-3.77357290e-02  1.49385977e-02 -2.07032600e-02]
 [ 2.34103758e-02 -6.48166136e-02 -4.78406628e-02]
 [ 3.76418296e-02 -9.06971777e-03  8.79183960e-02]
 [-2.35647895e-02  1.03259148e-01  6.82888801e-02]
 [ 3.12192975e-02 -4.58582648e-03 -1.98675915e-02]
 [-3.23192411e-01 -8.72267669e-01 -1.33468736e-01]
 [ 7.24400582e-02 -3.50614269e-02 -8.26209607e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.25151208 -29.28467519 -29.2776944 ]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  8.31409947  -9.26062741 -83.52111278]
init_Out:  [2.49223638]
Stock Position:  8.314099471154409
Bond position:  [-828.91771073]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [0.87840721]
curr_Stock_Price:  99.8308206629583
curr_Factors:  [99.83082066 -0.87294148 -1.01502859]
mat_Sqrt:  [[15.11226845  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01007688  0.0044385  -0.34436486]
Stock Position:  -0.01007687950536682
Bond Position:  [1.88439037]


portfolio before change:  [0.87997339]
curr_Stock_Price:  99.72215403813179
curr_Factors:  [99.72215404 -0.52696702 -1.03151367]
mat_Sqrt:  [[20.9870834   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00317241  0.00501705  0.3086131 ]
Stock Position:  -0.003172414061397073
Bond Position:  [1.19633336]


portfolio before change:  [0.88736266]
curr_Stock_Price:  97.48721637546764
curr_Factors:  [97.48721638 -0.99109194 -1.05857926]
mat_Sqrt:  [[12.55413458  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00231373  0.0113714   0.14316357]
Stock Position:  -0.002313730599261601
Bond Position:  [1.11292182]


portfolio before change:  [0.88785346]
curr_Stock_Price:  97.39535838881926
curr_Factors:  [97.39535839 -1.0829507  -1.03829048]
mat_Sqrt:  [[11.6760225   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00597866 -0.03211079  0.20748907]
Stock Position:  -0.005978661249889615
Bond Position:  [1.47014732]


portfolio before change:  [0.88702106]
curr_Stock_Price:  97.59606893441467
curr_Factors:  [97.59606893 -1.15466909 -1.0641428 ]
mat_Sqrt:  [[10.61242339  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00395917  0.00574078 -0.00532103]
Stock Position:  -0.003959174298049228
Bond Position:  [1.27342091]


portfolio before change:  [0.8848682]
curr_Stock_Price:  98.22025411344256
curr_Factors:  [98.22025411 -1.08650509 -1.07925253]
mat_Sqrt:  [[11.26223204  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00701497 -0.01530846  0.15686375]
Stock Position:  -0.00701497421212113
Bond Position:  [1.57388075]


portfolio before change:  [0.88773331]
curr_Stock_Price:  97.8679239666893
curr_Factors:  [97.86792397 -0.875074   -1.0575891 ]
mat_Sqrt:  [[14.16757287  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00483693  0.02646412 -0.30131844]
Stock Position:  -0.00483692594870986
Bond Position:  [1.36111321]


portfolio before change:  [0.88703517]
curr_Stock_Price:  98.08261669067059
curr_Factors:  [98.08261669 -0.49859553 -1.02259487]
mat_Sqrt:  [[21.4263131   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01127157 -0.04506676  0.86677508]
Stock Position:  -0.011271569212842374
Bond Position:  [1.99258018]


portfolio before change:  [0.88635958]
curr_Stock_Price:  98.18675477710757
curr_Factors:  [98.18675478 -0.32014536 -1.02150931]
mat_Sqrt:  [[25.66727063  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0023844   0.01565783 -0.0071819 ]
Stock Position:  0.0023843977037088316
Bond Position:  [0.65224331]


portfolio before change:  [0.89017699]
curr_Stock_Price:  99.71935647057714
curr_Factors:  [99.71935647 -0.62980954 -1.03348058]
mat_Sqrt:  [[18.8982568   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0016732   0.02723053 -0.03459878]
Stock Position:  0.0016731955457276477
Bond Position:  [0.72332701]


portfolio before change:  [0.88757419]
curr_Stock_Price:  98.05568059870983
curr_Factors:  [98.0556806  -0.87779932 -1.05340274]
mat_Sqrt:  [[14.21550721  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00093244 -0.00299438 -0.32533902]
Stock Position:  -0.0009324355077252257
Bond Position:  [0.97900479]


portfolio before change:  [0.88742827]
curr_Stock_Price:  98.47469785833596
curr_Factors:  [98.47469786 -0.87933579 -1.06672223]
mat_Sqrt:  [[14.06573397  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00303767 -0.03329438 -0.9508997 ]
Stock Position:  -0.0030376660857375283
Bond Position:  [1.18656152]


portfolio before change:  [0.88948935]
curr_Stock_Price:  97.8938560442076
curr_Factors:  [97.89385604 -0.50379165 -1.02474827]
mat_Sqrt:  [[21.22848412  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0019585   0.004724   -0.05906064]
Stock Position:  -0.001958503067738775
Bond Position:  [1.08121477]


portfolio before change:  [0.88827589]
curr_Stock_Price:  98.65147618076003
curr_Factors:  [98.65147618 -0.52035471 -1.00338162]
mat_Sqrt:  [[21.49578488  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00055692 -0.02049681 -0.13647609]
Stock Position:  0.0005569177238570068
Bond Position:  [0.83333513]


portfolio before change:  [0.8893104]
curr_Stock_Price:  100.13492019318646
curr_Factors:  [100.13492019  -0.89416016  -1.02751358]
mat_Sqrt:  [[14.65592574  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0037769  -0.0028681   0.25080671]
Stock Position:  0.003776896724746123
Bond Position:  [0.51111115]


portfolio before change:  [0.88687646]
curr_Stock_Price:  99.45665568607767
curr_Factors:  [99.45665569 -1.21707177 -1.03442428]
mat_Sqrt:  [[10.46698352  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00066488  0.03265341  0.19480917]
Stock Position:  -0.0006648754618913693
Bond Position:  [0.95300275]


portfolio before change:  [0.88688971]
curr_Stock_Price:  99.79511674903632
curr_Factors:  [99.79511675 -1.23162468 -1.0333133 ]
mat_Sqrt:  [[10.36237314  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00260997 -0.00145017 -0.05667671]
Stock Position:  0.002609965540461694
Bond Position:  [0.62642789]


portfolio before change:  [0.88967218]
curr_Stock_Price:  100.80120261376086
curr_Factors:  [100.80120261  -1.01231821  -1.05981077]
mat_Sqrt:  [[12.69262741  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02938387 -0.27583526 -0.38074915]
Stock Position:  -0.029383865548188906
Bond Position:  [3.85160117]


portfolio before change:  [0.87981299]
curr_Stock_Price:  101.16950717586492
curr_Factors:  [101.16950718  -0.89059243  -1.10750447]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [0.87981299]
Stock Price:  103.13653936068557
PL:  [-2.25672637]
Settle:  Tensor("sub_78:0", shape=(), dtype=float64)
PL:  Tensor("sub_79:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  40
output_Z_Vals[:, i, :]:  [[ 1.19251512e+02 -2.92846752e+01 -2.92776944e+01]
 [-6.46904828e-02 -1.29586980e-02 -4.21847728e-02]
 [-2.65942868e-01 -3.21672971e-02  1.83134305e-01]
 [-3.77445238e-02 -3.19784501e-03 -5.01305400e-02]
 [-9.88296441e-02 -2.41910939e-01  2.15109929e-01]
 [-1.25325185e-01 -8.55079459e-02  2.24205639e-02]
 [ 5.40845782e-02  5.89109533e-02 -2.79642434e-02]
 [-1.32008117e-01  2.00329309e-01 -6.64146149e-02]
 [-1.27533274e-01 -6.05657569e-02  1.18825090e-01]
 [ 4.50470017e-02  4.74936917e-02 -1.18045691e-02]
 [ 3.94621393e-02  7.90735161e-02 -1.29668099e-02]
 [ 1.72795870e-01 -1.27662985e-02 -1.63903687e-01]
 [ 3.56814821e-02 -5.74625167e-02 -4.17936166e-01]
 [-8.45720117e-02  2.97281712e-02 -3.59999752e-02]
 [-9.42583343e-02  2.69485747e-02  1.77951427e-01]
 [-1.32795499e-02 -4.44968996e-02  1.09384811e-01]
 [-2.72303832e-02  1.02870990e-01  8.19201221e-02]
 [ 2.48138511e-02 -2.30244644e-04 -1.15826741e-02]
 [-3.90019508e-01 -9.93268518e-01 -2.46358282e-01]
 [ 9.68879582e-02 -9.12450809e-02 -1.55231900e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.25151208 -29.28467519 -29.2776944 ]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  8.31409947  -9.26062741 -83.52111278]
init_Out:  [2.49223638]
Stock Position:  8.314099471154409
Bond position:  [-828.91771073]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [3.44146405]
curr_Stock_Price:  100.13909900961335
curr_Factors:  [100.13909901  -1.1661932   -1.02352378]
mat_Sqrt:  [[11.21041475  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00656854 -0.0040979  -0.12034141]
Stock Position:  -0.006568535357298897
Bond Position:  [4.09923127]


portfolio before change:  [3.44206974]
curr_Stock_Price:  100.20292524292611
curr_Factors:  [100.20292524  -1.21409053  -1.0266331 ]
mat_Sqrt:  [[10.6597371   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02151941 -0.01017219  0.5224312 ]
Stock Position:  -0.021519413474880227
Bond Position:  [5.59837792]


portfolio before change:  [3.44258924]
curr_Stock_Price:  100.24383112934507
curr_Factors:  [100.24383113  -1.65880691  -1.00542008]
mat_Sqrt:  [[ 6.98230116  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00688311 -0.00101125 -0.14300848]
Stock Position:  -0.0068831097784346935
Bond Position:  [4.13257854]


portfolio before change:  [3.43706075]
curr_Stock_Price:  101.19714476642469
curr_Factors:  [101.19714477  -1.35287366  -1.01517857]
mat_Sqrt:  [[ 9.47842646  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00645325 -0.07649896  0.61364875]
Stock Position:  -0.006453247013097212
Bond Position:  [4.09011093]


portfolio before change:  [3.4353864]
curr_Stock_Price:  101.61507590678991
curr_Factors:  [101.61507591  -1.07931168  -1.01885553]
mat_Sqrt:  [[12.46624641  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00986315 -0.02703999  0.06395963]
Stock Position:  -0.0098631463368746
Bond Position:  [4.43763076]


portfolio before change:  [3.42948514]
curr_Stock_Price:  102.32588421573809
curr_Factors:  [102.32588422  -1.04911044  -0.99823331]
mat_Sqrt:  [[13.20794981  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00377784  0.01862928 -0.0797742 ]
Stock Position:  0.0037778365241272517
Bond Position:  [3.04291467]


portfolio before change:  [3.42932429]
curr_Stock_Price:  102.0819163944705
curr_Factors:  [102.08191639  -0.73781736  -0.98423557]
mat_Sqrt:  [[18.24192759  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00769614  0.06334969 -0.18946241]
Stock Position:  -0.0076961418729136095
Bond Position:  [4.2149612]


portfolio before change:  [3.43718026]
curr_Stock_Price:  101.19808430623232
curr_Factors:  [101.19808431  -0.78271455  -0.97774059]
mat_Sqrt:  [[17.4026882   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00602447 -0.01915257  0.33897491]
Stock Position:  -0.006024471829557393
Bond Position:  [4.04684527]


portfolio before change:  [3.43764487]
curr_Stock_Price:  101.28891895587911
curr_Factors:  [101.28891896  -0.91352806  -0.97236896]
mat_Sqrt:  [[15.36481257  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00285481  0.01501882 -0.03367515]
Stock Position:  0.0028548142590103867
Bond Position:  [3.14848382]


portfolio before change:  [3.43709859]
curr_Stock_Price:  100.82181400854739
curr_Factors:  [100.82181401  -0.88853793  -0.97254429]
mat_Sqrt:  [[15.67822051  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0024784   0.02500524 -0.0369907 ]
Stock Position:  0.0024784043373993576
Bond Position:  [3.18722137]


portfolio before change:  [3.44044546]
curr_Stock_Price:  101.8506870314881
curr_Factors:  [101.85068703  -0.80862272  -0.98900779]
mat_Sqrt:  [[16.8757449   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00823724 -0.00403706 -0.4675716 ]
Stock Position:  0.008237239100266771
Bond Position:  [2.601477]


portfolio before change:  [3.422018]
curr_Stock_Price:  99.5346308053026
curr_Factors:  [99.53463081 -0.62361426 -1.00185129]
mat_Sqrt:  [[19.5904086   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00260909 -0.01817124 -1.19225555]
Stock Position:  -0.0026090857773493964
Bond Position:  [3.68171239]


portfolio before change:  [3.4193085]
curr_Stock_Price:  100.9259380855253
curr_Factors:  [100.92593809  -0.79415822  -0.97969624]
mat_Sqrt:  [[17.12488204  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00532283  0.00940087 -0.10269791]
Stock Position:  -0.005322833613293321
Bond Position:  [3.95652048]


portfolio before change:  [3.41222838]
curr_Stock_Price:  102.44192984434086
curr_Factors:  [102.44192984  -0.96971129  -0.98810057]
mat_Sqrt:  [[14.46141749  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.003958    0.00852189  0.50764589]
Stock Position:  -0.003958003584588556
Bond Position:  [3.81769391]


portfolio before change:  [3.41563403]
curr_Stock_Price:  101.82265210802268
curr_Factors:  [101.82265211  -0.61773997  -0.98963886]
mat_Sqrt:  [[20.40650577  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00038711 -0.01407116  0.31204442]
Stock Position:  0.0003871131202019512
Bond Position:  [3.37621715]


portfolio before change:  [3.415668]
curr_Stock_Price:  99.72974139700656
curr_Factors:  [99.7297414  -0.53844516 -0.98284507]
mat_Sqrt:  [[21.78395542  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00036047  0.03253066  0.23369531]
Stock Position:  -0.0003604667115441045
Bond Position:  [3.45161725]


portfolio before change:  [3.41728294]
curr_Stock_Price:  97.64373507250481
curr_Factors:  [97.64373507 -0.11213937 -1.02811934]
mat_Sqrt:  [[31.22024565  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 7.18879763e-04 -7.28097496e-05 -3.30421451e-02]
Stock Position:  0.0007188797628926915
Bond Position:  [3.34708884]


portfolio before change:  [3.418471]
curr_Stock_Price:  98.13224605375774
curr_Factors:  [98.13224605 -0.16570373 -1.01937357]
mat_Sqrt:  [[30.00124009  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01553113 -0.31409908 -0.70279161]
Stock Position:  -0.015531133480265559
Bond Position:  [4.94257601]


portfolio before change:  [3.38073116]
curr_Stock_Price:  100.64176292297398
curr_Factors:  [100.64176292  -0.17613692  -1.016825  ]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [3.38073116]
Stock Price:  102.17892898424131
PL:  [1.20180217]
Settle:  Tensor("sub_80:0", shape=(), dtype=float64)
PL:  Tensor("sub_81:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  41
output_Z_Vals[:, i, :]:  [[ 1.19251512e+02 -2.92846752e+01 -2.92776944e+01]
 [ 1.30864188e-02 -5.93502507e-02 -1.87000281e-01]
 [-3.67697305e-01 -5.81541233e-02  2.39277367e-01]
 [-6.59390394e-02 -1.24032279e-01 -3.91917910e-01]
 [-9.88296441e-02 -2.41910939e-01  2.15109929e-01]
 [-7.06041615e-04 -1.87632044e-01  3.28696860e-02]
 [ 5.59253850e-02  2.82844562e-02 -1.59535441e-02]
 [-9.28325134e-02  1.53884436e-01 -8.25784233e-02]
 [-2.24038312e-01 -1.02828637e-01  2.13702759e-01]
 [ 6.98256297e-02  5.81927986e-02 -5.30341118e-03]
 [ 3.31258090e-02  8.15654161e-02 -4.18468221e-03]
 [-5.06936115e-03 -9.01004982e-03 -1.07293693e-01]
 [ 4.44261942e-02 -3.39787364e-02 -3.42788818e-01]
 [-1.98146251e-02  1.15404380e-02 -8.07639439e-03]
 [ 1.16500900e-02 -5.82131592e-02 -1.07130123e-01]
 [ 1.63564537e-01  2.02410470e-02 -5.11043173e-02]
 [ 7.63504048e-03  1.23895415e-02  9.19631674e-02]
 [ 4.18716721e-02 -2.48791143e-02  6.74762710e-02]
 [-2.39196360e-01 -6.55430912e-01 -8.74725126e-02]
 [ 1.00012257e-01 -9.84250242e-02 -1.64511155e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.25151208 -29.28467519 -29.2776944 ]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  8.31409947  -9.26062741 -83.52111278]
init_Out:  [2.49223638]
Stock Position:  8.314099471154409
Bond position:  [-828.91771073]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [7.3068106]
curr_Stock_Price:  100.60401364757439
curr_Factors:  [100.60401365  -1.31209201  -1.01719472]
mat_Sqrt:  [[ 9.7953269   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00271734 -0.0187682  -0.53345975]
Stock Position:  -0.0027173437797933086
Bond Position:  [7.58018629]


portfolio before change:  [7.30851093]
curr_Stock_Price:  100.67575785744448
curr_Factors:  [100.67575786  -1.42644616  -1.02163207]
mat_Sqrt:  [[ 8.70438402  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.03680405 -0.01838995  0.68259173]
Stock Position:  -0.036804045938239834
Bond Position:  [11.01378615]


portfolio before change:  [7.27083451]
curr_Stock_Price:  101.7742840936363
curr_Factors:  [101.77428409  -1.56036432  -0.98672413]
mat_Sqrt:  [[ 7.96987656  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01871314 -0.03922245 -1.11803271]
Stock Position:  -0.018713143987209246
Bond Position:  [9.17535134]


portfolio before change:  [7.27554693]
curr_Stock_Price:  101.64505425018062
curr_Factors:  [101.64505425  -1.67365153  -0.9440986 ]
mat_Sqrt:  [[ 7.41671881  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00824713 -0.07649896  0.61364875]
Stock Position:  -0.008247127710293248
Bond Position:  [8.11382667]


portfolio before change:  [7.28590922]
curr_Stock_Price:  100.63457196847499
curr_Factors:  [100.63457197  -1.27784433  -0.96121237]
mat_Sqrt:  [[10.72351676  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00010806 -0.05933446  0.09376807]
Stock Position:  0.00010806309431853905
Bond Position:  [7.27503433]


portfolio before change:  [7.28775728]
curr_Stock_Price:  100.90365554724343
curr_Factors:  [100.90365555  -1.09968497  -0.91760567]
mat_Sqrt:  [[13.42173656  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00397856  0.00894433 -0.04551102]
Stock Position:  0.003978559908787461
Bond Position:  [6.88630604]


portfolio before change:  [7.28668383]
curr_Stock_Price:  100.20107795499804
curr_Factors:  [100.20107795  -0.74512196  -0.92386678]
mat_Sqrt:  [[18.88164343  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00559885  0.04866253 -0.23557326]
Stock Position:  -0.0055988497407783635
Bond Position:  [7.84769461]


portfolio before change:  [7.29419266]
curr_Stock_Price:  99.2103988815107
curr_Factors:  [99.21039888 -0.90329525 -0.95551613]
mat_Sqrt:  [[15.46271205  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01183954 -0.03251727  0.60963449]
Stock Position:  -0.011839542909627297
Bond Position:  [8.46879843]


portfolio before change:  [7.29899088]
curr_Stock_Price:  98.98397487835567
curr_Factors:  [98.98397488 -1.00224161 -0.92035478]
mat_Sqrt:  [[14.47411063  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00485319  0.01840218 -0.01512916]
Stock Position:  0.0048531898642106405
Bond Position:  [6.81860286]


portfolio before change:  [7.29709664]
curr_Stock_Price:  98.24237993762905
curr_Factors:  [98.24237994 -0.70743791 -0.94774905]
mat_Sqrt:  [[18.76982862  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00183154  0.02579325 -0.01193773]
Stock Position:  0.0018315363979013058
Bond Position:  [7.11716215]


portfolio before change:  [7.29880629]
curr_Stock_Price:  98.20423575258555
curr_Factors:  [98.20423575 -1.06092192 -0.9062188 ]
mat_Sqrt:  [[13.73446869  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00198065 -0.00284923 -0.30607904]
Stock Position:  -0.0019806541983495834
Bond Position:  [7.49331492]


portfolio before change:  [7.29790555]
curr_Stock_Price:  99.60493973977803
curr_Factors:  [99.60493974 -0.92494378 -0.92082839]
mat_Sqrt:  [[15.7279533   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00167998 -0.01074502 -0.97788108]
Stock Position:  -0.0016799774845787218
Bond Position:  [7.4652396]


portfolio before change:  [7.30355457]
curr_Stock_Price:  97.35343283517061
curr_Factors:  [97.35343284 -0.7783105  -0.89102421]
mat_Sqrt:  [[18.33869449  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00115413  0.00364941 -0.02303971]
Stock Position:  -0.0011541301041526743
Bond Position:  [7.4159131]


portfolio before change:  [7.30589044]
curr_Stock_Price:  96.93609900585531
curr_Factors:  [96.93609901 -0.63355394 -0.90286588]
mat_Sqrt:  [[20.85580176  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00056199 -0.01840862 -0.30561242]
Stock Position:  -0.0005619928787598959
Bond Position:  [7.36036783]


portfolio before change:  [7.30754188]
curr_Stock_Price:  97.2721783220678
curr_Factors:  [97.27217832 -0.49018652 -0.88521239]
mat_Sqrt:  [[24.58444934  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00625011  0.00640078 -0.14578639]
Stock Position:  0.006250110855345921
Bond Position:  [6.69957999]


portfolio before change:  [7.30150347]
curr_Stock_Price:  96.03803790229715
curr_Factors:  [96.0380379  -1.02222428 -0.87815051]
mat_Sqrt:  [[14.35889414  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00186134 0.00391792 0.26234532]
Stock Position:  0.0018613438986410905
Bond Position:  [7.12274366]


portfolio before change:  [7.30567739]
curr_Stock_Price:  97.32367124946256
curr_Factors:  [97.32367125 -1.55302814 -0.85484773]
mat_Sqrt:  [[ 8.7597413   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00627905 -0.00786747  0.19249102]
Stock Position:  0.006279047571036038
Bond Position:  [6.69457743]


portfolio before change:  [7.30941954]
curr_Stock_Price:  97.6530677718598
curr_Factors:  [97.65306777 -1.31359798 -0.85749864]
mat_Sqrt:  [[11.13757425  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02459914 -0.20726545 -0.24953473]
Stock Position:  -0.024599141478822015
Bond Position:  [9.71160117]


portfolio before change:  [7.30953225]
curr_Stock_Price:  97.74719689688632
curr_Factors:  [97.7471969  -1.54511634 -0.84410966]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [7.30953225]
Stock Price:  98.37025441771226
PL:  [7.30953225]
Settle:  Tensor("sub_82:0", shape=(), dtype=float64)
PL:  Tensor("sub_83:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  42
output_Z_Vals[:, i, :]:  [[ 1.19251512e+02 -2.92846752e+01 -2.92776944e+01]
 [-1.48558994e-01  2.77701645e-02 -6.31948085e-02]
 [-3.66345200e-01 -5.78615303e-02  2.38114377e-01]
 [-5.92031377e-02 -9.52705466e-02 -3.10650752e-01]
 [-9.88296441e-02 -2.41910939e-01  2.15109929e-01]
 [ 2.59607507e-02 -1.55827430e-01  2.22354016e-02]
 [ 5.58310137e-02  2.98545635e-02 -1.65692883e-02]
 [-1.16329021e-01  1.90100734e-01 -8.83304295e-02]
 [-1.66933274e-02 -1.47268755e-02  1.61579695e-02]
 [ 4.89762015e-02  4.26384290e-02 -9.65607738e-03]
 [ 8.07683947e-02  4.88774662e-02 -1.57798280e-02]
 [ 9.18553206e-02 -1.03926307e-02 -1.28947892e-01]
 [ 4.03819609e-02 -1.34986719e-02 -2.92749491e-01]
 [-8.45720117e-02  2.97281712e-02 -3.59999752e-02]
 [-1.21232635e-01  7.06059624e-02  2.41953401e-01]
 [-1.69441632e-01 -3.24010210e-01  2.39530747e-01]
 [-5.43827230e-02 -1.23937524e-01  2.54516199e-01]
 [-1.86612860e-01  2.93769853e-01 -8.70772467e-02]
 [-3.24324101e-01 -9.61477578e-01 -1.72890569e-01]
 [ 9.64176509e-02 -7.10786468e-02 -1.35107509e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.25151208 -29.28467519 -29.2776944 ]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  8.31409947  -9.26062741 -83.52111278]
init_Out:  [2.49223638]
Stock Position:  8.314099471154409
Bond position:  [-828.91771073]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-0.65746979]
curr_Stock_Price:  99.64608905067001
curr_Factors:  [99.64608905 -0.98212499 -0.99998369]
mat_Sqrt:  [[13.72907874  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01170811  0.0087817  -0.1802772 ]
Stock Position:  -0.011708109570299921
Bond Position:  [0.50919754]


portfolio before change:  [-0.66974437]
curr_Stock_Price:  100.7053460585092
curr_Factors:  [100.70534606  -1.48238102  -0.97287136]
mat_Sqrt:  [[ 8.64470081  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.03692832 -0.01829742  0.67927404]
Stock Position:  -0.036928320836930116
Bond Position:  [3.04913496]


portfolio before change:  [-0.68381769]
curr_Stock_Price:  101.10708917408766
curr_Factors:  [101.10708917  -1.1207157   -1.04541068]
mat_Sqrt:  [[11.58897095  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01079253 -0.03012719 -0.88620013]
Stock Position:  -0.010792531306969645
Bond Position:  [0.40738374]


portfolio before change:  [-0.67948681]
curr_Stock_Price:  100.71524224311621
curr_Factors:  [100.71524224  -0.86956466  -1.0605991 ]
mat_Sqrt:  [[14.61624223  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00418484 -0.07649896  0.61364875]
Stock Position:  -0.004184839461276887
Bond Position:  [-0.25800969]


portfolio before change:  [-0.67805479]
curr_Stock_Price:  100.35763533622391
curr_Factors:  [100.35763534  -1.04302531  -1.05636299]
mat_Sqrt:  [[12.29695729  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00215306 -0.04927696  0.06343141]
Stock Position:  0.0021530599353343665
Bond Position:  [-0.89413079]


portfolio before change:  [-0.67757943]
curr_Stock_Price:  100.68225331516517
curr_Factors:  [100.68225332  -1.18225553  -1.0317692 ]
mat_Sqrt:  [[11.00054504  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00483791  0.00944084 -0.04726757]
Stock Position:  0.0048379115004365475
Bond Position:  [-1.16467126]


portfolio before change:  [-0.6734231]
curr_Stock_Price:  101.60156164981963
curr_Factors:  [101.60156165  -1.19697992  -1.06137787]
mat_Sqrt:  [[10.6195975   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01218982  0.06011513 -0.25198213]
Stock Position:  -0.012189823058471858
Bond Position:  [0.56508196]


portfolio before change:  [-0.68234795]
curr_Stock_Price:  102.34530814191692
curr_Factors:  [102.34530814  -1.18216152  -1.05003831]
mat_Sqrt:  [[10.98084768  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00125449 -0.00465705  0.04609419]
Stock Position:  -0.001254488035206898
Bond Position:  [-0.55395699]


portfolio before change:  [-0.68239491]
curr_Stock_Price:  102.27233245903777
curr_Factors:  [102.27233246  -1.23165661  -1.02248912]
mat_Sqrt:  [[10.73482842  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00448131  0.01348346 -0.0275461 ]
Stock Position:  0.004481308927832846
Bond Position:  [-1.14070883]


portfolio before change:  [-0.68417326]
curr_Stock_Price:  101.93914075070732
curr_Factors:  [101.93914075  -1.07872928  -0.96734892]
mat_Sqrt:  [[13.17469281  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00598187  0.01545641 -0.04501546]
Stock Position:  0.005981874699723598
Bond Position:  [-1.29396043]


portfolio before change:  [-0.69548021]
curr_Stock_Price:  100.10302370058427
curr_Factors:  [100.1030237   -0.92908176  -0.96129438]
mat_Sqrt:  [[15.11705764  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00431735 -0.00328644 -0.36785244]
Stock Position:  0.004317348484533637
Bond Position:  [-1.12765985]


portfolio before change:  [-0.6879636]
curr_Stock_Price:  101.90935552503923
curr_Factors:  [101.90935553  -0.73898984  -0.9492539 ]
mat_Sqrt:  [[18.83732006  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00104706 -0.00426865 -0.83513281]
Stock Position:  -0.0010470604598355501
Bond Position:  [-0.58125834]


portfolio before change:  [-0.68887194]
curr_Stock_Price:  102.63806754157919
curr_Factors:  [102.63806754  -1.0145325   -0.94255747]
mat_Sqrt:  [[14.49956908  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00628659  0.00940087 -0.10269791]
Stock Position:  -0.006286593572120984
Bond Position:  [-0.04362812]


portfolio before change:  [-0.6961239]
curr_Stock_Price:  103.78989219547749
curr_Factors:  [103.7898922   -0.80527858  -0.95863654]
mat_Sqrt:  [[17.78674426  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0039367   0.02232757  0.69022571]
Stock Position:  -0.003936699425458609
Bond Position:  [-0.28753429]


portfolio before change:  [-0.71201955]
curr_Stock_Price:  107.80944272624991
curr_Factors:  [107.80944273  -0.86830799  -0.95915647]
mat_Sqrt:  [[17.33800284  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00743532 -0.10246102  0.68331455]
Stock Position:  -0.007435316052873896
Bond Position:  [0.08957773]


portfolio before change:  [-0.7142974]
curr_Stock_Price:  108.11880981464064
curr_Factors:  [108.11880981  -0.87037265  -0.94759691]
mat_Sqrt:  [[17.55363677  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-3.20724106e-04 -3.91924865e-02  7.26063873e-01]
Stock Position:  -0.0003207241064122804
Bond Position:  [-0.67962109]


portfolio before change:  [-0.71404842]
curr_Stock_Price:  106.81268482626291
curr_Factors:  [106.81268483  -0.99502019  -0.97241645]
mat_Sqrt:  [[14.93399345  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01317814  0.09289818 -0.24840715]
Stock Position:  -0.01317814448448966
Bond Position:  [0.69354458]


portfolio before change:  [-0.68942398]
curr_Stock_Price:  104.95726183058987
curr_Factors:  [104.95726183  -0.72204027  -0.93435058]
mat_Sqrt:  [[20.02862276  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01919455 -0.30404591 -0.49320867]
Stock Position:  -0.019194554186964884
Bond Position:  [1.32518387]


portfolio before change:  [-0.68013056]
curr_Stock_Price:  104.49035414973054
curr_Factors:  [104.49035415  -0.68015053  -0.90156889]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-0.68013056]
Stock Price:  105.56182005792428
PL:  [-6.24195061]
Settle:  Tensor("sub_84:0", shape=(), dtype=float64)
PL:  Tensor("sub_85:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  43
output_Z_Vals[:, i, :]:  [[ 1.19251512e+02 -2.92846752e+01 -2.92776944e+01]
 [-2.58015526e-01  9.35651695e-02  2.28865029e-01]
 [-5.32383689e-02  2.55965727e-02  9.29968654e-02]
 [-5.21797902e-02  2.85153283e-02  2.72273446e-02]
 [-9.88296441e-02 -2.41910939e-01  2.15109929e-01]
 [-1.36754902e-01  8.39586405e-03 -2.29474786e-02]
 [ 5.51403297e-02  4.13458457e-02 -2.10757891e-02]
 [-5.61174048e-02  1.01954267e-01 -8.09960380e-02]
 [-2.83046512e-01 -1.23273050e-01  2.58726747e-01]
 [ 9.17752375e-03 -1.78913205e-03  1.38424777e-02]
 [ 3.38629580e-02  8.51242763e-02 -1.21626393e-02]
 [ 1.50772359e-01 -1.21204356e-02 -1.54392393e-01]
 [ 3.82000952e-02 -1.67638235e-02 -4.18654011e-01]
 [-8.45720117e-02  2.97281712e-02 -3.59999752e-02]
 [-7.15752956e-02 -1.34945910e-02  9.71121602e-02]
 [-5.22335331e-02 -1.08612807e-01  1.40562860e-01]
 [-2.45870135e-02 -2.44657482e-02  2.33990286e-01]
 [-6.09609217e-02  1.17012843e-01 -9.31246298e-02]
 [-3.41587108e-01 -1.02406111e+00 -1.96275965e-01]
 [ 8.90370436e-02 -3.34494543e-02 -9.29068029e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.25151208 -29.28467519 -29.2776944 ]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  8.31409947  -9.26062741 -83.52111278]
init_Out:  [2.49223638]
Stock Position:  8.314099471154409
Bond position:  [-828.91771073]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-12.46395481]
curr_Stock_Price:  98.22603326909568
curr_Factors:  [98.22603327 -0.61449517 -0.98005628]
mat_Sqrt:  [[19.93984189  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01047565  0.0295879   0.65288822]
Stock Position:  -0.01047565004439795
Bond Position:  [-11.43497326]


portfolio before change:  [-12.48015059]
curr_Stock_Price:  99.4991456451124
curr_Factors:  [99.49914565 -0.22375294 -1.00888904]
mat_Sqrt:  [[29.006127    0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00115819  0.00809435  0.26529417]
Stock Position:  -0.0011581884948312705
Bond Position:  [-12.36491182]


portfolio before change:  [-12.48168732]
curr_Stock_Price:  98.15663228092467
curr_Factors:  [98.15663228 -0.16121703 -0.98121901]
mat_Sqrt:  [[31.31597808  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00146525  0.00901734  0.07767204]
Stock Position:  -0.001465251030404791
Bond Position:  [-12.33786321]


portfolio before change:  [-12.48829404]
curr_Stock_Price:  100.56022512689675
curr_Factors:  [100.56022513  -0.27544005  -1.01289099]
mat_Sqrt:  [[27.72752928  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00220599 -0.07649896  0.61364875]
Stock Position:  -0.00220598909582347
Bond Position:  [-12.26645928]


portfolio before change:  [-12.49157029]
curr_Stock_Price:  100.6550817265548
curr_Factors:  [ 1.00655082e+02 -7.99364261e-02 -1.06284700e+00]
mat_Sqrt:  [[32.10193187  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00439918  0.00265501 -0.06546277]
Stock Position:  -0.004399182484232729
Bond Position:  [-12.04877022]


portfolio before change:  [-12.49576876]
curr_Stock_Price:  100.9246549883319
curr_Factors:  [100.92465499  -0.2030766   -1.0850155 ]
mat_Sqrt:  [[27.83466393  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00186479  0.0130747  -0.06012336]
Stock Position:  0.00186478980077191
Bond Position:  [-12.68397203]


portfolio before change:  [-12.50472892]
curr_Stock_Price:  97.82040438940214
curr_Factors:  [97.82040439 -0.13600712 -1.06093549]
mat_Sqrt:  [[29.55315728  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00236923  0.03224077 -0.23105915]
Stock Position:  -0.0023692292269144283
Bond Position:  [-12.27296996]


portfolio before change:  [-12.51219905]
curr_Stock_Price:  99.67817993736084
curr_Factors:  [99.67817994 -0.18036708 -1.02790203]
mat_Sqrt:  [[29.77525522  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0078393  -0.03898236  0.73807539]
Stock Position:  -0.007839295776105577
Bond Position:  [-11.73079231]


portfolio before change:  [-12.48482266]
curr_Stock_Price:  95.8118307284497
curr_Factors:  [ 9.58118307e+01 -6.10079361e-02 -1.03634597e+00]
mat_Sqrt:  [[31.97749149  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00037392 -0.00056577  0.03948874]
Stock Position:  0.00037391652464420077
Bond Position:  [-12.52064828]


portfolio before change:  [-12.48642571]
curr_Stock_Price:  99.89697076490181
curr_Factors:  [99.89697076 -0.31749956 -1.05748109]
mat_Sqrt:  [[25.25839852  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00132939  0.02691866 -0.03469662]
Stock Position:  0.0013293863004458935
Bond Position:  [-12.61922737]


portfolio before change:  [-12.48863139]
curr_Stock_Price:  100.61122441650895
curr_Factors:  [100.61122442  -0.59071054  -1.08364291]
mat_Sqrt:  [[18.85749365  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00630753 -0.00383282 -0.44043852]
Stock Position:  0.006307529368316949
Bond Position:  [-13.12323964]


portfolio before change:  [-12.48910464]
curr_Stock_Price:  101.05640115396986
curr_Factors:  [101.05640115  -0.4172773   -1.11884517]
mat_Sqrt:  [[21.74875063  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00219278 -0.00530119 -1.19430336]
Stock Position:  -0.0021927759314477185
Bond Position:  [-12.2675106]


portfolio before change:  [-12.49381681]
curr_Stock_Price:  101.80654907368056
curr_Factors:  [101.80654907  -0.82480357  -1.1153907 ]
mat_Sqrt:  [[14.62716125  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00623176  0.00940087 -0.10269791]
Stock Position:  -0.006231755856390984
Bond Position:  [-11.85938325]


portfolio before change:  [-12.49642682]
curr_Stock_Price:  101.74954863754506
curr_Factors:  [101.74954864  -0.23823669  -1.13719255]
mat_Sqrt:  [[25.71527432  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00202606 -0.00426736  0.27703396]
Stock Position:  -0.002026063851194005
Bond Position:  [-12.29027573]


portfolio before change:  [-12.50258677]
curr_Stock_Price:  103.27319461633414
curr_Factors:  [103.27319462  -0.51240856  -1.13528571]
mat_Sqrt:  [[19.87939115  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00132527 -0.03434639  0.40098671]
Stock Position:  -0.0013252734916360366
Bond Position:  [-12.36572155]


portfolio before change:  [-12.50734606]
curr_Stock_Price:  104.53140708296085
curr_Factors:  [104.53140708  -0.46771923  -1.12248747]
mat_Sqrt:  [[21.31222543  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00105781 -0.00773675  0.66750916]
Stock Position:  0.0010578130796197814
Bond Position:  [-12.61792075]


portfolio before change:  [-12.51173191]
curr_Stock_Price:  103.36770871927489
curr_Factors:  [103.36770872  -0.66836432  -1.11385688]
mat_Sqrt:  [[17.39306255  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0044241   0.03700271 -0.26565865]
Stock Position:  -0.0044241000286116714
Bond Position:  [-12.05442283]


portfolio before change:  [-12.52472444]
curr_Stock_Price:  105.62320474747827
curr_Factors:  [105.62320475  -0.67870918  -1.12639711]
mat_Sqrt:  [[17.3704728   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02349348 -0.32383656 -0.5599207 ]
Stock Position:  -0.023493483498984787
Bond Position:  [-10.04326742]


portfolio before change:  [-12.54585295]
curr_Stock_Price:  106.41565343187814
curr_Factors:  [106.41565343  -0.60043511  -1.14847245]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-12.54585295]
Stock Price:  105.9748549485475
PL:  [-18.5207079]
Settle:  Tensor("sub_86:0", shape=(), dtype=float64)
PL:  Tensor("sub_87:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  44
output_Z_Vals[:, i, :]:  [[ 1.19251512e+02 -2.92846752e+01 -2.92776944e+01]
 [ 7.46159610e-02 -3.64292094e-02 -4.44542000e-03]
 [-3.87696092e-01 -6.24818262e-02  2.56478999e-01]
 [-2.95745371e-02  1.87256104e-02  1.06290293e-02]
 [-8.80196033e-02 -1.51578770e-01  1.23485205e-01]
 [-5.47760324e-02 -1.09959371e-01  1.13124985e-02]
 [ 5.57358215e-02  3.14383269e-02 -1.71903879e-02]
 [-1.24422263e-01  1.98567398e-01 -8.30383016e-02]
 [-5.57005468e-03 -8.56027011e-03  1.85536467e-03]
 [ 4.96763300e-02  4.01484382e-02 -8.78845066e-03]
 [ 9.15016139e-02  4.08105066e-02 -1.65584431e-02]
 [ 1.06990064e-01 -1.08364731e-02 -1.35484133e-01]
 [ 5.48680315e-02 -4.33822108e-03 -9.79402276e-02]
 [-8.45720117e-02  2.97281712e-02 -3.59999752e-02]
 [-1.22246247e-01  7.20344737e-02  2.43415231e-01]
 [-6.16278075e-02 -1.35557815e-01  1.50715865e-01]
 [-2.59068265e-02  2.79114785e-02  1.72429914e-01]
 [-1.13701056e-02  5.09941982e-02 -8.51538723e-02]
 [-3.33487158e-01 -9.11786197e-01 -1.47682720e-01]
 [ 6.92592579e-02 -2.77516381e-02 -7.31738956e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.25151208 -29.28467519 -29.2776944 ]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  8.31409947  -9.26062741 -83.52111278]
init_Out:  [2.49223638]
Stock Position:  8.314099471154409
Bond position:  [-828.91771073]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [7.91306961]
curr_Stock_Price:  100.67693303164793
curr_Factors:  [100.67693303  -0.83317379  -0.99077738]
mat_Sqrt:  [[16.24793039  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0044786  -0.01151993 -0.01268155]
Stock Position:  0.0044785978005412895
Bond Position:  [7.46217812]


portfolio before change:  [7.91789591]
curr_Stock_Price:  101.33797130082633
curr_Factors:  [101.3379713   -0.88933199  -1.03441954]
mat_Sqrt:  [[14.80122058  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02276541 -0.01975849  0.7316632 ]
Stock Position:  -0.022765406931095192
Bond Position:  [10.22489607]


portfolio before change:  [7.96195285]
curr_Stock_Price:  99.51501289169802
curr_Factors:  [99.51501289 -0.94990316 -0.99028509]
mat_Sqrt:  [[14.29800849  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00188288  0.00592156  0.03032166]
Stock Position:  -0.0018828777753108566
Bond Position:  [8.14932745]


portfolio before change:  [7.96673313]
curr_Stock_Price:  98.05836107621133
curr_Factors:  [98.05836108 -0.61173562 -0.97812643]
mat_Sqrt:  [[19.99936992  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00333646 -0.04793342  0.35226892]
Stock Position:  -0.0033364570316387295
Bond Position:  [8.29390064]


portfolio before change:  [7.959939]
curr_Stock_Price:  100.71622975746415
curr_Factors:  [100.71622976  -0.71108985  -0.96948588]
mat_Sqrt:  [[18.76008028  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00294807 -0.03477221  0.03227141]
Stock Position:  -0.002948069315747546
Bond Position:  [8.25685743]


portfolio before change:  [7.96069365]
curr_Stock_Price:  101.16052713017876
curr_Factors:  [101.16052713  -0.9247192   -0.99147644]
mat_Sqrt:  [[14.88736678  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00356266  0.00994167 -0.04903939]
Stock Position:  0.0035626570609349987
Bond Position:  [7.60029339]


portfolio before change:  [7.96555272]
curr_Stock_Price:  101.99101864885422
curr_Factors:  [101.99101865  -1.15111727  -1.02784367]
mat_Sqrt:  [[11.54120669  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01180513  0.06279252 -0.23688516]
Stock Position:  -0.011805125792725343
Bond Position:  [9.16956953]


portfolio before change:  [7.96423786]
curr_Stock_Price:  102.29661005126535
curr_Factors:  [102.29661005  -1.34875177  -1.0402197 ]
mat_Sqrt:  [[ 9.38305181  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00057682 -0.002707    0.00529284]
Stock Position:  -0.0005768224752805912
Bond Position:  [8.02324484]


portfolio before change:  [7.96619787]
curr_Stock_Price:  102.37644583190146
curr_Factors:  [102.37644583  -1.22766683  -0.97838058]
mat_Sqrt:  [[11.27524094  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00433862  0.01269605 -0.025071  ]
Stock Position:  0.004338623315802741
Bond Position:  [7.52202503]


portfolio before change:  [7.96756235]
curr_Stock_Price:  102.25745391407715
curr_Factors:  [102.25745391  -1.28195922  -0.99565195]
mat_Sqrt:  [[10.48433805  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00850558  0.01290542 -0.04723663]
Stock Position:  0.00850557834176971
Bond Position:  [7.09780356]


portfolio before change:  [7.9747302]
curr_Stock_Price:  102.89152938215257
curr_Factors:  [102.89152938  -1.38482179  -0.99045032]
mat_Sqrt:  [[ 9.56779922  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00826258 -0.00342679 -0.38649852]
Stock Position:  0.008262577679420478
Bond Position:  [7.12458094]


portfolio before change:  [7.98253619]
curr_Stock_Price:  103.62067468726148
curr_Factors:  [103.62067469  -1.5966123   -1.02666586]
mat_Sqrt:  [[ 7.51919219  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00462338 -0.00137187 -0.27939621]
Stock Position:  0.004623376156274636
Bond Position:  [7.50345883]


portfolio before change:  [7.98353749]
curr_Stock_Price:  103.43146311123857
curr_Factors:  [103.43146311  -1.38165513  -0.99390987]
mat_Sqrt:  [[ 9.61519064  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00948009  0.00940087 -0.10269791]
Stock Position:  -0.009480092617292091
Bond Position:  [8.96407734]


portfolio before change:  [7.98107201]
curr_Stock_Price:  103.92795411570044
curr_Factors:  [103.92795412  -1.36221173  -0.97595708]
mat_Sqrt:  [[10.02948342  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00704916  0.0227793   0.6943959 ]
Stock Position:  -0.007049156610316351
Bond Position:  [8.71367643]


portfolio before change:  [7.98778282]
curr_Stock_Price:  103.28502372030069
curr_Factors:  [103.28502372  -1.40671381  -0.97891323]
mat_Sqrt:  [[ 9.50545023  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0036151  -0.04286715  0.42995041]
Stock Position:  -0.0036150994693698916
Bond Position:  [8.36116845]


portfolio before change:  [7.98869245]
curr_Stock_Price:  103.61168600624326
curr_Factors:  [103.61168601  -1.26906546  -1.02221046]
mat_Sqrt:  [[10.47900986  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00095533 0.00882638 0.49189455]
Stock Position:  0.0009553339098275304
Bond Position:  [7.8897087]


portfolio before change:  [7.98941884]
curr_Stock_Price:  102.30713437623733
curr_Factors:  [102.30713438  -1.11749783  -1.04260386]
mat_Sqrt:  [[11.79738295  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00232555  0.01612578 -0.2429203 ]
Stock Position:  -0.0023255498748630562
Bond Position:  [8.22733919]


portfolio before change:  [7.99259527]
curr_Stock_Price:  101.82581374432351
curr_Factors:  [101.82581374  -0.96880242  -1.09167801]
mat_Sqrt:  [[12.97187057  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02984727 -0.28833211 -0.42129769]
Stock Position:  -0.029847274765013438
Bond Position:  [11.03181831]


portfolio before change:  [7.99575652]
curr_Stock_Price:  101.81231342615762
curr_Factors:  [101.81231343  -0.85139817  -1.1095409 ]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [7.99575652]
Stock Price:  102.67757332543495
PL:  [5.31818319]
Settle:  Tensor("sub_88:0", shape=(), dtype=float64)
PL:  Tensor("sub_89:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  45
output_Z_Vals[:, i, :]:  [[ 1.19251512e+02 -2.92846752e+01 -2.92776944e+01]
 [ 7.18559865e-02 -3.83160730e-02 -1.34500211e-02]
 [-5.83272778e-02  2.26672745e-02  8.29150656e-02]
 [-4.87285227e-02  1.64002262e-02 -2.00924181e-03]
 [-9.01670678e-02 -1.69523672e-01  1.41686879e-01]
 [-3.67562757e-02 -6.23888140e-03 -2.11101968e-02]
 [-1.13518489e-01 -8.29548743e-02  7.83282272e-02]
 [-2.36461747e-02  3.42797109e-02 -9.92580598e-02]
 [-2.77671793e-01 -1.69371923e-01  3.70048695e-01]
 [ 9.28205517e-04 -2.03474324e-02  1.94965773e-02]
 [ 6.49648107e-02  6.16892373e-02 -3.75407478e-03]
 [-5.90459693e-02 -9.51073014e-03 -1.47412248e-01]
 [-1.09466847e-02 -2.64180273e-01 -3.63741083e-01]
 [ 7.40860800e-02 -4.12719862e-02  6.14419091e-03]
 [ 1.14650985e-02 -5.81058274e-02 -1.07971279e-01]
 [ 1.31327053e-01  2.71082409e-03 -1.08863669e-03]
 [-2.35647895e-02  1.03259148e-01  6.82888801e-02]
 [ 8.29656050e-03  2.28340360e-02 -8.19100720e-02]
 [-3.58626951e-01 -9.35624623e-01 -1.95063775e-01]
 [ 7.86940060e-02 -4.94336077e-02 -1.01195359e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.25151208 -29.28467519 -29.2776944 ]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  8.31409947  -9.26062741 -83.52111278]
init_Out:  [2.49223638]
Stock Position:  8.314099471154409
Bond position:  [-828.91771073]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [8.74374499]
curr_Stock_Price:  100.77684467994999
curr_Factors:  [100.77684468  -0.80748852  -1.02230328]
mat_Sqrt:  [[16.16933927  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00421299 -0.01211661 -0.03836917]
Stock Position:  0.004212985732645962
Bond Position:  [8.31917359]


portfolio before change:  [8.73820867]
curr_Stock_Price:  98.96900991366556
curr_Factors:  [98.96900991 -0.58973074 -1.05982627]
mat_Sqrt:  [[19.01541108  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00214652  0.00716802  0.2365336 ]
Stock Position:  -0.002146524427714102
Bond Position:  [8.95064806]


portfolio before change:  [8.74073851]
curr_Stock_Price:  98.83302190752386
curr_Factors:  [98.83302191 -0.37748408 -1.05332557]
mat_Sqrt:  [[23.63248233  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00206137  0.00518621 -0.00573181]
Stock Position:  -0.002061366416983818
Bond Position:  [8.94446958]


portfolio before change:  [8.74300265]
curr_Stock_Price:  98.81956045805502
curr_Factors:  [98.81956046 -0.51133117 -1.05724262]
mat_Sqrt:  [[20.58827578  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00318737 -0.05360809  0.40419323]
Stock Position:  -0.003187369246360061
Bond Position:  [9.05797708]


portfolio before change:  [8.7426688]
curr_Stock_Price:  99.6348516725371
curr_Factors:  [99.63485167 -0.56511401 -1.03246045]
mat_Sqrt:  [[20.1647809   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00204448 -0.00197291 -0.06022152]
Stock Position:  -0.002044478640787316
Bond Position:  [8.94637012]


portfolio before change:  [8.74843875]
curr_Stock_Price:  97.90674128582457
curr_Factors:  [97.90674129 -0.59987771 -1.07265475]
mat_Sqrt:  [[18.38404082  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00542164 -0.02623263  0.22344863]
Stock Position:  -0.005421642230276428
Bond Position:  [9.27925408]


portfolio before change:  [8.75781371]
curr_Stock_Price:  96.60550327219792
curr_Factors:  [96.60550327 -0.76154283 -1.01949095]
mat_Sqrt:  [[16.27454006  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00264352  0.0108402  -0.28315562]
Stock Position:  -0.002643518207770991
Bond Position:  [9.01319211]


portfolio before change:  [8.76265296]
curr_Stock_Price:  95.62738510087804
curr_Factors:  [95.6273851  -0.70978216 -0.97870821]
mat_Sqrt:  [[17.6717772   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01168581 -0.0535601   1.05564592]
Stock Position:  -0.01168581300771242
Bond Position:  [9.8801367]


portfolio before change:  [8.76461678]
curr_Stock_Price:  95.67072984590283
curr_Factors:  [95.67072985 -0.46055697 -0.98580484]
mat_Sqrt:  [[22.52330603  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00019458 -0.00643442  0.05561831]
Stock Position:  0.00019457886116901448
Bond Position:  [8.74600128]


portfolio before change:  [8.76717893]
curr_Stock_Price:  97.59988365598575
curr_Factors:  [97.59988366 -0.30407659 -0.96985333]
mat_Sqrt:  [[27.30162927  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00240979  0.01950785 -0.01070933]
Stock Position:  0.0024097947418423187
Bond Position:  [8.53198324]


portfolio before change:  [8.761278]
curr_Stock_Price:  94.26590998333651
curr_Factors:  [94.26590998 -0.15519943 -0.99705407]
mat_Sqrt:  [[29.78086617  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00300132 -0.00300756 -0.42052611]
Stock Position:  -0.003001320848247275
Bond Position:  [9.04420024]


portfolio before change:  [8.75737632]
curr_Stock_Price:  96.31934280440875
curr_Factors:  [96.3193428  -0.51784208 -1.023268  ]
mat_Sqrt:  [[20.62613745  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00446114 -0.08354114 -1.03765206]
Stock Position:  -0.004461141979934573
Bond Position:  [9.18707058]


portfolio before change:  [8.76753509]
curr_Stock_Price:  94.55707745038202
curr_Factors:  [94.55707745 -0.34766257 -1.04068554]
mat_Sqrt:  [[23.59077024  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00314846 -0.01305135  0.01752767]
Stock Position:  0.0031484609798318824
Bond Position:  [8.46982582]


portfolio before change:  [8.7770215]
curr_Stock_Price:  96.89748617098991
curr_Factors:  [96.89748617 -0.32394433 -1.03980771]
mat_Sqrt:  [[24.77664647  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00048734 -0.01837468 -0.30801201]
Stock Position:  -0.00048734329304334567
Bond Position:  [8.82424384]


portfolio before change:  [8.77863341]
curr_Stock_Price:  98.11721122322797
curr_Factors:  [98.11721122 -0.44339107 -1.06591361]
mat_Sqrt:  [[21.6901473   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00604767  0.00085724 -0.00310558]
Stock Position:  0.0060476689079819014
Bond Position:  [8.185253]


portfolio before change:  [8.78192856]
curr_Stock_Price:  98.32366820970125
curr_Factors:  [98.32366821 -0.65459894 -1.04377513]
mat_Sqrt:  [[17.99134304  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00038681  0.03265341  0.19480917]
Stock Position:  -0.0003868105058790962
Bond Position:  [8.81996119]


portfolio before change:  [8.78339672]
curr_Stock_Price:  100.22927784512531
curr_Factors:  [100.22927785  -0.5145923   -1.05321024]
mat_Sqrt:  [[20.89809073  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00037485  0.00722076 -0.23366664]
Stock Position:  -0.0003748519787303774
Bond Position:  [8.82096786]


portfolio before change:  [8.78559459]
curr_Stock_Price:  100.24966641943446
curr_Factors:  [100.24966642  -0.57007555  -1.01551321]
mat_Sqrt:  [[20.53385481  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02058074 -0.29587048 -0.55646265]
Stock Position:  -0.020580738754798843
Bond Position:  [10.84880679]


portfolio before change:  [8.75980219]
curr_Stock_Price:  101.63469682761512
curr_Factors:  [101.63469683  -0.61391755  -1.06267432]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [8.75980219]
Stock Price:  99.95661545056485
PL:  [8.75980219]
Settle:  Tensor("sub_90:0", shape=(), dtype=float64)
PL:  Tensor("sub_91:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  46
output_Z_Vals[:, i, :]:  [[ 1.19251512e+02 -2.92846752e+01 -2.92776944e+01]
 [-1.16123370e-01  3.47388572e-02  1.59962784e-02]
 [-6.07753423e-01 -1.10101850e-01  4.45757736e-01]
 [ 8.13748350e-02 -1.51720674e-01 -4.56670276e-01]
 [-9.88296441e-02 -2.41910939e-01  2.15109929e-01]
 [-6.97053573e-01  2.89887065e-01 -1.28333578e-02]
 [ 5.10615817e-02  1.09206178e-01 -4.76883669e-02]
 [-1.79514119e-01  2.46584998e-01 -2.75050081e-02]
 [-7.66892052e-02 -1.97035831e-02  1.81769747e-02]
 [-1.33105213e-01 -1.00393928e-01 -5.32087443e-02]
 [ 2.75477262e-01 -1.56333900e-01 -1.03783461e-01]
 [-1.21514314e-01  1.12637767e-01  1.17610296e-01]
 [ 4.06681360e-02 -1.09271227e-02 -1.66466215e-01]
 [ 1.53700385e-02  7.88148573e-03  1.31750358e-01]
 [-2.39114543e-01  2.36740164e-01  4.11962457e-01]
 [-3.02302338e-01 -5.53372748e-01  3.48320315e-01]
 [-1.30053633e-01 -3.88700889e-01  1.48692565e-01]
 [-4.88722091e-01  6.86945151e-01 -1.23317276e-01]
 [-2.99454298e-01 -1.15423021e+00 -1.82558423e-01]
 [ 1.41180703e-01 -6.37514256e-02 -1.59925299e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.25151208 -29.28467519 -29.2776944 ]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  8.31409947  -9.26062741 -83.52111278]
init_Out:  [2.49223638]
Stock Position:  8.314099471154409
Bond position:  [-828.91771073]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-5.65969824]
curr_Stock_Price:  99.0444329762591
curr_Factors:  [99.04443298 -0.49404756 -1.02225126]
mat_Sqrt:  [[21.74251901  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00514941  0.01098539  0.04563293]
Stock Position:  -0.005149412086525102
Bond Position:  [-5.14967764]


portfolio before change:  [-5.68136959]
curr_Stock_Price:  103.00289872391792
curr_Factors:  [103.00289872  -0.66342371  -1.06527905]
mat_Sqrt:  [[18.28451216  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02841784 -0.03481726  1.27162275]
Stock Position:  -0.028417839062115518
Bond Position:  [-2.75424979]


portfolio before change:  [-5.6869851]
curr_Stock_Price:  103.1762709334595
curr_Factors:  [103.17627093  -0.58540051  -1.05817758]
mat_Sqrt:  [[19.9426531   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-7.90266254e-04 -4.79782897e-02 -1.30275319e+00]
Stock Position:  -0.0007902662539634392
Bond Position:  [-5.60544837]


portfolio before change:  [-5.69014485]
curr_Stock_Price:  105.40111180585687
curr_Factors:  [105.40111181  -0.68736355  -1.07230852]
mat_Sqrt:  [[18.13966739  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00337198 -0.07649896  0.61364875]
Stock Position:  -0.0033719817430228837
Bond Position:  [-5.33473423]


portfolio before change:  [-5.69495855]
curr_Stock_Price:  106.4330999819523
curr_Factors:  [106.43309998  -0.79625874  -1.11973067]
mat_Sqrt:  [[15.66653967  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.04418259  0.09167034 -0.03661   ]
Stock Position:  -0.04418259129172687
Bond Position:  [-0.99246839]


portfolio before change:  [-5.64424236]
curr_Stock_Price:  105.27960642704487
curr_Factors:  [105.27960643  -0.31287551  -1.0867243 ]
mat_Sqrt:  [[25.97202309  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00169979  0.03453403 -0.13604164]
Stock Position:  0.0016997877220423716
Bond Position:  [-5.82319534]


portfolio before change:  [-5.64815924]
curr_Stock_Price:  103.83183915765882
curr_Factors:  [ 1.03831839e+02 -8.68588470e-02 -1.10964114e+00]
mat_Sqrt:  [[31.38319861  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0056961   0.07797702 -0.07846413]
Stock Position:  -0.005696097476032335
Bond Position:  [-5.05672296]


portfolio before change:  [-5.66502984]
curr_Stock_Price:  106.57165609313203
curr_Factors:  [ 1.06571656e+02 -1.23253066e-03 -1.15738557e+00]
mat_Sqrt:  [[33.45494085  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00219661 -0.00623082  0.05185385]
Stock Position:  -0.0021966139608780894
Bond Position:  [-5.43093306]


portfolio before change:  [-5.66861417]
curr_Stock_Price:  107.58522774533921
curr_Factors:  [ 1.07585228e+02 -3.73338523e-02 -1.16712468e+00]
mat_Sqrt:  [[32.25989493  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00454306 -0.03174735 -0.15178974]
Stock Position:  -0.004543057640807907
Bond Position:  [-5.17984828]


portfolio before change:  [-5.66888654]
curr_Stock_Price:  107.36010230561158
curr_Factors:  [ 1.07360102e+02  1.28071940e-02 -1.16285130e+00]
mat_Sqrt:  [[33.9926565   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00736206 -0.04943712 -0.29606533]
Stock Position:  0.007362061502331183
Bond Position:  [-6.45927821]


portfolio before change:  [-5.65479628]
curr_Stock_Price:  109.49337415478105
curr_Factors:  [109.49337415  -0.72400595  -1.13949916]
mat_Sqrt:  [[16.98548116  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0055694   0.03561919  0.33550944]
Stock Position:  -0.00556939879382578
Bond Position:  [-5.04498402]


portfolio before change:  [-5.65133877]
curr_Stock_Price:  108.64608141750362
curr_Factors:  [108.64608142  -0.71883713  -1.13618426]
mat_Sqrt:  [[16.99763564  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 3.76889186e-04 -3.45545959e-03 -4.74881776e-01]
Stock Position:  0.00037688918641196425
Bond Position:  [-5.69228631]


portfolio before change:  [-5.65213908]
curr_Stock_Price:  110.29894114844495
curr_Factors:  [110.29894115  -0.53624827  -1.11823488]
mat_Sqrt:  [[21.08814802  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00201378 0.00249234 0.3758471 ]
Stock Position:  0.0020137836054951504
Bond Position:  [-5.87425728]


portfolio before change:  [-5.65345245]
curr_Stock_Price:  110.37609558852759
curr_Factors:  [110.37609559  -0.59805135  -1.1077156 ]
mat_Sqrt:  [[20.04794444  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00742772  0.07486381  1.17521422]
Stock Position:  -0.007427716795912725
Bond Position:  [-4.83361007]


portfolio before change:  [-5.67441946]
curr_Stock_Price:  113.03619308632096
curr_Factors:  [113.03619309  -0.5611573   -1.10716317]
mat_Sqrt:  [[21.31449994  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0115175  -0.17499183  0.9936609 ]
Stock Position:  -0.011517500979562957
Bond Position:  [-4.37252499]


portfolio before change:  [-5.69571608]
curr_Stock_Price:  114.7903372955533
curr_Factors:  [114.7903373   -0.56405573  -1.16649865]
mat_Sqrt:  [[20.3392584   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00539538 -0.12291801  0.4241785 ]
Stock Position:  -0.005395383749194143
Bond Position:  [-5.07637816]


portfolio before change:  [-5.69609382]
curr_Stock_Price:  114.62509986106171
curr_Factors:  [114.62509986  -0.73493536  -1.18791319]
mat_Sqrt:  [[16.7570364   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02960889  0.21723113 -0.35178986]
Stock Position:  -0.029608891781157595
Bond Position:  [-2.30217164]


portfolio before change:  [-5.6574498]
curr_Stock_Price:  113.30051019708695
curr_Factors:  [113.3005102   -0.85774488  -1.23202293]
mat_Sqrt:  [[14.01706976  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02614819 -0.36499964 -0.52078837]
Stock Position:  -0.026148188058208816
Bond Position:  [-2.69484675]


portfolio before change:  [-5.72195598]
curr_Stock_Price:  115.74168828617755
curr_Factors:  [115.74168829  -0.91959372  -1.22340606]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-5.72195598]
Stock Price:  115.259830460002
PL:  [-20.98178644]
Settle:  Tensor("sub_92:0", shape=(), dtype=float64)
PL:  Tensor("sub_93:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  47
output_Z_Vals[:, i, :]:  [[ 1.19251512e+02 -2.92846752e+01 -2.92776944e+01]
 [ 5.94526720e-02 -4.67956305e-02 -5.39166621e-02]
 [-5.59578842e-01 -9.96769545e-02  4.04321153e-01]
 [ 2.20775792e-02 -1.55643500e-01 -4.80742915e-01]
 [-9.88296441e-02 -2.41910939e-01  2.15109929e-01]
 [-2.05034080e-01 -1.34130191e-03  1.03586346e-03]
 [-2.46610947e-03  8.85551975e-04  1.07821376e-02]
 [-7.51074163e-02  1.21391520e-01 -6.76138731e-02]
 [-3.82510444e-01 -1.92742386e-01  4.18869936e-01]
 [ 3.46985853e-03 -9.55271562e-03  1.62656453e-02]
 [-1.21552180e-01  1.02656293e-01  1.46700753e-02]
 [-1.22691831e-01 -9.26325263e-03 -1.44860674e-01]
 [-4.32675602e-02 -4.20405258e-01 -3.58300386e-01]
 [-3.10862294e-02  1.23267354e-02 -2.01561957e-02]
 [ 1.11348156e-02 -5.79141975e-02 -1.09473076e-01]
 [ 1.79875620e-01  4.88119506e-02 -1.34061347e-01]
 [ 2.32913811e-02 -3.43054651e-02  1.05729965e-01]
 [ 4.16196696e-02 -2.49874608e-02  6.99696018e-02]
 [-4.17487900e-01 -1.05265453e+00 -2.91648964e-01]
 [ 1.24372522e-01 -1.36930706e-01 -2.19713108e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.25151208 -29.28467519 -29.2776944 ]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  8.31409947  -9.26062741 -83.52111278]
init_Out:  [2.49223638]
Stock Position:  8.314099471154409
Bond position:  [-828.91771073]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [8.92465841]
curr_Stock_Price:  100.79860451275952
curr_Factors:  [100.79860451  -0.89675186  -0.9985357 ]
mat_Sqrt:  [[15.14752199  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00311858 -0.01479808 -0.15380923]
Stock Position:  0.003118577511441484
Bond Position:  [8.61031015]


portfolio before change:  [8.93213991]
curr_Stock_Price:  102.50728521680529
curr_Factors:  [102.50728522  -0.86782151  -1.04432515]
mat_Sqrt:  [[15.14676855  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.03166489 -0.03152062  1.15341571]
Stock Position:  -0.03166489129703001
Bond Position:  [12.17802195]


portfolio before change:  [8.92763809]
curr_Stock_Price:  102.74561557749328
curr_Factors:  [102.74561558  -0.84275262  -1.06729947]
mat_Sqrt:  [[15.21381794  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00526313 -0.0492188  -1.37142572]
Stock Position:  -0.005263133526504065
Bond Position:  [9.46840198]


portfolio before change:  [8.9311992]
curr_Stock_Price:  102.51880840347084
curr_Factors:  [102.5188084   -0.66315752  -1.06450276]
mat_Sqrt:  [[18.21756065  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00335756 -0.07649896  0.61364875]
Stock Position:  -0.0033575640805249855
Bond Position:  [9.27541267]


portfolio before change:  [8.9358637]
curr_Stock_Price:  101.82027878416979
curr_Factors:  [101.82027878  -0.44325962  -1.04060018]
mat_Sqrt:  [[23.08884247  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00887257 -0.00042416  0.00295503]
Stock Position:  -0.008872565528147388
Bond Position:  [9.8392708]


portfolio before change:  [8.95763344]
curr_Stock_Price:  99.64395142843013
curr_Factors:  [ 9.96439514e+01 -1.56885208e-02 -1.02158186e+00]
mat_Sqrt:  [[35.31588881  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-6.86235033e-06  2.80036123e-04  3.07584374e-02]
Stock Position:  -6.862350330457059e-06
Bond Position:  [8.95831723]


portfolio before change:  [8.95987997]
curr_Stock_Price:  98.67112818853906
curr_Factors:  [ 9.86711282e+01  1.74807122e-02 -1.01922248e+00]
mat_Sqrt:  [[36.23591     0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00236712  0.03838737 -0.19288356]
Stock Position:  -0.002367119379220398
Bond Position:  [9.19344631]


portfolio before change:  [8.96739188]
curr_Stock_Price:  96.46876175143491
curr_Factors:  [ 9.64687618e+01  7.05273111e-02 -1.02658476e+00]
mat_Sqrt:  [[37.0831167   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00814348 -0.06095049  1.19491934]
Stock Position:  -0.00814347848874705
Bond Position:  [9.75298317]


portfolio before change:  [8.97616261]
curr_Stock_Price:  95.69118590956295
curr_Factors:  [95.69118591 -0.15576453 -1.02724951]
mat_Sqrt:  [[29.31537595  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00022321 -0.00302083  0.04640136]
Stock Position:  0.00022320776049635524
Bond Position:  [8.95480359]


portfolio before change:  [8.97728303]
curr_Stock_Price:  90.679918550188
curr_Factors:  [90.67991855  0.10096659 -1.05176156]
mat_Sqrt:  [[35.04177598  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00330768  0.03246277  0.04184964]
Stock Position:  -0.0033076830636544537
Bond Position:  [9.27722346]


portfolio before change:  [8.97111457]
curr_Stock_Price:  93.24608235976697
curr_Factors:  [93.24608236 -0.41326573 -1.01251042]
mat_Sqrt:  [[22.40907246  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0068053  -0.0029293  -0.41324718]
Stock Position:  -0.006805304805547185
Bond Position:  [9.60568259]


portfolio before change:  [8.96785954]
curr_Stock_Price:  94.0773093579948
curr_Factors:  [94.07730936 -0.334444   -1.00778648]
mat_Sqrt:  [[24.57885207  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00517763 -0.13294382 -1.02213127]
Stock Position:  -0.005177627375108828
Bond Position:  [9.45495679]


portfolio before change:  [8.95226911]
curr_Stock_Price:  97.54500988333876
curr_Factors:  [97.54500988 -0.17964001 -1.00227659]
mat_Sqrt:  [[29.91611525  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.001166    0.00389806 -0.05750002]
Stock Position:  -0.0011660043555212567
Bond Position:  [9.06600702]


portfolio before change:  [8.95680771]
curr_Stock_Price:  95.59663603183384
curr_Factors:  [95.59663603 -0.33354902 -0.96875977]
mat_Sqrt:  [[25.99304082  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00048885 -0.01831408 -0.31229621]
Stock Position:  -0.000488847024467396
Bond Position:  [9.00353984]


portfolio before change:  [8.95968706]
curr_Stock_Price:  94.31161499951592
curr_Factors:  [94.311615   -0.20696635 -1.02989432]
mat_Sqrt:  [[27.37810707  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00561656  0.01543569 -0.38243971]
Stock Position:  0.005616560018344015
Bond Position:  [8.42998021]


portfolio before change:  [8.96277461]
curr_Stock_Price:  94.48606280968926
curr_Factors:  [94.48606281 -0.3748684  -1.01889709]
mat_Sqrt:  [[23.44569398  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00187615 -0.01084834  0.30161816]
Stock Position:  0.0018761507553704392
Bond Position:  [8.78550451]


portfolio before change:  [8.96271908]
curr_Stock_Price:  93.285637345005
curr_Factors:  [93.28563735 -0.19246264 -1.05462353]
mat_Sqrt:  [[26.80477356  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00206146 -0.00790173  0.1996038 ]
Stock Position:  0.0020614604758481094
Bond Position:  [8.77041443]


portfolio before change:  [8.96475428]
curr_Stock_Price:  93.20914856236351
curr_Factors:  [ 9.32091486e+01 -8.40698159e-02 -1.04263540e+00]
mat_Sqrt:  [[30.20902322  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01669037 -0.33287859 -0.83199331]
Stock Position:  -0.016690374759119244
Bond Position:  [10.5204499]


portfolio before change:  [8.91119552]
curr_Stock_Price:  96.57571214168487
curr_Factors:  [96.57571214 -0.12769071 -1.08194609]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [8.91119552]
Stock Price:  95.57645195925465
PL:  [8.91119552]
Settle:  Tensor("sub_94:0", shape=(), dtype=float64)
PL:  Tensor("sub_95:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  48
output_Z_Vals[:, i, :]:  [[ 1.19251512e+02 -2.92846752e+01 -2.92776944e+01]
 [ 2.87602784e-02 -6.77785636e-02 -1.54052644e-01]
 [-4.76859704e-01 -8.17766769e-02  3.33171631e-01]
 [-6.03762344e-02 -1.00279571e-01 -3.24803903e-01]
 [-9.88296441e-02 -2.41910939e-01  2.15109929e-01]
 [-4.49135696e-02 -1.51238809e-02 -2.43067555e-02]
 [ 5.41939722e-02  5.70909064e-02 -2.72504812e-02]
 [-1.65865789e-01  2.37518432e-01 -4.68870978e-02]
 [-4.66349262e-02 -8.66854762e-03 -9.58629064e-03]
 [-4.73772408e-02 -2.83422522e-02 -3.13274205e-02]
 [ 2.93011611e-01 -1.78932826e-01 -1.16093869e-01]
 [-1.14936684e-01  8.06261286e-02  7.73874632e-02]
 [ 3.83065051e-02 -1.33256070e-02 -2.44579454e-01]
 [-7.58349074e-02  2.44809994e-02 -3.37487728e-02]
 [-9.79485972e-02  3.41110176e-02  1.92000733e-01]
 [-7.05692933e-02 -1.41595576e-01  1.55881495e-01]
 [-2.77586730e-02 -4.93108099e-02  2.57030863e-01]
 [-2.39339972e-01  3.65939812e-01 -9.00821443e-02]
 [-3.16192138e-01 -1.07474630e+00 -2.01413173e-01]
 [ 1.22884245e-01 -7.69437569e-02 -1.59787364e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.25151208 -29.28467519 -29.2776944 ]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  8.31409947  -9.26062741 -83.52111278]
init_Out:  [2.49223638]
Stock Position:  8.314099471154409
Bond position:  [-828.91771073]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [12.71280179]
curr_Stock_Price:  101.25423333831066
curr_Factors:  [101.25423334  -0.91870343  -1.02212098]
mat_Sqrt:  [[14.53864248  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-3.05091814e-04 -2.14334638e-02 -4.39469313e-01]
Stock Position:  -0.0003050918136460908
Bond Position:  [12.74369362]


portfolio before change:  [12.71587965]
curr_Stock_Price:  101.60972535927858
curr_Factors:  [101.60972536  -1.18556573  -1.04923141]
mat_Sqrt:  [[10.87364662  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.03779439 -0.02586006  0.95044593]
Stock Position:  -0.03779438570511317
Bond Position:  [16.5561568]


portfolio before change:  [12.73563372]
curr_Stock_Price:  101.196581680638
curr_Factors:  [101.19658168  -1.11886089  -1.02346561]
mat_Sqrt:  [[11.87860026  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01088224 -0.03171118 -0.92657513]
Stock Position:  -0.010882238481263738
Bond Position:  [13.83687905]


portfolio before change:  [12.73744774]
curr_Stock_Price:  101.34780364188376
curr_Factors:  [101.34780364  -0.66357102  -0.9929682 ]
mat_Sqrt:  [[19.33697334  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0031632  -0.07649896  0.61364875]
Stock Position:  -0.0031631955103043944
Bond Position:  [13.05803065]


portfolio before change:  [12.74515183]
curr_Stock_Price:  99.9444204001962
curr_Factors:  [99.9444204  -0.38250578 -0.99189154]
mat_Sqrt:  [[25.28514099  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00198795 -0.00478259 -0.06934041]
Stock Position:  -0.0019879526158932325
Bond Position:  [12.9438366]


portfolio before change:  [12.74457215]
curr_Stock_Price:  101.86400637954716
curr_Factors:  [101.86400638  -0.37601928  -0.98956321]
mat_Sqrt:  [[25.99895028  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00192722  0.01805373 -0.07773804]
Stock Position:  0.001927215188693571
Bond Position:  [12.54825829]


portfolio before change:  [12.75101911]
curr_Stock_Price:  103.5812532040578
curr_Factors:  [103.5812532   -0.55671956  -1.02642559]
mat_Sqrt:  [[21.26816197  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00796044  0.07510992 -0.13375584]
Stock Position:  -0.007960437681046624
Bond Position:  [13.57557122]


portfolio before change:  [12.73225927]
curr_Stock_Price:  106.36428562261406
curr_Factors:  [106.36428562  -0.72469166  -1.03306258]
mat_Sqrt:  [[18.34057127  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00266162 -0.00274124 -0.02734702]
Stock Position:  -0.0026616150505428303
Bond Position:  [13.01536005]


portfolio before change:  [12.73747495]
curr_Stock_Price:  105.62735180829418
curr_Factors:  [105.62735181  -0.67588817  -1.00762753]
mat_Sqrt:  [[19.61710043  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00277838 -0.00896261 -0.08936841]
Stock Position:  -0.0027783778588760027
Bond Position:  [13.03094764]


portfolio before change:  [12.73393859]
curr_Stock_Price:  108.07284391787356
curr_Factors:  [108.07284392  -0.45526773  -0.99592182]
mat_Sqrt:  [[25.32054024  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01045373 -0.05658353 -0.33118349]
Stock Position:  0.010453727332976358
Bond Position:  [11.60417455]


portfolio before change:  [12.73873911]
curr_Stock_Price:  108.25451220750753
curr_Factors:  [108.25451221  -0.65480726  -1.01799171]
mat_Sqrt:  [[20.32163491  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00477611  0.02549622  0.22076489]
Stock Position:  -0.00477610570041689
Bond Position:  [13.2557741]


portfolio before change:  [12.7594766]
curr_Stock_Price:  104.60653350487654
curr_Factors:  [104.6065335   -0.65327715  -1.03493074]
mat_Sqrt:  [[19.33657005  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-6.18627430e-04 -4.21392693e-03 -6.97717105e-01]
Stock Position:  -0.0006186274298139099
Bond Position:  [12.82418907]


portfolio before change:  [12.76363335]
curr_Stock_Price:  103.0703920331883
curr_Factors:  [103.07039203  -0.26730378  -1.02582379]
mat_Sqrt:  [[28.28367001  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00290244  0.00774157 -0.09627585]
Stock Position:  -0.0029024433547933837
Bond Position:  [13.06278932]


portfolio before change:  [12.76777693]
curr_Stock_Price:  102.76806889713514
curr_Factors:  [102.7680689   -0.22814522  -1.02156209]
mat_Sqrt:  [[29.45216399  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00196508  0.01078685  0.54772465]
Stock Position:  -0.0019650803606661906
Bond Position:  [12.96972444]


portfolio before change:  [12.76803111]
curr_Stock_Price:  104.28894896710936
curr_Factors:  [104.28894897  -0.12514691  -1.03771201]
mat_Sqrt:  [[32.59981073  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00130081 -0.04477645  0.44468651]
Stock Position:  -0.001300808120392146
Bond Position:  [12.90369102]


portfolio before change:  [12.77003346]
curr_Stock_Price:  105.22988794847015
curr_Factors:  [105.22988795  -0.41227734  -1.01161809]
mat_Sqrt:  [[25.33664918  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00092492 -0.01559345  0.73323751]
Stock Position:  0.0009249183770113127
Bond Position:  [12.6727044]


portfolio before change:  [12.77578701]
curr_Stock_Price:  108.02471301530296
curr_Factors:  [108.02471302  -0.7079011   -1.0019806 ]
mat_Sqrt:  [[19.54028701  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01270603  0.11572033 -0.25697928]
Stock Position:  -0.012706025627506204
Bond Position:  [14.14835179]


portfolio before change:  [12.75941642]
curr_Stock_Price:  109.59153871838494
curr_Factors:  [109.59153872  -0.58266547  -1.01975604]
mat_Sqrt:  [[22.07263632  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01744491 -0.33986462 -0.57457572]
Stock Position:  -0.017444914767867088
Bond Position:  [14.67123147]


portfolio before change:  [12.76953943]
curr_Stock_Price:  109.22153154984595
curr_Factors:  [109.22153155  -0.70157884  -1.00220022]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [12.76953943]
Stock Price:  106.76997381724357
PL:  [5.99956561]
Settle:  Tensor("sub_96:0", shape=(), dtype=float64)
PL:  Tensor("sub_97:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  49
output_Z_Vals[:, i, :]:  [[ 1.19251512e+02 -2.92846752e+01 -2.92776944e+01]
 [-1.67802236e-01  4.48385584e-02  2.04869169e-02]
 [-6.79399243e-02  1.71340045e-02  6.38711452e-02]
 [-3.25278351e-02  2.63047188e-02  2.86375828e-02]
 [-8.31109574e-02 -1.10560551e-01  8.18800594e-02]
 [-1.29138274e-01  6.42170408e-02 -1.45822132e-03]
 [-2.80987961e-01 -2.77664165e-01  2.14969413e-01]
 [ 4.50472683e-03 -1.92304340e-02 -8.93553478e-02]
 [-3.45513628e-01 -1.96243082e-01  4.29913896e-01]
 [ 1.49261927e-02  6.27195123e-03  1.13310111e-02]
 [-1.11407077e-01  1.12868404e-01  1.85104505e-02]
 [-1.33634009e-01 -1.00718480e-02 -1.55551018e-01]
 [-7.08296368e-02 -5.52887773e-01 -3.50714988e-01]
 [ 9.18599576e-02 -6.08470814e-02 -3.24153977e-03]
 [ 1.11348156e-02 -5.79141975e-02 -1.09473076e-01]
 [ 1.72142818e-01  3.76944627e-02 -9.81330443e-02]
 [-2.63909998e-02  9.16987618e-02  9.26749310e-02]
 [-5.03509687e-02  9.97271358e-02 -1.00169330e-01]
 [-4.06169672e-01 -1.04015540e+00 -2.76412901e-01]
 [ 1.40694641e-01 -1.63751667e-01 -2.57701924e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.25151208 -29.28467519 -29.2776944 ]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  8.31409947  -9.26062741 -83.52111278]
init_Out:  [2.49223638]
Stock Position:  8.314099471154409
Bond position:  [-828.91771073]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-2.47776178]
curr_Stock_Price:  99.42714868324832
curr_Factors:  [99.42714868 -0.9859678  -1.01581043]
mat_Sqrt:  [[13.43209474  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01209511  0.0141792   0.05844347]
Stock Position:  -0.01209510787093266
Bond Position:  [-1.27517969]


portfolio before change:  [-2.47055033]
curr_Stock_Price:  98.80455986382495
curr_Factors:  [98.80455986 -0.76240815 -0.96290066]
mat_Sqrt:  [[17.59887448  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00309451  0.00541825  0.1822066 ]
Stock Position:  -0.0030945094425704374
Bond Position:  [-2.16479869]


portfolio before change:  [-2.4721809]
curr_Stock_Price:  99.15656898493397
curr_Factors:  [99.15656898 -0.7257437  -0.94695634]
mat_Sqrt:  [[18.61560226  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00139684  0.00831828  0.08169505]
Stock Position:  -0.0013968405475764797
Bond Position:  [-2.33367498]


portfolio before change:  [-2.46971317]
curr_Stock_Price:  96.9721979024937
curr_Factors:  [96.9721979  -1.01422798 -0.95448762]
mat_Sqrt:  [[13.54081842  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00511431 -0.03496232  0.23358102]
Stock Position:  -0.005114308404114732
Bond Position:  [-1.97376744]


portfolio before change:  [-2.46787757]
curr_Stock_Price:  96.5167885366916
curr_Factors:  [96.51678854 -0.75163868 -0.94756822]
mat_Sqrt:  [[17.64601659  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00724117  0.02030721 -0.0041599 ]
Stock Position:  -0.0072411728146135465
Bond Position:  [-1.76898282]


portfolio before change:  [-2.45609229]
curr_Stock_Price:  94.82816972583139
curr_Factors:  [94.82816973 -0.62307401 -0.94886379]
mat_Sqrt:  [[19.69035087  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01240591 -0.08780512  0.6132479 ]
Stock Position:  -0.012405912553123148
Bond Position:  [-1.27966231]


portfolio before change:  [-2.46159433]
curr_Stock_Price:  95.24588016706691
curr_Factors:  [95.24588017 -0.61027826 -0.96250212]
mat_Sqrt:  [[19.76042872  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0007202  -0.0060812  -0.25490594]
Stock Position:  -0.0007201961578449004
Bond Position:  [-2.39299861]


portfolio before change:  [-2.46224275]
curr_Stock_Price:  95.31545155673683
curr_Factors:  [95.31545156 -0.21961394 -0.99491486]
mat_Sqrt:  [[28.2943781   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00928894 -0.06205751  1.22642468]
Stock Position:  -0.009288940536073757
Bond Position:  [-1.57686319]


portfolio before change:  [-2.46796442]
curr_Stock_Price:  95.88897209542566
curr_Factors:  [95.8889721   0.10232614 -0.9861818 ]
mat_Sqrt:  [[39.62005102  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.0004392  0.00198337 0.03232422]
Stock Position:  0.00043919849334653595
Bond Position:  [-2.51007871]


portfolio before change:  [-2.47030208]
curr_Stock_Price:  91.9953788492258
curr_Factors:  [91.99537885 -0.10174761 -0.98652776]
mat_Sqrt:  [[30.98375313  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00337966  0.03569212  0.05280516]
Stock Position:  -0.003379655044452274
Bond Position:  [-2.15938943]


portfolio before change:  [-2.46881644]
curr_Stock_Price:  91.3960417847944
curr_Factors:  [ 9.13960418e+01  8.62844585e-02 -9.50498471e-01]
mat_Sqrt:  [[38.51270391  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00430107 -0.003185   -0.44374376]
Stock Position:  -0.004301068599915102
Bond Position:  [-2.07571579]


portfolio before change:  [-2.47253869]
curr_Stock_Price:  92.14079928484993
curr_Factors:  [92.14079928 -0.16837851 -0.9766836 ]
mat_Sqrt:  [[29.31958508  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00534436 -0.17483847 -1.00049224]
Stock Position:  -0.005344363993954735
Bond Position:  [-1.98010472]


portfolio before change:  [-2.47982808]
curr_Stock_Price:  93.41210234662014
curr_Factors:  [93.41210235 -0.12886624 -0.98774704]
mat_Sqrt:  [[30.58187877  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00293073 -0.01924154 -0.00924721]
Stock Position:  0.00293072956159636
Bond Position:  [-2.75359369]


portfolio before change:  [-2.47018883]
curr_Stock_Price:  96.93605026603936
curr_Factors:  [96.93605027  0.28236385 -0.96972758]
mat_Sqrt:  [[48.74914973  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-2.60653175e-04 -1.83140773e-02 -3.12296215e-01]
Stock Position:  -0.0002606531751060422
Bond Position:  [-2.44492214]


portfolio before change:  [-2.47060273]
curr_Stock_Price:  96.1787188023206
curr_Factors:  [ 9.61787188e+01 -4.72630710e-02 -9.99884466e-01]
mat_Sqrt:  [[33.75270553  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00453548  0.01192004 -0.27994626]
Stock Position:  0.004535481185758675
Bond Position:  [-2.9068195]


portfolio before change:  [-2.45755007]
curr_Stock_Price:  99.21686518390452
curr_Factors:  [99.21686518  0.14202091 -1.01690351]
mat_Sqrt:  [[41.36459864  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-1.23442679e-04  2.89976946e-02  2.64375783e-01]
Stock Position:  -0.00012344267873395476
Bond Position:  [-2.44530248]


portfolio before change:  [-2.45853302]
curr_Stock_Price:  102.22674263297314
curr_Factors:  [ 1.02226743e+02 -6.24685208e-02 -1.02048744e+00]
mat_Sqrt:  [[34.61327755  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00197101  0.03153649 -0.28575522]
Stock Position:  -0.0019710067599387304
Bond Position:  [-2.25704342]


portfolio before change:  [-2.45233877]
curr_Stock_Price:  98.79774468090818
curr_Factors:  [ 9.87977447e+01  2.94055076e-02 -9.98077102e-01]
mat_Sqrt:  [[37.50233445  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01305116 -0.32892602 -0.78852907]
Stock Position:  -0.013051158633142173
Bond Position:  [-1.16291374]


portfolio before change:  [-2.41358035]
curr_Stock_Price:  95.8057349427423
curr_Factors:  [95.80573494 -0.26351971 -0.9794715 ]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-2.41358035]
Stock Price:  97.50818791787802
PL:  [-2.41358035]
Settle:  Tensor("sub_98:0", shape=(), dtype=float64)
PL:  Tensor("sub_99:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  50
output_Z_Vals[:, i, :]:  [[ 1.19251512e+02 -2.92846752e+01 -2.92776944e+01]
 [ 2.52940063e-02 -6.88508339e-02 -1.82701619e-01]
 [-3.58307113e-01 -5.61221021e-02  2.31200546e-01]
 [-2.78474018e-02  1.89910755e-02  1.19088873e-02]
 [-8.65751461e-02 -1.39508422e-01  1.11242144e-01]
 [-9.34401923e-03 -2.00301174e-02 -1.47867272e-02]
 [-2.11537847e-02  1.27286562e-03  1.43423138e-02]
 [-8.74711281e-02  1.52473036e-01 -9.38306080e-02]
 [-2.77456409e-01 -1.30312581e-01  2.76063817e-01]
 [ 6.74226849e-02  5.59717689e-02 -4.59043945e-03]
 [ 1.85062955e-02  9.28318417e-02 -9.38258038e-03]
 [-2.98965363e-02 -8.75868411e-03 -1.03169516e-01]
 [ 4.70349642e-02 -5.18904211e-02 -1.84811825e-01]
 [-5.28136859e-02  2.26179475e-02 -1.65812158e-02]
 [ 2.32289800e-02 -6.47233406e-02 -4.72085473e-02]
 [ 9.04779159e-02 -8.18228585e-03  4.66415997e-02]
 [-2.35647895e-02  1.03259148e-01  6.82888801e-02]
 [ 4.32444602e-02 -2.20728155e-02  3.67216891e-02]
 [-3.08301334e-01 -8.00080695e-01 -1.39542799e-01]
 [ 8.48378470e-02 -6.35527525e-02 -1.19442737e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.25151208 -29.28467519 -29.2776944 ]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  8.31409947  -9.26062741 -83.52111278]
init_Out:  [2.49223638]
Stock Position:  8.314099471154409
Bond position:  [-828.91771073]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [9.64747182]
curr_Stock_Price:  100.88554278078396
curr_Factors:  [100.88554278  -1.17843015  -0.98112274]
mat_Sqrt:  [[11.63984054  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00118365 -0.02177255 -0.52119686]
Stock Position:  -0.0011836524999801242
Bond Position:  [9.76688524]


portfolio before change:  [9.64983096]
curr_Stock_Price:  100.95556814855722
curr_Factors:  [100.95556815  -1.14517526  -0.99393866]
mat_Sqrt:  [[11.88844094  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0262913  -0.01774737  0.65955081]
Stock Position:  -0.02629129984012495
Bond Position:  [12.30408407]


portfolio before change:  [9.68663863]
curr_Stock_Price:  99.6725861850642
curr_Factors:  [99.67258619 -1.17056845 -0.97788136]
mat_Sqrt:  [[11.62828933  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00214358  0.00600551  0.03397274]
Stock Position:  -0.0021435795196219397
Bond Position:  [9.90029474]


portfolio before change:  [9.69144149]
curr_Stock_Price:  98.58679371623748
curr_Factors:  [98.58679372 -0.95169229 -1.00551227]
mat_Sqrt:  [[13.92565397  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00484502 -0.04411644  0.31734287]
Stock Position:  -0.004845017026876712
Bond Position:  [10.16909619]


portfolio before change:  [9.69013948]
curr_Stock_Price:  99.38030996441074
curr_Factors:  [99.38030996 -0.98619337 -1.00091251]
mat_Sqrt:  [[13.62420686  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00094534 -0.00633408 -0.04218242]
Stock Position:  -0.0009453410989524019
Bond Position:  [9.78408778]


portfolio before change:  [9.6928643]
curr_Stock_Price:  99.08571895244698
curr_Factors:  [99.08571895 -1.18648617 -1.01911292]
mat_Sqrt:  [[10.91770993  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0016664   0.00040252  0.04091463]
Stock Position:  -0.0016664032148464348
Bond Position:  [9.85798106]


portfolio before change:  [9.69367681]
curr_Stock_Price:  100.07725171604558
curr_Factors:  [100.07725172  -1.00338504  -0.9991767 ]
mat_Sqrt:  [[13.50933151  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00760122  0.04821621 -0.26767261]
Stock Position:  -0.007601218739968096
Bond Position:  [10.45438589]


portfolio before change:  [9.70939676]
curr_Stock_Price:  98.35305089575468
curr_Factors:  [98.3530509  -0.67709259 -0.95117001]
mat_Sqrt:  [[19.30378055  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01162828 -0.04120846  0.78753323]
Stock Position:  -0.011628280474804556
Bond Position:  [10.85307362]


portfolio before change:  [9.70731393]
curr_Stock_Price:  98.76553159672731
curr_Factors:  [98.7655316  -0.80026418 -0.94666866]
mat_Sqrt:  [[17.21559793  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00394589  0.01769983 -0.01309525]
Stock Position:  0.003945889677989515
Bond Position:  [9.31759604]


portfolio before change:  [9.71214936]
curr_Stock_Price:  99.4005561836913
curr_Factors:  [99.40055618 -1.28501316 -0.97992344]
mat_Sqrt:  [[10.32141752  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00183967  0.02935601 -0.02676589]
Stock Position:  0.0018396690277927544
Bond Position:  [9.52928523]


portfolio before change:  [9.71234933]
curr_Stock_Price:  98.21412296895197
curr_Factors:  [98.21412297 -1.3275367  -0.93968228]
mat_Sqrt:  [[10.17497271  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00503019 -0.00276974 -0.29431391]
Stock Position:  -0.005030192732969013
Bond Position:  [10.2063853]


portfolio before change:  [9.71244649]
curr_Stock_Price:  98.70212763327947
curr_Factors:  [98.70212763 -1.49187856 -0.9381892 ]
mat_Sqrt:  [[ 8.68883391  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00091734 -0.01640919 -0.5272167 ]
Stock Position:  0.0009173386818517379
Bond Position:  [9.62190321]


portfolio before change:  [9.71472834]
curr_Stock_Price:  98.5670334921876
curr_Factors:  [98.56703349 -1.45430844 -0.90369213]
mat_Sqrt:  [[ 9.325348    0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00596378  0.00715242 -0.04730159]
Stock Position:  -0.005963779524605675
Bond Position:  [10.30256039]


portfolio before change:  [9.71889459]
curr_Stock_Price:  98.30037465150109
curr_Factors:  [98.30037465 -1.33457458 -0.89385883]
mat_Sqrt:  [[10.5866569   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00112608 -0.02046732 -0.13467285]
Stock Position:  0.0011260803408236326
Bond Position:  [9.60820047]


portfolio before change:  [9.72209607]
curr_Stock_Price:  99.01002798733563
curr_Factors:  [99.01002799 -0.84199506 -0.89782189]
mat_Sqrt:  [[17.38146107  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00574102 -0.00258747  0.1330555 ]
Stock Position:  0.005741020648919545
Bond Position:  [9.15367746]


portfolio before change:  [9.71887023]
curr_Stock_Price:  98.04947711341065
curr_Factors:  [98.04947711 -0.70733088 -0.91114338]
mat_Sqrt:  [[19.43349179  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00035811  0.03265341  0.19480917]
Stock Position:  -0.00035810551072649853
Bond Position:  [9.75398229]


portfolio before change:  [9.72155024]
curr_Stock_Price:  97.37591301308731
curr_Factors:  [97.37591301 -0.73452975 -0.95193471]
mat_Sqrt:  [[18.03139521  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00278239 -0.00698004  0.10475676]
Stock Position:  0.0027823873518102995
Bond Position:  [9.45061273]


portfolio before change:  [9.7252607]
curr_Stock_Price:  97.8602123790492
curr_Factors:  [97.86021238 -0.86839227 -0.93590484]
mat_Sqrt:  [[16.10682269  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02219205 -0.25300773 -0.39807676]
Stock Position:  -0.02219204807280435
Bond Position:  [11.89697924]


portfolio before change:  [9.69128497]
curr_Stock_Price:  99.5252389011362
curr_Factors:  [99.5252389  -1.18930318 -0.99599429]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [9.69128497]
Stock Price:  99.57105526653129
PL:  [9.69128497]
Settle:  Tensor("sub_100:0", shape=(), dtype=float64)
PL:  Tensor("sub_101:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  51
output_Z_Vals[:, i, :]:  [[ 1.19251512e+02 -2.92846752e+01 -2.92776944e+01]
 [-8.28761397e-02 -1.26247816e-02 -7.25300556e-02]
 [-3.25850585e-01 -4.84363540e-02  2.08521301e-01]
 [-6.09429471e-02 -1.02699386e-01 -3.31641167e-01]
 [-9.88296441e-02 -2.41910939e-01  2.15109929e-01]
 [-1.54198909e-01 -6.60471300e-02  2.32765469e-02]
 [ 5.57133311e-02  3.18125111e-02 -1.73371306e-02]
 [-1.03908800e-01  1.72843998e-01 -8.92884552e-02]
 [-1.53213781e-01 -7.30696118e-02  1.47098785e-01]
 [ 4.50470017e-02  4.74936917e-02 -1.18045691e-02]
 [ 9.35439460e-02  3.92503270e-02 -1.67120397e-02]
 [ 9.59063525e-02 -1.05114315e-02 -1.30697411e-01]
 [ 5.32738446e-02 -5.49702861e-03 -1.27097249e-01]
 [-8.45720117e-02  2.97281712e-02 -3.59999752e-02]
 [-1.21262465e-01  7.06480022e-02  2.41996422e-01]
 [-3.97359465e-02 -1.03028694e-01  1.33997709e-01]
 [-2.59445489e-02  6.29857593e-02  1.27602260e-01]
 [-3.07861085e-02  8.03223479e-02 -7.86408993e-02]
 [-2.39108208e-01 -7.47030495e-01 -3.35729362e-02]
 [ 8.02966931e-02 -5.31167387e-02 -1.05955384e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.25151208 -29.28467519 -29.2776944 ]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  8.31409947  -9.26062741 -83.52111278]
init_Out:  [2.49223638]
Stock Position:  8.314099471154409
Bond position:  [-828.91771073]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [3.59803001]
curr_Stock_Price:  100.15793038784959
curr_Factors:  [100.15793039  -1.19902134  -0.99115634]
mat_Sqrt:  [[11.20735842  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0087449  -0.00399231 -0.20690806]
Stock Position:  -0.008744901528705794
Bond Position:  [4.47390124]


portfolio before change:  [3.59451983]
curr_Stock_Price:  100.68724291867747
curr_Factors:  [100.68724292  -1.19420905  -0.9935586 ]
mat_Sqrt:  [[11.29377239  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02519415 -0.01531692  0.59485323]
Stock Position:  -0.0251941481002563
Bond Position:  [6.13124914]


portfolio before change:  [3.58093019]
curr_Stock_Price:  101.28748755025735
curr_Factors:  [101.28748755  -1.17658177  -0.99960442]
mat_Sqrt:  [[11.49344289  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01142309 -0.0324764  -0.94607994]
Stock Position:  -0.0114230874705454
Bond Position:  [4.73794602]


portfolio before change:  [3.59211058]
curr_Stock_Price:  100.41243890068071
curr_Factors:  [100.4124389   -0.81716153  -0.93829612]
mat_Sqrt:  [[17.35409404  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00352462 -0.07649896  0.61364875]
Stock Position:  -0.0035246223244046596
Bond Position:  [3.9460265]


portfolio before change:  [3.58751353]
curr_Stock_Price:  101.99663044905878
curr_Factors:  [101.99663045  -1.1182274   -0.93191029]
mat_Sqrt:  [[13.12871868  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01151315 -0.02088594  0.06640151]
Stock Position:  -0.011513152001361996
Bond Position:  [4.76181624]


portfolio before change:  [3.59664201]
curr_Stock_Price:  101.30716910473147
curr_Factors:  [101.3071691   -1.13535514  -0.92372027]
mat_Sqrt:  [[12.92394471  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00410059  0.01006    -0.04945801]
Stock Position:  0.00410059009840771
Bond Position:  [3.18122283]


portfolio before change:  [3.5964599]
curr_Stock_Price:  101.0687850534758
curr_Factors:  [101.06878505  -1.12790158  -0.88619996]
mat_Sqrt:  [[13.48664298  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00872507  0.05465807 -0.25471511]
Stock Position:  -0.008725070932283748
Bond Position:  [4.47829222]


portfolio before change:  [3.6053374]
curr_Stock_Price:  100.17964726717062
curr_Factors:  [100.17964727  -1.06158673  -0.90634669]
mat_Sqrt:  [[13.99964012  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00893409 -0.02310664  0.41963189]
Stock Position:  -0.008934087966264569
Bond Position:  [4.50035118]


portfolio before change:  [3.59896361]
curr_Stock_Price:  101.01901854165529
curr_Factors:  [101.01901854  -1.24161531  -0.88242368]
mat_Sqrt:  [[12.07660146  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00363212  0.01501882 -0.03367515]
Stock Position:  0.003632121679767708
Bond Position:  [3.23205024]


portfolio before change:  [3.60420894]
curr_Stock_Price:  102.24067822945865
curr_Factors:  [102.24067823  -1.22118309  -0.85727766]
mat_Sqrt:  [[12.79262549  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00712489  0.01241204 -0.0476748 ]
Stock Position:  0.00712489037841766
Bond Position:  [2.87575532]


portfolio before change:  [3.60504331]
curr_Stock_Price:  102.25686699844488
curr_Factors:  [102.256867    -1.59604255  -0.8523751 ]
mat_Sqrt:  [[ 8.83808567  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00780219 -0.00332401 -0.37284333]
Stock Position:  0.007802193119566177
Bond Position:  [2.80721549]


portfolio before change:  [3.60586713]
curr_Stock_Price:  102.2724944314573
curr_Factors:  [102.27249443  -1.51995283  -0.81296065]
mat_Sqrt:  [[ 9.92172986  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00274028 -0.00173831 -0.36257308]
Stock Position:  0.0027402776449389713
Bond Position:  [3.3256121]


portfolio before change:  [3.61040774]
curr_Stock_Price:  103.62604465325968
curr_Factors:  [103.62604465  -1.49892775  -0.84102416]
mat_Sqrt:  [[ 9.98253217  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00913124  0.00940087 -0.10269791]
Stock Position:  -0.009131240070941229
Bond Position:  [4.55664204]


portfolio before change:  [3.61607806]
curr_Stock_Price:  103.12983440434675
curr_Factors:  [103.1298344   -1.78090735  -0.82891491]
mat_Sqrt:  [[ 7.58495339  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00923421  0.02234086  0.69034843]
Stock Position:  -0.009234206859348459
Bond Position:  [4.56840029]


portfolio before change:  [3.62375679]
curr_Stock_Price:  102.42197856094214
curr_Factors:  [102.42197856  -1.67173475  -0.82274909]
mat_Sqrt:  [[ 8.45381215  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00177955 -0.03258053  0.38225817]
Stock Position:  -0.0017795484326170558
Bond Position:  [3.80602166]


portfolio before change:  [3.62429871]
curr_Stock_Price:  102.65220823578542
curr_Factors:  [102.65220824  -1.6385523   -0.80238396]
mat_Sqrt:  [[ 8.93888078  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [1.93361861e-04 1.99178460e-02 3.64013730e-01]
Stock Position:  0.0001933618609898723
Bond Position:  [3.60444969]


portfolio before change:  [3.62528672]
curr_Stock_Price:  103.10102832182238
curr_Factors:  [103.10102832  -1.57274202  -0.84507046]
mat_Sqrt:  [[ 9.18798718  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00487209  0.02540016 -0.2243406 ]
Stock Position:  -0.004872090033147626
Bond Position:  [4.12760421]


portfolio before change:  [3.63058845]
curr_Stock_Price:  102.22466947458585
curr_Factors:  [102.22466947  -1.60994713  -0.83599617]
mat_Sqrt:  [[ 8.85719154  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02994736 -0.23623178 -0.09577424]
Stock Position:  -0.02994735952081768
Bond Position:  [6.69194738]


portfolio before change:  [3.63352344]
curr_Stock_Price:  102.18253591437463
curr_Factors:  [102.18253591  -1.48936988  -0.8251886 ]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [3.63352344]
Stock Price:  100.1983436330234
PL:  [3.4351798]
Settle:  Tensor("sub_102:0", shape=(), dtype=float64)
PL:  Tensor("sub_103:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  52
output_Z_Vals[:, i, :]:  [[ 1.19251512e+02 -2.92846752e+01 -2.92776944e+01]
 [ 7.57019244e-02 -2.86952879e-02  2.33096087e-02]
 [-7.56635798e-02  1.26880829e-02  4.85695648e-02]
 [-2.29025031e-02  3.87967456e-02  6.33186538e-02]
 [-9.60503652e-02 -2.18686393e-01  1.91553065e-01]
 [-1.73312128e-02 -1.16425282e-02 -1.61846691e-02]
 [ 5.55174396e-02  3.50716647e-02 -1.86152628e-02]
 [-9.64704156e-02  1.65922721e-01 -9.50674057e-02]
 [-2.33189405e-01 -1.07035028e-01  2.23177998e-01]
 [ 6.84012815e-02  5.68762808e-02 -4.88079641e-03]
 [ 4.15413041e-02  7.28049059e-02  3.18459559e-03]
 [-4.78534842e-02 -9.49412687e-03 -1.16874897e-01]
 [-7.41391167e-04 -2.26346558e-01 -3.31318946e-01]
 [ 3.94921750e-02 -1.49885078e-02  6.29969383e-03]
 [ 1.11348156e-02 -5.79141975e-02 -1.09473076e-01]
 [ 1.57128903e-01  1.87926619e-02 -3.43904280e-02]
 [ 1.99392154e-02 -2.34464078e-02  1.01299519e-01]
 [ 4.18161262e-02 -2.49029959e-02  6.80258468e-02]
 [-3.51985984e-01 -8.84064781e-01 -1.83561265e-01]
 [ 1.16920605e-01 -1.79024808e-01 -3.30358648e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.25151208 -29.28467519 -29.2776944 ]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  8.31409947  -9.26062741 -83.52111278]
init_Out:  [2.49223638]
Stock Position:  8.314099471154409
Bond position:  [-828.91771073]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [7.9195221]
curr_Stock_Price:  100.67770912129468
curr_Factors:  [100.67770912  -0.75477855  -1.03397401]
mat_Sqrt:  [[16.83014902  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00473668 -0.00907425  0.06649583]
Stock Position:  0.004736682315533819
Bond Position:  [7.44264377]


portfolio before change:  [7.91176686]
curr_Stock_Price:  98.64756903879136
curr_Factors:  [98.64756904 -1.20401003 -1.03776038]
mat_Sqrt:  [[10.48329645  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00624057  0.00401232  0.13855545]
Stock Position:  -0.00624057082977506
Bond Position:  [8.52738401]


portfolio before change:  [7.91494715]
curr_Stock_Price:  98.47960800791759
curr_Factors:  [98.47960801 -1.15352676 -1.01567417]
mat_Sqrt:  [[11.2531555   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00079763  0.01226861  0.18063049]
Stock Position:  -0.0007976348810104159
Bond Position:  [7.99349792]


portfolio before change:  [7.91583888]
curr_Stock_Price:  99.86732099807541
curr_Factors:  [99.867321   -1.16478343 -1.03213529]
mat_Sqrt:  [[11.09976338  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00563942 -0.06915471  0.54644758]
Stock Position:  -0.005639419123161723
Bond Position:  [8.47903256]


portfolio before change:  [7.92038116]
curr_Stock_Price:  99.43779920158563
curr_Factors:  [99.4377992  -0.83438981 -1.06703769]
mat_Sqrt:  [[14.85155859  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00140965 -0.00368169 -0.04617036]
Stock Position:  -0.0014096502560688143
Bond Position:  [8.06055368]


portfolio before change:  [7.92104739]
curr_Stock_Price:  100.39489065136083
curr_Factors:  [100.39489065  -1.0806648   -1.09219666]
mat_Sqrt:  [[11.43009572  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00460391  0.01109063 -0.05310416]
Stock Position:  0.004603912578309047
Bond Position:  [7.45883809]


portfolio before change:  [7.92360958]
curr_Stock_Price:  100.54633699756813
curr_Factors:  [100.546337    -1.1289509   -1.09273333]
mat_Sqrt:  [[10.90187133  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01023603  0.05246937 -0.27120085]
Stock Position:  -0.01023602819109712
Bond Position:  [8.95280472]


portfolio before change:  [7.93880121]
curr_Stock_Price:  99.28088983747854
curr_Factors:  [99.28088984 -0.74238122 -1.10007966]
mat_Sqrt:  [[15.72878106  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01210501 -0.03384745  0.63666471]
Stock Position:  -0.012105007951575915
Bond Position:  [9.14059717]


portfolio before change:  [7.94913312]
curr_Stock_Price:  98.6161671552367
curr_Factors:  [98.61616716 -0.43217284 -1.09315493]
mat_Sqrt:  [[21.45392137  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0032103   0.01798586 -0.01392355]
Stock Position:  0.003210300400056784
Bond Position:  [7.6325456]


portfolio before change:  [7.94572753]
curr_Stock_Price:  96.96088097448302
curr_Factors:  [96.96088097 -0.45437262 -1.06238697]
mat_Sqrt:  [[21.27532641  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00207147 0.02302293 0.00908476]
Stock Position:  0.0020714686448163855
Bond Position:  [7.7448761]


portfolio before change:  [7.94719573]
curr_Stock_Price:  96.73482852593474
curr_Factors:  [96.73482853 -0.8544278  -1.07724522]
mat_Sqrt:  [[14.01741515  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0051333  -0.00300231 -0.33341155]
Stock Position:  -0.005133300906759568
Bond Position:  [8.44376471]


portfolio before change:  [7.94951179]
curr_Stock_Price:  96.69492030757517
curr_Factors:  [96.69492031 -0.70884861 -1.10956018]
mat_Sqrt:  [[15.6920166   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00472953 -0.07157707 -0.94516073]
Stock Position:  -0.004729527932757387
Bond Position:  [8.40683312]


portfolio before change:  [7.95462115]
curr_Stock_Price:  96.05904489495964
curr_Factors:  [96.05904489 -0.62272988 -1.09203381]
mat_Sqrt:  [[17.29122877  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00233593 -0.00473978  0.01797127]
Stock Position:  0.0023359295952014507
Bond Position:  [7.73023399]


portfolio before change:  [7.95630056]
curr_Stock_Price:  95.95056681879524
curr_Factors:  [95.95056682 -0.78863295 -1.08254009]
mat_Sqrt:  [[14.7709156   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00086025 -0.01831408 -0.31229621]
Stock Position:  -0.0008602459730837758
Bond Position:  [8.03884165]


portfolio before change:  [7.95717267]
curr_Stock_Price:  97.27326904824025
curr_Factors:  [97.27326905 -0.68012567 -1.10892713]
mat_Sqrt:  [[16.25615203  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00926383  0.00594276 -0.09810632]
Stock Position:  0.009263828884166478
Bond Position:  [7.05604975]


portfolio before change:  [7.93722798]
curr_Stock_Price:  94.92986153857733
curr_Factors:  [94.92986154 -0.84247299 -1.0932666 ]
mat_Sqrt:  [[13.70003977  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00292054 -0.00741441  0.28897933]
Stock Position:  0.0029205396510201087
Bond Position:  [7.65998155]


portfolio before change:  [7.94024008]
curr_Stock_Price:  95.30543155470153
curr_Factors:  [95.30543155 -0.76205977 -1.08977801]
mat_Sqrt:  [[14.95804108  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00368089 -0.00787502  0.19405881]
Stock Position:  0.00368088649544078
Bond Position:  [7.5894316]


portfolio before change:  [7.9349365]
curr_Stock_Price:  93.34906111255202
curr_Factors:  [93.34906111 -0.67120358 -1.05018272]
mat_Sqrt:  [[16.69249989  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02469862 -0.27956583 -0.5236492 ]
Stock Position:  -0.024698620772083242
Bond Position:  [10.24052956]


portfolio before change:  [7.9617142]
curr_Stock_Price:  92.36855093514141
curr_Factors:  [92.36855094 -1.14773145 -1.04745249]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [7.9617142]
Stock Price:  92.7354722904714
PL:  [7.9617142]
Settle:  Tensor("sub_104:0", shape=(), dtype=float64)
PL:  Tensor("sub_105:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  53
output_Z_Vals[:, i, :]:  [[ 1.19251512e+02 -2.92846752e+01 -2.92776944e+01]
 [-3.11163670e-01  1.19148908e-01  3.42197851e-01]
 [-2.74148943e-01 -6.86498703e-02  2.17976324e-01]
 [-3.17161157e-02  4.12519294e-02  6.65063707e-02]
 [-8.65308964e-02 -1.39138658e-01  1.10867088e-01]
 [ 3.15103856e-03 -8.63154910e-02 -1.67289530e-03]
 [ 3.12391600e-02  1.63480193e-02 -3.74782870e-03]
 [-9.39719201e-02  1.58698044e-01 -8.83818143e-02]
 [-1.72867642e-01 -8.04017610e-02  1.63352922e-01]
 [ 4.50470017e-02  4.74936917e-02 -1.18045691e-02]
 [ 7.37765401e-02  5.37304729e-02 -1.53594539e-02]
 [ 2.03337149e-01 -1.36619540e-02 -1.77093549e-01]
 [ 3.30955896e-02 -4.56271776e-02 -4.86679272e-01]
 [-8.45720117e-02  2.97281712e-02 -3.59999752e-02]
 [-1.22496322e-01  7.23869104e-02  2.43775888e-01]
 [-8.31973393e-02 -1.65827069e-01  1.66779343e-01]
 [-4.35470375e-02 -1.04337764e-01  2.67488919e-01]
 [-2.16327914e-01  3.32827481e-01 -9.32403515e-02]
 [-3.10664394e-01 -1.02158082e+00 -1.67536942e-01]
 [ 1.21656862e-01 -7.60547444e-02 -1.58037397e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.25151208 -29.28467519 -29.2776944 ]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  8.31409947  -9.26062741 -83.52111278]
init_Out:  [2.49223638]
Stock Position:  8.314099471154409
Bond position:  [-828.91771073]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-13.57945514]
curr_Stock_Price:  98.0918635568976
curr_Factors:  [98.09186356 -0.82635902 -1.00962961]
mat_Sqrt:  [[15.64131469  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01523123  0.03767819  0.97619522]
Stock Position:  -0.015231226978603199
Bond Position:  [-12.0853957]


portfolio before change:  [-13.5714814]
curr_Stock_Price:  97.36996045215582
curr_Factors:  [97.36996045 -0.71436808 -0.98424526]
mat_Sqrt:  [[17.81257036  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01299236 -0.021709    0.62182578]
Stock Position:  -0.012992355369032784
Bond Position:  [-12.30641627]


portfolio before change:  [-13.58633674]
curr_Stock_Price:  98.2765208607215
curr_Factors:  [98.27652086 -0.76097818 -1.00039197]
mat_Sqrt:  [[16.88482003  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00101129  0.01304501  0.18972416]
Stock Position:  -0.0010112893950503193
Bond Position:  [-13.48695074]


portfolio before change:  [-13.58940571]
curr_Stock_Price:  97.97671932596387
curr_Factors:  [97.97671933 -0.73409887 -0.99680009]
mat_Sqrt:  [[17.35413721  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00388915 -0.04399951  0.31627294]
Stock Position:  -0.00388914704629117
Bond Position:  [-13.20835985]


portfolio before change:  [-13.60163671]
curr_Stock_Price:  100.2724641957166
curr_Factors:  [100.2724642   -0.70744926  -0.99655381]
mat_Sqrt:  [[18.24494495  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 3.18391665e-05 -2.72953549e-02 -4.77230463e-03]
Stock Position:  3.183916652188981e-05
Bond Position:  [-13.6048293]


portfolio before change:  [-13.60504982]
curr_Stock_Price:  99.91200618938355
curr_Factors:  [99.91200619 -0.68791031 -1.00122645]
mat_Sqrt:  [[18.45163714  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00167444  0.0051697  -0.01069151]
Stock Position:  0.0016744444676395813
Bond Position:  [-13.77234692]


portfolio before change:  [-13.60778837]
curr_Stock_Price:  100.33302195479317
curr_Factors:  [100.33302195  -0.91761193  -0.99814015]
mat_Sqrt:  [[14.77213732  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00730532  0.05018473 -0.25212872]
Stock Position:  -0.007305321780325561
Bond Position:  [-12.87482335]


portfolio before change:  [-13.6109732]
curr_Stock_Price:  100.3283300076513
curr_Factors:  [100.32833001  -0.7999975   -0.99490379]
mat_Sqrt:  [[16.66893515  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0084948  -0.02542527  0.46600042]
Stock Position:  -0.00849480366568826
Bond Position:  [-12.75870373]


portfolio before change:  [-13.62277365]
curr_Stock_Price:  101.34193489256467
curr_Factors:  [101.34193489  -1.21498186  -0.97271665]
mat_Sqrt:  [[11.36799303  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00385853  0.01501882 -0.03367515]
Stock Position:  0.00385852506055813
Bond Position:  [-14.01380404]


portfolio before change:  [-13.62454593]
curr_Stock_Price:  101.79070887297706
curr_Factors:  [101.79070887  -1.23808196  -1.01745671]
mat_Sqrt:  [[10.66940353  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00675095  0.01699107 -0.04381625]
Stock Position:  0.006750950912187642
Bond Position:  [-14.31173001]


portfolio before change:  [-13.62467049]
curr_Stock_Price:  102.30231350825272
curr_Factors:  [102.30231351  -0.69551639  -1.00654101]
mat_Sqrt:  [[18.65053595  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00894534 -0.00432029 -0.5051986 ]
Stock Position:  0.008945337007784406
Bond Position:  [-14.53979916]


portfolio before change:  [-13.6467805]
curr_Stock_Price:  100.23703593132471
curr_Factors:  [100.23703593  -0.28676425  -1.00754883]
mat_Sqrt:  [[27.4735758   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00245419 -0.01442858 -1.3883605 ]
Stock Position:  -0.0024541941648564547
Bond Position:  [-13.40077935]


portfolio before change:  [-13.65319623]
curr_Stock_Price:  101.48596741099333
curr_Factors:  [101.48596741  -0.41041513  -1.04077902]
mat_Sqrt:  [[23.77718215  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00383363  0.00940087 -0.10269791]
Stock Position:  -0.003833629115845541
Bond Position:  [-13.26413667]


portfolio before change:  [-13.66658669]
curr_Stock_Price:  104.11376606137152
curr_Factors:  [104.11376606  -0.55729141  -1.02705509]
mat_Sqrt:  [[21.35183546  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.003319    0.02289075  0.69542475]
Stock Position:  -0.0033190006189461564
Bond Position:  [-13.32103303]


portfolio before change:  [-13.67193663]
curr_Stock_Price:  104.72216247241825
curr_Factors:  [104.72216247  -0.27987476  -1.00893888]
mat_Sqrt:  [[28.86117107  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00185146 -0.05243912  0.47577504]
Stock Position:  -0.0018514593531415411
Bond Position:  [-13.4780478]


portfolio before change:  [-13.67875671]
curr_Stock_Price:  106.58563665501389
curr_Factors:  [106.58563666  -0.24412585  -0.99181753]
mat_Sqrt:  [[30.96957825  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 2.69939740e-04 -3.29944980e-02  7.63071431e-01]
Stock Position:  0.00026993974012315343
Bond Position:  [-13.70752841]


portfolio before change:  [-13.68197875]
curr_Stock_Price:  107.34606270384809
curr_Factors:  [107.3460627   -0.64677402  -1.00680971]
mat_Sqrt:  [[20.54205242  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01103916  0.10524929 -0.26598877]
Stock Position:  -0.011039157519099436
Bond Position:  [-12.49696866]


portfolio before change:  [-13.69212806]
curr_Stock_Price:  107.9824041307592
curr_Factors:  [107.98240413  -0.82538321  -1.02848032]
mat_Sqrt:  [[16.91337553  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02194948 -0.32305222 -0.47793626]
Stock Position:  -0.021949482031081886
Bond Position:  [-11.32197022]


portfolio before change:  [-13.71433801]
curr_Stock_Price:  108.86529999013489
curr_Factors:  [108.86529999  -0.60729366  -1.01473088]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-13.71433801]
Stock Price:  108.96853693635771
PL:  [-22.68287495]
Settle:  Tensor("sub_106:0", shape=(), dtype=float64)
PL:  Tensor("sub_107:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  54
output_Z_Vals[:, i, :]:  [[ 1.19251512e+02 -2.92846752e+01 -2.92776944e+01]
 [-4.46520132e-02 -1.13124117e-01 -3.73311752e-01]
 [-4.39047352e-01 -7.35941496e-02  3.00647951e-01]
 [-5.62489044e-02 -1.35193644e-01 -4.28978924e-01]
 [-9.88296441e-02 -2.41910939e-01  2.15109929e-01]
 [-1.26625680e-01  7.24452302e-02 -8.91404788e-03]
 [-2.96516942e-02 -8.57775525e-03  2.18610477e-02]
 [-1.44127306e-01  2.02243608e-01 -3.72463289e-02]
 [-2.54192282e-01 -1.10605436e-01  2.30283633e-01]
 [ 4.96063264e-02  4.03974043e-02 -8.87520184e-03]
 [ 3.62132963e-02  8.39595842e-02 -1.22031462e-02]
 [ 1.71693878e-01 -1.25631718e-02 -1.64046939e-01]
 [ 1.38054916e-02 -9.43976006e-02 -6.52686347e-01]
 [-4.69040804e-02  1.69705806e-02 -2.57707844e-02]
 [ 1.11348156e-02 -5.79141975e-02 -1.09473076e-01]
 [ 1.85809404e-01  5.58926438e-02 -1.60018200e-01]
 [-6.28626022e-03 -6.24577292e-02  2.84847753e-02]
 [ 4.16196696e-02 -2.49874608e-02  6.99696018e-02]
 [-4.62170547e-01 -1.16762467e+00 -3.69675854e-01]
 [ 1.44666680e-01 -2.67104789e-01 -4.83000773e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.25151208 -29.28467519 -29.2776944 ]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  8.31409947  -9.26062741 -83.52111278]
init_Out:  [2.49223638]
Stock Position:  8.314099471154409
Bond position:  [-828.91771073]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [17.49835464]
curr_Stock_Price:  101.82982818963207
curr_Factors:  [101.82982819  -1.18552227  -1.0372924 ]
mat_Sqrt:  [[11.0285614   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01122311 -0.03577299 -1.06495452]
Stock Position:  -0.011223114527922892
Bond Position:  [18.64120246]


portfolio before change:  [17.5036805]
curr_Stock_Price:  101.77057749895181
curr_Factors:  [101.7705775   -0.7701612   -1.05386881]
mat_Sqrt:  [[16.42313534  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0231124  -0.02327251  0.85766492]
Stock Position:  -0.023112397912053655
Bond Position:  [19.85584258]


portfolio before change:  [17.51600406]
curr_Stock_Price:  101.45217757725896
curr_Factors:  [101.45217758  -0.44976763  -1.08940167]
mat_Sqrt:  [[21.76750434  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00676718 -0.04275198 -1.22375747]
Stock Position:  -0.006767176579254791
Bond Position:  [18.20254886]


portfolio before change:  [17.52016976]
curr_Stock_Price:  101.50914435691054
curr_Factors:  [101.50914436  -0.14397453  -1.12876132]
mat_Sqrt:  [[28.42909368  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00215155 -0.07649896  0.61364875]
Stock Position:  -0.0021515503784371986
Bond Position:  [17.7385718]


portfolio before change:  [17.53250988]
curr_Stock_Price:  97.83508578350722
curr_Factors:  [97.83508578 -0.17309274 -1.14857538]
mat_Sqrt:  [[26.09164495  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00485116  0.02290919 -0.0254293 ]
Stock Position:  -0.004851159245460777
Bond Position:  [18.00712346]


portfolio before change:  [17.52913103]
curr_Stock_Price:  99.45968664640937
curr_Factors:  [99.45968665  0.12267971 -1.14962355]
mat_Sqrt:  [[35.61648399  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00071346 -0.00271252  0.06236348]
Stock Position:  -0.0007134562527057213
Bond Position:  [17.60009117]


portfolio before change:  [17.53177078]
curr_Stock_Price:  101.92770517244288
curr_Factors:  [ 1.01927705e+02  9.51386928e-02 -1.13551558e+00]
mat_Sqrt:  [[36.01324924  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00406818  0.06395504 -0.10625341]
Stock Position:  -0.00406817704074884
Bond Position:  [17.94643073]


portfolio before change:  [17.54179804]
curr_Stock_Price:  100.56589252088716
curr_Factors:  [ 1.00565893e+02  3.85430358e-02 -1.16745315e+00]
mat_Sqrt:  [[32.52155312  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00645854 -0.03497651  0.65693511]
Stock Position:  -0.006458536942178448
Bond Position:  [18.19130657]


portfolio before change:  [17.5363595]
curr_Stock_Price:  102.1122086539551
curr_Factors:  [ 1.02112209e+02  7.16968564e-02 -1.15282685e+00]
mat_Sqrt:  [[34.63768662  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00140996  0.01277478 -0.02531848]
Stock Position:  0.0014099596328957461
Bond Position:  [17.39238541]


portfolio before change:  [17.53791852]
curr_Stock_Price:  100.13370111379949
curr_Factors:  [ 1.00133701e+02 -1.42532152e-02 -1.14206003e+00]
mat_Sqrt:  [[31.50647441  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00113914  0.02655035 -0.03481218]
Stock Position:  0.0011391362337791052
Bond Position:  [17.4238526]


portfolio before change:  [17.5401115]
curr_Stock_Price:  98.23443144832869
curr_Factors:  [98.23443145  0.34740668 -1.1358163 ]
mat_Sqrt:  [[44.65414634  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00308781 -0.00397282 -0.46798026]
Stock Position:  0.0030878108316957356
Bond Position:  [17.23678216]


portfolio before change:  [17.55055405]
curr_Stock_Price:  100.22056602563602
curr_Factors:  [100.22056603   0.41372901  -1.1063425 ]
mat_Sqrt:  [[50.13703342  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00243056 -0.02985114 -1.86193247]
Stock Position:  -0.002430556382874333
Bond Position:  [17.79414578]


portfolio before change:  [17.56054148]
curr_Stock_Price:  97.9419349211564
curr_Factors:  [97.94193492  0.19905342 -1.11195444]
mat_Sqrt:  [[39.30979731  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00131586  0.00536657 -0.07351687]
Stock Position:  -0.001315863850268546
Bond Position:  [17.68941973]


portfolio before change:  [17.56654426]
curr_Stock_Price:  96.74130015586037
curr_Factors:  [96.74130016  0.16150494 -1.07790145]
mat_Sqrt:  [[38.69242707  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0003284  -0.01831408 -0.31229621]
Stock Position:  -0.00032840071366511226
Bond Position:  [17.59831417]


portfolio before change:  [17.57210997]
curr_Stock_Price:  93.19202034492541
curr_Factors:  [93.19202034  0.35696771 -1.05382923]
mat_Sqrt:  [[46.42325763  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00332999  0.01767481 -0.45648738]
Stock Position:  0.00332998964765477
Bond Position:  [17.26178151]


portfolio before change:  [17.56594251]
curr_Stock_Price:  90.04382704536609
curr_Factors:  [ 9.00438270e+01  5.70106053e-02 -1.05439502e+00]
mat_Sqrt:  [[33.21202833  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-6.27628470e-05 -1.97508682e-02  8.12591352e-02]
Stock Position:  -6.276284703669727e-05
Bond Position:  [17.57159391]


portfolio before change:  [17.57021973]
curr_Stock_Price:  91.89561170167791
curr_Factors:  [91.8956117   0.11265267 -1.04286926]
mat_Sqrt:  [[36.24990221  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00152433 -0.00790173  0.1996038 ]
Stock Position:  0.001524334629787151
Bond Position:  [17.43014007]


portfolio before change:  [17.57302451]
curr_Stock_Price:  90.8766099979571
curr_Factors:  [90.87661     0.24851006 -0.99843386]
mat_Sqrt:  [[42.93034235  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01322557 -0.36923534 -1.05458231]
Stock Position:  -0.01322557014583827
Bond Position:  [18.77491949]


portfolio before change:  [17.58821019]
curr_Stock_Price:  90.08334687809325
curr_Factors:  [ 9.00833469e+01  5.20682859e-02 -1.02227923e+00]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [17.58821019]
Stock Price:  90.57348895222611
PL:  [17.58821019]
Settle:  Tensor("sub_108:0", shape=(), dtype=float64)
PL:  Tensor("sub_109:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  55
output_Z_Vals[:, i, :]:  [[ 1.19251512e+02 -2.92846752e+01 -2.92776944e+01]
 [ 1.31559605e-02 -7.78467413e-02 -2.12978271e-01]
 [-4.44180169e-01 -7.47048823e-02  3.05062860e-01]
 [-5.13429954e-02 -6.17084021e-02 -2.15819882e-01]
 [-9.88296441e-02 -2.41910939e-01  2.15109929e-01]
 [-2.24935162e-01 -9.57173917e-04  1.17895023e-02]
 [ 5.19702018e-02  9.40889747e-02 -4.17599000e-02]
 [-1.85844276e-01  2.64790046e-01 -4.57129895e-02]
 [-1.14709716e-01 -4.05535683e-02  7.15716469e-02]
 [ 5.13086439e-03  1.78738414e-02 -1.73543282e-02]
 [ 1.49220800e-01 -1.67740564e-02 -3.92567039e-02]
 [ 1.47289774e-01 -1.20183051e-02 -1.52888369e-01]
 [ 3.18490926e-02 -1.62571315e-02 -2.72423798e-01]
 [ 4.65089713e-03  4.26587249e-03  8.96083442e-02]
 [-1.57077957e-01  1.21123756e-01  2.93649454e-01]
 [-5.18000751e-02 -1.08807330e-01  1.40424207e-01]
 [-3.78283853e-02 -9.15360420e-02  2.66270063e-01]
 [-1.58465917e-01  2.49999151e-01 -9.99911151e-02]
 [-3.56146633e-01 -1.04590689e+00 -2.44689089e-01]
 [ 1.23254230e-01 -8.71912832e-02 -1.70107197e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.25151208 -29.28467519 -29.2776944 ]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  8.31409947  -9.26062741 -83.52111278]
init_Out:  [2.49223638]
Stock Position:  8.314099471154409
Bond position:  [-828.91771073]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [10.41407965]
curr_Stock_Price:  100.97774853752574
curr_Factors:  [100.97774854  -1.21031214  -1.01896789]
mat_Sqrt:  [[10.86579901  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00297521 -0.0246173  -0.60756773]
Stock Position:  -0.00297521068091197
Bond Position:  [10.71450973]


portfolio before change:  [10.41512461]
curr_Stock_Price:  101.52695299784132
curr_Factors:  [101.526953    -1.07610869  -1.03573449]
mat_Sqrt:  [[12.28625472  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.03124128 -0.02362376  0.87025943]
Stock Position:  -0.03124128172255997
Bond Position:  [13.58695675]


portfolio before change:  [10.44597831]
curr_Stock_Price:  100.64809886213777
curr_Factors:  [100.64809886  -1.08546718  -1.06065774]
mat_Sqrt:  [[11.76942835  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00824087 -0.01951391 -0.61567405]
Stock Position:  -0.00824087165804087
Bond Position:  [11.27540637]


portfolio before change:  [10.43523461]
curr_Stock_Price:  102.2939078728599
curr_Factors:  [102.29390787  -1.11324128  -1.0467223 ]
mat_Sqrt:  [[11.79748696  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00518472 -0.07649896  0.61364875]
Stock Position:  -0.005184716667496054
Bond Position:  [10.96559954]


portfolio before change:  [10.43755542]
curr_Stock_Price:  102.37509436114242
curr_Factors:  [102.37509436  -0.82196756  -0.9909258 ]
mat_Sqrt:  [[16.70570208  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.013322   -0.00030268  0.03363217]
Stock Position:  -0.013321999465527453
Bond Position:  [11.80139638]


portfolio before change:  [10.42355221]
curr_Stock_Price:  103.64772068345364
curr_Factors:  [103.64772068  -0.79081656  -0.99258965]
mat_Sqrt:  [[17.41952381  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00263356  0.02975355 -0.11912937]
Stock Position:  0.002633560211225424
Bond Position:  [10.1505897]


portfolio before change:  [10.42908197]
curr_Stock_Price:  104.78374708239188
curr_Factors:  [104.78374708  -0.80653823  -0.99209714]
mat_Sqrt:  [[17.34428923  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01085882  0.08373396 -0.13040644]
Stock Position:  -0.010858822122106506
Bond Position:  [11.56691004]


portfolio before change:  [10.45524503]
curr_Stock_Price:  102.64070002822625
curr_Factors:  [102.64070003  -0.58927065  -0.98730085]
mat_Sqrt:  [[21.21403606  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00476794 -0.01282416  0.20417399]
Stock Position:  -0.00476794248445454
Bond Position:  [10.94462998]


portfolio before change:  [10.44968419]
curr_Stock_Price:  104.3809340758029
curr_Factors:  [104.38093408  -0.72945091  -0.97653013]
mat_Sqrt:  [[18.95496678  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00010815  0.0056522  -0.04950707]
Stock Position:  0.00010814725223249663
Bond Position:  [10.43839568]


portfolio before change:  [10.45222399]
curr_Stock_Price:  103.73250089614062
curr_Factors:  [103.7325009   -0.60965917  -0.89346172]
mat_Sqrt:  [[23.07372633  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00610107 -0.00530442 -0.11198845]
Stock Position:  0.006101071538851405
Bond Position:  [9.81934458]


portfolio before change:  [10.45061461]
curr_Stock_Price:  103.06630220334186
curr_Factors:  [103.0663022   -0.34670051  -0.92988576]
mat_Sqrt:  [[28.75426842  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00402623 -0.00380052 -0.43614796]
Stock Position:  0.004026228514147568
Bond Position:  [10.03564612]


portfolio before change:  [10.46843042]
curr_Stock_Price:  106.86802084979522
curr_Factors:  [106.86802085  -0.2470206   -0.94544323]
mat_Sqrt:  [[32.43151993  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-7.45538282e-04 -5.14095639e-03 -7.77149268e-01]
Stock Position:  -0.0007455382821014431
Bond Position:  [10.54810462]


portfolio before change:  [10.47021532]
curr_Stock_Price:  108.0114336574751
curr_Factors:  [108.01143366  -0.52151577  -0.95185673]
mat_Sqrt:  [[24.75096768  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00093137 0.00134899 0.25562766]
Stock Position:  0.0009313683588721332
Bond Position:  [10.36961689]


portfolio before change:  [10.47060625]
curr_Stock_Price:  105.64738386208884
curr_Factors:  [105.64738386  -0.27133636  -0.96978762]
mat_Sqrt:  [[30.53834182  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00307841  0.03830269  0.83770016]
Stock Position:  -0.0030784124327202862
Bond Position:  [10.79583247]


portfolio before change:  [10.47923059]
curr_Stock_Price:  103.72267496414239
curr_Factors:  [ 1.03722675e+02  7.98962742e-02 -9.77059841e-01]
mat_Sqrt:  [[42.29027626  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00061351 -0.0344079   0.40059118]
Stock Position:  -0.0006135097537037528
Bond Position:  [10.54286546]


portfolio before change:  [10.48052301]
curr_Stock_Price:  105.91273551023824
curr_Factors:  [ 1.05912736e+02 -1.59876857e-02 -1.00871147e+00]
mat_Sqrt:  [[38.01254941  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 3.72516799e-04 -2.89462381e-02  7.59594373e-01]
Stock Position:  0.0003725167989688403
Bond Position:  [10.44106874]


portfolio before change:  [10.48301312]
curr_Stock_Price:  105.58929455258881
curr_Factors:  [105.58929455  -0.30004541  -1.02425994]
mat_Sqrt:  [[28.08544984  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00613918  0.07905667 -0.28524682]
Stock Position:  -0.006139177708070385
Bond Position:  [11.13124456]


portfolio before change:  [10.48543173]
curr_Stock_Price:  105.64867444155442
curr_Factors:  [105.64867444  -0.2617042   -1.00991698]
mat_Sqrt:  [[29.62142808  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01462113 -0.3307448  -0.69802986]
Stock Position:  -0.014621131133443474
Bond Position:  [12.03013486]


portfolio before change:  [10.4652477]
curr_Stock_Price:  107.23486814813342
curr_Factors:  [107.23486815  -0.28579743  -0.97548558]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [10.4652477]
Stock Price:  106.9290552569862
PL:  [3.53619244]
Settle:  Tensor("sub_110:0", shape=(), dtype=float64)
PL:  Tensor("sub_111:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  56
output_Z_Vals[:, i, :]:  [[ 1.19251512e+02 -2.92846752e+01 -2.92776944e+01]
 [-1.68159106e-01  4.62152987e-02  2.33890083e-02]
 [-1.18580996e-01  7.85156492e-03  1.20687004e-01]
 [-3.68700443e-02 -1.49104835e-01 -4.73820813e-01]
 [-9.88296441e-02 -2.41910939e-01  2.15109929e-01]
 [-1.98580599e-01 -2.85030739e-02  1.86396259e-02]
 [ 5.58420289e-02  2.96712971e-02 -1.64974172e-02]
 [-8.92888504e-02  1.55048829e-01 -9.40542652e-02]
 [-8.22321580e-02 -4.31550948e-02  8.01317258e-02]
 [ 4.50470017e-02  4.74936917e-02 -1.18045691e-02]
 [ 5.30037259e-02  6.86507592e-02 -1.40020865e-02]
 [ 1.22386927e-01 -1.12880026e-02 -1.42133577e-01]
 [ 4.76851879e-02 -9.73807779e-03 -2.38462603e-01]
 [-8.40617790e-02  2.98862615e-02 -3.48455540e-02]
 [-8.14329786e-02  1.57990945e-03  1.27006448e-01]
 [-2.56490639e-02 -7.27175152e-02  1.21088414e-01]
 [-2.51898738e-02  4.38313753e-02  1.48956265e-01]
 [-2.80474355e-02  7.19378039e-02 -9.13177659e-02]
 [-3.85540161e-01 -1.02022983e+00 -2.46356008e-01]
 [ 9.64484671e-02 -9.02350875e-02 -1.53926599e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.25151208 -29.28467519 -29.2776944 ]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  8.31409947  -9.26062741 -83.52111278]
init_Out:  [2.49223638]
Stock Position:  8.314099471154409
Bond position:  [-828.91771073]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-6.01196932]
curr_Stock_Price:  99.00206265322183
curr_Factors:  [99.00206265 -0.61806226 -0.98348615]
mat_Sqrt:  [[19.95724568  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00812695  0.01461456  0.06672233]
Stock Position:  -0.008126951667501258
Bond Position:  [-5.20738434]


portfolio before change:  [-6.02048091]
curr_Stock_Price:  99.88918362121555
curr_Factors:  [99.88918362 -0.65414339 -0.98017736]
mat_Sqrt:  [[19.48686515  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00481058  0.00248288  0.34428643]
Stock Position:  -0.004810580704758422
Bond Position:  [-5.53995593]


portfolio before change:  [-6.03358607]
curr_Stock_Price:  102.32547895009729
curr_Factors:  [102.32547895  -1.17490578  -0.93604997]
mat_Sqrt:  [[12.39388185  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0110892  -0.04715109 -1.35167889]
Stock Position:  -0.011089195841601689
Bond Position:  [-4.8988788]


portfolio before change:  [-6.0280578]
curr_Stock_Price:  101.71649496837381
curr_Factors:  [101.71649497  -1.32424579  -0.91475263]
mat_Sqrt:  [[10.83943708  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00564297 -0.07649896  0.61364875]
Stock Position:  -0.0056429708308327045
Bond Position:  [-5.45407459]


portfolio before change:  [-6.03290203]
curr_Stock_Price:  102.33328664287193
curr_Factors:  [102.33328664  -1.00931281  -0.92788354]
mat_Sqrt:  [[14.74698487  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01325774 -0.00901346  0.05317366]
Stock Position:  -0.013257743814970505
Bond Position:  [-4.67619353]


portfolio before change:  [-6.01531983]
curr_Stock_Price:  100.91891369106645
curr_Factors:  [100.91891369  -1.00767088  -0.94757726]
mat_Sqrt:  [[14.28298855  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00372755  0.00938289 -0.04706254]
Stock Position:  0.0037275544338863254
Bond Position:  [-6.39150057]


portfolio before change:  [-6.01947013]
curr_Stock_Price:  100.23422094366607
curr_Factors:  [100.23422094  -1.05161571  -0.95901226]
mat_Sqrt:  [[13.42181933  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00778466  0.04903074 -0.26831064]
Stock Position:  -0.007784656515908511
Bond Position:  [-5.23918115]


portfolio before change:  [-6.0298296]
curr_Stock_Price:  101.39670170528701
curr_Factors:  [101.39670171  -1.070191    -0.96014461]
mat_Sqrt:  [[13.31252018  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00503207 -0.01364684  0.22859351]
Stock Position:  -0.005032074829485101
Bond Position:  [-5.51959381]


portfolio before change:  [-6.02954099]
curr_Stock_Price:  101.06509190383616
curr_Factors:  [101.0650919   -1.17744483  -0.92882008]
mat_Sqrt:  [[12.29877758  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00356651  0.01501882 -0.03367515]
Stock Position:  0.0035665077873489595
Bond Position:  [-6.38999043]


portfolio before change:  [-6.03073062]
curr_Stock_Price:  101.17950878111301
curr_Factors:  [101.17950878  -1.20682642  -0.90419456]
mat_Sqrt:  [[12.25428021  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00423673  0.02170928 -0.03994406]
Stock Position:  0.004236733293129346
Bond Position:  [-6.45940121]


portfolio before change:  [-6.0292996]
curr_Stock_Price:  101.89847613159306
curr_Factors:  [101.89847613  -1.25331744  -0.92333211]
mat_Sqrt:  [[11.55741743  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00805393 -0.00356958 -0.40546753]
Stock Position:  0.008053925340348406
Bond Position:  [-6.84998232]


portfolio before change:  [-6.03588981]
curr_Stock_Price:  101.29287090161841
curr_Factors:  [101.2928709   -1.1121393   -0.90738901]
mat_Sqrt:  [[13.44339247  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-9.24039958e-05 -3.07945058e-03 -6.80267432e-01]
Stock Position:  -9.24039958418653e-05
Bond Position:  [-6.02652994]


portfolio before change:  [-6.03735661]
curr_Stock_Price:  100.85973817991835
curr_Factors:  [100.85973818  -1.03561715  -0.93639384]
mat_Sqrt:  [[14.03732458  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00644018  0.00945087 -0.09940467]
Stock Position:  -0.006440182922587068
Bond Position:  [-5.38780144]


portfolio before change:  [-6.04258548]
curr_Stock_Price:  101.46247780956934
curr_Factors:  [101.46247781  -1.19079449  -0.93319477]
mat_Sqrt:  [[12.13021918  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00457264  0.00049961  0.36231404]
Stock Position:  -0.004572638146821775
Bond Position:  [-5.57863428]


portfolio before change:  [-6.04624387]
curr_Stock_Price:  101.95750068766392
curr_Factors:  [101.95750069  -1.34162688  -0.93190029]
mat_Sqrt:  [[10.49636378  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-2.67669165e-04 -2.29952974e-02  3.45431542e-01]
Stock Position:  -0.0002676691645757981
Bond Position:  [-6.01895299]


portfolio before change:  [-6.0480161]
curr_Stock_Price:  102.95614600249955
curr_Factors:  [102.956146    -1.24399108  -1.00128656]
mat_Sqrt:  [[10.90286378  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00058218 0.0138607  0.42493076]
Stock Position:  0.0005821789366353658
Bond Position:  [-6.107955]


portfolio before change:  [-6.04991044]
curr_Stock_Price:  102.32549042843117
curr_Factors:  [102.32549043  -0.6973278   -1.02319086]
mat_Sqrt:  [[18.31353031  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00244793  0.02274873 -0.26050417]
Stock Position:  -0.0024479261803717505
Bond Position:  [-5.79942519]


portfolio before change:  [-6.04802177]
curr_Stock_Price:  100.96159757659755
curr_Factors:  [100.96159758  -0.25696704  -1.07010254]
mat_Sqrt:  [[26.7804098   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01725775 -0.322625   -0.70278512]
Stock Position:  -0.017257749025940263
Bond Position:  [-4.30565185]


portfolio before change:  [-6.02131155]
curr_Stock_Price:  99.35149373607796
curr_Factors:  [99.35149374 -0.2646597  -1.09830051]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-6.02131155]
Stock Price:  97.00617198906157
PL:  [-6.02131155]
Settle:  Tensor("sub_112:0", shape=(), dtype=float64)
PL:  Tensor("sub_113:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  57
output_Z_Vals[:, i, :]:  [[ 1.19251512e+02 -2.92846752e+01 -2.92776944e+01]
 [-1.95672950e-01  4.83346420e-02  9.37802462e-03]
 [-7.37282797e-02  1.38020881e-02  5.24036496e-02]
 [-2.88672658e-02  4.30250550e-02  7.19745994e-02]
 [-8.49450925e-02 -1.25887171e-01  9.74259873e-02]
 [-2.53106538e-01  1.29207273e-01 -3.95119203e-04]
 [-4.20188436e-01 -4.39448644e-01  3.28513601e-01]
 [-4.61995571e-03  3.74257667e-03 -8.60847229e-02]
 [-3.49643143e-01 -1.85267634e-01  4.03208059e-01]
 [ 3.48584262e-02  2.58727904e-02  5.07162018e-03]
 [ 4.03043964e-02  6.34803425e-02  2.10992730e-03]
 [-4.58820950e-02 -9.54533902e-03 -1.26792058e-01]
 [-8.33336382e-03 -2.81184263e-01 -2.42455921e-01]
 [ 6.15702830e-02 -2.74878293e-02  1.27533227e-02]
 [ 1.11348156e-02 -5.79141975e-02 -1.09473076e-01]
 [ 1.74281724e-01  4.27990407e-02 -1.11182740e-01]
 [ 2.25003301e-02 -3.67967667e-02  1.13386076e-01]
 [ 4.16196696e-02 -2.49874608e-02  6.99696018e-02]
 [-3.10770672e-01 -7.90305920e-01 -1.58117457e-01]
 [ 1.14974389e-01 -1.36427043e-01 -2.36269170e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.25151208 -29.28467519 -29.2776944 ]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  8.31409947  -9.26062741 -83.52111278]
init_Out:  [2.49223638]
Stock Position:  8.314099471154409
Bond position:  [-828.91771073]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-2.59766365]
curr_Stock_Price:  99.41272717338286
curr_Factors:  [99.41272717 -1.01350468 -0.98603811]
mat_Sqrt:  [[13.46020235  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01430221  0.01528476  0.02675289]
Stock Position:  -0.014302212458883138
Bond Position:  [-1.1758417]


portfolio before change:  [-2.58769387]
curr_Stock_Price:  98.69509157783229
curr_Factors:  [98.69509158 -0.69514112 -0.9937626 ]
mat_Sqrt:  [[18.23114674  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0034378   0.0043646   0.14949303]
Stock Position:  -0.003437801364367791
Bond Position:  [-2.24839975]


portfolio before change:  [-2.58782724]
curr_Stock_Price:  98.57036195919135
curr_Factors:  [98.57036196 -0.66024164 -1.00994771]
mat_Sqrt:  [[18.55206825  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00070421  0.01360572  0.2053235 ]
Stock Position:  -0.0007042131325829025
Bond Position:  [-2.5184127]


portfolio before change:  [-2.58643438]
curr_Stock_Price:  95.69830113183174
curr_Factors:  [95.69830113 -0.40914775 -1.0337963 ]
mat_Sqrt:  [[22.60692999  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00302157 -0.03980902  0.27792922]
Stock Position:  -0.003021572981665457
Bond Position:  [-2.29727498]


portfolio before change:  [-2.58352166]
curr_Stock_Price:  94.54422962845312
curr_Factors:  [94.54422963 -0.17490793 -1.01797765]
mat_Sqrt:  [[28.67948865  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00871184  0.04085893 -0.00112717]
Stock Position:  -0.008711838519367477
Bond Position:  [-1.7598676]


portfolio before change:  [-2.56525897]
curr_Stock_Price:  92.39741442030834
curr_Factors:  [92.39741442 -0.24679084 -1.03750707]
mat_Sqrt:  [[25.57975173  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01424867 -0.13896586  0.93715786]
Stock Position:  -0.014248668129386013
Bond Position:  [-1.24871888]


portfolio before change:  [-2.6085448]
curr_Stock_Price:  95.41338824745824
curr_Factors:  [95.41338825 -0.29745569 -1.01925024]
mat_Sqrt:  [[25.5723828   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00086403  0.00118351 -0.24557575]
Stock Position:  -0.0008640295061374554
Bond Position:  [-2.52610482]


portfolio before change:  [-2.60988452]
curr_Stock_Price:  96.23293949021856
curr_Factors:  [96.23293949 -0.16780656 -1.03023759]
mat_Sqrt:  [[29.04154962  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0093701  -0.05858677  1.15024036]
Stock Position:  -0.009370100271053403
Bond Position:  [-1.70817223]


portfolio before change:  [-2.61682516]
curr_Stock_Price:  96.92807999040205
curr_Factors:  [96.92807999 -0.1945757  -1.06757988]
mat_Sqrt:  [[27.43483848  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00133267 0.00818169 0.01446792]
Stock Position:  0.0013326741088751297
Bond Position:  [-2.7459987]


portfolio before change:  [-2.61883357]
curr_Stock_Price:  95.9362218030062
curr_Factors:  [95.9362218  -0.15397777 -1.0558951 ]
mat_Sqrt:  [[28.61155761  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00148101 0.02007425 0.00601904]
Stock Position:  0.0014810147510375652
Bond Position:  [-2.76091653]


portfolio before change:  [-2.6194119]
curr_Stock_Price:  96.0118345299421
curr_Factors:  [96.01183453 -0.61126179 -1.04260526]
mat_Sqrt:  [[18.36789711  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00392042 -0.0030185  -0.36170245]
Stock Position:  -0.00392042021441809
Bond Position:  [-2.24300516]


portfolio before change:  [-2.61807717]
curr_Stock_Price:  95.52832888898887
curr_Factors:  [95.52832889 -0.9303016  -1.04921418]
mat_Sqrt:  [[13.19591177  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00493218 -0.08891827 -0.69165926]
Stock Position:  -0.004932180442079186
Bond Position:  [-2.14691422]


portfolio before change:  [-2.6180006]
curr_Stock_Price:  95.40396829372133
curr_Factors:  [95.40396829 -0.88626665 -1.08664976]
mat_Sqrt:  [[13.265992    0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00478395 -0.00869241  0.03638168]
Stock Position:  0.0047839476594124025
Bond Position:  [-3.07440819]


portfolio before change:  [-2.62123611]
curr_Stock_Price:  94.88832549998511
curr_Factors:  [94.8883255  -0.77463232 -1.06431933]
mat_Sqrt:  [[15.08572647  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00084229 -0.01831408 -0.31229621]
Stock Position:  -0.000842294250188113
Bond Position:  [-2.54131222]


portfolio before change:  [-2.62213184]
curr_Stock_Price:  95.19739533240457
curr_Factors:  [95.19739533 -0.59027124 -1.06320609]
mat_Sqrt:  [[18.21918671  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00838082  0.01353425 -0.31717341]
Stock Position:  0.008380819129560308
Bond Position:  [-3.41996399]


portfolio before change:  [-2.62890099]
curr_Stock_Price:  94.4917307940724
curr_Factors:  [94.49173079 -0.89303833 -1.05222214]
mat_Sqrt:  [[13.5075914   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00330889 -0.01163616  0.32345891]
Stock Position:  0.0033088858060385247
Bond Position:  [-2.94156333]


portfolio before change:  [-2.62972087]
curr_Stock_Price:  94.46622335448444
curr_Factors:  [94.46622335 -1.13180166 -1.06818049]
mat_Sqrt:  [[10.46734269  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00527899 -0.00790173  0.1996038 ]
Stock Position:  0.0052789884620142655
Bond Position:  [-3.12840697]


portfolio before change:  [-2.62879137]
curr_Stock_Price:  94.79047033835725
curr_Factors:  [94.79047034 -0.83752423 -1.05061937]
mat_Sqrt:  [[14.34677635  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02533335 -0.24991668 -0.45106509]
Stock Position:  -0.025333347750227837
Bond Position:  [-0.22743143]


portfolio before change:  [-2.63256791]
curr_Stock_Price:  94.93729941901455
curr_Factors:  [94.93729942 -1.03250307 -1.0430861 ]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-2.63256791]
Stock Price:  96.29537583758126
PL:  [-2.63256791]
Settle:  Tensor("sub_114:0", shape=(), dtype=float64)
PL:  Tensor("sub_115:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  58
output_Z_Vals[:, i, :]:  [[ 1.19251512e+02 -2.92846752e+01 -2.92776944e+01]
 [-1.52025257e-01  3.09673348e-02 -4.82672573e-02]
 [-4.05039286e-01 -6.62348633e-02  2.71396466e-01]
 [-5.34987374e-02 -7.09132386e-02 -2.41828430e-01]
 [-9.88296441e-02 -2.41910939e-01  2.15109929e-01]
 [-1.55926631e-02 -3.54558193e-02 -1.51041820e-02]
 [ 5.59388353e-02  2.80606765e-02 -1.58657851e-02]
 [-9.26311794e-02  1.60027353e-01 -9.45594632e-02]
 [-1.84508720e-01 -8.83033384e-02  1.81544709e-01]
 [ 5.19725018e-02  4.16912434e-02 -6.25433486e-06]
 [-7.73485696e-02  1.42866598e-01  1.03082241e-02]
 [-6.18006567e-02 -9.35329969e-03 -1.10570097e-01]
 [ 4.69921377e-03 -2.07469599e-01 -3.05280215e-01]
 [ 5.76972893e-02 -2.32223437e-02  1.47985081e-02]
 [ 1.11348156e-02 -5.79141975e-02 -1.09473076e-01]
 [ 1.77326416e-01  4.56536409e-02 -1.22710849e-01]
 [-2.35647895e-02  1.03259148e-01  6.82888801e-02]
 [ 4.44252505e-02 -2.37812244e-02  4.22109915e-02]
 [-2.98036209e-01 -8.00581027e-01 -1.18754428e-01]
 [ 9.11173689e-02 -7.79837050e-02 -1.38093090e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.25151208 -29.28467519 -29.2776944 ]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  8.31409947  -9.26062741 -83.52111278]
init_Out:  [2.49223638]
Stock Position:  8.314099471154409
Bond position:  [-828.91771073]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-1.09630491]
curr_Stock_Price:  99.59330701143948
curr_Factors:  [99.59330701 -0.93346381 -1.00736063]
mat_Sqrt:  [[14.30015702  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01126409  0.00979273 -0.13769305]
Stock Position:  -0.01126408583447734
Bond Position:  [0.02552265]


portfolio before change:  [-1.11523262]
curr_Stock_Price:  101.27423245423878
curr_Factors:  [101.27423245  -1.16781329  -0.9814258 ]
mat_Sqrt:  [[11.80582348  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02976081 -0.0209453   0.77421858]
Stock Position:  -0.029760811889131808
Bond Position:  [1.89877076]


portfolio before change:  [-1.10112503]
curr_Stock_Price:  100.8161524354736
curr_Factors:  [100.81615244  -1.00661116  -0.98577593]
mat_Sqrt:  [[13.74824938  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00761499 -0.02242474 -0.6898692 ]
Stock Position:  -0.007614986326261468
Bond Position:  [-0.33341141]


portfolio before change:  [-1.10295165]
curr_Stock_Price:  101.0450763097966
curr_Factors:  [101.04507631  -1.26322623  -1.02751485]
mat_Sqrt:  [[10.2248971   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00598213 -0.07649896  0.61364875]
Stock Position:  -0.005982126434440877
Bond Position:  [-0.49848722]


portfolio before change:  [-1.09600538]
curr_Stock_Price:  99.86307166194983
curr_Factors:  [99.86307166 -0.75508574 -1.00059747]
mat_Sqrt:  [[17.25525533  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00113538 -0.01121211 -0.04308803]
Stock Position:  -0.0011353791207197523
Bond Position:  [-0.98262294]


portfolio before change:  [-1.09760232]
curr_Stock_Price:  101.05320580730202
curr_Factors:  [101.05320581  -1.14578924  -0.9953258 ]
mat_Sqrt:  [[11.87614926  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00449849  0.00887357 -0.04526067]
Stock Position:  0.004498492557203292
Bond Position:  [-1.55218942]


portfolio before change:  [-1.1007949]
curr_Stock_Price:  100.42977876985809
curr_Factors:  [100.42977877  -1.10734853  -0.97477073]
mat_Sqrt:  [[12.52015194  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00861021  0.05060509 -0.26975183]
Stock Position:  -0.00861021184559694
Bond Position:  [-0.23607323]


portfolio before change:  [-1.09095297]
curr_Stock_Price:  99.27987016148383
curr_Factors:  [99.27987016 -1.18713431 -0.97818666]
mat_Sqrt:  [[11.38870259  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01314733 -0.02792397  0.51789652]
Stock Position:  -0.013147331092808839
Bond Position:  [0.21431235]


portfolio before change:  [-1.07948855]
curr_Stock_Price:  98.41194976112122
curr_Factors:  [98.41194976 -1.49868128 -1.00473808]
mat_Sqrt:  [[ 8.05056983  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 6.58930853e-03  1.31839288e-02 -1.78418765e-05]
Stock Position:  0.0065893085316357115
Bond Position:  [-1.72795525]


portfolio before change:  [-1.08248746]
curr_Stock_Price:  98.02239988625496
curr_Factors:  [98.02239989 -1.60544421 -0.99832876]
mat_Sqrt:  [[ 7.25305713  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00986558  0.04517839  0.02940649]
Stock Position:  -0.00986557960903917
Bond Position:  [-0.11543967]


portfolio before change:  [-1.0730049]
curr_Stock_Price:  97.05829871038621
curr_Factors:  [97.05829871 -1.4338304  -0.95890169]
mat_Sqrt:  [[ 8.8691567   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00954005 -0.00295777 -0.31542571]
Stock Position:  -0.009540048413420713
Bond Position:  [-0.14706403]


portfolio before change:  [-1.07166281]
curr_Stock_Price:  96.91376510870279
curr_Factors:  [96.91376511 -0.81073471 -0.98504226]
mat_Sqrt:  [[16.08753263  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00391438 -0.06560765 -0.87087948]
Stock Position:  -0.003914378452334038
Bond Position:  [-0.69230566]


portfolio before change:  [-1.06686276]
curr_Stock_Price:  95.64328089716508
curr_Factors:  [95.6432809  -1.05853891 -0.9759343 ]
mat_Sqrt:  [[12.505296    0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00480744 -0.00734355  0.04221602]
Stock Position:  0.004807437088853152
Bond Position:  [-1.52666181]


portfolio before change:  [-1.06843126]
curr_Stock_Price:  95.3964162697706
curr_Factors:  [95.39641627 -0.64690363 -0.99720426]
mat_Sqrt:  [[18.42914033  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00068949 -0.01831408 -0.31229621]
Stock Position:  -0.0006894852625707348
Bond Position:  [-1.00265683]


portfolio before change:  [-1.06839608]
curr_Stock_Price:  94.98180087974144
curr_Factors:  [94.98180088 -0.19378536 -1.00979568]
mat_Sqrt:  [[28.50570541  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00538338  0.01443695 -0.3500599 ]
Stock Position:  0.005383376375011917
Bond Position:  [-1.57971886]


portfolio before change:  [-1.05797964]
curr_Stock_Price:  96.99009866325932
curr_Factors:  [96.99009866 -0.53394648 -1.0108862 ]
mat_Sqrt:  [[20.69260141  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00033632  0.03265341  0.19480917]
Stock Position:  -0.0003363153991898589
Bond Position:  [-1.02536037]


portfolio before change:  [-1.05845247]
curr_Stock_Price:  97.6337195427502
curr_Factors:  [97.63371954 -0.9315255  -0.98736378]
mat_Sqrt:  [[14.32969049  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00365866 -0.00752028  0.12041621]
Stock Position:  0.0036586627275893317
Bond Position:  [-1.41566132]


portfolio before change:  [-1.05222328]
curr_Stock_Price:  99.43305081581404
curr_Factors:  [99.43305082 -1.11092587 -1.01976006]
mat_Sqrt:  [[11.80825218  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02904306 -0.25316595 -0.33877333]
Stock Position:  -0.02904305928076383
Bond Position:  [1.83561671]


portfolio before change:  [-1.02105916]
curr_Stock_Price:  98.37582198975574
curr_Factors:  [98.37582199 -1.09301232 -1.02770239]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-1.02105916]
Stock Price:  98.26240579794812
PL:  [-1.02105916]
Settle:  Tensor("sub_116:0", shape=(), dtype=float64)
PL:  Tensor("sub_117:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  59
output_Z_Vals[:, i, :]:  [[ 1.19251512e+02 -2.92846752e+01 -2.92776944e+01]
 [ 6.47901356e-02 -4.31466599e-02 -3.65028308e-02]
 [-3.24134868e-01 -4.79704192e-02  2.07794234e-01]
 [-4.19276742e-02 -1.55883560e-01 -4.92104403e-01]
 [-9.88296441e-02 -2.41910939e-01  2.15109929e-01]
 [-5.50617434e-01  1.81343857e-01  4.19502618e-03]
 [ 5.10615817e-02  1.09206178e-01 -4.76883669e-02]
 [-2.25095838e-01  3.57026959e-01 -2.52636561e-02]
 [-4.50283355e-02 -8.03531010e-03 -1.10848060e-02]
 [-1.78932015e-01 -1.46639161e-01 -6.71641731e-02]
 [ 2.69643718e-01 -1.57672098e-01 -1.08694151e-01]
 [-1.41450629e-01  8.52528123e-02  1.27017815e-01]
 [ 5.49432403e-02 -3.19579080e-03 -4.08544978e-02]
 [-6.74810274e-02  1.94639775e-02 -3.15963119e-02]
 [-1.47048058e-01  1.06988345e-01  2.79184353e-01]
 [-1.19575392e-01 -2.32936978e-01  1.97555037e-01]
 [-2.82674343e-02 -4.92772813e-03  2.24606398e-01]
 [-1.07885892e-01  1.85403143e-01 -8.42780256e-02]
 [-2.99478233e-01 -9.20707811e-01 -8.34132443e-02]
 [ 5.51133896e-02  5.11312771e-03 -3.08107739e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.25151208 -29.28467519 -29.2776944 ]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  8.31409947  -9.26062741 -83.52111278]
init_Out:  [2.49223638]
Stock Position:  8.314099471154409
Bond position:  [-828.91771073]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [10.84140595]
curr_Stock_Price:  101.02914632250841
curr_Factors:  [101.02914632  -0.74040306  -1.06759221]
mat_Sqrt:  [[16.56701693  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00339379 -0.01364417 -0.10413242]
Stock Position:  0.003393790492635145
Bond Position:  [10.49853419]


portfolio before change:  [10.84367687]
curr_Stock_Price:  100.92482789728489
curr_Factors:  [100.9248279   -0.79260125  -1.07641801]
mat_Sqrt:  [[15.57016682  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01817306 -0.01516958  0.59277911]
Stock Position:  -0.018173064034749695
Bond Position:  [12.67779023]


portfolio before change:  [10.82506185]
curr_Stock_Price:  102.12357262628365
curr_Factors:  [102.12357263  -0.98453338  -1.06794637]
mat_Sqrt:  [[13.11430771  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01116361 -0.04929471 -1.40383689]
Stock Position:  -0.01116360576153616
Bond Position:  [11.96512916]


portfolio before change:  [10.80641881]
curr_Stock_Price:  104.06153929125834
curr_Factors:  [104.06153929  -1.19849673  -1.10890785]
mat_Sqrt:  [[10.35612228  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00590633 -0.07649896  0.61364875]
Stock Position:  -0.005906325323975637
Bond Position:  [11.42104012]


portfolio before change:  [10.80129748]
curr_Stock_Price:  105.41211734653356
curr_Factors:  [105.41211735  -1.15822358  -1.12348494]
mat_Sqrt:  [[10.7635893   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.05064099  0.05734596  0.01196724]
Stock Position:  -0.05064099287637742
Bond Position:  [16.13947176]


portfolio before change:  [10.7604954]
curr_Stock_Price:  106.29751564266712
curr_Factors:  [106.29751564  -1.13349275  -1.11773719]
mat_Sqrt:  [[11.18990444  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00394525  0.03453403 -0.13604164]
Stock Position:  0.0039452460210805404
Bond Position:  [10.34112555]


portfolio before change:  [10.76466311]
curr_Stock_Price:  106.69853169503271
curr_Factors:  [106.6985317   -1.07070344  -1.13118454]
mat_Sqrt:  [[11.80023466  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01873135  0.11290184 -0.07207018]
Stock Position:  -0.018731353274240206
Bond Position:  [12.763271]


portfolio before change:  [10.7441317]
curr_Stock_Price:  107.96499781592772
curr_Factors:  [107.96499782  -1.2829362   -1.15159307]
mat_Sqrt:  [[ 9.46194347  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00501995 -0.00254099 -0.03162187]
Stock Position:  -0.0050199499681402755
Bond Position:  [11.28611059]


portfolio before change:  [10.74271695]
curr_Stock_Price:  108.80895742848729
curr_Factors:  [108.80895743  -1.37415742  -1.13750918]
mat_Sqrt:  [[ 8.82798744  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0222506  -0.04637137 -0.19160069]
Stock Position:  -0.02225060382761484
Bond Position:  [13.16378195]


portfolio before change:  [10.76939765]
curr_Stock_Price:  107.75777950161823
curr_Factors:  [107.7577795   -1.49721253  -1.12073994]
mat_Sqrt:  [[ 7.8611543   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.03096053 -0.0498603  -0.31007416]
Stock Position:  0.03096053482840868
Bond Position:  [7.43315916]


portfolio before change:  [10.76272219]
curr_Stock_Price:  107.48213883372077
curr_Factors:  [107.48213883  -1.69985679  -1.1325231 ]
mat_Sqrt:  [[ 6.32775047  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01790874  0.02695931  0.36234647]
Stock Position:  -0.017908735277556233
Bond Position:  [12.68759136]


portfolio before change:  [10.77067434]
curr_Stock_Price:  107.21523828561736
curr_Factors:  [107.21523829  -1.58321994  -1.14502667]
mat_Sqrt:  [[ 7.00477306  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00664138 -0.0010106  -0.11654651]
Stock Position:  0.006641376599339411
Bond Position:  [10.05861756]


portfolio before change:  [10.7683385]
curr_Stock_Price:  106.48484681796124
curr_Factors:  [106.48484682  -1.26075177  -1.15774048]
mat_Sqrt:  [[ 9.48309216  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00774305  0.00615505 -0.09013548]
Stock Position:  -0.007743048217176239
Bond Position:  [11.5928558]


portfolio before change:  [10.77747951]
curr_Stock_Price:  105.67864876986482
curr_Factors:  [105.67864877  -1.35054908  -1.12321349]
mat_Sqrt:  [[ 8.90524383  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00980292  0.03383269  0.79643525]
Stock Position:  -0.009802916670405625
Bond Position:  [11.81343849]


portfolio before change:  [10.78195893]
curr_Stock_Price:  105.52301185836171
curr_Factors:  [105.52301186  -1.22211022  -1.12224772]
mat_Sqrt:  [[10.12058135  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00842482 -0.07366114  0.56356953]
Stock Position:  -0.008424817043561088
Bond Position:  [11.670971]


portfolio before change:  [10.78682015]
curr_Stock_Price:  105.29237081084767
curr_Factors:  [105.29237081  -1.51306872  -1.14435129]
mat_Sqrt:  [[ 7.38404031  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0023636  -0.00155828  0.64073953]
Stock Position:  0.002363600497820397
Bond Position:  [10.53795105]


portfolio before change:  [10.78878384]
curr_Stock_Price:  105.0084295777213
curr_Factors:  [105.00842958  -1.23970519  -1.19799604]
mat_Sqrt:  [[ 9.17368811  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01311381  0.05862962 -0.24042175]
Stock Position:  -0.013113807918698235
Bond Position:  [12.16584422]


portfolio before change:  [10.79787305]
curr_Stock_Price:  104.54728417084138
curr_Factors:  [104.54728417  -1.50871826  -1.19214476]
mat_Sqrt:  [[ 7.02009279  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.04847193 -0.29115337 -0.23795477]
Stock Position:  -0.04847193254611291
Bond Position:  [15.86548196]


portfolio before change:  [10.78070055]
curr_Stock_Price:  104.98339992234351
curr_Factors:  [104.98339992  -1.40911759  -1.13249236]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [10.78070055]
Stock Price:  105.4406536099971
PL:  [5.34004694]
Settle:  Tensor("sub_118:0", shape=(), dtype=float64)
PL:  Tensor("sub_119:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  60
output_Z_Vals[:, i, :]:  [[ 1.19251512e+02 -2.92846752e+01 -2.92776944e+01]
 [ 9.52452135e-03 -8.09291379e-02 -2.16810585e-01]
 [-2.82014168e-01 -3.65317581e-02  1.89944813e-01]
 [-5.49418888e-02 -7.70753733e-02 -2.59239731e-01]
 [-9.88296441e-02 -2.41910939e-01  2.15109929e-01]
 [-1.92687657e-01 -4.01996934e-02  2.44908081e-02]
 [ 5.36429037e-02  6.62593305e-02 -3.08460339e-02]
 [-1.75195643e-01  2.52216439e-01 -4.99402535e-02]
 [-4.39293588e-02 -3.43927933e-03 -1.27366157e-02]
 [-2.20026760e-03  1.28337982e-02 -1.89808045e-02]
 [ 1.11563982e-01  2.17866158e-02 -2.34912579e-02]
 [ 4.32866172e-02 -8.96830175e-03 -1.07972526e-01]
 [ 4.31263067e-02 -1.05795380e-02 -1.95219072e-01]
 [-4.82005408e-02  8.05428724e-03 -2.60845741e-02]
 [-1.45284862e-01  1.04503425e-01  2.76641476e-01]
 [-1.50616832e-01 -2.89850244e-01  2.23735299e-01]
 [-5.52011937e-02 -1.27233476e-01  2.53970265e-01]
 [-3.02744321e-01  4.53270758e-01 -9.21825529e-02]
 [-3.09587828e-01 -1.06278383e+00 -1.99063437e-01]
 [ 1.24609356e-01 -8.09898493e-02 -1.64991079e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.25151208 -29.28467519 -29.2776944 ]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  8.31409947  -9.26062741 -83.52111278]
init_Out:  [2.49223638]
Stock Position:  8.314099471154409
Bond position:  [-828.91771073]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [11.76077999]
curr_Stock_Price:  101.13972643377093
curr_Factors:  [101.13972643  -1.13827491  -1.04276185]
mat_Sqrt:  [[11.42114241  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00322396 -0.02559204 -0.61850025]
Stock Position:  -0.0032239625360111724
Bond Position:  [12.08685068]


portfolio before change:  [11.7663825]
curr_Stock_Price:  100.33933805083169
curr_Factors:  [100.33933805  -1.16880311  -1.03527014]
mat_Sqrt:  [[11.07272164  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02205285 -0.01155236  0.54185968]
Stock Position:  -0.02205285194950895
Bond Position:  [13.97915107]


portfolio before change:  [11.75846523]
curr_Stock_Price:  100.85684482271671
curr_Factors:  [100.85684482  -1.04797843  -1.03226823]
mat_Sqrt:  [[12.59695949  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00872028 -0.02437337 -0.73953879]
Stock Position:  -0.008720283257477666
Bond Position:  [12.63796548]


portfolio before change:  [11.75956961]
curr_Stock_Price:  101.09255972369952
curr_Factors:  [101.09255972  -0.98240001  -1.03702649]
mat_Sqrt:  [[13.41817369  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00455849 -0.07649896  0.61364875]
Stock Position:  -0.0045584912414724605
Bond Position:  [12.22039916]


portfolio before change:  [11.75679998]
curr_Stock_Price:  102.37041974321578
curr_Factors:  [102.37041974  -1.23746617  -1.05141787]
mat_Sqrt:  [[10.37826549  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01818478 -0.01271226  0.06986546]
Stock Position:  -0.018184777023096614
Bond Position:  [13.61838324]


portfolio before change:  [11.75314774]
curr_Stock_Price:  102.75850586000966
curr_Factors:  [102.75850586  -1.36405036  -1.03691714]
mat_Sqrt:  [[ 9.31302665  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0052676   0.02095304 -0.08799515]
Stock Position:  0.005267599220630676
Bond Position:  [11.21185712]


portfolio before change:  [11.7635433]
curr_Stock_Price:  104.19981585524683
curr_Factors:  [104.19981586  -0.7773032   -1.0401287 ]
mat_Sqrt:  [[16.92646654  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01056791  0.07975784 -0.14246564]
Stock Position:  -0.010567914664914396
Bond Position:  [12.86471806]


portfolio before change:  [11.768001]
curr_Stock_Price:  104.08237355994238
curr_Factors:  [104.08237356  -0.71745142  -1.0913702 ]
mat_Sqrt:  [[17.0535948   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00273362 -0.0010876  -0.03633402]
Stock Position:  -0.0027336178679744417
Bond Position:  [12.05252244]


portfolio before change:  [11.76980768]
curr_Stock_Price:  104.52385017299814
curr_Factors:  [104.52385017  -0.68066292  -1.08399485]
mat_Sqrt:  [[17.89922669  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00032087  0.0040584  -0.05414695]
Stock Position:  -0.00032087089254465576
Bond Position:  [11.80334634]


portfolio before change:  [11.77331019]
curr_Stock_Price:  102.8057076734179
curr_Factors:  [102.80570767  -1.00994994  -1.04655171]
mat_Sqrt:  [[13.14891477  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00816276  0.00688953 -0.06701402]
Stock Position:  0.008162755543805932
Bond Position:  [10.93413233]


portfolio before change:  [11.78374828]
curr_Stock_Price:  103.74953339181353
curr_Factors:  [103.74953339  -1.04622536  -0.9990912 ]
mat_Sqrt:  [[13.4188858   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0015661  -0.00283603 -0.30801556]
Stock Position:  0.001566095531813712
Bond Position:  [11.6212666]


portfolio before change:  [11.78822162]
curr_Stock_Price:  104.7505272236286
curr_Factors:  [104.75052722  -0.91908389  -1.01308169]
mat_Sqrt:  [[15.17145974  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 1.98017729e-04 -3.34554367e-03 -5.56905673e-01]
Stock Position:  0.00019801772915912635
Bond Position:  [11.76747915]


portfolio before change:  [11.79142438]
curr_Stock_Price:  106.06620020160163
curr_Factors:  [106.0662002   -1.04974885  -1.00761933]
mat_Sqrt:  [[13.55418362  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00393362  0.00254699 -0.07441203]
Stock Position:  -0.00393362469292262
Bond Position:  [12.208649]


portfolio before change:  [11.79779363]
curr_Stock_Price:  105.22303142508258
curr_Factors:  [105.22303143  -0.9777309   -1.00936067]
mat_Sqrt:  [[14.4254014   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00596984  0.03304688  0.78918113]
Stock Position:  -0.0059698436292426865
Bond Position:  [12.42595868]


portfolio before change:  [11.79054543]
curr_Stock_Price:  106.9575966441017
curr_Factors:  [106.95759664  -0.99547453  -1.01193142]
mat_Sqrt:  [[14.3683305   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00782491 -0.0916587   0.63825453]
Stock Position:  -0.007824914404346978
Bond Position:  [12.62747947]


portfolio before change:  [11.78376773]
curr_Stock_Price:  108.22725468957607
curr_Factors:  [108.22725469  -0.82170286  -1.04594912]
mat_Sqrt:  [[16.71959267  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-3.97431015e-04 -4.02347578e-02  7.24506475e-01]
Stock Position:  -0.0003974310146731563
Bond Position:  [11.82678059]


portfolio before change:  [11.78620919]
curr_Stock_Price:  109.52458331470565
curr_Factors:  [109.52458331  -0.44090221  -0.99645322]
mat_Sqrt:  [[26.01813001  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0119093   0.1433368  -0.26297116]
Stock Position:  -0.011909295730677436
Bond Position:  [13.09056985]


portfolio before change:  [11.78621174]
curr_Stock_Price:  109.79920129954016
curr_Factors:  [109.7992013   -0.54930715  -0.93989636]
mat_Sqrt:  [[24.76545527  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01524957 -0.33608176 -0.56787258]
Stock Position:  -0.01524956591304357
Bond Position:  [13.4606019]


portfolio before change:  [11.7924882]
curr_Stock_Price:  109.60831807176119
curr_Factors:  [109.60831807  -0.9673275   -0.9403182 ]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [11.7924882]
Stock Price:  110.79098517175107
PL:  [1.00150302]
Settle:  Tensor("sub_120:0", shape=(), dtype=float64)
PL:  Tensor("sub_121:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  61
output_Z_Vals[:, i, :]:  [[ 1.19251512e+02 -2.92846752e+01 -2.92776944e+01]
 [-9.52674091e-02 -2.15019621e-03 -2.83892579e-02]
 [-3.64047326e-01 -5.73642743e-02  2.36137897e-01]
 [-6.50701260e-02 -1.20322092e-01 -3.81434663e-01]
 [-9.88296441e-02 -2.41910939e-01  2.15109929e-01]
 [-1.86267805e-02 -1.70273557e-01  2.92822217e-02]
 [ 5.59459162e-02  2.79428685e-02 -1.58195847e-02]
 [-1.41094466e-01  2.25982183e-01 -9.12017552e-02]
 [-5.70560586e-03 -5.90786759e-03 -4.28272881e-03]
 [ 4.82304782e-02  4.52905764e-02 -1.05802069e-02]
 [ 5.72237411e-02  6.54616822e-02 -1.43119679e-02]
 [ 1.11339638e-01 -1.09640291e-02 -1.37362584e-01]
 [ 4.98629334e-02 -9.21971772e-03 -2.53158231e-01]
 [-8.45720117e-02  2.97281712e-02 -3.59999752e-02]
 [-6.60856976e-03 -5.69988759e-02 -4.08563552e-03]
 [ 7.15012353e-02 -9.78460703e-03  6.75369032e-02]
 [-2.57856540e-02  8.36415840e-02  1.00431075e-01]
 [-2.02797211e-02  6.17831635e-02 -8.95536538e-02]
 [-3.29756660e-01 -9.13776450e-01 -1.55097134e-01]
 [ 8.46783467e-02 -6.31862053e-02 -1.18969016e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.25151208 -29.28467519 -29.2776944 ]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  8.31409947  -9.26062741 -83.52111278]
init_Out:  [2.49223638]
Stock Position:  8.314099471154409
Bond position:  [-828.91771073]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [2.36660961]
curr_Stock_Price:  100.00981808797478
curr_Factors:  [100.00981809  -1.16823617  -1.01671516]
mat_Sqrt:  [[11.24942528  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00898871 -0.00067995 -0.08098665]
Stock Position:  -0.008988713412932154
Bond Position:  [3.2655692]


portfolio before change:  [2.36174617]
curr_Stock_Price:  100.64171474419688
curr_Factors:  [100.64171474  -1.4933175   -0.99152016]
mat_Sqrt:  [[ 8.38738816  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.03783383 -0.01814018  0.67363569]
Stock Position:  -0.037833830069753216
Bond Position:  [6.1694077]


portfolio before change:  [2.32560359]
curr_Stock_Price:  101.63778412888264
curr_Factors:  [101.63778413  -1.47950319  -1.02422872]
mat_Sqrt:  [[ 8.31186031  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0175697  -0.03804919 -1.08812692]
Stock Position:  -0.017569695381657327
Bond Position:  [4.1113485]


portfolio before change:  [2.33085983]
curr_Stock_Price:  101.39712682465125
curr_Factors:  [101.39712682  -1.38566861  -0.99425224]
mat_Sqrt:  [[ 9.38510543  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00651742 -0.07649896  0.61364875]
Stock Position:  -0.00651741503720854
Bond Position:  [2.99170699]


portfolio before change:  [2.3361159]
curr_Stock_Price:  100.70543417384249
curr_Factors:  [100.70543417  -1.18197857  -0.98505961]
mat_Sqrt:  [[11.53241291  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0014781  -0.05384523  0.08353403]
Stock Position:  -0.0014780962547947338
Bond Position:  [2.48496823]


portfolio before change:  [2.33604512]
curr_Stock_Price:  101.17367238284208
curr_Factors:  [101.17367238  -1.31794561  -0.95201121]
mat_Sqrt:  [[10.45292403  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00511228  0.00883631 -0.04512887]
Stock Position:  0.0051122765795007345
Bond Position:  [1.81881733]


portfolio before change:  [2.34737145]
curr_Stock_Price:  103.300233409235
curr_Factors:  [103.30023341  -1.68414363  -0.92342117]
mat_Sqrt:  [[ 7.61465617  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02020789  0.07146184 -0.26017322]
Stock Position:  -0.020207886954877945
Bond Position:  [4.43485089]


portfolio before change:  [2.36332452]
curr_Stock_Price:  102.56565787601356
curr_Factors:  [102.56565788  -1.32773826  -0.9160746 ]
mat_Sqrt:  [[10.87743324  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00061893 -0.00186823 -0.01221743]
Stock Position:  -0.000618928616021398
Bond Position:  [2.42680534]


portfolio before change:  [2.36416338]
curr_Stock_Price:  102.19068552519308
curr_Factors:  [102.19068553  -1.58396252  -0.9290768 ]
mat_Sqrt:  [[ 8.27965427  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00570558  0.01432214 -0.03018239]
Stock Position:  0.00570557642618901
Bond Position:  [1.78110661]


portfolio before change:  [2.35959791]
curr_Stock_Price:  101.31245724600933
curr_Factors:  [101.31245725  -1.30696115  -0.92787695]
mat_Sqrt:  [[10.84139068  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0051647   0.0207008  -0.04082806]
Stock Position:  0.005164700537314856
Bond Position:  [1.83634941]


portfolio before change:  [2.35836071]
curr_Stock_Price:  100.9840062223558
curr_Factors:  [100.98400622  -1.05020996  -0.93626034]
mat_Sqrt:  [[13.85286195  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00599281 -0.00346713 -0.39185722]
Stock Position:  0.00599280700934445
Bond Position:  [1.75318305]


portfolio before change:  [2.35757026]
curr_Stock_Price:  100.77896073180985
curr_Factors:  [100.77896073  -1.15572269  -0.92575319]
mat_Sqrt:  [[12.5717688   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-1.63129484e-04 -2.91553074e-03 -7.22189967e-01]
Stock Position:  -0.00016312948395659027
Bond Position:  [2.37401028]


portfolio before change:  [2.3580163]
curr_Stock_Price:  101.68338961815058
curr_Factors:  [101.68338962  -1.1481603   -0.94852452]
mat_Sqrt:  [[12.49313307  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00729624  0.00940087 -0.10269791]
Stock Position:  -0.007296240043738156
Bond Position:  [3.09992272]


portfolio before change:  [2.37430675]
curr_Stock_Price:  99.5568999331694
curr_Factors:  [99.55689993 -0.56027988 -0.95801063]
mat_Sqrt:  [[21.81153214  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00040869 -0.01802463 -0.01165518]
Stock Position:  -0.00040869441016818563
Bond Position:  [2.4149951]


portfolio before change:  [2.37498151]
curr_Stock_Price:  99.38334145707096
curr_Factors:  [99.38334146 -0.79141737 -0.96068703]
mat_Sqrt:  [[17.23392981  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00493413 -0.00309416  0.19266399]
Stock Position:  0.0049341335023831995
Bond Position:  [1.88461084]


portfolio before change:  [2.38185778]
curr_Stock_Price:  100.68145284438309
curr_Factors:  [100.68145284  -0.72433052  -0.9399051 ]
mat_Sqrt:  [[19.06255573  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-1.63967012e-04  2.64497913e-02  2.86501901e-01]
Stock Position:  -0.00016396701190363037
Bond Position:  [2.39836621]


portfolio before change:  [2.38222726]
curr_Stock_Price:  102.08528511702542
curr_Factors:  [102.08528512  -0.7728056   -0.99336084]
mat_Sqrt:  [[17.45527951  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00211767  0.01953755 -0.25547165]
Stock Position:  -0.0021176716039088186
Bond Position:  [2.59841037]


portfolio before change:  [2.3814959]
curr_Stock_Price:  102.73743568128093
curr_Factors:  [102.73743568  -0.8560961   -0.95358701]
mat_Sqrt:  [[16.81873517  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02289169 -0.28896149 -0.44244895]
Stock Position:  -0.022891693823818244
Bond Position:  [4.73332983]


portfolio before change:  [2.41600728]
curr_Stock_Price:  101.28154113669821
curr_Factors:  [101.28154114  -0.94650042  -0.92647774]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [2.41600728]
Stock Price:  101.8247460610491
PL:  [0.59126122]
Settle:  Tensor("sub_122:0", shape=(), dtype=float64)
PL:  Tensor("sub_123:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  62
output_Z_Vals[:, i, :]:  [[ 1.19251512e+02 -2.92846752e+01 -2.92776944e+01]
 [-4.23198648e-01  1.40395048e-01  3.54373126e-01]
 [-3.44065495e-01 -9.59410925e-02  3.01520501e-01]
 [-5.11870526e-02  3.88370380e-02  5.29495671e-02]
 [-8.22381838e-02 -1.03267374e-01  7.44825255e-02]
 [-8.30959264e-02  4.23555873e-02 -3.62583997e-03]
 [-2.09510672e-01 -1.97529382e-01  1.58287936e-01]
 [-2.27204982e-02  2.96913432e-02 -1.02189406e-01]
 [-2.44121421e-01 -1.58543958e-01  3.46365340e-01]
 [ 3.70047481e-04 -4.26767744e-02  2.60594107e-02]
 [-5.73942112e-02  1.25705718e-01  2.05196171e-02]
 [-8.06611000e-02 -9.24147191e-03 -1.21250179e-01]
 [-1.69139899e-02 -2.96503644e-01 -3.51968349e-01]
 [ 6.90074599e-02 -3.56786951e-02  8.82602326e-03]
 [ 1.11348156e-02 -5.79141975e-02 -1.09473076e-01]
 [ 1.73916771e-01  4.22249763e-02 -1.09431312e-01]
 [ 1.52601225e-02 -9.81853461e-03  9.77490445e-02]
 [ 4.16196696e-02 -2.49874608e-02  6.99696018e-02]
 [-3.61953173e-01 -9.09649713e-01 -2.00013329e-01]
 [ 1.32273964e-01 -2.00553987e-01 -3.52166440e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.25151208 -29.28467519 -29.2776944 ]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  8.31409947  -9.26062741 -83.52111278]
init_Out:  [2.49223638]
Stock Position:  8.314099471154409
Bond position:  [-828.91771073]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-10.88422243]
curr_Stock_Price:  98.41603970178039
curr_Factors:  [98.4160397  -1.30925361 -0.98127143]
mat_Sqrt:  [[ 9.96101289  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.03485966  0.04439681  1.01092789]
Stock Position:  -0.03485966299081823
Bond Position:  [-7.45347245]


portfolio before change:  [-10.83726324]
curr_Stock_Price:  97.01548717859279
curr_Factors:  [97.01548718 -1.38083395 -0.94189399]
mat_Sqrt:  [[ 9.50808686  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02997397 -0.03033924  0.86015406]
Stock Position:  -0.02997396563232771
Bond Position:  [-7.92932436]


portfolio before change:  [-10.82218015]
curr_Stock_Price:  96.44613737353903
curr_Factors:  [96.44613737 -1.29195443 -0.98582269]
mat_Sqrt:  [[ 9.88686953  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00398266  0.01228135  0.15105038]
Stock Position:  -0.003982655916324983
Bond Position:  [-10.43806837]


portfolio before change:  [-10.82882714]
curr_Stock_Price:  97.45982136661945
curr_Factors:  [97.45982137 -1.34242568 -0.95753141]
mat_Sqrt:  [[ 9.7716283   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00713298 -0.03265601  0.21247791]
Stock Position:  -0.007132982546786951
Bond Position:  [-10.13364794]


portfolio before change:  [-10.82974018]
curr_Stock_Price:  97.23261078061981
curr_Factors:  [97.23261078 -0.93512571 -0.91774911]
mat_Sqrt:  [[15.24469139  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00542762  0.01339401 -0.01034351]
Stock Position:  -0.005427622588668288
Bond Position:  [-10.30199827]


portfolio before change:  [-10.82644805]
curr_Stock_Price:  96.15148323088823
curr_Factors:  [96.15148323 -0.55235056 -0.9206971 ]
mat_Sqrt:  [[22.04040217  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0082712  -0.06246428  0.45155142]
Stock Position:  -0.00827119524135747
Bond Position:  [-10.03116036]


portfolio before change:  [-10.83390205]
curr_Stock_Price:  96.74944892587982
curr_Factors:  [96.74944893 -0.95540862 -0.94745702]
mat_Sqrt:  [[14.42927309  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00296711  0.00938923 -0.29151793]
Stock Position:  -0.0029671069303130763
Bond Position:  [-10.54683609]


portfolio before change:  [-10.83312752]
curr_Stock_Price:  95.59965370714933
curr_Factors:  [95.59965371 -0.95621165 -0.96479356]
mat_Sqrt:  [[14.00149331  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01267818 -0.050136    0.98808391]
Stock Position:  -0.012678181901288032
Bond Position:  [-9.62109772]


portfolio before change:  [-10.83529588]
curr_Stock_Price:  95.58094286072053
curr_Factors:  [95.58094286 -1.01809584 -0.98211131]
mat_Sqrt:  [[12.93279465  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00035472 -0.01349558  0.07434025]
Stock Position:  0.00035471782820632833
Bond Position:  [-10.86920014]


portfolio before change:  [-10.83783051]
curr_Stock_Price:  96.09685386672288
curr_Factors:  [96.09685387 -0.86232814 -0.97916623]
mat_Sqrt:  [[15.23906524  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00327841  0.03975164  0.05853676]
Stock Position:  -0.0032784133047763673
Bond Position:  [-10.52278531]


portfolio before change:  [-10.83936186]
curr_Stock_Price:  95.7614241454633
curr_Factors:  [95.76142415 -0.80705601 -0.97957257]
mat_Sqrt:  [[16.04233797  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00658569 -0.00292241 -0.34589301]
Stock Position:  -0.0065856861374537015
Bond Position:  [-10.20870718]


portfolio before change:  [-10.8424365]
curr_Stock_Price:  95.84070815952235
curr_Factors:  [95.84070816 -0.52512866 -0.99274618]
mat_Sqrt:  [[21.00609605  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00458985 -0.09376269 -1.00406773]
Stock Position:  -0.004589854258841161
Bond Position:  [-10.40254161]


portfolio before change:  [-10.84074441]
curr_Stock_Price:  94.90537386016446
curr_Factors:  [94.90537386 -0.70198034 -1.01044968]
mat_Sqrt:  [[17.1234747   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00408141 -0.01128259  0.02517819]
Stock Position:  0.004081405533855563
Bond Position:  [-11.22809173]


portfolio before change:  [-10.84510601]
curr_Stock_Price:  94.52456596552261
curr_Factors:  [94.52456597 -0.28210992 -1.02913144]
mat_Sqrt:  [[25.47298303  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00049883 -0.01831408 -0.31229621]
Stock Position:  -0.0004988273515448675
Bond Position:  [-10.79795458]


portfolio before change:  [-10.84824948]
curr_Stock_Price:  95.41394139173259
curr_Factors:  [95.41394139 -0.38670575 -1.05791241]
mat_Sqrt:  [[22.50205281  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00678469  0.01335271 -0.31217707]
Stock Position:  0.006784689543729881
Bond Position:  [-11.49560346]


portfolio before change:  [-10.85426359]
curr_Stock_Price:  94.95115814205072
curr_Factors:  [94.95115814 -0.48807432 -1.02773777]
mat_Sqrt:  [[20.85409961  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00167639 -0.00310489  0.27885082]
Stock Position:  0.001676387368702896
Bond Position:  [-11.01343851]


portfolio before change:  [-10.85970139]
curr_Stock_Price:  93.35003822054924
curr_Factors:  [93.35003822 -0.61715002 -1.01672825]
mat_Sqrt:  [[18.21923707  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00303289 -0.00790173  0.1996038 ]
Stock Position:  0.0030328921601645124
Bond Position:  [-11.14282199]


portfolio before change:  [-10.85781108]
curr_Stock_Price:  94.89191875392387
curr_Factors:  [94.89191875 -0.48693279 -1.03599157]
mat_Sqrt:  [[20.69338722  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02059923 -0.2876565  -0.57058236]
Stock Position:  -0.0205992268252654
Bond Position:  [-8.90311092]


portfolio before change:  [-10.821996]
curr_Stock_Price:  93.04519241229171
curr_Factors:  [93.04519241 -0.13550567 -1.06388876]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-10.821996]
Stock Price:  91.10427555354563
PL:  [-10.821996]
Settle:  Tensor("sub_124:0", shape=(), dtype=float64)
PL:  Tensor("sub_125:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  63
output_Z_Vals[:, i, :]:  [[ 1.19251512e+02 -2.92846752e+01 -2.92776944e+01]
 [ 1.66163629e-02 -1.86151052e-03 -4.63255517e-02]
 [-3.24007847e-01 -4.79359241e-02  2.07740406e-01]
 [-1.40605460e-02 -1.33575940e-01 -4.23743957e-01]
 [-9.88296441e-02 -2.41910939e-01  2.15109929e-01]
 [-4.25561593e-01  1.59882346e-01 -3.61475053e-03]
 [ 5.10615817e-02  1.09206178e-01 -4.76883669e-02]
 [-1.79151428e-01  2.59031628e-01 -5.21929361e-02]
 [-1.96384986e-02  5.58278081e-03 -3.40840616e-02]
 [ 1.98336349e-02  2.92507701e-02 -1.39822492e-02]
 [ 1.25313340e-01  8.31521403e-03 -2.82722062e-02]
 [ 1.66954287e-01 -1.25949878e-02 -1.61380882e-01]
 [ 3.86881587e-02 -1.39763155e-02 -2.85133812e-01]
 [-8.45720117e-02  2.97281712e-02 -3.59999752e-02]
 [-8.57398821e-02  1.01500476e-02  1.44341461e-01]
 [-1.03819643e-02 -3.76450312e-02  1.06587904e-01]
 [-2.39871172e-02  5.97029845e-02  1.23475275e-01]
 [ 1.57826514e-02  1.59539224e-02 -7.77244471e-02]
 [-3.60615540e-01 -9.61270017e-01 -1.85327315e-01]
 [ 7.80394984e-02 -4.79294856e-02 -9.92514530e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.25151208 -29.28467519 -29.2776944 ]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  8.31409947  -9.26062741 -83.52111278]
init_Out:  [2.49223638]
Stock Position:  8.314099471154409
Bond position:  [-828.91771073]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [5.77794452]
curr_Stock_Price:  100.42012529219959
curr_Factors:  [100.42012529  -0.5497695   -1.02302802]
mat_Sqrt:  [[20.83355922  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00034138 -0.00058866 -0.1321539 ]
Stock Position:  0.0003413787921021917
Bond Position:  [5.74366322]


portfolio before change:  [5.77973751]
curr_Stock_Price:  101.46557368743717
curr_Factors:  [101.46557369  -0.34228614  -1.0363563 ]
mat_Sqrt:  [[25.56123954  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01106522 -0.01515867  0.59262556]
Stock Position:  -0.011065219025238984
Bond Position:  [6.90247631]


portfolio before change:  [5.77529382]
curr_Stock_Price:  102.02313362810676
curr_Factors:  [102.02313363  -0.41454143  -1.0264129 ]
mat_Sqrt:  [[24.14905537  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00430683 -0.04224042 -1.20882356]
Stock Position:  -0.004306828289770399
Bond Position:  [6.21468994]


portfolio before change:  [5.77726995]
curr_Stock_Price:  101.92508801593002
curr_Factors:  [101.92508802  -0.29486859  -1.04322002]
mat_Sqrt:  [[26.73970393  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00228748 -0.07649896  0.61364875]
Stock Position:  -0.0022874833397901794
Bond Position:  [6.0104219]


portfolio before change:  [5.77398911]
curr_Stock_Price:  104.01630948987166
curr_Factors:  [104.01630949  -0.54485915  -1.04162349]
mat_Sqrt:  [[21.28632961  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01983298  0.05055924 -0.01031188]
Stock Position:  -0.019832977992444007
Bond Position:  [7.83694229]


portfolio before change:  [5.76058287]
curr_Stock_Price:  104.79106563000852
curr_Factors:  [104.79106563  -0.69164493  -1.04294958]
mat_Sqrt:  [[18.49266206  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00238727  0.03453403 -0.13604164]
Stock Position:  0.002387267221202911
Bond Position:  [5.5104186]


portfolio before change:  [5.7611391]
curr_Stock_Price:  104.44692773495312
curr_Factors:  [104.44692773  -0.88704155  -1.08233492]
mat_Sqrt:  [[14.57492536  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01256384  0.08191299 -0.14889192]
Stock Position:  -0.012563844678881378
Bond Position:  [7.07339408]


portfolio before change:  [5.76726392]
curr_Stock_Price:  104.10019847691156
curr_Factors:  [104.10019848  -0.95781649  -1.04731444]
mat_Sqrt:  [[14.01632826  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00188721  0.00176543 -0.09723234]
Stock Position:  -0.0018872083531342465
Bond Position:  [5.96372269]


portfolio before change:  [5.76881399]
curr_Stock_Price:  104.06896187431116
curr_Factors:  [104.06896187  -1.33489856  -1.0222107 ]
mat_Sqrt:  [[ 9.85466078  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00179963  0.00924991 -0.03988746]
Stock Position:  0.0017996329115632873
Bond Position:  [5.58152806]


portfolio before change:  [5.7685982]
curr_Stock_Price:  103.1735892091504
curr_Factors:  [103.17358921  -1.07063075  -1.01842011]
mat_Sqrt:  [[12.77336371  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00937553  0.0026295  -0.08065273]
Stock Position:  0.009375525590705583
Bond Position:  [4.80129158]


portfolio before change:  [5.75823645]
curr_Stock_Price:  101.94035400588712
curr_Factors:  [101.94035401  -0.88610708  -1.02404815]
mat_Sqrt:  [[15.09302401  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00885756 -0.00398288 -0.46037474]
Stock Position:  0.008857559041081414
Bond Position:  [4.85529374]


portfolio before change:  [5.76135082]
curr_Stock_Price:  102.15490480056307
curr_Factors:  [102.1549048   -0.69626599  -1.02689703]
mat_Sqrt:  [[18.2347172   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00108998 -0.0044197  -0.8134074 ]
Stock Position:  -0.0010899759815290058
Bond Position:  [5.87269721]


portfolio before change:  [5.76271073]
curr_Stock_Price:  102.25440209478074
curr_Factors:  [102.25440209  -1.04711828  -1.01548473]
mat_Sqrt:  [[12.99884925  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00701238  0.00940087 -0.10269791]
Stock Position:  -0.007012382095685491
Bond Position:  [6.47975767]


portfolio before change:  [5.7657367]
curr_Stock_Price:  102.05392347730711
curr_Factors:  [102.05392348  -0.81680947  -1.02110969]
mat_Sqrt:  [[16.24170271  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00344879  0.00320973  0.41176601]
Stock Position:  -0.0034487906096366716
Bond Position:  [6.11769932]


portfolio before change:  [5.76914865]
curr_Stock_Price:  101.50812904488515
curr_Factors:  [101.50812904  -0.82130075  -1.09051858]
mat_Sqrt:  [[15.00404073  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00069336 -0.0119044   0.30406562]
Stock Position:  0.0006933605502319991
Bond Position:  [5.69876692]


portfolio before change:  [5.77103124]
curr_Stock_Price:  102.16827382754218
curr_Factors:  [102.16827383  -1.0613825   -1.1104522 ]
mat_Sqrt:  [[11.64394727  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [2.36920699e-04 1.88797414e-02 3.52240590e-01]
Stock Position:  0.00023692069863230362
Bond Position:  [5.74682546]


portfolio before change:  [5.77219502]
curr_Stock_Price:  101.0155555825741
curr_Factors:  [101.01555558  -1.13806666  -1.12500652]
mat_Sqrt:  [[10.5086775   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 3.13211233e-05  5.04507323e-03 -2.21726213e-01]
Stock Position:  3.132112327118937e-05
Bond Position:  [5.7690311]


portfolio before change:  [5.77366092]
curr_Stock_Price:  101.76449804994296
curr_Factors:  [101.76449805  -0.78172382  -1.180646  ]
mat_Sqrt:  [[14.30045681  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02959802 -0.30398027 -0.52868725]
Stock Position:  -0.029598019838634675
Bond Position:  [8.78568855]


portfolio before change:  [5.80896915]
curr_Stock_Price:  100.64579009516402
curr_Factors:  [100.6457901   -0.37293647  -1.20902229]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [5.80896915]
Stock Price:  100.77853413084289
PL:  [5.03043502]
Settle:  Tensor("sub_126:0", shape=(), dtype=float64)
PL:  Tensor("sub_127:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  64
output_Z_Vals[:, i, :]:  [[ 1.19251512e+02 -2.92846752e+01 -2.92776944e+01]
 [ 4.73941519e-02 -5.50394685e-02 -9.32583885e-02]
 [-5.53107936e-01 -9.82766617e-02  3.98755308e-01]
 [-1.69482098e-03 -1.53856861e-01 -4.80205415e-01]
 [-9.88296441e-02 -2.41910939e-01  2.15109929e-01]
 [-3.98831506e-01  7.66068315e-02  1.94069164e-02]
 [ 5.26002222e-02  8.36069847e-02 -3.76492101e-02]
 [-1.41167227e-01  2.27114250e-01 -9.26418310e-02]
 [ 1.87064085e-03 -1.71062640e-03 -1.75626745e-02]
 [ 4.90317503e-02  3.09325757e-02 -6.21134842e-03]
 [ 1.19013795e-01  1.55976195e-02 -2.41610335e-02]
 [ 1.16666108e-01 -1.11202334e-02 -1.39662926e-01]
 [ 4.79103395e-02 -8.52197805e-03 -1.80443579e-01]
 [-8.45720117e-02  2.97281712e-02 -3.59999752e-02]
 [-8.92329791e-02  1.51121675e-02  1.49553607e-01]
 [-5.40432425e-02 -1.22439762e-01  1.44499813e-01]
 [-2.61702488e-02  7.10042281e-02  1.18278668e-01]
 [-2.47507644e-02  6.99753742e-02 -8.40715724e-02]
 [-2.83756371e-01 -8.45118828e-01 -7.89315687e-02]
 [ 8.00417959e-02 -5.25309601e-02 -1.05198332e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.25151208 -29.28467519 -29.2776944 ]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  8.31409947  -9.26062741 -83.52111278]
init_Out:  [2.49223638]
Stock Position:  8.314099471154409
Bond position:  [-828.91771073]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [10.31985996]
curr_Stock_Price:  100.96641601860397
curr_Factors:  [100.96641602  -0.91380682  -1.03831836]
mat_Sqrt:  [[14.33440745  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00187917 -0.01740501 -0.26604022]
Stock Position:  0.001879167323131233
Bond Position:  [10.13012717]


portfolio before change:  [10.32532352]
curr_Stock_Price:  102.52599443230845
curr_Factors:  [102.52599443  -0.79566074  -1.05014514]
mat_Sqrt:  [[16.18865178  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0292952  -0.03107781  1.1375379 ]
Stock Position:  -0.02929520309829443
Bond Position:  [13.32884335]


portfolio before change:  [10.32954968]
curr_Stock_Price:  102.49549338162711
curr_Factors:  [102.49549338  -0.85315306  -1.06089145]
mat_Sqrt:  [[15.11631034  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00685941 -0.04865381 -1.36989239]
Stock Position:  -0.006859405871382928
Bond Position:  [11.03260787]


portfolio before change:  [10.32267408]
curr_Stock_Price:  103.90000180107509
curr_Factors:  [103.9000018   -1.2709286   -1.08486333]
mat_Sqrt:  [[ 9.85163067  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00620878 -0.07649896  0.61364875]
Stock Position:  -0.006208782008581628
Bond Position:  [10.96776654]


portfolio before change:  [10.32279398]
curr_Stock_Price:  104.32236866551496
curr_Factors:  [104.32236867  -1.42060629  -1.073942  ]
mat_Sqrt:  [[ 8.61011364  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.04563147  0.02422521  0.05536253]
Stock Position:  -0.04563146573331519
Bond Position:  [15.08317657]


portfolio before change:  [10.36013955]
curr_Stock_Price:  103.58659774497433
curr_Factors:  [103.58659774  -1.50524615  -1.05491746]
mat_Sqrt:  [[ 8.00642504  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00587951  0.02643885 -0.10740272]
Stock Position:  0.005879507050794064
Bond Position:  [9.75110142]


portfolio before change:  [10.36033915]
curr_Stock_Price:  103.20587093062711
curr_Factors:  [103.20587093  -1.68086697  -1.04946709]
mat_Sqrt:  [[ 6.72876541  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02291856  0.07181983 -0.26428136]
Stock Position:  -0.022918557520500118
Bond Position:  [12.72566884]


portfolio before change:  [10.36887398]
curr_Stock_Price:  102.97230419645483
curr_Factors:  [102.9723042   -1.81802035  -0.98993863]
mat_Sqrt:  [[ 6.21211288  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00028307 -0.00054095 -0.05010142]
Stock Position:  -0.0002830749028235662
Bond Position:  [10.39802285]


portfolio before change:  [10.37145882]
curr_Stock_Price:  103.0252605674752
curr_Factors:  [103.02526057  -1.47017999  -0.95639273]
mat_Sqrt:  [[ 9.10115642  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00533586  0.00978174 -0.01771925]
Stock Position:  0.005335864757809379
Bond Position:  [9.82172996]


portfolio before change:  [10.37422351]
curr_Stock_Price:  103.0831625087061
curr_Factors:  [103.08316251  -1.56042309  -0.96797004]
mat_Sqrt:  [[ 8.22470917  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0139196  0.0049324 -0.0689247]
Stock Position:  0.013919601436672114
Bond Position:  [8.93934698]


portfolio before change:  [10.37345183]
curr_Stock_Price:  102.8671509978786
curr_Factors:  [102.867151    -1.26143507  -0.99938171]
mat_Sqrt:  [[10.72547312  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00819268 -0.00351653 -0.39841945]
Stock Position:  0.00819268373831107
Bond Position:  [9.5306938]


portfolio before change:  [10.37328299]
curr_Stock_Price:  102.55567602622912
curr_Factors:  [102.55567603  -1.22605555  -1.01889462]
mat_Sqrt:  [[10.86401194  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00099939 -0.00269489 -0.51475531]
Stock Position:  0.00099939245336902
Bond Position:  [10.27078962]


portfolio before change:  [10.37606946]
curr_Stock_Price:  102.7742594866309
curr_Factors:  [102.77425949  -1.49442966  -1.01828648]
mat_Sqrt:  [[ 8.32962787  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01094321  0.00940087 -0.10269791]
Stock Position:  -0.01094321369497447
Bond Position:  [11.50075014]


portfolio before change:  [10.38430776]
curr_Stock_Price:  102.28420671105135
curr_Factors:  [102.28420671  -1.56177969  -1.04899135]
mat_Sqrt:  [[ 7.5156254   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00775921  0.00477889  0.42663481]
Stock Position:  -0.007759205557652018
Bond Position:  [11.17795194]


portfolio before change:  [10.38339742]
curr_Stock_Price:  102.76172710636675
curr_Factors:  [102.76172711  -1.72760154  -1.03570509]
mat_Sqrt:  [[ 6.48250074  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00427439 -0.03871885  0.41221775]
Stock Position:  -0.004274387894193999
Bond Position:  [10.8226409]


portfolio before change:  [10.38686478]
curr_Stock_Price:  102.58360390990187
curr_Factors:  [102.58360391  -1.72759368  -0.96074645]
mat_Sqrt:  [[ 6.97503947  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-2.77268006e-05  2.24535084e-02  3.37416117e-01]
Stock Position:  -2.7726800629847015e-05
Bond Position:  [10.3897091]


portfolio before change:  [10.38945825]
curr_Stock_Price:  102.738241366704
curr_Factors:  [102.73824137  -1.22531856  -0.92280953]
mat_Sqrt:  [[11.98980027  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00334493  0.02212816 -0.2398328 ]
Stock Position:  -0.0033449302664460695
Bond Position:  [10.7331105]


portfolio before change:  [10.39069076]
curr_Stock_Price:  103.17206211751713
curr_Factors:  [103.17206212  -1.33932779  -0.92196968]
mat_Sqrt:  [[10.7520951   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02991874 -0.26725004 -0.2251698 ]
Stock Position:  -0.02991873505616989
Bond Position:  [13.47746835]


portfolio before change:  [10.37864946]
curr_Stock_Price:  103.68716041365168
curr_Factors:  [103.68716041  -1.04660981  -0.91269382]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [10.37864946]
Stock Price:  103.44024987466307
PL:  [6.93839958]
Settle:  Tensor("sub_128:0", shape=(), dtype=float64)
PL:  Tensor("sub_129:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  65
output_Z_Vals[:, i, :]:  [[ 1.19251512e+02 -2.92846752e+01 -2.92776944e+01]
 [-1.19085518e-01  1.30551986e-02 -1.16126017e-01]
 [-1.94757152e-01 -3.76600838e-02  1.23110063e-01]
 [-6.72532852e-02 -1.26571874e-02 -8.16353012e-02]
 [-9.29236971e-02 -1.92558951e-01  1.65051768e-01]
 [-2.69493633e-01  1.31342311e-01  4.77345934e-03]
 [-1.93110113e-01 -1.75617831e-01  1.43337536e-01]
 [-4.77394197e-02  8.21513113e-02 -1.03901533e-01]
 [-2.96949047e-01 -1.67637232e-01  3.64509256e-01]
 [ 7.31047383e-04 -2.82348247e-02  2.18147666e-02]
 [-3.18737347e-02  1.11798422e-01  1.64596633e-02]
 [-5.68575370e-02 -9.46019736e-03 -1.28080978e-01]
 [-2.26030040e-02 -3.30061298e-01 -3.23679404e-01]
 [ 1.14248125e-02  4.48093355e-04  8.94334976e-04]
 [ 2.24511026e-02 -6.44798969e-02 -5.80178979e-02]
 [ 1.41123463e-01  1.04139722e-02 -1.41536009e-02]
 [-2.35647895e-02  1.03259148e-01  6.82888801e-02]
 [ 4.27163921e-02 -2.45159340e-02  5.91185536e-02]
 [-3.80323864e-01 -9.57002476e-01 -2.28068457e-01]
 [ 1.15188356e-01 -2.10153848e-01 -4.01214457e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.25151208 -29.28467519 -29.2776944 ]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  8.31409947  -9.26062741 -83.52111278]
init_Out:  [2.49223638]
Stock Position:  8.314099471154409
Bond position:  [-828.91771073]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [1.33800706]
curr_Stock_Price:  99.8861002331122
curr_Factors:  [99.88610023 -0.69752197 -0.98653877]
mat_Sqrt:  [[18.54072742  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00768322  0.00412842 -0.3312752 ]
Stock Position:  -0.007683223792254967
Bond Position:  [2.10545432]


portfolio before change:  [1.35478725]
curr_Stock_Price:  97.77061366145611
curr_Factors:  [97.77061366 -0.50071343 -1.00006421]
mat_Sqrt:  [[21.79861473  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00782618 -0.01190916  0.35119874]
Stock Position:  -0.00782617596208961
Bond Position:  [2.11995727]


portfolio before change:  [1.34327978]
curr_Stock_Price:  99.30872330748579
curr_Factors:  [99.30872331 -0.13878951 -1.01056028]
mat_Sqrt:  [[31.46524569  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00267736 -0.00400255 -0.23288279]
Stock Position:  -0.002677361214896244
Bond Position:  [1.60916511]


portfolio before change:  [1.35836425]
curr_Stock_Price:  93.82492024865658
curr_Factors:  [93.82492025 -0.14900401 -1.00826067]
mat_Sqrt:  [[29.49337955  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00217691 -0.06089249  0.47084675]
Stock Position:  -0.0021769121669924117
Bond Position:  [1.56261286]


portfolio before change:  [1.35989868]
curr_Stock_Price:  93.29952947318185
curr_Factors:  [93.29952947 -0.46412092 -1.01262577]
mat_Sqrt:  [[21.30769709  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01244283  0.04153409  0.01361735]
Stock Position:  -0.01244282806153592
Bond Position:  [2.52080868]


portfolio before change:  [1.32113776]
curr_Stock_Price:  96.46530495913555
curr_Factors:  [96.46530496 -0.54250844 -1.04191998]
mat_Sqrt:  [[19.78165492  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00851222 -0.05553523  0.40890209]
Stock Position:  -0.008512224824088572
Bond Position:  [2.14227212]


portfolio before change:  [1.31081321]
curr_Stock_Price:  97.74113925851441
curr_Factors:  [97.74113926 -0.79433019 -1.0670264 ]
mat_Sqrt:  [[15.19499283  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00439797  0.02597853 -0.29640215]
Stock Position:  -0.004397968087845538
Bond Position:  [1.74067562]


portfolio before change:  [1.31756837]
curr_Stock_Price:  96.30412577293171
curr_Factors:  [96.30412577 -0.5294088  -1.08372237]
mat_Sqrt:  [[19.18982111  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01182253 -0.05301155  1.03984345]
Stock Position:  -0.011822532396410299
Bond Position:  [2.45612702]


portfolio before change:  [1.32576874]
curr_Stock_Price:  95.66244751834405
curr_Factors:  [95.66244752 -0.69236765 -1.07528839]
mat_Sqrt:  [[16.33270902  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00027276 -0.00892864  0.06223146]
Stock Position:  0.0002727623393054952
Bond Position:  [1.29967563]


portfolio before change:  [1.32625572]
curr_Stock_Price:  96.25644004918189
curr_Factors:  [96.25644005 -0.92755132 -1.11918583]
mat_Sqrt:  [[12.4320614   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00206139  0.03535377  0.04695484]
Stock Position:  -0.002061387594091225
Bond Position:  [1.52467755]


portfolio before change:  [1.32760061]
curr_Stock_Price:  95.78894974926014
curr_Factors:  [95.78894975 -0.62065702 -1.07531218]
mat_Sqrt:  [[17.56974057  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00473804 -0.00299158 -0.36537938]
Stock Position:  -0.004738044820304677
Bond Position:  [1.78145295]


portfolio before change:  [1.3309797]
curr_Stock_Price:  95.16977806901185
curr_Factors:  [95.16977807 -0.58924416 -1.10130846]
mat_Sqrt:  [[17.5509804   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00553792 -0.10437455 -0.92336724]
Stock Position:  -0.005537920356355026
Bond Position:  [1.85802235]


portfolio before change:  [1.32259561]
curr_Stock_Price:  96.76760730957729
curr_Factors:  [96.76760731 -0.76227802 -1.14305493]
mat_Sqrt:  [[14.39641685  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00080707 0.0001417  0.00255129]
Stock Position:  0.0008070714912792857
Bond Position:  [1.24449723]


portfolio before change:  [1.32363372]
curr_Stock_Price:  97.66832443039381
curr_Factors:  [97.66832443 -0.72090949 -1.15056617]
mat_Sqrt:  [[15.03080298  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.000595   -0.02039033 -0.16550891]
Stock Position:  0.0005950038049848569
Bond Position:  [1.26552069]


portfolio before change:  [1.32396431]
curr_Stock_Price:  97.69215201451516
curr_Factors:  [97.69215201 -0.57511972 -1.15315398]
mat_Sqrt:  [[17.34921959  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00798326  0.00329319 -0.04037628]
Stock Position:  0.007983255840349495
Bond Position:  [0.54406287]


portfolio before change:  [1.31561776]
curr_Stock_Price:  96.62960498092035
curr_Factors:  [96.62960498 -0.34347622 -1.12534742]
mat_Sqrt:  [[22.24376009  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00031286  0.03265341  0.19480917]
Stock Position:  -0.0003128625949633087
Bond Position:  [1.34584955]


portfolio before change:  [1.31633773]
curr_Stock_Price:  95.4039476982805
curr_Factors:  [95.4039477  -0.55220897 -1.06555794]
mat_Sqrt:  [[18.92252559  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00286172 -0.00775262  0.16864878]
Stock Position:  0.0028617172381231763
Bond Position:  [1.04331861]


portfolio before change:  [1.30960617]
curr_Stock_Price:  92.96051264986309
curr_Factors:  [92.96051265 -0.46931386 -1.07639224]
mat_Sqrt:  [[19.81558407  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02278953 -0.30263076 -0.65061582]
Stock Position:  -0.02278952962292404
Bond Position:  [3.42813253]


portfolio before change:  [1.36123868]
curr_Stock_Price:  90.73249954828337
curr_Factors:  [90.73249955 -0.89601342 -1.08687113]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [1.36123868]
Stock Price:  90.25132166558508
PL:  [1.36123868]
Settle:  Tensor("sub_130:0", shape=(), dtype=float64)
PL:  Tensor("sub_131:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  66
output_Z_Vals[:, i, :]:  [[ 1.19251512e+02 -2.92846752e+01 -2.92776944e+01]
 [-1.42260487e-01  2.46115056e-02 -7.45896703e-02]
 [-5.53062997e-01 -9.82669371e-02  3.98716655e-01]
 [-5.89539723e-02 -9.42066316e-02 -3.07644628e-01]
 [-9.88296441e-02 -2.41910939e-01  2.15109929e-01]
 [-6.76094957e-02 -1.59476022e-01  4.80649362e-02]
 [ 5.55401713e-02  3.46934642e-02 -1.84669451e-02]
 [-1.03785530e-01  1.78867833e-01 -1.00758499e-01]
 [-2.65789082e-02 -1.86257408e-02  2.46258171e-02]
 [ 4.50470017e-02  4.74936917e-02 -1.18045691e-02]
 [ 7.93164308e-02  5.02520984e-02 -1.56132921e-02]
 [ 1.17487936e-01 -1.11443344e-02 -1.40017849e-01]
 [ 3.87078737e-02 -1.35504613e-02 -2.63696870e-01]
 [-8.45720117e-02  2.97281712e-02 -3.59999752e-02]
 [-9.11486406e-02  2.05820724e-02  1.64640333e-01]
 [-5.40714062e-02 -1.22352715e-01  1.44491753e-01]
 [-2.38527985e-02  2.93196170e-02  1.61874636e-01]
 [-1.65170091e-02  5.63117837e-02 -9.02282990e-02]
 [-3.19058844e-01 -8.62052132e-01 -1.46955606e-01]
 [ 1.09437425e-01 -1.20084976e-01 -1.92504163e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.25151208 -29.28467519 -29.2776944 ]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  8.31409947  -9.26062741 -83.52111278]
init_Out:  [2.49223638]
Stock Position:  8.314099471154409
Bond position:  [-828.91771073]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-0.52055186]
curr_Stock_Price:  99.66255721173121
curr_Factors:  [99.66255721 -0.84933033 -1.02020094]
mat_Sqrt:  [[15.36755984  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0102066   0.00778284 -0.21278357]
Stock Position:  -0.010206602383921824
Bond Position:  [0.49666424]


portfolio before change:  [-0.54552782]
curr_Stock_Price:  102.1217639679315
curr_Factors:  [102.12176397  -1.23309124  -1.02714939]
mat_Sqrt:  [[10.65389158  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.04451073 -0.03107473  1.13742763]
Stock Position:  -0.044510734718339114
Bond Position:  [3.99998692]


portfolio before change:  [-0.51554384]
curr_Stock_Price:  101.47059845590805
curr_Factors:  [101.47059846  -1.7996183   -1.03113391]
mat_Sqrt:  [[ 5.98356699  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02075419 -0.02979075 -0.87762449]
Stock Position:  -0.02075418791291632
Bond Position:  [1.59039603]


portfolio before change:  [-0.52586954]
curr_Stock_Price:  101.98728204293342
curr_Factors:  [101.98728204  -1.8723871   -0.98501035]
mat_Sqrt:  [[ 5.85590567  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01044529 -0.07649896  0.61364875]
Stock Position:  -0.010445289032049634
Bond Position:  [0.5394171]


portfolio before change:  [-0.52338864]
curr_Stock_Price:  101.76268055409379
curr_Factors:  [101.76268055  -1.88951675  -1.00569599]
mat_Sqrt:  [[ 5.62617996  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01100497 -0.05043075  0.13711588]
Stock Position:  -0.011004968792499998
Bond Position:  [0.59650648]


portfolio before change:  [-0.52159038]
curr_Stock_Price:  101.61282873497123
curr_Factors:  [101.61282873  -1.50041497  -0.98492084]
mat_Sqrt:  [[ 8.46410251  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00622233  0.01097104 -0.05268105]
Stock Position:  0.006222325791640638
Bond Position:  [-1.15385851]


portfolio before change:  [-0.52401648]
curr_Stock_Price:  101.26929213587681
curr_Factors:  [101.26929214  -1.46710954  -0.95616063]
mat_Sqrt:  [[ 8.97562931  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01333995  0.05656298 -0.28743595]
Stock Position:  -0.013339947666008545
Bond Position:  [0.82691058]


portfolio before change:  [-0.52733608]
curr_Stock_Price:  101.53363756087334
curr_Factors:  [101.53363756  -1.54848356  -0.95421622]
mat_Sqrt:  [[ 8.31191785  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00265078 -0.00588998  0.0702506 ]
Stock Position:  -0.0026507840073602285
Bond Position:  [-0.25819234]


portfolio before change:  [-0.52689409]
curr_Stock_Price:  101.34254318818547
curr_Factors:  [101.34254319  -1.28790247  -0.95843347]
mat_Sqrt:  [[10.72063471  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00409152  0.01501882 -0.03367515]
Stock Position:  0.0040915195029368545
Bond Position:  [-0.94153908]


portfolio before change:  [-0.52492657]
curr_Stock_Price:  101.88095824706946
curr_Factors:  [101.88095825  -0.88396545  -0.9634603 ]
mat_Sqrt:  [[16.06076439  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00482087  0.01589111 -0.04454038]
Stock Position:  0.004820871699725656
Bond Position:  [-1.0160816]


portfolio before change:  [-0.51944766]
curr_Stock_Price:  103.07015342396261
curr_Factors:  [103.07015342  -0.87528054  -0.94977012]
mat_Sqrt:  [[16.6158856   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0053334  -0.00352415 -0.39943195]
Stock Position:  0.005333400156966506
Bond Position:  [-1.06916203]


portfolio before change:  [-0.52081195]
curr_Stock_Price:  102.86447593848878
curr_Factors:  [102.86447594  -0.702756    -0.96061519]
mat_Sqrt:  [[19.49272197  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00079357 -0.00428503 -0.75225377]
Stock Position:  -0.0007935729015166549
Bond Position:  [-0.43918149]


portfolio before change:  [-0.52107581]
curr_Stock_Price:  103.05860102039735
curr_Factors:  [103.05860102  -0.67188078  -0.96217053]
mat_Sqrt:  [[20.11058829  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00453258  0.00940087 -0.10269791]
Stock Position:  -0.004532582360995708
Bond Position:  [-0.05395421]


portfolio before change:  [-0.51612044]
curr_Stock_Price:  101.96234743970972
curr_Factors:  [101.96234744  -0.57374599  -0.91758636]
mat_Sqrt:  [[22.9489288   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00248422  0.00650862  0.46967304]
Stock Position:  -0.002484218197853159
Bond Position:  [-0.26282372]


portfolio before change:  [-0.5195782]
curr_Stock_Price:  103.32778794119619
curr_Factors:  [103.32778794  -0.95762835  -0.87682219]
mat_Sqrt:  [[16.50157458  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00168083 -0.03869133  0.41219475]
Stock Position:  -0.0016808265139338415
Bond Position:  [-0.34590212]


portfolio before change:  [-0.51879064]
curr_Stock_Price:  102.80777789870123
curr_Factors:  [102.8077779   -0.83541091  -0.83020356]
mat_Sqrt:  [[19.43832312  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00051171 0.00927168 0.46178328]
Stock Position:  0.0005117083636686045
Bond Position:  [-0.57139824]


portfolio before change:  [-0.51953225]
curr_Stock_Price:  101.63769591509343
curr_Factors:  [101.63769592  -0.66242928  -0.8008242 ]
mat_Sqrt:  [[23.52728963  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00142306  0.01780735 -0.25739622]
Stock Position:  -0.0014230631745111434
Bond Position:  [-0.37489539]


portfolio before change:  [-0.51978402]
curr_Stock_Price:  101.74874409631231
curr_Factors:  [101.7487441   -0.79599357  -0.79711326]
mat_Sqrt:  [[20.68481083  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01795105 -0.27260482 -0.41922344]
Stock Position:  -0.017951052332081004
Bond Position:  [1.30671301]


portfolio before change:  [-0.4975374]
curr_Stock_Price:  100.52765143632934
curr_Factors:  [100.52765144  -0.50205161  -0.77930591]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-0.4975374]
Stock Price:  101.16059690043394
PL:  [-1.6581343]
Settle:  Tensor("sub_132:0", shape=(), dtype=float64)
PL:  Tensor("sub_133:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  67
output_Z_Vals[:, i, :]:  [[ 1.19251512e+02 -2.92846752e+01 -2.92776944e+01]
 [ 6.96708684e-02 -2.25976514e-02  3.90280978e-02]
 [-4.40669168e-01 -7.39451079e-02  3.02042930e-01]
 [-5.78051994e-02 -8.93014680e-02 -2.93784937e-01]
 [-9.88296441e-02 -2.41910939e-01  2.15109929e-01]
 [-9.28219312e-02  5.88681904e-02 -1.53086223e-02]
 [-1.67897334e-01 -1.53199718e-01  1.26570890e-01]
 [ 1.35152833e-02 -2.83869399e-02 -7.70081527e-02]
 [-3.90850123e-01 -2.33562788e-01  5.16517816e-01]
 [ 5.13149701e-03 -6.68199784e-03  1.53811465e-02]
 [ 3.57215585e-02  8.42032611e-02 -1.21946714e-02]
 [ 2.67875946e-01 -1.55546230e-02 -2.04965919e-01]
 [-4.65047285e-03 -2.05852912e-01 -5.30571544e-01]
 [-8.25117303e-02  3.03665282e-02 -3.13385085e-02]
 [-1.05206659e-01  4.80201147e-02  2.18840769e-01]
 [-8.84118811e-02 -1.70655454e-01  1.70091732e-01]
 [-8.29781861e-02 -2.48574184e-01  2.21945553e-01]
 [-5.02415754e-01  7.30999822e-01 -9.12994936e-02]
 [-3.16787937e-01 -1.29248258e+00 -3.02197559e-01]
 [ 2.29517842e-01 -1.73433149e-01 -3.30714267e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.25151208 -29.28467519 -29.2776944 ]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  8.31409947  -9.26062741 -83.52111278]
init_Out:  [2.49223638]
Stock Position:  8.314099471154409
Bond position:  [-828.91771073]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [6.48404559]
curr_Stock_Price:  100.50505344020628
curr_Factors:  [100.50505344  -0.7871066   -1.03775426]
mat_Sqrt:  [[16.20544263  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00475482 -0.007146    0.1113363 ]
Stock Position:  0.004754820860708041
Bond Position:  [6.00616207]


portfolio before change:  [6.49167615]
curr_Stock_Price:  101.79402461662406
curr_Factors:  [101.79402462  -0.74214036  -1.06215107]
mat_Sqrt:  [[16.75438442  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02273579 -0.0233835   0.86164441]
Stock Position:  -0.022735790132538954
Bond Position:  [8.80604373]


portfolio before change:  [6.51948485]
curr_Stock_Price:  100.66774234703155
curr_Factors:  [100.66774235  -0.4128332   -1.03764369]
mat_Sqrt:  [[23.6024029   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0050876  -0.0282396  -0.83808665]
Stock Position:  -0.005087598626590042
Bond Position:  [7.03164192]


portfolio before change:  [6.51977452]
curr_Stock_Price:  100.95637668914055
curr_Factors:  [100.95637669  -0.22058715  -1.04168801]
mat_Sqrt:  [[28.57160376  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00214082 -0.07649896  0.61364875]
Stock Position:  -0.0021408188273825605
Bond Position:  [6.73590384]


portfolio before change:  [6.52602778]
curr_Stock_Price:  98.82211655835673
curr_Factors:  [98.82211656 -0.17633886 -1.00914122]
mat_Sqrt:  [[30.19998253  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00312672  0.01861576 -0.04367124]
Stock Position:  -0.0031267177189313773
Bond Position:  [6.83501664]


portfolio before change:  [6.53340199]
curr_Stock_Price:  97.01023214089855
curr_Factors:  [97.01023214 -0.2131273  -0.96079687]
mat_Sqrt:  [[29.9908486   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00486871 -0.048446    0.36107152]
Stock Position:  -0.004868710474655439
Bond Position:  [7.00571673]


portfolio before change:  [6.54745758]
curr_Stock_Price:  94.48308789089438
curr_Factors:  [ 9.44830879e+01 -6.90119419e-02 -9.39671697e-01]
mat_Sqrt:  [[34.457863    0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-8.52312780e-05 -8.97673859e-03 -2.19682825e-01]
Stock Position:  -8.523127800809545e-05
Bond Position:  [6.55551049]


portfolio before change:  [6.54916571]
curr_Stock_Price:  93.67295042950224
curr_Factors:  [ 9.36729504e+01  7.55627414e-02 -9.57098698e-01]
mat_Sqrt:  [[38.79430697  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00751262 -0.07385904  1.47348156]
Stock Position:  -0.0075126211327057385
Bond Position:  [7.25289509]


portfolio before change:  [6.53636477]
curr_Stock_Price:  95.61826235199337
curr_Factors:  [ 9.56182624e+01  3.40534610e-02 -9.63700557e-01]
mat_Sqrt:  [[37.73985638  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00021459 -0.00211303  0.04387813]
Stock Position:  0.00021459095834132317
Bond Position:  [6.51584595]


portfolio before change:  [6.53884265]
curr_Stock_Price:  99.57332832556723
curr_Factors:  [99.57332833 -0.17504936 -0.97416253]
mat_Sqrt:  [[31.55343472  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00112211  0.02662741 -0.034788  ]
Stock Position:  0.0011221108187621
Bond Position:  [6.42711034]


portfolio before change:  [6.54315966]
curr_Stock_Price:  101.988440314769
curr_Factors:  [ 1.01988440e+02 -4.74812302e-02 -9.89745118e-01]
mat_Sqrt:  [[36.14841594  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00624193 -0.0049188  -0.58471072]
Stock Position:  0.006241928694094195
Bond Position:  [5.90655508]


portfolio before change:  [6.51869497]
curr_Stock_Price:  97.83243157153025
curr_Factors:  [ 9.78324316e+01  2.37899206e-02 -1.01510969e+00]
mat_Sqrt:  [[36.30430621  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00325769 -0.06509641 -1.51357293]
Stock Position:  -0.003257686137724157
Bond Position:  [6.83740232]


portfolio before change:  [6.51485353]
curr_Stock_Price:  99.53640144304096
curr_Factors:  [ 9.95364014e+01  5.76532274e-02 -1.02875637e+00]
mat_Sqrt:  [[37.6909599   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00233808  0.00960274 -0.08940004]
Stock Position:  -0.0023380836268182353
Bond Position:  [6.74757796]


portfolio before change:  [6.50759482]
curr_Stock_Price:  103.36253237695482
curr_Factors:  [103.36253238   0.23906738  -1.06765066]
mat_Sqrt:  [[45.1350567   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00131375  0.01518529  0.6242918 ]
Stock Position:  -0.0013137482039208396
Bond Position:  [6.64338717]


portfolio before change:  [6.50708118]
curr_Stock_Price:  105.01786909596423
curr_Factors:  [ 1.05017869e+02  2.27883871e-02 -1.09362939e+00]
mat_Sqrt:  [[35.9917417   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00161421 -0.05396599  0.48522437]
Stock Position:  -0.0016142135313809197
Bond Position:  [6.67660245]


portfolio before change:  [6.49998629]
curr_Stock_Price:  110.4472959741167
curr_Factors:  [ 1.10447296e+02  6.95664494e-03 -1.05300692e+00]
mat_Sqrt:  [[38.80263569  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00113631 -0.07860606  0.63314889]
Stock Position:  -0.0011363119244616347
Bond Position:  [6.62548887]


portfolio before change:  [6.497007]
curr_Stock_Price:  114.52704108177929
curr_Factors:  [114.52704108   0.13861023  -1.06833673]
mat_Sqrt:  [[45.19942933  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01111027  0.23116244 -0.26045204]
Stock Position:  -0.011110269707646057
Bond Position:  [7.76943332]


portfolio before change:  [6.46407205]
curr_Stock_Price:  117.66625843538442
curr_Factors:  [ 1.17666258e+02  1.08738901e-01 -1.03223919e+00]
mat_Sqrt:  [[46.72839519  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0088136  -0.40871888 -0.86208552]
Stock Position:  -0.008813602755396515
Bond Position:  [7.50113571]


portfolio before change:  [6.43297828]
curr_Stock_Price:  121.4069868171581
curr_Factors:  [ 1.21406987e+02 -1.25234313e-02 -1.04747516e+00]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [6.43297828]
Stock Price:  121.96517847719662
PL:  [-15.5322002]
Settle:  Tensor("sub_134:0", shape=(), dtype=float64)
PL:  Tensor("sub_135:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  68
output_Z_Vals[:, i, :]:  [[ 1.19251512e+02 -2.92846752e+01 -2.92776944e+01]
 [-2.53919704e-01  9.22270783e-02  2.28100354e-01]
 [-3.41718358e-01 -9.50249112e-02  2.98715877e-01]
 [-7.34624451e-02  3.72268747e-03 -4.29408345e-02]
 [-8.65923045e-02 -1.39651803e-01  1.11387576e-01]
 [-1.84939927e-01  1.02935299e-01 -8.35079404e-03]
 [ 5.47590452e-02  4.76894822e-02 -2.35635535e-02]
 [-1.01275658e-01  1.49870256e-01 -5.21933970e-02]
 [-3.52608359e-01 -1.86601584e-01  4.06208417e-01]
 [ 2.61243461e-02  1.77999246e-02  7.66308720e-03]
 [ 7.13182693e-02  6.00443580e-02 -7.79519205e-03]
 [ 3.44846222e-02 -1.02563095e-02 -1.42084418e-01]
 [ 1.97684515e-02 -1.17117562e-01 -4.56245135e-01]
 [-8.45720117e-02  2.97281712e-02 -3.59999752e-02]
 [-1.14365826e-01  6.09283807e-02  2.32050103e-01]
 [-1.61787507e-01 -3.02250293e-01  2.31302920e-01]
 [-8.09356734e-02 -2.40887466e-01  2.24782942e-01]
 [-4.86180415e-01  7.09936095e-01 -8.71679255e-02]
 [-3.04458656e-01 -1.24066109e+00 -2.54076134e-01]
 [ 1.78371140e-01 -1.30025553e-01 -2.51548883e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.25151208 -29.28467519 -29.2776944 ]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  8.31409947  -9.26062741 -83.52111278]
init_Out:  [2.49223638]
Stock Position:  8.314099471154409
Bond position:  [-828.91771073]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-11.08343198]
curr_Stock_Price:  98.3920792528884
curr_Factors:  [98.39207925 -0.73271084 -0.99971017]
mat_Sqrt:  [[17.40120219  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01177951  0.02916476  0.65070682]
Stock Position:  -0.011779509168537846
Bond Position:  [-9.92442158]


portfolio before change:  [-11.06986448]
curr_Stock_Price:  97.02963546433473
curr_Factors:  [97.02963546 -0.4100141  -1.0068232 ]
mat_Sqrt:  [[23.52771641  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01203673 -0.03004952  0.85215325]
Stock Position:  -0.0120367298935415
Bond Position:  [-9.90194496]


portfolio before change:  [-11.06714028]
curr_Stock_Price:  96.59762503988789
curr_Factors:  [96.59762504 -0.34028916 -0.99632138]
mat_Sqrt:  [[25.37954684  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00323613  0.00117722 -0.12249825]
Stock Position:  -0.003236132912073201
Bond Position:  [-10.75453753]


portfolio before change:  [-11.06662761]
curr_Stock_Price:  95.60828466436939
curr_Factors:  [95.60828466 -0.10792533 -1.01401479]
mat_Sqrt:  [[31.13458826  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00216676 -0.04416178  0.31775775]
Stock Position:  -0.002166760779680646
Bond Position:  [-10.85946733]


portfolio before change:  [-11.07241081]
curr_Stock_Price:  97.02421813409359
curr_Factors:  [ 9.70242181e+01  4.95777742e-02 -1.03486829e+00]
mat_Sqrt:  [[36.22212431  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0050794   0.032551   -0.02382249]
Stock Position:  -0.005079402479553898
Bond Position:  [-10.57958576]


portfolio before change:  [-11.09710838]
curr_Stock_Price:  101.36574027932186
curr_Factors:  [101.36574028  -0.16964658  -1.02221496]
mat_Sqrt:  [[30.78026171  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00166277  0.01508074 -0.06722026]
Stock Position:  0.0016627698799517301
Bond Position:  [-11.26565628]


portfolio before change:  [-11.10241692]
curr_Stock_Price:  99.867167622078
curr_Factors:  [99.86716762  0.15091575 -1.0092824 ]
mat_Sqrt:  [[42.3290803   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00255285  0.04739314 -0.14889323]
Stock Position:  -0.0025528538758264555
Bond Position:  [-10.84747064]


portfolio before change:  [-11.09582977]
curr_Stock_Price:  96.22443543909537
curr_Factors:  [96.22443544 -0.14061799 -1.04878351]
mat_Sqrt:  [[29.29104493  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00937179 -0.0590086   1.15879955]
Stock Position:  -0.009371787369729406
Bond Position:  [-10.19403482]


portfolio before change:  [-11.10029393]
curr_Stock_Price:  96.4288077319838
curr_Factors:  [ 9.64288077e+01 -1.86098401e-02 -1.03507350e+00]
mat_Sqrt:  [[33.62001749  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00083724 0.00562883 0.02186065]
Stock Position:  0.0008372440422935702
Bond Position:  [-11.18102837]


portfolio before change:  [-11.10179493]
curr_Stock_Price:  97.97507443669625
curr_Factors:  [97.97507444 -0.14070384 -1.06224166]
mat_Sqrt:  [[29.42273279  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00242253  0.01898769 -0.02223751]
Stock Position:  0.002422528918131539
Bond Position:  [-11.33914238]


portfolio before change:  [-11.10888205]
curr_Stock_Price:  96.21989380795647
curr_Factors:  [ 9.62198938e+01 -8.58736179e-02 -1.03352663e+00]
mat_Sqrt:  [[31.41344191  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 1.66073652e-04 -3.24332985e-03 -4.05327296e-01]
Stock Position:  0.00016607365246700475
Bond Position:  [-11.12486164]


portfolio before change:  [-11.11123135]
curr_Stock_Price:  98.82269538714559
curr_Factors:  [98.82269539 -0.38921345 -1.00605821]
mat_Sqrt:  [[24.48487599  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00311973 -0.03703582 -1.30154038]
Stock Position:  -0.003119728245283565
Bond Position:  [-10.8029314]


portfolio before change:  [-11.12366766]
curr_Stock_Price:  101.94323581508415
curr_Factors:  [101.94323582  -0.47607125  -1.02873368]
mat_Sqrt:  [[22.63757682  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00402662  0.00940087 -0.10269791]
Stock Position:  -0.004026619036769918
Bond Position:  [-10.71318109]


portfolio before change:  [-11.13362271]
curr_Stock_Price:  103.75031559606816
curr_Factors:  [103.7503156   -0.31366277  -1.04242798]
mat_Sqrt:  [[26.73293851  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00244738  0.01926725  0.66197435]
Stock Position:  -0.002447379043266901
Bond Position:  [-10.87970637]


portfolio before change:  [-11.14668312]
curr_Stock_Price:  107.9753014813931
curr_Factors:  [ 1.07975301e+02  8.99984376e-02 -1.03126462e+00]
mat_Sqrt:  [[42.12478677  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00290511 -0.09557993  0.65984285]
Stock Position:  -0.0029051082349039166
Bond Position:  [-10.83300319]


portfolio before change:  [-11.15596726]
curr_Stock_Price:  110.23874481280674
curr_Factors:  [ 1.10238745e+02 -7.91850252e-03 -1.01278007e+00]
mat_Sqrt:  [[39.72377404  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00103897 -0.07617531  0.64124317]
Stock Position:  -0.0010389681247026715
Bond Position:  [-11.04143272]


portfolio before change:  [-11.1629016]
curr_Stock_Price:  114.25584317822212
curr_Factors:  [ 1.14255843e+02 -9.33908227e-02 -1.02370659e+00]
mat_Sqrt:  [[37.38773682  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01298937  0.22450151 -0.24866583]
Stock Position:  -0.012989366650719498
Bond Position:  [-9.67879056]


portfolio before change:  [-11.19473125]
curr_Stock_Price:  116.51997612293233
curr_Factors:  [116.51997612  -0.25823411  -1.07624336]
mat_Sqrt:  [[30.67921079  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01265859 -0.39233149 -0.72480849]
Stock Position:  -0.012658587076674555
Bond Position:  [-9.71975299]


portfolio before change:  [-11.16977781]
curr_Stock_Price:  114.35672615711428
curr_Factors:  [ 1.14356726e+02  1.13238055e-01 -1.06737220e+00]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-11.16977781]
Stock Price:  114.5258868716905
PL:  [-25.69566468]
Settle:  Tensor("sub_136:0", shape=(), dtype=float64)
PL:  Tensor("sub_137:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  69
output_Z_Vals[:, i, :]:  [[ 1.19251512e+02 -2.92846752e+01 -2.92776944e+01]
 [-1.32664579e-01  1.45478449e-02 -1.23110628e-01]
 [-1.41657396e-01  1.58473851e-03  1.30466052e-01]
 [-5.09402711e-02 -5.99888034e-02 -2.10961103e-01]
 [-9.88296441e-02 -2.41910939e-01  2.15109929e-01]
 [-4.67406090e-02 -2.45605421e-03 -2.35577833e-02]
 [-7.67925973e-02 -4.29363020e-02  4.98422633e-02]
 [-7.00235098e-02  1.25535538e-01 -1.02640213e-01]
 [-7.10587988e-02 -4.02958381e-02  7.40416640e-02]
 [ 4.50470017e-02  4.74936917e-02 -1.18045691e-02]
 [ 2.66997686e-02  8.86739400e-02 -1.20391853e-02]
 [ 2.22902463e-02 -8.71259063e-03 -1.03887759e-01]
 [ 5.52530860e-02 -7.16812320e-03 -2.50167385e-01]
 [-8.28851728e-02  3.02508209e-02 -3.21834366e-02]
 [-2.78778008e-02 -4.15213435e-02  3.61178894e-02]
 [-1.85715359e-02 -5.38649452e-02  1.13771302e-01]
 [-2.53776541e-02  7.82110878e-02  1.05658675e-01]
 [ 9.73205993e-03  2.23058939e-02 -8.34110052e-02]
 [-3.56560386e-01 -9.36146771e-01 -1.87780490e-01]
 [ 6.69637769e-02 -2.24763993e-02 -6.63562535e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.25151208 -29.28467519 -29.2776944 ]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  8.31409947  -9.26062741 -83.52111278]
init_Out:  [2.49223638]
Stock Position:  8.314099471154409
Bond position:  [-828.91771073]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [1.00929413]
curr_Stock_Price:  99.84656342805926
curr_Factors:  [99.84656343 -0.9392417  -1.00185741]
mat_Sqrt:  [[14.33258384  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01098328  0.00460043 -0.35120035]
Stock Position:  -0.010983281786549446
Bond Position:  [2.10593707]


portfolio before change:  [1.01039559]
curr_Stock_Price:  99.79421966028846
curr_Factors:  [99.79421966 -0.8209339  -1.019299  ]
mat_Sqrt:  [[15.84537023  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00725671  0.00050114  0.37218333]
Stock Position:  -0.007256706834323655
Bond Position:  [1.73457298]


portfolio before change:  [1.00624956]
curr_Stock_Price:  100.42532202372685
curr_Factors:  [100.42532202  -0.64855675  -1.03699967]
mat_Sqrt:  [[18.61295735  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0051336  -0.01897013 -0.60181331]
Stock Position:  -0.005133597444869572
Bond Position:  [1.52179274]


portfolio before change:  [0.99824684]
curr_Stock_Price:  102.05833171219265
curr_Factors:  [102.05833171  -0.77963607  -1.08034819]
mat_Sqrt:  [[15.88793907  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00384988 -0.07649896  0.61364875]
Stock Position:  -0.0038498780095977646
Bond Position:  [1.39115897]


portfolio before change:  [1.0075529]
curr_Stock_Price:  99.73144549699506
curr_Factors:  [99.7314455  -0.38567825 -1.04802663]
mat_Sqrt:  [[23.77836513  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00217058 -0.00077667 -0.0672038 ]
Stock Position:  -0.0021705754857360314
Bond Position:  [1.22402753]


portfolio before change:  [1.01039063]
curr_Stock_Price:  98.56508256438822
curr_Factors:  [98.56508256 -0.61787669 -0.98929635]
mat_Sqrt:  [[19.75771452  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00342789 -0.01357765  0.1421861 ]
Stock Position:  -0.003427886275040282
Bond Position:  [1.34826052]


portfolio before change:  [1.00854982]
curr_Stock_Price:  99.2004343313763
curr_Factors:  [99.20043433 -1.06066146 -1.00107538]
mat_Sqrt:  [[12.62154852  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00695109  0.03969782 -0.29280396]
Stock Position:  -0.006951091759584458
Bond Position:  [1.69810114]


portfolio before change:  [0.99508101]
curr_Stock_Price:  101.1991691942362
curr_Factors:  [101.19916919  -1.22660969  -1.02677355]
mat_Sqrt:  [[10.63028818  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00536068 -0.01274266  0.21122026]
Stock Position:  -0.005360677013563557
Bond Position:  [1.53757707]


portfolio before change:  [1.00395482]
curr_Stock_Price:  99.61553203653672
curr_Factors:  [99.61553204 -0.89291207 -1.06814076]
mat_Sqrt:  [[14.01692129  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00312934  0.01501882 -0.03367515]
Stock Position:  0.0031293381118834055
Bond Position:  [0.69222414]


portfolio before change:  [1.00612337]
curr_Stock_Price:  100.25319895678952
curr_Factors:  [100.25319896  -0.99107639  -1.07091362]
mat_Sqrt:  [[12.7522659   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00208056  0.02804116 -0.03434444]
Stock Position:  0.0020805582091184905
Bond Position:  [0.79754075]


portfolio before change:  [1.00443657]
curr_Stock_Price:  99.34661023815887
curr_Factors:  [99.34661024 -1.25139837 -1.07100528]
mat_Sqrt:  [[ 9.73970859  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 8.82252557e-05 -2.75516307e-03 -2.96362858e-01]
Stock Position:  8.822525567844721e-05
Bond Position:  [0.99567169]


portfolio before change:  [1.00472782]
curr_Stock_Price:  99.82608232262415
curr_Factors:  [99.82608232 -1.36527381 -1.09240015]
mat_Sqrt:  [[ 8.5484975   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 4.68246294e-04 -2.26675959e-03 -7.13657916e-01]
Stock Position:  0.00046824629378837526
Bond Position:  [0.95798463]


portfolio before change:  [1.00522524]
curr_Stock_Price:  100.37684539521668
curr_Factors:  [100.3768454   -1.42323116  -1.11849151]
mat_Sqrt:  [[ 7.90273488  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01122061  0.00956615 -0.09181039]
Stock Position:  -0.011220611317049904
Bond Position:  [2.13151481]


portfolio before change:  [1.00276636]
curr_Stock_Price:  100.6434814916522
curr_Factors:  [100.64348149  -1.26761207  -1.10928994]
mat_Sqrt:  [[ 9.34351365  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00230934 -0.0131302   0.10303429]
Stock Position:  -0.002309339374046061
Bond Position:  [1.23518632]


portfolio before change:  [1.00097738]
curr_Stock_Price:  101.5518895793805
curr_Factors:  [101.55188958  -1.26293241  -1.12730919]
mat_Sqrt:  [[ 9.30291965  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00035055 -0.01703359  0.32455786]
Stock Position:  0.00035055090954744684
Bond Position:  [0.96537827]


portfolio before change:  [1.00103291]
curr_Stock_Price:  101.02174936722777
curr_Factors:  [101.02174937  -0.74634189  -1.09424689]
mat_Sqrt:  [[16.03457056  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-1.11681547e-04  2.47325176e-02  3.01414791e-01]
Stock Position:  -0.00011168154709811363
Bond Position:  [1.01231518]


portfolio before change:  [1.00128415]
curr_Stock_Price:  101.03847229295107
curr_Factors:  [101.03847229  -0.95326601  -1.10128949]
mat_Sqrt:  [[12.94805847  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00051886  0.00705374 -0.23794838]
Stock Position:  -0.0005188580605916259
Bond Position:  [1.05370878]


portfolio before change:  [1.00160361]
curr_Stock_Price:  100.93055227030513
curr_Factors:  [100.93055227  -0.67104705  -1.06509011]
mat_Sqrt:  [[17.78393498  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02356408 -0.2960356  -0.53568547]
Stock Position:  -0.023564083194849237
Bond Position:  [3.37993954]


portfolio before change:  [0.96745152]
curr_Stock_Price:  102.41574407773672
curr_Factors:  [102.41574408  -0.96515097  -1.09461363]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [0.96745152]
Stock Price:  101.60127374135803
PL:  [-0.63382222]
Settle:  Tensor("sub_138:0", shape=(), dtype=float64)
PL:  Tensor("sub_139:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  70
output_Z_Vals[:, i, :]:  [[ 1.19251512e+02 -2.92846752e+01 -2.92776944e+01]
 [-5.33645921e-02 -1.16626924e-01 -3.91476197e-01]
 [-6.34702634e-01 -1.15933613e-01  4.68937662e-01]
 [-2.84626364e-02 -1.57930723e-01 -4.97841434e-01]
 [-9.88296441e-02 -2.41910939e-01  2.15109929e-01]
 [-2.26756104e-01 -1.03395918e-02  2.01198218e-02]
 [ 5.42042795e-02  5.69194187e-02 -2.71832294e-02]
 [-1.30419349e-01  2.08248273e-01 -8.52862213e-02]
 [-5.25006922e-04 -6.42708307e-03 -2.85095140e-03]
 [ 3.78450696e-02  3.57720412e-02 -1.00614315e-02]
 [ 1.47476370e-01 -1.75577769e-02 -4.05560367e-02]
 [ 1.69662400e-02 -8.19642866e-03 -9.66055446e-02]
 [ 5.51029959e-02 -4.05520621e-03 -8.78954131e-02]
 [-8.45720117e-02  2.97281712e-02 -3.59999752e-02]
 [-1.32871673e-01  8.70091769e-02  2.58739198e-01]
 [-1.33003180e-01 -2.54566329e-01  2.08194123e-01]
 [-5.28834565e-02 -1.13509398e-01  2.54466741e-01]
 [-2.28255293e-01  3.56096693e-01 -7.46992527e-02]
 [-2.97249288e-01 -1.01627379e+00 -1.38614275e-01]
 [ 1.05613884e-01 -5.08740193e-02 -1.21857642e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.25151208 -29.28467519 -29.2776944 ]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  8.31409947  -9.26062741 -83.52111278]
init_Out:  [2.49223638]
Stock Position:  8.314099471154409
Bond position:  [-828.91771073]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [23.81785133]
curr_Stock_Price:  102.58992213753366
curr_Factors:  [102.58992214  -0.8392562   -0.98097672]
mat_Sqrt:  [[16.61833797  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00820092 -0.03688067 -1.11677262]
Stock Position:  -0.00820091820673203
Bond Position:  [24.65918289]


portfolio before change:  [23.81952403]
curr_Stock_Price:  103.13777096192277
curr_Factors:  [103.13777096  -0.77319779  -1.03249621]
mat_Sqrt:  [[16.95176018  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.03197158 -0.03666143  1.33774862]
Stock Position:  -0.031971578301106696
Bond Position:  [27.11700135]


portfolio before change:  [23.84958545]
curr_Stock_Price:  102.40958289754523
curr_Factors:  [102.4095829   -1.12455514  -1.02364163]
mat_Sqrt:  [[11.95062428  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01122635 -0.04994208 -1.42020304]
Stock Position:  -0.011226346353749247
Bond Position:  [24.9992709]


portfolio before change:  [23.85631205]
curr_Stock_Price:  102.36718200749387
curr_Factors:  [102.36718201  -1.03821636  -1.04304434]
mat_Sqrt:  [[12.77264118  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00478888 -0.07649896  0.61364875]
Stock Position:  -0.0047888785415269265
Bond Position:  [24.34653606]


portfolio before change:  [23.86134412]
curr_Stock_Price:  102.5875523254797
curr_Factors:  [102.58755233  -1.13427982  -1.07842688]
mat_Sqrt:  [[11.22350118  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01986155 -0.00326967  0.05739625]
Stock Position:  -0.01986154995399906
Bond Position:  [25.89889192]


portfolio before change:  [23.87237765]
curr_Stock_Price:  102.35806389203668
curr_Factors:  [102.35806389  -1.22752919  -1.07751656]
mat_Sqrt:  [[10.21065056  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00490911  0.0179995  -0.07754619]
Stock Position:  0.004909107288223923
Bond Position:  [23.36989093]


portfolio before change:  [23.87820426]
curr_Stock_Price:  102.35468425906993
curr_Factors:  [102.35468426  -1.28663701  -1.07513584]
mat_Sqrt:  [[ 9.64723387  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01476603  0.06585389 -0.24329785]
Stock Position:  -0.014766033545508806
Bond Position:  [25.38957696]


portfolio before change:  [23.88130445]
curr_Stock_Price:  102.5746488004753
curr_Factors:  [102.5746488   -1.24530936  -1.0522562 ]
mat_Sqrt:  [[10.30908197  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00012347 -0.00203242 -0.00813297]
Stock Position:  -0.0001234737985332339
Bond Position:  [23.89396973]


portfolio before change:  [23.88717509]
curr_Stock_Price:  103.41365989641886
curr_Factors:  [103.4136599   -1.44788385  -1.08590794]
mat_Sqrt:  [[ 8.20665387  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0044738   0.01131211 -0.02870246]
Stock Position:  0.004473798851485309
Bond Position:  [23.42452318]


portfolio before change:  [23.89565415]
curr_Stock_Price:  103.99978389841404
curr_Factors:  [103.9997839   -1.61446439  -1.09471782]
mat_Sqrt:  [[ 6.92547476  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.02003394 -0.00555226 -0.11569508]
Stock Position:  0.020033942607532395
Bond Position:  [21.81212845]


portfolio before change:  [23.89796361]
curr_Stock_Price:  103.84283733828546
curr_Factors:  [103.84283734  -1.43810278  -1.11430698]
mat_Sqrt:  [[ 8.08870639  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00036655 -0.00259194 -0.27558873]
Stock Position:  -0.0003665499705555177
Bond Position:  [23.9360272]


portfolio before change:  [23.90378427]
curr_Stock_Price:  104.29051420911875
curr_Factors:  [104.29051421  -1.60157564  -1.09634714]
mat_Sqrt:  [[ 7.02347164  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00527613 -0.00128237 -0.25074115]
Stock Position:  0.00527612507884639
Bond Position:  [23.35353447]


portfolio before change:  [23.9075549]
curr_Stock_Price:  103.89846957138121
curr_Factors:  [103.89846957  -1.70124586  -1.06170899]
mat_Sqrt:  [[ 6.55651572  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01390264  0.00940087 -0.10269791]
Stock Position:  -0.013902643068652229
Bond Position:  [25.35201824]


portfolio before change:  [23.90037393]
curr_Stock_Price:  104.87093007159953
curr_Factors:  [104.87093007  -1.28428192  -1.0789152 ]
mat_Sqrt:  [[ 9.87032947  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00788324  0.02751472  0.73811091]
Stock Position:  -0.007883241184242036
Bond Position:  [24.72709677]


portfolio before change:  [23.89621202]
curr_Stock_Price:  106.1831390523186
curr_Factors:  [106.18313905  -0.95014648  -1.13831246]
mat_Sqrt:  [[13.15374336  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0073803  -0.08050094  0.59391988]
Stock Position:  -0.007380302674055514
Bond Position:  [24.67987572]


portfolio before change:  [23.88791005]
curr_Stock_Price:  108.14413051182181
curr_Factors:  [108.14413051  -1.06545263  -1.07960563]
mat_Sqrt:  [[12.65948348  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-3.05814256e-04 -3.58948232e-02  7.25922783e-01]
Stock Position:  -0.0003058142562208584
Bond Position:  [23.92098206]


portfolio before change:  [23.89384373]
curr_Stock_Price:  108.29883326328985
curr_Factors:  [108.29883326  -1.31944231  -1.08565583]
mat_Sqrt:  [[ 9.77468858  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02397098  0.11260766 -0.21309618]
Stock Position:  -0.023970977167524554
Bond Position:  [26.48987259]


portfolio before change:  [23.89230538]
curr_Stock_Price:  108.63931367162813
curr_Factors:  [108.63931367  -1.06401335  -1.07937078]
mat_Sqrt:  [[12.73875879  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02761524 -0.32137399 -0.39542794]
Stock Position:  -0.02761524026191689
Bond Position:  [26.89240613]


portfolio before change:  [23.88869267]
curr_Stock_Price:  109.01362322592591
curr_Factors:  [109.01362323  -1.04610349  -1.0529177 ]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [23.88869267]
Stock Price:  109.50378682437739
PL:  [14.38490585]
Settle:  Tensor("sub_140:0", shape=(), dtype=float64)
PL:  Tensor("sub_141:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  71
output_Z_Vals[:, i, :]:  [[ 1.19251512e+02 -2.92846752e+01 -2.92776944e+01]
 [-1.59025550e-01  4.06371461e-02  1.20736905e-02]
 [-1.98786370e-01 -1.39296989e-02  1.54675505e-01]
 [-2.21138324e-02  2.74346777e-02  3.51712089e-02]
 [-9.88296441e-02 -2.41910939e-01  2.15109929e-01]
 [-3.79409782e-02 -1.34996786e-01  1.94174874e-02]
 [ 5.85278993e-02  2.83289037e-02 -1.52803235e-02]
 [-7.41758389e-02  1.33024507e-01 -1.03356113e-01]
 [-1.19263369e-01 -6.23055564e-02  1.23597556e-01]
 [ 4.62249755e-02  4.80706045e-02 -1.15803669e-02]
 [ 2.69375947e-02  8.85560871e-02 -1.20432841e-02]
 [ 1.00627203e-01 -1.06498755e-02 -1.32736205e-01]
 [ 4.14117847e-02 -4.38052408e-02 -3.63215427e-01]
 [-5.01565771e-02  1.90639926e-02 -2.39020968e-02]
 [ 1.11348156e-02 -5.79141975e-02 -1.09473076e-01]
 [ 1.74344959e-01  4.31242822e-02 -1.11847550e-01]
 [-2.35647895e-02  1.03259148e-01  6.82888801e-02]
 [ 4.11830639e-02 -1.96298037e-02  3.13190224e-02]
 [-3.71053799e-01 -9.34832876e-01 -2.09687440e-01]
 [ 1.05499878e-01 -1.07417114e-01 -1.77258438e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.25151208 -29.28467519 -29.2776944 ]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  8.31409947  -9.26062741 -83.52111278]
init_Out:  [2.49223638]
Stock Position:  8.314099471154409
Bond position:  [-828.91771073]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-1.64000323]
curr_Stock_Price:  99.52791227818184
curr_Factors:  [99.52791228 -1.13539495 -1.01488965]
mat_Sqrt:  [[11.59012601  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01341761  0.01285059  0.03444288]
Stock Position:  -0.013417608384199016
Bond Position:  [-0.30457668]


portfolio before change:  [-1.6463575]
curr_Stock_Price:  99.99581411083624
curr_Factors:  [99.99581411 -1.03461947 -0.99855253]
mat_Sqrt:  [[13.09141048  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01280023 -0.00440496  0.44124616]
Stock Position:  -0.01280022715489034
Bond Position:  [-0.36638837]


portfolio before change:  [-1.63942631]
curr_Stock_Price:  99.44716766123949
curr_Factors:  [99.44716766 -1.15217775 -1.02815226]
mat_Sqrt:  [[11.23795082  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00126591  0.00867561  0.10033367]
Stock Position:  -0.001265905088841203
Bond Position:  [-1.51353564]


portfolio before change:  [-1.64205322]
curr_Stock_Price:  101.22334770509367
curr_Factors:  [101.22334771  -1.07151304  -1.02975412]
mat_Sqrt:  [[12.3797526   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00494086 -0.07649896  0.61364875]
Stock Position:  -0.004940860229751532
Bond Position:  [-1.14192281]


portfolio before change:  [-1.63972701]
curr_Stock_Price:  100.69475089262941
curr_Factors:  [100.69475089  -0.90871811  -1.03473942]
mat_Sqrt:  [[14.42028846  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00259794 -0.04268973  0.05539269]
Stock Position:  -0.0025979370872669105
Bond Position:  [-1.37812839]


portfolio before change:  [-1.63866517]
curr_Stock_Price:  100.15339130820247
curr_Factors:  [100.15339131  -1.14640471  -1.01109367]
mat_Sqrt:  [[11.5791323   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0048484   0.00895839 -0.04359051]
Stock Position:  0.004848400037328778
Bond Position:  [-2.12424888]


portfolio before change:  [-1.64255162]
curr_Stock_Price:  99.46134469640404
curr_Factors:  [99.4613447  -1.13302534 -1.01385554]
mat_Sqrt:  [[11.62186444  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00790223  0.04206604 -0.29484622]
Stock Position:  -0.0079022294293168
Bond Position:  [-0.85658525]


portfolio before change:  [-1.64699724]
curr_Stock_Price:  99.99681955108991
curr_Factors:  [99.99681955 -1.37499491 -1.03446672]
mat_Sqrt:  [[ 8.98608033  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01064344 -0.01970275  0.35258942]
Stock Position:  -0.010643444340679162
Bond Position:  [-0.58268665]


portfolio before change:  [-1.64542255]
curr_Stock_Price:  99.8351826683667
curr_Factors:  [99.83518267 -1.5786517  -1.03943144]
mat_Sqrt:  [[ 7.28223273  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00619347  0.01520126 -0.03303556]
Stock Position:  0.006193474219499082
Bond Position:  [-2.26374918]


portfolio before change:  [-1.64553364]
curr_Stock_Price:  99.90863414808545
curr_Factors:  [99.90863415 -1.360808   -1.029389  ]
mat_Sqrt:  [[ 9.15279322  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00292433  0.02800389 -0.03435614]
Stock Position:  0.0029243289262511018
Bond Position:  [-1.93769935]


portfolio before change:  [-1.64675323]
curr_Stock_Price:  99.65725793935593
curr_Factors:  [99.65725794 -0.70657455 -1.08241618]
mat_Sqrt:  [[16.65559412  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00439838 -0.00336779 -0.37865945]
Stock Position:  0.0043983756890526825
Bond Position:  [-2.08508329]


portfolio before change:  [-1.64801126]
curr_Stock_Price:  99.48976573049842
curr_Factors:  [99.48976573 -0.8603971  -1.05748105]
mat_Sqrt:  [[14.61687413  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00231652 -0.01385243 -1.03615251]
Stock Position:  -0.0023165212985106318
Bond Position:  [-1.4175411]


portfolio before change:  [-1.645433]
curr_Stock_Price:  98.22377502417098
curr_Factors:  [98.22377502 -0.50564838 -1.01642257]
mat_Sqrt:  [[21.43826355  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00254421  0.00602856 -0.06818603]
Stock Position:  -0.0025442052184636104
Bond Position:  [-1.39553156]


portfolio before change:  [-1.64179118]
curr_Stock_Price:  96.6552139983025
curr_Factors:  [96.655214   -0.4183944  -1.05489286]
mat_Sqrt:  [[22.15056242  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00057365 -0.01831408 -0.31229621]
Stock Position:  -0.000573647766639628
Bond Position:  [-1.58634514]


portfolio before change:  [-1.6414028]
curr_Stock_Price:  95.28674452012669
curr_Factors:  [95.28674452 -0.40955366 -1.06538583]
mat_Sqrt:  [[21.80089924  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00700098  0.0136371  -0.31906993]
Stock Position:  0.007000979013801721
Bond Position:  [-2.3085033]


portfolio before change:  [-1.63134252]
curr_Stock_Price:  96.80617146342746
curr_Factors:  [96.80617146 -0.72416908 -1.07966877]
mat_Sqrt:  [[15.94065722  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00043657  0.03265341  0.19480917]
Stock Position:  -0.0004365717427576451
Bond Position:  [-1.58907968]


portfolio before change:  [-1.63182718]
curr_Stock_Price:  97.00623701585775
curr_Factors:  [97.00623702 -0.49092176 -1.08305063]
mat_Sqrt:  [[20.10166974  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00234156 -0.00620749  0.08934445]
Stock Position:  0.002341556388726172
Bond Position:  [-1.85897276]


portfolio before change:  [-1.63323443]
curr_Stock_Price:  96.6037517745633
curr_Factors:  [96.60375177 -0.40385244 -1.09468498]
mat_Sqrt:  [[21.58675979  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02028991 -0.29562011 -0.5981799 ]
Stock Position:  -0.02028990703693423
Bond Position:  [0.32684672]


portfolio before change:  [-1.66181032]
curr_Stock_Price:  98.01615917057558
curr_Factors:  [98.01615917 -0.29395566 -1.10158521]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-1.66181032]
Stock Price:  98.04029765627591
PL:  [-1.66181032]
Settle:  Tensor("sub_142:0", shape=(), dtype=float64)
PL:  Tensor("sub_143:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  72
output_Z_Vals[:, i, :]:  [[ 1.19251512e+02 -2.92846752e+01 -2.92776944e+01]
 [-8.10934315e-02  7.14840185e-03 -8.62057502e-02]
 [-2.42799574e-01 -2.58823044e-02  1.73326909e-01]
 [-3.86260136e-02 -6.99909151e-03 -6.09017183e-02]
 [-8.94355529e-02 -1.63410899e-01  1.35486639e-01]
 [ 9.16066978e-03 -1.15786937e-01  8.04356184e-03]
 [ 5.57287366e-02  3.15562017e-02 -1.72366145e-02]
 [-1.25757765e-01  1.95098693e-01 -7.31678532e-02]
 [-2.46714257e-02  3.30885061e-03 -3.19029080e-02]
 [ 2.64726774e-02  3.51585019e-02 -1.23657774e-02]
 [ 2.08078148e-01 -8.46044538e-02 -7.18570151e-02]
 [-1.11094258e-01  3.25078947e-02  1.67007019e-02]
 [ 4.33967090e-02 -1.03300803e-02 -1.87564053e-01]
 [-6.97188364e-02  2.08079203e-02 -3.21729058e-02]
 [-1.68016675e-01  1.36539991e-01  3.09425251e-01]
 [-1.50653995e-01 -2.91151363e-01  2.24049477e-01]
 [-4.13451458e-02 -7.37940374e-02  2.63776209e-01]
 [-1.90526602e-01  3.00621725e-01 -8.31620872e-02]
 [-2.73190872e-01 -9.27720768e-01 -7.34717646e-02]
 [ 8.48792133e-02 -3.05152192e-02 -8.70545845e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.25151208 -29.28467519 -29.2776944 ]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  8.31409947  -9.26062741 -83.52111278]
init_Out:  [2.49223638]
Stock Position:  8.314099471154409
Bond position:  [-828.91771073]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [3.09273214]
curr_Stock_Price:  100.09715436958086
curr_Factors:  [100.09715437  -0.99883234  -0.97506304]
mat_Sqrt:  [[13.90496375  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0070842   0.00226052 -0.24592101]
Stock Position:  -0.00708419938385848
Bond Position:  [3.80184034]


portfolio before change:  [3.09483422]
curr_Stock_Price:  99.93461038493326
curr_Factors:  [99.93461038 -1.44189905 -0.96598646]
mat_Sqrt:  [[ 8.99465541  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02313459 -0.0081847   0.49445343]
Stock Position:  -0.023134587736825554
Bond Position:  [5.40678023]


portfolio before change:  [3.09381747]
curr_Stock_Price:  100.03699421593693
curr_Factors:  [100.03699422  -1.07812966  -0.96659027]
mat_Sqrt:  [[12.94643062  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00395771 -0.00221331 -0.17373565]
Stock Position:  -0.003957711745585248
Bond Position:  [3.48973506]


portfolio before change:  [3.10044098]
curr_Stock_Price:  98.58389098824851
curr_Factors:  [98.58389099 -0.64164583 -0.97740026]
mat_Sqrt:  [[19.52824303  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00337965 -0.05167506  0.38650567]
Stock Position:  -0.0033796542618737455
Bond Position:  [3.43362045]


portfolio before change:  [3.09577023]
curr_Stock_Price:  100.21993476294278
curr_Factors:  [100.21993476  -0.85713945  -0.95477289]
mat_Sqrt:  [[16.37007189  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00047727 -0.03661504  0.02294604]
Stock Position:  0.00047727029956359405
Bond Position:  [3.04793823]


portfolio before change:  [3.09700796]
curr_Stock_Price:  101.21654497712568
curr_Factors:  [101.21654498  -0.98775019  -0.99411469]
mat_Sqrt:  [[13.94885406  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0038014   0.00997895 -0.04917126]
Stock Position:  0.00380139506954871
Bond Position:  [2.71224389]


portfolio before change:  [3.10026469]
curr_Stock_Price:  101.89487047569853
curr_Factors:  [101.89487048  -0.87714591  -0.96494499]
mat_Sqrt:  [[16.14888004  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00840031  0.06169562 -0.20872752]
Stock Position:  -0.008400314047992427
Bond Position:  [3.9562136]


portfolio before change:  [3.08316637]
curr_Stock_Price:  104.04806354620708
curr_Factors:  [104.04806355  -1.24919868  -0.97715277]
mat_Sqrt:  [[11.22901988  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00276944  0.00104635 -0.09101012]
Stock Position:  -0.0027694443207328507
Bond Position:  [3.37132169]


portfolio before change:  [3.08458274]
curr_Stock_Price:  103.84100563482747
curr_Factors:  [103.84100563  -0.94720138  -0.98572418]
mat_Sqrt:  [[15.0283043   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00165397  0.01111809 -0.03527612]
Stock Position:  0.00165396652599002
Bond Position:  [2.91283319]


portfolio before change:  [3.08835847]
curr_Stock_Price:  105.68350445650107
curr_Factors:  [105.68350446  -1.10846702  -1.01203088]
mat_Sqrt:  [[12.67904862  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01508204 -0.02675428 -0.20498806]
Stock Position:  0.015082039985114287
Bond Position:  [1.49443563]


portfolio before change:  [3.09901451]
curr_Stock_Price:  106.36526802360686
curr_Factors:  [106.36526802  -0.70632641  -1.00902432]
mat_Sqrt:  [[19.13517685  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00558374  0.0102799   0.04764245]
Stock Position:  -0.005583742052947345
Bond Position:  [3.69293073]


portfolio before change:  [3.10687201]
curr_Stock_Price:  105.12342262087857
curr_Factors:  [105.12342262  -0.92819683  -1.02485132]
mat_Sqrt:  [[14.91081765  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 3.24840362e-04 -3.26665823e-03 -5.35068036e-01]
Stock Position:  0.00032484036242175115
Bond Position:  [3.07272367]


portfolio before change:  [3.10759581]
curr_Stock_Price:  104.98652916411322
curr_Factors:  [104.98652916  -1.02175505  -1.02161542]
mat_Sqrt:  [[13.60532934  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00556759  0.00658004 -0.09178035]
Stock Position:  -0.0055675862891725455
Bond Position:  [3.69211737]


portfolio before change:  [3.09963155]
curr_Stock_Price:  106.58280661488287
curr_Factors:  [106.58280661  -1.58920977  -1.04203723]
mat_Sqrt:  [[ 7.67275098  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01320648  0.04317774  0.88270411]
Stock Position:  -0.013206483917239208
Bond Position:  [4.50721567]


portfolio before change:  [3.0984099]
curr_Stock_Price:  106.76064279620567
curr_Factors:  [106.7606428   -1.31367658  -1.0378919 ]
mat_Sqrt:  [[10.16571583  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01106047 -0.09207015  0.63915079]
Stock Position:  -0.011060468793897445
Bond Position:  [4.27923266]


portfolio before change:  [3.09745943]
curr_Stock_Price:  106.94331287092503
curr_Factors:  [106.94331287  -1.1773127   -1.03309258]
mat_Sqrt:  [[11.72699713  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00090327 -0.02333572  0.7524801 ]
Stock Position:  0.0009032656439154842
Bond Position:  [3.00086121]


portfolio before change:  [3.09830429]
curr_Stock_Price:  107.04799029205972
curr_Factors:  [107.04799029  -1.13390942  -0.98692032]
mat_Sqrt:  [[12.83848753  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01555791  0.09506494 -0.23723829]
Stock Position:  -0.01555790523755029
Bond Position:  [4.76374678]


portfolio before change:  [3.09813538]
curr_Stock_Price:  107.13540513851432
curr_Factors:  [107.13540514  -1.53620119  -1.0157644 ]
mat_Sqrt:  [[ 8.34888437  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.03738726 -0.29337107 -0.20959449]
Stock Position:  -0.03738725637417161
Bond Position:  [7.10363424]


portfolio before change:  [3.07202446]
curr_Stock_Price:  107.88130242697686
curr_Factors:  [107.88130243  -1.74273884  -0.97559947]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [3.07202446]
Stock Price:  108.0326182845156
PL:  [-4.96059383]
Settle:  Tensor("sub_144:0", shape=(), dtype=float64)
PL:  Tensor("sub_145:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  73
output_Z_Vals[:, i, :]:  [[ 1.19251512e+02 -2.92846752e+01 -2.92776944e+01]
 [-1.87168547e-01  6.00863259e-02  1.09086326e-01]
 [-1.47205723e-01  7.79867470e-05  1.32817258e-01]
 [-3.71778614e-02  1.77470827e-02  5.47275829e-03]
 [-8.86054866e-02 -1.56474600e-01  1.28451088e-01]
 [-2.40154647e-02 -6.12770394e-03 -1.65081015e-02]
 [ 9.61141646e-03  1.00980269e-02  3.72752931e-03]
 [-1.16356156e-01  1.85740074e-01 -7.99210850e-02]
 [-1.16999572e-01 -5.75265169e-02  1.12256596e-01]
 [ 4.50470017e-02  4.74936917e-02 -1.18045691e-02]
 [ 2.07915314e-02  8.89049679e-02 -3.70553848e-03]
 [-5.19692942e-02 -9.21769353e-03 -1.08948751e-01]
 [ 1.84838001e-02 -1.35731930e-01 -9.03588741e-02]
 [ 2.37476315e-02  1.83677157e-03  1.87094881e-02]
 [ 1.67246840e-02 -6.39308187e-02 -7.04069551e-02]
 [ 1.30195075e-01 -9.92297580e-04  1.79266296e-03]
 [-1.23314266e-02  7.05419415e-02  7.68127042e-02]
 [ 4.16196696e-02 -2.49874608e-02  6.99696018e-02]
 [-1.91495982e-01 -6.03419342e-01 -3.38355778e-02]
 [ 6.97949435e-02 -2.89826959e-02 -7.47648968e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.25151208 -29.28467519 -29.2776944 ]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  8.31409947  -9.26062741 -83.52111278]
init_Out:  [2.49223638]
Stock Position:  8.314099471154409
Bond position:  [-828.91771073]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-3.35173509]
curr_Stock_Price:  99.32202926379536
curr_Factors:  [99.32202926 -1.15920453 -1.04229712]
mat_Sqrt:  [[10.98868095  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01486529  0.01900096  0.31119293]
Stock Position:  -0.014865293865509924
Bond Position:  [-1.87528394]


portfolio before change:  [-3.3526177]
curr_Stock_Price:  99.34986112493146
curr_Factors:  [99.34986112 -1.19624723 -1.06783584]
mat_Sqrt:  [[10.32496244  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-1.16312772e-02  2.46615748e-05  3.78890669e-01]
Stock Position:  -0.0116312772217777
Bond Position:  [-2.19705192]


portfolio before change:  [-3.35128602]
curr_Stock_Price:  99.18814105805458
curr_Factors:  [99.18814106 -0.75344437 -1.07423416]
mat_Sqrt:  [[15.94810358  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0022324   0.00561212  0.01561226]
Stock Position:  -0.0022323978115532956
Bond Position:  [-3.12985863]


portfolio before change:  [-3.35235673]
curr_Stock_Price:  99.31721568508219
curr_Factors:  [99.31721569 -0.82871346 -1.09992576]
mat_Sqrt:  [[14.43534488  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0046016  -0.04948161  0.3664352 ]
Stock Position:  -0.004601599434639046
Bond Position:  [-2.89533868]


portfolio before change:  [-3.35378905]
curr_Stock_Price:  99.47116159916897
curr_Factors:  [99.4711616  -0.7154221  -1.11578561]
mat_Sqrt:  [[15.93726465  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00172824 -0.00193775 -0.04709302]
Stock Position:  -0.0017282378149740824
Bond Position:  [-3.18187923]


portfolio before change:  [-3.3548398]
curr_Stock_Price:  99.61881619914405
curr_Factors:  [99.6188162  -0.74208039 -1.07862359]
mat_Sqrt:  [[16.1294548   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00065923 0.00319328 0.0106336 ]
Stock Position:  0.0006592302880214139
Bond Position:  [-3.42051154]


portfolio before change:  [-3.35453441]
curr_Stock_Price:  101.37939015849271
curr_Factors:  [101.37939016  -0.92049697  -1.07715281]
mat_Sqrt:  [[13.75249184  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00929826  0.05873617 -0.22799261]
Stock Position:  -0.009298256079227291
Bond Position:  [-2.41188288]


portfolio before change:  [-3.35308135]
curr_Stock_Price:  101.15826204504249
curr_Factors:  [101.15826205  -0.8548018   -1.06434196]
mat_Sqrt:  [[14.84320935  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00643868 -0.01819148  0.32023682]
Stock Position:  -0.006438676176188849
Bond Position:  [-2.70175606]


portfolio before change:  [-3.34897021]
curr_Stock_Price:  100.4148377473137
curr_Factors:  [100.41483775  -0.74725802  -1.04374621]
mat_Sqrt:  [[16.7484505   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00261897  0.01501882 -0.03367515]
Stock Position:  0.0026189697959443747
Bond Position:  [-3.61195363]


portfolio before change:  [-3.3551707]
curr_Stock_Price:  98.39213619689016
curr_Factors:  [98.3921362  -0.9883193  -1.03541218]
mat_Sqrt:  [[13.00364112  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00171726  0.02811422 -0.01057087]
Stock Position:  0.0017172619336622177
Bond Position:  [-3.52413577]


portfolio before change:  [-3.3580579]
curr_Stock_Price:  97.22396394899555
curr_Factors:  [97.22396395 -1.05520139 -1.00928081]
mat_Sqrt:  [[12.33616294  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00603481 -0.00291489 -0.31080046]
Stock Position:  -0.006034807190389855
Bond Position:  [-2.77133003]


portfolio before change:  [-3.35445185]
curr_Stock_Price:  96.51160167131259
curr_Factors:  [96.51160167 -1.49603817 -0.98467786]
mat_Sqrt:  [[ 8.07640783  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00042905 -0.04292221 -0.25776872]
Stock Position:  -0.0004290535204598423
Bond Position:  [-3.31304321]


portfolio before change:  [-3.35538235]
curr_Stock_Price:  96.74965280475791
curr_Factors:  [96.7496528  -1.95817413 -0.97277968]
mat_Sqrt:  [[ 5.16121973  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00535031 0.00058084 0.05337296]
Stock Position:  0.005350307968934778
Bond Position:  [-3.87302279]


portfolio before change:  [-3.35578166]
curr_Stock_Price:  96.85601426655947
curr_Factors:  [96.85601427 -1.87722811 -0.96049324]
mat_Sqrt:  [[ 5.67178641  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 1.23812458e-04 -2.02167000e-02 -2.00851445e-01]
Stock Position:  0.00012381245830158123
Bond Position:  [-3.36777365]


portfolio before change:  [-3.35656772]
curr_Stock_Price:  97.3082693970552
curr_Factors:  [97.3082694  -2.18365979 -0.97822698]
mat_Sqrt:  [[ 4.1205935   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.03167878 -0.00031379  0.00511397]
Stock Position:  0.031678781169374864
Bond Position:  [-6.43917509]


portfolio before change:  [-3.35296075]
curr_Stock_Price:  97.47295263043932
curr_Factors:  [97.47295263 -1.94781515 -0.97766622]
mat_Sqrt:  [[ 5.22833861  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00098871 0.02230732 0.21912526]
Stock Position:  0.0009887053076559054
Bond Position:  [-3.44933278]


portfolio before change:  [-3.35369199]
curr_Stock_Price:  97.60565082368511
curr_Factors:  [97.60565082 -1.84436001 -1.0184167 ]
mat_Sqrt:  [[ 5.57425503  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00991289 -0.00790173  0.1996038 ]
Stock Position:  0.009912890768080595
Bond Position:  [-4.32124615]


portfolio before change:  [-3.34939899]
curr_Stock_Price:  98.14771726858918
curr_Factors:  [98.14771727 -1.8852659  -1.03872488]
mat_Sqrt:  [[ 5.27238536  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.04058559 -0.19081795 -0.09652349]
Stock Position:  -0.040585588095323845
Bond Position:  [0.63398383]


portfolio before change:  [-3.36159764]
curr_Stock_Price:  98.45218901447436
curr_Factors:  [98.45218901 -2.03133438 -1.0547008 ]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-3.36159764]
Stock Price:  98.39088826042712
PL:  [-3.36159764]
Settle:  Tensor("sub_146:0", shape=(), dtype=float64)
PL:  Tensor("sub_147:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  74
output_Z_Vals[:, i, :]:  [[ 1.19251512e+02 -2.92846752e+01 -2.92776944e+01]
 [-3.49664592e-03  3.49364524e-04 -5.66710043e-02]
 [-1.98483064e-01 -1.38473305e-02  1.54546973e-01]
 [-6.20406798e-02 -1.41205181e-01 -4.42739111e-01]
 [-9.81786220e-02 -2.36470790e-01  2.09591937e-01]
 [-1.63093324e-02 -2.31592799e-03 -1.25574595e-02]
 [-5.68435880e-02 -1.50830551e-02  3.09945504e-02]
 [-5.87743917e-02  1.07501759e-01 -9.73023027e-02]
 [-3.13513150e-01 -1.43778972e-01  3.05919366e-01]
 [ 4.50470017e-02  4.74936917e-02 -1.18045691e-02]
 [ 3.85774997e-02  8.04491080e-02 -8.96638610e-03]
 [-7.02078855e-02 -9.30587197e-03 -1.15306836e-01]
 [ 1.91614598e-02 -1.48073492e-01 -2.99936997e-01]
 [-6.90363257e-02  2.67018757e-02 -2.47977375e-02]
 [ 2.32571114e-02 -6.46709007e-02 -4.70354029e-02]
 [ 5.56423457e-02 -1.12555469e-02  8.49007791e-02]
 [-2.35647895e-02  1.03259148e-01  6.82888801e-02]
 [ 2.91278910e-02 -4.94517111e-03 -3.35821131e-03]
 [-3.23494952e-01 -8.38799372e-01 -1.46979744e-01]
 [ 9.67302599e-02 -9.08826748e-02 -1.54763532e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.25151208 -29.28467519 -29.2776944 ]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  8.31409947  -9.26062741 -83.52111278]
init_Out:  [2.49223638]
Stock Position:  8.314099471154409
Bond position:  [-828.91771073]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [4.49816053]
curr_Stock_Price:  100.26619593500902
curr_Factors:  [100.26619594  -0.67088173  -0.99460799]
mat_Sqrt:  [[18.96014009  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-7.94062998e-04  1.10478763e-04 -1.61666601e-01]
Stock Position:  -0.0007940629984118122
Bond Position:  [4.57777821]


portfolio before change:  [4.49922315]
curr_Stock_Price:  100.3694265171842
curr_Factors:  [100.36942652  -0.65884317  -1.00379488]
mat_Sqrt:  [[19.0338619   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00878927 -0.00437891  0.4408795 ]
Stock Position:  -0.008789274209020863
Bond Position:  [5.38139756]


portfolio before change:  [4.48819586]
curr_Stock_Price:  101.77714267900085
curr_Factors:  [101.77714268  -1.13214261  -1.03129904]
mat_Sqrt:  [[11.69713456  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01334176 -0.044653   -1.26301145]
Stock Position:  -0.01334175678578204
Bond Position:  [5.84608175]


portfolio before change:  [4.51073419]
curr_Stock_Price:  100.19739409599808
curr_Factors:  [100.1973941   -0.77249995  -0.98588451]
mat_Sqrt:  [[17.266319    0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00356193 -0.07477863  0.59790746]
Stock Position:  -0.003561934453516953
Bond Position:  [4.86763074]


portfolio before change:  [4.51602546]
curr_Stock_Price:  99.05357406136427
curr_Factors:  [99.05357406 -0.93834105 -1.02823269]
mat_Sqrt:  [[13.86111057  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00136587 -0.00073236 -0.03582294]
Stock Position:  -0.0013658653085597146
Bond Position:  [4.6513193]


portfolio before change:  [4.51745096]
curr_Stock_Price:  98.86136721191068
curr_Factors:  [98.86136721 -0.88293972 -1.04864905]
mat_Sqrt:  [[14.32676935  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00355323 -0.00476968  0.08841883]
Stock Position:  -0.003553229167191203
Bond Position:  [4.86872806]


portfolio before change:  [4.52048688]
curr_Stock_Price:  98.34955746187423
curr_Factors:  [98.34955746 -0.71526496 -1.04763803]
mat_Sqrt:  [[16.87148724  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00449637  0.03399504 -0.27757639]
Stock Position:  -0.004496370504056297
Bond Position:  [4.96270293]


portfolio before change:  [4.52185693]
curr_Stock_Price:  98.32081833293971
curr_Factors:  [98.32081833 -0.3806093  -1.05627225]
mat_Sqrt:  [[23.36768866  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01090309 -0.0454669   0.8727028 ]
Stock Position:  -0.010903088528458846
Bond Position:  [5.59385751]


portfolio before change:  [4.5095937]
curr_Stock_Price:  99.57384539697972
curr_Factors:  [99.5738454  -0.83594879 -1.03845598]
mat_Sqrt:  [[15.27923575  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0028708   0.01501882 -0.03367515]
Stock Position:  0.002870803664732115
Bond Position:  [4.22373674]


portfolio before change:  [4.50864669]
curr_Stock_Price:  98.87610303001306
curr_Factors:  [98.87610303 -0.90750982 -0.98630885]
mat_Sqrt:  [[14.88045952  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00260909  0.02544024 -0.0255786 ]
Stock Position:  0.002609088166477637
Bond Position:  [4.25067022]


portfolio before change:  [4.50308162]
curr_Stock_Price:  96.335801012924
curr_Factors:  [96.33580101 -0.89449879 -0.97604715]
mat_Sqrt:  [[14.83952268  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00633343 -0.00294278 -0.32893831]
Stock Position:  -0.00633342954416716
Bond Position:  [5.11321762]


portfolio before change:  [4.49544104]
curr_Stock_Price:  97.74404945499553
curr_Factors:  [97.74404945 -0.92662705 -1.0073195 ]
mat_Sqrt:  [[14.13149186  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00324709 -0.04682495 -0.85563677]
Stock Position:  -0.003247085657306352
Bond Position:  [4.81282434]


portfolio before change:  [4.49289423]
curr_Stock_Price:  98.89898266858673
curr_Factors:  [98.89898267 -0.9145238  -1.01855844]
mat_Sqrt:  [[14.31083173  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00512959  0.00844387 -0.07074104]
Stock Position:  -0.005129590272202846
Bond Position:  [5.00020549]


portfolio before change:  [4.49675426]
curr_Stock_Price:  98.39020441947784
curr_Factors:  [98.39020442 -0.92308367 -1.03273502]
mat_Sqrt:  [[13.91715928  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00086126 -0.02045073 -0.13417891]
Stock Position:  0.0008612572644227874
Bond Position:  [4.41201498]


portfolio before change:  [4.49893834]
curr_Stock_Price:  99.64527704695554
curr_Factors:  [99.64527705 -0.85213149 -1.00477737]
mat_Sqrt:  [[15.56006642  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00467106 -0.00355932  0.24219829]
Stock Position:  0.004671061529125245
Bond Position:  [4.03348912]


portfolio before change:  [4.49495428]
curr_Stock_Price:  98.57645002976477
curr_Factors:  [98.57645003 -0.84590576 -0.97031337]
mat_Sqrt:  [[16.03242545  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00043407  0.03265341  0.19480917]
Stock Position:  -0.0004340728435461256
Bond Position:  [4.53774364]


portfolio before change:  [4.4960204]
curr_Stock_Price:  98.73415758179841
curr_Factors:  [98.73415758 -0.69906301 -1.02013975]
mat_Sqrt:  [[17.69404614  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00160024 -0.0015638  -0.00958004]
Stock Position:  0.0016002397058873473
Bond Position:  [4.33802208]


portfolio before change:  [4.49672019]
curr_Stock_Price:  98.4936607067495
curr_Factors:  [98.49366071 -0.84911798 -1.0069632 ]
mat_Sqrt:  [[15.3929715   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02437182 -0.26525165 -0.4192923 ]
Stock Position:  -0.02437182277346682
Bond Position:  [6.89719024]


portfolio before change:  [4.47734962]
curr_Stock_Price:  99.35921293547139
curr_Factors:  [99.35921294 -0.53644581 -1.02384259]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [4.47734962]
Stock Price:  100.46643082907751
PL:  [4.01091879]
Settle:  Tensor("sub_148:0", shape=(), dtype=float64)
PL:  Tensor("sub_149:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  75
output_Z_Vals[:, i, :]:  [[ 1.19251512e+02 -2.92846752e+01 -2.92776944e+01]
 [-1.78536548e-01  5.74503026e-02  8.77365077e-02]
 [-1.09261670e-01  1.03824013e-02  1.16737769e-01]
 [-2.65641215e-02  4.44585331e-02  7.63953727e-02]
 [-9.88296441e-02 -2.41910939e-01  2.15109929e-01]
 [-1.87148724e-01 -7.20771177e-02  4.14425569e-02]
 [ 5.25907299e-02  8.37649132e-02 -3.77111445e-02]
 [-1.43024833e-01  2.30234070e-01 -9.37685487e-02]
 [-6.17299919e-03 -5.24704877e-03 -1.35212413e-02]
 [ 2.01777527e-02  2.66617452e-02 -1.47929796e-02]
 [ 1.64919783e-01 -3.83963784e-02 -5.11317269e-02]
 [ 1.45290390e-02 -8.12495515e-03 -9.55529906e-02]
 [ 4.83620690e-02 -8.22592107e-03 -1.73836058e-01]
 [-8.45720117e-02  2.97281712e-02 -3.59999752e-02]
 [-9.49986370e-02  2.83328425e-02  1.80535895e-01]
 [-1.06635749e-02 -4.68641198e-02  1.08821747e-01]
 [-2.38545575e-02  1.03654348e-01  6.88416546e-02]
 [ 3.31332378e-02 -9.05209974e-03  2.18075245e-03]
 [-3.08092807e-01 -8.30538534e-01 -1.21890133e-01]
 [ 9.48042768e-02 -8.64565783e-02 -1.49043309e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.25151208 -29.28467519 -29.2776944 ]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  8.31409947  -9.26062741 -83.52111278]
init_Out:  [2.49223638]
Stock Position:  8.314099471154409
Bond position:  [-828.91771073]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-5.87556362]
curr_Stock_Price:  99.018469203589
curr_Factors:  [99.0184692  -0.80536017 -1.01786872]
mat_Sqrt:  [[15.99182263  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00995159  0.01816738  0.25028784]
Stock Position:  -0.009951589086739328
Bond Position:  [-4.89017251]


portfolio before change:  [-5.88275659]
curr_Stock_Price:  99.61840073393905
curr_Factors:  [99.61840073 -0.77771431 -1.02165436]
mat_Sqrt:  [[16.47721005  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00516863  0.0032832   0.33302036]
Stock Position:  -0.005168629905099046
Bond Position:  [-5.36786595]


portfolio before change:  [-5.87801259]
curr_Stock_Price:  98.44088710149619
curr_Factors:  [98.4408871  -0.82431391 -0.99795246]
mat_Sqrt:  [[15.91385105  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0006172   0.01405902  0.21793473]
Stock Position:  -0.0006172023919714447
Bond Position:  [-5.81725464]


portfolio before change:  [-5.88185977]
curr_Stock_Price:  102.3175336954557
curr_Factors:  [102.3175337   -1.46475024  -1.01963382]
mat_Sqrt:  [[ 8.53091817  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00716999 -0.07649896  0.61364875]
Stock Position:  -0.007169993433700611
Bond Position:  [-5.14824372]


portfolio before change:  [-5.88680396]
curr_Stock_Price:  102.82757291527669
curr_Factors:  [102.82757292  -1.81769055  -0.99810461]
mat_Sqrt:  [[ 6.15496071  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02933411 -0.02279279  0.11822408]
Stock Position:  -0.029334114267594896
Bond Position:  [-2.87044819]


portfolio before change:  [-5.91708728]
curr_Stock_Price:  103.83546457907478
curr_Factors:  [103.83546458  -1.86144175  -1.03488396]
mat_Sqrt:  [[ 5.73439279  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00820589  0.02648879 -0.1075794 ]
Stock Position:  0.008205886358369108
Bond Position:  [-6.7691493]


portfolio before change:  [-5.92250561]
curr_Stock_Price:  103.38142040929631
curr_Factors:  [103.38142041  -1.756419    -1.01497226]
mat_Sqrt:  [[ 6.46908067  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02414882  0.07280641 -0.26749557]
Stock Position:  -0.024148816129379722
Bond Position:  [-3.4259667]


portfolio before change:  [-5.9372138]
curr_Stock_Price:  103.95501353682124
curr_Factors:  [103.95501354  -2.01636643  -1.03945388]
mat_Sqrt:  [[ 4.89462631  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00185274 -0.00165926 -0.03857234]
Stock Position:  -0.0018527439412053036
Bond Position:  [-5.74461178]


portfolio before change:  [-5.93897042]
curr_Stock_Price:  104.12788497622063
curr_Factors:  [104.12788498  -2.13519785  -1.03227032]
mat_Sqrt:  [[ 4.3848334   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00407006  0.00843118 -0.04220025]
Stock Position:  0.004070063786779248
Bond Position:  [-6.36277756]


portfolio before change:  [-5.93866239]
curr_Stock_Price:  104.5944452041964
curr_Factors:  [104.5944452   -1.75969731  -1.04358237]
mat_Sqrt:  [[ 6.33956888  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.02421161 -0.012142   -0.14586458]
Stock Position:  0.024211610481235032
Bond Position:  [-8.47106235]


portfolio before change:  [-5.9563351]
curr_Stock_Price:  103.95199803440231
curr_Factors:  [103.95199803  -1.19528292  -1.02090743]
mat_Sqrt:  [[11.3332273   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00045754 -0.00256934 -0.27258609]
Stock Position:  -0.0004575412501299534
Bond Position:  [-5.90877277]


portfolio before change:  [-5.95718502]
curr_Stock_Price:  102.58062938742805
curr_Factors:  [102.58062939  -1.24703336  -0.94767644]
mat_Sqrt:  [[11.42654684  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00110843 -0.00260126 -0.49590589]
Stock Position:  0.0011084310963931365
Bond Position:  [-6.07088858]


portfolio before change:  [-5.95743815]
curr_Stock_Price:  103.72168273680568
curr_Factors:  [103.72168274  -1.18099736  -0.95588085]
mat_Sqrt:  [[12.24151411  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00744621  0.00940087 -0.10269791]
Stock Position:  -0.0074462110622943315
Bond Position:  [-5.18510461]


portfolio before change:  [-5.94767551]
curr_Stock_Price:  102.23648698718013
curr_Factors:  [102.23648699  -1.13054224  -0.92312734]
mat_Sqrt:  [[13.11319595  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00437844  0.00895963  0.51501866]
Stock Position:  -0.0043784406955347565
Bond Position:  [-5.50003911]


portfolio before change:  [-5.94577487]
curr_Stock_Price:  101.48831640677068
curr_Factors:  [101.48831641  -1.21409858  -0.88021026]
mat_Sqrt:  [[12.49882752  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00082724 -0.01481974  0.31043816]
Stock Position:  0.0008272411861921754
Bond Position:  [-6.02973018]


portfolio before change:  [-5.94890837]
curr_Stock_Price:  99.52288905691981
curr_Factors:  [99.52288906 -1.19869206 -0.8628812 ]
mat_Sqrt:  [[12.66464693  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00056267  0.03277838  0.19638608]
Stock Position:  -0.0005626662874942782
Bond Position:  [-5.8929102]


portfolio before change:  [-5.95003719]
curr_Stock_Price:  98.91045353081512
curr_Factors:  [98.91045353 -0.95500036 -0.89736015]
mat_Sqrt:  [[15.51573117  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00214909 -0.00286253  0.00622108]
Stock Position:  0.002149087109921243
Bond Position:  [-6.16260437]


portfolio before change:  [-5.94786206]
curr_Stock_Price:  100.63954438438618
curr_Factors:  [100.63954438  -0.98054208  -0.89054652]
mat_Sqrt:  [[15.49405913  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02287444 -0.26263935 -0.34771862]
Stock Position:  -0.022874440830972252
Bond Position:  [-3.64578876]


portfolio before change:  [-5.93478257]
curr_Stock_Price:  100.0278985113054
curr_Factors:  [100.02789851  -0.8210307   -0.92403433]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-5.93478257]
Stock Price:  100.65960821511149
PL:  [-6.59439078]
Settle:  Tensor("sub_150:0", shape=(), dtype=float64)
PL:  Tensor("sub_151:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  76
output_Z_Vals[:, i, :]:  [[ 1.19251512e+02 -2.92846752e+01 -2.92776944e+01]
 [ 5.34583842e-02 -1.74862379e-02  3.64433097e-02]
 [-2.28504797e-01 -2.20002916e-02  1.67269235e-01]
 [-2.83262852e-02  4.33617616e-02  7.30129853e-02]
 [-9.32042132e-02 -1.94903034e-01  1.67429392e-01]
 [-8.07094446e-02  4.25716973e-02 -1.72700363e-02]
 [-1.69644455e-01 -1.58255375e-01  1.29665177e-01]
 [-4.52635634e-02  8.29730391e-02 -7.40934282e-02]
 [-4.49858049e-01 -2.17694528e-01  4.74151826e-01]
 [-6.28746038e-03 -3.09013116e-01  1.04338522e-01]
 [-3.87716661e-01  1.87308791e-01  4.31434964e-02]
 [-2.12279507e-01 -1.50653668e-02 -2.22723689e-01]
 [-1.90920762e-01 -7.84493126e-01 -4.33844585e-04]
 [ 3.17522336e-01 -3.09378248e-01 -1.22405537e-01]
 [ 1.11348156e-02 -5.79141975e-02 -1.09473076e-01]
 [ 2.27942551e-01  1.17545891e-01 -3.63799101e-01]
 [-1.08422282e-01 -1.53503893e-01 -2.72748577e-01]
 [ 3.55432754e-02 -2.75999564e-02  1.30089863e-01]
 [-3.54264264e-01 -8.89574144e-01 -2.00516638e-01]
 [ 1.51684503e-01 -2.85025474e-01 -5.16748837e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.25151208 -29.28467519 -29.2776944 ]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  8.31409947  -9.26062741 -83.52111278]
init_Out:  [2.49223638]
Stock Position:  8.314099471154409
Bond position:  [-828.91771073]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [6.32482667]
curr_Stock_Price:  100.48590296954269
curr_Factors:  [100.48590297  -0.77413665  -0.9953968 ]
mat_Sqrt:  [[17.12405163  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00352988 -0.00552963  0.10396262]
Stock Position:  0.0035298802079312117
Bond Position:  [5.97012347]


portfolio before change:  [6.32548904]
curr_Stock_Price:  100.25066717594557
curr_Factors:  [100.25066718  -1.02364323  -0.9753274 ]
mat_Sqrt:  [[13.5814256   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01435263 -0.0069571   0.47717257]
Stock Position:  -0.01435262825430844
Bond Position:  [7.7643496]


portfolio before change:  [6.35417087]
curr_Stock_Price:  98.38755852477081
curr_Factors:  [98.38755852 -0.81045855 -0.93163856]
mat_Sqrt:  [[17.23284667  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00071393  0.01371219  0.20828572]
Stock Position:  -0.0007139259302528557
Bond Position:  [6.4244123]


portfolio before change:  [6.35515796]
curr_Stock_Price:  99.25490261556646
curr_Factors:  [99.25490262 -0.50153249 -0.93684725]
mat_Sqrt:  [[23.55437482  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00271967 -0.06163375  0.47762945]
Stock Position:  -0.002719673389279999
Bond Position:  [6.62509887]


portfolio before change:  [6.35738505]
curr_Stock_Price:  99.04509462041415
curr_Factors:  [99.04509462 -0.2727637  -0.99102572]
mat_Sqrt:  [[27.98827948  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00297037  0.01346235 -0.04926661]
Stock Position:  -0.0029703676324503055
Bond Position:  [6.65158539]


portfolio before change:  [6.36494784]
curr_Stock_Price:  97.05891441212235
curr_Factors:  [ 9.70589144e+01  6.89262929e-02 -9.82480028e-01]
mat_Sqrt:  [[38.9299713   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00378276 -0.05004474  0.36989866]
Stock Position:  -0.0037827615300771627
Bond Position:  [6.73209857]


portfolio before change:  [6.36656715]
curr_Stock_Price:  97.07581177841998
curr_Factors:  [97.07581178  0.20671559 -0.99098161]
mat_Sqrt:  [[44.31070138  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00131448  0.02623838 -0.21136793]
Stock Position:  -0.0013144785496445978
Bond Position:  [6.49417123]


portfolio before change:  [6.36933025]
curr_Stock_Price:  96.20904056204597
curr_Factors:  [96.20904056  0.53234847 -0.96336322]
mat_Sqrt:  [[62.52137984  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00573713 -0.06884105  1.35262318]
Stock Position:  -0.005737126445770498
Bond Position:  [6.92129368]


portfolio before change:  [6.41831033]
curr_Stock_Price:  87.9732908116956
curr_Factors:  [87.97329081  0.83847698 -0.99235161]
mat_Sqrt:  [[ 7.54264963e+01  0.00000000e+00  0.00000000e+00]
 [-8.16496581e-02  3.16227766e+00  0.00000000e+00]
 [-7.15541753e-02  0.00000000e+00  3.50542437e-01]]
grads:  [ 9.32280722e-05 -9.77185275e-02  2.97648761e-01]
Stock Position:  9.322807220231815e-05
Bond Position:  [6.41010875]


portfolio before change:  [6.41950265]
curr_Stock_Price:  83.57113099219762
curr_Factors:  [83.57113099  0.16285371 -0.98463995]
mat_Sqrt:  [[36.7416834   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01018118  0.05923224  0.12307639]
Stock Position:  -0.010181181278889962
Bond Position:  [7.27035549]


portfolio before change:  [6.43041803]
curr_Stock_Price:  82.67756431342337
curr_Factors:  [82.67756431  0.1374325  -0.97273238]
mat_Sqrt:  [[35.86092977  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00719813 -0.00476409 -0.63536869]
Stock Position:  -0.007198133934182409
Bond Position:  [7.02554221]


portfolio before change:  [6.42544526]
curr_Stock_Price:  83.61244300647134
curr_Factors:  [83.61244301  0.16662073 -0.99751169]
mat_Sqrt:  [[36.4266772   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00579973 -0.24807851 -0.00123764]
Stock Position:  -0.005799728708583435
Bond Position:  [6.91037474]


portfolio before change:  [6.45260934]
curr_Stock_Price:  79.22667375379991
curr_Factors:  [79.22667375  0.35239805 -0.95036284]
mat_Sqrt:  [[43.56910242  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00653097 -0.09783399 -0.34918893]
Stock Position:  0.006530965347631373
Bond Position:  [5.93518268]


portfolio before change:  [6.47498393]
curr_Stock_Price:  82.42537642812589
curr_Factors:  [82.42537643  0.3859691  -0.93209262]
mat_Sqrt:  [[47.74001021  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-2.66162923e-04 -1.83140773e-02 -3.12296215e-01]
Stock Position:  -0.00026616292299203346
Bond Position:  [6.49692251]


portfolio before change:  [6.47707952]
curr_Stock_Price:  80.65520779234855
curr_Factors:  [80.65520779  0.28553167 -0.96346931]
mat_Sqrt:  [[40.94565633  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00382745  0.03717127 -1.03781757]
Stock Position:  0.003827448538969756
Bond Position:  [6.16837586]


portfolio before change:  [6.48706874]
curr_Stock_Price:  82.86214438199954
curr_Factors:  [ 8.28621444e+01 -7.77563760e-02 -9.34699789e-01]
mat_Sqrt:  [[30.10592966  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0055823  -0.04854219 -0.77807577]
Stock Position:  -0.005582299163177352
Bond Position:  [6.94963002]


portfolio before change:  [6.47035555]
curr_Stock_Price:  86.16738013427157
curr_Factors:  [86.16738013 -0.37672037 -0.91949387]
mat_Sqrt:  [[23.57242136  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00260411 -0.00872787  0.37111017]
Stock Position:  0.0026041079390385284
Bond Position:  [6.2459664]


portfolio before change:  [6.47806175]
curr_Stock_Price:  88.5269230184521
curr_Factors:  [88.52692302 -0.7284536  -0.90617971]
mat_Sqrt:  [[17.26486329  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02422048 -0.28130804 -0.57201816]
Stock Position:  -0.024220478878272462
Bond Position:  [8.62222621]


portfolio before change:  [6.4754043]
curr_Stock_Price:  88.725650422579
curr_Factors:  [88.72565042 -0.62849648 -0.91787419]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [6.4754043]
Stock Price:  86.6013164076253
PL:  [6.4754043]
Settle:  Tensor("sub_152:0", shape=(), dtype=float64)
PL:  Tensor("sub_153:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  77
output_Z_Vals[:, i, :]:  [[ 1.19251512e+02 -2.92846752e+01 -2.92776944e+01]
 [-2.04057847e-01  6.38487075e-02  1.00593316e-01]
 [-1.48488367e-01 -1.95995293e-02  6.78229031e-02]
 [-2.60625227e-02  4.45139114e-02  7.67079400e-02]
 [-8.28510307e-02 -1.08388519e-01  7.96769483e-02]
 [ 1.72510222e-03 -3.46301811e-03 -3.30081780e-03]
 [-1.44129494e-01 -1.09324530e-01  9.82166340e-02]
 [-5.01748631e-02  7.89751310e-02 -1.15188747e-01]
 [-2.26131306e-01 -1.45177648e-01  3.15471618e-01]
 [ 8.43379782e-03 -8.02278452e-03  1.56896888e-02]
 [-5.82437569e-02  1.25392664e-01  2.21352529e-02]
 [-1.04468446e-01 -9.09486850e-03 -1.34805624e-01]
 [-4.02479006e-02 -4.00990288e-01 -3.78841163e-01]
 [ 7.84972901e-02 -4.61302316e-02  3.81479318e-03]
 [ 1.11348156e-02 -5.79141975e-02 -1.09473076e-01]
 [ 1.77411050e-01  4.72790992e-02 -1.25690485e-01]
 [ 2.25003301e-02 -3.67967667e-02  1.13386076e-01]
 [ 4.16809886e-02 -2.49610972e-02  6.93629074e-02]
 [-3.65055598e-01 -9.17698629e-01 -2.02266949e-01]
 [ 1.15074482e-01 -1.21764564e-01 -1.98182984e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.25151208 -29.28467519 -29.2776944 ]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  8.31409947  -9.26062741 -83.52111278]
init_Out:  [2.49223638]
Stock Position:  8.314099471154409
Bond position:  [-828.91771073]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-5.78606222]
curr_Stock_Price:  99.02923421898562
curr_Factors:  [99.02923422 -0.88606478 -1.01162166]
mat_Sqrt:  [[14.84597318  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01225085  0.02019073  0.28696473]
Stock Position:  -0.012250847689104314
Bond Position:  [-4.57287015]


portfolio before change:  [-5.7745166]
curr_Stock_Price:  97.99347093796538
curr_Factors:  [97.99347094 -1.02331488 -1.03121702]
mat_Sqrt:  [[12.55813864  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01076196 -0.00619792  0.19347986]
Stock Position:  -0.010761955740721273
Bond Position:  [-4.7199152]


portfolio before change:  [-5.77347119]
curr_Stock_Price:  97.78667479244095
curr_Factors:  [97.78667479 -1.27167822 -1.0634957 ]
mat_Sqrt:  [[ 9.46512885  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00097782  0.01407653  0.2188264 ]
Stock Position:  -0.0009778245945515798
Bond Position:  [-5.67785298]


portfolio before change:  [-5.77526245]
curr_Stock_Price:  98.16671972841593
curr_Factors:  [98.16671973 -1.07602715 -1.11172373]
mat_Sqrt:  [[11.01123784  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00630135 -0.03427546  0.22729616]
Stock Position:  -0.0063013461539604115
Bond Position:  [-5.15667997]


portfolio before change:  [-5.77757598]
curr_Stock_Price:  98.32925619413069
curr_Factors:  [98.32925619 -1.27506506 -1.13833387]
mat_Sqrt:  [[ 8.80150449  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00010929 -0.0010951  -0.00941631]
Stock Position:  0.00010928936820026664
Bond Position:  [-5.78832232]


portfolio before change:  [-5.7791476]
curr_Stock_Price:  97.19136764425367
curr_Factors:  [97.19136764 -1.17514249 -1.11865236]
mat_Sqrt:  [[ 9.80494686  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01294284 -0.03457145  0.28018472]
Stock Position:  -0.012942839577752795
Bond Position:  [-4.52121532]


portfolio before change:  [-5.7916823]
curr_Stock_Price:  98.07249187597104
curr_Factors:  [98.07249188 -1.24197292 -1.1259118 ]
mat_Sqrt:  [[ 9.18730092  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00779865  0.02497413 -0.32860143]
Stock Position:  -0.007798649366568143
Bond Position:  [-5.02684932]


portfolio before change:  [-5.77884382]
curr_Stock_Price:  96.2650835682081
curr_Factors:  [96.26508357 -1.03285144 -1.10591443]
mat_Sqrt:  [[11.3400398   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01459293 -0.0459092   0.89995272]
Stock Position:  -0.014592929616743052
Bond Position:  [-4.37405423]


portfolio before change:  [-5.78623674]
curr_Stock_Price:  96.69674950676107
curr_Factors:  [96.69674951 -1.40688753 -1.11331876]
mat_Sqrt:  [[ 7.77857767  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00146933 -0.00253703  0.04475832]
Stock Position:  0.0014693296398953476
Bond Position:  [-5.92831614]


portfolio before change:  [-5.78894187]
curr_Stock_Price:  95.86448874235172
curr_Factors:  [95.86448874 -1.00296139 -1.10526559]
mat_Sqrt:  [[11.64304074  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00433631  0.03965264  0.06314572]
Stock Position:  -0.00433630644790398
Bond Position:  [-5.37324407]


portfolio before change:  [-5.78560393]
curr_Stock_Price:  94.78490208407929
curr_Factors:  [94.78490208 -0.91763559 -1.1127827 ]
mat_Sqrt:  [[12.44341847  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01062573 -0.00287605 -0.38456292]
Stock Position:  -0.010625726166328208
Bond Position:  [-4.77844552]


portfolio before change:  [-5.78255501]
curr_Stock_Price:  94.3855238204962
curr_Factors:  [94.38552382 -0.30287102 -1.12658528]
mat_Sqrt:  [[22.59958202  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00566082 -0.12680426 -1.08072839]
Stock Position:  -0.0056608150391582405
Bond Position:  [-5.24825602]


portfolio before change:  [-5.78329632]
curr_Stock_Price:  94.28466940991663
curr_Factors:  [94.28466941 -0.25084916 -1.11362981]
mat_Sqrt:  [[24.09103152  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00324124 -0.01458766  0.01088254]
Stock Position:  0.0032412436959069653
Bond Position:  [-6.08889591]


portfolio before change:  [-5.7906042]
curr_Stock_Price:  92.49971646267055
curr_Factors:  [92.49971646 -0.41546154 -1.07043212]
mat_Sqrt:  [[20.93268724  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00060702 -0.01831408 -0.31229621]
Stock Position:  -0.0006070229070292379
Bond Position:  [-5.73445475]


portfolio before change:  [-5.793269]
curr_Stock_Price:  94.52765357826358
curr_Factors:  [94.52765358 -0.53197021 -1.07199725]
mat_Sqrt:  [[19.00923597  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00804742  0.01495096 -0.35855997]
Stock Position:  0.008047421178347463
Bond Position:  [-6.55397284]


portfolio before change:  [-5.80852947]
curr_Stock_Price:  92.83496534327857
curr_Factors:  [92.83496534 -0.73061247 -1.06882468]
mat_Sqrt:  [[15.35415621  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00291094 -0.01163616  0.32345891]
Stock Position:  0.002910943255784166
Bond Position:  [-6.07876679]


portfolio before change:  [-5.80269023]
curr_Stock_Price:  95.36305535806892
curr_Factors:  [95.36305536 -0.82676004 -1.06230446]
mat_Sqrt:  [[14.42015298  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00382764 -0.00789339  0.19787307]
Stock Position:  0.0038276390045437103
Bond Position:  [-6.16770558]


portfolio before change:  [-5.80230908]
curr_Stock_Price:  95.865524223958
curr_Factors:  [95.86552422 -0.44561155 -1.06672186]
mat_Sqrt:  [[21.12829221  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02035366 -0.29020179 -0.5770113 ]
Stock Position:  -0.020353658423109953
Bond Position:  [-3.85109494]


portfolio before change:  [-5.82988651]
curr_Stock_Price:  97.1731291009669
curr_Factors:  [97.1731291  -0.38906611 -1.07201331]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-5.82988651]
Stock Price:  95.86755332351204
PL:  [-5.82988651]
Settle:  Tensor("sub_154:0", shape=(), dtype=float64)
PL:  Tensor("sub_155:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  78
output_Z_Vals[:, i, :]:  [[ 1.19251512e+02 -2.92846752e+01 -2.92776944e+01]
 [-1.42203967e-01  2.35937038e-02 -8.05631686e-02]
 [-2.66417133e-01 -3.22960929e-02  1.83335284e-01]
 [-4.08808793e-02 -1.67227441e-02 -8.84545739e-02]
 [-9.88296441e-02 -2.41910939e-01  2.15109929e-01]
 [-2.74695118e-01  3.68377583e-02  9.94402992e-03]
 [ 5.44874050e-02  5.22089055e-02 -2.53359219e-02]
 [-1.42356467e-01  2.17757271e-01 -7.19099238e-02]
 [-2.12902474e-02  1.10271323e-03 -2.72085378e-02]
 [-5.58174926e-03  5.98228016e-03 -2.09929564e-02]
 [ 1.82712473e-01 -5.48652481e-02 -5.70513391e-02]
 [-6.75382515e-02 -4.38398830e-03 -6.07923171e-02]
 [ 4.09560777e-02 -1.19491956e-02 -2.24265388e-01]
 [-8.45720117e-02  2.97281712e-02 -3.59999752e-02]
 [-1.12780123e-01  5.86936053e-02  2.29763205e-01]
 [-1.04217129e-01 -2.05554814e-01  1.84780069e-01]
 [-2.61864130e-02 -1.30699409e-02  2.26185984e-01]
 [-9.55437855e-02  1.65575035e-01 -9.16988098e-02]
 [-3.47502414e-01 -9.80031818e-01 -1.93313286e-01]
 [ 8.30189030e-02 -5.93726421e-02 -1.14040423e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.25151208 -29.28467519 -29.2776944 ]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  8.31409947  -9.26062741 -83.52111278]
init_Out:  [2.49223638]
Stock Position:  8.314099471154409
Bond position:  [-828.91771073]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-0.04356216]
curr_Stock_Price:  99.71992839173926
curr_Factors:  [99.71992839 -1.08827292 -0.98725979]
mat_Sqrt:  [[12.51380998  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01262922  0.00746098 -0.2298243 ]
Stock Position:  -0.012629220683398145
Bond Position:  [1.21582282]


portfolio before change:  [-0.05297053]
curr_Stock_Price:  100.4889673254155
curr_Factors:  [100.48896733  -1.00486033  -0.99218456]
mat_Sqrt:  [[13.63995102  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01684961 -0.01021292  0.52300453]
Stock Position:  -0.01684961013961205
Bond Position:  [1.6402294]


portfolio before change:  [-0.0443611]
curr_Stock_Price:  100.00234961297252
curr_Factors:  [100.00234961  -0.8364727   -0.99682357]
mat_Sqrt:  [[15.98894284  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00371309 -0.0052882  -0.25233628]
Stock Position:  -0.0037130893284092765
Bond Position:  [0.32695656]


portfolio before change:  [-0.05231523]
curr_Stock_Price:  102.16655300398956
curr_Factors:  [102.166553    -0.99170214  -1.02985123]
mat_Sqrt:  [[13.53191522  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00452018 -0.07649896  0.61364875]
Stock Position:  -0.0045201751745453655
Bond Position:  [0.40949549]


portfolio before change:  [-0.05513777]
curr_Stock_Price:  102.81363603409253
curr_Factors:  [102.81363603  -0.83261841  -1.0502855 ]
mat_Sqrt:  [[15.64285213  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01736986  0.01164912  0.02836755]
Stock Position:  -0.017369860174562473
Bond Position:  [1.73072071]


portfolio before change:  [-0.04058268]
curr_Stock_Price:  102.00059801503058
curr_Factors:  [102.00059802  -0.88644721  -1.02023176]
mat_Sqrt:  [[15.15453314  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00334314  0.01650991 -0.07227633]
Stock Position:  0.0033431422353519314
Bond Position:  [-0.38158519]


portfolio before change:  [-0.03796192]
curr_Stock_Price:  102.8130571279195
curr_Factors:  [102.81305713  -1.04773447  -1.00587848]
mat_Sqrt:  [[13.18789569  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01148118  0.0688609  -0.205139  ]
Stock Position:  -0.011481175938520717
Bond Position:  [1.14245287]


portfolio before change:  [-0.05161746]
curr_Stock_Price:  104.02732136658453
curr_Factors:  [104.02732137  -1.31707219  -1.00535557]
mat_Sqrt:  [[10.1983487   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00262942  0.00034871 -0.07761839]
Stock Position:  -0.002629415384678048
Bond Position:  [0.22191358]


portfolio before change:  [-0.05331136]
curr_Stock_Price:  104.6926376472349
curr_Factors:  [104.69263765  -1.4582965   -1.00973913]
mat_Sqrt:  [[ 8.87282437  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00109463  0.00189176 -0.05988706]
Stock Position:  -0.0010946296620196405
Bond Position:  [0.0612883]


portfolio before change:  [-0.05347516]
curr_Stock_Price:  104.85627099960905
curr_Factors:  [104.856271    -1.01301028  -0.99742624]
mat_Sqrt:  [[14.04342115  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01208041 -0.01734991 -0.16275159]
Stock Position:  0.012080411243949204
Bond Position:  [-1.32018203]


portfolio before change:  [-0.05495617]
curr_Stock_Price:  104.76099860203601
curr_Factors:  [104.7609986   -1.01897544  -0.97710148]
mat_Sqrt:  [[14.23358956  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00562477 -0.00138634 -0.17342356]
Stock Position:  -0.005624767031903371
Bond Position:  [0.53430004]


portfolio before change:  [-0.05174091]
curr_Stock_Price:  104.21312376089675
curr_Factors:  [104.21312376  -0.80792018  -1.02480802]
mat_Sqrt:  [[16.67165331  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-3.07733713e-04 -3.77866743e-03 -6.39766728e-01]
Stock Position:  -0.00030773371298500575
Bond Position:  [-0.01967102]


portfolio before change:  [-0.05158192]
curr_Stock_Price:  103.68048035009902
curr_Factors:  [103.68048035  -0.75995383  -1.03011014]
mat_Sqrt:  [[17.30940333  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00526609  0.00940087 -0.10269791]
Stock Position:  -0.005266091270799997
Bond Position:  [0.49440895]


portfolio before change:  [-0.05087409]
curr_Stock_Price:  103.56954197276406
curr_Factors:  [103.56954197  -0.69429946  -1.01368172]
mat_Sqrt:  [[18.77004248  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0034291   0.01856055  0.65545047]
Stock Position:  -0.003429104802623294
Bond Position:  [0.30427672]


portfolio before change:  [-0.05676792]
curr_Stock_Price:  105.31049369164519
curr_Factors:  [105.31049369  -0.69265629  -1.01443254]
mat_Sqrt:  [[19.1025959   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00375899 -0.06500214  0.5271261 ]
Stock Position:  -0.0037589895373710447
Bond Position:  [0.33909313]


portfolio before change:  [-0.05457558]
curr_Stock_Price:  104.74982230238183
curr_Factors:  [104.7498223   -0.97128395  -1.02784801]
mat_Sqrt:  [[14.18865779  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00138464 -0.00413308  0.64524566]
Stock Position:  0.0013846371943136435
Bond Position:  [-0.19961608]


portfolio before change:  [-0.05521135]
curr_Stock_Price:  104.32670503885612
curr_Factors:  [104.32670504  -0.77813526  -1.09385875]
mat_Sqrt:  [[16.04718369  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00685395  0.05235942 -0.26159118]
Stock Position:  -0.00685395018586372
Bond Position:  [0.65983869]


portfolio before change:  [-0.05064784]
curr_Stock_Price:  103.6849543822291
curr_Factors:  [103.68495438  -0.65739301  -1.06535843]
mat_Sqrt:  [[18.515451    0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02226609 -0.30991327 -0.551469  ]
Stock Position:  -0.022266086637035123
Bond Position:  [2.25801033]


portfolio before change:  [-0.02656214]
curr_Stock_Price:  102.62858876644741
curr_Factors:  [102.62858877  -0.34114225  -1.01570329]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-0.02656214]
Stock Price:  103.80666561323382
PL:  [-3.83322776]
Settle:  Tensor("sub_156:0", shape=(), dtype=float64)
PL:  Tensor("sub_157:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  79
output_Z_Vals[:, i, :]:  [[ 1.19251512e+02 -2.92846752e+01 -2.92776944e+01]
 [-2.91967717e-03 -5.75228762e-03 -2.01630517e-02]
 [-2.31817438e-01 -2.28999009e-02  1.68673027e-01]
 [-6.42534366e-02 -1.16834897e-01 -3.71581487e-01]
 [-9.88296441e-02 -2.41910939e-01  2.15109929e-01]
 [-2.61738318e-01  2.56193831e-02  1.14988012e-02]
 [ 5.39103582e-02  6.18095456e-02 -2.91009754e-02]
 [-1.39931301e-01  2.16354970e-01 -7.53593120e-02]
 [-5.19773696e-02 -3.09171879e-02  5.28218970e-02]
 [ 2.48820284e-02  3.52402823e-02 -1.25273901e-02]
 [ 1.57338913e-01 -2.68312828e-02 -4.39845016e-02]
 [-4.53863400e-02 -4.63575356e-03 -6.56939253e-02]
 [ 5.44799762e-02 -3.25803494e-03 -3.52687385e-02]
 [-8.45720117e-02  2.97281712e-02 -3.59999752e-02]
 [-1.32135225e-01  8.59712805e-02  2.57677095e-01]
 [-1.18153094e-01 -2.31725826e-01  1.96675837e-01]
 [-2.89031275e-02 -1.41193521e-02  2.39103845e-01]
 [-1.41514395e-01  2.37375951e-01 -6.97409532e-02]
 [-2.88434649e-01 -9.33682211e-01 -7.60485510e-02]
 [ 6.67760792e-02 -6.79636886e-03 -5.08361770e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.25151208 -29.28467519 -29.2776944 ]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  8.31409947  -9.26062741 -83.52111278]
init_Out:  [2.49223638]
Stock Position:  8.314099471154409
Bond position:  [-828.91771073]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [4.33543596]
curr_Stock_Price:  100.24662381271887
curr_Factors:  [100.24662381  -0.90050876  -1.03075175]
mat_Sqrt:  [[14.53228727  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00049435 -0.00181903 -0.05751957]
Stock Position:  -0.0004943451891219975
Bond Position:  [4.3849924]


portfolio before change:  [4.33659186]
curr_Stock_Price:  100.12623838315828
curr_Factors:  [100.12623838  -1.06034441  -1.03045033]
mat_Sqrt:  [[12.37448928  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01599892 -0.00724158  0.4811772 ]
Stock Position:  -0.015998920766997337
Bond Position:  [5.93850361]


portfolio before change:  [4.31908821]
curr_Stock_Price:  101.31309707847343
curr_Factors:  [101.31309708  -1.04999708  -1.06704004]
mat_Sqrt:  [[12.19686038  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01173407 -0.03694644 -1.06001856]
Stock Position:  -0.011734073340144972
Bond Position:  [5.50790352]


portfolio before change:  [4.29883795]
curr_Stock_Price:  103.15622648638521
curr_Factors:  [103.15622649  -0.93026625  -1.06053959]
mat_Sqrt:  [[14.08962566  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00434125 -0.07649896  0.61364875]
Stock Position:  -0.004341252827853593
Bond Position:  [4.7466652]


portfolio before change:  [4.3019113]
curr_Stock_Price:  102.72166598497036
curr_Factors:  [102.72166598  -0.87112057  -1.05073556]
mat_Sqrt:  [[15.03178447  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01721217  0.00810156  0.03280288]
Stock Position:  -0.01721217103998346
Bond Position:  [6.06997418]


portfolio before change:  [4.30847587]
curr_Stock_Price:  102.42844964151587
curr_Factors:  [102.42844964  -1.06889348  -1.08093796]
mat_Sqrt:  [[11.93330302  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00415359  0.01954589 -0.08301698]
Stock Position:  0.004153591171786107
Bond Position:  [3.88302997]


portfolio before change:  [4.31043672]
curr_Stock_Price:  102.66679186068468
curr_Factors:  [102.66679186  -1.09297612  -1.08680009]
mat_Sqrt:  [[11.60820881  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01289843  0.06841745 -0.21497914]
Stock Position:  -0.0128984322080928
Bond Position:  [5.63467738]


portfolio before change:  [4.32003041]
curr_Stock_Price:  102.03223117967951
curr_Factors:  [102.03223118  -0.97568412  -1.10405961]
mat_Sqrt:  [[12.75017538  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00329356 -0.00977687  0.15068617]
Stock Position:  -0.0032935565319192994
Bond Position:  [4.65607933]


portfolio before change:  [4.31531041]
curr_Stock_Price:  103.8187980401817
curr_Factors:  [103.81879804  -0.78398872  -1.09187007]
mat_Sqrt:  [[15.90746127  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00146062  0.01114396 -0.03573716]
Stock Position:  0.0014606218634551445
Bond Position:  [4.16367041]


portfolio before change:  [4.3168453]
curr_Stock_Price:  104.15690092651235
curr_Factors:  [104.15690093  -1.22238791  -1.11357747]
mat_Sqrt:  [[10.0737501   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01465868 -0.0084848  -0.12547554]
Stock Position:  0.014658675485231054
Bond Position:  [2.79004309]


portfolio before change:  [4.32089774]
curr_Stock_Price:  104.38576496684685
curr_Factors:  [104.38576497  -1.46472976  -1.06985131]
mat_Sqrt:  [[ 8.27726207  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00711778 -0.00146595 -0.18740648]
Stock Position:  -0.007117782484349637
Bond Position:  [5.06389291]


portfolio before change:  [4.31646956]
curr_Stock_Price:  105.18577750839
curr_Factors:  [105.18577751  -1.78192566  -1.09896211]
mat_Sqrt:  [[ 5.8993391   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00800033 -0.00103028 -0.10061189]
Stock Position:  0.008000328889285657
Bond Position:  [3.47494875]


portfolio before change:  [4.31562435]
curr_Stock_Price:  104.97152905244894
curr_Factors:  [104.97152905  -1.80341461  -1.07142079]
mat_Sqrt:  [[ 5.92306326  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01538949  0.00940087 -0.10269791]
Stock Position:  -0.015389485782046037
Bond Position:  [5.9310822]


portfolio before change:  [4.32314054]
curr_Stock_Price:  104.57949300931034
curr_Factors:  [104.57949301  -1.80343295  -1.10353189]
mat_Sqrt:  [[ 5.71436193  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01353035  0.02718651  0.73508103]
Stock Position:  -0.013530353887691053
Bond Position:  [5.73813809]


portfolio before change:  [4.31526241]
curr_Stock_Price:  105.26778580349534
curr_Factors:  [105.2677858   -1.54513778  -1.14664628]
mat_Sqrt:  [[ 7.1329392   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01177494 -0.07327814  0.56106142]
Stock Position:  -0.011774941550976019
Bond Position:  [5.55478443]


portfolio before change:  [4.31087909]
curr_Stock_Price:  105.75799525145548
curr_Factors:  [105.75799525  -1.57313189  -1.188561  ]
mat_Sqrt:  [[ 6.68228859  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00292403 -0.00446493  0.68209672]
Stock Position:  0.0029240252167982298
Bond Position:  [4.00164004]


portfolio before change:  [4.31357032]
curr_Stock_Price:  106.33620225612168
curr_Factors:  [106.33620226  -1.73596007  -1.16761607]
mat_Sqrt:  [[ 5.83007373  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02566369  0.07506487 -0.19895153]
Stock Position:  -0.025663686810204516
Bond Position:  [7.04254931]


portfolio before change:  [4.32351094]
curr_Stock_Price:  106.01747284998656
curr_Factors:  [106.01747285  -1.5505651   -1.15501063]
mat_Sqrt:  [[ 7.08534235  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.04630201 -0.29525624 -0.21694535]
Stock Position:  -0.04630200624581319
Bond Position:  [9.23233263]


portfolio before change:  [4.34941321]
curr_Stock_Price:  105.5079074916237
curr_Factors:  [105.50790749  -1.18124399  -1.13236836]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [4.34941321]
Stock Price:  105.5044902671001
PL:  [-1.15507705]
Settle:  Tensor("sub_158:0", shape=(), dtype=float64)
PL:  Tensor("sub_159:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  80
output_Z_Vals[:, i, :]:  [[ 1.19251512e+02 -2.92846752e+01 -2.92776944e+01]
 [-2.16371826e-01  6.76753168e-02  1.09379592e-01]
 [-2.64686158e-01 -6.49561677e-02  2.06669122e-01]
 [-3.87801975e-02  3.55081641e-02  4.95603260e-02]
 [-8.82364941e-02 -1.53391179e-01  1.25323548e-01]
 [-1.22179670e-01  7.45414763e-02 -1.24001154e-02]
 [-2.59625116e-01 -2.58745444e-01  2.00805040e-01]
 [-6.77186570e-02  1.18630187e-01 -8.20752356e-02]
 [-3.27268345e-01 -1.60254894e-01  3.44596482e-01]
 [ 6.39444406e-02  5.27568454e-02 -3.55841830e-03]
 [ 3.20810568e-02  8.60072838e-02 -1.21319291e-02]
 [ 1.16161384e-01 -1.11054319e-02 -1.39444951e-01]
 [-5.21328143e-03 -2.31608256e-01 -4.00079320e-01]
 [ 9.09155942e-03  1.90806786e-03  1.38128741e-03]
 [ 1.11348156e-02 -5.79141975e-02 -1.09473076e-01]
 [ 8.67805720e-02 -1.06712426e-02  5.12097799e-02]
 [-2.69109917e-02  1.07822870e-01  7.46722459e-02]
 [-1.47429143e-03  3.53267710e-02 -9.04654516e-02]
 [-3.61120189e-01 -9.23191341e-01 -2.06463428e-01]
 [ 1.04368068e-01 -1.08435102e-01 -1.77448035e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.25151208 -29.28467519 -29.2776944 ]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  8.31409947  -9.26062741 -83.52111278]
init_Out:  [2.49223638]
Stock Position:  8.314099471154409
Bond position:  [-828.91771073]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-6.84885997]
curr_Stock_Price:  98.90140344732487
curr_Factors:  [98.90140345 -0.82784544 -0.99628833]
mat_Sqrt:  [[15.95846901  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01204987  0.02140081  0.31202953]
Stock Position:  -0.012049867777874014
Bond Position:  [-5.65711113]


portfolio before change:  [-6.83227722]
curr_Stock_Price:  97.40784337906102
curr_Factors:  [97.40784338 -0.97756462 -1.03265024]
mat_Sqrt:  [[13.04874382  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01717998 -0.02054094  0.58956948]
Stock Position:  -0.017179980289814458
Bond Position:  [-5.15881239]


portfolio before change:  [-6.85268518]
curr_Stock_Price:  98.52065603084128
curr_Factors:  [98.52065603 -0.41743282 -0.99738874]
mat_Sqrt:  [[23.93746188  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00115914  0.01122867  0.14138182]
Stock Position:  -0.00115914216668031
Bond Position:  [-6.73848574]


portfolio before change:  [-6.85403045]
curr_Stock_Price:  98.22771267521149
curr_Factors:  [98.22771268 -0.58322772 -1.01919122]
mat_Sqrt:  [[19.78391922  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00336715 -0.04850655  0.3575132 ]
Stock Position:  -0.0033671526097022618
Bond Position:  [-6.52328275]


portfolio before change:  [-6.85552157]
curr_Stock_Price:  98.18616093322579
curr_Factors:  [98.18616093 -0.11573735 -1.02100462]
mat_Sqrt:  [[31.50427698  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00389744  0.02357208 -0.03537408]
Stock Position:  -0.0038974447864788646
Bond Position:  [-6.47284642]


portfolio before change:  [-6.84619852]
curr_Stock_Price:  95.37881835477799
curr_Factors:  [ 9.53788184e+01 -6.82363974e-02 -1.00933263e+00]
mat_Sqrt:  [[32.46905559  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00693943 -0.08182249  0.57284089]
Stock Position:  -0.006939429972958323
Bond Position:  [-6.18432389]


portfolio before change:  [-6.87013856]
curr_Stock_Price:  98.60585087627558
curr_Factors:  [98.60585088 -0.35425212 -0.99982748]
mat_Sqrt:  [[25.45853354  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00319772  0.03751416 -0.2341378 ]
Stock Position:  -0.003197716626451335
Bond Position:  [-6.55482499]


portfolio before change:  [-6.86813134]
curr_Stock_Price:  97.46562072411403
curr_Factors:  [97.46562072 -0.32607239 -0.99404708]
mat_Sqrt:  [[26.03339776  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0100281  -0.05067705  0.98303785]
Stock Position:  -0.010028104992982421
Bond Position:  [-5.89073586]


portfolio before change:  [-6.87985619]
curr_Stock_Price:  98.48794610355361
curr_Factors:  [98.4879461  -0.58192027 -1.0144347 ]
mat_Sqrt:  [[19.95698473  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00323597  0.01668318 -0.01015118]
Stock Position:  0.0032359726804493637
Bond Position:  [-7.19856049]


portfolio before change:  [-6.87803614]
curr_Stock_Price:  99.6065956764874
curr_Factors:  [99.60659568 -0.796      -1.01244064]
mat_Sqrt:  [[16.3264704   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00194931  0.02719789 -0.03460902]
Stock Position:  0.0019493089960569933
Bond Position:  [-7.07220017]


portfolio before change:  [-6.87856641]
curr_Stock_Price:  100.24169169153753
curr_Factors:  [100.24169169  -0.76677885  -1.00216989]
mat_Sqrt:  [[17.0924261   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00511399 -0.00351185 -0.39779763]
Stock Position:  0.00511399381647867
Bond Position:  [-7.3912018]


portfolio before change:  [-6.89723586]
curr_Stock_Price:  96.95239944466263
curr_Factors:  [96.95239944 -0.4155779  -0.96851159]
mat_Sqrt:  [[24.29160071  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00382269 -0.07324096 -1.14131494]
Stock Position:  -0.003822688803313114
Bond Position:  [-6.52661701]


portfolio before change:  [-6.89749014]
curr_Stock_Price:  96.59202944094545
curr_Factors:  [96.59202944 -0.6123004  -0.99151614]
mat_Sqrt:  [[19.42730766  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00048503 0.00060338 0.00394043]
Stock Position:  0.00048502756037285117
Bond Position:  [-6.94433993]


portfolio before change:  [-6.8991414]
curr_Stock_Price:  96.76735938194504
curr_Factors:  [96.76735938 -0.22555777 -0.98778441]
mat_Sqrt:  [[28.75948307  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00044182 -0.01831408 -0.31229621]
Stock Position:  -0.0004418236805703172
Bond Position:  [-6.85638729]


portfolio before change:  [-6.90200553]
curr_Stock_Price:  99.36979764743197
curr_Factors:  [99.36979765 -0.20691429 -0.97975616]
mat_Sqrt:  [[30.33122672  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00319665 -0.00337454  0.14608725]
Stock Position:  0.0031966459896640583
Bond Position:  [-7.21965559]


portfolio before change:  [-6.90453208]
curr_Stock_Price:  99.14411992626444
curr_Factors:  [99.14411993 -0.40707446 -0.96808788]
mat_Sqrt:  [[25.0634902   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00035448  0.03409659  0.21301913]
Stock Position:  -0.00035448410007483337
Bond Position:  [-6.86938707]


portfolio before change:  [-6.90670797]
curr_Stock_Price:  100.43706016810351
curr_Factors:  [100.43706017  -0.36165888  -0.93989483]
mat_Sqrt:  [[27.32979665  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00069625  0.01117131 -0.25807275]
Stock Position:  -0.0006962489095518262
Bond Position:  [-6.83677877]


portfolio before change:  [-6.90671607]
curr_Stock_Price:  97.99352536970993
curr_Factors:  [97.99352537 -0.36443925 -0.92391784]
mat_Sqrt:  [[27.01910818  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01580737 -0.29193874 -0.58898269]
Stock Position:  -0.015807370634034094
Bond Position:  [-5.35769609]


portfolio before change:  [-6.93889116]
curr_Stock_Price:  99.94422965845801
curr_Factors:  [99.94422966 -0.46396072 -0.8992186 ]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-6.93889116]
Stock Price:  102.68183630724266
PL:  [-9.62072747]
Settle:  Tensor("sub_160:0", shape=(), dtype=float64)
PL:  Tensor("sub_161:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  81
output_Z_Vals[:, i, :]:  [[ 1.19251512e+02 -2.92846752e+01 -2.92776944e+01]
 [-1.52582054e-01  3.93699912e-02  9.42885092e-04]
 [-3.06755995e-01 -4.32508624e-02  2.00429617e-01]
 [-3.81724327e-02 -5.04311552e-03 -5.53592821e-02]
 [-8.57039772e-02 -1.32228655e-01  1.03858211e-01]
 [-1.37315594e-02  8.64043859e-03 -7.85704570e-03]
 [-1.14365000e-01 -8.10580063e-02  7.74291933e-02]
 [-7.84842322e-02  1.38169839e-01 -1.08044727e-01]
 [-1.90142890e-01 -8.79340070e-02  1.80257006e-01]
 [ 4.50470017e-02  4.74936917e-02 -1.18045691e-02]
 [ 6.15072893e-02  6.36398212e-02 -1.43208134e-02]
 [ 1.94476390e-01 -1.34021028e-02 -1.73266853e-01]
 [ 3.74554552e-02 -1.43322517e-02 -2.80017439e-01]
 [-7.89888979e-02  2.63751659e-02 -3.45614300e-02]
 [-1.12325279e-01  5.80525812e-02  2.29107230e-01]
 [-4.08165619e-02 -9.17246345e-02  1.31861566e-01]
 [-2.24798373e-02  3.42555107e-02  1.49695452e-01]
 [-1.89518326e-02  5.86374634e-02 -9.31544657e-02]
 [-3.91838928e-01 -1.00693377e+00 -2.50987762e-01]
 [ 1.28559339e-01 -1.46520966e-01 -2.32117207e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.25151208 -29.28467519 -29.2776944 ]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  8.31409947  -9.26062741 -83.52111278]
init_Out:  [2.49223638]
Stock Position:  8.314099471154409
Bond position:  [-828.91771073]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-3.96688996]
curr_Stock_Price:  99.24803990722067
curr_Factors:  [99.24803991 -0.72314344 -1.00574069]
mat_Sqrt:  [[17.61477511  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00859353  0.01244988  0.00268979]
Stock Position:  -0.008593527774419105
Bond Position:  [-3.11399917]


portfolio before change:  [-3.97774357]
curr_Stock_Price:  100.42043599381203
curr_Factors:  [100.42043599  -1.23342603  -1.04396586]
mat_Sqrt:  [[10.29824859  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02592287 -0.01367712  0.57176991]
Stock Position:  -0.025922874290027362
Bond Position:  [-1.37455724]


portfolio before change:  [-3.96618489]
curr_Stock_Price:  99.96129080954586
curr_Factors:  [99.96129081 -1.1480164  -1.03514476]
mat_Sqrt:  [[11.26411321  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00440361 -0.00159477 -0.15792462]
Stock Position:  -0.004403614430865316
Bond Position:  [-3.52599391]


portfolio before change:  [-3.96203285]
curr_Stock_Price:  98.81821754803991
curr_Factors:  [98.81821755 -1.14288649 -1.00978157]
mat_Sqrt:  [[11.48008638  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00591617 -0.04181437  0.29627857]
Stock Position:  -0.005916169578265224
Bond Position:  [-3.37740752]


portfolio before change:  [-3.96125324]
curr_Stock_Price:  98.54370433451712
curr_Factors:  [98.54370433 -1.09773525 -0.96341618]
mat_Sqrt:  [[12.54533289  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00120461  0.00273235 -0.02241396]
Stock Position:  -0.0012046134680407958
Bond Position:  [-3.84254617]


portfolio before change:  [-3.96124294]
curr_Stock_Price:  97.73758894234427
curr_Factors:  [97.73758894 -1.10578973 -0.93672687]
mat_Sqrt:  [[12.6767502   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00793995 -0.02563279  0.22088394]
Stock Position:  -0.007939948297740454
Bond Position:  [-3.18521153]


portfolio before change:  [-3.97928639]
curr_Stock_Price:  99.90977617692963
curr_Factors:  [99.90977618 -1.38540788 -0.92310112]
mat_Sqrt:  [[ 9.93196704  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00976355  0.04369314 -0.30822153]
Stock Position:  -0.009763548297402821
Bond Position:  [-3.00381247]


portfolio before change:  [-3.97937993]
curr_Stock_Price:  99.84243291191082
curr_Factors:  [99.84243291 -0.90492932 -0.92589733]
mat_Sqrt:  [[16.00284662  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00972443 -0.02780717  0.51422306]
Stock Position:  -0.009724427944860177
Bond Position:  [-3.00846939]


portfolio before change:  [-3.9903172]
curr_Stock_Price:  100.8898014331104
curr_Factors:  [100.88980143  -0.7203221   -0.94974926]
mat_Sqrt:  [[18.99085393  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00230973  0.01501882 -0.03367515]
Stock Position:  0.0023097268908973054
Bond Position:  [-4.22334509]


portfolio before change:  [-3.99027419]
curr_Stock_Price:  101.36560524314567
curr_Factors:  [101.36560524  -0.56403926  -0.94015286]
mat_Sqrt:  [[22.52310601  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00267402  0.02012468 -0.04085329]
Stock Position:  0.002674020117739711
Bond Position:  [-4.26132786]


portfolio before change:  [-3.98944988]
curr_Stock_Price:  102.07232260409968
curr_Factors:  [102.0723226   -0.69715036  -0.97470935]
mat_Sqrt:  [[19.17911451  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00827788 -0.00423812 -0.4942821 ]
Stock Position:  0.008277879601343654
Bond Position:  [-4.83439228]


portfolio before change:  [-3.98582236]
curr_Stock_Price:  102.65656359763221
curr_Factors:  [102.6565636   -0.63888294  -1.006317  ]
mat_Sqrt:  [[19.81004527  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00101327 -0.00453226 -0.79881181]
Stock Position:  -0.0010132698898189924
Bond Position:  [-3.88180355]


portfolio before change:  [-3.98838299]
curr_Stock_Price:  104.22580103719969
curr_Factors:  [104.22580104  -0.85342225  -1.03456011]
mat_Sqrt:  [[15.77738133  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00541045  0.00834056 -0.09859414]
Stock Position:  -0.005410448958929914
Bond Position:  [-3.42447461]


portfolio before change:  [-3.98690264]
curr_Stock_Price:  103.79393812514563
curr_Factors:  [103.79393813  -1.03158993  -1.07413699]
mat_Sqrt:  [[12.63765253  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00506898  0.01835784  0.65357915]
Stock Position:  -0.005068983357400868
Bond Position:  [-3.4607729]


portfolio before change:  [-3.98269499]
curr_Stock_Price:  102.79315554111422
curr_Factors:  [102.79315554  -0.69421522  -1.06052993]
mat_Sqrt:  [[17.77821125  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0009151  -0.02900588  0.37616434]
Stock Position:  -0.0009150950083711341
Bond Position:  [-3.88862949]


portfolio before change:  [-3.9832002]
curr_Stock_Price:  102.28274130887074
curr_Factors:  [102.28274131  -0.51129341  -1.00993447]
mat_Sqrt:  [[22.34299993  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [4.01069343e-04 1.08325436e-02 4.27039456e-01]
Stock Position:  0.0004010693433874804
Bond Position:  [-4.02422267]


portfolio before change:  [-3.98462327]
curr_Stock_Price:  101.2432983195824
curr_Factors:  [101.24329832  -0.33465564  -1.02757986]
mat_Sqrt:  [[25.92715848  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00140597  0.01854279 -0.26574376]
Stock Position:  -0.0014059734138794026
Bond Position:  [-3.84227788]


portfolio before change:  [-3.9827702]
curr_Stock_Price:  99.24200914159682
curr_Factors:  [99.24200914 -0.15721473 -0.99636246]
mat_Sqrt:  [[31.31146151  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01498079 -0.31842042 -0.71599822]
Stock Position:  -0.014980792513223916
Bond Position:  [-2.49604625]


portfolio before change:  [-3.95283338]
curr_Stock_Price:  97.20200299953719
curr_Factors:  [97.202003   -0.10340092 -1.00348066]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-3.95283338]
Stock Price:  97.7005172436755
PL:  [-3.95283338]
Settle:  Tensor("sub_162:0", shape=(), dtype=float64)
PL:  Tensor("sub_163:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  82
output_Z_Vals[:, i, :]:  [[ 1.19251512e+02 -2.92846752e+01 -2.92776944e+01]
 [-8.17307298e-02  8.94906163e-03 -9.69119756e-02]
 [-2.98836623e-01 -4.11002094e-02  1.97073638e-01]
 [-4.00933097e-02 -1.41942461e-01 -4.53332118e-01]
 [-9.88296441e-02 -2.41910939e-01  2.15109929e-01]
 [-2.21268640e-02  8.50063689e-03 -1.05846606e-02]
 [ 5.55339762e-02  3.47965368e-02 -1.85073668e-02]
 [-1.18768129e-01  1.89130588e-01 -8.06269339e-02]
 [-5.88084887e-02 -1.65456591e-02  1.77517988e-02]
 [ 5.90265007e-03  1.65925049e-02 -1.76976112e-02]
 [ 1.79714618e-01 -4.97511338e-02 -5.36751401e-02]
 [-1.14404268e-01  3.55627855e-02  2.64553029e-02]
 [ 4.24933761e-02 -1.09502661e-02 -2.02219196e-01]
 [-5.99009680e-02  1.49116828e-02 -2.96432337e-02]
 [-9.84592258e-02  3.50082320e-02  1.93527160e-01]
 [ 1.32816516e-02 -1.22122300e-02  9.31607089e-02]
 [-2.40248481e-02  4.50728110e-02  1.42401509e-01]
 [ 1.56743269e-02  1.38885206e-02 -6.10090302e-02]
 [-3.01217716e-01 -7.88346916e-01 -1.28253744e-01]
 [ 1.32186801e-01 -1.56725983e-01 -2.44724567e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.25151208 -29.28467519 -29.2776944 ]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  8.31409947  -9.26062741 -83.52111278]
init_Out:  [2.49223638]
Stock Position:  8.314099471154409
Bond position:  [-828.91771073]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [2.08265512]
curr_Stock_Price:  99.97566472049661
curr_Factors:  [99.97566472 -0.86619888 -1.02177257]
mat_Sqrt:  [[15.13417387  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00669225  0.00282994 -0.27646289]
Stock Position:  -0.006692254301254367
Bond Position:  [2.75171769]


portfolio before change:  [2.07859445]
curr_Stock_Price:  100.685243762905
curr_Factors:  [100.68524376  -1.00521386  -1.0018548 ]
mat_Sqrt:  [[13.53028626  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01919178 -0.01299703  0.56219623]
Stock Position:  -0.019191784510052746
Bond Position:  [4.01092395]


portfolio before change:  [2.0533185]
curr_Stock_Price:  102.05451741432562
curr_Factors:  [102.05451741  -0.84828952  -0.97781333]
mat_Sqrt:  [[16.43485369  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.008293   -0.04488615 -1.29323035]
Stock Position:  -0.008293002290976416
Bond Position:  [2.89965685]


portfolio before change:  [2.05744408]
curr_Stock_Price:  101.64446403384365
curr_Factors:  [101.64446403  -0.86056395  -0.95905912]
mat_Sqrt:  [[16.4752294   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00371264 -0.07649896  0.61364875]
Stock Position:  -0.00371264191713458
Bond Position:  [2.43481358]


portfolio before change:  [2.06897823]
curr_Stock_Price:  98.70171552812091
curr_Factors:  [98.70171553 -1.00156326 -0.92949997]
mat_Sqrt:  [[14.31115206  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00168176  0.00268814 -0.03019509]
Stock Position:  -0.00168176281144197
Bond Position:  [2.2349711]


portfolio before change:  [2.06655076]
curr_Stock_Price:  100.47740314945756
curr_Factors:  [100.47740315  -0.95209357  -0.92460648]
mat_Sqrt:  [[15.38253546  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00342301  0.01100363 -0.05279637]
Stock Position:  0.0034230129742493223
Bond Position:  [1.7226153]


portfolio before change:  [2.07122794]
curr_Stock_Price:  101.71796922893105
curr_Factors:  [101.71796923  -1.04299759  -0.91090779]
mat_Sqrt:  [[14.41542189  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00904189  0.05980834 -0.2300062 ]
Stock Position:  -0.009041893013929558
Bond Position:  [2.99095093]


portfolio before change:  [2.06245986]
curr_Stock_Price:  102.77039418930548
curr_Factors:  [102.77039419  -1.10761165  -0.89217699]
mat_Sqrt:  [[13.91140036  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00399759 -0.0052322   0.05064094]
Stock Position:  -0.00399759359519356
Bond Position:  [2.47329413]


portfolio before change:  [2.05653498]
curr_Stock_Price:  104.4071974913117
curr_Factors:  [104.40719749  -1.08308837  -0.92439113]
mat_Sqrt:  [[14.02468671  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00019384  0.00524701 -0.05048636]
Stock Position:  0.00019384083236713174
Bond Position:  [2.0362966]


portfolio before change:  [2.05708918]
curr_Stock_Price:  104.6396797227817
curr_Factors:  [104.63967972  -0.71500192  -0.89355844]
mat_Sqrt:  [[20.94630942  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00799538 -0.01573269 -0.15312023]
Stock Position:  0.007995377785492476
Bond Position:  [1.22045541]


portfolio before change:  [2.07079511]
curr_Stock_Price:  106.31574423531268
curr_Factors:  [106.31574424  -0.80614657  -0.90195078]
mat_Sqrt:  [[19.26550204  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00561033  0.01124594  0.07546962]
Stock Position:  -0.005610332649364407
Bond Position:  [2.6672618]


portfolio before change:  [2.0821925]
curr_Stock_Price:  104.40311350286878
curr_Factors:  [104.4031135   -0.88143261  -0.85650341]
mat_Sqrt:  [[18.3627375   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 5.07996621e-05 -3.46277819e-03 -5.76875080e-01]
Stock Position:  5.079966206760618e-05
Bond Position:  [2.07688886]


portfolio before change:  [2.0827328]
curr_Stock_Price:  104.81682521482486
curr_Factors:  [104.81682521  -1.06976944  -0.89887557]
mat_Sqrt:  [[14.63724473  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00447945  0.00471549 -0.08456389]
Stock Position:  -0.004479452997061382
Bond Position:  [2.55225484]


portfolio before change:  [2.09481383]
curr_Stock_Price:  102.26229829899127
curr_Factors:  [102.2622983   -0.81160939  -0.87986248]
mat_Sqrt:  [[18.84163789  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00308104  0.01107058  0.55207912]
Stock Position:  -0.003081035282132782
Bond Position:  [2.40988758]


portfolio before change:  [2.09953091]
curr_Stock_Price:  100.92685882534623
curr_Factors:  [100.92685883  -0.88596128  -0.84218074]
mat_Sqrt:  [[17.92603397  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00178415 -0.00386185  0.26576157]
Stock Position:  0.0017841471935289073
Bond Position:  [1.91946254]


portfolio before change:  [2.10277337]
curr_Stock_Price:  102.47523594657265
curr_Factors:  [102.47523595  -1.01032974  -0.85531484]
mat_Sqrt:  [[15.86279753  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [3.91262203e-04 1.42532743e-02 4.06231867e-01]
Stock Position:  0.0003912622027513691
Bond Position:  [2.06267868]


portfolio before change:  [2.10233063]
curr_Stock_Price:  100.02552558591282
curr_Factors:  [100.02552559  -0.75612603  -0.84885043]
mat_Sqrt:  [[20.09455652  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00017813  0.00439194 -0.17404178]
Stock Position:  0.00017813335605253584
Bond Position:  [2.08451274]


portfolio before change:  [2.10261011]
curr_Stock_Price:  98.66861050577091
curr_Factors:  [98.66861051 -0.87525687 -0.82410985]
mat_Sqrt:  [[18.03654804  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01928043 -0.24929718 -0.36587223]
Stock Position:  -0.01928043167000575
Bond Position:  [4.00498351]


portfolio before change:  [2.11628723]
curr_Stock_Price:  98.01116922562197
curr_Factors:  [98.01116923 -0.36351273 -0.82445429]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [2.11628723]
Stock Price:  98.98851709383561
PL:  [2.11628723]
Settle:  Tensor("sub_164:0", shape=(), dtype=float64)
PL:  Tensor("sub_165:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  83
output_Z_Vals[:, i, :]:  [[ 1.19251512e+02 -2.92846752e+01 -2.92776944e+01]
 [-1.04453813e-01  1.14468429e-02 -1.08599962e-01]
 [-4.98643404e-01 -8.64906318e-02  3.51908527e-01]
 [ 1.72197457e-01 -1.64683016e-01 -4.69863188e-01]
 [-9.88296441e-02 -2.41910939e-01  2.15109929e-01]
 [-3.70713920e-01  1.14178090e-01  2.94304158e-03]
 [ 5.15987470e-02  1.00269068e-01 -4.41835282e-02]
 [-1.88023800e-01  2.68467122e-01 -4.66456806e-02]
 [-2.93460900e-02  4.25184447e-04 -2.81009411e-02]
 [-3.40162496e-02 -1.75986072e-02 -2.81927827e-02]
 [ 2.00330132e-01 -7.53810930e-02 -6.71927874e-02]
 [ 5.25392756e-02 -9.23964581e-03 -1.11968471e-01]
 [ 5.32424181e-02 -5.08653112e-03 -1.05478257e-01]
 [-8.45720117e-02  2.97281712e-02 -3.59999752e-02]
 [-1.10373728e-01  5.53022074e-02  2.26292707e-01]
 [-7.49785644e-02 -1.55396826e-01  1.60911694e-01]
 [-2.61148305e-02  7.40535362e-03  1.99618265e-01]
 [-6.88813214e-02  1.30573227e-01 -8.60484810e-02]
 [-3.02676754e-01 -9.14026611e-01 -9.59186112e-02]
 [ 5.48904509e-02  5.26927895e-03 -3.04981412e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.25151208 -29.28467519 -29.2776944 ]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  8.31409947  -9.26062741 -83.52111278]
init_Out:  [2.49223638]
Stock Position:  8.314099471154409
Bond position:  [-828.91771073]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [1.89279039]
curr_Stock_Price:  99.95282824567686
curr_Factors:  [99.95282825 -0.70512365 -0.98037211]
mat_Sqrt:  [[18.52650839  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00681867  0.00361981 -0.30980546]
Stock Position:  -0.006818669127549898
Bond Position:  [2.57433566]


portfolio before change:  [1.87618443]
curr_Stock_Price:  102.48259353502287
curr_Factors:  [102.48259354  -0.58802874  -0.99285772]
mat_Sqrt:  [[21.09015835  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02034331 -0.02735074  1.00389707]
Stock Position:  -0.020343306511398984
Bond Position:  [3.96101924]


portfolio before change:  [1.84775302]
curr_Stock_Price:  103.92885736060579
curr_Factors:  [103.92885736  -0.39228489  -1.04589389]
mat_Sqrt:  [[24.66851708  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00292012 -0.05207734 -1.34038889]
Stock Position:  0.002920116283856682
Bond Position:  [1.54426867]


portfolio before change:  [1.84822595]
curr_Stock_Price:  103.95858916582739
curr_Factors:  [103.95858917  -0.78894467  -1.05063839]
mat_Sqrt:  [[16.51732075  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00370318 -0.07649896  0.61364875]
Stock Position:  -0.0037031809325109954
Bond Position:  [2.23320342]


portfolio before change:  [1.85012251]
curr_Stock_Price:  103.59722629190274
curr_Factors:  [103.59722629  -0.71696777  -1.09925792]
mat_Sqrt:  [[16.84889135  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02179165  0.03610628  0.00839568]
Stock Position:  -0.021791647969927202
Bond Position:  [4.1076768]


portfolio before change:  [1.84671605]
curr_Stock_Price:  103.80067633794312
curr_Factors:  [103.80067634  -0.39510774  -1.07513176]
mat_Sqrt:  [[23.86070534  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00189302  0.03170786 -0.12604331]
Stock Position:  0.0018930185711509139
Bond Position:  [1.65021944]


portfolio before change:  [1.84915366]
curr_Stock_Price:  104.87039734468412
curr_Factors:  [104.87039734  -0.84127186  -1.05472403]
mat_Sqrt:  [[15.74825223  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01210379  0.08489676 -0.13306714]
Stock Position:  -0.012103788742623862
Bond Position:  [3.11848279]


portfolio before change:  [1.85044565]
curr_Stock_Price:  104.82807410706607
curr_Factors:  [104.82807411  -1.09355697  -1.08223229]
mat_Sqrt:  [[11.89992814  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00294718  0.00013446 -0.08016416]
Stock Position:  -0.002947176819311186
Bond Position:  [2.15939252]


portfolio before change:  [1.84949081]
curr_Stock_Price:  105.33525716698176
curr_Factors:  [105.33525717  -1.28248483  -1.09982247]
mat_Sqrt:  [[ 9.72637127  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00413571 -0.00556517 -0.08042616]
Stock Position:  -0.004135712102128977
Bond Position:  [2.2851271]


portfolio before change:  [1.84969839]
curr_Stock_Price:  105.42321471627446
curr_Factors:  [105.42321472  -1.04506926  -1.07729415]
mat_Sqrt:  [[12.62424865  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01462805 -0.02383759 -0.19168232]
Stock Position:  0.01462804918982414
Bond Position:  [0.30756242]


portfolio before change:  [1.82601038]
curr_Stock_Price:  103.79860195503133
curr_Factors:  [103.79860196  -0.82845727  -1.08463048]
mat_Sqrt:  [[15.32314994  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00192162 -0.00292183 -0.31941488]
Stock Position:  0.0019216179834106392
Bond Position:  [1.62654912]


portfolio before change:  [1.82740683]
curr_Stock_Price:  104.31366913196507
curr_Factors:  [104.31366913  -1.49685879  -1.0917085 ]
mat_Sqrt:  [[ 7.83683548  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00402974 -0.0016085  -0.30090011]
Stock Position:  0.004029742031639583
Bond Position:  [1.40704965]


portfolio before change:  [1.82744537]
curr_Stock_Price:  104.23593031205353
curr_Factors:  [104.23593031  -1.72127792  -1.12346927]
mat_Sqrt:  [[ 6.06121153  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01503873  0.00940087 -0.10269791]
Stock Position:  -0.015038725720759755
Bond Position:  [3.39502093]


portfolio before change:  [1.83547118]
curr_Stock_Price:  103.75869899996187
curr_Factors:  [103.758699    -1.49839417  -1.11772762]
mat_Sqrt:  [[ 7.58328293  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00827531  0.01748809  0.64555011]
Stock Position:  -0.008275311186402718
Bond Position:  [2.6941067]


portfolio before change:  [1.83765214]
curr_Stock_Price:  103.57654829287372
curr_Factors:  [103.57654829  -1.56285177  -1.14158648]
mat_Sqrt:  [[ 6.93008919  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00665863 -0.04914079  0.45903627]
Stock Position:  -0.006658634544149844
Bond Position:  [2.52733053]


portfolio before change:  [1.83379967]
curr_Stock_Price:  104.25001793850412
curr_Factors:  [104.25001794  -1.10831347  -1.14879632]
mat_Sqrt:  [[10.91002672  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00135868 0.00234178 0.56945535]
Stock Position:  0.0013586843456981424
Bond Position:  [1.6921568]


portfolio before change:  [1.83373426]
curr_Stock_Price:  103.89048284201634
curr_Factors:  [103.89048284  -1.11306319  -1.14078237]
mat_Sqrt:  [[10.90794838  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00761596  0.04129088 -0.24547237]
Stock Position:  -0.007615960848192221
Bond Position:  [2.62496011]


portfolio before change:  [1.83084537]
curr_Stock_Price:  104.35598121422578
curr_Factors:  [104.35598121  -1.36931672  -1.09963113]
mat_Sqrt:  [[ 8.83622812  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0391407  -0.28904059 -0.2736291 ]
Stock Position:  -0.039140696583659894
Bond Position:  [5.91541117]


portfolio before change:  [1.81228371]
curr_Stock_Price:  104.86799811869335
curr_Factors:  [104.86799812  -1.49364063  -1.11853498]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [1.81228371]
Stock Price:  105.76413269513252
PL:  [-3.95184899]
Settle:  Tensor("sub_166:0", shape=(), dtype=float64)
PL:  Tensor("sub_167:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  84
output_Z_Vals[:, i, :]:  [[ 1.19251512e+02 -2.92846752e+01 -2.92776944e+01]
 [ 2.21172648e-02 -7.06795160e-02 -1.97651432e-01]
 [-5.72273295e-01 -1.02424012e-01  4.15240080e-01]
 [-3.52514505e-02 -1.71332992e-01 -5.37646755e-01]
 [-9.88296441e-02 -2.41910939e-01  2.15109929e-01]
 [-2.27426481e-01 -1.98951367e-02  2.79461564e-02]
 [ 5.25535562e-02  8.43833934e-02 -3.79536920e-02]
 [-1.60389341e-01  2.47547598e-01 -8.00926240e-02]
 [ 1.08422637e-02  1.27291805e-03 -2.12184021e-02]
 [-4.33450197e-02 -2.43569481e-02 -3.03013965e-02]
 [ 2.03611952e-01 -7.89143428e-02 -6.87886216e-02]
 [-4.63963928e-03 -7.47902996e-03 -8.75783206e-02]
 [ 4.96596242e-02 -7.38419990e-03 -1.55300938e-01]
 [-8.45720117e-02  2.97281712e-02 -3.59999752e-02]
 [-1.00297131e-01  3.90206916e-02  2.02505239e-01]
 [-2.18107387e-02 -5.96829865e-02  1.16475501e-01]
 [-2.44726650e-02  6.61656466e-02  1.17254072e-01]
 [-2.61713989e-02  6.99354178e-02 -8.96456828e-02]
 [-3.48272425e-01 -9.52772563e-01 -1.85877908e-01]
 [ 6.95648494e-02 -2.84539172e-02 -7.40815109e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.25151208 -29.28467519 -29.2776944 ]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  8.31409947  -9.26062741 -83.52111278]
init_Out:  [2.49223638]
Stock Position:  8.314099471154409
Bond position:  [-828.91771073]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [9.36947687]
curr_Stock_Price:  100.85210621330332
curr_Factors:  [100.85210621  -1.23486689  -0.99240991]
mat_Sqrt:  [[10.87404057  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00184413 -0.02235083 -0.56384452]
Stock Position:  -0.0018441261044589159
Bond Position:  [9.55546087]


portfolio before change:  [9.36961689]
curr_Stock_Price:  102.07172869879761
curr_Factors:  [102.0717287   -1.49020842  -1.02828621]
mat_Sqrt:  [[ 8.22502356  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.05959343 -0.03238932  1.18456437]
Stock Position:  -0.05959342746654735
Bond Position:  [15.45242106]


portfolio before change:  [9.33868388]
curr_Stock_Price:  102.655628662398
curr_Factors:  [102.65562866  -1.55254378  -1.04716437]
mat_Sqrt:  [[ 7.62682643  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01959163 -0.05418025 -1.53375654]
Stock Position:  -0.019591626327382324
Bond Position:  [11.3498746]


portfolio before change:  [9.34695419]
curr_Stock_Price:  102.3783427281133
curr_Factors:  [102.37834273  -1.42373944  -1.05355648]
mat_Sqrt:  [[ 8.59670742  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00711512 -0.07649896  0.61364875]
Stock Position:  -0.00711512260279942
Bond Position:  [10.07538865]


portfolio before change:  [9.34633592]
curr_Stock_Price:  102.81929570010735
curr_Factors:  [102.8192957   -1.40605642  -1.08645455]
mat_Sqrt:  [[ 8.50336578  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02613503 -0.00629139  0.07972261]
Stock Position:  -0.026135026024766028
Bond Position:  [12.03352089]


portfolio before change:  [9.33142262]
curr_Stock_Price:  103.50504397501
curr_Factors:  [103.50504398  -1.27056308  -1.10420753]
mat_Sqrt:  [[ 9.62967745  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00487919  0.02668437 -0.10827132]
Stock Position:  0.004879193653012366
Bond Position:  [8.82640147]


portfolio before change:  [9.33592792]
curr_Stock_Price:  103.97610987899442
curr_Factors:  [103.97610988  -1.51403204  -1.11567454]
mat_Sqrt:  [[ 7.49663741  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02272306  0.07828142 -0.22848196]
Stock Position:  -0.022723058112536117
Bond Position:  [11.69858311]


portfolio before change:  [9.34661222]
curr_Stock_Price:  103.6346379667008
curr_Factors:  [103.63463797  -1.13291587  -1.12214383]
mat_Sqrt:  [[10.86788288  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00060214  0.00040253 -0.0605302 ]
Stock Position:  0.0006021358731459144
Bond Position:  [9.28421009]


portfolio before change:  [9.3500713]
curr_Stock_Price:  105.52413590548315
curr_Factors:  [105.52413591  -1.10947354  -1.17393835]
mat_Sqrt:  [[10.75668918  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00466307 -0.00770234 -0.08644145]
Stock Position:  -0.004663066787589114
Bond Position:  [9.84213739]


portfolio before change:  [9.35259947]
curr_Stock_Price:  105.50969620449982
curr_Factors:  [105.5096962   -0.99159833  -1.13952963]
mat_Sqrt:  [[12.52435183  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01497347 -0.02495491 -0.19623479]
Stock Position:  0.014973467399124087
Bond Position:  [7.77275348]


portfolio before change:  [9.33690735]
curr_Stock_Price:  104.33190927359472
curr_Factors:  [104.33190927  -0.81416992  -1.12660398]
mat_Sqrt:  [[14.98130904  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00151586 -0.00236508 -0.24983657]
Stock Position:  -0.0015158619825620906
Bond Position:  [9.49506012]


portfolio before change:  [9.34085406]
curr_Stock_Price:  103.29444835948107
curr_Factors:  [103.29444836  -1.31564962  -1.11026222]
mat_Sqrt:  [[ 9.1309687   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00194594 -0.00233509 -0.44303035]
Stock Position:  0.0019459374255689802
Bond Position:  [9.13984953]


portfolio before change:  [9.34329006]
curr_Stock_Price:  103.37191808452393
curr_Factors:  [103.37191808  -1.27505172  -1.11010611]
mat_Sqrt:  [[ 9.5179121   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00957698  0.00940087 -0.10269791]
Stock Position:  -0.009576984617017727
Bond Position:  [10.33328133]


portfolio before change:  [9.34805134]
curr_Stock_Price:  103.14453523294729
curr_Factors:  [103.14453523  -0.93643967  -1.07456771]
mat_Sqrt:  [[13.8062844   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00419761  0.01233943  0.57769108]
Stock Position:  -0.004197611065469257
Bond Position:  [9.78101199]


portfolio before change:  [9.35536475]
curr_Stock_Price:  101.98486461651822
curr_Factors:  [101.98486462  -0.85111123  -1.03744511]
mat_Sqrt:  [[15.42929663  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 2.74617324e-05 -1.88734175e-02  3.32272182e-01]
Stock Position:  2.74617324461018e-05
Bond Position:  [9.35256407]


portfolio before change:  [9.35770167]
curr_Stock_Price:  101.92990767897955
curr_Factors:  [101.92990768  -1.08225834  -1.07323473]
mat_Sqrt:  [[11.80817785  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [9.90933437e-05 2.09234146e-02 3.34493230e-01]
Stock Position:  9.909334369363988e-05
Bond Position:  [9.3476011]


portfolio before change:  [9.36009793]
curr_Stock_Price:  102.52599380633177
curr_Factors:  [102.52599381  -0.85480112  -1.03442886]
mat_Sqrt:  [[15.50071855  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00275242  0.02211552 -0.25573418]
Stock Position:  -0.0027524222431757296
Bond Position:  [9.64229276]


portfolio before change:  [9.36211022]
curr_Stock_Price:  102.67080866977754
curr_Factors:  [102.67080867  -0.69082486  -1.03790132]
mat_Sqrt:  [[18.2251346   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02254113 -0.30129314 -0.53025793]
Stock Position:  -0.02254112714355808
Bond Position:  [11.67642597]


portfolio before change:  [9.37377451]
curr_Stock_Price:  102.28285908819532
curr_Factors:  [102.28285909  -0.89262635  -1.07821096]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [9.37377451]
Stock Price:  104.24062495773921
PL:  [5.13314955]
Settle:  Tensor("sub_168:0", shape=(), dtype=float64)
PL:  Tensor("sub_169:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  85
output_Z_Vals[:, i, :]:  [[ 1.19251512e+02 -2.92846752e+01 -2.92776944e+01]
 [-1.39891769e-01  2.16018674e-02 -8.96848669e-02]
 [-5.32383689e-02  2.55965727e-02  9.29968654e-02]
 [ 2.48024878e-01 -1.87860574e-01 -5.17361494e-01]
 [-9.88296441e-02 -2.41910939e-01  2.15109929e-01]
 [-4.46586523e-01  1.43207455e-01  4.06273831e-03]
 [ 5.31580231e-02  7.43265506e-02 -3.40097308e-02]
 [-1.36429190e-01  2.03963522e-01 -6.13472026e-02]
 [-8.99492018e-02 -4.64597012e-02  8.75382555e-02]
 [ 4.85618310e-02  4.41121281e-02 -1.01695816e-02]
 [ 5.49562860e-02  6.77220282e-02 -1.40273471e-02]
 [ 8.66801124e-02 -1.02408622e-02 -1.26712875e-01]
 [ 4.66379769e-02 -1.01971468e-02 -2.42141213e-01]
 [-8.33022401e-02  3.01215969e-02 -3.31270676e-02]
 [-6.49486916e-02 -1.74410661e-02  8.94632591e-02]
 [-3.32475109e-02 -8.06346353e-02  1.26117290e-01]
 [-2.59424619e-02  8.57287043e-02  9.84219339e-02]
 [-1.35244148e-02  5.65401562e-02 -7.80871566e-02]
 [-2.67781163e-01 -8.32679305e-01 -4.47625843e-02]
 [ 5.84754098e-02 -2.96930554e-03 -4.11455684e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.25151208 -29.28467519 -29.2776944 ]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  8.31409947  -9.26062741 -83.52111278]
init_Out:  [2.49223638]
Stock Position:  8.314099471154409
Bond position:  [-828.91771073]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-0.13705691]
curr_Stock_Price:  99.70868306645957
curr_Factors:  [99.70868307 -0.86762829 -1.01563839]
mat_Sqrt:  [[15.16493845  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01039509  0.00683111 -0.25584596]
Stock Position:  -0.010395087244883361
Bond Position:  [0.89942355]


portfolio before change:  [-0.13501631]
curr_Stock_Price:  99.53401273888016
curr_Factors:  [99.53401274 -0.35500874 -1.04372531]
mat_Sqrt:  [[24.57587762  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00136697  0.00809435  0.26529417]
Stock Position:  -0.0013669730576346512
Bond Position:  [0.001044]


portfolio before change:  [-0.14224219]
curr_Stock_Price:  104.82024236933299
curr_Factors:  [104.82024237  -0.56616871  -1.04843353]
mat_Sqrt:  [[20.85606215  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00659609 -0.05940673 -1.47588834]
Stock Position:  0.006596085333059341
Bond Position:  [-0.83364545]


portfolio before change:  [-0.1505518]
curr_Stock_Price:  103.59206279526379
curr_Factors:  [103.5920628   -0.72832581  -1.05944825]
mat_Sqrt:  [[17.33429071  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00352865 -0.07649896  0.61364875]
Stock Position:  -0.003528648981503477
Bond Position:  [0.21498823]


portfolio before change:  [-0.15339607]
curr_Stock_Price:  104.4133466730544
curr_Factors:  [104.41334667  -0.90439988  -1.05693056]
mat_Sqrt:  [[14.68794467  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.03009677  0.04528617  0.01158986]
Stock Position:  -0.03009676502657275
Bond Position:  [2.98910789]


portfolio before change:  [-0.10244518]
curr_Stock_Price:  102.74527648501643
curr_Factors:  [102.74527649  -0.88689165  -1.05342426]
mat_Sqrt:  [[14.7602385   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00326112  0.02350412 -0.0970203 ]
Stock Position:  0.003261120688366226
Bond Position:  [-0.43750993]


portfolio before change:  [-0.10445113]
curr_Stock_Price:  102.16371090603784
curr_Factors:  [102.16371091  -0.61356501  -1.03861227]
mat_Sqrt:  [[19.5778584   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00733917  0.06449893 -0.17500649]
Stock Position:  -0.007339174520134614
Bond Position:  [0.64534617]


portfolio before change:  [-0.0984344]
curr_Stock_Price:  101.36588590800488
curr_Factors:  [101.36588591  -1.00294351  -1.00846386]
mat_Sqrt:  [[13.56277952  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00540303 -0.01469185  0.24972228]
Stock Position:  -0.005403030731901548
Bond Position:  [0.4492486]


portfolio before change:  [-0.10276228]
curr_Stock_Price:  102.18768604273133
curr_Factors:  [102.18768604  -1.15830143  -1.0383138 ]
mat_Sqrt:  [[11.36110806  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00419193  0.01394948 -0.02901099]
Stock Position:  0.0041919277436683324
Bond Position:  [-0.53112568]


portfolio before change:  [-0.10667307]
curr_Stock_Price:  101.28643318138595
curr_Factors:  [101.28643318  -1.03871778  -1.05131866]
mat_Sqrt:  [[12.52737231  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00429791  0.02141559 -0.04001612]
Stock Position:  0.004297911782358642
Bond Position:  [-0.54199322]


portfolio before change:  [-0.11224562]
curr_Stock_Price:  100.02139035017208
curr_Factors:  [100.02139035  -0.94425661  -1.03386749]
mat_Sqrt:  [[13.83580731  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00437636 -0.00323844 -0.36147656]
Stock Position:  0.004376364592520414
Bond Position:  [-0.5499757]


portfolio before change:  [-0.1065346]
curr_Stock_Price:  101.3577825593494
curr_Factors:  [101.35778256  -1.08757263  -1.06583987]
mat_Sqrt:  [[11.76635471  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-2.59398973e-04 -3.22462095e-03 -6.90761481e-01]
Stock Position:  -0.0002593989727292853
Bond Position:  [-0.08024249]


portfolio before change:  [-0.10633429]
curr_Stock_Price:  100.50824497152624
curr_Factors:  [100.50824497  -1.26138922  -1.07121889]
mat_Sqrt:  [[ 9.75355326  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00915426  0.00952529 -0.0945023 ]
Stock Position:  -0.00915425750799619
Bond Position:  [0.81374407]


portfolio before change:  [-0.11447189]
curr_Stock_Price:  101.41941282868264
curr_Factors:  [101.41941283  -1.06135828  -1.08662163]
mat_Sqrt:  [[11.83764386  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00398199 -0.00551535  0.25521378]
Stock Position:  -0.0039819923037565826
Bond Position:  [0.28937943]


portfolio before change:  [-0.11713778]
curr_Stock_Price:  102.10706768659678
curr_Factors:  [102.10706769  -1.31675319  -1.11398724]
mat_Sqrt:  [[ 8.98252942  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00106717 -0.02549891  0.35977752]
Stock Position:  -0.0010671720300212573
Bond Position:  [-0.00817197]


portfolio before change:  [-0.11667956]
curr_Stock_Price:  101.67577569589527
curr_Factors:  [101.6757757   -1.4167402   -1.08693957]
mat_Sqrt:  [[ 8.31540081  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00043758  0.0271098   0.28077038]
Stock Position:  -0.00043758121406143897
Bond Position:  [-0.07218815]


portfolio before change:  [-0.11717601]
curr_Stock_Price:  102.76906169251009
curr_Factors:  [102.76906169  -1.58176777  -1.09812433]
mat_Sqrt:  [[ 7.04693139  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00397393  0.01787957 -0.22276092]
Stock Position:  -0.003973932309012615
Bond Position:  [0.29122129]


portfolio before change:  [-0.11890892]
curr_Stock_Price:  103.22345415358635
curr_Factors:  [103.22345415  -1.64904189  -1.06207546]
mat_Sqrt:  [[ 6.86048919  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.04349806 -0.26331632 -0.12769519]
Stock Position:  -0.04349806060342371
Bond Position:  [4.37111115]


portfolio before change:  [-0.14907118]
curr_Stock_Price:  103.94199610297484
curr_Factors:  [103.9419961   -1.385998    -1.10433312]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-0.14907118]
Stock Price:  103.82148992037914
PL:  [-3.9705611]
Settle:  Tensor("sub_170:0", shape=(), dtype=float64)
PL:  Tensor("sub_171:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  86
output_Z_Vals[:, i, :]:  [[ 1.19251512e+02 -2.92846752e+01 -2.92776944e+01]
 [ 5.70910159e-03 -8.35375594e-02 -2.29258646e-01]
 [-5.83822189e-01 -1.04923173e-01  4.25173674e-01]
 [-7.45918404e-03 -1.69470362e-01 -5.27666403e-01]
 [-9.88296441e-02 -2.41910939e-01  2.15109929e-01]
 [-2.81964910e-01  8.14051900e-03  2.72988245e-02]
 [ 5.19614501e-02  9.42345811e-02 -4.18170020e-02]
 [-1.58707173e-01  2.45774465e-01 -8.18045986e-02]
 [-2.93920548e-02 -9.80823453e-04 -2.59652602e-02]
 [-2.99134299e-02 -1.44181027e-02 -2.71591333e-02]
 [ 2.26974223e-01 -1.08524403e-01 -8.46821036e-02]
 [-1.27094397e-01  2.35225879e-02  1.66695118e-02]
 [ 5.02668983e-02 -6.28697226e-03 -1.10606910e-01]
 [-8.45720117e-02  2.97281712e-02 -3.59999752e-02]
 [-1.50911865e-01  1.12433715e-01  2.84756729e-01]
 [-1.24154163e-01 -2.45997847e-01  2.02487067e-01]
 [-2.97152420e-02  1.33440115e-02  2.07336917e-01]
 [-1.01351362e-01  1.81193751e-01 -7.07994366e-02]
 [-3.01077725e-01 -9.44113913e-01 -9.30142639e-02]
 [ 4.61704021e-02  2.53087999e-02 -4.59935489e-03]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.25151208 -29.28467519 -29.2776944 ]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  8.31409947  -9.26062741 -83.52111278]
init_Out:  [2.49223638]
Stock Position:  8.314099471154409
Bond position:  [-828.91771073]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [13.48620715]
curr_Stock_Price:  101.34725668539923
curr_Factors:  [101.34725669  -1.06012755  -1.00653959]
mat_Sqrt:  [[12.83127643  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00337028 -0.0264169  -0.6540111 ]
Stock Position:  -0.003370284658894219
Bond Position:  [13.82777625]


portfolio before change:  [13.48674117]
curr_Stock_Price:  102.21464839397105
curr_Factors:  [102.21464839  -1.38872045  -1.0232433 ]
mat_Sqrt:  [[ 9.16242837  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.05454265 -0.03317962  1.21290215]
Stock Position:  -0.05454264536771283
Bond Position:  [19.06179848]


portfolio before change:  [13.45560227]
curr_Stock_Price:  102.87293948825989
curr_Factors:  [102.87293949  -1.4341325   -1.01540823]
mat_Sqrt:  [[ 8.88135288  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01346015 -0.05359123 -1.50528537]
Stock Position:  -0.013460150159331004
Bond Position:  [14.84028749]


portfolio before change:  [13.45404399]
curr_Stock_Price:  103.26437812660107
curr_Factors:  [103.26437813  -1.48882735  -0.97768554]
mat_Sqrt:  [[ 8.76511458  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00697842 -0.07649896  0.61364875]
Stock Position:  -0.006978417304024376
Bond Position:  [14.17466591]


portfolio before change:  [13.45653554]
curr_Stock_Price:  103.41520809005813
curr_Factors:  [103.41520809  -1.45481076  -0.98442922]
mat_Sqrt:  [[ 9.02061084  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.03061682  0.00257426  0.07787595]
Stock Position:  -0.030616815020804048
Bond Position:  [16.62277984]


portfolio before change:  [13.43927245]
curr_Stock_Price:  104.11480105795567
curr_Factors:  [104.11480106  -1.48296673  -0.94533777]
mat_Sqrt:  [[ 9.18149138  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00499469  0.02979959 -0.11929227]
Stock Position:  0.004994691480825516
Bond Position:  [12.91925114]


portfolio before change:  [13.44231109]
curr_Stock_Price:  104.07644588607319
curr_Factors:  [104.07644589  -1.60594252  -0.96648222]
mat_Sqrt:  [[ 7.94625659  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02127538  0.07772071 -0.23336575]
Stock Position:  -0.021275376107673213
Bond Position:  [15.65657662]


portfolio before change:  [13.41688879]
curr_Stock_Price:  105.45536067644355
curr_Factors:  [105.45536068  -1.54747957  -0.99646589]
mat_Sqrt:  [[ 8.28413536  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00419084 -0.00031016 -0.07407166]
Stock Position:  -0.0041908436580098815
Bond Position:  [13.85883572]


portfolio before change:  [13.42122812]
curr_Stock_Price:  105.24676693491344
curr_Factors:  [105.24676693  -1.1768414   -1.02806769]
mat_Sqrt:  [[11.60456622  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00308754 -0.0045594  -0.07747745]
Stock Position:  -0.0030875379449651096
Bond Position:  [13.74618151]


portfolio before change:  [13.42101827]
curr_Stock_Price:  106.42790955799632
curr_Factors:  [106.42790956  -1.50632933  -1.0490427 ]
mat_Sqrt:  [[ 8.26554623  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.02502998 -0.03431843 -0.24157447]
Stock Position:  0.025029981991201284
Bond Position:  [10.75712961]


portfolio before change:  [13.40354795]
curr_Stock_Price:  105.6224776930478
curr_Factors:  [105.62247769  -1.19011145  -1.08323415]
mat_Sqrt:  [[10.87564193  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01131744  0.0074385   0.04755348]
Stock Position:  -0.011317437417332602
Bond Position:  [14.59892373]


portfolio before change:  [13.40355949]
curr_Stock_Price:  105.94398504566739
curr_Factors:  [105.94398505  -1.30066983  -1.07813515]
mat_Sqrt:  [[ 9.81690136  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00280404 -0.00198812 -0.31553073]
Stock Position:  0.0028040445153314562
Bond Position:  [13.10648784]


portfolio before change:  [13.40483345]
curr_Stock_Price:  105.22963360876551
curr_Factors:  [105.22963361  -1.61822483  -1.10746051]
mat_Sqrt:  [[ 6.89267744  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0132246   0.00940087 -0.10269791]
Stock Position:  -0.013224599382642989
Bond Position:  [14.7964532]


portfolio before change:  [13.40491565]
curr_Stock_Price:  105.50316734006906
curr_Factors:  [105.50316734  -1.99897878  -1.1197999 ]
mat_Sqrt:  [[ 4.66441437  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01926997  0.03555466  0.81233169]
Stock Position:  -0.019269967996795288
Bond Position:  [15.43795831]


portfolio before change:  [13.41325901]
curr_Stock_Price:  105.27050566753822
curr_Factors:  [105.27050567  -2.00456101  -1.12205228]
mat_Sqrt:  [[ 4.61780736  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01931075 -0.07779135  0.57763924]
Stock Position:  -0.019310745137315784
Bond Position:  [15.44611091]


portfolio before change:  [13.4162361]
curr_Stock_Price:  105.31633113534572
curr_Factors:  [105.31633114  -2.02203934  -1.13549204]
mat_Sqrt:  [[ 4.47916709  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00289156 0.00421975 0.59147451]
Stock Position:  0.0028915576711376536
Bond Position:  [13.11170785]


portfolio before change:  [13.41947161]
curr_Stock_Price:  105.30152136119852
curr_Factors:  [105.30152136  -1.81387792  -1.16106464]
mat_Sqrt:  [[ 5.37568125  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02067177  0.0572985  -0.20197109]
Stock Position:  -0.020671767666686554
Bond Position:  [15.59624019]


portfolio before change:  [13.42098739]
curr_Stock_Price:  105.41683627814365
curr_Factors:  [105.41683628  -1.45101074  -1.1898315 ]
mat_Sqrt:  [[ 7.51634604  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0458256  -0.29855503 -0.2653438 ]
Stock Position:  -0.045825604174461396
Bond Position:  [18.25177761]


portfolio before change:  [13.46291832]
curr_Stock_Price:  104.60140985360134
curr_Factors:  [104.60140985  -1.65493884  -1.19512929]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [13.46291832]
Stock Price:  105.34960919569725
PL:  [8.11330912]
Settle:  Tensor("sub_172:0", shape=(), dtype=float64)
PL:  Tensor("sub_173:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  87
output_Z_Vals[:, i, :]:  [[ 1.19251512e+02 -2.92846752e+01 -2.92776944e+01]
 [-3.20651878e-01  1.20138567e-01  3.34081010e-01]
 [-3.13922749e-01 -8.41751750e-02  2.65502550e-01]
 [-6.89652337e-02  1.08612030e-02 -2.34480506e-02]
 [-8.82399104e-02 -1.53419727e-01  1.25352504e-01]
 [-2.00946978e-01  1.03465049e-01 -2.09039710e-03]
 [-3.20434081e-01 -3.23985127e-01  2.47407282e-01]
 [-6.45531882e-03 -9.57453899e-04 -9.61585294e-02]
 [-3.18443557e-01 -1.65438498e-01  3.57696081e-01]
 [ 1.41986556e-02  1.99340471e-03  1.26044336e-02]
 [-1.35437072e-01  1.61816864e-01  3.77966660e-02]
 [-8.91576297e-02 -9.18915108e-03 -1.26087940e-01]
 [-5.86876245e-03 -2.49256217e-01 -3.26950593e-01]
 [-2.12843715e-02  1.08834686e-02 -1.19731195e-02]
 [ 1.11348156e-02 -5.79141975e-02 -1.09473076e-01]
 [ 1.63407767e-01  2.30354005e-02 -5.51511132e-02]
 [-2.35647895e-02  1.03259148e-01  6.82888801e-02]
 [ 2.79674780e-02 -2.97443577e-03 -1.10139749e-02]
 [-3.07598676e-01 -8.46895146e-01 -1.14201855e-01]
 [ 8.46793871e-02 -6.31885962e-02 -1.18972106e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.25151208 -29.28467519 -29.2776944 ]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  8.31409947  -9.26062741 -83.52111278]
init_Out:  [2.49223638]
Stock Position:  8.314099471154409
Bond position:  [-828.91771073]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-14.60166167]
curr_Stock_Price:  97.96891500034567
curr_Factors:  [97.968915   -0.73454865 -0.98505089]
mat_Sqrt:  [[17.54994277  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01420836  0.03799115  0.95304013]
Stock Position:  -0.014208360460180269
Bond Position:  [-13.20968401]


portfolio before change:  [-14.5935951]
curr_Stock_Price:  97.16872399986819
curr_Factors:  [97.168724   -0.81294029 -0.98073415]
mat_Sqrt:  [[16.16380444  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01620291 -0.02661853  0.75740487]
Stock Position:  -0.01620290954755596
Bond Position:  [-13.01917906]


portfolio before change:  [-14.58383151]
curr_Stock_Price:  96.3652392589144
curr_Factors:  [96.36523926 -0.67076956 -0.97483228]
mat_Sqrt:  [[18.58851101  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0039525   0.00343461 -0.06689076]
Stock Position:  -0.0039525011905673655
Bond Position:  [-14.20294779]


portfolio before change:  [-14.59141944]
curr_Stock_Price:  97.38655333629384
curr_Factors:  [97.38655334 -0.29835078 -0.99310062]
mat_Sqrt:  [[26.76879239  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00248848 -0.04851558  0.3575958 ]
Stock Position:  -0.0024884842406062463
Bond Position:  [-14.34907454]


portfolio before change:  [-14.59071944]
curr_Stock_Price:  95.6635319838622
curr_Factors:  [95.66353198 -0.31779545 -0.98718478]
mat_Sqrt:  [[25.9418353   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00765953  0.03271852 -0.00596332]
Stock Position:  -0.00765952834340005
Bond Position:  [-13.85798191]


portfolio before change:  [-14.58256066]
curr_Stock_Price:  94.14598199176991
curr_Factors:  [94.14598199 -0.49083968 -0.96861989]
mat_Sqrt:  [[21.87593136  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01272163 -0.10245309  0.70578411]
Stock Position:  -0.012721631650324255
Bond Position:  [-13.38487015]


portfolio before change:  [-14.60818972]
curr_Stock_Price:  95.89752051855898
curr_Factors:  [95.89752052 -0.83311373 -0.96923363]
mat_Sqrt:  [[15.81458743  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0016509  -0.00030277 -0.27431352]
Stock Position:  -0.001650900973947489
Bond Position:  [-14.44987241]


portfolio before change:  [-14.6133754]
curr_Stock_Price:  96.85018947963847
curr_Factors:  [96.85018948 -0.40905583 -0.95590281]
mat_Sqrt:  [[24.73468993  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01009516 -0.05231625  1.02040736]
Stock Position:  -0.010095164090426708
Bond Position:  [-13.63565685]


portfolio before change:  [-14.61260834]
curr_Stock_Price:  96.43648614235101
curr_Factors:  [96.43648614 -0.73962856 -0.94383188]
mat_Sqrt:  [[17.91116348  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00093925 0.00063037 0.03595694]
Stock Position:  0.0009392463162579402
Bond Position:  [-14.70318595]


portfolio before change:  [-14.61818028]
curr_Stock_Price:  94.41817867814815
curr_Factors:  [94.41817868 -0.929364   -0.9347861 ]
mat_Sqrt:  [[14.6374532   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00844025  0.05117099  0.10782337]
Stock Position:  -0.008440250139770062
Bond Position:  [-13.82126724]


portfolio before change:  [-14.62981002]
curr_Stock_Price:  95.38663164148
curr_Factors:  [95.38663164 -1.01548008 -0.92049236]
mat_Sqrt:  [[13.76275459  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00836551 -0.00290586 -0.3596938 ]
Stock Position:  -0.008365511766889457
Bond Position:  [-13.83185203]


portfolio before change:  [-14.64194598]
curr_Stock_Price:  96.42393402414069
curr_Factors:  [96.42393402 -0.66192604 -0.93534875]
mat_Sqrt:  [[19.52078223  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00404917 -0.07882174 -0.93269904]
Stock Position:  -0.0040491738353352425
Bond Position:  [-14.25150871]


portfolio before change:  [-14.64935394]
curr_Stock_Price:  97.37342216290608
curr_Factors:  [97.37342216 -0.54615593 -0.95528227]
mat_Sqrt:  [[21.69572204  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00108074  0.00344165 -0.03415598]
Stock Position:  -0.001080736757790107
Bond Position:  [-14.54411891]


portfolio before change:  [-14.65067552]
curr_Stock_Price:  95.23145036165319
curr_Factors:  [95.23145036 -0.5799811  -0.93267922]
mat_Sqrt:  [[20.9816852   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00060561 -0.01831408 -0.31229621]
Stock Position:  -0.0006056053429975843
Bond Position:  [-14.59300284]


portfolio before change:  [-14.65532346]
curr_Stock_Price:  96.8814316853973
curr_Factors:  [96.88143169 -0.88330575 -0.97534638]
mat_Sqrt:  [[15.10212942  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01011413  0.00728443 -0.15733077]
Stock Position:  0.01011412765979543
Bond Position:  [-15.63519463]


portfolio before change:  [-14.65310427]
curr_Stock_Price:  97.48736428222799
curr_Factors:  [97.48736428 -1.04981855 -0.96855226]
mat_Sqrt:  [[12.95331794  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00053726  0.03265341  0.19480917]
Stock Position:  -0.0005372554381829562
Bond Position:  [-14.60072865]


portfolio before change:  [-14.6575543]
curr_Stock_Price:  98.9752742158993
curr_Factors:  [98.97527422 -0.76647045 -0.96857246]
mat_Sqrt:  [[17.45850908  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00146877 -0.0009406  -0.0314198 ]
Stock Position:  0.0014687657521119527
Bond Position:  [-14.80292579]


portfolio before change:  [-14.65809847]
curr_Stock_Price:  101.12471547201608
curr_Factors:  [101.12471547  -1.09400548  -0.97746894]
mat_Sqrt:  [[12.74170088  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02768679 -0.26781176 -0.3257861 ]
Stock Position:  -0.027686787961636976
Bond Position:  [-11.85827991]


portfolio before change:  [-14.65009907]
curr_Stock_Price:  100.72870202147793
curr_Factors:  [100.72870202  -1.1297415   -0.92139421]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-14.65009907]
Stock Price:  100.28329384800408
PL:  [-14.93339291]
Settle:  Tensor("sub_174:0", shape=(), dtype=float64)
PL:  Tensor("sub_175:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  88
output_Z_Vals[:, i, :]:  [[ 1.19251512e+02 -2.92846752e+01 -2.92776944e+01]
 [-4.01444686e-01  1.47359060e-01  4.25406949e-01]
 [-5.35732884e-02  2.54037850e-02  9.23333457e-02]
 [-4.89600497e-02 -5.15334250e-02 -1.87070172e-01]
 [-9.88296441e-02 -2.41910939e-01  2.15109929e-01]
 [-3.38322586e-02  1.44750454e-02 -1.22040309e-02]
 [-1.83368044e-01 -1.62210063e-01  1.34240507e-01]
 [ 1.09767045e-02 -2.93854061e-02 -8.46065212e-02]
 [-3.12690572e-01 -1.82106606e-01  3.98216796e-01]
 [ 4.28330371e-02  3.32436827e-02  2.70549334e-03]
 [-9.66265113e-02  1.48662626e-01  2.32783365e-02]
 [-2.76080598e-02 -9.59548192e-03 -1.14810554e-01]
 [ 2.50232833e-03 -2.19282708e-01 -2.86717964e-01]
 [ 2.82273554e-02 -8.34261589e-03  6.38332443e-03]
 [ 1.11348156e-02 -5.79141975e-02 -1.09473076e-01]
 [ 1.80364732e-01  4.32418968e-02 -1.25770365e-01]
 [ 2.04735600e-02 -3.86034715e-02  1.07408452e-01]
 [ 4.16196696e-02 -2.49874608e-02  6.99696018e-02]
 [-4.25305572e-01 -1.07235908e+00 -3.24908325e-01]
 [ 1.82771186e-01 -3.79093527e-01 -6.81743641e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.25151208 -29.28467519 -29.2776944 ]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  8.31409947  -9.26062741 -83.52111278]
init_Out:  [2.49223638]
Stock Position:  8.314099471154409
Bond position:  [-828.91771073]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-14.49461119]
curr_Stock_Price:  97.98179077601773
curr_Factors:  [97.98179078 -1.06964257 -0.99763159]
mat_Sqrt:  [[12.3976569   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02506958  0.04659903  1.21356761]
Stock Position:  -0.025069580778139148
Bond Position:  [-12.03824877]


portfolio before change:  [-14.52460437]
curr_Stock_Price:  99.05812490318492
curr_Factors:  [99.0581249  -0.79758843 -1.02734096]
mat_Sqrt:  [[15.97104523  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00213323  0.00803338  0.26340133]
Stock Position:  -0.0021332292099236635
Bond Position:  [-14.31329069]


portfolio before change:  [-14.53116038]
curr_Stock_Price:  100.45377167648019
curr_Factors:  [100.45377168  -0.79270237  -0.99062626]
mat_Sqrt:  [[16.88404367  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00524022 -0.0162963  -0.53365913]
Stock Position:  -0.005240224301812971
Bond Position:  [-14.00476008]


portfolio before change:  [-14.53399197]
curr_Stock_Price:  100.32590756295745
curr_Factors:  [100.32590756  -1.00005982  -0.97645506]
mat_Sqrt:  [[13.90028132  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00440039 -0.07649896  0.61364875]
Stock Position:  -0.004400387723508424
Bond Position:  [-14.09251908]


portfolio before change:  [-14.53071231]
curr_Stock_Price:  98.77985516956582
curr_Factors:  [98.77985517 -0.86389735 -0.92791448]
mat_Sqrt:  [[16.46244707  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00218374  0.00457741 -0.0348147 ]
Stock Position:  -0.002183736827578153
Bond Position:  [-14.3150031]


portfolio before change:  [-14.52931578]
curr_Stock_Price:  96.50131478790297
curr_Factors:  [96.50131479 -1.00585408 -0.90382254]
mat_Sqrt:  [[14.29457375  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01120387 -0.05129533  0.3829508 ]
Stock Position:  -0.011203871035284155
Bond Position:  [-13.44812749]


portfolio before change:  [-14.51414183]
curr_Stock_Price:  94.84685145668347
curr_Factors:  [94.84685146 -0.44528125 -0.9332589 ]
mat_Sqrt:  [[23.89629302  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00029512 -0.00929248 -0.24135885]
Stock Position:  -0.0002951192994591794
Bond Position:  [-14.4861507]


portfolio before change:  [-14.51795827]
curr_Stock_Price:  95.50572014708185
curr_Factors:  [95.50572015 -0.47080368 -0.94173204]
mat_Sqrt:  [[23.25802942  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01015163 -0.05758717  1.13600168]
Stock Position:  -0.010151628802425544
Bond Position:  [-13.54841965]


portfolio before change:  [-14.54345281]
curr_Stock_Price:  97.68340120238123
curr_Factors:  [97.6834012  -0.9210136  -0.89446666]
mat_Sqrt:  [[15.89892329  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00278281 0.01051258 0.00771802]
Stock Position:  0.0027828074293132577
Bond Position:  [-14.8152869]


portfolio before change:  [-14.55077099]
curr_Stock_Price:  96.38475107869054
curr_Factors:  [96.38475108 -1.1351452  -0.90204257]
mat_Sqrt:  [[12.56807969  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00700476  0.04701125  0.06640661]
Stock Position:  -0.007004760504722
Bond Position:  [-13.87561889]


portfolio before change:  [-14.55838246]
curr_Stock_Price:  96.97608329195182
curr_Factors:  [96.97608329 -0.78934715 -0.89836326]
mat_Sqrt:  [[17.93499754  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00285985 -0.00303436 -0.32752255]
Stock Position:  -0.0028598509727289258
Bond Position:  [-14.28104532]


portfolio before change:  [-14.56120802]
curr_Stock_Price:  96.71552843791791
curr_Factors:  [96.71552844 -0.83882345 -0.86706911]
mat_Sqrt:  [[17.56452801  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00351194 -0.06934328 -0.81792654]
Stock Position:  -0.003511941004999641
Bond Position:  [-14.22154879]


portfolio before change:  [-14.56274545]
curr_Stock_Price:  96.14080111819999
curr_Factors:  [96.14080112 -0.69337261 -0.87812231]
mat_Sqrt:  [[19.9717519   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00146782 -0.00263817  0.01820985]
Stock Position:  0.0014678201886468628
Bond Position:  [-14.70386286]


portfolio before change:  [-14.56847559]
curr_Stock_Price:  94.74163676660345
curr_Factors:  [94.74163677 -0.26182671 -0.81782438]
mat_Sqrt:  [[32.18506389  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0003948  -0.01831408 -0.31229621]
Stock Position:  -0.00039479867761695145
Bond Position:  [-14.53107172]


portfolio before change:  [-14.57221398]
curr_Stock_Price:  95.00801962859008
curr_Factors:  [95.00801963 -0.14388773 -0.820866  ]
mat_Sqrt:  [[36.20537462  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00430346  0.01367429 -0.35878784]
Stock Position:  0.004303462299663242
Bond Position:  [-14.98107741]


portfolio before change:  [-14.5861284]
curr_Stock_Price:  92.64511423019364
curr_Factors:  [92.64511423 -0.13293173 -0.82840125]
mat_Sqrt:  [[35.42590155  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00116868 -0.01220749  0.30640642]
Stock Position:  0.0011686782635498916
Bond Position:  [-14.69440073]


portfolio before change:  [-14.58935613]
curr_Stock_Price:  93.02702024792384
curr_Factors:  [ 9.30270202e+01 -4.75939251e-02 -8.08927259e-01]
mat_Sqrt:  [[39.50269145  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00139882 -0.00790173  0.1996038 ]
Stock Position:  0.0013988156056231398
Bond Position:  [-14.71948378]


portfolio before change:  [-14.59661133]
curr_Stock_Price:  90.47138192510879
curr_Factors:  [90.47138193  0.13833233 -0.79509305]
mat_Sqrt:  [[46.91196925  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01107    -0.33910971 -0.92687301]
Stock Position:  -0.011069997834103317
Bond Position:  [-13.59509333]


portfolio before change:  [-14.54524229]
curr_Stock_Price:  85.52393396554264
curr_Factors:  [85.52393397 -0.15070261 -0.80322784]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-14.54524229]
Stock Price:  85.55312054939938
PL:  [-14.54524229]
Settle:  Tensor("sub_176:0", shape=(), dtype=float64)
PL:  Tensor("sub_177:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  89
output_Z_Vals[:, i, :]:  [[ 1.19251512e+02 -2.92846752e+01 -2.92776944e+01]
 [ 6.98736143e-02 -3.96713268e-02 -1.99176426e-02]
 [-8.03518351e-02  1.82334057e-02  1.04486695e-01]
 [-4.32217907e-02 -2.46934996e-02 -1.11112540e-01]
 [-9.63066344e-02 -2.20827861e-01  1.93725175e-01]
 [-4.98042222e-03 -1.53248044e-01  2.34231136e-02]
 [ 5.55748504e-02  3.41164896e-02 -1.82406747e-02]
 [-8.83573876e-02  1.50303103e-01 -8.70252575e-02]
 [-2.18060607e-01 -9.95200140e-02  2.06163427e-01]
 [ 4.89788207e-02  3.89241992e-02  8.81993287e-04]
 [ 5.57032688e-02  7.02640209e-02 -9.43443631e-03]
 [ 1.03967755e-01 -1.07478407e-02 -1.34178889e-01]
 [ 3.94193185e-02 -5.27508810e-02 -3.59737914e-01]
 [-8.35371598e-02  3.00488094e-02 -3.36585827e-02]
 [ 5.59705967e-03 -6.30626020e-02 -1.57815979e-02]
 [ 3.51565843e-02 -7.31312161e-03  8.75406301e-02]
 [-2.57815993e-02  1.06282547e-01  7.25177663e-02]
 [ 2.94584704e-02  1.59655868e-03 -5.62186757e-02]
 [-2.36348087e-01 -7.40830176e-01 -3.72697900e-02]
 [ 6.46059452e-02 -1.70578727e-02 -5.93534282e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.25151208 -29.28467519 -29.2776944 ]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  8.31409947  -9.26062741 -83.52111278]
init_Out:  [2.49223638]
Stock Position:  8.314099471154409
Bond position:  [-828.91771073]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [7.62192674]
curr_Stock_Price:  100.64191506279472
curr_Factors:  [100.64191506  -0.89622923  -1.05770109]
mat_Sqrt:  [[14.26256838  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00454221 -0.01254518 -0.05681949]
Stock Position:  0.0045422136841817996
Bond Position:  [7.16478965]


portfolio before change:  [7.61858689]
curr_Stock_Price:  99.51223043741702
curr_Factors:  [99.51223044 -0.59538499 -1.07287818]
mat_Sqrt:  [[18.76544954  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00312024  0.00576591  0.29807146]
Stock Position:  -0.003120244639725953
Bond Position:  [7.92908939]


portfolio before change:  [7.61907381]
curr_Stock_Price:  99.99155275426263
curr_Factors:  [99.99155275 -0.70097203 -1.03085566]
mat_Sqrt:  [[17.69457363  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00376048 -0.00780877 -0.31697315]
Stock Position:  -0.0037604820387914365
Bond Position:  [7.99509024]


portfolio before change:  [7.62044746]
curr_Stock_Price:  100.15785271848421
curr_Factors:  [100.15785272  -0.83043861  -1.024753  ]
mat_Sqrt:  [[15.66698846  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00398701 -0.0698319   0.552644  ]
Stock Position:  -0.0039870074371262144
Bond Position:  [8.01977756]


portfolio before change:  [7.62083939]
curr_Stock_Price:  100.56248201738539
curr_Factors:  [100.56248202  -1.05195571  -1.06932651]
mat_Sqrt:  [[12.05521122  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00034475 -0.04846129  0.06681962]
Stock Position:  -0.0003447510448631516
Bond Position:  [7.65550842]


portfolio before change:  [7.62246867]
curr_Stock_Price:  101.38871253412485
curr_Factors:  [101.38871253  -1.08801364  -1.05411921]
mat_Sqrt:  [[11.90345767  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00443     0.01078858 -0.05203557]
Stock Position:  0.004430004602624732
Bond Position:  [7.1733162]


portfolio before change:  [7.61755792]
curr_Stock_Price:  99.8753290671406
curr_Factors:  [99.87532907 -0.76364243 -1.08129597]
mat_Sqrt:  [[15.78380316  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00647756  0.04753001 -0.24825884]
Stock Position:  -0.006477560152863699
Bond Position:  [8.26450638]


portfolio before change:  [7.6201697]
curr_Stock_Price:  99.79113177107051
curr_Factors:  [99.79113177 -0.64167669 -1.0809572 ]
mat_Sqrt:  [[17.82220999  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01001825 -0.03147099  0.58812687]
Stock Position:  -0.010018245203858465
Bond Position:  [8.61990173]


portfolio before change:  [7.64254641]
curr_Stock_Price:  97.77266779427751
curr_Factors:  [97.77266779 -0.54922266 -1.06756777]
mat_Sqrt:  [[19.41128578  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00258426 0.01230891 0.00251608]
Stock Position:  0.0025842633983525387
Bond Position:  [7.38987609]


portfolio before change:  [7.64644714]
curr_Stock_Price:  98.5671011264983
curr_Factors:  [98.56710113 -0.64485868 -1.0893154 ]
mat_Sqrt:  [[17.40162281  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00319463  0.02221943 -0.02691382]
Stock Position:  0.0031946262923089777
Bond Position:  [7.33156209]


portfolio before change:  [7.65275201]
curr_Stock_Price:  99.96687376856252
curr_Factors:  [99.96687377 -0.77754569 -1.11656949]
mat_Sqrt:  [[15.04015607  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00507316 -0.00339877 -0.38277502]
Stock Position:  0.00507315851277551
Bond Position:  [7.14560421]


portfolio before change:  [7.65139667]
curr_Stock_Price:  99.34754302130634
curr_Factors:  [99.34754302 -0.8589295  -1.05394508]
mat_Sqrt:  [[14.66919417  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00241144 -0.01668129 -1.02623214]
Stock Position:  -0.002411441094244799
Bond Position:  [7.89096742]


portfolio before change:  [7.65037906]
curr_Stock_Price:  100.58771591145127
curr_Factors:  [100.58771591  -1.1753723   -1.04289603]
mat_Sqrt:  [[10.94367656  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00819029  0.00950227 -0.09601857]
Stock Position:  -0.00819028521630008
Bond Position:  [8.47422114]


portfolio before change:  [7.66098366]
curr_Stock_Price:  99.55163716079085
curr_Factors:  [99.55163716 -1.35019247 -1.02979186]
mat_Sqrt:  [[ 9.21370588  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 8.11166676e-05 -1.99421457e-02 -4.50205060e-02]
Stock Position:  8.111666760347158e-05
Bond Position:  [7.65290836]


portfolio before change:  [7.66292726]
curr_Stock_Price:  99.9231680475674
curr_Factors:  [99.92316805 -1.41446184 -1.02322126]
mat_Sqrt:  [[ 8.7295906   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00605262 -0.00231261  0.24972905]
Stock Position:  0.006052622514046476
Bond Position:  [7.05813004]


portfolio before change:  [7.66994989]
curr_Stock_Price:  100.79186202640133
curr_Factors:  [100.79186203  -1.7361643   -1.00685557]
mat_Sqrt:  [[ 6.48854137  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00126912  0.03360949  0.206873  ]
Stock Position:  -0.0012691247932202804
Bond Position:  [7.79786734]


portfolio before change:  [7.67113321]
curr_Stock_Price:  101.39573790604432
curr_Factors:  [101.39573791  -1.84327192  -1.04843165]
mat_Sqrt:  [[ 5.62559934  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00320394  0.00050488 -0.16037623]
Stock Position:  0.0032039438195490258
Bond Position:  [7.34626696]


portfolio before change:  [7.67315041]
curr_Stock_Price:  101.45204723143955
curr_Factors:  [101.45204723  -1.72698321  -1.00519685]
mat_Sqrt:  [[ 6.60222152  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.03984779 -0.23427107 -0.10632034]
Stock Position:  -0.03984778507715782
Bond Position:  [11.71578979]


portfolio before change:  [7.6607621]
curr_Stock_Price:  101.8364507488694
curr_Factors:  [101.83645075  -1.46388265  -1.01241406]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [7.6607621]
Stock Price:  101.89074090855232
PL:  [5.77002119]
Settle:  Tensor("sub_178:0", shape=(), dtype=float64)
PL:  Tensor("sub_179:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  90
output_Z_Vals[:, i, :]:  [[ 1.19251512e+02 -2.92846752e+01 -2.92776944e+01]
 [-1.22968191e-01  2.22575063e-02 -5.95037806e-02]
 [-8.71301850e-02  1.50631605e-02  9.68439091e-02]
 [-1.88610808e-02  3.14849299e-02  4.61947856e-02]
 [-8.42757611e-02 -1.20294024e-01  9.17528082e-02]
 [ 1.62501948e-02 -5.88374914e-02 -1.26422548e-03]
 [-4.11357449e-02 -4.11015048e-03  2.14058345e-02]
 [-5.69319002e-02  9.53816565e-02 -1.10675991e-01]
 [-2.36025107e-01 -1.13597155e-01  2.38769644e-01]
 [ 6.25816478e-02  5.60812860e-02 -8.46722354e-03]
 [ 2.66084815e-02  8.87191766e-02 -1.20376120e-02]
 [ 3.90247564e-02 -9.42847484e-03 -1.14230724e-01]
 [ 2.06061069e-02 -1.36798504e-01 -3.30168000e-01]
 [ 3.39743722e-02 -1.20054841e-02  5.57077260e-03]
 [ 1.35103333e-02 -5.92924707e-02 -9.86715926e-02]
 [ 1.44262030e-01  9.02346515e-03 -1.69156865e-02]
 [-2.35647895e-02  1.03259148e-01  6.82888801e-02]
 [ 4.38901106e-02 -2.40113034e-02  4.75057029e-02]
 [-3.04955470e-01 -7.90469681e-01 -1.39551077e-01]
 [ 1.29433895e-01 -1.48761561e-01 -2.34941114e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.25151208 -29.28467519 -29.2776944 ]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  8.31409947  -9.26062741 -83.52111278]
init_Out:  [2.49223638]
Stock Position:  8.314099471154409
Bond position:  [-828.91771073]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [0.32228196]
curr_Stock_Price:  99.7639312474655
curr_Factors:  [99.76393125 -1.24861008 -1.00531432]
mat_Sqrt:  [[10.47385662  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01284528  0.00703844 -0.16974772]
Stock Position:  -0.012845284047861972
Bond Position:  [1.603778]


portfolio before change:  [0.33271367]
curr_Stock_Price:  98.98304392119954
curr_Factors:  [98.98304392 -1.27432204 -0.99576444]
mat_Sqrt:  [[10.2252697   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00654976  0.00476339  0.27626872]
Stock Position:  -0.006549761299456805
Bond Position:  [0.98102899]


portfolio before change:  [0.33411518]
curr_Stock_Price:  98.80651615924936
curr_Factors:  [98.80651616 -1.3646989  -1.00631262]
mat_Sqrt:  [[ 9.22716672  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00093405  0.00995641  0.13178087]
Stock Position:  -0.0009340540339711215
Bond Position:  [0.4264058]


portfolio before change:  [0.33469469]
curr_Stock_Price:  98.30023335992769
curr_Factors:  [98.30023336 -1.37889121 -1.00930856]
mat_Sqrt:  [[ 9.023449    0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00760826 -0.03804031  0.26174522]
Stock Position:  -0.007608263308505292
Bond Position:  [1.08258875]


portfolio before change:  [0.32721002]
curr_Stock_Price:  99.31956514309185
curr_Factors:  [99.31956514 -1.2807818  -1.0701491 ]
mat_Sqrt:  [[ 9.46321035  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00152939 -0.01860605 -0.00360648]
Stock Position:  0.001529392014857031
Bond Position:  [0.17531147]


portfolio before change:  [0.32650765]
curr_Stock_Price:  98.83165532431553
curr_Factors:  [98.83165532 -1.36320565 -1.08665382]
mat_Sqrt:  [[ 8.52973653  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00432281 -0.00129974  0.06106489]
Stock Position:  -0.004322808881473631
Bond Position:  [0.75373801]


portfolio before change:  [0.32854564]
curr_Stock_Price:  98.40380217667384
curr_Factors:  [98.40380218 -1.13250758 -1.09697337]
mat_Sqrt:  [[10.58670003  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00727902  0.03016233 -0.3157278 ]
Stock Position:  -0.007279019741139478
Bond Position:  [1.04482886]


portfolio before change:  [0.3272024]
curr_Stock_Price:  98.62422681939131
curr_Factors:  [98.62422682 -0.90134577 -1.10326121]
mat_Sqrt:  [[13.28598823  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0143173  -0.03592257  0.68114333]
Stock Position:  -0.014317303337214963
Bond Position:  [1.73923537]


portfolio before change:  [0.31799654]
curr_Stock_Price:  99.29758851455433
curr_Factors:  [99.29758851 -1.01045422 -1.09611352]
mat_Sqrt:  [[12.08002846  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00515738  0.01773446 -0.02415463]
Stock Position:  0.005157379869378043
Bond Position:  [-0.19411884]


portfolio before change:  [0.32204595]
curr_Stock_Price:  100.09216761306095
curr_Factors:  [100.09216761  -1.05303992  -1.09121159]
mat_Sqrt:  [[11.72636744  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00225492  0.02805547 -0.03433996]
Stock Position:  0.0022549211107048173
Bond Position:  [0.09634601]


portfolio before change:  [0.31887901]
curr_Stock_Price:  98.67702648284863
curr_Factors:  [98.67702648 -0.8803927  -1.0873056 ]
mat_Sqrt:  [[13.79289844  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00112116 -0.00298155 -0.32586846]
Stock Position:  0.0011211614018835335
Bond Position:  [0.20824614]


portfolio before change:  [0.31818712]
curr_Stock_Price:  98.01346979016854
curr_Factors:  [98.01346979 -0.8386052  -1.04638191]
mat_Sqrt:  [[14.88148477  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00338147 -0.04325949 -0.9418774 ]
Stock Position:  -0.003381468773098835
Bond Position:  [0.64961661]


portfolio before change:  [0.32477752]
curr_Stock_Price:  96.11252947000264
curr_Factors:  [96.11252947 -0.6180121  -1.00879105]
mat_Sqrt:  [[18.89158419  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00184217 -0.00379647  0.01589186]
Stock Position:  0.0018421706057916976
Bond Position:  [0.14772184]


portfolio before change:  [0.32638052]
curr_Stock_Price:  96.9626520692365
curr_Factors:  [96.96265207 -0.56391037 -1.03455313]
mat_Sqrt:  [[19.60652406  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00041628 -0.01874993 -0.28148259]
Stock Position:  -0.00041628216030480597
Bond Position:  [0.36674435]


portfolio before change:  [0.32620211]
curr_Stock_Price:  97.6115167213772
curr_Factors:  [97.61151672 -0.86579017 -1.02252225]
mat_Sqrt:  [[14.77125509  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00954842  0.00285347 -0.04825575]
Stock Position:  0.009548417750337832
Bond Position:  [-0.60583343]


portfolio before change:  [0.33579055]
curr_Stock_Price:  98.63157254889803
curr_Factors:  [98.63157255 -0.62696685 -1.00514081]
mat_Sqrt:  [[19.28415473  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00036088  0.03265341  0.19480917]
Stock Position:  -0.0003608786903465849
Bond Position:  [0.37138459]


portfolio before change:  [0.33656028]
curr_Stock_Price:  96.75596086066032
curr_Factors:  [96.75596086 -0.75571482 -0.9545543 ]
mat_Sqrt:  [[17.49513458  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00302754 -0.00759304  0.13552055]
Stock Position:  0.003027539007586951
Bond Position:  [0.04362783]


portfolio before change:  [0.33883198]
curr_Stock_Price:  97.50270322655194
curr_Factors:  [97.50270323 -0.88124161 -0.94585797]
mat_Sqrt:  [[15.68618712  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02255813 -0.24996846 -0.39810038]
Stock Position:  -0.02255813034091474
Bond Position:  [2.53831067]


portfolio before change:  [0.34336079]
curr_Stock_Price:  97.33007551625379
curr_Factors:  [97.33007552 -0.33478667 -0.93109435]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [0.34336079]
Stock Price:  95.66826406906205
PL:  [0.34336079]
Settle:  Tensor("sub_180:0", shape=(), dtype=float64)
PL:  Tensor("sub_181:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  91
output_Z_Vals[:, i, :]:  [[ 1.19251512e+02 -2.92846752e+01 -2.92776944e+01]
 [ 4.20668693e-02 -3.98884848e-02 -6.86990791e-02]
 [-3.84561671e-01 -6.18035430e-02  2.53782978e-01]
 [-4.94912780e-02 -5.38017247e-02 -1.93479323e-01]
 [-9.88296441e-02 -2.41910939e-01  2.15109929e-01]
 [-6.62403820e-02  2.05181139e-02 -2.10166429e-02]
 [ 5.40085034e-02  6.01766508e-02 -2.84606081e-02]
 [-1.56201985e-01  2.33778534e-01 -6.57032230e-02]
 [-2.49717401e-02 -3.50681863e-03 -1.12319698e-02]
 [ 5.13365014e-02  3.42440770e-02 -6.73110110e-03]
 [ 1.41001639e-01 -9.55191256e-03 -3.74274828e-02]
 [ 1.67830353e-01 -1.26206794e-02 -1.61759229e-01]
 [ 1.88697675e-02 -1.13432634e-01 -4.94000768e-01]
 [-8.32564471e-02  3.01357854e-02 -3.30234591e-02]
 [-1.07802320e-01  5.16782510e-02  2.22584227e-01]
 [-6.69021160e-02 -1.43200856e-01  1.54699182e-01]
 [-2.45795879e-02  4.18072520e-02  1.48953016e-01]
 [ 2.60211851e-02  1.77818731e-03 -3.50688936e-02]
 [-2.98067803e-01 -8.05110981e-01 -1.13287187e-01]
 [ 1.05707508e-01 -1.08904387e-01 -1.78866274e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.25151208 -29.28467519 -29.2776944 ]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  8.31409947  -9.26062741 -83.52111278]
init_Out:  [2.49223638]
Stock Position:  8.314099471154409
Bond position:  [-828.91771073]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [7.16870415]
curr_Stock_Price:  100.58740253443095
curr_Factors:  [100.58740253  -1.01545873  -0.99660871]
mat_Sqrt:  [[13.44973743  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0020085  -0.01261385 -0.19597935]
Stock Position:  0.002008501087012835
Bond Position:  [6.96667424]


portfolio before change:  [7.17194477]
curr_Stock_Price:  101.33359870544083
curr_Factors:  [101.33359871  -0.9243847   -1.00760739]
mat_Sqrt:  [[14.67911804  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02277754 -0.019544    0.7239722 ]
Stock Position:  -0.022777540011396383
Bond Position:  [9.48007487]


portfolio before change:  [7.19595993]
curr_Stock_Price:  100.38332735378881
curr_Factors:  [100.38332735  -0.5549312   -0.96933983]
mat_Sqrt:  [[21.86145614  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00413395 -0.0170136  -0.55194265]
Stock Position:  -0.004133953075442121
Bond Position:  [7.6109399]


portfolio before change:  [7.19517819]
curr_Stock_Price:  101.0327570358614
curr_Factors:  [101.03275704  -0.56935381  -1.00350153]
mat_Sqrt:  [[20.95944647  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00291833 -0.07649896  0.61364875]
Stock Position:  -0.002918332186401446
Bond Position:  [7.49002534]


portfolio before change:  [7.20183834]
curr_Stock_Price:  99.39229762634864
curr_Factors:  [99.39229763 -0.32456305 -0.98783379]
mat_Sqrt:  [[26.75383381  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00261647  0.0064884  -0.05995463]
Stock Position:  -0.002616470271362551
Bond Position:  [7.46189533]


portfolio before change:  [7.19608214]
curr_Stock_Price:  102.30534552014494
curr_Factors:  [102.30534552  -0.93771148  -0.96257605]
mat_Sqrt:  [[15.29727023  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00325239  0.01902953 -0.08119019]
Stock Position:  0.0032523946936132615
Bond Position:  [6.86334478]


portfolio before change:  [7.20178584]
curr_Stock_Price:  103.5314095792545
curr_Factors:  [103.53140958  -1.05407031  -0.96540963]
mat_Sqrt:  [[13.74115166  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0119042   0.07392726 -0.18743301]
Stock Position:  -0.011904203349582268
Bond Position:  [8.43424479]


portfolio before change:  [7.20679907]
curr_Stock_Price:  103.28742814856325
curr_Factors:  [103.28742815  -1.10029776  -0.96740916]
mat_Sqrt:  [[13.06332579  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00209403 -0.00110895 -0.03204168]
Stock Position:  -0.00209403045136282
Bond Position:  [7.42308609]


portfolio before change:  [7.21018926]
curr_Stock_Price:  102.554779806978
curr_Factors:  [102.55477981  -0.78472809  -0.96995817]
mat_Sqrt:  [[17.73802839  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00286654  0.01082893 -0.01920196]
Stock Position:  0.0028665361387169817
Bond Position:  [6.91621228]


portfolio before change:  [7.21473396]
curr_Stock_Price:  103.53695170354287
curr_Factors:  [103.5369517   -0.55612597  -0.95974795]
mat_Sqrt:  [[22.73838935  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0058542  -0.00302058 -0.10677019]
Stock Position:  0.005854203415135853
Bond Position:  [6.60860758]


portfolio before change:  [7.20039862]
curr_Stock_Price:  100.80597375553872
curr_Factors:  [100.80597376  -0.51328352  -0.9526786 ]
mat_Sqrt:  [[23.27164104  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00577894 -0.00399101 -0.46145406]
Stock Position:  0.005778944610514031
Bond Position:  [6.61784648]


portfolio before change:  [7.19198013]
curr_Stock_Price:  99.06289489543559
curr_Factors:  [99.0628949  -0.23656637 -0.91979989]
mat_Sqrt:  [[31.16789927  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00272385 -0.03587055 -1.40924669]
Stock Position:  -0.0027238452735833863
Bond Position:  [7.46181213]


portfolio before change:  [7.1904387]
curr_Stock_Price:  100.31374293174504
curr_Factors:  [100.31374293  -0.64654273  -0.95760012]
mat_Sqrt:  [[20.16926374  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00442352  0.00952977 -0.09420674]
Stock Position:  -0.00442352437496384
Bond Position:  [7.63417899]


portfolio before change:  [7.18029881]
curr_Stock_Price:  103.03751546876862
curr_Factors:  [103.03751547  -0.88116446  -0.94108691]
mat_Sqrt:  [[16.65718718  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00366407  0.0163421   0.63497084]
Stock Position:  -0.003664074697185404
Bond Position:  [7.55783596]


portfolio before change:  [7.1795043]
curr_Stock_Price:  103.77008839793218
curr_Factors:  [103.7700884   -0.96005438  -0.94178725]
mat_Sqrt:  [[15.49219177  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0025188  -0.04528409  0.44131371]
Stock Position:  -0.0025187984095213184
Bond Position:  [7.44088024]


portfolio before change:  [7.18387745]
curr_Stock_Price:  102.77250974388599
curr_Factors:  [102.77250974  -1.09768488  -0.92573547]
mat_Sqrt:  [[13.58678387  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.0005082  0.01322061 0.42492149]
Stock Position:  0.0005081981031372691
Bond Position:  [7.13164866]


portfolio before change:  [7.18422016]
curr_Stock_Price:  99.93812073221133
curr_Factors:  [99.93812073 -1.11286249 -0.90889738]
mat_Sqrt:  [[13.23402713  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00142879  0.00056231 -0.10004179]
Stock Position:  0.0014287933384229058
Bond Position:  [7.04142924]


portfolio before change:  [7.18611223]
curr_Stock_Price:  100.03015033033034
curr_Factors:  [100.03015033  -1.07024207  -0.92674235]
mat_Sqrt:  [[13.57849407  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02518544 -0.25459845 -0.32317681]
Stock Position:  -0.02518543867408555
Bond Position:  [9.70541544]


portfolio before change:  [7.23996602]
curr_Stock_Price:  97.98821097222837
curr_Factors:  [97.98821097 -0.86016869 -0.947588  ]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [7.23996602]
Stock Price:  98.90890786363788
PL:  [7.23996602]
Settle:  Tensor("sub_182:0", shape=(), dtype=float64)
PL:  Tensor("sub_183:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  92
output_Z_Vals[:, i, :]:  [[ 1.19251512e+02 -2.92846752e+01 -2.92776944e+01]
 [-2.88236065e-01  8.23320482e-02  1.25262419e-01]
 [-7.63808924e-02  1.22751806e-02  4.71484740e-02]
 [-2.21720926e-02  3.74752736e-02  6.02238393e-02]
 [-8.43422689e-02 -1.20849785e-01  9.23165211e-02]
 [-1.21874125e-01  6.39416906e-02 -4.27203181e-03]
 [-1.51492755e-01 -1.30107234e-01  1.10968174e-01]
 [-3.60876634e-02  5.87248062e-02 -1.02718255e-01]
 [-2.42395608e-01 -1.35644815e-01  2.91378493e-01]
 [ 9.21190414e-04 -2.06280745e-02  1.95790610e-02]
 [-1.01374747e-03  9.64311385e-02  8.88121119e-03]
 [-1.05240740e-02 -9.81871642e-03 -1.22382220e-01]
 [ 9.99603393e-03 -2.01361797e-01 -2.12482929e-01]
 [ 1.15142461e-02  3.63747098e-05  8.52193051e-04]
 [ 1.11348156e-02 -5.79141975e-02 -1.09473076e-01]
 [ 1.62504537e-01  2.05404696e-02 -4.91952370e-02]
 [-2.35647895e-02  1.03259148e-01  6.82888801e-02]
 [ 4.24353416e-02 -2.11139090e-02  3.46010885e-02]
 [-3.07960855e-01 -8.28431821e-01 -1.21250951e-01]
 [ 7.26797113e-02 -3.56121730e-02 -8.33327369e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.25151208 -29.28467519 -29.2776944 ]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  8.31409947  -9.26062741 -83.52111278]
init_Out:  [2.49223638]
Stock Position:  8.314099471154409
Bond position:  [-828.91771073]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-5.3574598]
curr_Stock_Price:  99.08078549198797
curr_Factors:  [99.08078549 -1.13898056 -0.97722771]
mat_Sqrt:  [[11.93800809  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02182451  0.02603568  0.35733881]
Stock Position:  -0.02182450996495043
Bond Position:  [-3.19507021]


portfolio before change:  [-5.34867258]
curr_Stock_Price:  98.6415502485822
curr_Factors:  [98.64155025 -1.42344331 -0.96837081]
mat_Sqrt:  [[ 9.02211202  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00736411  0.00388175  0.13450147]
Stock Position:  -0.007364107922969618
Bond Position:  [-4.62226556]


portfolio before change:  [-5.35053391]
curr_Stock_Price:  98.73736974693944
curr_Factors:  [98.73736975 -1.06957467 -0.9501592 ]
mat_Sqrt:  [[13.10153794  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00068018  0.01185072  0.17180185]
Stock Position:  -0.0006801755307160311
Bond Position:  [-5.28337517]


portfolio before change:  [-5.35009366]
curr_Stock_Price:  96.14794861000547
curr_Factors:  [96.14794861 -0.66076689 -0.95133839]
mat_Sqrt:  [[19.17836558  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00357792 -0.03821606  0.26335334]
Stock Position:  -0.003577915215644066
Bond Position:  [-5.00608445]


portfolio before change:  [-5.35433786]
curr_Stock_Price:  96.9843365184625
curr_Factors:  [96.98433652 -0.63185277 -0.95435645]
mat_Sqrt:  [[19.85270484  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00609968  0.02022014 -0.01218692]
Stock Position:  -0.0060996818160164055
Bond Position:  [-4.76276427]


portfolio before change:  [-5.35693283]
curr_Stock_Price:  97.21453400103913
curr_Factors:  [97.214534   -0.55473949 -0.95737861]
mat_Sqrt:  [[21.4302212   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0061689  -0.04114352  0.31656131]
Stock Position:  -0.006168896937737587
Bond Position:  [-4.75722639]


portfolio before change:  [-5.35834465]
curr_Stock_Price:  97.25057904070418
curr_Factors:  [97.25057904 -0.80460657 -0.96796801]
mat_Sqrt:  [[16.5223887   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00336142  0.01857041 -0.29302659]
Stock Position:  -0.0033614190043342184
Bond Position:  [-5.0314447]


portfolio before change:  [-5.35951213]
curr_Stock_Price:  97.223645715767
curr_Factors:  [97.22364572 -0.94194957 -0.98866283]
mat_Sqrt:  [[14.10319761  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01321832 -0.04289466  0.83122174]
Stock Position:  -0.01321831839935056
Bond Position:  [-4.07437903]


portfolio before change:  [-5.34029913]
curr_Stock_Price:  95.69306368479448
curr_Factors:  [95.69306368 -0.49700768 -0.96290448]
mat_Sqrt:  [[22.2253528   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0001973  -0.00652317  0.05585361]
Stock Position:  0.00019730327552543113
Bond Position:  [-5.35917969]


portfolio before change:  [-5.34140907]
curr_Stock_Price:  96.85893141159666
curr_Factors:  [96.85893141 -0.60390807 -0.96156969]
mat_Sqrt:  [[20.24236821  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00016248 0.0304942  0.02533562]
Stock Position:  0.0001624791836544041
Bond Position:  [-5.35714663]


portfolio before change:  [-5.34275348]
curr_Stock_Price:  96.82841521226557
curr_Factors:  [96.82841521 -0.61110174 -0.99262526]
mat_Sqrt:  [[19.47659511  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00183599 -0.00310495 -0.34912241]
Stock Position:  -0.001835986114410425
Bond Position:  [-5.16497785]


portfolio before change:  [-5.34358648]
curr_Stock_Price:  96.57873866570165
curr_Factors:  [96.57873867 -1.14083766 -0.99030273]
mat_Sqrt:  [[11.46407504  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00336495 -0.06367619 -0.60615465]
Stock Position:  -0.003364946700701932
Bond Position:  [-5.01860417]


portfolio before change:  [-5.34461132]
curr_Stock_Price:  96.51039569423953
curr_Factors:  [96.51039569 -0.52095647 -0.99126695]
mat_Sqrt:  [[21.27275857  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [5.49488606e-04 1.15026932e-05 2.43106957e-03]
Stock Position:  0.000549488605775253
Bond Position:  [-5.39764268]


portfolio before change:  [-5.34646168]
curr_Stock_Price:  95.59903559765021
curr_Factors:  [95.5990356  -0.63805661 -0.96736091]
mat_Sqrt:  [[19.19683096  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00066191 -0.01831408 -0.31229621]
Stock Position:  -0.0006619124108401071
Bond Position:  [-5.28318349]


portfolio before change:  [-5.34882379]
curr_Stock_Price:  97.17197256138377
curr_Factors:  [97.17197256 -0.6409638  -0.9391761 ]
mat_Sqrt:  [[20.01220655  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00764498  0.00649547 -0.14034032]
Stock Position:  0.0076449817397401965
Bond Position:  [-6.09170174]


portfolio before change:  [-5.34446654]
curr_Stock_Price:  97.94115280667327
curr_Factors:  [97.94115281 -0.69028006 -0.97193078]
mat_Sqrt:  [[18.58130513  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00037453  0.03265341  0.19480917]
Stock Position:  -0.0003745291546457913
Bond Position:  [-5.30778472]


portfolio before change:  [-5.34578079]
curr_Stock_Price:  97.9068154967647
curr_Factors:  [97.9068155  -0.8991047  -0.97757699]
mat_Sqrt:  [[14.98926799  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00326588 -0.0066768   0.09870727]
Stock Position:  0.0032658766536517825
Bond Position:  [-5.66553237]


portfolio before change:  [-5.34034199]
curr_Stock_Price:  100.00590185832213
curr_Factors:  [100.00590186  -1.07221868  -1.02056647]
mat_Sqrt:  [[12.33504073  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02870693 -0.26197314 -0.34589521]
Stock Position:  -0.028706927486639278
Bond Position:  [-2.46947982]


portfolio before change:  [-5.37613]
curr_Stock_Price:  101.23106134203773
curr_Factors:  [101.23106134  -1.06552908  -1.05449933]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-5.37613]
Stock Price:  101.41195616477764
PL:  [-6.78808617]
Settle:  Tensor("sub_184:0", shape=(), dtype=float64)
PL:  Tensor("sub_185:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  93
output_Z_Vals[:, i, :]:  [[ 1.19251512e+02 -2.92846752e+01 -2.92776944e+01]
 [-3.90392511e-02 -4.24407438e-02 -1.93420590e-01]
 [-5.67151657e-01 -1.01876026e-01  4.11913227e-01]
 [-5.44883221e-02 -7.51386820e-02 -2.53767551e-01]
 [-9.88296441e-02 -2.41910939e-01  2.15109929e-01]
 [-8.98318221e-02 -1.53185634e-01  5.55005210e-02]
 [ 5.52686532e-02  3.92108585e-02 -2.02385177e-02]
 [-1.19485960e-01  2.08701284e-01 -1.14842991e-01]
 [ 9.39623658e-04 -2.11995228e-03 -1.70948958e-02]
 [ 4.93216906e-02  4.14097048e-02 -9.22793365e-03]
 [ 8.55499634e-02  4.38591045e-02 -1.64344190e-02]
 [ 4.83038047e-02 -9.11543611e-03 -1.10139299e-01]
 [ 5.63971831e-02 -3.00043913e-03 -5.83852636e-02]
 [-8.45720117e-02  2.97281712e-02 -3.59999752e-02]
 [-9.98849167e-02  2.24817449e-02  1.30915089e-01]
 [-5.82969437e-02 -1.23170873e-01  1.46466066e-01]
 [-2.50657526e-02  7.19179204e-02  1.12402120e-01]
 [ 1.12765368e-03  3.49212564e-02 -8.15813430e-02]
 [-3.16952102e-01 -8.97466999e-01 -1.11594736e-01]
 [ 6.62454028e-02 -2.08255057e-02 -6.42226625e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.25151208 -29.28467519 -29.2776944 ]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  8.31409947  -9.26062741 -83.52111278]
init_Out:  [2.49223638]
Stock Position:  8.314099471154409
Bond position:  [-828.91771073]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [5.97912142]
curr_Stock_Price:  100.44432236866456
curr_Factors:  [100.44432237  -1.32495414  -0.99265713]
mat_Sqrt:  [[ 9.89463112  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00804647 -0.01342094 -0.55177511]
Stock Position:  -0.008046472681757656
Bond Position:  [6.78734392]


portfolio before change:  [5.96861753]
curr_Stock_Price:  101.9606308843482
curr_Factors:  [101.96063088  -1.77803088  -1.05222841]
mat_Sqrt:  [[ 6.01542789  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.08074249 -0.03221603  1.17507378]
Stock Position:  -0.08074249384160614
Bond Position:  [14.20117315]


portfolio before change:  [6.03694481]
curr_Stock_Price:  101.15837006671029
curr_Factors:  [101.15837007  -1.71092181  -1.0518408 ]
mat_Sqrt:  [[ 6.38482892  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01695088 -0.02376094 -0.72392819]
Stock Position:  -0.01695088157193712
Bond Position:  [7.75166836]


portfolio before change:  [6.02611465]
curr_Stock_Price:  101.91162429247744
curr_Factors:  [101.91162429  -2.27438551  -1.06848646]
mat_Sqrt:  [[ 3.60108084  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01698563 -0.07649896  0.61364875]
Stock Position:  -0.01698563016317512
Bond Position:  [7.75714781]


portfolio before change:  [6.02366721]
curr_Stock_Price:  102.16989944633687
curr_Factors:  [102.16989945  -2.19245408  -1.08486774]
mat_Sqrt:  [[ 3.85478519  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02139109 -0.04844155  0.15832754]
Stock Position:  -0.021391091250722485
Bond Position:  [8.20919285]


portfolio before change:  [6.02662598]
curr_Stock_Price:  102.12753513254829
curr_Factors:  [102.12753513  -2.16812126  -1.11901808]
mat_Sqrt:  [[ 3.8155432   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01366775  0.01239956 -0.05773486]
Stock Position:  0.013667753284257256
Bond Position:  [4.63077203]


portfolio before change:  [6.0306963]
curr_Stock_Price:  102.34062629342792
curr_Factors:  [102.34062629  -2.05452439  -1.15755755]
mat_Sqrt:  [[ 4.12153136  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.03337098  0.06599714 -0.32761509]
Stock Position:  -0.03337098064878226
Bond Position:  [9.44590336]


portfolio before change:  [6.02371457]
curr_Stock_Price:  102.62061509800662
curr_Factors:  [102.6206151   -2.10973651  -1.15818917]
mat_Sqrt:  [[ 3.90834167  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00066642 -0.00067039 -0.04876698]
Stock Position:  -0.0006664192849091096
Bond Position:  [6.09210293]


portfolio before change:  [6.02525832]
curr_Stock_Price:  102.58979648010403
curr_Factors:  [102.58979648  -2.0530905   -1.15092044]
mat_Sqrt:  [[ 4.16504688  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01164627  0.0130949  -0.02632473]
Stock Position:  0.011646265208429396
Bond Position:  [4.83047035]


portfolio before change:  [6.0243129]
curr_Stock_Price:  102.40491375202048
curr_Factors:  [102.40491375  -2.42006545  -1.15732285]
mat_Sqrt:  [[ 2.86207362  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.02911446  0.01386947 -0.04688282]
Stock Position:  0.029114463831552372
Bond Position:  [3.04284874]


portfolio before change:  [6.03400691]
curr_Stock_Price:  102.71174407973899
curr_Factors:  [102.71174408  -2.32461081  -1.14758801]
mat_Sqrt:  [[ 3.1890646   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00802315 -0.00288255 -0.31419676]
Stock Position:  0.008023153551940483
Bond Position:  [5.20993481]


portfolio before change:  [6.03407021]
curr_Stock_Price:  102.55727321335323
curr_Factors:  [102.55727321  -2.41764076  -1.15715223]
mat_Sqrt:  [[ 2.87378052  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01545068 -0.00094882 -0.16655691]
Stock Position:  0.015450682392379128
Bond Position:  [4.44949035]


portfolio before change:  [6.04096758]
curr_Stock_Price:  102.9316811483597
curr_Factors:  [102.93168115  -2.34883951  -1.18858871]
mat_Sqrt:  [[ 2.99408077  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.03044437  0.00940087 -0.10269791]
Stock Position:  -0.0304443683714743
Bond Position:  [9.1746576]


portfolio before change:  [6.03971233]
curr_Stock_Price:  103.04826091469857
curr_Factors:  [103.04826091  -2.15184862  -1.26978612]
mat_Sqrt:  [[ 3.3654534   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02156664  0.00710935  0.37346431]
Stock Position:  -0.021566636401725098
Bond Position:  [8.26211671]


portfolio before change:  [6.04826948]
curr_Stock_Price:  102.74727000213619
curr_Factors:  [102.74727     -1.69750652  -1.25887322]
mat_Sqrt:  [[ 5.34356235  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0059099  -0.03895005  0.41782692]
Stock Position:  -0.005909904186442237
Bond Position:  [6.655496]


portfolio before change:  [6.05260723]
curr_Stock_Price:  102.29486542502589
curr_Factors:  [102.29486543  -1.4055101   -1.25684563]
mat_Sqrt:  [[ 7.13850773  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-3.71020502e-05  2.27424433e-02  3.20651961e-01]
Stock Position:  -3.7102050243188074e-05
Bond Position:  [6.05640258]


portfolio before change:  [6.0541291]
curr_Stock_Price:  102.09060482173808
curr_Factors:  [102.09060482  -1.29076319  -1.20161985]
mat_Sqrt:  [[ 8.44418189  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00173177  0.01104307 -0.23272886]
Stock Position:  -0.0017317728889514334
Bond Position:  [6.23092684]


portfolio before change:  [6.05596106]
curr_Stock_Price:  101.93236794119387
curr_Factors:  [101.93236794  -1.26818361  -1.20588931]
mat_Sqrt:  [[ 8.58688998  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.04226254 -0.28380398 -0.31834872]
Stock Position:  -0.04226253987513398
Bond Position:  [10.36388182]


portfolio before change:  [6.07545575]
curr_Stock_Price:  101.53240615329504
curr_Factors:  [101.53240615  -0.73801121  -1.1991591 ]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [6.07545575]
Stock Price:  100.3732327145564
PL:  [5.70222304]
Settle:  Tensor("sub_186:0", shape=(), dtype=float64)
PL:  Tensor("sub_187:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  94
output_Z_Vals[:, i, :]:  [[ 1.19251512e+02 -2.92846752e+01 -2.92776944e+01]
 [-1.10061153e-01  1.20632165e-02 -1.11484189e-01]
 [-1.86474184e-01 -1.05860953e-02  1.49457990e-01]
 [-5.64951392e-02 -2.69820801e-02 -1.19462895e-01]
 [-9.28142565e-02 -1.91644431e-01  1.64124161e-01]
 [-4.69848383e-02  8.32986293e-03 -1.85748863e-02]
 [-9.28172493e-02 -6.11622806e-02  6.26934841e-02]
 [-8.21749077e-02  1.40762323e-01 -8.58604090e-02]
 [-1.57467100e-01 -7.54870076e-02  1.52615370e-01]
 [ 4.50470017e-02  4.74936917e-02 -1.18045691e-02]
 [ 2.44212414e-02  8.98030467e-02 -1.19999160e-02]
 [ 2.51569250e-02 -8.75817119e-03 -1.04593106e-01]
 [ 2.89470932e-02 -1.07474708e-01 -2.94908045e-01]
 [-8.01272131e-02  3.11053464e-02 -2.59434453e-02]
 [ 1.77082702e-02 -6.17281098e-02 -7.95835656e-02]
 [ 1.78291435e-01  4.33318635e-02 -1.21183965e-01]
 [ 1.47646051e-02 -8.37533855e-03  9.73730482e-02]
 [ 4.22739789e-02 -2.47061459e-02  6.34958200e-02]
 [-2.92335978e-01 -7.57977136e-01 -1.35631044e-01]
 [ 1.11679848e-01 -1.13392630e-01 -1.87540800e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.25151208 -29.28467519 -29.2776944 ]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  8.31409947  -9.26062741 -83.52111278]
init_Out:  [2.49223638]
Stock Position:  8.314099471154409
Bond position:  [-828.91771073]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [1.1677497]
curr_Stock_Price:  99.86562208486586
curr_Factors:  [99.86562208 -0.8726109  -1.0285158 ]
mat_Sqrt:  [[14.91994341  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00888115  0.00381472 -0.31803336]
Stock Position:  -0.00888115276508251
Bond Position:  [2.05467154]


portfolio before change:  [1.16337049]
curr_Stock_Price:  100.41655744344241
curr_Factors:  [100.41655744  -0.55483457  -0.99355445]
mat_Sqrt:  [[21.34757378  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00731884 -0.00334762  0.42636204]
Stock Position:  -0.00731884252897144
Bond Position:  [1.89830346]


portfolio before change:  [1.16833149]
curr_Stock_Price:  99.80356972864757
curr_Factors:  [99.80356973 -0.38415151 -0.9925645 ]
mat_Sqrt:  [[25.191029    0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00323834 -0.00853248 -0.34079439]
Stock Position:  -0.0032383383359135495
Bond Position:  [1.49152921]


portfolio before change:  [1.16922052]
curr_Stock_Price:  99.64419703596067
curr_Factors:  [99.64419704 -0.61477912 -0.98957913]
mat_Sqrt:  [[20.03032876  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00320817 -0.06060329  0.46820055]
Stock Position:  -0.0032081745133256986
Bond Position:  [1.48889649]


portfolio before change:  [1.17049644]
curr_Stock_Price:  99.36252382107917
curr_Factors:  [99.36252382 -0.5878083  -0.97855041]
mat_Sqrt:  [[20.74730393  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00243701  0.00263413 -0.05298898]
Stock Position:  -0.002437007965996849
Bond Position:  [1.41264371]


portfolio before change:  [1.17357566]
curr_Stock_Price:  98.24393514296278
curr_Factors:  [98.24393514 -0.70658701 -0.95106901]
mat_Sqrt:  [[18.72383851  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00435804 -0.01934121  0.17884706]
Stock Position:  -0.004358037950244845
Bond Position:  [1.60172646]


portfolio before change:  [1.16801411]
curr_Stock_Price:  99.61198951811197
curr_Factors:  [99.61198952 -0.69238834 -0.95437831]
mat_Sqrt:  [[19.19242912  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00500544  0.04451295 -0.24493585]
Stock Position:  -0.005005443664084525
Bond Position:  [1.66661631]


portfolio before change:  [1.16622287]
curr_Stock_Price:  100.05309771442664
curr_Factors:  [100.05309771  -1.06454817  -0.95910627]
mat_Sqrt:  [[13.22417477  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00969918 -0.02387109  0.43536917]
Stock Position:  -0.009699182481617726
Bond Position:  [2.13665612]


portfolio before change:  [1.15834535]
curr_Stock_Price:  100.92036221416964
curr_Factors:  [100.92036221  -1.27167842  -0.98020789]
mat_Sqrt:  [[10.61688227  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0041315   0.01501882 -0.03367515]
Stock Position:  0.004131503473889543
Bond Position:  [0.74139252]


portfolio before change:  [1.15557625]
curr_Stock_Price:  100.20525642691352
curr_Factors:  [100.20525643  -1.35928831  -0.95988763]
mat_Sqrt:  [[ 9.85564812  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00246462  0.02839822 -0.03423242]
Stock Position:  0.0024646246715726507
Bond Position:  [0.90860791]


portfolio before change:  [1.15322851]
curr_Stock_Price:  99.16050359678397
curr_Factors:  [99.1605036  -1.17249555 -0.95070265]
mat_Sqrt:  [[11.86439125  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00030181 -0.00276958 -0.29837502]
Stock Position:  0.0003018116631240814
Bond Position:  [1.12330072]


portfolio before change:  [1.15326347]
curr_Stock_Price:  98.34573548656154
curr_Factors:  [98.34573549 -0.99149784 -0.92394489]
mat_Sqrt:  [[14.48402693  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00234919 -0.03398649 -0.84129057]
Stock Position:  -0.0023491909131820384
Bond Position:  [1.38429637]


portfolio before change:  [1.15168021]
curr_Stock_Price:  99.16702751345751
curr_Factors:  [99.16702751 -0.42996697 -0.87930895]
mat_Sqrt:  [[26.77663435  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00316021  0.00983637 -0.07400943]
Stock Position:  -0.0031602089707710415
Bond Position:  [1.46506874]


portfolio before change:  [1.15607817]
curr_Stock_Price:  97.89127572197675
curr_Factors:  [97.89127572 -0.30535908 -0.90133039]
mat_Sqrt:  [[29.28770945  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-4.45477180e-06 -1.95201423e-02 -2.27029761e-01]
Stock Position:  -4.454771795531805e-06
Bond Position:  [1.15651425]


portfolio before change:  [1.15638001]
curr_Stock_Price:  95.0442516361178
curr_Factors:  [95.04425164 -0.3062607  -0.91016398]
mat_Sqrt:  [[28.1604329   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00549259  0.01370274 -0.34570412]
Stock Position:  0.005492589074364312
Bond Position:  [0.634341]


portfolio before change:  [1.15678657]
curr_Stock_Price:  95.08939407556574
curr_Factors:  [95.08939408 -0.38480921 -0.9260146 ]
mat_Sqrt:  [[25.63589789  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00134283 -0.00264851  0.2777782 ]
Stock Position:  0.0013428257965158368
Bond Position:  [1.02909808]


portfolio before change:  [1.1576093]
curr_Stock_Price:  95.5104668549536
curr_Factors:  [95.51046685 -0.74114007 -0.93233204]
mat_Sqrt:  [[17.91724641  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00304718 -0.00781277  0.1811359 ]
Stock Position:  0.0030471813428309164
Bond Position:  [0.86657159]


portfolio before change:  [1.1615871]
curr_Stock_Price:  96.74476541154162
curr_Factors:  [96.74476541 -0.94747057 -0.96454757]
mat_Sqrt:  [[14.29711951  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02375251 -0.23969342 -0.38691762]
Stock Position:  -0.02375250720905185
Bond Position:  [3.45951784]


portfolio before change:  [1.17234849]
curr_Stock_Price:  96.328118818906
curr_Factors:  [96.32811882 -1.03567754 -1.01741916]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [1.17234849]
Stock Price:  97.20712280866543
PL:  [1.17234849]
Settle:  Tensor("sub_188:0", shape=(), dtype=float64)
PL:  Tensor("sub_189:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  95
output_Z_Vals[:, i, :]:  [[ 1.19251512e+02 -2.92846752e+01 -2.92776944e+01]
 [-2.06333971e-01  7.54221853e-02  1.69763147e-01]
 [-1.42001000e-01  1.49142645e-03  1.30611661e-01]
 [-5.21777968e-02 -1.32912674e-01 -4.22959568e-01]
 [-9.88296441e-02 -2.41910939e-01  2.15109929e-01]
 [-1.48814166e-01 -6.22931361e-02  1.73574196e-02]
 [ 5.27300328e-02  8.14472568e-02 -3.68022363e-02]
 [-8.44877030e-02  1.47892089e-01 -9.30198615e-02]
 [-1.13873620e-01 -5.57121182e-02  1.08111370e-01]
 [ 5.11249448e-02  3.49964731e-02 -6.99327034e-03]
 [ 8.67634671e-02  4.50209145e-02 -1.60744773e-02]
 [ 1.31186424e-01 -1.15460572e-02 -1.45933815e-01]
 [ 5.18423906e-02 -6.10058138e-03 -1.30898597e-01]
 [-8.45720117e-02  2.97281712e-02 -3.59999752e-02]
 [-9.98705698e-02  3.82093849e-02  2.00955148e-01]
 [-7.57986854e-02 -1.56507949e-01  1.61513337e-01]
 [-2.40069095e-02  4.48845121e-02  1.42566622e-01]
 [-6.21080586e-04  3.66468353e-02 -8.35300760e-02]
 [-3.33560744e-01 -9.23229071e-01 -1.47780603e-01]
 [ 6.85449188e-02 -2.61100174e-02 -7.10522888e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.25151208 -29.28467519 -29.2776944 ]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  8.31409947  -9.26062741 -83.52111278]
init_Out:  [2.49223638]
Stock Position:  8.314099471154409
Bond position:  [-828.91771073]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-10.71139645]
curr_Stock_Price:  98.43682679698135
curr_Factors:  [98.4368268  -0.56687949 -0.99473283]
mat_Sqrt:  [[20.65180384  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00821884  0.02385059  0.48428701]
Stock Position:  -0.008218837571028786
Bond Position:  [-9.90236016]


portfolio before change:  [-10.72515615]
curr_Stock_Price:  99.80974583584687
curr_Factors:  [99.80974584 -0.86278351 -0.99080598]
mat_Sqrt:  [[15.63756979  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00737336  0.00047163  0.37259871]
Stock Position:  -0.007373364217597317
Bond Position:  [-9.98922254]


portfolio before change:  [-10.74142298]
curr_Stock_Price:  101.67717210179191
curr_Factors:  [101.6771721   -0.70182042  -0.98290932]
mat_Sqrt:  [[18.86056215  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00752607 -0.04203068 -1.20658592]
Stock Position:  -0.007526066637653178
Bond Position:  [-9.97619381]


portfolio before change:  [-10.7402266]
curr_Stock_Price:  101.18677853823888
curr_Factors:  [101.18677854  -0.79685486  -1.00459209]
mat_Sqrt:  [[16.70187764  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00366226 -0.07649896  0.61364875]
Stock Position:  -0.0036622605296563475
Bond Position:  [-10.36965426]


portfolio before change:  [-10.74478516]
curr_Stock_Price:  101.72355559174119
curr_Factors:  [101.72355559  -0.92886719  -1.00512298]
mat_Sqrt:  [[14.70619351  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00998759 -0.01969882  0.04951589]
Stock Position:  -0.009987594650502283
Bond Position:  [-9.72881152]


portfolio before change:  [-10.75925939]
curr_Stock_Price:  102.92922348120618
curr_Factors:  [102.92922348  -0.78327338  -1.04340904]
mat_Sqrt:  [[16.56611231  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00285648  0.02575588 -0.10498654]
Stock Position:  0.002856479903057647
Bond Position:  [-11.05327465]


portfolio before change:  [-10.77076795]
curr_Stock_Price:  99.86779821794798
curr_Factors:  [99.86779822 -0.93224208 -1.00957327]
mat_Sqrt:  [[14.32536791  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00695666  0.04676759 -0.26535977]
Stock Position:  -0.006956662199648664
Bond Position:  [-10.07602142]


portfolio before change:  [-10.78285205]
curr_Stock_Price:  101.24270778888372
curr_Factors:  [101.24270779  -0.85983037  -1.01667608]
mat_Sqrt:  [[15.50270053  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00601469 -0.01761772  0.30841165]
Stock Position:  -0.006014691389117726
Bond Position:  [-10.17390841]


portfolio before change:  [-10.79357184]
curr_Stock_Price:  102.6020437855814
curr_Factors:  [102.60204379  -1.02769176  -1.02885075]
mat_Sqrt:  [[13.12232973  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0038561   0.01106686 -0.01994985]
Stock Position:  0.0038561029601843874
Bond Position:  [-11.18921588]


portfolio before change:  [-10.79832777]
curr_Stock_Price:  102.09420574669576
curr_Factors:  [102.09420575  -0.82627725  -1.004799  ]
mat_Sqrt:  [[16.35967916  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00517398  0.01423686 -0.04585601]
Stock Position:  0.005173983691372265
Bond Position:  [-11.32656152]


portfolio before change:  [-10.7994497]
curr_Stock_Price:  102.42471743547418
curr_Factors:  [102.42471744  -1.34607091  -1.02755063]
mat_Sqrt:  [[ 9.54012439  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01059731 -0.00365118 -0.41630856]
Stock Position:  0.010597313719991713
Bond Position:  [-11.88487656]


portfolio before change:  [-10.79176749]
curr_Stock_Price:  103.43004760692911
curr_Factors:  [103.43004761  -1.4326381   -1.06078878]
mat_Sqrt:  [[ 8.54604532  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00292127 -0.00192917 -0.37341726]
Stock Position:  0.002921270495658041
Bond Position:  [-11.09391464]


portfolio before change:  [-10.79710332]
curr_Stock_Price:  102.55302907407797
curr_Factors:  [102.55302907  -1.21568667  -1.03930724]
mat_Sqrt:  [[10.75516508  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00847527  0.00940087 -0.10269791]
Stock Position:  -0.008475267190557356
Bond Position:  [-9.927939]


portfolio before change:  [-10.8033007]
curr_Stock_Price:  102.99137245465467
curr_Factors:  [102.99137245  -1.32233482  -1.03855097]
mat_Sqrt:  [[ 9.71585837  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00595565  0.01208287  0.5732691 ]
Stock Position:  -0.00595564567397339
Bond Position:  [-10.18992057]


portfolio before change:  [-10.81093133]
curr_Stock_Price:  103.84482139527015
curr_Factors:  [103.8448214   -1.22933958  -1.08234709]
mat_Sqrt:  [[10.29039577  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00455482 -0.04949216  0.46075259]
Stock Position:  -0.004554823005396304
Bond Position:  [-10.33793655]


portfolio before change:  [-10.80768513]
curr_Stock_Price:  102.5646387232714
curr_Factors:  [102.56463872  -0.94886982  -1.10087208]
mat_Sqrt:  [[13.20705714  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00047348 0.01419373 0.40670289]
Stock Position:  0.0004734812231105877
Bond Position:  [-10.85624757]


portfolio before change:  [-10.81075511]
curr_Stock_Price:  101.81366674721686
curr_Factors:  [101.81366675  -1.11598958  -1.08405472]
mat_Sqrt:  [[11.28077609  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00148264  0.01158875 -0.23828806]
Stock Position:  -0.0014826434459768063
Bond Position:  [-10.65980174]


portfolio before change:  [-10.81428815]
curr_Stock_Price:  102.39894523588363
curr_Factors:  [102.39894524  -0.98284062  -1.09043534]
mat_Sqrt:  [[12.87903065  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.03009264 -0.29195067 -0.42157693]
Stock Position:  -0.030092637860265795
Bond Position:  [-7.73283377]


portfolio before change:  [-10.81434687]
curr_Stock_Price:  102.33664655498485
curr_Factors:  [102.33664655  -0.87895429  -1.09228729]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-10.81434687]
Stock Price:  102.53938551252187
PL:  [-13.35373238]
Settle:  Tensor("sub_190:0", shape=(), dtype=float64)
PL:  Tensor("sub_191:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  96
output_Z_Vals[:, i, :]:  [[ 1.19251512e+02 -2.92846752e+01 -2.92776944e+01]
 [-3.19081640e-01  1.05883486e-01  2.47975531e-01]
 [-1.47707992e-01 -5.84136774e-05  1.33030104e-01]
 [-2.07944324e-02  2.93777062e-02  4.05242979e-02]
 [-8.55808330e-02 -1.31199623e-01  1.02814454e-01]
 [ 1.06391551e-02 -1.04670726e-01  8.05449229e-03]
 [ 5.85485150e-02  2.82718419e-02 -1.52533896e-02]
 [-9.78337785e-02  1.69357074e-01 -9.85380203e-02]
 [-1.61608559e-02 -1.41156448e-02  1.46253966e-02]
 [ 4.90898697e-02  4.22341706e-02 -9.51521525e-03]
 [ 1.07265382e-01  2.90782299e-02 -1.78605134e-02]
 [ 9.37114633e-02 -1.04470641e-02 -1.29749504e-01]
 [ 5.00886534e-02 -7.14098391e-03 -1.50969778e-01]
 [-8.45720117e-02  2.97281712e-02 -3.59999752e-02]
 [-1.22382269e-01  7.22261724e-02  2.43611401e-01]
 [-9.51423634e-02 -1.99549735e-01  1.79565583e-01]
 [-2.95064382e-02  3.51216930e-02  1.78514186e-01]
 [-7.20883223e-02  1.39921674e-01 -7.25045324e-02]
 [-2.62133287e-01 -8.32996572e-01 -4.23677942e-02]
 [ 7.64348917e-02 -4.24919057e-02 -9.27685209e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.25151208 -29.28467519 -29.2776944 ]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  8.31409947  -9.26062741 -83.52111278]
init_Out:  [2.49223638]
Stock Position:  8.314099471154409
Bond position:  [-828.91771073]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-8.24359143]
curr_Stock_Price:  98.73364848215238
curr_Factors:  [98.73364848 -1.15519242 -1.00816265]
mat_Sqrt:  [[11.34833148  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02341577  0.0334833   0.70740517]
Stock Position:  -0.02341577239448585
Bond Position:  [-5.93166679]


portfolio before change:  [-8.25937713]
curr_Stock_Price:  99.34445860143742
curr_Factors:  [99.3444586  -1.33137219 -1.00193214]
mat_Sqrt:  [[ 9.6339071   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-1.25135984e-02 -1.84720267e-05  3.79497858e-01]
Stock Position:  -0.012513598358193413
Bond Position:  [-7.01622047]


portfolio before change:  [-8.26251228]
curr_Stock_Price:  99.45480867095326
curr_Factors:  [99.45480867 -1.24555448 -1.03343134]
mat_Sqrt:  [[10.18297834  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00115525  0.00929005  0.11560454]
Stock Position:  -0.001155252937680485
Bond Position:  [-8.14761682]


portfolio before change:  [-8.2635209]
curr_Stock_Price:  98.56449399281428
curr_Factors:  [98.56449399 -1.20313926 -0.94987668]
mat_Sqrt:  [[11.44662761  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.005939   -0.04148896  0.29330102]
Stock Position:  -0.0059389963918826906
Bond Position:  [-7.67814672]


portfolio before change:  [-8.27188263]
curr_Stock_Price:  99.64918142408881
curr_Factors:  [99.64918142 -1.24240115 -0.92472317]
mat_Sqrt:  [[11.41047178  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00083964 -0.03309979  0.02297722]
Stock Position:  0.0008396396857224651
Bond Position:  [-8.35555204]


portfolio before change:  [-8.27360315]
curr_Stock_Price:  100.0882098215945
curr_Factors:  [100.08820982  -1.3398986   -0.9362783 ]
mat_Sqrt:  [[10.27665675  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00546529  0.00894034 -0.04351367]
Stock Position:  0.005465289639843302
Bond Position:  [-8.82061421]


portfolio before change:  [-8.27157196]
curr_Stock_Price:  100.86339641642945
curr_Factors:  [100.86339642  -1.31588929  -0.95172553]
mat_Sqrt:  [[10.44530169  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01087331  0.05355541 -0.28110154]
Stock Position:  -0.010873308415505503
Bond Position:  [-7.17485315]


portfolio before change:  [-8.28663588]
curr_Stock_Price:  102.08381399197563
curr_Factors:  [102.08381399  -1.34842161  -0.98744511]
mat_Sqrt:  [[ 9.87422139  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00137124 -0.00446376  0.04172219]
Stock Position:  -0.001371239629296564
Bond Position:  [-8.14665451]


portfolio before change:  [-8.2889181]
curr_Stock_Price:  102.26270585012695
curr_Factors:  [102.26270585  -1.21704085  -0.95884917]
mat_Sqrt:  [[11.60754166  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00415575  0.01335562 -0.02714426]
Stock Position:  0.0041557521416524575
Bond Position:  [-8.71389656]


portfolio before change:  [-8.28940866]
curr_Stock_Price:  102.66893527111336
curr_Factors:  [102.66893527  -1.33635373  -0.96464884]
mat_Sqrt:  [[10.28315398  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01014965  0.00919534 -0.05095107]
Stock Position:  0.010149650297948471
Bond Position:  [-9.33146245]


portfolio before change:  [-8.28724746]
curr_Stock_Price:  103.11174436300534
curr_Factors:  [103.11174436  -1.22354959  -0.95140597]
mat_Sqrt:  [[11.71485549  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00571554 -0.00330365 -0.37013922]
Stock Position:  0.005715539106463312
Bond Position:  [-8.87658666]


portfolio before change:  [-8.29007584]
curr_Stock_Price:  103.00519881099551
curr_Factors:  [103.00519881  -1.33593557  -0.94594734]
mat_Sqrt:  [[10.51598567  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00181511 -0.00225818 -0.43067475]
Stock Position:  0.0018151125123933608
Bond Position:  [-8.47704187]


portfolio before change:  [-8.29300392]
curr_Stock_Price:  102.55974457626951
curr_Factors:  [102.55974458  -1.56532888  -0.93718112]
mat_Sqrt:  [[ 8.39751225  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01085475  0.00940087 -0.10269791]
Stock Position:  -0.010854750200241296
Bond Position:  [-7.17974351]


portfolio before change:  [-8.306139]
curr_Stock_Price:  103.60444122942492
curr_Factors:  [103.60444123  -1.68032649  -0.93320908]
mat_Sqrt:  [[ 7.59161718  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00932482  0.02283992  0.69495552]
Stock Position:  -0.009324815311168617
Bond Position:  [-7.34004672]


portfolio before change:  [-8.31482523]
curr_Stock_Price:  104.33914635560717
curr_Factors:  [104.33914636  -1.93393588  -0.93801386]
mat_Sqrt:  [[ 5.90439433  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01077859 -0.06310317  0.51225063]
Stock Position:  -0.010778589740855923
Bond Position:  [-7.19019638]


portfolio before change:  [-8.31962263]
curr_Stock_Price:  104.61744077000144
curr_Factors:  [104.61744077  -2.21099426  -0.93315434]
mat_Sqrt:  [[ 4.50938902  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00173847 0.01110645 0.50925129]
Stock Position:  0.0017384740434170513
Bond Position:  [-8.50149733]


portfolio before change:  [-8.32200177]
curr_Stock_Price:  104.47162303555736
curr_Factors:  [104.47162304  -1.91379953  -0.9699431 ]
mat_Sqrt:  [[ 5.84258217  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0142532   0.04424712 -0.20683525]
Stock Position:  -0.01425319893129072
Bond Position:  [-6.83294694]


portfolio before change:  [-8.31801394]
curr_Stock_Price:  104.07197430063364
curr_Factors:  [104.0719743  -1.6402815  -0.9517517]
mat_Sqrt:  [[ 7.79162565  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.03751328 -0.26341665 -0.12086352]
Stock Position:  -0.0375132827753959
Bond Position:  [-4.41393254]


portfolio before change:  [-8.32944104]
curr_Stock_Price:  104.34716934004274
curr_Factors:  [104.34716934  -1.18159876  -0.93606139]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-8.32944104]
Stock Price:  102.42869973616934
PL:  [-10.75814077]
Settle:  Tensor("sub_192:0", shape=(), dtype=float64)
PL:  Tensor("sub_193:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  97
output_Z_Vals[:, i, :]:  [[ 1.19251512e+02 -2.92846752e+01 -2.92776944e+01]
 [-8.71594691e-02  9.54580300e-03 -9.97043359e-02]
 [-1.60550264e-01 -3.54597188e-03  1.38472253e-01]
 [-5.06162826e-02 -3.11951444e-02 -1.30397338e-01]
 [-9.88296441e-02 -2.41910939e-01  2.15109929e-01]
 [-1.12209262e-01  6.29602391e-02 -7.53671198e-03]
 [-5.60231011e-02 -2.05356701e-02  3.38601136e-02]
 [-5.80976539e-02  1.05242195e-01 -9.87306267e-02]
 [-2.53918753e-01 -1.14425326e-01  2.39495937e-01]
 [ 5.92784116e-02  5.44635258e-02 -9.09592404e-03]
 [ 1.78149133e-02  8.98492246e-02 -1.70257688e-03]
 [ 8.58508094e-02 -1.02165420e-02 -1.26354724e-01]
 [ 3.41053289e-02 -6.89203574e-02 -3.88430942e-01]
 [-8.41758582e-02  2.98509153e-02 -3.51036626e-02]
 [-7.83966158e-02 -3.94975293e-03  1.15150966e-01]
 [-1.55761382e-02 -4.81194107e-02  1.11186821e-01]
 [-2.34796306e-02  3.50268183e-02  1.52964739e-01]
 [-3.27476030e-02  7.76378670e-02 -9.36153866e-02]
 [-3.54803942e-01 -9.40296587e-01 -1.96115415e-01]
 [ 8.33759855e-02 -6.01932523e-02 -1.15100967e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.25151208 -29.28467519 -29.2776944 ]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  8.31409947  -9.26062741 -83.52111278]
init_Out:  [2.49223638]
Stock Position:  8.314099471154409
Bond position:  [-828.91771073]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [2.68829419]
curr_Stock_Price:  100.04850953937078
curr_Factors:  [100.04850954  -0.9372997   -0.98205612]
mat_Sqrt:  [[14.67725987  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00730825  0.00301865 -0.28442872]
Stock Position:  -0.007308248327769788
Bond Position:  [3.41947354]


portfolio before change:  [2.68848949]
curr_Stock_Price:  100.13877296357641
curr_Factors:  [100.13877296  -0.63214674  -1.00666657]
mat_Sqrt:  [[19.44798845  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00680668 -0.00112133  0.39502279]
Stock Position:  -0.006806682895267824
Bond Position:  [3.37010237]


portfolio before change:  [2.69054572]
curr_Stock_Price:  99.96047857995843
curr_Factors:  [99.96047858 -0.51793543 -1.01179574]
mat_Sqrt:  [[21.65082851  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00360443 -0.00986477 -0.37198731]
Stock Position:  -0.003604434023315174
Bond Position:  [3.05084667]


portfolio before change:  [2.68550112]
curr_Stock_Price:  101.57166308618868
curr_Factors:  [101.57166309  -0.39950807  -0.98605368]
mat_Sqrt:  [[25.41152549  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00240704 -0.07649896  0.61364875]
Stock Position:  -0.002407042712650108
Bond Position:  [2.92998845]


portfolio before change:  [2.69576683]
curr_Stock_Price:  97.61114896359672
curr_Factors:  [97.61114896 -0.45362336 -1.01580601]
mat_Sqrt:  [[22.4561013   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00499294  0.01990978 -0.02150014]
Stock Position:  -0.004992944176420226
Bond Position:  [3.18313385]


portfolio before change:  [2.6897769]
curr_Stock_Price:  98.97023082822079
curr_Factors:  [98.97023083 -0.52405247 -0.98338424]
mat_Sqrt:  [[21.91962578  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00226471 -0.00649395  0.09659348]
Stock Position:  -0.0022647130733677015
Bond Position:  [2.91391607]


portfolio before change:  [2.69181363]
curr_Stock_Price:  98.39260274926187
curr_Factors:  [98.39260275 -0.77882846 -0.98994358]
mat_Sqrt:  [[16.7800987   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00450138  0.0332805  -0.281651  ]
Stock Position:  -0.004501380963490981
Bond Position:  [3.13471622]


portfolio before change:  [2.69000062]
curr_Stock_Price:  98.96948969320665
curr_Factors:  [98.96948969 -0.77728797 -0.93042696]
mat_Sqrt:  [[17.94114521  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0115927  -0.03618447  0.68321524]
Stock Position:  -0.01159269918004986
Bond Position:  [3.83732414]


portfolio before change:  [2.68795883]
curr_Stock_Price:  99.22837987747255
curr_Factors:  [99.22837988 -0.78352378 -0.90272114]
mat_Sqrt:  [[18.37845651  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00320092  0.01722288 -0.02594814]
Stock Position:  0.0032009192951122692
Bond Position:  [2.3703368]


portfolio before change:  [2.68506576]
curr_Stock_Price:  98.13940231773132
curr_Factors:  [98.13940232 -0.77429612 -0.93165811]
mat_Sqrt:  [[17.82201902  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00111027  0.02841282 -0.00485698]
Stock Position:  0.0011102711325263234
Bond Position:  [2.57610442]


portfolio before change:  [2.68661577]
curr_Stock_Price:  98.95532801681249
curr_Factors:  [98.95532802 -0.60872468 -0.93967077]
mat_Sqrt:  [[21.03679535  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0028424  -0.00323075 -0.36045486]
Stock Position:  0.002842399163866535
Bond Position:  [2.40534522]


portfolio before change:  [2.6881386]
curr_Stock_Price:  99.27949888661438
curr_Factors:  [99.27949889 -0.70175789 -0.92798804]
mat_Sqrt:  [[19.45673265  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00241368 -0.02179453 -1.10808536]
Stock Position:  -0.0024136797268695834
Bond Position:  [2.92776751]


portfolio before change:  [2.68543648]
curr_Stock_Price:  100.7022886900264
curr_Factors:  [100.70228869  -0.76036004  -0.96514381]
mat_Sqrt:  [[17.93339608  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00505039  0.00943969 -0.10014098]
Stock Position:  -0.005050388426617097
Bond Position:  [3.19402215]


portfolio before change:  [2.6830852]
curr_Stock_Price:  101.32598047339144
curr_Factors:  [101.32598047  -0.26281345  -0.94829134]
mat_Sqrt:  [[30.18176887  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00182208 -0.00124902  0.32849365]
Stock Position:  -0.0018220769537272482
Bond Position:  [2.86770893]


portfolio before change:  [2.68247392]
curr_Stock_Price:  102.0549798276532
curr_Factors:  [102.05497983  -0.40653751  -0.9600036 ]
mat_Sqrt:  [[26.02273501  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 2.25853996e-04 -1.52166937e-02  3.17185051e-01]
Stock Position:  0.00022585399645846666
Bond Position:  [2.65942439]


portfolio before change:  [2.68325552]
curr_Stock_Price:  102.57152244661265
curr_Factors:  [102.57152245  -0.77537641  -0.92604812]
mat_Sqrt:  [[18.71145307  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00046221 0.01107645 0.43636582]
Stock Position:  0.0004622064646398254
Bond Position:  [2.6358463]


portfolio before change:  [2.68374469]
curr_Stock_Price:  102.20398920707709
curr_Factors:  [102.20398921  -0.53410749  -0.89371453]
mat_Sqrt:  [[24.51165425  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00203381  0.02455125 -0.26705864]
Stock Position:  -0.002033814695121891
Bond Position:  [2.89160866]


portfolio before change:  [2.68599473]
curr_Stock_Price:  101.45315731393524
curr_Factors:  [101.45315731  -0.55781405  -0.95685768]
mat_Sqrt:  [[22.30755623  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01878799 -0.29734789 -0.55946269]
Stock Position:  -0.01878799194072779
Bond Position:  [4.59209584]


portfolio before change:  [2.67487555]
curr_Stock_Price:  102.10609290352676
curr_Factors:  [102.1060929   -0.67251877  -0.95611559]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [2.67487555]
Stock Price:  102.59134210270199
PL:  [0.08353345]
Settle:  Tensor("sub_194:0", shape=(), dtype=float64)
PL:  Tensor("sub_195:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  98
output_Z_Vals[:, i, :]:  [[ 1.19251512e+02 -2.92846752e+01 -2.92776944e+01]
 [-1.60951688e-01  2.68271652e-02 -8.32480157e-02]
 [-1.40094247e-01 -1.63229693e-02  5.77926632e-02]
 [-5.92337505e-02  2.41249400e-02  1.36876116e-02]
 [-8.78815938e-02 -1.50425519e-01  1.22315452e-01]
 [-4.74663239e-02 -2.94162953e-03 -2.35943180e-02]
 [-8.57239229e-02 -5.84632912e-02  5.99672534e-02]
 [-1.23265671e-01  1.89789691e-01 -6.94074018e-02]
 [-3.11283786e-02 -2.14671346e-02  3.15554260e-02]
 [ 4.90767345e-02  3.20820440e-02 -6.49192258e-03]
 [ 1.08121508e-01  2.42554932e-02 -2.35549273e-02]
 [ 1.20062398e-01 -1.12198333e-02 -1.41129682e-01]
 [ 3.78798167e-02 -1.38201723e-02 -2.61827918e-01]
 [-6.41848714e-02  1.74844318e-02 -3.07470243e-02]
 [-1.22264182e-01  7.20597492e-02  2.43441096e-01]
 [ 3.30003398e-03 -1.34978151e-02  9.65783237e-02]
 [-2.35563986e-02 -1.78772611e-02  2.21149610e-01]
 [-3.66210940e-02  8.15460375e-02 -9.76939076e-02]
 [-3.90625647e-01 -1.11045065e+00 -3.03883408e-01]
 [ 1.08086355e-01 -1.16980087e-01 -1.88491449e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.25151208 -29.28467519 -29.2776944 ]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  8.31409947  -9.26062741 -83.52111278]
init_Out:  [2.49223638]
Stock Position:  8.314099471154409
Bond position:  [-828.91771073]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-1.30304731]
curr_Stock_Price:  99.56844052960496
curr_Factors:  [99.56844053 -0.73397719 -0.98986572]
mat_Sqrt:  [[17.76095198  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00997987  0.00848349 -0.23748342]
Stock Position:  -0.009979867308769236
Bond Position:  [-0.30936749]


portfolio before change:  [-1.28799737]
curr_Stock_Price:  98.05265922473119
curr_Factors:  [98.05265922 -0.30087591 -0.97103386]
mat_Sqrt:  [[27.48374975  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00468345 -0.00516178  0.16486638]
Stock Position:  -0.00468345214152286
Bond Position:  [-0.82877243]


portfolio before change:  [-1.28567751]
curr_Stock_Price:  97.51308276181354
curr_Factors:  [97.51308276 -0.35222051 -0.9774354 ]
mat_Sqrt:  [[25.79886873  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00216354  0.00762898  0.03904695]
Stock Position:  -0.0021635396411687612
Bond Position:  [-1.07470409]


portfolio before change:  [-1.28754344]
curr_Stock_Price:  98.25132775168935
curr_Factors:  [98.25132775 -0.73221445 -0.96093301]
mat_Sqrt:  [[18.07231661  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00369615 -0.04756873  0.34893194]
Stock Position:  -0.003696151876979311
Bond Position:  [-0.92439161]


portfolio before change:  [-1.29308856]
curr_Stock_Price:  99.689037247758
curr_Factors:  [99.68903725 -0.45951571 -0.9753761 ]
mat_Sqrt:  [[23.74005966  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00220549 -0.00093022 -0.06730802]
Stock Position:  -0.002205489251963872
Bond Position:  [-1.07322546]


portfolio before change:  [-1.29079464]
curr_Stock_Price:  98.5272741635837
curr_Factors:  [98.52727416 -0.17315203 -1.00544369]
mat_Sqrt:  [[30.31788157  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00247355 -0.01848772  0.17106988]
Stock Position:  -0.0024735459867565417
Bond Position:  [-1.0470829]


portfolio before change:  [-1.29859121]
curr_Stock_Price:  101.57341218623753
curr_Factors:  [101.57341219  -0.69190626  -1.03996056]
mat_Sqrt:  [[17.97379726  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00737368  0.06001677 -0.198     ]
Stock Position:  -0.007373681062168523
Bond Position:  [-0.54962126]


portfolio before change:  [-1.30576869]
curr_Stock_Price:  102.52816718025373
curr_Factors:  [102.52816718  -0.9232902   -1.09848077]
mat_Sqrt:  [[13.57685614  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00185915 -0.0067885   0.09001885]
Stock Position:  -0.0018591515576079347
Bond Position:  [-1.11515329]


portfolio before change:  [-1.30654823]
curr_Stock_Price:  102.7974905953259
curr_Factors:  [102.7974906   -0.74268329  -1.09396016]
mat_Sqrt:  [[16.3809242   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00296564  0.01014523 -0.01851965]
Stock Position:  0.0029656404355331567
Bond Position:  [-1.61140862]


portfolio before change:  [-1.30721042]
curr_Stock_Price:  102.7100583444744
curr_Factors:  [102.71005834  -0.85263648  -1.06679573]
mat_Sqrt:  [[15.0665618   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0068987   0.00767026 -0.06719565]
Stock Position:  0.006898697560067607
Bond Position:  [-2.01577605]


portfolio before change:  [-1.30527069]
curr_Stock_Price:  103.06429076711969
curr_Factors:  [103.06429077  -0.92056506  -1.08318512]
mat_Sqrt:  [[13.89602456  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0065461  -0.00354802 -0.4026037 ]
Stock Position:  0.006546097179340341
Bond Position:  [-1.97993955]


portfolio before change:  [-1.30152675]
curr_Stock_Price:  103.71185002210142
curr_Factors:  [103.71185002  -0.64595711  -1.04608126]
mat_Sqrt:  [[19.09789292  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00083373 -0.00437032 -0.74692217]
Stock Position:  -0.0008337264537049201
Bond Position:  [-1.21505943]


portfolio before change:  [-1.30215448]
curr_Stock_Price:  104.10038471267542
curr_Factors:  [104.10038471  -0.37412458  -1.05659174]
mat_Sqrt:  [[24.89431202  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00281227  0.00552906 -0.0877127 ]
Stock Position:  -0.0028122743568570973
Bond Position:  [-1.00939564]


portfolio before change:  [-1.30290618]
curr_Stock_Price:  104.27793278534219
curr_Factors:  [ 1.04277933e+02 -9.91841177e-02 -1.07596759e+00]
mat_Sqrt:  [[32.19811971  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00219613  0.02278729  0.69446969]
Stock Position:  -0.002196134498719928
Bond Position:  [-1.07389781]


portfolio before change:  [-1.29707079]
curr_Stock_Price:  101.49855014273622
curr_Factors:  [ 1.01498550e+02 -9.16611399e-02 -1.03433132e+00]
mat_Sqrt:  [[32.91906776  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00068852 -0.00426838  0.27551108]
Stock Position:  0.0006885216136193413
Bond Position:  [-1.36695473]


portfolio before change:  [-1.29570541]
curr_Stock_Price:  103.97800649176348
curr_Factors:  [103.97800649  -0.30262179  -1.02451369]
mat_Sqrt:  [[27.5787053   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00076595 -0.00565329  0.63087828]
Stock Position:  0.0007659528381872103
Bond Position:  [-1.37534766]


portfolio before change:  [-1.29781677]
curr_Stock_Price:  101.67044107387991
curr_Factors:  [101.67044107  -0.1212602   -0.97637014]
mat_Sqrt:  [[33.92344168  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0016053   0.02578712 -0.27869353]
Stock Position:  -0.0016052990792334943
Bond Position:  [-1.13460531]


portfolio before change:  [-1.30154337]
curr_Stock_Price:  103.81515491756518
curr_Factors:  [103.81515492   0.20037041  -0.99115234]
mat_Sqrt:  [[47.07914095  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01022379 -0.35115533 -0.86689478]
Stock Position:  -0.01022379105878217
Bond Position:  [-0.24015891]


portfolio before change:  [-1.25942328]
curr_Stock_Price:  99.68947074867782
curr_Factors:  [ 9.96894707e+01 -4.52527475e-02 -9.78887493e-01]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-1.25942328]
Stock Price:  95.89170091658623
PL:  [-1.25942328]
Settle:  Tensor("sub_196:0", shape=(), dtype=float64)
PL:  Tensor("sub_197:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  99
output_Z_Vals[:, i, :]:  [[ 1.19251512e+02 -2.92846752e+01 -2.92776944e+01]
 [-1.56037839e-01  3.38061079e-02 -3.61037153e-02]
 [-5.32383689e-02  2.55965727e-02  9.29968654e-02]
 [-4.55966479e-02  4.83760452e-03 -2.99700076e-02]
 [-9.88296441e-02 -2.41910939e-01  2.15109929e-01]
 [-3.39129141e-01  1.01908248e-01 -5.02815890e-03]
 [ 5.24290273e-02  8.64552468e-02 -3.87662043e-02]
 [-1.89232034e-01  2.57982012e-01 -2.40557265e-02]
 [-1.79226429e-01 -5.99870871e-02  1.13772844e-01]
 [ 1.88383681e-02  3.13303901e-02 -1.24186314e-02]
 [ 4.11352551e-02  8.15205451e-02 -1.22879737e-02]
 [ 2.55203950e-01 -1.51830032e-02 -1.99493264e-01]
 [ 2.37438695e-02 -5.36830670e-02 -5.76177173e-01]
 [-4.91078657e-02  8.42975692e-03 -2.68622827e-02]
 [-8.33605557e-02  5.05519405e-03  1.33161769e-01]
 [ 5.70150667e-02 -1.24221846e-02  8.37901266e-02]
 [ 2.25003301e-02 -3.67967667e-02  1.13386076e-01]
 [-2.88320611e-03  3.25942232e-02 -8.41732599e-02]
 [-5.05169835e-01 -1.27809475e+00 -4.52819383e-01]
 [ 1.86709904e-01 -2.72991517e-01 -4.34273813e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.25151208 -29.28467519 -29.2776944 ]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  8.31409947  -9.26062741 -83.52111278]
init_Out:  [2.49223638]
Stock Position:  8.314099471154409
Bond position:  [-828.91771073]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-1.34897272]
curr_Stock_Price:  99.56291673147038
curr_Factors:  [99.56291673 -0.97691922 -1.00133012]
mat_Sqrt:  [[13.77066274  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01180296  0.01069043 -0.10299385]
Stock Position:  -0.011802961988129395
Bond Position:  [-0.1738354]


portfolio before change:  [-1.34395079]
curr_Stock_Price:  99.13375355722197
curr_Factors:  [99.13375356 -0.76602485 -0.97026026]
mat_Sqrt:  [[17.46475531  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00192356  0.00809435  0.26529417]
Stock Position:  -0.0019235633118787367
Bond Position:  [-1.15326074]


portfolio before change:  [-1.34495906]
curr_Stock_Price:  99.50801713173962
curr_Factors:  [99.50801713 -0.58165611 -0.93844813]
mat_Sqrt:  [[21.76131762  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00237069  0.00152978 -0.08549609]
Stock Position:  -0.002370690255504359
Bond Position:  [-1.10905637]


portfolio before change:  [-1.34752122]
curr_Stock_Price:  100.47181374105142
curr_Factors:  [100.47181374  -0.40370016  -0.93253711]
mat_Sqrt:  [[26.40728602  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00231628 -0.07649896  0.61364875]
Stock Position:  -0.002316278439859504
Bond Position:  [-1.11480052]


portfolio before change:  [-1.35393178]
curr_Stock_Price:  103.11908780988347
curr_Factors:  [103.11908781  -0.36397011  -0.94453518]
mat_Sqrt:  [[27.86521727  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01211274  0.03222622 -0.01434394]
Stock Position:  -0.012112744247757375
Bond Position:  [-0.10487664]


portfolio before change:  [-1.34858737]
curr_Stock_Price:  102.67570095384426
curr_Factors:  [ 1.02675701e+02 -6.49684311e-02 -9.32517054e-01]
mat_Sqrt:  [[37.86737795  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00123452  0.02733955 -0.11058919]
Stock Position:  0.0012345236563095529
Bond Position:  [-1.47534295]


portfolio before change:  [-1.34667975]
curr_Stock_Price:  104.51973620784612
curr_Factors:  [104.51973621  -0.18134738  -0.92962992]
mat_Sqrt:  [[34.41176861  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00544817  0.08158108 -0.06862429]
Stock Position:  -0.005448174533730334
Bond Position:  [-0.77723798]


portfolio before change:  [-1.34136536]
curr_Stock_Price:  103.50862236023379
curr_Factors:  [103.50862236  -0.24822786  -0.896249  ]
mat_Sqrt:  [[32.9561554   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00478064 -0.01896958  0.32456225]
Stock Position:  -0.004780639685855414
Bond Position:  [-0.84652793]


portfolio before change:  [-1.34377502]
curr_Stock_Price:  103.96839413652557
curr_Factors:  [103.96839414   0.30251324  -0.89787145]
mat_Sqrt:  [[57.32453629  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00029852  0.00990754 -0.0354269 ]
Stock Position:  0.0002985174219163105
Bond Position:  [-1.37481139]


portfolio before change:  [-1.34548583]
curr_Stock_Price:  99.3888669456282
curr_Factors:  [99.38886695  0.40217951 -0.9377938 ]
mat_Sqrt:  [[58.17326124  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00070018  0.02577906 -0.03505417]
Stock Position:  0.0007001813815005114
Bond Position:  [-1.41507607]


portfolio before change:  [-1.34483098]
curr_Stock_Price:  100.82944500959326
curr_Factors:  [100.82944501   0.2181224   -0.9059049 ]
mat_Sqrt:  [[50.68590813  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00422387 -0.00480129 -0.56909875]
Stock Position:  0.004223866992716867
Bond Position:  [-1.77072114]


portfolio before change:  [-1.34506862]
curr_Stock_Price:  100.87800035795264
curr_Factors:  [100.87800036   0.21849611  -0.89964594]
mat_Sqrt:  [[51.04777897  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00186598 -0.01697608 -1.6436731 ]
Stock Position:  -0.0018659752937079323
Bond Position:  [-1.15683277]


portfolio before change:  [-1.34932512]
curr_Stock_Price:  103.0040988530343
curr_Factors:  [ 1.03004099e+02  7.28054772e-03 -8.90900456e-01]
mat_Sqrt:  [[42.56996144  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00127727  0.00266572 -0.07663062]
Stock Position:  -0.0012772727286111771
Bond Position:  [-1.21776079]


portfolio before change:  [-1.34750727]
curr_Stock_Price:  101.34249193528227
curr_Factors:  [101.34249194  -0.23190554  -0.88237977]
mat_Sqrt:  [[33.25551064  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00168539  0.00159859  0.37987346]
Stock Position:  -0.0016853898132881474
Bond Position:  [-1.17670567]


portfolio before change:  [-1.34603697]
curr_Stock_Price:  100.2955447187662
curr_Factors:  [100.29554472   0.1268568   -0.87149219]
mat_Sqrt:  [[47.63109885  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00154936 -0.00392824  0.23902991]
Stock Position:  0.0015493641147301123
Bond Position:  [-1.50143129]


portfolio before change:  [-1.35602303]
curr_Stock_Price:  94.09257262859595
curr_Factors:  [94.09257263  0.23177238 -0.85536483]
mat_Sqrt:  [[50.43506463  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00088619 -0.01163616  0.32345891]
Stock Position:  0.0008861905459844822
Bond Position:  [-1.43940698]


portfolio before change:  [-1.35241585]
curr_Stock_Price:  98.56912869274998
curr_Factors:  [98.56912869  0.57380432 -0.86679324]
mat_Sqrt:  [[ 7.35355671e+01  0.00000000e+00  0.00000000e+00]
 [-8.16496581e-02  3.16227766e+00  0.00000000e+00]
 [-7.15541753e-02  0.00000000e+00  3.50542437e-01]]
grads:  [-0.00026142  0.0103072  -0.24012288]
Stock Position:  -0.0002614166500482784
Bond Position:  [-1.32664824]


portfolio before change:  [-1.35026164]
curr_Stock_Price:  89.05974546302676
curr_Factors:  [89.05974546  0.71757858 -0.84843956]
mat_Sqrt:  [[ 7.81356531e+01  0.00000000e+00  0.00000000e+00]
 [-8.16496581e-02  3.16227766e+00  0.00000000e+00]
 [-7.15541753e-02  0.00000000e+00  3.50542437e-01]]
grads:  [-0.0080706  -0.40416905 -1.29176766]
Stock Position:  -0.008070598304861544
Bond Position:  [-0.63149621]


portfolio before change:  [-1.38078907]
curr_Stock_Price:  92.82272946102098
curr_Factors:  [92.82272946  0.73876618 -0.85293532]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-1.38078907]
Stock Price:  90.19031839263226
PL:  [-1.38078907]
Settle:  Tensor("sub_198:0", shape=(), dtype=float64)
PL:  Tensor("sub_199:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  100
output_Z_Vals[:, i, :]:  [[ 1.19251512e+02 -2.92846752e+01 -2.92776944e+01]
 [-8.41966798e-02 -2.26340512e-02 -1.76739574e-01]
 [-2.73509847e-01 -3.42222515e-02  1.86340951e-01]
 [-5.98345203e-02 -9.79664972e-02 -3.18268243e-01]
 [-9.88296441e-02 -2.41910939e-01  2.15109929e-01]
 [-3.22263077e-02 -1.68423374e-01  3.53922796e-02]
 [ 5.54635939e-02  3.59675240e-02 -1.89665892e-02]
 [-8.82189147e-02  1.46089950e-01 -8.01674382e-02]
 [-3.29822439e-01 -1.74981413e-01  3.79856472e-01]
 [-3.63520121e-04 -7.20234482e-02  3.46847133e-02]
 [-1.40334584e-01  1.56385888e-01  3.47138040e-02]
 [-1.23971839e-01 -9.90334069e-03 -1.44848238e-01]
 [-4.39617895e-02 -2.47891400e-01  7.02686650e-02]
 [ 8.90657165e-02 -5.77696699e-02 -1.76600388e-03]
 [ 1.11348156e-02 -5.79141975e-02 -1.09473076e-01]
 [ 1.83374947e-01  4.65701215e-02 -1.38384060e-01]
 [ 2.00425561e-02 -3.89876773e-02  1.06137277e-01]
 [ 4.16196696e-02 -2.49874608e-02  6.99696018e-02]
 [-2.76507487e-01 -7.07954390e-01 -1.36546045e-01]
 [ 1.54274455e-01 -2.13418948e-01 -3.53220298e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.25151208 -29.28467519 -29.2776944 ]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  8.31409947  -9.26062741 -83.52111278]
init_Out:  [2.49223638]
Stock Position:  8.314099471154409
Bond position:  [-828.91771073]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [5.12066134]
curr_Stock_Price:  100.34106884362737
curr_Factors:  [100.34106884  -1.25295884  -0.9327957 ]
mat_Sqrt:  [[11.27762329  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01071661 -0.00715752 -0.50418881]
Stock Position:  -0.010716611106542458
Bond Position:  [6.19597756]


portfolio before change:  [5.11839853]
curr_Stock_Price:  100.69677889749373
curr_Factors:  [100.6967789   -0.98798541  -0.91957361]
mat_Sqrt:  [[14.94766042  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01581229 -0.01082203  0.53157887]
Stock Position:  -0.015812292232041485
Bond Position:  [6.71064542]


portfolio before change:  [5.11057304]
curr_Stock_Price:  101.2977898027963
curr_Factors:  [101.2977898   -1.14884427  -0.93256658]
mat_Sqrt:  [[12.63731246  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01007574 -0.03097973 -0.90793071]
Stock Position:  -0.010075737060355014
Bond Position:  [6.13122293]


portfolio before change:  [5.11013943]
curr_Stock_Price:  101.4929723273042
curr_Factors:  [101.49297233  -1.25858568  -0.94308604]
mat_Sqrt:  [[11.22695786  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00544819 -0.07649896  0.61364875]
Stock Position:  -0.0054481924699786
Bond Position:  [5.66309267]


portfolio before change:  [5.11390322]
curr_Stock_Price:  101.06203209667088
curr_Factors:  [101.0620321   -1.39172577  -0.92748317]
mat_Sqrt:  [[ 9.93958795  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0029529  -0.05326015  0.10096432]
Stock Position:  -0.002952895212687925
Bond Position:  [5.41232881]


portfolio before change:  [5.11426134]
curr_Stock_Price:  101.39903485802338
curr_Factors:  [101.39903486  -0.83412418  -0.92437732]
mat_Sqrt:  [[17.47134432  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00300611  0.01137393 -0.0541064 ]
Stock Position:  0.0030061071217141696
Bond Position:  [4.80944498]


portfolio before change:  [5.1109528]
curr_Stock_Price:  99.89840666324447
curr_Factors:  [99.89840666 -0.61662892 -0.89323584]
mat_Sqrt:  [[22.07153942  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00456747  0.0461977  -0.22869539]
Stock Position:  -0.0045674656558125975
Bond Position:  [5.56723534]


portfolio before change:  [5.12849626]
curr_Stock_Price:  96.36220586291425
curr_Factors:  [96.36220586 -0.3575838  -0.87847639]
mat_Sqrt:  [[27.99578259  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0091729  -0.05533398  1.08362478]
Stock Position:  -0.009172901727953818
Bond Position:  [6.0124173]


portfolio before change:  [5.14783788]
curr_Stock_Price:  94.41752922533757
curr_Factors:  [94.41752923 -0.38365177 -0.8460292 ]
mat_Sqrt:  [[27.6063489   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00017593 -0.02277581  0.09894583]
Stock Position:  0.00017593162735859486
Bond Position:  [5.13122685]


portfolio before change:  [5.1490194]
curr_Stock_Price:  93.84092573561719
curr_Factors:  [93.84092574 -0.6798411  -0.86089332]
mat_Sqrt:  [[20.10295153  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00642745  0.04945356  0.09902882]
Stock Position:  -0.006427453807158585
Bond Position:  [5.75217762]


portfolio before change:  [5.15715119]
curr_Stock_Price:  92.79952475776788
curr_Factors:  [92.79952476 -0.87483895 -0.85102296]
mat_Sqrt:  [[16.52012946  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00930953 -0.00313171 -0.41321171]
Stock Position:  -0.009309525397961978
Bond Position:  [6.02107072]


portfolio before change:  [5.16274868]
curr_Stock_Price:  92.359971294005
curr_Factors:  [92.35997129 -1.23487831 -0.83119389]
mat_Sqrt:  [[11.70038176  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00307843 -0.07839014  0.20045694]
Stock Position:  -0.0030784283352908136
Bond Position:  [5.44707223]


portfolio before change:  [5.16004456]
curr_Stock_Price:  93.68079254055078
curr_Factors:  [93.68079254 -1.31958531 -0.84271096]
mat_Sqrt:  [[10.77896882  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00809109 -0.01826837 -0.00503792]
Stock Position:  0.008091091775389029
Bond Position:  [4.40206467]


portfolio before change:  [5.15012579]
curr_Stock_Price:  92.31887197718227
curr_Factors:  [92.31887198 -1.17190987 -0.84769259]
mat_Sqrt:  [[12.25147235  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00103715 -0.01831408 -0.31229621]
Stock Position:  -0.0010371504987063643
Bond Position:  [5.24587435]


portfolio before change:  [5.15008866]
curr_Stock_Price:  93.61932385048914
curr_Factors:  [93.61932385 -1.17640019 -0.84496876]
mat_Sqrt:  [[12.40212539  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01260509  0.01472677 -0.3947712 ]
Stock Position:  0.012605085796970051
Bond Position:  [3.97000905]


portfolio before change:  [5.14796958]
curr_Stock_Price:  93.3724631918321
curr_Factors:  [93.37246319 -1.08469437 -0.86130237]
mat_Sqrt:  [[13.33776826  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00305157 -0.01232899  0.30278011]
Stock Position:  0.0030515659522546415
Bond Position:  [4.86303735]


portfolio before change:  [5.15158035]
curr_Stock_Price:  94.15725756085264
curr_Factors:  [94.15725756 -0.84018411 -0.84353832]
mat_Sqrt:  [[17.48326095  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00316056 -0.00790173  0.1996038 ]
Stock Position:  0.003160564921761807
Bond Position:  [4.85399022]


portfolio before change:  [5.15185296]
curr_Stock_Price:  93.85951544376135
curr_Factors:  [93.85951544 -0.93016427 -0.88377001]
mat_Sqrt:  [[15.30018418  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02108858 -0.22387484 -0.38952786]
Stock Position:  -0.02108857851053734
Bond Position:  [7.13121672]


portfolio before change:  [5.17317147]
curr_Stock_Price:  92.93316179594383
curr_Factors:  [92.9331618  -0.70945813 -0.8843902 ]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [5.17317147]
Stock Price:  93.62490975612569
PL:  [5.17317147]
Settle:  Tensor("sub_200:0", shape=(), dtype=float64)
PL:  Tensor("sub_201:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  101
output_Z_Vals[:, i, :]:  [[ 1.19251512e+02 -2.92846752e+01 -2.92776944e+01]
 [-1.29391822e-01  1.43786125e-02 -1.20296737e-01]
 [-5.75375292e-02  2.31218728e-02  8.44796617e-02]
 [-3.59075259e-02  4.72383703e-03 -2.76837322e-02]
 [-9.88296441e-02 -2.41910939e-01  2.15109929e-01]
 [-5.25880199e-02 -1.33793903e-01  1.96879743e-02]
 [ 5.56466588e-02  3.29217752e-02 -1.77721473e-02]
 [-8.79617623e-02  1.57253653e-01 -1.06553045e-01]
 [-1.31068208e-01 -6.60734635e-02  1.31829668e-01]
 [ 7.14811874e-02  6.03189721e-02 -6.73684051e-03]
 [ 9.14059192e-03  9.85524725e-02 -1.05674146e-02]
 [ 1.45246923e-02 -8.12482768e-03 -9.55511134e-02]
 [ 6.17011802e-02 -2.38098362e-03 -1.27110395e-01]
 [-8.13687849e-02  3.07206581e-02 -2.87525500e-02]
 [-7.71296040e-02 -7.53258598e-03  1.07241502e-01]
 [-3.02348438e-02 -8.02968774e-02  1.24766001e-01]
 [-2.49918066e-02  4.56100836e-02  1.45831124e-01]
 [-1.18862052e-02  5.32941131e-02 -8.07722894e-02]
 [-2.73443822e-01 -8.12192151e-01 -6.26849169e-02]
 [ 7.92574526e-02 -5.07284629e-02 -1.02868811e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.25151208 -29.28467519 -29.2776944 ]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  8.31409947  -9.26062741 -83.52111278]
init_Out:  [2.49223638]
Stock Position:  8.314099471154409
Bond position:  [-828.91771073]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-0.42880079]
curr_Stock_Price:  99.67359281035354
curr_Factors:  [99.67359281 -0.57359806 -0.98556389]
mat_Sqrt:  [[20.96257741  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0073262   0.00454692 -0.34317311]
Stock Position:  -0.007326200061701922
Bond Position:  [0.30142789]


portfolio before change:  [-0.42373968]
curr_Stock_Price:  98.99305712818561
curr_Factors:  [98.99305713 -1.02989312 -0.95412591]
mat_Sqrt:  [[13.61307449  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00291603  0.00731178  0.24099696]
Stock Position:  -0.0029160338715329007
Bond Position:  [-0.13507258]


portfolio before change:  [-0.42648423]
curr_Stock_Price:  99.9226679144157
curr_Factors:  [99.92266791 -1.07621164 -0.93098646]
mat_Sqrt:  [[13.42607166  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00308627  0.00149381 -0.07897398]
Stock Position:  -0.0030862694726151016
Bond Position:  [-0.11809595]


portfolio before change:  [-0.43225447]
curr_Stock_Price:  101.78274964296456
curr_Factors:  [101.78274964  -1.05629159  -0.96079608]
mat_Sqrt:  [[13.54141771  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.004517   -0.07649896  0.61364875]
Stock Position:  -0.004517003209576539
Bond Position:  [0.02749853]


portfolio before change:  [-0.4277951]
curr_Stock_Price:  100.79702949340408
curr_Factors:  [100.79702949  -0.88572     -0.962845  ]
mat_Sqrt:  [[15.87179896  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00327775 -0.04230935  0.05616431]
Stock Position:  -0.003277748974371936
Bond Position:  [-0.09740774]


portfolio before change:  [-0.42707701]
curr_Stock_Price:  100.57051812309145
curr_Factors:  [100.57051812  -0.99787238  -0.96642328]
mat_Sqrt:  [[14.10548167  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00374812  0.01041078 -0.05069899]
Stock Position:  0.0037481152525187743
Bond Position:  [-0.8040269]


portfolio before change:  [-0.42757231]
curr_Stock_Price:  100.4920056335416
curr_Factors:  [100.49200563  -1.45746849  -0.91594232]
mat_Sqrt:  [[ 9.36207885  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01128505  0.04972797 -0.30396618]
Stock Position:  -0.011285051263339094
Bond Position:  [0.70648512]


portfolio before change:  [-0.41986364]
curr_Stock_Price:  99.82457148449653
curr_Factors:  [99.82457148 -1.4129878  -0.88309395]
mat_Sqrt:  [[10.047588    0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01053632 -0.02089426  0.37607335]
Stock Position:  -0.01053631968907407
Bond Position:  [0.63191996]


portfolio before change:  [-0.4176081]
curr_Stock_Price:  99.62549428399414
curr_Factors:  [99.62549428 -1.87702489 -0.88947337]
mat_Sqrt:  [[ 6.26463193  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01143937  0.01907453 -0.01921833]
Stock Position:  0.011439373537696793
Bond Position:  [-1.55726134]


portfolio before change:  [-0.41131849]
curr_Stock_Price:  100.20935268216205
curr_Factors:  [100.20935268  -1.73440167  -0.85330407]
mat_Sqrt:  [[ 7.53497703  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00126452  0.03116503 -0.03014589]
Stock Position:  0.0012645216174560273
Bond Position:  [-0.53803538]


portfolio before change:  [-0.41191539]
curr_Stock_Price:  99.84370077000155
curr_Factors:  [99.84370077 -1.5024982  -0.89262039]
mat_Sqrt:  [[ 9.10193824  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00057014 -0.0025693  -0.27258073]
Stock Position:  -0.0005701400093156551
Bond Position:  [-0.3549905]


portfolio before change:  [-0.41209567]
curr_Stock_Price:  100.00423553749339
curr_Factors:  [100.00423554  -1.83583431  -0.92329312]
mat_Sqrt:  [[ 6.33497021  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00563434 -0.00075293 -0.36261058]
Stock Position:  0.005634344214604047
Bond Position:  [-0.97555396]


portfolio before change:  [-0.41055598]
curr_Stock_Price:  100.32079619241956
curr_Factors:  [100.32079619  -1.74331011  -0.90803615]
mat_Sqrt:  [[ 7.07825032  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01221272  0.00971473 -0.08202302]
Stock Position:  -0.012212717366777941
Bond Position:  [0.81463355]


portfolio before change:  [-0.42106148]
curr_Stock_Price:  101.19768432178904
curr_Factors:  [101.19768432  -1.60493263  -0.93773747]
mat_Sqrt:  [[ 7.95981513  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00696417 -0.00238201  0.30593015]
Stock Position:  -0.006964171118131382
Bond Position:  [0.28369651]


portfolio before change:  [-0.42793568]
curr_Stock_Price:  102.19495044770036
curr_Factors:  [102.19495045  -1.24025736  -0.92909503]
mat_Sqrt:  [[11.67593481  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00058585 -0.0253921   0.35592267]
Stock Position:  -0.0005858500427469513
Bond Position:  [-0.36806477]


portfolio before change:  [-0.42839331]
curr_Stock_Price:  102.8189968769259
curr_Factors:  [102.81899688  -1.2276818   -0.93434095]
mat_Sqrt:  [[11.83365252  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.0005031  0.01442317 0.4160156 ]
Stock Position:  0.0005030986063594469
Bond Position:  [-0.4801214]


portfolio before change:  [-0.42864495]
curr_Stock_Price:  102.55742485783469
curr_Factors:  [102.55742486  -1.42189121  -0.9584798 ]
mat_Sqrt:  [[ 9.48822803  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00284539  0.01685308 -0.23042086]
Stock Position:  -0.0028453923748623993
Bond Position:  [-0.13682884]


portfolio before change:  [-0.4281415]
curr_Stock_Price:  102.36846668309062
curr_Factors:  [102.36846668  -1.41714994  -0.91588493]
mat_Sqrt:  [[ 9.92983493  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.03093808 -0.25683771 -0.17882262]
Stock Position:  -0.03093808112015408
Bond Position:  [2.73894242]


portfolio before change:  [-0.42763202]
curr_Stock_Price:  102.37413409223304
curr_Factors:  [102.37413409  -1.24344459  -0.89285253]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-0.42763202]
Stock Price:  102.58433093843838
PL:  [-3.01196296]
Settle:  Tensor("sub_202:0", shape=(), dtype=float64)
PL:  Tensor("sub_203:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  102
output_Z_Vals[:, i, :]:  [[ 1.19251512e+02 -2.92846752e+01 -2.92776944e+01]
 [-1.85546756e-01  4.29540824e-02 -1.62472875e-02]
 [-1.50740745e-01 -8.82014231e-04  1.34315289e-01]
 [-5.22637764e-02 -6.56400593e-02 -2.26928900e-01]
 [-9.88296441e-02 -2.41910939e-01  2.15109929e-01]
 [-3.07183118e-01  4.31100931e-02  1.92588741e-02]
 [ 5.16551105e-02  9.93313194e-02 -4.38157742e-02]
 [-1.94304438e-01  2.73831587e-01 -4.06688421e-02]
 [-1.29949354e-01 -4.45442525e-02  6.91321931e-02]
 [-1.98824538e-01 -1.62906411e-01 -7.18872350e-02]
 [ 3.66006181e-01 -2.62889218e-01 -1.57048753e-01]
 [-1.31710946e-01  1.83821730e-01  1.99460176e-01]
 [ 3.70531478e-02 -1.14126650e-02 -1.22870299e-01]
 [ 7.05840179e-02  1.00236266e-03  2.69767871e-01]
 [-3.07284423e-01  3.32813843e-01  5.10276924e-01]
 [-2.96009593e-01 -5.45317992e-01  3.43811942e-01]
 [-1.15198778e-01 -3.57137479e-01  1.76607033e-01]
 [-4.42994804e-01  6.50132510e-01 -8.66264971e-02]
 [-2.95720194e-01 -1.03266784e+00 -1.78402093e-01]
 [ 1.41630949e-01 -1.03064193e-01 -1.98822483e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.25151208 -29.28467519 -29.2776944 ]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  8.31409947  -9.26062741 -83.52111278]
init_Out:  [2.49223638]
Stock Position:  8.314099471154409
Bond position:  [-828.91771073]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-3.99855999]
curr_Stock_Price:  99.24423071183512
curr_Factors:  [99.24423071 -0.74301983 -0.97366438]
mat_Sqrt:  [[17.83030566  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01053006  0.01358327 -0.04634899]
Stock Position:  -0.010530057860564292
Bond Position:  [-2.9535125]


portfolio before change:  [-4.00303663]
curr_Stock_Price:  99.59923102135902
curr_Factors:  [99.59923102 -1.15872691 -0.97291417]
mat_Sqrt:  [[11.81669505  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-1.04383268e-02 -2.78917390e-04  3.83164132e-01]
Stock Position:  -0.010438326830207173
Bond Position:  [-2.96338731]


portfolio before change:  [-4.01629258]
curr_Stock_Price:  100.79817896288421
curr_Factors:  [100.79817896  -1.1085329   -0.99029005]
mat_Sqrt:  [[12.35792236  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00811465 -0.02075721 -0.64736499]
Stock Position:  -0.00811465392796832
Bond Position:  [-3.19835024]


portfolio before change:  [-4.02691234]
curr_Stock_Price:  102.00834425143634
curr_Factors:  [102.00834425  -1.23721071  -1.00386647]
mat_Sqrt:  [[10.84796427  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00563854 -0.07649896  0.61364875]
Stock Position:  -0.005638535096135976
Bond Position:  [-3.45173471]


portfolio before change:  [-4.03587793]
curr_Stock_Price:  103.44533950325318
curr_Factors:  [103.4453395   -1.19399063  -1.00900435]
mat_Sqrt:  [[11.42779294  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02643895  0.01363261  0.05494021]
Stock Position:  -0.02643894758929671
Bond Position:  [-1.30089202]


portfolio before change:  [-4.05146361]
curr_Stock_Price:  104.0225339665816
curr_Factors:  [104.02253397  -0.89571726  -0.97601785]
mat_Sqrt:  [[16.00454003  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00282895  0.03141132 -0.12499421]
Stock Position:  0.0028289458228538513
Bond Position:  [-4.34573772]


portfolio before change:  [-4.04911848]
curr_Stock_Price:  105.23559987795664
curr_Factors:  [105.23559988  -0.78663574  -0.92629386]
mat_Sqrt:  [[18.97784117  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01030337  0.08659315 -0.11601689]
Stock Position:  -0.010303365242465001
Bond Position:  [-2.96483766]


portfolio before change:  [-4.08221556]
curr_Stock_Price:  108.3759117775607
curr_Factors:  [108.37591178  -0.59239526  -0.95931539]
mat_Sqrt:  [[22.96325194  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00509457 -0.01408613  0.1972149 ]
Stock Position:  -0.005094571631522483
Bond Position:  [-3.53008672]


portfolio before change:  [-4.08754994]
curr_Stock_Price:  109.24973264180926
curr_Factors:  [109.24973264  -0.45998934  -0.97454713]
mat_Sqrt:  [[26.02610078  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00836486 -0.05151553 -0.20507427]
Stock Position:  -0.008364859807333553
Bond Position:  [-3.17369124]


portfolio before change:  [-4.09740472]
curr_Stock_Price:  110.33298603934368
curr_Factors:  [110.33298604  -0.43796454  -0.94175742]
mat_Sqrt:  [[27.76513178  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01178316 -0.08313287 -0.44801638]
Stock Position:  0.011783159186536213
Bond Position:  [-5.39747586]


portfolio before change:  [-4.07619575]
curr_Stock_Price:  112.24745661686761
curr_Factors:  [112.24745662  -0.59706738  -0.97151861]
mat_Sqrt:  [[23.38558656  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00368817  0.05812953  0.56900436]
Stock Position:  -0.003688171413018979
Bond Position:  [-3.66220789]


portfolio before change:  [-4.08282919]
curr_Stock_Price:  113.79775769777983
curr_Factors:  [113.7977577   -0.41496781  -0.95250169]
mat_Sqrt:  [[28.99006903  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00040282 -0.003609   -0.35051476]
Stock Position:  0.0004028165440102817
Bond Position:  [-4.12866881]


portfolio before change:  [-4.08457347]
curr_Stock_Price:  112.0302576448488
curr_Factors:  [112.03025764   0.19193479  -0.97994217]
mat_Sqrt:  [[50.94576374  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [2.46685938e-03 3.16974905e-04 7.69572647e-01]
Stock Position:  0.002466859375463837
Bond Position:  [-4.36093636]


portfolio before change:  [-4.08384799]
curr_Stock_Price:  112.76635508850823
curr_Factors:  [112.76635509  -0.20997198  -0.95361877]
mat_Sqrt:  [[35.22398612  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0055227   0.10524498  1.45567803]
Stock Position:  -0.005522695945878022
Bond Position:  [-3.4610737]


portfolio before change:  [-4.086314]
curr_Stock_Price:  113.05618340938213
curr_Factors:  [113.05618341  -0.32677927  -0.95268643]
mat_Sqrt:  [[31.45063574  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00762812 -0.17244469  0.98079977]
Stock Position:  -0.007628123210253309
Bond Position:  [-3.2239075]


portfolio before change:  [-4.09261513]
curr_Stock_Price:  113.77655056389857
curr_Factors:  [113.77655056  -0.36612961  -0.94571067]
mat_Sqrt:  [[30.64275232  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00288389 -0.11293679  0.50381071]
Stock Position:  -0.002883888095367263
Bond Position:  [-3.76449629]


portfolio before change:  [-4.09180657]
curr_Stock_Price:  113.16980018128366
curr_Factors:  [113.16980018  -0.30179184  -0.88370002]
mat_Sqrt:  [[34.5842194   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01283507  0.20558995 -0.24712128]
Stock Position:  -0.012835073987434439
Bond Position:  [-2.63926381]


portfolio before change:  [-4.04992889]
curr_Stock_Price:  109.85563307584421
curr_Factors:  [109.85563308  -0.64464898  -0.85857145]
mat_Sqrt:  [[24.43329225  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01468487 -0.32655824 -0.50893151]
Stock Position:  -0.014684870695005861
Bond Position:  [-2.43671312]


portfolio before change:  [-4.06549878]
curr_Stock_Price:  110.87441202749535
curr_Factors:  [110.87441203  -0.95324898  -0.87451682]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-4.06549878]
Stock Price:  110.55540764231347
PL:  [-14.62090642]
Settle:  Tensor("sub_204:0", shape=(), dtype=float64)
PL:  Tensor("sub_205:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  103
output_Z_Vals[:, i, :]:  [[ 1.19251512e+02 -2.92846752e+01 -2.92776944e+01]
 [ 5.31727625e-02 -5.10889066e-02 -7.44052857e-02]
 [-3.34334580e-01 -5.07403410e-02  2.12116550e-01]
 [-6.69931191e-02 -1.28533110e-01 -4.04635147e-01]
 [-9.88296441e-02 -2.41910939e-01  2.15109929e-01]
 [-1.34645363e-01 -4.71757986e-02  4.53098409e-04]
 [ 5.52997173e-02  3.86940283e-02 -2.00358340e-02]
 [-8.62821842e-02  1.40828821e-01 -7.48177873e-02]
 [-3.05985000e-01 -1.71895642e-01  3.74117835e-01]
 [ 5.28555119e-02  4.25074051e-02 -2.68250035e-04]
 [ 4.61875801e-02  7.44278669e-02 -1.33663189e-02]
 [ 6.68949056e-02 -9.66063994e-03 -1.18168237e-01]
 [ 4.79588026e-02 -1.25468169e-02 -3.56139001e-01]
 [-8.30780841e-02  3.01910493e-02 -3.26199058e-02]
 [ 4.04977105e-03 -6.33988822e-02 -1.71735920e-02]
 [ 9.44611658e-02 -8.86860525e-03  4.24891273e-02]
 [-2.36659566e-02  1.03397125e-01  6.84818710e-02]
 [ 4.39570735e-02 -2.39825132e-02  4.68431671e-02]
 [-3.60177352e-01 -9.13408509e-01 -2.02473392e-01]
 [ 1.21138814e-01 -1.30402383e-01 -2.10995017e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.25151208 -29.28467519 -29.2776944 ]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  8.31409947  -9.26062741 -83.52111278]
init_Out:  [2.49223638]
Stock Position:  8.314099471154409
Bond position:  [-828.91771073]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [10.73059265]
curr_Stock_Price:  101.015817963979
curr_Factors:  [101.01581796  -0.83762196  -1.00342068]
mat_Sqrt:  [[16.02635381  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00228784 -0.01615573 -0.21225757]
Stock Position:  0.0022878402483757845
Bond Position:  [10.49948459]


portfolio before change:  [10.73350588]
curr_Stock_Price:  101.14171553820036
curr_Factors:  [101.14171554  -0.72083247  -1.03825793]
mat_Sqrt:  [[17.41674769  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01678537 -0.0160455   0.60510947]
Stock Position:  -0.016785371543715212
Bond Position:  [12.43120716]


portfolio before change:  [10.73273012]
curr_Stock_Price:  101.37310449244666
curr_Factors:  [101.37310449  -0.86278499  -1.05736505]
mat_Sqrt:  [[14.85977328  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01029004 -0.04064574 -1.15431145]
Stock Position:  -0.010290038106318308
Bond Position:  [11.77586323]


portfolio before change:  [10.73547761]
curr_Stock_Price:  101.39223460316683
curr_Factors:  [101.3922346   -0.62738738  -1.03672268]
mat_Sqrt:  [[19.19954246  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00318584 -0.07649896  0.61364875]
Stock Position:  -0.0031858377552646676
Bond Position:  [11.05849682]


portfolio before change:  [10.73911201]
curr_Stock_Price:  101.11932718958212
curr_Factors:  [101.11932719  -0.4708675   -1.03883369]
mat_Sqrt:  [[22.34494429  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00607614 -0.0149183   0.00129256]
Stock Position:  -0.006076137258330207
Bond Position:  [11.35352693]


portfolio before change:  [10.74504952]
curr_Stock_Price:  100.60933743936909
curr_Factors:  [100.60933744  -0.33433324  -1.01503804]
mat_Sqrt:  [[26.09839414  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00200047  0.01223613 -0.05715666]
Stock Position:  0.0020004677309102743
Bond Position:  [10.54378379]


portfolio before change:  [10.74550164]
curr_Stock_Price:  99.51751478315961
curr_Factors:  [99.51751478 -0.36768874 -1.01854162]
mat_Sqrt:  [[24.88097093  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00393546  0.04453398 -0.21343432]
Stock Position:  -0.003935462039138133
Bond Position:  [11.13714904]


portfolio before change:  [10.76167215]
curr_Stock_Price:  96.11616677889378
curr_Factors:  [96.11616678 -0.49946981 -0.98072041]
mat_Sqrt:  [[21.87550036  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0106995  -0.05435817  1.06725405]
Stock Position:  -0.010699496644991324
Bond Position:  [11.79006675]


portfolio before change:  [10.74485078]
curr_Stock_Price:  97.96384744846488
curr_Factors:  [97.96384745 -0.56789586 -1.00126825]
mat_Sqrt:  [[20.39794981  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00264234  0.01344202 -0.00076524]
Stock Position:  0.002642338693388682
Bond Position:  [10.48599712]


portfolio before change:  [10.75561423]
curr_Stock_Price:  101.04506525773195
curr_Factors:  [101.04506526  -0.84065997  -1.07355765]
mat_Sqrt:  [[14.89981781  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00304574  0.02353616 -0.03813039]
Stock Position:  0.0030457359606572663
Bond Position:  [10.44785764]


portfolio before change:  [10.75650295]
curr_Stock_Price:  100.47917045272187
curr_Factors:  [100.47917045  -1.26124629  -1.00204268]
mat_Sqrt:  [[10.45062184  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00406909 -0.00305496 -0.33710109]
Stock Position:  0.004069085947631924
Bond Position:  [10.34764457]


portfolio before change:  [10.75739379]
curr_Stock_Price:  100.06227097929381
curr_Factors:  [100.06227098  -0.87448305  -0.97732728]
mat_Sqrt:  [[15.7050509   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00159577 -0.00396765 -1.01596544]
Stock Position:  -0.0015957747698317206
Bond Position:  [10.91707064]


portfolio before change:  [10.7596468]
curr_Stock_Price:  100.36093229523613
curr_Factors:  [100.3609323   -0.86541389  -0.96541612]
mat_Sqrt:  [[16.08589826  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00553013  0.00954725 -0.09305551]
Stock Position:  -0.005530127287296115
Bond Position:  [11.31465553]


portfolio before change:  [10.76773112]
curr_Stock_Price:  99.41062797872056
curr_Factors:  [99.41062798 -0.93838089 -0.98140356]
mat_Sqrt:  [[14.57743195  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-7.49601045e-05 -2.00484869e-02 -4.89914776e-02]
Stock Position:  -7.49601044879526e-05
Bond Position:  [10.77518295]


portfolio before change:  [10.77046416]
curr_Stock_Price:  98.8915809374493
curr_Factors:  [98.89158094 -0.76774034 -0.97705367]
mat_Sqrt:  [[17.27447713  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00595707 -0.0028045   0.12120965]
Stock Position:  0.0059570680719832425
Bond Position:  [10.18136028]


portfolio before change:  [10.77447305]
curr_Stock_Price:  99.13721029589797
curr_Factors:  [99.1372103  -0.90825641 -0.95398815]
mat_Sqrt:  [[15.39834897  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00045573  0.03269704  0.19535972]
Stock Position:  -0.0004557274920407543
Bond Position:  [10.81965261]


portfolio before change:  [10.7786857]
curr_Stock_Price:  95.82954078730435
curr_Factors:  [95.82954079 -0.39255383 -0.92540515]
mat_Sqrt:  [[25.65175543  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00206222 -0.00758394  0.13363052]
Stock Position:  0.002062224132894742
Bond Position:  [10.58106371]


portfolio before change:  [10.78395651]
curr_Stock_Price:  97.10254249121175
curr_Factors:  [97.10254249 -0.38206751 -0.95690858]
mat_Sqrt:  [[25.4519272   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01670173 -0.28884513 -0.57760023]
Stock Position:  -0.016701728057215783
Bond Position:  [12.40573677]


portfolio before change:  [10.79885284]
curr_Stock_Price:  96.39635762961355
curr_Factors:  [96.39635763 -0.70865874 -1.00801624]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [10.79885284]
Stock Price:  94.45949533547572
PL:  [10.79885284]
Settle:  Tensor("sub_206:0", shape=(), dtype=float64)
PL:  Tensor("sub_207:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  104
output_Z_Vals[:, i, :]:  [[ 1.19251512e+02 -2.92846752e+01 -2.92776944e+01]
 [-1.55805876e-01  4.26026255e-02  2.20320438e-02]
 [-6.21144897e-02  2.04872645e-02  7.54120994e-02]
 [-3.13883549e-02  2.36621628e-02  2.23975874e-02]
 [-9.30350423e-02 -1.93489387e-01  1.65995517e-01]
 [ 4.83063034e-03 -8.27016269e-02 -1.82771447e-03]
 [ 5.73019791e-02  3.17221021e-02 -1.68819550e-02]
 [-1.44414148e-01  2.16135624e-01 -6.34384266e-02]
 [-5.44117172e-02 -3.01756349e-02  5.08649373e-02]
 [ 4.57856892e-02  4.74709326e-02 -1.16662052e-02]
 [ 2.79864139e-02  8.80363527e-02 -1.20613600e-02]
 [ 5.25098724e-02 -9.23878353e-03 -1.11955773e-01]
 [ 4.03991926e-02 -5.56234506e-02 -3.21524785e-01]
 [-8.23527894e-02  3.04157744e-02 -3.09788984e-02]
 [ 2.17213920e-02 -6.32108469e-02 -3.89666418e-02]
 [ 6.41842821e-02 -1.07091783e-02  7.56588812e-02]
 [-2.49921740e-02  1.05205888e-01  7.10118229e-02]
 [ 3.01430388e-02 -1.93289781e-03 -3.33618479e-02]
 [-3.05429195e-01 -8.50456753e-01 -1.07943541e-01]
 [ 6.09460890e-02 -8.64716678e-03 -4.84835539e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.25151208 -29.28467519 -29.2776944 ]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  8.31409947  -9.26062741 -83.52111278]
init_Out:  [2.49223638]
Stock Position:  8.314099471154409
Bond position:  [-828.91771073]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-2.27171109]
curr_Stock_Price:  99.45193196736115
curr_Factors:  [99.45193197 -1.00622485 -1.02682556]
mat_Sqrt:  [[13.02178885  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01153517  0.01347213  0.06285129]
Stock Position:  -0.011535174628713965
Bond Position:  [-1.12451569]


portfolio before change:  [-2.2656092]
curr_Stock_Price:  98.89857607650735
curr_Factors:  [98.89857608 -1.03850045 -1.0301255 ]
mat_Sqrt:  [[12.49675358  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00369633  0.00647864  0.21512973]
Stock Position:  -0.00369632642143206
Bond Position:  [-1.90004778]


portfolio before change:  [-2.26741027]
curr_Stock_Price:  99.25731159200811
curr_Factors:  [99.25731159 -0.8221157  -0.99067166]
mat_Sqrt:  [[16.19865502  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00161776  0.00748263  0.06389408]
Stock Position:  -0.0016177585153590785
Bond Position:  [-2.10683591]


portfolio before change:  [-2.26876909]
curr_Stock_Price:  99.77163224045226
curr_Factors:  [99.77163224 -0.69521764 -1.01418861]
mat_Sqrt:  [[18.05599294  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00355268 -0.06118672  0.47353901]
Stock Position:  -0.0035526832473889735
Bond Position:  [-1.91431209]


portfolio before change:  [-2.27084092]
curr_Stock_Price:  100.22007829494635
curr_Factors:  [100.22007829  -0.72865541  -1.02759602]
mat_Sqrt:  [[17.30710522  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00013418 -0.02615255 -0.00521396]
Stock Position:  0.00013417627198093334
Bond Position:  [-2.28428807]


portfolio before change:  [-2.27139375]
curr_Stock_Price:  100.35652353793756
curr_Factors:  [100.35652354  -0.7154902   -1.01731665]
mat_Sqrt:  [[17.74177867  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00308171  0.01003141 -0.04815952]
Stock Position:  0.003081710502698558
Bond Position:  [-2.58066351]


portfolio before change:  [-2.26467642]
curr_Stock_Price:  102.7456431674541
curr_Factors:  [102.74564317  -0.81022343  -0.98891535]
mat_Sqrt:  [[16.99837355  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00892926  0.06834809 -0.18097217]
Stock Position:  -0.008929258118926827
Bond Position:  [-1.34723406]


portfolio before change:  [-2.26065905]
curr_Stock_Price:  102.25800697511792
curr_Factors:  [102.25800698  -0.89276028  -0.99794237]
mat_Sqrt:  [[15.43745122  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00290256 -0.00954237  0.14510351]
Stock Position:  -0.0029025573112916236
Bond Position:  [-1.96384932]


portfolio before change:  [-2.25958782]
curr_Stock_Price:  101.71977508293024
curr_Factors:  [101.71977508  -1.17976408  -1.01042882]
mat_Sqrt:  [[11.3819507   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00392112  0.01501163 -0.03328044]
Stock Position:  0.003921123049675665
Bond Position:  [-2.65844357]


portfolio before change:  [-2.26656429]
curr_Stock_Price:  100.11008892405792
curr_Factors:  [100.11008892  -0.88779528  -1.04570119]
mat_Sqrt:  [[14.48008131  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00191971  0.02783954 -0.0344077 ]
Stock Position:  0.0019197052411822838
Bond Position:  [-2.45874615]


portfolio before change:  [-2.26801647]
curr_Stock_Price:  99.67386760551777
curr_Factors:  [99.67386761 -1.12095165 -1.04257791]
mat_Sqrt:  [[11.45440044  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00256831 -0.00292156 -0.31937866]
Stock Position:  0.002568310028553605
Bond Position:  [-2.52400987]


portfolio before change:  [-2.26999213]
curr_Stock_Price:  99.15034322623409
curr_Factors:  [99.15034323 -0.998304   -1.05808997]
mat_Sqrt:  [[12.68275688  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0021027  -0.01758968 -0.91722072]
Stock Position:  -0.0021026950869861964
Bond Position:  [-2.06150919]


portfolio before change:  [-2.27255488]
curr_Stock_Price:  100.12400435639945
curr_Factors:  [100.12400436  -1.26418669  -1.09752584]
mat_Sqrt:  [[ 9.43755488  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0093129   0.00961831 -0.08837417]
Stock Position:  -0.009312899335175298
Bond Position:  [-1.34011011]


portfolio before change:  [-2.26195276]
curr_Stock_Price:  98.9495914127435
curr_Factors:  [98.94959141 -1.32486151 -1.09764527]
mat_Sqrt:  [[ 8.77672872  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00138266 -0.01998902 -0.11116098]
Stock Position:  0.0013826635039257558
Bond Position:  [-2.39876675]


portfolio before change:  [-2.26222426]
curr_Stock_Price:  99.18700727787558
curr_Factors:  [99.18700728 -1.1506921  -1.11715409]
mat_Sqrt:  [[10.2693203   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00772705 -0.00338654  0.21583373]
Stock Position:  0.007727052469801908
Bond Position:  [-3.02864747]


portfolio before change:  [-2.25584993]
curr_Stock_Price:  100.10994474994621
curr_Factors:  [100.10994475  -1.31054161  -1.13166455]
mat_Sqrt:  [[ 8.70643907  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00089365  0.03326902  0.20257696]
Stock Position:  -0.0008936537558950949
Bond Position:  [-2.1663863]


portfolio before change:  [-2.2566082]
curr_Stock_Price:  100.35232184242514
curr_Factors:  [100.35232184  -1.40112356  -1.16986579]
mat_Sqrt:  [[ 7.67292474  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00303446 -0.00061124 -0.09517207]
Stock Position:  0.0030344586621311688
Bond Position:  [-2.56112317]


portfolio before change:  [-2.25608504]
curr_Stock_Price:  100.73575500812731
curr_Factors:  [100.73575501  -1.26041941  -1.15509789]
mat_Sqrt:  [[ 8.99783056  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.038834   -0.26893804 -0.30793288]
Stock Position:  -0.03883400274546491
Bond Position:  [1.65588754]


portfolio before change:  [-2.2660911]
curr_Stock_Price:  101.00407855017568
curr_Factors:  [101.00407855  -1.33900355  -1.15268895]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-2.2660911]
Stock Price:  100.417324882742
PL:  [-2.68341598]
Settle:  Tensor("sub_208:0", shape=(), dtype=float64)
PL:  Tensor("sub_209:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  105
output_Z_Vals[:, i, :]:  [[ 1.19251512e+02 -2.92846752e+01 -2.92776944e+01]
 [-3.59257738e-01  1.25510727e-01  3.31868208e-01]
 [-7.00527106e-02  1.59178339e-02  5.96854367e-02]
 [-3.53726731e-02  3.89760863e-02  5.94877870e-02]
 [-8.08655986e-02 -9.17976121e-02  6.28486433e-02]
 [-2.40300478e-02  9.03960401e-03 -2.30151798e-03]
 [-1.29714144e-01 -9.27607467e-02  8.65632204e-02]
 [-2.62630991e-02  3.23594607e-02 -1.08116753e-01]
 [-2.49132196e-01 -1.42646009e-01  3.07750634e-01]
 [ 6.40416261e-02  5.28466735e-02 -3.58725397e-03]
 [ 5.38816587e-02  7.10753597e-02 -9.33280093e-03]
 [ 4.65782339e-02 -9.28386887e-03 -1.12425622e-01]
 [ 3.55937025e-02 -8.82451004e-02 -2.57809481e-01]
 [-3.05494151e-02  1.31219584e-02 -1.70048100e-02]
 [ 2.28670959e-02 -6.43001014e-02 -4.49862381e-02]
 [ 7.66036975e-02 -1.01390142e-02  6.20978536e-02]
 [-2.35647895e-02  1.03259148e-01  6.82888801e-02]
 [ 4.47455621e-02 -2.36435090e-02  3.90418067e-02]
 [-2.98677406e-01 -7.97088061e-01 -1.25452631e-01]
 [ 8.56539562e-02 -6.54282508e-02 -1.21866603e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.25151208 -29.28467519 -29.2776944 ]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  8.31409947  -9.26062741 -83.52111278]
init_Out:  [2.49223638]
Stock Position:  8.314099471154409
Bond position:  [-828.91771073]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-10.60175717]
curr_Stock_Price:  98.45001394778193
curr_Factors:  [98.45001395 -1.17219283 -1.01000983]
mat_Sqrt:  [[11.10445393  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02596028  0.03968998  0.94672762]
Stock Position:  -0.02596028154578126
Bond Position:  [-8.04596709]


portfolio before change:  [-10.61142212]
curr_Stock_Price:  98.74481857956562
curr_Factors:  [98.74481858 -1.1151353  -1.08429971]
mat_Sqrt:  [[10.94742117  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00524859  0.00503366  0.17026594]
Stock Position:  -0.005248585422082938
Bond Position:  [-10.0931515]


portfolio before change:  [-10.60684641]
curr_Stock_Price:  97.39220423901608
curr_Factors:  [97.39220424 -1.21751566 -1.04386664]
mat_Sqrt:  [[10.14888522  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00218974  0.01232532  0.1697021 ]
Stock Position:  -0.0021897401257362672
Bond Position:  [-10.39358279]


portfolio before change:  [-10.61081452]
curr_Stock_Price:  98.0175714837459
curr_Factors:  [98.01757148 -1.4143747  -1.06392812]
mat_Sqrt:  [[ 8.2222504   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00856297 -0.02902895  0.17928969]
Stock Position:  -0.008562969232946803
Bond Position:  [-9.77149307]


portfolio before change:  [-10.61147314]
curr_Stock_Price:  97.80916710158994
curr_Factors:  [97.8091671  -1.25711253 -1.04424771]
mat_Sqrt:  [[ 9.79290425  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00247796  0.00285857 -0.00656559]
Stock Position:  -0.0024779616981434106
Bond Position:  [-10.36910577]


portfolio before change:  [-10.61315492]
curr_Stock_Price:  97.44159586812052
curr_Factors:  [97.44159587 -1.21669066 -1.10117669]
mat_Sqrt:  [[ 9.59637896  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01192529 -0.02933352  0.24694077]
Stock Position:  -0.011925286909299084
Bond Position:  [-9.45113593]


portfolio before change:  [-10.60937608]
curr_Stock_Price:  96.92656294519688
curr_Factors:  [96.92656295 -1.17257194 -1.11671238]
mat_Sqrt:  [[ 9.82243731  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00483554  0.01023296 -0.308427  ]
Stock Position:  -0.004835543333849344
Bond Position:  [-10.14068348]


portfolio before change:  [-10.61233096]
curr_Stock_Price:  97.01329411617097
curr_Factors:  [97.01329412 -0.84634263 -1.13870388]
mat_Sqrt:  [[13.32712609  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01425633 -0.04510863  0.8779269 ]
Stock Position:  -0.014256334339639678
Bond Position:  [-9.229277]


portfolio before change:  [-10.63825649]
curr_Stock_Price:  98.66995611346516
curr_Factors:  [98.66995611 -0.92228711 -1.15741088]
mat_Sqrt:  [[12.33058203  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.005245    0.01671159 -0.01023344]
Stock Position:  0.005244997847623767
Bond Position:  [-11.1557802]


portfolio before change:  [-10.64115206]
curr_Stock_Price:  98.64969488114498
curr_Factors:  [98.64969488 -1.03235857 -1.19138324]
mat_Sqrt:  [[10.6742397   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00504127  0.022476   -0.02662388]
Stock Position:  0.005041273959677395
Bond Position:  [-11.1384722]


portfolio before change:  [-10.64132044]
curr_Stock_Price:  99.16872666489685
curr_Factors:  [99.16872666 -0.99146342 -1.19465035]
mat_Sqrt:  [[11.14185729  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00209927 -0.00293582 -0.32071901]
Stock Position:  0.002099267722218035
Bond Position:  [-10.84950215]


portfolio before change:  [-10.64571946]
curr_Stock_Price:  98.3654463112154
curr_Factors:  [98.36544631 -1.21371617 -1.19597625]
mat_Sqrt:  [[ 8.83743932  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00218501 -0.02790555 -0.73545869]
Stock Position:  -0.0021850125775279205
Bond Position:  [-10.43078972]


portfolio before change:  [-10.64764747]
curr_Stock_Price:  98.05422866138589
curr_Factors:  [98.05422866 -0.93579734 -1.16808001]
mat_Sqrt:  [[11.96090397  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00281598  0.00414953 -0.04850999]
Stock Position:  -0.002815982799948844
Bond Position:  [-10.37152845]


portfolio before change:  [-10.65098395]
curr_Stock_Price:  98.31817949140445
curr_Factors:  [98.31817949 -0.97470932 -1.18637036]
mat_Sqrt:  [[11.32632055  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00106161 -0.02033348 -0.12833322]
Stock Position:  0.001061606631060187
Bond Position:  [-10.75535919]


portfolio before change:  [-10.65318228]
curr_Stock_Price:  98.78054364115296
curr_Factors:  [98.78054364 -1.30295065 -1.1756778 ]
mat_Sqrt:  [[ 8.28355489  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0107463  -0.00320624  0.17714789]
Stock Position:  0.010746301776641867
Bond Position:  [-11.71470781]


portfolio before change:  [-10.65473799]
curr_Stock_Price:  98.90833975656311
curr_Factors:  [98.90833976 -1.53332405 -1.16605179]
mat_Sqrt:  [[ 6.6513359   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00104629  0.03265341  0.19480917]
Stock Position:  -0.0010462921448616273
Bond Position:  [-10.55125097]


portfolio before change:  [-10.65729198]
curr_Stock_Price:  98.82791375573198
curr_Factors:  [98.82791376 -1.57204463 -1.16045125]
mat_Sqrt:  [[ 6.42941924  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00810407 -0.00747673  0.11137541]
Stock Position:  0.008104070178938926
Bond Position:  [-11.45820033]


portfolio before change:  [-10.66071472]
curr_Stock_Price:  98.75907992509018
curr_Factors:  [98.75907993 -1.15699854 -1.13106019]
mat_Sqrt:  [[10.02041608  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.03441634 -0.25206138 -0.35788144]
Stock Position:  -0.03441633954360183
Bond Position:  [-7.2617887]


portfolio before change:  [-10.65421779]
curr_Stock_Price:  98.51754912625077
curr_Factors:  [98.51754913 -0.91646747 -1.13302236]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-10.65421779]
Stock Price:  98.57060456617488
PL:  [-10.65421779]
Settle:  Tensor("sub_210:0", shape=(), dtype=float64)
PL:  Tensor("sub_211:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  106
output_Z_Vals[:, i, :]:  [[ 1.19251512e+02 -2.92846752e+01 -2.92776944e+01]
 [-8.39763068e-02  8.37019452e-03 -9.31152725e-02]
 [-5.32383689e-02  2.55965727e-02  9.29968654e-02]
 [-2.82139332e-02  4.34316895e-02  7.32286395e-02]
 [-9.88296441e-02 -2.41910939e-01  2.15109929e-01]
 [-1.03534073e-01 -1.03517922e-01  2.43665862e-02]
 [ 5.24305041e-02  8.64306774e-02 -3.87565690e-02]
 [-1.51336602e-01  2.27960108e-01 -6.77504991e-02]
 [-2.93068064e-02 -9.15559552e-04 -2.60552885e-02]
 [ 3.20452390e-02  3.32995176e-02 -1.05693490e-02]
 [ 4.64164767e-02  7.53539473e-02 -1.31457212e-02]
 [-4.79786316e-03 -9.89052046e-03 -1.29446636e-01]
 [-1.16661008e-03 -2.17024640e-01 -3.83063649e-01]
 [ 1.00511216e-02  1.46575242e-03  2.92026313e-03]
 [ 1.11348156e-02 -5.79141975e-02 -1.09473076e-01]
 [ 1.90045594e-01  5.32279535e-02 -1.65335385e-01]
 [-8.55927852e-04 -5.76170185e-02  4.45006450e-02]
 [ 4.16196696e-02 -2.49874608e-02  6.99696018e-02]
 [-1.11989442e-01 -3.41005871e-01 -2.57187298e-02]
 [ 1.25103605e-01 -1.71138758e-01 -3.01198828e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.25151208 -29.28467519 -29.2776944 ]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  8.31409947  -9.26062741 -83.52111278]
init_Out:  [2.49223638]
Stock Position:  8.314099471154409
Bond position:  [-828.91771073]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [2.81062165]
curr_Stock_Price:  100.0632227943398
curr_Factors:  [100.06322279  -1.00632632  -0.98683121]
mat_Sqrt:  [[13.6350637   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00753698  0.00264689 -0.26563195]
Stock Position:  -0.007536984571949183
Bond Position:  [3.56479662]


portfolio before change:  [2.81885468]
curr_Stock_Price:  99.0891305458147
curr_Factors:  [99.08913055 -0.94383575 -0.98844105]
mat_Sqrt:  [[14.3498998   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0023411   0.00809435  0.26529417]
Stock Position:  -0.00234110084722159
Bond Position:  [3.05083233]


portfolio before change:  [2.82066477]
curr_Stock_Price:  98.6417850595608
curr_Factors:  [98.64178506 -0.64207349 -0.95961359]
mat_Sqrt:  [[19.88186233  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00061085  0.01373431  0.20890093]
Stock Position:  -0.0006108481262775866
Bond Position:  [2.88091992]


portfolio before change:  [2.82022405]
curr_Stock_Price:  100.54248421938647
curr_Factors:  [100.54248422  -0.96867581  -0.96036502]
mat_Sqrt:  [[14.60756498  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00418733 -0.07649896  0.61364875]
Stock Position:  -0.004187325356659104
Bond Position:  [3.24122814]


portfolio before change:  [2.81708022]
curr_Stock_Price:  101.48681886566084
curr_Factors:  [101.48681887  -1.09930786  -0.94052307]
mat_Sqrt:  [[13.19843151  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00767008 -0.03273524  0.06951109]
Stock Position:  -0.007670084577290238
Bond Position:  [3.5954927]


portfolio before change:  [2.8028308]
curr_Stock_Price:  103.46181773433524
curr_Factors:  [103.46181773  -1.24181661  -0.92893328]
mat_Sqrt:  [[11.80416865  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00396055  0.02733178 -0.1105617 ]
Stock Position:  0.003960548549524078
Bond Position:  [2.39306524]


portfolio before change:  [2.80292309]
curr_Stock_Price:  103.33404519520509
curr_Factors:  [103.3340452   -1.06955123  -0.92479994]
mat_Sqrt:  [[14.06396325  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01132541  0.07208732 -0.19327332]
Stock Position:  -0.011325414240000163
Bond Position:  [3.97322395]


portfolio before change:  [2.78959006]
curr_Stock_Price:  104.59902802761731
curr_Factors:  [104.59902803  -1.49260371  -0.90665143]
mat_Sqrt:  [[ 9.49608036  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00364876 -0.00028953 -0.07432849]
Stock Position:  -0.003648764351836937
Bond Position:  [3.17124727]


portfolio before change:  [2.79389447]
curr_Stock_Price:  103.63664991837358
curr_Factors:  [103.63664992  -0.79200799  -0.88616684]
mat_Sqrt:  [[19.3504601   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00158898  0.01053023 -0.03015141]
Stock Position:  0.0015889838990196174
Bond Position:  [2.6292175]


portfolio before change:  [2.79031936]
curr_Stock_Price:  100.97300598501361
curr_Factors:  [100.97300599  -0.2199939   -0.85514591]
mat_Sqrt:  [[34.45704235  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00132567  0.02382901 -0.03750108]
Stock Position:  0.0013256723454702515
Bond Position:  [2.65646224]


portfolio before change:  [2.78467794]
curr_Stock_Price:  96.21646050518672
curr_Factors:  [96.21646051 -0.37772878 -0.85247916]
mat_Sqrt:  [[28.11750985  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00111946 -0.00312766 -0.36927522]
Stock Position:  -0.0011194597059699337
Bond Position:  [2.89238839]


portfolio before change:  [2.78436793]
curr_Stock_Price:  97.13940154550885
curr_Factors:  [97.13940155 -0.48001686 -0.8587998 ]
mat_Sqrt:  [[25.4656484   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00333637 -0.06862922 -1.09277397]
Stock Position:  -0.0033363651633876073
Bond Position:  [3.10846045]


portfolio before change:  [2.78747784]
curr_Stock_Price:  96.44023018475733
curr_Factors:  [96.44023018 -0.62670598 -0.83274825]
mat_Sqrt:  [[22.40914687  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00047682 0.00046351 0.0083307 ]
Stock Position:  0.0004768170550185163
Bond Position:  [2.74149349]


portfolio before change:  [2.78630647]
curr_Stock_Price:  92.54601604578114
curr_Factors:  [92.54601605 -0.79352452 -0.82544423]
mat_Sqrt:  [[18.33363297  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00069308 -0.01831408 -0.31229621]
Stock Position:  -0.0006930770723518894
Bond Position:  [2.85044799]


portfolio before change:  [2.78737028]
curr_Stock_Price:  92.03941830382651
curr_Factors:  [92.0394183  -1.26949061 -0.84178373]
mat_Sqrt:  [[11.14446101  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01414792  0.01683216 -0.47165583]
Stock Position:  0.014147924166634785
Bond Position:  [1.48520357]


portfolio before change:  [2.79051592]
curr_Stock_Price:  92.2355103821316
curr_Factors:  [92.23551038 -1.55398441 -0.86180915]
mat_Sqrt:  [[ 8.23630355  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00081834 -0.0182201   0.12694795]
Stock Position:  0.000818335945860018
Bond Position:  [2.71503629]


portfolio before change:  [2.79126164]
curr_Stock_Price:  92.31722761306456
curr_Factors:  [92.31722761 -1.87914349 -0.86248038]
mat_Sqrt:  [[ 5.95128346  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00928488 -0.00790173  0.1996038 ]
Stock Position:  0.009284884789271588
Bond Position:  [1.93410682]


portfolio before change:  [2.79609581]
curr_Stock_Price:  92.78579373761457
curr_Factors:  [92.78579374 -2.02254945 -0.86527984]
mat_Sqrt:  [[ 5.16788883  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02438984 -0.10783552 -0.07336838]
Stock Position:  -0.024389841432515012
Bond Position:  [5.05912661]


portfolio before change:  [2.79114419]
curr_Stock_Price:  93.04067675279619
curr_Factors:  [93.04067675 -1.64209394 -0.8889278 ]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [2.79114419]
Stock Price:  93.55516563445389
PL:  [2.79114419]
Settle:  Tensor("sub_212:0", shape=(), dtype=float64)
PL:  Tensor("sub_213:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  107
output_Z_Vals[:, i, :]:  [[ 1.19251512e+02 -2.92846752e+01 -2.92776944e+01]
 [-1.31581202e-01  2.45327081e-02 -6.25985116e-02]
 [-1.91543235e-01 -1.19626908e-02  1.51606094e-01]
 [-4.29733775e-02 -8.51323550e-03 -6.57772115e-02]
 [-8.46986777e-02 -1.23828051e-01  9.53374027e-02]
 [ 2.64439901e-02 -4.68768578e-02 -1.52061584e-03]
 [-2.50721085e-02  2.74149335e-03  1.49478556e-02]
 [-4.45171233e-02  5.83316698e-02 -1.18354522e-01]
 [-1.21033680e-01 -7.03069692e-02  1.42578825e-01]
 [ 5.67785043e-02  4.61334070e-02 -1.43223130e-03]
 [-6.63012316e-02  1.39038017e-01  3.98300364e-03]
 [-2.41047881e-02 -8.65073995e-03 -1.01826043e-01]
 [ 4.13841576e-02 -6.27699559e-02 -2.57358793e-01]
 [-4.77137883e-02  1.88956724e-02 -2.14080043e-02]
 [ 2.32957363e-02 -6.47076225e-02 -4.72383404e-02]
 [ 1.27032389e-01 -1.04742606e-03  4.84479160e-03]
 [-2.67380257e-02  9.63176911e-02  8.82285753e-02]
 [ 4.56373584e-04  3.36770333e-02 -8.76071089e-02]
 [-3.58042264e-01 -9.69451710e-01 -1.99037269e-01]
 [ 7.96490606e-02 -5.16284162e-02 -1.04031897e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.25151208 -29.28467519 -29.2776944 ]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  8.31409947  -9.26062741 -83.52111278]
init_Out:  [2.49223638]
Stock Position:  8.314099471154409
Bond position:  [-828.91771073]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-0.89719378]
curr_Stock_Price:  99.61725562233127
curr_Factors:  [99.61725562 -0.7898371  -1.02942289]
mat_Sqrt:  [[16.15250926  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00889804  0.00775792 -0.17857613]
Stock Position:  -0.008898037775109162
Bond Position:  [-0.01079567]


portfolio before change:  [-0.9005992]
curr_Stock_Price:  99.99966868443263
curr_Factors:  [99.99966868 -0.9404996  -1.02116614]
mat_Sqrt:  [[14.06235158  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0114423  -0.00378293  0.43248999]
Stock Position:  -0.011442300073623691
Bond Position:  [0.24362701]


portfolio before change:  [-0.89780522]
curr_Stock_Price:  99.76081218237019
curr_Factors:  [99.76081218 -0.73062155 -1.03149764]
mat_Sqrt:  [[17.12700149  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00330589 -0.00269212 -0.18764408]
Stock Position:  -0.003305885469210389
Bond Position:  [-0.5680074]


portfolio before change:  [-0.89496282]
curr_Stock_Price:  98.85805182983542
curr_Factors:  [98.85805183 -1.2401634  -1.0367479 ]
mat_Sqrt:  [[10.1428975   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00674711 -0.03915787  0.27197107]
Stock Position:  -0.006747109330380401
Bond Position:  [-0.22795673]


portfolio before change:  [-0.8951156]
curr_Stock_Price:  98.87224801961253
curr_Factors:  [98.87224802 -1.70470138 -1.03436988]
mat_Sqrt:  [[ 6.3901474   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00390026 -0.01482376 -0.00433789]
Stock Position:  0.00390026064237657
Bond Position:  [-1.28074313]


portfolio before change:  [-0.89506856]
curr_Stock_Price:  98.96641090940588
curr_Factors:  [98.96641091 -1.74355198 -1.02099727]
mat_Sqrt:  [[ 6.23532845  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00352028  0.00086694  0.04264207]
Stock Position:  -0.00352028050449809
Bond Position:  [-0.54667904]


portfolio before change:  [-0.89385869]
curr_Stock_Price:  98.58389669062579
curr_Factors:  [98.58389669 -1.96459598 -1.04247646]
mat_Sqrt:  [[ 4.8736127   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01378239  0.01844609 -0.33763251]
Stock Position:  -0.013782388101379177
Bond Position:  [0.46486283]


portfolio before change:  [-0.89697673]
curr_Stock_Price:  98.81856364547401
curr_Factors:  [98.81856365 -1.76311555 -1.03521143]
mat_Sqrt:  [[ 6.01922488  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0155743  -0.02223302  0.4067377 ]
Stock Position:  -0.015574300559080689
Bond Position:  [0.64205328]


portfolio before change:  [-0.89664863]
curr_Stock_Price:  98.8078043254532
curr_Factors:  [98.80780433 -1.82613628 -1.03360137]
mat_Sqrt:  [[ 5.66008518  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01019018  0.01458866 -0.00408576]
Stock Position:  0.010190184237026851
Bond Position:  [-1.90351836]


portfolio before change:  [-0.89727467]
curr_Stock_Price:  98.79307445824176
curr_Factors:  [98.79307446 -1.76311083 -1.0126552 ]
mat_Sqrt:  [[ 6.15497977  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01005661  0.04396768  0.0113624 ]
Stock Position:  -0.010056614393345688
Bond Position:  [0.09624919]


portfolio before change:  [-0.89552445]
curr_Stock_Price:  98.62143032117227
curr_Factors:  [98.62143032 -1.54109166 -0.98596834]
mat_Sqrt:  [[ 7.87921744  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00572561 -0.0027356  -0.29048136]
Stock Position:  -0.005725607104097194
Bond Position:  [-0.33085688]


portfolio before change:  [-0.89669691]
curr_Stock_Price:  98.81175792092827
curr_Factors:  [98.81175792 -1.21588976 -0.99996876]
mat_Sqrt:  [[10.77639492  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00118497 -0.0198496  -0.734173  ]
Stock Position:  -0.001184969494275704
Bond Position:  [-0.77960799]


portfolio before change:  [-0.8964379]
curr_Stock_Price:  98.42867820686901
curr_Factors:  [98.42867821 -1.00996804 -1.06087927]
mat_Sqrt:  [[12.40978026  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00415767  0.00597534 -0.06107108]
Stock Position:  -0.004157671900051586
Bond Position:  [-0.48720375]


portfolio before change:  [-0.89609066]
curr_Stock_Price:  98.31586079741655
curr_Factors:  [98.3158608  -0.93303594 -1.05559703]
mat_Sqrt:  [[13.45771284  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00089038 -0.02046235 -0.13475784]
Stock Position:  0.0008903821158054115
Bond Position:  [-0.98362934]


portfolio before change:  [-0.89649894]
curr_Stock_Price:  98.13352724269564
curr_Factors:  [98.13352724 -0.71771079 -1.01942297]
mat_Sqrt:  [[17.27387628  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0074097  -0.00033123  0.01382084]
Stock Position:  0.007409702431187141
Bond Position:  [-1.62363918]


portfolio before change:  [-0.88432849]
curr_Stock_Price:  99.83081748296554
curr_Factors:  [99.83081748 -0.40436415 -1.04650808]
mat_Sqrt:  [[23.39692717  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00026677  0.03045833  0.25169157]
Stock Position:  -0.0002667671292251927
Bond Position:  [-0.85769691]


portfolio before change:  [-0.88482538]
curr_Stock_Price:  100.8895645487094
curr_Factors:  [100.88956455  -0.63344242  -1.08123409]
mat_Sqrt:  [[18.16233572  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0009116   0.01064961 -0.2499187 ]
Stock Position:  -0.0009116016594588459
Bond Position:  [-0.79285428]


portfolio before change:  [-0.88646594]
curr_Stock_Price:  102.4717521831099
curr_Factors:  [102.47175218  -0.630293    -1.09050652]
mat_Sqrt:  [[18.33455719  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02310946 -0.30656755 -0.56779793]
Stock Position:  -0.0231094598043352
Bond Position:  [1.4816009]


portfolio before change:  [-0.85393701]
curr_Stock_Price:  101.08017980803359
curr_Factors:  [101.08017981  -0.65789226  -1.08138784]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-0.85393701]
Stock Price:  100.47771260429005
PL:  [-1.33164961]
Settle:  Tensor("sub_214:0", shape=(), dtype=float64)
PL:  Tensor("sub_215:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  108
output_Z_Vals[:, i, :]:  [[ 1.19251512e+02 -2.92846752e+01 -2.92776944e+01]
 [-1.33652340e-01  4.17597033e-04 -1.45269323e-01]
 [-2.64533830e-01 -3.17846467e-02  1.82537199e-01]
 [-4.77629776e-02 -4.64004014e-02 -1.72548920e-01]
 [-9.88296441e-02 -2.41910939e-01  2.15109929e-01]
 [-2.55625866e-01  2.95712276e-02  5.02115872e-03]
 [ 5.16585401e-02  9.92742596e-02 -4.37933972e-02]
 [-1.32185167e-01  2.03494889e-01 -7.17603429e-02]
 [-5.36672612e-02 -3.10128608e-02  5.29325071e-02]
 [ 4.84667485e-02  2.95537111e-02 -5.84777110e-03]
 [ 9.16765248e-02  4.16722205e-02 -1.64254177e-02]
 [ 1.77161663e-01 -1.28943300e-02 -1.65789142e-01]
 [ 3.52775227e-02 -1.52859737e-02 -2.87615526e-01]
 [-7.79543659e-02  2.57538654e-02 -3.42948725e-02]
 [-1.65957617e-01  1.33638104e-01  3.06455682e-01]
 [-1.61121777e-01 -3.05675931e-01  2.31807247e-01]
 [-3.69117415e-02 -7.41735387e-02  2.63432293e-01]
 [-2.30696086e-01  3.54901088e-01 -8.73956715e-02]
 [-2.86694672e-01 -1.00891879e+00 -1.20223839e-01]
 [ 1.02901144e-01 -4.08852240e-02 -1.10116514e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.25151208 -29.28467519 -29.2776944 ]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  8.31409947  -9.26062741 -83.52111278]
init_Out:  [2.49223638]
Stock Position:  8.314099471154409
Bond position:  [-828.91771073]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [1.7490522]
curr_Stock_Price:  99.9355397593699
curr_Factors:  [99.93553976 -1.45833686 -0.99184506]
mat_Sqrt:  [[ 8.62222744  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-1.89387876e-02  1.32055777e-04 -4.14412942e-01]
Stock Position:  -0.018938787554308837
Bond Position:  [3.64171016]


portfolio before change:  [1.74627631]
curr_Stock_Price:  100.13018933913715
curr_Factors:  [100.13018934  -1.39400837  -0.96509101]
mat_Sqrt:  [[ 9.46283341  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02410422 -0.01005119  0.52072782]
Stock Position:  -0.024104224008939575
Bond Position:  [4.15983683]


portfolio before change:  [1.7360558]
curr_Stock_Price:  100.59735252106073
curr_Factors:  [100.59735252  -1.20017757  -0.99487542]
mat_Sqrt:  [[11.20178286  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00751509 -0.0146731  -0.49223404]
Stock Position:  -0.007515092249208981
Bond Position:  [2.49205418]


portfolio before change:  [1.72507074]
curr_Stock_Price:  102.14199677483363
curr_Factors:  [102.14199677  -0.95231326  -1.01826043]
mat_Sqrt:  [[14.23623222  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00429655 -0.07649896  0.61364875]
Stock Position:  -0.004296546045537225
Bond Position:  [2.16392854]


portfolio before change:  [1.72420225]
curr_Stock_Price:  102.47006050718774
curr_Factors:  [102.47006051  -0.64017253  -1.04567445]
mat_Sqrt:  [[18.98641435  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01336942  0.00935124  0.01432397]
Stock Position:  -0.01336942277566524
Bond Position:  [3.09416781]


portfolio before change:  [1.70435644]
curr_Stock_Price:  104.01234486027218
curr_Factors:  [104.01234486  -0.78761674  -1.0618208 ]
mat_Sqrt:  [[16.36380779  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00276723  0.03139328 -0.12493037]
Stock Position:  0.0027672349391478926
Bond Position:  [1.41652984]


portfolio before change:  [1.69962516]
curr_Stock_Price:  102.17460729629003
curr_Factors:  [102.1746073   -0.8935473   -1.03072935]
mat_Sqrt:  [[14.91558353  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00949202  0.06435073 -0.20471228]
Stock Position:  -0.009492016829648698
Bond Position:  [2.66946826]


portfolio before change:  [1.70204734]
curr_Stock_Price:  101.98974452113784
curr_Factors:  [101.98974452  -1.01378345  -1.01653991]
mat_Sqrt:  [[13.39054565  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00326075 -0.00980713  0.15100171]
Stock Position:  -0.0032607489029025777
Bond Position:  [2.03461028]


portfolio before change:  [1.69960431]
curr_Stock_Price:  102.89497940073912
curr_Factors:  [102.8949794   -0.6902375   -0.95057471]
mat_Sqrt:  [[19.94336762  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00240863  0.0093457  -0.01668206]
Stock Position:  0.0024086278549459144
Bond Position:  [1.45176859]


portfolio before change:  [1.69826571]
curr_Stock_Price:  102.18852541486325
curr_Factors:  [102.18852541  -0.62950907  -0.96428258]
mat_Sqrt:  [[20.75999344  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00430634  0.01317791 -0.04685714]
Stock Position:  0.004306343968400093
Bond Position:  [1.25820677]


portfolio before change:  [1.70063876]
curr_Stock_Price:  102.66653240426571
curr_Factors:  [102.6665324   -0.50972881  -0.9535354 ]
mat_Sqrt:  [[23.76519165  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00601666 -0.00407755 -0.47295027]
Stock Position:  0.006016663704388122
Bond Position:  [1.08292877]


portfolio before change:  [1.70608801]
curr_Stock_Price:  103.52722129822729
curr_Factors:  [103.5272213   -0.49943243  -0.9667337 ]
mat_Sqrt:  [[23.89498138  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00099713 -0.00483385 -0.82048704]
Stock Position:  -0.0009971312628588836
Bond Position:  [1.80931824]


portfolio before change:  [1.70596932]
curr_Stock_Price:  104.09994027620336
curr_Factors:  [104.09994028  -0.74870957  -1.04181203]
mat_Sqrt:  [[17.37148037  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0048522   0.00814409 -0.09783373]
Stock Position:  -0.004852195306757832
Bond Position:  [2.21108256]


portfolio before change:  [1.69398841]
curr_Stock_Price:  106.6830484140723
curr_Factors:  [106.68304841  -1.0106941   -1.06147832]
mat_Sqrt:  [[13.43267076  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00744097  0.04226008  0.87423276]
Stock Position:  -0.007440969358374309
Bond Position:  [2.48781371]


portfolio before change:  [1.68865028]
curr_Stock_Price:  107.48404112797431
curr_Factors:  [107.48404113  -0.72505189  -1.04916056]
mat_Sqrt:  [[18.23111822  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00667523 -0.09666322  0.66128155]
Stock Position:  -0.006675226278962042
Bond Position:  [2.40613058]


portfolio before change:  [1.69787825]
curr_Stock_Price:  106.19174666262998
curr_Factors:  [106.19174666  -0.58324872  -1.06168288]
mat_Sqrt:  [[20.497743    0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 7.29153330e-04 -2.34557324e-02  7.51499006e-01]
Stock Position:  0.0007291533301907139
Bond Position:  [1.62044818]


portfolio before change:  [1.69953912]
curr_Stock_Price:  107.91390006505503
curr_Factors:  [107.91390007  -0.82003051  -1.04965501]
mat_Sqrt:  [[16.63731673  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01438767  0.11222958 -0.24931552]
Stock Position:  -0.014387665386347356
Bond Position:  [3.25216821]


portfolio before change:  [1.68297879]
curr_Stock_Price:  109.12142564982608
curr_Factors:  [109.12142565  -1.19687838  -1.08165511]
mat_Sqrt:  [[11.17777877  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.03017464 -0.31904813 -0.34296515]
Stock Position:  -0.030174638284166087
Bond Position:  [4.97567834]


portfolio before change:  [1.65089569]
curr_Stock_Price:  110.2259020883697
curr_Factors:  [110.22590209  -1.36703165  -1.073775  ]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [1.65089569]
Stock Price:  110.55954234924668
PL:  [-8.90864666]
Settle:  Tensor("sub_216:0", shape=(), dtype=float64)
PL:  Tensor("sub_217:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  109
output_Z_Vals[:, i, :]:  [[ 1.19251512e+02 -2.92846752e+01 -2.92776944e+01]
 [ 9.14455380e-03 -8.00809601e-02 -2.32857527e-01]
 [-2.11761786e-01 -1.74534150e-02  1.60174076e-01]
 [-5.59453936e-02 -8.13602541e-02 -2.71346793e-01]
 [-9.88296441e-02 -2.41910939e-01  2.15109929e-01]
 [-4.09768242e-01  1.16860156e-01  8.04808086e-03]
 [ 5.10615817e-02  1.09206178e-01 -4.76883669e-02]
 [-2.19968220e-01  3.17915782e-01 -2.90661385e-02]
 [-5.89630787e-02 -1.35950496e-02  1.93491641e-03]
 [-1.22906325e-01 -9.71169939e-02 -5.20323160e-02]
 [ 2.27472414e-01 -1.04905235e-01 -8.06986478e-02]
 [-1.21644879e-01  4.15077562e-02  4.63282110e-02]
 [ 3.76665287e-02 -1.37023319e-02 -2.51753265e-01]
 [-5.64083396e-02  1.28141433e-02 -2.87433230e-02]
 [-8.80770001e-02  1.44748313e-02  1.52298956e-01]
 [-6.60241624e-02 -1.44414626e-01  1.54606395e-01]
 [-2.61060515e-02 -3.50289144e-02  2.54009554e-01]
 [-1.41263333e-01  2.28625916e-01 -9.29964442e-02]
 [-3.17889892e-01 -9.56509116e-01 -1.76158778e-01]
 [ 9.27384415e-02 -7.07602641e-02 -1.32164303e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.25151208 -29.28467519 -29.2776944 ]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  8.31409947  -9.26062741 -83.52111278]
init_Out:  [2.49223638]
Stock Position:  8.314099471154409
Bond position:  [-828.91771073]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [10.80834806]
curr_Stock_Price:  101.02517019847977
curr_Factors:  [101.0251702   -1.23311479  -0.97538939]
mat_Sqrt:  [[11.09911653  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00364488 -0.02532382 -0.66427771]
Stock Position:  -0.0036448821182136237
Bond Position:  [11.17657289]


portfolio before change:  [10.81406884]
curr_Stock_Price:  100.22232097631102
curr_Factors:  [100.22232098  -0.98951972  -0.95099584]
mat_Sqrt:  [[14.39491996  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01247086 -0.00551925  0.45693206]
Stock Position:  -0.012470860258172957
Bond Position:  [12.0639274]


portfolio before change:  [10.80682742]
curr_Stock_Price:  101.0448608222789
curr_Factors:  [101.04486082  -1.04573554  -0.92464398]
mat_Sqrt:  [[14.08605157  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00805297 -0.02572837 -0.77407687]
Stock Position:  -0.008052969138990958
Bond Position:  [11.62053856]


portfolio before change:  [10.78996437]
curr_Stock_Price:  103.49967489136824
curr_Factors:  [103.49967489  -1.19334238  -0.93210458]
mat_Sqrt:  [[12.35574969  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00495046 -0.07649896  0.61364875]
Stock Position:  -0.004950458597091613
Bond Position:  [11.30233523]


portfolio before change:  [10.78928773]
curr_Stock_Price:  104.20720266422533
curr_Factors:  [104.20720266  -0.95596486  -0.95792348]
mat_Sqrt:  [[15.37115822  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02635508  0.03695443  0.02295893]
Stock Position:  -0.026355080888855728
Bond Position:  [13.53567698]


portfolio before change:  [10.77181303]
curr_Stock_Price:  104.99866443080077
curr_Factors:  [104.99866443  -1.10226941  -0.9610871 ]
mat_Sqrt:  [[13.3376535   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00330995  0.03453403 -0.13604164]
Stock Position:  0.003309946982098276
Bond Position:  [10.42427302]


portfolio before change:  [10.77957486]
curr_Stock_Price:  106.55622238392979
curr_Factors:  [106.55622238  -0.89892809  -0.92070729]
mat_Sqrt:  [[17.27114821  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01260442  0.1005338  -0.0829176 ]
Stock Position:  -0.012604417936073253
Bond Position:  [12.12265402]


portfolio before change:  [10.78977046]
curr_Stock_Price:  105.98780544698413
curr_Factors:  [105.98780545  -0.73396917  -0.94593954]
mat_Sqrt:  [[19.75517204  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00298247 -0.00429913  0.00551978]
Stock Position:  -0.0029824664693335954
Bond Position:  [11.10587554]


portfolio before change:  [10.78812096]
curr_Stock_Price:  107.47191945262468
curr_Factors:  [107.47191945  -0.90104046  -0.95746443]
mat_Sqrt:  [[16.75546893  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00811884 -0.03071109 -0.14843371]
Stock Position:  -0.008118837346922387
Bond Position:  [11.66066799]


portfolio before change:  [10.80186764]
curr_Stock_Price:  106.13784363771121
curr_Factors:  [106.13784364  -0.7346214   -0.95142521]
mat_Sqrt:  [[19.66208274  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01059355 -0.03317395 -0.23021078]
Stock Position:  0.010593548636991473
Bond Position:  [9.67749123]


portfolio before change:  [10.80580182]
curr_Stock_Price:  106.28080891888587
curr_Factors:  [106.28080892  -1.07906772  -0.91258666]
mat_Sqrt:  [[14.50408521  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00766104  0.01312591  0.13216149]
Stock Position:  -0.007661044840079357
Bond Position:  [11.62002386]


portfolio before change:  [10.82421105]
curr_Stock_Price:  104.25708256132219
curr_Factors:  [104.25708256  -0.61542455  -0.88125283]
mat_Sqrt:  [[23.34032198  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-6.03084400e-04 -4.33305779e-03 -7.18181991e-01]
Stock Position:  -0.0006030843997254001
Bond Position:  [10.88708687]


portfolio before change:  [10.82758432]
curr_Stock_Price:  103.17736840472469
curr_Factors:  [103.1773684   -0.36735932  -0.85074772]
mat_Sqrt:  [[30.51878801  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00202972  0.00405219 -0.0819967 ]
Stock Position:  -0.0020297230047925633
Bond Position:  [11.0370058]


portfolio before change:  [10.83338182]
curr_Stock_Price:  101.68065823009242
curr_Factors:  [101.68065823  -0.58415343  -0.89287991]
mat_Sqrt:  [[23.2151194   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00243873  0.00457734  0.43446653]
Stock Position:  -0.0024387282403146616
Bond Position:  [11.08135331]


portfolio before change:  [10.83090475]
curr_Stock_Price:  103.8325007508486
curr_Factors:  [103.83250075  -0.94080375  -0.84435042]
mat_Sqrt:  [[17.42010248  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00219253 -0.04566791  0.44104901]
Stock Position:  -0.0021925263629411097
Bond Position:  [11.05856024]


portfolio before change:  [10.83064076]
curr_Stock_Price:  105.21399878617765
curr_Factors:  [105.21399879  -0.79820376  -0.84802924]
mat_Sqrt:  [[20.28259963  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00122465 -0.01107712  0.72461855]
Stock Position:  0.0012246452298371041
Bond Position:  [10.70179094]


portfolio before change:  [10.83350753]
curr_Stock_Price:  105.36994819697209
curr_Factors:  [105.3699482   -0.73890591  -0.83712751]
mat_Sqrt:  [[21.78984523  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00708326  0.07229786 -0.26529297]
Stock Position:  -0.007083256207458215
Bond Position:  [11.57986987]


portfolio before change:  [10.83587376]
curr_Stock_Price:  105.4446447962085
curr_Factors:  [105.4446448   -0.6407747   -0.84088241]
mat_Sqrt:  [[23.96343231  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01579678 -0.30247474 -0.50253196]
Stock Position:  -0.01579678180971472
Bond Position:  [12.50155981]


portfolio before change:  [10.85707735]
curr_Stock_Price:  104.30024677760144
curr_Factors:  [104.30024678  -0.93722741  -0.84736391]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [10.85707735]
Stock Price:  105.34562279078482
PL:  [5.51145456]
Settle:  Tensor("sub_218:0", shape=(), dtype=float64)
PL:  Tensor("sub_219:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  110
output_Z_Vals[:, i, :]:  [[ 1.19251512e+02 -2.92846752e+01 -2.92776944e+01]
 [-3.58091775e-01  1.26287962e-01  3.30015123e-01]
 [-6.25132850e-02  2.02577083e-02  7.46220333e-02]
 [-2.13305232e-02  3.65442106e-02  5.81936148e-02]
 [-8.66990364e-02 -1.40543690e-01  1.12292225e-01]
 [-2.56499851e-02  5.15163658e-03 -1.28939542e-02]
 [-3.66964453e-02 -6.74836949e-03  2.21345764e-02]
 [-9.48754730e-02  1.57853941e-01 -8.43454378e-02]
 [-1.58254460e-01 -7.05305873e-02  1.40631519e-01]
 [ 4.50470017e-02  4.74936917e-02 -1.18045691e-02]
 [ 1.71100902e-01 -4.49400244e-02 -5.59074192e-02]
 [ 5.13031382e-02 -6.69929352e-03 -1.20511767e-01]
 [ 2.29774418e-02 -1.99979752e-02 -2.95995247e-01]
 [ 4.35271880e-02  9.52404472e-03  2.18100457e-01]
 [-2.87508367e-01  3.04942905e-01  4.81755935e-01]
 [-1.85124220e-01 -3.39229270e-01  2.49652742e-01]
 [-8.79426684e-02 -2.75190417e-01  2.15410749e-01]
 [-1.92706368e-01  2.93834825e-01 -1.10331943e-01]
 [-3.45518020e-01 -1.22631323e+00 -2.99164845e-01]
 [ 1.55359730e-01 -9.75880043e-02 -2.03265712e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.25151208 -29.28467519 -29.2776944 ]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  8.31409947  -9.26062741 -83.52111278]
init_Out:  [2.49223638]
Stock Position:  8.314099471154409
Bond position:  [-828.91771073]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-14.15401745]
curr_Stock_Price:  98.0227565769464
curr_Factors:  [98.02275658 -0.83871373 -0.96424465]
mat_Sqrt:  [[16.15518866  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0177941   0.03993576  0.94144129]
Stock Position:  -0.01779409604222281
Bond Position:  [-12.4097911]


portfolio before change:  [-14.17273708]
curr_Stock_Price:  98.90039605606228
curr_Factors:  [98.90039606 -1.02475257 -0.96591494]
mat_Sqrt:  [[13.51021056  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00346094  0.00640605  0.21287589]
Stock Position:  -0.003460943426589376
Bond Position:  [-13.83044841]


portfolio before change:  [-14.17626529]
curr_Stock_Price:  98.92066832697961
curr_Factors:  [98.92066833 -1.03859986 -0.96046699]
mat_Sqrt:  [[13.39995511  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00063494  0.01155629  0.16601018]
Stock Position:  -0.0006349449523867502
Bond Position:  [-14.11345611]


portfolio before change:  [-14.17961952]
curr_Stock_Price:  98.64572460493618
curr_Factors:  [98.6457246  -1.04736436 -0.95188889]
mat_Sqrt:  [[13.36022012  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0050453  -0.04444382  0.32033846]
Stock Position:  -0.005045298948947757
Bond Position:  [-13.68192235]


portfolio before change:  [-14.18458001]
curr_Stock_Price:  98.95087652302416
curr_Factors:  [98.95087652 -0.89365424 -0.97049221]
mat_Sqrt:  [[15.3402038   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00183498  0.00162909 -0.03678286]
Stock Position:  -0.0018349780875832787
Bond Position:  [-14.00300732]


portfolio before change:  [-14.18828638]
curr_Stock_Price:  99.06269242532618
curr_Factors:  [99.06269243 -0.84195898 -1.01855797]
mat_Sqrt:  [[15.41337987  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00209899 -0.00213402  0.06314379]
Stock Position:  -0.0020989871282439134
Bond Position:  [-13.98035506]


portfolio before change:  [-14.19433371]
curr_Stock_Price:  100.27842335769431
curr_Factors:  [100.27842336  -0.79664871  -1.0068573 ]
mat_Sqrt:  [[16.51789843  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00653937  0.0499178  -0.24061406]
Stock Position:  -0.0065393695612012154
Bond Position:  [-13.53857604]


portfolio before change:  [-14.20631884]
curr_Stock_Price:  101.59354449640944
curr_Factors:  [101.5935445   -0.34371316  -0.99830727]
mat_Sqrt:  [[26.5481366   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00494834 -0.02230373  0.40118258]
Stock Position:  -0.0049483421354034616
Bond Position:  [-13.70359922]


portfolio before change:  [-14.20637858]
curr_Stock_Price:  100.9131983298027
curr_Factors:  [ 1.00913198e+02 -2.43652481e-02 -1.00586706e+00]
mat_Sqrt:  [[36.01834595  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00121782  0.01501882 -0.03367515]
Stock Position:  0.0012178151116146389
Bond Position:  [-14.3292722]


portfolio before change:  [-14.205759]
curr_Stock_Price:  104.36392771448328
curr_Factors:  [ 1.04363928e+02  5.45578084e-02 -1.04475375e+00]
mat_Sqrt:  [[38.77160524  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00408878 -0.01421128 -0.15948831]
Stock Position:  0.004088778391462186
Bond Position:  [-14.63247997]


portfolio before change:  [-14.20911543]
curr_Stock_Price:  104.43782424561724
curr_Factors:  [104.43782425   0.32063505  -1.07716271]
mat_Sqrt:  [[49.01195503  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00054131 -0.0021185  -0.34378653]
Stock Position:  0.0005413128630472324
Bond Position:  [-14.26564897]


portfolio before change:  [-14.20881689]
curr_Stock_Price:  111.57859905838406
curr_Factors:  [111.57859906   0.32267019  -1.13819766]
mat_Sqrt:  [[49.36303179  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-7.68969794e-04 -6.32391501e-03 -8.44392049e-01]
Stock Position:  -0.0007689697940940853
Bond Position:  [-14.12301632]


portfolio before change:  [-14.21238137]
curr_Stock_Price:  111.62188035630946
curr_Factors:  [111.62188036   0.11520552  -1.14884459]
mat_Sqrt:  [[39.70503536  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00222371 0.00301177 0.6221799 ]
Stock Position:  0.0022237146086065925
Bond Position:  [-14.46059658]


portfolio before change:  [-14.21456962]
curr_Stock_Price:  112.26375538578897
curr_Factors:  [112.26375539   0.2359263   -1.14122858]
mat_Sqrt:  [[45.40166498  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00399317  0.09643141  1.37431559]
Stock Position:  -0.003993174179564679
Bond Position:  [-13.7662809]


portfolio before change:  [-14.20479887]
curr_Stock_Price:  108.95491956743308
curr_Factors:  [108.95491957   0.36043988  -1.12272401]
mat_Sqrt:  [[50.8383039   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00281132 -0.10727371  0.71218978]
Stock Position:  -0.0028113237132966137
Bond Position:  [-13.89849132]


portfolio before change:  [-14.21330801]
curr_Stock_Price:  110.74556461171386
curr_Factors:  [110.74556461   0.31027042  -1.11620122]
mat_Sqrt:  [[49.46693995  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00103256 -0.08702285  0.61450691]
Stock Position:  -0.0010325587051537308
Bond Position:  [-14.09895671]


portfolio before change:  [-14.21199961]
curr_Stock_Price:  106.06439726865266
curr_Factors:  [106.06439727   0.33063806  -1.09060151]
mat_Sqrt:  [[49.60457089  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00418592  0.09291873 -0.31474632]
Stock Position:  -0.004185924715635248
Bond Position:  [-13.76802203]


portfolio before change:  [-14.24424773]
curr_Stock_Price:  112.9459554796962
curr_Factors:  [ 1.12945955e+02  4.84021647e-02 -1.10831073e+00]
mat_Sqrt:  [[39.13436051  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01119855 -0.38779429 -0.85343403]
Stock Position:  -0.011198549156771289
Bond Position:  [-12.97941689]


portfolio before change:  [-14.25682603]
curr_Stock_Price:  113.77937064578647
curr_Factors:  [113.77937065  -0.34265626  -1.11510817]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-14.25682603]
Stock Price:  115.98578747016998
PL:  [-30.2426135]
Settle:  Tensor("sub_220:0", shape=(), dtype=float64)
PL:  Tensor("sub_221:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  111
output_Z_Vals[:, i, :]:  [[ 1.19251512e+02 -2.92846752e+01 -2.92776944e+01]
 [-4.13424888e-01  1.40065916e-01  3.62553722e-01]
 [-9.06992945e-02  4.03316462e-03  1.87818310e-02]
 [-2.64739368e-02  4.45146641e-02  7.65684777e-02]
 [-8.34244590e-02 -1.13180271e-01  8.45372644e-02]
 [-8.91727805e-02  4.78361635e-02 -5.36098592e-03]
 [-1.69777237e-01 -1.49642825e-01  1.24936098e-01]
 [ 8.20635321e-03 -2.70719710e-02 -8.89804815e-02]
 [-2.95945626e-01 -1.84337290e-01  4.04770615e-01]
 [ 2.80258232e-02  1.95574502e-02  7.09890470e-03]
 [ 3.68856685e-02  8.36263953e-02 -1.22147342e-02]
 [ 1.14741871e-03 -9.94281035e-03 -1.30491598e-01]
 [ 2.81067565e-02 -9.85731034e-02 -3.65260434e-01]
 [-2.02005403e-02  1.13491171e-02 -9.14714834e-03]
 [ 2.36706307e-02 -6.50640457e-02 -4.92080578e-02]
 [ 1.69141929e-01  2.98331644e-02 -7.87561165e-02]
 [ 2.25003301e-02 -3.67967667e-02  1.13386076e-01]
 [ 4.34142521e-02 -2.42158948e-02  5.22138790e-02]
 [-3.32369048e-01 -8.37976625e-01 -1.71311809e-01]
 [ 1.33208946e-01 -1.52041806e-01 -2.44733830e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.25151208 -29.28467519 -29.2776944 ]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  8.31409947  -9.26062741 -83.52111278]
init_Out:  [2.49223638]
Stock Position:  8.314099471154409
Bond position:  [-828.91771073]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-11.87343291]
curr_Stock_Price:  98.29705983023581
curr_Factors:  [98.29705983 -1.21505011 -0.98045958]
mat_Sqrt:  [[10.94064149  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.03069312  0.04429273  1.03426485]
Stock Position:  -0.030693120994040764
Bond Position:  [-8.85638936]


portfolio before change:  [-11.87823454]
curr_Stock_Price:  98.38135406896347
curr_Factors:  [98.38135407 -1.23356854 -0.97077425]
mat_Sqrt:  [[10.8537268   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00799369  0.0012754   0.05357934]
Stock Position:  -0.007993690553255708
Bond Position:  [-11.09180444]


portfolio before change:  [-11.87980979]
curr_Stock_Price:  98.23148033402168
curr_Factors:  [98.23148033 -0.97394334 -0.94145284]
mat_Sqrt:  [[14.46787332  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00067011  0.01407677  0.21842855]
Stock Position:  -0.0006701121772496072
Bond Position:  [-11.81398368]


portfolio before change:  [-11.88200012]
curr_Stock_Price:  97.09206026776188
curr_Factors:  [97.09206027 -0.99546827 -0.89607841]
mat_Sqrt:  [[14.64520415  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00471763 -0.03579074  0.24116128]
Stock Position:  -0.004717630666236231
Bond Position:  [-11.42395564]


portfolio before change:  [-11.8863556]
curr_Stock_Price:  97.40983248546185
curr_Factors:  [97.40983249 -0.80114387 -0.91749322]
mat_Sqrt:  [[17.46659255  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00509727  0.01512712 -0.0152934 ]
Stock Position:  -0.00509727140618739
Bond Position:  [-11.38983124]


portfolio before change:  [-11.88625386]
curr_Stock_Price:  96.83117846367585
curr_Factors:  [96.83117846 -0.72181376 -0.92899362]
mat_Sqrt:  [[18.58141055  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0079724  -0.04732122  0.35640791]
Stock Position:  -0.007972404659936911
Bond Position:  [-11.11427652]


portfolio before change:  [-11.87063923]
curr_Stock_Price:  94.52402761550985
curr_Factors:  [94.52402762 -0.53997451 -0.91737294]
mat_Sqrt:  [[22.01021387  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00048413 -0.00856091 -0.25383655]
Stock Position:  -0.0004841255462902678
Bond Position:  [-11.82487774]


portfolio before change:  [-11.87381685]
curr_Stock_Price:  94.9805901450747
curr_Factors:  [94.98059015 -0.5872805  -0.97392724]
mat_Sqrt:  [[19.93475761  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01093977 -0.05829257  1.1546979 ]
Stock Position:  -0.010939773792503014
Bond Position:  [-10.83475068]


portfolio before change:  [-11.89656506]
curr_Stock_Price:  96.81236317981198
curr_Factors:  [96.81236318 -0.57922094 -1.01277947]
mat_Sqrt:  [[19.7030667   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00152158 0.00618461 0.0202512 ]
Stock Position:  0.0015215830481210798
Bond Position:  [-12.04387311]


portfolio before change:  [-11.8958239]
curr_Stock_Price:  99.27855140994727
curr_Factors:  [99.27855141 -0.36872023 -0.9820928 ]
mat_Sqrt:  [[25.71608096  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00142135  0.02644499 -0.03484524]
Stock Position:  0.0014213507331835302
Bond Position:  [-12.03693354]


portfolio before change:  [-11.90291451]
curr_Stock_Price:  96.4073341745771
curr_Factors:  [96.40733417 -0.39209382 -0.96870094]
mat_Sqrt:  [[24.72432351  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00104131 -0.00314419 -0.37225621]
Stock Position:  -0.001041314215968018
Bond Position:  [-11.80252419]


portfolio before change:  [-11.90829059]
curr_Stock_Price:  98.73619334081994
curr_Factors:  [98.73619334 -0.75272108 -0.97828657]
mat_Sqrt:  [[17.48675825  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00280194 -0.03117155 -1.04198635]
Stock Position:  -0.0028019409510932603
Bond Position:  [-11.6316376]


portfolio before change:  [-11.90780253]
curr_Stock_Price:  97.52406002048754
curr_Factors:  [97.52406002 -0.89382876 -0.98194498]
mat_Sqrt:  [[14.94423161  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00145706  0.00358891 -0.02609427]
Stock Position:  -0.0014570612757906823
Bond Position:  [-11.765704]


portfolio before change:  [-11.91174988]
curr_Stock_Price:  98.21418428898905
curr_Factors:  [98.21418429 -0.95062559 -0.97311014]
mat_Sqrt:  [[14.34519313  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00083276 -0.02057506 -0.14037689]
Stock Position:  0.0008327619874486183
Bond Position:  [-11.99353892]


portfolio before change:  [-11.91616884]
curr_Stock_Price:  96.50877134532779
curr_Factors:  [96.50877135 -0.79006404 -0.92569901]
mat_Sqrt:  [[17.35482992  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00886417  0.00943407 -0.22466928]
Stock Position:  0.00886417176803855
Bond Position:  [-12.77163917]


portfolio before change:  [-11.94155395]
curr_Stock_Price:  94.00523244493324
curr_Factors:  [94.00523244 -0.52427451 -0.9589121 ]
mat_Sqrt:  [[21.33105166  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00209531 -0.01163616  0.32345891]
Stock Position:  0.0020953058556720206
Bond Position:  [-12.13852367]


portfolio before change:  [-11.94146309]
curr_Stock_Price:  95.49707833601968
curr_Factors:  [95.49707834 -0.40327866 -1.00737973]
mat_Sqrt:  [[23.2996249   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0022939  -0.00765774  0.14895166]
Stock Position:  0.0022939044746980806
Bond Position:  [-12.16052426]


portfolio before change:  [-11.94468045]
curr_Stock_Price:  95.419984207976
curr_Factors:  [95.41998421 -0.61208931 -0.98142833]
mat_Sqrt:  [[19.39025078  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02006031 -0.26499148 -0.48870491]
Stock Position:  -0.020060307250512444
Bond Position:  [-10.03052625]


portfolio before change:  [-11.94644397]
curr_Stock_Price:  95.38287495717155
curr_Factors:  [95.38287496 -0.63545466 -1.00180009]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-11.94644397]
Stock Price:  94.97836994757375
PL:  [-11.94644397]
Settle:  Tensor("sub_222:0", shape=(), dtype=float64)
PL:  Tensor("sub_223:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  112
output_Z_Vals[:, i, :]:  [[ 1.19251512e+02 -2.92846752e+01 -2.92776944e+01]
 [-3.51191530e-03 -4.32112406e-03 -2.86599402e-02]
 [-4.77127954e-01 -8.18347257e-02  3.33402362e-01]
 [-3.67082631e-02 -1.48942845e-01 -4.73732592e-01]
 [-9.88296441e-02 -2.41910939e-01  2.15109929e-01]
 [-2.93192014e-01  5.45613267e-02  6.39178141e-03]
 [ 5.21707873e-02  9.07517254e-02 -4.04511411e-02]
 [-1.55607280e-01  2.18523680e-01 -3.85937072e-02]
 [-3.61319094e-01 -1.57766577e-01  3.36197478e-01]
 [ 6.56593189e-02  5.43418987e-02 -4.06723555e-03]
 [ 1.25269600e-02  8.97021380e-02  5.63461871e-03]
 [-8.82580539e-02 -9.21280003e-03 -1.30692420e-01]
 [-3.77532155e-02 -3.82561749e-01 -4.05730215e-01]
 [-6.09641261e-02  2.47383285e-02 -2.03250835e-02]
 [ 1.58422183e-02 -6.22031728e-02 -7.60921619e-02]
 [-1.27902183e-02 -5.30102827e-02  1.11130804e-01]
 [-2.45408462e-02  3.36014414e-02  1.59313250e-01]
 [-1.15417029e-01  1.94765171e-01 -8.73263401e-02]
 [-2.77638827e-01 -8.69203405e-01 -1.01289324e-01]
 [ 1.22248473e-01 -1.00743727e-01 -1.82686228e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.25151208 -29.28467519 -29.2776944 ]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  8.31409947  -9.26062741 -83.52111278]
init_Out:  [2.49223638]
Stock Position:  8.314099471154409
Bond position:  [-828.91771073]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [4.98545205]
curr_Stock_Price:  100.32480619309936
curr_Factors:  [100.32480619  -0.84986274  -0.98366793]
mat_Sqrt:  [[16.03673949  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00059075 -0.00136646 -0.08175883]
Stock Position:  -0.0005907480157511392
Bond Position:  [5.04471873]


portfolio before change:  [4.98571836]
curr_Stock_Price:  102.00915049334344
curr_Factors:  [102.00915049  -0.92541727  -0.98315174]
mat_Sqrt:  [[15.12718584  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02718189 -0.02587841  0.95110414]
Stock Position:  -0.027181886290370195
Bond Position:  [7.75851949]


portfolio before change:  [4.97999613]
curr_Stock_Price:  102.2910332634668
curr_Factors:  [102.29103326  -1.10636868  -0.9536505 ]
mat_Sqrt:  [[13.03714822  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01052793 -0.04709986 -1.35142722]
Stock Position:  -0.010527932093738876
Bond Position:  [6.05690918]


portfolio before change:  [4.98242967]
curr_Stock_Price:  102.2037302890682
curr_Factors:  [102.20373029  -1.05935984  -0.95611373]
mat_Sqrt:  [[13.61939126  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00449114 -0.07649896  0.61364875]
Stock Position:  -0.004491142526413902
Bond Position:  [5.44144119]


portfolio before change:  [4.98036914]
curr_Stock_Price:  102.96546511353998
curr_Factors:  [102.96546511  -0.70367422  -0.94724101]
mat_Sqrt:  [[19.7564182   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.014703    0.01725381  0.01823397]
Stock Position:  -0.014702995606901088
Bond Position:  [6.49426992]


portfolio before change:  [4.97790239]
curr_Stock_Price:  103.24367496411179
curr_Factors:  [103.24367496  -0.56320291  -0.94281392]
mat_Sqrt:  [[22.89858553  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00202008  0.02869822 -0.11539585]
Stock Position:  0.002020078144978416
Bond Position:  [4.7693421]


portfolio before change:  [4.97838913]
curr_Stock_Price:  102.89430777564533
curr_Factors:  [102.89430778  -0.19864083  -0.90359916]
mat_Sqrt:  [[34.1739047   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00461881  0.06910326 -0.1100971 ]
Stock Position:  -0.004618814597108914
Bond Position:  [5.45363886]


portfolio before change:  [5.00083184]
curr_Stock_Price:  98.33055293217559
curr_Factors:  [98.33055293 -0.11088965 -0.86825457]
mat_Sqrt:  [[36.93614354  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00803459 -0.04989017  0.95907782]
Stock Position:  -0.00803458504655796
Bond Position:  [5.79087703]


portfolio before change:  [5.00147236]
curr_Stock_Price:  98.43104151443572
curr_Factors:  [98.43104151 -0.3181671  -0.83479708]
mat_Sqrt:  [[31.07463955  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00213139  0.01718442 -0.01160269]
Stock Position:  0.0021313907633610358
Bond Position:  [4.79167735]


portfolio before change:  [4.9998578]
curr_Stock_Price:  97.1114211640758
curr_Factors:  [97.11142116 -0.31206057 -0.80039203]
mat_Sqrt:  [[31.92554217  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00050095 0.02836631 0.016074  ]
Stock Position:  0.0005009537793301695
Bond Position:  [4.95120947]


portfolio before change:  [4.9999049]
curr_Stock_Price:  94.73424245203948
curr_Factors:  [94.73424245 -0.5223433  -0.82822245]
mat_Sqrt:  [[24.54503957  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00469233 -0.00291334 -0.3728291 ]
Stock Position:  -0.0046923291982465115
Bond Position:  [5.44442915]


portfolio before change:  [5.00035837]
curr_Stock_Price:  94.92770851476511
curr_Factors:  [94.92770851 -0.19048661 -0.81300989]
mat_Sqrt:  [[34.80006108  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00374856 -0.12097665 -1.15743537]
Stock Position:  -0.003748563844020185
Bond Position:  [5.35620095]


portfolio before change:  [4.98898756]
curr_Stock_Price:  98.31834881299204
curr_Factors:  [98.31834881 -0.70552709 -0.7819279 ]
mat_Sqrt:  [[22.21473215  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00290232  0.00782295 -0.05798181]
Stock Position:  -0.0029023183827725624
Bond Position:  [5.27433871]


portfolio before change:  [4.99164927]
curr_Stock_Price:  97.85562872288838
curr_Factors:  [97.85562872 -0.5427109  -0.77570747]
mat_Sqrt:  [[26.18207037  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-4.95036580e-05 -1.96703704e-02 -2.17069758e-01]
Stock Position:  -4.9503657983489244e-05
Bond Position:  [4.99649348]


portfolio before change:  [4.99270456]
curr_Stock_Price:  101.77424180113532
curr_Factors:  [101.7742418   -1.03515253  -0.76226016]
mat_Sqrt:  [[16.86675224  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00050546 -0.01676332  0.31702525]
Stock Position:  0.0005054643799233285
Bond Position:  [4.94126131]


portfolio before change:  [4.99450557]
curr_Stock_Price:  102.89309378730518
curr_Factors:  [102.89309379  -1.06148084  -0.72341008]
mat_Sqrt:  [[17.26704204  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00051233 0.01062571 0.45447636]
Stock Position:  0.0005123298105572725
Bond Position:  [4.94179037]


portfolio before change:  [4.99675973]
curr_Stock_Price:  104.88116941479846
curr_Factors:  [104.88116941  -1.08787663  -0.68674498]
mat_Sqrt:  [[17.78234975  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00721016  0.06159015 -0.24911774]
Stock Position:  -0.007210162357193441
Bond Position:  [5.75296999]


portfolio before change:  [4.99447673]
curr_Stock_Price:  105.39730522063348
curr_Factors:  [105.39730522  -1.08370634  -0.70126539]
mat_Sqrt:  [[17.68585814  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01813636 -0.27486625 -0.28895025]
Stock Position:  -0.018136363885707794
Bond Position:  [6.90600061]


portfolio before change:  [4.96945644]
curr_Stock_Price:  106.87207698276805
curr_Factors:  [106.87207698  -1.16722558  -0.71881297]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [4.96945644]
Stock Price:  106.75555975979455
PL:  [-1.78610332]
Settle:  Tensor("sub_224:0", shape=(), dtype=float64)
PL:  Tensor("sub_225:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  113
output_Z_Vals[:, i, :]:  [[ 1.19251512e+02 -2.92846752e+01 -2.92776944e+01]
 [-3.11667591e-01  1.09445844e-01  2.72318186e-01]
 [-8.60044230e-02  6.73564536e-03  2.80829907e-02]
 [-2.45256603e-02  4.17333916e-02  7.01961162e-02]
 [-8.72254572e-02 -1.44942631e-01  1.16754110e-01]
 [-9.43713962e-02  5.06876210e-02 -5.41460669e-03]
 [-3.43838336e-02 -6.15793021e-03  2.13222931e-02]
 [-3.70664585e-02  5.93081455e-02 -1.04533066e-01]
 [-2.52063860e-01 -1.33383775e-01  2.85252614e-01]
 [ 1.38060942e-02  1.50704404e-03  1.27571336e-02]
 [ 7.18967472e-03  9.65833128e-02 -1.94584670e-03]
 [-2.93863267e-02 -9.64176060e-03 -1.15942382e-01]
 [ 1.73127806e-02 -1.65731974e-01 -2.39261853e-01]
 [-7.98262207e-04  7.44720481e-03  3.84066486e-03]
 [ 1.83295934e-02 -6.20886010e-02 -7.67584079e-02]
 [ 8.24314716e-02 -7.59988910e-03  5.52134659e-02]
 [-2.64497617e-02  1.07193821e-01  7.37923829e-02]
 [-1.28839248e-02  5.13565681e-02 -8.99726723e-02]
 [-3.50885586e-01 -9.25281365e-01 -1.87309187e-01]
 [ 9.19576777e-02 -7.99148164e-02 -1.40588831e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.25151208 -29.28467519 -29.2776944 ]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  8.31409947  -9.26062741 -83.52111278]
init_Out:  [2.49223638]
Stock Position:  8.314099471154409
Bond position:  [-828.91771073]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-12.81826878]
curr_Stock_Price:  98.18341723193514
curr_Factors:  [98.18341723 -0.76520725 -0.97124154]
mat_Sqrt:  [[17.29450015  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01464367  0.03460981  0.77684798]
Stock Position:  -0.014643672381077687
Bond Position:  [-11.38050298]


portfolio before change:  [-12.82545268]
curr_Stock_Price:  98.47968326190669
curr_Factors:  [98.47968326 -0.64578483 -0.93128481]
mat_Sqrt:  [[20.34389022  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00393721  0.00213     0.08011296]
Stock Position:  -0.003937206306211864
Bond Position:  [-12.43771785]


portfolio before change:  [-12.82901421]
curr_Stock_Price:  98.59441144542696
curr_Factors:  [98.59441145 -0.91778517 -0.93805849]
mat_Sqrt:  [[15.41237746  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00059169  0.01319726  0.20024998]
Stock Position:  -0.000591692394699662
Bond Position:  [-12.77067665]


portfolio before change:  [-12.83213029]
curr_Stock_Price:  98.46429240196426
curr_Factors:  [98.4642924  -0.92006927 -0.94661821]
mat_Sqrt:  [[15.2260303   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00440926 -0.04583488  0.33306698]
Stock Position:  -0.004409260043047452
Bond Position:  [-12.39797562]


portfolio before change:  [-12.83041342]
curr_Stock_Price:  97.3718758493331
curr_Factors:  [97.37187585 -0.76243265 -0.92229379]
mat_Sqrt:  [[18.06201263  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00521359  0.01602883 -0.01544637]
Stock Position:  -0.005213588392091393
Bond Position:  [-12.32275654]


portfolio before change:  [-12.84215657]
curr_Stock_Price:  99.03331805793495
curr_Factors:  [99.03331806 -0.99697172 -0.92330459]
mat_Sqrt:  [[14.51496268  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00207995 -0.00194731  0.06082657]
Stock Position:  -0.0020799527008542487
Bond Position:  [-12.63617195]


portfolio before change:  [-12.84197057]
curr_Stock_Price:  97.42489510699934
curr_Factors:  [97.42489511 -0.91348279 -0.89675479]
mat_Sqrt:  [[15.94019948  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00356789  0.01875488 -0.29820374]
Stock Position:  -0.0035678883178496884
Bond Position:  [-12.49436942]


portfolio before change:  [-12.84557007]
curr_Stock_Price:  97.55817411596466
curr_Factors:  [97.55817412 -0.88757491 -0.92865628]
mat_Sqrt:  [[15.8666221   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0124337  -0.04217965  0.81374631]
Stock Position:  -0.012433703083190717
Bond Position:  [-11.6325607]


portfolio before change:  [-12.83427154]
curr_Stock_Price:  96.41555078521124
curr_Factors:  [96.41555079 -0.72379884 -0.85045192]
mat_Sqrt:  [[19.97370673  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00082353 0.00047657 0.03639255]
Stock Position:  0.0008235349183761984
Bond Position:  [-12.91367311]


portfolio before change:  [-12.83589141]
curr_Stock_Price:  98.36925763474486
curr_Factors:  [98.36925763 -0.75961925 -0.82767632]
mat_Sqrt:  [[20.11433553  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00046167  0.03054233 -0.00555096]
Stock Position:  0.0004616732592361631
Bond Position:  [-12.88130587]


portfolio before change:  [-12.83987821]
curr_Stock_Price:  96.70993468164535
curr_Factors:  [96.70993468 -0.71624105 -0.80681737]
mat_Sqrt:  [[21.08702063  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00252771 -0.00304899 -0.33075134]
Stock Position:  -0.002527712015108781
Bond Position:  [-12.59542334]


portfolio before change:  [-12.84454298]
curr_Stock_Price:  97.30949618462533
curr_Factors:  [97.30949618 -1.09418411 -0.84413084]
mat_Sqrt:  [[14.00734219  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0025562  -0.05240905 -0.68254747]
Stock Position:  -0.0025561966960345683
Bond Position:  [-12.59580076]


portfolio before change:  [-12.84668515]
curr_Stock_Price:  96.9154861437742
curr_Factors:  [96.91548614 -1.12182596 -0.84208149]
mat_Sqrt:  [[13.59812433  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [1.30897632e-05 2.35501294e-03 1.09563478e-02]
Stock Position:  1.308976319143862e-05
Bond Position:  [-12.84795375]


portfolio before change:  [-12.84988984]
curr_Stock_Price:  97.50399141646929
curr_Factors:  [97.50399142 -1.0101994  -0.86050392]
mat_Sqrt:  [[15.01710656  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 7.04681836e-05 -1.96341396e-02 -2.18970372e-01]
Stock Position:  7.046818355730198e-05
Bond Position:  [-12.85676077]


portfolio before change:  [-12.85299274]
curr_Stock_Price:  99.08894779776585
curr_Factors:  [99.0889478  -1.07908674 -0.85439364]
mat_Sqrt:  [[14.33261235  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00652398 -0.0024033   0.15750865]
Stock Position:  0.006523977806031793
Bond Position:  [-13.49944684]


portfolio before change:  [-12.85412205]
curr_Stock_Price:  99.43321219512053
curr_Factors:  [99.4332122  -0.70766732 -0.919845  ]
mat_Sqrt:  [[19.53043204  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00044132  0.03389766  0.21050913]
Stock Position:  -0.00044132265294654407
Bond Position:  [-12.81023992]


portfolio before change:  [-12.85820317]
curr_Stock_Price:  101.423035545852
curr_Factors:  [101.42303555  -0.60692773  -0.95475451]
mat_Sqrt:  [[21.27681538  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00140639  0.01624037 -0.25666699]
Stock Position:  -0.0014063899242245843
Bond Position:  [-12.71556283]


portfolio before change:  [-12.8610824]
curr_Stock_Price:  101.20968582424875
curr_Factors:  [101.20968582  -0.61212182  -0.95052143]
mat_Sqrt:  [[21.21166377  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01947092 -0.29259966 -0.53434097]
Stock Position:  -0.01947091848318686
Bond Position:  [-10.89043686]


portfolio before change:  [-12.85879006]
curr_Stock_Price:  100.9521072100198
curr_Factors:  [100.95210721  -0.6289544   -0.93973967]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-12.85879006]
Stock Price:  101.35584922770411
PL:  [-14.21463929]
Settle:  Tensor("sub_226:0", shape=(), dtype=float64)
PL:  Tensor("sub_227:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  114
output_Z_Vals[:, i, :]:  [[ 1.19251512e+02 -2.92846752e+01 -2.92776944e+01]
 [-3.95042295e-01  1.32859613e-01  3.41564482e-01]
 [-9.17418660e-02  3.43303543e-03  1.67163593e-02]
 [-2.49283787e-02  4.24619971e-02  7.19024701e-02]
 [-8.29838498e-02 -1.09498398e-01  8.08027085e-02]
 [-1.11299484e-01  5.25876369e-02  1.62542522e-04]
 [-2.38805483e-01 -2.22270167e-01  1.77048037e-01]
 [-1.92825913e-02  1.99509033e-02 -1.04670785e-01]
 [-2.51578911e-01 -1.52933655e-01  3.32335644e-01]
 [ 7.92791067e-04 -2.57647432e-02  2.10887831e-02]
 [-1.68842130e-02  1.03155856e-01  1.52544081e-02]
 [ 5.80769533e-02 -9.40204410e-03 -1.14360028e-01]
 [ 4.52851012e-02 -4.42542300e-02 -2.72031994e-01]
 [-6.38450471e-02  2.48771570e-02 -2.38298409e-02]
 [ 6.17520361e-03 -6.30009080e-02 -1.63413085e-02]
 [ 5.51771378e-02 -1.04926863e-02  8.45930559e-02]
 [-2.35647895e-02  1.03259148e-01  6.82888801e-02]
 [ 3.59644026e-02 -1.09176897e-02 -1.94255792e-03]
 [-2.26830274e-01 -6.93477412e-01 -4.77796923e-02]
 [ 6.69464233e-02 -2.24365192e-02 -6.63047130e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.25151208 -29.28467519 -29.2776944 ]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  8.31409947  -9.26062741 -83.52111278]
init_Out:  [2.49223638]
Stock Position:  8.314099471154409
Bond position:  [-828.91771073]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-9.35285429]
curr_Stock_Price:  98.6002289989249
curr_Factors:  [98.600229   -1.37803886 -1.00784365]
mat_Sqrt:  [[ 9.07198485  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0354818  0.0420139  0.9743884]
Stock Position:  -0.03548179609550723
Bond Position:  [-5.85434107]


portfolio before change:  [-9.34571733]
curr_Stock_Price:  98.35783060605867
curr_Factors:  [98.35783061 -1.02461383 -1.02014137]
mat_Sqrt:  [[12.72867038  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00693246  0.00108562  0.04768712]
Stock Position:  -0.0069324611416563785
Bond Position:  [-8.66385549]


portfolio before change:  [-9.3473083]
curr_Stock_Price:  98.27485025229787
curr_Factors:  [98.27485025 -1.0735016  -1.0286618 ]
mat_Sqrt:  [[12.00838011  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00076238  0.01342766  0.20511773]
Stock Position:  -0.0007623829602545691
Bond Position:  [-9.27238523]


portfolio before change:  [-9.34837214]
curr_Stock_Price:  96.62928980138363
curr_Factors:  [96.6292898  -1.01305081 -1.02065266]
mat_Sqrt:  [[12.64394485  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00548225 -0.03462643  0.23050764]
Stock Position:  -0.005482252827944825
Bond Position:  [-8.81862594]


portfolio before change:  [-9.35033676]
curr_Stock_Price:  96.58545524935198
curr_Factors:  [96.58545525 -0.87712368 -1.03191817]
mat_Sqrt:  [[14.316122    0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00767725  0.01662967  0.00046369]
Stock Position:  -0.007677253557785362
Bond Position:  [-8.60882573]


portfolio before change:  [-9.34394761]
curr_Stock_Price:  95.4728661921468
curr_Factors:  [95.47286619 -1.08965903 -0.98941123]
mat_Sqrt:  [[11.93854002  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01745646 -0.070288    0.50506877]
Stock Position:  -0.017456464079252988
Bond Position:  [-7.67732895]


portfolio before change:  [-9.36631122]
curr_Stock_Price:  96.64401080664118
curr_Factors:  [96.64401081 -1.11161388 -1.01289087]
mat_Sqrt:  [[11.54819888  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00347529  0.00630903 -0.29859661]
Stock Position:  -0.0034752861572755265
Bond Position:  [-9.03044563]


portfolio before change:  [-9.3671552]
curr_Stock_Price:  96.23716035760843
curr_Factors:  [96.23716036 -0.87464955 -1.02847941]
mat_Sqrt:  [[14.34909107  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01308026 -0.04836187  0.94806109]
Stock Position:  -0.01308026488561281
Bond Position:  [-8.10834765]


portfolio before change:  [-9.36574448]
curr_Stock_Price:  95.97431704905074
curr_Factors:  [95.97431705 -1.02194728 -1.038294  ]
mat_Sqrt:  [[12.22935667  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00036243 -0.00814753  0.06016043]
Stock Position:  0.0003624293735532706
Bond Position:  [-9.40052839]


portfolio before change:  [-9.36802405]
curr_Stock_Price:  96.1698102840957
curr_Factors:  [96.16981028 -0.66771196 -1.04664521]
mat_Sqrt:  [[17.31820604  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00064135  0.03262075  0.04351658]
Stock Position:  -0.0006413451398079072
Bond Position:  [-9.30634601]


portfolio before change:  [-9.37222018]
curr_Stock_Price:  99.08439091791524
curr_Factors:  [99.08439092 -0.88212405 -1.06313369]
mat_Sqrt:  [[14.16415077  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00243506 -0.00297319 -0.32623733]
Stock Position:  0.0024350595454832734
Bond Position:  [-9.61349657]


portfolio before change:  [-9.3745592]
curr_Stock_Price:  99.11094146111357
curr_Factors:  [99.11094146 -1.20337655 -1.07010018]
mat_Sqrt:  [[10.20382975  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00111584 -0.01399442 -0.77603156]
Stock Position:  -0.0011158395175055057
Bond Position:  [-9.2639673]


portfolio before change:  [-9.376863]
curr_Stock_Price:  99.09975615086549
curr_Factors:  [99.09975615 -1.53605082 -1.06257376]
mat_Sqrt:  [[ 7.37062425  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0092349   0.00786685 -0.0679799 ]
Stock Position:  -0.009234898597529082
Bond Position:  [-8.4616868]


portfolio before change:  [-9.38326495]
curr_Stock_Price:  99.56389301194285
curr_Factors:  [99.56389301 -1.34435943 -1.03944335]
mat_Sqrt:  [[ 9.17972079  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00013213 -0.01992264 -0.0466172 ]
Stock Position:  0.0001321251015953412
Bond Position:  [-9.39641984]


portfolio before change:  [-9.38564173]
curr_Stock_Price:  99.35662712422437
curr_Factors:  [99.35662712 -1.3008208  -1.05828209]
mat_Sqrt:  [[ 9.38969473  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00768648 -0.00331808  0.24132044]
Stock Position:  0.007686480248962867
Bond Position:  [-10.14934448]


portfolio before change:  [-9.38880224]
curr_Stock_Price:  99.27559467163367
curr_Factors:  [99.27559467 -1.03546877 -1.03827332]
mat_Sqrt:  [[12.48037838  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00055761  0.03265341  0.19480917]
Stock Position:  -0.0005576145442302466
Bond Position:  [-9.33344472]


portfolio before change:  [-9.39123656]
curr_Stock_Price:  99.45612537822858
curr_Factors:  [99.45612538 -1.26754651 -1.06097066]
mat_Sqrt:  [[ 9.69101747  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0036411  -0.00345248 -0.00554158]
Stock Position:  0.003641102303687968
Bond Position:  [-9.75336648]


portfolio before change:  [-9.39253059]
curr_Stock_Price:  99.77048352615066
curr_Factors:  [99.77048353 -1.71276495 -1.03471956]
mat_Sqrt:  [[ 6.39417789  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.03980008 -0.21929681 -0.13630216]
Stock Position:  -0.039800077127913926
Bond Position:  [-5.42165765]


portfolio before change:  [-9.37932019]
curr_Stock_Price:  99.40450474724459
curr_Factors:  [99.40450475 -1.88433666 -1.05663316]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-9.37932019]
Stock Price:  99.71070163608871
PL:  [-9.37932019]
Settle:  Tensor("sub_228:0", shape=(), dtype=float64)
PL:  Tensor("sub_229:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  115
output_Z_Vals[:, i, :]:  [[ 1.19251512e+02 -2.92846752e+01 -2.92776944e+01]
 [-7.32235331e-02 -1.24611016e-01 -4.32879168e-01]
 [-5.46849508e-01 -9.69223488e-02  3.93372223e-01]
 [ 6.37410276e-02 -1.65085186e-01 -5.00741766e-01]
 [-9.88296441e-02 -2.41910939e-01  2.15109929e-01]
 [-2.53767260e-01  5.60894023e-03  2.26811432e-02]
 [ 5.23265548e-02  8.81601372e-02 -3.94348060e-02]
 [-1.39963795e-01  2.13524590e-01 -6.98362827e-02]
 [-3.26496797e-02 -2.20587515e-02  3.28715094e-02]
 [ 5.07131987e-02  3.64608387e-02 -7.50352231e-03]
 [ 8.63240985e-02  4.49529384e-02 -1.61286190e-02]
 [ 1.39705328e-01 -1.17958831e-02 -1.49612874e-01]
 [ 4.57668279e-02 -9.80908169e-03 -2.05767850e-01]
 [-8.45720117e-02  2.97281712e-02 -3.59999752e-02]
 [-8.91949681e-02  1.71084471e-02  1.58618376e-01]
 [-2.98285816e-02 -7.24697968e-02  1.22798766e-01]
 [-2.38861459e-02  4.34036258e-02  1.43951702e-01]
 [-5.09573983e-03  4.13639766e-02 -8.76812651e-02]
 [-3.40099313e-01 -9.57628665e-01 -1.71578887e-01]
 [ 7.38233833e-02 -3.82404428e-02 -8.67294746e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.25151208 -29.28467519 -29.2776944 ]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  8.31409947  -9.26062741 -83.52111278]
init_Out:  [2.49223638]
Stock Position:  8.314099471154409
Bond position:  [-828.91771073]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [18.91695809]
curr_Stock_Price:  102.00045442026115
curr_Factors:  [102.00045442  -1.25733735  -1.03195685]
mat_Sqrt:  [[10.33651813  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01594367 -0.03940546 -1.23488378]
Stock Position:  -0.015943673083794047
Bond Position:  [20.54321999]


portfolio before change:  [18.91762836]
curr_Stock_Price:  102.2805764577489
curr_Factors:  [102.28057646  -1.05112868  -1.0200094 ]
mat_Sqrt:  [[12.89167441  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.03638436 -0.03064954  1.12218146]
Stock Position:  -0.03638435539060681
Bond Position:  [22.63904121]


portfolio before change:  [18.88224204]
curr_Stock_Price:  103.40872035266402
curr_Factors:  [103.40872035  -1.1234942   -1.03753818]
mat_Sqrt:  [[11.91331788  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00358716 -0.05220452 -1.42847688]
Stock Position:  -0.003587156748022634
Bond Position:  [19.25318533]


portfolio before change:  [18.88762292]
curr_Stock_Price:  103.25066232038655
curr_Factors:  [103.25066232  -1.21316731  -1.03976926]
mat_Sqrt:  [[10.85062931  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00563715 -0.07649896  0.61364875]
Stock Position:  -0.005637150208231697
Bond Position:  [19.46966241]


portfolio before change:  [18.89411791]
curr_Stock_Price:  102.96204767049778
curr_Factors:  [102.96204767  -1.24726174  -1.05557761]
mat_Sqrt:  [[10.29358731  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02418911  0.0017737   0.06470299]
Stock Position:  -0.024189105477174892
Bond Position:  [21.38467774]


portfolio before change:  [18.88363284]
curr_Stock_Price:  103.61655325771999
curr_Factors:  [103.61655326  -1.11777345  -1.09904749]
mat_Sqrt:  [[11.28953463  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00412358  0.02787868 -0.11249652]
Stock Position:  0.004123575086522886
Bond Position:  [18.4563622]


portfolio before change:  [18.8837064]
curr_Stock_Price:  102.51529837705701
curr_Factors:  [102.51529838  -0.90915626  -1.10322492]
mat_Sqrt:  [[13.70322018  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01085189  0.0675224  -0.19922348]
Stock Position:  -0.010851893421359761
Bond Position:  [19.99619149]


portfolio before change:  [18.8898275]
curr_Stock_Price:  102.41195923176242
curr_Factors:  [102.41195923  -0.98213251  -1.04883552]
mat_Sqrt:  [[13.43731401  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00197282 -0.00697559  0.09377327]
Stock Position:  -0.0019728172908434326
Bond Position:  [19.09186758]


portfolio before change:  [18.89437457]
curr_Stock_Price:  102.52676650141835
curr_Factors:  [102.5267665   -0.97088981  -1.05641163]
mat_Sqrt:  [[13.50179254  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00371232  0.01152993 -0.02140546]
Stock Position:  0.0037123191791241746
Bond Position:  [18.51376249]


portfolio before change:  [18.89753925]
curr_Stock_Price:  102.13231394572443
curr_Factors:  [102.13231395  -1.0964458   -1.05832917]
mat_Sqrt:  [[11.84012505  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00711078  0.01421537 -0.04601046]
Stock Position:  0.007110781133913326
Bond Position:  [18.17129872]


portfolio before change:  [18.90555369]
curr_Stock_Price:  102.62045231416805
curr_Factors:  [102.62045231  -1.29915625  -1.04367561]
mat_Sqrt:  [[ 9.85723193  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01104379 -0.00373019 -0.42680389]
Stock Position:  0.01104378597125401
Bond Position:  [17.77223538]


portfolio before change:  [18.90627391]
curr_Stock_Price:  102.28330392783234
curr_Factors:  [102.28330393  -1.11235016  -1.04334943]
mat_Sqrt:  [[11.84667058  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 2.96401597e-04 -3.10190399e-03 -5.86998401e-01]
Stock Position:  0.0002964015972900608
Bond Position:  [18.87595698]


portfolio before change:  [18.91095577]
curr_Stock_Price:  102.15605560222434
curr_Factors:  [102.1560556   -0.9789531   -1.04829426]
mat_Sqrt:  [[13.45370109  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0067753   0.00940087 -0.10269791]
Stock Position:  -0.006775302731141269
Bond Position:  [19.60309398]


portfolio before change:  [18.91406896]
curr_Stock_Price:  102.41998435847898
curr_Factors:  [102.41998436  -1.09029529  -1.05869317]
mat_Sqrt:  [[11.94237974  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00472062  0.00541017  0.45249408]
Stock Position:  -0.004720616051576161
Bond Position:  [19.39755438]


portfolio before change:  [18.91945987]
curr_Stock_Price:  102.30539847809804
curr_Factors:  [102.30539848  -0.78318954  -1.07141772]
mat_Sqrt:  [[16.01226797  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00041428 -0.02291696  0.3503107 ]
Stock Position:  -0.0004142792601523676
Bond Position:  [18.96184288]


portfolio before change:  [18.92410189]
curr_Stock_Price:  102.5444604629127
curr_Factors:  [102.54446046  -0.9172536   -1.05536647]
mat_Sqrt:  [[14.2631087   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00046403 0.01372543 0.41065414]
Stock Position:  0.00046403272142900916
Bond Position:  [18.8765179]


portfolio before change:  [18.92824457]
curr_Stock_Price:  101.30093007936487
curr_Factors:  [101.30093008  -0.72335123  -1.04720259]
mat_Sqrt:  [[17.24533681  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00127139  0.01308044 -0.25013024]
Stock Position:  -0.001271392381739816
Bond Position:  [19.0570378]


portfolio before change:  [18.93038266]
curr_Stock_Price:  103.36698460682615
curr_Factors:  [103.36698461  -0.81510678  -1.07189681]
mat_Sqrt:  [[15.66269897  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02552871 -0.30282877 -0.48946681]
Stock Position:  -0.025528714659826215
Bond Position:  [21.56920891]


portfolio before change:  [18.92814238]
curr_Stock_Price:  103.66599133744955
curr_Factors:  [103.66599134  -0.68556995  -1.05232271]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [18.92814238]
Stock Price:  106.05269455080882
PL:  [12.87544783]
Settle:  Tensor("sub_230:0", shape=(), dtype=float64)
PL:  Tensor("sub_231:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  116
output_Z_Vals[:, i, :]:  [[ 1.19251512e+02 -2.92846752e+01 -2.92776944e+01]
 [-1.61313707e-01  2.34112000e-02 -1.03940024e-01]
 [-1.60896606e-01 -3.64002766e-03  1.38619022e-01]
 [-5.94143474e-02 -9.61723944e-02 -3.13198951e-01]
 [-9.88296441e-02 -2.41910939e-01  2.15109929e-01]
 [-2.60024337e-01  3.02009885e-03  2.63538287e-02]
 [ 5.48115963e-02  4.68151608e-02 -2.32206736e-02]
 [-1.26086305e-01  1.98610703e-01 -7.85523731e-02]
 [-6.48810724e-02 -3.56961632e-02  6.34094495e-02]
 [ 4.59433077e-02  4.74660764e-02 -1.16366816e-02]
 [ 6.73506523e-02  5.93022371e-02 -1.47329943e-02]
 [ 7.84513762e-02 -9.99954575e-03 -1.23159130e-01]
 [ 2.94554596e-02 -1.82322623e-02 -3.28248715e-01]
 [-4.71455009e-02  7.74405844e-03 -2.47745796e-02]
 [-1.36402568e-01  9.19853640e-02  2.63831448e-01]
 [-8.00530355e-02 -1.55761960e-01  1.63141031e-01]
 [-2.04439527e-02  1.25433180e-02  1.68872951e-01]
 [-4.41028839e-02  9.05455667e-02 -1.01555877e-01]
 [-3.97991866e-01 -1.15352482e+00 -3.20630177e-01]
 [ 1.21979330e-01 -7.99189621e-02 -1.62059698e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.25151208 -29.28467519 -29.2776944 ]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  8.31409947  -9.26062741 -83.52111278]
init_Out:  [2.49223638]
Stock Position:  8.314099471154409
Bond position:  [-828.91771073]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-0.51538125]
curr_Stock_Price:  99.66317911958848
curr_Factors:  [99.66317912 -0.74839316 -0.98910568]
mat_Sqrt:  [[17.53672848  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01037399  0.00740327 -0.29651196]
Stock Position:  -0.010373993167697704
Bond Position:  [0.51852389]


portfolio before change:  [-0.51860648]
curr_Stock_Price:  99.98657228027042
curr_Factors:  [99.98657228 -0.77578275 -1.01019913]
mat_Sqrt:  [[16.76098763  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0079169  -0.00115108  0.39544148]
Stock Position:  -0.007916902345599943
Bond Position:  [0.27297745]


portfolio before change:  [-0.52778999]
curr_Stock_Price:  101.15518123137103
curr_Factors:  [101.15518123  -1.1745357   -1.03879623]
mat_Sqrt:  [[11.05987684  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01137707 -0.03041238 -0.89346943]
Stock Position:  -0.01137706846681425
Bond Position:  [0.62305943]


portfolio before change:  [-0.53169522]
curr_Stock_Price:  101.51212811935079
curr_Factors:  [101.51212812  -1.18563497  -1.03950514]
mat_Sqrt:  [[10.96861672  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00557651 -0.07649896  0.61364875]
Stock Position:  -0.005576512408317246
Bond Position:  [0.03438842]


portfolio before change:  [-0.54059697]
curr_Stock_Price:  103.10996454131441
curr_Factors:  [103.10996454  -1.39804008  -1.09254275]
mat_Sqrt:  [[ 8.54386266  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02979529  0.00095504  0.07518014]
Stock Position:  -0.029795294697457234
Bond Position:  [2.5315948]


portfolio before change:  [-0.50106771]
curr_Stock_Price:  101.80451397027565
curr_Factors:  [101.80451397  -0.87449908  -1.09792962]
mat_Sqrt:  [[14.16289823  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00362076  0.01480425 -0.06624212]
Stock Position:  0.0036207602120298514
Bond Position:  [-0.86967745]


portfolio before change:  [-0.50079024]
curr_Stock_Price:  101.94120226625623
curr_Factors:  [101.94120227  -1.01493821  -1.0644023 ]
mat_Sqrt:  [[12.74393776  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01074963  0.06280622 -0.22408806]
Stock Position:  -0.010749631516132986
Bond Position:  [0.59504012]


portfolio before change:  [-0.50024831]
curr_Stock_Price:  101.90462858751405
curr_Factors:  [101.90462859  -0.94715142  -1.05253456]
mat_Sqrt:  [[13.79562324  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0038316  -0.01128812  0.18088951]
Stock Position:  -0.0038316024396135868
Bond Position:  [-0.10979029]


portfolio before change:  [-0.49922362]
curr_Stock_Price:  101.6300316414525
curr_Factors:  [101.63003164  -0.61135005  -1.07447114]
mat_Sqrt:  [[18.83125306  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00237868  0.01501009 -0.03319621]
Stock Position:  0.0023786812647205334
Bond Position:  [-0.74096907]


portfolio before change:  [-0.49949732]
curr_Stock_Price:  101.59285001752616
curr_Factors:  [101.59285002  -0.72525344  -1.05940201]
mat_Sqrt:  [[17.05285622  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00386296  0.01875301 -0.04202913]
Stock Position:  0.00386295812822334
Bond Position:  [-0.89194625]


portfolio before change:  [-0.49163954]
curr_Stock_Price:  103.68471855533623
curr_Factors:  [103.68471856  -0.51867161  -1.05978301]
mat_Sqrt:  [[21.38949948  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00248035 -0.00316213 -0.35133872]
Stock Position:  0.002480349618185823
Bond Position:  [-0.74881389]


portfolio before change:  [-0.48882184]
curr_Stock_Price:  104.89621021255398
curr_Factors:  [104.89621021  -0.15725689  -1.11173409]
mat_Sqrt:  [[29.4879116   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0012893  -0.00576555 -0.93640222]
Stock Position:  -0.0012893006537299796
Bond Position:  [-0.35357909]


portfolio before change:  [-0.48888731]
curr_Stock_Price:  104.87841578932309
curr_Factors:  [ 1.04878416e+02 -1.03077309e-01 -1.13483436e+00]
mat_Sqrt:  [[30.41360571  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00170985  0.00244889 -0.07067498]
Stock Position:  -0.001709847906265964
Bond Position:  [-0.30956117]


portfolio before change:  [-0.48938477]
curr_Stock_Price:  105.12408780578329
curr_Factors:  [ 1.05124088e+02  7.54685720e-02 -1.10908631e+00]
mat_Sqrt:  [[37.39450252  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00214398  0.02908833  0.75263769]
Stock Position:  -0.002143982182887945
Bond Position:  [-0.2640006]


portfolio before change:  [-0.4881986]
curr_Stock_Price:  104.5400450937416
curr_Factors:  [104.54004509  -0.17947558  -1.13876967]
mat_Sqrt:  [[27.97538317  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00181494 -0.04925626  0.46539595]
Stock Position:  -0.0018149445253806077
Bond Position:  [-0.29846422]


portfolio before change:  [-0.48393987]
curr_Stock_Price:  102.15244674931307
curr_Factors:  [102.15244675   0.20368074  -1.09960557]
mat_Sqrt:  [[41.70168085  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [3.44133875e-04 3.96654544e-03 4.81747523e-01]
Stock Position:  0.00034413387516458375
Bond Position:  [-0.51909398]


portfolio before change:  [-0.48430723]
curr_Stock_Price:  101.46207795082633
curr_Factors:  [101.46207795   0.20856414  -1.07324211]
mat_Sqrt:  [[42.73452476  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0014624   0.02863302 -0.28971065]
Stock Position:  -0.00146240105085256
Bond Position:  [-0.33592899]


portfolio before change:  [-0.48946766]
curr_Stock_Price:  104.9333788341765
curr_Factors:  [104.93337883   0.24355752  -1.1007988 ]
mat_Sqrt:  [[44.52649357  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01107709 -0.36477658 -0.91466865]
Stock Position:  -0.011077092990851852
Bond Position:  [0.67288913]


portfolio before change:  [-0.51791908]
curr_Stock_Price:  107.51705893086869
curr_Factors:  [ 1.07517059e+02 -9.99012169e-02 -1.05750722e+00]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-0.51791908]
Stock Price:  113.82158575917161
PL:  [-14.33950484]
Settle:  Tensor("sub_232:0", shape=(), dtype=float64)
PL:  Tensor("sub_233:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  117
output_Z_Vals[:, i, :]:  [[ 1.19251512e+02 -2.92846752e+01 -2.92776944e+01]
 [-4.43718294e-02 -1.56046446e-02 -6.71793357e-02]
 [-2.91568023e-01 -3.91262855e-02  1.93993435e-01]
 [-1.76313668e-02  3.14169757e-02  4.65835852e-02]
 [-8.90333365e-02 -1.60049850e-01  1.32077497e-01]
 [-4.42547611e-03  2.17253465e-03 -5.12593055e-03]
 [-1.10992816e-01 -7.55191193e-02  7.37848808e-02]
 [-5.67331236e-02  9.15809474e-02 -1.15777249e-01]
 [-2.15195353e-01 -1.10502311e-01  2.32796243e-01]
 [ 4.50470017e-02  4.74936917e-02 -1.18045691e-02]
 [-2.27768025e-02  1.16139038e-01 -5.38533180e-03]
 [ 4.30296647e-03 -8.12128817e-03 -9.52364906e-02]
 [ 4.69766647e-02 -3.63406477e-02 -2.73085051e-01]
 [-8.23048791e-02  3.04306189e-02 -3.08704995e-02]
 [-8.29536455e-03 -5.46700788e-02  4.83560726e-03]
 [ 2.59010904e-02 -6.99826081e-03  8.95340042e-02]
 [-2.72879370e-02  1.03637033e-01  8.11827006e-02]
 [ 2.08859445e-02  9.51689031e-03 -6.13350838e-02]
 [-2.99364688e-01 -8.26862977e-01 -1.03613361e-01]
 [ 8.87405799e-02 -7.25216124e-02 -1.31033961e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.25151208 -29.28467519 -29.2776944 ]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  8.31409947  -9.26062741 -83.52111278]
init_Out:  [2.49223638]
Stock Position:  8.314099471154409
Bond position:  [-828.91771073]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [4.38602144]
curr_Stock_Price:  100.25270811325973
curr_Factors:  [100.25270811  -1.10734564  -1.00202981]
mat_Sqrt:  [[12.1620279   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00480904 -0.00493462 -0.19164395]
Stock Position:  -0.00480903880147035
Bond Position:  [4.86814061]


portfolio before change:  [4.38644084]
curr_Stock_Price:  100.41860232529147
curr_Factors:  [100.41860233  -1.1982902   -1.01196928]
mat_Sqrt:  [[11.01312773  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02297072 -0.01237282  0.55340927]
Stock Position:  -0.022970723801115384
Bond Position:  [6.69312882]


portfolio before change:  [4.41297349]
curr_Stock_Price:  99.33639177171146
curr_Factors:  [99.33639177 -1.42432641 -0.93367208]
mat_Sqrt:  [[ 9.39815595  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00077796  0.00993492  0.13289   ]
Stock Position:  -0.0007779557482617676
Bond Position:  [4.49025281]


portfolio before change:  [4.41470294]
curr_Stock_Price:  98.55646194322439
curr_Factors:  [98.55646194 -1.31634423 -0.93548477]
mat_Sqrt:  [[10.36879278  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00638508 -0.05061221  0.37678033]
Stock Position:  -0.006385082730303347
Bond Position:  [5.04399411]


portfolio before change:  [4.41814742]
curr_Stock_Price:  98.2145206827512
curr_Factors:  [98.21452068 -1.33259583 -0.91229878]
mat_Sqrt:  [[10.4047191   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0005205   0.00068702 -0.01462285]
Stock Position:  -0.0005205049403410008
Bond Position:  [4.46926857]


portfolio before change:  [4.41951602]
curr_Stock_Price:  97.73202083282581
curr_Factors:  [97.73202083 -1.33157279 -0.89091775]
mat_Sqrt:  [[10.58818447  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0092444  -0.02388124  0.21048773]
Stock Position:  -0.00924440216415086
Bond Position:  [5.32299013]


portfolio before change:  [4.41227505]
curr_Stock_Price:  98.65927261439911
curr_Factors:  [98.65927261 -1.37341451 -0.92684308]
mat_Sqrt:  [[ 9.88891697  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00788776  0.02896044 -0.33028027]
Stock Position:  -0.007887764252507487
Bond Position:  [5.19047613]


portfolio before change:  [4.4168502]
curr_Stock_Price:  98.24377209209588
curr_Factors:  [98.24377209 -1.14940246 -0.88241006]
mat_Sqrt:  [[12.87953146  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01324032 -0.0349439   0.66410288]
Stock Position:  -0.013240324517413457
Bond Position:  [5.71762962]


portfolio before change:  [4.39634582]
curr_Stock_Price:  99.90037527356886
curr_Factors:  [99.90037527 -1.59319469 -0.90163058]
mat_Sqrt:  [[ 8.24286663  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00532141  0.01501882 -0.03367515]
Stock Position:  0.005321411590424129
Bond Position:  [3.86473481]


portfolio before change:  [4.39655557]
curr_Stock_Price:  99.75820235680551
curr_Factors:  [99.75820236 -1.85080136 -0.92626198]
mat_Sqrt:  [[ 6.20705125  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00336349  0.03672639 -0.01536285]
Stock Position:  -0.003363494331425479
Bond Position:  [4.73209171]


portfolio before change:  [4.39796223]
curr_Stock_Price:  99.69175504667876
curr_Factors:  [99.69175505 -1.60456371 -0.92443127]
mat_Sqrt:  [[ 7.94933272  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00193058 -0.00256818 -0.2716832 ]
Stock Position:  -0.0019305760703979117
Bond Position:  [4.59042475]


portfolio before change:  [4.39992774]
curr_Stock_Price:  99.26817359955595
curr_Factors:  [99.2681736  -1.19281977 -0.974983  ]
mat_Sqrt:  [[11.35913475  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00085437 -0.01149192 -0.77903564]
Stock Position:  -0.00085436960302374
Bond Position:  [4.48473945]


portfolio before change:  [4.40034857]
curr_Stock_Price:  100.08806986856514
curr_Factors:  [100.08806987  -1.04457963  -1.0269239 ]
mat_Sqrt:  [[12.61071647  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00696396  0.00962301 -0.08806494]
Stock Position:  -0.006963964213752787
Bond Position:  [5.09735831]


portfolio before change:  [4.40233678]
curr_Stock_Price:  99.98558341589963
curr_Factors:  [99.98558342 -1.17356453 -1.05577676]
mat_Sqrt:  [[10.75837715  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00081052 -0.0172882   0.01379464]
Stock Position:  -0.0008105196165239292
Bond Position:  [4.48337706]


portfolio before change:  [4.40316777]
curr_Stock_Price:  100.34336905469132
curr_Factors:  [100.34336905  -1.1343304   -1.03458091]
mat_Sqrt:  [[11.46944668  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00383597 -0.00221304  0.25541559]
Stock Position:  0.0038359695475749488
Bond Position:  [4.01825366]


portfolio before change:  [4.40459511]
curr_Stock_Price:  100.4535505184557
curr_Factors:  [100.45355052  -1.08268587  -0.96661537]
mat_Sqrt:  [[12.94091756  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00062134  0.03277291  0.23159165]
Stock Position:  -0.0006213385462682709
Bond Position:  [4.46701078]


portfolio before change:  [4.40558623]
curr_Stock_Price:  100.65598543312674
curr_Factors:  [100.65598543  -1.20138838  -0.99590326]
mat_Sqrt:  [[11.18324831  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00077005  0.0030095  -0.17497192]
Stock Position:  0.0007700533611377195
Bond Position:  [4.32807575]


portfolio before change:  [4.40687641]
curr_Stock_Price:  100.92613355353768
curr_Factors:  [100.92613355  -1.13550445  -0.9426341 ]
mat_Sqrt:  [[12.63221569  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02706288 -0.26147703 -0.29558008]
Stock Position:  -0.02706288394744299
Bond Position:  [7.13822865]


portfolio before change:  [4.43105122]
curr_Stock_Price:  100.09879993023264
curr_Factors:  [100.09879993  -1.04918825  -0.93794655]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [4.43105122]
Stock Price:  100.46056530457112
PL:  [3.97048592]
Settle:  Tensor("sub_234:0", shape=(), dtype=float64)
PL:  Tensor("sub_235:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  118
output_Z_Vals[:, i, :]:  [[ 1.19251512e+02 -2.92846752e+01 -2.92776944e+01]
 [-1.19680137e-01  4.09681103e-02  4.88100292e-02]
 [-6.22696640e-02  2.03979424e-02  7.51046786e-02]
 [-5.18229973e-02 -6.37579696e-02 -2.21610998e-01]
 [-9.88296441e-02 -2.41910939e-01  2.15109929e-01]
 [-2.05578801e-01 -2.64173321e-02  2.08994804e-02]
 [ 5.50560547e-02  4.27479737e-02 -2.16256573e-02]
 [-1.13941083e-01  1.86432104e-01 -8.75141100e-02]
 [-1.00368117e-01 -5.17015846e-02  9.94157524e-02]
 [ 4.50470017e-02  4.74936917e-02 -1.18045691e-02]
 [ 2.64938272e-02  8.87759927e-02 -1.20356360e-02]
 [ 1.57613442e-01 -1.23210576e-02 -1.57346851e-01]
 [ 4.14010034e-02 -2.97266364e-02 -4.09676204e-01]
 [-8.06813489e-02  3.09336531e-02 -2.71971993e-02]
 [-2.23972467e-02 -4.55414914e-02  2.55920143e-02]
 [ 3.18818463e-02 -8.21725418e-03  8.88004467e-02]
 [-2.58103131e-02  1.06321708e-01  7.25725419e-02]
 [ 3.81974672e-02 -1.60914992e-02  2.34941402e-02]
 [-3.01595135e-01 -7.90753197e-01 -1.32456389e-01]
 [ 9.77133627e-02 -9.31419407e-02 -1.57683374e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.25151208 -29.28467519 -29.2776944 ]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  8.31409947  -9.26062741 -83.52111278]
init_Out:  [2.49223638]
Stock Position:  8.314099471154409
Bond position:  [-828.91771073]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-5.69282852]
curr_Stock_Price:  99.0404481448387
curr_Factors:  [99.04044814 -0.61973277 -1.03344178]
mat_Sqrt:  [[18.96042258  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00573083  0.01295525  0.13924143]
Stock Position:  -0.0057308342756358
Bond Position:  [-5.12524413]


portfolio before change:  [-5.69330168]
curr_Stock_Price:  98.89940248171531
curr_Factors:  [98.89940248 -0.57334565 -1.04289438]
mat_Sqrt:  [[19.64579207  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00236246  0.0064504   0.21425274]
Stock Position:  -0.0023624556791878564
Bond Position:  [-5.45965623]


portfolio before change:  [-5.69914283]
curr_Stock_Price:  100.79406970115305
curr_Factors:  [100.7940697   -1.35260347  -1.07732056]
mat_Sqrt:  [[ 8.87426479  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01112265 -0.02016204 -0.63219449]
Stock Position:  -0.011122653976820326
Bond Position:  [-4.57804527]


portfolio before change:  [-5.70113661]
curr_Stock_Price:  100.87041154839811
curr_Factors:  [100.87041155  -1.28592102  -1.08035099]
mat_Sqrt:  [[ 9.46465773  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00646263 -0.07649896  0.61364875]
Stock Position:  -0.006462634885785407
Bond Position:  [-5.04924797]


portfolio before change:  [-5.71213038]
curr_Stock_Price:  102.37618969261044
curr_Factors:  [102.37618969  -1.14117515  -1.09536668]
mat_Sqrt:  [[10.93657117  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01846966 -0.00835389  0.0596204 ]
Stock Position:  -0.018469664890222646
Bond Position:  [-3.82127646]


portfolio before change:  [-5.70424051]
curr_Stock_Price:  101.89727996314078
curr_Factors:  [101.89727996  -1.26356428  -1.11737462]
mat_Sqrt:  [[ 9.42180177  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0054921   0.0135181  -0.06169198]
Stock Position:  0.005492100671159417
Bond Position:  [-6.26387063]


portfolio before change:  [-5.7086084]
curr_Stock_Price:  101.38714304118491
curr_Factors:  [101.38714304  -1.11856596  -1.10976997]
mat_Sqrt:  [[10.92015715  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01162906  0.05895501 -0.2496534 ]
Stock Position:  -0.01162906064754044
Bond Position:  [-4.52957116]


portfolio before change:  [-5.70690277]
curr_Stock_Price:  101.14308499887088
curr_Factors:  [101.143085    -0.98827866  -1.09027691]
mat_Sqrt:  [[12.65409183  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00643348 -0.01634948  0.28360547]
Stock Position:  -0.006433483479778263
Bond Position:  [-5.0562004]


portfolio before change:  [-5.7072667]
curr_Stock_Price:  101.00314823788273
curr_Factors:  [101.00314824  -1.30071056  -1.07037628]
mat_Sqrt:  [[ 9.43159147  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00465072  0.01501882 -0.03367515]
Stock Position:  0.004650719460321124
Bond Position:  [-6.177004]


portfolio before change:  [-5.7126902]
curr_Stock_Price:  100.16907093445448
curr_Factors:  [100.16907093  -1.04362003  -1.09421217]
mat_Sqrt:  [[11.8109524   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00222922  0.02807343 -0.03433432]
Stock Position:  0.002229223240046919
Bond Position:  [-5.93598942]


portfolio before change:  [-5.7129576]
curr_Stock_Price:  100.71490330087278
curr_Factors:  [100.7149033   -0.56525699  -1.11865092]
mat_Sqrt:  [[18.69742622  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00669488 -0.00389626 -0.44886677]
Stock Position:  0.006694879832621316
Bond Position:  [-6.38723177]


portfolio before change:  [-5.71925421]
curr_Stock_Price:  100.01293315910424
curr_Factors:  [100.01293316  -0.65919493  -1.10344944]
mat_Sqrt:  [[17.16127063  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00250514 -0.00940039 -1.16869218]
Stock Position:  -0.002505137352373006
Bond Position:  [-5.46870808]


portfolio before change:  [-5.71907426]
curr_Stock_Price:  99.39528128392305
curr_Factors:  [99.39528128 -1.00944586 -1.08066317]
mat_Sqrt:  [[12.29257728  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00695007  0.00978208 -0.07758604]
Stock Position:  -0.006950068202273474
Bond Position:  [-5.02827027]


portfolio before change:  [-5.72762832]
curr_Stock_Price:  100.4451760004536
curr_Factors:  [100.445176    -0.88778051  -1.09279252]
mat_Sqrt:  [[13.86044411  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00132385 -0.01440148  0.07300689]
Stock Position:  -0.001323851872305779
Bond Position:  [-5.59465379]


portfolio before change:  [-5.72862527]
curr_Stock_Price:  100.14159764647425
curr_Factors:  [100.14159765  -1.10573648  -1.07516298]
mat_Sqrt:  [[11.30998198  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00440284 -0.00259852  0.25332296]
Stock Position:  0.004402835748228655
Bond Position:  [-6.16953227]


portfolio before change:  [-5.73254483]
curr_Stock_Price:  99.60172090438942
curr_Factors:  [99.6017209  -0.86249719 -1.04988506]
mat_Sqrt:  [[14.71396722  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00056078  0.03362188  0.20702926]
Stock Position:  -0.000560779440545705
Bond Position:  [-5.67669024]


portfolio before change:  [-5.73309682]
curr_Stock_Price:  98.05500569980377
curr_Factors:  [98.0550057  -0.78314646 -1.02467542]
mat_Sqrt:  [[16.0820979   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00264752 -0.00508858  0.06702224]
Stock Position:  0.0026475219873545552
Bond Position:  [-5.9926996]


portfolio before change:  [-5.73370751]
curr_Stock_Price:  98.39028800071729
curr_Factors:  [98.390288   -1.03208204 -1.03951074]
mat_Sqrt:  [[12.395696    0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02815895 -0.25005812 -0.37786121]
Stock Position:  -0.02815895470364082
Bond Position:  [-2.96313985]


portfolio before change:  [-5.74591779]
curr_Stock_Price:  98.7975970904896
curr_Factors:  [98.79759709 -0.71785151 -1.00722483]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-5.74591779]
Stock Price:  95.61992228955246
PL:  [-5.74591779]
Settle:  Tensor("sub_236:0", shape=(), dtype=float64)
PL:  Tensor("sub_237:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  119
output_Z_Vals[:, i, :]:  [[ 1.19251512e+02 -2.92846752e+01 -2.92776944e+01]
 [ 7.96181442e-02 -3.30094541e-02  1.18745363e-02]
 [-1.20846185e-01 -8.80968178e-03  3.47929082e-02]
 [-2.41414181e-02  4.10382135e-02  6.85680476e-02]
 [-9.66237547e-02 -2.23477820e-01  1.96413052e-01]
 [-2.80951868e-01  3.43887309e-02  1.53295141e-02]
 [ 5.16600127e-02  9.92497585e-02 -4.37837887e-02]
 [-1.73886291e-01  2.93185065e-01 -7.50463064e-02]
 [-8.37006869e-03 -4.84405441e-03 -1.46591690e-02]
 [-1.03500597e-02  2.78760478e-03 -2.20598399e-02]
 [ 1.98003196e-01 -7.53313529e-02 -6.85582193e-02]
 [-1.44536265e-01  3.65700856e-02  6.20118324e-02]
 [ 5.38237410e-02 -3.34620667e-03 -2.73562496e-02]
 [-8.45720117e-02  2.97281712e-02 -3.59999752e-02]
 [-1.54416104e-01  1.17372334e-01  2.89810535e-01]
 [-1.36184788e-01 -2.67663232e-01  2.12543673e-01]
 [-2.96123227e-02 -1.11197935e-02  2.38277246e-01]
 [-1.47858387e-01  2.40663391e-01 -8.50388277e-02]
 [-2.78009233e-01 -9.53299991e-01 -7.58233782e-02]
 [ 6.93276932e-02 -1.19062246e-03 -4.71601136e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.25151208 -29.28467519 -29.2776944 ]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  8.31409947  -9.26062741 -83.52111278]
init_Out:  [2.49223638]
Stock Position:  8.314099471154409
Bond position:  [-828.91771073]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [7.25133186]
curr_Stock_Price:  100.59734079752698
curr_Factors:  [100.5973408   -0.83524574  -1.02003566]
mat_Sqrt:  [[15.73432184  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00516004 -0.01043851  0.03387475]
Stock Position:  0.0051600395716915725
Bond Position:  [6.7322456]


portfolio before change:  [7.24030972]
curr_Stock_Price:  98.13507048879175
curr_Factors:  [98.13507049 -0.85568074 -1.0294838 ]
mat_Sqrt:  [[14.89730405  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00765048 -0.00278587  0.09925448]
Stock Position:  -0.007650483370231496
Bond Position:  [7.99109044]


portfolio before change:  [7.23844328]
curr_Stock_Price:  98.64019760974084
curr_Factors:  [98.64019761 -0.91654304 -1.01729721]
mat_Sqrt:  [[14.26256979  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00063701  0.01297742  0.19560555]
Stock Position:  -0.0006370115625614587
Bond Position:  [7.30127822]


portfolio before change:  [7.2392773]
curr_Stock_Price:  100.19672594823311
curr_Factors:  [100.19672595  -0.74054469  -1.03622629]
mat_Sqrt:  [[16.95163915  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00367524 -0.07066989  0.56031177]
Stock Position:  -0.0036752363772209317
Bond Position:  [7.60752395]


portfolio before change:  [7.23074885]
curr_Stock_Price:  103.0347916192673
curr_Factors:  [103.03479162  -1.02621427  -1.05530921]
mat_Sqrt:  [[12.8525628   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02154705  0.01087467  0.04373084]
Stock Position:  -0.021547051382397996
Bond Position:  [9.4508448]


portfolio before change:  [7.19836539]
curr_Stock_Price:  104.64737757260677
curr_Factors:  [104.64737757  -1.64226726  -1.08877811]
mat_Sqrt:  [[ 6.81789669  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00664212  0.03138553 -0.12490296]
Stock Position:  0.006642122054757688
Bond Position:  [6.50328473]


portfolio before change:  [7.20123945]
curr_Stock_Price:  104.83527470843767
curr_Factors:  [104.83527471  -1.82372609  -1.07697566]
mat_Sqrt:  [[ 5.76432788  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.03151019  0.09271326 -0.21408622]
Stock Position:  -0.031510186777298714
Bond Position:  [10.50461853]


portfolio before change:  [7.21299496]
curr_Stock_Price:  104.54555787599652
curr_Factors:  [104.54555788  -1.89852744  -1.09234315]
mat_Sqrt:  [[ 5.2527531   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00218694 -0.00153182 -0.04181853]
Stock Position:  -0.002186935452085921
Bond Position:  [7.44162935]


portfolio before change:  [7.2143338]
curr_Stock_Price:  104.78415801373158
curr_Factors:  [104.78415801  -1.50872867  -1.11191126]
mat_Sqrt:  [[ 7.6237065   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00193882  0.00088152 -0.06293058]
Stock Position:  -0.0019388246403458816
Bond Position:  [7.41749191]


portfolio before change:  [7.21471941]
curr_Stock_Price:  105.54183004094929
curr_Factors:  [105.54183004  -1.53156496  -1.11869759]
mat_Sqrt:  [[ 7.45470081  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.02442268 -0.02382187 -0.19557752]
Stock Position:  0.024422678437466695
Bond Position:  [4.63710523]


portfolio before change:  [7.21464133]
curr_Stock_Price:  105.49115992134186
curr_Factors:  [105.49115992  -1.83526078  -1.08925363]
mat_Sqrt:  [[ 5.66390026  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02311727  0.01156448  0.1769025 ]
Stock Position:  -0.023117270998896006
Bond Position:  [9.65330906]


portfolio before change:  [7.20571591]
curr_Stock_Price:  105.98166131004872
curr_Factors:  [105.98166131  -1.74757363  -1.11016698]
mat_Sqrt:  [[ 6.0831671   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00791582 -0.00105816 -0.07803977]
Stock Position:  0.00791582253801723
Bond Position:  [6.36678388]


portfolio before change:  [7.21024894]
curr_Stock_Price:  106.3532134596124
curr_Factors:  [106.35321346  -1.90432221  -1.14483932]
mat_Sqrt:  [[ 5.04099872  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01808231  0.00940087 -0.10269791]
Stock Position:  -0.018082309235978138
Bond Position:  [9.13336064]


portfolio before change:  [7.21960171]
curr_Stock_Price:  105.96227117121516
curr_Factors:  [105.96227117  -1.93919629  -1.15271454]
mat_Sqrt:  [[ 4.81228617  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01916516  0.03711639  0.82674879]
Stock Position:  -0.019165160234245856
Bond Position:  [9.25038561]


portfolio before change:  [7.22579315]
curr_Stock_Price:  105.75989569092089
curr_Factors:  [105.75989569  -1.99105497  -1.10829529]
mat_Sqrt:  [[ 4.76749561  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02091466 -0.08464255  0.60632794]
Stock Position:  -0.020914655338853526
Bond Position:  [9.43772492]


portfolio before change:  [7.22553156]
curr_Stock_Price:  105.8852299325661
curr_Factors:  [105.88522993  -1.79155519  -1.0876258 ]
mat_Sqrt:  [[ 5.94871236  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00315004 -0.00351639  0.67973866]
Stock Position:  0.0031500438342582583
Bond Position:  [6.89198844]


portfolio before change:  [7.22747043]
curr_Stock_Price:  105.95369405830995
curr_Factors:  [105.95369406  -1.13006109  -1.11083548]
mat_Sqrt:  [[11.26956337  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01410906  0.07610445 -0.24259211]
Stock Position:  -0.014109061496105715
Bond Position:  [8.72237762]


portfolio before change:  [7.20675501]
curr_Stock_Price:  107.5765015687735
curr_Factors:  [107.57650157  -1.53480017  -1.12269516]
mat_Sqrt:  [[ 7.5436557   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.04216798 -0.30145993 -0.21630299]
Stock Position:  -0.04216797907443735
Bond Position:  [11.74303868]


portfolio before change:  [7.22203594]
curr_Stock_Price:  107.28374847111904
curr_Factors:  [107.28374847  -1.42086508  -1.1657664 ]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [7.22203594]
Stock Price:  106.57781077831467
PL:  [0.64422516]
Settle:  Tensor("sub_238:0", shape=(), dtype=float64)
PL:  Tensor("sub_239:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  120
output_Z_Vals[:, i, :]:  [[ 1.19251512e+02 -2.92846752e+01 -2.92776944e+01]
 [-3.33023538e-01  1.01328840e-01  1.98564319e-01]
 [-1.17875190e-01  8.04323959e-03  1.20387906e-01]
 [-2.00457990e-02  3.43160808e-02  5.29999016e-02]
 [-9.36819055e-02 -1.98894784e-01  1.71478260e-01]
 [ 1.59951487e-02 -6.95370585e-02  9.51549591e-04]
 [ 5.57057912e-02  3.19379579e-02 -1.73863266e-02]
 [-9.96649058e-02  1.74962883e-01 -1.04125694e-01]
 [-9.16323970e-04 -6.08538364e-03 -3.84659148e-03]
 [ 5.08612591e-02  3.59342652e-02 -7.32004000e-03]
 [ 8.14290267e-02  4.83188845e-02 -1.58411571e-02]
 [ 1.37595652e-01 -1.17340146e-02 -1.48701768e-01]
 [ 4.77574819e-02 -8.46250434e-03 -1.74502683e-01]
 [-8.45720117e-02  2.97281712e-02 -3.59999752e-02]
 [-1.12434823e-01  5.82069648e-02  2.29265214e-01]
 [-7.54893778e-02 -1.55303511e-01  1.61106269e-01]
 [-2.80324220e-02 -1.96096759e-02  2.42437293e-01]
 [-1.22419077e-01  2.05428082e-01 -8.47388869e-02]
 [-3.29898046e-01 -9.46887917e-01 -1.44359629e-01]
 [ 6.46974006e-02 -1.72680460e-02 -5.96250531e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.25151208 -29.28467519 -29.2776944 ]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  8.31409947  -9.26062741 -83.52111278]
init_Out:  [2.49223638]
Stock Position:  8.314099471154409
Bond position:  [-828.91771073]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-7.18220784]
curr_Stock_Price:  98.86130916204404
curr_Factors:  [98.86130916 -1.18582878 -0.97907116]
mat_Sqrt:  [[11.34546401  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0255499   0.03204299  0.56644873]
Stock Position:  -0.025549899635383743
Bond Position:  [-4.65631132]


portfolio before change:  [-7.19684049]
curr_Stock_Price:  99.38845129566887
curr_Factors:  [99.3884513  -1.18682842 -0.95427813]
mat_Sqrt:  [[11.68060034  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00796992  0.0025435   0.34343319]
Stock Position:  -0.00796991877593247
Bond Position:  [-6.40472261]


portfolio before change:  [-7.19533677]
curr_Stock_Price:  98.99884807005516
curr_Factors:  [98.99884807 -1.12526881 -0.943448  ]
mat_Sqrt:  [[12.50828731  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00066685  0.0108517   0.15119397]
Stock Position:  -0.0006668540454487694
Bond Position:  [-7.12931899]


portfolio before change:  [-7.19733267]
curr_Stock_Price:  99.31877711464118
curr_Factors:  [99.31877711 -1.29591356 -0.99071064]
mat_Sqrt:  [[10.09167123  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00632348 -0.06289605  0.48917975]
Stock Position:  -0.006323481223167829
Bond Position:  [-6.56929225]


portfolio before change:  [-7.19882156]
curr_Stock_Price:  99.29448104575178
curr_Factors:  [99.29448105 -1.37825562 -0.99976764]
mat_Sqrt:  [[ 9.20794528  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00156321 -0.02198955  0.00271451]
Stock Position:  0.0015632090991010024
Bond Position:  [-7.3540396]


portfolio before change:  [-7.19895642]
curr_Stock_Price:  100.38447036797888
curr_Factors:  [100.38447037  -1.64393807  -1.01096744]
mat_Sqrt:  [[ 7.05757852  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00750703  0.01009967 -0.04959835]
Stock Position:  0.007507030418066955
Bond Position:  [-7.95254569]


portfolio before change:  [-7.19585683]
curr_Stock_Price:  101.06223089169168
curr_Factors:  [101.06223089  -1.50254783  -0.99703347]
mat_Sqrt:  [[ 8.29916717  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01402574  0.05532812 -0.29704162]
Stock Position:  -0.014025738914247228
Bond Position:  [-5.77838437]


portfolio before change:  [-7.21448616]
curr_Stock_Price:  102.28744617744464
curr_Factors:  [102.28744618  -1.41292387  -1.02177348]
mat_Sqrt:  [[ 8.96286205  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00020737 -0.00192437 -0.01097325]
Stock Position:  -0.000207370155773409
Bond Position:  [-7.1932748]


portfolio before change:  [-7.21636022]
curr_Stock_Price:  102.65158155469214
curr_Factors:  [102.65158155  -1.37760803  -1.05061193]
mat_Sqrt:  [[ 9.05322082  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00555547  0.01136341 -0.02088204]
Stock Position:  0.005555468260533557
Bond Position:  [-7.78663782]


portfolio before change:  [-7.22180297]
curr_Stock_Price:  102.02231816852526
curr_Factors:  [102.02231817  -1.21543531  -1.07922367]
mat_Sqrt:  [[10.28341716  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00772536  0.01527977 -0.04519041]
Stock Position:  0.007725355395307227
Bond Position:  [-8.00996164]


portfolio before change:  [-7.22172854]
curr_Stock_Price:  102.29119479720589
curr_Factors:  [102.2911948   -1.24775244  -1.05150355]
mat_Sqrt:  [[10.26322994  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01041963 -0.00371062 -0.42420475]
Stock Position:  0.010419630066625801
Bond Position:  [-8.28756495]


portfolio before change:  [-7.21396324]
curr_Stock_Price:  103.23532164174911
curr_Factors:  [103.23532164  -1.21015035  -1.10703297]
mat_Sqrt:  [[10.17392156  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0011715  -0.00267608 -0.49780758]
Stock Position:  0.0011715020584480119
Bond Position:  [-7.33490363]


portfolio before change:  [-7.21422276]
curr_Stock_Price:  104.57927011222758
curr_Factors:  [104.57927011  -1.29121704  -1.13243203]
mat_Sqrt:  [[ 9.26548576  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0098379   0.00940087 -0.10269791]
Stock Position:  -0.009837897345035897
Bond Position:  [-6.18538264]


portfolio before change:  [-7.20920461]
curr_Stock_Price:  103.91198418969832
curr_Factors:  [103.91198419  -1.17217074  -1.10169579]
mat_Sqrt:  [[10.69394522  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00599717  0.01840666  0.65402984]
Stock Position:  -0.005997165553852963
Bond Position:  [-6.58602724]


portfolio before change:  [-7.21041397]
curr_Stock_Price:  103.83905795025072
curr_Factors:  [103.83905795  -1.19439048  -1.09701419]
mat_Sqrt:  [[10.50065362  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00443912 -0.04911128  0.45959134]
Stock Position:  -0.00443911583311901
Bond Position:  [-6.74946036]


portfolio before change:  [-7.21980018]
curr_Stock_Price:  105.5733309013195
curr_Factors:  [105.5733309   -1.33446914  -1.11113305]
mat_Sqrt:  [[ 9.15045494  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00228935 -0.00620112  0.69160612]
Stock Position:  0.0022893466787633015
Bond Position:  [-7.46149414]


portfolio before change:  [-7.22220816]
curr_Stock_Price:  105.33641953287879
curr_Factors:  [105.33641953  -1.20962002  -1.12661047]
mat_Sqrt:  [[10.1851292   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01319691  0.06496206 -0.24173646]
Stock Position:  -0.01319690669598731
Bond Position:  [-5.83209326]


portfolio before change:  [-7.20056145]
curr_Stock_Price:  103.58563632512633
curr_Factors:  [103.58563633  -1.0416      -1.12406215]
mat_Sqrt:  [[11.87857707  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.03231144 -0.29943225 -0.41181784]
Stock Position:  -0.032311435159523075
Bond Position:  [-3.85356087]


portfolio before change:  [-7.21484445]
curr_Stock_Price:  103.99785847863795
curr_Factors:  [103.99785848  -1.01932361  -1.0967145 ]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-7.21484445]
Stock Price:  103.86760054218611
PL:  [-11.08244499]
Settle:  Tensor("sub_240:0", shape=(), dtype=float64)
PL:  Tensor("sub_241:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  121
output_Z_Vals[:, i, :]:  [[ 1.19251512e+02 -2.92846752e+01 -2.92776944e+01]
 [ 1.80350533e-02 -2.73397467e-02 -5.27663009e-02]
 [-4.45523522e-01 -7.49955816e-02  3.06218323e-01]
 [-5.57446260e-02 -8.05029936e-02 -2.68924578e-01]
 [-9.84077467e-02 -2.38385430e-01  2.11533973e-01]
 [-8.24839524e-02 -1.16517565e-01  2.28157498e-02]
 [ 5.37339441e-02  6.47446424e-02 -3.02520233e-02]
 [-1.48216916e-01  2.20616593e-01 -6.14074796e-02]
 [-1.07175223e-01 -5.35490849e-02  1.03380033e-01]
 [ 4.93252479e-02  4.13970534e-02 -9.22352533e-03]
 [ 1.05124309e-01  2.53885604e-02 -2.51615140e-02]
 [ 1.27576680e-01 -1.14401976e-02 -1.44374875e-01]
 [ 3.40901908e-02 -1.61475042e-02 -3.09252679e-01]
 [-7.02523723e-02  2.11283416e-02 -3.23103767e-02]
 [-9.50351525e-02  2.82937727e-02  1.80185789e-01]
 [ 1.83862685e-02 -9.78173062e-03  9.28119853e-02]
 [-2.18314079e-02  3.10104043e-02  1.51095836e-01]
 [ 3.47613551e-02 -1.20192777e-02  1.44885123e-02]
 [-4.06368649e-01 -1.02423415e+00 -2.63165125e-01]
 [ 1.21138988e-01 -2.00817460e-01 -3.66987984e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.25151208 -29.28467519 -29.2776944 ]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  8.31409947  -9.26062741 -83.52111278]
init_Out:  [2.49223638]
Stock Position:  8.314099471154409
Bond position:  [-828.91771073]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [6.26897829]
curr_Stock_Price:  100.47918565997367
curr_Factors:  [100.47918566  -0.98346513  -0.98988249]
mat_Sqrt:  [[13.96568115  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0004696  -0.00864559 -0.15052757]
Stock Position:  0.00046959886444392486
Bond Position:  [6.22179338]


portfolio before change:  [6.27107741]
curr_Stock_Price:  101.63649366399237
curr_Factors:  [101.63649366  -0.97032871  -1.03990476]
mat_Sqrt:  [[13.61495997  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02827429 -0.02371569  0.87355564]
Stock Position:  -0.02827429145154242
Bond Position:  [9.14477725]


portfolio before change:  [6.29285765]
curr_Stock_Price:  100.94704172269458
curr_Factors:  [100.94704172  -1.09243273  -1.01344741]
mat_Sqrt:  [[12.28913942  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0091721  -0.02545728 -0.76716697]
Stock Position:  -0.009172099039830163
Bond Position:  [7.21875392]


portfolio before change:  [6.29937237]
curr_Stock_Price:  100.43354934174872
curr_Factors:  [100.43354934  -0.93526272  -1.03863903]
mat_Sqrt:  [[13.95160508  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00439975 -0.07538409  0.60344755]
Stock Position:  -0.004399754736364345
Bond Position:  [6.74125535]


portfolio before change:  [6.29794362]
curr_Stock_Price:  101.14137746064871
curr_Factors:  [101.14137746  -1.05810083  -1.07285862]
mat_Sqrt:  [[12.00784118  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00673187 -0.03684609  0.06508698]
Stock Position:  -0.006731865981519082
Bond Position:  [6.97881382]


portfolio before change:  [6.29139212]
curr_Stock_Price:  102.37378893480498
curr_Factors:  [102.37378893  -0.81207732  -1.089911  ]
mat_Sqrt:  [[15.28149146  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00322158  0.02047405 -0.0863006 ]
Stock Position:  0.003221575281273762
Bond Position:  [5.96158725]


portfolio before change:  [6.2942878]
curr_Stock_Price:  102.80994311839864
curr_Factors:  [102.80994312  -0.75433607  -1.09520953]
mat_Sqrt:  [[16.17289152  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00958736  0.06976509 -0.17517845]
Stock Position:  -0.009587362238347972
Bond Position:  [7.27996397]


portfolio before change:  [6.31062149]
curr_Stock_Price:  101.29613025179968
curr_Factors:  [101.29613025  -0.8673292   -1.07863802]
mat_Sqrt:  [[14.4700499   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0060439  -0.01693371  0.29491446]
Stock Position:  -0.0060438971659686975
Bond Position:  [6.92284489]


portfolio before change:  [6.30655647]
curr_Stock_Price:  102.25510606833177
curr_Factors:  [102.25510607  -0.85979638  -1.0564783 ]
mat_Sqrt:  [[15.04726204  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00322393  0.0130909  -0.02631215]
Stock Position:  0.0032239334237564314
Bond Position:  [5.97689282]


portfolio before change:  [6.30914472]
curr_Stock_Price:  102.59439395842998
curr_Factors:  [102.59439396  -0.43928571  -1.06086606]
mat_Sqrt:  [[22.88842943  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00439715  0.00802857 -0.0717788 ]
Stock Position:  0.004397146012147366
Bond Position:  [5.85802219]


portfolio before change:  [6.31305646]
curr_Stock_Price:  103.15090328503935
curr_Factors:  [103.15090329  -0.60164703  -1.01495225]
mat_Sqrt:  [[20.48296814  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00477523 -0.00361771 -0.41186133]
Stock Position:  0.004775230666534239
Bond Position:  [5.82048711]


portfolio before change:  [6.31322633]
curr_Stock_Price:  102.8817149819999
curr_Factors:  [102.88171498  -0.44633454  -1.00016283]
mat_Sqrt:  [[24.21767054  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00121616 -0.00510629 -0.88221181]
Stock Position:  -0.001216164651887631
Bond Position:  [6.43834744]


portfolio before change:  [6.31467854]
curr_Stock_Price:  103.01128153475419
curr_Factors:  [ 1.03011282e+02 -5.82503285e-02 -1.04185458e+00]
mat_Sqrt:  [[34.28587975  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00222547  0.00668137 -0.09217251]
Stock Position:  -0.002225469185590406
Bond Position:  [6.54392698]


portfolio before change:  [6.31711922]
curr_Stock_Price:  102.64978730935303
curr_Factors:  [102.64978731   0.16254803  -1.03971397]
mat_Sqrt:  [[42.69821575  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00134723  0.00894728  0.5140199 ]
Stock Position:  -0.0013472305371465586
Bond Position:  [6.45541215]


portfolio before change:  [6.32058262]
curr_Stock_Price:  101.277089148372
curr_Factors:  [101.27708915   0.17862153  -1.05626786]
mat_Sqrt:  [[42.10699529  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00088059 -0.00309325  0.26476676]
Stock Position:  0.0008805869940377528
Bond Position:  [6.23139933]


portfolio before change:  [6.32273435]
curr_Stock_Price:  101.95128303379596
curr_Factors:  [101.95128303  -0.15221058  -1.08690646]
mat_Sqrt:  [[29.52915395  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [3.32267753e-04 9.80635086e-03 4.31034363e-01]
Stock Position:  0.0003322677533375795
Bond Position:  [6.28885923]


portfolio before change:  [6.3226578]
curr_Stock_Price:  96.98853653654359
curr_Factors:  [96.98853654 -0.23081717 -1.11658677]
mat_Sqrt:  [[25.20869196  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00148395 -0.00380083  0.04133169]
Stock Position:  0.0014839514052795329
Bond Position:  [6.17873153]


portfolio before change:  [6.32348582]
curr_Stock_Price:  96.50546308126285
curr_Factors:  [96.50546308 -0.14628598 -1.1539623 ]
mat_Sqrt:  [[26.29427777  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01850336 -0.32389128 -0.75073685]
Stock Position:  -0.01850336492937561
Bond Position:  [8.10916162]


portfolio before change:  [6.39647676]
curr_Stock_Price:  92.67030120003326
curr_Factors:  [92.6703012   0.11757259 -1.15205657]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [6.39647676]
Stock Price:  87.98034920368391
PL:  [6.39647676]
Settle:  Tensor("sub_242:0", shape=(), dtype=float64)
PL:  Tensor("sub_243:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  122
output_Z_Vals[:, i, :]:  [[ 1.19251512e+02 -2.92846752e+01 -2.92776944e+01]
 [-1.23491595e-01  1.35395263e-02 -1.18392355e-01]
 [-3.83605930e-01 -6.15967222e-02  2.52960913e-01]
 [-5.73264722e-02 -1.25390164e-01 -3.99841717e-01]
 [-9.88296441e-02 -2.41910939e-01  2.15109929e-01]
 [-1.93692850e-01 -1.68879609e-02  6.86430675e-03]
 [ 5.15915854e-02  1.00388220e-01 -4.42302555e-02]
 [-9.96930669e-02  1.54957878e-01 -6.61893026e-02]
 [-3.30568745e-01 -1.42777279e-01  3.02301240e-01]
 [ 6.83501496e-04 -3.01369175e-02  2.23738120e-02]
 [-2.56407368e-02  8.83069489e-02  1.01350524e-02]
 [-7.54481840e-02 -9.31295312e-03 -1.29408709e-01]
 [-2.28364702e-02 -3.25657912e-01 -3.50235745e-01]
 [ 8.11050576e-02 -4.90022722e-02  2.43772710e-03]
 [ 1.11348156e-02 -5.79141975e-02 -1.09473076e-01]
 [ 1.59784148e-01  1.78406899e-02 -3.88252791e-02]
 [-2.35647895e-02  1.03259148e-01  6.82888801e-02]
 [ 4.39701971e-02 -2.39768708e-02  4.67133209e-02]
 [-2.35411429e-01 -6.56472863e-01 -8.09383725e-02]
 [ 8.99144461e-02 -7.52192712e-02 -1.34520376e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.25151208 -29.28467519 -29.2776944 ]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  8.31409947  -9.26062741 -83.52111278]
init_Out:  [2.49223638]
Stock Position:  8.314099471154409
Bond position:  [-828.91771073]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [1.60622291]
curr_Stock_Price:  99.91836059388056
curr_Factors:  [99.91836059 -0.9208156  -0.98312179]
mat_Sqrt:  [[14.88592404  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00989584  0.00428157 -0.33774043]
Stock Position:  -0.009895841485713512
Bond Position:  [2.59499917]


portfolio before change:  [1.59031023]
curr_Stock_Price:  101.59194316319076
curr_Factors:  [101.59194316  -0.72713305  -0.97607297]
mat_Sqrt:  [[18.49976843  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01803055 -0.01947859  0.72162707]
Stock Position:  -0.018030545701995505
Bond Position:  [3.42206841]


portfolio before change:  [1.59358993]
curr_Stock_Price:  101.45750034870441
curr_Factors:  [101.45750035  -0.54941826  -0.97848733]
mat_Sqrt:  [[22.01522818  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00645832 -0.03965185 -1.14063712]
Stock Position:  -0.0064583196574267395
Bond Position:  [2.2488349]


portfolio before change:  [1.59418623]
curr_Stock_Price:  101.45223341507862
curr_Factors:  [101.45223342  -0.69839771  -0.96360747]
mat_Sqrt:  [[19.25138299  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00317726 -0.07649896  0.61364875]
Stock Position:  -0.003177258864622132
Bond Position:  [1.91652624]


portfolio before change:  [1.5932264]
curr_Stock_Price:  101.90514455577157
curr_Factors:  [101.90514456  -0.61407476  -0.98175323]
mat_Sqrt:  [[20.66030929  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0093284  -0.00534044  0.01958196]
Stock Position:  -0.009328404589897922
Bond Position:  [2.54383882]


portfolio before change:  [1.57536833]
curr_Stock_Price:  103.88770369061206
curr_Factors:  [103.88770369  -0.5877377   -1.00430946]
mat_Sqrt:  [[21.14203807  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0021358   0.03174554 -0.12617661]
Stock Position:  0.002135798585927205
Bond Position:  [1.35348512]


portfolio before change:  [1.56773204]
curr_Stock_Price:  100.15387623334567
curr_Factors:  [100.15387623  -0.29152535  -0.97467398]
mat_Sqrt:  [[28.233478    0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00386785  0.04900198 -0.18881966]
Stock Position:  -0.003867851724065339
Bond Position:  [1.95511238]


portfolio before change:  [1.57266478]
curr_Stock_Price:  99.00494275382802
curr_Factors:  [99.00494275 -0.11095777 -0.99009883]
mat_Sqrt:  [[32.92107968  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00827884 -0.04515014  0.86238129]
Stock Position:  -0.008278837112800376
Bond Position:  [2.39231058]


portfolio before change:  [1.60481092]
curr_Stock_Price:  95.19426407091422
curr_Factors:  [95.19426407 -0.13481231 -0.95986648]
mat_Sqrt:  [[31.85648271  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00014039 -0.00953013  0.06382626]
Stock Position:  0.0001403923004612473
Bond Position:  [1.59144638]


portfolio before change:  [1.60511351]
curr_Stock_Price:  94.5152902267314
curr_Factors:  [94.51529023 -0.13515441 -0.97422558]
mat_Sqrt:  [[31.1676792   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00068314  0.02792511  0.02891248]
Stock Position:  -0.0006831388421903837
Bond Position:  [1.66968058]


portfolio before change:  [1.60504157]
curr_Stock_Price:  95.2317112438108
curr_Factors:  [95.23171124 -0.5830252  -0.96469457]
mat_Sqrt:  [[20.25887992  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00503997 -0.00294501 -0.36916703]
Stock Position:  -0.0050399669620703955
Bond Position:  [2.08500625]


portfolio before change:  [1.60442438]
curr_Stock_Price:  95.45760733745217
curr_Factors:  [95.45760734 -0.48985273 -0.92882542]
mat_Sqrt:  [[23.10396157  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0044467  -0.10298207 -0.99912509]
Stock Position:  -0.004446704650710096
Bond Position:  [2.02889616]


portfolio before change:  [1.61083292]
curr_Stock_Price:  94.13049858393437
curr_Factors:  [94.13049858 -0.70914442 -0.91337242]
mat_Sqrt:  [[18.58147765  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00432352 -0.01549588  0.00695416]
Stock Position:  0.004323521782041771
Bond Position:  [1.20385766]


portfolio before change:  [1.61824371]
curr_Stock_Price:  95.77494041777885
curr_Factors:  [95.77494042 -0.80605598 -0.95907662]
mat_Sqrt:  [[16.39323051  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00077511 -0.01831408 -0.31229621]
Stock Position:  -0.0007751138894035047
Bond Position:  [1.69248019]


portfolio before change:  [1.61748965]
curr_Stock_Price:  97.29372340227917
curr_Factors:  [97.2937234  -0.72672618 -0.97776714]
mat_Sqrt:  [[17.69427533  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00860841  0.00564172 -0.11075771]
Stock Position:  0.008608412232109947
Bond Position:  [0.77994517]


portfolio before change:  [1.62162453]
curr_Stock_Price:  97.75140039417212
curr_Factors:  [97.75140039 -0.92747855 -0.95361087]
mat_Sqrt:  [[14.89965563  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00046707  0.03265341  0.19480917]
Stock Position:  -0.00046707391607449635
Bond Position:  [1.66728166]


portfolio before change:  [1.62220874]
curr_Stock_Price:  97.39314041923099
curr_Factors:  [97.39314042 -0.97793257 -0.93366659]
mat_Sqrt:  [[14.39896931  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00367293 -0.00758215  0.1332601 ]
Stock Position:  0.0036729318981906954
Bond Position:  [1.26449037]


portfolio before change:  [1.62420894]
curr_Stock_Price:  97.85163903006557
curr_Factors:  [97.85163903 -1.39003326 -0.89483318]
mat_Sqrt:  [[ 9.96008897  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02699604 -0.20759495 -0.23089465]
Stock Position:  -0.02699604009401584
Bond Position:  [4.26581571]


portfolio before change:  [1.61739601]
curr_Stock_Price:  98.14351547688943
curr_Factors:  [98.14351548 -1.74750144 -0.89188034]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [1.61739601]
Stock Price:  97.3138231387165
PL:  [1.61739601]
Settle:  Tensor("sub_244:0", shape=(), dtype=float64)
PL:  Tensor("sub_245:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  123
output_Z_Vals[:, i, :]:  [[ 1.19251512e+02 -2.92846752e+01 -2.92776944e+01]
 [-1.35551920e-01  2.60353181e-02 -4.78482318e-02]
 [-1.76608021e-01 -7.90675489e-03  1.45277022e-01]
 [-4.39539320e-02 -2.99746626e-02 -1.26005092e-01]
 [-9.88296441e-02 -2.41910939e-01  2.15109929e-01]
 [ 2.45543102e-02 -2.11368420e-01  3.97032843e-02]
 [ 5.56071550e-02  3.35790210e-02 -1.80298973e-02]
 [-9.21421539e-02  1.64104914e-01 -1.03546120e-01]
 [-4.12564751e-02 -2.53033886e-02  3.95830914e-02]
 [ 4.50470017e-02  4.74936917e-02 -1.18045691e-02]
 [ 2.52718979e-02  8.93815104e-02 -1.20145767e-02]
 [ 4.84282467e-02 -9.11908551e-03 -1.10193041e-01]
 [ 5.06841965e-02 -1.75933759e-02 -2.92290812e-01]
 [-8.19419475e-02  3.05430696e-02 -3.00493527e-02]
 [-3.12428001e-02 -4.04205688e-02  3.54620071e-02]
 [-1.16867352e-02 -4.48996968e-02  1.08803738e-01]
 [-2.56190584e-02  8.14241892e-02  1.02565623e-01]
 [ 2.80853174e-02 -2.74020741e-03 -1.36023021e-02]
 [-3.63689183e-01 -9.42724480e-01 -2.05554206e-01]
 [ 1.10393828e-01 -1.21032762e-01 -1.94118038e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.25151208 -29.28467519 -29.2776944 ]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  8.31409947  -9.26062741 -83.52111278]
init_Out:  [2.49223638]
Stock Position:  8.314099471154409
Bond position:  [-828.91771073]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [0.51366914]
curr_Stock_Price:  99.7869508395549
curr_Factors:  [99.78695084 -1.39934103 -0.99987241]
mat_Sqrt:  [[ 9.05959106  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01596614  0.00823309 -0.13649769]
Stock Position:  -0.015966136771313304
Bond Position:  [2.10688124]


portfolio before change:  [0.51848347]
curr_Stock_Price:  99.51841099172967
curr_Factors:  [99.51841099 -1.27680541 -1.03963471]
mat_Sqrt:  [[ 9.81490888  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01499327 -0.00250034  0.41443491]
Stock Position:  -0.014993274609204363
Bond Position:  [2.01059033]


portfolio before change:  [0.50791712]
curr_Stock_Price:  100.25667950353497
curr_Factors:  [100.2566795   -1.13871599  -1.06372412]
mat_Sqrt:  [[11.08168321  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00635721 -0.00947882 -0.35945745]
Stock Position:  -0.006357207195874883
Bond Position:  [1.1452696]


portfolio before change:  [0.50709377]
curr_Stock_Price:  100.43123681758905
curr_Factors:  [100.43123682  -1.67922663  -1.06927991]
mat_Sqrt:  [[ 6.4299499   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00951277 -0.07649896  0.61364875]
Stock Position:  -0.009512768872546463
Bond Position:  [1.46247292]


portfolio before change:  [0.50727436]
curr_Stock_Price:  100.45069245853061
curr_Factors:  [100.45069246  -1.53920483  -1.05568583]
mat_Sqrt:  [[ 7.49904988  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00362729 -0.06684056  0.11326242]
Stock Position:  0.003627286181220047
Bond Position:  [0.14291095]


portfolio before change:  [0.50732167]
curr_Stock_Price:  100.4538846173869
curr_Factors:  [100.45388462  -1.18690128  -1.02141924]
mat_Sqrt:  [[11.03837954  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00478275  0.01061862 -0.05143428]
Stock Position:  0.0047827513118750865
Bond Position:  [0.02687572]


portfolio before change:  [0.50807164]
curr_Stock_Price:  100.60928627418788
curr_Factors:  [100.60928627  -1.38504089  -0.98647677]
mat_Sqrt:  [[ 9.39076632  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01161154  0.05189453 -0.29538826]
Stock Position:  -0.01161153868494516
Bond Position:  [1.67630026]


portfolio before change:  [0.5024866]
curr_Stock_Price:  101.12637269326235
curr_Factors:  [101.12637269  -1.60386525  -1.01886392]
mat_Sqrt:  [[ 7.34222391  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00460759 -0.00800163  0.11291954]
Stock Position:  -0.0046075877712636205
Bond Position:  [0.96843524]


portfolio before change:  [0.50687037]
curr_Stock_Price:  100.227499490157
curr_Factors:  [100.22749949  -1.4154625   -1.0001935 ]
mat_Sqrt:  [[ 8.95119104  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00490032  0.01501882 -0.03367515]
Stock Position:  0.004900318385144863
Bond Position:  [0.01572371]


portfolio before change:  [0.50643264]
curr_Stock_Price:  100.13736967779856
curr_Factors:  [100.13736968  -1.28491436  -1.01572649]
mat_Sqrt:  [[10.03322502  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0025044   0.02826492 -0.03427424]
Stock Position:  0.002504404445714332
Bond Position:  [0.25564817]


portfolio before change:  [0.50671987]
curr_Stock_Price:  100.22653503797204
curr_Factors:  [100.22653504  -1.33532061  -1.02014118]
mat_Sqrt:  [[ 9.50645632  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0027034  -0.00288371 -0.31435008]
Stock Position:  0.0027033977393019267
Bond Position:  [0.23576768]


portfolio before change:  [0.50509015]
curr_Stock_Price:  99.60188786403272
curr_Factors:  [99.60188786 -1.15736055 -1.01303193]
mat_Sqrt:  [[11.36784359  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-8.29856130e-04 -5.56351395e-03 -8.33824329e-01]
Stock Position:  -0.0008298561298480414
Bond Position:  [0.58774538]


portfolio before change:  [0.50490862]
curr_Stock_Price:  99.99771086344052
curr_Factors:  [99.99771086 -1.02801062 -0.99265628]
mat_Sqrt:  [[13.25639926  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00658453  0.00965857 -0.08572244]
Stock Position:  -0.006584527638387538
Bond Position:  [1.16334632]


portfolio before change:  [0.50379408]
curr_Stock_Price:  100.21115270786626
curr_Factors:  [100.21115271  -1.06390193  -0.97781619]
mat_Sqrt:  [[13.00795848  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00192558 -0.01278211  0.10116324]
Stock Position:  -0.0019255752474623847
Bond Position:  [0.6967582]


portfolio before change:  [0.50172979]
curr_Stock_Price:  101.37366630279996
curr_Factors:  [101.3736663   -1.27110612  -1.01962718]
mat_Sqrt:  [[10.2582274   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00091277 -0.01419853  0.31038678]
Stock Position:  0.0009127726647953321
Bond Position:  [0.40919868]


portfolio before change:  [0.5015466]
curr_Stock_Price:  101.06088793839606
curr_Factors:  [101.06088794  -0.90234598  -1.00775202]
mat_Sqrt:  [[14.96366878  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-1.72456020e-04  2.57485894e-02  2.92591173e-01]
Stock Position:  -0.0001724560200504606
Bond Position:  [0.51897516]


portfolio before change:  [0.50201153]
curr_Stock_Price:  99.11742780152181
curr_Factors:  [99.1174278  -0.83130986 -0.97112067]
mat_Sqrt:  [[16.34422718  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00154415 -0.00086653 -0.03880358]
Stock Position:  0.001544154213079986
Bond Position:  [0.34895893]


portfolio before change:  [0.50289257]
curr_Stock_Price:  99.63149302705615
curr_Factors:  [99.63149303 -0.46361746 -0.98778785]
mat_Sqrt:  [[23.33776814  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01842459 -0.29811566 -0.58638893]
Stock Position:  -0.01842458965169137
Bond Position:  [2.33856195]


portfolio before change:  [0.5142746]
curr_Stock_Price:  99.04546589567695
curr_Factors:  [99.0454659  -0.44286715 -0.90444568]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [0.5142746]
Stock Price:  101.47927923335907
PL:  [-0.96500464]
Settle:  Tensor("sub_246:0", shape=(), dtype=float64)
PL:  Tensor("sub_247:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  124
output_Z_Vals[:, i, :]:  [[ 1.19251512e+02 -2.92846752e+01 -2.92776944e+01]
 [-4.62392235e-02 -7.24832034e-03 -1.36663710e-02]
 [-2.71200934e-01 -3.35952229e-02  1.85362507e-01]
 [-3.81952072e-02 -5.14132625e-03 -5.56375711e-02]
 [-8.43403405e-02 -1.20833670e-01  9.23001759e-02]
 [ 1.09059811e-02 -8.05738381e-02  2.15563183e-03]
 [ 7.93272396e-03  1.07958390e-02  3.96720109e-03]
 [-7.41566522e-02  1.34188874e-01 -9.47024025e-02]
 [-2.54954443e-01 -1.25858702e-01  2.66938152e-01]
 [ 4.50470017e-02  4.74936917e-02 -1.18045691e-02]
 [ 2.12505214e-02  9.13866663e-02 -9.70803258e-03]
 [-5.75135940e-02 -9.27339922e-03 -1.09575656e-01]
 [ 7.29025940e-03 -1.87917600e-01 -3.51600246e-01]
 [-7.59582496e-02  3.00005810e-02 -2.38313381e-02]
 [-2.98592770e-02 -4.21758124e-02  2.89508126e-02]
 [ 1.56202819e-01  1.42221377e-02 -3.15403932e-02]
 [-2.17688630e-02  3.01779291e-02  1.51897208e-01]
 [-6.34850781e-03  4.14547471e-02 -9.22479244e-02]
 [-3.80696389e-01 -9.75373159e-01 -2.39107240e-01]
 [ 9.61391548e-02 -8.95242578e-02 -1.53007934e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.25151208 -29.28467519 -29.2776944 ]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  8.31409947  -9.26062741 -83.52111278]
init_Out:  [2.49223638]
Stock Position:  8.314099471154409
Bond position:  [-828.91771073]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [3.75608757]
curr_Stock_Price:  100.17694117404723
curr_Factors:  [100.17694117  -1.0414995   -1.01001107]
mat_Sqrt:  [[12.87680288  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00382207 -0.00229212 -0.03898635]
Stock Position:  -0.0038220675651615514
Bond Position:  [4.13897061]


portfolio before change:  [3.75597641]
curr_Stock_Price:  100.47678742797063
curr_Factors:  [100.47678743  -1.05530994  -0.98822814]
mat_Sqrt:  [[13.0187243   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01799189 -0.01062374  0.52878764]
Stock Position:  -0.017991885376143327
Bond Position:  [5.56374325]


portfolio before change:  [3.76543376]
curr_Stock_Price:  100.02846111568348
curr_Factors:  [100.02846112  -1.16924226  -0.99173548]
mat_Sqrt:  [[11.52452091  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00431124 -0.00162583 -0.1587185 ]
Stock Position:  -0.00431123582156993
Bond Position:  [4.19668004]


portfolio before change:  [3.77566532]
curr_Stock_Price:  97.8986176431332
curr_Factors:  [97.89861764 -1.01076441 -0.97543808]
mat_Sqrt:  [[13.43320926  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0051082  -0.03821096  0.26330671]
Stock Position:  -0.005108202858502576
Bond Position:  [4.27575131]


portfolio before change:  [3.76928427]
curr_Stock_Price:  99.35707871829891
curr_Factors:  [99.35707872 -1.45668679 -0.94489968]
mat_Sqrt:  [[ 8.99918249  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0010296  -0.02547968  0.00614942]
Stock Position:  0.0010296035299663566
Bond Position:  [3.66698587]


portfolio before change:  [3.7703399]
curr_Stock_Price:  99.49185212175153
curr_Factors:  [99.49185212 -1.22427259 -0.96941902]
mat_Sqrt:  [[11.09377502  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00081318 0.00341394 0.01131732]
Stock Position:  0.0008131833252012474
Bond Position:  [3.68943478]


portfolio before change:  [3.77115142]
curr_Stock_Price:  99.35540961793191
curr_Factors:  [99.35540962 -0.86894192 -0.94938434]
mat_Sqrt:  [[16.12510153  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00558278  0.04243425 -0.27015959]
Stock Position:  -0.00558278390628111
Bond Position:  [4.3258312]


portfolio before change:  [3.778994]
curr_Stock_Price:  98.14436723133105
curr_Factors:  [98.14436723 -0.84624605 -0.94389514]
mat_Sqrt:  [[16.38388688  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0124339  -0.03980002  0.76150025]
Stock Position:  -0.012433898003411695
Bond Position:  [4.99931105]


portfolio before change:  [3.75416224]
curr_Stock_Price:  100.2419996692011
curr_Factors:  [100.24199967  -1.27409517  -0.9335812 ]
mat_Sqrt:  [[11.02219419  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00397958  0.01501882 -0.03367515]
Stock Position:  0.00397957840842907
Bond Position:  [3.35524134]


portfolio before change:  [3.75151378]
curr_Stock_Price:  99.36568211446286
curr_Factors:  [99.36568211 -1.17310165 -0.94708243]
mat_Sqrt:  [[11.92482935  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00181373  0.028899   -0.02769431]
Stock Position:  0.0018137342259989587
Bond Position:  [3.57129084]


portfolio before change:  [3.74809964]
curr_Stock_Price:  96.99098448430536
curr_Factors:  [96.99098448 -1.1073597  -0.92505758]
mat_Sqrt:  [[12.70760644  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00630489 -0.00293251 -0.31258885]
Stock Position:  -0.006304890666955269
Bond Position:  [4.35961719]


portfolio before change:  [3.74660453]
curr_Stock_Price:  97.40100829187884
curr_Factors:  [97.40100829 -0.65902562 -0.9419802 ]
mat_Sqrt:  [[19.6451551   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00352921 -0.05942476 -1.00301764]
Stock Position:  -0.00352920867761427
Bond Position:  [4.09035301]


portfolio before change:  [3.7430045]
curr_Stock_Price:  98.71086108124283
curr_Factors:  [98.71086108 -0.41581961 -0.92070361]
mat_Sqrt:  [[25.93703199  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00308625  0.00948702 -0.06798417]
Stock Position:  -0.0030862509439145325
Bond Position:  [4.04765099]


portfolio before change:  [3.73996846]
curr_Stock_Price:  100.02250971851701
curr_Factors:  [100.02250972  -0.41193105  -0.94098003]
mat_Sqrt:  [[25.85448729  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00096845 -0.01333716  0.08258861]
Stock Position:  -0.000968446662058787
Bond Position:  [3.83683493]


portfolio before change:  [3.74306421]
curr_Stock_Price:  97.81647634603172
curr_Factors:  [97.81647635 -0.13504532 -0.92858927]
mat_Sqrt:  [[33.76613696  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00444623  0.00449743 -0.08997596]
Stock Position:  0.004446226042980018
Bond Position:  [3.30815005]


portfolio before change:  [3.76298964]
curr_Stock_Price:  102.11186883468798
curr_Factors:  [102.11186883  -0.30542976  -0.96225354]
mat_Sqrt:  [[28.74275277  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [3.48477948e-04 9.54309910e-03 4.33320454e-01]
Stock Position:  0.00034847794791101024
Bond Position:  [3.72740591]


portfolio before change:  [3.76334073]
curr_Stock_Price:  100.44496546224926
curr_Factors:  [100.44496546  -0.24339548  -0.9188467 ]
mat_Sqrt:  [[31.41758582  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00076735  0.01310914 -0.26315765]
Stock Position:  -0.0007673466606917423
Bond Position:  [3.84041684]


portfolio before change:  [3.76569955]
curr_Stock_Price:  98.62232272037136
curr_Factors:  [98.62232272 -0.16462775 -0.91501051]
mat_Sqrt:  [[33.50381684  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01357123 -0.30844008 -0.6821064 ]
Stock Position:  -0.01357122917563155
Bond Position:  [5.1041257]


portfolio before change:  [3.73118432]
curr_Stock_Price:  101.25962448260893
curr_Factors:  [101.25962448  -0.4886372   -0.89849135]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [3.73118432]
Stock Price:  101.12118486821342
PL:  [2.60999945]
Settle:  Tensor("sub_248:0", shape=(), dtype=float64)
PL:  Tensor("sub_249:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  125
output_Z_Vals[:, i, :]:  [[ 1.19251512e+02 -2.92846752e+01 -2.92776944e+01]
 [-1.15148304e-02  1.23074453e-03 -6.07952877e-02]
 [-3.01230775e-01 -4.17503858e-02  1.98088204e-01]
 [-4.35562289e-02 -2.82596484e-02 -1.21145443e-01]
 [-9.88296441e-02 -2.41910939e-01  2.15109929e-01]
 [ 2.12118161e-02 -1.69818452e-01  2.62327081e-02]
 [ 5.58350497e-02  2.97874143e-02 -1.65429546e-02]
 [-9.34452321e-02  1.63194600e-01 -9.84172724e-02]
 [-1.34327739e-01 -6.60808439e-02  1.31616671e-01]
 [ 4.50470017e-02  4.74936917e-02 -1.18045691e-02]
 [ 5.78458145e-02  6.48934118e-02 -1.43788527e-02]
 [ 1.10833816e-01 -1.09491953e-02 -1.37144134e-01]
 [ 3.81501651e-02 -5.28815695e-02 -3.83943124e-01]
 [-8.45720117e-02  2.97281712e-02 -3.59999752e-02]
 [-7.49520182e-02 -9.29870328e-03  1.04027928e-01]
 [ 8.10640648e-02 -9.95681122e-03  5.72309147e-02]
 [-2.35647895e-02  1.03259148e-01  6.82888801e-02]
 [ 1.91332526e-02  6.62526046e-03 -2.74261621e-02]
 [-3.44114754e-01 -9.49590380e-01 -1.87439348e-01]
 [ 7.84536107e-02 -4.88811558e-02 -1.00481378e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.25151208 -29.28467519 -29.2776944 ]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  8.31409947  -9.26062741 -83.52111278]
init_Out:  [2.49223638]
Stock Position:  8.314099471154409
Bond position:  [-828.91771073]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [4.89378745]
curr_Stock_Price:  100.31378099459558
curr_Factors:  [100.31378099  -0.77760297  -0.96472994]
mat_Sqrt:  [[17.56608717  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00136017  0.0003892  -0.17343203]
Stock Position:  -0.0013601685218599918
Bond Position:  [5.0302311]


portfolio before change:  [4.89448233]
curr_Stock_Price:  100.72758052813266
curr_Factors:  [100.72758053  -1.05088466  -0.96470066]
mat_Sqrt:  [[13.42118375  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.019512   -0.01320263  0.56509051]
Stock Position:  -0.019512003166695414
Bond Position:  [6.8598792]


portfolio before change:  [4.90395988]
curr_Stock_Price:  100.32975527634625
curr_Factors:  [100.32975528  -1.04693753  -0.94871395]
mat_Sqrt:  [[13.63732934  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00506071 -0.00893649 -0.34559423]
Stock Position:  -0.005060712273614823
Bond Position:  [5.41169991]


portfolio before change:  [4.90631628]
curr_Stock_Price:  100.13150177812415
curr_Factors:  [100.13150178  -0.99635796  -0.96355744]
mat_Sqrt:  [[14.10555854  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00433635 -0.07649896  0.61364875]
Stock Position:  -0.004336349184016936
Bond Position:  [5.34052144]


portfolio before change:  [4.9072401]
curr_Stock_Price:  100.22639300825087
curr_Factors:  [100.22639301  -1.19792881  -0.96000927]
mat_Sqrt:  [[11.58247845  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00191512 -0.05370131  0.07483461]
Stock Position:  0.0019151213370326866
Bond Position:  [4.71529439]


portfolio before change:  [4.90918681]
curr_Stock_Price:  100.62727854201853
curr_Factors:  [100.62727854  -1.35763006  -0.97017322]
mat_Sqrt:  [[ 9.81213712  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00542464  0.00941961 -0.04719244]
Stock Position:  0.0054246430025163645
Bond Position:  [4.36331975]


portfolio before change:  [4.91000084]
curr_Stock_Price:  100.57622738753979
curr_Factors:  [100.57622739  -1.24366364  -0.97214106]
mat_Sqrt:  [[10.96941802  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00996597  0.05160666 -0.28075708]
Stock Position:  -0.009965971491016466
Bond Position:  [5.91234066]


portfolio before change:  [4.9139126]
curr_Stock_Price:  100.3320480836471
curr_Factors:  [100.33204808  -1.12465798  -0.96647238]
mat_Sqrt:  [[12.3957641   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00880686 -0.0208966   0.37546573]
Stock Position:  -0.008806863155947843
Bond Position:  [5.79752322]


portfolio before change:  [4.90702618]
curr_Stock_Price:  101.27858018313131
curr_Factors:  [101.27858018  -1.23397972  -0.96390316]
mat_Sqrt:  [[11.24577001  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00390046  0.01501882 -0.03367515]
Stock Position:  0.0039004608800406095
Bond Position:  [4.51199304]


portfolio before change:  [4.90850946]
curr_Stock_Price:  101.36963026037729
curr_Factors:  [101.36963026  -1.42664959  -0.99046691]
mat_Sqrt:  [[ 9.03998067  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00625956  0.0205211  -0.04101886]
Stock Position:  0.006259558095112144
Bond Position:  [4.27398037]


portfolio before change:  [4.90732947]
curr_Stock_Price:  101.01040174181627
curr_Factors:  [101.01040174  -1.06130833  -0.99295138]
mat_Sqrt:  [[12.94829064  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00637587 -0.00346244 -0.39123404]
Stock Position:  0.006375874766572321
Bond Position:  [4.2632998]


portfolio before change:  [4.89869906]
curr_Stock_Price:  99.48961160289068
curr_Factors:  [99.4896116  -0.74534229 -0.93853837]
mat_Sqrt:  [[18.47045769  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00225156 -0.01672262 -1.09528286]
Stock Position:  -0.0022515572610429793
Bond Position:  [5.12270562]


portfolio before change:  [4.89454275]
curr_Stock_Price:  101.90445312886885
curr_Factors:  [101.90445313  -0.30813756  -0.96004418]
mat_Sqrt:  [[28.67007495  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00317937  0.00940087 -0.10269791]
Stock Position:  -0.0031793742408996674
Bond Position:  [5.21853514]


portfolio before change:  [4.89797124]
curr_Stock_Price:  101.23649344112161
curr_Factors:  [101.23649344  -0.4103384   -0.96562524]
mat_Sqrt:  [[25.5719401   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00211003 -0.00294051  0.29676272]
Stock Position:  -0.002110027539179017
Bond Position:  [5.11158303]


portfolio before change:  [4.90343763]
curr_Stock_Price:  99.25152543092172
curr_Factors:  [99.25152543 -0.62252742 -0.98523448]
mat_Sqrt:  [[19.88360237  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00465153 -0.00314862  0.16326387]
Stock Position:  0.004651530986622926
Bond Position:  [4.44176608]


portfolio before change:  [4.89443971]
curr_Stock_Price:  97.07836956201051
curr_Factors:  [97.07836956 -0.21744799 -0.96175651]
mat_Sqrt:  [[29.85385822  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00023311  0.03265341  0.19480917]
Stock Position:  -0.0002331102550497588
Bond Position:  [4.91706967]


portfolio before change:  [4.89527504]
curr_Stock_Price:  98.7689356118843
curr_Factors:  [98.76893561 -0.33456702 -0.95537296]
mat_Sqrt:  [[27.18983395  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00050408  0.00209509 -0.07823921]
Stock Position:  0.0005040845109135568
Bond Position:  [4.84548715]


portfolio before change:  [4.89860864]
curr_Stock_Price:  102.97869608283213
curr_Factors:  [102.97869608  -0.64450028  -0.98113987]
mat_Sqrt:  [[20.26473093  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02007892 -0.30028684 -0.53471229]
Stock Position:  -0.020078922849041596
Bond Position:  [6.96630993]


portfolio before change:  [4.89660567]
curr_Stock_Price:  103.16519837004921
curr_Factors:  [103.16519837  -0.5463658   -1.02745414]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [4.89660567]
Stock Price:  102.09033669655699
PL:  [2.80626897]
Settle:  Tensor("sub_250:0", shape=(), dtype=float64)
PL:  Tensor("sub_251:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  126
output_Z_Vals[:, i, :]:  [[ 1.19251512e+02 -2.92846752e+01 -2.92776944e+01]
 [-1.43074133e-01  1.56920905e-02 -1.28464951e-01]
 [-5.32383689e-02  2.55965727e-02  9.29968654e-02]
 [-4.90695961e-02  1.71475814e-02 -2.51145813e-04]
 [-8.75290963e-02 -1.47479936e-01  1.19327721e-01]
 [-6.27971499e-02  4.13999597e-02 -1.13436745e-02]
 [-9.56084735e-02 -6.66423654e-02  6.62040389e-02]
 [-4.47428425e-02  8.39062517e-02 -9.22116147e-02]
 [-2.45830516e-01 -1.08597527e-01  2.26043377e-01]
 [ 5.46695284e-02  4.41840913e-02 -8.06482322e-04]
 [ 4.02465342e-02  8.11872586e-02 -1.16777302e-02]
 [ 8.90351650e-02 -1.03694666e-02 -1.28554005e-01]
 [ 3.93208968e-02 -2.53772037e-02 -4.34837423e-01]
 [-8.45720117e-02  2.97281712e-02 -3.59999752e-02]
 [-1.12271343e-01  5.79765680e-02  2.29029443e-01]
 [-7.25965782e-02 -1.47352963e-01  1.58059359e-01]
 [-2.38990209e-02 -2.79280584e-02  2.35500749e-01]
 [-8.49432558e-02  1.48286698e-01 -9.87870316e-02]
 [-3.45375102e-01 -9.81537037e-01 -1.96486203e-01]
 [ 8.96960769e-02 -7.47174377e-02 -1.33871814e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.25151208 -29.28467519 -29.2776944 ]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  8.31409947  -9.26062741 -83.52111278]
init_Out:  [2.49223638]
Stock Position:  8.314099471154409
Bond position:  [-828.91771073]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [1.21692154]
curr_Stock_Price:  99.87153635672162
curr_Factors:  [99.87153636 -0.89270197 -0.9704074 ]
mat_Sqrt:  [[15.49899773  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01089695  0.00496227 -0.36647475]
Stock Position:  -0.010896947428350222
Bond Position:  [2.30521642]


portfolio before change:  [1.22317792]
curr_Stock_Price:  99.35028968290266
curr_Factors:  [99.35028968 -0.53813319 -0.97565896]
mat_Sqrt:  [[21.86439988  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0015365   0.00809435  0.26529417]
Stock Position:  -0.001536495982505132
Bond Position:  [1.37582924]


portfolio before change:  [1.22423602]
curr_Stock_Price:  98.88553185373635
curr_Factors:  [98.88553185 -0.30754384 -0.95836912]
mat_Sqrt:  [[27.88391441  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00174574  0.00542254 -0.00071645]
Stock Position:  -0.001745741708656981
Bond Position:  [1.39686461]


portfolio before change:  [1.22669353]
curr_Stock_Price:  97.67787576347828
curr_Factors:  [97.67787576 -0.45679658 -1.01936776]
mat_Sqrt:  [[22.32061618  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00300078 -0.04663725  0.34040877]
Stock Position:  -0.0030007837689969515
Bond Position:  [1.51980371]


portfolio before change:  [1.224249]
curr_Stock_Price:  98.61913942704814
curr_Factors:  [98.61913943 -0.54369013 -1.01103419]
mat_Sqrt:  [[20.83305766  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00307414  0.01309182 -0.03236035]
Stock Position:  -0.003074139497144942
Bond Position:  [1.52741799]


portfolio before change:  [1.22568892]
curr_Stock_Price:  98.27497230934908
curr_Factors:  [98.27497231 -0.42837485 -0.99949728]
mat_Sqrt:  [[23.5681744   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00355629 -0.02107417  0.1888617 ]
Stock Position:  -0.0035562928075652408
Bond Position:  [1.5751835]


portfolio before change:  [1.22904393]
curr_Stock_Price:  97.44231605390262
curr_Factors:  [97.44231605 -0.38587598 -0.98663951]
mat_Sqrt:  [[24.69856361  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00248593  0.02653349 -0.26305407]
Stock Position:  -0.002485934422267848
Bond Position:  [1.47127914]


portfolio before change:  [1.2234728]
curr_Stock_Price:  99.83135941994506
curr_Factors:  [99.83135942 -0.44081388 -0.96052347]
mat_Sqrt:  [[24.58520914  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0082364  -0.03434155  0.64483883]
Stock Position:  -0.008236398538596541
Bond Position:  [2.04572366]


portfolio before change:  [1.239086]
curr_Stock_Price:  97.99782680821833
curr_Factors:  [97.99782681 -0.4704667  -0.93750441]
mat_Sqrt:  [[23.97410259  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00232108  0.01397224 -0.00230067]
Stock Position:  0.0023210768350078155
Bond Position:  [1.01162551]


portfolio before change:  [1.24192822]
curr_Stock_Price:  99.11338141256266
curr_Factors:  [99.11338141 -0.51263967 -0.96920615]
mat_Sqrt:  [[22.52033413  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00177436  0.02567367 -0.03331331]
Stock Position:  0.0017743552664580946
Bond Position:  [1.06606587]


portfolio before change:  [1.24042269]
curr_Stock_Price:  98.11466077222357
curr_Factors:  [98.11466077 -0.30495184 -0.98115078]
mat_Sqrt:  [[27.11356596  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00230609 -0.00327911 -0.36672879]
Stock Position:  0.0023060946797437425
Bond Position:  [1.01416099]


portfolio before change:  [1.24600109]
curr_Stock_Price:  100.42368794134298
curr_Factors:  [100.42368794  -0.47055604  -0.96036168]
mat_Sqrt:  [[24.01023978  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00208641 -0.00802498 -1.24047013]
Stock Position:  -0.0020864080321673236
Bond Position:  [1.45552588]


portfolio before change:  [1.24214842]
curr_Stock_Price:  102.44467546897353
curr_Factors:  [102.44467547  -0.3911844   -0.99013479]
mat_Sqrt:  [[25.73890624  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00354144  0.00940087 -0.10269791]
Stock Position:  -0.0035414441051501854
Bond Position:  [1.60495051]


portfolio before change:  [1.23885448]
curr_Stock_Price:  103.48809935830697
curr_Factors:  [103.48809936  -0.30557807  -1.00281165]
mat_Sqrt:  [[27.96816537  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00228917  0.0183338   0.65335725]
Stock Position:  -0.0022891725065583603
Bond Position:  [1.47575659]


portfolio before change:  [1.23767832]
curr_Stock_Price:  104.16307571171745
curr_Factors:  [104.16307571  -0.48960371  -1.042308  ]
mat_Sqrt:  [[22.51194367  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00196063 -0.0465971   0.45089936]
Stock Position:  -0.0019606251907255366
Bond Position:  [1.44190307]


portfolio before change:  [1.23766307]
curr_Stock_Price:  104.35473762724992
curr_Factors:  [104.35473763  -0.2921043   -1.03828792]
mat_Sqrt:  [[27.58863221  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00085003 -0.00883163  0.67181809]
Stock Position:  0.0008500337667349385
Bond Position:  [1.14895802]


portfolio before change:  [1.23741847]
curr_Stock_Price:  103.72902788587818
curr_Factors:  [103.72902789  -0.33187367  -1.05574157]
mat_Sqrt:  [[25.89802622  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0039107   0.04689237 -0.2818119 ]
Stock Position:  -0.003910696793349918
Bond Position:  [1.64307125]


portfolio before change:  [1.23687608]
curr_Stock_Price:  103.97277075484818
curr_Factors:  [103.97277075  -0.61340421  -1.03046132]
mat_Sqrt:  [[20.09083041  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02044843 -0.31038926 -0.56052045]
Stock Position:  -0.020448425914788543
Bond Position:  [3.36295558]


portfolio before change:  [1.30028734]
curr_Stock_Price:  100.91285724624801
curr_Factors:  [100.91285725  -0.64732836  -0.96719376]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [1.30028734]
Stock Price:  100.32120768442837
PL:  [0.97907966]
Settle:  Tensor("sub_252:0", shape=(), dtype=float64)
PL:  Tensor("sub_253:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  127
output_Z_Vals[:, i, :]:  [[ 1.19251512e+02 -2.92846752e+01 -2.92776944e+01]
 [-2.16749671e-01  5.10698342e-02 -4.49212764e-03]
 [-5.96472607e-02  2.19074607e-02  8.03000055e-02]
 [-5.30212534e-02  2.79916012e-02  2.56121970e-02]
 [-8.58403053e-02 -1.33367857e-01  1.05013713e-01]
 [-2.05779492e-02  1.08702909e-02 -5.16641963e-03]
 [-1.27965992e-01 -9.29952671e-02  8.63877697e-02]
 [-2.31116222e-02  5.79134123e-03 -1.12554527e-01]
 [-1.50354861e-01 -1.01858742e-01  2.16585038e-01]
 [ 2.70381534e-02  1.53077421e-02  8.37053941e-03]
 [-1.11735096e-01  1.58100579e-01  2.29338038e-02]
 [-8.21900054e-02 -9.23205706e-03 -1.22120708e-01]
 [-1.63758595e-02 -2.75912526e-01 -1.30637586e-01]
 [ 9.35186277e-02 -6.26738424e-02 -4.11742242e-03]
 [ 1.11348156e-02 -5.79141975e-02 -1.09473076e-01]
 [ 1.85270933e-01  4.97328820e-02 -1.48218946e-01]
 [ 1.89778773e-02 -3.99367541e-02  1.02997182e-01]
 [ 4.16196696e-02 -2.49874608e-02  6.99696018e-02]
 [-2.61884185e-01 -6.72766416e-01 -1.27335617e-01]
 [ 1.49279382e-01 -2.17582924e-01 -3.72049017e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.25151208 -29.28467519 -29.2776944 ]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  8.31409947  -9.26062741 -83.52111278]
init_Out:  [2.49223638]
Stock Position:  8.314099471154409
Bond position:  [-828.91771073]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-3.7304235]
curr_Stock_Price:  99.27648152743134
curr_Factors:  [99.27648153 -0.8976194  -0.95836451]
mat_Sqrt:  [[15.51682295  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0139428   0.0161497  -0.01281479]
Stock Position:  -0.013942802955737972
Bond Position:  [-2.34623108]


portfolio before change:  [-3.72649751]
curr_Stock_Price:  98.9528295279111
curr_Factors:  [98.95282953 -0.95944222 -0.97158697]
mat_Sqrt:  [[14.34805049  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00297535  0.00692775  0.22907356]
Stock Position:  -0.0029753479407830883
Bond Position:  [-3.43207842]


portfolio before change:  [-3.72206804]
curr_Stock_Price:  97.17569210991739
curr_Factors:  [97.17569211 -0.78498084 -0.95869298]
mat_Sqrt:  [[16.99376952  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00276986  0.00885172  0.07306447]
Stock Position:  -0.00276986489111272
Bond Position:  [-3.4529045]


portfolio before change:  [-3.7267647]
curr_Stock_Price:  98.55963178379167
curr_Factors:  [98.55963178 -1.09084398 -0.96991828]
mat_Sqrt:  [[12.55224453  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00540525 -0.04217462  0.29957489]
Stock Position:  -0.005405249548036327
Bond Position:  [-3.19402529]


portfolio before change:  [-3.72533354]
curr_Stock_Price:  98.14711400468666
curr_Factors:  [98.147114   -1.17537316 -0.97766438]
mat_Sqrt:  [[11.39790965  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00187331  0.00343749 -0.01473836]
Stock Position:  -0.001873314597913579
Bond Position:  [-3.54147312]


portfolio before change:  [-3.7248862]
curr_Stock_Price:  97.43563756451576
curr_Factors:  [97.43563756 -1.30985747 -0.97364855]
mat_Sqrt:  [[ 9.93124662  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01135137 -0.02940769  0.24644026]
Stock Position:  -0.011351373463193846
Bond Position:  [-2.61885789]


portfolio before change:  [-3.72303077]
curr_Stock_Price:  97.21449897551973
curr_Factors:  [97.21449898 -1.77959724 -0.98443443]
mat_Sqrt:  [[ 6.12812112  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00749613  0.00183138 -0.32108674]
Stock Position:  -0.007496129092833172
Bond Position:  [-2.99429834]


portfolio before change:  [-3.7253804]
curr_Stock_Price:  97.42806985310959
curr_Factors:  [97.42806985 -1.59876569 -0.97420886]
mat_Sqrt:  [[ 7.43456306  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01463093 -0.03221056  0.61785683]
Stock Position:  -0.014630934695227853
Bond Position:  [-2.29991667]


portfolio before change:  [-3.72585927]
curr_Stock_Price:  97.42149642092619
curr_Factors:  [97.42149642 -1.58134476 -0.98220004]
mat_Sqrt:  [[ 7.50449442  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00388328 0.00484073 0.02387882]
Stock Position:  0.003883276500932425
Bond Position:  [-4.10417388]


portfolio before change:  [-3.72964489]
curr_Stock_Price:  96.71089811512964
curr_Factors:  [96.71089812 -1.50566085 -1.00026894]
mat_Sqrt:  [[ 7.8915795   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01304829  0.04999579  0.06542376]
Stock Position:  -0.013048289507881589
Bond Position:  [-2.4677331]


portfolio before change:  [-3.71876796]
curr_Stock_Price:  95.83002107116266
curr_Factors:  [95.83002107 -1.12230868 -0.9445447 ]
mat_Sqrt:  [[12.13049611  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0088501  -0.00291943 -0.34837639]
Stock Position:  -0.008850104754106344
Bond Position:  [-2.87066224]


portfolio before change:  [-3.70824179]
curr_Stock_Price:  94.55953526870614
curr_Factors:  [94.55953527 -1.109576   -0.9415636 ]
mat_Sqrt:  [[12.1592481   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00412576 -0.0872512  -0.37267267]
Stock Position:  -0.004125762992904557
Bond Position:  [-3.31811156]


portfolio before change:  [-3.70427567]
curr_Stock_Price:  93.39714387374023
curr_Factors:  [93.39714387 -1.14288279 -0.91284768]
mat_Sqrt:  [[11.95476915  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00761704 -0.01981921 -0.01174586]
Stock Position:  0.00761703798837828
Bond Position:  [-4.41568526]


portfolio before change:  [-3.70833638]
curr_Stock_Price:  93.00898081535863
curr_Factors:  [93.00898082 -1.27408192 -0.89855873]
mat_Sqrt:  [[10.59153826  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0011997  -0.01831408 -0.31229621]
Stock Position:  -0.0011996954881592634
Bond Position:  [-3.59675392]


portfolio before change:  [-3.7091409]
curr_Stock_Price:  92.92997664162084
curr_Factors:  [92.92997664 -1.30778178 -0.89153139]
mat_Sqrt:  [[10.3040096   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01516885  0.01572692 -0.4228274 ]
Stock Position:  0.01516884891883466
Bond Position:  [-5.11878167]


portfolio before change:  [-3.7030233]
curr_Stock_Price:  93.41765089012604
curr_Factors:  [93.41765089 -1.19538018 -0.84768724]
mat_Sqrt:  [[12.10977398  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00321814 -0.01262911  0.29382229]
Stock Position:  0.003218138221252942
Bond Position:  [-4.00365421]


portfolio before change:  [-3.70707122]
curr_Stock_Price:  92.47086646179248
curr_Factors:  [92.47086646 -1.25290832 -0.83995155]
mat_Sqrt:  [[11.40479368  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00484507 -0.00790173  0.1996038 ]
Stock Position:  0.004845066279470364
Bond Position:  [-4.1550987]


portfolio before change:  [-3.7073655]
curr_Stock_Price:  92.62455452273252
curr_Factors:  [92.62455452 -1.01743653 -0.81628143]
mat_Sqrt:  [[14.80309556  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0206205  -0.21274742 -0.36325307]
Stock Position:  -0.020620498727626908
Bond Position:  [-1.79740099]


portfolio before change:  [-3.68927976]
curr_Stock_Price:  91.72568501259674
curr_Factors:  [91.72568501 -1.50665456 -0.80048204]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-3.68927976]
Stock Price:  92.05627403945934
PL:  [-3.68927976]
Settle:  Tensor("sub_254:0", shape=(), dtype=float64)
PL:  Tensor("sub_255:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  128
output_Z_Vals[:, i, :]:  [[ 1.19251512e+02 -2.92846752e+01 -2.92776944e+01]
 [ 1.07108715e-02 -8.01180867e-02 -2.12940038e-01]
 [-4.06763215e-01 -6.66079184e-02  2.72879275e-01]
 [-5.73716380e-02 -8.74501977e-02 -2.88554116e-01]
 [-9.88296441e-02 -2.41910939e-01  2.15109929e-01]
 [-3.19263210e-01  8.66694885e-02 -4.17461386e-03]
 [ 5.10615817e-02  1.09206178e-01 -4.76883669e-02]
 [-1.83930974e-01  2.71012681e-01 -6.22071845e-02]
 [-2.91985678e-02 -8.32695022e-04 -2.61695960e-02]
 [ 2.55257486e-02  3.52562949e-02 -1.24920926e-02]
 [ 1.45485748e-01 -1.40213336e-02 -3.86303408e-02]
 [-6.64651666e-02 -4.65915861e-03 -6.45271897e-02]
 [ 4.03984698e-02 -1.23884655e-02 -2.36202424e-01]
 [-7.32413329e-02  2.29233974e-02 -3.30805123e-02]
 [-1.63869674e-01  1.30695509e-01  3.03444454e-01]
 [-1.92224068e-01 -3.56049836e-01  2.56513170e-01]
 [-5.41528920e-02 -1.16094315e-01  2.53015964e-01]
 [-2.65269843e-01  4.10909398e-01 -6.53231796e-02]
 [-2.89931710e-01 -1.00419582e+00 -1.06650847e-01]
 [ 8.10972489e-02 -9.95549877e-03 -6.41763051e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.25151208 -29.28467519 -29.2776944 ]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  8.31409947  -9.26062741 -83.52111278]
init_Out:  [2.49223638]
Stock Position:  8.314099471154409
Bond position:  [-828.91771073]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [15.57781075]
curr_Stock_Price:  101.59882976403101
curr_Factors:  [101.59882976  -0.88655883  -0.97098911]
mat_Sqrt:  [[15.85498693  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0021964  -0.02533556 -0.60745866]
Stock Position:  -0.0021964049598907297
Bond Position:  [15.80096292]


portfolio before change:  [15.58111513]
curr_Stock_Price:  101.89310585698425
curr_Factors:  [101.89310586  -0.59634301  -0.971194  ]
mat_Sqrt:  [[21.25064546  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01660099 -0.02106327  0.77844862]
Stock Position:  -0.016600991039306272
Bond Position:  [17.27264167]


portfolio before change:  [15.60421694]
curr_Stock_Price:  100.76166068086455
curr_Factors:  [100.76166068  -0.61803154  -1.03075074]
mat_Sqrt:  [[19.37484646  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00611775 -0.02765418 -0.82316458]
Stock Position:  -0.006117749372686204
Bond Position:  [16.22065153]


portfolio before change:  [15.59269359]
curr_Stock_Price:  103.30818988737593
curr_Factors:  [103.30818989  -0.66787066  -1.06014181]
mat_Sqrt:  [[18.35136923  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00333308 -0.07649896  0.61364875]
Stock Position:  -0.0033330824788320775
Bond Position:  [15.9370283]


portfolio before change:  [15.59813063]
curr_Stock_Price:  102.87246959410952
curr_Factors:  [102.87246959  -0.39921746  -1.0496652 ]
mat_Sqrt:  [[24.15780227  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01315838  0.0274073  -0.01190901]
Stock Position:  -0.013158380437776045
Bond Position:  [16.95176572]


portfolio before change:  [15.57439714]
curr_Stock_Price:  104.99826067465571
curr_Factors:  [104.99826067  -0.6671291   -1.0816628 ]
mat_Sqrt:  [[18.26801814  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00241662  0.03453403 -0.13604164]
Stock Position:  0.0024166237203403847
Bond Position:  [15.32065585]


portfolio before change:  [15.57816699]
curr_Stock_Price:  104.97310789706161
curr_Factors:  [104.9731079   -1.27236551  -1.08814159]
mat_Sqrt:  [[ 9.90655937  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01914201  0.08570173 -0.17745978]
Stock Position:  -0.019142008647238123
Bond Position:  [17.58756313]


portfolio before change:  [15.57570865]
curr_Stock_Price:  105.33126188475192
curr_Factors:  [105.33126188  -0.93124146  -1.1182692 ]
mat_Sqrt:  [[13.56644674  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0025476  -0.00026332 -0.07465457]
Stock Position:  -0.002547602546247081
Bond Position:  [15.84405084]


portfolio before change:  [15.58349811]
curr_Stock_Price:  103.82869181465368
curr_Factors:  [103.82869181  -0.99032254  -1.09470582]
mat_Sqrt:  [[12.90627965  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00185074  0.01114902 -0.03563646]
Stock Position:  0.0018507366327423084
Bond Position:  [15.39133854]


portfolio before change:  [15.58720986]
curr_Stock_Price:  103.75490601623596
curr_Factors:  [103.75490602  -0.96732573  -1.0845306 ]
mat_Sqrt:  [[13.33210607  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01029382 -0.00443394 -0.11020161]
Stock Position:  0.010293822501697998
Bond Position:  [14.51917528]


portfolio before change:  [15.60245112]
curr_Stock_Price:  104.88286448236833
curr_Factors:  [104.88286448  -0.89468822  -1.07471602]
mat_Sqrt:  [[14.63535111  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00544961 -0.00147336 -0.18407811]
Stock Position:  -0.005449614594942673
Bond Position:  [16.17402231]


portfolio before change:  [15.6120081]
curr_Stock_Price:  103.87123837156001
curr_Factors:  [103.87123837  -0.78617965  -1.08696873]
mat_Sqrt:  [[15.95869239  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-5.09817259e-04 -3.91757676e-03 -6.73819769e-01]
Stock Position:  -0.0005098172592777904
Bond Position:  [15.66496345]


portfolio before change:  [15.61507656]
curr_Stock_Price:  105.5351076952223
curr_Factors:  [105.5351077   -0.95171045  -1.16006763]
mat_Sqrt:  [[12.77213177  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00621682  0.00724901 -0.09436949]
Stock Position:  -0.00621681533620161
Bond Position:  [16.27116884]


portfolio before change:  [15.60877106]
curr_Stock_Price:  107.20377544469615
curr_Factors:  [107.20377544  -0.86171444  -1.18636219]
mat_Sqrt:  [[13.82743739  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00712748  0.04132955  0.86564257]
Stock Position:  -0.007127480493083911
Bond Position:  [16.37286388]


portfolio before change:  [15.60325408]
curr_Stock_Price:  108.55217726289277
curr_Factors:  [108.55217726  -0.72981035  -1.21189302]
mat_Sqrt:  [[15.57282775  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00957159 -0.11259284  0.73176067]
Stock Position:  -0.009571588801397184
Bond Position:  [16.64227089]


portfolio before change:  [15.60931222]
curr_Stock_Price:  108.35398102689183
curr_Factors:  [108.35398103  -1.10433444  -1.17561674]
mat_Sqrt:  [[11.08344201  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-4.96575613e-04 -3.67122460e-02  7.21784118e-01]
Stock Position:  -0.0004965756133160017
Bond Position:  [15.66311817]


portfolio before change:  [15.61262628]
curr_Stock_Price:  109.56671649795558
curr_Factors:  [109.5667165   -1.53748514  -1.19852422]
mat_Sqrt:  [[ 7.10305012  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.03772946  0.12994096 -0.18634885]
Stock Position:  -0.03772946018292862
Bond Position:  [19.74651934]


portfolio before change:  [15.65845121]
curr_Stock_Price:  108.48300936413447
curr_Factors:  [108.48300936  -1.35645505  -1.18382199]
mat_Sqrt:  [[ 8.55329449  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.03947367 -0.3175546  -0.30424518]
Stock Position:  -0.03947367280727011
Bond Position:  [19.94067403]


portfolio before change:  [15.6616796]
curr_Stock_Price:  108.52753009026702
curr_Factors:  [108.52753009  -1.15803638  -1.2148432 ]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [15.6616796]
Stock Price:  109.3048036632562
PL:  [6.35687594]
Settle:  Tensor("sub_256:0", shape=(), dtype=float64)
PL:  Tensor("sub_257:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  129
output_Z_Vals[:, i, :]:  [[ 1.19251512e+02 -2.92846752e+01 -2.92776944e+01]
 [-1.41998615e-01  1.57723881e-02 -1.26733754e-01]
 [-8.55336435e-02  1.68261891e-02  1.06682581e-01]
 [-2.55669242e-02  2.23494453e-02  2.11612745e-02]
 [-9.39058337e-02 -2.00766000e-01  1.73376250e-01]
 [-2.67303304e-02 -2.90011472e-02 -1.90394458e-02]
 [ 5.54348602e-02  3.64455830e-02 -1.91540681e-02]
 [-1.17529121e-01  1.75689594e-01 -5.79973545e-02]
 [-1.20497083e-01 -3.52828783e-02  5.84774994e-02]
 [-5.37773952e-02 -3.41704628e-02 -3.30769255e-02]
 [ 2.57551981e-01 -1.39475892e-01 -9.75488241e-02]
 [-1.11987469e-01  2.84875555e-02  9.70902864e-03]
 [ 4.02379100e-02 -1.13750148e-02 -1.81257293e-01]
 [-4.86673977e-03  1.05553197e-03  5.21900132e-02]
 [-1.81915687e-01  1.56128250e-01  3.29470380e-01]
 [-1.70759718e-01 -3.27879409e-01  2.40975616e-01]
 [-5.00110061e-02 -9.23766759e-02  2.54096278e-01]
 [-2.45221131e-01  3.84091330e-01 -6.24546902e-02]
 [-2.78693633e-01 -1.02322187e+00 -1.27308908e-01]
 [ 8.79314497e-02 -3.13885107e-02 -9.00939756e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.25151208 -29.28467519 -29.2776944 ]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  8.31409947  -9.26062741 -83.52111278]
init_Out:  [2.49223638]
Stock Position:  8.314099471154409
Bond position:  [-828.91771073]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [0.90563258]
curr_Stock_Price:  99.83409526501579
curr_Factors:  [99.83409527 -1.05556868 -0.9778294 ]
mat_Sqrt:  [[13.06728367  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01281527  0.00498767 -0.36153612]
Stock Position:  -0.012815271850880201
Bond Position:  [2.18503365]


portfolio before change:  [0.91455257]
curr_Stock_Price:  99.18068276810953
curr_Factors:  [99.18068277 -1.21162213 -0.93760488]
mat_Sqrt:  [[11.56191213  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00547684  0.00532091  0.30433571]
Stock Position:  -0.005476836506008146
Bond Position:  [1.45774895]


portfolio before change:  [0.9114234]
curr_Stock_Price:  99.81857904644706
curr_Factors:  [99.81857905 -1.45420629 -0.93283791]
mat_Sqrt:  [[ 9.17341953  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00225329  0.00706752  0.06036723]
Stock Position:  -0.002253285900275539
Bond Position:  [1.13634319]


portfolio before change:  [0.91239459]
curr_Stock_Price:  99.51366079883736
curr_Factors:  [99.5136608  -1.04291198 -0.92978577]
mat_Sqrt:  [[13.84047384  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00460239 -0.06348778  0.49459418]
Stock Position:  -0.004602393770856216
Bond Position:  [1.37039564]


portfolio before change:  [0.91096747]
curr_Stock_Price:  99.89819066101578
curr_Factors:  [99.89819066 -0.67459415 -0.93365199]
mat_Sqrt:  [[20.00346356  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00156801 -0.00917097 -0.05431424]
Stock Position:  -0.0015680058236516423
Bond Position:  [1.06760841]


portfolio before change:  [0.90928207]
curr_Stock_Price:  101.14329973953943
curr_Factors:  [101.14329974  -0.5728649   -1.01237341]
mat_Sqrt:  [[20.72415671  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00253164  0.01152511 -0.05464122]
Stock Position:  0.002531638514075571
Bond Position:  [0.65322379]


portfolio before change:  [0.90902514]
curr_Stock_Price:  100.97729768260281
curr_Factors:  [100.97729768  -0.25673386  -1.01380417]
mat_Sqrt:  [[28.34236498  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00440441  0.05555793 -0.16545031]
Stock Position:  -0.004404413513142466
Bond Position:  [1.35377091]


portfolio before change:  [0.90002455]
curr_Stock_Price:  103.09768592893771
curr_Factors:  [103.09768593  -0.54242006  -0.99822449]
mat_Sqrt:  [[22.08795403  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00495616 -0.01115743  0.16682003]
Stock Position:  -0.004956159039245926
Bond Position:  [1.41099308]


portfolio before change:  [0.88706557]
curr_Stock_Price:  105.78359237492502
curr_Factors:  [105.78359237  -0.67974394  -0.99863287]
mat_Sqrt:  [[19.74733634  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00310986 -0.01080565 -0.09435926]
Stock Position:  -0.003109861040567665
Bond Position:  [1.21603784]


portfolio before change:  [0.88336989]
curr_Stock_Price:  107.06973446594853
curr_Factors:  [107.06973447  -0.71452664  -0.99799947]
mat_Sqrt:  [[19.31639548  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01211606 -0.04410615 -0.27827964]
Stock Position:  0.012116062711077699
Bond Position:  [-0.41389373]


portfolio before change:  [0.87285529]
curr_Stock_Price:  106.21045219687285
curr_Factors:  [106.2104522   -0.70977424  -1.00219886]
mat_Sqrt:  [[19.17197209  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00569947  0.00900856  0.02769716]
Stock Position:  -0.005699469832400575
Bond Position:  [1.47819856]


portfolio before change:  [0.86487306]
curr_Stock_Price:  107.6758202345677
curr_Factors:  [107.67582023  -0.70532752  -1.01126493]
mat_Sqrt:  [[19.34690762  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 1.52231996e-04 -3.59709553e-03 -5.17076605e-01]
Stock Position:  0.00015223199588236406
Bond Position:  [0.84848136]


portfolio before change:  [0.8650464]
curr_Stock_Price:  107.42091335692967
curr_Factors:  [107.42091336  -0.62900613  -0.9894543 ]
mat_Sqrt:  [[21.29121323  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00027306 0.00033379 0.14888358]
Stock Position:  0.0002730589238190222
Bond Position:  [0.83571417]


portfolio before change:  [0.86510004]
curr_Stock_Price:  106.85210927760521
curr_Factors:  [106.85210928  -0.5668623   -0.95708355]
mat_Sqrt:  [[23.27779428  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00475267  0.04937209  0.93988729]
Stock Position:  -0.004752667379760494
Bond Position:  [1.37293258]


portfolio before change:  [0.86102935]
curr_Stock_Price:  107.7808440651372
curr_Factors:  [107.78084407  -1.03829691  -0.94368285]
mat_Sqrt:  [[14.85178677  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00875562 -0.10368457  0.68743636]
Stock Position:  -0.008755618959863019
Bond Position:  [1.80471735]


portfolio before change:  [0.85894688]
curr_Stock_Price:  108.070225023518
curr_Factors:  [108.07022502  -1.57796802  -0.92385087]
mat_Sqrt:  [[ 8.85482364  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-5.97387373e-05 -2.92120699e-02  7.24865955e-01]
Stock Position:  -5.973873729320845e-05
Bond Position:  [0.86540286]


portfolio before change:  [0.85910182]
curr_Stock_Price:  109.09862569237097
curr_Factors:  [109.09862569  -1.8379622   -0.90425039]
mat_Sqrt:  [[ 7.02896666  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.03529003  0.12146034 -0.17816585]
Stock Position:  -0.03529003023284283
Bond Position:  [4.70919562]


portfolio before change:  [0.84859366]
curr_Stock_Price:  109.42975616387382
curr_Factors:  [109.42975616  -1.97645265  -0.93508527]
mat_Sqrt:  [[ 5.95210497  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.05562737 -0.32357117 -0.36317688]
Stock Position:  -0.055627367360999755
Bond Position:  [6.93588291]


portfolio before change:  [0.84710721]
curr_Stock_Price:  109.48765280633222
curr_Factors:  [109.48765281  -2.27641931  -0.91231763]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [0.84710721]
Stock Price:  109.92557225179502
PL:  [-9.07846504]
Settle:  Tensor("sub_258:0", shape=(), dtype=float64)
PL:  Tensor("sub_259:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  130
output_Z_Vals[:, i, :]:  [[ 1.19251512e+02 -2.92846752e+01 -2.92776944e+01]
 [ 4.35242907e-02 -5.76851090e-02 -1.05884069e-01]
 [-2.08310208e-01 -1.65160746e-02  1.58711406e-01]
 [-6.04721280e-02 -1.00689028e-01 -3.25960838e-01]
 [-9.88296441e-02 -2.41910939e-01  2.15109929e-01]
 [ 2.59143653e-02 -1.68092935e-01  2.62489630e-02]
 [ 5.77929836e-02  2.45316002e-02 -1.30726605e-02]
 [-8.21917360e-02  1.38624775e-01 -1.18562535e-01]
 [-1.60518909e-01 -7.87388719e-02  1.60225247e-01]
 [ 4.67267235e-02  4.83163356e-02 -1.14848699e-02]
 [ 2.73094802e-02  8.83718020e-02 -1.20496934e-02]
 [ 6.80436456e-02 -9.69432797e-03 -1.18664344e-01]
 [ 3.16864001e-02 -8.42674507e-02 -3.67487479e-01]
 [-8.15032922e-02  3.06789824e-02 -2.90568779e-02]
 [ 6.10725879e-03 -6.30971939e-02 -1.66364024e-02]
 [ 1.15815459e-01 -5.69617866e-03  1.83333564e-02]
 [-2.35647895e-02  1.03259148e-01  6.82888801e-02]
 [ 4.38842387e-02 -2.40138280e-02  4.75637998e-02]
 [-2.79713790e-01 -7.36380658e-01 -1.24202043e-01]
 [ 8.36197860e-02 -6.07535295e-02 -1.15825062e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.25151208 -29.28467519 -29.2776944 ]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  8.31409947  -9.26062741 -83.52111278]
init_Out:  [2.49223638]
Stock Position:  8.314099471154409
Bond position:  [-828.91771073]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [9.90252555]
curr_Stock_Price:  100.91622003400566
curr_Factors:  [100.91622003  -0.97265591  -1.05086324]
mat_Sqrt:  [[13.34005972  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00153083 -0.01824163 -0.30205778]
Stock Position:  0.0015308306718523816
Bond Position:  [9.74803991]


portfolio before change:  [9.90386981]
curr_Stock_Price:  100.20219068746495
curr_Factors:  [100.20219069  -0.7960078   -1.05028501]
mat_Sqrt:  [[15.81402556  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01115085 -0.00522284  0.45275947]
Stock Position:  -0.011150849642809268
Bond Position:  [11.02120937]


portfolio before change:  [9.89835331]
curr_Stock_Price:  100.94403019703994
curr_Factors:  [100.9440302   -0.77047213  -1.08188862]
mat_Sqrt:  [[15.83472739  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00818507 -0.03184067 -0.92987554]
Stock Position:  -0.008185072076099451
Bond Position:  [10.72458748]


portfolio before change:  [9.89151558]
curr_Stock_Price:  102.10702803910245
curr_Factors:  [102.10702804  -1.01794273  -1.08898407]
mat_Sqrt:  [[12.41735083  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0049259  -0.07649896  0.61364875]
Stock Position:  -0.004925899904885278
Bond Position:  [10.39448457]


portfolio before change:  [9.90242863]
curr_Stock_Price:  100.41919214611814
curr_Factors:  [100.41919215  -1.1560786   -1.08415393]
mat_Sqrt:  [[10.68799147  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00251986 -0.05315565  0.07488099]
Stock Position:  0.002519862746787426
Bond Position:  [9.64938605]


portfolio before change:  [9.90367953]
curr_Stock_Price:  99.9581543092574
curr_Factors:  [99.95815431 -1.48227838 -1.08580792]
mat_Sqrt:  [[ 7.6650064   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00727435  0.00775757 -0.03729266]
Stock Position:  0.0072743502358248585
Bond Position:  [9.1765489]


portfolio before change:  [9.90700502]
curr_Stock_Price:  100.09989497009758
curr_Factors:  [100.09989497  -1.71277642  -1.12833391]
mat_Sqrt:  [[ 5.84191299  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01759936  0.043837   -0.33822591]
Stock Position:  -0.017599361035791107
Bond Position:  [11.66869921]


portfolio before change:  [9.9139645]
curr_Stock_Price:  99.87023118080545
curr_Factors:  [99.87023118 -1.05114862 -1.15070853]
mat_Sqrt:  [[11.04540492  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01175567 -0.02489942  0.45707803]
Stock Position:  -0.011755666456186614
Bond Position:  [11.08800563]


portfolio before change:  [9.91950723]
curr_Stock_Price:  99.63456715750131
curr_Factors:  [99.63456716 -1.21405843 -1.20237931]
mat_Sqrt:  [[ 8.89128359  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00513198  0.01527897 -0.03276314]
Stock Position:  0.00513198192809803
Bond Position:  [9.40818444]


portfolio before change:  [9.92338453]
curr_Stock_Price:  99.93171385416598
curr_Factors:  [99.93171385 -1.28414767 -1.16826107]
mat_Sqrt:  [[ 8.60271935  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00315384  0.02794562 -0.03437442]
Stock Position:  0.0031538396055084206
Bond Position:  [9.60821593]


portfolio before change:  [9.92407378]
curr_Stock_Price:  99.38853416894898
curr_Factors:  [99.38853417 -0.89261562 -1.18038593]
mat_Sqrt:  [[12.50383259  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00348462 -0.00306562 -0.33851634]
Stock Position:  0.0034846181062537732
Bond Position:  [9.57774269]


portfolio before change:  [9.92472546]
curr_Stock_Price:  98.88832082435187
curr_Factors:  [98.88832082 -0.79792547 -1.13760227]
mat_Sqrt:  [[14.27433832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00318771 -0.02664771 -1.04833949]
Stock Position:  -0.0031877094919780134
Bond Position:  [10.2399527]


portfolio before change:  [9.92566295]
curr_Stock_Price:  99.39740573511173
curr_Factors:  [99.39740574 -0.59862539 -1.12397836]
mat_Sqrt:  [[17.75242742  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00488059  0.00970155 -0.08289118]
Stock Position:  -0.004880593091457868
Bond Position:  [10.41078125]


portfolio before change:  [9.92614811]
curr_Stock_Price:  99.83134202279463
curr_Factors:  [99.83134202 -0.73591007 -1.11191759]
mat_Sqrt:  [[15.73133394  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 6.87929475e-05 -1.99530847e-02 -4.74590254e-02]
Stock Position:  6.879294748507094e-05
Bond Position:  [9.91928042]


portfolio before change:  [9.92852815]
curr_Stock_Price:  98.37638963771911
curr_Factors:  [98.37638964 -0.6202635  -1.09875034]
mat_Sqrt:  [[17.63326172  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0067719  -0.00180129  0.05229996]
Stock Position:  0.006771898866712157
Bond Position:  [9.26233319]


portfolio before change:  [9.92612796]
curr_Stock_Price:  97.67997322838305
curr_Factors:  [97.67997323 -1.20989284 -1.11154864]
mat_Sqrt:  [[ 9.58553388  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00072601  0.03265341  0.19480917]
Stock Position:  -0.0007260149088348294
Bond Position:  [9.99704508]


portfolio before change:  [9.92860164]
curr_Stock_Price:  97.71563294093136
curr_Factors:  [97.71563294 -1.08877492 -1.11980007]
mat_Sqrt:  [[10.73475454  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00493473 -0.00759384  0.13568628]
Stock Position:  0.004934730837924043
Bond Position:  [9.4464013]


portfolio before change:  [9.92904918]
curr_Stock_Price:  97.32769726763735
curr_Factors:  [97.32769727 -1.17284688 -1.08645133]
mat_Sqrt:  [[10.16332247  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.03188718 -0.23286401 -0.35431386]
Stock Position:  -0.03188717997255254
Bond Position:  [13.03255498]


portfolio before change:  [9.9020103]
curr_Stock_Price:  98.27784181826533
curr_Factors:  [98.27784182 -1.28589559 -1.08215825]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [9.9020103]
Stock Price:  97.72186101510516
PL:  [9.9020103]
Settle:  Tensor("sub_260:0", shape=(), dtype=float64)
PL:  Tensor("sub_261:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  131
output_Z_Vals[:, i, :]:  [[ 1.19251512e+02 -2.92846752e+01 -2.92776944e+01]
 [-9.12198228e-02  9.99212780e-03 -1.01792845e-01]
 [-6.32381059e-02  2.28809578e-02  9.72344377e-02]
 [-3.68024728e-02  3.80861783e-02  5.67433562e-02]
 [-8.73062648e-02 -1.45617885e-01  1.17439026e-01]
 [ 7.30194763e-03 -2.34668481e-02 -1.02913121e-02]
 [-7.05431800e-02 -3.16868946e-02  4.25452474e-02]
 [-4.65183800e-02  7.37697501e-02 -1.11893400e-01]
 [-2.23153314e-01 -1.01721681e-01  2.11101415e-01]
 [ 4.50470017e-02  4.74936917e-02 -1.18045691e-02]
 [ 2.78256144e-02  8.81160357e-02 -1.20585887e-02]
 [ 1.49098579e-01 -1.20713502e-02 -1.53669538e-01]
 [ 4.61272320e-02 -1.21809560e-02 -3.34070056e-01]
 [-8.35278501e-02  3.00516939e-02 -3.36375189e-02]
 [-9.38611514e-02  2.58743945e-02  1.75090007e-01]
 [-2.83971251e-02 -7.55747314e-02  1.22905764e-01]
 [-2.52611695e-02  7.66606734e-02  1.07151163e-01]
 [-1.91758958e-02  5.99293975e-02 -9.04399611e-02]
 [-3.47854747e-01 -9.12926760e-01 -1.85569442e-01]
 [ 9.65429256e-02 -9.04521623e-02 -1.54207144e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.25151208 -29.28467519 -29.2776944 ]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  8.31409947  -9.26062741 -83.52111278]
init_Out:  [2.49223638]
Stock Position:  8.314099471154409
Bond position:  [-828.91771073]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [1.73901631]
curr_Stock_Price:  99.93433266642701
curr_Factors:  [99.93433267 -0.91909274 -1.03057572]
mat_Sqrt:  [[14.22277903  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00785643  0.00315979 -0.29038665]
Stock Position:  -0.007856425552128052
Bond Position:  [2.52414295]


portfolio before change:  [1.74514709]
curr_Stock_Price:  99.23431046838519
curr_Factors:  [99.23431047 -0.89497311 -1.00006843]
mat_Sqrt:  [[14.91611673  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00286934  0.00723559  0.27738279]
Stock Position:  -0.0028693410218542147
Bond Position:  [2.02988417]


portfolio before change:  [1.74993492]
curr_Stock_Price:  97.74257697625704
curr_Factors:  [97.74257698 -0.95331461 -0.93966324]
mat_Sqrt:  [[14.72224195  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00164624  0.01204391  0.161873  ]
Stock Position:  -0.0016462440245545446
Bond Position:  [1.91084305]


portfolio before change:  [1.74953058]
curr_Stock_Price:  98.27841289354299
curr_Factors:  [98.27841289 -1.36147857 -0.93949431]
mat_Sqrt:  [[ 9.84369865  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00681593 -0.04604842  0.33502085]
Stock Position:  -0.006815930073991371
Bond Position:  [2.41938937]


portfolio before change:  [1.74560578]
curr_Stock_Price:  98.94299066851376
curr_Factors:  [98.94299067 -1.31245362 -0.89396693]
mat_Sqrt:  [[10.89303164  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00042186 -0.00742087 -0.02935825]
Stock Position:  0.0004218596888566433
Bond Position:  [1.70386572]


portfolio before change:  [1.74585778]
curr_Stock_Price:  98.53047950409275
curr_Factors:  [98.5304795  -1.12195976 -0.89991339]
mat_Sqrt:  [[13.04614631  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00480424 -0.01002028  0.12136975]
Stock Position:  -0.0048042401412256505
Bond Position:  [2.21922187]


portfolio before change:  [1.74875752]
curr_Stock_Price:  98.042396658713
curr_Factors:  [98.04239666 -1.18658281 -0.90110174]
mat_Sqrt:  [[12.1546942   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00554961  0.02332804 -0.31920073]
Stock Position:  -0.005549608805452796
Bond Position:  [2.29285447]


portfolio before change:  [1.74208211]
curr_Stock_Price:  99.34856089416718
curr_Factors:  [99.34856089 -0.86161353 -0.91843963]
mat_Sqrt:  [[16.75306664  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0109048  -0.03216722  0.60221358]
Stock Position:  -0.010904801186599538
Bond Position:  [2.82545841]


portfolio before change:  [1.73115563]
curr_Stock_Price:  100.415332482876
curr_Factors:  [100.41533248  -0.71307042  -0.92211161]
mat_Sqrt:  [[19.57264403  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00224107  0.01501882 -0.03367515]
Stock Position:  0.0022410710543181458
Bond Position:  [1.50611773]


portfolio before change:  [1.73102985]
curr_Stock_Price:  100.19117330290663
curr_Factors:  [100.1911733   -0.852638    -0.92613637]
mat_Sqrt:  [[16.91677484  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00163384  0.02786474 -0.0343998 ]
Stock Position:  0.0016338404812800591
Bond Position:  [1.56733345]


portfolio before change:  [1.73310884]
curr_Stock_Price:  101.22377852534997
curr_Factors:  [101.22377853  -0.80904981  -0.89944155]
mat_Sqrt:  [[18.33555984  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00640391 -0.0038173  -0.43837642]
Stock Position:  0.00640390781064784
Bond Position:  [1.0848811]


portfolio before change:  [1.72960855]
curr_Stock_Price:  100.6348338633335
curr_Factors:  [100.63483386  -0.84884888  -0.91603329]
mat_Sqrt:  [[17.22938382  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00129889 -0.00385196 -0.95300888]
Stock Position:  -0.00129888822004396
Bond Position:  [1.86032195]


portfolio before change:  [1.73033095]
curr_Stock_Price:  100.43677408341799
curr_Factors:  [100.43677408  -0.53854132  -0.90081791]
mat_Sqrt:  [[23.81151251  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00376365  0.00950318 -0.09595848]
Stock Position:  -0.0037636478758348775
Bond Position:  [2.1083396]


portfolio before change:  [1.72475928]
curr_Stock_Price:  102.05722633976093
curr_Factors:  [102.05722634  -0.43440245  -0.90157576]
mat_Sqrt:  [[26.83093433  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0021413   0.0081822   0.49948305]
Stock Position:  -0.002141296263076589
Bond Position:  [1.94329404]


portfolio before change:  [1.72461573]
curr_Stock_Price:  102.3511770335173
curr_Factors:  [102.35117703  -0.87289024  -0.90033687]
mat_Sqrt:  [[17.37761193  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-3.02712613e-04 -2.38988285e-02  3.50615934e-01]
Stock Position:  -0.00030271261338036957
Bond Position:  [1.75559873]


portfolio before change:  [1.72542397]
curr_Stock_Price:  101.1312592143324
curr_Factors:  [101.13125921  -0.87435721  -0.90754158]
mat_Sqrt:  [[17.02223589  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-8.28128507e-05  2.42422335e-02  3.05672442e-01]
Stock Position:  -8.281285070650493e-05
Bond Position:  [1.73379894]


portfolio before change:  [1.72580136]
curr_Stock_Price:  101.8089171221539
curr_Factors:  [101.80891712  -0.66733771  -0.90176021]
mat_Sqrt:  [[21.19997037  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00170234  0.01895134 -0.25800004]
Stock Position:  -0.0017023375298812955
Bond Position:  [1.8991145]


portfolio before change:  [1.72836966]
curr_Stock_Price:  100.57915824276755
curr_Factors:  [100.57915824  -0.5776334   -0.90973109]
mat_Sqrt:  [[22.72761189  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01800918 -0.28869279 -0.52937796]
Stock Position:  -0.018009178457675107
Bond Position:  [3.53971767]


portfolio before change:  [1.72370159]
curr_Stock_Price:  100.88750728054065
curr_Factors:  [100.88750728  -0.521277    -0.91330228]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [1.72370159]
Stock Price:  100.52777515863559
PL:  [1.19592643]
Settle:  Tensor("sub_262:0", shape=(), dtype=float64)
PL:  Tensor("sub_263:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  132
output_Z_Vals[:, i, :]:  [[ 1.19251512e+02 -2.92846752e+01 -2.92776944e+01]
 [-1.76244409e-01  4.29814621e-02  2.90854914e-03]
 [-5.80026941e-02  2.29427176e-02  8.42589214e-02]
 [-2.72280386e-02  1.99031873e-02  1.44217767e-02]
 [-9.09443462e-02 -1.76018861e-01  1.48275007e-01]
 [-6.62390040e-02  4.23381684e-02 -1.06395496e-02]
 [-1.24719459e-01 -9.86939690e-02  8.89660488e-02]
 [-5.99865078e-02  1.11166228e-01 -8.83903240e-02]
 [-1.91258297e-01 -8.75058869e-02  1.79147728e-01]
 [ 4.53234463e-02  3.04311004e-02 -6.67285157e-03]
 [ 4.71714649e-02  7.35192774e-02 -1.34742223e-02]
 [ 1.01024045e-01 -1.06615133e-02 -1.32907589e-01]
 [ 4.95310619e-02 -9.85990532e-03 -2.79660514e-01]
 [-8.45720117e-02  2.97281712e-02 -3.59999752e-02]
 [-2.18796677e-02 -4.66733088e-02  2.06826761e-02]
 [-1.81647054e-02 -5.56973852e-02  1.14019631e-01]
 [-2.27998890e-02  3.99428806e-02  1.43763755e-01]
 [-4.30202310e-02  9.17350710e-02 -9.40995120e-02]
 [-3.32926102e-01 -9.74070908e-01 -1.78615968e-01]
 [ 8.51319055e-02 -5.20091285e-02 -1.08325942e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.25151208 -29.28467519 -29.2776944 ]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  8.31409947  -9.26062741 -83.52111278]
init_Out:  [2.49223638]
Stock Position:  8.314099471154409
Bond position:  [-828.91771073]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-1.89537834]
curr_Stock_Price:  99.49719637060576
curr_Factors:  [99.49719637 -1.08614536 -0.99520461]
mat_Sqrt:  [[12.41343673  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01406064  0.01359193  0.00829728]
Stock Position:  -0.014060644982784707
Bond Position:  [-0.49638358]


portfolio before change:  [-1.88823571]
curr_Stock_Price:  98.98038226207345
curr_Factors:  [98.98038226 -1.03815566 -1.02148409]
mat_Sqrt:  [[12.61998817  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0031863   0.00725512  0.24036725]
Stock Position:  -0.0031862973889757013
Bond Position:  [-1.57285478]


portfolio before change:  [-1.89050163]
curr_Stock_Price:  99.56810394789625
curr_Factors:  [99.56810395 -1.15255805 -1.04025928]
mat_Sqrt:  [[11.11198826  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00213916  0.00629394  0.04114131]
Stock Position:  -0.0021391588180427554
Bond Position:  [-1.67750964]


portfolio before change:  [-1.89121023]
curr_Stock_Price:  99.70328337455987
curr_Factors:  [99.70328337 -0.74734963 -1.06416466]
mat_Sqrt:  [[16.29216501  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00400331 -0.05566205  0.42298732]
Stock Position:  -0.0040033123069504436
Bond Position:  [-1.49206685]


portfolio before change:  [-1.88702657]
curr_Stock_Price:  98.5650454724383
curr_Factors:  [98.56504547 -0.51250077 -1.06814968]
mat_Sqrt:  [[20.28874371  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00331798  0.0133885  -0.03035167]
Stock Position:  -0.0033179790267997716
Bond Position:  [-1.55998982]


portfolio before change:  [-1.88466121]
curr_Stock_Price:  97.73459770564115
curr_Factors:  [97.73459771 -0.46786161 -1.0275685 ]
mat_Sqrt:  [[21.90742242  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00498039 -0.03120977  0.25379537]
Stock Position:  -0.004980394581200906
Bond Position:  [-1.39790435]


portfolio before change:  [-1.88774655]
curr_Stock_Price:  98.28391654008387
curr_Factors:  [98.28391654 -0.44579575 -1.01387116]
mat_Sqrt:  [[22.83269483  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00329172  0.03515385 -0.25215299]
Stock Position:  -0.003291718651913076
Bond Position:  [-1.56422355]


portfolio before change:  [-1.89464064]
curr_Stock_Price:  100.25947415572169
curr_Factors:  [100.25947416  -0.67415107  -1.01221324]
mat_Sqrt:  [[18.56721251  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00845304 -0.02767179  0.5110586 ]
Stock Position:  -0.00845303583053442
Bond Position:  [-1.04714371]


portfolio before change:  [-1.91875108]
curr_Stock_Price:  103.08078305908326
curr_Factors:  [103.08078306  -1.12024585  -1.01335985]
mat_Sqrt:  [[12.20575163  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00366607  0.00962316 -0.01903579]
Stock Position:  0.003666065408273283
Bond Position:  [-2.29665197]


portfolio before change:  [-1.92680273]
curr_Stock_Price:  101.04115477000327
curr_Factors:  [101.04115477  -0.89793977  -0.99924431]
mat_Sqrt:  [[15.1552018   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00305633  0.02324884 -0.03843821]
Stock Position:  0.003056330818651891
Bond Position:  [-2.23561792]


portfolio before change:  [-1.92823003]
curr_Stock_Price:  100.75704594667832
curr_Factors:  [100.75704595  -1.06244441  -0.9896282 ]
mat_Sqrt:  [[12.94409271  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00568747 -0.00337147 -0.37914836]
Stock Position:  0.005687468408734295
Bond Position:  [-2.50128255]


portfolio before change:  [-1.92998374]
curr_Stock_Price:  100.55866006504903
curr_Factors:  [100.55866007  -1.09150155  -0.97271418]
mat_Sqrt:  [[12.76268285  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-6.11860634e-04 -3.11797583e-03 -7.97793605e-01]
Stock Position:  -0.0006118606343499338
Bond Position:  [-1.86845586]


portfolio before change:  [-1.93090812]
curr_Stock_Price:  101.30589137982506
curr_Factors:  [101.30589138  -0.76203495  -1.01426529]
mat_Sqrt:  [[17.14736164  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00531586  0.00940087 -0.10269791]
Stock Position:  -0.00531585556228675
Bond Position:  [-1.39238063]


portfolio before change:  [-1.92413788]
curr_Stock_Price:  99.96680770439889
curr_Factors:  [99.9668077  -0.9182544  -0.97113409]
mat_Sqrt:  [[15.11140449  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00124826 -0.0147594   0.05900192]
Stock Position:  -0.0012482581462784944
Bond Position:  [-1.7993535]


portfolio before change:  [-1.92687731]
curr_Stock_Price:  101.80098837089437
curr_Factors:  [101.80098837  -1.00722548  -0.98697544]
mat_Sqrt:  [[13.85739311  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 2.64938294e-04 -1.76130597e-02  3.25266271e-01]
Stock Position:  0.00026493829424587456
Bond Position:  [-1.95384829]


portfolio before change:  [-1.92724921]
curr_Stock_Price:  102.24115362176927
curr_Factors:  [102.24115362  -0.64147787  -0.99441243]
mat_Sqrt:  [[19.91441764  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [3.80482395e-04 1.26310479e-02 4.10117977e-01]
Stock Position:  0.00038048239513705135
Bond Position:  [-1.96615017]


portfolio before change:  [-1.92752554]
curr_Stock_Price:  102.80692988313807
curr_Factors:  [102.80692988  -0.60550319  -0.98403103]
mat_Sqrt:  [[20.97473323  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00285389  0.02900918 -0.26843972]
Stock Position:  -0.002853892034996127
Bond Position:  [-1.63412567]


portfolio before change:  [-1.93314692]
curr_Stock_Price:  104.63348440256
curr_Factors:  [104.6334844   -0.72992531  -1.01215811]
mat_Sqrt:  [[18.32708826  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0215275  -0.30802827 -0.50954164]
Stock Position:  -0.021527496952752127
Bond Position:  [0.3193501]


portfolio before change:  [-1.92715456]
curr_Stock_Price:  104.35883525804913
curr_Factors:  [104.35883526  -0.69218345  -0.98985843]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-1.92715456]
Stock Price:  102.84922572455447
PL:  [-4.77638028]
Settle:  Tensor("sub_264:0", shape=(), dtype=float64)
PL:  Tensor("sub_265:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  133
output_Z_Vals[:, i, :]:  [[ 1.19251512e+02 -2.92846752e+01 -2.92776944e+01]
 [-3.21785550e-02 -3.98837059e-02 -1.73564351e-01]
 [-1.41275654e-01  1.68840756e-03  1.30304282e-01]
 [-2.77686482e-02  4.37088351e-02  7.40833424e-02]
 [-8.79866046e-02 -1.51303023e-01  1.23205512e-01]
 [-1.02200435e-01  5.76243856e-02 -7.55343287e-03]
 [ 2.46752084e-02  1.38486784e-02 -1.30563300e-03]
 [-1.21516645e-01  1.86502768e-01 -6.80486816e-02]
 [-1.62110453e-01 -7.28102398e-02  1.45844741e-01]
 [-6.42529751e-02 -4.32362257e-02 -3.58033715e-02]
 [ 1.72761085e-01 -4.37577703e-02 -5.24121610e-02]
 [ 1.56278892e-01 -1.22819205e-02 -1.56770500e-01]
 [ 3.85956400e-02 -1.31045508e-02 -2.38733802e-01]
 [-8.21082599e-02  2.82485358e-02 -3.53651649e-02]
 [-9.33442862e-02  2.53151600e-02  1.75097330e-01]
 [-2.07631147e-02 -5.65575340e-02  1.15315596e-01]
 [-2.36875440e-02  1.73286013e-02  1.76551117e-01]
 [-1.04091896e-01  1.78156764e-01 -8.97457464e-02]
 [-3.42214597e-01 -9.61482456e-01 -1.79911814e-01]
 [ 7.77660996e-02 -4.73011886e-02 -9.84394511e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.25151208 -29.28467519 -29.2776944 ]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  8.31409947  -9.26062741 -83.52111278]
init_Out:  [2.49223638]
Stock Position:  8.314099471154409
Bond position:  [-828.91771073]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [6.33788679]
curr_Stock_Price:  100.48747380872294
curr_Factors:  [100.48747381  -1.25290789  -0.96673242]
mat_Sqrt:  [[10.91778129  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00628672 -0.01261234 -0.49513078]
Stock Position:  -0.006286718956156053
Bond Position:  [6.96962329]


portfolio before change:  [6.34408218]
curr_Stock_Price:  99.7791920024372
curr_Factors:  [99.779192   -0.95862245 -0.95395765]
mat_Sqrt:  [[14.7372686   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0077785   0.00053392  0.37172185]
Stock Position:  -0.007778497658292782
Bond Position:  [7.12021439]


portfolio before change:  [6.35976027]
curr_Stock_Price:  97.99249504490204
curr_Factors:  [97.99249504 -1.0882292  -0.94546243]
mat_Sqrt:  [[12.8224721   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00089826  0.01382195  0.21133916]
Stock Position:  -0.0008982582979257717
Bond Position:  [6.44778285]


portfolio before change:  [6.36071794]
curr_Stock_Price:  98.72110384459842
curr_Factors:  [98.72110384 -0.9261204  -0.94624658]
mat_Sqrt:  [[15.17928641  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00439705 -0.04784622  0.35147103]
Stock Position:  -0.00439704543724753
Bond Position:  [6.79479912]


portfolio before change:  [6.36725225]
curr_Stock_Price:  97.62141182557355
curr_Factors:  [97.62141183 -0.57286901 -0.94760342]
mat_Sqrt:  [[21.34087862  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00479148  0.01822243 -0.02154784]
Stock Position:  -0.004791481139595202
Bond Position:  [6.8350034]


portfolio before change:  [6.35846748]
curr_Stock_Price:  99.81149249951292
curr_Factors:  [99.8114925  -0.66063556 -0.98776263]
mat_Sqrt:  [[19.1995173   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00128994  0.00437934 -0.00372461]
Stock Position:  0.0012899422484450856
Bond Position:  [6.22971642]


portfolio before change:  [6.36219805]
curr_Stock_Price:  101.49601693602415
curr_Factors:  [101.49601694  -0.64710293  -0.98297511]
mat_Sqrt:  [[19.88451947  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0065675   0.05897735 -0.19412395]
Stock Position:  -0.006567498058981053
Bond Position:  [7.02877294]


portfolio before change:  [6.36539416]
curr_Stock_Price:  101.27695329955962
curr_Factors:  [101.2769533   -0.46898567  -0.96332309]
mat_Sqrt:  [[24.1805868   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00555073 -0.02302462  0.41605445]
Stock Position:  -0.005550732640575721
Bond Position:  [6.92755545]


portfolio before change:  [6.34075178]
curr_Stock_Price:  106.02848616779042
curr_Factors:  [106.02848617  -0.58717676  -0.99217813]
mat_Sqrt:  [[21.85332111  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0033257  -0.0136725  -0.10213705]
Stock Position:  -0.003325703303909877
Bond Position:  [6.69337106]


portfolio before change:  [6.34766698]
curr_Stock_Price:  104.45238233622975
curr_Factors:  [104.45238234  -0.52992701  -1.04499117]
mat_Sqrt:  [[21.62420129  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00744225 -0.01383742 -0.14951731]
Stock Position:  0.0074422483809561965
Bond Position:  [5.57030641]


portfolio before change:  [6.33821721]
curr_Stock_Price:  102.9954939172759
curr_Factors:  [102.99549392  -0.37817735  -1.04581801]
mat_Sqrt:  [[24.79618654  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0049992  -0.00388388 -0.4472226 ]
Stock Position:  0.0049992013883496675
Bond Position:  [5.82332199]


portfolio before change:  [6.34892014]
curr_Stock_Price:  104.84517298186272
curr_Factors:  [104.84517298  -0.66596808  -1.04926272]
mat_Sqrt:  [[18.86397305  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-5.55241000e-04 -4.14402283e-03 -6.81041086e-01]
Stock Position:  -0.0005552410001148699
Bond Position:  [6.40713448]


portfolio before change:  [6.35086141]
curr_Stock_Price:  104.23410125837472
curr_Factors:  [104.23410126  -0.74445382  -1.0980983 ]
mat_Sqrt:  [[16.51199731  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00536566  0.00893297 -0.10088697]
Stock Position:  -0.005365660387715017
Bond Position:  [6.9101462]


portfolio before change:  [6.360102]
curr_Stock_Price:  102.83393111517087
curr_Factors:  [102.83393112  -0.82368392  -1.10294214]
mat_Sqrt:  [[14.97660476  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00380253  0.00800536  0.49950394]
Stock Position:  -0.0038025346618692263
Bond Position:  [6.75113159]


portfolio before change:  [6.36526059]
curr_Stock_Price:  101.92122515104113
curr_Factors:  [101.92122515  -0.83085022  -1.07582112]
mat_Sqrt:  [[15.14285608  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 8.68576911e-05 -1.78850626e-02  3.28963298e-01]
Stock Position:  8.685769112135849e-05
Bond Position:  [6.35640795]


portfolio before change:  [6.36695664]
curr_Stock_Price:  103.15016703249465
curr_Factors:  [103.15016703  -0.63233573  -1.08425222]
mat_Sqrt:  [[18.53383364  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00069053 0.00547978 0.50365119]
Stock Position:  0.0006905330326478523
Bond Position:  [6.29572804]


portfolio before change:  [6.36955268]
curr_Stock_Price:  104.63006275424875
curr_Factors:  [104.63006275  -0.9056846   -1.08168215]
mat_Sqrt:  [[14.34016254  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00821547  0.05633812 -0.25601963]
Stock Position:  -0.008215470469049448
Bond Position:  [7.22913787]


portfolio before change:  [6.38138163]
curr_Stock_Price:  103.41023794270983
curr_Factors:  [103.41023794  -0.74138495  -1.0486459 ]
mat_Sqrt:  [[17.26485827  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02338648 -0.30404745 -0.51323833]
Stock Position:  -0.023386482867481934
Bond Position:  [8.79978339]


portfolio before change:  [6.41005899]
curr_Stock_Price:  102.27808216142523
curr_Factors:  [102.27808216  -0.25727529  -1.09918549]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [6.41005899]
Stock Price:  103.1910898276347
PL:  [3.21896916]
Settle:  Tensor("sub_266:0", shape=(), dtype=float64)
PL:  Tensor("sub_267:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  134
output_Z_Vals[:, i, :]:  [[ 1.19251512e+02 -2.92846752e+01 -2.92776944e+01]
 [-1.44664986e-01  3.65381132e-02 -6.62466946e-03]
 [-6.30739880e-02  1.99349542e-02  7.35112068e-02]
 [-4.83076632e-02 -1.41994374e-02 -8.24774572e-02]
 [-9.14009195e-02 -1.79834133e-01  1.52144872e-01]
 [-8.44445078e-02  5.06444581e-02 -9.51928888e-03]
 [-9.82121747e-02 -6.68538824e-02  6.67748007e-02]
 [-5.17036723e-02  9.76064511e-02 -9.16441621e-02]
 [-2.17424305e-01 -9.98149875e-02  2.06918357e-01]
 [ 6.19293904e-02  5.08943448e-02 -2.96053781e-03]
 [ 4.16895589e-02  7.98972576e-02 -1.12605133e-02]
 [ 1.44393674e-01 -1.19333739e-02 -1.51637631e-01]
 [ 3.56192061e-02 -1.53435765e-02 -2.97036723e-01]
 [-8.45720117e-02  2.97281712e-02 -3.59999752e-02]
 [-1.13617790e-01  5.98741525e-02  2.30971287e-01]
 [-1.08255740e-01 -2.13302905e-01  1.88265007e-01]
 [-2.68159057e-02 -7.29577490e-03  2.21461019e-01]
 [-1.30540694e-01  2.16626170e-01 -8.49756740e-02]
 [-3.06290598e-01 -9.50515066e-01 -1.21081704e-01]
 [ 6.73248193e-02 -1.52688812e-02 -5.95421136e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.25151208 -29.28467519 -29.2776944 ]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  8.31409947  -9.26062741 -83.52111278]
init_Out:  [2.49223638]
Stock Position:  8.314099471154409
Bond position:  [-828.91771073]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-5.75869671]
curr_Stock_Price:  99.03252567695503
curr_Factors:  [99.03252568 -0.47496617 -0.99042775]
mat_Sqrt:  [[22.87522447  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00634196  0.01155437 -0.01889834]
Stock Position:  -0.0063419631592401705
Bond Position:  [-5.13063608]


portfolio before change:  [-5.75909232]
curr_Stock_Price:  98.8926310362432
curr_Factors:  [98.89263104 -0.54604241 -0.98819784]
mat_Sqrt:  [[21.32317443  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00223015  0.00630399  0.20970701]
Stock Position:  -0.0022301490599099505
Bond Position:  [-5.53854701]


portfolio before change:  [-5.76255171]
curr_Stock_Price:  99.82287316910748
curr_Factors:  [99.82287317 -0.56107028 -0.94696655]
mat_Sqrt:  [[22.09520286  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00296489 -0.00449026 -0.23528523]
Stock Position:  -0.002964893869829217
Bond Position:  [-5.46658748]


portfolio before change:  [-5.75993508]
curr_Stock_Price:  98.47933683176997
curr_Factors:  [98.47933683 -0.38053336 -0.96305728]
mat_Sqrt:  [[25.69396415  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0025293  -0.05686855  0.43402697]
Stock Position:  -0.002529301224125776
Bond Position:  [-5.51085118]


portfolio before change:  [-5.76052665]
curr_Stock_Price:  98.16845245232342
curr_Factors:  [98.16845245 -0.50497427 -1.02234262]
mat_Sqrt:  [[21.31408263  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00399173  0.01601518 -0.02715588]
Stock Position:  -0.003991726584312769
Bond Position:  [-5.36866503]


portfolio before change:  [-5.7619139]
curr_Stock_Price:  98.1797050335504
curr_Factors:  [98.17970503 -0.60554438 -1.01736488]
mat_Sqrt:  [[19.37319211  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00445502 -0.02114105  0.19048992]
Stock Position:  -0.004455021398573683
Bond Position:  [-5.32452121]


portfolio before change:  [-5.76174559]
curr_Stock_Price:  97.84309464960576
curr_Factors:  [97.84309465 -0.44373125 -1.01460873]
mat_Sqrt:  [[22.76046726  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00298282  0.03086587 -0.26143529]
Stock Position:  -0.002982815337284779
Bond Position:  [-5.46989771]


portfolio before change:  [-5.76810012]
curr_Stock_Price:  99.5149676960618
curr_Factors:  [99.5149677  -0.79491334 -1.02043716]
mat_Sqrt:  [[16.19913039  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01097371 -0.03156427  0.59028048]
Stock Position:  -0.010973705400934498
Bond Position:  [-4.67605218]


portfolio before change:  [-5.7575023]
curr_Stock_Price:  98.44267866040138
curr_Factors:  [98.44267866 -0.67473649 -1.02797852]
mat_Sqrt:  [[17.93509527  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00349255  0.0160942  -0.00844559]
Stock Position:  0.0034925467929438794
Bond Position:  [-6.10131796]


portfolio before change:  [-5.75680538]
curr_Stock_Price:  99.07901676818615
curr_Factors:  [99.07901677 -0.71667994 -1.01074731]
mat_Sqrt:  [[17.61041402  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00235395  0.02526573 -0.03212311]
Stock Position:  0.002353945483025222
Bond Position:  [-5.99003198]


portfolio before change:  [-5.75438857]
curr_Stock_Price:  100.74197157567605
curr_Factors:  [100.74197158  -0.68898941  -1.02327769]
mat_Sqrt:  [[18.17951514  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00622308 -0.00377366 -0.43257995]
Stock Position:  0.006223084248230574
Bond Position:  [-6.38131434]


portfolio before change:  [-5.74297132]
curr_Stock_Price:  102.83302132720104
curr_Factors:  [102.83302133  -0.53663174  -1.07281758]
mat_Sqrt:  [[20.56636968  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00123548 -0.00485206 -0.84736309]
Stock Position:  -0.0012354796159214758
Bond Position:  [-5.61592322]


portfolio before change:  [-5.74524282]
curr_Stock_Price:  103.53505501014712
curr_Factors:  [103.53505501  -0.76427988  -1.05522742]
mat_Sqrt:  [[16.78361232  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00543107  0.00940087 -0.10269791]
Stock Position:  -0.00543106549620643
Bond Position:  [-5.18293716]


portfolio before change:  [-5.74769697]
curr_Stock_Price:  103.74831886994673
curr_Factors:  [103.74831887  -0.86303959  -1.04701655]
mat_Sqrt:  [[15.3622287   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00422628  0.01893387  0.65889679]
Stock Position:  -0.0042262767268340775
Bond Position:  [-5.30922786]


portfolio before change:  [-5.75478781]
curr_Stock_Price:  105.1120181042604
curr_Factors:  [105.1120181   -1.19811179  -1.10210154]
mat_Sqrt:  [[10.53616152  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00715002 -0.0674523   0.53706766]
Stock Position:  -0.007150019764497349
Bond Position:  [-5.0032348]


portfolio before change:  [-5.75403079]
curr_Stock_Price:  104.83118199976776
curr_Factors:  [104.831182    -1.16367471  -1.06678694]
mat_Sqrt:  [[11.2671297   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00161543 -0.00230713  0.63176665]
Stock Position:  0.0016154300118991012
Bond Position:  [-5.92337823]


portfolio before change:  [-5.75440284]
curr_Stock_Price:  105.51767412794084
curr_Factors:  [105.51767413  -1.19868566  -1.07503289]
mat_Sqrt:  [[10.86079931  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01310152  0.06850321 -0.24241195]
Stock Position:  -0.013101523501986767
Bond Position:  [-4.37196055]


portfolio before change:  [-5.75574702]
curr_Stock_Price:  105.53683573867943
curr_Factors:  [105.53683574  -1.17933326  -1.07460224]
mat_Sqrt:  [[11.07981016  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.03208976 -0.30057926 -0.3454124 ]
Stock Position:  -0.032089763792019645
Bond Position:  [-2.36909488]


portfolio before change:  [-5.74154364]
curr_Stock_Price:  105.07576291265364
curr_Factors:  [105.07576291  -1.31906694  -1.05308005]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-5.74154364]
Stock Price:  105.18863879076689
PL:  [-10.93018244]
Settle:  Tensor("sub_268:0", shape=(), dtype=float64)
PL:  Tensor("sub_269:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  135
output_Z_Vals[:, i, :]:  [[ 1.19251512e+02 -2.92846752e+01 -2.92776944e+01]
 [-1.39594548e-02 -9.69840181e-02 -2.93428624e-01]
 [-2.48381929e-01 -2.73982970e-02  1.75692534e-01]
 [ 1.17851850e-01 -1.39293500e-01 -4.10785585e-01]
 [-9.88296441e-02 -2.41910939e-01  2.15109929e-01]
 [-3.24151925e-01  9.32991407e-02 -6.63096304e-03]
 [ 5.48783161e-02  4.57051068e-02 -2.27853471e-02]
 [-1.11033269e-01  1.71894922e-01 -6.81552146e-02]
 [-2.69631917e-01 -1.31133657e-01  2.78593753e-01]
 [ 3.12621993e-02  2.25488162e-02  6.13864765e-03]
 [ 6.86911321e-02  6.13308556e-02 -7.73810350e-03]
 [-4.39757066e-02 -9.55531336e-03 -1.25207903e-01]
 [ 9.09885122e-04 -2.13186970e-01 -3.62183962e-01]
 [ 2.70029046e-02 -8.74071595e-03  3.50157075e-03]
 [ 1.11348156e-02 -5.79141975e-02 -1.09473076e-01]
 [ 1.63844432e-01  2.34397508e-02 -5.68021721e-02]
 [-2.35647895e-02  1.03259148e-01  6.82888801e-02]
 [ 3.32621518e-02 -1.02425349e-02  1.05592847e-02]
 [-3.45217014e-01 -8.66339037e-01 -1.82626035e-01]
 [ 1.52756284e-01 -2.42191473e-01 -4.18033838e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.25151208 -29.28467519 -29.2776944 ]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  8.31409947  -9.26062741 -83.52111278]
init_Out:  [2.49223638]
Stock Position:  8.314099471154409
Bond position:  [-828.91771073]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [13.65449182]
curr_Stock_Price:  101.36749756349455
curr_Factors:  [101.36749756  -1.21147895  -0.99706325]
mat_Sqrt:  [[11.13630293  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0068568  -0.03066904 -0.83707019]
Stock Position:  -0.00685680327745391
Bond Position:  [14.34954881]


portfolio before change:  [13.66302805]
curr_Stock_Price:  100.64582162472506
curr_Factors:  [100.64582162  -0.76703635  -0.97567254]
mat_Sqrt:  [[17.617606    0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01210302 -0.0086641   0.5012019 ]
Stock Position:  -0.012103021340848348
Bond Position:  [14.88114657]


portfolio before change:  [13.63570377]
curr_Stock_Price:  103.21088597051101
curr_Factors:  [103.21088597  -0.17129789  -0.99366394]
mat_Sqrt:  [[32.19504319  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 9.44370569e-04 -4.40484723e-02 -1.17185693e+00]
Stock Position:  0.0009443705692012145
Bond Position:  [13.53823445]


portfolio before change:  [13.6378406]
curr_Stock_Price:  101.88920526174324
curr_Factors:  [101.88920526  -0.40234272  -1.00050024]
mat_Sqrt:  [[25.05423931  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00244137 -0.07649896  0.61364875]
Stock Position:  -0.0024413683649644746
Bond Position:  [13.88658968]


portfolio before change:  [13.6389254]
curr_Stock_Price:  102.86705028062632
curr_Factors:  [102.86705028  -0.31353442  -1.02429527]
mat_Sqrt:  [[26.99381277  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01196928  0.02950378 -0.01891629]
Stock Position:  -0.01196927953464573
Bond Position:  [14.87016988]


portfolio before change:  [13.65970527]
curr_Stock_Price:  101.4415786154274
curr_Factors:  [101.44157862  -0.3178104   -1.02476148]
mat_Sqrt:  [[26.49381145  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00194035  0.01445322 -0.06500025]
Stock Position:  0.0019403541652526645
Bond Position:  [13.46287268]


portfolio before change:  [13.66195614]
curr_Stock_Price:  100.86680166778982
curr_Factors:  [100.86680167  -0.50502212  -0.98753808]
mat_Sqrt:  [[22.67449338  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00531465  0.05435795 -0.19442786]
Stock Position:  -0.005314653981384153
Bond Position:  [14.19802829]


portfolio before change:  [13.67990793]
curr_Stock_Price:  98.1569666135475
curr_Factors:  [98.15696661 -0.71610121 -1.00829909]
mat_Sqrt:  [[17.49941745  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01235184 -0.0414681   0.79475043]
Stock Position:  -0.01235184328731458
Bond Position:  [14.8923274]


portfolio before change:  [13.69800732]
curr_Stock_Price:  96.99310456891202
curr_Factors:  [96.99310457 -0.63594609 -1.00551041]
mat_Sqrt:  [[18.78734284  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00176169 0.00713056 0.01751185]
Stock Position:  0.0017616889066448566
Bond Position:  [13.52713564]


portfolio before change:  [13.70337127]
curr_Stock_Price:  98.11801995756842
curr_Factors:  [98.11801996 -0.43419552 -1.02087385]
mat_Sqrt:  [[22.89919292  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00299989  0.01939452 -0.02207466]
Stock Position:  0.002999894120764146
Bond Position:  [13.4090276]


portfolio before change:  [13.70056734]
curr_Stock_Price:  96.06574322241327
curr_Factors:  [96.06574322 -0.61562567 -0.98067332]
mat_Sqrt:  [[19.46725432  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0035845  -0.00302166 -0.3571833 ]
Stock Position:  -0.0035845003462015817
Bond Position:  [14.04491503]


portfolio before change:  [13.70055796]
curr_Stock_Price:  97.04803985967943
curr_Factors:  [97.04803986 -0.59492734 -1.0149497 ]
mat_Sqrt:  [[19.40108656  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00404746 -0.06741564 -1.03321003]
Stock Position:  -0.004047457349705572
Bond Position:  [14.09335576]


portfolio before change:  [13.70757663]
curr_Stock_Price:  96.18456340181585
curr_Factors:  [96.1845634  -0.51386765 -0.97243467]
mat_Sqrt:  [[21.75767467  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00126355 -0.00276406  0.00998901]
Stock Position:  0.0012635530160689263
Bond Position:  [13.58604233]


portfolio before change:  [13.71011493]
curr_Stock_Price:  95.50503003005416
curr_Factors:  [95.50503003 -0.60921714 -0.94235764]
mat_Sqrt:  [[20.23885223  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00062783 -0.01831408 -0.31229621]
Stock Position:  -0.0006278330666851621
Bond Position:  [13.77007615]


portfolio before change:  [13.71252616]
curr_Stock_Price:  97.148331295588
curr_Factors:  [97.1483313  -0.37157821 -0.95729022]
mat_Sqrt:  [[25.72261519  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00594243  0.0074123  -0.16204079]
Stock Position:  0.005942434208250381
Bond Position:  [13.1352286]


portfolio before change:  [13.71883302]
curr_Stock_Price:  97.65698438027641
curr_Factors:  [97.65698438 -0.29812484 -0.9406277 ]
mat_Sqrt:  [[28.29566584  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00024595  0.03265341  0.19480917]
Stock Position:  -0.0002459472254292185
Bond Position:  [13.74285148]


portfolio before change:  [13.72225512]
curr_Stock_Price:  97.71408596160884
curr_Factors:  [97.71408596 -0.48641193 -0.90790526]
mat_Sqrt:  [[24.23331974  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00145061 -0.00323897  0.0301227 ]
Stock Position:  0.0014506099889809504
Bond Position:  [13.58051009]


portfolio before change:  [13.71765374]
curr_Stock_Price:  92.20128059030304
curr_Factors:  [92.20128059 -0.63940891 -0.92167374]
mat_Sqrt:  [[19.3538502   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02091905 -0.27396046 -0.52098124]
Stock Position:  -0.02091905079062568
Bond Position:  [15.64641701]


portfolio before change:  [13.73530967]
curr_Stock_Price:  91.54427971006439
curr_Factors:  [91.54427971 -0.36365545 -0.93155137]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [13.73530967]
Stock Price:  91.35386558443074
PL:  [13.73530967]
Settle:  Tensor("sub_270:0", shape=(), dtype=float64)
PL:  Tensor("sub_271:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  136
output_Z_Vals[:, i, :]:  [[ 1.19251512e+02 -2.92846752e+01 -2.92776944e+01]
 [ 2.65679042e-02 -1.70354055e-02  2.48019486e-04]
 [-1.23240874e-01  6.58608813e-03  1.22661713e-01]
 [-2.87222116e-02  3.57686029e-02  5.37815269e-02]
 [-9.53381780e-02 -2.12735129e-01  1.85516645e-01]
 [-2.01174621e-01 -4.32367692e-03  1.21873906e-03]
 [ 5.13493202e-02  1.04418917e-01 -4.58109615e-02]
 [-2.16808211e-01  3.17911283e-01 -3.21870758e-02]
 [-6.23045241e-02 -1.54626277e-02  5.23440484e-03]
 [-1.39966864e-01 -1.12401879e-01 -5.67004902e-02]
 [ 2.95017211e-01 -1.84959973e-01 -1.21002338e-01]
 [-1.23013867e-01  8.10082390e-02  9.15777577e-02]
 [ 4.87322043e-02 -6.29474239e-03 -8.19397466e-02]
 [ 7.44149340e-03  5.20715281e-03  1.00579498e-01]
 [-2.29773971e-01  2.23576239e-01  3.98491502e-01]
 [-1.92172193e-01 -3.63966212e-01  2.58307179e-01]
 [-6.26940467e-02 -1.52116769e-01  2.47707895e-01]
 [-2.29538678e-01  3.55830374e-01 -8.03721225e-02]
 [-2.92025787e-01 -1.01072356e+00 -1.49583769e-01]
 [ 1.20602745e-01 -6.85941913e-02 -1.49963068e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.25151208 -29.28467519 -29.2776944 ]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  8.31409947  -9.26062741 -83.52111278]
init_Out:  [2.49223638]
Stock Position:  8.314099471154409
Bond position:  [-828.91771073]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [5.18436621]
curr_Stock_Price:  100.34873111214068
curr_Factors:  [100.34873111  -0.91179261  -1.04295544]
mat_Sqrt:  [[14.2093952   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00184235 -0.00538707  0.00070753]
Stock Position:  0.001842349960283789
Bond Position:  [4.99948873]


portfolio before change:  [5.18388609]
curr_Stock_Price:  99.40963256848372
curr_Factors:  [99.40963257 -1.0960514  -1.0088888 ]
mat_Sqrt:  [[12.11335799  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00809293  0.0020827   0.34991972]
Stock Position:  -0.008092933818355864
Bond Position:  [5.98840166]


portfolio before change:  [5.1898053]
curr_Stock_Price:  98.86323943188907
curr_Factors:  [98.86323943 -0.75824481 -1.01740407]
mat_Sqrt:  [[16.74481405  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00100452  0.01131103  0.15342373]
Stock Position:  -0.0010045236659250282
Bond Position:  [5.28911576]


portfolio before change:  [5.18993476]
curr_Stock_Price:  100.0508456559014
curr_Factors:  [100.05084566  -0.79536436  -1.02348715]
mat_Sqrt:  [[16.22944194  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00387953 -0.06727275  0.52922735]
Stock Position:  -0.0038795264297710403
Bond Position:  [5.57808466]


portfolio before change:  [5.18452738]
curr_Stock_Price:  101.8041734291345
curr_Factors:  [101.80417343  -0.43587062  -1.00721821]
mat_Sqrt:  [[24.0458463   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00836059 -0.00136727  0.00347672]
Stock Position:  -0.008360590898212518
Bond Position:  [6.03567042]


portfolio before change:  [5.16595568]
curr_Stock_Price:  104.20601404488917
curr_Factors:  [104.20601404  -0.73186198  -0.97282756]
mat_Sqrt:  [[18.94765743  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00235883  0.03302016 -0.13068592]
Stock Position:  0.0023588288872556265
Bond Position:  [4.92015152]


portfolio before change:  [5.1723256]
curr_Stock_Price:  106.3849458940051
curr_Factors:  [106.38494589  -0.9533982   -0.98755027]
mat_Sqrt:  [[15.27344368  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01408785  0.10053237 -0.09182077]
Stock Position:  -0.014087846933437216
Bond Position:  [6.67106043]


portfolio before change:  [5.16088213]
curr_Stock_Price:  107.31563711224325
curr_Factors:  [107.31563711  -1.19372545  -1.0068085 ]
mat_Sqrt:  [[11.88456405  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00518616 -0.00488971  0.0149323 ]
Stock Position:  -0.0051861640660374525
Bond Position:  [5.71743864]


portfolio before change:  [5.15936527]
curr_Stock_Price:  107.88376395706956
curr_Factors:  [107.88376396  -1.09106934  -1.00971229]
mat_Sqrt:  [[13.20073828  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01169957 -0.0355446  -0.16175072]
Stock Position:  -0.011699573434518187
Bond Position:  [6.42155929]


portfolio before change:  [5.15488677]
curr_Stock_Price:  108.40379115396932
curr_Factors:  [108.40379115  -1.14714347  -1.01607219]
mat_Sqrt:  [[12.46154376  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.02130892 -0.05848948 -0.34518599]
Stock Position:  0.02130892222100923
Bond Position:  [2.84491881]


portfolio before change:  [5.14599794]
curr_Stock_Price:  107.95326867999552
curr_Factors:  [107.95326868  -0.96826878  -1.00314746]
mat_Sqrt:  [[15.03351731  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00680007  0.02561705  0.26124585]
Stock Position:  -0.00680007277126595
Bond Position:  [5.88008802]


portfolio before change:  [5.14161274]
curr_Stock_Price:  108.81434770183328
curr_Factors:  [108.8143477   -1.15873429  -0.9861162 ]
mat_Sqrt:  [[12.74058672  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0024994  -0.00199057 -0.23375129]
Stock Position:  0.0024993977714019918
Bond Position:  [4.86964241]


portfolio before change:  [5.14457332]
curr_Stock_Price:  109.51172188677326
curr_Factors:  [109.51172189  -0.98193603  -0.98272958]
mat_Sqrt:  [[15.35384581  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00183059 0.00164665 0.28692531]
Stock Position:  0.0018305931849744213
Bond Position:  [4.94410191]


portfolio before change:  [5.14580332]
curr_Stock_Price:  109.50834253958865
curr_Factors:  [109.50834254  -0.82418629  -0.97568004]
mat_Sqrt:  [[18.1040271   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00787999  0.07070101  1.13678534]
Stock Position:  -0.007879988184782197
Bond Position:  [6.00872776]


portfolio before change:  [5.15323281]
curr_Stock_Price:  108.7561677946461
curr_Factors:  [108.75616779  -0.77352188  -0.95141265]
mat_Sqrt:  [[19.37868704  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00768076 -0.11509622  0.73687848]
Stock Position:  -0.007680759148658252
Bond Position:  [5.98856274]


portfolio before change:  [5.15306822]
curr_Stock_Price:  108.97254294617755
curr_Factors:  [108.97254295  -0.82040537  -0.9219413 ]
mat_Sqrt:  [[19.08207259  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00084155 -0.04810355  0.70664168]
Stock Position:  -0.0008415502202742621
Bond Position:  [5.24477408]


portfolio before change:  [5.15511355]
curr_Stock_Price:  108.10036912217687
curr_Factors:  [108.10036912  -1.15308584  -0.93681987]
mat_Sqrt:  [[13.37188578  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01770559  0.11252344 -0.22927929]
Stock Position:  -0.017705585568923668
Bond Position:  [7.06909389]


portfolio before change:  [5.13903804]
curr_Stock_Price:  109.10813057378122
curr_Factors:  [109.10813057  -0.90240822  -0.94526842]
mat_Sqrt:  [[17.19575877  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02027571 -0.31961885 -0.42672086]
Stock Position:  -0.02027570987810496
Bond Position:  [7.35128284]


portfolio before change:  [5.10642525]
curr_Stock_Price:  110.80724929115645
curr_Factors:  [110.80724929  -1.28359327  -0.9734587 ]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [5.10642525]
Stock Price:  111.04382558660592
PL:  [-5.93740034]
Settle:  Tensor("sub_272:0", shape=(), dtype=float64)
PL:  Tensor("sub_273:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  137
output_Z_Vals[:, i, :]:  [[ 1.19251512e+02 -2.92846752e+01 -2.92776944e+01]
 [ 4.23193149e-02 -2.47975289e-02 -8.35522784e-03]
 [-2.93208659e-01 -3.95718309e-02  1.94688685e-01]
 [-3.88381922e-02  1.46459310e-02 -2.91302583e-03]
 [-9.31117347e-02 -1.94130254e-01  1.66645554e-01]
 [-3.07141679e-01  7.17686173e-02  7.16681663e-04]
 [ 5.10615817e-02  1.09206178e-01 -4.76883669e-02]
 [-2.23048041e-01  3.29661566e-01 -2.61588512e-02]
 [-5.93010422e-02 -1.41713814e-02  2.39729441e-03]
 [-1.57305347e-02  4.88568298e-05 -2.27525219e-02]
 [ 1.33052599e-01 -3.54196132e-03 -3.71922605e-02]
 [ 6.74013150e-02 -9.67549094e-03 -1.18386940e-01]
 [ 4.42133306e-02 -1.01843780e-02 -1.95567595e-01]
 [-8.45720117e-02  2.97281712e-02 -3.59999752e-02]
 [-9.81869017e-02  3.47451124e-02  1.93671283e-01]
 [-3.90763300e-02 -9.13441052e-02  1.31038474e-01]
 [-2.39932520e-02  3.32889977e-02  1.57381536e-01]
 [-2.57068357e-02  6.91518096e-02 -9.00281670e-02]
 [-3.48358865e-01 -9.12084619e-01 -1.76830883e-01]
 [ 8.64958056e-02 -6.73629026e-02 -1.24366919e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.25151208 -29.28467519 -29.2776944 ]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  8.31409947  -9.26062741 -83.52111278]
init_Out:  [2.49223638]
Stock Position:  8.314099471154409
Bond position:  [-828.91771073]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [6.10474947]
curr_Stock_Price:  100.45943261010206
curr_Factors:  [100.45943261  -0.90468078  -1.0222268 ]
mat_Sqrt:  [[14.62666758  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00273292 -0.00784167 -0.02383514]
Stock Position:  0.002732922007489392
Bond Position:  [5.83020168]


portfolio before change:  [6.10705608]
curr_Stock_Price:  100.77004491301214
curr_Factors:  [100.77004491  -0.8457695   -1.02289661]
mat_Sqrt:  [[15.55177876  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01636403 -0.01251371  0.55539263]
Stock Position:  -0.016364027675869166
Bond Position:  [7.75605989]


portfolio before change:  [6.13281866]
curr_Stock_Price:  99.31420998938219
curr_Factors:  [99.31420999 -0.70576498 -1.00540108]
mat_Sqrt:  [[17.94161009  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00217676  0.00463145 -0.00831005]
Stock Position:  -0.002176764214683584
Bond Position:  [6.34900228]


portfolio before change:  [6.13440586]
curr_Stock_Price:  99.3143253746903
curr_Factors:  [99.31432537 -0.43483693 -0.99849087]
mat_Sqrt:  [[23.68784459  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00270636 -0.06138938  0.47539338]
Stock Position:  -0.0027063574627271617
Bond Position:  [6.40318593]


portfolio before change:  [6.12627539]
curr_Stock_Price:  102.91010661390983
curr_Factors:  [102.91010661  -0.54238918  -1.01058951]
mat_Sqrt:  [[21.7774964   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01401182  0.02269523  0.00204449]
Stock Position:  -0.014011818584063584
Bond Position:  [7.56823313]


portfolio before change:  [6.09007117]
curr_Stock_Price:  105.6289909517588
curr_Factors:  [105.62899095  -0.90260562  -0.9907464 ]
mat_Sqrt:  [[15.90416221  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00277581  0.03453403 -0.13604164]
Stock Position:  0.00277580958961753
Bond Position:  [5.7968652]


portfolio before change:  [6.0940737]
curr_Stock_Price:  106.5487708316379
curr_Factors:  [106.54877083  -0.86699521  -1.07069915]
mat_Sqrt:  [[15.34682272  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01432713  0.10424814 -0.07462392]
Stock Position:  -0.01432712643171805
Bond Position:  [7.62061141]


portfolio before change:  [6.08392689]
curr_Stock_Price:  107.38998664148066
curr_Factors:  [107.38998664  -1.11636217  -1.04303464]
mat_Sqrt:  [[12.39223584  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00477538 -0.00448138  0.00683881]
Stock Position:  -0.004775377159575865
Bond Position:  [6.59675458]


portfolio before change:  [6.09763936]
curr_Stock_Price:  104.86388719858729
curr_Factors:  [104.8638872   -0.60218652  -1.00011712]
mat_Sqrt:  [[21.12293793  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-9.64525504e-04  1.54498861e-05 -6.49066119e-02]
Stock Position:  -0.0009645255035232082
Bond Position:  [6.19878325]


portfolio before change:  [6.10069097]
curr_Stock_Price:  103.30693533079288
curr_Factors:  [103.30693533  -0.19892689  -0.98797242]
mat_Sqrt:  [[31.52576666  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00397673 -0.00112007 -0.10609917]
Stock Position:  0.003976725102567701
Bond Position:  [5.68986769]


portfolio before change:  [6.10372775]
curr_Stock_Price:  103.71283173121489
curr_Factors:  [103.71283173  -0.61649862  -1.00038881]
mat_Sqrt:  [[20.58861841  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00208785 -0.00305966 -0.33772499]
Stock Position:  0.0020878458670717595
Bond Position:  [5.88719134]


portfolio before change:  [6.10580222]
curr_Stock_Price:  104.00140046226326
curr_Factors:  [104.00140046  -0.99353746  -1.01888693]
mat_Sqrt:  [[13.90126689  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 2.89923418e-04 -3.22058310e-03 -5.57899914e-01]
Stock Position:  0.0002899234179655663
Bond Position:  [6.07564978]


portfolio before change:  [6.10675827]
curr_Stock_Price:  102.05933234042931
curr_Factors:  [102.05933234  -0.97490609  -0.99870081]
mat_Sqrt:  [[14.18162953  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00642753  0.00940087 -0.10269791]
Stock Position:  -0.006427533419439192
Bond Position:  [6.76274804]


portfolio before change:  [6.10363648]
curr_Stock_Price:  102.8080937587829
curr_Factors:  [102.80809376  -0.88223094  -1.02189612]
mat_Sqrt:  [[15.31353419  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00377162  0.01098737  0.55249026]
Stock Position:  -0.0037716180301216326
Bond Position:  [6.49138934]


portfolio before change:  [6.10605747]
curr_Stock_Price:  102.59653108325357
curr_Factors:  [102.59653108  -0.97730685  -1.02947037]
mat_Sqrt:  [[13.7911474   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00106494 -0.02888554  0.37381629]
Stock Position:  -0.0010649373619803844
Bond Position:  [6.21531634]


portfolio before change:  [6.1073471]
curr_Stock_Price:  102.84479859949268
curr_Factors:  [102.8447986   -0.84885965  -1.0743588 ]
mat_Sqrt:  [[15.02931436  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00059827 0.01052691 0.44896572]
Stock Position:  0.0005982733159424179
Bond Position:  [6.0458178]


portfolio before change:  [6.10860169]
curr_Stock_Price:  102.4151351781795
curr_Factors:  [102.41513518  -0.79663082  -1.07832641]
mat_Sqrt:  [[15.70654135  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00269304  0.02186772 -0.2568253 ]
Stock Position:  -0.0026930350420052347
Bond Position:  [6.38440923]


portfolio before change:  [6.11566005]
curr_Stock_Price:  100.38691781226647
curr_Factors:  [100.38691781  -0.70597126  -1.03390113]
mat_Sqrt:  [[17.62220057  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02315285 -0.28842648 -0.50444929]
Stock Position:  -0.02315285426692929
Bond Position:  [8.43990373]


portfolio before change:  [6.12174368]
curr_Stock_Price:  100.21530212735668
curr_Factors:  [100.21530213  -0.72823867  -1.04095287]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [6.12174368]
Stock Price:  99.50969470991382
PL:  [6.12174368]
Settle:  Tensor("sub_274:0", shape=(), dtype=float64)
PL:  Tensor("sub_275:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  138
output_Z_Vals[:, i, :]:  [[ 1.19251512e+02 -2.92846752e+01 -2.92776944e+01]
 [-2.63606317e-01  7.80628029e-02  1.47958070e-01]
 [-2.22938199e-01 -2.04885780e-02  1.64910286e-01]
 [-6.27530283e-02 -1.10428280e-01 -3.53479394e-01]
 [-9.88296441e-02 -2.41910939e-01  2.15109929e-01]
 [-3.17132062e-02 -1.56789081e-01  2.60317277e-02]
 [ 3.39122239e-02  1.84217317e-02 -5.04635200e-03]
 [-7.70774930e-02  1.37328053e-01 -9.30058223e-02]
 [-2.51227442e-01 -1.12814931e-01  2.35810895e-01]
 [ 5.52167692e-02  5.24743361e-02 -9.86897097e-03]
 [ 3.30212814e-02  8.34912837e-02 -1.25909678e-02]
 [ 9.00329298e-02 -1.03391871e-02 -1.28160856e-01]
 [ 4.68170474e-02 -1.09260961e-02 -2.82866045e-01]
 [-8.45720117e-02  2.97281712e-02 -3.59999752e-02]
 [ 1.02871338e-02 -6.44761754e-02 -2.80800446e-02]
 [ 9.86350741e-02 -9.43723551e-03  3.81035239e-02]
 [-1.90274345e-02  9.00440864e-02  7.17318042e-02]
 [ 4.31849672e-02 -2.43144740e-02  5.44824396e-02]
 [-3.11702653e-01 -7.90741323e-01 -1.58532495e-01]
 [ 1.39566652e-01 -1.84247292e-01 -3.08063872e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.25151208 -29.28467519 -29.2776944 ]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  8.31409947  -9.26062741 -83.52111278]
init_Out:  [2.49223638]
Stock Position:  8.314099471154409
Bond position:  [-828.91771073]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-3.76296915]
curr_Stock_Price:  99.2725670145145
curr_Factors:  [99.27256701 -1.42518834 -0.98636305]
mat_Sqrt:  [[ 8.90237308  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02599183  0.02468563  0.42208319]
Stock Position:  -0.02599182567493938
Bond Position:  [-1.18269389]


portfolio before change:  [-3.78768326]
curr_Stock_Price:  100.21203172279267
curr_Factors:  [100.21203172  -0.98579398  -0.9958369 ]
mat_Sqrt:  [[13.81365207  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0137404  -0.00647906  0.47044314]
Stock Position:  -0.013740395315331886
Bond Position:  [-2.41073033]


portfolio before change:  [-3.80208997]
curr_Stock_Price:  101.21665702481039
curr_Factors:  [101.21665702  -0.86486784  -1.00201689]
mat_Sqrt:  [[15.64855539  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00880324 -0.03492049 -1.00837832]
Stock Position:  -0.008803237730199137
Bond Position:  [-2.91105567]


portfolio before change:  [-3.81131564]
curr_Stock_Price:  102.18196339537617
curr_Factors:  [102.1819634   -1.02904746  -0.99751746]
mat_Sqrt:  [[13.46629986  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0045422  -0.07649896  0.61364875]
Stock Position:  -0.004542200001225991
Bond Position:  [-3.34718473]


portfolio before change:  [-3.80576298]
curr_Stock_Price:  100.7752509392528
curr_Factors:  [100.77525094  -1.07300391  -0.93965202]
mat_Sqrt:  [[13.46692764  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00226093 -0.04958106  0.07426127]
Stock Position:  -0.0022609298480448918
Bond Position:  [-3.5779172]


portfolio before change:  [-3.80456596]
curr_Stock_Price:  99.85014201839896
curr_Factors:  [99.85014202 -1.15280358 -0.9004378 ]
mat_Sqrt:  [[12.81260051  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00260351  0.00582546 -0.01439584]
Stock Position:  0.0026035143009037363
Bond Position:  [-4.06452723]


portfolio before change:  [-3.80645345]
curr_Stock_Price:  99.5155064574443
curr_Factors:  [99.51550646 -0.86464298 -0.9238558 ]
mat_Sqrt:  [[16.64008758  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00555985  0.04342694 -0.26531972]
Stock Position:  -0.005559852462685612
Bond Position:  [-3.25316191]


portfolio before change:  [-3.80485779]
curr_Stock_Price:  99.08221233991641
curr_Factors:  [99.08221234 -0.75880501 -0.90181137]
mat_Sqrt:  [[18.82778207  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01094158 -0.03567521  0.67270285]
Stock Position:  -0.010941576276259033
Bond Position:  [-2.72074221]


portfolio before change:  [-3.80703603]
curr_Stock_Price:  99.21911903470381
curr_Factors:  [99.21911903 -0.65347688 -0.91062316]
mat_Sqrt:  [[20.76420715  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00262746  0.01659384 -0.02815343]
Stock Position:  0.0026274615269321834
Bond Position:  [-4.06773045]


portfolio before change:  [-3.80425619]
curr_Stock_Price:  100.66420360559385
curr_Factors:  [100.66420361  -1.09513644  -0.95307827]
mat_Sqrt:  [[12.98215277  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00251167  0.02640226 -0.03591853]
Stock Position:  0.0025116709946192244
Bond Position:  [-4.05709155]


portfolio before change:  [-3.80611618]
curr_Stock_Price:  100.32754034968978
curr_Factors:  [100.32754035  -1.0167824   -0.97747386]
mat_Sqrt:  [[13.65606813  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00465765 -0.00326954 -0.36560725]
Stock Position:  0.004657654559571869
Bond Position:  [-4.2734072]


portfolio before change:  [-3.80417039]
curr_Stock_Price:  100.97470656030164
curr_Factors:  [100.97470656  -0.99428474  -0.98883197]
mat_Sqrt:  [[13.89811683  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-8.06213755e-04 -3.45513496e-03 -8.06938093e-01]
Stock Position:  -0.0008062137554600185
Bond Position:  [-3.72276319]


portfolio before change:  [-3.80491267]
curr_Stock_Price:  100.74087055316048
curr_Factors:  [100.74087055  -0.60081661  -0.99068994]
mat_Sqrt:  [[20.51271687  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00444373  0.00940087 -0.10269791]
Stock Position:  -0.00444372621834602
Bond Position:  [-3.35724782]


portfolio before change:  [-3.7983863]
curr_Stock_Price:  99.08330050082246
curr_Factors:  [99.0833005  -0.77617187 -0.96017157]
mat_Sqrt:  [[17.45484869  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0001656  -0.02038916 -0.08010455]
Stock Position:  0.00016560160720292336
Bond Position:  [-3.81479465]


portfolio before change:  [-3.79936153]
curr_Stock_Price:  98.95399091528726
curr_Factors:  [98.95399092 -0.48677195 -0.98484256]
mat_Sqrt:  [[22.71534071  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0046739  -0.00298432  0.10869875]
Stock Position:  0.004673901056571256
Bond Position:  [-4.2618627]


portfolio before change:  [-3.81149345]
curr_Stock_Price:  96.58630743770007
curr_Factors:  [96.58630744 -0.53589776 -0.94857611]
mat_Sqrt:  [[21.8885379   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-9.41274821e-05  2.84744403e-02  2.04630871e-01]
Stock Position:  -9.412748212632179e-05
Bond Position:  [-3.80240202]


portfolio before change:  [-3.81241188]
curr_Stock_Price:  96.24326178345642
curr_Factors:  [96.24326178 -0.76071038 -0.94620024]
mat_Sqrt:  [[17.46097423  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00307419 -0.00768891  0.15542324]
Stock Position:  0.003074189955670741
Bond Position:  [-4.10828195]


portfolio before change:  [-3.81704322]
curr_Stock_Price:  95.07087578228634
curr_Factors:  [95.07087578 -0.74997642 -0.97943381]
mat_Sqrt:  [[16.86452745  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02161222 -0.25005436 -0.45224908]
Stock Position:  -0.02161221639219338
Bond Position:  [-1.76235088]


portfolio before change:  [-3.79132826]
curr_Stock_Price:  93.86065279496071
curr_Factors:  [93.86065279 -0.64876106 -0.9693218 ]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-3.79132826]
Stock Price:  93.44892034880834
PL:  [-3.79132826]
Settle:  Tensor("sub_276:0", shape=(), dtype=float64)
PL:  Tensor("sub_277:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  139
output_Z_Vals[:, i, :]:  [[ 1.19251512e+02 -2.92846752e+01 -2.92776944e+01]
 [-7.76566861e-02 -2.17301417e-02 -1.20580902e-01]
 [-2.61749872e-01 -3.10286109e-02  1.81357446e-01]
 [-5.90732918e-02 -9.47161158e-02 -3.09084191e-01]
 [-9.88296441e-02 -2.41910939e-01  2.15109929e-01]
 [-2.24722481e-01 -3.68747149e-02  3.47665017e-02]
 [ 5.25949761e-02  8.36942667e-02 -3.76834393e-02]
 [-1.54824803e-01  2.39903759e-01 -8.06484889e-02]
 [-1.14562880e-02 -4.27796901e-03 -1.62576138e-02]
 [ 2.97576690e-02  3.59300578e-02 -1.21838324e-02]
 [ 1.46533795e-01 -1.42570025e-02 -3.77731021e-02]
 [-8.49180480e-03 -7.44984439e-03 -8.56109788e-02]
 [ 4.60993917e-02 -9.06780188e-03 -1.74101194e-01]
 [-7.86377400e-02  2.61642738e-02 -3.44709507e-02]
 [-1.16922161e-01  6.45310928e-02  2.35736844e-01]
 [-4.75927240e-02 -1.06775297e-01  1.38179133e-01]
 [-2.35711564e-02  4.30074595e-02  1.43118153e-01]
 [ 2.63013964e-02  1.98238931e-03 -3.84901165e-02]
 [-2.61805212e-01 -7.48515939e-01 -7.82701076e-02]
 [ 7.01144281e-02 -2.97169026e-02 -7.57137749e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.25151208 -29.28467519 -29.2776944 ]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  8.31409947  -9.26062741 -83.52111278]
init_Out:  [2.49223638]
Stock Position:  8.314099471154409
Bond position:  [-828.91771073]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [4.15374624]
curr_Stock_Price:  100.2247706078229
curr_Factors:  [100.22477061  -1.26883436  -0.99392012]
mat_Sqrt:  [[10.42973532  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00985943 -0.00687167 -0.34398375]
Stock Position:  -0.009859428491875783
Bond Position:  [5.1419052]


portfolio before change:  [4.15602983]
curr_Stock_Price:  100.12355241975378
curr_Factors:  [100.12355242  -1.33436153  -0.99011406]
mat_Sqrt:  [[ 9.79556134  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02302386 -0.00981211  0.51736231]
Stock Position:  -0.023023855947631438
Bond Position:  [6.46126008]


portfolio before change:  [4.12898969]
curr_Stock_Price:  101.3681598835034
curr_Factors:  [101.36815988  -1.52994517  -1.00433104]
mat_Sqrt:  [[ 8.04043212  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01549797 -0.02995187 -0.88173116]
Stock Position:  -0.015497972724282045
Bond Position:  [5.69999066]


portfolio before change:  [4.11529927]
curr_Stock_Price:  102.34348677548826
curr_Factors:  [102.34348678  -1.50970184  -1.03722332]
mat_Sqrt:  [[ 8.01575926  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0076308  -0.07649896  0.61364875]
Stock Position:  -0.007630796444131499
Bond Position:  [4.89626159]


portfolio before change:  [4.1114542]
curr_Stock_Price:  103.00780660598586
curr_Factors:  [103.00780661  -1.64271342  -1.03591973]
mat_Sqrt:  [[ 7.07220017  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.03090663 -0.01166081  0.09917915]
Stock Position:  -0.030906633593781912
Bond Position:  [7.29507874]


portfolio before change:  [4.09243661]
curr_Stock_Price:  103.68214692632922
curr_Factors:  [103.68214693  -1.64635109  -1.04151849]
mat_Sqrt:  [[ 7.0530515   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00667284  0.02646645 -0.10750036]
Stock Position:  0.006672835583325505
Bond Position:  [3.40058269]


portfolio before change:  [4.09360775]
curr_Stock_Price:  103.73023548956765
curr_Factors:  [103.73023549  -1.48327436  -1.04686409]
mat_Sqrt:  [[ 8.261905    0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01998242  0.07586423 -0.23006769]
Stock Position:  -0.019982415532645792
Bond Position:  [6.16638842]


portfolio before change:  [4.08815858]
curr_Stock_Price:  104.08009113213684
curr_Factors:  [104.08009113  -1.71416824  -1.04315584]
mat_Sqrt:  [[ 6.60506399  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00225362 -0.00135281 -0.04637845]
Stock Position:  -0.002253621806070372
Bond Position:  [4.32271574]


portfolio before change:  [4.08982834]
curr_Stock_Price:  103.81875812743439
curr_Factors:  [103.81875813  -1.70568377  -1.03630728]
mat_Sqrt:  [[ 6.69027925  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00421483  0.01136208 -0.03475708]
Stock Position:  0.004214826261930417
Bond Position:  [3.65225031]


portfolio before change:  [4.0907015]
curr_Stock_Price:  103.80926319480109
curr_Factors:  [103.80926319  -1.2060449   -1.04959324]
mat_Sqrt:  [[10.8799002   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01272579 -0.00450846 -0.10775615]
Stock Position:  0.012725785679227266
Bond Position:  [2.76964706]


portfolio before change:  [4.09705487]
curr_Stock_Price:  104.2540986035754
curr_Factors:  [104.2540986   -1.00739547  -1.07008312]
mat_Sqrt:  [[13.05736815  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00200342 -0.00235585 -0.24422429]
Stock Position:  -0.002003422629409594
Bond Position:  [4.3059199]


portfolio before change:  [4.09814282]
curr_Stock_Price:  104.24844193767125
curr_Factors:  [104.24844194  -1.09534738  -1.03246766]
mat_Sqrt:  [[12.41570093  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00083177 -0.00286749 -0.49666225]
Stock Position:  0.0008317697717648595
Bond Position:  [4.01143212]


portfolio before change:  [4.09899333]
curr_Stock_Price:  104.06513144014438
curr_Factors:  [104.06513144  -0.89657744  -0.99188654]
mat_Sqrt:  [[15.74547437  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00539828  0.00827387 -0.09833603]
Stock Position:  -0.005398283512683696
Bond Position:  [4.66076642]


portfolio before change:  [4.10265944]
curr_Stock_Price:  103.60187963088828
curr_Factors:  [103.60187963  -0.38808251  -0.97043334]
mat_Sqrt:  [[26.63003254  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00252108  0.02040652  0.6724916 ]
Stock Position:  -0.0025210781634086
Bond Position:  [4.36384787]


portfolio before change:  [4.10481288]
curr_Stock_Price:  103.18049574199836
curr_Factors:  [103.18049574  -0.6501445   -0.94911108]
mat_Sqrt:  [[20.84729615  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0010622  -0.03376531  0.39418661]
Stock Position:  -0.0010621978363608358
Bond Position:  [4.21441097]


portfolio before change:  [4.10667685]
curr_Stock_Price:  102.4176950048937
curr_Factors:  [102.417695    -0.85697802  -0.97439085]
mat_Sqrt:  [[16.40671378  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00041161 0.01360015 0.40827625]
Stock Position:  0.0004116096780142562
Bond Position:  [4.06452074]


portfolio before change:  [4.10675818]
curr_Stock_Price:  100.1462985492575
curr_Factors:  [100.14629855  -1.19941079  -0.97824052]
mat_Sqrt:  [[11.34731101  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00162997  0.00062689 -0.10980159]
Stock Position:  0.0016299737715318049
Bond Position:  [3.94352234]


portfolio before change:  [4.10768439]
curr_Stock_Price:  100.10961186616696
curr_Factors:  [100.10961187  -1.36868524  -0.93242463]
mat_Sqrt:  [[10.02574049  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02963458 -0.23670152 -0.22328283]
Stock Position:  -0.029634582020513254
Bond Position:  [7.07439089]


portfolio before change:  [4.11052444]
curr_Stock_Price:  100.07346389655385
curr_Factors:  [100.0734639   -1.85927132  -0.97104729]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [4.11052444]
Stock Price:  99.99484734090743
PL:  [4.11052444]
Settle:  Tensor("sub_278:0", shape=(), dtype=float64)
PL:  Tensor("sub_279:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  140
output_Z_Vals[:, i, :]:  [[ 1.19251512e+02 -2.92846752e+01 -2.92776944e+01]
 [-1.32098335e-01  2.35289030e-02 -6.91581944e-02]
 [-8.75799119e-02  5.82875610e-03  2.49617392e-02]
 [-4.97776163e-02  3.00104426e-02  3.18382004e-02]
 [-8.32167610e-02 -1.11444679e-01  8.27768385e-02]
 [-1.23299486e-01  5.93872751e-02 -1.30703661e-04]
 [-1.43683514e-01 -1.13730578e-01  1.00570031e-01]
 [-2.40780508e-02  3.54177202e-02 -9.90449035e-02]
 [-2.47133970e-01 -1.28684009e-01  2.74291181e-01]
 [ 5.41601602e-02  4.37132848e-02 -6.55348960e-04]
 [ 2.90281696e-02  8.75201187e-02 -1.20793141e-02]
 [ 1.79865448e-01 -1.29736214e-02 -1.66956825e-01]
 [ 3.07102649e-02 -7.26841488e-02 -4.45869840e-01]
 [-8.35906094e-02  3.00322486e-02 -3.37795143e-02]
 [-6.99592834e-02 -1.57783666e-02  8.96777877e-02]
 [ 7.29810209e-02 -9.61551286e-03  6.58974250e-02]
 [-2.49761498e-02  1.05184033e-01  7.09812546e-02]
 [ 3.42799509e-02 -9.34462394e-03 -3.07782401e-03]
 [-2.32332190e-01 -7.19670777e-01 -3.95523272e-02]
 [ 7.23584701e-02 -3.48739296e-02 -8.23786419e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.25151208 -29.28467519 -29.2776944 ]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  8.31409947  -9.26062741 -83.52111278]
init_Out:  [2.49223638]
Stock Position:  8.314099471154409
Bond position:  [-828.91771073]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-0.37277494]
curr_Stock_Price:  99.68033146523747
curr_Factors:  [99.68033147 -0.93724648 -1.02053904]
mat_Sqrt:  [[14.07194165  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01034738  0.00744049 -0.19728908]
Stock Position:  -0.010347376493383804
Bond Position:  [0.65865497]


portfolio before change:  [-0.35969085]
curr_Stock_Price:  98.43176237291921
curr_Factors:  [98.43176237 -1.05766942 -1.03348513]
mat_Sqrt:  [[12.16069453  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00677051  0.00184321  0.07120889]
Stock Position:  -0.006770511355500723
Bond Position:  [0.30674252]


portfolio before change:  [-0.34897191]
curr_Stock_Price:  96.8599099599187
curr_Factors:  [96.85990996 -1.09568893 -1.00110299]
mat_Sqrt:  [[11.89923112  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00357198  0.00949014  0.09082552]
Stock Position:  -0.0035719790737140976
Bond Position:  [-0.00299033]


portfolio before change:  [-0.34934419]
curr_Stock_Price:  96.96392473166922
curr_Factors:  [96.96392473 -0.84902209 -0.96748127]
mat_Sqrt:  [[15.76568345  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00438912 -0.0352419   0.23613928]
Stock Position:  -0.004389121412458873
Bond Position:  [0.07624225]


portfolio before change:  [-0.34694495]
curr_Stock_Price:  96.4216331317171
curr_Factors:  [96.42163313 -0.84280345 -0.96902568]
mat_Sqrt:  [[15.75096222  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0077324   0.01877991 -0.00037286]
Stock Position:  -0.0077324033155909315
Bond Position:  [0.39862601]


portfolio before change:  [-0.3530295]
curr_Stock_Price:  97.22141293216028
curr_Factors:  [97.22141293 -1.05461978 -0.99398069]
mat_Sqrt:  [[12.53331778  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01006048 -0.03596477  0.28689831]
Stock Position:  -0.010060484818896456
Bond Position:  [0.62506505]


portfolio before change:  [-0.34740431]
curr_Stock_Price:  96.67781071460752
curr_Factors:  [96.67781071 -0.76557703 -0.95623924]
mat_Sqrt:  [[17.28030892  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00251043  0.01120007 -0.28254754]
Stock Position:  -0.002510431132680649
Bond Position:  [-0.10470132]


portfolio before change:  [-0.35025905]
curr_Stock_Price:  97.80453357407819
curr_Factors:  [97.80453357 -0.89793895 -0.98080059]
mat_Sqrt:  [[14.942827    0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01301408 -0.04069346  0.78247639]
Stock Position:  -0.013014078507521695
Bond Position:  [0.92257683]


portfolio before change:  [-0.35417047]
curr_Stock_Price:  98.1228119182663
curr_Factors:  [98.12281192 -0.7531683  -0.92596382]
mat_Sqrt:  [[18.30341677  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00301338  0.01382335 -0.00186953]
Stock Position:  0.0030133750685764947
Bond Position:  [-0.64985131]


portfolio before change:  [-0.34893497]
curr_Stock_Price:  99.9141542761298
curr_Factors:  [99.91415428 -0.80007808 -0.91078037]
mat_Sqrt:  [[18.05554624  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00159631  0.02767629 -0.03445892]
Stock Position:  0.0015963100368956123
Bond Position:  [-0.50842894]


portfolio before change:  [-0.34781268]
curr_Stock_Price:  100.69684532941508
curr_Factors:  [100.69684533  -0.37615044  -0.94547974]
mat_Sqrt:  [[26.85586659  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00541597 -0.00410262 -0.47628135]
Stock Position:  0.005415969395278207
Bond Position:  [-0.89318371]


portfolio before change:  [-0.35475352]
curr_Stock_Price:  99.45652794608749
curr_Factors:  [99.45652795 -0.48092486 -0.92738483]
mat_Sqrt:  [[24.32272162  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00255643 -0.02298475 -1.27194255]
Stock Position:  -0.0025564257456976132
Bond Position:  [-0.10050029]


portfolio before change:  [-0.35703909]
curr_Stock_Price:  100.34074696472707
curr_Factors:  [100.34074696  -0.39936652  -0.92753029]
mat_Sqrt:  [[26.62032583  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00337     0.00949703 -0.09636355]
Stock Position:  -0.0033699961117771835
Bond Position:  [-0.01889116]


portfolio before change:  [-0.35916988]
curr_Stock_Price:  100.97162683650187
curr_Factors:  [100.97162684  -0.59307061  -0.94576724]
mat_Sqrt:  [[21.6715795   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00240228 -0.00498956  0.25582577]
Stock Position:  -0.0024022834752829886
Bond Position:  [-0.1166074]


portfolio before change:  [-0.35550035]
curr_Stock_Price:  99.43197338983356
curr_Factors:  [99.43197339 -0.70827253 -0.92585952]
mat_Sqrt:  [[19.40133119  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00444217 -0.00304069  0.18798701]
Stock Position:  0.004442169672981285
Bond Position:  [-0.79719404]


portfolio before change:  [-0.35531058]
curr_Stock_Price:  99.51956296952143
curr_Factors:  [99.51956297 -1.00752025 -0.89610703]
mat_Sqrt:  [[14.83110931  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00052399  0.03326211  0.20248976]
Stock Position:  -0.0005239879026987066
Bond Position:  [-0.30316354]


portfolio before change:  [-0.35527385]
curr_Stock_Price:  99.30480152372694
curr_Factors:  [99.30480152 -1.16545153 -0.91252697]
mat_Sqrt:  [[12.43127446  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00268761 -0.00295503 -0.00878018]
Stock Position:  0.0026876098388379124
Bond Position:  [-0.62216641]


portfolio before change:  [-0.35072734]
curr_Stock_Price:  101.05433653617179
curr_Factors:  [101.05433654  -1.66280562  -0.92678228]
mat_Sqrt:  [[ 7.5842252   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.03414819 -0.22757988 -0.11283178]
Stock Position:  -0.034148194119084846
Bond Position:  [3.10009576]


portfolio before change:  [-0.37061552]
curr_Stock_Price:  101.65944313932508
curr_Factors:  [101.65944314  -1.51591984  -0.90950529]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-0.37061552]
Stock Price:  102.59480705822833
PL:  [-2.96542258]
Settle:  Tensor("sub_280:0", shape=(), dtype=float64)
PL:  Tensor("sub_281:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  141
output_Z_Vals[:, i, :]:  [[ 1.19251512e+02 -2.92846752e+01 -2.92776944e+01]
 [-3.45849301e-01  1.18386147e-01  3.02023938e-01]
 [-8.80917841e-02  1.57518613e-02  1.04764091e-01]
 [-2.29428990e-02  2.62137440e-02  3.18075079e-02]
 [-8.57352279e-02 -1.32489797e-01  1.04123089e-01]
 [-1.98970112e-02 -9.47705025e-03 -1.62366790e-02]
 [-8.40127806e-02 -4.78143954e-02  5.37930027e-02]
 [-9.09019251e-02  1.52454218e-01 -8.43681658e-02]
 [-1.77933994e-01 -8.45077633e-02  1.72875745e-01]
 [ 4.50470017e-02  4.74936917e-02 -1.18045691e-02]
 [ 3.40589417e-02  8.33561228e-02 -1.25269747e-02]
 [ 1.49138271e-01 -1.20725142e-02 -1.53686680e-01]
 [ 4.63705653e-02 -1.07408786e-02 -2.64924254e-01]
 [-8.45720117e-02  2.97281712e-02 -3.59999752e-02]
 [-7.72811409e-02 -6.51196647e-03  1.11050557e-01]
 [-4.20759889e-03 -2.79259346e-02  1.01756378e-01]
 [-2.42871616e-02  6.36965875e-02  1.19630882e-01]
 [-6.26239552e-04  3.48693271e-02 -8.84702490e-02]
 [-3.36857454e-01 -9.12608725e-01 -1.51644548e-01]
 [ 7.76447426e-02 -4.70222984e-02 -9.80790174e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.25151208 -29.28467519 -29.2776944 ]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  8.31409947  -9.26062741 -83.52111278]
init_Out:  [2.49223638]
Stock Position:  8.314099471154409
Bond position:  [-828.91771073]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-8.89364583]
curr_Stock_Price:  98.65546149398715
curr_Factors:  [98.65546149 -1.2480142  -1.01986176]
mat_Sqrt:  [[10.21398269  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02752523  0.03743699  0.86159023]
Stock Position:  -0.027525228368544114
Bond Position:  [-6.17813172]


portfolio before change:  [-8.90581952]
curr_Stock_Price:  99.04161497445712
curr_Factors:  [99.04161497 -1.26072492 -0.98693679]
mat_Sqrt:  [[10.46334714  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00633642  0.00498118  0.29886279]
Stock Position:  -0.006336422870689727
Bond Position:  [-8.27824996]


portfolio before change:  [-8.91087162]
curr_Stock_Price:  99.51227138911865
curr_Factors:  [99.51227139 -1.16533748 -0.99946052]
mat_Sqrt:  [[11.42133352  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00138105  0.00828951  0.09073797]
Stock Position:  -0.0013810456208501107
Bond Position:  [-8.77344063]


portfolio before change:  [-8.91202655]
curr_Stock_Price:  98.76016100412654
curr_Factors:  [98.760161   -1.27084691 -1.01372077]
mat_Sqrt:  [[10.05556904  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00675268 -0.04189695  0.29703419]
Stock Position:  -0.0067526823117857165
Bond Position:  [-8.24513056]


portfolio before change:  [-8.91868171]
curr_Stock_Price:  99.44042573338051
curr_Factors:  [99.44042573 -0.80032832 -1.07691513]
mat_Sqrt:  [[15.21550952  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00154159 -0.00299691 -0.04631873]
Stock Position:  -0.00154158529953636
Bond Position:  [-8.76538581]


portfolio before change:  [-8.91928142]
curr_Stock_Price:  98.40778463430132
curr_Factors:  [98.40778463 -0.73262538 -1.05994147]
mat_Sqrt:  [[16.38806066  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00453177 -0.01512024  0.15345646]
Stock Position:  -0.00453176820546555
Bond Position:  [-8.47332015]


portfolio before change:  [-8.9284662]
curr_Stock_Price:  99.96703926612447
curr_Factors:  [99.96703927 -0.71490046 -1.07665923]
mat_Sqrt:  [[16.6645021   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00625204  0.04821026 -0.24067889]
Stock Position:  -0.006252041208082371
Bond Position:  [-8.30346815]


portfolio before change:  [-8.93004684]
curr_Stock_Price:  99.88778812516819
curr_Factors:  [99.88778813 -0.92631883 -1.08147984]
mat_Sqrt:  [[13.41332699  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01079731 -0.0267237   0.49316638]
Stock Position:  -0.010797310910031915
Bond Position:  [-7.85152734]


portfolio before change:  [-8.93318953]
curr_Stock_Price:  99.99703360017396
curr_Factors:  [99.9970336  -0.88020052 -1.07939166]
mat_Sqrt:  [[14.09116972  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00311285  0.01501882 -0.03367515]
Stock Position:  0.003112849171915585
Bond Position:  [-9.24446521]


portfolio before change:  [-8.93326337]
curr_Stock_Price:  100.71584786011334
curr_Factors:  [100.71584786  -0.75336237  -1.07833524]
mat_Sqrt:  [[16.12878475  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00208659  0.02635952 -0.03573597]
Stock Position:  0.0020865880510513414
Bond Position:  [-9.14341586]


portfolio before change:  [-8.93506706]
curr_Stock_Price:  100.94706530725017
curr_Factors:  [100.94706531  -0.71297712  -1.09697437]
mat_Sqrt:  [[16.52120634  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00710937 -0.00381766 -0.43842532]
Stock Position:  0.007109371787587358
Bond Position:  [-9.65273727]


portfolio before change:  [-8.93598098]
curr_Stock_Price:  101.15799301231448
curr_Factors:  [101.15799301  -1.03485234  -1.12182308]
mat_Sqrt:  [[11.70490703  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-6.82124164e-04 -3.39656404e-03 -7.55755157e-01]
Stock Position:  -0.0006821241640594077
Bond Position:  [-8.86697867]


portfolio before change:  [-8.93876702]
curr_Stock_Price:  101.9921872483229
curr_Factors:  [101.99218725  -0.81468284  -1.10056828]
mat_Sqrt:  [[15.02394253  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00606718  0.00940087 -0.10269791]
Stock Position:  -0.006067175613637094
Bond Position:  [-8.31996251]


portfolio before change:  [-8.93961817]
curr_Stock_Price:  101.78960378206789
curr_Factors:  [101.78960378  -0.5063595   -1.08609404]
mat_Sqrt:  [[20.70664037  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00264559 -0.00205926  0.31679633]
Stock Position:  -0.0026455850926456093
Bond Position:  [-8.67032511]


portfolio before change:  [-8.94032174]
curr_Stock_Price:  101.23612572519285
curr_Factors:  [101.23612573  -0.91272426  -1.06893844]
mat_Sqrt:  [[13.95437348  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00113529 -0.00883096  0.29028262]
Stock Position:  0.0011352921174636495
Bond Position:  [-9.05525432]


portfolio before change:  [-8.94231144]
curr_Stock_Price:  101.47782689614074
curr_Factors:  [101.4778269   -0.68877743  -1.08420941]
mat_Sqrt:  [[17.23347104  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [1.03114961e-04 2.01426296e-02 3.41273606e-01]
Stock Position:  0.00010311496098536121
Bond Position:  [-8.95277532]


portfolio before change:  [-8.94462025]
curr_Stock_Price:  100.79569076324618
curr_Factors:  [100.79569076  -0.55271502  -1.08422066]
mat_Sqrt:  [[19.61235889  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00090682  0.01102665 -0.25238099]
Stock Position:  -0.0009068175555771658
Bond Position:  [-8.85321695]


portfolio before change:  [-8.94747993]
curr_Stock_Price:  101.50818493038207
curr_Factors:  [101.50818493  -0.94771475  -1.11273543]
mat_Sqrt:  [[12.93179815  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.03026456 -0.28859222 -0.43259968]
Stock Position:  -0.030264563317858567
Bond Position:  [-5.87537904]


portfolio before change:  [-8.93117512]
curr_Stock_Price:  100.92090264959074
curr_Factors:  [100.92090265  -0.71968015  -1.10348122]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-8.93117512]
Stock Price:  102.026395814025
PL:  [-10.95757094]
Settle:  Tensor("sub_282:0", shape=(), dtype=float64)
PL:  Tensor("sub_283:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  142
output_Z_Vals[:, i, :]:  [[ 1.19251512e+02 -2.92846752e+01 -2.92776944e+01]
 [-1.15165580e-01 -7.49141351e-04 -3.39093472e-02]
 [-1.68433679e-01 -5.68686022e-03  1.41812995e-01]
 [-4.16943194e-02 -2.02305398e-02 -9.83942326e-02]
 [-9.88296441e-02 -2.41910939e-01  2.15109929e-01]
 [-6.52699728e-03 -1.86380316e-01  3.51262744e-02]
 [ 5.55159282e-02  3.50968113e-02 -1.86251245e-02]
 [-8.38981944e-02  1.49243163e-01 -1.07105398e-01]
 [-1.22362262e-01 -6.26888800e-02  1.24300675e-01]
 [ 4.50470017e-02  4.74936917e-02 -1.18045691e-02]
 [ 2.85015294e-02  8.77810912e-02 -1.20702378e-02]
 [ 9.56878364e-02 -1.05050233e-02 -1.30603040e-01]
 [ 4.18021670e-02 -1.45038136e-02 -3.71125144e-01]
 [-8.45720117e-02  2.97281712e-02 -3.59999752e-02]
 [-1.46288600e-01  1.05918020e-01  2.78089065e-01]
 [-1.20038927e-01 -2.32388144e-01  1.97625131e-01]
 [-2.61954619e-02  1.57351430e-02  1.89277436e-01]
 [-3.96923503e-02  9.13755877e-02 -8.22961654e-02]
 [-3.29812270e-01 -9.27418149e-01 -1.42829538e-01]
 [ 7.03374130e-02 -3.02293435e-02 -7.63760462e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.25151208 -29.28467519 -29.2776944 ]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  8.31409947  -9.26062741 -83.52111278]
init_Out:  [2.49223638]
Stock Position:  8.314099471154409
Bond position:  [-828.91771073]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [2.5540673]
curr_Stock_Price:  100.03236505087271
curr_Factors:  [100.03236505  -1.18352189  -0.97550281]
mat_Sqrt:  [[11.54750138  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01057429 -0.0002369  -0.09673393]
Stock Position:  -0.01057429098229249
Bond Position:  [3.61183864]


portfolio before change:  [2.55750782]
curr_Stock_Price:  99.79240117317268
curr_Factors:  [99.79240117 -1.0450833  -0.99383754]
mat_Sqrt:  [[12.98988794  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01074937 -0.00179834  0.404553  ]
Stock Position:  -0.010749365795561521
Bond Position:  [3.63021285]


portfolio before change:  [2.55405072]
curr_Stock_Price:  100.19845017467834
curr_Factors:  [100.19845017  -1.16815989  -1.01792588]
mat_Sqrt:  [[11.25786449  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00553403 -0.00639746 -0.28069136]
Stock Position:  -0.005534025425855433
Bond Position:  [3.10855149]


portfolio before change:  [2.55403918]
curr_Stock_Price:  100.3409829968084
curr_Factors:  [100.340983    -1.1499354   -1.02821737]
mat_Sqrt:  [[11.36367023  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00538265 -0.07649896  0.61364875]
Stock Position:  -0.005382647155006094
Bond Position:  [3.09413928]


portfolio before change:  [2.55271428]
curr_Stock_Price:  100.7308512913997
curr_Factors:  [100.73085129  -1.37700859  -1.01536011]
mat_Sqrt:  [[ 9.20809894  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00045277 -0.05893863  0.10020548]
Stock Position:  -0.00045277485023236663
Bond Position:  [2.59832268]


portfolio before change:  [2.55305882]
curr_Stock_Price:  101.40474789463092
curr_Factors:  [101.40474789  -0.99822967  -1.03899667]
mat_Sqrt:  [[13.22215154  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00397971  0.01109859 -0.0531323 ]
Stock Position:  0.003979706792307897
Bond Position:  [2.14949766]


portfolio before change:  [2.54830557]
curr_Stock_Price:  100.07532978162976
curr_Factors:  [100.07532978  -1.36208374  -1.07320943]
mat_Sqrt:  [[ 8.76380384  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01162823  0.04719483 -0.30554189]
Stock Position:  -0.011628232708466189
Bond Position:  [3.71200479]


portfolio before change:  [2.54596683]
curr_Stock_Price:  100.35627159082141
curr_Factors:  [100.35627159  -1.15997729  -1.10509799]
mat_Sqrt:  [[10.4192107   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00946407 -0.01982396  0.35459523]
Stock Position:  -0.009464067466548017
Bond Position:  [3.49574536]


portfolio before change:  [2.54640866]
curr_Stock_Price:  100.40194078511882
curr_Factors:  [100.40194079  -0.85525076  -1.1150752 ]
mat_Sqrt:  [[13.99717575  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00313375  0.01501882 -0.03367515]
Stock Position:  0.0031337526069173194
Bond Position:  [2.23177382]


portfolio before change:  [2.54649687]
curr_Stock_Price:  100.25202449951595
curr_Factors:  [100.2520245   -0.80556905  -1.10841029]
mat_Sqrt:  [[14.78640116  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0019142   0.02775882 -0.03443303]
Stock Position:  0.0019142048251666894
Bond Position:  [2.35459396]


portfolio before change:  [2.54664424]
curr_Stock_Price:  100.02145566870567
curr_Factors:  [100.02145567  -0.8661684   -1.0915908 ]
mat_Sqrt:  [[14.12047002  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00486934 -0.00332198 -0.37257412]
Stock Position:  0.004869339601443781
Bond Position:  [2.0596058]


portfolio before change:  [2.5514699]
curr_Stock_Price:  100.90672926040394
curr_Factors:  [100.90672926  -0.64495488  -1.1217533 ]
mat_Sqrt:  [[17.24441698  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00199067 -0.00458651 -1.05871673]
Stock Position:  -0.00199066878300333
Bond Position:  [2.75234178]


portfolio before change:  [2.5484633]
curr_Stock_Price:  102.76277356819939
curr_Factors:  [102.76277357  -0.74422691  -1.14289309]
mat_Sqrt:  [[15.56933326  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00585464  0.00940087 -0.10269791]
Stock Position:  -0.005854643627158454
Bond Position:  [3.15010272]


portfolio before change:  [2.53205455]
curr_Stock_Price:  105.69999399710888
curr_Factors:  [105.699994    -0.61064057  -1.12133721]
mat_Sqrt:  [[18.70193604  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00464065  0.03349422  0.7933107 ]
Stock Position:  -0.00464064874016996
Bond Position:  [3.02257109]


portfolio before change:  [2.53329586]
curr_Stock_Price:  105.5953585907481
curr_Factors:  [105.59535859  -1.09349762  -1.14112439]
mat_Sqrt:  [[11.3021436   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00758255 -0.07348758  0.56376949]
Stock Position:  -0.007582552927473195
Bond Position:  [3.33397826]


portfolio before change:  [2.54586975]
curr_Stock_Price:  104.04702911886622
curr_Factors:  [104.04702912  -1.21280856  -1.09807696]
mat_Sqrt:  [[10.31869687  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00124501 0.00497589 0.53995584]
Stock Position:  0.0012450130892909977
Bond Position:  [2.41632984]


portfolio before change:  [2.54550112]
curr_Stock_Price:  103.26567869548663
curr_Factors:  [103.2656787   -1.33473354  -1.08063418]
mat_Sqrt:  [[ 9.22518603  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00586781  0.0288955  -0.23476805]
Stock Position:  -0.005867814152543846
Bond Position:  [3.15144493]


portfolio before change:  [2.54799906]
curr_Stock_Price:  102.97426067031765
curr_Factors:  [102.97426067  -1.01989349  -1.07439415]
mat_Sqrt:  [[12.68209829  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.03019319 -0.29327537 -0.40745291]
Stock Position:  -0.030193194574596696
Bond Position:  [5.65712095]


portfolio before change:  [2.53890649]
curr_Stock_Price:  103.32225407178383
curr_Factors:  [103.32225407  -0.80813218  -1.07461402]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [2.53890649]
Stock Price:  103.12712338562079
PL:  [-0.5882169]
Settle:  Tensor("sub_284:0", shape=(), dtype=float64)
PL:  Tensor("sub_285:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  143
output_Z_Vals[:, i, :]:  [[ 1.19251512e+02 -2.92846752e+01 -2.92776944e+01]
 [ 7.49113092e-02 -3.62272938e-02 -3.48182697e-03]
 [-5.05588084e-01 -8.79934484e-02  3.57881880e-01]
 [-4.29324087e-02 -1.38456180e-01 -4.42182426e-01]
 [-9.88296441e-02 -2.41910939e-01  2.15109929e-01]
 [-3.33820045e-01  8.15549626e-02  7.90010798e-03]
 [ 5.56204243e-02  3.33582531e-02 -1.79433194e-02]
 [-1.22693751e-01  1.95426995e-01 -8.20760976e-02]
 [-7.73236903e-02 -3.45328617e-02  5.97289747e-02]
 [-5.58782083e-03  6.70828403e-03 -2.07296700e-02]
 [ 1.89447714e-01 -6.07828718e-02 -5.89703042e-02]
 [-1.25991050e-01  7.40404527e-02  9.03797876e-02]
 [ 5.31668749e-02 -3.60970208e-03 -2.84110959e-02]
 [ 1.03754372e-02  6.19678487e-03  1.12114218e-01]
 [-2.40430511e-01  2.38594794e-01  4.13860344e-01]
 [-1.12993059e-01 -2.27703901e-01  1.93571487e-01]
 [-4.81526065e-02 -1.14004054e-01  2.62294295e-01]
 [-2.74747222e-01  4.12848803e-01 -9.64030013e-02]
 [-2.92103435e-01 -1.09651561e+00 -2.10214801e-01]
 [ 1.91646637e-01 -1.68842176e-01 -2.99129848e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.25151208 -29.28467519 -29.2776944 ]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  8.31409947  -9.26062741 -83.52111278]
init_Out:  [2.49223638]
Stock Position:  8.314099471154409
Bond position:  [-828.91771073]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [8.52341171]
curr_Stock_Price:  100.75034351912653
curr_Factors:  [100.75034352  -0.79640417  -1.02878452]
mat_Sqrt:  [[16.23966844  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0045115  -0.01145608 -0.00993268]
Stock Position:  0.004511496017745074
Bond Position:  [8.06887693]


portfolio before change:  [8.53205514]
curr_Stock_Price:  102.21902854014277
curr_Factors:  [102.21902854  -0.87360827  -1.00166329]
mat_Sqrt:  [[15.67153952  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02774506 -0.02782597  1.02093739]
Stock Position:  -0.027745055401550422
Bond Position:  [11.36812775]


portfolio before change:  [8.54173957]
curr_Stock_Price:  101.97242463788871
curr_Factors:  [101.97242464  -0.83215393  -0.96178107]
mat_Sqrt:  [[16.95847024  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00806485 -0.04378369 -1.26142338]
Stock Position:  -0.008064845455701183
Bond Position:  [9.36413142]


portfolio before change:  [8.53610128]
curr_Stock_Price:  102.96185653318193
curr_Factors:  [102.96185653  -0.90515822  -0.95693112]
mat_Sqrt:  [[15.99488941  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00382414 -0.07649896  0.61364875]
Stock Position:  -0.0038241356789273573
Bond Position:  [8.92984139]


portfolio before change:  [8.53648189]
curr_Stock_Price:  103.44618326145311
curr_Factors:  [103.44618326  -0.79967564  -0.93673221]
mat_Sqrt:  [[18.22225517  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0181153   0.02578994  0.02253681]
Stock Position:  -0.018115304552500024
Bond Position:  [10.410441]


portfolio before change:  [8.57706821]
curr_Stock_Price:  101.3494268171495
curr_Factors:  [101.34942682  -1.04389664  -0.92972124]
mat_Sqrt:  [[14.08283012  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0037506   0.01054881 -0.0511873 ]
Stock Position:  0.003750600231351819
Bond Position:  [8.19694702]


portfolio before change:  [8.58144422]
curr_Stock_Price:  101.9697336340022
curr_Factors:  [101.96973363  -1.1363689   -0.92846544]
mat_Sqrt:  [[12.93376975  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01039152  0.06179944 -0.23414026]
Stock Position:  -0.010391522594876862
Bond Position:  [9.64106501]


portfolio before change:  [8.5817002]
curr_Stock_Price:  102.17707482333516
curr_Factors:  [102.17707482  -0.90068002  -0.93175475]
mat_Sqrt:  [[16.35073037  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00403794 -0.01092025  0.17039014]
Stock Position:  -0.004037935770721964
Bond Position:  [8.99428466]


portfolio before change:  [8.57386142]
curr_Stock_Price:  104.67528924191859
curr_Factors:  [104.67528924  -1.14568738  -0.97301404]
mat_Sqrt:  [[12.58067195  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00076673  0.00212135 -0.05913598]
Stock Position:  -0.0007667348683979709
Bond Position:  [8.65411962]


portfolio before change:  [8.57582889]
curr_Stock_Price:  104.93135421468783
curr_Factors:  [104.93135421  -0.6753475   -0.94504086]
mat_Sqrt:  [[20.75771535  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00847112 -0.01922123 -0.16822586]
Stock Position:  0.00847111739594054
Bond Position:  [7.68694307]


portfolio before change:  [8.59946067]
curr_Stock_Price:  107.4941572615772
curr_Factors:  [107.49415726  -1.11618788  -0.92890349]
mat_Sqrt:  [[13.90634381  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00759586  0.02341365  0.25782838]
Stock Position:  -0.007595859700795319
Bond Position:  [9.41597121]


portfolio before change:  [8.58760104]
curr_Stock_Price:  109.36542920562552
curr_Factors:  [109.36542921  -1.39150153  -0.88551254]
mat_Sqrt:  [[11.21980777  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00421347 -0.00114149 -0.08104895]
Stock Position:  0.004213466322385323
Bond Position:  [8.12679349]


portfolio before change:  [8.59100798]
curr_Stock_Price:  109.69176101892748
curr_Factors:  [109.69176102  -1.25662923  -0.86669415]
mat_Sqrt:  [[13.12279618  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00254676 0.0019596  0.31983066]
Stock Position:  0.002546763355159904
Bond Position:  [8.31164902]


portfolio before change:  [8.59252909]
curr_Stock_Price:  109.47302809661659
curr_Factors:  [109.4730281   -0.86485145  -0.84094113]
mat_Sqrt:  [[19.88340817  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00753347  0.0754503   1.18062836]
Stock Position:  -0.007533473620430432
Bond Position:  [9.41724126]


portfolio before change:  [8.62300667]
curr_Stock_Price:  105.73995891259355
curr_Factors:  [105.73995891  -0.84023298  -0.82409789]
mat_Sqrt:  [[20.0184028   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00396434 -0.0720063   0.55220557]
Stock Position:  -0.003964338960062603
Bond Position:  [9.04219571]


portfolio before change:  [8.61970884]
curr_Stock_Price:  107.14212651920954
curr_Factors:  [107.14212652  -0.49462507  -0.80487712]
mat_Sqrt:  [[29.21417538  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 8.36724049e-05 -3.60512472e-02  7.48252615e-01]
Stock Position:  8.367240486922022e-05
Bond Position:  [8.610744]


portfolio before change:  [8.62198658]
curr_Stock_Price:  108.6335625098813
curr_Factors:  [108.63356251  -0.44744303  -0.78003361]
mat_Sqrt:  [[31.83300883  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0089142   0.13055425 -0.27501093]
Stock Position:  -0.008914196360981286
Bond Position:  [9.59036749]


portfolio before change:  [8.58898027]
curr_Stock_Price:  112.60522796455012
curr_Factors:  [112.60522796  -0.39606097  -0.81384149]
mat_Sqrt:  [[33.58184784  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0108191  -0.34674868 -0.59968432]
Stock Position:  -0.010819096806936568
Bond Position:  [9.80726713]


portfolio before change:  [8.58437361]
curr_Stock_Price:  113.25766568743025
curr_Factors:  [113.25766569  -0.24723081  -0.77067869]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [8.58437361]
Stock Price:  110.69655038306963
PL:  [-2.11217678]
Settle:  Tensor("sub_286:0", shape=(), dtype=float64)
PL:  Tensor("sub_287:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  144
output_Z_Vals[:, i, :]:  [[ 1.19251512e+02 -2.92846752e+01 -2.92776944e+01]
 [-2.02162860e-01  3.37597686e-02 -9.01893160e-02]
 [-2.29270388e-01 -2.22082021e-02  1.67593668e-01]
 [-4.69278500e-02 -4.27990823e-02 -1.62344254e-01]
 [-9.88296441e-02 -2.41910939e-01  2.15109929e-01]
 [-1.28953399e-01 -7.53225252e-02  1.64903679e-02]
 [ 5.58885577e-02  2.88971722e-02 -1.61938311e-02]
 [-1.12402965e-01  1.88915701e-01 -9.65911676e-02]
 [-1.21671148e-01 -6.11763190e-02  1.20709477e-01]
 [ 4.50470017e-02  4.74936917e-02 -1.18045691e-02]
 [ 4.06819399e-02  7.85164809e-02 -1.29775878e-02]
 [ 9.72837179e-02 -1.05518242e-02 -1.31292254e-01]
 [ 5.12690775e-02 -9.15115724e-03 -2.76277420e-01]
 [-8.13897648e-02  3.07141577e-02 -2.88000178e-02]
 [-2.70744078e-02 -4.33992475e-02  2.78672690e-02]
 [ 6.25366022e-02 -9.33622310e-03  7.71233429e-02]
 [-2.35647895e-02  1.03259148e-01  6.82888801e-02]
 [ 2.93370969e-02 -3.28449990e-03 -1.75994572e-02]
 [-3.04294493e-01 -8.05790203e-01 -1.22526186e-01]
 [ 1.12939445e-01 -1.23609631e-01 -1.98466792e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.25151208 -29.28467519 -29.2776944 ]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  8.31409947  -9.26062741 -83.52111278]
init_Out:  [2.49223638]
Stock Position:  8.314099471154409
Bond position:  [-828.91771073]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-1.10940424]
curr_Stock_Price:  99.59173145491303
curr_Factors:  [99.59173145 -0.83806403 -0.95836813]
mat_Sqrt:  [[16.52124255  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01329809  0.01067578 -0.25728501]
Stock Position:  -0.013298092030853897
Bond Position:  [0.21497577]


portfolio before change:  [-1.12075502]
curr_Stock_Price:  100.44933774930871
curr_Factors:  [100.44933775  -0.86224171  -0.96124231]
mat_Sqrt:  [[16.21877432  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01206219 -0.00702285  0.47809809]
Stock Position:  -0.01206218692925954
Bond Position:  [0.09088367]


portfolio before change:  [-1.12049362]
curr_Stock_Price:  100.42955020830523
curr_Factors:  [100.42955021  -0.91844711  -0.97126942]
mat_Sqrt:  [[15.1763752   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00534853 -0.01353426 -0.46312297]
Stock Position:  -0.005348530103216691
Bond Position:  [-0.58334314]


portfolio before change:  [-1.12141066]
curr_Stock_Price:  100.57373725177696
curr_Factors:  [100.57373725  -0.84239757  -0.99639244]
mat_Sqrt:  [[15.99220087  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00382478 -0.07649896  0.61364875]
Stock Position:  -0.0038247785749473237
Bond Position:  [-0.73673838]


portfolio before change:  [-1.12506831]
curr_Stock_Price:  101.48187850968066
curr_Factors:  [101.48187851  -0.87884619  -1.01521034]
mat_Sqrt:  [[15.26898606  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00835236 -0.02381907  0.04704243]
Stock Position:  -0.008352364432546226
Bond Position:  [-0.27745467]


portfolio before change:  [-1.12160918]
curr_Stock_Price:  101.059424183317
curr_Factors:  [101.05942418  -1.09208679  -1.03610225]
mat_Sqrt:  [[12.03139712  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0044325   0.00913809 -0.04619649]
Stock Position:  0.0044324966613018355
Bond Position:  [-1.56955475]


portfolio before change:  [-1.11964179]
curr_Stock_Price:  101.59181694042638
curr_Factors:  [101.59181694  -1.41710463  -1.04097565]
mat_Sqrt:  [[ 8.69617014  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01463193  0.05974039 -0.27554772]
Stock Position:  -0.014631932199765609
Bond Position:  [0.36684278]


portfolio before change:  [-1.10455297]
curr_Stock_Price:  100.56686022662862
curr_Factors:  [100.56686023  -1.0942374   -1.04005638]
mat_Sqrt:  [[11.89988811  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00828672 -0.01934565  0.34435054]
Stock Position:  -0.00828671613021
Bond Position:  [-0.27118395]


portfolio before change:  [-1.10522519]
curr_Stock_Price:  100.63979783404898
curr_Factors:  [100.63979783  -0.92383589  -1.05550452]
mat_Sqrt:  [[13.9044283   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00315466  0.01501882 -0.03367515]
Stock Position:  0.003154655844077492
Bond Position:  [-1.42270912]


portfolio before change:  [-1.10481515]
curr_Stock_Price:  100.88253908343209
curr_Factors:  [100.88253908  -0.76281882  -1.0556141 ]
mat_Sqrt:  [[16.371204    0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00244699  0.02482909 -0.03702145]
Stock Position:  0.002446990929990568
Bond Position:  [-1.35167381]


portfolio before change:  [-1.10822337]
curr_Stock_Price:  99.62783065933966
curr_Factors:  [99.62783066 -0.7266427  -1.04109117]
mat_Sqrt:  [[17.00840574  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00412804 -0.00333678 -0.37454026]
Stock Position:  0.004128038392761899
Bond Position:  [-1.51949088]


portfolio before change:  [-1.10591339]
curr_Stock_Price:  100.27944789729625
curr_Factors:  [100.2794479   -1.16317724  -1.01613657]
mat_Sqrt:  [[11.34352346  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-4.72701154e-04 -2.89385001e-03 -7.88142579e-01]
Stock Position:  -0.00047270115350569607
Bond Position:  [-1.05851118]


portfolio before change:  [-1.10605273]
curr_Stock_Price:  100.01433426532535
curr_Factors:  [100.01433427  -1.29511805  -0.94817468]
mat_Sqrt:  [[10.6123751   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00814855  0.00971267 -0.08215843]
Stock Position:  -0.008148553631722542
Bond Position:  [-0.29108056]


portfolio before change:  [-1.10531725]
curr_Stock_Price:  99.91514314466484
curr_Factors:  [99.91514314 -1.15100749 -0.92515248]
mat_Sqrt:  [[12.53044495  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00179615 -0.01372405  0.07949756]
Stock Position:  -0.0017961524285751698
Bond Position:  [-0.92585442]


portfolio before change:  [-1.10474842]
curr_Stock_Price:  99.46956990968891
curr_Factors:  [99.46956991 -1.05561715 -0.91369844]
mat_Sqrt:  [[13.88121072  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00562186 -0.00295237  0.22001143]
Stock Position:  0.005621863968612961
Bond Position:  [-1.66395281]


portfolio before change:  [-1.111684]
curr_Stock_Price:  98.30989442765227
curr_Factors:  [98.30989443 -0.87972265 -0.89399348]
mat_Sqrt:  [[16.68330536  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00041714  0.03265341  0.19480917]
Stock Position:  -0.0004171379924462735
Bond Position:  [-1.07067521]


portfolio before change:  [-1.11242829]
curr_Stock_Price:  99.45242142925775
curr_Factors:  [99.45242143 -1.03965712 -0.88689857]
mat_Sqrt:  [[14.48514531  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00177146 -0.00103865 -0.05020635]
Stock Position:  0.0017714573671289693
Bond Position:  [-1.28860402]


portfolio before change:  [-1.11206989]
curr_Stock_Price:  99.83661862360094
curr_Factors:  [99.83661862 -0.9501726  -0.86134752]
mat_Sqrt:  [[16.31385772  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02146092 -0.25481324 -0.3495331 ]
Stock Position:  -0.021460923949934305
Bond Position:  [1.03051619]


portfolio before change:  [-1.08009795]
curr_Stock_Price:  98.35884991485226
curr_Factors:  [98.35884991 -0.7851653  -0.85879153]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-1.08009795]
Stock Price:  100.47131687867525
PL:  [-1.55141483]
Settle:  Tensor("sub_288:0", shape=(), dtype=float64)
PL:  Tensor("sub_289:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  145
output_Z_Vals[:, i, :]:  [[ 1.19251512e+02 -2.92846752e+01 -2.92776944e+01]
 [-1.38223473e-01  1.99432353e-02 -9.75805875e-02]
 [-2.25949988e-01 -2.13064856e-02  1.66186587e-01]
 [-3.01943911e-02  3.32775987e-02  4.69965192e-02]
 [-9.05810545e-02 -1.72983078e-01  1.45195785e-01]
 [-4.45872467e-02  2.06972881e-02 -1.34324953e-02]
 [-6.86424445e-02 -2.69014745e-02  3.95732842e-02]
 [-5.46053785e-02  8.96619554e-02 -1.12514953e-01]
 [-1.58738478e-01 -8.41823127e-02  1.73451465e-01]
 [ 6.21735878e-02  5.11200553e-02 -3.03299302e-03]
 [-1.51642848e-02  1.10880964e-01 -3.16879517e-03]
 [-1.75280932e-02 -8.52816627e-03 -1.00300492e-01]
 [ 4.48136834e-02 -5.42679655e-02 -2.23664254e-01]
 [-3.74050919e-03  7.64680583e-03  6.84307832e-04]
 [ 2.39770430e-02 -6.53652461e-02 -5.10794436e-02]
 [ 1.44137009e-01  5.99447739e-03 -1.57116546e-02]
 [-1.00150975e-02  6.37956258e-02  7.85703240e-02]
 [ 3.81850382e-02 -1.53006885e-02  1.74478130e-02]
 [-2.65506257e-01 -7.18569105e-01 -1.03320141e-01]
 [ 9.00696942e-02 -7.55760465e-02 -1.34981467e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.25151208 -29.28467519 -29.2776944 ]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  8.31409947  -9.26062741 -83.52111278]
init_Out:  [2.49223638]
Stock Position:  8.314099471154409
Bond position:  [-828.91771073]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [0.19982922]
curr_Stock_Price:  99.74920292459996
curr_Factors:  [99.74920292 -0.96690973 -1.00196857]
mat_Sqrt:  [[13.92632256  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01131864  0.0063066  -0.27837025]
Stock Position:  -0.011318644550917245
Bond Position:  [1.32885499]


portfolio before change:  [0.19527797]
curr_Stock_Price:  100.1806592257772
curr_Factors:  [100.18065923  -0.99728583  -1.01590959]
mat_Sqrt:  [[13.38024994  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01439266 -0.0067377   0.47408408]
Stock Position:  -0.014392662715418864
Bond Position:  [1.63714441]


portfolio before change:  [0.21400521]
curr_Stock_Price:  98.90793439270296
curr_Factors:  [98.90793439 -0.74182682 -1.01411865]
mat_Sqrt:  [[17.08573654  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00115547  0.0105233   0.13406799]
Stock Position:  -0.0011554692296231832
Bond Position:  [0.32829029]


portfolio before change:  [0.21390938]
curr_Stock_Price:  99.06191261058184
curr_Factors:  [99.06191261 -0.63056534 -1.01079945]
mat_Sqrt:  [[19.18982611  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00340855 -0.05470205  0.41420316]
Stock Position:  -0.0034085505726208177
Bond Position:  [0.55156692]


portfolio before change:  [0.21441541]
curr_Stock_Price:  98.953913023184
curr_Factors:  [98.95391302 -0.65965702 -1.02050753]
mat_Sqrt:  [[18.43939978  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00253776  0.00654506 -0.03831917]
Stock Position:  -0.0025377583993970378
Bond Position:  [0.46553653]


portfolio before change:  [0.21545569]
curr_Stock_Price:  98.58985983949562
curr_Factors:  [98.58985984 -1.07381796 -1.01978254]
mat_Sqrt:  [[12.15047069  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00504171 -0.00850699  0.11289156]
Stock Position:  -0.005041712069694276
Bond Position:  [0.71251737]


portfolio before change:  [0.21655908]
curr_Stock_Price:  98.40634140210693
curr_Factors:  [98.4063414  -1.21037979 -0.98621594]
mat_Sqrt:  [[10.94091595  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00687852  0.0283536  -0.32097384]
Stock Position:  -0.006878522384257202
Bond Position:  [0.89344931]


portfolio before change:  [0.2143033]
curr_Stock_Price:  98.76676433417802
curr_Factors:  [98.76676433 -1.50793007 -0.94451743]
mat_Sqrt:  [[ 8.502104    0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01476181 -0.02662078  0.49480875]
Stock Position:  -0.014761807618201395
Bond Position:  [1.67227927]


portfolio before change:  [0.21489235]
curr_Stock_Price:  98.75518507458003
curr_Factors:  [98.75518507 -1.24615249 -0.95443422]
mat_Sqrt:  [[10.93596827  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00574932  0.01616558 -0.00865228]
Stock Position:  0.005749321259631011
Bond Position:  [-0.35288294]


portfolio before change:  [0.21598768]
curr_Stock_Price:  98.96104582446536
curr_Factors:  [98.96104582 -1.3537456  -0.98213635]
mat_Sqrt:  [[ 9.5720208   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00135271  0.03506364 -0.00903969]
Stock Position:  -0.0013527110375014474
Bond Position:  [0.34985338]


portfolio before change:  [0.216341]
curr_Stock_Price:  98.76451614053413
curr_Factors:  [98.76451614 -1.43924535 -0.94187207]
mat_Sqrt:  [[ 9.13050464  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00418619 -0.00269684 -0.28612939]
Stock Position:  -0.004186191590075586
Bond Position:  [0.62978819]


portfolio before change:  [0.21628459]
curr_Stock_Price:  98.81560764118758
curr_Factors:  [98.81560764 -1.34703693 -0.95939448]
mat_Sqrt:  [[ 9.84362611  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-2.27841246e-04 -1.71610375e-02 -6.38051860e-01]
Stock Position:  -0.00022784124595400668
Bond Position:  [0.23879886]


portfolio before change:  [0.2167123]
curr_Stock_Price:  97.20044476000164
curr_Factors:  [97.20044476 -1.22039791 -0.974879  ]
mat_Sqrt:  [[10.82110489  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00031451  0.00241813  0.00195214]
Stock Position:  -0.0003145137022742503
Bond Position:  [0.24728317]


portfolio before change:  [0.21654443]
curr_Stock_Price:  97.93075721381773
curr_Factors:  [97.93075721 -1.102475   -0.9469383 ]
mat_Sqrt:  [[12.61450534  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00094041 -0.02067031 -0.14571543]
Stock Position:  0.0009404072183077584
Bond Position:  [0.12444964]


portfolio before change:  [0.21643163]
curr_Stock_Price:  97.77772307555188
curr_Factors:  [97.77772308 -0.8450482  -0.89594138]
mat_Sqrt:  [[17.14501034  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0082289   0.00189562 -0.04482098]
Stock Position:  0.008228904776488561
Bond Position:  [-0.58817194]


portfolio before change:  [0.20565813]
curr_Stock_Price:  96.48636731076701
curr_Factors:  [96.48636731 -0.75271437 -0.90519454]
mat_Sqrt:  [[18.38422238  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00041722 0.02017395 0.22413926]
Stock Position:  0.0004172163768470607
Bond Position:  [0.16540244]


portfolio before change:  [0.20664027]
curr_Stock_Price:  98.74128791961152
curr_Factors:  [98.74128792 -1.06976248 -0.95469574]
mat_Sqrt:  [[13.04030518  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00317105 -0.0048385   0.04977375]
Stock Position:  0.003171052784241123
Bond Position:  [-0.10647356]


portfolio before change:  [0.20506702]
curr_Stock_Price:  98.25355340784348
curr_Factors:  [98.25355341 -1.23305792 -0.95690216]
mat_Sqrt:  [[10.99665722  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02774932 -0.2272315  -0.2947436 ]
Stock Position:  -0.02774932063216033
Bond Position:  [2.93153638]


portfolio before change:  [0.1869296]
curr_Stock_Price:  98.93358427562966
curr_Factors:  [98.93358428 -1.16405598 -0.9802159 ]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [0.1869296]
Stock Price:  100.15297566632901
PL:  [0.03395393]
Settle:  Tensor("sub_290:0", shape=(), dtype=float64)
PL:  Tensor("sub_291:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  146
output_Z_Vals[:, i, :]:  [[ 1.19251512e+02 -2.92846752e+01 -2.92776944e+01]
 [ 6.28152919e-03 -8.31462178e-02 -2.27391063e-01]
 [-4.69165721e-01 -8.01117123e-02  3.26553776e-01]
 [ 2.97258050e-02 -1.50621884e-01 -4.65583329e-01]
 [-9.88296441e-02 -2.41910939e-01  2.15109929e-01]
 [-1.82660700e-01 -2.65099483e-02  8.24275558e-03]
 [ 5.40567703e-02  5.93736083e-02 -2.81456814e-02]
 [-1.80386888e-01  2.59777000e-01 -5.04989850e-02]
 [-3.96621907e-02 -2.53901667e-02  4.03924343e-02]
 [ 4.50470017e-02  4.74936917e-02 -1.18045691e-02]
 [ 9.19157493e-02  4.09991275e-02 -1.64805071e-02]
 [ 1.53058900e-01 -1.21874908e-02 -1.55379882e-01]
 [ 4.49515357e-02 -1.07161298e-02 -2.36782152e-01]
 [-8.36212001e-02  3.00227704e-02 -3.38487271e-02]
 [-1.87989355e-02 -4.85772707e-02  1.66181859e-02]
 [ 6.97260776e-02 -1.14379548e-02  6.98348205e-02]
 [-2.45036319e-02  1.04539589e-01  7.00798581e-02]
 [ 3.44880698e-02 -1.16731057e-02  1.35995047e-02]
 [-2.98355666e-01 -7.88602092e-01 -1.27883463e-01]
 [ 7.44945754e-02 -3.97829075e-02 -8.87229336e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.25151208 -29.28467519 -29.2776944 ]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  8.31409947  -9.26062741 -83.52111278]
init_Out:  [2.49223638]
Stock Position:  8.314099471154409
Bond position:  [-828.91771073]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [13.04240911]
curr_Stock_Price:  101.29387771924492
curr_Factors:  [101.29387772  -1.08146881  -0.99153872]
mat_Sqrt:  [[12.74346309  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00331788 -0.02629314 -0.64868341]
Stock Position:  -0.0033178817225772636
Bond Position:  [13.37849022]


portfolio before change:  [13.04438828]
curr_Stock_Price:  101.7055487104418
curr_Factors:  [101.70554871  -1.13744378  -0.99925256]
mat_Sqrt:  [[12.00574782  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.03369858 -0.02533355  0.93156703]
Stock Position:  -0.033698582701888004
Bond Position:  [16.47172112]


portfolio before change:  [13.00934287]
curr_Stock_Price:  102.86772969835707
curr_Factors:  [102.8677297   -0.90263212  -0.99677863]
mat_Sqrt:  [[15.39485309  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00449501 -0.04763082 -1.32817965]
Stock Position:  -0.004495011033854549
Bond Position:  [13.47173445]


portfolio before change:  [13.01257351]
curr_Stock_Price:  102.89836773870917
curr_Factors:  [102.89836774  -0.794752    -1.02130673]
mat_Sqrt:  [[16.73802463  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00365435 -0.07649896  0.61364875]
Stock Position:  -0.0036543516107761347
Bond Position:  [13.38860032]


portfolio before change:  [13.01995242]
curr_Stock_Price:  101.79520417845636
curr_Factors:  [101.79520418  -0.66446794  -1.03925225]
mat_Sqrt:  [[18.52725351  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00980516 -0.00838318  0.02351429]
Stock Position:  -0.009805157502036891
Bond Position:  [14.01807043]


portfolio before change:  [13.01991293]
curr_Stock_Price:  102.1566921288789
curr_Factors:  [102.15669213  -0.74586083  -1.04559369]
mat_Sqrt:  [[17.03130818  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00292664  0.01877558 -0.08029179]
Stock Position:  0.0029266440716374667
Bond Position:  [12.72093666]


portfolio before change:  [13.03002232]
curr_Stock_Price:  104.52416690504016
curr_Factors:  [104.52416691  -0.86647058  -1.04001245]
mat_Sqrt:  [[15.53251053  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01184532  0.0821487  -0.14405955]
Stock Position:  -0.011845318689024014
Bond Position:  [14.26814439]


portfolio before change:  [13.06122315]
curr_Stock_Price:  102.19131693963843
curr_Factors:  [102.19131694  -1.02618965  -1.04540527]
mat_Sqrt:  [[12.87454095  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00249117 -0.00802908  0.11522837]
Stock Position:  -0.0024911716102198373
Bond Position:  [13.31579926]


portfolio before change:  [13.06824467]
curr_Stock_Price:  100.70922260231437
curr_Factors:  [100.7092226   -0.87600549  -1.04046675]
mat_Sqrt:  [[14.81685139  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00296039  0.01501882 -0.03367515]
Stock Position:  0.002960391842970513
Bond Position:  [12.77010591]


portfolio before change:  [13.07602154]
curr_Stock_Price:  102.25764750540671
curr_Factors:  [102.25764751  -1.01590183  -1.02329265]
mat_Sqrt:  [[13.30714502  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.006734    0.01296506 -0.0470143 ]
Stock Position:  0.006733996861284509
Bond Position:  [12.38741886]


portfolio before change:  [13.07934937]
curr_Stock_Price:  102.2918899820345
curr_Factors:  [102.29188998  -1.11742346  -1.03557842]
mat_Sqrt:  [[11.8796698   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01018778 -0.00385402 -0.44325555]
Stock Position:  0.01018777771483546
Bond Position:  [12.03722233]


portfolio before change:  [13.07638366]
curr_Stock_Price:  101.70536390497968
curr_Factors:  [101.7053639   -1.03866982  -1.0364069 ]
mat_Sqrt:  [[12.7687825   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-2.86488389e-04 -3.38873778e-03 -6.75473571e-01]
Stock Position:  -0.00028648838939086417
Bond Position:  [13.10552106]


portfolio before change:  [13.08006209]
curr_Stock_Price:  100.30341227849928
curr_Factors:  [100.30341228  -0.56595953  -1.02273681]
mat_Sqrt:  [[20.48111773  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00438235  0.00949403 -0.096561  ]
Stock Position:  -0.0043823466691187115
Bond Position:  [13.51962641]


portfolio before change:  [13.08389167]
curr_Stock_Price:  100.2008988172028
curr_Factors:  [100.20089882  -0.41972963  -1.0535978 ]
mat_Sqrt:  [[22.96220776  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00072558 -0.01536148  0.04740706]
Stock Position:  -0.0007255845100879194
Bond Position:  [13.15659589]


portfolio before change:  [13.08768204]
curr_Stock_Price:  99.51067815266559
curr_Factors:  [99.51067815 -0.48121076 -1.0508097 ]
mat_Sqrt:  [[21.50411883  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00389161 -0.003617    0.1992193 ]
Stock Position:  0.0038916137209639573
Bond Position:  [12.70042492]


portfolio before change:  [13.08860063]
curr_Stock_Price:  98.93073567160678
curr_Factors:  [98.93073567 -0.58456568 -1.05141282]
mat_Sqrt:  [[19.26791861  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00038922  0.03305832  0.19991833]
Stock Position:  -0.00038921900846372175
Bond Position:  [13.12710635]


portfolio before change:  [13.09204471]
curr_Stock_Price:  98.51478748057065
curr_Factors:  [98.51478748 -0.80864122 -1.05581602]
mat_Sqrt:  [[15.26785179  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00242095 -0.00369136  0.0387956 ]
Stock Position:  0.0024209469225710736
Bond Position:  [12.85354564]


portfolio before change:  [13.09550107]
curr_Stock_Price:  98.61498139524352
curr_Factors:  [98.6149814  -1.09678837 -1.07074487]
mat_Sqrt:  [[11.28743257  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.03054914 -0.24937788 -0.36481592]
Stock Position:  -0.030549142582365053
Bond Position:  [16.10810419]


portfolio before change:  [13.05246819]
curr_Stock_Price:  100.15546330387541
curr_Factors:  [100.1554633   -1.13480116  -1.09542525]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [13.05246819]
Stock Price:  99.56399815071794
PL:  [13.05246819]
Settle:  Tensor("sub_292:0", shape=(), dtype=float64)
PL:  Tensor("sub_293:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  147
output_Z_Vals[:, i, :]:  [[ 1.19251512e+02 -2.92846752e+01 -2.92776944e+01]
 [ 4.40673438e-02 -5.63154493e-02 -1.17455583e-01]
 [-3.37976246e-01 -5.17225379e-02  2.13713282e-01]
 [-4.25350284e-02 -1.48057716e-01 -4.70097871e-01]
 [-9.88296441e-02 -2.41910939e-01  2.15109929e-01]
 [-2.98554885e-01  5.09573454e-02  1.21817402e-02]
 [ 5.24532279e-02  8.60526093e-02 -3.86083032e-02]
 [-1.70838358e-01  2.45586810e-01 -4.89221320e-02]
 [-8.09216800e-02 -4.14439397e-02  7.61064394e-02]
 [ 4.50470017e-02  4.74936917e-02 -1.18045691e-02]
 [ 3.52624590e-02  8.44307643e-02 -1.21867590e-02]
 [ 1.87920868e-01 -1.32098552e-02 -1.70435720e-01]
 [ 3.10036383e-02 -1.76621303e-02 -3.28369641e-01]
 [-8.45720117e-02  2.97281712e-02 -3.59999752e-02]
 [-1.36151338e-01  9.16312989e-02  2.63469125e-01]
 [-4.26577260e-02 -9.56977292e-02  1.33551435e-01]
 [-2.55275336e-02  1.00228829e-02  1.93759281e-01]
 [-8.95796366e-03  4.70494347e-02 -8.67967324e-02]
 [-3.41957667e-01 -9.02099479e-01 -1.64194420e-01]
 [ 7.47499801e-02 -4.03698522e-02 -8.94814925e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.25151208 -29.28467519 -29.2776944 ]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  8.31409947  -9.26062741 -83.52111278]
init_Out:  [2.49223638]
Stock Position:  8.314099471154409
Bond position:  [-828.91771073]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [8.69207529]
curr_Stock_Price:  100.77062997179792
curr_Factors:  [100.77062997  -1.07270393  -0.99203955]
mat_Sqrt:  [[12.7828376   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00145803 -0.01780851 -0.33506809]
Stock Position:  0.0014580303023503452
Bond Position:  [8.54514866]


portfolio before change:  [8.69455168]
curr_Stock_Price:  101.00370867166052
curr_Factors:  [101.00370867  -0.93416538  -1.0094393 ]
mat_Sqrt:  [[14.46240542  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02044526 -0.0163561   0.60966451]
Stock Position:  -0.020445262511957267
Bond Position:  [10.75959902]


portfolio before change:  [8.67698589]
curr_Stock_Price:  101.99445324081209
curr_Factors:  [101.99445324  -0.81118133  -1.05082356]
mat_Sqrt:  [[15.84594354  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00898124 -0.04681996 -1.34105838]
Stock Position:  -0.008981237873969419
Bond Position:  [9.59302233]


portfolio before change:  [8.6804923]
curr_Stock_Price:  101.87110120117302
curr_Factors:  [101.8711012   -1.03642165  -1.00645952]
mat_Sqrt:  [[13.20805837  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00463101 -0.07649896  0.61364875]
Stock Position:  -0.004631008249255626
Bond Position:  [9.15225821]


portfolio before change:  [8.67688489]
curr_Stock_Price:  103.14420501486275
curr_Factors:  [103.14420501  -0.93133464  -1.02925631]
mat_Sqrt:  [[14.52014658  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02029956  0.01611413  0.03475111]
Stock Position:  -0.02029955987724557
Bond Position:  [10.77066686]


portfolio before change:  [8.68042702]
curr_Stock_Price:  103.10237521356247
curr_Factors:  [103.10237521  -0.68027487  -1.00965174]
mat_Sqrt:  [[19.02579748  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00245951  0.02721222 -0.11013874]
Stock Position:  0.0024595137125890073
Bond Position:  [8.42684532]


portfolio before change:  [8.68452327]
curr_Stock_Price:  103.91118144096068
curr_Factors:  [103.91118144  -0.68371155  -1.04292428]
mat_Sqrt:  [[18.4839111   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00943975  0.07766137 -0.13956123]
Stock Position:  -0.009439751190810761
Bond Position:  [9.66541896]


portfolio before change:  [8.70590281]
curr_Stock_Price:  101.90234850705403
curr_Factors:  [101.90234851  -0.8227714   -1.03644929]
mat_Sqrt:  [[15.87577399  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00418604 -0.01310572  0.21711049]
Stock Position:  -0.004186038177273842
Bond Position:  [9.13246993]


portfolio before change:  [8.71598797]
curr_Stock_Price:  100.03858974219055
curr_Factors:  [100.03858974  -0.32567558  -1.04131006]
mat_Sqrt:  [[25.49724402  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00172033  0.01501882 -0.03367515]
Stock Position:  0.0017203304783436726
Bond Position:  [8.54388854]


portfolio before change:  [8.71785732]
curr_Stock_Price:  99.88344779431901
curr_Factors:  [99.88344779 -0.16118936 -1.02048653]
mat_Sqrt:  [[30.64066647  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0011408   0.02669935 -0.03476543]
Stock Position:  0.0011407989527016473
Bond Position:  [8.60391039]


portfolio before change:  [8.72075942]
curr_Stock_Price:  100.54162780739293
curr_Factors:  [100.54162781  -0.25496168  -1.03093673]
mat_Sqrt:  [[27.78992198  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00549803 -0.00417732 -0.48620567]
Stock Position:  0.005498027157478474
Bond Position:  [8.16797882]


portfolio before change:  [8.74021846]
curr_Stock_Price:  103.70945340225082
curr_Factors:  [103.7094534   -0.26113599  -1.04035614]
mat_Sqrt:  [[28.22198099  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00129263 -0.00558526 -0.93674718]
Stock Position:  -0.0012926296049443587
Bond Position:  [8.87427637]


portfolio before change:  [8.74284466]
curr_Stock_Price:  103.39431306906202
curr_Factors:  [103.39431307  -0.66924847  -1.03199486]
mat_Sqrt:  [[18.86496753  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00483186  0.00940087 -0.10269791]
Stock Position:  -0.0048318608347491234
Bond Position:  [9.24243159]


portfolio before change:  [8.73847107]
curr_Stock_Price:  104.77773188263748
curr_Factors:  [104.77773188  -0.53977214  -1.01856353]
mat_Sqrt:  [[22.05425607  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00362765  0.02897636  0.75160408]
Stock Position:  -0.003627645287948925
Bond Position:  [9.11856752]


portfolio before change:  [8.74741731]
curr_Stock_Price:  102.94009098579457
curr_Factors:  [102.94009099  -0.62114366  -1.02120184]
mat_Sqrt:  [[19.92154235  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0008969  -0.03026228  0.38098507]
Stock Position:  -0.000896896334810158
Bond Position:  [8.8397439]


portfolio before change:  [8.74872683]
curr_Stock_Price:  103.94431887565236
curr_Factors:  [103.94431888  -1.0159258   -1.04091511]
mat_Sqrt:  [[13.29003428  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00107466 0.00316951 0.5527413 ]
Stock Position:  0.0010746551503276092
Bond Position:  [8.63702253]


portfolio before change:  [8.7485625]
curr_Stock_Price:  101.78189580685695
curr_Factors:  [101.78189581  -0.889501    -1.04391352]
mat_Sqrt:  [[14.72310051  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00172929  0.01487834 -0.24760692]
Stock Position:  -0.001729286658200297
Bond Position:  [8.92457257]


portfolio before change:  [8.75249609]
curr_Stock_Price:  100.79757695859617
curr_Factors:  [100.79757696  -0.81842806  -1.06112547]
mat_Sqrt:  [[15.38758154  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02591478 -0.2852689  -0.46840098]
Stock Position:  -0.02591478200578086
Bond Position:  [11.36464332]


portfolio before change:  [8.77279165]
curr_Stock_Price:  100.12405996315393
curr_Factors:  [100.12405996  -1.0978214   -1.10408479]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [8.77279165]
Stock Price:  100.54318739370036
PL:  [8.22960426]
Settle:  Tensor("sub_294:0", shape=(), dtype=float64)
PL:  Tensor("sub_295:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  148
output_Z_Vals[:, i, :]:  [[ 1.19251512e+02 -2.92846752e+01 -2.92776944e+01]
 [-1.19316585e-01  1.30805981e-02 -1.16244871e-01]
 [-4.23685798e-01 -7.02699360e-02  2.87434960e-01]
 [ 6.71722461e-02 -1.55883532e-01 -4.73482092e-01]
 [-9.88296441e-02 -2.41910939e-01  2.15109929e-01]
 [-4.28061621e-01  1.39392986e-01  3.10520137e-03]
 [ 5.10615817e-02  1.09206178e-01 -4.76883669e-02]
 [-2.43073653e-01  3.95029596e-01 -8.87557883e-03]
 [-4.97766975e-02 -9.98857484e-03 -6.62873640e-03]
 [ 4.85497189e-02  3.00963969e-02 -5.99463174e-03]
 [ 1.44494601e-01 -1.33006256e-02 -3.80414849e-02]
 [ 1.56551774e-01 -1.22899231e-02 -1.56888349e-01]
 [ 4.77751646e-02 -8.29239635e-03 -1.66125411e-01]
 [-8.45720117e-02  2.97281712e-02 -3.59999752e-02]
 [-1.39483833e-01  9.63278754e-02  2.68275243e-01]
 [-8.27881959e-02 -1.71903732e-01  1.68000279e-01]
 [-2.62267143e-02 -1.11800166e-02  2.23933520e-01]
 [-7.71378515e-02  1.40775359e-01 -8.95610296e-02]
 [-3.32336468e-01 -9.19266263e-01 -1.60842001e-01]
 [ 8.33555087e-02 -6.01461948e-02 -1.15040151e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.25151208 -29.28467519 -29.2776944 ]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  8.31409947  -9.26062741 -83.52111278]
init_Out:  [2.49223638]
Stock Position:  8.314099471154409
Bond position:  [-828.91771073]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [2.31799229]
curr_Stock_Price:  100.00397051325713
curr_Factors:  [100.00397051  -0.93162047  -0.9484472 ]
mat_Sqrt:  [[15.25858382  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00935259  0.00413645 -0.33161426]
Stock Position:  -0.009352586862536812
Bond Position:  [3.25328811]


portfolio before change:  [2.30465365]
curr_Stock_Price:  101.51714155463605
curr_Factors:  [101.51714155  -1.09569146  -0.96001272]
mat_Sqrt:  [[12.99446485  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02822954 -0.0222213   0.81997193]
Stock Position:  -0.028229538406998284
Bond Position:  [5.1704357]


portfolio before change:  [2.25570582]
curr_Stock_Price:  103.29685919665704
curr_Factors:  [103.2968592   -0.93129899  -1.01449521]
mat_Sqrt:  [[14.7584054   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00227001 -0.0492947  -1.35071262]
Stock Position:  -0.002270013303289057
Bond Position:  [2.49019106]


portfolio before change:  [2.25613199]
curr_Stock_Price:  103.38340218996873
curr_Factors:  [103.38340219  -0.70117268  -1.00230831]
mat_Sqrt:  [[18.82081499  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00324995 -0.07649896  0.61364875]
Stock Position:  -0.003249945726416911
Bond Position:  [2.59212243]


portfolio before change:  [2.25398613]
curr_Stock_Price:  104.24309998264751
curr_Factors:  [104.24309998  -0.80668992  -0.99082977]
mat_Sqrt:  [[17.27406045  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02453556  0.04407993  0.00885828]
Stock Position:  -0.024535555149823862
Bond Position:  [4.81164846]


portfolio before change:  [2.19601981]
curr_Stock_Price:  106.65467686007086
curr_Factors:  [106.65467686  -1.26401593  -0.9707301 ]
mat_Sqrt:  [[11.41410959  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00386775  0.03453403 -0.13604164]
Stock Position:  0.003867750316738033
Bond Position:  [1.78350615]


portfolio before change:  [2.20019531]
curr_Stock_Price:  107.61894888354195
curr_Factors:  [107.61894888  -1.04659275  -0.99125752]
mat_Sqrt:  [[14.02366797  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01673498  0.12491933 -0.02531956]
Stock Position:  -0.016734976418425453
Bond Position:  [4.00119588]


portfolio before change:  [2.22645583]
curr_Stock_Price:  106.1095295461071
curr_Factors:  [106.10952955  -0.82483841  -0.96989294]
mat_Sqrt:  [[17.63244219  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00291438 -0.00315866 -0.01890994]
Stock Position:  -0.002914382816660404
Bond Position:  [2.53569962]


portfolio before change:  [2.23613579]
curr_Stock_Price:  103.00562760668242
curr_Factors:  [103.00562761  -1.26560815  -0.95607939]
mat_Sqrt:  [[11.16848623  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00430704  0.00951732 -0.01710102]
Stock Position:  0.004307043450022115
Bond Position:  [1.79248608]


portfolio before change:  [2.24019633]
curr_Stock_Price:  103.8443372571207
curr_Factors:  [103.84433726  -1.47229948  -0.99731917]
mat_Sqrt:  [[ 8.7870089   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01552132 -0.00420603 -0.10852177]
Stock Position:  0.015521322050384168
Bond Position:  [0.62839493]


portfolio before change:  [2.22012219]
curr_Stock_Price:  102.54088754645097
curr_Factors:  [102.54088755  -1.09729656  -0.97723638]
mat_Sqrt:  [[12.88068219  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0096431  -0.00388641 -0.44755879]
Stock Position:  0.009643103340338575
Bond Position:  [1.23130981]


portfolio before change:  [2.23062713]
curr_Stock_Price:  103.59833570873856
curr_Factors:  [103.59833571  -1.19850302  -0.99266301]
mat_Sqrt:  [[11.58087739  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00117874 -0.00262229 -0.47390956]
Stock Position:  0.001178740418822183
Bond Position:  [2.10851159]


portfolio before change:  [2.23143143]
curr_Stock_Price:  103.83342128848015
curr_Factors:  [103.83342129  -1.17844189  -0.98748303]
mat_Sqrt:  [[11.90386308  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00765742  0.00940087 -0.10269791]
Stock Position:  -0.007657421554228842
Bond Position:  [3.02652771]


portfolio before change:  [2.22543727]
curr_Stock_Price:  104.71503448916827
curr_Factors:  [104.71503449  -1.05828792  -0.95457242]
mat_Sqrt:  [[13.99055366  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00587791  0.03046155  0.76531459]
Stock Position:  -0.005877909147451925
Bond Position:  [2.84094273]


portfolio before change:  [2.22817479]
curr_Stock_Price:  104.3701515200306
curr_Factors:  [104.37015152  -1.00848269  -0.93451262]
mat_Sqrt:  [[14.95354543  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00353988 -0.05436073  0.47925803]
Stock Position:  -0.003539884104472199
Bond Position:  [2.59763303]


portfolio before change:  [2.22770933]
curr_Stock_Price:  104.68511824964375
curr_Factors:  [104.68511825  -1.01622286  -0.94563474]
mat_Sqrt:  [[14.71841416  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00130414 -0.00353543  0.63882   ]
Stock Position:  0.0013041389504014718
Bond Position:  [2.09118539]


portfolio before change:  [2.22718987]
curr_Stock_Price:  103.88587219533377
curr_Factors:  [103.8858722   -0.90976423  -0.95831065]
mat_Sqrt:  [[16.04212435  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00572148  0.04451708 -0.25549269]
Stock Position:  -0.005721475159321327
Bond Position:  [2.8215703]


portfolio before change:  [2.23438941]
curr_Stock_Price:  102.75083880274248
curr_Factors:  [102.7508388   -0.81695712  -0.95611208]
mat_Sqrt:  [[17.44822307  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02228901 -0.29069752 -0.45883746]
Stock Position:  -0.022289006477475223
Bond Position:  [4.52460353]


portfolio before change:  [2.22254481]
curr_Stock_Price:  103.33300472854621
curr_Factors:  [103.33300473  -0.54138575  -0.96863958]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [2.22254481]
Stock Price:  102.72588764779209
PL:  [-0.50334284]
Settle:  Tensor("sub_296:0", shape=(), dtype=float64)
PL:  Tensor("sub_297:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  149
output_Z_Vals[:, i, :]:  [[ 1.19251512e+02 -2.92846752e+01 -2.92776944e+01]
 [-3.23366300e-02  1.49362468e-03 -5.93559831e-02]
 [-2.44264637e-01 -2.62801698e-02  1.73947756e-01]
 [-5.72233542e-02 -5.89930394e-02 -2.09181572e-01]
 [-9.30116871e-02 -1.93294225e-01  1.65797562e-01]
 [-7.03123510e-02  3.51711809e-02 -1.65157391e-02]
 [-1.96112445e-01 -1.77542502e-01  1.44923097e-01]
 [ 4.04898262e-03 -2.39111013e-02 -9.54236383e-02]
 [-3.08764205e-01 -1.97342703e-01  4.35161920e-01]
 [ 5.68685531e-02  4.62166387e-02 -1.45894945e-03]
 [ 6.18444151e-02  6.52929014e-02 -7.44189400e-03]
 [ 4.29896405e-03 -9.83921445e-03 -1.19013071e-01]
 [ 2.05056668e-02 -1.18089367e-01 -4.34309026e-01]
 [-7.98549900e-02  3.11896919e-02 -2.53275299e-02]
 [-3.25170338e-02 -4.01401054e-02  3.45037816e-02]
 [-4.06535815e-03 -3.05946138e-02  1.02299827e-01]
 [-2.54252542e-02  7.88446479e-02  1.05048787e-01]
 [-2.51051334e-02  6.79699915e-02 -9.09855263e-02]
 [-3.45796386e-01 -9.48741550e-01 -1.92325811e-01]
 [ 7.79572421e-02 -4.77404525e-02 -9.90071495e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.25151208 -29.28467519 -29.2776944 ]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  8.31409947  -9.26062741 -83.52111278]
init_Out:  [2.49223638]
Stock Position:  8.314099471154409
Bond position:  [-828.91771073]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [3.88824502]
curr_Stock_Price:  100.19283675529445
curr_Factors:  [100.19283676  -0.9113832   -1.00407676]
mat_Sqrt:  [[14.75580761  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00300994  0.00047233 -0.1693261 ]
Stock Position:  -0.003009937192479852
Bond Position:  [4.18981916]


portfolio before change:  [3.88842522]
curr_Stock_Price:  100.48101067806148
curr_Factors:  [100.48101068  -0.82863307  -1.01324698]
mat_Sqrt:  [[15.92816161  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0131488  -0.00831052  0.49622453]
Stock Position:  -0.01314880250462413
Bond Position:  [5.20963018]


portfolio before change:  [3.89315511]
curr_Stock_Price:  100.22035393349313
curr_Factors:  [100.22035393  -0.33846562  -1.02620645]
mat_Sqrt:  [[25.60273632  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00396229 -0.01865524 -0.5967368 ]
Stock Position:  -0.003962293572516676
Bond Position:  [4.29025758]


portfolio before change:  [3.89670677]
curr_Stock_Price:  99.59471547475252
curr_Factors:  [99.59471547 -0.53108562 -1.01387604]
mat_Sqrt:  [[21.24554971  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00301989 -0.061125    0.4729743 ]
Stock Position:  -0.003019890649579169
Bond Position:  [4.19747192]


portfolio before change:  [3.8993002]
curr_Stock_Price:  99.08346202415602
curr_Factors:  [99.08346202 -0.36360332 -1.01864068]
mat_Sqrt:  [[24.87139969  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00292607  0.0111221  -0.04711481]
Stock Position:  -0.0029260715927537633
Bond Position:  [4.18922551]


portfolio before change:  [3.90833509]
curr_Stock_Price:  96.35370792097915
curr_Factors:  [96.35370792 -0.73413336 -1.00624065]
mat_Sqrt:  [[16.90571724  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01012168 -0.05614387  0.41342526]
Stock Position:  -0.010121680539491673
Bond Position:  [4.88359655]


portfolio before change:  [3.92106481]
curr_Stock_Price:  95.2166771509982
curr_Factors:  [95.21667715 -0.87932241 -1.02607181]
mat_Sqrt:  [[14.16481236  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00113285 -0.00756135 -0.27221708]
Stock Position:  -0.0011328542555241548
Bond Position:  [4.02893143]


portfolio before change:  [3.92297288]
curr_Stock_Price:  94.42159202734982
curr_Factors:  [94.42159203 -0.47690832 -1.05086595]
mat_Sqrt:  [[20.49119956  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01098191 -0.06240524  1.24139583]
Stock Position:  -0.01098191035167754
Bond Position:  [4.95990234]


portfolio before change:  [3.88393671]
curr_Stock_Price:  98.08910502002755
curr_Factors:  [98.08910502 -0.45210165 -1.09249802]
mat_Sqrt:  [[20.93194859  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00275961  0.01461498 -0.00416198]
Stock Position:  0.0027596119179277507
Bond Position:  [3.61324885]


portfolio before change:  [3.88520427]
curr_Stock_Price:  98.22105516521536
curr_Factors:  [98.22105517 -0.72143383 -1.10428146]
mat_Sqrt:  [[15.82364464  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00391889  0.02064743 -0.02122965]
Stock Position:  0.003918894901627664
Bond Position:  [3.50028628]


portfolio before change:  [3.88306153]
curr_Stock_Price:  97.45095902459903
curr_Factors:  [97.45095902 -0.70372808 -1.06448052]
mat_Sqrt:  [[16.62887541  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00121767 -0.00311143 -0.33951117]
Stock Position:  -0.001217672533781425
Bond Position:  [4.00172488]


portfolio before change:  [3.88252156]
curr_Stock_Price:  98.71609721408484
curr_Factors:  [98.71609721 -0.4718401  -1.0164086 ]
mat_Sqrt:  [[22.28690591  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00319454 -0.03734314 -1.23896276]
Stock Position:  -0.0031945370338140253
Bond Position:  [4.19787379]


portfolio before change:  [3.88273876]
curr_Stock_Price:  98.97666557505973
curr_Factors:  [98.97666558 -0.52765209 -0.97686785]
mat_Sqrt:  [[21.98508303  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00383076  0.00986305 -0.07225239]
Stock Position:  -0.00383076269716522
Bond Position:  [4.26189488]


portfolio before change:  [3.87918055]
curr_Stock_Price:  100.18368802087727
curr_Factors:  [100.18368802  -0.56406331  -0.96610664]
mat_Sqrt:  [[21.68965531  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00122226 -0.01269342  0.09842968]
Stock Position:  -0.0012222597176544925
Bond Position:  [4.00163104]


portfolio before change:  [3.87882998]
curr_Stock_Price:  101.28910512095901
curr_Factors:  [101.28910512  -0.95122149  -0.97814104]
mat_Sqrt:  [[14.71130625  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0010894  -0.00967487  0.29183293]
Stock Position:  0.0010894040835551146
Bond Position:  [3.76848521]


portfolio before change:  [3.879061]
curr_Stock_Price:  100.63625011447958
curr_Factors:  [100.63625011  -0.54467418  -0.97948914]
mat_Sqrt:  [[21.91889854  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-8.88046624e-05  2.49328669e-02  2.99674948e-01]
Stock Position:  -8.880466241328941e-05
Bond Position:  [3.88799796]


portfolio before change:  [3.87989793]
curr_Stock_Price:  102.15859090930499
curr_Factors:  [102.15859091  -0.6990138   -0.93784327]
mat_Sqrt:  [[19.87910837  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00210887  0.021494   -0.25955638]
Stock Position:  -0.002108872176735115
Bond Position:  [4.09533734]


portfolio before change:  [3.87942573]
curr_Stock_Price:  102.86804777106673
curr_Factors:  [102.86804777  -0.59756254  -0.96205667]
mat_Sqrt:  [[21.62452023  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0189392  -0.30001842 -0.54865201]
Stock Position:  -0.018939200730759078
Bond Position:  [5.82766434]


portfolio before change:  [3.88390921]
curr_Stock_Price:  102.70825364585029
curr_Factors:  [102.70825365  -0.71261475  -1.00740888]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [3.88390921]
Stock Price:  103.0222805939477
PL:  [0.86162861]
Settle:  Tensor("sub_298:0", shape=(), dtype=float64)
PL:  Tensor("sub_299:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  150
output_Z_Vals[:, i, :]:  [[ 1.19251512e+02 -2.92846752e+01 -2.92776944e+01]
 [-3.74457436e-01  1.25376693e-01  3.07394322e-01]
 [-6.96823232e-02  1.61310378e-02  6.04192231e-02]
 [-1.77053509e-02  3.30856626e-02  5.08814767e-02]
 [-9.03790678e-02 -1.71295212e-01  1.43483768e-01]
 [ 2.27569850e-02 -1.62402614e-01  2.25099158e-02]
 [-2.97775724e-03  5.40067116e-03  8.38378670e-03]
 [-5.02224397e-02  8.46880651e-02 -1.07203827e-01]
 [-2.34118679e-01 -1.15865696e-01  2.44364076e-01]
 [ 4.50470017e-02  4.74936917e-02 -1.18045691e-02]
 [-2.61108820e-02  1.15639751e-01  1.05957479e-03]
 [-1.76081613e-02 -8.81229740e-03 -1.04230883e-01]
 [ 3.66487050e-02 -8.00714835e-02 -2.69402956e-01]
 [-4.85956595e-02  1.95322235e-02 -2.06068739e-02]
 [ 1.21033210e-02 -5.84761235e-02 -1.05069280e-01]
 [ 1.78912784e-01  4.49373400e-02 -1.25183991e-01]
 [ 2.06838566e-02 -3.84160088e-02  1.08028687e-01]
 [ 4.16196696e-02 -2.49874608e-02  6.99696018e-02]
 [-3.36390902e-01 -8.44667143e-01 -1.73560705e-01]
 [ 1.45116470e-01 -1.75067052e-01 -2.71966828e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.25151208 -29.28467519 -29.2776944 ]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  8.31409947  -9.26062741 -83.52111278]
init_Out:  [2.49223638]
Stock Position:  8.314099471154409
Bond position:  [-828.91771073]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-11.79593778]
curr_Stock_Price:  98.30638075945974
curr_Factors:  [98.30638076 -1.04430141 -0.96844139]
mat_Sqrt:  [[13.13586318  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02348332  0.03964759  0.87691044]
Stock Position:  -0.02348331555007793
Bond Position:  [-9.48737802]


portfolio before change:  [-11.80929564]
curr_Stock_Price:  98.77419030695937
curr_Factors:  [98.77419031 -0.89284137 -0.94103158]
mat_Sqrt:  [[15.78347316  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00360711  0.00510108  0.17235923]
Stock Position:  -0.0036071147761534443
Bond Position:  [-11.4530058]


portfolio before change:  [-11.81441468]
curr_Stock_Price:  99.39946374653069
curr_Factors:  [99.39946375 -1.23803149 -0.94405752]
mat_Sqrt:  [[11.21281931  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00057657  0.01046261  0.14515069]
Stock Position:  -0.0005765672856162968
Bond Position:  [-11.7571042]


portfolio before change:  [-11.81710605]
curr_Stock_Price:  98.96884952984772
curr_Factors:  [98.96884953 -1.22207801 -0.9399521 ]
mat_Sqrt:  [[11.39044721  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00575161 -0.0541683   0.40931925]
Stock Position:  -0.005751608206417633
Bond Position:  [-11.247876]


portfolio before change:  [-11.82786517]
curr_Stock_Price:  100.35051485774669
curr_Factors:  [100.35051486  -1.00092105  -0.94773121]
mat_Sqrt:  [[14.29653134  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00161987 -0.05135622  0.06421452]
Stock Position:  0.0016198743791475648
Bond Position:  [-11.99042039]


portfolio before change:  [-11.83246582]
curr_Stock_Price:  99.36113261515285
curr_Factors:  [99.36113262 -0.90310058 -0.9598993 ]
mat_Sqrt:  [[15.42147675  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-7.30785533e-05  1.70784218e-03  2.39166099e-02]
Stock Position:  -7.307855332097615e-05
Bond Position:  [-11.82520465]


portfolio before change:  [-11.83532804]
curr_Stock_Price:  98.06865570078749
curr_Factors:  [98.0686557  -0.98236338 -0.95974702]
mat_Sqrt:  [[14.06314285  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00497177  0.02678072 -0.30582268]
Stock Position:  -0.0049717686591438815
Bond Position:  [-11.34775337]


portfolio before change:  [-11.83955103]
curr_Stock_Price:  98.34736783301715
curr_Factors:  [98.34736783 -0.98432573 -0.9515626 ]
mat_Sqrt:  [[14.19113456  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01319343 -0.03663995  0.69710269]
Stock Position:  -0.013193427899923619
Bond Position:  [-10.54201212]


portfolio before change:  [-11.85930607]
curr_Stock_Price:  99.64492372743472
curr_Factors:  [99.64492373 -1.13806694 -0.97219165]
mat_Sqrt:  [[12.07762448  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00363181  0.01501882 -0.03367515]
Stock Position:  0.0036318140272096227
Bond Position:  [-12.2211979]


portfolio before change:  [-11.86647801]
curr_Stock_Price:  98.5115338075397
curr_Factors:  [98.51153381 -1.28832331 -0.96738534]
mat_Sqrt:  [[10.32393495  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.002219    0.0365685   0.00302267]
Stock Position:  -0.0022189980681946555
Bond Position:  [-11.64788111]


portfolio before change:  [-11.86898019]
curr_Stock_Price:  98.32669580527799
curr_Factors:  [98.32669581 -1.19647495 -0.95660645]
mat_Sqrt:  [[11.41826384  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00342537 -0.00278669 -0.2973417 ]
Stock Position:  -0.00342536609162893
Bond Position:  [-11.53217526]


portfolio before change:  [-11.8728987]
curr_Stock_Price:  98.6288853487698
curr_Factors:  [98.62888535 -1.13467002 -0.95190628]
mat_Sqrt:  [[12.24096209  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00166738 -0.02532083 -0.76853165]
Stock Position:  -0.0016673836453760364
Bond Position:  [-11.70844651]


portfolio before change:  [-11.87520457]
curr_Stock_Price:  98.25608036072087
curr_Factors:  [98.25608036 -0.87132689 -0.94772095]
mat_Sqrt:  [[15.93518084  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0032819   0.00617663 -0.05878568]
Stock Position:  -0.0032819018907577617
Bond Position:  [-11.55273776]


portfolio before change:  [-11.87415616]
curr_Stock_Price:  97.05648361735619
curr_Factors:  [97.05648362 -0.49650181 -0.92253246]
mat_Sqrt:  [[23.48257948  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0004622  -0.01849177 -0.29973341]
Stock Position:  -0.0004622023292354182
Bond Position:  [-11.82929643]


portfolio before change:  [-11.87607523]
curr_Stock_Price:  94.80937194019249
curr_Factors:  [94.80937194 -0.36666137 -0.93069138]
mat_Sqrt:  [[25.90705982  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0059644   0.01421043 -0.35711508]
Stock Position:  0.005964396841712288
Bond Position:  [-12.44155595]


portfolio before change:  [-11.89241175]
curr_Stock_Price:  92.59192459479452
curr_Factors:  [92.59192459 -0.3413971  -0.95099411]
mat_Sqrt:  [[25.42697759  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00164169 -0.01214821  0.30817577]
Stock Position:  0.0016416903141469672
Bond Position:  [-12.04441901]


portfolio before change:  [-11.89215074]
curr_Stock_Price:  94.58528768642294
curr_Factors:  [94.58528769 -0.58443466 -0.90486226]
mat_Sqrt:  [[21.33193027  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00259034 -0.00790173  0.1996038 ]
Stock Position:  0.002590341359725524
Bond Position:  [-12.13715893]


portfolio before change:  [-11.89410411]
curr_Stock_Price:  95.00272482938362
curr_Factors:  [95.00272483 -0.5167658  -0.88224239]
mat_Sqrt:  [[23.45063066  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01678539 -0.2671072  -0.49512038]
Stock Position:  -0.016785392671776957
Bond Position:  [-10.29944607]


portfolio before change:  [-11.9265022]
curr_Stock_Price:  96.77944264771159
curr_Factors:  [96.77944265 -0.19214052 -0.87643835]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-11.9265022]
Stock Price:  97.26045278843341
PL:  [-11.9265022]
Settle:  Tensor("sub_300:0", shape=(), dtype=float64)
PL:  Tensor("sub_301:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  151
output_Z_Vals[:, i, :]:  [[ 1.19251512e+02 -2.92846752e+01 -2.92776944e+01]
 [ 6.85998121e-02 -4.05421649e-02 -2.40735073e-02]
 [-6.96171141e-02  1.61685737e-02  6.05484108e-02]
 [-3.88316159e-02  1.85081502e-02  6.79987548e-03]
 [-9.28193324e-02 -1.91686847e-01  1.64167184e-01]
 [-5.43072755e-02 -1.04104649e-01  8.64656812e-03]
 [-6.85608351e-02 -3.96039690e-02  4.65680381e-02]
 [ 3.43963188e-05 -2.93507709e-03 -8.19495924e-02]
 [-3.35183096e-01 -2.05761704e-01  4.53552740e-01]
 [-2.19013530e-03 -1.45097940e-01  5.61620913e-02]
 [-9.77957861e-02  1.36684128e-01  2.80368023e-02]
 [-8.32767120e-02 -9.22536522e-03 -1.22739458e-01]
 [-8.26382229e-04 -2.37213575e-01 -2.81238691e-01]
 [ 3.29617959e-02 -1.23082223e-02  4.63300069e-03]
 [ 2.25874323e-02 -6.45589953e-02 -5.73980063e-02]
 [ 1.55797937e-01  1.34216681e-02 -3.08188412e-02]
 [ 2.25587515e-02 -3.66127768e-02  1.12820650e-01]
 [ 4.26668169e-02 -2.45372484e-02  5.96090543e-02]
 [-3.22044082e-01 -8.13735648e-01 -1.61869341e-01]
 [ 1.32405409e-01 -1.51536463e-01 -2.39788720e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.25151208 -29.28467519 -29.2776944 ]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  8.31409947  -9.26062741 -83.52111278]
init_Out:  [2.49223638]
Stock Position:  8.314099471154409
Bond position:  [-828.91771073]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [9.73837562]
curr_Stock_Price:  100.8964764725246
curr_Factors:  [100.89647647  -0.77215262  -1.01253821]
mat_Sqrt:  [[16.93536725  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00369871 -0.01282056 -0.06867502]
Stock Position:  0.0036987112731229304
Bond Position:  [9.36518868]


portfolio before change:  [9.73286403]
curr_Stock_Price:  98.77325743030418
curr_Factors:  [98.77325743 -0.70017022 -0.97244806]
mat_Sqrt:  [[18.54515592  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00306496  0.00511295  0.17272776]
Stock Position:  -0.003064964834438136
Bond Position:  [10.03560059]


portfolio before change:  [9.73400295]
curr_Stock_Price:  99.22034072858041
curr_Factors:  [99.22034073 -0.62486197 -0.95013976]
mat_Sqrt:  [[20.53932447  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00179975  0.00585279  0.01939815]
Stock Position:  -0.0017997533868560768
Bond Position:  [9.9125751]


portfolio before change:  [9.73615696]
curr_Stock_Price:  99.40061543949943
curr_Factors:  [99.40061544 -0.61230319 -0.93302213]
mat_Sqrt:  [[21.19643471  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00303156 -0.0606167   0.46832328]
Stock Position:  -0.003031556023534311
Bond Position:  [10.03749549]


portfolio before change:  [9.73475103]
curr_Stock_Price:  100.69223507284805
curr_Factors:  [100.69223507  -0.66998777  -0.93767009]
mat_Sqrt:  [[20.17432637  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00273765 -0.03292078  0.02466625]
Stock Position:  -0.002737651387675899
Bond Position:  [10.01041126]


portfolio before change:  [9.74239555]
curr_Stock_Price:  98.81412745583121
curr_Factors:  [98.81412746 -0.24758749 -0.94071665]
mat_Sqrt:  [[30.11238192  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00199512 -0.01252387  0.13284565]
Stock Position:  -0.0019951176363459827
Bond Position:  [9.93954135]


portfolio before change:  [9.75211029]
curr_Stock_Price:  95.19050612319612
curr_Factors:  [95.19050612 -0.168419   -0.91826139]
mat_Sqrt:  [[32.1110376   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00052223 -0.00092815 -0.23377938]
Stock Position:  -0.0005222278319343337
Bond Position:  [9.80182142]


portfolio before change:  [9.7550154]
curr_Stock_Price:  94.32048480447858
curr_Factors:  [94.3204848  -0.32928132 -0.92117138]
mat_Sqrt:  [[27.01104069  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00917828 -0.06506756  1.29385972]
Stock Position:  -0.009178275563345712
Bond Position:  [10.6207148]


portfolio before change:  [9.77439152]
curr_Stock_Price:  92.4987261206705
curr_Factors:  [92.49872612 -0.09643021 -0.90732452]
mat_Sqrt:  [[33.9008519   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00016305 -0.045884    0.16021481]
Stock Position:  0.00016304873031887759
Bond Position:  [9.75930972]


portfolio before change:  [9.77715546]
curr_Stock_Price:  94.48472742561145
curr_Factors:  [94.48472743 -0.61647511 -0.91680342]
mat_Sqrt:  [[20.39234685  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.004342    0.04322332  0.07998119]
Stock Position:  -0.004342002882403047
Bond Position:  [10.18740842]


portfolio before change:  [9.7751204]
curr_Stock_Price:  95.5400554948769
curr_Factors:  [95.54005549 -0.77900639 -0.91828664]
mat_Sqrt:  [[17.50090427  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00620362 -0.00291732 -0.35014151]
Stock Position:  -0.006203622116616639
Bond Position:  [10.3678148]


portfolio before change:  [9.77216421]
curr_Stock_Price:  96.4344471164235
curr_Factors:  [96.43444712 -0.84747968 -0.89698554]
mat_Sqrt:  [[16.85080189  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00381933 -0.07501352 -0.8022957 ]
Stock Position:  -0.0038193326532819163
Bond Position:  [10.14047944]


portfolio before change:  [9.77635781]
curr_Stock_Price:  96.00029594993589
curr_Factors:  [96.00029595 -0.48384516 -0.9069256 ]
mat_Sqrt:  [[23.89288023  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00140585 -0.0038922   0.01321666]
Stock Position:  0.001405845839067016
Bond Position:  [9.6413962]


portfolio before change:  [9.78198351]
curr_Stock_Price:  98.28720871184588
curr_Factors:  [98.28720871 -0.48276675 -0.92093913]
mat_Sqrt:  [[24.14767287  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00038116 -0.02041535 -0.16374054]
Stock Position:  0.0003811633236735168
Bond Position:  [9.74452003]


portfolio before change:  [9.78424606]
curr_Stock_Price:  97.8310224264425
curr_Factors:  [97.83102243 -0.17810003 -0.90559067]
mat_Sqrt:  [[33.10058733  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00452722  0.0042443  -0.08791758]
Stock Position:  0.004527219180179476
Bond Position:  [9.34134358]


portfolio before change:  [9.77169166]
curr_Stock_Price:  94.54202118727753
curr_Factors:  [94.54202119 -0.39514283 -0.91696351]
mat_Sqrt:  [[25.4556586   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00175375 -0.01157798  0.32184591]
Stock Position:  0.001753748864677769
Bond Position:  [9.6058887]


portfolio before change:  [9.77496918]
curr_Stock_Price:  95.04137902894992
curr_Factors:  [95.04137903 -0.46286449 -0.88604663]
mat_Sqrt:  [[24.66539473  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00219745 -0.00775936  0.17004804]
Stock Position:  0.0021974477085013886
Bond Position:  [9.56612072]


portfolio before change:  [9.77885615]
curr_Stock_Price:  95.72177811825667
curr_Factors:  [95.72177812 -0.56319286 -0.83327276]
mat_Sqrt:  [[23.68827537  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01587689 -0.25732581 -0.46176818]
Stock Position:  -0.01587688765509351
Bond Position:  [11.29862007]


portfolio before change:  [9.77241184]
curr_Stock_Price:  96.30560309666629
curr_Factors:  [96.3056031  -1.05587603 -0.81342244]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [9.77241184]
Stock Price:  94.78723435803695
PL:  [9.77241184]
Settle:  Tensor("sub_302:0", shape=(), dtype=float64)
PL:  Tensor("sub_303:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  152
output_Z_Vals[:, i, :]:  [[ 1.19251512e+02 -2.92846752e+01 -2.92776944e+01]
 [-2.61919242e-01  7.31499657e-02  1.17317588e-01]
 [-1.13433288e-01  7.62397357e-03  1.05648439e-01]
 [-2.11480854e-02  3.56226207e-02  5.58850288e-02]
 [-9.88296441e-02 -2.41910939e-01  2.15109929e-01]
 [ 1.78206690e-02 -1.71218440e-01  2.67328618e-02]
 [ 1.35245224e-02  1.27582967e-02  1.93470253e-03]
 [-7.34593381e-02  1.28145905e-01 -1.08777739e-01]
 [-2.34273400e-01 -1.07774509e-01  2.24880890e-01]
 [ 5.27826094e-02  4.24400217e-02 -2.46619315e-04]
 [ 3.46683874e-02  7.86241619e-02 -1.14948132e-05]
 [ 3.52574266e-02 -1.02241373e-02 -1.31209815e-01]
 [ 6.13302389e-03 -1.90677712e-01 -3.62762477e-01]
 [ 5.77051644e-02 -2.57947523e-02  1.08645697e-02]
 [ 1.11348156e-02 -5.79141975e-02 -1.09473076e-01]
 [ 1.73648825e-01  3.73234476e-02 -1.00975326e-01]
 [ 6.00797271e-03 -5.14983955e-02  6.47445877e-02]
 [ 3.69143092e-02 -2.70104917e-02  1.16524760e-01]
 [-4.58169326e-01 -1.15712288e+00 -3.72549339e-01]
 [ 1.51830758e-01 -3.07392847e-01 -5.65847772e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.25151208 -29.28467519 -29.2776944 ]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  8.31409947  -9.26062741 -83.52111278]
init_Out:  [2.49223638]
Stock Position:  8.314099471154409
Bond position:  [-828.91771073]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-3.24066996]
curr_Stock_Price:  99.33538791163514
curr_Factors:  [99.33538791 -1.43383748 -0.97063358]
mat_Sqrt:  [[ 8.97130213  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02631537  0.02313205  0.33467442]
Stock Position:  -0.026315373430549825
Bond Position:  [-0.62662213]


portfolio before change:  [-3.2311098]
curr_Stock_Price:  98.96614213640184
curr_Factors:  [98.96614214 -1.50473415 -0.9698075 ]
mat_Sqrt:  [[ 8.33310503  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01100083  0.00241091  0.30138559]
Stock Position:  -0.011000826204781593
Bond Position:  [-2.14240047]


portfolio before change:  [-3.22896744]
curr_Stock_Price:  98.72270424299698
curr_Factors:  [98.72270424 -1.18196542 -0.9863037 ]
mat_Sqrt:  [[11.29145031  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0007812   0.01126486  0.15942443]
Stock Position:  -0.0007811954438948789
Bond Position:  [-3.15184572]


portfolio before change:  [-3.23034094]
curr_Stock_Price:  99.4721076566732
curr_Factors:  [99.47210766 -1.43791342 -0.99882952]
mat_Sqrt:  [[ 8.69835857  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00703197 -0.07649896  0.61364875]
Stock Position:  -0.007031973536132894
Bond Position:  [-2.53085571]


portfolio before change:  [-3.23507275]
curr_Stock_Price:  100.05501974306117
curr_Factors:  [100.05501974  -1.47153374  -0.92270257]
mat_Sqrt:  [[ 9.12925348  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00206552 -0.05414402  0.07626141]
Stock Position:  0.0020655194350730727
Bond Position:  [-3.44173834]


portfolio before change:  [-3.23695257]
curr_Stock_Price:  99.56154625621537
curr_Factors:  [99.56154626 -1.27480373 -0.95180175]
mat_Sqrt:  [[10.74209923  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00132645 0.00403453 0.00551917]
Stock Position:  0.001326450204589162
Bond Position:  [-3.36901601]


portfolio before change:  [-3.23785167]
curr_Stock_Price:  99.5187715976631
curr_Factors:  [99.5187716  -1.31500437 -1.00264849]
mat_Sqrt:  [[ 9.80304864  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00942103  0.04052329 -0.31031261]
Stock Position:  -0.009421027216692081
Bond Position:  [-2.30028261]


portfolio before change:  [-3.23327058]
curr_Stock_Price:  98.97146023832013
curr_Factors:  [98.97146024 -0.91134211 -1.00013006]
mat_Sqrt:  [[14.63417219  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01306206 -0.03408129  0.64152259]
Stock Position:  -0.013062064847369782
Bond Position:  [-1.94049895]


portfolio before change:  [-3.22337132]
curr_Stock_Price:  98.17645258834894
curr_Factors:  [98.17645259 -0.97865823 -0.99395874]
mat_Sqrt:  [[13.65559635  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00394183  0.01342071 -0.00070354]
Stock Position:  0.003941831880551301
Bond Position:  [-3.61036639]


portfolio before change:  [-3.22664431]
curr_Stock_Price:  97.57513608709857
curr_Factors:  [97.57513609 -0.52182372 -0.95937291]
mat_Sqrt:  [[22.18521512  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 1.65407944e-03  2.48631431e-02 -3.27915027e-05]
Stock Position:  0.0016540794399552553
Bond Position:  [-3.38804134]


portfolio before change:  [-3.22864939]
curr_Stock_Price:  96.87507204815174
curr_Factors:  [96.87507205 -0.28992749 -0.94354799]
mat_Sqrt:  [[28.21762426  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 2.90965287e-04 -3.23315610e-03 -3.74305081e-01]
Stock Position:  0.00029096528695794045
Bond Position:  [-3.25683667]


portfolio before change:  [-3.2293083]
curr_Stock_Price:  97.40916327772824
curr_Factors:  [97.40916328 -0.61143785 -0.93403515]
mat_Sqrt:  [[20.76870483  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00350714 -0.06029759 -1.03486037]
Stock Position:  -0.0035071437800328568
Bond Position:  [-2.88768036]


portfolio before change:  [-3.22307292]
curr_Stock_Price:  95.42538691760078
curr_Factors:  [95.42538692 -0.48196569 -0.94015038]
mat_Sqrt:  [[23.01689682  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00257449 -0.00815702  0.03099359]
Stock Position:  0.0025744942155802157
Bond Position:  [-3.46874503]


portfolio before change:  [-3.22124996]
curr_Stock_Price:  96.47035243741323
curr_Factors:  [96.47035244 -0.40624364 -0.94452836]
mat_Sqrt:  [[24.98969972  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00050847 -0.01831408 -0.31229621]
Stock Position:  -0.0005084743235703119
Bond Position:  [-3.17219726]


portfolio before change:  [-3.22178194]
curr_Stock_Price:  95.95672745780632
curr_Factors:  [95.95672746 -0.2568942  -0.93409258]
mat_Sqrt:  [[29.16328521  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00528065  0.01180271 -0.2880545 ]
Stock Position:  0.0052806468509784535
Bond Position:  [-3.72849553]


portfolio before change:  [-3.24718851]
curr_Stock_Price:  91.32200680650965
curr_Factors:  [91.32200681 -0.12476825 -0.9500613 ]
mat_Sqrt:  [[31.17330914  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00057402 -0.01628522  0.18469829]
Stock Position:  0.0005740238677880347
Bond Position:  [-3.29960952]


portfolio before change:  [-3.250809]
curr_Stock_Price:  86.45202413322467
curr_Factors:  [ 8.64520241e+01  5.77896311e-02 -9.34584070e-01]
mat_Sqrt:  [[35.97395437  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00166794 -0.00854147  0.33241271]
Stock Position:  0.0016679405817324724
Bond Position:  [-3.39500584]


portfolio before change:  [-3.2531296]
curr_Stock_Price:  85.56965127770717
curr_Factors:  [ 8.55696513e+01  4.55194601e-02 -9.09799595e-01]
mat_Sqrt:  [[36.05518004  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01564525 -0.36591438 -1.06277957]
Stock Position:  -0.015645253331478474
Bond Position:  [-1.91437073]


portfolio before change:  [-3.28541369]
curr_Stock_Price:  87.6025641898259
curr_Factors:  [87.60256419 -0.47203918 -0.93590205]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-3.28541369]
Stock Price:  85.94942226341743
PL:  [-3.28541369]
Settle:  Tensor("sub_304:0", shape=(), dtype=float64)
PL:  Tensor("sub_305:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  153
output_Z_Vals[:, i, :]:  [[ 1.19251512e+02 -2.92846752e+01 -2.92776944e+01]
 [-8.45034073e-02 -1.29145978e-01 -4.56396046e-01]
 [-6.42503362e-01 -1.17621677e-01  4.75647331e-01]
 [-4.82498399e-02 -1.46873342e-01 -4.63381662e-01]
 [-9.88296441e-02 -2.41910939e-01  2.15109929e-01]
 [ 2.40270833e-02 -1.53557914e-01  2.03459248e-02]
 [ 5.54665676e-02  3.59180490e-02 -1.89471867e-02]
 [-1.22042021e-01  1.86034435e-01 -6.57094345e-02]
 [-1.39595539e-01 -6.69948805e-02  1.33443455e-01]
 [ 5.02102164e-02  3.82496836e-02 -8.12683770e-03]
 [ 1.02457293e-01  2.87620883e-02 -2.32973771e-02]
 [ 8.36532355e-02 -1.01520958e-02 -1.25405657e-01]
 [ 3.28250822e-02 -1.66854582e-02 -3.12844722e-01]
 [-8.09257419e-02  3.08579305e-02 -2.77501478e-02]
 [-5.11508399e-02 -2.83588245e-02  6.04681589e-02]
 [ 8.33804255e-02 -1.05918842e-02  5.48700234e-02]
 [-2.21284006e-02  3.26092274e-02  1.50310129e-01]
 [-3.68030934e-02  8.23957273e-02 -9.60418130e-02]
 [-3.90814930e-01 -1.02994780e+00 -2.57954671e-01]
 [ 1.20622153e-01 -1.37220648e-01 -2.17315932e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.25151208 -29.28467519 -29.2776944 ]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  8.31409947  -9.26062741 -83.52111278]
init_Out:  [2.49223638]
Stock Position:  8.314099471154409
Bond position:  [-828.91771073]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [19.63220499]
curr_Stock_Price:  102.08648260718817
curr_Factors:  [102.08648261  -1.27633048  -1.03234754]
mat_Sqrt:  [[10.1466369   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01783836 -0.04083954 -1.30197088]
Stock Position:  -0.01783836326157812
Bond Position:  [21.45326075]


portfolio before change:  [19.62108219]
curr_Stock_Price:  103.01071453346495
curr_Factors:  [103.01071453  -1.18258179  -1.00424661]
mat_Sqrt:  [[11.56524642  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.04742218 -0.03719524  1.35688944]
Stock Position:  -0.04742218331014996
Bond Position:  [24.50607518]


portfolio before change:  [19.67635854]
curr_Stock_Price:  101.97429949417908
curr_Factors:  [101.97429949  -1.0153712   -1.00218813]
mat_Sqrt:  [[13.56050452  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01081298 -0.04644543 -1.3218989 ]
Stock Position:  -0.010812981090507516
Bond Position:  [20.77900471]


portfolio before change:  [19.68707669]
curr_Stock_Price:  101.46354803998543
curr_Factors:  [101.46354804  -0.98434835  -1.03327537]
mat_Sqrt:  [[13.4917162   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00453364 -0.07649896  0.61364875]
Stock Position:  -0.004533643188053176
Bond Position:  [20.14707621]


portfolio before change:  [19.69701836]
curr_Stock_Price:  100.38179620559733
curr_Factors:  [100.38179621  -0.95128924  -1.00392454]
mat_Sqrt:  [[14.20745885  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00170441 -0.04855928  0.05804126]
Stock Position:  0.0017044096236856552
Bond Position:  [19.52592666]


portfolio before change:  [19.70318555]
curr_Stock_Price:  101.13577821183729
curr_Factors:  [101.13577821  -0.60743881  -0.99929614]
mat_Sqrt:  [[20.28190276  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00258982  0.01135828 -0.05405105]
Stock Position:  0.002589815659890209
Bond Position:  [19.44126253]


portfolio before change:  [19.70887412]
curr_Stock_Price:  101.45535484396211
curr_Factors:  [101.45535484  -0.57358252  -0.99659849]
mat_Sqrt:  [[21.10347733  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00619099  0.05882925 -0.18745073]
Stock Position:  -0.006190994622240372
Bond Position:  [20.33698367]


portfolio before change:  [19.71892806]
curr_Stock_Price:  100.65272727808798
curr_Factors:  [100.65272728  -0.92891148  -0.98501844]
mat_Sqrt:  [[14.84623545  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00768453 -0.02118564  0.38067703]
Stock Position:  -0.007684527752176878
Bond Position:  [20.49239674]


portfolio before change:  [19.71133232]
curr_Stock_Price:  102.30793360609987
curr_Factors:  [102.30793361  -0.52576927  -1.00817875]
mat_Sqrt:  [[22.06602735  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00224503  0.01209561 -0.02318361]
Stock Position:  0.0022450318931179266
Bond Position:  [19.48164775]


portfolio before change:  [19.7166339]
curr_Stock_Price:  102.49971596245159
curr_Factors:  [102.49971596  -0.43912863  -1.01966915]
mat_Sqrt:  [[23.83278722  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00413063  0.00909537 -0.06646093]
Stock Position:  0.004130627648418402
Bond Position:  [19.29324574]


portfolio before change:  [19.72596633]
curr_Stock_Price:  103.59119923567816
curr_Factors:  [103.59119924  -0.59910649  -1.02855756]
mat_Sqrt:  [[20.34404669  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00284077 -0.00321037 -0.35774743]
Stock Position:  0.002840771447658684
Bond Position:  [19.43168741]


portfolio before change:  [19.7305827]
curr_Stock_Price:  103.50595729711102
curr_Factors:  [103.5059573   -0.36501882  -1.0105296 ]
mat_Sqrt:  [[26.15605602  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00120297 -0.00527641 -0.89245891]
Stock Position:  -0.0012029679100339697
Bond Position:  [19.85509705]


portfolio before change:  [19.7408097]
curr_Stock_Price:  99.13127163053308
curr_Factors:  [99.13127163 -0.10000885 -0.97270192]
mat_Sqrt:  [[33.91082161  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00252997  0.00975813 -0.07916345]
Stock Position:  -0.002529973165887432
Bond Position:  [19.99160916]


portfolio before change:  [19.74202061]
curr_Stock_Price:  100.6283723162157
curr_Factors:  [100.62837232  -0.19322892  -0.97263253]
mat_Sqrt:  [[31.361242    0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00126079 -0.00896785  0.17249883]
Stock Position:  -0.0012607935086296012
Bond Position:  [19.86889221]


portfolio before change:  [19.74864392]
curr_Stock_Price:  99.3153360229965
curr_Factors:  [99.31533602 -0.39029794 -1.00420587]
mat_Sqrt:  [[24.62583738  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00382961 -0.00334945  0.1565289 ]
Stock Position:  0.0038296054435456002
Bond Position:  [19.36830537]


portfolio before change:  [19.76456237]
curr_Stock_Price:  102.20747948413232
curr_Factors:  [102.20747948  -0.41159832  -1.01589865]
mat_Sqrt:  [[24.52046039  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [3.83169508e-04 1.03119431e-02 4.28792961e-01]
Stock Position:  0.00038316950805096934
Bond Position:  [19.72539958]


portfolio before change:  [19.76942591]
curr_Stock_Price:  102.02891314560694
curr_Factors:  [102.02891315  -0.3061599   -1.01884303]
mat_Sqrt:  [[27.11950775  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00200151  0.02605582 -0.27398056]
Stock Position:  -0.0020015148649494842
Bond Position:  [19.9736383]


portfolio before change:  [19.77736966]
curr_Stock_Price:  100.55517264924674
curr_Factors:  [100.55517265  -0.14518848  -1.03560066]
mat_Sqrt:  [[30.87409303  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01522515 -0.32569809 -0.73587288]
Stock Position:  -0.015225154753026491
Bond Position:  [21.30833773]


portfolio before change:  [19.81229759]
curr_Stock_Price:  98.611010181788
curr_Factors:  [98.61101018  0.28983279 -1.02848874]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [19.81229759]
Stock Price:  98.00734351142678
PL:  [19.81229759]
Settle:  Tensor("sub_306:0", shape=(), dtype=float64)
PL:  Tensor("sub_307:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  154
output_Z_Vals[:, i, :]:  [[ 1.19251512e+02 -2.92846752e+01 -2.92776944e+01]
 [ 3.18754488e-02 -6.38788850e-02 -1.67544405e-01]
 [-4.58219529e-01 -7.77429755e-02  3.17138587e-01]
 [-6.02609692e-02 -9.97873979e-02 -3.23413254e-01]
 [-9.88296441e-02 -2.41910939e-01  2.15109929e-01]
 [-1.03560046e-01 -1.18062393e-01  3.57267252e-02]
 [ 5.56221627e-02  3.33293300e-02 -1.79319768e-02]
 [-1.21271155e-01  2.02561642e-01 -9.89042230e-02]
 [-5.63470560e-02 -3.33404137e-02  5.81042584e-02]
 [ 4.69499513e-02  4.74350615e-02 -1.14481267e-02]
 [ 7.76011463e-02  5.05367058e-02 -1.57058588e-02]
 [ 9.48932275e-02 -1.04817205e-02 -1.30259873e-01]
 [ 5.02444313e-02 -7.31715351e-03 -1.62942615e-01]
 [-8.45720117e-02  2.97281712e-02 -3.59999752e-02]
 [-5.12125449e-03 -5.63681941e-02  2.01983671e-03]
 [ 2.09263753e-02 -6.20736137e-03  9.02659600e-02]
 [-2.48932935e-02  1.05071030e-01  7.08231940e-02]
 [ 3.37182230e-02 -8.02926642e-03 -9.58402134e-03]
 [-3.41936455e-01 -8.94195125e-01 -1.56123592e-01]
 [ 8.07343385e-02 -5.41224904e-02 -1.07255203e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.25151208 -29.28467519 -29.2776944 ]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  8.31409947  -9.26062741 -83.52111278]
init_Out:  [2.49223638]
Stock Position:  8.314099471154409
Bond position:  [-828.91771073]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [8.40761326]
curr_Stock_Price:  100.73641555858673
curr_Factors:  [100.73641556  -1.21997247  -1.01352003]
mat_Sqrt:  [[10.79426375  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-3.68135848e-04 -2.02002771e-02 -4.77957553e-01]
Stock Position:  -0.0003681358476352901
Bond Position:  [8.44469794]


portfolio before change:  [8.4095619]
curr_Stock_Price:  101.17863672200293
curr_Factors:  [101.17863672  -1.52455411  -1.02711987]
mat_Sqrt:  [[ 7.88698275  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0501448  -0.02458449  0.90470812]
Stock Position:  -0.05014480361419633
Bond Position:  [13.48314477]


portfolio before change:  [8.40936025]
curr_Stock_Price:  101.24988740463826
curr_Factors:  [101.2498874   -1.30576881  -1.05471639]
mat_Sqrt:  [[ 9.55539962  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01348493 -0.03155555 -0.92260799]
Stock Position:  -0.013484932911540076
Bond Position:  [9.77470819]


portfolio before change:  [8.40763635]
curr_Stock_Price:  101.55896449853101
curr_Factors:  [101.5589645   -1.50410633  -1.01961158]
mat_Sqrt:  [[ 8.14107023  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00751334 -0.07649896  0.61364875]
Stock Position:  -0.007513339834297815
Bond Position:  [9.17068337]


portfolio before change:  [8.40836769]
curr_Stock_Price:  101.76681078144112
curr_Factors:  [101.76681078  -1.51464888  -1.031847  ]
mat_Sqrt:  [[ 7.97401516  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01245492 -0.03733461  0.1019184 ]
Stock Position:  -0.012454919475000407
Bond Position:  [9.67586512]


portfolio before change:  [8.41205002]
curr_Stock_Price:  101.66539984415013
curr_Factors:  [101.66539984  -1.80813217  -1.03816407]
mat_Sqrt:  [[ 5.90258734  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00894902  0.01053966 -0.05115494]
Stock Position:  0.008949020115039587
Bond Position:  [7.50224432]


portfolio before change:  [8.4184625]
curr_Stock_Price:  102.17234716274798
curr_Factors:  [102.17234716  -1.61049316  -1.04735387]
mat_Sqrt:  [[ 7.16217738  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01902072  0.06405562 -0.28214622]
Stock Position:  -0.01902072081298271
Bond Position:  [10.36185419]


portfolio before change:  [8.44153324]
curr_Stock_Price:  101.09562927398771
curr_Factors:  [101.09562927  -1.43393645  -1.04826732]
mat_Sqrt:  [[ 8.44743741  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00536819 -0.01054316  0.16575528]
Stock Position:  -0.005368186527592058
Bond Position:  [8.98423343]


portfolio before change:  [8.43910915]
curr_Stock_Price:  101.96564968433749
curr_Factors:  [101.96564968  -1.31211249  -1.07119002]
mat_Sqrt:  [[ 9.40586548  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00487333  0.01500028 -0.03265832]
Stock Position:  0.004873329348229979
Bond Position:  [7.94219695]


portfolio before change:  [8.4410935]
curr_Stock_Price:  101.96535405666883
curr_Factors:  [101.96535406  -1.56314139  -1.10833122]
mat_Sqrt:  [[ 7.05093675  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01073617  0.01598111 -0.04480444]
Stock Position:  0.010736169686239841
Bond Position:  [7.34637616]


portfolio before change:  [8.44741799]
curr_Stock_Price:  102.38334925006191
curr_Factors:  [102.38334925  -1.63788139  -1.10409312]
mat_Sqrt:  [[ 6.59788789  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01031139 -0.00331461 -0.37159516]
Stock Position:  0.01031139155730703
Bond Position:  [7.39170319]


portfolio before change:  [8.44833785]
curr_Stock_Price:  102.2933220510245
curr_Factors:  [102.29332205  -1.36407161  -1.07091932]
mat_Sqrt:  [[ 8.96074584  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00187428 -0.00231389 -0.46482993]
Stock Position:  0.0018742838513694927
Bond Position:  [8.25661112]


portfolio before change:  [8.44906438]
curr_Stock_Price:  101.57951703436234
curr_Factors:  [101.57951703  -1.49145688  -1.08040225]
mat_Sqrt:  [[ 7.76000346  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0117465   0.00940087 -0.10269791]
Stock Position:  -0.01174650220065554
Bond Position:  [9.6422684]


portfolio before change:  [8.47003158]
curr_Stock_Price:  99.99978511655235
curr_Factors:  [99.99978512 -1.40492955 -1.07705533]
mat_Sqrt:  [[ 8.35769911  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00073757 -0.01782519  0.00576203]
Stock Position:  -0.0007375687347308995
Bond Position:  [8.54378829]


portfolio before change:  [8.47202621]
curr_Stock_Price:  100.19173548283486
curr_Factors:  [100.19173548  -1.51178523  -1.12557944]
mat_Sqrt:  [[ 7.16867644  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00546706 -0.00196294  0.25750366]
Stock Position:  0.005467057156610331
Bond Position:  [7.92427227]


portfolio before change:  [8.47424273]
curr_Stock_Price:  100.23475756201012
curr_Factors:  [100.23475756  -1.415333    -1.13038139]
mat_Sqrt:  [[ 7.86011014  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00098264  0.03322638  0.20203886]
Stock Position:  -0.0009826385474966566
Bond Position:  [8.57273727]


portfolio before change:  [8.47702792]
curr_Stock_Price:  99.58168917444142
curr_Factors:  [99.58168917 -1.2207983  -1.12498187]
mat_Sqrt:  [[ 9.5371827   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00330858 -0.00253908 -0.02734055]
Stock Position:  0.003308584840574038
Bond Position:  [8.14755345]


portfolio before change:  [8.48028188]
curr_Stock_Price:  99.94946720050264
curr_Factors:  [99.9494672  -0.90947839 -1.16650088]
mat_Sqrt:  [[12.53701495  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0316577  -0.28276933 -0.44537715]
Stock Position:  -0.03165770085255504
Bond Position:  [11.64445222]


portfolio before change:  [8.48207263]
curr_Stock_Price:  99.98486872256419
curr_Factors:  [99.98486872 -0.71121239 -1.13736321]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [8.48207263]
Stock Price:  99.53487761304024
PL:  [8.48207263]
Settle:  Tensor("sub_308:0", shape=(), dtype=float64)
PL:  Tensor("sub_309:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  155
output_Z_Vals[:, i, :]:  [[ 1.19251512e+02 -2.92846752e+01 -2.92776944e+01]
 [-2.21573240e-01  6.72289595e-02  9.63918108e-02]
 [-1.44201212e-01 -1.79260817e-02  6.27001275e-02]
 [-4.17317795e-02  3.50181754e-02  4.72817922e-02]
 [-8.49348415e-02 -1.25801511e-01  9.73391010e-02]
 [-2.05402844e-02  1.35793377e-02 -8.28088866e-03]
 [-1.17132787e-01 -8.84796393e-02  8.20069689e-02]
 [-3.67284388e-02  5.71474187e-02 -1.06162160e-01]
 [-1.74404030e-01 -8.48869776e-02  1.74038266e-01]
 [ 5.62945941e-02  4.56861312e-02 -1.28865150e-03]
 [ 1.87027474e-02  9.32098764e-02 -1.10304378e-02]
 [ 7.18345703e-02 -9.80550087e-03 -1.20301530e-01]
 [ 4.22582110e-02 -4.74351254e-02 -3.16905598e-01]
 [-7.03524247e-02  2.80609331e-02 -2.23784379e-02]
 [ 1.11348156e-02 -5.79141975e-02 -1.09473076e-01]
 [ 1.73463470e-01  3.52515101e-02 -9.72363953e-02]
 [ 2.25003301e-02 -3.67967667e-02  1.13386076e-01]
 [ 4.17912711e-02 -2.49136821e-02  6.82717645e-02]
 [-2.50669177e-01 -6.67317713e-01 -1.03337730e-01]
 [ 1.27572265e-01 -1.42972015e-01 -2.27929035e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.25151208 -29.28467519 -29.2776944 ]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  8.31409947  -9.26062741 -83.52111278]
init_Out:  [2.49223638]
Stock Position:  8.314099471154409
Bond position:  [-828.91771073]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-7.91023611]
curr_Stock_Price:  98.77374366328398
curr_Factors:  [98.77374366 -0.7151173  -0.97059833]
mat_Sqrt:  [[18.3039372   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01093543  0.02125966  0.27497901]
Stock Position:  -0.010935434153535315
Bond Position:  [-6.83010234]


portfolio before change:  [-7.9038405]
curr_Stock_Price:  98.03272571534484
curr_Factors:  [98.03272572 -0.69017357 -0.93278174]
mat_Sqrt:  [[19.34329889  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00681711 -0.00566872  0.17886601]
Stock Position:  -0.006817112853999182
Bond Position:  [-7.23554034]


portfolio before change:  [-7.90087135]
curr_Stock_Price:  97.33180556708268
curr_Factors:  [97.33180557 -1.06145687 -0.93415566]
mat_Sqrt:  [[13.23034808  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00235642  0.01107372  0.13488179]
Stock Position:  -0.0023564201369674314
Bond Position:  [-7.67151673]


portfolio before change:  [-7.9039767]
curr_Stock_Price:  97.83563167931626
curr_Factors:  [97.83563168 -0.96802872 -0.94161588]
mat_Sqrt:  [[14.49268795  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00471367 -0.03978193  0.27768136]
Stock Position:  -0.004713670919565544
Bond Position:  [-7.44281173]


portfolio before change:  [-7.90889465]
curr_Stock_Price:  98.48417356989009
curr_Factors:  [98.48417357 -1.06305029 -0.92034456]
mat_Sqrt:  [[13.551551    0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00161458  0.00429416 -0.02362307]
Stock Position:  -0.0016145750964423073
Bond Position:  [-7.74988455]


portfolio before change:  [-7.90961773]
curr_Stock_Price:  97.73188284130869
curr_Factors:  [97.73188284 -0.92134296 -0.86724251]
mat_Sqrt:  [[16.34042945  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00628366 -0.02797972  0.23394306]
Stock Position:  -0.006283661007504527
Bond Position:  [-7.29550371]


portfolio before change:  [-7.90967708]
curr_Stock_Price:  97.45103524254449
curr_Factors:  [97.45103524 -0.99894738 -0.91670988]
mat_Sqrt:  [[14.34917982  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.003967    0.0180716  -0.30285109]
Stock Position:  -0.0039669973991114885
Bond Position:  [-7.52308908]


portfolio before change:  [-7.91807548]
curr_Stock_Price:  99.09393601753948
curr_Factors:  [99.09393602 -1.37334147 -0.92735337]
mat_Sqrt:  [[ 9.92814252  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01420914 -0.02684362  0.49648273]
Stock Position:  -0.014209142281208993
Bond Position:  [-6.51003564]


portfolio before change:  [-7.91357283]
curr_Stock_Price:  98.66249843920443
curr_Factors:  [98.66249844 -1.59073496 -0.9350622 ]
mat_Sqrt:  [[ 7.89245906  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00724884  0.01444722 -0.00367616]
Stock Position:  0.007248838360936232
Bond Position:  [-8.62876133]


portfolio before change:  [-7.907317]
curr_Stock_Price:  99.8231375564055
curr_Factors:  [99.82313756 -1.48684336 -0.93405509]
mat_Sqrt:  [[ 8.86846348  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00212639  0.02947555 -0.03146677]
Stock Position:  0.0021263928540831995
Bond Position:  [-8.11958021]


portfolio before change:  [-7.90918294]
curr_Stock_Price:  99.90036407105222
curr_Factors:  [99.90036407 -1.03442107 -0.91753454]
mat_Sqrt:  [[14.18546315  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00331501 -0.00310077 -0.34318678]
Stock Position:  0.0033150095814834806
Bond Position:  [-8.2403536]


portfolio before change:  [-7.9131516]
curr_Stock_Price:  99.32470540518645
curr_Factors:  [99.32470541 -0.99172287 -0.87359994]
mat_Sqrt:  [[15.38005488  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00153801 -0.0150003  -0.90404346]
Stock Position:  -0.001538007711168847
Bond Position:  [-7.76038944]


portfolio before change:  [-7.91406752]
curr_Stock_Price:  98.65863504865537
curr_Factors:  [98.65863505 -0.72054952 -0.86791457]
mat_Sqrt:  [[20.14994706  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00368219  0.00887365 -0.06383945]
Stock Position:  -0.0036821870435930094
Bond Position:  [-7.55078797]


portfolio before change:  [-7.90538415]
curr_Stock_Price:  95.78770465058396
curr_Factors:  [95.78770465 -0.92593236 -0.86288347]
mat_Sqrt:  [[16.0116807   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00079358 -0.01831408 -0.31229621]
Stock Position:  -0.0007935844402432329
Bond Position:  [-7.82936852]


portfolio before change:  [-7.90729351]
curr_Stock_Price:  95.72694059913488
curr_Factors:  [95.7269406  -0.88520812 -0.89984172]
mat_Sqrt:  [[16.0618987   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00962062  0.01114751 -0.27738837]
Stock Position:  0.00962061629603092
Bond Position:  [-8.82824568]


portfolio before change:  [-7.92049922]
curr_Stock_Price:  94.58373216608507
curr_Factors:  [94.58373217 -0.91697813 -0.8665213 ]
mat_Sqrt:  [[15.89470541  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00281195 -0.01163616  0.32345891]
Stock Position:  0.0028119475197219256
Bond Position:  [-8.18646371]


portfolio before change:  [-7.91823158]
curr_Stock_Price:  96.11808181496896
curr_Factors:  [96.11808181 -1.11756432 -0.86847643]
mat_Sqrt:  [[13.19102548  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00417586 -0.0078784   0.19476034]
Stock Position:  0.004175863223266219
Bond Position:  [-8.31960754]


portfolio before change:  [-7.91650126]
curr_Stock_Price:  97.03058363808879
curr_Factors:  [97.03058364 -1.19401794 -0.86837504]
mat_Sqrt:  [[12.33737467  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02342419 -0.21102439 -0.29479378]
Stock Position:  -0.023424187043209175
Bond Position:  [-5.64363872]


portfolio before change:  [-7.90440868]
curr_Stock_Price:  96.45409980196573
curr_Factors:  [96.4540998  -0.92849722 -0.87939802]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-7.90440868]
Stock Price:  94.49988503824811
PL:  [-7.90440868]
Settle:  Tensor("sub_310:0", shape=(), dtype=float64)
PL:  Tensor("sub_311:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  156
output_Z_Vals[:, i, :]:  [[ 1.19251512e+02 -2.92846752e+01 -2.92776944e+01]
 [-1.76808911e-01  2.76068578e-02 -9.71209156e-02]
 [-1.10732585e-01  9.98294705e-03  1.17361096e-01]
 [-4.20700632e-02 -7.54544528e-03 -6.29355041e-02]
 [-9.29839805e-02 -1.93062699e-01  1.65562724e-01]
 [-1.37712534e-01  6.67546605e-02  1.39816022e-04]
 [-2.74251239e-01 -2.68841786e-01  2.08926604e-01]
 [-9.56816439e-04 -3.01696645e-02 -9.92735829e-02]
 [-1.53000143e-01 -1.14957830e-01  2.47922001e-01]
 [ 2.99439442e-02  1.94019134e-02  7.09533893e-03]
 [-1.12652283e-01  1.59570064e-01  2.12195985e-02]
 [-4.82072045e-02 -9.09995064e-03 -1.07416916e-01]
 [ 1.49648351e-03 -2.31114139e-01 -2.60224475e-01]
 [-8.02291292e-02  3.10737687e-02 -2.61740345e-02]
 [ 1.61255184e-02 -6.54838167e-02 -4.03415507e-02]
 [ 1.55735512e-01  1.05791345e-02 -2.94762354e-02]
 [-2.35647895e-02  1.03259148e-01  6.82888801e-02]
 [ 4.43814379e-02 -2.38000612e-02  4.26444767e-02]
 [-3.07815884e-01 -8.00498614e-01 -1.35253109e-01]
 [ 1.07369979e-01 -1.15333784e-01 -1.86363791e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.25151208 -29.28467519 -29.2776944 ]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  8.31409947  -9.26062741 -83.52111278]
init_Out:  [2.49223638]
Stock Position:  8.314099471154409
Bond position:  [-828.91771073]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-0.87770662]
curr_Stock_Price:  99.61959949081218
curr_Factors:  [99.61959949 -0.77215142 -0.97642034]
mat_Sqrt:  [[17.33603296  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01130136  0.00873005 -0.27705894]
Stock Position:  -0.011301364597091466
Bond Position:  [0.24813079]


portfolio before change:  [-0.87428456]
curr_Stock_Price:  99.32228813053247
curr_Factors:  [99.32228813 -1.12407742 -0.99638519]
mat_Sqrt:  [[11.91630216  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00726052  0.00315689  0.33479854]
Stock Position:  -0.0072605235989472066
Bond Position:  [-0.15315274]


portfolio before change:  [-0.8779685]
curr_Stock_Price:  99.82440700867355
curr_Factors:  [99.82440701 -0.7211539  -0.97082438]
mat_Sqrt:  [[18.38314912  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00299794 -0.00238608 -0.17953748]
Stock Position:  -0.0029979380254037758
Bond Position:  [-0.57870111]


portfolio before change:  [-0.87728053]
curr_Stock_Price:  99.54666383872674
curr_Factors:  [99.54666384 -1.05826865 -0.95654681]
mat_Sqrt:  [[13.27405072  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00483451 -0.06105179  0.47230437]
Stock Position:  -0.00483450680195877
Bond Position:  [-0.39602151]


portfolio before change:  [-0.86104404]
curr_Stock_Price:  96.16772412271438
curr_Factors:  [96.16772412 -0.80960112 -0.93077561]
mat_Sqrt:  [[16.87303959  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00805785  0.02110968  0.00039886]
Stock Position:  -0.008057848484176986
Bond Position:  [-0.08613909]


portfolio before change:  [-0.8508652]
curr_Stock_Price:  94.90183064611799
curr_Factors:  [94.90183065 -0.78791071 -0.9111927 ]
mat_Sqrt:  [[17.35255194  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01374701 -0.08501524  0.59600945]
Stock Position:  -0.013747011993305485
Bond Position:  [0.4537514]


portfolio before change:  [-0.8584158]
curr_Stock_Price:  95.45933745294562
curr_Factors:  [95.45933745 -1.24819521 -0.89813364]
mat_Sqrt:  [[11.16039688  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00197125 -0.00954049 -0.2831999 ]
Stock Position:  -0.0019712497073529176
Bond Position:  [-0.67024161]


portfolio before change:  [-0.86062154]
curr_Stock_Price:  96.49327946150196
curr_Factors:  [96.49327946 -1.63066429 -0.87530129]
mat_Sqrt:  [[ 7.87354015  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01338172 -0.03635286  0.70725246]
Stock Position:  -0.013381715585181154
Bond Position:  [0.43062408]


portfolio before change:  [-0.8733582]
curr_Stock_Price:  97.45312127028845
curr_Factors:  [97.45312127 -1.48458969 -0.87337219]
mat_Sqrt:  [[ 9.22031841  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00345902 0.00613542 0.02024103]
Stock Position:  0.0034590160591576385
Bond Position:  [-1.21045011]


portfolio before change:  [-0.87526135]
curr_Stock_Price:  96.99041832905402
curr_Factors:  [96.99041833 -1.33913423 -0.84052708]
mat_Sqrt:  [[10.96765926  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00950073  0.05046048  0.06053361]
Stock Position:  -0.00950072994670331
Bond Position:  [0.04621842]


portfolio before change:  [-0.87938176]
curr_Stock_Price:  97.42532904359652
curr_Factors:  [97.42532904 -1.36162714 -0.85859344]
mat_Sqrt:  [[10.57894444  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00665176 -0.00287766 -0.30643056]
Stock Position:  -0.006651755364428054
Bond Position:  [-0.23133231]


portfolio before change:  [-0.87286922]
curr_Stock_Price:  96.43756287758531
curr_Factors:  [96.43756288 -0.92609263 -0.87575539]
mat_Sqrt:  [[15.91158987  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00361931 -0.07308471 -0.742348  ]
Stock Position:  -0.0036193087525013615
Bond Position:  [-0.52383191]


portfolio before change:  [-0.88438206]
curr_Stock_Price:  99.58232361289323
curr_Factors:  [99.58232361 -1.11818964 -0.88712985]
mat_Sqrt:  [[13.40550149  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00632349  0.00982639 -0.07466724]
Stock Position:  -0.006323490429456334
Bond Position:  [-0.25467419]


portfolio before change:  [-0.87676389]
curr_Stock_Price:  98.36751247989294
curr_Factors:  [98.36751248 -0.97307451 -0.83462667]
mat_Sqrt:  [[16.13529991  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00038425 -0.0207078  -0.11508322]
Stock Position:  0.0003842537191382038
Bond Position:  [-0.91456197]


portfolio before change:  [-0.87741878]
curr_Stock_Price:  97.25828844641404
curr_Factors:  [97.25828845 -1.43583039 -0.81626658]
mat_Sqrt:  [[10.22947478  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01466271  0.00334542 -0.0840875 ]
Stock Position:  0.014662713032568088
Bond Position:  [-2.30348916]


portfolio before change:  [-0.87358899]
curr_Stock_Price:  97.55876031188282
curr_Factors:  [97.55876031 -1.10954353 -0.80955376]
mat_Sqrt:  [[14.31571057  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00048613  0.03265341  0.19480917]
Stock Position:  -0.0004861260968067826
Bond Position:  [-0.82616313]


portfolio before change:  [-0.87372187]
curr_Stock_Price:  97.40718429481149
curr_Factors:  [97.40718429 -0.88910899 -0.82297848]
mat_Sqrt:  [[17.58088976  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00298459 -0.00752624  0.12165282]
Stock Position:  0.0029845867311076883
Bond Position:  [-1.16444206]


portfolio before change:  [-0.87129578]
curr_Stock_Price:  98.31761054434261
curr_Factors:  [98.31761054 -0.81401779 -0.83312135]
mat_Sqrt:  [[18.93598386  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0188051  -0.25313989 -0.38583947]
Stock Position:  -0.018805101297821907
Bond Position:  [0.97757685]


portfolio before change:  [-0.88495824]
curr_Stock_Price:  99.05713780835315
curr_Factors:  [99.05713781 -0.67891085 -0.87275884]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-0.88495824]
Stock Price:  99.2955495698283
PL:  [-0.88495824]
Settle:  Tensor("sub_312:0", shape=(), dtype=float64)
PL:  Tensor("sub_313:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  157
output_Z_Vals[:, i, :]:  [[ 1.19251512e+02 -2.92846752e+01 -2.92776944e+01]
 [-7.58753000e-02  8.30541733e-03 -9.39001403e-02]
 [-1.08085812e-01  1.07017276e-02  1.16239477e-01]
 [-2.01195297e-02  3.41035548e-02  5.24142976e-02]
 [-8.69555674e-02 -1.42687345e-01  1.14466553e-01]
 [ 1.22120817e-02 -3.06337815e-02 -8.16053924e-03]
 [-2.11364109e-02  2.23594515e-03  1.40604964e-02]
 [-8.31444541e-02  1.44368604e-01 -1.12246370e-01]
 [-5.40883454e-02 -3.22220907e-02  5.55591361e-02]
 [ 4.50470017e-02  4.74936917e-02 -1.18045691e-02]
 [ 6.70189314e-02  5.79972682e-02 -1.50446695e-02]
 [ 1.24839563e-01 -1.13599287e-02 -1.43192797e-01]
 [ 4.35171469e-02 -1.19704266e-02 -2.73856071e-01]
 [-8.45720117e-02  2.97281712e-02 -3.59999752e-02]
 [-8.63675599e-02  1.13035644e-02  1.46443066e-01]
 [-8.68230750e-02 -1.73413893e-01  1.70052717e-01]
 [-4.72977544e-02 -1.15052651e-01  2.63937995e-01]
 [-3.26879811e-01  4.88697806e-01 -8.69374846e-02]
 [-3.07309167e-01 -1.02150611e+00 -1.70927999e-01]
 [ 1.08719939e-01 -6.14268338e-02 -1.34433446e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.25151208 -29.28467519 -29.2776944 ]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  8.31409947  -9.26062741 -83.52111278]
init_Out:  [2.49223638]
Stock Position:  8.314099471154409
Bond position:  [-828.91771073]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [2.45610771]
curr_Stock_Price:  100.02058270468379
curr_Factors:  [100.0205827   -0.63254239  -0.98957098]
mat_Sqrt:  [[19.75215543  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0048009   0.0026264  -0.26787096]
Stock Position:  -0.004800900907865356
Bond Position:  [2.93629661]


portfolio before change:  [2.45888833]
curr_Stock_Price:  99.59431764917531
curr_Factors:  [99.59431765 -0.8565843  -0.9888404 ]
mat_Sqrt:  [[15.73174132  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00534475  0.00338418  0.33159887]
Stock Position:  -0.0053447491263847865
Bond Position:  [2.99119497]


portfolio before change:  [2.46304761]
curr_Stock_Price:  98.95604841474852
curr_Factors:  [98.95604841 -1.14258798 -0.95345985]
mat_Sqrt:  [[12.16579067  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00070196  0.01078449  0.1495234 ]
Stock Position:  -0.0007019647317926629
Bond Position:  [2.53251126]


portfolio before change:  [2.46418995]
curr_Stock_Price:  98.23074838932969
curr_Factors:  [98.23074839 -1.34589534 -0.9303344 ]
mat_Sqrt:  [[10.08540719  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00667046 -0.0451217   0.32654122]
Stock Position:  -0.00667046458631132
Bond Position:  [3.11943468]


portfolio before change:  [2.45997804]
curr_Stock_Price:  98.97910179823533
curr_Factors:  [98.9791018  -1.35492342 -0.92184985]
mat_Sqrt:  [[10.15671912  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00096048 -0.00968725 -0.02327975]
Stock Position:  0.0009604831702004975
Bond Position:  [2.36491028]


portfolio before change:  [2.46058914]
curr_Stock_Price:  98.99971328464162
curr_Factors:  [98.99971328 -1.57926596 -0.92301193]
mat_Sqrt:  [[ 8.10790136  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00224578  0.00070707  0.04011068]
Stock Position:  -0.0022457836449896657
Bond Position:  [2.68292108]


portfolio before change:  [2.45839039]
curr_Stock_Price:  100.27746953630074
curr_Factors:  [100.27746954  -1.59028377  -0.92067139]
mat_Sqrt:  [[ 8.14159316  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01256868  0.04565336 -0.32020765]
Stock Position:  -0.01256867852666632
Bond Position:  [3.71874567]


portfolio before change:  [2.4511438]
curr_Stock_Price:  100.92800696720161
curr_Factors:  [100.92800697  -1.56881626  -0.94770541]
mat_Sqrt:  [[ 8.14892315  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00534787 -0.01018952  0.15849475]
Stock Position:  -0.005347866729863759
Bond Position:  [2.99089333]


portfolio before change:  [2.4502009]
curr_Stock_Price:  101.2441550078409
curr_Factors:  [101.24415501  -1.46923401  -0.94681119]
mat_Sqrt:  [[ 9.0384688   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.004853    0.01501882 -0.03367515]
Stock Position:  0.004852999659404269
Bond Position:  [1.95886305]


portfolio before change:  [2.45241578]
curr_Stock_Price:  101.59962797774644
curr_Factors:  [101.59962798  -1.54014581  -0.93766538]
mat_Sqrt:  [[ 8.52692394  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00767515  0.01834035 -0.04291825]
Stock Position:  0.007675151623608487
Bond Position:  [1.67262323]


portfolio before change:  [2.45464529]
curr_Stock_Price:  101.8356231888559
curr_Factors:  [101.83562319  -1.2112052   -0.95458364]
mat_Sqrt:  [[11.67641663  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00816322 -0.00359232 -0.40848919]
Stock Position:  0.008163218835426391
Bond Position:  [1.62333881]


portfolio before change:  [2.45339333]
curr_Stock_Price:  101.63253541704637
curr_Factors:  [101.63253542  -0.89740372  -0.9484469 ]
mat_Sqrt:  [[16.04685839  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00079097 -0.00378538 -0.78123514]
Stock Position:  -0.0007909688124093822
Bond Position:  [2.53378149]


portfolio before change:  [2.45322493]
curr_Stock_Price:  102.64638632114963
curr_Factors:  [102.64638632  -0.8245179   -0.98685922]
mat_Sqrt:  [[16.77538814  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00543373  0.00940087 -0.10269791]
Stock Position:  -0.005433728089012365
Bond Position:  [3.01097748]


portfolio before change:  [2.45736284]
curr_Stock_Price:  102.0234109458817
curr_Factors:  [102.02341095  -0.5818388   -1.00600427]
mat_Sqrt:  [[20.85011024  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00269462  0.0035745   0.41776131]
Stock Position:  -0.0026946206378048398
Bond Position:  [2.73227723]


portfolio before change:  [2.45052804]
curr_Stock_Price:  104.81340051386469
curr_Factors:  [104.81340051  -0.39449853  -0.99437803]
mat_Sqrt:  [[26.13577511  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00216518 -0.05483829  0.48511307]
Stock Position:  -0.0021651830401947882
Bond Position:  [2.67746823]


portfolio before change:  [2.44638439]
curr_Stock_Price:  107.03635055409482
curr_Factors:  [107.03635055  -0.29231379  -1.02329646]
mat_Sqrt:  [[28.71898057  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 1.25621329e-04 -3.63828429e-02  7.52941633e-01]
Stock Position:  0.00012562132881044908
Bond Position:  [2.43293834]


portfolio before change:  [2.44740292]
curr_Stock_Price:  110.30188249401346
curr_Factors:  [110.30188249  -0.58416543  -0.98710801]
mat_Sqrt:  [[22.91857118  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01448641  0.15453982 -0.24800844]
Stock Position:  -0.014486406035068511
Bond Position:  [4.04528078]


portfolio before change:  [2.47686371]
curr_Stock_Price:  108.33801789050459
curr_Factors:  [108.33801789  -0.76916165  -0.9764547 ]
mat_Sqrt:  [[18.90903389  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.019492   -0.32302859 -0.48761   ]
Stock Position:  -0.019491999173266147
Bond Position:  [4.58858826]


portfolio before change:  [2.48368707]
curr_Stock_Price:  108.04681801910101
curr_Factors:  [108.04681802  -0.84644353  -1.01220835]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [2.48368707]
Stock Price:  109.19433373805478
PL:  [-6.71064667]
Settle:  Tensor("sub_314:0", shape=(), dtype=float64)
PL:  Tensor("sub_315:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  158
output_Z_Vals[:, i, :]:  [[ 1.19251512e+02 -2.92846752e+01 -2.92776944e+01]
 [-1.03753392e-02 -1.48011351e-02 -4.30592592e-02]
 [-5.23855009e-01 -9.19463793e-02  3.73593879e-01]
 [-5.34816409e-02 -1.41128199e-01 -4.45853555e-01]
 [-9.88296441e-02 -2.41910939e-01  2.15109929e-01]
 [-2.83720840e-02 -1.29566433e-02 -2.00362794e-02]
 [-1.66351438e-02  2.09642622e-03  1.29193321e-02]
 [-5.76123574e-02  9.57495232e-02 -1.12063656e-01]
 [-2.07099340e-01 -1.05320149e-01  2.20898023e-01]
 [ 4.50470017e-02  4.74936917e-02 -1.18045691e-02]
 [ 2.60222063e-02  8.90097008e-02 -1.20275079e-02]
 [ 9.40523209e-02 -1.04570601e-02 -1.29896710e-01]
 [ 3.95126806e-02 -2.59720234e-02 -4.31560484e-01]
 [-8.45720117e-02  2.97281712e-02 -3.59999752e-02]
 [-6.47646570e-02 -1.89031765e-02  8.38532617e-02]
 [ 1.36270516e-01  4.92123491e-03 -7.14561440e-03]
 [-2.45683782e-02  6.74395928e-02  1.16027723e-01]
 [-4.25112989e-02  8.92779900e-02 -9.89437131e-02]
 [-3.65915786e-01 -9.75517421e-01 -2.15100692e-01]
 [ 8.23945492e-02 -5.79378162e-02 -1.12186074e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.25151208 -29.28467519 -29.2776944 ]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  8.31409947  -9.26062741 -83.52111278]
init_Out:  [2.49223638]
Stock Position:  8.314099471154409
Bond position:  [-828.91771073]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [5.07616961]
curr_Stock_Price:  100.33571748405782
curr_Factors:  [100.33571748  -0.98219797  -0.99883964]
mat_Sqrt:  [[13.83890912  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00141246 -0.00468053 -0.12283608]
Stock Position:  -0.0014124622956176417
Bond Position:  [5.21789003]


portfolio before change:  [5.07489914]
curr_Stock_Price:  102.1588474575654
curr_Factors:  [102.15884746  -1.04459983  -1.00599474]
mat_Sqrt:  [[13.1435922   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0342349  -0.029076    1.06575935]
Stock Position:  -0.034234896860276934
Bond Position:  [8.57229675]


portfolio before change:  [5.09288529]
curr_Stock_Price:  101.69607966435342
curr_Factors:  [101.69607966  -0.75167308  -1.04551351]
mat_Sqrt:  [[16.85760959  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00878743 -0.04462866 -1.27189609]
Stock Position:  -0.008787428036825595
Bond Position:  [5.98653227]


portfolio before change:  [5.10307728]
curr_Stock_Price:  100.70657918116859
curr_Factors:  [100.70657918  -0.51288557  -1.01334893]
mat_Sqrt:  [[21.88883385  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00279442 -0.07649896  0.61364875]
Stock Position:  -0.0027944214697151067
Bond Position:  [5.3844939]


portfolio before change:  [5.10733191]
curr_Stock_Price:  99.66581275479233
curr_Factors:  [99.66581275 -0.65067091 -1.04981107]
mat_Sqrt:  [[18.19852833  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00180215 -0.00409725 -0.05715793]
Stock Position:  -0.0018021518514270052
Bond Position:  [5.28694484]


portfolio before change:  [5.10949213]
curr_Stock_Price:  99.20063610438781
curr_Factors:  [99.2006361  -0.94574633 -1.06645922]
mat_Sqrt:  [[13.26247838  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00105138  0.00066295  0.03685526]
Stock Position:  -0.0010513771477707612
Bond Position:  [5.21378941]


portfolio before change:  [5.11150697]
curr_Stock_Price:  98.52416100438846
curr_Factors:  [98.524161   -1.20901783 -1.04659438]
mat_Sqrt:  [[10.3262541   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00755502  0.03027866 -0.31968642]
Stock Position:  -0.0075550158441692146
Bond Position:  [5.85585857]


portfolio before change:  [5.11321164]
curr_Stock_Price:  98.49232477739882
curr_Factors:  [98.49232478 -1.13760561 -1.03570102]
mat_Sqrt:  [[11.2084952   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01469672 -0.03330516  0.63016057]
Stock Position:  -0.014696716338311403
Bond Position:  [6.5607254]


portfolio before change:  [5.09303379]
curr_Stock_Price:  99.9768899022328
curr_Factors:  [99.9768899  -1.50516175 -1.03716656]
mat_Sqrt:  [[ 7.86648037  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00557602  0.01501882 -0.03367515]
Stock Position:  0.005576024337838376
Bond Position:  [4.53556022]


portfolio before change:  [5.09488978]
curr_Stock_Price:  100.10636560929292
curr_Factors:  [100.10636561  -1.10153508  -1.04127257]
mat_Sqrt:  [[11.74497652  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00220225  0.02814734 -0.03431113]
Stock Position:  0.002202245536022713
Bond Position:  [4.87443099]


portfolio before change:  [5.09588537]
curr_Stock_Price:  100.00502817694557
curr_Factors:  [100.00502818  -0.87755287  -0.99890019]
mat_Sqrt:  [[15.31399951  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00439253 -0.00330681 -0.37055916]
Stock Position:  0.004392534149407638
Bond Position:  [4.65660987]


portfolio before change:  [5.09865956]
curr_Stock_Price:  100.37153399349036
curr_Factors:  [100.37153399  -0.49546461  -1.00415715]
mat_Sqrt:  [[22.40438894  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00219822 -0.00821307 -1.23112194]
Stock Position:  -0.0021982223743229772
Bond Position:  [5.31929851]


portfolio before change:  [5.09513457]
curr_Stock_Price:  102.5801286467779
curr_Factors:  [102.58012865  -0.53871333  -1.06033289]
mat_Sqrt:  [[20.73033371  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00439708  0.00940087 -0.10269791]
Stock Position:  -0.004397078168124919
Bond Position:  [5.54618742]


portfolio before change:  [5.10267249]
curr_Stock_Price:  101.18119891418796
curr_Factors:  [101.18119891  -0.42247522  -1.03368484]
mat_Sqrt:  [[23.58834887  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00204068 -0.00597771  0.23921002]
Stock Position:  -0.0020406794838133736
Bond Position:  [5.30915089]


portfolio before change:  [5.11018598]
curr_Stock_Price:  98.14983959916556
curr_Factors:  [98.1498396  -0.22715287 -1.03159007]
mat_Sqrt:  [[27.87561638  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00484075  0.00155623 -0.02038445]
Stock Position:  0.004840753556460457
Bond Position:  [4.6350668]


portfolio before change:  [5.12393577]
curr_Stock_Price:  100.7508551624423
curr_Factors:  [100.75085516  -0.28374704  -1.05736197]
mat_Sqrt:  [[26.35193415  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [3.25199824e-05 2.13262718e-02 3.30994799e-01]
Stock Position:  3.2519982406005766e-05
Bond Position:  [5.12065935]


portfolio before change:  [5.12525265]
curr_Stock_Price:  101.8751070760186
curr_Factors:  [ 1.01875107e+02 -6.65077186e-02 -1.04794575e+00]
mat_Sqrt:  [[33.4246668   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00180714  0.02823218 -0.28225887]
Stock Position:  -0.001807136997876411
Bond Position:  [5.30935493]


portfolio before change:  [5.12704992]
curr_Stock_Price:  101.61515745747708
curr_Factors:  [101.61515746  -0.46289739  -1.02411159]
mat_Sqrt:  [[22.96987854  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01893831 -0.30848569 -0.6136224 ]
Stock Position:  -0.01893831444997132
Bond Position:  [7.05146973]


portfolio before change:  [5.14507332]
curr_Stock_Price:  100.75656443170696
curr_Factors:  [100.75656443  -0.76897754  -1.04198467]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [5.14507332]
Stock Price:  102.33956655688296
PL:  [2.80550676]
Settle:  Tensor("sub_316:0", shape=(), dtype=float64)
PL:  Tensor("sub_317:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  159
output_Z_Vals[:, i, :]:  [[ 1.19251512e+02 -2.92846752e+01 -2.92776944e+01]
 [ 2.00757170e-02 -7.30481606e-02 -1.91309183e-01]
 [-2.06639571e-01 -1.60623820e-02  1.58003443e-01]
 [-1.99241373e-02  3.56162574e-02  5.64310673e-02]
 [-9.61947066e-02 -2.19892556e-01  1.92776487e-01]
 [ 1.24271816e-02 -1.64206259e-01  2.36017617e-02]
 [-3.42898893e-02 -6.67711260e-03  2.16188008e-02]
 [-4.58407387e-02  7.76036425e-02 -1.05203720e-01]
 [-2.56780285e-01 -1.22436326e-01  2.58572609e-01]
 [ 3.04304626e-02  2.17800461e-02  6.38543017e-03]
 [-4.79073102e-02  1.02445406e-01  1.49475876e-02]
 [-7.05750232e-02 -9.36149501e-03 -1.31870496e-01]
 [-5.49549509e-02 -4.74207542e-01 -3.65996476e-01]
 [ 8.89759594e-02 -5.76708167e-02 -1.71860644e-03]
 [ 1.11348156e-02 -5.79141975e-02 -1.09473076e-01]
 [ 1.66285558e-01  2.63014981e-02 -6.68113468e-02]
 [-2.36131575e-02  5.47255654e-02  1.28266726e-01]
 [-3.57923049e-04  3.50681831e-02 -8.68878971e-02]
 [-3.30719934e-01 -8.71161544e-01 -1.52909367e-01]
 [ 8.74211340e-02 -6.94893973e-02 -1.27115170e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.25151208 -29.28467519 -29.2776944 ]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  8.31409947  -9.26062741 -83.52111278]
init_Out:  [2.49223638]
Stock Position:  8.314099471154409
Bond position:  [-828.91771073]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [10.4455861]
curr_Stock_Price:  100.98153805803194
curr_Factors:  [100.98153806  -1.15052133  -0.98452773]
mat_Sqrt:  [[11.93993484  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00174718 -0.02309986 -0.54575185]
Stock Position:  -0.0017471788643907476
Bond Position:  [10.62201891]


portfolio before change:  [10.45037451]
curr_Stock_Price:  99.76095976340147
curr_Factors:  [99.76095976 -1.31374071 -0.99876194]
mat_Sqrt:  [[ 9.87764653  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01769672 -0.00507937  0.45073984]
Stock Position:  -0.017696723768992246
Bond Position:  [12.21581665]


portfolio before change:  [10.46484531]
curr_Stock_Price:  99.11584233094494
curr_Factors:  [99.11584233 -1.06565236 -0.96288503]
mat_Sqrt:  [[13.03648422  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0005742   0.01126285  0.16098213]
Stock Position:  -0.0005742028262423069
Bond Position:  [10.5217579]


portfolio before change:  [10.46697881]
curr_Stock_Price:  99.98185763869819
curr_Factors:  [99.98185764 -0.93751779 -0.96409342]
mat_Sqrt:  [[14.93007362  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00418765 -0.06953613  0.54993766]
Stock Position:  -0.004187653319028295
Bond Position:  [10.88566816]


portfolio before change:  [10.46768377]
curr_Stock_Price:  100.4634613571073
curr_Factors:  [100.46346136  -1.01459922  -0.96464114]
mat_Sqrt:  [[13.88145429  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00093687 -0.05192658  0.06732926]
Stock Position:  0.0009368675225710538
Bond Position:  [10.37356282]


portfolio before change:  [10.46900841]
curr_Stock_Price:  99.10886081820063
curr_Factors:  [99.10886082 -0.7760843  -0.98827734]
mat_Sqrt:  [[16.97696132  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00177001 -0.00211149  0.06167242]
Stock Position:  -0.0017700088870770258
Bond Position:  [10.64443197]


portfolio before change:  [10.47407264]
curr_Stock_Price:  97.75135907802283
curr_Factors:  [97.75135908 -0.85530526 -0.96595508]
mat_Sqrt:  [[15.81828832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00412887  0.02454043 -0.30011693]
Stock Position:  -0.0041288690366577665
Bond Position:  [10.8776752]


portfolio before change:  [10.47393232]
curr_Stock_Price:  98.44406195182971
curr_Factors:  [98.44406195 -0.80012426 -1.00278921]
mat_Sqrt:  [[16.22535302  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01276771 -0.03871777  0.73763568]
Stock Position:  -0.012767713850481486
Bond Position:  [11.73083793]


portfolio before change:  [10.49789812]
curr_Stock_Price:  96.79672519640043
curr_Factors:  [96.7967252  -0.33475663 -0.9344715 ]
mat_Sqrt:  [[27.20457153  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00118716 0.00688746 0.01821585]
Stock Position:  0.001187162290250463
Bond Position:  [10.3829847]


portfolio before change:  [10.497748]
curr_Stock_Price:  94.48348730323556
curr_Factors:  [94.4834873  -0.21367238 -0.91691393]
mat_Sqrt:  [[30.50341879  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00138381  0.03239608  0.04264131]
Stock Position:  -0.001383812678691431
Bond Position:  [10.62849545]


portfolio before change:  [10.49956907]
curr_Stock_Price:  95.0878971950672
curr_Factors:  [95.0878972  -0.50222119 -0.93145407]
mat_Sqrt:  [[22.67190369  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00431083 -0.00296036 -0.37618982]
Stock Position:  -0.004310828485484128
Bond Position:  [10.90947668]


portfolio before change:  [10.50973513]
curr_Stock_Price:  93.36239318038191
curr_Factors:  [93.36239318 -0.22718863 -0.9588096 ]
mat_Sqrt:  [[28.51671454  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0049763  -0.14995759 -1.04408607]
Stock Position:  -0.004976297478752053
Bond Position:  [10.97433417]


portfolio before change:  [10.51132124]
curr_Stock_Price:  93.59505949802912
curr_Factors:  [93.5950595  -0.19172543 -0.96632611]
mat_Sqrt:  [[29.3979826   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00296402 -0.01823711 -0.00490271]
Stock Position:  0.0029640161843296226
Bond Position:  [10.23390397]


portfolio before change:  [10.52432409]
curr_Stock_Price:  97.1186774231818
curr_Factors:  [97.11867742 -0.10590719 -0.94289722]
mat_Sqrt:  [[34.02614838  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00037344 -0.01831408 -0.31229621]
Stock Position:  -0.00037343693794007803
Bond Position:  [10.5605918]


portfolio before change:  [10.52697575]
curr_Stock_Price:  97.08874283814812
curr_Factors:  [97.08874284 -0.16198394 -0.93150884]
mat_Sqrt:  [[32.52902138  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00471354  0.00831726 -0.19059418]
Stock Position:  0.0047135402176854925
Bond Position:  [10.06934406]


portfolio before change:  [10.54948213]
curr_Stock_Price:  101.32944706817497
curr_Factors:  [101.32944707  -0.39340835  -0.98225387]
mat_Sqrt:  [[25.60313591  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [1.55535102e-04 1.73057433e-02 3.65909267e-01]
Stock Position:  0.00015553510233288554
Bond Position:  [10.53372185]


portfolio before change:  [10.55207869]
curr_Stock_Price:  101.09025631468998
curr_Factors:  [101.09025631  -0.74727957  -0.96332127]
mat_Sqrt:  [[18.27278698  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00094065  0.01108953 -0.24786699]
Stock Position:  -0.0009406547671470006
Bond Position:  [10.64716972]


portfolio before change:  [10.55527513]
curr_Stock_Price:  100.522234931495
curr_Factors:  [100.52223493  -0.82799458  -0.9697695 ]
mat_Sqrt:  [[16.65340781  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02308391 -0.27548547 -0.43620786]
Stock Position:  -0.023083907303859716
Bond Position:  [12.87572108]


portfolio before change:  [10.53828134]
curr_Stock_Price:  101.39787153007107
curr_Factors:  [101.39787153  -0.67378361  -0.95263801]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [10.53828134]
Stock Price:  99.73988153479652
PL:  [10.53828134]
Settle:  Tensor("sub_318:0", shape=(), dtype=float64)
PL:  Tensor("sub_319:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  160
output_Z_Vals[:, i, :]:  [[ 1.19251512e+02 -2.92846752e+01 -2.92776944e+01]
 [ 5.90922886e-02 -4.36267069e-02 -5.95073844e-02]
 [-1.99496027e-01 -1.41224196e-02  1.54976235e-01]
 [-6.73830718e-02 -1.30198176e-01 -4.09339840e-01]
 [-9.88296441e-02 -2.41910939e-01  2.15109929e-01]
 [-2.02129792e-01 -5.03972427e-03  2.30781920e-03]
 [ 5.90542854e-02  2.68719307e-02 -1.45926142e-02]
 [-1.38388467e-01  2.13320911e-01 -7.37670391e-02]
 [-1.24127051e-01 -6.18970911e-02  1.22270219e-01]
 [ 4.50470017e-02  4.74936917e-02 -1.18045691e-02]
 [ 4.43439448e-02  7.51565017e-02 -1.33744987e-02]
 [ 1.20930300e-01 -1.12452854e-02 -1.41504503e-01]
 [ 4.73274199e-02 -1.19647392e-02 -3.45726418e-01]
 [-8.45720117e-02  2.97281712e-02 -3.59999752e-02]
 [-9.90403870e-02  3.63162905e-02  1.96540878e-01]
 [-2.90301860e-02 -7.31901143e-02  1.22626424e-01]
 [-2.38805006e-02 -1.49135639e-02  2.18728708e-01]
 [-7.31774968e-02  1.34757370e-01 -9.09886479e-02]
 [-3.50054909e-01 -9.73072459e-01 -2.11613337e-01]
 [ 8.63626813e-02 -5.98373834e-02 -1.16887393e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.25151208 -29.28467519 -29.2776944 ]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  8.31409947  -9.26062741 -83.52111278]
init_Out:  [2.49223638]
Stock Position:  8.314099471154409
Bond position:  [-828.91771073]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [7.41293551]
curr_Stock_Price:  100.61677809752263
curr_Factors:  [100.6167781   -1.00255259  -1.01215293]
mat_Sqrt:  [[13.41822019  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00341468 -0.01379598 -0.169758  ]
Stock Position:  0.0034146822190016892
Bond Position:  [7.06936118]


portfolio before change:  [7.41293788]
curr_Stock_Price:  100.09983848575537
curr_Factors:  [100.09983849  -0.90560272  -1.01538534]
mat_Sqrt:  [[14.66084036  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01147453 -0.0044659   0.44210406]
Stock Position:  -0.011474531544517438
Bond Position:  [8.56153664]


portfolio before change:  [7.40152156]
curr_Stock_Price:  101.28132237108217
curr_Factors:  [101.28132237  -0.63936656  -1.05304922]
mat_Sqrt:  [[18.6432889   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00827649 -0.04117228 -1.16773263]
Stock Position:  -0.008276485984548594
Bond Position:  [8.23977501]


portfolio before change:  [7.39984449]
curr_Stock_Price:  101.73287476076446
curr_Factors:  [101.73287476  -0.51167087  -1.07113953]
mat_Sqrt:  [[20.89563121  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00292724 -0.07649896  0.61364875]
Stock Position:  -0.0029272447741132946
Bond Position:  [7.69764152]


portfolio before change:  [7.40157513]
curr_Stock_Price:  101.79915491792796
curr_Factors:  [101.79915492  -0.49665616  -1.08807766]
mat_Sqrt:  [[20.8690662   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00966928 -0.0015937   0.00658357]
Stock Position:  -0.009669279559652666
Bond Position:  [8.38589961]


portfolio before change:  [7.41729155]
curr_Stock_Price:  100.39060294084747
curr_Factors:  [100.39060294  -0.45054046  -1.05467986]
mat_Sqrt:  [[22.28354003  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00254759  0.00849765 -0.04162867]
Stock Position:  0.0025475939054615533
Bond Position:  [7.16153706]


portfolio before change:  [7.42459044]
curr_Stock_Price:  102.55275566233831
curr_Factors:  [102.55275566  -1.02718354  -1.07042319]
mat_Sqrt:  [[12.58833546  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.011752    0.067458   -0.21043683]
Stock Position:  -0.011752004786508832
Bond Position:  [8.62979092]


portfolio before change:  [7.450025]
curr_Stock_Price:  100.57208626481486
curr_Factors:  [100.57208626  -1.0793916   -1.01955032]
mat_Sqrt:  [[12.32873638  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00817334 -0.01957358  0.3488029 ]
Stock Position:  -0.008173337460659139
Bond Position:  [8.2720346]


portfolio before change:  [7.44771779]
curr_Stock_Price:  101.10742138175878
curr_Factors:  [101.10742138  -0.9032319   -1.00893601]
mat_Sqrt:  [[14.93960321  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00293607  0.01501882 -0.03367515]
Stock Position:  0.002936067670000412
Bond Position:  [7.15085956]


portfolio before change:  [7.44910229]
curr_Stock_Price:  100.97001589489419
curr_Factors:  [100.97001589  -1.11307265  -0.96755201]
mat_Sqrt:  [[12.60632836  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00345496  0.02376657 -0.03815372]
Stock Position:  0.0034549646773203856
Bond Position:  [7.10025446]


portfolio before change:  [7.44777621]
curr_Stock_Price:  100.07235871365437
curr_Factors:  [100.07235871  -0.67261133  -0.96576254]
mat_Sqrt:  [[19.44363244  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00471905 -0.00355607 -0.40367296]
Stock Position:  0.004719049419204653
Bond Position:  [6.9755298]


portfolio before change:  [7.45058655]
curr_Stock_Price:  100.29830378198832
curr_Factors:  [100.29830378  -0.86989196  -0.96675117]
mat_Sqrt:  [[15.98268028  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00147363 -0.00378358 -0.98626124]
Stock Position:  -0.0014736338096155703
Bond Position:  [7.59838952]


portfolio before change:  [7.44938995]
curr_Stock_Price:  102.39952872206527
curr_Factors:  [102.39952872  -1.02386561  -0.94013748]
mat_Sqrt:  [[14.36621151  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00634495  0.00940087 -0.10269791]
Stock Position:  -0.006344950280417758
Bond Position:  [8.09910987]


portfolio before change:  [7.45032059]
curr_Stock_Price:  102.57201135165936
curr_Factors:  [102.57201135  -0.95954767  -0.94820742]
mat_Sqrt:  [[15.22303906  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00380896  0.01148422  0.56067642]
Stock Position:  -0.003808961237881988
Bond Position:  [7.8410134]


portfolio before change:  [7.45260607]
curr_Stock_Price:  102.48669117585338
curr_Factors:  [102.48669118  -0.5817311   -0.95666644]
mat_Sqrt:  [[22.00644587  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-2.67600349e-04 -2.31447463e-02  3.49819056e-01]
Stock Position:  -0.0002676003492474469
Bond Position:  [7.48003154]


portfolio before change:  [7.45407382]
curr_Stock_Price:  103.99076275046355
curr_Factors:  [103.99076275  -0.41956821  -0.96506304]
mat_Sqrt:  [[26.04096376  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0007827  -0.00471608  0.62397212]
Stock Position:  0.0007826992717810062
Bond Position:  [7.37268033]


portfolio before change:  [7.45570618]
curr_Stock_Price:  103.72113101241399
curr_Factors:  [103.72113101  -0.81829372  -0.95962051]
mat_Sqrt:  [[17.52786038  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00503604  0.04261402 -0.25956529]
Stock Position:  -0.005036042876464401
Bond Position:  [7.97805024]


portfolio before change:  [7.45921556]
curr_Stock_Price:  103.42037571540402
curr_Factors:  [103.42037572  -0.44749361  -0.9416566 ]
mat_Sqrt:  [[25.78136089  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01622781 -0.30771253 -0.60367395]
Stock Position:  -0.016227805997651727
Bond Position:  [9.13750135]


portfolio before change:  [7.45147872]
curr_Stock_Price:  104.03792671397653
curr_Factors:  [104.03792671  -0.71171309  -0.9422492 ]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [7.45147872]
Stock Price:  104.49541185731303
PL:  [2.95606686]
Settle:  Tensor("sub_320:0", shape=(), dtype=float64)
PL:  Tensor("sub_321:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  161
output_Z_Vals[:, i, :]:  [[ 1.19251512e+02 -2.92846752e+01 -2.92776944e+01]
 [-1.84212038e-01  5.07998449e-02  3.49186474e-02]
 [-2.09292117e-01 -1.67827304e-02  1.59127508e-01]
 [-4.15184823e-02 -1.94722779e-02 -9.62456284e-02]
 [-9.88296441e-02 -2.41910939e-01  2.15109929e-01]
 [ 1.99376426e-02 -1.53090963e-01  2.28731083e-02]
 [ 5.57026460e-02  3.19902860e-02 -1.74068480e-02]
 [-1.12724720e-01  1.78347723e-01 -7.59722515e-02]
 [-7.06837024e-02 -1.54584450e-02  1.19518060e-02]
 [-2.35990249e-02 -7.61494161e-03 -2.50398626e-02]
 [ 1.83287367e-01 -5.59748927e-02 -5.78298839e-02]
 [-4.39226372e-02 -5.97230644e-03 -7.18989568e-02]
 [ 4.12838191e-02 -1.21038624e-02 -2.38393716e-01]
 [-8.18844763e-02  2.81141399e-02 -3.53075048e-02]
 [-1.25976822e-01  7.72920748e-02  2.48795458e-01]
 [-1.21934243e-01 -2.34690087e-01  1.98954549e-01]
 [-3.35400960e-02 -7.45485762e-02  2.62482355e-01]
 [-2.40762128e-01  3.64365617e-01 -9.99090426e-02]
 [-3.70054183e-01 -1.07531005e+00 -2.71642210e-01]
 [ 1.00721693e-01 -6.43877953e-02 -1.31619761e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.25151208 -29.28467519 -29.2776944 ]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  8.31409947  -9.26062741 -83.52111278]
init_Out:  [2.49223638]
Stock Position:  8.314099471154409
Bond position:  [-828.91771073]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-4.48132501]
curr_Stock_Price:  99.18616488985094
curr_Factors:  [99.18616489 -0.84467899 -0.99592658]
mat_Sqrt:  [[15.74295507  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01116516  0.01606432  0.09961318]
Stock Position:  -0.011165162538376043
Bond Position:  [-3.37389535]


portfolio before change:  [-4.49439983]
curr_Stock_Price:  100.28164771374098
curr_Factors:  [100.28164771  -0.89116122  -0.96380077]
mat_Sqrt:  [[15.68995523  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01129663 -0.00530717  0.45394649]
Stock Position:  -0.011296633823456043
Bond Position:  [-3.36155478]


portfolio before change:  [-4.49400163]
curr_Stock_Price:  100.17199594775157
curr_Factors:  [100.17199595  -1.1267813   -1.01343806]
mat_Sqrt:  [[11.78313546  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00523352 -0.00615767 -0.27456199]
Stock Position:  -0.005233523043105836
Bond Position:  [-3.96974918]


portfolio before change:  [-4.49829488]
curr_Stock_Price:  100.80267798245931
curr_Factors:  [100.80267798  -1.4860984   -1.00300135]
mat_Sqrt:  [[ 8.36507399  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00731214 -0.07649896  0.61364875]
Stock Position:  -0.007312144196421305
Bond Position:  [-3.76121116]


portfolio before change:  [-4.49371142]
curr_Stock_Price:  100.04723918235517
curr_Factors:  [100.04723918  -1.24721925  -0.99922311]
mat_Sqrt:  [[10.58248323  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0019517  -0.04841161  0.06525061]
Stock Position:  0.0019516973676623561
Bond Position:  [-4.68897336]


portfolio before change:  [-4.49255406]
curr_Stock_Price:  101.24094610595037
curr_Factors:  [101.24094611  -0.98766887  -0.98822511]
mat_Sqrt:  [[14.03577324  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00377432  0.01011622 -0.04965689]
Stock Position:  0.0037743181480672846
Bond Position:  [-4.8746696]


portfolio before change:  [-4.49401133]
curr_Stock_Price:  101.1777680308711
curr_Factors:  [101.17776803  -0.78622747  -0.97120758]
mat_Sqrt:  [[17.45182114  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00708394  0.0563985  -0.21672769]
Stock Position:  -0.007083935342836619
Bond Position:  [-3.77727456]


portfolio before change:  [-4.52045972]
curr_Stock_Price:  104.77801937630609
curr_Factors:  [104.77801938  -0.66436159  -0.95901779]
mat_Sqrt:  [[20.66547922  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00332164 -0.00488839  0.03409518]
Stock Position:  -0.003321635314633488
Bond Position:  [-4.17242535]


portfolio before change:  [-4.52246372]
curr_Stock_Price:  105.06726428541825
curr_Factors:  [105.06726429  -0.6875304   -0.97310202]
mat_Sqrt:  [[19.96475238  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0014479  -0.00240806 -0.07143176]
Stock Position:  -0.0014478958627684429
Bond Position:  [-4.37033726]


portfolio before change:  [-4.52332254]
curr_Stock_Price:  104.90572049669863
curr_Factors:  [104.9057205   -1.09886194  -0.97801287]
mat_Sqrt:  [[13.14691645  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01293365 -0.01770082 -0.16497256]
Stock Position:  0.01293365074709262
Bond Position:  [-5.88013649]


portfolio before change:  [-4.52886439]
curr_Stock_Price:  104.59091118323501
curr_Factors:  [104.59091118  -0.93207044  -1.00175707]
mat_Sqrt:  [[15.12318723  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00388497 -0.00188861 -0.20510771]
Stock Position:  -0.0038849717090233076
Bond Position:  [-4.12253166]


portfolio before change:  [-4.52370696]
curr_Stock_Price:  102.99805749851461
curr_Factors:  [102.9980575   -0.84768531  -1.02083895]
mat_Sqrt:  [[15.89788164  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-4.83750910e-04 -3.82757737e-03 -6.80070915e-01]
Stock Position:  -0.000483750910370682
Bond Position:  [-4.47388156]


portfolio before change:  [-4.52530884]
curr_Stock_Price:  103.99706159836786
curr_Factors:  [103.9970616   -0.91380994  -1.00178265]
mat_Sqrt:  [[15.31404003  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00577024  0.00889047 -0.10072248]
Stock Position:  -0.005770240017878478
Bond Position:  [-3.92522084]


portfolio before change:  [-4.52779658]
curr_Stock_Price:  104.25810977800667
curr_Factors:  [104.25810978  -0.46704537  -1.01925505]
mat_Sqrt:  [[23.58401692  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00310363  0.0244419   0.70974419]
Stock Position:  -0.0031036268862667223
Bond Position:  [-4.20421831]


portfolio before change:  [-4.53516457]
curr_Stock_Price:  106.29340577433632
curr_Factors:  [106.29340577  -0.20641024  -0.98847462]
mat_Sqrt:  [[32.1791391   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0027155  -0.07421552  0.56756195]
Stock Position:  -0.002715501103146701
Bond Position:  [-4.2465247]


portfolio before change:  [-4.53433324]
curr_Stock_Price:  105.59626349429281
curr_Factors:  [105.59626349  -0.14602364  -1.00451662]
mat_Sqrt:  [[33.4176007   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 5.42051317e-04 -2.35743297e-02  7.48789098e-01]
Stock Position:  0.000542051316901616
Bond Position:  [-4.59157183]


portfolio before change:  [-4.53433096]
curr_Stock_Price:  107.71841880489919
curr_Factors:  [107.7184188   -0.31680206  -0.98783091]
mat_Sqrt:  [[29.22099954  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00861531  0.11522252 -0.28501269]
Stock Position:  -0.008615314322217313
Bond Position:  [-3.60630292]


portfolio before change:  [-4.51320109]
curr_Stock_Price:  105.16116366199776
curr_Factors:  [ 1.05161164e+02 -5.59189586e-02 -1.00244658e+00]
mat_Sqrt:  [[36.49329418  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01242056 -0.34004289 -0.77491961]
Stock Position:  -0.012420564188643431
Bond Position:  [-3.20704011]


portfolio before change:  [-4.51439337]
curr_Stock_Price:  105.19259672866048
curr_Factors:  [105.19259673  -0.43382232  -0.9964496 ]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-4.51439337]
Stock Price:  106.05289894712755
PL:  [-10.56729231]
Settle:  Tensor("sub_322:0", shape=(), dtype=float64)
PL:  Tensor("sub_323:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  162
output_Z_Vals[:, i, :]:  [[ 1.19251512e+02 -2.92846752e+01 -2.92776944e+01]
 [ 5.28937342e-02 -5.12775691e-02 -7.53436461e-02]
 [-1.30701316e-01  4.56006614e-03  1.25823212e-01]
 [-2.90815596e-02  4.28916784e-02  7.15632729e-02]
 [-8.42431152e-02 -1.20021224e-01  9.14761046e-02]
 [-1.39584435e-01  6.58442583e-02  1.62922065e-03]
 [-1.49153225e-01 -1.22374952e-01  1.06293671e-01]
 [-5.09326278e-02  8.94819620e-02 -1.01950149e-01]
 [-1.71863568e-01 -7.90755462e-02  1.60232340e-01]
 [ 7.21848329e-02  5.98015777e-02 -5.83259607e-03]
 [ 4.65431763e-02  7.64511790e-02 -1.05437567e-02]
 [-1.64731622e-02 -9.77028211e-03 -1.22435411e-01]
 [-1.92075581e-02 -2.96989720e-01 -3.90052702e-01]
 [ 6.42351666e-02 -3.04227742e-02  1.13460957e-02]
 [ 1.11348156e-02 -5.79141975e-02 -1.09473076e-01]
 [ 1.86705469e-01  5.25575419e-02 -1.56399062e-01]
 [ 1.27743743e-03 -5.57152925e-02  5.07926541e-02]
 [ 4.16196696e-02 -2.49874608e-02  6.99696018e-02]
 [-3.84065724e-01 -9.66340234e-01 -2.48459926e-01]
 [ 1.59860949e-01 -2.19423739e-01 -3.57367097e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.25151208 -29.28467519 -29.2776944 ]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  8.31409947  -9.26062741 -83.52111278]
init_Out:  [2.49223638]
Stock Position:  8.314099471154409
Bond position:  [-828.91771073]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [9.01183799]
curr_Stock_Price:  100.8090902644238
curr_Factors:  [100.80909026  -0.94540344  -0.99564428]
mat_Sqrt:  [[14.47149433  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0025008  -0.01621539 -0.21493445]
Stock Position:  0.002500798805659305
Bond Position:  [8.75973474]


portfolio before change:  [9.01128005]
curr_Stock_Price:  99.71018188819043
curr_Factors:  [99.71018189 -0.85210699 -1.0087157 ]
mat_Sqrt:  [[15.50938149  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00676365  0.00144202  0.3589386 ]
Stock Position:  -0.0067636494580209094
Bond Position:  [9.68568477]


portfolio before change:  [9.02519167]
curr_Stock_Price:  98.01141069902445
curr_Factors:  [98.0114107  -1.02608509 -0.98619367]
mat_Sqrt:  [[13.10252752  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00102013  0.01356354  0.2041501 ]
Stock Position:  -0.0010201321311111837
Bond Position:  [9.12517626]


portfolio before change:  [9.02791172]
curr_Stock_Price:  97.58159259927922
curr_Factors:  [97.5815926  -0.87643447 -0.98945444]
mat_Sqrt:  [[15.10158884  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00454718 -0.03795404  0.26095586]
Stock Position:  -0.004547175064853318
Bond Position:  [9.4716323]


portfolio before change:  [9.03715794]
curr_Stock_Price:  96.06900011750366
curr_Factors:  [96.06900012 -0.80973708 -1.00696766]
mat_Sqrt:  [[15.61702926  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00880781  0.02082178  0.00464771]
Stock Position:  -0.008807807033546977
Bond Position:  [9.88331516]


portfolio before change:  [9.02987885]
curr_Stock_Price:  97.17599843578304
curr_Factors:  [97.17599844 -0.86037134 -0.99854491]
mat_Sqrt:  [[15.14404675  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0086249  -0.03869836  0.30322626]
Stock Position:  -0.00862489599435368
Bond Position:  [9.86801173]


portfolio before change:  [9.02556387]
curr_Stock_Price:  97.96236135703684
curr_Factors:  [97.96236136 -0.78704377 -1.01870708]
mat_Sqrt:  [[16.10021282  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00431253  0.02829668 -0.2908354 ]
Stock Position:  -0.004312533089719485
Bond Position:  [9.44802979]


portfolio before change:  [9.01605816]
curr_Stock_Price:  100.71434148880422
curr_Factors:  [100.71434149  -0.61204551  -1.05074586]
mat_Sqrt:  [[19.09634272  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00739398 -0.02500588  0.45709827]
Stock Position:  -0.007393981273249341
Bond Position:  [9.76073812]


portfolio before change:  [9.03222315]
curr_Stock_Price:  98.85816956999052
curr_Factors:  [98.85816957 -0.5847319  -1.05138605]
mat_Sqrt:  [[19.25110088  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00376801  0.01891092 -0.01663877]
Stock Position:  0.0037680094138553134
Bond Position:  [8.65972464]


portfolio before change:  [9.03458204]
curr_Stock_Price:  98.90957064087777
curr_Factors:  [98.90957064 -0.7630551  -1.04400209]
mat_Sqrt:  [[16.23466573  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00285592  0.02417599 -0.0300784 ]
Stock Position:  0.0028559197197638615
Bond Position:  [8.75210424]


portfolio before change:  [9.03063129]
curr_Stock_Price:  96.75998439536372
curr_Factors:  [96.7599844  -0.63271894 -1.01484239]
mat_Sqrt:  [[18.6281186   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00223949 -0.00308963 -0.34927415]
Stock Position:  -0.002239488284875567
Bond Position:  [9.24732414]


portfolio before change:  [9.03467794]
curr_Stock_Price:  95.98546432524556
curr_Factors:  [95.98546433 -0.370776   -0.97318134]
mat_Sqrt:  [[25.03411319  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00425399 -0.0939164  -1.11271179]
Stock Position:  -0.00425399427219739
Bond Position:  [9.44299955]


portfolio before change:  [9.04053343]
curr_Stock_Price:  95.16401415343962
curr_Factors:  [95.16401415 -0.40987623 -0.95401574]
mat_Sqrt:  [[24.32999368  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00270307 -0.00962053  0.03236725]
Stock Position:  0.002703069589917086
Bond Position:  [8.78329847]


portfolio before change:  [9.03994027]
curr_Stock_Price:  94.13213100486968
curr_Factors:  [94.132131   -0.69131472 -0.93205228]
mat_Sqrt:  [[18.56600917  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0006844  -0.01831408 -0.31229621]
Stock Position:  -0.0006844023692421627
Bond Position:  [9.10436453]


portfolio before change:  [9.04305085]
curr_Stock_Price:  92.91325233842296
curr_Factors:  [92.91325234 -0.58041827 -0.92370995]
mat_Sqrt:  [[20.64634014  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00756249  0.01662015 -0.44616299]
Stock Position:  0.007562486786332286
Bond Position:  [8.34039561]


portfolio before change:  [9.03185355]
curr_Stock_Price:  91.15686356000467
curr_Factors:  [91.15686356 -0.23670013 -0.90732974]
mat_Sqrt:  [[29.03644991  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00035152 -0.01761872  0.1448973 ]
Stock Position:  0.0003515196207369484
Bond Position:  [8.99981012]


portfolio before change:  [9.03458607]
curr_Stock_Price:  92.528886368058
curr_Factors:  [92.52888637 -0.21992389 -0.92879896]
mat_Sqrt:  [[29.33548965  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00188362 -0.00790173  0.1996038 ]
Stock Position:  0.0018836222580654559
Bond Position:  [8.8602966]


portfolio before change:  [9.03448034]
curr_Stock_Price:  91.2966436659661
curr_Factors:  [91.29664367 -0.31493459 -0.9020656 ]
mat_Sqrt:  [[27.03450032  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01700543 -0.30558361 -0.70878701]
Stock Position:  -0.017005425902900856
Bond Position:  [10.58701865]


portfolio before change:  [9.00440873]
curr_Stock_Price:  93.220658966724
curr_Factors:  [93.22065897 -0.4027638  -0.88399737]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [9.00440873]
Stock Price:  94.85332967472263
PL:  [9.00440873]
Settle:  Tensor("sub_324:0", shape=(), dtype=float64)
PL:  Tensor("sub_325:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  163
output_Z_Vals[:, i, :]:  [[ 1.19251512e+02 -2.92846752e+01 -2.92776944e+01]
 [-6.33910120e-02  6.93311142e-03 -8.74786440e-02]
 [-3.32628850e-01 -5.02771181e-02  2.11393715e-01]
 [-4.35237785e-02 -2.81197126e-02 -1.20748922e-01]
 [-8.99840362e-02 -1.67994202e-01  1.40135523e-01]
 [-6.75614186e-02  3.92242953e-02 -7.66307851e-03]
 [-8.30098290e-02 -5.01561517e-02  5.49102361e-02]
 [-6.17054971e-02  1.12330071e-01 -9.84570548e-02]
 [-2.48477731e-01 -1.20990962e-01  2.55681980e-01]
 [ 4.51704398e-02  3.54041321e-02  2.01196845e-03]
 [ 9.96606305e-03  9.29245407e-02  1.96294060e-03]
 [-3.15194718e-02 -9.19983004e-03 -1.09232950e-01]
 [-5.71690824e-03 -2.66516508e-01 -2.53452880e-01]
 [ 3.63653144e-02 -1.13889673e-02  9.31667945e-03]
 [ 1.69523837e-02 -6.12895452e-02 -8.30205829e-02]
 [ 1.71296272e-01  3.52066894e-02 -9.22200294e-02]
 [-1.38782463e-03  3.86686654e-02  8.51166589e-02]
 [ 4.45910875e-02 -2.36687368e-02  4.02510339e-02]
 [-3.67414441e-01 -9.23990903e-01 -2.13005672e-01]
 [ 1.46753966e-01 -1.99273704e-01 -3.31468845e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.25151208 -29.28467519 -29.2776944 ]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  8.31409947  -9.26062741 -83.52111278]
init_Out:  [2.49223638]
Stock Position:  8.314099471154409
Bond position:  [-828.91771073]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [2.95846367]
curr_Stock_Price:  100.08100487900514
curr_Factors:  [100.08100488  -0.82573795  -0.99728122]
mat_Sqrt:  [[16.16681585  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0050145   0.00219244 -0.24955222]
Stock Position:  -0.005014500324381643
Bond Position:  [3.4603199]


portfolio before change:  [2.95449498]
curr_Stock_Price:  101.04498562757952
curr_Factors:  [101.04498563  -0.88186656  -0.99770408]
mat_Sqrt:  [[15.42508661  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01885088 -0.01589902  0.60304743]
Stock Position:  -0.018850878788477105
Bond Position:  [4.85928176]


portfolio before change:  [2.97211721]
curr_Stock_Price:  100.17461459980423
curr_Factors:  [100.1746146   -0.81469863  -0.97293784]
mat_Sqrt:  [[16.76474791  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00410967 -0.00889223 -0.34446307]
Stock Position:  -0.004109670920427134
Bond Position:  [3.38380191]


portfolio before change:  [2.97654861]
curr_Stock_Price:  99.30219766750372
curr_Factors:  [99.30219767 -0.84291131 -0.98358448]
mat_Sqrt:  [[15.98533785  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00411105 -0.05312443  0.39976764]
Stock Position:  -0.00411105379667662
Bond Position:  [3.38478529]


portfolio before change:  [2.98253379]
curr_Stock_Price:  98.05218282547479
curr_Factors:  [98.05218283 -0.73075537 -1.00025134]
mat_Sqrt:  [[17.36563239  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00392228  0.01240381 -0.02186063]
Stock Position:  -0.003922279907070305
Bond Position:  [3.3671219]


portfolio before change:  [2.9817447]
curr_Stock_Price:  98.46800593054299
curr_Factors:  [98.46800593 -0.56561282 -1.01045794]
mat_Sqrt:  [[20.36180654  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00358988 -0.01586077  0.15664362]
Stock Position:  -0.0035898754924368415
Bond Position:  [3.33523259]


portfolio before change:  [2.98210357]
curr_Stock_Price:  98.60033559635364
curr_Factors:  [98.6003356  -0.80939719 -1.00475406]
mat_Sqrt:  [[16.0695056   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00491008  0.03552189 -0.28087057]
Stock Position:  -0.004910083190301585
Bond Position:  [3.46623942]


portfolio before change:  [2.98414839]
curr_Stock_Price:  98.36039024647827
curr_Factors:  [98.36039025 -0.858153   -1.01163379]
mat_Sqrt:  [[15.16289608  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01315124 -0.0382607   0.72938952]
Stock Position:  -0.013151236911662941
Bond Position:  [4.27770918]


portfolio before change:  [2.9924167]
curr_Stock_Price:  97.81300837964972
curr_Factors:  [97.81300838 -0.96250612 -1.00853709]
mat_Sqrt:  [[13.62647195  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00341213 0.01119577 0.00573959]
Stock Position:  0.003412127665001778
Bond Position:  [2.65866623]


portfolio before change:  [2.99276372]
curr_Stock_Price:  97.71989011675248
curr_Factors:  [97.71989012 -0.8017311  -0.98536183]
mat_Sqrt:  [[16.36282825  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00078019 0.02938532 0.00559972]
Stock Position:  0.0007801859033480892
Bond Position:  [2.91652404]


portfolio before change:  [2.99336776]
curr_Stock_Price:  97.55943658011215
curr_Factors:  [97.55943658 -1.02392816 -0.97048297]
mat_Sqrt:  [[13.2772317   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00407119 -0.00290924 -0.3116112 ]
Stock Position:  -0.004071186988074482
Bond Position:  [3.39055047]


portfolio before change:  [3.00123552]
curr_Stock_Price:  95.83511948565473
curr_Factors:  [95.83511949 -0.9073669  -0.97542743]
mat_Sqrt:  [[14.58268526  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00441168 -0.08427992 -0.72303052]
Stock Position:  -0.004411683193345688
Bond Position:  [3.4240297]


portfolio before change:  [3.00052959]
curr_Stock_Price:  96.18918925377213
curr_Factors:  [96.18918925 -0.93132312 -1.02968147]
mat_Sqrt:  [[13.53545291  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00280545 -0.00360151  0.02657789]
Stock Position:  0.002805448185460166
Bond Position:  [2.7306758]


portfolio before change:  [3.00340785]
curr_Stock_Price:  96.97177625829652
curr_Factors:  [96.97177626 -1.17866112 -0.99342591]
mat_Sqrt:  [[11.04892277  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-1.42693645e-04 -1.93814560e-02 -2.36834615e-01]
Stock Position:  -0.00014269364520116894
Bond Position:  [3.01724511]


portfolio before change:  [3.00433666]
curr_Stock_Price:  95.7495577940322
curr_Factors:  [95.74955779 -1.09547001 -0.99035466]
mat_Sqrt:  [[11.89254026  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01289724  0.01113333 -0.26307807]
Stock Position:  0.012897242000235027
Bond Position:  [1.76943144]


portfolio before change:  [3.01106944]
curr_Stock_Price:  96.2372878575276
curr_Factors:  [96.23728786 -1.12039541 -1.00724007]
mat_Sqrt:  [[11.46365277  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00148164 0.01222811 0.24281414]
Stock Position:  0.0014816360547362172
Bond Position:  [2.86848081]


portfolio before change:  [3.01282268]
curr_Stock_Price:  96.93653152980656
curr_Factors:  [96.93653153 -0.61478429 -0.9817362 ]
mat_Sqrt:  [[19.63936474  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00265773 -0.00748471  0.114825  ]
Stock Position:  0.0026577321588146423
Bond Position:  [2.75519134]


portfolio before change:  [3.01180971]
curr_Stock_Price:  96.2961912570587
curr_Factors:  [96.29619126 -0.29764108 -0.97500618]
mat_Sqrt:  [[26.97152034  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01611891 -0.29219158 -0.60764589]
Stock Position:  -0.01611890537767021
Bond Position:  [4.5639989]


portfolio before change:  [3.05891618]
curr_Stock_Price:  93.44455072759463
curr_Factors:  [93.44455073 -0.60043818 -0.93565163]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [3.05891618]
Stock Price:  92.50342386163905
PL:  [3.05891618]
Settle:  Tensor("sub_326:0", shape=(), dtype=float64)
PL:  Tensor("sub_327:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  164
output_Z_Vals[:, i, :]:  [[ 1.19251512e+02 -2.92846752e+01 -2.92776944e+01]
 [-5.45003731e-02 -1.98719648e-02 -9.93178616e-02]
 [-5.35599957e-01 -9.44879656e-02  3.83696105e-01]
 [-4.96128843e-02 -5.43209737e-02 -1.94946476e-01]
 [-9.88296441e-02 -2.41910939e-01  2.15109929e-01]
 [-2.34425346e-01 -2.37148592e-03  1.81637208e-02]
 [ 5.34807662e-02  6.89568991e-02 -3.19039311e-02]
 [-1.40266084e-01  2.18932278e-01 -7.96069014e-02]
 [-8.64883301e-02 -4.47184064e-02  8.35926721e-02]
 [ 5.40607476e-02  5.19081745e-02 -1.00889950e-02]
 [-1.00020806e-02  1.01717962e-01  9.41366855e-03]
 [-6.74547814e-03 -9.85926544e-03 -1.25113306e-01]
 [-9.72906061e-03 -2.35689563e-01 -4.80414069e-01]
 [-8.39023326e-02  2.99356644e-02 -3.44848003e-02]
 [-6.21861054e-02 -2.14006683e-02  7.57462083e-02]
 [-5.80924054e-02 -1.26476939e-01  1.47137964e-01]
 [-2.42984765e-02  1.47590698e-02  1.82449211e-01]
 [-1.90156555e-01  2.95410589e-01 -9.61639342e-02]
 [-3.21196262e-01 -9.65551418e-01 -1.74356815e-01]
 [ 1.04326318e-01 -7.16036447e-02 -1.41277702e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.25151208 -29.28467519 -29.2776944 ]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  8.31409947  -9.26062741 -83.52111278]
init_Out:  [2.49223638]
Stock Position:  8.314099471154409
Bond position:  [-828.91771073]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [4.49179565]
curr_Stock_Price:  100.2654303818882
curr_Factors:  [100.26543038  -1.17691604  -0.99688215]
mat_Sqrt:  [[11.40466839  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00660139 -0.00628407 -0.28332621]
Stock Position:  -0.006601387793055591
Bond Position:  [5.15368664]


portfolio before change:  [4.48058903]
curr_Stock_Price:  102.15824457045814
curr_Factors:  [102.15824457  -1.14231308  -0.99584123]
mat_Sqrt:  [[12.04161683  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.03817743 -0.02987972  1.09457819]
Stock Position:  -0.03817743024566737
Bond Position:  [8.38072829]


portfolio before change:  [4.54783136]
curr_Stock_Price:  100.45182056536107
curr_Factors:  [100.45182057  -0.69488964  -0.97888427]
mat_Sqrt:  [[18.83853114  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00482037 -0.0171778  -0.55612803]
Stock Position:  -0.004820372037553411
Bond Position:  [5.03204651]


portfolio before change:  [4.5438285]
curr_Stock_Price:  101.54323627277131
curr_Factors:  [101.54323627  -0.99334487  -1.02001251]
mat_Sqrt:  [[13.56004102  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0045108  -0.07649896  0.61364875]
Stock Position:  -0.004510799574941658
Bond Position:  [5.00186968]


portfolio before change:  [4.54004616]
curr_Stock_Price:  102.65899551975184
curr_Factors:  [102.65899552  -1.05349547  -0.99677297]
mat_Sqrt:  [[13.21224867  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01746704 -0.00074993  0.05181604]
Stock Position:  -0.017467043588465035
Bond Position:  [6.3331953]


portfolio before change:  [4.5383426]
curr_Stock_Price:  102.84718160516248
curr_Factors:  [102.84718161  -1.3530819   -0.98989761]
mat_Sqrt:  [[ 9.87755194  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00493532  0.02180609 -0.09101303]
Stock Position:  0.00493531831854144
Bond Position:  [4.03075902]


portfolio before change:  [4.53939293]
curr_Stock_Price:  102.8557955930525
curr_Factors:  [102.85579559  -1.25850344  -1.02627464]
mat_Sqrt:  [[10.47037546  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01440855  0.06923247 -0.22709633]
Stock Position:  -0.014408553706942669
Bond Position:  [6.02139618]


portfolio before change:  [4.55958167]
curr_Stock_Price:  101.55912110103684
curr_Factors:  [101.5591211   -0.93289906  -1.03693445]
mat_Sqrt:  [[14.16547394  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00498251 -0.0141412   0.23846663]
Stock Position:  -0.004982513955750203
Bond Position:  [5.06560141]


portfolio before change:  [4.57222505]
curr_Stock_Price:  99.27576993221268
curr_Factors:  [99.27576993 -0.73157812 -1.03438006]
mat_Sqrt:  [[16.97842394  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00314173  0.01641481 -0.02878109]
Stock Position:  0.0031417287989756503
Bond Position:  [4.26032751]


portfolio before change:  [4.56595215]
curr_Stock_Price:  96.9400741182006
curr_Factors:  [96.94007412 -0.72805351 -0.97989452]
mat_Sqrt:  [[17.56915767  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00031044  0.03216604  0.02685458]
Stock Position:  -0.00031044044371903893
Bond Position:  [4.59604627]


portfolio before change:  [4.5671845]
curr_Stock_Price:  96.67207317522805
curr_Factors:  [96.67207318 -0.53402799 -0.97624804]
mat_Sqrt:  [[21.34993157  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00152407 -0.00311777 -0.35691344]
Stock Position:  -0.0015240653022000053
Bond Position:  [4.71451905]


portfolio before change:  [4.56751357]
curr_Stock_Price:  97.22959872535134
curr_Factors:  [97.22959873 -0.10242111 -0.93672082]
mat_Sqrt:  [[34.39575798  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00331083 -0.07453158 -1.37048762]
Stock Position:  -0.0033108341496203187
Bond Position:  [4.88942465]


portfolio before change:  [4.55821515]
curr_Stock_Price:  100.40732815586077
curr_Factors:  [100.40732816  -0.33192973  -0.93348259]
mat_Sqrt:  [[28.32721143  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00318311  0.00946649 -0.09837554]
Stock Position:  -0.0031831081454092433
Bond Position:  [4.87782253]


portfolio before change:  [4.55837119]
curr_Stock_Price:  100.74145722788546
curr_Factors:  [100.74145723  -0.24988259  -0.93567035]
mat_Sqrt:  [[30.7842892   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00153575 -0.00676749  0.21608285]
Stock Position:  -0.001535752148336083
Bond Position:  [4.71308509]


portfolio before change:  [4.55515103]
curr_Stock_Price:  103.60557312634364
curr_Factors:  [103.60557313  -0.67305419  -0.91775148]
mat_Sqrt:  [[21.11081475  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00148377 -0.03999552  0.41974366]
Stock Position:  -0.0014837710059294007
Bond Position:  [4.70887798]


portfolio before change:  [4.55669474]
curr_Stock_Price:  103.35867588409643
curr_Factors:  [103.35867588  -0.79442906  -0.91061047]
mat_Sqrt:  [[18.7870104   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00070926 0.00466723 0.52047681]
Stock Position:  0.0007092608118193332
Bond Position:  [4.48338648]


portfolio before change:  [4.56007415]
curr_Stock_Price:  106.54287523289717
curr_Factors:  [106.54287523  -0.56366292  -0.9163183 ]
mat_Sqrt:  [[24.25362918  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00833518  0.09341703 -0.27432894]
Stock Position:  -0.008335184216219132
Bond Position:  [5.44812864]


portfolio before change:  [4.57103335]
curr_Stock_Price:  105.39149132778063
curr_Factors:  [105.39149133  -0.69665999  -0.90929206]
mat_Sqrt:  [[21.15190244  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01804647 -0.30533417 -0.49739146]
Stock Position:  -0.01804646791037712
Bond Position:  [6.47297752]


portfolio before change:  [4.57334282]
curr_Stock_Price:  105.35320020439674
curr_Factors:  [105.3532002   -0.65105373  -0.9196049 ]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [4.57334282]
Stock Price:  106.18144960982073
PL:  [-1.60810679]
Settle:  Tensor("sub_328:0", shape=(), dtype=float64)
PL:  Tensor("sub_329:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  165
output_Z_Vals[:, i, :]:  [[ 1.19251512e+02 -2.92846752e+01 -2.92776944e+01]
 [-3.76556813e-01  1.18281118e-01  2.68151318e-01]
 [-3.66784906e-01 -1.04809386e-01  3.28668214e-01]
 [-5.78390136e-02  2.65427912e-02  2.02618982e-02]
 [-8.36235782e-02 -1.14844174e-01  8.62249769e-02]
 [-2.61540133e-01  1.28875562e-01  3.37900623e-03]
 [-3.09308044e-01 -3.11356802e-01  2.38498989e-01]
 [ 1.95720012e-04 -1.07643961e-02 -9.05541251e-02]
 [-2.68111171e-01 -1.39331812e-01  2.98431075e-01]
 [ 1.01668017e-03 -1.68079674e-02  1.84562905e-02]
 [-8.70862121e-02  1.35959678e-01  2.91528595e-02]
 [-5.94419170e-02 -9.41345123e-03 -1.20841206e-01]
 [-1.59034150e-02 -3.23154502e-01 -2.17065118e-01]
 [ 5.15072830e-02 -2.03251407e-02  1.20583570e-02]
 [ 1.11348156e-02 -5.79141975e-02 -1.09473076e-01]
 [ 1.66600808e-01  2.57699187e-02 -6.65971830e-02]
 [ 2.27014975e-02 -3.61632187e-02  1.11439096e-01]
 [ 4.16196696e-02 -2.49874608e-02  6.99696018e-02]
 [-3.41154924e-01 -8.71707080e-01 -1.69845391e-01]
 [ 9.59483356e-02 -8.90857368e-02 -1.52441195e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.25151208 -29.28467519 -29.2776944 ]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  8.31409947  -9.26062741 -83.52111278]
init_Out:  [2.49223638]
Stock Position:  8.314099471154409
Bond position:  [-828.91771073]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-7.77916521]
curr_Stock_Price:  98.78950855731678
curr_Factors:  [98.78950856 -1.38179219 -0.97579953]
mat_Sqrt:  [[ 9.35021838  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.03409189  0.03740377  0.76496107]
Stock Position:  -0.03409189352741942
Bond Position:  [-4.4112438]


portfolio before change:  [-7.71586706]
curr_Stock_Price:  96.90046411354218
curr_Factors:  [96.90046411 -1.29779723 -0.95211462]
mat_Sqrt:  [[10.21413406  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02960623 -0.03314364  0.93759893]
Stock Position:  -0.02960622531465351
Bond Position:  [-4.84701009]


portfolio before change:  [-7.71017793]
curr_Stock_Price:  96.66737019131638
curr_Factors:  [96.66737019 -0.97287447 -0.955763  ]
mat_Sqrt:  [[14.05022544  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00377344  0.00839357  0.05780156]
Stock Position:  -0.0037734440091927164
Bond Position:  [-7.34540902]


portfolio before change:  [-7.71121763]
curr_Stock_Price:  96.45618947295105
curr_Factors:  [96.45618947 -0.69445768 -1.00543779]
mat_Sqrt:  [[17.62279864  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00391472 -0.03631692  0.24597586]
Stock Position:  -0.003914715462469476
Bond Position:  [-7.3336191]


portfolio before change:  [-7.7013555]
curr_Stock_Price:  93.46854782698385
curr_Factors:  [93.46854783 -0.48283587 -0.96962747]
mat_Sqrt:  [[21.87100211  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01177462  0.04075403  0.00963936]
Stock Position:  -0.011774624805707323
Bond Position:  [-6.60079842]


portfolio before change:  [-7.71330755]
curr_Stock_Price:  94.34345009393344
curr_Factors:  [94.34345009 -0.50782296 -0.95657066]
mat_Sqrt:  [[21.81391848  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01231617 -0.09845967  0.68037123]
Stock Position:  -0.01231616594084508
Bond Position:  [-6.55135797]


portfolio before change:  [-7.7280371]
curr_Stock_Price:  95.40640276373931
curr_Factors:  [95.40640276 -0.60441408 -1.00704073]
mat_Sqrt:  [[19.04283433  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00097499 -0.003404   -0.25832571]
Stock Position:  -0.0009749861051766652
Bond Position:  [-7.63501718]


portfolio before change:  [-7.73209244]
curr_Stock_Price:  97.60781527430915
curr_Factors:  [97.60781527 -0.72538285 -1.05652828]
mat_Sqrt:  [[16.42897332  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01283049 -0.04406059  0.85134079]
Stock Position:  -0.012830486177494162
Bond Position:  [-6.47973671]


portfolio before change:  [-7.71317045]
curr_Stock_Price:  96.00677463353982
curr_Factors:  [96.00677463 -0.79396831 -1.04587455]
mat_Sqrt:  [[15.24994509  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00028525 -0.00531515  0.05265066]
Stock Position:  0.0002852518361118708
Bond Position:  [-7.74055655]


portfolio before change:  [-7.7154327]
curr_Stock_Price:  94.8608479582415
curr_Factors:  [94.86084796 -0.83535742 -1.03800084]
mat_Sqrt:  [[14.57128488  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00532725  0.04299423  0.08316499]
Stock Position:  -0.005327254694630488
Bond Position:  [-7.21008481]


portfolio before change:  [-7.72445299]
curr_Stock_Price:  96.21568007042933
curr_Factors:  [96.21568007 -0.77572636 -1.04370075]
mat_Sqrt:  [[15.59835149  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00540772 -0.00297679 -0.34472632]
Stock Position:  -0.005407723962204245
Bond Position:  [-7.20414515]


portfolio before change:  [-7.71886704]
curr_Stock_Price:  94.84963307801502
curr_Factors:  [94.84963308 -0.94935729 -0.96665948]
mat_Sqrt:  [[13.96111632  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00491046 -0.10219043 -0.61922636]
Stock Position:  -0.004910456897588536
Bond Position:  [-7.25311201]


portfolio before change:  [-7.72523129]
curr_Stock_Price:  95.77637784493986
curr_Factors:  [95.77637784 -0.84540777 -0.97538115]
mat_Sqrt:  [[15.50600183  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00344666 -0.00642737  0.03439914]
Stock Position:  0.003446658430209922
Bond Position:  [-8.05533975]


portfolio before change:  [-7.72807407]
curr_Stock_Price:  95.53594259097197
curr_Factors:  [95.53594259 -1.02294222 -0.94676989]
mat_Sqrt:  [[13.32697834  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00095345 -0.01831408 -0.31229621]
Stock Position:  -0.0009534509878414189
Bond Position:  [-7.63698523]


portfolio before change:  [-7.73083623]
curr_Stock_Price:  96.43023901179465
curr_Factors:  [96.43023901 -1.36711129 -0.9313864 ]
mat_Sqrt:  [[ 9.68251946  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01587109  0.00814916 -0.18998323]
Stock Position:  0.015871085171180705
Bond Position:  [-9.26128876]


portfolio before change:  [-7.74858893]
curr_Stock_Price:  95.45758414646046
curr_Factors:  [95.45758415 -1.38319432 -0.90473723]
mat_Sqrt:  [[ 9.68666745  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00459551 -0.01143581  0.31790472]
Stock Position:  0.004595510034575775
Bond Position:  [-8.18726521]


portfolio before change:  [-7.7530103]
curr_Stock_Price:  94.94092691776014
curr_Factors:  [94.94092692 -1.08273123 -0.90277823]
mat_Sqrt:  [[13.03639963  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00423867 -0.00790173  0.1996038 ]
Stock Position:  0.004238668868689047
Bond Position:  [-8.15543345]


portfolio before change:  [-7.74386406]
curr_Stock_Price:  97.579811218653
curr_Factors:  [97.57981122 -0.62409531 -0.97575633]
mat_Sqrt:  [[19.70394709  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02021584 -0.27565798 -0.48452162]
Stock Position:  -0.020215840373789578
Bond Position:  [-5.77120617]


portfolio before change:  [-7.76879576]
curr_Stock_Price:  98.74170801137345
curr_Factors:  [98.74170801 -0.94757379 -0.97492782]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-7.76879576]
Stock Price:  98.18839851037113
PL:  [-7.76879576]
Settle:  Tensor("sub_330:0", shape=(), dtype=float64)
PL:  Tensor("sub_331:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  166
output_Z_Vals[:, i, :]:  [[ 1.19251512e+02 -2.92846752e+01 -2.92776944e+01]
 [-3.20375603e-01  1.15058383e-01  3.03158272e-01]
 [-6.98813025e-02  2.10768740e-02  1.00049614e-01]
 [-4.77814488e-02 -2.33680475e-02 -1.08069257e-01]
 [-9.70782505e-02 -2.27275732e-01  2.00265309e-01]
 [-5.09295347e-02 -6.88282554e-02 -9.41030514e-04]
 [ 2.38877965e-04  3.55719335e-03  8.63027640e-03]
 [-1.23233474e-01  1.80756152e-01 -5.21305765e-02]
 [-3.41925174e-01 -1.48463042e-01  3.15180606e-01]
 [ 4.30187559e-02  3.34153416e-02  2.65038918e-03]
 [ 4.02969761e-02  8.17856939e-02 -1.21579883e-02]
 [ 8.49698685e-02 -1.06429177e-02 -1.34734517e-01]
 [ 1.13543044e-02 -1.54805511e-01 -4.43844937e-01]
 [ 7.72600980e-02 -4.47676615e-02  4.46810879e-03]
 [ 1.11348156e-02 -5.79141975e-02 -1.09473076e-01]
 [ 1.69580698e-01  3.21207946e-02 -8.33968633e-02]
 [-2.35647895e-02  1.03259148e-01  6.82888801e-02]
 [ 4.35452492e-02 -2.24292880e-02  3.75100201e-02]
 [-3.53422678e-01 -8.89447009e-01 -1.86249710e-01]
 [ 1.39710068e-01 -1.85417280e-01 -3.08775988e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.25151208 -29.28467519 -29.2776944 ]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  8.31409947  -9.26062741 -83.52111278]
init_Out:  [2.49223638]
Stock Position:  8.314099471154409
Bond position:  [-828.91771073]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-12.27969898]
curr_Stock_Price:  98.24819511935081
curr_Factors:  [98.24819512 -0.88971782 -0.99366037]
mat_Sqrt:  [[14.94114314  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01710196  0.03638466  0.86482617]
Stock Position:  -0.017101963506265895
Bond Position:  [-10.59946193]


portfolio before change:  [-12.3019863]
curr_Stock_Price:  99.39643318867486
curr_Factors:  [99.39643319 -0.85678285 -0.96019027]
mat_Sqrt:  [[16.15360292  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00302809  0.00666509  0.2854137 ]
Stock Position:  -0.0030280896604650597
Bond Position:  [-12.00100499]


portfolio before change:  [-12.30653763]
curr_Stock_Price:  99.90853995662575
curr_Factors:  [99.90853996 -0.58895248 -1.00534183]
mat_Sqrt:  [[20.28660585  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00347246 -0.00738963 -0.30829151]
Stock Position:  -0.0034724563740860816
Bond Position:  [-11.95960959]


portfolio before change:  [-12.31033078]
curr_Stock_Price:  100.13975137520498
curr_Factors:  [100.13975138  -0.51208613  -1.02628916]
mat_Sqrt:  [[21.50297807  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00288646 -0.0718709   0.57130118]
Stock Position:  -0.0028864606357664017
Bond Position:  [-12.02128133]


portfolio before change:  [-12.31470431]
curr_Stock_Price:  100.61363042210537
curr_Factors:  [100.61363042  -0.57217029  -1.05476808]
mat_Sqrt:  [[19.77363275  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00267522 -0.02176541 -0.0026845 ]
Stock Position:  -0.0026752170598629017
Bond Position:  [-12.04554101]


portfolio before change:  [-12.31508404]
curr_Stock_Price:  99.6297714740222
curr_Factors:  [ 9.96297715e+01 -9.79699453e-02 -1.10323190e+00]
mat_Sqrt:  [[29.97186718  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [6.98112027e-05 1.12488331e-03 2.46197764e-02]
Stock Position:  6.98112027433507e-05
Bond Position:  [-12.32203931]


portfolio before change:  [-12.31806315]
curr_Stock_Price:  101.08773686098344
curr_Factors:  [101.08773686  -0.11363251  -1.09488858]
mat_Sqrt:  [[30.18870149  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00427999  0.05716011 -0.14871402]
Stock Position:  -0.004279994621593756
Bond Position:  [-11.88540818]


portfolio before change:  [-12.3111374]
curr_Stock_Price:  98.77524066383434
curr_Factors:  [ 9.87752407e+01 -8.80562262e-02 -1.08180726e+00]
mat_Sqrt:  [[30.66075479  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00917859 -0.04694814  0.89912254]
Stock Position:  -0.009178590131083091
Bond Position:  [-11.40451995]


portfolio before change:  [-12.30097647]
curr_Stock_Price:  97.35754844186832
curr_Factors:  [97.35754844 -0.28785425 -1.05988432]
mat_Sqrt:  [[25.29613722  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.0017561  0.01056686 0.00756082]
Stock Position:  0.001756099928727559
Bond Position:  [-12.47194606]


portfolio before change:  [-12.30114456]
curr_Stock_Price:  99.03757066220147
curr_Factors:  [99.03757066 -0.26963347 -1.09658617]
mat_Sqrt:  [[25.26145305  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00158055  0.02586291 -0.03468336]
Stock Position:  0.0015805478242970547
Bond Position:  [-12.45767818]


portfolio before change:  [-12.30647376]
curr_Stock_Price:  97.6365465419031
curr_Factors:  [97.63654654 -0.16265137 -1.0835391 ]
mat_Sqrt:  [[28.08010744  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00203676 -0.00336559 -0.38436007]
Stock Position:  0.0020367622009716097
Bond Position:  [-12.50533618]


portfolio before change:  [-12.30842599]
curr_Stock_Price:  98.21319145073288
curr_Factors:  [98.21319145 -0.38412648 -1.03929312]
mat_Sqrt:  [[23.6584641   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0035185  -0.0489538  -1.26616606]
Stock Position:  -0.003518496586783643
Bond Position:  [-11.96286321]


portfolio before change:  [-12.29780272]
curr_Stock_Price:  94.34382299964277
curr_Factors:  [94.343823   -0.28080448 -0.99926265]
mat_Sqrt:  [[26.22934092  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00293626 -0.01415678  0.01274627]
Stock Position:  0.0029362632888410775
Bond Position:  [-12.57482103]


portfolio before change:  [-12.30492972]
curr_Stock_Price:  92.98737107226685
curr_Factors:  [ 9.29873711e+01 -6.83456265e-02 -9.84259915e-01]
mat_Sqrt:  [[32.45511789  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00039151 -0.01831408 -0.31229621]
Stock Position:  -0.00039151361901286724
Bond Position:  [-12.2685239]


portfolio before change:  [-12.30944948]
curr_Stock_Price:  96.69666922274664
curr_Factors:  [96.69666922 -0.22018013 -0.95687182]
mat_Sqrt:  [[29.80055467  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00514711  0.01015749 -0.23790804]
Stock Position:  0.005147110243224188
Bond Position:  [-12.80715789]


portfolio before change:  [-12.31019917]
curr_Stock_Price:  97.17314892281934
curr_Factors:  [97.17314892 -0.36036098 -0.97939773]
mat_Sqrt:  [[25.45050842  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00027344  0.03265341  0.19480917]
Stock Position:  -0.00027344210145547547
Bond Position:  [-12.28362794]


portfolio before change:  [-12.31322922]
curr_Stock_Price:  97.02231324105303
curr_Factors:  [97.02231324 -0.59620036 -1.0388649 ]
mat_Sqrt:  [[18.91349579  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00267655 -0.00709276  0.10700565]
Stock Position:  0.0026765452983697215
Bond Position:  [-12.57291383]


portfolio before change:  [-12.31858099]
curr_Stock_Price:  96.19731228677671
curr_Factors:  [96.19731229 -0.50168154 -1.02523089]
mat_Sqrt:  [[20.89456321  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01983321 -0.28126784 -0.53131858]
Stock Position:  -0.019833205374573174
Bond Position:  [-10.41067994]


portfolio before change:  [-12.28079618]
curr_Stock_Price:  94.16093919003295
curr_Factors:  [94.16093919 -0.30551803 -1.00265348]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-12.28079618]
Stock Price:  96.42575862894753
PL:  [-12.28079618]
Settle:  Tensor("sub_332:0", shape=(), dtype=float64)
PL:  Tensor("sub_333:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  167
output_Z_Vals[:, i, :]:  [[ 1.19251512e+02 -2.92846752e+01 -2.92776944e+01]
 [-1.74565312e-01  4.95721749e-02  4.14722886e-02]
 [-4.24636637e-01 -7.04756959e-02  2.88252809e-01]
 [ 1.35866962e-01 -1.63567838e-01 -4.77038894e-01]
 [-9.88296441e-02 -2.41910939e-01  2.15109929e-01]
 [-7.18307665e-01  3.28380721e-01 -2.24401301e-02]
 [ 5.10615817e-02  1.09206178e-01 -4.76883669e-02]
 [-3.25914055e-01  5.91591727e-01  6.72140870e-02]
 [-1.40109367e-01 -4.89122092e-02  7.87294137e-02]
 [-3.24485936e-01 -2.76888747e-01 -1.06464270e-01]
 [ 4.33787124e-01 -3.45051498e-01 -1.99351877e-01]
 [-1.41436929e-01  1.99755170e-01  2.30539809e-01]
 [ 4.31096942e-02 -8.40492350e-03 -8.35305816e-02]
 [ 1.92952599e-02  9.20548005e-03  1.47182259e-01]
 [-2.51996623e-01  2.54895232e-01  4.30540968e-01]
 [-2.56547695e-01 -4.76394507e-01  3.11316323e-01]
 [-8.51798549e-02 -2.27052916e-01  2.17528109e-01]
 [-3.16999878e-01  4.77274789e-01 -8.05611602e-02]
 [-3.00355361e-01 -1.09871136e+00 -1.74878661e-01]
 [ 1.05616722e-01 -5.01538376e-02 -1.21153001e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.25151208 -29.28467519 -29.2776944 ]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  8.31409947  -9.26062741 -83.52111278]
init_Out:  [2.49223638]
Stock Position:  8.314099471154409
Bond position:  [-828.91771073]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-3.47110728]
curr_Stock_Price:  99.30767146156191
curr_Factors:  [99.30767146 -0.93212402 -1.01938465]
mat_Sqrt:  [[14.10760702  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01168305  0.0156761   0.1183089 ]
Stock Position:  -0.011683049290793213
Bond Position:  [-2.31089086]


portfolio before change:  [-3.4998733]
curr_Stock_Price:  101.72041699941067
curr_Factors:  [101.720417    -0.74985006  -1.04028789]
mat_Sqrt:  [[16.98091544  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02164883 -0.02228637  0.82230503]
Stock Position:  -0.021648830115563778
Bond Position:  [-1.29774528]


portfolio before change:  [-3.54451345]
curr_Stock_Price:  103.76744091345203
curr_Factors:  [103.76744091  -0.64958904  -1.03471214]
mat_Sqrt:  [[19.25654616  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00177958 -0.05172469 -1.36085918]
Stock Position:  0.0017795767619925784
Bond Position:  [-3.72917558]


portfolio before change:  [-3.54393869]
curr_Stock_Price:  104.61437171223862
curr_Factors:  [104.61437171  -0.34336602  -1.06092399]
mat_Sqrt:  [[25.68715182  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00238121 -0.07649896  0.61364875]
Stock Position:  -0.0023812148459522327
Bond Position:  [-3.29482939]


portfolio before change:  [-3.54910647]
curr_Stock_Price:  106.43863775325507
curr_Factors:  [106.43863775  -0.4376048   -1.04977152]
mat_Sqrt:  [[24.05137886  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02970347  0.1038431  -0.06401545]
Stock Position:  -0.029703473064671398
Bond Position:  [-0.38750926]


portfolio before change:  [-3.57036636]
curr_Stock_Price:  107.15111362711635
curr_Factors:  [107.15111363  -0.45652135  -1.09218745]
mat_Sqrt:  [[22.77199087  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00193865  0.03453403 -0.13604164]
Stock Position:  0.001938650257827116
Bond Position:  [-3.7780949]


portfolio before change:  [-3.56366908]
curr_Stock_Price:  111.09299341798243
curr_Factors:  [111.09299342  -0.78295694  -1.14014703]
mat_Sqrt:  [[16.23653024  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01828711  0.18707773  0.19174308]
Stock Position:  -0.01828710933286991
Bond Position:  [-1.53209936]


portfolio before change:  [-3.56426367]
curr_Stock_Price:  111.10456011894539
curr_Factors:  [111.10456012  -1.23769125  -1.16349834]
mat_Sqrt:  [[10.06719538  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01244654 -0.0154674   0.2245931 ]
Stock Position:  -0.01244653509073345
Bond Position:  [-2.18139687]


portfolio before change:  [-3.57985656]
curr_Stock_Price:  112.31352843745942
curr_Factors:  [112.31352844  -1.40063109  -1.17344005]
mat_Sqrt:  [[ 8.56105287  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.04127613 -0.08755991 -0.30371293]
Stock Position:  -0.041276126445038766
Bond Position:  [1.05601084]


portfolio before change:  [-3.59738783]
curr_Stock_Price:  112.7446567535304
curr_Factors:  [112.74465675  -1.17280654  -1.18099259]
mat_Sqrt:  [[10.71159133  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.03586632 -0.10911486 -0.56869542]
Stock Position:  0.035866323618983176
Bond Position:  [-7.64112417]


portfolio before change:  [-3.60230135]
curr_Stock_Price:  112.66092913547361
curr_Factors:  [112.66092914  -0.91539856  -1.15054098]
mat_Sqrt:  [[14.27404914  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00625054  0.06316813  0.6576659 ]
Stock Position:  -0.006250541155300275
Bond Position:  [-2.89810958]


portfolio before change:  [-3.60374653]
curr_Stock_Price:  112.77620953703499
curr_Factors:  [112.77620954  -0.78160813  -1.1327666 ]
mat_Sqrt:  [[16.62704658  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00155422 -0.00265787 -0.2382895 ]
Stock Position:  0.0015542189811528118
Bond Position:  [-3.77902546]


portfolio before change:  [-3.60706811]
curr_Stock_Price:  111.24701653533258
curr_Factors:  [111.24701654  -0.80689848  -1.1067613 ]
mat_Sqrt:  [[16.41332193  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.0030205  0.00291103 0.41987002]
Stock Position:  0.0030204974538768983
Bond Position:  [-3.94308944]


portfolio before change:  [-3.60861714]
curr_Stock_Price:  111.06057741237636
curr_Factors:  [111.06057741  -0.83038568  -1.07670081]
mat_Sqrt:  [[16.49387849  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0095509   0.08060495  1.22821354]
Stock Position:  -0.009550903956130022
Bond Position:  [-2.54788823]


portfolio before change:  [-3.60830814]
curr_Stock_Price:  110.96152340580137
curr_Factors:  [110.96152341  -1.11953206  -1.08459998]
mat_Sqrt:  [[12.24418902  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01676722 -0.15064917  0.88809882]
Stock Position:  -0.016767216683217005
Bond Position:  [-1.74779223]


portfolio before change:  [-3.61596551]
curr_Stock_Price:  111.39214786495319
curr_Factors:  [111.39214786  -1.01987437  -1.05347907]
mat_Sqrt:  [[14.00904793  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00332925 -0.07180044  0.62054715]
Stock Position:  -0.003329248128851403
Bond Position:  [-3.24511341]


portfolio before change:  [-3.61313677]
curr_Stock_Price:  110.29877120788551
curr_Factors:  [110.29877121  -0.82664078  -1.08305428]
mat_Sqrt:  [[16.33806603  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01965478  0.15092754 -0.22981857]
Stock Position:  -0.019654784942015658
Bond Position:  [-1.44523814]


portfolio before change:  [-3.6352187]
curr_Stock_Price:  111.40387499818749
curr_Factors:  [111.403875    -0.83904476  -1.12200486]
mat_Sqrt:  [[15.67571168  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02324749 -0.34744304 -0.49888014]
Stock Position:  -0.023247488283807276
Bond Position:  [-1.04535843]


portfolio before change:  [-3.56826458]
curr_Stock_Price:  108.51257364123772
curr_Factors:  [108.51257364  -0.72239307  -1.10683544]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-3.56826458]
Stock Price:  108.57996018583714
PL:  [-12.14822477]
Settle:  Tensor("sub_334:0", shape=(), dtype=float64)
PL:  Tensor("sub_335:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  168
output_Z_Vals[:, i, :]:  [[ 1.19251512e+02 -2.92846752e+01 -2.92776944e+01]
 [-2.27127186e-01  7.64405434e-02  1.60861166e-01]
 [-2.36400793e-01 -2.41445963e-02  1.70615308e-01]
 [-5.99537735e-02 -9.84756982e-02 -3.19707006e-01]
 [-9.88296441e-02 -2.41910939e-01  2.15109929e-01]
 [-1.57828741e-01 -7.31199934e-02  3.08099289e-02]
 [ 5.56765101e-02  3.24251220e-02 -1.75773763e-02]
 [-1.10306835e-01  1.81337897e-01 -8.81170646e-02]
 [-7.51176389e-02 -4.20094659e-02  7.78783310e-02]
 [ 4.50470017e-02  4.74936917e-02 -1.18045691e-02]
 [ 1.67209473e-02  9.15637251e-02 -3.99997167e-03]
 [ 7.97766528e-02 -1.00384109e-02 -1.23731478e-01]
 [ 1.24845232e-02 -1.54745031e-01 -4.20563792e-01]
 [-3.60087306e-02  1.32073415e-02 -2.37735486e-02]
 [-2.34316316e-02 -4.48964520e-02  2.69867209e-02]
 [ 3.37444539e-02 -1.00634794e-02  8.93728190e-02]
 [-2.35647895e-02  1.03259148e-01  6.82888801e-02]
 [ 3.90985388e-02 -1.71593815e-02  2.58557383e-02]
 [-3.57733330e-01 -9.21700428e-01 -1.79921147e-01]
 [ 9.60389524e-02 -8.92939829e-02 -1.52710330e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.25151208 -29.28467519 -29.2776944 ]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  8.31409947  -9.26062741 -83.52111278]
init_Out:  [2.49223638]
Stock Position:  8.314099471154409
Bond position:  [-828.91771073]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-6.20407159]
curr_Stock_Price:  98.97895705060895
curr_Factors:  [98.97895705 -1.00510604 -1.03287063]
mat_Sqrt:  [[12.89617297  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01491278  0.02417262  0.45889213]
Stock Position:  -0.014912784736687267
Bond Position:  [-4.72801971]


portfolio before change:  [-6.22122559]
curr_Stock_Price:  100.04997379561539
curr_Factors:  [100.0499738   -1.18136857  -1.02155846]
mat_Sqrt:  [[11.05345191  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0182927  -0.00763519  0.48671798]
Stock Position:  -0.01829270181710973
Bond Position:  [-4.39104125]


portfolio before change:  [-6.24465474]
curr_Stock_Price:  101.27074773283931
curr_Factors:  [101.27074773  -1.28809094  -1.01763182]
mat_Sqrt:  [[10.09534922  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01265497 -0.03114075 -0.9120351 ]
Stock Position:  -0.01265496831251639
Bond Position:  [-4.96307664]


portfolio before change:  [-6.2492006]
curr_Stock_Price:  101.5319044968857
curr_Factors:  [101.5319045   -1.69568558  -1.02281967]
mat_Sqrt:  [[ 6.69839419  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00913154 -0.07649896  0.61364875]
Stock Position:  -0.009131535930999718
Bond Position:  [-5.32205836]


portfolio before change:  [-6.25668792]
curr_Stock_Price:  102.20612242103132
curr_Factors:  [102.20612242  -1.40468823  -1.01731262]
mat_Sqrt:  [[ 9.0701675   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01691563 -0.02312257  0.08789215]
Stock Position:  -0.016915634740848385
Bond Position:  [-4.52780649]


portfolio before change:  [-6.2428403]
curr_Stock_Price:  101.32056821824345
curr_Factors:  [101.32056822  -1.10859276  -0.9705253 ]
mat_Sqrt:  [[12.66916853  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00417752  0.01025372 -0.05014336]
Stock Position:  0.004177524055051692
Bond Position:  [-6.66610941]


portfolio before change:  [-6.24440297]
curr_Stock_Price:  101.3454785754319
curr_Factors:  [101.34547858  -1.14881877  -0.95865407]
mat_Sqrt:  [[12.31800995  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01003502  0.05734408 -0.25137346]
Stock Position:  -0.010035024467669837
Bond Position:  [-5.22739862]


portfolio before change:  [-6.243402]
curr_Stock_Price:  101.11548547123088
curr_Factors:  [101.11548547  -1.23482357  -1.01751735]
mat_Sqrt:  [[10.6325746   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00567177 -0.01328456  0.2221652 ]
Stock Position:  -0.005671765599637375
Bond Position:  [-5.66989867]


portfolio before change:  [-6.23682321]
curr_Stock_Price:  99.70561663360584
curr_Factors:  [99.70561663 -1.1821198  -1.02806506]
mat_Sqrt:  [[10.93574902  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00401104  0.01501882 -0.03367515]
Stock Position:  0.004011036274452487
Bond Position:  [-6.63674605]


portfolio before change:  [-6.2432744]
curr_Stock_Price:  98.51096317064034
curr_Factors:  [98.51096317 -1.03928249 -1.02557804]
mat_Sqrt:  [[12.49473448  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00146211  0.02895499 -0.01141081]
Stock Position:  0.0014621056398188112
Bond Position:  [-6.38730783]


portfolio before change:  [-6.24396576]
curr_Stock_Price:  99.13038662545816
curr_Factors:  [99.13038663 -0.71299792 -1.06757674]
mat_Sqrt:  [[16.70756079  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00324768 -0.00317442 -0.35297147]
Stock Position:  0.003247684133607157
Bond Position:  [-6.56590995]


portfolio before change:  [-6.24897249]
curr_Stock_Price:  98.09425034808723
curr_Factors:  [98.09425035 -0.48412099 -1.10398747]
mat_Sqrt:  [[20.041804    0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00385984 -0.04893468 -1.19975144]
Stock Position:  -0.003859842197355283
Bond Position:  [-5.87034416]


portfolio before change:  [-6.24968244]
curr_Stock_Price:  97.89791491546161
curr_Factors:  [97.89791492 -0.31664155 -1.13257532]
mat_Sqrt:  [[22.98193311  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00176314  0.00417653 -0.06781932]
Stock Position:  -0.0017631447084343235
Bond Position:  [-6.07707425]


portfolio before change:  [-6.25601893]
curr_Stock_Price:  100.62998644533735
curr_Factors:  [100.62998645  -0.54013578  -1.13686147]
mat_Sqrt:  [[18.81121143  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00101441 -0.0141975   0.0769856 ]
Stock Position:  -0.001014406313584131
Bond Position:  [-6.15393924]


portfolio before change:  [-6.25711531]
curr_Stock_Price:  100.19397133152764
curr_Factors:  [100.19397133  -0.77684094  -1.15207065]
mat_Sqrt:  [[14.55881179  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00355302 -0.00318235  0.25495578]
Stock Position:  0.003553021152412612
Bond Position:  [-6.61310661]


portfolio before change:  [-6.26505389]
curr_Stock_Price:  98.42502636639504
curr_Factors:  [98.42502637 -0.59130356 -1.13345248]
mat_Sqrt:  [[17.54096603  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00039674  0.03265341  0.19480917]
Stock Position:  -0.0003967421458565483
Bond Position:  [-6.22600454]


portfolio before change:  [-6.26654709]
curr_Stock_Price:  98.26498113177495
curr_Factors:  [98.26498113 -0.87585488 -1.13785118]
mat_Sqrt:  [[13.11768939  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00334916 -0.00542627  0.07375922]
Stock Position:  0.003349161934457766
Bond Position:  [-6.59565243]


portfolio before change:  [-6.2660351]
curr_Stock_Price:  98.910251067248
curr_Factors:  [98.91025107 -0.73721916 -1.1946754 ]
mat_Sqrt:  [[14.32947096  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02918864 -0.29146727 -0.51326495]
Stock Position:  -0.029188640985368292
Bond Position:  [-3.37897929]


portfolio before change:  [-6.24358186]
curr_Stock_Price:  98.1120607815533
curr_Factors:  [98.11206078 -0.42745733 -1.15630865]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-6.24358186]
Stock Price:  97.66942885112199
PL:  [-6.24358186]
Settle:  Tensor("sub_336:0", shape=(), dtype=float64)
PL:  Tensor("sub_337:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  169
output_Z_Vals[:, i, :]:  [[ 1.19251512e+02 -2.92846752e+01 -2.92776944e+01]
 [-1.15943807e-01 -2.63779070e-02 -1.78810964e-01]
 [-4.41982332e-01 -7.42292743e-02  3.03172427e-01]
 [-6.22454043e-02 -1.08260769e-01 -3.47355023e-01]
 [-9.88296441e-02 -2.41910939e-01  2.15109929e-01]
 [ 2.87181558e-02 -2.29974248e-01  4.82917156e-02]
 [ 5.62272986e-02  2.32613574e-02 -1.39836509e-02]
 [-4.14602843e-02  1.03107614e-01 -4.80078179e-02]
 [-5.33081337e-02 -3.10908818e-02  5.26814236e-02]
 [ 4.50470017e-02  4.74936917e-02 -1.18045691e-02]
 [ 2.82612027e-02  8.61605438e-02 -1.24418727e-02]
 [ 1.38697429e-02 -8.10562059e-03 -9.52682604e-02]
 [ 5.39446532e-02 -8.04147320e-03 -2.70116382e-01]
 [-7.87188739e-02  3.12700325e-02 -2.35868833e-02]
 [-3.21556406e-04 -6.02355811e-02 -9.00293642e-03]
 [ 7.00993510e-02 -7.42470305e-03  6.85146619e-02]
 [-2.35647895e-02  1.03259148e-01  6.82888801e-02]
 [ 4.38574271e-02 -2.40253554e-02  4.78290752e-02]
 [-1.94399653e-01 -6.43097970e-01 -1.31115678e-02]
 [ 6.90519139e-02 -2.72751415e-02 -7.25580783e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.25151208 -29.28467519 -29.2776944 ]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  8.31409947  -9.26062741 -83.52111278]
init_Out:  [2.49223638]
Stock Position:  8.314099471154409
Bond position:  [-828.91771073]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [3.54068189]
curr_Stock_Price:  100.15103269419636
curr_Factors:  [100.15103269  -1.47603233  -0.99887008]
mat_Sqrt:  [[ 8.42983308  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0181646  -0.00834143 -0.51009791]
Stock Position:  -0.01816459653467872
Bond Position:  [5.359885]


portfolio before change:  [3.52634172]
curr_Stock_Price:  101.01426754028556
curr_Factors:  [101.01426754  -1.61756275  -1.00614769]
mat_Sqrt:  [[ 7.32689134  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.05213863 -0.02347336  0.86486655]
Stock Position:  -0.05213863479620428
Bond Position:  [8.79308772]


portfolio before change:  [3.50477495]
curr_Stock_Price:  101.4700777257263
curr_Factors:  [101.47007773  -1.47534137  -1.0354728 ]
mat_Sqrt:  [[ 8.23958342  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01649892 -0.03423506 -0.9909072 ]
Stock Position:  -0.01649892058547667
Bond Position:  [5.1789217]


portfolio before change:  [3.51040568]
curr_Stock_Price:  101.20728227173166
curr_Factors:  [101.20728227  -1.5704885   -0.97604301]
mat_Sqrt:  [[ 7.92989029  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00771343 -0.07649896  0.61364875]
Stock Position:  -0.0077134266664926135
Bond Position:  [4.29106063]


portfolio before change:  [3.51632175]
curr_Stock_Price:  100.57939365727545
curr_Factors:  [100.57939366  -2.05385594  -0.95571358]
mat_Sqrt:  [[ 4.95986181  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00658038 -0.07272424  0.13776282]
Stock Position:  0.006580375150967127
Bond Position:  [2.85447161]


portfolio before change:  [3.51934217]
curr_Stock_Price:  100.9299371276269
curr_Factors:  [100.92993713  -2.18044654  -0.96950017]
mat_Sqrt:  [[ 4.32529298  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01247858  0.00735589 -0.03989146]
Stock Position:  0.012478577461463185
Bond Position:  [2.25988013]


portfolio before change:  [3.5203731]
curr_Stock_Price:  100.96727256742572
curr_Factors:  [100.96727257  -2.03477718  -0.96532904]
mat_Sqrt:  [[ 5.02633054  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00966861  0.03260549 -0.13695294]
Stock Position:  -0.009668606471887536
Bond Position:  [4.49658593]


portfolio before change:  [3.52440266]
curr_Stock_Price:  100.66678693266797
curr_Factors:  [100.66678693  -1.73240268  -0.95679194]
mat_Sqrt:  [[ 6.83886176  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00633985 -0.0098318   0.15028544]
Stock Position:  -0.006339848319926644
Bond Position:  [4.16261482]


portfolio before change:  [3.52442745]
curr_Stock_Price:  100.82704277775798
curr_Factors:  [100.82704278  -1.80908341  -0.96229954]
mat_Sqrt:  [[ 6.30929314  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00695223  0.01501882 -0.03367515]
Stock Position:  0.006952234593365213
Bond Position:  [2.8234542]


portfolio before change:  [3.52358713]
curr_Stock_Price:  100.604628792933
curr_Factors:  [100.60462879  -1.65176626  -0.9791009 ]
mat_Sqrt:  [[ 7.24514153  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00385723  0.02724636 -0.0354932 ]
Stock Position:  0.003857229243462203
Bond Position:  [3.13553201]


portfolio before change:  [3.52300615]
curr_Stock_Price:  100.25075722959984
curr_Factors:  [100.25075723  -1.69952911  -0.98767044]
mat_Sqrt:  [[ 6.82419965  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00084788 -0.00256322 -0.27177383]
Stock Position:  -0.0008478789919488651
Bond Position:  [3.60800666]


portfolio before change:  [3.52435296]
curr_Stock_Price:  99.72627465420138
curr_Factors:  [99.72627465 -1.2565576  -0.99385816]
mat_Sqrt:  [[10.5067028   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-1.33272286e-04 -2.54293711e-03 -7.70566852e-01]
Stock Position:  -0.00013327228562876343
Bond Position:  [3.53764371]


portfolio before change:  [3.52528792]
curr_Stock_Price:  99.3478067117657
curr_Factors:  [99.34780671 -1.58465677 -0.93808983]
mat_Sqrt:  [[ 7.9715607   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01037766  0.00988845 -0.06728681]
Stock Position:  -0.01037765886850622
Bond Position:  [4.55628557]


portfolio before change:  [3.525899]
curr_Stock_Price:  99.39869802742996
curr_Factors:  [99.39869803 -1.52964991 -0.94849599]
mat_Sqrt:  [[ 8.33941533  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00044542 -0.01904816 -0.02568287]
Stock Position:  -0.0004454208086436528
Bond Position:  [3.57017325]


portfolio before change:  [3.5270149]
curr_Stock_Price:  98.89750703203197
curr_Factors:  [98.89750703 -1.72231891 -0.94966795]
mat_Sqrt:  [[ 6.8352782   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01227355 -0.0023479   0.19545326]
Stock Position:  0.012273552057095195
Bond Position:  [2.31319119]


portfolio before change:  [3.52724543]
curr_Stock_Price:  98.86916708726733
curr_Factors:  [98.86916709 -1.86395362 -0.96259255]
mat_Sqrt:  [[ 5.85473811  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00118865  0.03265341  0.19480917]
Stock Position:  -0.0011886510331906336
Bond Position:  [3.64476637]


portfolio before change:  [3.52812107]
curr_Stock_Price:  98.89917181527491
curr_Factors:  [98.89917182 -2.01213654 -0.96297289]
mat_Sqrt:  [[ 5.04799651  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01049925 -0.00759748  0.13644304]
Stock Position:  0.010499247400177911
Bond Position:  [2.4897542]


portfolio before change:  [3.53121462]
curr_Stock_Price:  99.13452470784017
curr_Factors:  [99.13452471 -2.17885875 -0.9699601 ]
mat_Sqrt:  [[ 4.25314586  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.05024064 -0.20336543 -0.03740365]
Stock Position:  -0.050240637291324254
Bond Position:  [8.51179632]


portfolio before change:  [3.513465]
curr_Stock_Price:  99.53017726477117
curr_Factors:  [99.53017726 -2.11400434 -0.96049164]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [3.513465]
Stock Price:  99.92398236107076
PL:  [3.513465]
Settle:  Tensor("sub_338:0", shape=(), dtype=float64)
PL:  Tensor("sub_339:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  170
output_Z_Vals[:, i, :]:  [[ 1.19251512e+02 -2.92846752e+01 -2.92776944e+01]
 [-1.04864118e-01  1.14919447e-02 -1.08811009e-01]
 [-3.16045252e-01 -4.57735331e-02  2.04366111e-01]
 [-4.86608853e-02 -2.28303358e-02 -1.06692601e-01]
 [-9.88296441e-02 -2.41910939e-01  2.15109929e-01]
 [-2.57014414e-01  2.20500220e-02  1.16594452e-02]
 [ 5.25898507e-02  8.37795410e-02 -3.77168810e-02]
 [-1.32378897e-01  2.01810991e-01 -6.80248810e-02]
 [-3.15821165e-02  1.28571483e-03 -2.49618292e-02]
 [-1.57630377e-03  1.20602627e-02 -1.91599926e-02]
 [ 1.28394268e-01  4.53035536e-03 -3.05602857e-02]
 [-5.19167827e-02 -6.07841607e-03 -6.72120742e-02]
 [ 3.80115633e-02 -1.40067925e-02 -2.73880862e-01]
 [-6.54595128e-02  1.82499329e-02 -3.10754484e-02]
 [-1.38375230e-01  9.47654906e-02  2.66676418e-01]
 [-9.18218489e-02 -1.84806416e-01  1.74779629e-01]
 [-5.35832829e-02 -1.26596991e-01  2.56454647e-01]
 [-3.94778936e-01  5.85152812e-01 -8.10676257e-02]
 [-2.91697552e-01 -1.09893320e+00 -1.86805291e-01]
 [ 1.37087607e-01 -8.60862057e-02 -1.78914323e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.25151208 -29.28467519 -29.2776944 ]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  8.31409947  -9.26062741 -83.52111278]
init_Out:  [2.49223638]
Stock Position:  8.314099471154409
Bond position:  [-828.91771073]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [1.64234762]
curr_Stock_Price:  99.92270558735538
curr_Factors:  [99.92270559 -0.79480834 -1.00233382]
mat_Sqrt:  [[16.56438286  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00765367  0.00363407 -0.31040752]
Stock Position:  -0.007653671881896289
Bond Position:  [2.40712322]


portfolio before change:  [1.63658874]
curr_Stock_Price:  100.75377530120734
curr_Factors:  [100.7537753   -0.91814055  -1.07047723]
mat_Sqrt:  [[13.79163015  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01997669 -0.01447486  0.58299963]
Stock Position:  -0.019976685766418766
Bond Position:  [3.64931525]


portfolio before change:  [1.65634508]
curr_Stock_Price:  99.81048051526108
curr_Factors:  [99.81048052 -0.60789368 -1.0792275 ]
mat_Sqrt:  [[18.47007789  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00384562 -0.00721959 -0.30436429]
Stock Position:  -0.003845619841955053
Bond Position:  [2.04017825]


portfolio before change:  [1.64815858]
curr_Stock_Price:  102.07191241559202
curr_Factors:  [102.07191242  -0.95021718  -1.04565337]
mat_Sqrt:  [[13.87109301  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00440965 -0.07649896  0.61364875]
Stock Position:  -0.004409647256971611
Bond Position:  [2.09825971]


portfolio before change:  [1.6459528]
curr_Stock_Price:  102.69110292331342
curr_Factors:  [102.69110292  -0.86416687  -1.02534279]
mat_Sqrt:  [[15.5213395   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01636876  0.00697283  0.03326115]
Stock Position:  -0.016368761910562774
Bond Position:  [3.32687902]


portfolio before change:  [1.64252144]
curr_Stock_Price:  102.95154938819127
curr_Factors:  [102.95154939  -0.65107498  -1.01682368]
mat_Sqrt:  [[19.42109452  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00242283  0.02649342 -0.10759576]
Stock Position:  0.0024228347705586135
Bond Position:  [1.39308685]


portfolio before change:  [1.64077598]
curr_Stock_Price:  102.08736473077298
curr_Factors:  [102.08736473  -0.77344168  -1.03719056]
mat_Sqrt:  [[16.69646007  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00844812  0.06381824 -0.19405605]
Stock Position:  -0.008448118938202116
Bond Position:  [2.50322218]


portfolio before change:  [1.62281315]
curr_Stock_Price:  104.28770232286138
curr_Factors:  [104.28770232  -0.88643651  -1.03089852]
mat_Sqrt:  [[15.33010314  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00239034  0.00040658 -0.07120915]
Stock Position:  -0.0023903447454951864
Bond Position:  [1.87209671]


portfolio before change:  [1.62268112]
curr_Stock_Price:  104.53876022414401
curr_Factors:  [104.53876022  -0.84448103  -1.02559075]
mat_Sqrt:  [[16.11074001  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00032127  0.00381379 -0.05465813]
Stock Position:  -0.0003212717869826437
Bond Position:  [1.65626647]


portfolio before change:  [1.62351843]
curr_Stock_Price:  103.2215097376134
curr_Factors:  [103.22150974  -0.8344333   -0.9807069 ]
mat_Sqrt:  [[16.8060184   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00727556  0.00143262 -0.08717999]
Stock Position:  0.007275557239988757
Bond Position:  [0.87252443]


portfolio before change:  [1.63352519]
curr_Stock_Price:  104.5669189929556
curr_Factors:  [104.56691899  -1.08652359  -0.98368422]
mat_Sqrt:  [[13.1921166   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00498732 -0.00192216 -0.19173734]
Stock Position:  -0.004987322047251197
Bond Position:  [2.15503409]


portfolio before change:  [1.6435428]
curr_Stock_Price:  102.6663431612276
curr_Factors:  [102.66634316  -0.6685663   -0.98326674]
mat_Sqrt:  [[19.68095279  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00092759 -0.00442934 -0.78130586]
Stock Position:  -0.0009275865615159675
Bond Position:  [1.73877472]


portfolio before change:  [1.64285513]
curr_Stock_Price:  103.87638348826114
curr_Factors:  [103.87638349  -0.48368839  -0.99473765]
mat_Sqrt:  [[23.68342723  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00301188  0.00577114 -0.0886496 ]
Stock Position:  -0.0030118762058474907
Bond Position:  [1.95571794]


portfolio before change:  [1.64072081]
curr_Stock_Price:  104.74737271116932
curr_Factors:  [104.74737271  -0.8965283   -0.97870457]
mat_Sqrt:  [[16.05978956  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00507437  0.02996748  0.76075359]
Stock Position:  -0.005074369083352548
Bond Position:  [2.17224764]


portfolio before change:  [1.6402545]
curr_Stock_Price:  104.94630271274016
curr_Factors:  [104.94630271  -0.58045894  -0.94881822]
mat_Sqrt:  [[22.74104979  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00267871 -0.05844092  0.49859763]
Stock Position:  -0.0026787148467725215
Bond Position:  [1.92137572]


portfolio before change:  [1.6328357]
curr_Stock_Price:  107.89518138816354
curr_Factors:  [107.89518139  -0.66458432  -0.92672658]
mat_Sqrt:  [[21.97376657  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-2.04945176e-04 -4.00334838e-02  7.31593725e-01]
Stock Position:  -0.00020494517614915442
Bond Position:  [1.65494829]


portfolio before change:  [1.63237077]
curr_Stock_Price:  112.18273605029349
curr_Factors:  [112.18273605  -0.63182394  -0.9607336 ]
mat_Sqrt:  [[22.81849911  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0173639   0.18504157 -0.23126337]
Stock Position:  -0.017363903427498523
Bond Position:  [3.58030097]


portfolio before change:  [1.62984199]
curr_Stock_Price:  112.37992512437634
curr_Factors:  [112.37992512  -0.6593994   -0.96852087]
mat_Sqrt:  [[22.06439104  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01623445 -0.34751319 -0.5329035 ]
Stock Position:  -0.016234454624658376
Bond Position:  [3.45426878]


portfolio before change:  [1.63357334]
curr_Stock_Price:  112.20328374658658
curr_Factors:  [112.20328375  -1.09112414  -0.97032596]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [1.63357334]
Stock Price:  111.54692727001708
PL:  [-9.91335393]
Settle:  Tensor("sub_340:0", shape=(), dtype=float64)
PL:  Tensor("sub_341:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  171
output_Z_Vals[:, i, :]:  [[ 1.19251512e+02 -2.92846752e+01 -2.92776944e+01]
 [-1.10398422e-01  3.68370087e-03 -6.11835048e-02]
 [-2.26426101e-01 -2.14357829e-02  1.66388349e-01]
 [-2.19968731e-02  2.76069191e-02  3.56457381e-02]
 [-9.88296441e-02 -2.41910939e-01  2.15109929e-01]
 [-7.29003623e-02 -1.24183781e-01  2.34731051e-02]
 [ 4.08426840e-02  2.01948830e-02 -7.37567534e-03]
 [-9.99056842e-02  1.62470980e-01 -7.99682045e-02]
 [-1.94223159e-01 -8.80023608e-02  1.80132643e-01]
 [ 6.03687334e-02  4.94518375e-02 -2.49747917e-03]
 [-6.47884840e-03  1.05889009e-01 -3.86509074e-03]
 [ 4.91887201e-02 -9.47789932e-03 -1.15178909e-01]
 [ 1.47082182e-02 -1.42198047e-01 -4.31238876e-01]
 [-7.99663987e-02  3.11551731e-02 -2.55795966e-02]
 [ 1.26780401e-02 -6.55058863e-02 -3.56023680e-02]
 [ 1.48825709e-01  7.10896139e-03 -2.11454030e-02]
 [-2.31030523e-02  4.79360433e-02  1.34802577e-01]
 [-3.12796944e-03  3.85902059e-02 -8.77916651e-02]
 [-3.56470036e-01 -9.33811905e-01 -2.07979043e-01]
 [ 1.11949742e-01 -1.25858526e-01 -1.99965814e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.25151208 -29.28467519 -29.2776944 ]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  8.31409947  -9.26062741 -83.52111278]
init_Out:  [2.49223638]
Stock Position:  8.314099471154409
Bond position:  [-828.91771073]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [2.48046792]
curr_Stock_Price:  100.02351269322457
curr_Factors:  [100.02351269  -1.13011202  -0.97889217]
mat_Sqrt:  [[12.13872908  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01011575  0.00116489 -0.17453951]
Stock Position:  -0.010115749300010976
Bond Position:  [3.4922807]


portfolio before change:  [2.48175433]
curr_Stock_Price:  99.98266252063799
curr_Factors:  [99.98266252 -1.32851351 -0.94544243]
mat_Sqrt:  [[10.288645    0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01876007 -0.00677859  0.47465965]
Stock Position:  -0.01876006909081185
Bond Position:  [4.35743599]


portfolio before change:  [2.48994545]
curr_Stock_Price:  99.60411260267537
curr_Factors:  [99.6041126  -1.22286308 -0.93065495]
mat_Sqrt:  [[11.56155559  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00121159  0.00873007  0.10168737]
Stock Position:  -0.0012115938537442727
Bond Position:  [2.61062518]


portfolio before change:  [2.48981169]
curr_Stock_Price:  100.25325890522582
curr_Factors:  [100.25325891  -0.96888276  -0.91450702]
mat_Sqrt:  [[15.24588737  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00401201 -0.07649896  0.61364875]
Stock Position:  -0.004012008338259183
Bond Position:  [2.8920286]


portfolio before change:  [2.48692734]
curr_Stock_Price:  101.15241930230226
curr_Factors:  [101.1524193   -1.02539066  -0.91249122]
mat_Sqrt:  [[14.56682379  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00489574 -0.03927036  0.06696224]
Stock Position:  -0.004895737547545044
Bond Position:  [2.98214304]


portfolio before change:  [2.49344131]
curr_Stock_Price:  99.97418340787229
curr_Factors:  [99.97418341 -1.00670832 -0.93201532]
mat_Sqrt:  [[14.38503386  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00277084  0.00638618 -0.02104075]
Stock Position:  0.0027708353400935203
Bond Position:  [2.21642931]


portfolio before change:  [2.49553339]
curr_Stock_Price:  100.529215375477
curr_Factors:  [100.52921538  -0.74653759  -0.95264922]
mat_Sqrt:  [[18.37997176  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00609545  0.05137783 -0.22812703]
Stock Position:  -0.006095446956800456
Bond Position:  [3.10830389]


portfolio before change:  [2.49825441]
curr_Stock_Price:  100.21031337008306
curr_Factors:  [100.21031337  -0.70915492  -0.91311646]
mat_Sqrt:  [[19.78649686  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00807247 -0.02782879  0.51386829]
Stock Position:  -0.008072472333704759
Bond Position:  [3.30719939]


portfolio before change:  [2.5131109]
curr_Stock_Price:  98.47235921083309
curr_Factors:  [98.47235921 -0.86693307 -0.89036212]
mat_Sqrt:  [[16.98754972  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00359886  0.01563804 -0.00712461]
Stock Position:  0.00359885796109819
Bond Position:  [2.15872286]


portfolio before change:  [2.51522778]
curr_Stock_Price:  98.91059195360958
curr_Factors:  [98.91059195 -1.15500369 -0.90987134]
mat_Sqrt:  [[12.54523988  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00036139  0.03348504 -0.01102603]
Stock Position:  -0.0003613931924381623
Bond Position:  [2.5509734]


portfolio before change:  [2.5159929]
curr_Stock_Price:  98.55835231087353
curr_Factors:  [98.55835231 -0.77366646 -0.92686143]
mat_Sqrt:  [[17.99548497  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00141331 -0.00299717 -0.32857337]
Stock Position:  0.0014133103589971689
Bond Position:  [2.37669936]


portfolio before change:  [2.51635845]
curr_Stock_Price:  98.3965334877201
curr_Factors:  [98.39653349 -0.42547783 -0.91165575]
mat_Sqrt:  [[25.83866449  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00297963 -0.04496697 -1.23020448]
Stock Position:  -0.0029796271604406207
Bond Position:  [2.80954344]


portfolio before change:  [2.51526677]
curr_Stock_Price:  98.99867599164416
curr_Factors:  [98.99867599 -0.29311138 -0.90074377]
mat_Sqrt:  [[30.00161852  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00281263  0.00985213 -0.07297147]
Stock Position:  -0.002812627887018372
Bond Position:  [2.7937132]


portfolio before change:  [2.5170113]
curr_Stock_Price:  98.62677506914147
curr_Factors:  [98.62677507 -0.64812309 -0.86642575]
mat_Sqrt:  [[21.68875543  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00017149 -0.02071478 -0.10156365]
Stock Position:  0.00017148897617934525
Bond Position:  [2.5000979]


portfolio before change:  [2.5175222]
curr_Stock_Price:  97.96081503878845
curr_Factors:  [97.96081504 -0.46138879 -0.81718817]
mat_Sqrt:  [[27.275547    0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00530486  0.00224805 -0.06032195]
Stock Position:  0.005304860588802915
Bond Position:  [1.99785373]


portfolio before change:  [2.53934381]
curr_Stock_Price:  101.98016327361441
curr_Factors:  [101.98016327  -0.7600309   -0.81031376]
mat_Sqrt:  [[21.20917041  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [2.66446620e-04 1.51587079e-02 3.84554229e-01]
Stock Position:  0.00026644662042837956
Bond Position:  [2.51217154]


portfolio before change:  [2.53973859]
curr_Stock_Price:  101.10442782714215
curr_Factors:  [101.10442783  -0.71453904  -0.80847184]
mat_Sqrt:  [[22.04626156  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00090954  0.01220329 -0.25044518]
Stock Position:  -0.0009095407470700546
Bond Position:  [2.63169719]


portfolio before change:  [2.54092629]
curr_Stock_Price:  100.52205494267376
curr_Factors:  [100.52205494  -0.36281427  -0.80550021]
mat_Sqrt:  [[31.25135295  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01353652 -0.29529725 -0.59330632]
Stock Position:  -0.013536517956107604
Bond Position:  [3.90164489]


portfolio before change:  [2.54860443]
curr_Stock_Price:  100.02690528248104
curr_Factors:  [100.02690528  -0.39684756  -0.81234858]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [2.54860443]
Stock Price:  97.24127416788684
PL:  [2.54860443]
Settle:  Tensor("sub_342:0", shape=(), dtype=float64)
PL:  Tensor("sub_343:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  172
output_Z_Vals[:, i, :]:  [[ 1.19251512e+02 -2.92846752e+01 -2.92776944e+01]
 [ 2.06462140e-02 -7.19714957e-02 -1.98624640e-01]
 [-4.51152276e-01 -7.62136342e-02  3.11059805e-01]
 [-4.88450387e-02 -5.10423378e-02 -1.85682590e-01]
 [-9.88296441e-02 -2.41910939e-01  2.15109929e-01]
 [ 2.23569200e-02 -1.71992870e-01  2.54332625e-02]
 [ 5.44367439e-02  5.30517818e-02 -2.56664701e-02]
 [-1.27469936e-01  2.04871031e-01 -8.69333367e-02]
 [-9.50789535e-03 -1.11484374e-02  8.00554856e-03]
 [ 5.09680527e-02  3.55544563e-02 -7.18769722e-03]
 [ 9.43126514e-02  3.87807849e-02 -1.67444297e-02]
 [ 1.27677279e-01 -1.14431478e-02 -1.44418321e-01]
 [ 5.30238901e-02 -5.26695919e-03 -1.10580325e-01]
 [-8.45720117e-02  2.97281712e-02 -3.59999752e-02]
 [-1.37143141e-01  9.30290743e-02  2.64899502e-01]
 [-9.43434517e-02 -1.90208447e-01  1.77084984e-01]
 [-2.66229499e-02 -2.11433172e-02  2.38400796e-01]
 [-1.10465695e-01  1.89350285e-01 -8.32733736e-02]
 [-3.00544248e-01 -9.48731363e-01 -1.05980641e-01]
 [ 6.99597540e-02 -2.03408270e-02 -6.64030009e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.25151208 -29.28467519 -29.2776944 ]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  8.31409947  -9.26062741 -83.52111278]
init_Out:  [2.49223638]
Stock Position:  8.314099471154409
Bond position:  [-828.91771073]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [9.23149899]
curr_Stock_Price:  100.83551056356185
curr_Factors:  [100.83551056  -1.24846423  -1.02603589]
mat_Sqrt:  [[10.3707616   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00209784 -0.02275939 -0.56662081]
Stock Position:  -0.0020978369518971475
Bond Position:  [9.44303545]


portfolio before change:  [9.23244352]
curr_Stock_Price:  101.51073793432265
curr_Factors:  [101.51073793  -1.17534063  -1.0162836 ]
mat_Sqrt:  [[11.34231424  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.03435148 -0.02410087  0.88736704]
Stock Position:  -0.03435148057457646
Bond Position:  [12.71948767]


portfolio before change:  [9.26754792]
curr_Stock_Price:  100.58140007777156
curr_Factors:  [100.58140008  -1.05308827  -0.99369316]
mat_Sqrt:  [[12.99007906  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00677942 -0.016141   -0.52970075]
Stock Position:  -0.006779423420843227
Bond Position:  [9.94943182]


portfolio before change:  [9.26750841]
curr_Stock_Price:  100.95417269416025
curr_Factors:  [100.95417269  -1.0524914   -0.96731844]
mat_Sqrt:  [[13.39466955  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00456649 -0.07649896  0.61364875]
Stock Position:  -0.004566490200408132
Bond Position:  [9.72851465]


portfolio before change:  [9.27237811]
curr_Stock_Price:  100.42044457991437
curr_Factors:  [100.42044458  -1.0740187   -0.96770466]
mat_Sqrt:  [[13.03505745  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00177273 -0.05438892  0.07255402]
Stock Position:  0.0017727291352646966
Bond Position:  [9.09435986]


portfolio before change:  [9.27826044]
curr_Stock_Price:  102.45598437000149
curr_Factors:  [102.45598437  -1.59924843  -0.9958781 ]
mat_Sqrt:  [[ 7.6469491   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00661275  0.01677645 -0.0732193 ]
Stock Position:  0.006612753411208828
Bond Position:  [8.60074428]


portfolio before change:  [9.27922574]
curr_Stock_Price:  102.2767619861312
curr_Factors:  [102.27676199  -1.32104926  -1.02071206]
mat_Sqrt:  [[ 9.83474158  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01422766  0.06478591 -0.24799661]
Stock Position:  -0.014227662300414582
Bond Position:  [10.73438497]


portfolio before change:  [9.27953832]
curr_Stock_Price:  102.44343438621978
curr_Factors:  [102.44343439  -1.21420206  -1.02874471]
mat_Sqrt:  [[10.87388476  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00075057 -0.00352545  0.0228376 ]
Stock Position:  -0.0007505708579978288
Bond Position:  [9.35642937]


portfolio before change:  [9.28168498]
curr_Stock_Price:  102.70022450242284
curr_Factors:  [102.7002245   -1.46520926  -1.07040125]
mat_Sqrt:  [[ 8.13522825  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0061976   0.01124331 -0.0205045 ]
Stock Position:  0.006197598972694164
Bond Position:  [8.64519017]


portfolio before change:  [9.2819508]
curr_Stock_Price:  102.3943404753002
curr_Factors:  [102.39434048  -1.37036403  -1.10892332]
mat_Sqrt:  [[ 8.58094544  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01070931  0.01226356 -0.0477672 ]
Stock Position:  0.010709312297807602
Bond Position:  [8.18537783]


portfolio before change:  [9.28424392]
curr_Stock_Price:  102.41735997576042
curr_Factors:  [102.41735998  -1.37104091  -1.10515675]
mat_Sqrt:  [[ 8.60943395  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01137154 -0.00361864 -0.41198527]
Stock Position:  0.011371543450604284
Bond Position:  [8.11960046]


portfolio before change:  [9.30545045]
curr_Stock_Price:  104.10370763360376
curr_Factors:  [104.10370763  -1.4883278   -1.09076753]
mat_Sqrt:  [[ 7.89549432  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00383963 -0.00166556 -0.31545489]
Stock Position:  0.00383963083697829
Bond Position:  [8.90573064]


portfolio before change:  [9.30959869]
curr_Stock_Price:  104.60415346935724
curr_Factors:  [104.60415347  -1.43511112  -1.08505913]
mat_Sqrt:  [[ 8.41497632  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01083222  0.00940087 -0.10269791]
Stock Position:  -0.010832222731811935
Bond Position:  [10.44269418]


portfolio before change:  [9.30656219]
curr_Stock_Price:  105.12551468382028
curr_Factors:  [105.12551468  -1.24316     -1.08855223]
mat_Sqrt:  [[10.21076732  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00790036  0.02941838  0.75568455]
Stock Position:  -0.007900361839214285
Bond Position:  [10.13709179]


portfolio before change:  [9.31456283]
curr_Stock_Price:  104.43364132196743
curr_Factors:  [104.43364132  -1.44478291  -1.1010661 ]
mat_Sqrt:  [[ 8.18827162  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00770703 -0.06014919  0.50517417]
Stock Position:  -0.007707034478207425
Bond Position:  [10.1194365]


portfolio before change:  [9.31171839]
curr_Stock_Price:  105.13100648058847
curr_Factors:  [105.13100648  -0.9867096   -1.1033785 ]
mat_Sqrt:  [[13.00220759  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00165314 -0.0066861   0.68009111]
Stock Position:  0.0016531416390467971
Bond Position:  [9.13792194]


portfolio before change:  [9.31392573]
curr_Stock_Price:  105.08417543992088
curr_Factors:  [105.08417544  -1.3121581   -1.10296875]
mat_Sqrt:  [[ 9.38990194  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0130539   0.05987782 -0.23755576]
Stock Position:  -0.013053895371531917
Bond Position:  [10.68568356]


portfolio before change:  [9.30732872]
curr_Stock_Price:  105.7942141848386
curr_Factors:  [105.79421418  -1.31272716  -1.11537293]
mat_Sqrt:  [[ 9.33149969  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0371509  -0.3000152  -0.30233327]
Stock Position:  -0.03715089807656303
Bond Position:  [13.23767878]


portfolio before change:  [9.34807375]
curr_Stock_Price:  104.78656166064096
curr_Factors:  [104.78656166  -0.98423583  -1.09185663]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [9.34807375]
Stock Price:  105.65426058403169
PL:  [3.69381316]
Settle:  Tensor("sub_344:0", shape=(), dtype=float64)
PL:  Tensor("sub_345:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  173
output_Z_Vals[:, i, :]:  [[ 1.19251512e+02 -2.92846752e+01 -2.92776944e+01]
 [-1.64502790e-01  4.59828670e-02  2.81440464e-02]
 [-8.24771144e-02  8.76604887e-03  3.50710542e-02]
 [-4.51713079e-02 -3.52243497e-02 -1.40880559e-01]
 [-9.02681191e-02 -1.70368090e-01  1.42543379e-01]
 [-6.05280453e-02  3.75717468e-02 -9.30807675e-03]
 [-8.62211763e-02 -5.15408689e-02  5.62343119e-02]
 [-9.02892972e-02  1.50216142e-01 -8.20298800e-02]
 [-2.22263234e-01 -9.97762898e-02  2.06482655e-01]
 [ 4.14902064e-02  3.20025110e-02  3.10392130e-03]
 [ 7.94392449e-02  5.31314423e-02 -4.58706263e-03]
 [ 1.85638748e-01 -1.31429295e-02 -1.69450140e-01]
 [ 3.22109253e-02 -2.02384525e-02 -4.83181604e-01]
 [-8.45720117e-02  2.97281712e-02 -3.59999752e-02]
 [-5.90888819e-02 -2.28125907e-02  7.42742765e-02]
 [ 7.13789151e-02 -1.07645190e-02  6.78929746e-02]
 [ 3.59656402e-03  2.41516173e-02  8.88987901e-02]
 [ 4.16196696e-02 -2.49874608e-02  6.99696018e-02]
 [-3.17345852e-01 -8.09382615e-01 -1.57729047e-01]
 [ 1.17968555e-01 -1.25410147e-01 -2.06294864e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.25151208 -29.28467519 -29.2776944 ]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  8.31409947  -9.26062741 -83.52111278]
init_Out:  [2.49223638]
Stock Position:  8.314099471154409
Bond position:  [-828.91771073]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-3.67685272]
curr_Stock_Price:  99.28292489229847
curr_Factors:  [99.28292489 -0.86893462 -1.01403197]
mat_Sqrt:  [[15.10471599  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01043188  0.01454106  0.08028713]
Stock Position:  -0.010431883512337594
Bond Position:  [-2.64114482]


portfolio before change:  [-3.66970464]
curr_Stock_Price:  98.53440700841549
curr_Factors:  [98.53440701 -0.88771479 -0.98150522]
mat_Sqrt:  [[15.19833354  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0049408   0.00277207  0.10004796]
Stock Position:  -0.004940800039751176
Bond Position:  [-3.18286584]


portfolio before change:  [-3.67874927]
curr_Stock_Price:  100.20393696023794
curr_Factors:  [100.20393696  -0.75948721  -1.00259191]
mat_Sqrt:  [[17.20376683  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00435009 -0.01113892 -0.40189302]
Stock Position:  -0.0043500892048348675
Bond Position:  [-3.2428532]


portfolio before change:  [-3.67572593]
curr_Stock_Price:  99.32254005844626
curr_Factors:  [99.32254006 -0.8160475  -0.9832872 ]
mat_Sqrt:  [[16.42883194  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00399118 -0.05387512  0.40663659]
Stock Position:  -0.003991182029554895
Bond Position:  [-3.27931159]


portfolio before change:  [-3.6726722]
curr_Stock_Price:  98.35198598571944
curr_Factors:  [98.35198599 -0.67845123 -1.003266  ]
mat_Sqrt:  [[18.29880047  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00335858  0.01188123 -0.02655335]
Stock Position:  -0.0033585780841942337
Bond Position:  [-3.34234938]


portfolio before change:  [-3.67352932]
curr_Stock_Price:  98.35836559311947
curr_Factors:  [98.35836559 -0.74775265 -1.00822386]
mat_Sqrt:  [[16.99027459  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00447745 -0.01629865  0.16042084]
Stock Position:  -0.0044774541172742715
Bond Position:  [-3.23313425]


portfolio before change:  [-3.68144669]
curr_Stock_Price:  99.94609473826247
curr_Factors:  [99.94609474 -0.65891146 -1.00783715]
mat_Sqrt:  [[18.87583201  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00546493  0.04750252 -0.23400841]
Stock Position:  -0.005464925316242947
Bond Position:  [-3.13524875]


portfolio before change:  [-3.68270488]
curr_Stock_Price:  100.03288049200731
curr_Factors:  [100.03288049  -0.51723399  -1.02786017]
mat_Sqrt:  [[21.33619196  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00856251 -0.03155203  0.58903754]
Stock Position:  -0.00856250975132552
Bond Position:  [-2.82617236]


portfolio before change:  [-3.66064964]
curr_Stock_Price:  97.37456355615035
curr_Factors:  [97.37456356 -0.45426215 -0.98222358]
mat_Sqrt:  [[23.15195654  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00185514 0.01012008 0.00885462]
Stock Position:  0.0018551388027686555
Bond Position:  [-3.84129297]


portfolio before change:  [-3.66144166]
curr_Stock_Price:  97.46535307871146
curr_Factors:  [97.46535308 -0.19597632 -0.99874269]
mat_Sqrt:  [[29.51143876  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00270657  0.01680164 -0.01308561]
Stock Position:  0.0027065695859071945
Bond Position:  [-3.92523842]


portfolio before change:  [-3.65666111]
curr_Stock_Price:  99.59424026313883
curr_Factors:  [ 9.95942403e+01  3.11282522e-02 -9.79904972e-01]
mat_Sqrt:  [[38.56432455  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00390803 -0.00415616 -0.48339408]
Stock Position:  0.003908029902901834
Bond Position:  [-4.04587838]


portfolio before change:  [-3.65031693]
curr_Stock_Price:  101.47646032464016
curr_Factors:  [ 1.01476460e+02 -5.09262154e-02 -9.85720576e-01]
mat_Sqrt:  [[35.9878025   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00186009 -0.00639996 -1.37838262]
Stock Position:  -0.0018600930453991917
Bond Position:  [-3.46156128]


portfolio before change:  [-3.65003615]
curr_Stock_Price:  100.86020824529284
curr_Factors:  [100.86020825  -0.16194556  -1.00420599]
mat_Sqrt:  [[31.42437717  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00290071  0.00940087 -0.10269791]
Stock Position:  -0.002900706584172767
Bond Position:  [-3.35747028]


portfolio before change:  [-3.65102983]
curr_Stock_Price:  100.91337040535649
curr_Factors:  [100.91337041  -0.43759374  -0.99782572]
mat_Sqrt:  [[24.01894686  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0018534  -0.00721397  0.21188384]
Stock Position:  -0.0018534004635380773
Bond Position:  [-3.46399694]


portfolio before change:  [-3.64907061]
curr_Stock_Price:  99.38896883304317
curr_Factors:  [99.38896883 -0.6614006  -1.03465618]
mat_Sqrt:  [[18.2284645   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00466082 -0.00340404  0.19367976]
Stock Position:  0.004660818898166216
Bond Position:  [-4.11230459]


portfolio before change:  [-3.66750547]
curr_Stock_Price:  95.65428988740219
curr_Factors:  [95.65428989 -0.71226096 -1.01729753]
mat_Sqrt:  [[16.96550309  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00131835 0.00763741 0.2536035 ]
Stock Position:  0.0013183543993871272
Bond Position:  [-3.79361173]


portfolio before change:  [-3.66932732]
curr_Stock_Price:  94.9918577956782
curr_Factors:  [94.9918578  -0.77891471 -1.00119416]
mat_Sqrt:  [[16.01750707  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00344979 -0.00790173  0.1996038 ]
Stock Position:  0.0034497866014177735
Bond Position:  [-3.99702895]


portfolio before change:  [-3.66635717]
curr_Stock_Price:  96.14251754190612
curr_Factors:  [96.14251754 -0.77294008 -1.01932217]
mat_Sqrt:  [[16.01569845  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02312983 -0.25594926 -0.44995707]
Stock Position:  -0.023129826610721924
Bond Position:  [-1.44259741]


portfolio before change:  [-3.6612391]
curr_Stock_Price:  95.9056475218916
curr_Factors:  [95.90564752 -0.95414872 -1.01412124]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-3.6612391]
Stock Price:  94.74837287674636
PL:  [-3.6612391]
Settle:  Tensor("sub_346:0", shape=(), dtype=float64)
PL:  Tensor("sub_347:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  174
output_Z_Vals[:, i, :]:  [[ 1.19251512e+02 -2.92846752e+01 -2.92776944e+01]
 [-7.87525793e-02 -9.36598848e-03 -5.48856452e-02]
 [-1.04532400e-01  1.16667227e-02  1.14733654e-01]
 [-2.66252204e-02  4.44205052e-02  7.62780964e-02]
 [-8.19739740e-02 -1.01059553e-01  7.22431124e-02]
 [ 1.66805551e-02 -1.22817424e-01  1.43790238e-02]
 [ 5.60012832e-02  2.70216974e-02 -1.54583319e-02]
 [-1.07510943e-01  1.83812755e-01 -9.99485010e-02]
 [-2.37011816e-02 -1.64245574e-02  1.93002071e-02]
 [ 5.06879472e-02  3.65506450e-02 -7.53481494e-03]
 [ 9.42201023e-02  3.81521411e-02 -1.68885336e-02]
 [ 1.01634882e-01 -1.06794268e-02 -1.33171391e-01]
 [ 5.18400604e-02 -6.38357921e-03 -1.45348329e-01]
 [-8.45720117e-02  2.97281712e-02 -3.59999752e-02]
 [-8.64899527e-02  1.17466006e-02  1.47823209e-01]
 [-4.44870075e-02 -1.01849000e-01  1.35735933e-01]
 [-2.31291443e-02  4.82833301e-02  1.34468265e-01]
 [-4.77449476e-02  9.72885388e-02 -9.68973359e-02]
 [-3.90711416e-01 -1.05072149e+00 -2.56336966e-01]
 [ 9.33884288e-02 -8.32028216e-02 -1.44838201e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.25151208 -29.28467519 -29.2776944 ]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  8.31409947  -9.26062741 -83.52111278]
init_Out:  [2.49223638]
Stock Position:  8.314099471154409
Bond position:  [-828.91771073]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [3.56264449]
curr_Stock_Price:  100.1536743027962
curr_Factors:  [100.1536743   -1.15256475  -0.98804032]
mat_Sqrt:  [[11.77643706  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00765918 -0.00296179 -0.15657347]
Stock Position:  -0.0076591835916972875
Bond Position:  [4.32973987]


portfolio before change:  [3.56973914]
curr_Stock_Price:  99.36872401226888
curr_Factors:  [99.36872401 -0.96738532 -1.03350703]
mat_Sqrt:  [[13.43609938  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00601449  0.00368934  0.32730318]
Stock Position:  -0.006014487943880459
Bond Position:  [4.16739113]


portfolio before change:  [3.57669529]
curr_Stock_Price:  98.38540265701343
curr_Factors:  [98.38540266 -0.85940917 -0.99485766]
mat_Sqrt:  [[15.40397545  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00064322  0.014047    0.21760018]
Stock Position:  -0.0006432162046446972
Bond Position:  [3.63997838]


portfolio before change:  [3.57808139]
curr_Stock_Price:  97.64539093454397
curr_Factors:  [97.64539093 -1.24527692 -0.9852052 ]
mat_Sqrt:  [[10.49459478  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00665455 -0.03195784  0.20608949]
Stock Position:  -0.006654545354720824
Bond Position:  [4.22786707]


portfolio before change:  [3.56514109]
curr_Stock_Price:  99.74882531116789
curr_Factors:  [99.74882531 -1.37867119 -0.99215667]
mat_Sqrt:  [[ 9.3168764   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00176503 -0.03883828  0.04101935]
Stock Position:  0.0017650259662624443
Bond Position:  [3.38908182]


portfolio before change:  [3.56858874]
curr_Stock_Price:  101.22204999462727
curr_Factors:  [101.22204999  -1.5616891   -1.00523487]
mat_Sqrt:  [[ 7.77095176  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00689022  0.00854501 -0.04409832]
Stock Position:  0.006890219283237869
Bond Position:  [2.87114662]


portfolio before change:  [3.57049357]
curr_Stock_Price:  101.39431593085959
curr_Factors:  [101.39431593  -1.46275081  -1.02929473]
mat_Sqrt:  [[ 8.38942091  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01468121  0.0581267  -0.28512525]
Stock Position:  -0.014681206462186671
Bond Position:  [5.05908446]


portfolio before change:  [3.57051693]
curr_Stock_Price:  101.47888478231899
curr_Factors:  [101.47888478  -1.60931553  -1.04482677]
mat_Sqrt:  [[ 7.13996906  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00282713 -0.0051939   0.05505812]
Stock Position:  -0.0028271304022083133
Bond Position:  [3.85741097]


portfolio before change:  [3.56798824]
curr_Stock_Price:  102.71447050309689
curr_Factors:  [102.7144705   -1.74965697  -1.05266703]
mat_Sqrt:  [[ 6.23157432  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00803868  0.01155833 -0.02149473]
Stock Position:  0.008038681807871189
Bond Position:  [2.74229929]


portfolio before change:  [3.56618187]
curr_Stock_Price:  102.40446556991064
curr_Factors:  [102.40446557  -1.75543534  -1.0081623 ]
mat_Sqrt:  [[ 6.45808402  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01420821  0.01206477 -0.04817829]
Stock Position:  0.01420821231244619
Bond Position:  [2.11119748]


portfolio before change:  [3.56386182]
curr_Stock_Price:  102.20402406631894
curr_Factors:  [102.20402407  -1.52627177  -0.98585767]
mat_Sqrt:  [[ 8.28827289  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00894947 -0.00337713 -0.37990091]
Stock Position:  0.008949469372735181
Bond Position:  [2.64919003]


portfolio before change:  [3.55921373]
curr_Stock_Price:  101.61064067661873
curr_Factors:  [101.61064068  -1.46570895  -0.9704776 ]
mat_Sqrt:  [[ 8.89030809  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00247529 -0.00201866 -0.41463832]
Stock Position:  0.0024752948379627346
Bond Position:  [3.30769744]


portfolio before change:  [3.56046013]
curr_Stock_Price:  101.78006465403068
curr_Factors:  [101.78006465  -1.02949224  -0.99716517]
mat_Sqrt:  [[13.41209413  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00679632  0.00940087 -0.10269791]
Stock Position:  -0.006796321056342832
Bond Position:  [4.25219013]


portfolio before change:  [3.55878807]
curr_Stock_Price:  102.18252405157529
curr_Factors:  [102.18252405  -1.14934832  -1.03915618]
mat_Sqrt:  [[11.45305119  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00489061  0.0037146   0.42169847]
Stock Position:  -0.004890606851888236
Bond Position:  [4.05852262]


portfolio before change:  [3.55757669]
curr_Stock_Price:  102.63771064950556
curr_Factors:  [102.63771065  -1.24397686  -1.05556224]
mat_Sqrt:  [[10.29508208  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00188534 -0.03220748  0.38721683]
Stock Position:  -0.0018853425324348078
Bond Position:  [3.75108393]


portfolio before change:  [3.55989074]
curr_Stock_Price:  101.90778311108328
curr_Factors:  [101.90778311  -0.57658794  -1.09872184]
mat_Sqrt:  [[19.08224921  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [2.91671360e-04 1.52685296e-02 3.83600532e-01]
Stock Position:  0.00029167136043636854
Bond Position:  [3.53016716]


portfolio before change:  [3.56100773]
curr_Stock_Price:  102.71121417917593
curr_Factors:  [102.71121418  -0.37186958  -1.15030297]
mat_Sqrt:  [[22.41541191  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00290033  0.03076534 -0.27642113]
Stock Position:  -0.0029003283302990604
Bond Position:  [3.85890398]


portfolio before change:  [3.56457009]
curr_Stock_Price:  101.81562230564761
curr_Factors:  [101.81562231  -0.25378094  -1.16741537]
mat_Sqrt:  [[24.58083931  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01912732 -0.33226731 -0.73125801]
Stock Position:  -0.019127316479336392
Bond Position:  [5.51202972]


portfolio before change:  [3.61870324]
curr_Stock_Price:  99.05752642488
curr_Factors:  [99.05752642 -0.26695514 -1.15969803]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [3.61870324]
Stock Price:  98.36593507123622
PL:  [3.61870324]
Settle:  Tensor("sub_348:0", shape=(), dtype=float64)
PL:  Tensor("sub_349:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  175
output_Z_Vals[:, i, :]:  [[ 1.19251512e+02 -2.92846752e+01 -2.92776944e+01]
 [-9.12379290e-02 -1.02580120e-02 -4.30387337e-02]
 [-7.81808049e-02  1.12391077e-02  4.35826099e-02]
 [-2.01916751e-02  3.38922656e-02  5.18326327e-02]
 [-8.81316131e-02 -1.52514760e-01  1.24434588e-01]
 [ 1.01427241e-04 -8.97084229e-03 -9.67793222e-03]
 [-7.96067437e-02 -4.04836538e-02  4.89796902e-02]
 [-3.02672621e-02  4.27438750e-02 -1.06332396e-01]
 [-1.82686186e-01 -1.25674737e-01  2.71611658e-01]
 [ 3.65950130e-04 -4.28406906e-02  2.61075874e-02]
 [-1.00630013e-01  1.41498527e-01  3.14165322e-02]
 [-8.82957395e-02 -9.19445852e-03 -1.25597196e-01]
 [-1.28380818e-02 -2.97328164e-01 -2.64765472e-01]
 [ 7.22296235e-02 -3.92273951e-02  7.12451725e-03]
 [ 1.11348156e-02 -5.79141975e-02 -1.09473076e-01]
 [ 1.73772652e-01  4.55835922e-02 -1.14477785e-01]
 [ 2.32283425e-02 -3.45039964e-02  1.06340078e-01]
 [ 4.16196696e-02 -2.49874608e-02  6.99696018e-02]
 [-2.35179659e-01 -6.27921709e-01 -1.03917882e-01]
 [ 9.15601675e-02 -9.59625008e-02 -1.78087577e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.25151208 -29.28467519 -29.2776944 ]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  8.31409947  -9.26062741 -83.52111278]
init_Out:  [2.49223638]
Stock Position:  8.314099471154409
Bond position:  [-828.91771073]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [2.88192146]
curr_Stock_Price:  100.07179856456665
curr_Factors:  [100.07179856  -1.2225492   -1.01494236]
mat_Sqrt:  [[10.68025115  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00939004 -0.00324387 -0.12277753]
Stock Position:  -0.009390044581722958
Bond Position:  [3.82160011]


portfolio before change:  [2.89660741]
curr_Stock_Price:  98.60956594729099
curr_Factors:  [98.60956595 -1.21285508 -0.9791591 ]
mat_Sqrt:  [[11.0138558   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00626432  0.00355412  0.12432906]
Stock Position:  -0.006264322926818756
Bond Position:  [3.51432957]


portfolio before change:  [2.89634881]
curr_Stock_Price:  98.79111662204298
curr_Factors:  [98.79111662 -1.24100387 -0.96235019]
mat_Sqrt:  [[10.90971439  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00080078  0.01071768  0.14786407]
Stock Position:  -0.0008007806980794184
Bond Position:  [2.97545883]


portfolio before change:  [2.897347]
curr_Stock_Price:  98.47363647869322
curr_Factors:  [98.47363648 -1.39610764 -0.97502546]
mat_Sqrt:  [[ 9.19496239  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00725065 -0.0482294   0.35497724]
Stock Position:  -0.007250646662548055
Bond Position:  [3.61134454]


portfolio before change:  [2.89555995]
curr_Stock_Price:  98.84463764737293
curr_Factors:  [98.84463765 -1.16910778 -0.9987863 ]
mat_Sqrt:  [[11.30963729  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00018619 -0.00283683 -0.02760845]
Stock Position:  -0.00018618621427595052
Bond Position:  [2.91396346]


portfolio before change:  [2.89636995]
curr_Stock_Price:  98.40732524311338
curr_Factors:  [98.40732524 -1.00756538 -1.01317181]
mat_Sqrt:  [[13.04464953  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00541633 -0.01280206  0.13972542]
Stock Position:  -0.005416327180560682
Bond Position:  [3.42937622]


portfolio before change:  [2.90413716]
curr_Stock_Price:  97.13159815250353
curr_Factors:  [97.13159815 -1.06415527 -0.99865013]
mat_Sqrt:  [[12.34512614  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00412054  0.0135168  -0.30333673]
Stock Position:  -0.004120543512563753
Bond Position:  [3.30437214]


portfolio before change:  [2.90726638]
curr_Stock_Price:  96.57268497639429
curr_Factors:  [96.57268498 -1.36502872 -1.03441711]
mat_Sqrt:  [[ 8.76573264  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01488622 -0.03974184  0.77483246]
Stock Position:  -0.014886216795838889
Bond Position:  [4.34486831]


portfolio before change:  [2.92142446]
curr_Stock_Price:  95.69457562006357
curr_Factors:  [95.69457562 -1.17407426 -1.0466105 ]
mat_Sqrt:  [[10.38618813  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00044184 -0.01354742  0.07447768]
Stock Position:  0.00044183651957095286
Bond Position:  [2.8791431]


portfolio before change:  [2.92164356]
curr_Stock_Price:  94.56117952774568
curr_Factors:  [94.56117953 -0.90070902 -1.06590089]
mat_Sqrt:  [[13.23198642  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0068443   0.04474576  0.08962262]
Stock Position:  -0.006844298437425656
Bond Position:  [3.56884849]


portfolio before change:  [2.91533324]
curr_Stock_Price:  95.61353554039385
curr_Factors:  [95.61353554 -1.09932099 -1.03296976]
mat_Sqrt:  [[11.33645511  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0100711  -0.00290754 -0.35829384]
Stock Position:  -0.010071098814014516
Bond Position:  [3.87826661]


portfolio before change:  [2.91864516]
curr_Stock_Price:  95.38096631909994
curr_Factors:  [95.38096632 -0.83418511 -1.07985295]
mat_Sqrt:  [[14.0671317   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0053003  -0.09402342 -0.7553022 ]
Stock Position:  -0.00530030494603234
Bond Position:  [3.42419337]


portfolio before change:  [2.9228575]
curr_Stock_Price:  94.74776067234542
curr_Factors:  [94.74776067 -0.94643005 -1.11403268]
mat_Sqrt:  [[12.07039168  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00602061 -0.01240479  0.02032426]
Stock Position:  0.006020605165917067
Bond Position:  [2.35241864]


portfolio before change:  [2.9185819]
curr_Stock_Price:  93.93990580755147
curr_Factors:  [93.93990581 -1.12970617 -1.14601759]
mat_Sqrt:  [[ 9.6497453   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00131678 -0.01831408 -0.31229621]
Stock Position:  -0.0013167830096180427
Bond Position:  [3.04228037]


portfolio before change:  [2.91836519]
curr_Stock_Price:  94.68214859227363
curr_Factors:  [94.68214859 -1.04076662 -1.16848622]
mat_Sqrt:  [[10.39445658  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01458296  0.0144148  -0.32657326]
Stock Position:  0.014582959087710269
Bond Position:  [1.5376193]


portfolio before change:  [2.92140699]
curr_Stock_Price:  94.86437120446101
curr_Factors:  [94.8643712  -1.15513981 -1.15856239]
mat_Sqrt:  [[ 9.38155943  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00469475 -0.01091112  0.30335864]
Stock Position:  0.004694745157994473
Bond Position:  [2.47604294]


portfolio before change:  [2.92544577]
curr_Stock_Price:  95.59277992139195
curr_Factors:  [95.59277992 -1.28900708 -1.14702489]
mat_Sqrt:  [[ 8.36507518  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00660568 -0.00790173  0.1996038 ]
Stock Position:  0.0066056765863562955
Bond Position:  [2.29399079]


portfolio before change:  [2.9259262]
curr_Stock_Price:  95.57867908659149
curr_Factors:  [95.57867909 -1.42857464 -1.11515637]
mat_Sqrt:  [[ 7.50987461  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0362995  -0.19856628 -0.29644879]
Stock Position:  -0.036299497784473465
Bond Position:  [6.39538425]


portfolio before change:  [2.9154695]
curr_Stock_Price:  95.91079781792835
curr_Factors:  [95.91079782 -1.17137527 -1.13554047]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [2.9154695]
Stock Price:  96.25893908082395
PL:  [2.9154695]
Settle:  Tensor("sub_350:0", shape=(), dtype=float64)
PL:  Tensor("sub_351:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  176
output_Z_Vals[:, i, :]:  [[ 1.19251512e+02 -2.92846752e+01 -2.92776944e+01]
 [-1.34010172e-01  1.46957560e-02 -1.23802756e-01]
 [-3.23009226e-01 -4.76647301e-02  2.07317223e-01]
 [-3.92426875e-02 -9.65837313e-03 -6.84370350e-02]
 [-9.88296441e-02 -2.41910939e-01  2.15109929e-01]
 [ 2.01050525e-02 -1.74025472e-01  2.54012949e-02]
 [ 5.61272988e-02  3.49734751e-02 -1.84166431e-02]
 [-5.36417367e-02  8.36268529e-02 -1.18639886e-01]
 [-1.65280093e-01 -9.53401700e-02  1.99840824e-01]
 [ 3.18778938e-02  2.16245572e-02  6.39391872e-03]
 [-1.33316889e-01  1.71252504e-01  2.34189275e-02]
 [-6.17547815e-02 -9.35244468e-03 -1.10559455e-01]
 [ 3.64266633e-02 -1.01576579e-01 -1.40366466e-01]
 [-4.85080834e-02  2.10352083e-02 -1.58873987e-02]
 [ 8.27594469e-03 -6.37737147e-02 -2.24159518e-02]
 [ 6.76286838e-02 -7.35993845e-03  7.11727037e-02]
 [-2.49958479e-02  1.05210899e-01  7.10188316e-02]
 [ 4.24730368e-02 -1.63683347e-02 -2.41914068e-03]
 [-2.21864874e-01 -7.21754047e-01 -1.63909523e-02]
 [ 6.34851492e-02 -1.44821743e-02 -5.60246329e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.25151208 -29.28467519 -29.2776944 ]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  8.31409947  -9.26062741 -83.52111278]
init_Out:  [2.49223638]
Stock Position:  8.314099471154409
Bond position:  [-828.91771073]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [1.03439096]
curr_Stock_Price:  99.84958201515049
curr_Factors:  [99.84958202 -0.82080502 -0.99088524]
mat_Sqrt:  [[16.31320017  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00974069  0.00464721 -0.3531748 ]
Stock Position:  -0.009740692183217008
Bond Position:  [2.00699501]


portfolio before change:  [1.02661922]
curr_Stock_Price:  100.69896306096952
curr_Factors:  [100.69896306  -1.20931518  -0.97017498]
mat_Sqrt:  [[11.38897004  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0247539  -0.01507291  0.59141833]
Stock Position:  -0.02475390419628531
Bond Position:  [3.5193117]


portfolio before change:  [1.04264053]
curr_Stock_Price:  100.08728672553003
curr_Factors:  [100.08728673  -1.1117293   -0.96924221]
mat_Sqrt:  [[12.49178419  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00427975 -0.00305425 -0.19523181]
Stock Position:  -0.004279750283633018
Bond Position:  [1.47098912]


portfolio before change:  [1.03882246]
curr_Stock_Price:  101.06534885427781
curr_Factors:  [101.06534885  -0.97375872  -0.97974028]
mat_Sqrt:  [[14.32875447  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0042688  -0.07649896  0.61364875]
Stock Position:  -0.004268802803729397
Bond Position:  [1.47025051]


portfolio before change:  [1.04189192]
curr_Stock_Price:  100.43241889423062
curr_Factors:  [100.43241889  -1.05066894  -0.92817284]
mat_Sqrt:  [[13.88269739  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00149803 -0.05503169  0.07246282]
Stock Position:  0.0014980339299884612
Bond Position:  [0.89144075]


portfolio before change:  [1.04175275]
curr_Stock_Price:  100.19072670463038
curr_Factors:  [100.1907267   -1.29381161  -0.92720716]
mat_Sqrt:  [[10.87054527  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00490049  0.01105958 -0.05253756]
Stock Position:  0.004900492768689467
Bond Position:  [0.55076882]


portfolio before change:  [1.03374994]
curr_Stock_Price:  98.52956421342579
curr_Factors:  [98.52956421 -1.44986347 -0.92582471]
mat_Sqrt:  [[ 9.1583723   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00826564  0.02644513 -0.33844657]
Stock Position:  -0.00826563535638482
Bond Position:  [1.84815939]


portfolio before change:  [1.03718323]
curr_Stock_Price:  98.1701010069143
curr_Factors:  [98.17010101 -1.48352005 -0.93779153]
mat_Sqrt:  [[ 8.71800227  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01456176 -0.03014921  0.57009025]
Stock Position:  -0.01456175677026518
Bond Position:  [2.46671237]


portfolio before change:  [1.04659816]
curr_Stock_Price:  97.56590368851873
curr_Factors:  [97.56590369 -1.56022022 -0.91478608]
mat_Sqrt:  [[ 8.21138648  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.0041091  0.00683829 0.01824007]
Stock Position:  0.004109097862720348
Bond Position:  [0.64569032]


portfolio before change:  [1.04454745]
curr_Stock_Price:  97.02754903808899
curr_Factors:  [97.02754904 -1.60732463 -0.89882492]
mat_Sqrt:  [[ 7.91567833  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01567962  0.0541548   0.06680768]
Stock Position:  -0.015679616451545954
Bond Position:  [2.56590221]


portfolio before change:  [1.04771804]
curr_Stock_Price:  96.86625484556498
curr_Factors:  [96.86625485 -1.18585079 -0.91976812]
mat_Sqrt:  [[11.7954316   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00716923 -0.0029575  -0.31539535]
Stock Position:  -0.007169225995889732
Bond Position:  [1.74217411]


portfolio before change:  [1.04184732]
curr_Stock_Price:  97.7458922993054
curr_Factors:  [97.7458923  -1.55067901 -0.94715119]
mat_Sqrt:  [[ 8.04089969  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0006407  -0.03212133 -0.40042646]
Stock Position:  0.0006406972793105883
Bond Position:  [0.97922179]


portfolio before change:  [1.04255982]
curr_Stock_Price:  98.47581666255086
curr_Factors:  [98.47581666 -1.41234587 -0.94097079]
mat_Sqrt:  [[ 9.36045913  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00547067  0.00665192 -0.04532233]
Stock Position:  -0.005470667364856101
Bond Position:  [1.58128825]


portfolio before change:  [1.03974639]
curr_Stock_Price:  99.062362268838
curr_Factors:  [99.06236227 -1.54442998 -0.92923491]
mat_Sqrt:  [[ 8.34852333  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00024599 -0.02016702 -0.06394647]
Stock Position:  0.00024599289744879773
Bond Position:  [1.01537775]


portfolio before change:  [1.03999361]
curr_Stock_Price:  99.03528955535944
curr_Factors:  [99.03528956 -1.6447436  -0.90637316]
mat_Sqrt:  [[ 7.7242095   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01061166 -0.00232742  0.20303591]
Stock Position:  0.010611664311186627
Bond Position:  [-0.01093564]


portfolio before change:  [1.05652074]
curr_Stock_Price:  100.59299644408837
curr_Factors:  [100.59299644  -1.77134912  -0.89234459]
mat_Sqrt:  [[ 7.01035907  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00111017  0.03327061  0.20259696]
Stock Position:  -0.0011101650944624886
Bond Position:  [1.16819557]


portfolio before change:  [1.05723313]
curr_Stock_Price:  100.2143944921353
curr_Factors:  [100.21439449  -1.88088508  -0.88248073]
mat_Sqrt:  [[ 6.32143367  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00657392 -0.00517612 -0.00690113]
Stock Position:  0.006573920636901617
Bond Position:  [0.39843166]


portfolio before change:  [1.06244892]
curr_Stock_Price:  100.99264635980794
curr_Factors:  [100.99264636  -2.06129255  -0.88986239]
mat_Sqrt:  [[ 5.27982401  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.04618455 -0.22823867 -0.04675882]
Stock Position:  -0.04618454554791955
Bond Position:  [5.72674839]


portfolio before change:  [1.07136595]
curr_Stock_Price:  100.83057564479394
curr_Factors:  [100.83057564  -2.39767538  -0.85961553]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [1.07136595]
Stock Price:  100.66069402730004
PL:  [0.41067192]
Settle:  Tensor("sub_352:0", shape=(), dtype=float64)
PL:  Tensor("sub_353:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  177
output_Z_Vals[:, i, :]:  [[ 1.19251512e+02 -2.92846752e+01 -2.92776944e+01]
 [-3.93018566e-01  1.50245661e-01  4.52410449e-01]
 [-3.04491664e-01 -8.04938462e-02  2.54233227e-01]
 [-2.32574386e-02  3.94389015e-02  6.48225474e-02]
 [-8.76991714e-02 -1.48901139e-01  1.20769260e-01]
 [-5.59023631e-02  2.94769552e-02 -4.93193342e-03]
 [-1.78369832e-01 -1.52735411e-01  1.28140960e-01]
 [-2.71982015e-02  3.77157189e-02 -1.04325235e-01]
 [-2.46508979e-01 -1.41578162e-01  3.05366465e-01]
 [ 2.89952758e-02  2.04535103e-02  6.81126086e-03]
 [-8.62268172e-02  1.40028725e-01  2.77319243e-02]
 [-8.55604393e-02 -9.21130224e-03 -1.24039768e-01]
 [ 2.31918597e-02 -1.45717516e-01 -2.12677491e-01]
 [ 2.59466288e-02 -6.21554132e-03  5.98252173e-03]
 [ 1.11348156e-02 -5.79141975e-02 -1.09473076e-01]
 [ 1.69209182e-01  3.71983222e-02 -9.06456792e-02]
 [-1.95655116e-02  9.16112378e-02  7.13235137e-02]
 [ 4.28907544e-02 -2.44409683e-02  5.73934014e-02]
 [-3.02084892e-01 -7.74419546e-01 -1.51624970e-01]
 [ 8.90593293e-02 -1.01266466e-01 -1.94116462e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.25151208 -29.28467519 -29.2776944 ]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  8.31409947  -9.26062741 -83.52111278]
init_Out:  [2.49223638]
Stock Position:  8.314099471154409
Bond position:  [-828.91771073]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-16.63230459]
curr_Stock_Price:  97.72467412595851
curr_Factors:  [97.72467413 -0.90765324 -0.99420522]
mat_Sqrt:  [[14.58940564  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02034294  0.04751185  1.29060109]
Stock Position:  -0.02034293588933009
Bond Position:  [-14.64429781]


portfolio before change:  [-16.6255135]
curr_Stock_Price:  97.21085331191351
curr_Factors:  [97.21085331 -0.8888114  -1.0132834 ]
mat_Sqrt:  [[14.50926723  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01755257 -0.02545439  0.72525663]
Stock Position:  -0.017552565698805495
Bond Position:  [-14.91921361]


portfolio before change:  [-16.65120872]
curr_Stock_Price:  98.4622344599514
curr_Factors:  [98.46223446 -1.12427984 -1.03864389]
mat_Sqrt:  [[11.32201809  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00079555  0.01247168  0.18492068]
Stock Position:  -0.0007955545914900505
Bond Position:  [-16.57287664]


portfolio before change:  [-16.65600954]
curr_Stock_Price:  99.28817225832067
curr_Factors:  [99.28817226 -1.07863175 -1.00943655]
mat_Sqrt:  [[12.30441521  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00543641 -0.04708667  0.34452108]
Stock Position:  -0.0054364111805537815
Bond Position:  [-16.11623821]


portfolio before change:  [-16.65196338]
curr_Stock_Price:  97.80268440216611
curr_Factors:  [97.8026844  -0.94875791 -1.00704952]
mat_Sqrt:  [[13.83421129  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00405863  0.00932143 -0.01406943]
Stock Position:  -0.004058633841612592
Bond Position:  [-16.25501809]


portfolio before change:  [-16.65112278]
curr_Stock_Price:  96.59418455472729
curr_Factors:  [96.59418455 -1.04147465 -1.02602744]
mat_Sqrt:  [[12.21929733  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01277952 -0.04829918  0.36555049]
Stock Position:  -0.012779522042464112
Bond Position:  [-15.41669527]


portfolio before change:  [-16.65896368]
curr_Stock_Price:  96.90610872306247
curr_Factors:  [96.90610872 -0.98325573 -1.03575626]
mat_Sqrt:  [[12.86783214  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00369291  0.01192676 -0.29761086]
Stock Position:  -0.003692905283736283
Bond Position:  [-16.3010986]


portfolio before change:  [-16.66325062]
curr_Stock_Price:  96.96328686997307
curr_Factors:  [96.96328687 -0.89189922 -1.06208212]
mat_Sqrt:  [[13.74054677  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0136699  -0.04477095  0.87112553]
Stock Position:  -0.013669895809326415
Bond Position:  [-15.33777259]


portfolio before change:  [-16.6672069]
curr_Stock_Price:  96.97216499154524
curr_Factors:  [96.97216499 -0.79878369 -1.09244044]
mat_Sqrt:  [[14.63183808  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00211277 0.00646797 0.01943063]
Stock Position:  0.0021127711912701623
Bond Position:  [-16.8720869]


portfolio before change:  [-16.67450651]
curr_Stock_Price:  95.51386264233777
curr_Factors:  [95.51386264 -1.07925197 -1.07635155]
mat_Sqrt:  [[11.06368227  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00695524  0.04428097  0.07911146]
Stock Position:  -0.006955237308807295
Bond Position:  [-16.01018493]


portfolio before change:  [-16.68020795]
curr_Stock_Price:  95.7580517471578
curr_Factors:  [95.75805175 -1.04827454 -1.06404417]
mat_Sqrt:  [[11.58262362  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00959349 -0.00291287 -0.35385093]
Stock Position:  -0.009593490162590911
Bond Position:  [-15.76155402]


portfolio before change:  [-16.69975266]
curr_Stock_Price:  97.38455292759711
curr_Factors:  [97.38455293 -1.24500985 -1.03897839]
mat_Sqrt:  [[ 9.9212544   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00241735 -0.04607992 -0.60670968]
Stock Position:  -0.0024173517187892025
Bond Position:  [-16.46433994]


portfolio before change:  [-16.70147744]
curr_Stock_Price:  96.39511491741028
curr_Factors:  [96.39511492 -0.81730686 -1.07409628]
mat_Sqrt:  [[14.54216537  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00185717 -0.00196553  0.01706647]
Stock Position:  0.0018571733044490456
Bond Position:  [-16.88049987]


portfolio before change:  [-16.70769114]
curr_Stock_Price:  95.32195157777309
curr_Factors:  [95.32195158 -0.93277145 -1.11319945]
mat_Sqrt:  [[12.32080416  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00103131 -0.01831408 -0.31229621]
Stock Position:  -0.0010313142309327165
Bond Position:  [-16.60938425]


portfolio before change:  [-16.71251311]
curr_Stock_Price:  95.97074295346913
curr_Factors:  [95.97074295 -0.73949212 -1.11977254]
mat_Sqrt:  [[14.95100801  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01014424  0.01176314 -0.25858689]
Stock Position:  0.010144243581140942
Bond Position:  [-17.6860637]


portfolio before change:  [-16.71140708]
curr_Stock_Price:  96.51569246958684
curr_Factors:  [96.51569247 -0.85544344 -1.1304812 ]
mat_Sqrt:  [[13.24713053  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-1.99384189e-04  2.89700171e-02  2.03466132e-01]
Stock Position:  -0.00019938418857599373
Bond Position:  [-16.69216338]


portfolio before change:  [-16.71549757]
curr_Stock_Price:  96.09903055037681
curr_Factors:  [96.09903055 -0.76025279 -1.09624369]
mat_Sqrt:  [[15.01249339  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00359534 -0.00772891  0.1637274 ]
Stock Position:  0.0035953434857036583
Bond Position:  [-17.06100659]


portfolio before change:  [-16.72153504]
curr_Stock_Price:  95.60625737799863
curr_Factors:  [95.60625738 -0.96023007 -1.14749315]
mat_Sqrt:  [[11.61752861  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.03038776 -0.24489296 -0.43254384]
Stock Position:  -0.03038775702683319
Bond Position:  [-13.81627532]


portfolio before change:  [-16.71788461]
curr_Stock_Price:  95.37244833436363
curr_Factors:  [95.37244833 -1.20802734 -1.1587132 ]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-16.71788461]
Stock Price:  95.86803535087904
PL:  [-16.71788461]
Settle:  Tensor("sub_354:0", shape=(), dtype=float64)
PL:  Tensor("sub_355:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  178
output_Z_Vals[:, i, :]:  [[ 1.19251512e+02 -2.92846752e+01 -2.92776944e+01]
 [-1.78755666e-01  5.25049401e-02  5.26343250e-02]
 [-6.93595060e-02  2.12185775e-02  9.98284934e-02]
 [-4.95671362e-02 -1.23756989e-01 -3.99536443e-01]
 [-9.64982480e-02 -2.22429046e-01  1.95349271e-01]
 [-7.96745999e-02  2.56357696e-02 -2.41477622e-02]
 [ 5.45708765e-02  5.08201452e-02 -2.47912960e-02]
 [-8.78860225e-02  1.38288105e-01 -6.59428303e-02]
 [-1.55923258e-01 -5.37668870e-02  1.00453074e-01]
 [-9.48647336e-02 -6.98950811e-02 -4.38412053e-02]
 [ 1.40841440e-01 -9.26374803e-03 -3.70816787e-02]
 [ 1.22500479e-01 -1.12913326e-02 -1.42182616e-01]
 [ 4.85992538e-02 -7.66636354e-03 -1.49670038e-01]
 [-8.45720117e-02  2.97281712e-02 -3.59999752e-02]
 [-1.33919577e-01  8.84860167e-02  2.60250484e-01]
 [-1.32095437e-01 -2.59731724e-01  2.08995206e-01]
 [-4.80070642e-02 -9.50821174e-02  2.58008552e-01]
 [-2.90220409e-01  4.41010756e-01 -7.79548211e-02]
 [-2.73498531e-01 -9.99597874e-01 -1.05660945e-01]
 [ 1.08816041e-01 -5.51653701e-02 -1.28358168e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.25151208 -29.28467519 -29.2776944 ]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  8.31409947  -9.26062741 -83.52111278]
init_Out:  [2.49223638]
Stock Position:  8.314099471154409
Bond position:  [-828.91771073]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-5.30737448]
curr_Stock_Price:  99.08680963512496
curr_Factors:  [99.08680964 -0.79172469 -1.00097354]
mat_Sqrt:  [[16.49897241  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.010101    0.01660352  0.15015108]
Stock Position:  -0.01010099619824603
Bond Position:  [-4.30649899]


portfolio before change:  [-5.31437722]
curr_Stock_Price:  99.67348297825195
curr_Factors:  [99.67348298 -0.47147232 -1.01859319]
mat_Sqrt:  [[22.46220588  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00215625  0.0067099   0.2847829 ]
Stock Position:  -0.0021562547798800436
Bond Position:  [-5.0994558]


portfolio before change:  [-5.31956331]
curr_Stock_Price:  101.48730740760162
curr_Factors:  [101.48730741  -0.29169647  -1.01043389]
mat_Sqrt:  [[27.59965801  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00486664 -0.0391354  -1.13976626]
Stock Position:  -0.004866638665838863
Bond Position:  [-4.82566126]


portfolio before change:  [-5.30875274]
curr_Stock_Price:  99.01801713735546
curr_Factors:  [99.01801714  0.10118721 -0.99866726]
mat_Sqrt:  [[40.35929685  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00154527 -0.07033824  0.5572771 ]
Stock Position:  -0.001545265730025083
Bond Position:  [-5.15574359]


portfolio before change:  [-5.31078483]
curr_Stock_Price:  99.49883895526524
curr_Factors:  [99.49883896 -0.11385249 -0.98522529]
mat_Sqrt:  [[33.15084465  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00253212  0.00810674 -0.06888684]
Stock Position:  -0.002532117337095345
Bond Position:  [-5.0588421]


portfolio before change:  [-5.31681693]
curr_Stock_Price:  101.38154341216604
curr_Factors:  [ 1.01381543e+02 -4.52059178e-02 -9.81326875e-01]
mat_Sqrt:  [[36.31962629  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00139931  0.01607074 -0.07072267]
Stock Position:  0.001399313542581387
Bond Position:  [-5.45868149]


portfolio before change:  [-5.32088708]
curr_Stock_Price:  99.44823038884552
curr_Factors:  [99.44823039 -0.1242561  -0.96850425]
mat_Sqrt:  [[33.34396704  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00293234  0.04373054 -0.18811654]
Stock Position:  -0.002932343435508935
Bond Position:  [-5.02927071]


portfolio before change:  [-5.3313103]
curr_Stock_Price:  102.57397121903007
curr_Factors:  [102.57397122  -0.35467141  -0.99890232]
mat_Sqrt:  [[26.49644253  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00516321 -0.01700258  0.28656466]
Stock Position:  -0.005163206914683443
Bond Position:  [-4.80169966]


portfolio before change:  [-5.35406355]
curr_Stock_Price:  106.74825191203425
curr_Factors:  [106.74825191  -0.41854811  -0.99114913]
mat_Sqrt:  [[26.06976038  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00405138 -0.02210277 -0.12506676]
Stock Position:  -0.00405137844767284
Bond Position:  [-4.92158598]


portfolio before change:  [-5.34236089]
curr_Stock_Price:  103.55595203412511
curr_Factors:  [103.55595203  -0.66951317  -0.9889442 ]
mat_Sqrt:  [[19.72042095  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00674595 -0.00292945 -0.10578371]
Stock Position:  0.00674595057827951
Bond Position:  [-6.04094422]


portfolio before change:  [-5.3482101]
curr_Stock_Price:  102.91278209730339
curr_Factors:  [102.9127821   -1.07426559  -0.98622272]
mat_Sqrt:  [[13.11023927  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00710788 -0.00357063 -0.40560743]
Stock Position:  0.0071078819401751625
Bond Position:  [-6.07970201]


portfolio before change:  [-5.34038441]
curr_Stock_Price:  104.22763292655273
curr_Factors:  [104.22763293  -1.23450723  -1.01360179]
mat_Sqrt:  [[11.00630471  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0016218  -0.00242432 -0.42696696]
Stock Position:  0.001621801422303886
Bond Position:  [-5.50942094]


portfolio before change:  [-5.34052387]
curr_Stock_Price:  104.99102762220758
curr_Factors:  [104.99102762  -1.38682129  -1.03814682]
mat_Sqrt:  [[ 9.2897049   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00981225  0.00940087 -0.10269791]
Stock Position:  -0.0098122490195531
Bond Position:  [-4.31032576]


portfolio before change:  [-5.33738951]
curr_Stock_Price:  104.56176057757968
curr_Factors:  [104.56176058  -1.54280684  -1.02154155]
mat_Sqrt:  [[ 8.04804747  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00975534  0.02798174  0.74242219]
Stock Position:  -0.00975534382633157
Bond Position:  [-4.31735358]


portfolio before change:  [-5.35263699]
curr_Stock_Price:  106.0140935511866
curr_Factors:  [106.01409355  -1.40375875  -1.00639432]
mat_Sqrt:  [[ 9.52022961  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01009857 -0.08213438  0.59620515]
Stock Position:  -0.010098570831049317
Bond Position:  [-4.28204616]


portfolio before change:  [-5.37030754]
curr_Stock_Price:  107.65788097516283
curr_Factors:  [107.65788098  -1.1906305   -1.00742962]
mat_Sqrt:  [[11.95199619  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 1.84379346e-04 -3.00676056e-02  7.36026583e-01]
Stock Position:  0.00018437934645513788
Bond Position:  [-5.39015743]


portfolio before change:  [-5.37127575]
curr_Stock_Price:  109.71611117369271
curr_Factors:  [109.71611117  -1.02349883  -1.04991736]
mat_Sqrt:  [[13.7973981   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02136244  0.13945985 -0.22238341]
Stock Position:  -0.02136243508706467
Bond Position:  [-3.02747245]


portfolio before change:  [-5.37471487]
curr_Stock_Price:  109.84166575699801
curr_Factors:  [109.84166576  -1.2688321   -1.02975515]
mat_Sqrt:  [[11.02816743  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02909604 -0.3161006  -0.30142127]
Stock Position:  -0.029096038817896307
Bond Position:  [-2.17875749]


portfolio before change:  [-5.36414422]
curr_Stock_Price:  109.45964111996511
curr_Factors:  [109.45964112  -1.16639616  -1.02126114]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-5.36414422]
Stock Price:  109.01196182536444
PL:  [-14.37610604]
Settle:  Tensor("sub_356:0", shape=(), dtype=float64)
PL:  Tensor("sub_357:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  179
output_Z_Vals[:, i, :]:  [[ 1.19251512e+02 -2.92846752e+01 -2.92776944e+01]
 [-1.46459694e-01  1.90866097e-03 -8.53127102e-02]
 [-3.39399067e-01 -5.20304338e-02  2.14937098e-01]
 [-3.96976510e-02 -1.16203112e-02 -7.39963653e-02]
 [-9.88296441e-02 -2.41910939e-01  2.15109929e-01]
 [ 2.20720562e-02 -1.79041087e-01  2.99558741e-02]
 [ 5.54991341e-02  3.53762223e-02 -1.87347002e-02]
 [-8.78317905e-02  1.56838226e-01 -1.06880982e-01]
 [-3.70913646e-02 -2.29680798e-02  3.41571251e-02]
 [ 4.50470017e-02  4.74936917e-02 -1.18045691e-02]
 [ 6.91478497e-02  5.71182707e-02 -1.50433489e-02]
 [ 1.48088949e-01 -1.20417417e-02 -1.53233509e-01]
 [ 4.73823221e-02 -8.37329646e-03 -1.62828820e-01]
 [-8.37860496e-02  2.92561523e-02 -3.57974642e-02]
 [-1.56670628e-01  1.20549697e-01  2.93062005e-01]
 [-1.18079232e-01 -2.31071258e-01  1.96494455e-01]
 [-2.85530555e-02 -3.48994332e-02  2.55139157e-01]
 [-1.44470891e-01  2.35095149e-01 -8.74246151e-02]
 [-3.05285768e-01 -9.70373613e-01 -1.26396314e-01]
 [ 8.63423324e-02 -2.99433028e-02 -8.75395920e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.25151208 -29.28467519 -29.2776944 ]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  8.31409947  -9.26062741 -83.52111278]
init_Out:  [2.49223638]
Stock Position:  8.314099471154409
Bond position:  [-828.91771073]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [1.93957083]
curr_Stock_Price:  99.95845488429231
curr_Factors:  [99.95845488 -1.32055417 -0.9458862 ]
mat_Sqrt:  [[10.36375136  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01580748  0.00060357 -0.24337342]
Stock Position:  -0.01580748037140222
Bond Position:  [3.51966214]


portfolio before change:  [1.93402623]
curr_Stock_Price:  100.36488394410678
curr_Factors:  [100.36488394  -1.71843799  -0.92983876]
mat_Sqrt:  [[ 7.1031307   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.04179406 -0.01645347  0.61315571]
Stock Position:  -0.04179405506135436
Bond Position:  [6.12868172]


portfolio before change:  [1.93302943]
curr_Stock_Price:  100.4253988621148
curr_Factors:  [100.42539886  -1.60964069  -0.93075233]
mat_Sqrt:  [[ 7.91707743  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00695991 -0.00367467 -0.21109103]
Stock Position:  -0.006959908057203169
Bond Position:  [2.63198097]


portfolio before change:  [1.93849579]
curr_Stock_Price:  99.73454469568131
curr_Factors:  [99.7345447  -1.46673246 -0.94913104]
mat_Sqrt:  [[ 8.90531777  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00686855 -0.07649896  0.61364875]
Stock Position:  -0.006868550773600852
Bond Position:  [2.62352757]


portfolio before change:  [1.93627711]
curr_Stock_Price:  100.15306705605066
curr_Factors:  [100.15306706  -1.43678763  -0.9834613 ]
mat_Sqrt:  [[ 8.90355605  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00264658 -0.05661776  0.08545577]
Stock Position:  0.002646577649201645
Bond Position:  [1.67121424]


portfolio before change:  [1.93708753]
curr_Stock_Price:  100.30139380212184
curr_Factors:  [100.3013938   -1.30940163  -0.9911177 ]
mat_Sqrt:  [[10.05088069  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00523221  0.01118694 -0.05344489]
Stock Position:  0.005232212101392208
Bond Position:  [1.41228936]


portfolio before change:  [1.93808741]
curr_Stock_Price:  100.42500641622937
curr_Factors:  [100.42500642  -1.44323978  -0.9757892 ]
mat_Sqrt:  [[ 8.9386294   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01181381  0.0495966  -0.30490169]
Stock Position:  -0.011813806056953119
Bond Position:  [3.12448896]


portfolio before change:  [1.93218914]
curr_Stock_Price:  100.99040346045636
curr_Factors:  [100.99040346  -1.73984792  -0.96511008]
mat_Sqrt:  [[ 6.75354459  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00454755 -0.00726314  0.09744077]
Stock Position:  -0.004547553283353829
Bond Position:  [2.39144838]


portfolio before change:  [1.93226246]
curr_Stock_Price:  101.1057664069221
curr_Factors:  [101.10576641  -1.28033706  -0.97820691]
mat_Sqrt:  [[10.56580874  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00415147  0.01501882 -0.03367515]
Stock Position:  0.004151474540620407
Bond Position:  [1.51252444]


portfolio before change:  [1.93495085]
curr_Stock_Price:  101.66224655076397
curr_Factors:  [101.66224655  -1.20993881  -1.01248641]
mat_Sqrt:  [[11.01470051  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00613289  0.01806238 -0.04291449]
Stock Position:  0.006132888161156191
Bond Position:  [1.31146766]


portfolio before change:  [1.93715459]
curr_Stock_Price:  101.96811134840537
curr_Factors:  [101.96811135  -1.05475107  -1.03137914]
mat_Sqrt:  [[12.66104452  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0092014  -0.00380793 -0.43713255]
Stock Position:  0.009201403033512965
Bond Position:  [0.9989049]


portfolio before change:  [1.95797079]
curr_Stock_Price:  104.20325308654093
curr_Factors:  [104.20325309  -1.16896248  -1.05214391]
mat_Sqrt:  [[11.30490788  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0012321  -0.00264787 -0.4645053 ]
Stock Position:  0.0012321047657590915
Bond Position:  [1.82958146]


portfolio before change:  [1.95920022]
curr_Stock_Price:  104.82980458058832
curr_Factors:  [104.82980458  -1.19371832  -1.05327044]
mat_Sqrt:  [[11.08230139  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00815154  0.00925161 -0.1021202 ]
Stock Position:  -0.008151536634784665
Bond Position:  [2.81372421]


portfolio before change:  [1.94881309]
curr_Stock_Price:  106.19036377568601
curr_Factors:  [106.19036378  -1.29012343  -1.09064768]
mat_Sqrt:  [[ 9.82040397  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00954513  0.03812116  0.83602433]
Stock Position:  -0.009545128439900468
Bond Position:  [2.96241375]


portfolio before change:  [1.95563478]
curr_Stock_Price:  105.55328543850283
curr_Factors:  [105.55328544  -1.13384042  -1.07694569]
mat_Sqrt:  [[11.57016492  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00725454 -0.07307115  0.56054399]
Stock Position:  -0.007254538250639806
Bond Position:  [2.72137513]


portfolio before change:  [1.95495054]
curr_Stock_Price:  105.74139838864022
curr_Factors:  [105.74139839  -1.0721162   -1.10730434]
mat_Sqrt:  [[11.96009793  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00189178 -0.01103617  0.727841  ]
Stock Position:  0.0018917827706879636
Bond Position:  [1.75491078]


portfolio before change:  [1.95546828]
curr_Stock_Price:  105.7831382825168
curr_Factors:  [105.78313828  -1.05255315  -1.09228434]
mat_Sqrt:  [[12.38583699  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01261491  0.07434361 -0.24939809]
Stock Position:  -0.012614911323533522
Bond Position:  [3.28991319]


portfolio before change:  [1.94958058]
curr_Stock_Price:  106.31507100832624
curr_Factors:  [106.31507101  -1.15369512  -1.09130457]
mat_Sqrt:  [[11.26169745  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.03162412 -0.30685908 -0.3605735 ]
Stock Position:  -0.03162411775513168
Bond Position:  [5.3117009]


portfolio before change:  [1.92106385]
curr_Stock_Price:  107.2588070543564
curr_Factors:  [107.25880705  -1.17055246  -1.07560193]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [1.92106385]
Stock Price:  106.91130901119901
PL:  [-4.99024516]
Settle:  Tensor("sub_358:0", shape=(), dtype=float64)
PL:  Tensor("sub_359:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  180
output_Z_Vals[:, i, :]:  [[ 1.19251512e+02 -2.92846752e+01 -2.92776944e+01]
 [-1.48110754e-01  1.77611209e-02 -1.22063582e-01]
 [-5.75137025e-02  2.44355262e-02  9.48086166e-02]
 [-4.64903469e-02 -1.39071243e-02 -8.13930398e-02]
 [-9.12775976e-02 -1.78803616e-01  1.51099608e-01]
 [-7.31645146e-02  4.53175840e-02 -1.38341869e-02]
 [-8.38236426e-02 -5.38702051e-02  5.71014956e-02]
 [-9.43070508e-02  1.49645927e-01 -7.03514031e-02]
 [-3.14901972e-01 -1.62819368e-01  3.51643617e-01]
 [ 4.65014983e-02  3.66344227e-02  1.61703341e-03]
 [-3.88785576e-02  1.16794655e-01  1.51640017e-02]
 [-8.67879503e-02 -9.20374334e-03 -1.24738690e-01]
 [-1.54433384e-02 -3.07240275e-01 -1.86802515e-01]
 [ 6.07213787e-02 -2.65528965e-02  1.32015978e-02]
 [ 1.11348156e-02 -5.79141975e-02 -1.09473076e-01]
 [ 1.83006966e-01  5.30194442e-02 -1.48565210e-01]
 [ 2.25003301e-02 -3.67967667e-02  1.13386076e-01]
 [ 4.16196696e-02 -2.49874608e-02  6.99696018e-02]
 [-3.82078440e-01 -9.61550697e-01 -2.29526487e-01]
 [ 1.26938214e-01 -2.05172484e-01 -3.71343955e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.25151208 -29.28467519 -29.2776944 ]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  8.31409947  -9.26062741 -83.52111278]
init_Out:  [2.49223638]
Stock Position:  8.314099471154409
Bond position:  [-828.91771073]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [0.48696135]
curr_Stock_Price:  99.78373849006238
curr_Factors:  [99.78373849 -0.75230154 -0.99489907]
mat_Sqrt:  [[17.38842249  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00992432  0.00561656 -0.34821342]
Stock Position:  -0.009924321101636432
Bond Position:  [1.47724721]


portfolio before change:  [0.49262346]
curr_Stock_Price:  99.25042653626255
curr_Factors:  [99.25042654 -0.89103702 -0.97464716]
mat_Sqrt:  [[15.36300024  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00244289  0.00772719  0.27046259]
Stock Position:  -0.0024428856044629824
Bond Position:  [0.7350809]


portfolio before change:  [0.49134986]
curr_Stock_Price:  99.84701250270203
curr_Factors:  [99.8470125  -0.60539673 -0.95413367]
mat_Sqrt:  [[20.99131415  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00302333 -0.00439782 -0.23219169]
Stock Position:  -0.0030233320074160666
Bond Position:  [0.79322053]


portfolio before change:  [0.49530213]
curr_Stock_Price:  98.6053569533157
curr_Factors:  [98.60535695 -0.42579514 -0.97467264]
mat_Sqrt:  [[24.30440998  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00267652 -0.05654267  0.43104512]
Stock Position:  -0.0026765187357342146
Bond Position:  [0.75922122]


portfolio before change:  [0.49504703]
curr_Stock_Price:  98.77159355120185
curr_Factors:  [98.77159355 -0.40979991 -0.98547784]
mat_Sqrt:  [[24.47206592  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00305729  0.01433068 -0.03946508]
Stock Position:  -0.003057294445376079
Bond Position:  [0.79702087]


portfolio before change:  [0.4961185]
curr_Stock_Price:  98.4863102032075
curr_Factors:  [98.4863102  -0.4331427  -0.97066253]
mat_Sqrt:  [[24.19418514  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00304035 -0.01703525  0.16289467]
Stock Position:  -0.0030403491959678035
Bond Position:  [0.79555127]


portfolio before change:  [0.49196513]
curr_Stock_Price:  99.91781685570764
curr_Factors:  [99.91781686 -0.34541892 -0.99007322]
mat_Sqrt:  [[26.28125315  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00398777  0.0473222  -0.20069297]
Stock Position:  -0.003987771399232636
Bond Position:  [0.89041455]


portfolio before change:  [0.50389376]
curr_Stock_Price:  96.98234327041183
curr_Factors:  [96.98234327 -0.42343073 -0.98587028]
mat_Sqrt:  [[23.69414369  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01043832 -0.05148801  1.00314136]
Stock Position:  -0.010438317615198577
Bond Position:  [1.51622626]


portfolio before change:  [0.49616049]
curr_Stock_Price:  97.75951597487668
curr_Factors:  [97.75951597 -0.74248535 -0.99597504]
mat_Sqrt:  [[17.18522773  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00278015 0.01158482 0.00461295]
Stock Position:  0.002780147657635281
Bond Position:  [0.2243746]


portfolio before change:  [0.49294279]
curr_Stock_Price:  96.58195066971274
curr_Factors:  [96.58195067 -0.9180472  -1.01931302]
mat_Sqrt:  [[13.91589418  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00235469  0.03693371  0.04325868]
Stock Position:  -0.002354688335814389
Bond Position:  [0.72036318]


portfolio before change:  [0.49528255]
curr_Stock_Price:  95.66478211730107
curr_Factors:  [95.66478212 -1.0810038  -1.02126958]
mat_Sqrt:  [[11.6881657   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00962407 -0.00291048 -0.35584476]
Stock Position:  -0.009624073714644032
Bond Position:  [1.41596746]


portfolio before change:  [0.50465781]
curr_Stock_Price:  94.72742144875956
curr_Factors:  [94.72742145 -1.02226805 -1.03357292]
mat_Sqrt:  [[12.12370412  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0050733  -0.09715791 -0.53289558]
Stock Position:  -0.0050732970056211165
Bond Position:  [0.98523815]


portfolio before change:  [0.50123828]
curr_Stock_Price:  95.45000203371704
curr_Factors:  [95.45000203 -0.94490433 -1.01664681]
mat_Sqrt:  [[13.42409776  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00467298 -0.00839676  0.03766048]
Stock Position:  0.004672980774012009
Bond Position:  [0.05520226]


portfolio before change:  [0.49634619]
curr_Stock_Price:  94.40015885374743
curr_Factors:  [94.40015885 -0.82420144 -1.07125297]
mat_Sqrt:  [[14.18362816  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00089587 -0.01831408 -0.31229621]
Stock Position:  -0.0008958653258988729
Bond Position:  [0.58091602]


portfolio before change:  [0.49783875]
curr_Stock_Price:  92.8962341908505
curr_Factors:  [92.89623419 -1.02976576 -1.08417259]
mat_Sqrt:  [[11.21828184  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01373207  0.01676622 -0.42381519]
Stock Position:  0.013732065018287333
Bond Position:  [-0.77781838]


portfolio before change:  [0.5174168]
curr_Stock_Price:  94.33611468512196
curr_Factors:  [94.33611469 -0.87165444 -1.09900389]
mat_Sqrt:  [[13.14715991  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0033996  -0.01163616  0.32345891]
Stock Position:  0.003399599438293288
Bond Position:  [0.1967118]


portfolio before change:  [0.51688066]
curr_Stock_Price:  94.16393936127247
curr_Factors:  [94.16393936 -0.79955549 -1.1098555 ]
mat_Sqrt:  [[13.95204805  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00396049 -0.00790173  0.1996038 ]
Stock Position:  0.003960492470358216
Bond Position:  [0.14394509]


portfolio before change:  [0.51521058]
curr_Stock_Price:  93.7331655769272
curr_Factors:  [93.73316558 -0.43005098 -1.08995566]
mat_Sqrt:  [[20.50042136  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02213406 -0.30406903 -0.65477518]
Stock Position:  -0.022134055781562852
Bond Position:  [2.58990569]


portfolio before change:  [0.55023023]
curr_Stock_Price:  92.18026024073767
curr_Factors:  [92.18026024 -0.41957501 -1.06670215]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [0.55023023]
Stock Price:  90.19156119512208
PL:  [0.55023023]
Settle:  Tensor("sub_360:0", shape=(), dtype=float64)
PL:  Tensor("sub_361:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  181
output_Z_Vals[:, i, :]:  [[ 1.19251512e+02 -2.92846752e+01 -2.92776944e+01]
 [-4.35043335e-01  1.65956524e-01  5.13015730e-01]
 [-1.05995408e-01 -3.01283070e-03  1.70475266e-02]
 [-3.65122567e-02  2.19798791e-02  1.63510623e-02]
 [-9.88296441e-02 -2.41910939e-01  2.15109929e-01]
 [-3.00534829e-01  6.16629895e-02  4.93026570e-03]
 [ 5.16293064e-02  9.97606359e-02 -4.39841379e-02]
 [-1.69815469e-01  2.45565782e-01 -5.14956168e-02]
 [-2.33420163e-02  3.65092158e-03 -3.23545213e-02]
 [ 4.38877215e-02  3.07472490e-02 -7.02449780e-03]
 [ 1.20982229e-01  1.17476373e-02 -2.78494717e-02]
 [ 1.51383020e-01 -1.21383439e-02 -1.54656119e-01]
 [ 4.49805013e-02 -9.35119523e-03 -1.67424980e-01]
 [-8.45720117e-02  2.97281712e-02 -3.59999752e-02]
 [-1.26071644e-01  7.74257101e-02  2.48932210e-01]
 [-5.80592923e-02 -1.26105452e-01  1.47038747e-01]
 [-2.38440338e-02  5.77985382e-02  1.25308567e-01]
 [-2.73119915e-02  7.14419972e-02 -8.98618256e-02]
 [-3.21133257e-01 -9.52381047e-01 -1.45198065e-01]
 [ 8.47668914e-02 -3.33057481e-02 -8.97124465e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.25151208 -29.28467519 -29.2776944 ]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  8.31409947  -9.26062741 -83.52111278]
init_Out:  [2.49223638]
Stock Position:  8.314099471154409
Bond position:  [-828.91771073]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-15.90656327]
curr_Stock_Price:  97.81196455696752
curr_Factors:  [97.81196456 -1.168593   -1.01823713]
mat_Sqrt:  [[10.98155204  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02968974  0.05248006  1.46349108]
Stock Position:  -0.02968974304742833
Bond Position:  [-13.00255117]


portfolio before change:  [-15.92172711]
curr_Stock_Price:  98.21320758509421
curr_Factors:  [98.21320759 -0.89295642 -1.00307829]
mat_Sqrt:  [[14.74797797  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00695644 -0.00095274  0.04863185]
Stock Position:  -0.006956437520467356
Bond Position:  [-15.23851307]


portfolio before change:  [-15.93177984]
curr_Stock_Price:  99.11059512357657
curr_Factors:  [99.11059512 -0.68616506 -1.0127084 ]
mat_Sqrt:  [[18.12628118  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00179888  0.00695065  0.04664503]
Stock Position:  -0.0017988848199700163
Bond Position:  [-15.75349129]


portfolio before change:  [-15.93987257]
curr_Stock_Price:  101.4197313040817
curr_Factors:  [101.4197313   -0.69936612  -1.04931604]
mat_Sqrt:  [[17.6473477   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00346605 -0.07649896  0.61364875]
Stock Position:  -0.0034660521393994666
Bond Position:  [-15.5883465]


portfolio before change:  [-15.94900521]
curr_Stock_Price:  102.93011356827618
curr_Factors:  [102.93011357  -0.69528373  -1.06809472]
mat_Sqrt:  [[17.64887065  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01688132  0.01949955  0.01406468]
Stock Position:  -0.01688132445019218
Bond Position:  [-14.21140857]


portfolio before change:  [-15.97339798]
curr_Stock_Price:  104.16458234621155
curr_Factors:  [104.16458235  -0.92560711  -1.0908817 ]
mat_Sqrt:  [[13.86660395  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00326157  0.03154708 -0.1254745 ]
Stock Position:  0.0032615693452670074
Bond Position:  [-16.31313799]


portfolio before change:  [-15.97838371]
curr_Stock_Price:  103.88651501108505
curr_Factors:  [103.88651501  -0.74235731  -1.06813952]
mat_Sqrt:  [[16.99301316  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01023871  0.07765472 -0.14690266]
Stock Position:  -0.010238707246904451
Bond Position:  [-14.91472009]


portfolio before change:  [-15.99125489]
curr_Stock_Price:  104.77940476088743
curr_Factors:  [104.77940476  -0.8255959   -1.07059934]
mat_Sqrt:  [[15.73145158  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00189761  0.00115452 -0.09229844]
Stock Position:  -0.0018976054903859555
Bond Position:  [-15.79242492]


portfolio before change:  [-15.99193923]
curr_Stock_Price:  103.05920436901955
curr_Factors:  [103.05920437  -0.84136565  -1.05864143]
mat_Sqrt:  [[15.41431383  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00280569  0.00972313 -0.02003894]
Stock Position:  0.0028056871660168538
Bond Position:  [-16.28109111]


portfolio before change:  [-15.99599457]
curr_Stock_Price:  103.06470699799853
curr_Factors:  [103.064707    -0.96577825  -1.05288749]
mat_Sqrt:  [[13.69035097  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00844396  0.00371493 -0.07944679]
Stock Position:  0.008443961913418724
Bond Position:  [-16.86626903]


portfolio before change:  [-16.00185961]
curr_Stock_Price:  102.86954506608542
curr_Factors:  [102.86954507  -0.68763669  -1.06484445]
mat_Sqrt:  [[17.83174865  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00670156 -0.00383848 -0.44119086]
Stock Position:  0.006701561564278643
Bond Position:  [-16.69124619]


portfolio before change:  [-15.98836874]
curr_Stock_Price:  105.505378791736
curr_Factors:  [105.50537879  -1.01137617  -1.05100209]
mat_Sqrt:  [[13.41513681  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00078744 -0.00295711 -0.47761687]
Stock Position:  0.0007874368835419123
Bond Position:  [-16.07144756]


portfolio before change:  [-15.99373732]
curr_Stock_Price:  103.79068179664581
curr_Factors:  [103.7906818   -0.8063637   -1.03427282]
mat_Sqrt:  [[16.47327997  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00553338  0.00940087 -0.10269791]
Stock Position:  -0.005533378776332615
Bond Position:  [-15.41942416]


portfolio before change:  [-16.00007768]
curr_Stock_Price:  104.2397785792709
curr_Factors:  [104.23977858  -1.03142077  -1.00852538]
mat_Sqrt:  [[13.55489394  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00540465  0.02448416  0.71013431]
Stock Position:  -0.005404649162786704
Bond Position:  [-15.43669824]


portfolio before change:  [-15.99893235]
curr_Stock_Price:  103.31372699564193
curr_Factors:  [103.313727    -1.05361207  -1.00909487]
mat_Sqrt:  [[13.13214859  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00238355 -0.03987805  0.41946062]
Stock Position:  -0.002383552257995301
Bond Position:  [-15.75267868]


portfolio before change:  [-16.00006951]
curr_Stock_Price:  102.138381110109
curr_Factors:  [102.13838111  -1.01943641  -1.04872928]
mat_Sqrt:  [[12.91207456  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [2.49907333e-04 1.82775026e-02 3.57470461e-01]
Stock Position:  0.0002499073325765801
Bond Position:  [-16.02559464]


portfolio before change:  [-16.00396818]
curr_Stock_Price:  102.57147432017902
curr_Factors:  [102.57147432  -0.84626564  -1.05402243]
mat_Sqrt:  [[15.33705514  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0028565   0.02259194 -0.25635078]
Stock Position:  -0.0028565024419029113
Bond Position:  [-15.71097251]


portfolio before change:  [-16.01361574]
curr_Stock_Price:  104.5736888688163
curr_Factors:  [104.57368887  -0.99526663  -1.05705998]
mat_Sqrt:  [[13.43099862  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02794744 -0.30116933 -0.41420966]
Stock Position:  -0.027947442411951788
Bond Position:  [-13.0910486]


portfolio before change:  [-16.04738831]
curr_Stock_Price:  105.66500136853375
curr_Factors:  [105.66500137  -0.74468467  -1.09666298]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-16.04738831]
Stock Price:  106.5112081444797
PL:  [-22.55859645]
Settle:  Tensor("sub_362:0", shape=(), dtype=float64)
PL:  Tensor("sub_363:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  182
output_Z_Vals[:, i, :]:  [[ 1.19251512e+02 -2.92846752e+01 -2.92776944e+01]
 [-4.46164782e-02  4.86936508e-03 -7.78216577e-02]
 [-3.69384172e-01 -5.85191585e-02  2.40728299e-01]
 [-5.80850071e-02 -1.32548301e-01 -4.20134910e-01]
 [-9.88296441e-02 -2.41910939e-01  2.15109929e-01]
 [-1.85573118e-01  1.12856539e-02 -1.71740082e-02]
 [-5.39741856e-02 -2.16197817e-02  3.41010014e-02]
 [-6.64301707e-02  1.13358421e-01 -7.54725042e-02]
 [-1.33769535e-01 -4.08658698e-02  7.09738897e-02]
 [ 5.20753676e-02  3.16163165e-02 -5.81546912e-03]
 [ 2.86058022e-02  8.77294196e-02 -1.20720349e-02]
 [ 1.74165903e-01 -1.28064762e-02 -1.64495363e-01]
 [ 3.96586658e-02 -1.47711954e-02 -3.44224093e-01]
 [-8.45720117e-02  2.97281712e-02 -3.59999752e-02]
 [-9.37383621e-02  2.58202962e-02  1.75442127e-01]
 [-6.38626222e-02 -1.32937692e-01  1.51059754e-01]
 [-2.44271307e-02 -4.22598486e-03  2.07348558e-01]
 [-5.97922538e-02  1.16642194e-01 -8.96561365e-02]
 [-3.11562429e-01 -9.37201372e-01 -1.32031462e-01]
 [ 8.80857258e-02 -3.72683108e-02 -9.59737816e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.25151208 -29.28467519 -29.2776944 ]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  8.31409947  -9.26062741 -83.52111278]
init_Out:  [2.49223638]
Stock Position:  8.314099471154409
Bond position:  [-828.91771073]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [3.15018628]
curr_Stock_Price:  100.10406481618028
curr_Factors:  [100.10406482  -0.74249271  -1.01102474]
mat_Sqrt:  [[17.33439778  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00348302  0.00153983 -0.22200353]
Stock Position:  -0.0034830186691671137
Bond Position:  [3.49885061]


portfolio before change:  [3.14693369]
curr_Stock_Price:  101.289075762697
curr_Factors:  [101.28907576  -0.82586225  -1.02924233]
mat_Sqrt:  [[15.84531672  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02030611 -0.01850538  0.68673083]
Stock Position:  -0.020306105444169584
Bond Position:  [5.20372034]


portfolio before change:  [3.14477101]
curr_Stock_Price:  101.45965372821362
curr_Factors:  [101.45965373  -0.55127238  -1.04359124]
mat_Sqrt:  [[20.58983689  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00715242 -0.04191545 -1.19852795]
Stock Position:  -0.007152415517275025
Bond Position:  [3.87045261]


portfolio before change:  [3.15273116]
curr_Stock_Price:  100.48202343179854
curr_Factors:  [100.48202343  -0.23805681  -1.03951709]
mat_Sqrt:  [[28.00561245  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00218408 -0.07649896  0.61364875]
Stock Position:  -0.0021840846139971133
Bond Position:  [3.3721924]


portfolio before change:  [3.15212987]
curr_Stock_Price:  101.14337401211539
curr_Factors:  [101.14337401  -0.12247672  -1.05088052]
mat_Sqrt:  [[31.28634741  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00603418  0.00356884 -0.04899266]
Stock Position:  -0.006034176854542008
Bond Position:  [3.76244688]


portfolio before change:  [3.16538405]
curr_Stock_Price:  99.10275567571382
curr_Factors:  [99.10275568 -0.19325528 -1.01456645]
mat_Sqrt:  [[29.61661471  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00160625 -0.00683678  0.09728067]
Stock Position:  -0.0016062459771835017
Bond Position:  [3.32456745]


portfolio before change:  [3.16740788]
curr_Stock_Price:  98.360288299973
curr_Factors:  [98.3602883  -0.12193696 -1.00543604]
mat_Sqrt:  [[31.85722349  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00247696  0.03584708 -0.21530205]
Stock Position:  -0.0024769587738604146
Bond Position:  [3.41104226]


portfolio before change:  [3.15618476]
curr_Stock_Price:  103.23561737679312
curr_Factors:  [103.23561738  -0.38008636  -1.02702685]
mat_Sqrt:  [[25.27714713  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00476071 -0.01292292  0.20246875]
Stock Position:  -0.00476071141365159
Bond Position:  [3.64765974]


portfolio before change:  [3.15959587]
curr_Stock_Price:  102.71067922802779
curr_Factors:  [102.71067923  -0.78216907  -1.03514855]
mat_Sqrt:  [[16.68647444  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00309859  0.00999796 -0.01658991]
Stock Position:  0.0030985946079862686
Bond Position:  [2.84133711]


portfolio before change:  [3.15366643]
curr_Stock_Price:  100.56781721445299
curr_Factors:  [100.56781721  -0.67814543  -1.01046933]
mat_Sqrt:  [[18.58244912  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00152869  0.02774248 -0.03443816]
Stock Position:  0.0015286882851584908
Bond Position:  [2.99992959]


portfolio before change:  [3.15627693]
curr_Stock_Price:  101.78482099277896
curr_Factors:  [101.78482099  -0.77529671  -1.00111648]
mat_Sqrt:  [[17.226481    0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00814199 -0.00404976 -0.46925948]
Stock Position:  0.008141985953959083
Bond Position:  [2.32754634]


portfolio before change:  [3.1552322]
curr_Stock_Price:  101.5850310703212
curr_Factors:  [101.58503107  -0.61598752  -0.99100475]
mat_Sqrt:  [[20.36675518  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00152146 -0.00467106 -0.98197552]
Stock Position:  -0.0015214585435069574
Bond Position:  [3.30978961]


portfolio before change:  [3.1553996]
curr_Stock_Price:  102.01892620700949
curr_Factors:  [102.01892621  -0.68491174  -0.99309266]
mat_Sqrt:  [[19.05165456  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00478451  0.00940087 -0.10269791]
Stock Position:  -0.004784513464702374
Bond Position:  [3.64351052]


portfolio before change:  [3.15440606]
curr_Stock_Price:  102.41698671869088
curr_Factors:  [102.41698672  -0.51940368  -0.99396746]
mat_Sqrt:  [[22.54879092  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00253937  0.00816509  0.50048755]
Stock Position:  -0.0025393694494663215
Bond Position:  [3.41448063]


portfolio before change:  [3.15149096]
curr_Stock_Price:  103.90114549214677
curr_Factors:  [103.90114549  -0.42597072  -0.9924629 ]
mat_Sqrt:  [[25.15373279  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00144949 -0.04203859  0.43093143]
Stock Position:  -0.0014494912516064807
Bond Position:  [3.30209476]


portfolio before change:  [3.15227646]
curr_Stock_Price:  103.9288285685224
curr_Factors:  [103.92882857  -0.62983619  -1.03015312]
mat_Sqrt:  [[19.76113282  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00090018 -0.00133637  0.59150772]
Stock Position:  0.0009001812894857486
Bond Position:  [3.05872167]


portfolio before change:  [3.15261545]
curr_Stock_Price:  103.45582861105244
curr_Factors:  [103.45582861  -0.88943205  -1.0322181 ]
mat_Sqrt:  [[15.14233698  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00495839  0.0368855  -0.255764  ]
Stock Position:  -0.004958385721954463
Bond Position:  [3.66558936]


portfolio before change:  [3.14686553]
curr_Stock_Price:  104.80030501718373
curr_Factors:  [104.80030502  -1.0599129   -1.01080293]
mat_Sqrt:  [[13.2148454   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02744729 -0.2963691  -0.37664901]
Stock Position:  -0.027447288443414757
Bond Position:  [6.02334973]


portfolio before change:  [3.10190718]
curr_Stock_Price:  106.49316347077651
curr_Factors:  [106.49316347  -1.03486896  -1.04383557]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [3.10190718]
Stock Price:  106.65677516636089
PL:  [-3.55486798]
Settle:  Tensor("sub_364:0", shape=(), dtype=float64)
PL:  Tensor("sub_365:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  183
output_Z_Vals[:, i, :]:  [[ 1.19251512e+02 -2.92846752e+01 -2.92776944e+01]
 [-1.12458552e-01  2.76657214e-02 -1.08785311e-02]
 [-1.69455546e-01 -5.96436703e-03  1.42246029e-01]
 [-2.53264832e-02  4.31822552e-02  7.35892747e-02]
 [-8.15599042e-02 -9.75994525e-02  6.87335018e-02]
 [-5.30378371e-02  2.53578745e-02 -2.91801639e-03]
 [-1.55738261e-01 -1.25287560e-01  1.09049133e-01]
 [-1.81124485e-02  1.59001622e-02 -1.06362110e-01]
 [-1.99215060e-01 -1.35651129e-01  2.94450659e-01]
 [ 9.58235963e-04 -1.91460520e-02  1.91434787e-02]
 [-8.32387070e-02  1.43645538e-01  1.63922053e-02]
 [-3.99488770e-02 -8.94603541e-03 -1.05501288e-01]
 [ 3.24082245e-02 -1.06956117e-01 -2.19968443e-01]
 [-2.02143395e-02  1.22536127e-02 -6.39205564e-03]
 [ 1.51013672e-02 -6.02155871e-02 -9.14371586e-02]
 [ 1.24624548e-01 -2.62894128e-03  8.00300201e-03]
 [-2.35647895e-02  1.03259148e-01  6.82888801e-02]
 [ 4.52824682e-02 -2.34126707e-02  3.37296209e-02]
 [-2.65481095e-01 -7.23273574e-01 -1.01788313e-01]
 [ 8.07567571e-02 -5.41740105e-02 -1.07321786e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.25151208 -29.28467519 -29.2776944 ]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  8.31409947  -9.26062741 -83.52111278]
init_Out:  [2.49223638]
Stock Position:  8.314099471154409
Bond position:  [-828.91771073]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-0.40965998]
curr_Stock_Price:  99.67589502104566
curr_Factors:  [99.67589502 -1.2211168  -1.04280842]
mat_Sqrt:  [[10.36048079  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01099995  0.00874867 -0.03103342]
Stock Position:  -0.010999952513376536
Bond Position:  [0.68677013]


portfolio before change:  [-0.41140275]
curr_Stock_Price:  99.84993973972827
curr_Factors:  [99.84993974 -0.88149698 -1.05327467]
mat_Sqrt:  [[14.42404798  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00974579 -0.0018861   0.40578833]
Stock Position:  -0.009745786750761704
Bond Position:  [0.56171347]


portfolio before change:  [-0.39411629]
curr_Stock_Price:  98.09061380557846
curr_Factors:  [98.09061381 -1.1512341  -1.04327499]
mat_Sqrt:  [[10.92859326  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00084093  0.01365543  0.20992972]
Stock Position:  -0.0008409293102159802
Bond Position:  [-0.31162902]


portfolio before change:  [-0.39388661]
curr_Stock_Price:  97.7248268828819
curr_Factors:  [97.72482688 -1.23620899 -1.03470955]
mat_Sqrt:  [[10.08689538  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00694463 -0.03086366  0.19607755]
Stock Position:  -0.006944628776384883
Bond Position:  [0.28477604]


portfolio before change:  [-0.39263585]
curr_Stock_Price:  97.55497579081175
curr_Factors:  [97.55497579 -1.07907108 -1.00712103]
mat_Sqrt:  [[12.11233016  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00437395  0.00801886 -0.00832429]
Stock Position:  -0.004373950883119539
Bond Position:  [0.03406482]


portfolio before change:  [-0.39004303]
curr_Stock_Price:  96.96413615119164
curr_Factors:  [96.96413615 -1.19300275 -1.01081135]
mat_Sqrt:  [[10.70303206  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01277335 -0.03961941  0.31108682]
Stock Position:  -0.012773353407238794
Bond Position:  [0.84851415]


portfolio before change:  [-0.38629058]
curr_Stock_Price:  96.68697369206456
curr_Factors:  [96.68697369 -1.22632915 -0.9873664 ]
mat_Sqrt:  [[10.56749882  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00372964  0.00502807 -0.3034215 ]
Stock Position:  -0.0037296415708614346
Bond Position:  [-0.02568283]


portfolio before change:  [-0.38443739]
curr_Stock_Price:  96.18837032937077
curr_Factors:  [96.18837033 -1.27067796 -0.97127538]
mat_Sqrt:  [[10.22008721  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01395419 -0.04289665  0.83998577]
Stock Position:  -0.013954192893982644
Bond Position:  [0.95779368]


portfolio before change:  [-0.38630196]
curr_Stock_Price:  96.33915270708015
curr_Factors:  [96.33915271 -1.29261109 -0.94868228]
mat_Sqrt:  [[10.24286573  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00042679 -0.00605451  0.05461102]
Stock Position:  0.00042678810409733074
Bond Position:  [-0.42741836]


portfolio before change:  [-0.38604264]
curr_Stock_Price:  97.19715673695408
curr_Factors:  [97.19715674 -1.32378012 -0.94089638]
mat_Sqrt:  [[10.09524941  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0075465   0.04542471  0.0467624 ]
Stock Position:  -0.007546495105655352
Bond Position:  [0.34745523]


portfolio before change:  [-0.39106834]
curr_Stock_Price:  97.87463358850815
curr_Factors:  [97.87463359 -1.38382267 -0.95511778]
mat_Sqrt:  [[ 9.43802705  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.006539   -0.00282898 -0.30096581]
Stock Position:  -0.006538996193345495
Bond Position:  [0.24893351]


portfolio before change:  [-0.39202791]
curr_Stock_Price:  98.03089781638457
curr_Factors:  [98.03089782 -1.28277771 -0.97494384]
mat_Sqrt:  [[10.25290582  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0014878  -0.03382249 -0.62750874]
Stock Position:  -0.001487796858743911
Bond Position:  [-0.24617785]


portfolio before change:  [-0.39154284]
curr_Stock_Price:  97.66349105511387
curr_Factors:  [97.66349106 -1.22157902 -0.98152418]
mat_Sqrt:  [[10.7878943   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00196542  0.00387493 -0.01823476]
Stock Position:  -0.001965418360403491
Bond Position:  [-0.19959322]


portfolio before change:  [-0.3900477]
curr_Stock_Price:  96.87737773874319
curr_Factors:  [96.87737774 -1.09113109 -0.96399025]
mat_Sqrt:  [[12.40779235  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00041248 -0.01904184 -0.26084476]
Stock Position:  -0.00041247663656487227
Bond Position:  [-0.35008805]


portfolio before change:  [-0.39062569]
curr_Stock_Price:  98.0664261470037
curr_Factors:  [98.06642615 -0.95800343 -1.01786424]
mat_Sqrt:  [[13.59602396  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00928141 -0.00083134  0.02283034]
Stock Position:  0.009281410168768505
Bond Position:  [-1.30082041]


portfolio before change:  [-0.39012903]
curr_Stock_Price:  98.15497968517829
curr_Factors:  [98.15497969 -1.45702064 -0.98932905]
mat_Sqrt:  [[ 8.50112033  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00081863  0.03265341  0.19480917]
Stock Position:  -0.0008186262787737492
Bond Position:  [-0.30977679]


portfolio before change:  [-0.3907806]
curr_Stock_Price:  98.8562874842497
curr_Factors:  [98.85628748 -1.45754369 -0.98173985]
mat_Sqrt:  [[ 8.62257373  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00598    -0.00740374  0.09622122]
Stock Position:  0.005979999391334493
Bond Position:  [-0.98194113]


portfolio before change:  [-0.39421022]
curr_Stock_Price:  98.32382782398845
curr_Factors:  [98.32382782 -1.27293442 -0.99666419]
mat_Sqrt:  [[10.16212716  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.03000685 -0.22871919 -0.29037372]
Stock Position:  -0.030006846606351674
Bond Position:  [2.5561778]


portfolio before change:  [-0.42754842]
curr_Stock_Price:  99.45614676437104
curr_Factors:  [99.45614676 -1.25236416 -1.03767549]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-0.42754842]
Stock Price:  99.61292952894783
PL:  [-0.42754842]
Settle:  Tensor("sub_366:0", shape=(), dtype=float64)
PL:  Tensor("sub_367:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  184
output_Z_Vals[:, i, :]:  [[ 1.19251512e+02 -2.92846752e+01 -2.92776944e+01]
 [-1.37780771e-01  1.60733007e-02 -1.20027553e-01]
 [-3.74893147e-01 -1.07974356e-01  3.38356854e-01]
 [-4.18379993e-02  3.22139287e-02  4.01935621e-02]
 [-8.38462523e-02 -1.16704910e-01  8.81123380e-02]
 [-1.23817375e-01  5.95693808e-02 -5.66367524e-05]
 [-1.55473660e-01 -1.30832258e-01  1.12062445e-01]
 [-4.54664621e-02  7.69280355e-02 -1.05183867e-01]
 [-2.74361166e-01 -1.61253638e-01  3.50745624e-01]
 [ 2.36077603e-02  1.54738571e-02  8.40977709e-03]
 [ 6.11892864e-02  5.68851858e-02 -2.78289586e-04]
 [-1.23300762e-02 -9.89003006e-03 -1.46701829e-01]
 [-3.16639404e-02 -3.32462129e-01 -4.81271040e-01]
 [ 9.54794916e-02 -6.48334216e-02 -5.15288248e-03]
 [ 1.11348156e-02 -5.79141975e-02 -1.09473076e-01]
 [ 1.04309751e-01 -9.95767368e-03  3.20833477e-02]
 [-2.65933641e-02  9.43922389e-02  9.00820883e-02]
 [ 1.66092092e-02  1.00376676e-02 -3.73044276e-02]
 [-3.79506913e-01 -9.61095201e-01 -2.34742800e-01]
 [ 1.43457389e-01 -1.69591251e-01 -2.65407442e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.25151208 -29.28467519 -29.2776944 ]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  8.31409947  -9.26062741 -83.52111278]
init_Out:  [2.49223638]
Stock Position:  8.314099471154409
Bond position:  [-828.91771073]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [0.05125962]
curr_Stock_Price:  99.7313333289404
curr_Factors:  [99.73133333 -0.63029553 -0.97412275]
mat_Sqrt:  [[20.04664129  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00807448  0.00508282 -0.3424052 ]
Stock Position:  -0.008074483903424304
Bond Position:  [0.85653867]


portfolio before change:  [0.07461358]
curr_Stock_Price:  96.86554135370957
curr_Factors:  [96.86554135 -0.42356312 -0.98274916]
mat_Sqrt:  [[23.73644349  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0130017  -0.03414449  0.96523792]
Stock Position:  -0.01300170470130665
Bond Position:  [1.33403074]


portfolio before change:  [0.05335814]
curr_Stock_Price:  98.526014767874
curr_Factors:  [98.52601477 -0.36530332 -1.00579688]
mat_Sqrt:  [[25.00861624  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00131162  0.01018694  0.11466105]
Stock Position:  -0.0013116184583426705
Bond Position:  [0.18258668]


portfolio before change:  [0.05528972]
curr_Stock_Price:  97.08815556836183
curr_Factors:  [97.08815557 -0.68134329 -1.02130776]
mat_Sqrt:  [[17.68944862  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00389349 -0.03690533  0.25135997]
Stock Position:  -0.0038934907411697617
Bond Position:  [0.43330155]


portfolio before change:  [0.0579294]
curr_Stock_Price:  96.43800634396256
curr_Factors:  [96.43800634 -0.82325223 -0.99259756]
mat_Sqrt:  [[15.69042403  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00779398  0.01883749 -0.00016157]
Stock Position:  -0.007793980659777851
Bond Position:  [0.80956536]


portfolio before change:  [0.05328694]
curr_Stock_Price:  97.05962420809
curr_Factors:  [97.05962421 -0.84990759 -0.95817022]
mat_Sqrt:  [[15.91477088  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00854408 -0.04137279  0.31968296]
Stock Position:  -0.008544080500639607
Bond Position:  [0.88257219]


portfolio before change:  [0.04813797]
curr_Stock_Price:  97.68808835068907
curr_Factors:  [97.68808835 -0.83528114 -1.00251949]
mat_Sqrt:  [[15.54873047  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00417724  0.02432678 -0.3000603 ]
Stock Position:  -0.004177238513654414
Bond Position:  [0.45620441]


portfolio before change:  [0.05465504]
curr_Stock_Price:  96.1552551981129
curr_Factors:  [96.1552552  -0.71928896 -1.00417381]
mat_Sqrt:  [[17.15863181  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01205976 -0.05099288  1.00057964]
Stock Position:  -0.012059764944081352
Bond Position:  [1.21426482]


portfolio before change:  [0.05058753]
curr_Stock_Price:  96.51770924059053
curr_Factors:  [96.51770924 -0.41063135 -1.02290336]
mat_Sqrt:  [[23.01604998  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00111765 0.00489326 0.02399075]
Stock Position:  0.0011176519049390064
Bond Position:  [-0.05728567]


portfolio before change:  [0.05056855]
curr_Stock_Price:  96.51354261610318
curr_Factors:  [96.51354262 -0.13590454 -1.04323717]
mat_Sqrt:  [[29.6820247   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00210906  0.01798868 -0.00079388]
Stock Position:  0.002109062660548881
Bond Position:  [-0.15298455]


portfolio before change:  [0.04756717]
curr_Stock_Price:  95.10858968687535
curr_Factors:  [ 9.51085897e+01 -7.82110375e-02 -1.01897914e+00]
mat_Sqrt:  [[31.74798036  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00133964 -0.0031275  -0.41849949]
Stock Position:  -0.0013396386412492319
Bond Position:  [0.17497831]


portfolio before change:  [0.04664271]
curr_Stock_Price:  95.8313324381125
curr_Factors:  [ 9.58313324e+01  2.25879232e-02 -9.89540857e-01]
mat_Sqrt:  [[36.43889538  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00380053 -0.10513376 -1.37293232]
Stock Position:  -0.00380053000844631
Bond Position:  [0.41085256]


portfolio before change:  [0.05679128]
curr_Stock_Price:  93.18805679171952
curr_Factors:  [93.18805679 -0.18722709 -0.96989229]
mat_Sqrt:  [[29.29744137  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00316593 -0.02050213 -0.01469974]
Stock Position:  0.0031659308048531737
Bond Position:  [-0.23823566]


portfolio before change:  [0.06036174]
curr_Stock_Price:  94.33464716092011
curr_Factors:  [94.33464716  0.12070971 -0.98067171]
mat_Sqrt:  [[39.92036287  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0003183  -0.01831408 -0.31229621]
Stock Position:  -0.00031829922744212104
Bond Position:  [0.09038838]


portfolio before change:  [0.05889213]
curr_Stock_Price:  99.02271705913928
curr_Factors:  [99.02271706 -0.15682142 -0.98147827]
mat_Sqrt:  [[31.72324202  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00348645 -0.00314889  0.09152486]
Stock Position:  0.0034864542201729597
Bond Position:  [-0.28634604]


portfolio before change:  [0.06286775]
curr_Stock_Price:  100.18355795109127
curr_Factors:  [100.18355795  -0.65177758  -0.94958685]
mat_Sqrt:  [[20.19913225  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00028557  0.02984945  0.25697912]
Stock Position:  -0.00028556858808109694
Bond Position:  [0.09147703]


portfolio before change:  [0.06323779]
curr_Stock_Price:  98.9678653024588
curr_Factors:  [98.9678653  -0.32002079 -0.95826181]
mat_Sqrt:  [[27.56405586  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00033571  0.00317419 -0.10641915]
Stock Position:  0.0003357142464310184
Bond Position:  [0.03001287]


portfolio before change:  [0.06267247]
curr_Stock_Price:  97.2615761758599
curr_Factors:  [97.26157618 -0.16955342 -0.9483003 ]
mat_Sqrt:  [[31.80267146  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01422016 -0.30392499 -0.66965587]
Stock Position:  -0.01422015626209277
Bond Position:  [1.44574728]


portfolio before change:  [0.08059538]
curr_Stock_Price:  96.0266083881038
curr_Factors:  [96.02660839 -0.15348335 -0.95723395]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [0.08059538]
Stock Price:  96.96837962766354
PL:  [0.08059538]
Settle:  Tensor("sub_368:0", shape=(), dtype=float64)
PL:  Tensor("sub_369:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  185
output_Z_Vals[:, i, :]:  [[ 1.19251512e+02 -2.92846752e+01 -2.92776944e+01]
 [-2.21681476e-01  6.03854181e-02  5.68253969e-02]
 [-8.92332934e-02  4.87703001e-03  2.16861724e-02]
 [-2.81655521e-02  4.34618020e-02  7.33215047e-02]
 [-8.13883468e-02 -9.61658635e-02  6.72793997e-02]
 [ 8.67532510e-03 -8.45191559e-03 -6.75915111e-03]
 [-1.08783662e-01 -7.24773784e-02  7.17212613e-02]
 [-4.07494041e-02  6.39669982e-02 -1.08524885e-01]
 [-2.16009328e-01 -1.18125191e-01  2.51083825e-01]
 [ 4.86466365e-02  3.86171630e-02  9.80554836e-04]
 [-3.92150610e-02  1.21816757e-01  5.04550892e-03]
 [-2.26418208e-03 -8.67250925e-03 -1.02694916e-01]
 [ 5.33851148e-02 -8.48920561e-03 -2.82450269e-01]
 [-8.30382612e-02  3.02033880e-02 -3.25298051e-02]
 [-3.46963679e-02 -3.78507576e-02  4.22849690e-02]
 [-3.70755699e-02 -8.46585654e-02  1.28658916e-01]
 [-2.53585845e-02  2.31986836e-02  1.76139588e-01]
 [-8.95699168e-02  1.59343429e-01 -8.59741292e-02]
 [-3.23730327e-01 -9.73052517e-01 -1.49456113e-01]
 [ 7.56242462e-02 -1.78996843e-02 -6.80580161e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.25151208 -29.28467519 -29.2776944 ]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  8.31409947  -9.26062741 -83.52111278]
init_Out:  [2.49223638]
Stock Position:  8.314099471154409
Bond position:  [-828.91771073]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-3.78714337]
curr_Stock_Price:  99.26965939716167
curr_Factors:  [99.2696594  -1.02210177 -0.99546089]
mat_Sqrt:  [[13.20079856  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01579623  0.01909555  0.16210704]
Stock Position:  -0.015796233442963957
Bond Position:  [-2.21905665]


portfolio before change:  [-3.77397656]
curr_Stock_Price:  98.40099410919169
curr_Factors:  [98.40099411 -1.29057398 -1.01754984]
mat_Sqrt:  [[ 9.78574836  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00865347  0.00154225  0.06186461]
Stock Position:  -0.008653471817966685
Bond Position:  [-2.92246633]


portfolio before change:  [-3.7674566]
curr_Stock_Price:  97.56310259615402
curr_Factors:  [97.5631026  -1.34586146 -1.03550637]
mat_Sqrt:  [[ 9.0171791   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0013393   0.01374383  0.20916584]
Stock Position:  -0.0013392973096730731
Bond Position:  [-3.6367906]


portfolio before change:  [-3.76863701]
curr_Stock_Price:  97.76551966686547
curr_Factors:  [97.76551967 -1.34192527 -1.03628162]
mat_Sqrt:  [[ 9.06449436  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00773766 -0.03041032  0.1919294 ]
Stock Position:  -0.007737661467165946
Bond Position:  [-3.01216051]


portfolio before change:  [-3.77642125]
curr_Stock_Price:  98.67420599437737
curr_Factors:  [98.67420599 -1.2673612  -1.03592   ]
mat_Sqrt:  [[ 9.86055421  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00071775 -0.00267273 -0.01928198]
Stock Position:  0.0007177478557522692
Bond Position:  [-3.84724445]


portfolio before change:  [-3.77799232]
curr_Stock_Price:  97.82552839485074
curr_Factors:  [97.82552839 -1.17281891 -0.98597174]
mat_Sqrt:  [[11.2953927   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00850037 -0.02291936  0.2046008 ]
Stock Position:  -0.008500366588417534
Bond Position:  [-2.94643946]


portfolio before change:  [-3.7771972]
curr_Stock_Price:  97.64532261381828
curr_Factors:  [97.64532261 -1.06031302 -0.95880799]
mat_Sqrt:  [[12.9645764   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00472444  0.02022814 -0.30959129]
Stock Position:  -0.004724437629514389
Bond Position:  [-3.31587797]


portfolio before change:  [-3.77881041]
curr_Stock_Price:  97.81129599647598
curr_Factors:  [97.811296   -1.11915401 -0.97879098]
mat_Sqrt:  [[12.0022614   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01398128 -0.03735447  0.71627226]
Stock Position:  -0.013981284918348633
Bond Position:  [-2.41128281]


portfolio before change:  [-3.78452758]
curr_Stock_Price:  98.17709067715028
curr_Factors:  [98.17709068 -1.34645499 -0.98661281]
mat_Sqrt:  [[ 9.52295402  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00523408 0.01221182 0.00279725]
Stock Position:  0.0052340778072072
Bond Position:  [-4.29839411]


portfolio before change:  [-3.78580627]
curr_Stock_Price:  98.13812336580524
curr_Factors:  [98.13812337 -1.34537161 -1.00504044]
mat_Sqrt:  [[ 9.35549483  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00374538  0.03852184  0.01439343]
Stock Position:  -0.003745377056411846
Bond Position:  [-3.418242]


portfolio before change:  [-3.7896015]
curr_Stock_Price:  98.92323893871067
curr_Factors:  [98.92323894 -1.28773269 -1.04445753]
mat_Sqrt:  [[ 9.60375308  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00244182 -0.00274249 -0.29296001]
Stock Position:  -0.002441818009746302
Bond Position:  [-3.54804895]


portfolio before change:  [-3.79250282]
curr_Stock_Price:  99.74811837133213
curr_Factors:  [99.74811837 -1.21988391 -1.04548674]
mat_Sqrt:  [[10.35301247  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-4.33593150e-04 -2.68452253e-03 -8.05751999e-01]
Stock Position:  -0.00043359315020999236
Bond Position:  [-3.74925272]


portfolio before change:  [-3.79370114]
curr_Stock_Price:  100.34979748579941
curr_Factors:  [100.34979749  -1.14238358  -1.06771228]
mat_Sqrt:  [[11.00738259  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00807626  0.00955115 -0.09279848]
Stock Position:  -0.008076264369163002
Bond Position:  [-2.98324964]


portfolio before change:  [-3.79662134]
curr_Stock_Price:  100.61901769868372
curr_Factors:  [100.6190177   -0.78412076  -1.06507054]
mat_Sqrt:  [[15.83384896  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00170788 -0.01196946  0.12062725]
Stock Position:  -0.001707878303294448
Bond Position:  [-3.6247763]


portfolio before change:  [-3.80068122]
curr_Stock_Price:  102.46550290009567
curr_Factors:  [102.4655029   -0.92259956  -1.12349713]
mat_Sqrt:  [[13.24247542  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00098162 -0.02677139  0.36702807]
Stock Position:  -0.0009816180950157067
Bond Position:  [-3.70009923]


portfolio before change:  [-3.80269552]
curr_Stock_Price:  103.57506333075933
curr_Factors:  [103.57506333  -1.07844005  -1.1027162 ]
mat_Sqrt:  [[11.69475375  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00095725 0.00733607 0.50247722]
Stock Position:  0.0009572451099480077
Bond Position:  [-3.90184224]


portfolio before change:  [-3.80286528]
curr_Stock_Price:  104.4168804008682
curr_Factors:  [104.4168804   -1.13236959  -1.09263181]
mat_Sqrt:  [[11.28404694  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00912838  0.05038882 -0.24526026]
Stock Position:  -0.009128381275563808
Bond Position:  [-2.84970818]


portfolio before change:  [-3.80917297]
curr_Stock_Price:  105.02982353640614
curr_Factors:  [105.02982354  -1.00263891  -1.11515799]
mat_Sqrt:  [[12.63470573  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0300254  -0.30770622 -0.42635669]
Stock Position:  -0.030025395501991438
Bond Position:  [-0.65561098]


portfolio before change:  [-3.83486853]
curr_Stock_Price:  105.8801582878596
curr_Factors:  [105.88015829  -0.99219765  -1.12812958]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-3.83486853]
Stock Price:  104.87453797592917
PL:  [-8.70940651]
Settle:  Tensor("sub_370:0", shape=(), dtype=float64)
PL:  Tensor("sub_371:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  186
output_Z_Vals[:, i, :]:  [[ 1.19251512e+02 -2.92846752e+01 -2.92776944e+01]
 [-2.07170684e-01  6.87581317e-02  1.26986815e-01]
 [-4.45883566e-01 -1.35684752e-01  4.23184208e-01]
 [-7.13959066e-02  9.33258885e-04 -5.04229368e-02]
 [-8.44873567e-02 -1.22062185e-01  9.35462690e-02]
 [-2.13892103e-01  9.92469303e-02  6.59134583e-03]
 [-3.85869495e-01 -3.92479400e-01  2.96612134e-01]
 [-5.21703813e-03 -3.86406001e-02 -1.01329058e-01]
 [-2.04885547e-01 -1.80805510e-01  4.02717645e-01]
 [-3.91452307e-03 -2.14082783e-01  7.64374772e-02]
 [-2.79547767e-01  2.20427937e-01  5.94584134e-02]
 [-1.54788292e-01 -1.07427953e-02 -1.61217156e-01]
 [-7.23232652e-02 -3.03010481e-01  1.42494768e-01]
 [ 1.47750493e-01 -1.22401604e-01 -3.27552747e-02]
 [ 1.11348156e-02 -5.79141975e-02 -1.09473076e-01]
 [ 1.92932789e-01  6.22214242e-02 -1.87462026e-01]
 [ 8.24539690e-03 -4.95039092e-02  7.13435014e-02]
 [ 4.16196696e-02 -2.49874608e-02  6.99696018e-02]
 [-3.54391452e-01 -8.90208029e-01 -1.86096735e-01]
 [ 1.21497790e-01 -1.69703477e-01 -3.00385101e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.25151208 -29.28467519 -29.2776944 ]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  8.31409947  -9.26062741 -83.52111278]
init_Out:  [2.49223638]
Stock Position:  8.314099471154409
Bond position:  [-828.91771073]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-7.89973112]
curr_Stock_Price:  98.77500717785408
curr_Factors:  [98.77500718 -0.74688362 -1.00077137]
mat_Sqrt:  [[17.20482057  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01043163  0.02174323  0.36225804]
Stock Position:  -0.010431627610626331
Bond Position:  [-6.86934703]


portfolio before change:  [-7.87776358]
curr_Stock_Price:  96.50449941267864
curr_Factors:  [96.50449941 -0.80158762 -0.9728796 ]
mat_Sqrt:  [[16.36463182  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02218228 -0.04290729  1.20722675]
Stock Position:  -0.02218227822106129
Bond Position:  [-5.73707393]


portfolio before change:  [-7.86372648]
curr_Stock_Price:  95.80702586361649
curr_Factors:  [95.80702586 -0.67459093 -1.03960895]
mat_Sqrt:  [[17.25558987  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00473263  0.00029512 -0.1438426 ]
Stock Position:  -0.0047326315398961444
Bond Position:  [-7.41030713]


portfolio before change:  [-7.86466116]
curr_Stock_Price:  95.61302620979104
curr_Factors:  [95.61302621 -0.72966571 -0.99400378]
mat_Sqrt:  [[17.05834574  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00401821 -0.03859945  0.26686147]
Stock Position:  -0.004018205374399123
Bond Position:  [-7.48046838]


portfolio before change:  [-7.85926825]
curr_Stock_Price:  93.8054380737808
curr_Factors:  [93.80543807 -0.87373701 -0.9701556 ]
mat_Sqrt:  [[14.84005902  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01414982  0.03138464  0.01880327]
Stock Position:  -0.014149816089590548
Bond Position:  [-6.53193855]


portfolio before change:  [-7.84674476]
curr_Stock_Price:  92.80495329464664
curr_Factors:  [92.80495329 -1.00846617 -0.95810118]
mat_Sqrt:  [[12.98678967  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02583068 -0.12411288  0.84615186]
Stock Position:  -0.02583067712779271
Bond Position:  [-5.44952998]


portfolio before change:  [-7.87573951]
curr_Stock_Price:  93.87469654980765
curr_Factors:  [93.87469655 -1.24298032 -0.95462765]
mat_Sqrt:  [[10.42652362  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00257981 -0.01221923 -0.2890636 ]
Stock Position:  -0.0025798091905017695
Bond Position:  [-7.6335607]


portfolio before change:  [-7.8755604]
curr_Stock_Price:  93.0654353485371
curr_Factors:  [93.06543535 -1.27262339 -0.95208485]
mat_Sqrt:  [[10.06027612  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01265865 -0.05717572  1.14884135]
Stock Position:  -0.012658651596844744
Bond Position:  [-6.69747747]


portfolio before change:  [-7.8597716]
curr_Stock_Price:  91.6858748043687
curr_Factors:  [91.6858748  -1.12665266 -0.99563677]
mat_Sqrt:  [[10.98003798  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00056107 -0.06769892  0.21805485]
Stock Position:  0.0005610743760961094
Bond Position:  [-7.91121419]


portfolio before change:  [-7.86190007]
curr_Stock_Price:  91.41777591208867
curr_Factors:  [91.41777591 -1.30182869 -0.99525065]
mat_Sqrt:  [[ 9.1922488   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02847175  0.06970543  0.1696183 ]
Stock Position:  -0.028471753766439675
Bond Position:  [-5.25907567]


portfolio before change:  [-7.84973845]
curr_Stock_Price:  90.94444518190093
curr_Factors:  [90.94444518 -1.29930638 -1.00613628]
mat_Sqrt:  [[ 9.06849359  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02072825 -0.00339717 -0.45990767]
Stock Position:  -0.020728248022470017
Bond Position:  [-5.96461943]


portfolio before change:  [-7.83765351]
curr_Stock_Price:  90.28947997501538
curr_Factors:  [90.28947998 -1.14942234 -1.05893765]
mat_Sqrt:  [[ 9.9210718   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00514666 -0.09582033  0.40649791]
Stock Position:  -0.005146655578664925
Bond Position:  [-7.37296465]


portfolio before change:  [-7.83800492]
curr_Stock_Price:  89.99957075037828
curr_Factors:  [89.99957075 -0.9133114  -1.02743406]
mat_Sqrt:  [[12.92365603  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01067066 -0.03870679 -0.09344168]
Stock Position:  0.010670661185685609
Bond Position:  [-8.79835985]


portfolio before change:  [-7.83593958]
curr_Stock_Price:  90.39928377153946
curr_Factors:  [90.39928377 -0.72435922 -0.99375541]
mat_Sqrt:  [[16.21799968  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00078349 -0.01831408 -0.31229621]
Stock Position:  -0.0007834887725526032
Bond Position:  [-7.76511276]


portfolio before change:  [-7.83829218]
curr_Stock_Price:  90.92395759071432
curr_Factors:  [90.92395759 -0.74937923 -1.04507823]
mat_Sqrt:  [[15.1131628   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01034025  0.01967614 -0.53477698]
Stock Position:  0.010340245483854295
Bond Position:  [-8.77846822]


portfolio before change:  [-7.83023204]
curr_Stock_Price:  91.91571608478283
curr_Factors:  [91.91571608 -0.85387336 -1.05043356]
mat_Sqrt:  [[13.68862388  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00157285 -0.01565451  0.20352315]
Stock Position:  0.00157284931582338
Bond Position:  [-7.97480162]


portfolio before change:  [-7.83270795]
curr_Stock_Price:  91.60929301776898
curr_Factors:  [91.60929302 -0.67213045 -1.05466304]
mat_Sqrt:  [[16.29305973  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00339144 -0.00790173  0.1996038 ]
Stock Position:  0.0033914428716695093
Bond Position:  [-8.14339563]


portfolio before change:  [-7.8318241]
curr_Stock_Price:  92.47027015128243
curr_Factors:  [92.47027015 -0.71998871 -1.07088083]
mat_Sqrt:  [[15.42543312  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02692718 -0.2815085  -0.53088219]
Stock Position:  -0.026927176558363637
Bond Position:  [-5.34186081]


portfolio before change:  [-7.86739901]
curr_Stock_Price:  93.74182109192105
curr_Factors:  [93.74182109 -0.59806534 -1.07451114]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-7.86739901]
Stock Price:  94.80369191328181
PL:  [-7.86739901]
Settle:  Tensor("sub_372:0", shape=(), dtype=float64)
PL:  Tensor("sub_373:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  187
output_Z_Vals[:, i, :]:  [[ 1.19251512e+02 -2.92846752e+01 -2.92776944e+01]
 [ 7.33850405e-02 -2.63528265e-02  2.93480063e-02]
 [-5.40849123e-01 -9.56238760e-02  3.88211090e-01]
 [-5.28176682e-02 -6.80051307e-02 -2.33611482e-01]
 [-9.88296441e-02 -2.41910939e-01  2.15109929e-01]
 [ 2.35144582e-02 -1.92634045e-01  3.37637126e-02]
 [ 5.56808168e-02  3.23534700e-02 -1.75492767e-02]
 [-7.05021000e-02  1.17485524e-01 -1.16436042e-01]
 [-6.73300496e-02 -3.76224352e-02  6.73788918e-02]
 [ 4.69772092e-02  4.84390110e-02 -1.14371953e-02]
 [ 3.23101006e-02  8.36259994e-02 -1.26257370e-02]
 [ 1.28918764e-01 -1.14795556e-02 -1.44954481e-01]
 [ 5.05400107e-02 -9.46141984e-03 -2.78360081e-01]
 [-7.80375247e-02  3.12933430e-02 -2.26189583e-02]
 [ 2.88133205e-03 -6.33993859e-02 -1.93935945e-02]
 [ 8.72411196e-02 -7.38297180e-03  4.99607402e-02]
 [-2.50844261e-02  1.05331706e-01  7.11878072e-02]
 [ 4.46290793e-02 -2.36935899e-02  4.01942956e-02]
 [-2.81764342e-01 -7.31007874e-01 -1.27836942e-01]
 [ 1.27221366e-01 -1.43260036e-01 -2.27960744e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.25151208 -29.28467519 -29.2776944 ]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  8.31409947  -9.26062741 -83.52111278]
init_Out:  [2.49223638]
Stock Position:  8.314099471154409
Bond position:  [-828.91771073]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [7.21105814]
curr_Stock_Price:  100.59249677067798
curr_Factors:  [100.59249677  -0.77284519  -0.98945864]
mat_Sqrt:  [[17.26659713  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00455766 -0.0083335   0.08372169]
Stock Position:  0.00455765832583363
Bond Position:  [6.75259191]


portfolio before change:  [7.2198655]
curr_Stock_Price:  102.154484216308
curr_Factors:  [102.15448422  -1.25072621  -0.95937282]
mat_Sqrt:  [[11.20530345  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.04141564 -0.03023892  1.10745818]
Stock Position:  -0.041415644489512654
Bond Position:  [11.4506593]


portfolio before change:  [7.27233824]
curr_Stock_Price:  100.95663470546445
curr_Factors:  [100.95663471  -1.36703164  -0.99654907]
mat_Sqrt:  [[ 9.49827641  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01076609 -0.02150511 -0.66642853]
Stock Position:  -0.010766089850660188
Bond Position:  [8.35924644]


portfolio before change:  [7.2880158]
curr_Stock_Price:  99.69457074975627
curr_Factors:  [99.69457075 -1.60625803 -0.97668167]
mat_Sqrt:  [[ 7.53208221  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00812081 -0.07649896  0.61364875]
Stock Position:  -0.008120812487877781
Bond Position:  [8.09761672]


portfolio before change:  [7.28645358]
curr_Stock_Price:  100.1362601571575
curr_Factors:  [100.13626016  -1.68968243  -0.97549329]
mat_Sqrt:  [[ 6.96819441  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00364982 -0.06091623  0.09631847]
Stock Position:  0.0036498203152174656
Bond Position:  [6.92097423]


portfolio before change:  [7.28867072]
curr_Stock_Price:  100.26960354168578
curr_Factors:  [100.26960354  -1.90203376  -0.94421873]
mat_Sqrt:  [[ 5.82180358  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00909236  0.01023107 -0.0500632 ]
Stock Position:  0.009092362527136662
Bond Position:  [6.37698314]


portfolio before change:  [7.28369474]
curr_Stock_Price:  99.54697233691773
curr_Factors:  [99.54697234 -1.5733554  -0.92151598]
mat_Sqrt:  [[ 8.21332827  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01110829  0.03715218 -0.33215962]
Stock Position:  -0.011108291473196162
Bond Position:  [8.38949153]


portfolio before change:  [7.28006028]
curr_Stock_Price:  100.06299182443875
curr_Factors:  [100.06299182  -1.92243791  -0.88996777]
mat_Sqrt:  [[ 6.00981654  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00907645 -0.01189726  0.19221322]
Stock Position:  -0.009076449782723489
Bond Position:  [8.188277]


portfolio before change:  [7.2839324]
curr_Stock_Price:  99.86194525432342
curr_Factors:  [99.86194525 -1.64786795 -0.90694591]
mat_Sqrt:  [[ 7.7599417   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00591413  0.01531776 -0.03262713]
Stock Position:  0.005914128371944784
Bond Position:  [6.69333603]


portfolio before change:  [7.29022042]
curr_Stock_Price:  100.64219223168524
curr_Factors:  [100.64219223  -1.31338356  -0.90068962]
mat_Sqrt:  [[10.99563519  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00290043  0.02644486 -0.03601771]
Stock Position:  0.0029004324233527674
Bond Position:  [6.99831454]


portfolio before change:  [7.29551575]
curr_Stock_Price:  101.86460573354938
curr_Factors:  [101.86460573  -1.18838242  -0.87793334]
mat_Sqrt:  [[12.90130891  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00767625 -0.00363015 -0.41351479]
Stock Position:  0.007676248527800161
Bond Position:  [6.51357772]


portfolio before change:  [7.2864087]
curr_Stock_Price:  100.46605286463564
curr_Factors:  [100.46605286  -1.11239071  -0.83816897]
mat_Sqrt:  [[14.28571666  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-4.56700620e-04 -2.99196366e-03 -7.94083829e-01]
Stock Position:  -0.00045670061975220576
Bond Position:  [7.33229161]


portfolio before change:  [7.28893392]
curr_Stock_Price:  98.95103426382406
curr_Factors:  [98.95103426 -0.96725911 -0.86306034]
mat_Sqrt:  [[15.86801847  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00515796  0.00989582 -0.06452559]
Stock Position:  -0.005157960316539515
Bond Position:  [7.79931942]


portfolio before change:  [7.29083938]
curr_Stock_Price:  98.95968360014767
curr_Factors:  [98.9596836  -1.03393564 -0.85639341]
mat_Sqrt:  [[14.9451      0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00018162 -0.02004865 -0.05532453]
Stock Position:  -0.00018162032729364546
Bond Position:  [7.30881247]


portfolio before change:  [7.29267147]
curr_Stock_Price:  98.93404429437396
curr_Factors:  [98.93404429 -1.13932809 -0.87359917]
mat_Sqrt:  [[13.2172944   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00735768 -0.0023347   0.14252409]
Stock Position:  0.007357684749498738
Bond Position:  [6.56474596]


portfolio before change:  [7.29872855]
curr_Stock_Price:  99.53419208203837
curr_Factors:  [99.53419208 -1.02523652 -0.84716963]
mat_Sqrt:  [[15.30370687  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00051188  0.03330881  0.203079  ]
Stock Position:  -0.0005118774748330138
Bond Position:  [7.34967787]


portfolio before change:  [7.3010876]
curr_Stock_Price:  98.51559578002355
curr_Factors:  [98.51559578 -1.36095394 -0.82715421]
mat_Sqrt:  [[11.04642361  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0047275  -0.00749257  0.11466314]
Stock Position:  0.004727497469389662
Bond Position:  [6.83535537]


portfolio before change:  [7.29349883]
curr_Stock_Price:  96.5488425423927
curr_Factors:  [96.54884254 -0.8887279  -0.80953677]
mat_Sqrt:  [[17.66851693  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01849241 -0.23116499 -0.36468321]
Stock Position:  -0.018492411762718493
Bond Position:  [9.07891978]


portfolio before change:  [7.29500928]
curr_Stock_Price:  96.58991724616659
curr_Factors:  [96.58991725 -1.10033141 -0.82139871]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [7.29500928]
Stock Price:  96.55663990309223
PL:  [7.29500928]
Settle:  Tensor("sub_374:0", shape=(), dtype=float64)
PL:  Tensor("sub_375:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  188
output_Z_Vals[:, i, :]:  [[ 1.19251512e+02 -2.92846752e+01 -2.92776944e+01]
 [-2.54678833e-01  7.17239861e-02  1.00078760e-01]
 [-1.70989605e-01 -6.38096933e-03  1.42896115e-01]
 [-2.93405839e-02  1.67921249e-02  5.85072698e-03]
 [-9.88296441e-02 -2.41910939e-01  2.15109929e-01]
 [-1.22363786e-01 -9.93197828e-02  3.15499764e-02]
 [ 5.53547336e-02  3.77786914e-02 -1.96768691e-02]
 [-1.10201568e-01  1.78525372e-01 -8.31589568e-02]
 [-2.13871120e-01 -9.85185920e-02  2.04050002e-01]
 [ 4.50470017e-02  4.74936917e-02 -1.18045691e-02]
 [ 3.16736915e-02  8.62091506e-02 -1.21249084e-02]
 [ 9.33462603e-02 -1.04363541e-02 -1.29591784e-01]
 [ 3.89220289e-02 -2.50618460e-02 -4.41564869e-01]
 [-8.45720117e-02  2.97281712e-02 -3.59999752e-02]
 [-8.09158885e-02  1.46189180e-03  1.25372935e-01]
 [ 2.00158326e-02 -8.61998752e-03  9.11190471e-02]
 [-2.75433689e-02  1.08685339e-01  7.58785970e-02]
 [ 2.57371933e-02  8.77231258e-04 -2.62238015e-02]
 [-2.88296635e-01 -7.74439710e-01 -1.11565026e-01]
 [ 8.62730856e-02 -6.68510705e-02 -1.23705435e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.25151208 -29.28467519 -29.2776944 ]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  8.31409947  -9.26062741 -83.52111278]
init_Out:  [2.49223638]
Stock Position:  8.314099471154409
Bond position:  [-828.91771073]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-4.18256168]
curr_Stock_Price:  99.22209942850574
curr_Factors:  [99.22209943 -1.16804882 -0.98296605]
mat_Sqrt:  [[11.546079    0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02012791  0.02268112  0.28549684]
Stock Position:  -0.020127909817516294
Bond Position:  [-2.18542821]


portfolio before change:  [-4.1961102]
curr_Stock_Price:  99.86807308842133
curr_Factors:  [99.86807309 -1.02477528 -0.97467908]
mat_Sqrt:  [[13.5230507   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01049954 -0.00201784  0.40764284]
Stock Position:  -0.010499540104927551
Bond Position:  [-3.14754137]


portfolio before change:  [-4.19484034]
curr_Stock_Price:  99.67217382649265
curr_Factors:  [99.67217383 -1.10346446 -0.98156665]
mat_Sqrt:  [[12.38957548  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00223678  0.00531014  0.0166905 ]
Stock Position:  -0.0022367786927516547
Bond Position:  [-3.97189574]


portfolio before change:  [-4.19977053]
curr_Stock_Price:  101.43233938980448
curr_Factors:  [101.43233939  -1.18447611  -0.96133104]
mat_Sqrt:  [[11.86490423  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00515526 -0.07649896  0.61364875]
Stock Position:  -0.005155256719975774
Bond Position:  [-3.67686078]


portfolio before change:  [-4.20304066]
curr_Stock_Price:  101.88833896144712
curr_Factors:  [101.88833896  -1.3718344   -0.95501852]
mat_Sqrt:  [[ 9.94454917  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01191488 -0.03140767  0.0900033 ]
Stock Position:  -0.011914878929684923
Bond Position:  [-2.98905344]


portfolio before change:  [-4.20117398]
curr_Stock_Price:  101.66894668846311
curr_Factors:  [101.66894669  -1.23113075  -0.93841829]
mat_Sqrt:  [[11.6135541   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00450453  0.01194667 -0.05613263]
Stock Position:  0.004504534158789184
Bond Position:  [-4.65914523]


portfolio before change:  [-4.20425877]
curr_Stock_Price:  101.24274235729183
curr_Factors:  [101.24274236  -0.99753562  -0.93459561]
mat_Sqrt:  [[14.66391602  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0083584   0.05645468 -0.23722936]
Stock Position:  -0.008358395803639342
Bond Position:  [-3.35803185]


portfolio before change:  [-4.18916234]
curr_Stock_Price:  99.336151733769
curr_Factors:  [99.33615173 -0.93626855 -0.9372817 ]
mat_Sqrt:  [[15.25579321  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01145554 -0.03115431  0.58209786]
Stock Position:  -0.011455538531019634
Bond Position:  [-3.05121323]


portfolio before change:  [-4.1923396]
curr_Stock_Price:  99.54691124887488
curr_Factors:  [99.54691125 -0.94990103 -0.94104885]
mat_Sqrt:  [[15.02445363  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00291949  0.01501882 -0.03367515]
Stock Position:  0.002919486263159919
Bond Position:  [-4.48296544]


portfolio before change:  [-4.1920559]
curr_Stock_Price:  100.02801726260724
curr_Factors:  [100.02801726  -0.47815558  -0.90078083]
mat_Sqrt:  [[25.19168336  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00124742  0.02726173 -0.03458899]
Stock Position:  0.0012474202373532332
Bond Position:  [-4.31683288]


portfolio before change:  [-4.19496964]
curr_Stock_Price:  98.55746640528054
curr_Factors:  [98.55746641 -0.41904302 -0.84969137]
mat_Sqrt:  [[27.71310503  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00240406 -0.00330026 -0.36968929]
Stock Position:  0.0024040605557076786
Bond Position:  [-4.43190776]


portfolio before change:  [-4.19141486]
curr_Stock_Price:  100.4970587065242
curr_Factors:  [100.49705871  -0.42567144  -0.86337799]
mat_Sqrt:  [[27.690213    0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00187283 -0.00792525 -1.25966166]
Stock Position:  -0.0018728319816032292
Bond Position:  [-4.00320075]


portfolio before change:  [-4.19391885]
curr_Stock_Price:  101.29962066853153
curr_Factors:  [101.29962067  -0.53004784  -0.87722934]
mat_Sqrt:  [[24.79905368  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00367566  0.00940087 -0.10269791]
Stock Position:  -0.0036756603267720485
Bond Position:  [-3.82157585]


portfolio before change:  [-4.19414843]
curr_Stock_Price:  101.1021229735296
curr_Factors:  [101.10212297  -0.37592075  -0.84716963]
mat_Sqrt:  [[29.75629602  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00185798  0.00046229  0.35765409]
Stock Position:  -0.0018579765206238903
Bond Position:  [-4.00630306]


portfolio before change:  [-4.19500154]
curr_Stock_Price:  101.02214796986574
curr_Factors:  [101.02214797  -0.50258764  -0.8421057 ]
mat_Sqrt:  [[26.32835355  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00145823 -0.00272588  0.25993728]
Stock Position:  0.0014582325866780944
Bond Position:  [-4.34231532]


portfolio before change:  [-4.19754697]
curr_Stock_Price:  100.02112834145062
curr_Factors:  [100.02112834  -0.97183225  -0.89245267]
mat_Sqrt:  [[15.50397624  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00059652  0.03436932  0.21646052]
Stock Position:  -0.000596522567480495
Bond Position:  [-4.13788211]


portfolio before change:  [-4.19824925]
curr_Stock_Price:  99.46403974162361
curr_Factors:  [99.46403974 -0.90519937 -0.87804024]
mat_Sqrt:  [[16.71918007  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00122057  0.0002774  -0.07480921]
Stock Position:  0.0012205701557831748
Bond Position:  [-4.31965209]


portfolio before change:  [-4.19933815]
curr_Stock_Price:  99.45679156046909
curr_Factors:  [99.45679156 -1.07547555 -0.88916666]
mat_Sqrt:  [[13.94444311  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02374177 -0.24489934 -0.31826397]
Stock Position:  -0.023741765498434375
Bond Position:  [-1.83805833]


portfolio before change:  [-4.25427357]
curr_Stock_Price:  101.75130686082964
curr_Factors:  [101.75130686  -0.87831036  -0.88758178]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-4.25427357]
Stock Price:  104.43139200805491
PL:  [-8.68566557]
Settle:  Tensor("sub_376:0", shape=(), dtype=float64)
PL:  Tensor("sub_377:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  189
output_Z_Vals[:, i, :]:  [[ 1.19251512e+02 -2.92846752e+01 -2.92776944e+01]
 [-1.04664757e-01 -1.54667756e-02 -1.03803039e-01]
 [-9.42202169e-02  2.00643713e-03  1.18064192e-02]
 [-2.46188340e-02  4.19019631e-02  7.05909015e-02]
 [-8.59585989e-02 -1.34356357e-01  1.06016357e-01]
 [-2.17433023e-02  1.12917105e-02 -9.47437975e-03]
 [-1.24849590e-01 -9.53290062e-02  8.71320220e-02]
 [-6.79803743e-02  1.23195182e-01 -9.00244012e-02]
 [-2.77290343e-01 -1.39793000e-01  2.98891130e-01]
 [ 7.16821353e-04 -2.88039429e-02  2.19820365e-02]
 [-1.64000029e-01  1.71487620e-01  4.14637306e-02]
 [-1.30533609e-01 -9.85787460e-03 -1.48590172e-01]
 [-3.78343286e-02 -2.42753210e-01  4.74529650e-02]
 [ 1.09165426e-01 -7.99062987e-02 -1.23799209e-02]
 [ 1.11348156e-02 -5.79141975e-02 -1.09473076e-01]
 [ 1.91206098e-01  5.60254512e-02 -1.72829997e-01]
 [-6.19671064e-03 -6.23779028e-02  2.87488870e-02]
 [ 4.16196696e-02 -2.49874608e-02  6.99696018e-02]
 [-2.35584970e-01 -6.14882448e-01 -1.11284974e-01]
 [ 1.40235641e-01 -2.18587751e-01 -3.87727962e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.25151208 -29.28467519 -29.2776944 ]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  8.31409947  -9.26062741 -83.52111278]
init_Out:  [2.49223638]
Stock Position:  8.314099471154409
Bond position:  [-828.91771073]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [3.44787586]
curr_Stock_Price:  100.13987020691242
curr_Factors:  [100.13987021  -1.29098955  -0.98207863]
mat_Sqrt:  [[10.31397458  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01224095 -0.00489102 -0.29612118]
Stock Position:  -0.012240946849204026
Bond Position:  [4.67368269]


portfolio before change:  [3.47142876]
curr_Stock_Price:  98.31122702739317
curr_Factors:  [98.31122703 -1.25988598 -1.00927568]
mat_Sqrt:  [[10.16526559  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00902666  0.00063449  0.03368043]
Stock Position:  -0.009026663879515041
Bond Position:  [4.35885116]


portfolio before change:  [3.4735004]
curr_Stock_Price:  98.20246136293258
curr_Factors:  [98.20246136 -1.15683446 -1.00897813]
mat_Sqrt:  [[11.2595728   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00081065  0.01325056  0.20137619]
Stock Position:  -0.0008106544251701816
Bond Position:  [3.55310866]


portfolio before change:  [3.47439239]
curr_Stock_Price:  98.19801820546446
curr_Factors:  [98.19801821 -0.93549483 -0.96988494]
mat_Sqrt:  [[14.60853961  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00464024 -0.04248721  0.30243516]
Stock Position:  -0.004640242531021079
Bond Position:  [3.93005501]


portfolio before change:  [3.47320308]
curr_Stock_Price:  98.66608381556512
curr_Factors:  [98.66608382 -0.98113563 -0.97827576]
mat_Sqrt:  [[13.90613154  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00168168  0.00357075 -0.02702777]
Stock Position:  -0.0016816827271314604
Bond Position:  [3.63912813]


portfolio before change:  [3.47586553]
curr_Stock_Price:  97.62394205832578
curr_Factors:  [97.62394206 -0.84036783 -0.97956046]
mat_Sqrt:  [[15.81872686  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00692377 -0.03014568  0.24856341]
Stock Position:  -0.006923769925406422
Bond Position:  [4.15179125]


portfolio before change:  [3.46867153]
curr_Stock_Price:  98.81290087640349
curr_Factors:  [98.81290088 -0.61194391 -1.00384704]
mat_Sqrt:  [[19.63742579  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00423557  0.03895774 -0.25681456]
Stock Position:  -0.004235567494308462
Bond Position:  [3.88720024]


portfolio before change:  [3.47424759]
curr_Stock_Price:  97.72588242645416
curr_Factors:  [97.72588243 -0.69278055 -0.96344991]
mat_Sqrt:  [[18.65167548  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01178923 -0.04420643  0.8526532 ]
Stock Position:  -0.01178922968052589
Bond Position:  [4.62636047]


portfolio before change:  [3.49562692]
curr_Stock_Price:  96.01053822594417
curr_Factors:  [96.01053823 -1.15727475 -0.96256156]
mat_Sqrt:  [[11.52618788  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00038696 -0.00910861  0.06270863]
Stock Position:  0.00038695978271819286
Bond Position:  [3.4584747]


portfolio before change:  [3.4955837]
curr_Stock_Price:  93.66419417634155
curr_Factors:  [93.66419418 -0.98616903 -0.96556429]
mat_Sqrt:  [[13.30290801  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01135906  0.05422915  0.11828448]
Stock Position:  -0.01135905688000898
Bond Position:  [4.55952061]


portfolio before change:  [3.50669291]
curr_Stock_Price:  92.7865523303297
curr_Factors:  [92.78655233 -1.16022459 -0.97283299]
mat_Sqrt:  [[10.99283987  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01465672 -0.00311733 -0.4238864 ]
Stock Position:  -0.01465672035433177
Bond Position:  [4.86663946]


portfolio before change:  [3.5091127]
curr_Stock_Price:  92.70447552467314
curr_Factors:  [92.70447552 -1.26270623 -0.98006611]
mat_Sqrt:  [[ 9.84185693  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00349689 -0.07676531  0.1353701 ]
Stock Position:  -0.0034968902544864123
Bond Position:  [3.83329007]


portfolio before change:  [3.51092443]
curr_Stock_Price:  92.46045991140929
curr_Factors:  [92.46045991 -1.47769408 -0.96135109]
mat_Sqrt:  [[ 8.06663096  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01296393 -0.02526859 -0.03531647]
Stock Position:  0.012963926840848015
Bond Position:  [2.3122738]


portfolio before change:  [3.50690918]
curr_Stock_Price:  92.10613897051833
curr_Factors:  [92.10613897 -1.25137617 -0.92771734]
mat_Sqrt:  [[10.42126143  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0012193  -0.01831408 -0.31229621]
Stock Position:  -0.0012192977541095348
Bond Position:  [3.61921399]


portfolio before change:  [3.50835995]
curr_Stock_Price:  91.65846006687731
curr_Factors:  [91.65846007 -1.12116315 -0.89580776]
mat_Sqrt:  [[12.19588215  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01290385  0.0177168  -0.49303588]
Stock Position:  0.012903854908594995
Bond Position:  [2.32561248]


portfolio before change:  [3.50819023]
curr_Stock_Price:  91.6002448848781
curr_Factors:  [91.60024488 -1.27343189 -0.86049735]
mat_Sqrt:  [[10.84283735  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00017882 -0.01972562  0.08201257]
Stock Position:  -0.0001788239662763429
Bond Position:  [3.52457055]


portfolio before change:  [3.50911365]
curr_Stock_Price:  91.36446321573
curr_Factors:  [91.36446322 -1.24076513 -0.88129289]
mat_Sqrt:  [[10.94407902  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00504903 -0.00790173  0.1996038 ]
Stock Position:  0.005049029812319787
Bond Position:  [3.04781175]


portfolio before change:  [3.508441]
curr_Stock_Price:  91.08031005754938
curr_Factors:  [91.08031006 -1.34402    -0.91220212]
mat_Sqrt:  [[ 9.54024839  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02873899 -0.1944429  -0.31746505]
Stock Position:  -0.028738991382966594
Bond Position:  [6.12599724]


portfolio before change:  [3.50859323]
curr_Stock_Price:  91.12830947879857
curr_Factors:  [91.12830948 -1.39350975 -0.89700947]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [3.50859323]
Stock Price:  92.59327435526237
PL:  [3.50859323]
Settle:  Tensor("sub_378:0", shape=(), dtype=float64)
PL:  Tensor("sub_379:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  190
output_Z_Vals[:, i, :]:  [[ 1.19251512e+02 -2.92846752e+01 -2.92776944e+01]
 [-5.35028050e-01  1.98336092e-01  6.02376665e-01]
 [-3.79719887e-01 -1.09858426e-01  3.44124387e-01]
 [-4.51756737e-02  3.28746939e-02  4.06714050e-02]
 [-8.34260156e-02 -1.13193278e-01  8.45504582e-02]
 [-6.43642753e-02  2.72865230e-02  3.01629427e-04]
 [-3.90267601e-02 -3.04605580e-03  2.03461988e-02]
 [-6.60625290e-02  1.12653716e-01 -1.10950546e-01]
 [-1.03034743e-01 -5.52406270e-02  1.07450714e-01]
 [ 6.85910504e-02  5.90243914e-02 -7.32346204e-03]
 [-1.06126173e-02  1.07050000e-01 -1.19980977e-03]
 [-2.72874700e-02 -9.18003595e-03 -1.09068971e-01]
 [ 2.22256050e-02 -1.40225943e-01 -2.76703731e-01]
 [ 8.29494246e-03  1.23200840e-03 -1.08394893e-03]
 [ 1.11348156e-02 -5.79141975e-02 -1.09473076e-01]
 [ 1.58060205e-01  2.23272277e-02 -4.20709465e-02]
 [-2.38615367e-02  1.03663867e-01  6.88549684e-02]
 [ 1.71230149e-02  1.12556418e-02 -5.01142076e-02]
 [-3.89318363e-01 -9.97595366e-01 -2.28249211e-01]
 [ 9.29845065e-02 -8.22745689e-02 -1.43638541e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.25151208 -29.28467519 -29.2776944 ]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  8.31409947  -9.26062741 -83.52111278]
init_Out:  [2.49223638]
Stock Position:  8.314099471154409
Bond position:  [-828.91771073]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-21.25618477]
curr_Stock_Price:  97.16852487761702
curr_Factors:  [97.16852488 -1.03263995 -0.94782171]
mat_Sqrt:  [[13.40979195  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.03034703  0.06271938  1.71841296]
Stock Position:  -0.030347034039102414
Bond Position:  [-18.30740823]


portfolio before change:  [-21.25038644]
curr_Stock_Price:  96.82662167298632
curr_Factors:  [96.82662167 -1.3671366  -1.0080331 ]
mat_Sqrt:  [[ 9.00475059  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.03468306 -0.03474028  0.98169109]
Stock Position:  -0.03468306196315876
Bond Position:  [-17.89214272]


portfolio before change:  [-21.25898095]
curr_Stock_Price:  96.94543807960467
curr_Factors:  [96.94543808 -1.19173247 -1.00618666]
mat_Sqrt:  [[10.76423634  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00334672  0.01039589  0.1160242 ]
Stock Position:  -0.003346715533250058
Bond Position:  [-20.93453215]


portfolio before change:  [-21.26166121]
curr_Stock_Price:  96.18229267823524
curr_Factors:  [96.18229268 -0.92349886 -1.0344891 ]
mat_Sqrt:  [[13.57537249  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00508935 -0.03579486  0.24119892]
Stock Position:  -0.005089353058570565
Bond Position:  [-20.77215557]


portfolio before change:  [-21.27103794]
curr_Stock_Price:  97.00421195729393
curr_Factors:  [97.00421196 -1.18861943 -1.00994335]
mat_Sqrt:  [[10.7638319   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00590851  0.00862876  0.00086046]
Stock Position:  -0.005908506468628795
Bond Position:  [-20.69788792]


portfolio before change:  [-21.28695181]
curr_Stock_Price:  98.82171970865141
curr_Factors:  [98.82171971 -1.442745   -1.0680355 ]
mat_Sqrt:  [[ 8.02480139  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00435553 -0.00096325  0.05804204]
Stock Position:  -0.00435552940500456
Bond Position:  [-20.85653091]


portfolio before change:  [-21.29296606]
curr_Stock_Price:  99.00527230422335
curr_Factors:  [99.0052723  -1.26527241 -1.078983  ]
mat_Sqrt:  [[ 9.49644661  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00903512  0.03562423 -0.31651103]
Stock Position:  -0.009035117193305953
Bond Position:  [-20.39844183]


portfolio before change:  [-21.30490517]
curr_Stock_Price:  99.76219167624839
curr_Factors:  [99.76219168 -1.64349128 -1.11337258]
mat_Sqrt:  [[ 6.33395863  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01302941 -0.01746862  0.30652698]
Stock Position:  -0.01302941324732232
Bond Position:  [-20.00506235]


portfolio before change:  [-21.30667414]
curr_Stock_Price:  99.51406733028291
curr_Factors:  [99.51406733 -1.58927798 -1.11931964]
mat_Sqrt:  [[ 6.63064048  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01034895  0.01866515 -0.0208918 ]
Stock Position:  0.010348948713512345
Bond Position:  [-22.33654012]


portfolio before change:  [-21.32195973]
curr_Stock_Price:  98.57670172325685
curr_Factors:  [98.57670172 -1.45060084 -1.13524094]
mat_Sqrt:  [[ 7.42604312  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00108988  0.03385218 -0.00342272]
Stock Position:  -0.0010898816741482364
Bond Position:  [-21.21452278]


portfolio before change:  [-21.32648216]
curr_Stock_Price:  97.85932128174557
curr_Factors:  [97.85932128 -1.08856019 -1.10611236]
mat_Sqrt:  [[10.90104217  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00456728 -0.00290298 -0.31114342]
Stock Position:  -0.004567279646622072
Bond Position:  [-20.87953127]


portfolio before change:  [-21.33106388]
curr_Stock_Price:  97.71945409059603
curr_Factors:  [97.71945409 -1.04761787 -1.11844268]
mat_Sqrt:  [[11.20141495  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00338144 -0.04434334 -0.78935872]
Stock Position:  -0.0033814411764150213
Bond Position:  [-21.0006313]


portfolio before change:  [-21.33314733]
curr_Stock_Price:  96.78276173626635
curr_Factors:  [96.78276174 -0.64877557 -1.12174231]
mat_Sqrt:  [[16.47676194  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00049193  0.0003896  -0.0030922 ]
Stock Position:  0.0004919348025327815
Bond Position:  [-21.38075814]


portfolio before change:  [-21.33869891]
curr_Stock_Price:  96.36455725072689
curr_Factors:  [96.36455725 -0.72346309 -1.13136024]
mat_Sqrt:  [[15.07918243  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00084266 -0.01831408 -0.31229621]
Stock Position:  -0.0008426597875997628
Bond Position:  [-21.25749638]


portfolio before change:  [-21.34460146]
curr_Stock_Price:  97.06176419351412
curr_Factors:  [97.06176419 -0.6756829  -1.16641522]
mat_Sqrt:  [[15.38279079  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00975434  0.00706049 -0.1200167 ]
Stock Position:  0.009754341570851746
Bond Position:  [-22.29137506]


portfolio before change:  [-21.32867674]
curr_Stock_Price:  99.2657323943778
curr_Factors:  [99.26573239 -0.86180383 -1.17461124]
mat_Sqrt:  [[12.95375042  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00055042  0.03278139  0.19642406]
Stock Position:  -0.0005504186333230452
Bond Position:  [-21.27403903]


portfolio before change:  [-21.33422683]
curr_Stock_Price:  99.68526265177825
curr_Factors:  [99.68526265 -0.59726342 -1.21435755]
mat_Sqrt:  [[16.28748274  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00044108  0.00355935 -0.14296189]
Stock Position:  0.0004410819419979293
Bond Position:  [-21.3781962]


portfolio before change:  [-21.33989574]
curr_Stock_Price:  98.9514026593399
curr_Factors:  [98.95140266 -0.44738417 -1.23793985]
mat_Sqrt:  [[18.34404181  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02516715 -0.31546735 -0.65113147]
Stock Position:  -0.025167154764147923
Bond Position:  [-18.84957048]


portfolio before change:  [-21.30502871]
curr_Stock_Price:  97.37871714962795
curr_Factors:  [97.37871715 -0.58485749 -1.21115704]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-21.30502871]
Stock Price:  95.57673929591297
PL:  [-21.30502871]
Settle:  Tensor("sub_380:0", shape=(), dtype=float64)
PL:  Tensor("sub_381:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  191
output_Z_Vals[:, i, :]:  [[ 1.19251512e+02 -2.92846752e+01 -2.92776944e+01]
 [-2.41731699e-02 -1.03966650e-01 -3.26751551e-01]
 [-3.61166766e-01 -5.67409260e-02  2.33660230e-01]
 [-5.28509079e-03 -1.39630550e-01 -4.39887436e-01]
 [-9.88296441e-02 -2.41910939e-01  2.15109929e-01]
 [-3.14081925e-01  6.79059538e-02  7.58452320e-03]
 [ 5.36397547e-02  6.63117227e-02 -3.08665804e-02]
 [-7.98850866e-02  1.35867276e-01 -8.23067267e-02]
 [-2.82386157e-01 -1.32245123e-01  2.80365668e-01]
 [ 4.50470017e-02  4.74936917e-02 -1.18045691e-02]
 [ 4.64896271e-02  7.39204770e-02 -1.34487935e-02]
 [ 7.39309630e-02 -9.86697982e-03 -1.21206899e-01]
 [ 5.43474136e-02 -5.08125793e-03 -1.26135370e-01]
 [-8.45720117e-02  2.97281712e-02 -3.59999752e-02]
 [-8.29418596e-02 -2.49669443e-03  1.01585493e-01]
 [-3.70037789e-02 -9.15306699e-02  1.30204958e-01]
 [-2.57031981e-02  8.25440922e-02  1.01487562e-01]
 [ 2.13389022e-02  1.04550751e-02 -7.15774958e-02]
 [-2.75564551e-01 -8.04122572e-01 -7.26216637e-02]
 [ 8.28598645e-02 -5.90071560e-02 -1.13568074e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.25151208 -29.28467519 -29.2776944 ]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  8.31409947  -9.26062741 -83.52111278]
init_Out:  [2.49223638]
Stock Position:  8.314099471154409
Bond position:  [-828.91771073]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [18.53906457]
curr_Stock_Price:  101.95500229137437
curr_Factors:  [101.95500229  -0.99702466  -1.02674768]
mat_Sqrt:  [[13.47396391  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00694343 -0.03287714 -0.93213122]
Stock Position:  -0.006943425027832404
Bond Position:  [19.24698148]


portfolio before change:  [18.54932959]
curr_Stock_Price:  101.16970154650508
curr_Factors:  [101.16970155  -0.93270487  -1.00585549]
mat_Sqrt:  [[14.55943103  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02163107 -0.01794306  0.6665676 ]
Stock Position:  -0.021631072993931674
Bond Position:  [20.73773879]


portfolio before change:  [18.53105566]
curr_Stock_Price:  102.25420684720383
curr_Factors:  [102.25420685  -0.59353319  -1.0178746 ]
mat_Sqrt:  [[20.41059538  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00483484 -0.04415506 -1.25487641]
Stock Position:  -0.004834840978821734
Bond Position:  [19.02543849]


portfolio before change:  [18.53298062]
curr_Stock_Price:  102.83995445542664
curr_Factors:  [102.83995446  -0.40074697  -1.04670272]
mat_Sqrt:  [[24.18479808  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00252914 -0.07649896  0.61364875]
Stock Position:  -0.002529135329156011
Bond Position:  [18.79307678]


portfolio before change:  [18.53687346]
curr_Stock_Price:  103.15864638417831
curr_Factors:  [103.15864638  -0.7987142   -1.05564095]
mat_Sqrt:  [[16.14988475  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01924351  0.02147375  0.02163653]
Stock Position:  -0.019243506780240383
Bond Position:  [20.52200757]


portfolio before change:  [18.5611423]
curr_Stock_Price:  102.16414500004592
curr_Factors:  [102.164145    -0.36799614  -1.06607383]
mat_Sqrt:  [[24.34948781  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00201447  0.02096961 -0.08805376]
Stock Position:  0.0020144695456189876
Bond Position:  [18.35533574]


portfolio before change:  [18.55995575]
curr_Stock_Price:  99.29691184323563
curr_Factors:  [99.29691184 -0.51249675 -1.03954664]
mat_Sqrt:  [[21.03254677  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00443017  0.04296501 -0.23479818]
Stock Position:  -0.004430171951996811
Bond Position:  [18.99985815]


portfolio before change:  [18.5688041]
curr_Stock_Price:  98.37193866638678
curr_Factors:  [98.37193867 -0.61479188 -1.01820826]
mat_Sqrt:  [[19.2162341   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0118947  -0.04181958  0.79980521]
Stock Position:  -0.011894698403449812
Bond Position:  [19.73890864]


portfolio before change:  [18.55975754]
curr_Stock_Price:  99.54741209759177
curr_Factors:  [99.5474121  -0.80239066 -1.01475705]
mat_Sqrt:  [[16.17531513  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00271177  0.01501882 -0.03367515]
Stock Position:  0.0027117670129355224
Bond Position:  [18.28980815]


portfolio before change:  [18.56838428]
curr_Stock_Price:  101.04227272949693
curr_Factors:  [101.04227273  -0.97308456  -1.02560819]
mat_Sqrt:  [[13.69247245  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00333417  0.02337571 -0.03836566]
Stock Position:  0.003334169358210079
Bond Position:  [18.23149223]


portfolio before change:  [18.57539274]
curr_Stock_Price:  101.77709293724496
curr_Factors:  [101.77709294  -1.62157073  -1.02272992]
mat_Sqrt:  [[ 7.23177425  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00676666 -0.00312021 -0.34576955]
Stock Position:  0.006766658108973607
Bond Position:  [17.88670195]


portfolio before change:  [18.58200605]
curr_Stock_Price:  102.09350915082905
curr_Factors:  [102.09350915  -1.59730786  -1.07488465]
mat_Sqrt:  [[ 7.05471817  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00403545 -0.00160683 -0.3598291 ]
Stock Position:  0.0040354470374722295
Bond Position:  [18.1700131]


portfolio before change:  [18.58596118]
curr_Stock_Price:  101.94781316488567
curr_Factors:  [101.94781316  -1.8350407   -1.05845053]
mat_Sqrt:  [[ 5.64612693  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01614432  0.00940087 -0.10269791]
Stock Position:  -0.016144323157649906
Bond Position:  [20.23183962]


portfolio before change:  [18.59605153]
curr_Stock_Price:  101.63613943448581
curr_Factors:  [101.63613943  -1.8751177   -1.04986129]
mat_Sqrt:  [[ 5.45438667  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01141655 -0.00078952  0.28979514]
Stock Position:  -0.011416548861659341
Bond Position:  [19.75638548]


portfolio before change:  [18.59551303]
curr_Stock_Price:  102.1159874719531
curr_Factors:  [102.11598747  -1.67358785  -1.04718777]
mat_Sqrt:  [[ 6.72165012  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00190267 -0.02894454  0.3714385 ]
Stock Position:  -0.0019026748791333504
Bond Position:  [18.78980656]


portfolio before change:  [18.60071279]
curr_Stock_Price:  101.85229890184765
curr_Factors:  [101.8522989   -1.49039448  -1.01976101]
mat_Sqrt:  [[ 8.27607002  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00034507  0.02610273  0.28951576]
Stock Position:  -0.00034507404697058385
Bond Position:  [18.63585937]


portfolio before change:  [18.60556444]
curr_Stock_Price:  101.29558277559599
curr_Factors:  [101.29558278  -1.50584712  -0.95352756]
mat_Sqrt:  [[ 8.65959644  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00080814  0.00330619 -0.20419067]
Stock Position:  0.0008081388072789103
Bond Position:  [18.52370355]


portfolio before change:  [18.61047318]
curr_Stock_Price:  101.63863662511027
curr_Factors:  [101.63863663  -1.38622902  -0.95711487]
mat_Sqrt:  [[ 9.75792581  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.03188698 -0.25428588 -0.20716939]
Stock Position:  -0.03188697555395689
Bond Position:  [21.8514219]


portfolio before change:  [18.64555715]
curr_Stock_Price:  100.70971732366472
curr_Factors:  [100.70971732  -0.93744946  -0.99602657]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [18.64555715]
Stock Price:  99.32004312894013
PL:  [18.64555715]
Settle:  Tensor("sub_382:0", shape=(), dtype=float64)
PL:  Tensor("sub_383:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  192
output_Z_Vals[:, i, :]:  [[ 1.19251512e+02 -2.92846752e+01 -2.92776944e+01]
 [-3.86953465e-01  1.54880330e-01  4.90963396e-01]
 [-2.89127886e-01 -7.44967500e-02  2.35874853e-01]
 [-4.11088213e-02  3.54059049e-02  4.84775301e-02]
 [-8.27550211e-02 -1.07586233e-01  7.88631822e-02]
 [-1.01787977e-01  4.61296858e-02  1.22706948e-03]
 [-2.21999872e-01 -2.04219708e-01  1.64157475e-01]
 [-6.96753764e-04 -9.35820309e-03 -9.12022543e-02]
 [-2.92772271e-01 -1.71320278e-01  3.73668562e-01]
 [ 4.59777090e-02  3.61502869e-02  1.77244562e-03]
 [ 5.71739093e-02  6.97213319e-02 -9.60286528e-03]
 [ 1.18951806e-01 -1.11872640e-02 -1.40650051e-01]
 [ 4.13950468e-02 -1.47376192e-02 -3.75389277e-01]
 [-8.45720117e-02  2.97281712e-02 -3.59999752e-02]
 [-3.91641400e-02 -3.45245430e-02  5.11206282e-02]
 [ 1.16235649e-01 -4.06675898e-03  1.72490771e-02]
 [-2.35647895e-02  1.03259148e-01  6.82888801e-02]
 [ 4.17436178e-02 -2.49341703e-02  6.87432495e-02]
 [-3.68491740e-01 -9.26652965e-01 -2.02870654e-01]
 [ 1.11147450e-01 -1.34408466e-01 -2.35312629e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.25151208 -29.28467519 -29.2776944 ]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  8.31409947  -9.26062741 -83.52111278]
init_Out:  [2.49223638]
Stock Position:  8.314099471154409
Bond position:  [-828.91771073]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-18.02881603]
curr_Stock_Price:  97.55670507031269
curr_Factors:  [97.55670507 -0.8403757  -1.00661535]
mat_Sqrt:  [[15.38576521  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01837653  0.04897746  1.40058191]
Stock Position:  -0.018376530834857574
Bond Position:  [-16.23606223]


portfolio before change:  [-18.02803108]
curr_Stock_Price:  97.29308190243353
curr_Factors:  [97.2930819  -0.59506723 -1.00388366]
mat_Sqrt:  [[19.66375296  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01235286 -0.02355794  0.6728853 ]
Stock Position:  -0.012352862215837257
Bond Position:  [-16.82618304]


portfolio before change:  [-18.03557675]
curr_Stock_Price:  97.56335141346861
curr_Factors:  [97.56335141 -0.91754338 -1.01419622]
mat_Sqrt:  [[14.13653146  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00214333  0.01119633  0.1382929 ]
Stock Position:  -0.002143327054830693
Bond Position:  [-17.82646658]


portfolio before change:  [-18.03816215]
curr_Stock_Price:  96.69004693618425
curr_Factors:  [96.69004694 -1.03366199 -1.04148039]
mat_Sqrt:  [[12.13832851  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00572031 -0.03402175  0.22497471]
Stock Position:  -0.005720310336300587
Bond Position:  [-17.48506507]


portfolio before change:  [-18.04217381]
curr_Stock_Price:  96.62708713953539
curr_Factors:  [96.62708714 -0.93417623 -1.10107168]
mat_Sqrt:  [[12.62414436  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00794877  0.01458749  0.00350049]
Stock Position:  -0.007948771549192903
Bond Position:  [-17.27410717]


portfolio before change:  [-18.04071605]
curr_Stock_Price:  95.90033002200218
curr_Factors:  [95.90033002 -0.70489767 -1.12972135]
mat_Sqrt:  [[15.31282031  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01265373 -0.06457994  0.46829558]
Stock Position:  -0.01265373027106223
Bond Position:  [-16.82721914]


portfolio before change:  [-18.03791432]
curr_Stock_Price:  95.34641715188702
curr_Factors:  [95.34641715 -0.58912766 -1.12307516]
mat_Sqrt:  [[17.20695977  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00113646 -0.00295932 -0.26017465]
Stock Position:  -0.0011364566422579928
Bond Position:  [-17.92955725]


portfolio before change:  [-18.04317564]
curr_Stock_Price:  96.03132758973223
curr_Factors:  [96.03132759 -0.5317379  -1.1805268 ]
mat_Sqrt:  [[17.32949153  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01274827 -0.05417623  1.0659724 ]
Stock Position:  -0.012748265880333967
Bond Position:  [-16.81894274]


portfolio before change:  [-18.06833925]
curr_Stock_Price:  97.67534382853633
curr_Factors:  [97.67534383 -0.63269366 -1.19829097]
mat_Sqrt:  [[15.65303029  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00302005 0.01143172 0.00505629]
Stock Position:  0.0030200480994145022
Bond Position:  [-18.36332349]


portfolio before change:  [-18.07058525]
curr_Stock_Price:  98.45195636879413
curr_Factors:  [98.45195637 -0.49739341 -1.22959159]
mat_Sqrt:  [[17.50670033  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00325669  0.02204782 -0.0273943 ]
Stock Position:  0.0032566919319835055
Bond Position:  [-18.39121294]


portfolio before change:  [-18.07163065]
curr_Stock_Price:  99.54293511861914
curr_Factors:  [99.54293512 -0.5112959  -1.17813832]
mat_Sqrt:  [[18.3780099   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00489459 -0.00353772 -0.40123545]
Stock Position:  0.004894593126016015
Bond Position:  [-18.55885281]


portfolio before change:  [-18.06958938]
curr_Stock_Price:  100.90802574762587
curr_Factors:  [100.90802575  -0.62832895  -1.17666155]
mat_Sqrt:  [[16.5969505   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00214566 -0.00466044 -1.07088112]
Stock Position:  -0.002145664782057697
Bond Position:  [-17.85307458]


portfolio before change:  [-18.07614606]
curr_Stock_Price:  101.88341365066717
curr_Factors:  [101.88341365  -0.66283139  -1.16617712]
mat_Sqrt:  [[16.35969424  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0055718   0.00940087 -0.10269791]
Stock Position:  -0.005571797152105415
Bond Position:  [-17.50847235]


portfolio before change:  [-18.07663146]
curr_Stock_Price:  101.18484897926098
curr_Factors:  [101.18484898  -0.34851068  -1.18834594]
mat_Sqrt:  [[21.76041328  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00136122 -0.01091762  0.14583292]
Stock Position:  -0.001361215202351046
Bond Position:  [-17.93889711]


portfolio before change:  [-18.077407]
curr_Stock_Price:  98.45952814151833
curr_Factors:  [98.45952814 -0.33188857 -1.15080274]
mat_Sqrt:  [[22.35285992  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00535285 -0.00128602  0.04920682]
Stock Position:  0.0053528541434215175
Bond Position:  [-18.60444649]


portfolio before change:  [-18.09107619]
curr_Stock_Price:  96.77491428501138
curr_Factors:  [96.77491429 -0.15645124 -1.14183502]
mat_Sqrt:  [[26.41947833  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00026341  0.03265341  0.19480917]
Stock Position:  -0.0002634132444378778
Bond Position:  [-18.06558439]


portfolio before change:  [-18.09504957]
curr_Stock_Price:  94.71133578375623
curr_Factors:  [94.71133578 -0.54661602 -1.14992864]
mat_Sqrt:  [[17.36208913  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00317542 -0.00788488  0.19610536]
Stock Position:  0.0031754230102232044
Bond Position:  [-18.39579813]


portfolio before change:  [-18.09883775]
curr_Stock_Price:  94.96684441674867
curr_Factors:  [94.96684442 -0.54533874 -1.13809577]
mat_Sqrt:  [[17.6386642   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02459532 -0.2930334  -0.57873351]
Stock Position:  -0.02459532139510445
Bond Position:  [-15.76309769]


portfolio before change:  [-18.11094421]
curr_Stock_Price:  95.29882581794156
curr_Factors:  [95.29882582 -0.50849914 -1.1366898 ]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-18.11094421]
Stock Price:  94.05827103469433
PL:  [-18.11094421]
Settle:  Tensor("sub_384:0", shape=(), dtype=float64)
PL:  Tensor("sub_385:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  193
output_Z_Vals[:, i, :]:  [[ 1.19251512e+02 -2.92846752e+01 -2.92776944e+01]
 [-7.91666929e-02 -4.76811525e-03 -1.50216348e-02]
 [-7.41664683e-02  1.35498563e-02  5.15355403e-02]
 [-2.18687522e-02  3.69264644e-02  5.89385585e-02]
 [-8.34148376e-02 -1.13099871e-01  8.44557148e-02]
 [-1.52618480e-01  7.50228628e-02 -8.57720214e-05]
 [-1.50443512e-01 -1.26705905e-01  1.08908414e-01]
 [-2.09435720e-02  2.81521466e-02 -9.94476280e-02]
 [-2.69250373e-01 -1.62908823e-01  3.55090808e-01]
 [ 2.73242541e-03 -1.27994839e-02  1.72367320e-02]
 [-2.38291976e-02  1.02795753e-01  1.62642991e-02]
 [-7.48968450e-03 -9.86064414e-03 -1.27221405e-01]
 [ 5.66546221e-03 -1.87905220e-01 -3.91358682e-01]
 [-4.60531650e-02  1.78524992e-02 -2.24785771e-02]
 [-1.95329077e-02 -4.80414749e-02  1.80143374e-02]
 [ 8.17928702e-02 -1.09735294e-02  5.66746211e-02]
 [-2.35647895e-02  1.03259148e-01  6.82888801e-02]
 [ 4.29484159e-02 -2.44161772e-02  5.68228946e-02]
 [-3.75264841e-01 -9.43963680e-01 -2.24505962e-01]
 [ 1.38430031e-01 -1.82576177e-01 -3.03035611e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.25151208 -29.28467519 -29.2776944 ]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  8.31409947  -9.26062741 -83.52111278]
init_Out:  [2.49223638]
Stock Position:  8.314099471154409
Bond position:  [-828.91771073]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [2.41945688]
curr_Stock_Price:  100.01617443075703
curr_Factors:  [100.01617443  -1.17157461  -1.03538611]
mat_Sqrt:  [[11.00523643  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00748335 -0.00150781 -0.04285254]
Stock Position:  -0.007483354305634061
Bond Position:  [3.16791335]


portfolio before change:  [2.43027808]
curr_Stock_Price:  98.67598381076422
curr_Factors:  [98.67598381 -1.27339481 -1.02468505]
mat_Sqrt:  [[ 9.91215456  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00638579  0.00428484  0.14701655]
Stock Position:  -0.0063857927110815135
Bond Position:  [3.06040245]


portfolio before change:  [2.43156109]
curr_Stock_Price:  98.59489505372254
curr_Factors:  [98.59489505 -1.18460416 -1.02710751]
mat_Sqrt:  [[10.79742653  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00082284  0.01167717  0.1681353 ]
Stock Position:  -0.0008228379286711936
Bond Position:  [2.51268871]


portfolio before change:  [2.43392733]
curr_Stock_Price:  96.48270567632393
curr_Factors:  [96.48270568 -0.95173406 -0.98957789]
mat_Sqrt:  [[13.84676769  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00499002 -0.03576532  0.24092865]
Stock Position:  -0.004990017504388574
Bond Position:  [2.91537772]


portfolio before change:  [2.43683688]
curr_Stock_Price:  96.04571098989072
curr_Factors:  [96.04571099 -0.69576875 -0.95350709]
mat_Sqrt:  [[18.45893246  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00816401  0.02372431 -0.00024468]
Stock Position:  -0.008164009832770821
Bond Position:  [3.220955]


portfolio before change:  [2.42852558]
curr_Stock_Price:  97.16239685388281
curr_Factors:  [97.16239685 -0.79885081 -0.92212376]
mat_Sqrt:  [[17.38154824  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00756459 -0.04006793  0.31068539]
Stock Position:  -0.0075645855005300805
Bond Position:  [3.16351884]


portfolio before change:  [2.43332271]
curr_Stock_Price:  96.63280451486463
curr_Factors:  [96.63280451 -0.84698047 -0.89843869]
mat_Sqrt:  [[16.86936265  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00240177  0.00890249 -0.2836964 ]
Stock Position:  -0.0024017711643953086
Bond Position:  [2.66541259]


portfolio before change:  [2.43589767]
curr_Stock_Price:  95.83817111716314
curr_Factors:  [95.83817112 -0.7866036  -0.92042537]
mat_Sqrt:  [[17.38542263  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01155992 -0.05151629  1.01297524]
Stock Position:  -0.011559917579162918
Bond Position:  [3.54377903]


portfolio before change:  [2.4342435]
curr_Stock_Price:  96.05791492713928
curr_Factors:  [96.05791493 -0.73026366 -0.9629096 ]
mat_Sqrt:  [[17.66840523  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00033508 -0.00404755  0.0491716 ]
Stock Position:  0.00033508272345466006
Bond Position:  [2.40205616]


portfolio before change:  [2.4347109]
curr_Stock_Price:  95.66041827458763
curr_Factors:  [95.66041827 -0.47071604 -0.98141348]
mat_Sqrt:  [[22.39135822  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00079741  0.03250687  0.04639752]
Stock Position:  -0.00079740971112782
Bond Position:  [2.51099145]


portfolio before change:  [2.43463573]
curr_Stock_Price:  96.5420128927102
curr_Factors:  [96.54201289 -0.49778311 -0.99826369]
mat_Sqrt:  [[21.62676082  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00155887 -0.00311821 -0.36292726]
Stock Position:  -0.001558867094887042
Bond Position:  [2.5851319]


portfolio before change:  [2.43373157]
curr_Stock_Price:  97.53666192429613
curr_Factors:  [97.53666192 -0.52238504 -1.00318839]
mat_Sqrt:  [[21.21386327  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00372737 -0.05942085 -1.11643739]
Stock Position:  -0.0037273732357002752
Bond Position:  [2.79728712]


portfolio before change:  [2.432205]
curr_Stock_Price:  98.13385931537655
curr_Factors:  [98.13385932 -0.62624444 -0.99062241]
mat_Sqrt:  [[19.4815062   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00257581  0.00564546 -0.06412512]
Stock Position:  -0.0025758088328679874
Bond Position:  [2.68497907]


portfolio before change:  [2.42773561]
curr_Stock_Price:  100.1296297067961
curr_Factors:  [100.12962971  -0.66136528  -1.02916067]
mat_Sqrt:  [[18.46615674  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00092581 -0.01519205  0.05138989]
Stock Position:  -0.0009258110532545197
Bond Position:  [2.52043673]


portfolio before change:  [2.42913855]
curr_Stock_Price:  99.29495788280471
curr_Factors:  [99.29495788 -0.41554734 -1.04614035]
mat_Sqrt:  [[23.02100581  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00404319 -0.00347013  0.16167692]
Stock Position:  0.00404318535181744
Bond Position:  [2.02767063]


portfolio before change:  [2.41893226]
curr_Stock_Price:  96.64524892736421
curr_Factors:  [96.64524893 -0.46321244 -1.0090414 ]
mat_Sqrt:  [[22.17117911  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00031389  0.03265341  0.19480917]
Stock Position:  -0.0003138868017946959
Bond Position:  [2.44926793]


portfolio before change:  [2.42005251]
curr_Stock_Price:  95.02728318024346
curr_Factors:  [95.02728318 -0.36348968 -0.96767556]
mat_Sqrt:  [[25.1032873   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0021478  -0.00772107  0.1620999 ]
Stock Position:  0.0021478030767310093
Bond Position:  [2.21595262]


portfolio before change:  [2.42364673]
curr_Stock_Price:  96.44275877585758
curr_Factors:  [96.44275878 -0.23741925 -0.99219061]
mat_Sqrt:  [[28.20050235  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01579635 -0.29850753 -0.64045302]
Stock Position:  -0.01579634861187408
Bond Position:  [3.94709017]


portfolio before change:  [2.45535223]
curr_Stock_Price:  94.49809402820674
curr_Factors:  [ 9.44980940e+01 -7.24246025e-02 -1.03254402e+00]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [2.45535223]
Stock Price:  97.56176563907806
PL:  [2.45535223]
Settle:  Tensor("sub_386:0", shape=(), dtype=float64)
PL:  Tensor("sub_387:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  194
output_Z_Vals[:, i, :]:  [[ 1.19251512e+02 -2.92846752e+01 -2.92776944e+01]
 [-2.07996563e-01  6.60833321e-02  1.31918579e-01]
 [-2.14360560e-01 -4.53120769e-02  1.46534425e-01]
 [-2.38662710e-02  4.05404123e-02  6.74022248e-02]
 [-8.11642857e-02 -9.42935371e-02  6.53802823e-02]
 [-1.15838614e-02  5.59703784e-03 -4.80887359e-03]
 [ 1.56281494e-02  1.37437694e-02  1.09891412e-03]
 [-5.82080418e-02  9.50716094e-02 -1.14820518e-01]
 [-2.43413022e-01 -1.26055077e-01  2.68227822e-01]
 [ 3.81798671e-02  2.89427813e-02  4.08612377e-03]
 [ 3.77967843e-02  7.86603559e-02 -4.20584987e-03]
 [-2.54843189e-02 -8.91933134e-03 -1.05507590e-01]
 [ 2.81340372e-02 -1.26691955e-01 -2.05727744e-01]
 [-4.23724269e-02  1.95982063e-02 -1.23841638e-02]
 [ 1.30407785e-03 -6.51452523e-02 -3.45157977e-02]
 [ 2.72663333e-02 -5.10071807e-03  8.79525241e-02]
 [-2.35647895e-02  1.03259148e-01  6.82888801e-02]
 [ 4.73578091e-02 -2.25203949e-02  1.31960554e-02]
 [-2.16835733e-01 -7.12069098e-01 -1.70685409e-02]
 [ 5.66536986e-02  1.21716420e-03 -3.57350356e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.25151208 -29.28467519 -29.2776944 ]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  8.31409947  -9.26062741 -83.52111278]
init_Out:  [2.49223638]
Stock Position:  8.314099471154409
Bond position:  [-828.91771073]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-3.32193956]
curr_Stock_Price:  99.3256129981596
curr_Factors:  [99.325613   -1.31391686 -1.03169168]
mat_Sqrt:  [[ 9.51429054  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01885191  0.02089738  0.37632699]
Stock Position:  -0.01885190818025716
Bond Position:  [-1.44946223]


portfolio before change:  [-3.29081323]
curr_Stock_Price:  97.65529144140162
curr_Factors:  [97.65529144 -1.53043078 -1.03163855]
mat_Sqrt:  [[ 7.53361127  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02463882 -0.01432894  0.41802193]
Stock Position:  -0.02463882087727177
Bond Position:  [-0.88470199]


portfolio before change:  [-3.29639992]
curr_Stock_Price:  97.87305736219902
curr_Factors:  [97.87305736 -1.45098535 -1.02934917]
mat_Sqrt:  [[ 8.19346424  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00110589  0.01282     0.19227979]
Stock Position:  -0.0011058937075696428
Bond Position:  [-3.18816273]


portfolio before change:  [-3.29749264]
curr_Stock_Price:  98.14032981618959
curr_Factors:  [98.14032982 -1.34292998 -1.07048651]
mat_Sqrt:  [[ 8.78443933  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00799746 -0.02981823  0.18651175]
Stock Position:  -0.00799746431354443
Bond Position:  [-2.51261885]


portfolio before change:  [-3.29939583]
curr_Stock_Price:  98.29974991254622
curr_Factors:  [98.29974991 -1.177188   -1.06106189]
mat_Sqrt:  [[10.48317505  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00118485  0.00176994 -0.01371838]
Stock Position:  -0.0011848465399873442
Bond Position:  [-3.18292571]


portfolio before change:  [-3.30177548]
curr_Stock_Price:  99.63648099869849
curr_Factors:  [99.636481   -1.17502658 -1.02808308]
mat_Sqrt:  [[11.00575936  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00147262 0.00434616 0.0031349 ]
Stock Position:  0.001472622319090379
Bond Position:  [-3.44850239]


portfolio before change:  [-3.30407312]
curr_Stock_Price:  98.66175332958429
curr_Factors:  [98.66175333 -1.33146403 -0.99650747]
mat_Sqrt:  [[ 9.6188611   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00823288  0.03006428 -0.32755098]
Stock Position:  -0.008232881494750056
Bond Position:  [-2.4918026]


portfolio before change:  [-3.29839498]
curr_Stock_Price:  97.89638710481798
curr_Factors:  [97.8963871  -0.92097974 -0.98172296]
mat_Sqrt:  [[14.60270733  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01314249 -0.03986212  0.76517932]
Stock Position:  -0.013142492721175297
Bond Position:  [-2.01179243]


portfolio before change:  [-3.29244832]
curr_Stock_Price:  97.40563800005575
curr_Factors:  [97.405638   -0.80719921 -0.99818078]
mat_Sqrt:  [[16.01465287  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.0024828  0.00915251 0.01165657]
Stock Position:  0.002482803926459667
Bond Position:  [-3.53428743]


portfolio before change:  [-3.29145674]
curr_Stock_Price:  98.16093882501195
curr_Factors:  [98.16093883 -0.7353479  -1.00340347]
mat_Sqrt:  [[17.25077363  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00225899  0.02487459 -0.01199812]
Stock Position:  0.0022589868298958896
Bond Position:  [-3.51320101]


portfolio before change:  [-3.29237518]
curr_Stock_Price:  98.14322066004856
curr_Factors:  [98.14322066 -1.18392715 -1.03002423]
mat_Sqrt:  [[10.7239169   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00440616 -0.00282054 -0.30098379]
Stock Position:  -0.004406157008493819
Bond Position:  [-2.85994074]


portfolio before change:  [-3.29095027]
curr_Stock_Price:  97.65753976782874
curr_Factors:  [97.65753977 -1.30079969 -1.00528464]
mat_Sqrt:  [[ 9.73164103  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00176035 -0.04006351 -0.58688399]
Stock Position:  -0.0017603541697011418
Bond Position:  [-3.11903841]


portfolio before change:  [-3.29332258]
curr_Stock_Price:  98.56216047046821
curr_Factors:  [98.56216047 -1.74840936 -1.03329265]
mat_Sqrt:  [[ 6.10425096  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00727269  0.0061975  -0.03532857]
Stock Position:  -0.007272687598372885
Bond Position:  [-2.57651077]


portfolio before change:  [-3.29856443]
curr_Stock_Price:  99.19434015133203
curr_Factors:  [99.19434015 -1.95502331 -1.0341834 ]
mat_Sqrt:  [[ 4.99218774  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00148702 -0.02060074 -0.09846396]
Stock Position:  -0.0014870180025095669
Bond Position:  [-3.15106066]


portfolio before change:  [-3.30001408]
curr_Stock_Price:  99.63938145812767
curr_Factors:  [99.63938146 -2.27218244 -1.05197111]
mat_Sqrt:  [[ 3.58731472  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0125687  -0.00161299  0.25090407]
Stock Position:  0.012568695727708006
Bond Position:  [-4.55235115]


portfolio before change:  [-3.29934828]
curr_Stock_Price:  99.78291520265287
curr_Factors:  [99.7829152  -2.18401001 -1.00788325]
mat_Sqrt:  [[ 4.10047869  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00169718  0.03265341  0.19480917]
Stock Position:  -0.0016971775820860432
Bond Position:  [-3.12999895]


portfolio before change:  [-3.30065939]
curr_Stock_Price:  100.09432563216228
curr_Factors:  [100.09432563  -2.03805479  -1.04956204]
mat_Sqrt:  [[ 4.56535449  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01083595 -0.00712157  0.03764467]
Stock Position:  0.010835953415282824
Bond Position:  [-4.38527684]


portfolio before change:  [-3.29741235]
curr_Stock_Price:  100.49516669227954
curr_Factors:  [100.49516669  -2.1445717   -1.02914626]
mat_Sqrt:  [[ 4.20549362  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.05676037 -0.22517602 -0.0486918 ]
Stock Position:  -0.056760371346215886
Bond Position:  [2.40673063]


portfolio before change:  [-3.31431923]
curr_Stock_Price:  100.80363245528757
curr_Factors:  [100.80363246  -2.09859407  -1.02716126]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-3.31431923]
Stock Price:  101.29020546660753
PL:  [-4.60452469]
Settle:  Tensor("sub_388:0", shape=(), dtype=float64)
PL:  Tensor("sub_389:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  195
output_Z_Vals[:, i, :]:  [[ 1.19251512e+02 -2.92846752e+01 -2.92776944e+01]
 [-6.09251061e-02  6.66205253e-03 -8.62102653e-02]
 [-5.99333579e-02  2.37784237e-02  9.58339900e-02]
 [-4.76972540e-02 -4.61169817e-02 -1.71745824e-01]
 [-9.88296441e-02 -2.41910939e-01  2.15109929e-01]
 [-1.70222259e-01 -3.84217011e-02  1.06263125e-02]
 [ 5.26626403e-02  8.25685010e-02 -3.72419512e-02]
 [-1.39466497e-01  2.05887086e-01 -5.67113651e-02]
 [-2.09504891e-01 -9.23569033e-02  1.89530404e-01]
 [ 4.50470017e-02  4.74936917e-02 -1.18045691e-02]
 [ 3.20227840e-02  8.60361604e-02 -1.21309248e-02]
 [ 1.74540480e-01 -1.28174610e-02 -1.64657131e-01]
 [ 2.95047251e-02 -4.97534169e-02 -5.19042054e-01]
 [-7.46780986e-02  2.37862642e-02 -3.34507094e-02]
 [-2.51307830e-02 -4.51079089e-02  2.26614750e-02]
 [ 1.80947768e-01  4.99743226e-02 -1.38551092e-01]
 [ 3.58806793e-03  2.41763622e-02  8.88923433e-02]
 [ 1.61184749e-02  1.14577886e-02 -4.50883191e-02]
 [-3.72846123e-01 -9.54951413e-01 -2.17609870e-01]
 [ 9.84620583e-02 -9.48625162e-02 -1.59907021e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.25151208 -29.28467519 -29.2776944 ]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  8.31409947  -9.26062741 -83.52111278]
init_Out:  [2.49223638]
Stock Position:  8.314099471154409
Bond position:  [-828.91771073]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-0.28286535]
curr_Stock_Price:  99.69114557571874
curr_Factors:  [99.69114558 -0.39429544 -1.01736298]
mat_Sqrt:  [[24.29859294  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00322449  0.00210673 -0.24593389]
Stock Position:  -0.0032244949153643317
Bond Position:  [0.03858824]


portfolio before change:  [-0.28205463]
curr_Stock_Price:  99.44271031884556
curr_Factors:  [99.44271032 -0.58752712 -1.04334647]
mat_Sqrt:  [[19.46675432  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00204232  0.0075194   0.2733877 ]
Stock Position:  -0.002042321471239711
Bond Position:  [-0.07896065]


portfolio before change:  [-0.28389192]
curr_Stock_Price:  100.33265267072882
curr_Factors:  [100.33265267  -0.7909792   -1.03028531]
mat_Sqrt:  [[16.23592991  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00517035 -0.01458347 -0.48994303]
Stock Position:  -0.00517035115341137
Bond Position:  [0.23486313]


portfolio before change:  [-0.28736999]
curr_Stock_Price:  101.01670655152076
curr_Factors:  [101.01670655  -1.04618151  -1.05712994]
mat_Sqrt:  [[12.32924976  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0049611  -0.07649896  0.61364875]
Stock Position:  -0.0049610988867338866
Bond Position:  [0.21378388]


portfolio before change:  [-0.29081026]
curr_Stock_Price:  101.72092851085051
curr_Factors:  [101.72092851  -0.73775441  -1.06046482]
mat_Sqrt:  [[16.8443256   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01003574 -0.01215001  0.03031391]
Stock Position:  -0.010035736675486556
Bond Position:  [0.7300342]


portfolio before change:  [-0.30148784]
curr_Stock_Price:  102.80307255805268
curr_Factors:  [102.80307256  -0.47011233  -1.08205869]
mat_Sqrt:  [[21.77242425  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00216754  0.02611045 -0.10624092]
Stock Position:  0.0021675385283971243
Bond Position:  [-0.52431746]


portfolio before change:  [-0.3029825]
curr_Stock_Price:  102.17398595253461
curr_Factors:  [102.17398595  -0.48446372  -1.09241023]
mat_Sqrt:  [[21.11118838  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00690282  0.06510721 -0.16178174]
Stock Position:  -0.006902817213006586
Bond Position:  [0.40230585]


portfolio before change:  [-0.2942646]
curr_Stock_Price:  100.92560943684951
curr_Factors:  [100.92560944  -0.19404059  -1.08734568]
mat_Sqrt:  [[28.02221048  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00618088 -0.02920582  0.54067749]
Stock Position:  -0.006180875868540822
Bond Position:  [0.32954406]


portfolio before change:  [-0.29611856]
curr_Stock_Price:  101.23889200120063
curr_Factors:  [101.238892    -0.30582905  -1.08303854]
mat_Sqrt:  [[25.24467914  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00173754  0.01501882 -0.03367515]
Stock Position:  0.0017375418303764935
Bond Position:  [-0.47202537]


portfolio before change:  [-0.29822742]
curr_Stock_Price:  100.09311579322552
curr_Factors:  [100.09311579  -0.45873409  -1.05623236]
mat_Sqrt:  [[22.00202429  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00144387  0.02720702 -0.03460615]
Stock Position:  0.0014438677572129748
Bond Position:  [-0.44274864]


portfolio before change:  [-0.29854251]
curr_Stock_Price:  99.95156103573115
curr_Factors:  [99.95156104 -0.17625716 -1.05983444]
mat_Sqrt:  [[29.03767372  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00484195 -0.00405324 -0.46972096]
Stock Position:  0.00484195255445553
Bond Position:  [-0.78250322]


portfolio before change:  [-0.29642246]
curr_Stock_Price:  100.42981698895348
curr_Factors:  [100.42981699  -0.11280528  -1.02410223]
mat_Sqrt:  [[32.21884861  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00241253 -0.01573341 -1.48068251]
Stock Position:  -0.0024125293607157056
Bond Position:  [-0.05413258]


portfolio before change:  [-0.30058031]
curr_Stock_Price:  102.14764642830346
curr_Factors:  [102.14764643   0.21870802  -1.0359878 ]
mat_Sqrt:  [[45.11160359  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00179315  0.00752188 -0.09542556]
Stock Position:  -0.0017931536671281947
Bond Position:  [-0.11741389]


portfolio before change:  [-0.29725848]
curr_Stock_Price:  100.2787634853106
curr_Factors:  [100.27876349   0.16019986  -1.03953143]
mat_Sqrt:  [[41.62172956  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00052063 -0.01426437  0.06464688]
Stock Position:  -0.0005206345385098258
Bond Position:  [-0.24504989]


portfolio before change:  [-0.29411681]
curr_Stock_Price:  94.12677887412225
curr_Factors:  [94.12677887 -0.10227957 -1.03000003]
mat_Sqrt:  [[30.33684511  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0050749   0.01580327 -0.3952477 ]
Stock Position:  0.0050749006865605335
Bond Position:  [-0.77180086]


portfolio before change:  [-0.28831914]
curr_Stock_Price:  95.30722384418195
curr_Factors:  [95.30722384 -0.39035914 -1.05068135]
mat_Sqrt:  [[22.55744403  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00099113 0.00764524 0.25358511]
Stock Position:  0.0009911305764651285
Bond Position:  [-0.38278105]


portfolio before change:  [-0.28445218]
curr_Stock_Price:  99.30535584698399
curr_Factors:  [99.30535585 -0.42745683 -1.04899211]
mat_Sqrt:  [[22.68605817  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00031785  0.00362327 -0.12862442]
Stock Position:  0.00031784715748101007
Bond Position:  [-0.3160161]


portfolio before change:  [-0.28479398]
curr_Stock_Price:  98.4785970549339
curr_Factors:  [98.47859705 -0.37116276 -1.02733818]
mat_Sqrt:  [[24.32095437  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01817043 -0.30198215 -0.62078039]
Stock Position:  -0.018170433792750407
Bond Position:  [1.50460485]


portfolio before change:  [-0.31171329]
curr_Stock_Price:  99.98079090027133
curr_Factors:  [99.9807909  -0.31005405 -1.01244611]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-0.31171329]
Stock Price:  103.31445004119375
PL:  [-3.62616333]
Settle:  Tensor("sub_390:0", shape=(), dtype=float64)
PL:  Tensor("sub_391:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  196
output_Z_Vals[:, i, :]:  [[ 1.19251512e+02 -2.92846752e+01 -2.92776944e+01]
 [-1.31281142e-02 -2.76001176e-02 -9.78245528e-02]
 [-2.41224403e-01 -2.54545374e-02  1.72659401e-01]
 [-4.46321061e-02 -3.28991509e-02 -1.34291896e-01]
 [-9.88296441e-02 -2.41910939e-01  2.15109929e-01]
 [-9.05093339e-02 -1.25379560e-01  3.41861191e-02]
 [ 5.57513224e-02  3.11804297e-02 -1.70892491e-02]
 [-1.20406160e-01  1.94100206e-01 -8.53638831e-02]
 [-1.42256902e-01 -6.75976359e-02  1.34705634e-01]
 [ 4.50470017e-02  4.74936917e-02 -1.18045691e-02]
 [ 7.47604263e-02  5.29203271e-02 -1.54460925e-02]
 [ 9.06895559e-02 -1.03584434e-02 -1.28444433e-01]
 [ 5.15873970e-02 -7.32878394e-03 -1.88972302e-01]
 [-8.45720117e-02  2.97281712e-02 -3.59999752e-02]
 [-8.35390680e-02  5.13585857e-04  1.12094765e-01]
 [-1.65588640e-02 -6.01748834e-02  1.14367749e-01]
 [-2.61690984e-02  8.07939399e-02  1.05716908e-01]
 [-1.68690716e-02  6.29911613e-02 -7.30930376e-02]
 [-2.50569861e-01 -8.00246912e-01 -2.83107120e-02]
 [ 7.02324532e-02 -2.99881356e-02 -7.60643126e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.25151208 -29.28467519 -29.2776944 ]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  8.31409947  -9.26062741 -83.52111278]
init_Out:  [2.49223638]
Stock Position:  8.314099471154409
Bond position:  [-828.91771073]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [6.0992774]
curr_Stock_Price:  100.45877444251596
curr_Factors:  [100.45877444  -1.07413044  -0.96545249]
mat_Sqrt:  [[13.06797411  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00258717 -0.00872792 -0.27906622]
Stock Position:  -0.0025871722052755084
Bond Position:  [6.35918155]


portfolio before change:  [6.1013996]
curr_Stock_Price:  100.25306688591314
curr_Factors:  [100.25306689  -1.08441167  -0.98537138]
mat_Sqrt:  [[12.65325656  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01633079 -0.00804943  0.49254921]
Stock Position:  -0.016330790591532206
Bond Position:  [7.73861144]


portfolio before change:  [6.10062134]
curr_Stock_Price:  100.41920430434085
curr_Factors:  [100.4192043   -1.17514928  -0.98122026]
mat_Sqrt:  [[11.62297706  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00627152 -0.01040362 -0.3830974 ]
Stock Position:  -0.006271523775475783
Bond Position:  [6.73040276]


portfolio before change:  [6.10203771]
curr_Stock_Price:  100.46168796999284
curr_Factors:  [100.46168797  -1.25944756  -0.97973507]
mat_Sqrt:  [[10.70374643  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00571451 -0.07649896  0.61364875]
Stock Position:  -0.005714506379095401
Bond Position:  [6.67612667]


portfolio before change:  [6.09707785]
curr_Stock_Price:  101.62173573746641
curr_Factors:  [101.62173574  -1.42846624  -0.96598256]
mat_Sqrt:  [[ 9.27023427  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00935989 -0.0396485   0.09752348]
Stock Position:  -0.009359893764883873
Bond Position:  [7.0482465]


portfolio before change:  [6.10132102]
curr_Stock_Price:  101.3566808326435
curr_Factors:  [101.35668083  -1.34524348  -0.97456305]
mat_Sqrt:  [[ 9.96261172  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00532672  0.00986012 -0.04875087]
Stock Position:  0.00532672262887264
Bond Position:  [5.56142209]


portfolio before change:  [6.10530464]
curr_Stock_Price:  101.84349005974704
curr_Factors:  [101.84349006  -1.18424575  -0.99456962]
mat_Sqrt:  [[11.52619026  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01152326  0.06137987 -0.2435194 ]
Stock Position:  -0.011523264944566142
Bond Position:  [7.27887416]


portfolio before change:  [6.11990517]
curr_Stock_Price:  100.73437879140631
curr_Factors:  [100.73437879  -0.87369719  -0.97515126]
mat_Sqrt:  [[15.85743838  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00734706 -0.02137625  0.38427768]
Stock Position:  -0.007347062664072835
Bond Position:  [6.86000697]


portfolio before change:  [6.12401958]
curr_Stock_Price:  100.40782787065717
curr_Factors:  [100.40782787  -0.96487771  -0.94197794]
mat_Sqrt:  [[14.91525508  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00294086  0.01501882 -0.03367515]
Stock Position:  0.0029408605994257694
Bond Position:  [5.82873415]


portfolio before change:  [6.12953084]
curr_Stock_Price:  101.7862999055772
curr_Factors:  [101.78629991  -1.24415529  -0.95181041]
mat_Sqrt:  [[11.32383525  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00644427  0.01673488 -0.0440634 ]
Stock Position:  0.006444274507872498
Bond Position:  [5.47359198]


portfolio before change:  [6.12560203]
curr_Stock_Price:  100.96427149091055
curr_Factors:  [100.96427149  -1.21882348  -0.9359639 ]
mat_Sqrt:  [[11.70456953  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00548534 -0.00327563 -0.36641622]
Stock Position:  0.005485335602019407
Bond Position:  [5.57177912]


portfolio before change:  [6.12781205]
curr_Stock_Price:  101.11319627919251
curr_Factors:  [101.11319628  -1.35396194  -0.90718326]
mat_Sqrt:  [[10.53913479  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00121683 -0.00231756 -0.53908538]
Stock Position:  0.0012168322437519745
Bond Position:  [6.00477426]


portfolio before change:  [6.13014673]
curr_Stock_Price:  101.79800143993958
curr_Factors:  [101.79800144  -1.54660133  -0.92191794]
mat_Sqrt:  [[ 8.62332894  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0105705   0.00940087 -0.10269791]
Stock Position:  -0.010570499907965856
Bond Position:  [7.20620249]


portfolio before change:  [6.13776051]
curr_Stock_Price:  101.24816820576572
curr_Factors:  [101.24816821  -1.86029439  -0.91383754]
mat_Sqrt:  [[ 6.31825262  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-9.59831188e-03  1.62410108e-04  3.19775163e-01]
Stock Position:  -0.009598311880769305
Bond Position:  [7.10957201]


portfolio before change:  [6.1389462]
curr_Stock_Price:  101.30983809179122
curr_Factors:  [101.30983809  -1.88196339  -0.92593609]
mat_Sqrt:  [[ 6.11218336  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0008561  -0.01902897  0.32625935]
Stock Position:  0.000856100978968144
Bond Position:  [6.05221475]


portfolio before change:  [6.14133567]
curr_Stock_Price:  102.3333454013644
curr_Factors:  [102.3333454   -1.81477466  -0.9576179 ]
mat_Sqrt:  [[ 6.39708883  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00039137  0.02554929  0.30158091]
Stock Position:  -0.0003913708701724847
Bond Position:  [6.18138596]


portfolio before change:  [6.14260831]
curr_Stock_Price:  103.03064977908988
curr_Factors:  [103.03064978  -1.90238526  -0.98885829]
mat_Sqrt:  [[ 5.71893708  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00527418  0.01991955 -0.20851409]
Stock Position:  -0.00527417947825935
Bond Position:  [6.68601045]


portfolio before change:  [6.14521871]
curr_Stock_Price:  102.85267166317416
curr_Factors:  [102.85267166  -1.83565719  -0.98234993]
mat_Sqrt:  [[ 6.14286025  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0450948  -0.25306029 -0.08076258]
Stock Position:  -0.045094798817353135
Bond Position:  [10.78333924]


portfolio before change:  [6.1221759]
curr_Stock_Price:  103.42344664118649
curr_Factors:  [103.42344664  -1.676324    -0.91696979]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [6.1221759]
Stock Price:  103.15673582322061
PL:  [2.96544007]
Settle:  Tensor("sub_392:0", shape=(), dtype=float64)
PL:  Tensor("sub_393:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  197
output_Z_Vals[:, i, :]:  [[ 1.19251512e+02 -2.92846752e+01 -2.92776944e+01]
 [ 1.58050266e-02 -1.53562794e-02 -8.28177081e-03]
 [-1.44131519e-01  9.12844140e-04  1.31514508e-01]
 [-1.90375782e-02  3.47053708e-02  5.44738992e-02]
 [-8.56364795e-02 -1.31664624e-01  1.03286109e-01]
 [-6.61206873e-02  3.15092929e-02 -2.25499219e-03]
 [-2.22853576e-01 -2.05910387e-01  1.65239233e-01]
 [-1.35378698e-03 -3.33589310e-02 -9.85331994e-02]
 [-2.63998000e-01 -1.90196321e-01  4.21132680e-01]
 [-4.99948398e-04 -7.74813175e-02  3.62888397e-02]
 [-1.02069113e-01  1.47786535e-01  3.21242331e-02]
 [-8.40698396e-02 -9.22048121e-03 -1.23191049e-01]
 [ 2.29632608e-02 -1.45907042e-01 -2.18796887e-01]
 [ 1.07532826e-02  1.96004535e-03  3.48054536e-03]
 [ 2.03667650e-02 -6.32705661e-02 -6.74953846e-02]
 [ 3.07308832e-02 -7.70136319e-03  8.87880114e-02]
 [-2.63359464e-02  9.09659983e-02  9.33803169e-02]
 [ 3.00540199e-02 -3.23610597e-03 -2.26792658e-02]
 [-2.61116725e-01 -7.21729429e-01 -9.40852387e-02]
 [ 7.49795995e-02 -4.08975401e-02 -9.01634687e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.25151208 -29.28467519 -29.2776944 ]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  8.31409947  -9.26062741 -83.52111278]
init_Out:  [2.49223638]
Stock Position:  8.314099471154409
Bond position:  [-828.91771073]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [5.71210564]
curr_Stock_Price:  100.41220634919333
curr_Factors:  [100.41220635  -0.88184106  -0.98676545]
mat_Sqrt:  [[15.49747745  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00088518 -0.00485608 -0.02362559]
Stock Position:  0.0008851775907359134
Bond Position:  [5.62322301]


portfolio before change:  [5.71302999]
curr_Stock_Price:  99.86810056047189
curr_Factors:  [99.86810056 -0.78333478 -1.00977269]
mat_Sqrt:  [[16.62226153  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-7.05455531e-03  2.88666663e-04  3.75174284e-01]
Stock Position:  -0.007054555305614163
Bond Position:  [6.41755503]


portfolio before change:  [5.71936844]
curr_Stock_Price:  99.19706479307101
curr_Factors:  [99.19706479 -1.10669079 -0.97824441]
mat_Sqrt:  [[12.33170057  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00056943  0.0109748   0.15539887]
Stock Position:  -0.0005694308888049445
Bond Position:  [5.77585431]


portfolio before change:  [5.72157474]
curr_Stock_Price:  97.85861860422715
curr_Factors:  [97.8586186  -0.80918253 -0.99071416]
mat_Sqrt:  [[16.17759211  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00420043 -0.04163601  0.29464652]
Stock Position:  -0.004200430842771364
Bond Position:  [6.1326231]


portfolio before change:  [5.72558588]
curr_Stock_Price:  97.26872796884
curr_Factors:  [97.26872797 -1.07914906 -0.95878197]
mat_Sqrt:  [[12.67392218  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00518919  0.00996411 -0.00643287]
Stock Position:  -0.005189192284572103
Bond Position:  [6.23033201]


portfolio before change:  [5.73477905]
curr_Stock_Price:  95.79732506287925
curr_Factors:  [95.79732506 -0.96744152 -0.97754314]
mat_Sqrt:  [[13.69800367  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01419483 -0.06511458  0.47138154]
Stock Position:  -0.014194830601293387
Bond Position:  [7.09460585]


portfolio before change:  [5.75591261]
curr_Stock_Price:  94.4334701925632
curr_Factors:  [94.43347019 -1.08930466 -0.97208078]
mat_Sqrt:  [[12.01925718  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0018577  -0.01054902 -0.28108779]
Stock Position:  -0.001857695168192498
Bond Position:  [5.93134121]


portfolio before change:  [5.75855676]
curr_Stock_Price:  93.80843213781519
curr_Factors:  [93.80843214 -0.8305342  -0.97584476]
mat_Sqrt:  [[15.40782941  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01187354 -0.06014536  1.20137432]
Stock Position:  -0.011873541347886046
Bond Position:  [6.87239506]


portfolio before change:  [5.75045985]
curr_Stock_Price:  94.63507890008192
curr_Factors:  [94.6350789  -0.83917378 -1.0005561 ]
mat_Sqrt:  [[15.03376001  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00032639 -0.02450174  0.10352196]
Stock Position:  0.00032639346126825684
Bond Position:  [5.71957158]


portfolio before change:  [5.75205083]
curr_Stock_Price:  95.12807091916112
curr_Factors:  [95.12807092 -0.91678556 -0.96457572]
mat_Sqrt:  [[14.49585608  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00632567  0.04673421  0.0916415 ]
Stock Position:  -0.006325666392848277
Bond Position:  [6.35379927]


portfolio before change:  [5.74969512]
curr_Stock_Price:  95.75162006119061
curr_Factors:  [95.75162006 -1.03770516 -1.00065034]
mat_Sqrt:  [[12.47095129  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00877673 -0.00291577 -0.35142977]
Stock Position:  -0.00877673054144728
Bond Position:  [6.59008129]


portfolio before change:  [5.73668824]
curr_Stock_Price:  97.42133057414661
curr_Factors:  [97.42133057 -1.22390196 -1.02318102]
mat_Sqrt:  [[10.29812884  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00247285 -0.04613986 -0.62416662]
Stock Position:  -0.002472854136525513
Bond Position:  [5.97759698]


portfolio before change:  [5.74009279]
curr_Stock_Price:  96.64895954402492
curr_Factors:  [96.64895954 -0.81678039 -1.00293973]
mat_Sqrt:  [[15.66400376  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00073508 0.00061982 0.00992903]
Stock Position:  0.0007350837141728865
Bond Position:  [5.66904772]


portfolio before change:  [5.74236292]
curr_Stock_Price:  97.8089526144848
curr_Factors:  [97.80895261 -0.62176216 -0.98344212]
mat_Sqrt:  [[19.64478346  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00025226 -0.02000791 -0.19254555]
Stock Position:  0.0002522648496011318
Bond Position:  [5.71768916]


portfolio before change:  [5.74442127]
curr_Stock_Price:  100.30135107434111
curr_Factors:  [100.30135107  -1.00185813  -1.00622666]
mat_Sqrt:  [[13.46500876  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0036135  -0.00243538  0.25328748]
Stock Position:  0.003613500197841523
Bond Position:  [5.38198232]


portfolio before change:  [5.7489048]
curr_Stock_Price:  101.16972427327164
curr_Factors:  [101.16972427  -1.2426836   -0.99136271]
mat_Sqrt:  [[10.83469226  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00045465  0.02876597  0.26638805]
Stock Position:  -0.00045465407606228036
Bond Position:  [5.79490203]


portfolio before change:  [5.75097846]
curr_Stock_Price:  99.79558750978588
curr_Factors:  [99.79558751 -1.19586773 -0.98278482]
mat_Sqrt:  [[11.29625691  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00224332 -0.00102335 -0.06469763]
Stock Position:  0.002243316390143132
Bond Position:  [5.52710538]


portfolio before change:  [5.74978562]
curr_Stock_Price:  98.64782486320418
curr_Factors:  [98.64782486 -1.318204   -0.98333411]
mat_Sqrt:  [[ 9.8751162   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.03027375 -0.22823089 -0.268399  ]
Stock Position:  -0.030273746795595448
Bond Position:  [8.73622489]


portfolio before change:  [5.70086742]
curr_Stock_Price:  100.33583956139827
curr_Factors:  [100.33583956  -1.50138958  -0.98064232]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [5.70086742]
Stock Price:  100.8983274236597
PL:  [4.80253999]
Settle:  Tensor("sub_394:0", shape=(), dtype=float64)
PL:  Tensor("sub_395:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  198
output_Z_Vals[:, i, :]:  [[ 1.19251512e+02 -2.92846752e+01 -2.92776944e+01]
 [-1.28910151e-01  9.26864128e-03 -9.19951053e-02]
 [-2.95891829e-01 -4.03004956e-02  1.95825727e-01]
 [-6.74155353e-02 -1.30336792e-01 -4.09731505e-01]
 [-9.88296441e-02 -2.41910939e-01  2.15109929e-01]
 [-2.03593497e-02 -1.64818782e-01  2.66900421e-02]
 [ 5.52298431e-02  3.98565621e-02 -2.04917413e-02]
 [-1.44425052e-01  2.19720606e-01 -7.01990414e-02]
 [-2.94517911e-02  2.33204030e-03 -2.70174731e-02]
 [-2.63754277e-02 -1.09924944e-02 -2.61207407e-02]
 [ 1.19437342e-01  1.25961665e-02 -2.85078309e-02]
 [-1.10699537e-01  3.51589541e-02  2.15274400e-02]
 [ 3.66081318e-02 -1.39792031e-02 -2.45888685e-01]
 [-1.31072424e-02 -1.72402558e-03  1.97927008e-02]
 [-1.70355568e-01  1.39836257e-01  3.12798399e-01]
 [-1.37448538e-01 -2.70069510e-01  2.13629987e-01]
 [-4.41717856e-02 -7.88269387e-02  2.60372979e-01]
 [-2.10563600e-01  3.29658242e-01 -7.98446208e-02]
 [-2.96980770e-01 -9.54488760e-01 -1.34390345e-01]
 [ 9.09886644e-02 -4.50087368e-02 -1.05644721e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.25151208 -29.28467519 -29.2776944 ]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  8.31409947  -9.26062741 -83.52111278]
init_Out:  [2.49223638]
Stock Position:  8.314099471154409
Bond position:  [-828.91771073]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [2.00815678]
curr_Stock_Price:  99.96670423842096
curr_Factors:  [99.96670424 -1.1356442  -0.97249494]
mat_Sqrt:  [[12.14233403  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0121434   0.002931   -0.26243643]
Stock Position:  -0.012143403215542699
Bond Position:  [3.22209278]


portfolio before change:  [2.00314812]
curr_Stock_Price:  100.44550579135215
curr_Factors:  [100.44550579  -1.23938762  -0.99152364]
mat_Sqrt:  [[10.79090971  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0238126  -0.01274414  0.55863629]
Stock Position:  -0.023812600687984343
Bond Position:  [4.39501684]


portfolio before change:  [1.97213033]
curr_Stock_Price:  101.79423200414952
curr_Factors:  [101.794232    -1.42076253  -0.97509648]
mat_Sqrt:  [[ 9.27288382  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01665252 -0.04121611 -1.16884994]
Stock Position:  -0.016652522872653185
Bond Position:  [3.66726111]


portfolio before change:  [1.97355602]
curr_Stock_Price:  101.7636805539283
curr_Factors:  [101.76368055  -1.30352532  -0.97835799]
mat_Sqrt:  [[10.38923274  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0058875  -0.07649896  0.61364875]
Stock Position:  -0.005887501874295927
Bond Position:  [2.57268988]


portfolio before change:  [1.98075209]
curr_Stock_Price:  100.65067581745491
curr_Factors:  [100.65067582  -1.10151346  -0.99802764]
mat_Sqrt:  [[12.33097962  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00155437 -0.05212028  0.07613926]
Stock Position:  -0.001554367207586252
Bond Position:  [2.1372002]


portfolio before change:  [1.97988311]
curr_Stock_Price:  101.5535158350429
curr_Factors:  [101.55351584  -0.83352465  -0.99938006]
mat_Sqrt:  [[16.24331104  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.003206    0.01260375 -0.05845723]
Stock Position:  0.00320600127815739
Bond Position:  [1.65430241]


portfolio before change:  [1.98464451]
curr_Stock_Price:  102.90965052452772
curr_Factors:  [102.90965052  -1.02670128  -0.99179335]
mat_Sqrt:  [[13.67209361  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01119662  0.06948176 -0.20025833]
Stock Position:  -0.011196617987282395
Bond Position:  [3.13688456]


portfolio before change:  [1.97235527]
curr_Stock_Price:  104.0772856705416
curr_Factors:  [104.07728567  -0.97419841  -1.00797201]
mat_Sqrt:  [[14.33871658  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00243442  0.00073746 -0.07707333]
Stock Position:  -0.0024344226679290475
Bond Position:  [2.22572337]


portfolio before change:  [1.97028679]
curr_Stock_Price:  105.15555965450153
curr_Factors:  [105.15555965  -1.09524849  -1.02517026]
mat_Sqrt:  [[12.61670874  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00253562 -0.00347613 -0.0745152 ]
Stock Position:  -0.002535615844165644
Bond Position:  [2.2369209]


portfolio before change:  [1.97640356]
curr_Stock_Price:  102.96379797267265
curr_Factors:  [102.96379797  -0.62057688  -0.98875085]
mat_Sqrt:  [[20.59502874  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00553257  0.00398326 -0.08132491]
Stock Position:  0.005532569940181923
Bond Position:  [1.40674914]


portfolio before change:  [1.99606116]
curr_Stock_Price:  106.45329205493087
curr_Factors:  [106.45329205  -0.70541553  -0.99299334]
mat_Sqrt:  [[19.47823012  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00541104  0.01111824  0.06141179]
Stock Position:  -0.005411039202040463
Bond Position:  [2.5720841]


portfolio before change:  [2.00168737]
curr_Stock_Price:  105.53237608929514
curr_Factors:  [105.53237609  -0.53791948  -0.96301788]
mat_Sqrt:  [[23.52539406  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-5.92747874e-04 -4.42061215e-03 -7.01451976e-01]
Stock Position:  -0.0005927478744391242
Bond Position:  [2.06424146]


portfolio before change:  [2.00169105]
curr_Stock_Price:  106.39690001201525
curr_Factors:  [106.39690001  -0.68704524  -0.95337749]
mat_Sqrt:  [[20.63015224  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00044166 -0.00054518  0.05646307]
Stock Position:  -0.0004416636540807389
Bond Position:  [2.0486827]


portfolio before change:  [2.00225781]
curr_Stock_Price:  106.27344490551832
curr_Factors:  [106.27344491  -0.7705661   -0.95213693]
mat_Sqrt:  [[18.9786073   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00542165  0.04422011  0.89232676]
Stock Position:  -0.005421646804584785
Bond Position:  [2.5784349]


portfolio before change:  [2.00254297]
curr_Stock_Price:  106.33976010853316
curr_Factors:  [106.33976011  -1.27982734  -0.95173336]
mat_Sqrt:  [[11.41671548  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00883044 -0.08540348  0.60942689]
Stock Position:  -0.008830443738589983
Bond Position:  [2.94157023]


portfolio before change:  [1.99461271]
curr_Stock_Price:  107.3211083700676
curr_Factors:  [107.32110837  -1.35866291  -0.95622573]
mat_Sqrt:  [[10.60087675  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 6.54787671e-04 -2.49272667e-02  7.42771635e-01]
Stock Position:  0.0006547876714069177
Bond Position:  [1.92434017]


portfolio before change:  [1.99531267]
curr_Stock_Price:  107.65528281656873
curr_Factors:  [107.65528282  -1.21562584  -0.9693109 ]
mat_Sqrt:  [[12.10958824  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01803117  0.10424709 -0.22777448]
Stock Position:  -0.018031172586193425
Bond Position:  [3.93646365]


portfolio before change:  [2.01337871]
curr_Stock_Price:  106.70793459755166
curr_Factors:  [106.7079346   -0.9881135   -0.91771371]
mat_Sqrt:  [[15.86742575  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02199839 -0.30183585 -0.38337825]
Stock Position:  -0.021998393661664714
Bond Position:  [4.36078186]


portfolio before change:  [2.01934969]
curr_Stock_Price:  106.48607038736543
curr_Factors:  [106.48607039  -1.18858614  -0.97456479]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [2.01934969]
Stock Price:  107.22823713294608
PL:  [-5.20888744]
Settle:  Tensor("sub_396:0", shape=(), dtype=float64)
PL:  Tensor("sub_397:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  199
output_Z_Vals[:, i, :]:  [[ 1.19251512e+02 -2.92846752e+01 -2.92776944e+01]
 [-5.21979085e-02  5.70273592e-03 -8.17212895e-02]
 [-3.75460120e-01 -5.98339831e-02  2.45954427e-01]
 [-1.90307254e-02 -1.32779696e-01 -4.22575257e-01]
 [-9.67904660e-02 -2.24870912e-01  1.97826078e-01]
 [-6.92915542e-02  2.81611248e-02 -1.89798725e-02]
 [-1.12990002e-01 -8.87191883e-02  8.14167007e-02]
 [-3.67352336e-02  6.60413145e-02 -9.59393676e-02]
 [-3.33857033e-01 -1.86346869e-01  4.06922923e-01]
 [-2.11043026e-03 -1.41909307e-01  5.52249177e-02]
 [-2.24511344e-01  1.38909795e-01  2.74037333e-02]
 [-1.91866488e-01 -1.23773583e-02 -1.88916838e-01]
 [-1.34421506e-01 -6.22672759e-01 -4.64339226e-02]
 [ 2.23807857e-01 -2.06166676e-01 -7.29183698e-02]
 [ 1.11348156e-02 -5.79141975e-02 -1.09473076e-01]
 [ 2.17665317e-01  8.75203680e-02 -2.88439388e-01]
 [-6.76843395e-02 -1.17189248e-01 -1.52598734e-01]
 [ 3.41813318e-02 -2.81855128e-02  1.43565026e-01]
 [-4.39011753e-01 -1.10800216e+00 -3.30861265e-01]
 [ 1.42333846e-01 -2.91638410e-01 -5.41931275e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.25151208 -29.28467519 -29.2776944 ]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  8.31409947  -9.26062741 -83.52111278]
init_Out:  [2.49223638]
Stock Position:  8.314099471154409
Bond position:  [-828.91771073]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [3.17709072]
curr_Stock_Price:  100.1073008175253
curr_Factors:  [100.10730082  -0.60929835  -0.98504079]
mat_Sqrt:  [[20.32605334  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00338147  0.00180336 -0.23312809]
Stock Position:  -0.0033814706518915006
Bond Position:  [3.51560062]


portfolio before change:  [3.17242732]
curr_Stock_Price:  101.7463552040155
curr_Factors:  [101.7463552   -0.43456813  -1.02208649]
mat_Sqrt:  [[23.70837563  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01378415 -0.01892117  0.70163952]
Stock Position:  -0.013784149314412535
Bond Position:  [4.57491427]


portfolio before change:  [3.17021797]
curr_Stock_Price:  101.98962185290776
curr_Factors:  [101.98962185  -0.4428008   -1.01252148]
mat_Sqrt:  [[23.7967444   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00456856 -0.04198863 -1.20548959]
Stock Position:  -0.00456856172195056
Bond Position:  [3.63616385]


portfolio before change:  [3.18049002]
curr_Stock_Price:  99.94020285594715
curr_Factors:  [99.94020286 -0.21828966 -1.00055578]
mat_Sqrt:  [[29.53944804  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00210618 -0.07111043  0.56434274]
Stock Position:  -0.0021061845413706563
Bond Position:  [3.39098253]


portfolio before change:  [3.18280901]
curr_Stock_Price:  99.24171461836325
curr_Factors:  [99.24171462 -0.33699204 -0.99604371]
mat_Sqrt:  [[26.16761778  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00276826  0.00890533 -0.05414429]
Stock Position:  -0.0027682568572014645
Bond Position:  [3.45753557]


portfolio before change:  [3.18701836]
curr_Stock_Price:  98.0334256135473
curr_Factors:  [98.03342561 -0.16964117 -1.04238688]
mat_Sqrt:  [[29.17407427  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00338182 -0.02805547  0.23225918]
Stock Position:  -0.003381824770538083
Bond Position:  [3.51855023]


portfolio before change:  [3.19144391]
curr_Stock_Price:  96.98493697786425
curr_Factors:  [96.98493698 -0.41633974 -1.01219096]
mat_Sqrt:  [[23.2434874   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00234963  0.0208841  -0.27368831]
Stock Position:  -0.002349630010828877
Bond Position:  [3.41932263]


portfolio before change:  [3.19515201]
curr_Stock_Price:  95.7706336386024
curr_Factors:  [95.77063364 -0.29123315 -1.01679817]
mat_Sqrt:  [[25.89176027  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00987209 -0.05892805  1.16083783]
Stock Position:  -0.009872086412268579
Bond Position:  [4.14060798]


portfolio before change:  [3.22642117]
curr_Stock_Price:  92.70807134457853
curr_Factors:  [92.70807134 -0.27803786 -1.02002328]
mat_Sqrt:  [[25.31493144  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00021719 -0.04487566  0.15754132]
Stock Position:  0.00021719301619145274
Bond Position:  [3.20628563]


portfolio before change:  [3.22623559]
curr_Stock_Price:  88.16255833863612
curr_Factors:  [ 8.81625583e+01  1.27781892e-02 -1.05287919e+00]
mat_Sqrt:  [[31.1583219   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00691086  0.04392713  0.07817522]
Stock Position:  -0.0069108646276415196
Bond Position:  [3.8355151]


portfolio before change:  [3.23748813]
curr_Stock_Price:  86.67308571896415
curr_Factors:  [ 8.66730857e+01  7.90628809e-02 -1.03922689e+00]
mat_Sqrt:  [[33.18106552  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00695422 -0.00391406 -0.53892715]
Stock Position:  -0.006954223891404516
Bond Position:  [3.84023218]


portfolio before change:  [3.23518993]
curr_Stock_Price:  87.14163273041474
curr_Factors:  [87.14163273 -0.24398462 -1.02067304]
mat_Sqrt:  [[24.60321445  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00650229 -0.19690642 -0.13246306]
Stock Position:  -0.006502285798799204
Bond Position:  [3.80180973]


portfolio before change:  [3.2489601]
curr_Stock_Price:  85.17007979361075
curr_Factors:  [85.17007979 -0.28499992 -1.00874655]
mat_Sqrt:  [[23.35716343  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00871682 -0.06519563 -0.20801581]
Stock Position:  0.008716822883525823
Bond Position:  [2.5065476]


portfolio before change:  [3.25377641]
curr_Stock_Price:  85.65071223722809
curr_Factors:  [85.65071224 -0.6896146  -1.00860308]
mat_Sqrt:  [[15.67488662  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00081064 -0.01831408 -0.31229621]
Stock Position:  -0.0008106355707477203
Bond Position:  [3.32320792]


portfolio before change:  [3.25489878]
curr_Stock_Price:  85.29115336298865
curr_Factors:  [85.29115336 -0.61920748 -1.00295964]
mat_Sqrt:  [[16.84246909  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.009562    0.02767637 -0.82283729]
Stock Position:  0.00956199703536083
Bond Position:  [2.43934503]


portfolio before change:  [3.26315488]
curr_Stock_Price:  86.09079641098421
curr_Factors:  [86.09079641 -0.50790915 -1.00988359]
mat_Sqrt:  [[18.87068711  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00539775 -0.03705849 -0.43532171]
Stock Position:  -0.005397749347043464
Bond Position:  [3.72785142]


portfolio before change:  [3.26873613]
curr_Stock_Price:  85.2294793806396
curr_Factors:  [85.22947938 -0.24248597 -1.04682001]
mat_Sqrt:  [[23.47747377  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00267314 -0.00891304  0.40955106]
Stock Position:  0.002673144213563865
Bond Position:  [3.04090544]


portfolio before change:  [3.27575437]
curr_Stock_Price:  87.57051178357952
curr_Factors:  [87.57051178 -0.16471255 -1.02931328]
mat_Sqrt:  [[26.53377601  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0201689  -0.35038105 -0.9438551 ]
Stock Position:  -0.02016889789508018
Bond Position:  [5.04195508]


portfolio before change:  [3.26083667]
curr_Stock_Price:  88.37265513782857
curr_Factors:  [88.37265514 -0.09943014 -1.02420294]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [3.26083667]
Stock Price:  91.37998373789347
PL:  [3.26083667]
Settle:  Tensor("sub_398:0", shape=(), dtype=float64)
PL:  Tensor("sub_399:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


FINAL AVERAGE P&L:  -1.322802619270093
FINAL STD P&L:  8.43154779476259
