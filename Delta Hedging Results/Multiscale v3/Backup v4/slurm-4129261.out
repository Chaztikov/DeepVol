WARNING:tensorflow:From main.py:92: The name tf.reset_default_graph is deprecated. Please use tf.compat.v1.reset_default_graph instead.

WARNING From main.py:92: The name tf.reset_default_graph is deprecated. Please use tf.compat.v1.reset_default_graph instead.

WARNING:tensorflow:From main.py:93: The name tf.Session is deprecated. Please use tf.compat.v1.Session instead.

WARNING From main.py:93: The name tf.Session is deprecated. Please use tf.compat.v1.Session instead.

2019-12-17 23:42:02.526422: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcuda.so.1
2019-12-17 23:42:02.544410: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1618] Found device 0 with properties: 
name: Tesla P100-PCIE-16GB major: 6 minor: 0 memoryClockRate(GHz): 1.3285
pciBusID: 0000:82:00.0
2019-12-17 23:42:02.546159: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcudart.so.10.0
2019-12-17 23:42:02.596872: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcublas.so.10.0
2019-12-17 23:42:02.612533: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcufft.so.10.0
2019-12-17 23:42:02.643962: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcurand.so.10.0
2019-12-17 23:42:02.679666: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcusolver.so.10.0
2019-12-17 23:42:02.699264: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcusparse.so.10.0
2019-12-17 23:42:02.742338: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcudnn.so.7
2019-12-17 23:42:02.744563: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1746] Adding visible gpu devices: 0
2019-12-17 23:42:02.744984: I tensorflow/core/platform/cpu_feature_guard.cc:142] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX AVX2 FMA
2019-12-17 23:42:02.751910: I tensorflow/core/platform/profile_utils/cpu_utils.cc:94] CPU Frequency: 2399880000 Hz
2019-12-17 23:42:02.752120: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x5600687aa9c0 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2019-12-17 23:42:02.752139: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2019-12-17 23:42:02.753269: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1618] Found device 0 with properties: 
name: Tesla P100-PCIE-16GB major: 6 minor: 0 memoryClockRate(GHz): 1.3285
pciBusID: 0000:82:00.0
2019-12-17 23:42:02.753296: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcudart.so.10.0
2019-12-17 23:42:02.753310: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcublas.so.10.0
2019-12-17 23:42:02.753321: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcufft.so.10.0
2019-12-17 23:42:02.753333: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcurand.so.10.0
2019-12-17 23:42:02.753344: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcusolver.so.10.0
2019-12-17 23:42:02.753354: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcusparse.so.10.0
2019-12-17 23:42:02.753366: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcudnn.so.7
2019-12-17 23:42:02.755428: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1746] Adding visible gpu devices: 0
2019-12-17 23:42:02.755459: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcudart.so.10.0
2019-12-17 23:42:02.853256: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1159] Device interconnect StreamExecutor with strength 1 edge matrix:
2019-12-17 23:42:02.853289: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1165]      0 
2019-12-17 23:42:02.853301: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1178] 0:   N 
2019-12-17 23:42:02.856610: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1304] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 15216 MB memory) -> physical GPU (device: 0, name: Tesla P100-PCIE-16GB, pci bus id: 0000:82:00.0, compute capability: 6.0)
2019-12-17 23:42:02.858803: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x560068de3cb0 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2019-12-17 23:42:02.858822: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Tesla P100-PCIE-16GB, Compute Capability 6.0
INFO   Y0_true: -1.0000e+00
WARNING:tensorflow:From /home/dz4/DeepBSDE/solver.py:229: The name tf.placeholder is deprecated. Please use tf.compat.v1.placeholder instead.

WARNING From /home/dz4/DeepBSDE/solver.py:229: The name tf.placeholder is deprecated. Please use tf.compat.v1.placeholder instead.

WARNING:tensorflow:From /home/dz4/DeepBSDE/solver.py:234: The name tf.random_uniform is deprecated. Please use tf.random.uniform instead.

WARNING From /home/dz4/DeepBSDE/solver.py:234: The name tf.random_uniform is deprecated. Please use tf.random.uniform instead.

WARNING:tensorflow:From /home/dz4/DeepBSDE/solver.py:308: The name tf.variable_scope is deprecated. Please use tf.compat.v1.variable_scope instead.

WARNING From /home/dz4/DeepBSDE/solver.py:308: The name tf.variable_scope is deprecated. Please use tf.compat.v1.variable_scope instead.

WARNING:tensorflow:From /home/dz4/DeepBSDE/solver.py:314: calling reduce_sum_v1 (from tensorflow.python.ops.math_ops) with keep_dims is deprecated and will be removed in a future version.
Instructions for updating:
keep_dims is deprecated, use keepdims instead
WARNING From /home/dz4/DeepBSDE/solver.py:314: calling reduce_sum_v1 (from tensorflow.python.ops.math_ops) with keep_dims is deprecated and will be removed in a future version.
Instructions for updating:
keep_dims is deprecated, use keepdims instead
WARNING:tensorflow:From /home/dz4/DeepBSDE/solver.py:484: The name tf.get_variable is deprecated. Please use tf.compat.v1.get_variable instead.

WARNING From /home/dz4/DeepBSDE/solver.py:484: The name tf.get_variable is deprecated. Please use tf.compat.v1.get_variable instead.

WARNING:tensorflow:From /home/dz4/DeepBSDE/solver.py:486: calling RandomNormal.__init__ (from tensorflow.python.ops.init_ops) with dtype is deprecated and will be removed in a future version.
Instructions for updating:
Call initializer instance with the dtype argument instead of passing it to the constructor
WARNING From /home/dz4/DeepBSDE/solver.py:486: calling RandomNormal.__init__ (from tensorflow.python.ops.init_ops) with dtype is deprecated and will be removed in a future version.
Instructions for updating:
Call initializer instance with the dtype argument instead of passing it to the constructor
WARNING:tensorflow:From /home/dz4/DeepBSDE/solver.py:489: calling RandomUniform.__init__ (from tensorflow.python.ops.init_ops) with dtype is deprecated and will be removed in a future version.
Instructions for updating:
Call initializer instance with the dtype argument instead of passing it to the constructor
WARNING From /home/dz4/DeepBSDE/solver.py:489: calling RandomUniform.__init__ (from tensorflow.python.ops.init_ops) with dtype is deprecated and will be removed in a future version.
Instructions for updating:
Call initializer instance with the dtype argument instead of passing it to the constructor
WARNING:tensorflow:From /home/dz4/DeepBSDE/solver.py:491: calling Constant.__init__ (from tensorflow.python.ops.init_ops) with dtype is deprecated and will be removed in a future version.
Instructions for updating:
Call initializer instance with the dtype argument instead of passing it to the constructor
WARNING From /home/dz4/DeepBSDE/solver.py:491: calling Constant.__init__ (from tensorflow.python.ops.init_ops) with dtype is deprecated and will be removed in a future version.
Instructions for updating:
Call initializer instance with the dtype argument instead of passing it to the constructor
WARNING:tensorflow:From /home/dz4/DeepBSDE/solver.py:327: where (from tensorflow.python.ops.array_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.where in 2.0, which has the same broadcast rule as np.where
WARNING From /home/dz4/DeepBSDE/solver.py:327: where (from tensorflow.python.ops.array_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.where in 2.0, which has the same broadcast rule as np.where
WARNING:tensorflow:From /home/dz4/DeepBSDE/solver.py:334: The name tf.train.piecewise_constant is deprecated. Please use tf.compat.v1.train.piecewise_constant instead.

WARNING From /home/dz4/DeepBSDE/solver.py:334: The name tf.train.piecewise_constant is deprecated. Please use tf.compat.v1.train.piecewise_constant instead.

WARNING:tensorflow:From /home/dz4/DeepBSDE/solver.py:337: The name tf.trainable_variables is deprecated. Please use tf.compat.v1.trainable_variables instead.

WARNING From /home/dz4/DeepBSDE/solver.py:337: The name tf.trainable_variables is deprecated. Please use tf.compat.v1.trainable_variables instead.

WARNING:tensorflow:From /home/dz4/DeepBSDE/solver.py:339: The name tf.train.AdamOptimizer is deprecated. Please use tf.compat.v1.train.AdamOptimizer instead.

WARNING From /home/dz4/DeepBSDE/solver.py:339: The name tf.train.AdamOptimizer is deprecated. Please use tf.compat.v1.train.AdamOptimizer instead.

WARNING:tensorflow:From /home/dz4/DeepBSDE/solver.py:192: The name tf.global_variables_initializer is deprecated. Please use tf.compat.v1.global_variables_initializer instead.

WARNING From /home/dz4/DeepBSDE/solver.py:192: The name tf.global_variables_initializer is deprecated. Please use tf.compat.v1.global_variables_initializer instead.

2019-12-17 23:42:12.657252: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcublas.so.10.0
INFO   step:     0,    loss: 2.0998e+02,   Y0: 2.6896e+00,  elapsed time   9
INFO   step:     1,    loss: 2.0292e+02,   Y0: 2.6846e+00,  elapsed time  13
INFO   step:     2,    loss: 2.0290e+02,   Y0: 2.6797e+00,  elapsed time  14
INFO   step:     3,    loss: 2.0288e+02,   Y0: 2.6747e+00,  elapsed time  15
INFO   step:     4,    loss: 2.0285e+02,   Y0: 2.6699e+00,  elapsed time  16
INFO   step:     5,    loss: 2.0282e+02,   Y0: 2.6663e+00,  elapsed time  17
INFO   step:     6,    loss: 2.0279e+02,   Y0: 2.6626e+00,  elapsed time  18
INFO   step:     7,    loss: 2.0277e+02,   Y0: 2.6603e+00,  elapsed time  19
INFO   step:     8,    loss: 2.0274e+02,   Y0: 2.6574e+00,  elapsed time  20
INFO   step:     9,    loss: 2.0272e+02,   Y0: 2.6543e+00,  elapsed time  21
INFO   step:    10,    loss: 2.0270e+02,   Y0: 2.6505e+00,  elapsed time  22
INFO   step:    11,    loss: 2.0268e+02,   Y0: 2.6465e+00,  elapsed time  23
INFO   step:    12,    loss: 2.0266e+02,   Y0: 2.6424e+00,  elapsed time  24
INFO   step:    13,    loss: 2.0264e+02,   Y0: 2.6382e+00,  elapsed time  25
INFO   step:    14,    loss: 2.0262e+02,   Y0: 2.6340e+00,  elapsed time  25
INFO   step:    15,    loss: 2.0259e+02,   Y0: 2.6299e+00,  elapsed time  26
INFO   step:    16,    loss: 2.0257e+02,   Y0: 2.6255e+00,  elapsed time  27
INFO   step:    17,    loss: 2.0254e+02,   Y0: 2.6217e+00,  elapsed time  28
INFO   step:    18,    loss: 2.0252e+02,   Y0: 2.6176e+00,  elapsed time  29
INFO   step:    19,    loss: 2.0250e+02,   Y0: 2.6135e+00,  elapsed time  30
INFO   step:    20,    loss: 2.0247e+02,   Y0: 2.6096e+00,  elapsed time  31
INFO   step:    21,    loss: 2.0245e+02,   Y0: 2.6060e+00,  elapsed time  32
INFO   step:    22,    loss: 2.0242e+02,   Y0: 2.6034e+00,  elapsed time  33
INFO   step:    23,    loss: 2.0240e+02,   Y0: 2.6011e+00,  elapsed time  34
INFO   step:    24,    loss: 2.0237e+02,   Y0: 2.5992e+00,  elapsed time  35
INFO   step:    25,    loss: 2.0235e+02,   Y0: 2.5976e+00,  elapsed time  36
INFO   step:    26,    loss: 2.0232e+02,   Y0: 2.5961e+00,  elapsed time  37
INFO   step:    27,    loss: 2.0230e+02,   Y0: 2.5947e+00,  elapsed time  38
INFO   step:    28,    loss: 2.0227e+02,   Y0: 2.5933e+00,  elapsed time  39
INFO   step:    29,    loss: 2.0225e+02,   Y0: 2.5919e+00,  elapsed time  40
INFO   step:    30,    loss: 2.0223e+02,   Y0: 2.5907e+00,  elapsed time  41
INFO   step:    31,    loss: 2.0220e+02,   Y0: 2.5896e+00,  elapsed time  42
INFO   step:    32,    loss: 2.0218e+02,   Y0: 2.5883e+00,  elapsed time  43
INFO   step:    33,    loss: 2.0216e+02,   Y0: 2.5874e+00,  elapsed time  44
INFO   step:    34,    loss: 2.0214e+02,   Y0: 2.5859e+00,  elapsed time  45
INFO   step:    35,    loss: 2.0211e+02,   Y0: 2.5847e+00,  elapsed time  46
INFO   step:    36,    loss: 2.0209e+02,   Y0: 2.5838e+00,  elapsed time  46
INFO   step:    37,    loss: 2.0206e+02,   Y0: 2.5823e+00,  elapsed time  47
INFO   step:    38,    loss: 2.0204e+02,   Y0: 2.5807e+00,  elapsed time  48
INFO   step:    39,    loss: 2.0201e+02,   Y0: 2.5793e+00,  elapsed time  49
INFO   step:    40,    loss: 2.0199e+02,   Y0: 2.5778e+00,  elapsed time  50
INFO   step:    41,    loss: 2.0196e+02,   Y0: 2.5766e+00,  elapsed time  51
INFO   step:    42,    loss: 2.0194e+02,   Y0: 2.5752e+00,  elapsed time  52
INFO   step:    43,    loss: 2.0192e+02,   Y0: 2.5743e+00,  elapsed time  53
INFO   step:    44,    loss: 2.0190e+02,   Y0: 2.5732e+00,  elapsed time  54
INFO   step:    45,    loss: 2.0187e+02,   Y0: 2.5724e+00,  elapsed time  55
INFO   step:    46,    loss: 2.0185e+02,   Y0: 2.5716e+00,  elapsed time  56
INFO   step:    47,    loss: 2.0183e+02,   Y0: 2.5709e+00,  elapsed time  57
INFO   step:    48,    loss: 2.0180e+02,   Y0: 2.5701e+00,  elapsed time  58
INFO   step:    49,    loss: 2.0178e+02,   Y0: 2.5693e+00,  elapsed time  59
INFO   step:    50,    loss: 2.0176e+02,   Y0: 2.5682e+00,  elapsed time  60
INFO   step:    51,    loss: 2.0173e+02,   Y0: 2.5668e+00,  elapsed time  61
INFO   step:    52,    loss: 2.0171e+02,   Y0: 2.5657e+00,  elapsed time  62
INFO   step:    53,    loss: 2.0169e+02,   Y0: 2.5646e+00,  elapsed time  63
INFO   step:    54,    loss: 2.0166e+02,   Y0: 2.5634e+00,  elapsed time  64
INFO   step:    55,    loss: 2.0164e+02,   Y0: 2.5622e+00,  elapsed time  65
INFO   step:    56,    loss: 2.0162e+02,   Y0: 2.5607e+00,  elapsed time  66
INFO   step:    57,    loss: 2.0159e+02,   Y0: 2.5589e+00,  elapsed time  67
INFO   step:    58,    loss: 2.0157e+02,   Y0: 2.5572e+00,  elapsed time  67
INFO   step:    59,    loss: 2.0155e+02,   Y0: 2.5560e+00,  elapsed time  68
INFO   step:    60,    loss: 2.0153e+02,   Y0: 2.5541e+00,  elapsed time  69
INFO   step:    61,    loss: 2.0151e+02,   Y0: 2.5528e+00,  elapsed time  70
INFO   step:    62,    loss: 2.0149e+02,   Y0: 2.5519e+00,  elapsed time  71
INFO   step:    63,    loss: 2.0147e+02,   Y0: 2.5505e+00,  elapsed time  72
INFO   step:    64,    loss: 2.0144e+02,   Y0: 2.5490e+00,  elapsed time  73
INFO   step:    65,    loss: 2.0142e+02,   Y0: 2.5471e+00,  elapsed time  74
INFO   step:    66,    loss: 2.0140e+02,   Y0: 2.5460e+00,  elapsed time  75
INFO   step:    67,    loss: 2.0137e+02,   Y0: 2.5455e+00,  elapsed time  76
INFO   step:    68,    loss: 2.0135e+02,   Y0: 2.5450e+00,  elapsed time  77
INFO   step:    69,    loss: 2.0133e+02,   Y0: 2.5448e+00,  elapsed time  78
INFO   step:    70,    loss: 2.0131e+02,   Y0: 2.5443e+00,  elapsed time  79
INFO   step:    71,    loss: 2.0128e+02,   Y0: 2.5435e+00,  elapsed time  80
INFO   step:    72,    loss: 2.0126e+02,   Y0: 2.5422e+00,  elapsed time  81
INFO   step:    73,    loss: 2.0124e+02,   Y0: 2.5410e+00,  elapsed time  82
INFO   step:    74,    loss: 2.0121e+02,   Y0: 2.5406e+00,  elapsed time  83
INFO   step:    75,    loss: 2.0119e+02,   Y0: 2.5399e+00,  elapsed time  84
INFO   step:    76,    loss: 2.0117e+02,   Y0: 2.5391e+00,  elapsed time  85
INFO   step:    77,    loss: 2.0114e+02,   Y0: 2.5377e+00,  elapsed time  86
INFO   step:    78,    loss: 2.0112e+02,   Y0: 2.5369e+00,  elapsed time  87
INFO   step:    79,    loss: 2.0110e+02,   Y0: 2.5362e+00,  elapsed time  88
INFO   step:    80,    loss: 2.0108e+02,   Y0: 2.5355e+00,  elapsed time  88
INFO   step:    81,    loss: 2.0105e+02,   Y0: 2.5344e+00,  elapsed time  89
INFO   step:    82,    loss: 2.0103e+02,   Y0: 2.5336e+00,  elapsed time  90
INFO   step:    83,    loss: 2.0101e+02,   Y0: 2.5329e+00,  elapsed time  91
INFO   step:    84,    loss: 2.0098e+02,   Y0: 2.5321e+00,  elapsed time  92
INFO   step:    85,    loss: 2.0096e+02,   Y0: 2.5313e+00,  elapsed time  93
INFO   step:    86,    loss: 2.0093e+02,   Y0: 2.5299e+00,  elapsed time  94
INFO   step:    87,    loss: 2.0090e+02,   Y0: 2.5288e+00,  elapsed time  95
INFO   step:    88,    loss: 2.0088e+02,   Y0: 2.5279e+00,  elapsed time  96
INFO   step:    89,    loss: 2.0085e+02,   Y0: 2.5275e+00,  elapsed time  97
INFO   step:    90,    loss: 2.0083e+02,   Y0: 2.5272e+00,  elapsed time  98
INFO   step:    91,    loss: 2.0080e+02,   Y0: 2.5275e+00,  elapsed time  99
INFO   step:    92,    loss: 2.0078e+02,   Y0: 2.5287e+00,  elapsed time 100
INFO   step:    93,    loss: 2.0075e+02,   Y0: 2.5301e+00,  elapsed time 101
INFO   step:    94,    loss: 2.0073e+02,   Y0: 2.5316e+00,  elapsed time 102
INFO   step:    95,    loss: 2.0070e+02,   Y0: 2.5321e+00,  elapsed time 103
INFO   step:    96,    loss: 2.0068e+02,   Y0: 2.5326e+00,  elapsed time 104
INFO   step:    97,    loss: 2.0065e+02,   Y0: 2.5330e+00,  elapsed time 105
INFO   step:    98,    loss: 2.0062e+02,   Y0: 2.5339e+00,  elapsed time 106
INFO   step:    99,    loss: 2.0060e+02,   Y0: 2.5343e+00,  elapsed time 107
INFO   step:   100,    loss: 2.0057e+02,   Y0: 2.5336e+00,  elapsed time 108
INFO   step:   101,    loss: 2.0055e+02,   Y0: 2.5328e+00,  elapsed time 109
INFO   step:   102,    loss: 2.0053e+02,   Y0: 2.5322e+00,  elapsed time 109
INFO   step:   103,    loss: 2.0050e+02,   Y0: 2.5316e+00,  elapsed time 110
INFO   step:   104,    loss: 2.0048e+02,   Y0: 2.5314e+00,  elapsed time 111
INFO   step:   105,    loss: 2.0046e+02,   Y0: 2.5308e+00,  elapsed time 112
INFO   step:   106,    loss: 2.0043e+02,   Y0: 2.5302e+00,  elapsed time 113
INFO   step:   107,    loss: 2.0041e+02,   Y0: 2.5284e+00,  elapsed time 114
INFO   step:   108,    loss: 2.0038e+02,   Y0: 2.5272e+00,  elapsed time 115
INFO   step:   109,    loss: 2.0036e+02,   Y0: 2.5266e+00,  elapsed time 116
INFO   step:   110,    loss: 2.0034e+02,   Y0: 2.5261e+00,  elapsed time 117
INFO   step:   111,    loss: 2.0031e+02,   Y0: 2.5250e+00,  elapsed time 118
INFO   step:   112,    loss: 2.0029e+02,   Y0: 2.5248e+00,  elapsed time 119
INFO   step:   113,    loss: 2.0026e+02,   Y0: 2.5249e+00,  elapsed time 120
INFO   step:   114,    loss: 2.0024e+02,   Y0: 2.5251e+00,  elapsed time 121
INFO   step:   115,    loss: 2.0021e+02,   Y0: 2.5258e+00,  elapsed time 122
INFO   step:   116,    loss: 2.0019e+02,   Y0: 2.5269e+00,  elapsed time 123
INFO   step:   117,    loss: 2.0017e+02,   Y0: 2.5279e+00,  elapsed time 124
INFO   step:   118,    loss: 2.0014e+02,   Y0: 2.5289e+00,  elapsed time 125
INFO   step:   119,    loss: 2.0012e+02,   Y0: 2.5298e+00,  elapsed time 126
INFO   step:   120,    loss: 2.0009e+02,   Y0: 2.5304e+00,  elapsed time 127
INFO   step:   121,    loss: 2.0007e+02,   Y0: 2.5312e+00,  elapsed time 128
INFO   step:   122,    loss: 2.0005e+02,   Y0: 2.5322e+00,  elapsed time 129
INFO   step:   123,    loss: 2.0002e+02,   Y0: 2.5338e+00,  elapsed time 129
INFO   step:   124,    loss: 2.0000e+02,   Y0: 2.5351e+00,  elapsed time 130
INFO   step:   125,    loss: 1.9997e+02,   Y0: 2.5369e+00,  elapsed time 131
INFO   step:   126,    loss: 1.9995e+02,   Y0: 2.5383e+00,  elapsed time 132
INFO   step:   127,    loss: 1.9992e+02,   Y0: 2.5395e+00,  elapsed time 133
INFO   step:   128,    loss: 1.9990e+02,   Y0: 2.5399e+00,  elapsed time 134
INFO   step:   129,    loss: 1.9988e+02,   Y0: 2.5401e+00,  elapsed time 135
INFO   step:   130,    loss: 1.9985e+02,   Y0: 2.5402e+00,  elapsed time 136
INFO   step:   131,    loss: 1.9983e+02,   Y0: 2.5407e+00,  elapsed time 137
INFO   step:   132,    loss: 1.9981e+02,   Y0: 2.5407e+00,  elapsed time 138
INFO   step:   133,    loss: 1.9979e+02,   Y0: 2.5414e+00,  elapsed time 139
INFO   step:   134,    loss: 1.9977e+02,   Y0: 2.5417e+00,  elapsed time 140
INFO   step:   135,    loss: 1.9975e+02,   Y0: 2.5427e+00,  elapsed time 141
INFO   step:   136,    loss: 1.9972e+02,   Y0: 2.5430e+00,  elapsed time 142
INFO   step:   137,    loss: 1.9970e+02,   Y0: 2.5433e+00,  elapsed time 143
INFO   step:   138,    loss: 1.9968e+02,   Y0: 2.5433e+00,  elapsed time 144
INFO   step:   139,    loss: 1.9966e+02,   Y0: 2.5431e+00,  elapsed time 145
INFO   step:   140,    loss: 1.9963e+02,   Y0: 2.5427e+00,  elapsed time 146
INFO   step:   141,    loss: 1.9961e+02,   Y0: 2.5422e+00,  elapsed time 147
INFO   step:   142,    loss: 1.9959e+02,   Y0: 2.5417e+00,  elapsed time 148
INFO   step:   143,    loss: 1.9957e+02,   Y0: 2.5408e+00,  elapsed time 149
INFO   step:   144,    loss: 1.9955e+02,   Y0: 2.5399e+00,  elapsed time 150
INFO   step:   145,    loss: 1.9953e+02,   Y0: 2.5384e+00,  elapsed time 150
INFO   step:   146,    loss: 1.9951e+02,   Y0: 2.5378e+00,  elapsed time 151
INFO   step:   147,    loss: 1.9949e+02,   Y0: 2.5381e+00,  elapsed time 152
INFO   step:   148,    loss: 1.9947e+02,   Y0: 2.5384e+00,  elapsed time 153
INFO   step:   149,    loss: 1.9945e+02,   Y0: 2.5388e+00,  elapsed time 154
Delta:  120 ,  120.05
Other1:  -30.05 ,  -30
Other2:  -30.05 ,  -30
all_one_vec:  Tensor("ones:0", shape=(?, 1), dtype=float64)
y:  Tensor("mul:0", shape=(?, 1), dtype=float64)
z output:  [<tf.Tensor 'MatMul:0' shape=(?, 3) dtype=float64>, <tf.Tensor 'MatMul_1:0' shape=(?, 3) dtype=float64>, <tf.Tensor 'MatMul_2:0' shape=(?, 3) dtype=float64>, <tf.Tensor 'MatMul_3:0' shape=(?, 3) dtype=float64>, <tf.Tensor 'MatMul_4:0' shape=(?, 3) dtype=float64>, <tf.Tensor 'MatMul_5:0' shape=(?, 3) dtype=float64>, <tf.Tensor 'MatMul_6:0' shape=(?, 3) dtype=float64>, <tf.Tensor 'MatMul_7:0' shape=(?, 3) dtype=float64>, <tf.Tensor 'MatMul_8:0' shape=(?, 3) dtype=float64>, <tf.Tensor 'MatMul_9:0' shape=(?, 3) dtype=float64>]
num_iterations:  150
total time intervals:  10
# of dimensions:  3
Loss out:  233.15360643839344
Output_Z_Vals:  [[[ 1.19279309e+02 -2.92921948e+01 -2.92556094e+01]
  [ 1.19279309e+02 -2.92921948e+01 -2.92556094e+01]
  [ 1.19279309e+02 -2.92921948e+01 -2.92556094e+01]
  ...
  [ 1.19279309e+02 -2.92921948e+01 -2.92556094e+01]
  [ 1.19279309e+02 -2.92921948e+01 -2.92556094e+01]
  [ 1.19279309e+02 -2.92921948e+01 -2.92556094e+01]]

 [[-6.89842083e-02 -1.01560897e-01  9.63252216e-03]
  [-7.04779654e-02 -1.14653620e-01 -1.72427800e-03]
  [-6.17811410e-02 -3.88655218e-02  6.40423566e-02]
  ...
  [-7.04779654e-02 -1.14653620e-01 -1.72427800e-03]
  [-7.04779654e-02 -1.14653620e-01 -1.72427800e-03]
  [-7.04779654e-02 -1.14653620e-01 -1.72427800e-03]]

 [[ 2.57796901e-01  7.04430275e-02 -1.79673634e-01]
  [ 1.47975956e-01  2.67140338e-02  2.70456891e-02]
  [ 5.65791809e-01  7.47617844e-02 -2.78362308e-01]
  ...
  [-6.81939967e-02 -4.70895768e-02  6.10195362e-02]
  [ 4.56936337e-01  7.00714767e-02 -2.67281797e-01]
  [ 1.88930044e-01  3.76943607e-02 -3.93928429e-02]]

 ...

 [[-1.89178669e-01  2.62976145e-02 -1.29198322e-01]
  [ 6.07800788e-02 -1.06242501e-01 -6.58994422e-03]
  [-1.66309240e-01  3.86328881e-03 -1.02322125e-01]
  ...
  [-6.28827611e-02 -9.75954405e-02  1.92248671e-02]
  [-2.06301435e-01  4.04816424e-02 -1.41561646e-01]
  [ 6.29177357e-02 -8.32515604e-02  6.30914280e-03]]

 [[ 4.07126577e-02  7.80943004e-02 -1.39875553e-01]
  [-1.53018581e-02 -7.00939028e-02 -1.58895860e-02]
  [-8.45872983e-02 -6.42791544e-03 -1.16892361e-01]
  ...
  [ 4.65597967e-02  9.53304919e-02 -1.56197137e-01]
  [-9.51572903e-02 -2.00755120e-03 -1.26942120e-01]
  [-1.30605028e-01 -1.79076053e-02 -1.29630178e-01]]

 [[ 7.38818455e-02  4.57997300e-01 -3.38226052e-01]
  [-4.17717382e-03 -2.09646501e-02  7.94993400e-03]
  [ 1.20618714e-02  7.56124286e-02  1.14275648e-02]
  ...
  [ 7.02167976e-02  4.26908848e-01 -2.73456113e-01]
  [ 1.00959276e-02  6.42715636e-02  1.11279496e-02]
  [ 5.10046760e-02  2.51405391e-01 -2.05557100e-02]]]
Z_Vals dimensionality:  (10, 200, 3)
X_test:  [[[ 1.00000000e+02  9.95638033e+01  1.00424163e+02 ...  1.08843891e+02
    1.10467678e+02  1.05428071e+02]
  [-1.00000000e+00 -9.66925188e-01 -8.38635920e-01 ...  1.85190873e-01
   -2.15806377e-01 -9.30818574e-02]
  [-1.00000000e+00 -9.95249305e-01 -9.68852717e-01 ... -1.03250630e+00
   -1.00236131e+00 -9.90520950e-01]]

 [[ 1.00000000e+02  1.00255718e+02  1.01751103e+02 ...  9.82265880e+01
    9.86379437e+01  1.03787710e+02]
  [-1.00000000e+00 -1.18435301e+00 -1.03270601e+00 ... -5.04397697e-01
   -5.34808513e-01 -6.47452336e-01]
  [-1.00000000e+00 -9.45428269e-01 -9.41325536e-01 ... -1.08267163e+00
   -1.02039849e+00 -1.01403668e+00]]

 [[ 1.00000000e+02  1.01360629e+02  9.85330303e+01 ...  1.02213900e+02
    1.00439169e+02  1.00916804e+02]
  [-1.00000000e+00 -3.63354662e-01 -4.21099060e-01 ... -8.82299095e-01
   -8.42788044e-01 -7.11230182e-01]
  [-1.00000000e+00 -1.00936078e+00 -9.85813912e-01 ... -8.62223451e-01
   -8.85826924e-01 -8.78745290e-01]]

 ...

 [[ 1.00000000e+02  1.03507939e+02  1.05453538e+02 ...  1.08676651e+02
    1.09509442e+02  1.06238453e+02]
  [-1.00000000e+00 -9.48576615e-01 -8.18485580e-01 ... -1.09980351e+00
   -9.48588306e-01 -3.30246800e-01]
  [-1.00000000e+00 -1.00148064e+00 -1.02119667e+00 ... -1.08544116e+00
   -1.03917228e+00 -1.07450878e+00]]

 [[ 1.00000000e+02  9.94647731e+01  9.95990414e+01 ...  1.02141886e+02
    1.00064077e+02  1.05112896e+02]
  [-1.00000000e+00 -1.08990855e+00 -1.04328068e+00 ... -6.29748950e-01
   -5.65165989e-01 -8.87426003e-01]
  [-1.00000000e+00 -9.56078608e-01 -9.21373930e-01 ... -9.23276222e-01
   -8.74078511e-01 -9.02970813e-01]]

 [[ 1.00000000e+02  1.01205216e+02  1.01422881e+02 ...  1.01250745e+02
    1.01922978e+02  9.96841661e+01]
  [-1.00000000e+00 -1.07524059e+00 -1.06413139e+00 ... -5.38621343e-01
   -5.29919912e-01 -9.11474119e-01]
  [-1.00000000e+00 -1.01695684e+00 -9.84613820e-01 ... -8.39314553e-01
   -8.02625015e-01 -6.90414178e-01]]]
X_test type:  <class 'numpy.ndarray'>
first element:  100.0
first element type:  <class 'float'>
---------------------------- TESTING DELTA HEDGING ----------------------------

Test sample:  0
output_Z_Vals[:, i, :]:  [[ 1.19279309e+02 -2.92921948e+01 -2.92556094e+01]
 [-6.89842083e-02 -1.01560897e-01  9.63252216e-03]
 [ 2.57796901e-01  7.04430275e-02 -1.79673634e-01]
 [-3.08416984e-02  8.29441958e-02 -2.07151022e-01]
 [-1.75678318e-01  1.82586180e-01  2.61780088e-01]
 [ 4.35179698e-02 -5.57532239e-02  3.14182108e-02]
 [-4.86022795e-03 -4.96129345e-02  1.71525645e-01]
 [-1.89178669e-01  2.62976145e-02 -1.29198322e-01]
 [ 4.07126577e-02  7.80943004e-02 -1.39875553e-01]
 [ 7.38818455e-02  4.57997300e-01 -3.38226052e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.27930914 -29.29219478 -29.25560936]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  8.31647217  -9.26300532 -83.45811031]
init_Out:  [2.54002979]
Stock Position:  8.316472170547405
Bond position:  [-829.10718727]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-1.50224499]
curr_Stock_Price:  99.56380332324343
curr_Factors:  [99.56380332 -0.96692519 -0.9952493 ]
mat_Sqrt:  [[13.9939373   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00497646 -0.03211638  0.0274789 ]
Stock Position:  -0.004976459989705799
Bond Position:  [-1.0067697]


portfolio before change:  [-1.50703004]
curr_Stock_Price:  100.42416257507254
curr_Factors:  [100.42416258  -0.83863592  -0.96885272]
mat_Sqrt:  [[16.47615533  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01353107  0.02227604 -0.51255887]
Stock Position:  0.013531069657129404
Bond Position:  [-2.86587638]


portfolio before change:  [-1.50720702]
curr_Stock_Price:  100.51700957926545
curr_Factors:  [100.51700958  -0.68816755  -0.94079872]
mat_Sqrt:  [[19.71462398  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00360061  0.02622926 -0.59094421]
Stock Position:  -0.0036006070340949266
Bond Position:  [-1.14528477]


portfolio before change:  [-1.49972282]
curr_Stock_Price:  98.27933470220091
curr_Factors:  [98.2793347  -0.34104351 -0.93547539]
mat_Sqrt:  [[27.42060886  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00428613  0.05773882  0.74678573]
Stock Position:  -0.004286131169036784
Bond Position:  [-1.0784847]


portfolio before change:  [-1.50947269]
curr_Stock_Price:  100.42824137048217
curr_Factors:  [100.42824137  -0.56126268  -0.94278336]
mat_Sqrt:  [[22.31808669  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00217275 -0.01763072  0.08962741]
Stock Position:  0.002172750911832601
Bond Position:  [-1.72767824]


portfolio before change:  [-1.51485425]
curr_Stock_Price:  98.34907847001848
curr_Factors:  [ 9.83490785e+01 -9.38689558e-02 -1.02595379e+00]
mat_Sqrt:  [[32.09500547  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00089956 -0.01568899  0.48931492]
Stock Position:  0.0008995573253964124
Bond Position:  [-1.60332488]


portfolio before change:  [-1.51208518]
curr_Stock_Price:  102.31873375939668
curr_Factors:  [102.31873376   0.19328218  -1.03271165]
mat_Sqrt:  [[44.19728306  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00486166  0.00831604 -0.36856685]
Stock Position:  -0.00486166004164062
Bond Position:  [-1.01464628]


portfolio before change:  [-1.54431572]
curr_Stock_Price:  108.84389131352475
curr_Factors:  [108.84389131   0.18519087  -1.0325063 ]
mat_Sqrt:  [[46.64656269  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 3.03925204e-04  2.46955862e-02 -3.99026019e-01]
Stock Position:  0.00030392520434515346
Bond Position:  [-1.57739613]


portfolio before change:  [-1.54461111]
curr_Stock_Price:  110.4676781697733
curr_Factors:  [110.46767817  -0.21580638  -1.00236131]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-1.54461111]
Stock Price:  105.4280714873179
PL:  [-6.9726826]
Settle:  Tensor("sub:0", shape=(), dtype=float64)
PL:  Tensor("sub_1:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  1
output_Z_Vals[:, i, :]:  [[ 1.19279309e+02 -2.92921948e+01 -2.92556094e+01]
 [-7.04779654e-02 -1.14653620e-01 -1.72427800e-03]
 [ 1.47975956e-01  2.67140338e-02  2.70456891e-02]
 [-4.54699088e-02  1.13671762e-01 -8.32782633e-02]
 [-9.20228541e-02  8.11590984e-02  1.38564405e-01]
 [ 4.08766228e-02 -6.61794576e-02  3.40389464e-02]
 [ 9.37883778e-02 -2.43174223e-02  1.17208663e-01]
 [ 6.07800788e-02 -1.06242501e-01 -6.58994422e-03]
 [-1.53018581e-02 -7.00939028e-02 -1.58895860e-02]
 [-4.17717382e-03 -2.09646501e-02  7.94993400e-03]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.27930914 -29.29219478 -29.25560936]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  8.31647217  -9.26300532 -83.45811031]
init_Out:  [2.54002979]
Stock Position:  8.316472170547405
Bond position:  [-829.10718727]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [4.25204025]
curr_Stock_Price:  100.25571752940688
curr_Factors:  [100.25571753  -1.18435301  -0.94542827]
mat_Sqrt:  [[11.91672427  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00619216 -0.03625666 -0.00491889]
Stock Position:  -0.00619216105277591
Bond Position:  [4.8728398]


portfolio before change:  [4.24521762]
curr_Stock_Price:  101.75110267614114
curr_Factors:  [101.75110268  -1.03270601  -0.94132554]
mat_Sqrt:  [[14.13279691  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01090983 0.00844772 0.07715382]
Stock Position:  0.010909828268347698
Bond Position:  [3.13513056]


portfolio before change:  [4.25415979]
curr_Stock_Price:  102.42702674306963
curr_Factors:  [102.42702674  -0.44852816  -0.98551661]
mat_Sqrt:  [[24.41275736  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00243864  0.03594617 -0.2375697 ]
Stock Position:  -0.002438643857339733
Bond Position:  [4.50394283]


portfolio before change:  [4.26214581]
curr_Stock_Price:  100.07592951625477
curr_Factors:  [ 1.00075930e+02  4.17784395e-02 -1.03322669e+00]
mat_Sqrt:  [[37.13206711  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0016601   0.02566476  0.39528568]
Stock Position:  -0.0016601013409352065
Bond Position:  [4.428282]


portfolio before change:  [4.2637649]
curr_Stock_Price:  100.43470862033998
curr_Factors:  [ 1.00434709e+02 -8.24751746e-02 -1.11632286e+00]
mat_Sqrt:  [[30.28673459  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00152265 -0.02092778  0.09710364]
Stock Position:  0.0015226483792326949
Bond Position:  [4.11083815]


portfolio before change:  [4.26378346]
curr_Stock_Price:  99.09666213411718
curr_Factors:  [99.09666213 -0.18838949 -1.07933194]
mat_Sqrt:  [[27.89295994  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00419768 -0.00768984  0.33436369]
Stock Position:  0.0041976765100594894
Bond Position:  [3.84780773]


portfolio before change:  [4.25390885]
curr_Stock_Price:  96.28582383113412
curr_Factors:  [96.28582383 -0.3278315  -1.06835058]
mat_Sqrt:  [[23.83461706  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00237855 -0.03359683 -0.01879928]
Stock Position:  0.0023785463958355237
Bond Position:  [4.02488855]


portfolio before change:  [4.260538]
curr_Stock_Price:  98.22658802348879
curr_Factors:  [98.22658802 -0.5043977  -1.08267163]
mat_Sqrt:  [[20.08970717  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00101321 -0.02216564 -0.04532857]
Stock Position:  -0.0010132115362861585
Bond Position:  [4.36006231]


portfolio before change:  [4.26230178]
curr_Stock_Price:  98.63794370303324
curr_Factors:  [98.6379437  -0.53480851 -1.02039849]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [4.26230178]
Stock Price:  103.78771032942359
PL:  [0.47459145]
Settle:  Tensor("sub_2:0", shape=(), dtype=float64)
PL:  Tensor("sub_3:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  2
output_Z_Vals[:, i, :]:  [[ 1.19279309e+02 -2.92921948e+01 -2.92556094e+01]
 [-6.17811410e-02 -3.88655218e-02  6.40423566e-02]
 [ 5.65791809e-01  7.47617844e-02 -2.78362308e-01]
 [-4.35840507e-02  1.18757572e-01 -5.20463183e-02]
 [ 4.20185233e-02 -6.01642127e-02 -5.19636787e-02]
 [ 8.44506523e-02  1.34371663e-01 -9.21375908e-03]
 [ 9.40390572e-02 -4.96051456e-03 -1.02437618e-01]
 [-1.66309240e-01  3.86328881e-03 -1.02322125e-01]
 [-8.45872983e-02 -6.42791544e-03 -1.16892361e-01]
 [ 1.20618714e-02  7.56124286e-02  1.14275648e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.27930914 -29.29219478 -29.25560936]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  8.31647217  -9.26300532 -83.45811031]
init_Out:  [2.54002979]
Stock Position:  8.316472170547405
Bond position:  [-829.10718727]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [13.44100654]
curr_Stock_Price:  101.36062909546546
curr_Factors:  [101.3606291   -0.36335466  -1.00936078]
mat_Sqrt:  [[25.68659603  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00193533 -0.01229036  0.18269502]
Stock Position:  -0.001935330517149053
Bond Position:  [13.63717286]


portfolio before change:  [13.45329917]
curr_Stock_Price:  98.5330302850206
curr_Factors:  [98.53303029 -0.42109906 -0.98581391]
mat_Sqrt:  [[24.13055434  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0211724   0.02364175 -0.79409018]
Stock Position:  0.021172397237312766
Bond Position:  [11.36711872]


portfolio before change:  [13.54908833]
curr_Stock_Price:  102.7887682201684
curr_Factors:  [102.78876822  -0.4479251   -0.97906305]
mat_Sqrt:  [[24.67246729  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00207282  0.03755444 -0.14847366]
Stock Position:  -0.0020728228345734422
Bond Position:  [13.76215123]


portfolio before change:  [13.557578]
curr_Stock_Price:  102.01355678976974
curr_Factors:  [102.01355679  -0.88966791  -0.95981099]
mat_Sqrt:  [[16.0486833   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00186047 -0.01902559 -0.14823791]
Stock Position:  0.0018604671767223325
Bond Position:  [13.36778513]


portfolio before change:  [13.56704227]
curr_Stock_Price:  103.50711204220899
curr_Factors:  [103.50711204  -0.30757073  -0.95867498]
mat_Sqrt:  [[29.17740525  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00294884  0.04249205 -0.02628429]
Stock Position:  0.002948835316745625
Bond Position:  [13.26181685]


portfolio before change:  [13.57348586]
curr_Stock_Price:  103.4430244532345
curr_Factors:  [103.44302445  -0.75596668  -0.93029215]
mat_Sqrt:  [[19.15880008  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00381031 -0.00156865 -0.29222601]
Stock Position:  0.0038103109630385273
Bond Position:  [13.17933577]


portfolio before change:  [13.58580934]
curr_Stock_Price:  104.94740757480938
curr_Factors:  [104.94740757  -1.11448986  -0.88673725]
mat_Sqrt:  [[14.18566911  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01318908  0.00122168 -0.29189654]
Stock Position:  -0.013189078683403401
Bond Position:  [14.96996896]


portfolio before change:  [13.62934865]
curr_Stock_Price:  102.21389981102755
curr_Factors:  [102.21389981  -0.8822991   -0.86222345]
mat_Sqrt:  [[17.85967053  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00608151 -0.00203269 -0.33346137]
Stock Position:  -0.006081513058548077
Bond Position:  [14.25096381]


portfolio before change:  [13.64726895]
curr_Stock_Price:  100.43916945152297
curr_Factors:  [100.43916945  -0.84278804  -0.88582692]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [13.64726895]
Stock Price:  100.91680377700966
PL:  [12.73046518]
Settle:  Tensor("sub_4:0", shape=(), dtype=float64)
PL:  Tensor("sub_5:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  3
output_Z_Vals[:, i, :]:  [[ 1.19279309e+02 -2.92921948e+01 -2.92556094e+01]
 [-5.08939697e-02  5.69993376e-02  1.47169763e-01]
 [ 9.37774636e-01  8.18062207e-02 -3.83800562e-01]
 [ 3.11226590e-01 -1.44559475e-01 -1.48555135e-01]
 [-2.35777496e-01  2.65363114e-01  3.53650883e-01]
 [ 4.18903888e-02 -8.18975831e-02  3.25969411e-02]
 [ 4.87068970e-02 -3.89082883e-02  1.80326468e-01]
 [ 7.87577821e-02 -1.06994209e-01 -2.73003795e-02]
 [ 1.18680717e-01 -9.14119449e-02  7.95809783e-02]
 [-1.03773962e-02 -7.65788680e-02 -4.91170151e-03]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.27930914 -29.29219478 -29.25560936]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  8.31647217  -9.26300532 -83.45811031]
init_Out:  [2.54002979]
Stock Position:  8.316472170547405
Bond position:  [-829.10718727]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-4.21665381]
curr_Stock_Price:  99.2374138676266
curr_Factors:  [99.23741387 -0.66604511 -0.9428186 ]
mat_Sqrt:  [[19.8588826   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00097595  0.01802477  0.41983437]
Stock Position:  -0.0009759537506727528
Bond Position:  [-4.11980268]


portfolio before change:  [-4.21638171]
curr_Stock_Price:  96.84742151671031
curr_Factors:  [96.84742152 -0.49556382 -0.93442294]
mat_Sqrt:  [[23.17675885  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.03717275  0.0258694  -1.09487617]
Stock Position:  0.037172751719423074
Bond Position:  [-7.81646686]


portfolio before change:  [-4.21433452]
curr_Stock_Price:  97.00765707092945
curr_Factors:  [97.00765707 -0.56192285 -0.96373351]
mat_Sqrt:  [[21.09705704  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01313787 -0.04571372 -0.42378645]
Stock Position:  0.013137869894793368
Bond Position:  [-5.4888085]


portfolio before change:  [-4.22206172]
curr_Stock_Price:  96.62843960444499
curr_Factors:  [96.6284396  -0.71298646 -1.02342497]
mat_Sqrt:  [[17.02123471  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00920833  0.08391518  1.00886753]
Stock Position:  -0.009208331130638433
Bond Position:  [-3.33227505]


portfolio before change:  [-4.22515571]
curr_Stock_Price:  96.78345509358206
curr_Factors:  [96.78345509 -0.5279507  -1.04298967]
mat_Sqrt:  [[20.11640576  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00230805 -0.02589829  0.09299   ]
Stock Position:  0.002308047748325424
Bond Position:  [-4.44853654]


portfolio before change:  [-4.23263973]
curr_Stock_Price:  94.50481825856211
curr_Factors:  [94.50481826 -0.75359272 -1.0720901 ]
mat_Sqrt:  [[15.2254443   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00555066 -0.01230388  0.51442122]
Stock Position:  0.005550660701900376
Bond Position:  [-4.75720392]


portfolio before change:  [-4.22851119]
curr_Stock_Price:  95.67724485467457
curr_Factors:  [95.67724485 -0.85878269 -1.12982   ]
mat_Sqrt:  [[13.09692947  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00537703 -0.03383454 -0.07788038]
Stock Position:  0.005377026499292671
Bond Position:  [-4.74297027]


portfolio before change:  [-4.23608587]
curr_Stock_Price:  94.70968329057628
curr_Factors:  [94.70968329 -0.92693681 -1.14355475]
mat_Sqrt:  [[11.94514221  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01109781 -0.028907    0.22702238]
Stock Position:  0.011097805940729602
Bond Position:  [-5.28715556]


portfolio before change:  [-4.2386616]
curr_Stock_Price:  94.71585667475244
curr_Factors:  [94.71585667 -0.56547144 -1.10540075]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-4.2386616]
Stock Price:  99.61789047250575
PL:  [-4.2386616]
Settle:  Tensor("sub_6:0", shape=(), dtype=float64)
PL:  Tensor("sub_7:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  4
output_Z_Vals[:, i, :]:  [[ 1.19279309e+02 -2.92921948e+01 -2.92556094e+01]
 [-7.04779654e-02 -1.14653620e-01 -1.72427800e-03]
 [ 9.31008565e-01  7.96219709e-02 -3.97349035e-01]
 [ 4.09369655e-01 -3.04425381e-01 -5.05991576e-02]
 [-2.61616533e-01  3.01234100e-01  3.93244560e-01]
 [ 4.94399171e-02 -6.10197727e-02  2.48136214e-02]
 [-1.99257730e-01 -1.08672674e-01  3.09938021e-01]
 [ 1.31383973e-01 -9.17212446e-02 -5.76856045e-02]
 [ 1.60260461e-01 -9.12666519e-02  1.10920306e-01]
 [-7.86005598e-03 -5.01584669e-02 -7.09032998e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.27930914 -29.29219478 -29.25560936]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  8.31647217  -9.26300532 -83.45811031]
init_Out:  [2.54002979]
Stock Position:  8.316472170547405
Bond position:  [-829.10718727]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-0.22347719]
curr_Stock_Price:  99.7175665735443
curr_Factors:  [99.71756657 -1.27631789 -1.03961266]
mat_Sqrt:  [[ 9.83956308  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00749934 -0.03625666 -0.00491889]
Stock Position:  -0.007499344767985615
Bond Position:  [0.52433922]


portfolio before change:  [-0.20393033]
curr_Stock_Price:  97.14605789153958
curr_Factors:  [97.14605789 -0.82911901 -1.02734147]
mat_Sqrt:  [[15.17660528  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.05613613  0.02517868 -1.1335262 ]
Stock Position:  0.056136128458819747
Bond Position:  [-5.65733391]


portfolio before change:  [-0.3127904]
curr_Stock_Price:  95.2572440046893
curr_Factors:  [95.257244   -0.67115299 -1.06845603]
mat_Sqrt:  [[16.72612791  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.02338742 -0.09626776 -0.14434531]
Stock Position:  0.023387416268021023
Bond Position:  [-2.54061122]


portfolio before change:  [-0.30055099]
curr_Stock_Price:  95.83490658479418
curr_Factors:  [95.83490658 -0.94487248 -1.13566286]
mat_Sqrt:  [[11.96626742  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01450477  0.09525859  1.12181727]
Stock Position:  -0.014504773027508307
Bond Position:  [1.08951258]


portfolio before change:  [-0.30282433]
curr_Stock_Price:  96.02920336540454
curr_Factors:  [96.02920337 -0.58507351 -1.16997898]
mat_Sqrt:  [[16.60327329  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00318789 -0.01929615  0.07078636]
Stock Position:  0.003187892632605549
Bond Position:  [-0.60895512]


portfolio before change:  [-0.3053581]
curr_Stock_Price:  95.32992682734984
curr_Factors:  [ 9.53299268e+01  1.75491557e-02 -1.17396352e+00]
mat_Sqrt:  [[29.99196241  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00462783 -0.03436532  0.8841669 ]
Stock Position:  -0.0046278336649028745
Bond Position:  [0.13581294]


portfolio before change:  [-0.28548728]
curr_Stock_Price:  91.05084114128489
curr_Factors:  [91.05084114 -0.35333865 -1.14470086]
mat_Sqrt:  [[20.35605741  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0057595  -0.0290048  -0.16456097]
Stock Position:  0.005759500178161296
Bond Position:  [-0.80989462]


portfolio before change:  [-0.26978737]
curr_Stock_Price:  93.8470841230957
curr_Factors:  [93.84708412 -0.48868975 -1.15209447]
mat_Sqrt:  [[18.19019069  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00992543 -0.02886105  0.31642476]
Stock Position:  0.009925430787658972
Bond Position:  [-1.20126011]


portfolio before change:  [-0.28481466]
curr_Stock_Price:  92.39359436775139
curr_Factors:  [92.39359437 -1.15233464 -1.13475863]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-0.28481466]
Stock Price:  92.41239600247282
PL:  [-0.28481466]
Settle:  Tensor("sub_8:0", shape=(), dtype=float64)
PL:  Tensor("sub_9:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  5
output_Z_Vals[:, i, :]:  [[ 1.19279309e+02 -2.92921948e+01 -2.92556094e+01]
 [-5.59944718e-02  5.00767753e-03  1.02520019e-01]
 [-4.75773376e-02 -1.26552653e-02  5.99117721e-02]
 [-5.99582820e-02  1.07779839e-01 -1.74487532e-01]
 [ 3.70729174e-02 -6.39288539e-02 -4.81209193e-02]
 [ 4.59472525e-02 -4.56468019e-02  2.90075460e-02]
 [ 8.69381025e-02 -2.68994985e-02  1.44375517e-01]
 [-2.04101827e-01  3.76134593e-02 -1.36867009e-01]
 [-5.30209413e-02  9.44643143e-03 -1.16063361e-01]
 [ 6.85138301e-02  3.51867358e-01 -1.74685839e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.27930914 -29.29219478 -29.25560936]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  8.31647217  -9.26300532 -83.45811031]
init_Out:  [2.54002979]
Stock Position:  8.316472170547405
Bond position:  [-829.10718727]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [5.50091777]
curr_Stock_Price:  100.40588667487089
curr_Factors:  [100.40588667  -0.41764909  -0.98614042]
mat_Sqrt:  [[24.66613692  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00141645  0.00158357  0.29246108]
Stock Position:  -0.0014164505359403248
Bond Position:  [5.64313774]


portfolio before change:  [5.50080071]
curr_Stock_Price:  102.481026942239
curr_Factors:  [102.48102694  -0.83277713  -0.93135701]
mat_Sqrt:  [[17.55859433  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00203175 -0.00400195  0.17091161]
Stock Position:  -0.0020317489650742713
Bond Position:  [5.70901643]


portfolio before change:  [5.50605324]
curr_Stock_Price:  101.30110549844213
curr_Factors:  [101.3011055   -0.71113636  -0.87770801]
mat_Sqrt:  [[20.68177644  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00448668  0.03408298 -0.49776436]
Stock Position:  -0.0044866811608173015
Bond Position:  [5.960559]


portfolio before change:  [5.50225636]
curr_Stock_Price:  102.81177678918937
curr_Factors:  [102.81177679  -0.83459368  -0.85819881]
mat_Sqrt:  [[18.91787837  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0013532  -0.02021608 -0.13727559]
Stock Position:  0.0013531982544634927
Bond Position:  [5.36313165]


portfolio before change:  [5.50216752]
curr_Stock_Price:  100.76397884674068
curr_Factors:  [100.76397885  -0.40858083  -0.84904518]
mat_Sqrt:  [[28.6500424   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00176927 -0.01443479  0.08275045]
Stock Position:  0.001769274788212725
Bond Position:  [5.32388836]


portfolio before change:  [5.50310675]
curr_Stock_Price:  99.78991460982421
curr_Factors:  [99.78991461 -0.47190412 -0.86704403]
mat_Sqrt:  [[26.15705573  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00442382 -0.00850637  0.41186316]
Stock Position:  0.004423819355891241
Bond Position:  [5.06165419]


portfolio before change:  [5.51623102]
curr_Stock_Price:  102.18441047475194
curr_Factors:  [102.18441047  -0.74939997  -0.87283496]
mat_Sqrt:  [[20.17701722  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01145207  0.01189442 -0.39044348]
Stock Position:  -0.011452065028427938
Bond Position:  [6.68645354]


portfolio before change:  [5.50952846]
curr_Stock_Price:  103.06168711518305
curr_Factors:  [103.06168712  -0.96966796  -0.90203134]
mat_Sqrt:  [[15.85727538  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00482229  0.00298722 -0.33109646]
Stock Position:  -0.004822289328601462
Bond Position:  [6.00652173]


portfolio before change:  [5.50951717]
curr_Stock_Price:  103.68697029256145
curr_Factors:  [103.68697029  -0.85059016  -0.92238904]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [5.50951717]
Stock Price:  103.93423189939716
PL:  [1.57528527]
Settle:  Tensor("sub_10:0", shape=(), dtype=float64)
PL:  Tensor("sub_11:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  6
output_Z_Vals[:, i, :]:  [[ 1.19279309e+02 -2.92921948e+01 -2.92556094e+01]
 [-7.04779654e-02 -1.14653620e-01 -1.72427800e-03]
 [ 3.40026752e-01  6.90811860e-02 -2.24939163e-01]
 [-4.36848727e-02  9.34026029e-02 -1.95852994e-01]
 [-2.91746417e-03  1.57592448e-02  2.15848255e-02]
 [ 1.08434682e-01  1.41843171e-01 -3.29535104e-02]
 [ 6.47427893e-02  5.73780916e-02 -3.79419712e-01]
 [-1.16458453e-01 -5.63624728e-02  3.88217579e-02]
 [-1.25055790e-01 -4.20224446e-02 -1.03275993e-01]
 [ 1.68098424e-02  9.93793751e-02  9.31330186e-03]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.27930914 -29.29219478 -29.25560936]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  8.31647217  -9.26300532 -83.45811031]
init_Out:  [2.54002979]
Stock Position:  8.316472170547405
Bond position:  [-829.10718727]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [4.13444448]
curr_Stock_Price:  100.24157742585625
curr_Factors:  [100.24157743  -1.0983288   -1.02605891]
mat_Sqrt:  [[11.9794819   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00615972 -0.03625666 -0.00491889]
Stock Position:  -0.006159721806750292
Bond Position:  [4.75190471]


portfolio before change:  [4.13500368]
curr_Stock_Price:  100.53661378557108
curr_Factors:  [100.53661379  -1.42940117  -1.00426507]
mat_Sqrt:  [[ 8.81853479  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.03355375  0.02184539 -0.64168882]
Stock Position:  0.03355374941420521
Bond Position:  [0.76162333]


portfolio before change:  [4.13788452]
curr_Stock_Price:  100.61111895054653
curr_Factors:  [100.61111895  -1.47102445  -1.03652144]
mat_Sqrt:  [[ 8.19657918  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00991286  0.0295365  -0.55871408]
Stock Position:  -0.009912861351395122
Bond Position:  [5.13522859]


portfolio before change:  [4.13781449]
curr_Stock_Price:  100.87726587555917
curr_Factors:  [100.87726588  -1.8484331   -1.0065344 ]
mat_Sqrt:  [[ 5.80626262  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00032644 0.00498351 0.0615755 ]
Stock Position:  0.00032644438448146187
Bond Position:  [4.10488368]


portfolio before change:  [4.13952075]
curr_Stock_Price:  99.8152223865884
curr_Factors:  [99.81522239 -2.01847842 -1.03169559]
mat_Sqrt:  [[ 4.72631909  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0222944   0.04485475 -0.09400719]
Stock Position:  0.022294400392933202
Bond Position:  [1.91420022]


portfolio before change:  [4.14335047]
curr_Stock_Price:  99.94406102032819
curr_Factors:  [99.94406102 -1.91197451 -1.07909138]
mat_Sqrt:  [[ 5.02057642  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00223569  0.01814455 -1.08237883]
Stock Position:  -0.0022356873172225283
Bond Position:  [4.36679414]


portfolio before change:  [4.14629917]
curr_Stock_Price:  99.60199315802232
curr_Factors:  [99.60199316 -1.30217235 -1.01907291]
mat_Sqrt:  [[ 9.77606367  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01125087 -0.01782338  0.11074767]
Stock Position:  -0.011250874700693683
Bond Position:  [5.26690871]


portfolio before change:  [4.13991649]
curr_Stock_Price:  100.4034239671278
curr_Factors:  [100.40342397  -0.88669586  -0.97796149]
mat_Sqrt:  [[15.55743971  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00946312 -0.01328866 -0.29461766]
Stock Position:  -0.009463120640067312
Bond Position:  [5.0900462]


portfolio before change:  [4.13664549]
curr_Stock_Price:  101.0180896721442
curr_Factors:  [101.01808967  -1.38646682  -0.97957064]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [4.13664549]
Stock Price:  98.73152023794684
PL:  [4.13664549]
Settle:  Tensor("sub_12:0", shape=(), dtype=float64)
PL:  Tensor("sub_13:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  7
output_Z_Vals[:, i, :]:  [[ 1.19279309e+02 -2.92921948e+01 -2.92556094e+01]
 [-7.04779654e-02 -1.14653620e-01 -1.72427800e-03]
 [ 6.35270061e-01  7.21484366e-02 -3.27610892e-01]
 [ 2.38864651e-01 -9.22348046e-02 -1.66009315e-01]
 [-1.82030542e-01  1.91834836e-01  2.71658339e-01]
 [ 4.19256428e-02 -6.18570094e-02  3.29979933e-02]
 [ 7.87245232e-02  7.82590461e-04 -1.01404920e-01]
 [-1.44875604e-01 -2.98585447e-02 -8.62990692e-03]
 [-1.02737189e-01 -3.51435530e-02 -9.93767818e-02]
 [ 4.03139466e-02  2.14235165e-01 -3.26015049e-03]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.27930914 -29.29219478 -29.25560936]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  8.31647217  -9.26300532 -83.45811031]
init_Out:  [2.54002979]
Stock Position:  8.316472170547405
Bond position:  [-829.10718727]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-3.58002527]
curr_Stock_Price:  99.3139641795263
curr_Factors:  [99.31396418 -1.10567809 -0.97832431]
mat_Sqrt:  [[12.35775491  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00597117 -0.03625666 -0.00491889]
Stock Position:  -0.0059711716594631195
Bond Position:  [-2.98700454]


portfolio before change:  [-3.57935705]
curr_Stock_Price:  98.95187475899286
curr_Factors:  [98.95187476 -1.28277613 -0.96220552]
mat_Sqrt:  [[10.48192098  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.05440411  0.02281534 -0.93458268]
Stock Position:  0.05440411477070059
Bond Position:  [-8.9627462]


portfolio before change:  [-3.60311915]
curr_Stock_Price:  98.59749711086859
curr_Factors:  [98.59749711 -0.97261997 -1.01282593]
mat_Sqrt:  [[13.53934609  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01496355 -0.02916721 -0.47357837]
Stock Position:  0.014963547575825591
Bond Position:  [-5.07848748]


portfolio before change:  [-3.6186043]
curr_Stock_Price:  97.73237620115383
curr_Factors:  [97.7323762  -0.7360707  -0.98463693]
mat_Sqrt:  [[17.48818073  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00695472  0.0606635   0.77496563]
Stock Position:  -0.006954717807724069
Bond Position:  [-2.93890321]


portfolio before change:  [-3.64022907]
curr_Stock_Price:  100.63040091121115
curr_Factors:  [100.63040091  -0.70660488  -1.03062914]
mat_Sqrt:  [[17.71161063  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00265725 -0.0195609   0.09413409]
Stock Position:  0.0026572506494162876
Bond Position:  [-3.90762926]


portfolio before change:  [-3.6446033]
curr_Stock_Price:  99.71971136302302
curr_Factors:  [99.71971136 -0.889324   -1.04824566]
mat_Sqrt:  [[14.36498576  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 4.04076537e-03  2.47476833e-04 -2.89280011e-01]
Stock Position:  0.004040765365317606
Bond Position:  [-4.04754725]


portfolio before change:  [-3.6446372]
curr_Stock_Price:  100.21228609580983
curr_Factors:  [100.2122861   -0.91333423  -1.09467432]
mat_Sqrt:  [[13.45407786  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01095639 -0.0094421  -0.02461872]
Stock Position:  -0.01095638972941319
Bond Position:  [-2.54667234]


portfolio before change:  [-3.65397551]
curr_Stock_Price:  100.94835464676484
curr_Factors:  [100.94835465  -1.08334486  -1.15939134]
mat_Sqrt:  [[10.7174456   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01156337 -0.01111337 -0.2834943 ]
Stock Position:  -0.011563370294849653
Bond Position:  [-2.4866723]


portfolio before change:  [-3.66459142]
curr_Stock_Price:  101.7588682100064
curr_Factors:  [101.75886821  -1.24491061  -1.11287193]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-3.66459142]
Stock Price:  100.8464046815802
PL:  [-4.51099611]
Settle:  Tensor("sub_14:0", shape=(), dtype=float64)
PL:  Tensor("sub_15:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  8
output_Z_Vals[:, i, :]:  [[ 1.19279309e+02 -2.92921948e+01 -2.92556094e+01]
 [-5.86047865e-02 -1.05856704e-02  8.85456351e-02]
 [ 5.76353339e-01  7.45385518e-02 -2.84539632e-01]
 [ 3.10236634e-01 -1.40615613e-01 -1.52021596e-01]
 [-1.91141722e-01  2.04654725e-01  2.85677171e-01]
 [ 7.96636214e-02  4.76098929e-02 -4.41962755e-03]
 [ 8.22860917e-02 -1.39389021e-02 -3.51043326e-02]
 [-5.59431999e-02 -9.91929012e-02  1.06000123e-01]
 [-9.06839659e-02 -6.51670137e-02 -6.47306178e-02]
 [-1.49175084e-02 -9.45105683e-02  4.19285436e-05]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.27930914 -29.29219478 -29.25560936]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  8.31647217  -9.26300532 -83.45811031]
init_Out:  [2.54002979]
Stock Position:  8.316472170547405
Bond position:  [-829.10718727]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-5.10648776]
curr_Stock_Price:  99.1304173031479
curr_Factors:  [99.1304173  -0.84132255 -0.95149471]
mat_Sqrt:  [[16.50426891  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00247232 -0.00334748  0.25259605]
Stock Position:  -0.0024723182512715533
Bond Position:  [-4.86140582]


portfolio before change:  [-5.1078648]
curr_Stock_Price:  98.70398511986862
curr_Factors:  [98.70398512 -0.64560198 -0.86313037]
mat_Sqrt:  [[21.83235347  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.02382686  0.02357116 -0.81171237]
Stock Position:  0.0238268635637042
Bond Position:  [-7.45967118]


portfolio before change:  [-5.14638059]
curr_Stock_Price:  97.24407743357457
curr_Factors:  [97.24407743 -0.66138241 -0.89103052]
mat_Sqrt:  [[20.59011594  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01338383 -0.04446656 -0.4336753 ]
Stock Position:  0.013383833130460368
Bond Position:  [-6.44787909]


portfolio before change:  [-5.15167572]
curr_Stock_Price:  97.08938413287261
curr_Factors:  [97.08938413 -1.17959501 -0.94119937]
mat_Sqrt:  [[11.64454304  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01095311  0.06471751  0.81495745]
Stock Position:  -0.010953109232249517
Bond Position:  [-4.08824509]


portfolio before change:  [-5.15254877]
curr_Stock_Price:  96.98242037251502
curr_Factors:  [96.98242037 -1.0677794  -0.95013019]
mat_Sqrt:  [[12.89216991  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0062046   0.01505557 -0.01260797]
Stock Position:  0.006204599485054691
Bond Position:  [-5.75428584]


portfolio before change:  [-5.14936635]
curr_Stock_Price:  97.95916047701301
curr_Factors:  [97.95916048 -1.01344407 -0.91697646]
mat_Sqrt:  [[14.2126176   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00526015 -0.00440787 -0.10014289]
Stock Position:  0.005260153405824055
Bond Position:  [-5.66464656]


portfolio before change:  [-5.14787749]
curr_Stock_Price:  98.78078789821022
curr_Factors:  [98.7807879  -1.51233701 -0.92190287]
mat_Sqrt:  [[ 8.65955425  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0042574  -0.03136755  0.30238884]
Stock Position:  -0.004257397564138796
Bond Position:  [-4.72732841]


portfolio before change:  [-5.15283809]
curr_Stock_Price:  99.3906294806469
curr_Factors:  [99.39062948 -1.74113848 -0.87241484]
mat_Sqrt:  [[ 7.28272069  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01449728 -0.02060762 -0.18465844]
Stock Position:  -0.014497281639349883
Bond Position:  [-3.71194414]


portfolio before change:  [-5.14424289]
curr_Stock_Price:  98.6696918291799
curr_Factors:  [98.66969183 -1.98471566 -0.90272007]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-5.14424289]
Stock Price:  98.37055068174799
PL:  [-5.14424289]
Settle:  Tensor("sub_16:0", shape=(), dtype=float64)
PL:  Tensor("sub_17:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  9
output_Z_Vals[:, i, :]:  [[ 1.19279309e+02 -2.92921948e+01 -2.92556094e+01]
 [-5.53413767e-02  1.80179887e-02  1.13356827e-01]
 [ 3.49587918e-01  6.85380189e-02 -2.33097010e-01]
 [ 1.93272652e-01 -6.63291582e-02 -1.96184174e-01]
 [-2.24541902e-01  2.49342354e-01  3.36292175e-01]
 [ 4.30620279e-02 -9.86983728e-02  2.92542681e-02]
 [-1.90009816e-01 -1.06070791e-01  3.05104119e-01]
 [ 1.33144696e-01 -8.77748282e-02 -5.27566690e-02]
 [-2.00634508e-01 -6.51218658e-02  1.36053218e-01]
 [-3.97164630e-03  7.21811877e-03 -2.37097430e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.27930914 -29.29219478 -29.25560936]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  8.31647217  -9.26300532 -83.45811031]
init_Out:  [2.54002979]
Stock Position:  8.316472170547405
Bond position:  [-829.10718727]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [4.10819961]
curr_Stock_Price:  100.23842165699564
curr_Factors:  [100.23842166  -0.49786314  -1.08772918]
mat_Sqrt:  [[20.53147851  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00154579  0.00569779  0.32337547]
Stock Position:  -0.001545786821170495
Bond Position:  [4.26314684]


portfolio before change:  [4.11102369]
curr_Stock_Price:  99.79076905046352
curr_Factors:  [99.79076905 -0.72513511 -1.11051565]
mat_Sqrt:  [[15.91759228  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01908435  0.02167362 -0.66496089]
Stock Position:  0.019084345721215944
Bond Position:  [2.20658216]


portfolio before change:  [4.08876562]
curr_Stock_Price:  98.56664341119787
curr_Factors:  [98.56664341 -0.33524091 -1.13200824]
mat_Sqrt:  [[22.72541149  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00666717 -0.02097512 -0.55965884]
Stock Position:  0.00666716700664727
Bond Position:  [3.43160535]


portfolio before change:  [4.08525094]
curr_Stock_Price:  97.7820654430651
curr_Factors:  [97.78206544  0.19128561 -1.14339332]
mat_Sqrt:  [[37.73671413  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00396056  0.07884898  0.95934797]
Stock Position:  -0.003960560983601129
Bond Position:  [4.47252278]


portfolio before change:  [4.09593517]
curr_Stock_Price:  95.64918437297432
curr_Factors:  [ 9.56491844e+01  3.90973719e-02 -1.12629832e+00]
mat_Sqrt:  [[32.24897368  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00144145 -0.03121117  0.08345428]
Stock Position:  0.0014414458514618175
Bond Position:  [3.95806205]


portfolio before change:  [4.09018988]
curr_Stock_Price:  90.29010696783263
curr_Factors:  [90.29010697 -0.53521952 -1.06241095]
mat_Sqrt:  [[18.2725041   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00714021 -0.03354253  0.87037713]
Stock Position:  -0.007140205506938556
Bond Position:  [4.73487979]


portfolio before change:  [4.09250353]
curr_Stock_Price:  90.29772268185896
curr_Factors:  [90.29772268 -0.58003183 -1.04485176]
mat_Sqrt:  [[17.78274575  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00675427 -0.02775684 -0.15050009]
Stock Position:  0.006754269061967637
Bond Position:  [3.48260841]


portfolio before change:  [4.084392]
curr_Stock_Price:  88.83890106750145
curr_Factors:  [88.83890107 -0.15770476 -1.06158419]
mat_Sqrt:  [[26.2465796   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00665017 -0.02059334  0.38812196]
Stock Position:  -0.006650169402711348
Bond Position:  [4.67518574]


portfolio before change:  [4.10098082]
curr_Stock_Price:  86.69600178056848
curr_Factors:  [86.69600178 -0.46888806 -1.08106494]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [4.10098082]
Stock Price:  88.52112595910329
PL:  [4.10098082]
Settle:  Tensor("sub_18:0", shape=(), dtype=float64)
PL:  Tensor("sub_19:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  10
output_Z_Vals[:, i, :]:  [[ 1.19279309e+02 -2.92921948e+01 -2.92556094e+01]
 [-7.04779654e-02 -1.14653620e-01 -1.72427800e-03]
 [ 2.82566402e-01  7.02538799e-02 -1.91645730e-01]
 [-4.66728975e-02  9.34825641e-02 -2.07964183e-01]
 [-1.55715132e-02 -1.30836296e-02  2.53550324e-02]
 [ 4.14882789e-02 -6.30586456e-02  3.34316005e-02]
 [ 8.30730515e-02  2.94304845e-03 -1.06847006e-01]
 [-8.31071441e-03 -9.27133060e-02  7.85601784e-02]
 [-1.14463859e-01 -4.46257469e-02 -9.32619379e-02]
 [ 5.31171168e-03  3.67244153e-02  1.09343974e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.27930914 -29.29219478 -29.25560936]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  8.31647217  -9.26300532 -83.45811031]
init_Out:  [2.54002979]
Stock Position:  8.316472170547405
Bond position:  [-829.10718727]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [19.96715478]
curr_Stock_Price:  102.14535464993743
curr_Factors:  [102.14535465  -1.05603969  -1.05723555]
mat_Sqrt:  [[12.34340114  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00597812 -0.03625666 -0.00491889]
Stock Position:  -0.005978115353730111
Bond Position:  [20.57779149]


portfolio before change:  [19.98730883]
curr_Stock_Price:  100.49557369233193
curr_Factors:  [100.49557369  -1.05262105  -0.99040394]
mat_Sqrt:  [[13.02784119  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0188259   0.02221623 -0.54671192]
Stock Position:  0.018825899451026744
Bond Position:  [18.09538926]


portfolio before change:  [19.99876615]
curr_Stock_Price:  100.62344872368597
curr_Factors:  [100.62344872  -1.28677342  -0.99736825]
mat_Sqrt:  [[10.24965093  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00845977  0.02956178 -0.59326393]
Stock Position:  -0.008459770950791869
Bond Position:  [20.85001748]


portfolio before change:  [20.0080793]
curr_Stock_Price:  100.7551857353233
curr_Factors:  [100.75518574  -1.1475062   -1.04963012]
mat_Sqrt:  [[11.19600872  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00095871 -0.00413741  0.07233085]
Stock Position:  -0.0009587127839858097
Bond Position:  [20.10467458]


portfolio before change:  [20.0178417]
curr_Stock_Price:  101.06023188621491
curr_Factors:  [101.06023189  -0.69937005  -1.08433277]
mat_Sqrt:  [[16.97962126  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00274943 -0.01994089  0.09537105]
Stock Position:  0.0027494316747679434
Bond Position:  [19.73998349]


portfolio before change:  [20.0265655]
curr_Stock_Price:  100.64245060010946
curr_Factors:  [100.6424506   -0.74913777  -1.04120829]
mat_Sqrt:  [[16.79746669  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00365168  0.00093067 -0.30480477]
Stock Position:  0.0036516808170972085
Bond Position:  [19.65905139]


portfolio before change:  [20.02673747]
curr_Stock_Price:  97.99709049416398
curr_Factors:  [97.99709049 -0.46088889 -1.00188506]
mat_Sqrt:  [[22.69543584  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00023491 -0.02931852  0.22411032]
Stock Position:  0.00023491364613742043
Bond Position:  [20.00371661]


portfolio before change:  [20.0370692]
curr_Stock_Price:  99.39069255318087
curr_Factors:  [99.39069255 -0.27930998 -1.00355794]
mat_Sqrt:  [[27.55518025  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00488667 -0.0141119  -0.26605035]
Stock Position:  -0.004886671149963554
Bond Position:  [20.52275883]


portfolio before change:  [20.04659566]
curr_Stock_Price:  99.5416117326373
curr_Factors:  [99.54161173 -0.6378754  -0.9906901 ]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [20.04659566]
Stock Price:  97.61439954844008
PL:  [20.04659566]
Settle:  Tensor("sub_20:0", shape=(), dtype=float64)
PL:  Tensor("sub_21:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  11
output_Z_Vals[:, i, :]:  [[ 1.19279309e+02 -2.92921948e+01 -2.92556094e+01]
 [-7.04779654e-02 -1.14653620e-01 -1.72427800e-03]
 [ 1.07825133e-01  1.20052835e-02  3.77712001e-02]
 [-5.66204834e-02  1.08671968e-01 -1.55560422e-01]
 [-7.79086872e-03 -2.96757693e-02  1.14602381e-02]
 [ 4.45898827e-02 -6.72664189e-02  3.03649760e-02]
 [ 7.45319584e-02  1.81874376e-02 -1.78337917e-01]
 [-1.98495616e-01  3.08531531e-02 -1.24798473e-01]
 [-1.17889170e-01 -2.57006752e-02 -1.16354254e-01]
 [ 7.00998444e-02  3.57693801e-01 -1.87734977e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.27930914 -29.29219478 -29.25560936]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  8.31647217  -9.26300532 -83.45811031]
init_Out:  [2.54002979]
Stock Position:  8.316472170547405
Bond position:  [-829.10718727]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [4.5731008]
curr_Stock_Price:  100.29432290722062
curr_Factors:  [100.29432291  -1.41802439  -0.98978645]
mat_Sqrt:  [[ 9.02770566  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00817376 -0.03625666 -0.00491889]
Stock Position:  -0.008173757390605368
Bond Position:  [5.39288227]


portfolio before change:  [4.55836977]
curr_Stock_Price:  102.42653022223467
curr_Factors:  [102.42653022  -1.63645967  -1.04622598]
mat_Sqrt:  [[ 7.00385078  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.0165402  0.0037964  0.10775072]
Stock Position:  0.01654020422164004
Bond Position:  [2.86421405]


portfolio before change:  [4.54867725]
curr_Stock_Price:  101.75392761564576
curr_Factors:  [101.75392762  -1.17031161  -1.08093281]
mat_Sqrt:  [[10.71144717  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00798848  0.03436509 -0.44377058]
Stock Position:  -0.007988483915786807
Bond Position:  [5.36153687]


portfolio before change:  [4.55804658]
curr_Stock_Price:  100.91673696777687
curr_Factors:  [100.91673697  -1.0089332   -1.09559256]
mat_Sqrt:  [[12.30210067  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00050542 -0.0093843   0.03269287]
Stock Position:  -0.0005054244508941766
Bond Position:  [4.60905236]


portfolio before change:  [4.56058034]
curr_Stock_Price:  100.46432648207818
curr_Factors:  [100.46432648  -1.24322208  -1.11005136]
mat_Sqrt:  [[ 9.54988647  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00513632 -0.02127151  0.08662282]
Stock Position:  0.005136322418206911
Bond Position:  [4.04456317]


portfolio before change:  [4.56189036]
curr_Stock_Price:  100.32555758822875
curr_Factors:  [100.32555759  -1.10681271  -1.10957353]
mat_Sqrt:  [[10.93571713  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00352958  0.00575137 -0.50874844]
Stock Position:  0.0035295793370315976
Bond Position:  [4.20778335]


portfolio before change:  [4.56985954]
curr_Stock_Price:  101.98715943555854
curr_Factors:  [101.98715944  -0.54067145  -1.06644992]
mat_Sqrt:  [[20.44473823  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01091593  0.00975662 -0.35601531]
Stock Position:  -0.010915931992200367
Bond Position:  [5.68314443]


portfolio before change:  [4.58352076]
curr_Stock_Price:  100.99604463495628
curr_Factors:  [100.99604463  -0.76802497  -1.10911706]
mat_Sqrt:  [[15.45510431  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00920754 -0.00812727 -0.3319263 ]
Stock Position:  -0.00920753870564029
Bond Position:  [5.51344575]


portfolio before change:  [4.56460151]
curr_Stock_Price:  103.3502743499205
curr_Factors:  [103.35027435  -1.07242056  -1.18010778]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [4.56460151]
Stock Price:  102.44337714246535
PL:  [2.12122437]
Settle:  Tensor("sub_22:0", shape=(), dtype=float64)
PL:  Tensor("sub_23:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  12
output_Z_Vals[:, i, :]:  [[ 1.19279309e+02 -2.92921948e+01 -2.92556094e+01]
 [-7.04779654e-02 -1.14653620e-01 -1.72427800e-03]
 [ 4.77636732e-01  6.83065952e-02 -2.89373687e-01]
 [ 2.33876057e-01 -8.60201890e-02 -1.48139612e-01]
 [-9.83573390e-02  7.82320286e-02  1.44303515e-01]
 [ 4.03424174e-02 -7.86921676e-02  3.45757983e-02]
 [ 8.69873244e-02 -2.70366317e-02  1.46274553e-01]
 [-4.33878158e-02 -1.01709784e-01  1.04087042e-01]
 [-1.22713284e-01 -4.86579264e-02 -9.54232041e-02]
 [-4.94201864e-03 -2.58309511e-02  7.13457344e-03]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.27930914 -29.29219478 -29.25560936]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  8.31647217  -9.26300532 -83.45811031]
init_Out:  [2.54002979]
Stock Position:  8.316472170547405
Bond position:  [-829.10718727]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-1.18324522]
curr_Stock_Price:  99.60216090544269
curr_Factors:  [99.60216091 -1.28165773 -1.01446691]
mat_Sqrt:  [[10.02477185  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00736079 -0.03625666 -0.00491889]
Stock Position:  -0.007360793537038564
Bond Position:  [-0.45009428]


portfolio before change:  [-1.1846988]
curr_Stock_Price:  99.76905578278365
curr_Factors:  [99.76905578 -1.3825331  -1.02981825]
mat_Sqrt:  [[ 8.93974196  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.04701839  0.02160044 -0.82550258]
Stock Position:  0.04701838661692946
Bond Position:  [-5.87567884]


portfolio before change:  [-1.23960598]
curr_Stock_Price:  98.66377315923704
curr_Factors:  [98.66377316 -1.29934804 -1.05265604]
mat_Sqrt:  [[ 9.39064288  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0214486  -0.02720197 -0.42260108]
Stock Position:  0.021448601132057248
Bond Position:  [-3.3558059]


portfolio before change:  [-1.236742]
curr_Stock_Price:  98.87554928633313
curr_Factors:  [98.87554929 -1.31711078 -1.0222324 ]
mat_Sqrt:  [[ 9.53070606  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00701748  0.02473914  0.41165776]
Stock Position:  -0.007017482702427521
Bond Position:  [-0.54288455]


portfolio before change:  [-1.24161756]
curr_Stock_Price:  99.53163156157721
curr_Factors:  [99.53163156 -0.96143131 -1.02278059]
mat_Sqrt:  [[13.68449717  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00331531 -0.02488465  0.09863513]
Stock Position:  0.00331530994978582
Bond Position:  [-1.57159577]


portfolio before change:  [-1.24706868]
curr_Stock_Price:  98.1244857147745
curr_Factors:  [98.12448571 -0.8124109  -0.9904366 ]
mat_Sqrt:  [[16.17374789  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00718123 -0.00854973  0.41728058]
Stock Position:  0.007181230378588545
Bond Position:  [-1.95172322]


portfolio before change:  [-1.244077]
curr_Stock_Price:  98.67700708965371
curr_Factors:  [98.67700709 -0.79079154 -1.02024814]
mat_Sqrt:  [[16.13211932  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00153528 -0.03216346  0.29693136]
Stock Position:  -0.0015352770521815985
Bond Position:  [-1.09258046]


portfolio before change:  [-1.24641141]
curr_Stock_Price:  99.8416032153866
curr_Factors:  [99.84160322 -0.90460788 -1.00339535]
mat_Sqrt:  [[14.81413415  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00968317 -0.01538699 -0.27221584]
Stock Position:  -0.009683171823561874
Bond Position:  [-0.27962801]


portfolio before change:  [-1.24044337]
curr_Stock_Price:  99.21083019585778
curr_Factors:  [99.2108302  -1.02027326 -0.9543748 ]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-1.24044337]
Stock Price:  99.6331786141501
PL:  [-1.24044337]
Settle:  Tensor("sub_24:0", shape=(), dtype=float64)
PL:  Tensor("sub_25:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  13
output_Z_Vals[:, i, :]:  [[ 1.19279309e+02 -2.92921948e+01 -2.92556094e+01]
 [-7.04779654e-02 -1.14653620e-01 -1.72427800e-03]
 [ 2.04818161e-01  3.95753895e-02 -3.90570884e-02]
 [-6.48542018e-02  1.07088289e-01 -1.99484119e-01]
 [-2.74603148e-03 -3.31238610e-02  4.91471712e-03]
 [ 3.89337392e-02 -8.15351039e-02  3.59717038e-02]
 [ 8.40593630e-02 -1.88792719e-02  3.33104840e-02]
 [-1.37768369e-01 -3.79057692e-02  6.76802386e-03]
 [-8.72797002e-02 -6.37218210e-02 -6.36749124e-02]
 [ 3.18141528e-03  2.64855155e-02  1.18155035e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.27930914 -29.29219478 -29.25560936]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  8.31647217  -9.26300532 -83.45811031]
init_Out:  [2.54002979]
Stock Position:  8.316472170547405
Bond position:  [-829.10718727]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [7.55545494]
curr_Stock_Price:  100.65293098908796
curr_Factors:  [100.65293099  -1.13531422  -1.034208  ]
mat_Sqrt:  [[11.4978039   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00641777 -0.03625666 -0.00491889]
Stock Position:  -0.006417771301598226
Bond Position:  [8.20142243]


portfolio before change:  [7.55397295]
curr_Stock_Price:  101.52297125542837
curr_Factors:  [101.52297126  -1.32671905  -1.10792181]
mat_Sqrt:  [[ 8.89637805  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.02224135  0.01251484 -0.111419  ]
Stock Position:  0.022241354538292363
Bond Position:  [5.29596456]


portfolio before change:  [7.540417]
curr_Stock_Price:  100.79439155015855
curr_Factors:  [100.79439155  -1.34284462  -1.16499255]
mat_Sqrt:  [[ 8.20911843  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01252372  0.03386429 -0.56907267]
Stock Position:  -0.012523722274786125
Bond Position:  [8.80273797]


portfolio before change:  [7.54248066]
curr_Stock_Price:  100.98114151523657
curr_Factors:  [100.98114152  -1.12464374  -1.15030252]
mat_Sqrt:  [[10.38110702  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00025027 -0.01047468  0.01402032]
Stock Position:  -0.0002502694040264237
Bond Position:  [7.56775315]


portfolio before change:  [7.54657428]
curr_Stock_Price:  99.7472831246021
curr_Factors:  [99.74728312 -1.02683329 -1.10651786]
mat_Sqrt:  [[11.81404022  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00373887 -0.02578366  0.10261726]
Stock Position:  0.003738873777447555
Bond Position:  [7.17363178]


portfolio before change:  [7.5464578]
curr_Stock_Price:  98.75655747060188
curr_Factors:  [98.75655747 -0.89108148 -1.09631713]
mat_Sqrt:  [[13.53473297  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.006677   -0.00597015  0.09502554]
Stock Position:  0.00667699736525406
Bond Position:  [6.88706052]


portfolio before change:  [7.55832187]
curr_Stock_Price:  100.01755586467765
curr_Factors:  [100.01755586  -1.03209253  -1.11960322]
mat_Sqrt:  [[11.63072127  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01181058 -0.01198686  0.01930729]
Stock Position:  -0.011810580942945735
Bond Position:  [8.73958731]


portfolio before change:  [7.55799565]
curr_Stock_Price:  100.41525937624432
curr_Factors:  [100.41525938  -1.79534624  -1.12714426]
mat_Sqrt:  [[ 5.40229401  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01886654 -0.02015061 -0.1816468 ]
Stock Position:  -0.018866536580462778
Bond Position:  [9.45248381]


portfolio before change:  [7.55874343]
curr_Stock_Price:  100.62619602334082
curr_Factors:  [100.62619602  -2.02374976  -1.08150667]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [7.55874343]
Stock Price:  99.95479332593082
PL:  [7.55874343]
Settle:  Tensor("sub_26:0", shape=(), dtype=float64)
PL:  Tensor("sub_27:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  14
output_Z_Vals[:, i, :]:  [[ 1.19279309e+02 -2.92921948e+01 -2.92556094e+01]
 [-5.25676090e-02  4.23299540e-02  1.34445346e-01]
 [ 2.12420305e-02  1.09190443e-03  5.02728404e-02]
 [-4.79328134e-02  1.38101004e-01  1.52127589e-02]
 [ 3.66991899e-02 -1.29552477e-01 -4.60587020e-02]
 [ 9.18636864e-02  1.70176179e-01 -1.65732321e-02]
 [ 1.04748711e-01 -9.42638201e-03 -7.05545672e-02]
 [-3.17877416e-02 -1.28047069e-01  5.56139976e-02]
 [ 4.60967453e-02  8.45049169e-02 -1.44407176e-01]
 [ 6.81788587e-02  3.88453410e-01 -1.56841223e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.27930914 -29.29219478 -29.25560936]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  8.31647217  -9.26300532 -83.45811031]
init_Out:  [2.54002979]
Stock Position:  8.316472170547405
Bond position:  [-829.10718727]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [0.44965223]
curr_Stock_Price:  99.79850587266087
curr_Factors:  [99.79850587 -0.48685513 -0.99533385]
mat_Sqrt:  [[22.6682265   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00106012  0.01338591  0.38353515]
Stock Position:  -0.0010601232051692094
Bond Position:  [0.55545095]


portfolio before change:  [0.44749191]
curr_Stock_Price:  102.09835063778347
curr_Factors:  [102.09835064  -0.75515657  -1.00707304]
mat_Sqrt:  [[17.52637641  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00179912 0.00034529 0.14341442]
Stock Position:  0.0017991239686965272
Bond Position:  [0.26380432]


portfolio before change:  [0.45114318]
curr_Stock_Price:  104.05448594139924
curr_Factors:  [104.05448594  -0.83263366  -1.01525844]
mat_Sqrt:  [[16.39575667  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00251661  0.04367137  0.04339777]
Stock Position:  -0.002516612696306992
Bond Position:  [0.71300802]


portfolio before change:  [0.45067018]
curr_Stock_Price:  104.38413152220596
curr_Factors:  [104.38413152  -0.45248881  -1.01235442]
mat_Sqrt:  [[24.12465721  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00099286 -0.04096809 -0.13139266]
Stock Position:  0.0009928624469411982
Bond Position:  [0.34703109]


portfolio before change:  [0.45045077]
curr_Stock_Price:  103.98834194051683
curr_Factors:  [103.98834194  -0.57416022  -1.0596905 ]
mat_Sqrt:  [[20.29608638  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00457599  0.05381443 -0.04727882]
Stock Position:  0.004575986612497034
Bond Position:  [-0.02539849]


portfolio before change:  [0.44083397]
curr_Stock_Price:  101.88953793490732
curr_Factors:  [101.88953793  -0.30533815  -1.04840877]
mat_Sqrt:  [[26.31508487  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00342402 -0.00298088 -0.20127254]
Stock Position:  0.003424022115777031
Bond Position:  [0.09196194]


portfolio before change:  [0.46204053]
curr_Stock_Price:  108.06957101724231
curr_Factors:  [108.06957102  -1.16298632  -1.01271716]
mat_Sqrt:  [[12.26895044  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00193511 -0.04049204  0.15865126]
Stock Position:  -0.001935107903030984
Bond Position:  [0.67116681]


portfolio before change:  [0.46324635]
curr_Stock_Price:  107.61990509671715
curr_Factors:  [107.6199051   -1.77764706  -1.008403  ]
mat_Sqrt:  [[ 6.63630657  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00283315  0.0267228  -0.41195348]
Stock Position:  0.002833151450428193
Bond Position:  [0.15834286]


portfolio before change:  [0.46208833]
curr_Stock_Price:  107.18321380726499
curr_Factors:  [107.18321381  -1.23687703  -1.00630862]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [0.46208833]
Stock Price:  105.58195614884754
PL:  [-5.11986782]
Settle:  Tensor("sub_28:0", shape=(), dtype=float64)
PL:  Tensor("sub_29:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  15
output_Z_Vals[:, i, :]:  [[ 1.19279309e+02 -2.92921948e+01 -2.92556094e+01]
 [-6.05923009e-02 -2.80061570e-02  7.34348750e-02]
 [ 3.18222273e-01  6.75032178e-02 -2.27522282e-01]
 [ 1.55081057e-01 -4.43288355e-02 -2.19584347e-01]
 [ 4.39753761e-02 -1.25879664e-01 -3.78170486e-02]
 [ 5.56448993e-02  2.73821735e-03  1.93789545e-02]
 [ 1.13731305e-01 -3.51540719e-03 -1.34371346e-01]
 [-1.41494417e-01 -2.04794177e-02 -7.31596981e-02]
 [ 3.48760405e-02  7.45645258e-02 -1.38757471e-01]
 [ 7.35742071e-02  4.30647201e-01 -2.38590104e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.27930914 -29.29219478 -29.25560936]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  8.31647217  -9.26300532 -83.45811031]
init_Out:  [2.54002979]
Stock Position:  8.316472170547405
Bond position:  [-829.10718727]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-1.31368048]
curr_Stock_Price:  99.58647694077918
curr_Factors:  [99.58647694 -0.81970613 -1.0561012 ]
mat_Sqrt:  [[15.2597562   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0030358  -0.00885632  0.20948926]
Stock Position:  -0.0030358011698279268
Bond Position:  [-1.01135573]


portfolio before change:  [-1.31575138]
curr_Stock_Price:  100.10202406985027
curr_Factors:  [100.10202407  -0.89536824  -1.03892809]
mat_Sqrt:  [[14.46733822  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0189062   0.02134639 -0.64905774]
Stock Position:  0.01890620120323528
Bond Position:  [-3.20830039]


portfolio before change:  [-1.33914676]
curr_Stock_Price:  98.94944821104238
curr_Factors:  [98.94944821 -0.10554549 -1.06477928]
mat_Sqrt:  [[30.70066529  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00355413 -0.01401801 -0.62641302]
Stock Position:  0.0035541257212572223
Bond Position:  [-1.69082554]


portfolio before change:  [-1.32285016]
curr_Stock_Price:  103.77263874917267
curr_Factors:  [ 1.03772639e+02  2.30442294e-04 -1.07106386e+00]
mat_Sqrt:  [[35.56524583  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00092804 -0.03980665 -0.10788151]
Stock Position:  0.0009280353241197696
Bond Position:  [-1.41915484]


portfolio before change:  [-1.32477499]
curr_Stock_Price:  102.46334339646319
curr_Factors:  [102.4633434   -0.17019406  -1.10761765]
mat_Sqrt:  [[28.55104104  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00208999 0.0008659  0.05528276]
Stock Position:  0.0020899872692226717
Bond Position:  [-1.53892207]


portfolio before change:  [-1.32036208]
curr_Stock_Price:  104.94305489160739
curr_Factors:  [104.94305489  -0.22501357  -1.15133553]
mat_Sqrt:  [[26.49798696  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00325353 -0.00111167 -0.38332405]
Stock Position:  0.0032535340075767936
Bond Position:  [-1.66179787]


portfolio before change:  [-1.32401034]
curr_Stock_Price:  104.07717841558187
curr_Factors:  [104.07717842  -0.35771159  -1.14404477]
mat_Sqrt:  [[23.18200579  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00677063 -0.00647616 -0.20870425]
Stock Position:  -0.006770633013787179
Bond Position:  [-0.61934196]


portfolio before change:  [-1.34823759]
curr_Stock_Price:  107.60971395748861
curr_Factors:  [107.60971396  -0.20302598  -1.22164321]
mat_Sqrt:  [[25.88961007  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 3.27449433e-04  2.35793734e-02 -3.95836442e-01]
Stock Position:  0.0003274494326331036
Bond Position:  [-1.38347433]


portfolio before change:  [-1.3486387]
curr_Stock_Price:  108.49779994027587
curr_Factors:  [108.49779994  -0.70096095  -1.17119433]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-1.3486387]
Stock Price:  106.7463186982586
PL:  [-8.0949574]
Settle:  Tensor("sub_30:0", shape=(), dtype=float64)
PL:  Tensor("sub_31:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  16
output_Z_Vals[:, i, :]:  [[ 1.19279309e+02 -2.92921948e+01 -2.92556094e+01]
 [-7.04779654e-02 -1.14653620e-01 -1.72427800e-03]
 [ 2.73234241e-02  1.62820729e-03  4.93812381e-02]
 [-5.89129088e-02  1.60938550e-01  6.84763393e-02]
 [ 3.61453495e-02 -8.23601572e-02 -4.61857249e-02]
 [ 7.80904626e-02  1.06047026e-01 -2.90109199e-03]
 [ 1.14963166e-01 -1.82951741e-05 -1.78188584e-01]
 [-5.33560733e-02 -1.06940877e-01  3.04206485e-02]
 [ 2.93024985e-02  6.59859140e-02 -1.31911095e-01]
 [ 7.10967367e-02  3.83685918e-01 -9.60172139e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.27930914 -29.29219478 -29.25560936]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  8.31647217  -9.26300532 -83.45811031]
init_Out:  [2.54002979]
Stock Position:  8.316472170547405
Bond position:  [-829.10718727]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [15.59475972]
curr_Stock_Price:  101.6196034699084
curr_Factors:  [101.61960347  -1.12395306  -1.02320209]
mat_Sqrt:  [[11.87079663  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00621612 -0.03625666 -0.00491889]
Stock Position:  -0.006216118276068274
Bond Position:  [16.2264392]


portfolio before change:  [15.59960747]
curr_Stock_Price:  102.14525300918801
curr_Factors:  [102.14525301  -0.86767086  -1.05588994]
mat_Sqrt:  [[14.92197638  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00250941 0.00051488 0.14087093]
Stock Position:  0.002509410704190953
Bond Position:  [15.34328308]


portfolio before change:  [15.61678232]
curr_Stock_Price:  105.93151808997114
curr_Factors:  [105.93151809  -0.65999762  -1.07687864]
mat_Sqrt:  [[18.65131349  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00218643  0.05089324  0.19534394]
Stock Position:  -0.0021864314844877
Bond Position:  [15.84839433]


portfolio before change:  [15.63365804]
curr_Stock_Price:  101.83830166462127
curr_Factors:  [101.83830166  -0.43578888  -1.02286554]
mat_Sqrt:  [[23.68239293  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00103837 -0.02604457 -0.13175502]
Stock Position:  0.0010383747031190611
Bond Position:  [15.52791172]


portfolio before change:  [15.64301622]
curr_Stock_Price:  103.3717398190619
curr_Factors:  [103.37173982  -0.21658231  -1.05318455]
mat_Sqrt:  [[29.03682238  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00276326  0.03353501 -0.00827601]
Stock Position:  0.002763263867913725
Bond Position:  [15.35737283]


portfolio before change:  [15.66181319]
curr_Stock_Price:  107.39465019580595
curr_Factors:  [107.3946502   -0.30455046  -1.06210589]
mat_Sqrt:  [[27.38112807  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 2.87022875e-03 -5.78544205e-06 -5.08322432e-01]
Stock Position:  0.00287022875392314
Bond Position:  [15.35356598]


portfolio before change:  [15.66855125]
curr_Stock_Price:  107.06692639136607
curr_Factors:  [107.06692639  -0.91692265  -1.0985311 ]
mat_Sqrt:  [[14.26773027  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00349794 -0.03381767  0.08678164]
Stock Position:  -0.0034979415146432283
Bond Position:  [16.0430651]


portfolio before change:  [15.67965262]
curr_Stock_Price:  106.18702724548163
curr_Factors:  [106.18702725  -1.23177545  -1.12294883]
mat_Sqrt:  [[10.07923799  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00040479  0.02086658 -0.37630564]
Stock Position:  0.00040479330148639105
Bond Position:  [15.63666883]


portfolio before change:  [15.68723658]
curr_Stock_Price:  105.60319896559487
curr_Factors:  [105.60319897  -0.91749717  -1.07692982]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [15.68723658]
Stock Price:  106.1119335514305
PL:  [9.57530303]
Settle:  Tensor("sub_32:0", shape=(), dtype=float64)
PL:  Tensor("sub_33:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  17
output_Z_Vals[:, i, :]:  [[ 1.19279309e+02 -2.92921948e+01 -2.92556094e+01]
 [-7.04779654e-02 -1.14653620e-01 -1.72427800e-03]
 [ 1.11683393e-01  1.59207242e-02  3.74154319e-02]
 [-5.20908400e-02  1.18516675e-01 -9.11721673e-02]
 [ 3.79647267e-02 -2.55573406e-02 -3.59731981e-02]
 [ 6.42982061e-02  3.01330824e-02  1.07976028e-02]
 [ 7.46099819e-02  1.81756315e-02 -1.72281610e-01]
 [-1.81304904e-01  1.13888288e-02 -8.75545359e-02]
 [-1.18611066e-01 -5.10848811e-02 -9.12766909e-02]
 [ 3.59121970e-02  1.92020240e-01 -1.41400590e-03]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.27930914 -29.29219478 -29.25560936]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  8.31647217  -9.26300532 -83.45811031]
init_Out:  [2.54002979]
Stock Position:  8.316472170547405
Bond position:  [-829.10718727]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [13.40461192]
curr_Stock_Price:  101.35625288553783
curr_Factors:  [101.35625289  -1.35435868  -1.01290411]
mat_Sqrt:  [[ 9.50082632  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00776672 -0.03625666 -0.00491889]
Stock Position:  -0.00776672190459097
Bond Position:  [14.19181775]


portfolio before change:  [13.4065785]
curr_Stock_Price:  102.01690511021029
curr_Factors:  [102.01690511  -1.11899518  -0.98146451]
mat_Sqrt:  [[12.48688437  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00958861 0.00503458 0.10673581]
Stock Position:  0.009588609477812234
Bond Position:  [12.42837823]


portfolio before change:  [13.41813545]
curr_Stock_Price:  102.57394174361559
curr_Factors:  [102.57394174  -1.0696168   -0.94281453]
mat_Sqrt:  [[13.71037154  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00493358  0.03747826 -0.26008882]
Stock Position:  -0.004933578431474749
Bond Position:  [13.92419203]


portfolio before change:  [13.42831259]
curr_Stock_Price:  101.92262814890219
curr_Factors:  [101.92262815  -1.3276233   -0.89046304]
mat_Sqrt:  [[11.09092979  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00270147 -0.00808194 -0.10262152]
Stock Position:  0.0027014723931417235
Bond Position:  [13.15297142]


portfolio before change:  [13.43638501]
curr_Stock_Price:  102.47576694477733
curr_Factors:  [102.47576694  -1.43394384  -0.8744364 ]
mat_Sqrt:  [[10.18836221  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00660364 0.00952892 0.03080256]
Stock Position:  0.006603641395133964
Bond Position:  [12.75967179]


portfolio before change:  [13.4411215]
curr_Stock_Price:  102.22667167527904
curr_Factors:  [102.22667168  -1.25785575  -0.95519777]
mat_Sqrt:  [[11.18014124  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00356994  0.00574764 -0.49147148]
Stock Position:  0.003569940444743213
Bond Position:  [13.07617837]


portfolio before change:  [13.4451469]
curr_Stock_Price:  101.52236666119353
curr_Factors:  [101.52236666  -1.0762375   -0.93358552]
mat_Sqrt:  [[13.605255    0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01461809  0.00360146 -0.24976872]
Stock Position:  -0.014618089872331626
Bond Position:  [14.92920998]


portfolio before change:  [13.46797773]
curr_Stock_Price:  100.47131558873517
curr_Factors:  [100.47131559  -1.24139751  -0.89033959]
mat_Sqrt:  [[11.91901668  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01162528 -0.01615446 -0.26038699]
Stock Position:  -0.011625275152804693
Bond Position:  [14.63598442]


portfolio before change:  [13.46469944]
curr_Stock_Price:  101.38295954917416
curr_Factors:  [101.38295955  -0.75838746  -0.95343614]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [13.46469944]
Stock Price:  101.89852421194783
PL:  [11.56617523]
Settle:  Tensor("sub_34:0", shape=(), dtype=float64)
PL:  Tensor("sub_35:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  18
output_Z_Vals[:, i, :]:  [[ 1.19279309e+02 -2.92921948e+01 -2.92556094e+01]
 [-7.04779654e-02 -1.14653620e-01 -1.72427800e-03]
 [ 5.83294640e-01  7.28263831e-02 -3.00375024e-01]
 [ 1.45211680e-01 -2.90255183e-02 -1.65387764e-01]
 [-7.45056280e-03  1.10923474e-02  2.48466637e-02]
 [ 4.27884490e-02 -5.73725683e-02  3.21412133e-02]
 [ 7.51854325e-02  1.61149680e-02 -1.56858400e-01]
 [-1.16991733e-02 -9.95414525e-02  7.81327137e-02]
 [-1.54412079e-02 -8.07765317e-02 -8.60735276e-03]
 [-1.50087629e-02 -9.03578551e-02  2.27335754e-03]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.27930914 -29.29219478 -29.25560936]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  8.31647217  -9.26300532 -83.45811031]
init_Out:  [2.54002979]
Stock Position:  8.316472170547405
Bond position:  [-829.10718727]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [25.86581075]
curr_Stock_Price:  102.85462846865734
curr_Factors:  [102.85462847  -0.55695356  -1.08925014]
mat_Sqrt:  [[19.82835374  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00372145 -0.03625666 -0.00491889]
Stock Position:  -0.0037214524643474044
Bond Position:  [26.24857936]


portfolio before change:  [25.8939612]
curr_Stock_Price:  98.8177974337959
curr_Factors:  [98.81779743 -0.85819705 -1.02602407]
mat_Sqrt:  [[15.01510361  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.03488895  0.02302972 -0.85688633]
Stock Position:  0.034888950997312936
Bond Position:  [22.44631191]


portfolio before change:  [25.92196605]
curr_Stock_Price:  99.2987201655877
curr_Factors:  [99.29872017 -1.34118201 -1.02182759]
mat_Sqrt:  [[ 9.34763236  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01184285 -0.00917867 -0.47180525]
Stock Position:  0.011842850072527137
Bond Position:  [24.7459862]


portfolio before change:  [25.95170788]
curr_Stock_Price:  100.76506813831641
curr_Factors:  [100.76506814  -1.77368009  -1.048797  ]
mat_Sqrt:  [[ 5.99133739  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00034923  0.00350771  0.07088062]
Stock Position:  -0.00034923014714809635
Bond Position:  [25.98689808]


portfolio before change:  [25.9644368]
curr_Stock_Price:  101.53181843754099
curr_Factors:  [101.53181844  -1.1933852   -1.01393767]
mat_Sqrt:  [[11.16796448  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00428618 -0.0181428   0.09168994]
Stock Position:  0.004286178868706348
Bond Position:  [25.52925327]


portfolio before change:  [25.97468735]
curr_Stock_Price:  100.94451856360149
curr_Factors:  [100.94451856  -1.08931165  -0.99746801]
mat_Sqrt:  [[12.52581079  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00347945  0.005096   -0.44747335]
Stock Position:  0.0034794500089213197
Bond Position:  [25.62345594]


portfolio before change:  [25.97728788]
curr_Stock_Price:  98.00888135473583
curr_Factors:  [98.00888135 -0.67449974 -1.00086566]
mat_Sqrt:  [[18.35115833  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 9.15174283e-05 -3.14777712e-02  2.22890884e-01]
Stock Position:  9.151742830108066e-05
Bond Position:  [25.96831836]


portfolio before change:  [25.99027936]
curr_Stock_Price:  98.05339811248987
curr_Factors:  [98.05339811 -1.26033522 -1.02716987]
mat_Sqrt:  [[ 9.95432492  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00193723 -0.02554378 -0.02455438]
Stock Position:  -0.0019372300625914544
Bond Position:  [26.18023135]


portfolio before change:  [26.00281048]
curr_Stock_Price:  98.34364244581181
curr_Factors:  [98.34364245 -1.2171083  -1.00838109]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [26.00281048]
Stock Price:  97.2725244703283
PL:  [26.00281048]
Settle:  Tensor("sub_36:0", shape=(), dtype=float64)
PL:  Tensor("sub_37:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  19
output_Z_Vals[:, i, :]:  [[ 1.19279309e+02 -2.92921948e+01 -2.92556094e+01]
 [-7.04779654e-02 -1.14653620e-01 -1.72427800e-03]
 [ 3.13073685e-01  6.75115148e-02 -2.25267091e-01]
 [ 1.83160406e-01 -5.18038788e-02 -1.47886023e-01]
 [-1.42514980e-01  1.38696155e-01  2.11685591e-01]
 [ 5.89779938e-02 -2.01413277e-02  1.60954753e-02]
 [ 8.73464367e-02 -2.80371258e-02  1.60129511e-01]
 [ 1.01845916e-02 -1.04456103e-01  5.11267189e-02]
 [ 7.19602223e-02 -9.09541977e-02  5.11001493e-02]
 [-1.56840267e-02 -9.75693201e-02 -4.17308462e-04]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.27930914 -29.29219478 -29.25560936]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  8.31647217  -9.26300532 -83.45811031]
init_Out:  [2.54002979]
Stock Position:  8.316472170547405
Bond position:  [-829.10718727]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [7.93062432]
curr_Stock_Price:  100.69804259099335
curr_Factors:  [100.69804259  -1.33792859  -1.03228634]
mat_Sqrt:  [[ 9.41130321  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0078406  -0.03625666 -0.00491889]
Stock Position:  -0.007840601265394966
Bond Position:  [8.72015752]


portfolio before change:  [7.93867115]
curr_Stock_Price:  100.22796917516443
curr_Factors:  [100.22796918  -0.99554375  -1.00858513]
mat_Sqrt:  [[13.50849025  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01990114  0.02134902 -0.64262431]
Stock Position:  0.019901141240459542
Bond Position:  [5.94402018]


portfolio before change:  [7.91875239]
curr_Stock_Price:  99.0777079696809
curr_Factors:  [99.07770797 -1.54333689 -1.01213897]
mat_Sqrt:  [[ 7.69390613  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01970855 -0.01638182 -0.42187766]
Stock Position:  0.01970854925694722
Bond Position:  [5.9660745]


portfolio before change:  [7.8973899]
curr_Stock_Price:  97.8423929049041
curr_Factors:  [97.8423929  -1.42406888 -1.02330718]
mat_Sqrt:  [[ 8.4653545   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0113077   0.04385958  0.60388007]
Stock Position:  -0.011307703658020155
Bond Position:  [9.00376269]


portfolio before change:  [7.91103483]
curr_Stock_Price:  97.03392508154376
curr_Factors:  [97.03392508 -0.80080075 -0.99238512]
mat_Sqrt:  [[16.14926907  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0038233  -0.00636925  0.04591591]
Stock Position:  0.0038232951459694704
Bond Position:  [7.54004549]


portfolio before change:  [7.91074067]
curr_Stock_Price:  95.97067399154628
curr_Factors:  [95.97067399 -1.0722816  -0.93562757]
mat_Sqrt:  [[12.88589748  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00925887 -0.00886612  0.45680492]
Stock Position:  0.009258867766640115
Bond Position:  [7.02216089]


portfolio before change:  [7.92763874]
curr_Stock_Price:  97.41643568978213
curr_Factors:  [97.41643569 -1.05774144 -0.95323045]
mat_Sqrt:  [[13.04001956  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00137452 -0.03303192  0.1458503 ]
Stock Position:  0.0013745182143213048
Bond Position:  [7.79373808]


portfolio before change:  [7.92938356]
curr_Stock_Price:  95.85004673573653
curr_Factors:  [95.85004674 -1.16430171 -1.00048905]
mat_Sqrt:  [[11.00108821  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00727588 -0.02876224  0.1457745 ]
Stock Position:  0.0072758774169439325
Bond Position:  [7.23199037]


portfolio before change:  [7.94560814]
curr_Stock_Price:  97.58285284167046
curr_Factors:  [97.58285284 -1.41545678 -1.08951265]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [7.94560814]
Stock Price:  98.49130991982562
PL:  [7.94560814]
Settle:  Tensor("sub_38:0", shape=(), dtype=float64)
PL:  Tensor("sub_39:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  20
output_Z_Vals[:, i, :]:  [[ 1.19279309e+02 -2.92921948e+01 -2.92556094e+01]
 [-7.04779654e-02 -1.14653620e-01 -1.72427800e-03]
 [ 2.65106004e-01  7.25844464e-02 -1.66678616e-01]
 [ 1.14594953e-01 -1.24731598e-02 -1.90939343e-01]
 [-1.64970311e-01  1.68963091e-01  2.45789585e-01]
 [ 9.28591014e-02  9.08287835e-02 -1.75063288e-02]
 [ 8.73464367e-02 -2.80371258e-02  1.60129511e-01]
 [-5.46990476e-02 -8.60409776e-02  8.42262459e-02]
 [-1.00445851e-01 -5.50163944e-02 -7.76149062e-02]
 [-1.50086346e-02 -9.48740524e-02 -6.44294368e-06]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.27930914 -29.29219478 -29.25560936]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  8.31647217  -9.26300532 -83.45811031]
init_Out:  [2.54002979]
Stock Position:  8.316472170547405
Bond position:  [-829.10718727]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [4.94312639]
curr_Stock_Price:  100.33881600185997
curr_Factors:  [100.338816    -1.31152715  -1.00664725]
mat_Sqrt:  [[ 9.8786732   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00746965 -0.03625666 -0.00491889]
Stock Position:  -0.007469654516849187
Bond Position:  [5.69262268]


portfolio before change:  [4.94280978]
curr_Stock_Price:  100.76234646129382
curr_Factors:  [100.76234646  -1.18977284  -0.99197995]
mat_Sqrt:  [[11.37038251  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.02048805  0.02295322 -0.4754877 ]
Stock Position:  0.020488052755177063
Bond Position:  [2.87838551]


portfolio before change:  [4.9174079]
curr_Stock_Price:  99.45224446413118
curr_Factors:  [99.45224446 -0.97292888 -1.01265258]
mat_Sqrt:  [[13.6548684   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00551434 -0.00394436 -0.5446968 ]
Stock Position:  0.005514338541509757
Bond Position:  [4.36899455]


portfolio before change:  [4.90903748]
curr_Stock_Price:  97.53805955485015
curr_Factors:  [97.53805955 -1.27604825 -0.92907011]
mat_Sqrt:  [[10.75234959  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01027088  0.05343082  0.70116927]
Stock Position:  -0.010270882027034283
Bond Position:  [5.91083938]


portfolio before change:  [4.90813487]
curr_Stock_Price:  97.91375931253694
curr_Factors:  [97.91375931 -1.34856306 -0.84326957]
mat_Sqrt:  [[10.93812566  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0083772   0.02872258 -0.04994068]
Stock Position:  0.008377196326714378
Bond Position:  [4.08789208]


portfolio before change:  [4.91294273]
curr_Stock_Price:  98.24363103299895
curr_Factors:  [98.24363103 -0.62643431 -0.82776148]
mat_Sqrt:  [[22.9485471   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00519897 -0.00886612  0.45680492]
Stock Position:  0.005198970563520217
Bond Position:  [4.40217698]


portfolio before change:  [4.91875467]
curr_Stock_Price:  98.93805865632673
curr_Factors:  [98.93805866 -0.85676383 -0.79527503]
mat_Sqrt:  [[18.96234411  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0020951  -0.02720855  0.24027404]
Stock Position:  -0.0020950999195644975
Bond Position:  [5.12603979]


portfolio before change:  [4.92068934]
curr_Stock_Price:  99.23827979690375
curr_Factors:  [99.2382798  -1.01361969 -0.81519463]
mat_Sqrt:  [[15.93805274  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00738543 -0.01739771 -0.22141372]
Stock Position:  -0.00738543451460007
Bond Position:  [5.65360716]


portfolio before change:  [4.93093514]
curr_Stock_Price:  98.23383164293386
curr_Factors:  [98.23383164 -1.43447773 -0.7997683 ]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [4.93093514]
Stock Price:  99.0067417949101
PL:  [4.93093514]
Settle:  Tensor("sub_40:0", shape=(), dtype=float64)
PL:  Tensor("sub_41:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  21
output_Z_Vals[:, i, :]:  [[ 1.19279309e+02 -2.92921948e+01 -2.92556094e+01]
 [-1.11192915e-02 -2.82242468e-01 -2.39340579e-02]
 [ 1.06157695e+00  8.06841146e-02 -4.44968457e-01]
 [ 5.09114857e-01 -4.59116818e-01  1.55267557e-01]
 [-2.97273782e-01  3.65108653e-01  4.52729962e-01]
 [ 1.42356826e-01  2.25315833e-01 -7.40353934e-02]
 [ 8.73464367e-02 -2.80371258e-02  1.60129511e-01]
 [ 1.28021639e-01 -9.92574528e-02 -6.70980638e-02]
 [ 1.19054669e-01 -9.14156087e-02  7.98089393e-02]
 [-1.05049961e-02 -7.70835913e-02 -4.80363213e-03]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.27930914 -29.29219478 -29.25560936]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  8.31647217  -9.26300532 -83.45811031]
init_Out:  [2.54002979]
Stock Position:  8.316472170547405
Bond position:  [-829.10718727]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-26.99105617]
curr_Stock_Price:  96.49894473198012
curr_Factors:  [96.49894473 -1.38529572 -0.96858517]
mat_Sqrt:  [[ 9.16737682  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00254078 -0.08925291 -0.06827721]
Stock Position:  -0.0025407791429143045
Bond Position:  [-26.74587366]


portfolio before change:  [-27.00533354]
curr_Stock_Price:  96.85359539360451
curr_Factors:  [96.85359539 -1.19317767 -0.97360019]
mat_Sqrt:  [[11.09420219  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.08768827  0.02551456 -1.26937115]
Stock Position:  0.08768827040822687
Bond Position:  [-35.4982578]


portfolio before change:  [-27.2349144]
curr_Stock_Price:  94.43790979772923
curr_Factors:  [94.4379098  -1.36801716 -0.95616053]
mat_Sqrt:  [[ 9.24206077  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.05723338 -0.14518549  0.44293512]
Stock Position:  0.05723337930351019
Bond Position:  [-32.63991511]


portfolio before change:  [-27.26852487]
curr_Stock_Price:  94.1358755873539
curr_Factors:  [94.13587559 -1.65223971 -1.00683777]
mat_Sqrt:  [[ 6.59071434  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02965287  0.11545749  1.29151257]
Stock Position:  -0.0296528706924371
Bond Position:  [-24.47712593]


portfolio before change:  [-27.2854015]
curr_Stock_Price:  94.2921843558289
curr_Factors:  [94.29218436 -1.47470523 -1.04259064]
mat_Sqrt:  [[ 7.60725528  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01749147  0.07125112 -0.21120237]
Stock Position:  0.01749146569509468
Bond Position:  [-28.93471001]


portfolio before change:  [-27.30213777]
curr_Stock_Price:  94.1626757257239
curr_Factors:  [94.16267573 -1.22157067 -1.04059551]
mat_Sqrt:  [[ 9.80465921  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01216858 -0.00886612  0.45680492]
Stock Position:  0.012168584165414826
Bond Position:  [-28.44796421]


portfolio before change:  [-27.33032992]
curr_Stock_Price:  93.01507971168823
curr_Factors:  [93.01507971 -0.54106045 -0.95365555]
mat_Sqrt:  [[20.86442645  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0053566  -0.03138796 -0.1914121 ]
Stock Position:  0.005356604852647143
Bond Position:  [-27.82857495]


portfolio before change:  [-27.33116117]
curr_Stock_Price:  95.45814221420589
curr_Factors:  [95.45814221 -0.61303399 -0.95012036]
mat_Sqrt:  [[19.99602501  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00665058 -0.02890815  0.22767269]
Stock Position:  0.006650584774634259
Bond Position:  [-27.96601364]


portfolio before change:  [-27.35241993]
curr_Stock_Price:  94.36466533497578
curr_Factors:  [ 9.43646653e+01 -5.16412917e-02 -8.93833811e-01]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-27.35241993]
Stock Price:  95.51862620195338
PL:  [-27.35241993]
Settle:  Tensor("sub_42:0", shape=(), dtype=float64)
PL:  Tensor("sub_43:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  22
output_Z_Vals[:, i, :]:  [[ 1.19279309e+02 -2.92921948e+01 -2.92556094e+01]
 [-5.84256872e-02 -2.24209744e-02  7.91047254e-02]
 [-1.00344487e-01 -2.43987726e-02  6.87603157e-02]
 [-5.46638374e-02  1.08527682e-01 -1.47456238e-01]
 [-8.09706840e-02  5.81440521e-02  1.19030752e-01]
 [ 7.10287189e-02  1.81713992e-02  3.83265209e-03]
 [-3.02393448e-01 -1.37689716e-01  3.63847244e-01]
 [ 1.34393936e-01 -8.49748275e-02 -4.92595665e-02]
 [-4.25242256e-02 -7.65760557e-02  1.25042336e-01]
 [-6.59326993e-03 -3.14660285e-02 -1.25046876e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.27930914 -29.29219478 -29.25560936]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  8.31647217  -9.26300532 -83.45811031]
init_Out:  [2.54002979]
Stock Position:  8.316472170547405
Bond position:  [-829.10718727]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [11.66647287]
curr_Stock_Price:  101.14725332353139
curr_Factors:  [101.14725332  -0.50576691  -0.96913235]
mat_Sqrt:  [[23.14267127  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00185188 -0.00709013  0.22566376]
Stock Position:  -0.0018518782614138677
Bond Position:  [11.85378527]


portfolio before change:  [11.67025721]
curr_Stock_Price:  102.3050194859304
curr_Factors:  [102.30501949  -0.15143797  -1.0095797 ]
mat_Sqrt:  [[32.03858865  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00271357 -0.00771557  0.19615404]
Stock Position:  -0.0027135658309974824
Bond Position:  [11.94786861]


portfolio before change:  [11.6786469]
curr_Stock_Price:  101.41531825768313
curr_Factors:  [101.41531826  -0.39793223  -1.00153992]
mat_Sqrt:  [[25.02191397  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00327557  0.03431947 -0.4206516 ]
Stock Position:  -0.0032755705019774303
Bond Position:  [12.01083992]


portfolio before change:  [11.68937124]
curr_Stock_Price:  99.97513547532292
curr_Factors:  [99.97513548 -0.49088906 -0.98946445]
mat_Sqrt:  [[22.75006496  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00242515  0.01838676  0.3395616 ]
Stock Position:  -0.002425151781438734
Bond Position:  [11.93182612]


portfolio before change:  [11.70651686]
curr_Stock_Price:  95.36585252577909
curr_Factors:  [95.36585253 -0.68389382 -0.96944083]
mat_Sqrt:  [[18.25403082  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00395969 0.0057463  0.01093349]
Stock Position:  0.0039596864893433545
Bond Position:  [11.32889798]


portfolio before change:  [11.70417207]
curr_Stock_Price:  93.34280122185767
curr_Factors:  [93.34280122 -0.24249788 -0.96771146]
mat_Sqrt:  [[27.8287432   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00832515 -0.04354131  1.03795491]
Stock Position:  -0.008325154017857314
Bond Position:  [12.48126527]


portfolio before change:  [11.74053417]
curr_Stock_Price:  89.7248618293021
curr_Factors:  [89.72486183 -0.52614696 -1.02540367]
mat_Sqrt:  [[19.01441294  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0064238  -0.0268714  -0.14052383]
Stock Position:  0.006423802260075033
Bond Position:  [11.1641594]


portfolio before change:  [11.75432308]
curr_Stock_Price:  91.00221102126265
curr_Factors:  [91.00221102 -0.23453465 -1.08379193]
mat_Sqrt:  [[24.35061776  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00077933 -0.02421548  0.35671098]
Stock Position:  -0.0007793334438832763
Bond Position:  [11.82524415]


portfolio before change:  [11.76079349]
curr_Stock_Price:  90.28837988236124
curr_Factors:  [90.28837988 -0.29981065 -1.1172843 ]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [11.76079349]
Stock Price:  90.17008163452708
PL:  [11.76079349]
Settle:  Tensor("sub_44:0", shape=(), dtype=float64)
PL:  Tensor("sub_45:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  23
output_Z_Vals[:, i, :]:  [[ 1.19279309e+02 -2.92921948e+01 -2.92556094e+01]
 [-6.33749677e-02 -5.23961223e-02  5.22786972e-02]
 [ 9.00775512e-01  7.92009807e-02 -3.87639531e-01]
 [ 3.61618448e-01 -2.19541423e-01 -1.26984610e-01]
 [-3.35467177e-01  4.16341648e-01  5.10653448e-01]
 [ 1.00016657e-01  9.75033476e-02 -2.91194808e-02]
 [-2.85337420e-03 -5.34146745e-02  2.07277113e-01]
 [ 1.34913551e-01 -8.38101829e-02 -4.78049662e-02]
 [-1.74951742e-02 -7.83892680e-02  1.23299300e-01]
 [-5.49730125e-03 -1.52941366e-02 -1.71889564e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.27930914 -29.29219478 -29.25560936]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  8.31647217  -9.26300532 -83.45811031]
init_Out:  [2.54002979]
Stock Position:  8.316472170547405
Bond position:  [-829.10718727]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-12.56390888]
curr_Stock_Price:  98.23371243085607
curr_Factors:  [98.23371243 -0.92307335 -0.99520453]
mat_Sqrt:  [[14.42656896  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00374701 -0.01656911  0.14913657]
Stock Position:  -0.0037470091122226144
Bond Position:  [-12.19582626]


portfolio before change:  [-12.5664329]
curr_Stock_Price:  97.27950721457263
curr_Factors:  [97.27950721 -0.81357412 -1.01086202]
mat_Sqrt:  [[15.69201856  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.05249126  0.02504555 -1.10582768]
Stock Position:  0.052491263726383554
Bond Position:  [-17.67275717]


portfolio before change:  [-12.63891633]
curr_Stock_Price:  96.06702281378658
curr_Factors:  [96.06702281 -0.52008337 -0.90829314]
mat_Sqrt:  [[23.02704942  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01433224 -0.06942509 -0.36225175]
Stock Position:  0.0143322438927452
Bond Position:  [-14.01577233]


portfolio before change:  [-12.67204691]
curr_Stock_Price:  94.24449269808456
curr_Factors:  [94.2444927  -0.78360868 -0.89435971]
mat_Sqrt:  [[17.60044173  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01252699  0.13165879  1.45675215]
Stock Position:  -0.012526991479721396
Bond Position:  [-11.49144695]


portfolio before change:  [-12.67795266]
curr_Stock_Price:  94.25715257279401
curr_Factors:  [94.25715257 -0.73306789 -0.87425069]
mat_Sqrt:  [[18.89142526  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00511291  0.03083327 -0.08306977]
Stock Position:  0.005112911946134287
Bond Position:  [-13.15988118]


portfolio before change:  [-12.69037835]
curr_Stock_Price:  93.11414344951926
curr_Factors:  [93.11414345 -0.75629632 -0.90273849]
mat_Sqrt:  [[17.72172476  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00214865 -0.0168912   0.59130391]
Stock Position:  0.0021486468685602226
Bond Position:  [-12.89044776]


portfolio before change:  [-12.70405119]
curr_Stock_Price:  89.75109666297038
curr_Factors:  [89.75109666 -0.44236188 -0.87709585]
mat_Sqrt:  [[23.988691    0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00512706 -0.02650311 -0.13637426]
Stock Position:  0.005127058975718507
Bond Position:  [-13.16421035]


portfolio before change:  [-12.70457817]
curr_Stock_Price:  90.93243047047358
curr_Factors:  [90.93243047 -0.52933475 -0.84082402]
mat_Sqrt:  [[23.10289519  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 2.44522942e-04 -2.47888631e-02  3.51738584e-01]
Stock Position:  0.0002445229420918717
Bond Position:  [-12.72681324]


portfolio before change:  [-12.71156598]
curr_Stock_Price:  88.38539054826663
curr_Factors:  [88.38539055 -0.21992764 -0.7567178 ]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-12.71156598]
Stock Price:  88.59488469866342
PL:  [-12.71156598]
Settle:  Tensor("sub_46:0", shape=(), dtype=float64)
PL:  Tensor("sub_47:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  24
output_Z_Vals[:, i, :]:  [[ 1.19279309e+02 -2.92921948e+01 -2.92556094e+01]
 [-7.04779654e-02 -1.14653620e-01 -1.72427800e-03]
 [-9.86002689e-02 -3.87160630e-02  6.61264760e-02]
 [-4.75041667e-02  1.33199084e-01 -4.84342934e-03]
 [ 3.78513219e-02 -6.78794694e-02 -5.02734446e-02]
 [ 6.11549337e-02  2.66276003e-02  1.39105157e-02]
 [ 9.50108079e-02 -7.84989798e-03 -8.09160789e-02]
 [-2.14391669e-01  5.10309224e-02 -1.58828687e-01]
 [-1.52043758e-03  3.14238079e-02 -1.10300151e-01]
 [ 1.05451651e-02  6.73323791e-02  1.18251201e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.27930914 -29.29219478 -29.25560936]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  8.31647217  -9.26300532 -83.45811031]
init_Out:  [2.54002979]
Stock Position:  8.316472170547405
Bond position:  [-829.10718727]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [33.87756053]
curr_Stock_Price:  103.81798764444265
curr_Factors:  [103.81798764  -1.64331567  -1.03047899]
mat_Sqrt:  [[ 7.16239615  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01030246 -0.03625666 -0.00491889]
Stock Position:  -0.01030245665831977
Bond Position:  [34.94714085]


portfolio before change:  [33.88973673]
curr_Stock_Price:  104.33259692755814
curr_Factors:  [104.33259693  -1.31187799  -1.01952006]
mat_Sqrt:  [[10.13693608  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00849388 -0.01224309  0.18864043]
Stock Position:  -0.00849387845456582
Bond Position:  [34.77592513]


portfolio before change:  [33.91397506]
curr_Stock_Price:  103.5266020783208
curr_Factors:  [103.52660208  -1.15617995  -1.0138453 ]
mat_Sqrt:  [[11.82012228  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00381161  0.04212125 -0.01381696]
Stock Position:  -0.0038116054079875925
Bond Position:  [34.30857762]


portfolio before change:  [33.93424045]
curr_Stock_Price:  102.71150887891291
curr_Factors:  [102.71150888  -0.98026672  -1.01167799]
mat_Sqrt:  [[14.01291592  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00184377 -0.02146537 -0.14341614]
Stock Position:  0.0018437745438480632
Bond Position:  [33.74486359]


portfolio before change:  [33.95071952]
curr_Stock_Price:  102.49587063162713
curr_Factors:  [102.49587063  -0.31630032  -0.97087272]
mat_Sqrt:  [[28.29399164  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00228607 0.00842039 0.03968283]
Stock Position:  0.002286065829493003
Bond Position:  [33.71640721]


portfolio before change:  [33.96685455]
curr_Stock_Price:  102.17768788215314
curr_Factors:  [102.17768788  -0.5637534   -0.9553177 ]
mat_Sqrt:  [[22.36824313  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0035001  -0.00248236 -0.23083105]
Stock Position:  0.0035001049695419307
Bond Position:  [33.60922191]


portfolio before change:  [33.98666995]
curr_Stock_Price:  103.036686562864
curr_Factors:  [103.03668656  -0.69677909  -0.9458038 ]
mat_Sqrt:  [[19.93550313  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01231445  0.01613739 -0.45309403]
Stock Position:  -0.01231445351684835
Bond Position:  [35.25551043]


portfolio before change:  [33.97990815]
curr_Stock_Price:  105.01760737147607
curr_Factors:  [105.01760737  -0.32962081  -0.93778986]
mat_Sqrt:  [[29.5687293   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00078542  0.00993708 -0.31465563]
Stock Position:  -0.0007854244307036135
Bond Position:  [34.06239155]


portfolio before change:  [34.00122113]
curr_Stock_Price:  99.57147929645369
curr_Factors:  [99.5714793  -0.1519138  -0.92807756]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [34.00122113]
Stock Price:  108.91415676114487
PL:  [25.08706437]
Settle:  Tensor("sub_48:0", shape=(), dtype=float64)
PL:  Tensor("sub_49:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  25
output_Z_Vals[:, i, :]:  [[ 1.19279309e+02 -2.92921948e+01 -2.92556094e+01]
 [-5.23380208e-02  4.43422863e-02  1.36190870e-01]
 [ 4.61181857e-01  7.15829917e-02 -2.57720199e-01]
 [ 1.73666981e-01 -5.49452105e-02 -2.07632482e-01]
 [-4.34681301e-03 -3.19256872e-02  7.03127045e-03]
 [ 4.28875456e-02 -5.79974907e-02  3.20435556e-02]
 [ 7.18394194e-02  2.84927467e-02 -2.40672503e-01]
 [-2.14391669e-01  5.10309224e-02 -1.58828687e-01]
 [-2.84231589e-02  1.79545379e-02 -1.11524058e-01]
 [ 6.78302434e-02  3.67528636e-01 -8.22688259e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.27930914 -29.29219478 -29.25560936]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  8.31647217  -9.26300532 -83.45811031]
init_Out:  [2.54002979]
Stock Position:  8.316472170547405
Bond position:  [-829.10718727]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-0.75622915]
curr_Stock_Price:  99.65350672418975
curr_Factors:  [99.65350672 -0.65318287 -1.01747621]
mat_Sqrt:  [[18.74712039  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00124783  0.01402226  0.38851464]
Stock Position:  -0.001247832331232476
Bond Position:  [-0.63187828]


portfolio before change:  [-0.75598556]
curr_Stock_Price:  99.2050426292274
curr_Factors:  [99.20504263 -0.6345184  -1.0179825 ]
mat_Sqrt:  [[19.00473082  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.02159584  0.02263653 -0.73520399]
Stock Position:  0.02159584425374962
Bond Position:  [-2.89840221]


portfolio before change:  [-0.76257867]
curr_Stock_Price:  98.96686978670024
curr_Factors:  [98.96686979 -0.43758681 -0.99292089]
mat_Sqrt:  [[23.6716338   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00548612 -0.0173752  -0.59231768]
Stock Position:  0.005486123182656605
Bond Position:  [-1.3055231]


portfolio before change:  [-0.75194829]
curr_Stock_Price:  101.02356806641082
curr_Factors:  [101.02356807  -0.85242211  -1.01919047]
mat_Sqrt:  [[15.54503444  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00024033 -0.01009579  0.02005826]
Stock Position:  -0.00024032617304801343
Bond Position:  [-0.72766968]


portfolio before change:  [-0.75222248]
curr_Stock_Price:  100.65018115330857
curr_Factors:  [100.65018115  -0.65167069  -0.98518862]
mat_Sqrt:  [[19.58554206  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00244726 -0.01834042  0.09141134]
Stock Position:  0.0024472603368817145
Bond Position:  [-0.99853968]


portfolio before change:  [-0.74609684]
curr_Stock_Price:  103.35730308488951
curr_Factors:  [103.35730308  -1.61224091  -0.99277112]
mat_Sqrt:  [[ 7.63833707  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00306978  0.0090102  -0.68657166]
Stock Position:  0.0030697820637222923
Bond Position:  [-1.06338124]


portfolio before change:  [-0.74514949]
curr_Stock_Price:  103.83915507012566
curr_Factors:  [103.83915507  -1.244352    -0.94006373]
mat_Sqrt:  [[11.68641891  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02100685  0.01613739 -0.45309403]
Stock Position:  -0.02100684807268748
Bond Position:  [1.43618387]


portfolio before change:  [-0.74054289]
curr_Stock_Price:  103.6540571663899
curr_Factors:  [103.65405717  -1.10808503  -0.90166574]
mat_Sqrt:  [[13.89193151  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00365135  0.00567772 -0.31814709]
Stock Position:  -0.0036513516931579704
Bond Position:  [-0.36206548]


portfolio before change:  [-0.74740751]
curr_Stock_Price:  105.48448659604328
curr_Factors:  [105.4844866   -0.97275979  -0.87027554]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-0.74740751]
Stock Price:  107.72893711590795
PL:  [-8.47634463]
Settle:  Tensor("sub_50:0", shape=(), dtype=float64)
PL:  Tensor("sub_51:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  26
output_Z_Vals[:, i, :]:  [[ 1.19279309e+02 -2.92921948e+01 -2.92556094e+01]
 [-5.94807373e-02 -2.72498461e-02  7.46440987e-02]
 [-4.55325733e-02 -1.64244081e-02  5.93801154e-02]
 [-4.95010658e-02  1.32147927e-01 -1.84863216e-02]
 [ 3.20976858e-02 -4.54699594e-02 -3.66766234e-02]
 [ 1.33427894e-01  3.61030457e-01 -5.78306440e-02]
 [ 9.08207716e-02  6.87352485e-04 -1.35860596e-01]
 [-2.14391669e-01  5.10309224e-02 -1.58828687e-01]
 [-1.37977930e-01 -2.19120649e-02 -1.29573942e-01]
 [-1.56940936e-02 -9.76082100e-02 -3.70297216e-04]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.27930914 -29.29219478 -29.25560936]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  8.31647217  -9.26300532 -83.45811031]
init_Out:  [2.54002979]
Stock Position:  8.316472170547405
Bond position:  [-829.10718727]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [12.56884635]
curr_Stock_Price:  101.25575768125023
curr_Factors:  [101.25575768  -0.68680549  -0.98965089]
mat_Sqrt:  [[18.93842998  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00237336 -0.00861716  0.21293884]
Stock Position:  -0.0023733573717722944
Bond Position:  [12.80916244]


portfolio before change:  [12.57113575]
curr_Stock_Price:  102.99033843299617
curr_Factors:  [102.99033843  -1.49777718  -0.98021358]
mat_Sqrt:  [[ 8.64208979  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00391523 -0.00519385  0.16939494]
Stock Position:  -0.003915225972630481
Bond Position:  [12.9743662]


portfolio before change:  [12.57583231]
curr_Stock_Price:  103.44810190424435
curr_Factors:  [103.4481019   -1.26312699  -0.96379124]
mat_Sqrt:  [[11.15794523  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00446879  0.04178884 -0.05273633]
Stock Position:  -0.004468791034719019
Bond Position:  [13.03812026]


portfolio before change:  [12.58374619]
curr_Stock_Price:  103.13634085968903
curr_Factors:  [103.13634086  -1.20794099  -0.91344926]
mat_Sqrt:  [[12.36242417  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00189583 -0.01437886 -0.1046282 ]
Stock Position:  0.0018958314113555392
Bond Position:  [12.38821708]


portfolio before change:  [12.59455418]
curr_Stock_Price:  105.56922014159717
curr_Factors:  [105.56922014  -1.41091063  -0.90803251]
mat_Sqrt:  [[10.38563612  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01260828  0.11416785 -0.16497473]
Stock Position:  0.01260828206694019
Bond Position:  [11.26350767]


portfolio before change:  [12.60159976]
curr_Stock_Price:  105.68124341747598
curr_Factors:  [105.68124342  -1.11396439  -0.86513752]
mat_Sqrt:  [[14.60443889  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 4.32102126e-03  2.17359941e-04 -3.87572464e-01]
Stock Position:  0.0043210212623375505
Bond Position:  [12.14494886]


portfolio before change:  [12.59597461]
curr_Stock_Price:  102.97374728461439
curr_Factors:  [102.97374728  -0.75275374  -0.87781411]
mat_Sqrt:  [[20.16414894  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01217482  0.01613739 -0.45309403]
Stock Position:  -0.012174817164838267
Bond Position:  [13.84966115]


portfolio before change:  [12.6293158]
curr_Stock_Price:  100.8041351739802
curr_Factors:  [100.80413517  -0.4453969   -0.91808704]
mat_Sqrt:  [[25.7824864   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00639942 -0.0069292  -0.36963839]
Stock Position:  -0.006399416419897422
Bond Position:  [13.27440344]


portfolio before change:  [12.66012351]
curr_Stock_Price:  97.02740849684645
curr_Factors:  [97.0274085  -0.32795116 -0.90814169]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [12.66012351]
Stock Price:  97.98222295489354
PL:  [12.66012351]
Settle:  Tensor("sub_52:0", shape=(), dtype=float64)
PL:  Tensor("sub_53:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  27
output_Z_Vals[:, i, :]:  [[ 1.19279309e+02 -2.92921948e+01 -2.92556094e+01]
 [-7.04779654e-02 -1.14653620e-01 -1.72427800e-03]
 [ 1.27193818e-01  2.37404811e-02  3.22386298e-02]
 [-6.19085713e-02  1.07504360e-01 -1.84444921e-01]
 [-1.88018254e-01  1.98896496e-01  2.80412985e-01]
 [ 4.15198836e-02 -1.00094127e-01  3.12964719e-02]
 [-8.66249130e-02 -7.69836408e-02  2.51064646e-01]
 [ 1.25450940e-01 -1.05019321e-01 -7.42944348e-02]
 [ 1.02199247e-01 -9.12504666e-02  6.95338690e-02]
 [-1.08588010e-02 -7.84830716e-02 -4.50398092e-03]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.27930914 -29.29219478 -29.25560936]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  8.31647217  -9.26300532 -83.45811031]
init_Out:  [2.54002979]
Stock Position:  8.316472170547405
Bond position:  [-829.10718727]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [21.77668701]
curr_Stock_Price:  102.36293876461444
curr_Factors:  [102.36293876  -1.01055203  -1.04088859]
mat_Sqrt:  [[13.15871271  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00560771 -0.03625666 -0.00491889]
Stock Position:  -0.005607712360024365
Bond Position:  [22.35070893]


portfolio before change:  [21.79188176]
curr_Stock_Price:  101.64667485749781
curr_Factors:  [101.64667486  -0.80771735  -1.00566792]
mat_Sqrt:  [[16.57868031  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00810604 0.0075074  0.09196784]
Stock Position:  0.00810604191909773
Bond Position:  [20.96792956]


portfolio before change:  [21.79574378]
curr_Stock_Price:  100.82943679159423
curr_Factors:  [100.82943679  -0.4574934   -0.99527827]
mat_Sqrt:  [[23.58612654  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00410336  0.03399586 -0.52617002]
Stock Position:  -0.004103364844421487
Bond Position:  [22.20948375]


portfolio before change:  [21.81604043]
curr_Stock_Price:  98.59002458663643
curr_Factors:  [98.59002459  0.2117795  -0.95552029]
mat_Sqrt:  [[46.86303923  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00268108  0.06289659  0.7999402 ]
Stock Position:  -0.0026810831992458645
Bond Position:  [22.08036849]


portfolio before change:  [21.83504279]
curr_Stock_Price:  95.62129361334082
curr_Factors:  [ 9.56212936e+01  5.25148365e-02 -9.82782387e-01]
mat_Sqrt:  [[37.71764345  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00120166 -0.03165254  0.08928012]
Stock Position:  0.0012016612339361727
Bond Position:  [21.72013839]


portfolio before change:  [21.84416924]
curr_Stock_Price:  94.17635006899789
curr_Factors:  [94.17635007 -0.57944143 -0.96542646]
mat_Sqrt:  [[20.09158759  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0018597  -0.02434436  0.71621755]
Stock Position:  -0.0018596970288136904
Bond Position:  [22.01930872]


portfolio before change:  [21.85556093]
curr_Stock_Price:  93.97240087434888
curr_Factors:  [93.97240087 -1.62883547 -0.98292678]
mat_Sqrt:  [[ 6.89805079  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01559485 -0.03321003 -0.21194134]
Stock Position:  0.01559484962493146
Bond Position:  [20.39007547]


portfolio before change:  [21.86980457]
curr_Stock_Price:  94.23184882695818
curr_Factors:  [94.23184883 -1.34733204 -0.99531503]
mat_Sqrt:  [[ 9.05313538  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01259638 -0.02885593  0.19836077]
Stock Position:  0.012596377641384087
Bond Position:  [20.68282462]


portfolio before change:  [21.89184737]
curr_Stock_Price:  95.16059241089994
curr_Factors:  [95.16059241 -1.29838836 -1.02848829]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [21.89184737]
Stock Price:  95.92894496175423
PL:  [21.89184737]
Settle:  Tensor("sub_54:0", shape=(), dtype=float64)
PL:  Tensor("sub_55:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  28
output_Z_Vals[:, i, :]:  [[ 1.19279309e+02 -2.92921948e+01 -2.92556094e+01]
 [-7.04779654e-02 -1.14653620e-01 -1.72427800e-03]
 [ 1.38343853e-01  1.92590394e-02  3.35646593e-02]
 [-4.62509602e-02  1.34602911e-01  7.05422116e-03]
 [ 3.78087050e-02 -5.01746481e-02 -4.41978239e-02]
 [ 5.03887332e-02 -4.82735603e-02  2.46139291e-02]
 [ 7.96262812e-02  9.97628275e-03 -1.52145342e-01]
 [-1.36845591e-01 -2.50397962e-02 -6.76963900e-02]
 [ 2.40980870e-02  5.18079749e-02 -1.18674753e-01]
 [ 7.11202357e-02  4.17448121e-01 -2.24222455e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.27930914 -29.29219478 -29.25560936]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  8.31647217  -9.26300532 -83.45811031]
init_Out:  [2.54002979]
Stock Position:  8.316472170547405
Bond position:  [-829.10718727]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [2.31635191]
curr_Stock_Price:  100.02296398831912
curr_Factors:  [100.02296399  -1.09711884  -1.01450089]
mat_Sqrt:  [[12.10695492  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00609487 -0.03625666 -0.00491889]
Stock Position:  -0.006094866656861527
Bond Position:  [2.92597853]


portfolio before change:  [2.30503007]
curr_Stock_Price:  102.12066193270884
curr_Factors:  [102.12066193  -1.39403973  -0.99422199]
mat_Sqrt:  [[ 9.37356374  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01554291 0.00609024 0.09575063]
Stock Position:  0.015542911991353051
Bond Position:  [0.71777761]


portfolio before change:  [2.32951813]
curr_Stock_Price:  103.67307879829688
curr_Factors:  [103.6730788   -1.02881611  -1.02616   ]
mat_Sqrt:  [[13.28009595  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0031126   0.04256518  0.02012373]
Stock Position:  -0.0031125973256176174
Bond Position:  [2.65221068]


portfolio before change:  [2.33489479]
curr_Stock_Price:  102.37184359810581
curr_Factors:  [102.3718436   -1.19639459  -1.01286243]
mat_Sqrt:  [[11.23860462  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00244615 -0.01586662 -0.12608409]
Stock Position:  0.0024461540474004736
Bond Position:  [2.08447749]


portfolio before change:  [2.33370437]
curr_Stock_Price:  101.4590166121639
curr_Factors:  [101.45901661  -1.43973819  -1.02392263]
mat_Sqrt:  [[ 8.63647164  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00627185 -0.01526544  0.07021669]
Stock Position:  0.006271845111616124
Bond Position:  [1.69736913]


portfolio before change:  [2.34204066]
curr_Stock_Price:  102.6528262884395
curr_Factors:  [102.65282629  -1.12526983  -1.01864087]
mat_Sqrt:  [[12.03046243  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00405864  0.00315478 -0.43402831]
Stock Position:  0.004058641141741657
Bond Position:  [1.92540967]


portfolio before change:  [2.35268808]
curr_Stock_Price:  105.03896409770161
curr_Factors:  [105.0389641   -0.80716113  -1.00614536]
mat_Sqrt:  [[17.13331603  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00883137 -0.00791828 -0.19311896]
Stock Position:  -0.008831365956403438
Bond Position:  [3.28032561]


portfolio before change:  [2.34662491]
curr_Stock_Price:  105.91127973007205
curr_Factors:  [105.91127973  -0.73845485  -1.02293206]
mat_Sqrt:  [[18.19623765  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 6.65731379e-05  1.63831202e-02 -3.38546038e-01]
Stock Position:  6.657313786678347e-05
Bond Position:  [2.33957407]


portfolio before change:  [2.3479565]
curr_Stock_Price:  108.33726653269187
curr_Factors:  [108.33726653  -0.78698496  -1.03372379]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [2.3479565]
Stock Price:  105.79502340790944
PL:  [-3.44706691]
Settle:  Tensor("sub_56:0", shape=(), dtype=float64)
PL:  Tensor("sub_57:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  29
output_Z_Vals[:, i, :]:  [[ 1.19279309e+02 -2.92921948e+01 -2.92556094e+01]
 [-7.04779654e-02 -1.14653620e-01 -1.72427800e-03]
 [ 2.39365458e-01  7.13594784e-02 -1.64930065e-01]
 [ 1.80453866e-01 -5.61219944e-02 -1.86356893e-01]
 [-8.59994541e-02  6.09159071e-02  1.25312190e-01]
 [ 4.14690470e-02 -6.37497388e-02  3.34510853e-02]
 [ 8.02074942e-02 -5.03163825e-03 -6.91231797e-02]
 [-1.70549403e-01 -7.89175419e-04 -6.42525804e-02]
 [-1.25938443e-01 -4.20865807e-02 -1.03525542e-01]
 [-6.15979062e-03 -3.37320193e-02  6.67037357e-03]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.27930914 -29.29219478 -29.25560936]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  8.31647217  -9.26300532 -83.45811031]
init_Out:  [2.54002979]
Stock Position:  8.316472170547405
Bond position:  [-829.10718727]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [0.49280193]
curr_Stock_Price:  99.8036943344323
curr_Factors:  [99.80369433 -1.29899836 -1.02501688]
mat_Sqrt:  [[ 9.76876414  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0075537  -0.03625666 -0.00491889]
Stock Position:  -0.007553696132579322
Bond Position:  [1.24668871]


portfolio before change:  [0.48778692]
curr_Stock_Price:  100.55015161385874
curr_Factors:  [100.55015161  -0.86524322  -1.06842021]
mat_Sqrt:  [[14.54130463  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01427257  0.02256585 -0.47049957]
Stock Position:  0.014272566892885197
Bond Position:  [-0.94732184]


portfolio before change:  [0.46446252]
curr_Stock_Price:  98.94913434403794
curr_Factors:  [98.94913434 -0.77596647 -1.04127097]
mat_Sqrt:  [[16.07665923  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00876829 -0.01774733 -0.53162434]
Stock Position:  0.008768293162825187
Bond Position:  [-0.4031525]


portfolio before change:  [0.47148094]
curr_Stock_Price:  99.77256113045436
curr_Factors:  [99.77256113 -0.69161289 -1.00224343]
mat_Sqrt:  [[18.3391273   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00320884  0.0192633   0.3574808 ]
Stock Position:  -0.0032088423558910297
Bond Position:  [0.79163536]


portfolio before change:  [0.4693093]
curr_Stock_Price:  100.5727089870992
curr_Factors:  [100.57270899  -0.73490309  -1.0486553 ]
mat_Sqrt:  [[16.90015083  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0027604  -0.02015944  0.09542664]
Stock Position:  0.002760401994904552
Bond Position:  [0.1916882]


portfolio before change:  [0.46773839]
curr_Stock_Price:  99.96888938701767
curr_Factors:  [99.96888939 -0.78519909 -1.01825447]
mat_Sqrt:  [[16.46777544  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00400588 -0.00159114 -0.19718919]
Stock Position:  0.004005876087147999
Bond Position:  [0.0672754]


portfolio before change:  [0.47184911]
curr_Stock_Price:  100.98666296843409
curr_Factors:  [100.98666297  -0.60094752  -1.04569181]
mat_Sqrt:  [[19.45976739  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00943923 -0.00024956 -0.18329473]
Stock Position:  -0.009439233189274662
Bond Position:  [1.42508577]


portfolio before change:  [0.48040434]
curr_Stock_Price:  100.15582112489038
curr_Factors:  [100.15582112  -0.77349158  -1.03427178]
mat_Sqrt:  [[16.42761604  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00901879 -0.01330895 -0.29532956]
Stock Position:  -0.009018787432132285
Bond Position:  [1.3836884]


portfolio before change:  [0.49583581]
curr_Stock_Price:  98.52151552588684
curr_Factors:  [98.52151553 -0.47551856 -0.97056247]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [0.49583581]
Stock Price:  100.42518453663168
PL:  [0.07065128]
Settle:  Tensor("sub_58:0", shape=(), dtype=float64)
PL:  Tensor("sub_59:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  30
output_Z_Vals[:, i, :]:  [[ 1.19279309e+02 -2.92921948e+01 -2.92556094e+01]
 [-7.04779654e-02 -1.14653620e-01 -1.72427800e-03]
 [ 2.72561133e-01  5.49572777e-02 -1.18430153e-01]
 [-6.33908744e-02  1.11178843e-01 -1.74603230e-01]
 [ 3.49450185e-02 -3.09420477e-02 -3.45624769e-02]
 [ 5.47685323e-02 -1.98830372e-03  2.02493129e-02]
 [ 7.45413569e-02  1.80122324e-02 -1.80183462e-01]
 [-2.14391669e-01  5.10309224e-02 -1.58828687e-01]
 [-4.33396829e-02  2.02374289e-02 -1.21901774e-01]
 [ 6.59443276e-02  3.39385604e-01 -1.90341696e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.27930914 -29.29219478 -29.25560936]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  8.31647217  -9.26300532 -83.45811031]
init_Out:  [2.54002979]
Stock Position:  8.316472170547405
Bond position:  [-829.10718727]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-0.71270346]
curr_Stock_Price:  99.6587403968595
curr_Factors:  [99.6587404  -1.33168449 -1.00375859]
mat_Sqrt:  [[ 9.64373688  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00765163 -0.03625666 -0.00491889]
Stock Position:  -0.0076516268288878255
Bond Position:  [0.04984804]


portfolio before change:  [-0.7250567]
curr_Stock_Price:  101.27645781042148
curr_Factors:  [101.27645781  -1.58416352  -1.02976162]
mat_Sqrt:  [[ 7.41814363  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.03367496  0.01737902 -0.33784826]
Stock Position:  0.03367495725184401
Bond Position:  [-4.13553708]


portfolio before change:  [-0.71886081]
curr_Stock_Price:  101.52186776542139
curr_Factors:  [101.52186777  -1.76129777  -1.01176854]
mat_Sqrt:  [[ 6.3420871   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01516236  0.03515784 -0.49809441]
Stock Position:  -0.015162356261308501
Bond Position:  [0.82044992]


portfolio before change:  [-0.72214538]
curr_Stock_Price:  101.76555636102898
curr_Factors:  [101.76555636  -1.43988309  -1.04269584]
mat_Sqrt:  [[ 8.5002262   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0031871  -0.00978473 -0.09859713]
Stock Position:  0.0031870989764512087
Bond Position:  [-1.04648228]


portfolio before change:  [-0.7211583]
curr_Stock_Price:  102.23948131581112
curr_Factors:  [102.23948132  -1.31601487  -0.99199497]
mat_Sqrt:  [[10.16863593  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00578746 -0.00062876  0.05776565]
Stock Position:  0.005787459462531468
Bond Position:  [-1.31286516]


portfolio before change:  [-0.71890507]
curr_Stock_Price:  102.742262670761
curr_Factors:  [102.74226267  -1.32338563  -0.9866681 ]
mat_Sqrt:  [[10.19777766  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00374853  0.00569597 -0.51401326]
Stock Position:  0.0037485260884716084
Bond Position:  [-1.10403713]


portfolio before change:  [-0.71690762]
curr_Stock_Price:  103.42242461257935
curr_Factors:  [103.42242461  -1.55815019  -1.00732706]
mat_Sqrt:  [[ 7.95137253  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.03087452  0.01613739 -0.45309403]
Stock Position:  -0.030874522063038718
Bond Position:  [2.47621031]


portfolio before change:  [-0.71754997]
curr_Stock_Price:  103.483340943111
curr_Factors:  [103.48334094  -0.73654493  -1.01659169]
mat_Sqrt:  [[17.92639159  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00377657  0.00639964 -0.34775183]
Stock Position:  -0.003776568740038624
Bond Position:  [-0.32673802]


portfolio before change:  [-0.71609958]
curr_Stock_Price:  103.05602191636483
curr_Factors:  [103.05602192  -1.04706502  -1.00802946]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-0.71609958]
Stock Price:  102.34136444158769
PL:  [-3.05746402]
Settle:  Tensor("sub_60:0", shape=(), dtype=float64)
PL:  Tensor("sub_61:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  31
output_Z_Vals[:, i, :]:  [[ 1.19279309e+02 -2.92921948e+01 -2.92556094e+01]
 [-5.52163452e-02 -1.66946517e-01 -1.12636773e-02]
 [ 1.16642489e+00  8.36088434e-02 -4.67623017e-01]
 [ 4.15064024e-01 -3.10583688e-01 -4.48691193e-02]
 [-1.99441708e-01  2.15361299e-01  2.98121154e-01]
 [ 1.42391025e-01  2.19325483e-01 -7.57122620e-02]
 [-2.47614936e-01 -1.22277884e-01  3.35214418e-01]
 [ 1.30079233e-01 -9.46456400e-02 -6.13380716e-02]
 [ 5.36471728e-02 -8.40581699e-02  1.12760601e-01]
 [-8.23096171e-03 -5.56314767e-02 -5.50504550e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.27930914 -29.29219478 -29.25560936]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  8.31647217  -9.26300532 -83.45811031]
init_Out:  [2.54002979]
Stock Position:  8.316472170547405
Bond position:  [-829.10718727]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-18.718753]
curr_Stock_Price:  97.4936337054451
curr_Factors:  [97.49363371 -1.3381834  -1.015655  ]
mat_Sqrt:  [[ 9.26226557  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00667505 -0.05279312 -0.03213214]
Stock Position:  -0.006675048755417714
Bond Position:  [-18.06797824]


portfolio before change:  [-18.71905208]
curr_Stock_Price:  96.18470432078131
curr_Factors:  [96.18470432 -0.99426213 -0.97823158]
mat_Sqrt:  [[13.38020845  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.08020283  0.02643944 -1.33399831]
Stock Position:  0.08020282501701737
Bond Position:  [-26.43333709]


portfolio before change:  [-18.78558111]
curr_Stock_Price:  95.52002631349902
curr_Factors:  [95.52002631 -0.85551554 -0.96855609]
mat_Sqrt:  [[15.41381683  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.02581359 -0.09821519 -0.12799911]
Stock Position:  0.025813588019357986
Bond Position:  [-21.25129572]


portfolio before change:  [-18.74023236]
curr_Stock_Price:  97.68853760633323
curr_Factors:  [97.68853761 -0.42288227 -1.01302607]
mat_Sqrt:  [[23.24002235  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00572406  0.06810322  0.85045667]
Stock Position:  -0.005724064107803709
Bond Position:  [-18.1810569]


portfolio before change:  [-18.72448059]
curr_Stock_Price:  93.34816629302645
curr_Factors:  [93.34816629 -1.05900915 -0.98788166]
mat_Sqrt:  [[12.05458901  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0109999   0.06935681 -0.21598601]
Stock Position:  0.010999900879275859
Bond Position:  [-19.75130117]


portfolio before change:  [-18.75806029]
curr_Stock_Price:  91.19345838852826
curr_Factors:  [91.19345839 -0.43735285 -0.94590849]
mat_Sqrt:  [[22.8676175   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00797402 -0.03866766  0.95627343]
Stock Position:  -0.007974017461341444
Bond Position:  [-18.03088206]


portfolio before change:  [-18.77217046]
curr_Stock_Price:  91.83209267626471
curr_Factors:  [91.83209268 -0.92831045 -0.9903217 ]
mat_Sqrt:  [[13.48165239  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00853864 -0.02992958 -0.17498044]
Stock Position:  0.008538635208443848
Bond Position:  [-19.5562912]


portfolio before change:  [-18.77900849]
curr_Stock_Price:  92.17670973362068
curr_Factors:  [92.17670973 -1.27434419 -0.93779403]
mat_Sqrt:  [[10.09024658  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00738277 -0.02658153  0.32167461]
Stock Position:  0.007382769182767262
Bond Position:  [-19.45952787]


portfolio before change:  [-18.78428219]
curr_Stock_Price:  92.78061552004874
curr_Factors:  [92.78061552 -1.24674735 -0.9700201 ]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-18.78428219]
Stock Price:  94.00560846539122
PL:  [-18.78428219]
Settle:  Tensor("sub_62:0", shape=(), dtype=float64)
PL:  Tensor("sub_63:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  32
output_Z_Vals[:, i, :]:  [[ 1.19279309e+02 -2.92921948e+01 -2.92556094e+01]
 [-6.74222411e-02 -8.78703161e-02  2.15079131e-02]
 [-1.17474466e-01 -3.02495514e-02  6.98649349e-02]
 [-5.69614043e-02  1.08203150e-01 -1.59186685e-01]
 [ 4.15463357e-02 -7.89462117e-02 -5.77747270e-02]
 [ 4.17152960e-02 -6.14284206e-02  3.32058741e-02]
 [ 7.67327770e-02  9.61943531e-03 -1.29530947e-01]
 [-1.32798458e-01 -4.35329926e-02  1.75354130e-02]
 [-1.18332580e-01 -5.14385053e-02 -9.08649643e-02]
 [-1.29924906e-02 -7.45376535e-02  4.79971414e-03]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.27930914 -29.29219478 -29.25560936]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  8.31647217  -9.26300532 -83.45811031]
init_Out:  [2.54002979]
Stock Position:  8.316472170547405
Bond position:  [-829.10718727]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [19.12419756]
curr_Stock_Price:  102.04399469780863
curr_Factors:  [102.0439947   -0.83433028  -1.04475544]
mat_Sqrt:  [[15.58514658  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00418994 -0.02778703  0.06135609]
Stock Position:  -0.004189935476215567
Bond Position:  [19.55175531]


portfolio before change:  [19.12937594]
curr_Stock_Price:  103.14184994585904
curr_Factors:  [103.14184995  -1.27561041  -1.10142044]
mat_Sqrt:  [[ 9.57422292  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01086191 -0.00956575  0.19930521]
Stock Position:  -0.010861913984352545
Bond Position:  [20.24969384]


portfolio before change:  [19.15520251]
curr_Stock_Price:  101.6965065140532
curr_Factors:  [101.69650651  -1.18300062  -1.10194889]
mat_Sqrt:  [[10.35058917  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00837261  0.03421684 -0.4541153 ]
Stock Position:  -0.00837261103081328
Bond Position:  [20.0066678]


portfolio before change:  [19.16352288]
curr_Stock_Price:  101.89781317876766
curr_Factors:  [101.89781318  -0.70577449  -1.10026692]
mat_Sqrt:  [[16.74214293  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00165539 -0.02496498 -0.16481521]
Stock Position:  0.0016553876409718788
Bond Position:  [18.9948425]


portfolio before change:  [19.17267887]
curr_Stock_Price:  101.6901241452494
curr_Factors:  [101.69012415  -1.09276216  -1.08872281]
mat_Sqrt:  [[11.47814986  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00408666 -0.01942537  0.09472712]
Stock Position:  0.004086663984604166
Bond Position:  [18.75710551]


portfolio before change:  [19.18048657]
curr_Stock_Price:  101.3051641325569
curr_Factors:  [101.30516413  -1.00294056  -1.02179424]
mat_Sqrt:  [[13.37520468  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00377869  0.00304193 -0.36951574]
Stock Position:  0.0037786902758864442
Bond Position:  [18.79768573]


portfolio before change:  [19.18473013]
curr_Stock_Price:  99.94023742422563
curr_Factors:  [99.94023742 -1.42441536 -0.99546831]
mat_Sqrt:  [[ 8.8878814   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01466526 -0.01376634  0.05002365]
Stock Position:  -0.014665257953064668
Bond Position:  [20.65037949]


portfolio before change:  [19.19459838]
curr_Stock_Price:  99.97157150632378
curr_Factors:  [99.97157151 -1.08251052 -1.02797312]
mat_Sqrt:  [[12.11448956  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01140852 -0.01626628 -0.25921245]
Stock Position:  -0.011408524353835292
Bond Position:  [20.33512649]


portfolio before change:  [19.22207281]
curr_Stock_Price:  98.45478189365328
curr_Factors:  [98.45478189 -0.9734878  -0.99535233]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [19.22207281]
Stock Price:  97.47353469320554
PL:  [19.22207281]
Settle:  Tensor("sub_64:0", shape=(), dtype=float64)
PL:  Tensor("sub_65:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  33
output_Z_Vals[:, i, :]:  [[ 1.19279309e+02 -2.92921948e+01 -2.92556094e+01]
 [-6.90340246e-02 -1.01997535e-01  9.25377701e-03]
 [ 7.47808802e-01  7.78476978e-02 -3.32670659e-01]
 [-6.22589434e-02  1.07454870e-01 -1.86233779e-01]
 [ 1.50323114e-02 -4.29361985e-02 -1.73513561e-02]
 [ 5.81064078e-02 -2.29960158e-02  1.69598762e-02]
 [ 7.76063140e-02  4.17099023e-03 -1.40500762e-01]
 [ 3.15025769e-02 -1.05784626e-01  2.58117062e-02]
 [ 5.14684724e-02 -9.07534284e-02  3.86083719e-02]
 [-1.41226734e-02 -9.13933649e-02 -1.73967970e-03]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.27930914 -29.29219478 -29.25560936]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  8.31647217  -9.26300532 -83.45811031]
init_Out:  [2.54002979]
Stock Position:  8.316472170547405
Bond position:  [-829.10718727]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-1.52964503]
curr_Stock_Price:  99.5605086519757
curr_Factors:  [99.56050865 -0.97529249 -0.97864542]
mat_Sqrt:  [[14.10920854  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00494561 -0.03225445  0.02639845]
Stock Position:  -0.004945611944889676
Bond Position:  [-1.03725739]


portfolio before change:  [-1.52095583]
curr_Stock_Price:  97.69866491715253
curr_Factors:  [97.69866492 -0.46324832 -1.02531577]
mat_Sqrt:  [[22.05024717  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0309254   0.0246176  -0.94901679]
Stock Position:  0.030925399709270735
Bond Position:  [-4.54232609]


portfolio before change:  [-1.42778145]
curr_Stock_Price:  100.78499884655812
curr_Factors:  [100.78499885  -0.48802756  -1.03288952]
mat_Sqrt:  [[22.02267138  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00442722  0.03398021 -0.53127313]
Stock Position:  -0.004427223189906714
Bond Position:  [-0.98158377]


portfolio before change:  [-1.43086488]
curr_Stock_Price:  101.37058313790048
curr_Factors:  [101.37058314  -0.93899796  -1.03560444]
mat_Sqrt:  [[14.07190906  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00073777 -0.01357762 -0.04949859]
Stock Position:  0.0007377728713709575
Bond Position:  [-1.50565334]


portfolio before change:  [-1.43300025]
curr_Stock_Price:  99.49689838945292
curr_Factors:  [99.49689839 -1.21859289 -1.01752061]
mat_Sqrt:  [[10.63353802  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00573418 -0.00727198  0.04838181]
Stock Position:  0.005734175522040549
Bond Position:  [-2.00353293]


portfolio before change:  [-1.43752451]
curr_Stock_Price:  98.88264324704122
curr_Factors:  [98.88264325 -1.09170541 -1.07387191]
mat_Sqrt:  [[11.340228    0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00432394  0.00131898 -0.40080956]
Stock Position:  0.004323935165484172
Bond Position:  [-1.86508665]


portfolio before change:  [-1.44797215]
curr_Stock_Price:  96.68213247781699
curr_Factors:  [96.68213248 -1.42858383 -1.12035161]
mat_Sqrt:  [[ 7.55714273  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00450435 -0.03345204  0.07363361]
Stock Position:  0.004504350823778422
Bond Position:  [-1.8834624]


portfolio before change:  [-1.44795601]
curr_Stock_Price:  96.8948390312051
curr_Factors:  [96.89483903 -1.07182268 -1.08605151]
mat_Sqrt:  [[11.19818905  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00509066 -0.02869875  0.11013894]
Stock Position:  0.005090656142703004
Bond Position:  [-1.94121432]


portfolio before change:  [-1.44986722]
curr_Stock_Price:  96.71011735599262
curr_Factors:  [96.71011736 -1.02541426 -1.12062299]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-1.44986722]
Stock Price:  97.33487865587864
PL:  [-1.44986722]
Settle:  Tensor("sub_66:0", shape=(), dtype=float64)
PL:  Tensor("sub_67:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  34
output_Z_Vals[:, i, :]:  [[ 1.19279309e+02 -2.92921948e+01 -2.92556094e+01]
 [-7.04779654e-02 -1.14653620e-01 -1.72427800e-03]
 [ 3.77607316e-01  6.68641599e-02 -2.57621378e-01]
 [-6.14468475e-02  1.01413676e-01 -2.20645653e-01]
 [-3.65537300e-02  1.19201503e-02  5.61685764e-02]
 [ 5.20241474e-02 -4.29171208e-02  2.29919966e-02]
 [ 7.53336730e-02  1.61651762e-02 -1.44275397e-01]
 [-6.18180500e-02 -9.06983863e-02  8.86864696e-02]
 [-1.22600072e-01 -4.23501500e-02 -1.02037195e-01]
 [ 3.40516728e-02  1.83329809e-01 -1.31709931e-04]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.27930914 -29.29219478 -29.25560936]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  8.31647217  -9.26300532 -83.45811031]
init_Out:  [2.54002979]
Stock Position:  8.316472170547405
Bond position:  [-829.10718727]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-8.32156547]
curr_Stock_Price:  98.74382577274496
curr_Factors:  [98.74382577 -1.07426775 -0.975005  ]
mat_Sqrt:  [[12.7210249   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00580065 -0.03625666 -0.00491889]
Stock Position:  -0.005800654934938199
Bond Position:  [-7.74878661]


portfolio before change:  [-8.33411267]
curr_Stock_Price:  100.23880304586946
curr_Factors:  [100.23880305  -1.35957271  -0.95887562]
mat_Sqrt:  [[ 9.86612366  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.03311807  0.0211443  -0.73492208]
Stock Position:  0.033118072437031125
Bond Position:  [-11.65382862]


portfolio before change:  [-8.32364932]
curr_Stock_Price:  100.73073147969241
curr_Factors:  [100.73073148  -1.14809402  -0.94770323]
mat_Sqrt:  [[12.38707611  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00838515  0.03206982 -0.62944063]
Stock Position:  -0.008385147726535378
Bond Position:  [-7.47900726]


portfolio before change:  [-8.32440829]
curr_Stock_Price:  100.37516570793379
curr_Factors:  [100.37516571  -1.16644254  -0.95430088]
mat_Sqrt:  [[12.03924115  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00205832  0.00376948  0.16023331]
Stock Position:  -0.0020583182986675845
Bond Position:  [-8.11780425]


portfolio before change:  [-8.32700002]
curr_Stock_Price:  99.66187170214927
curr_Factors:  [99.6618717  -1.11657566 -0.95465922]
mat_Sqrt:  [[12.56039101  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00442735 -0.01357159  0.06558977]
Stock Position:  0.00442735052977465
Bond Position:  [-8.76823806]


portfolio before change:  [-8.32987922]
curr_Stock_Price:  100.00203514758994
curr_Factors:  [100.00203515  -0.97282315  -0.96222666]
mat_Sqrt:  [[14.44200152  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00320599  0.00511188 -0.41157755]
Stock Position:  0.003205993561100691
Bond Position:  [-8.6504851]


portfolio before change:  [-8.33770206]
curr_Stock_Price:  98.91141363012652
curr_Factors:  [98.91141363 -1.01595338 -0.98563316]
mat_Sqrt:  [[13.36498316  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00344608 -0.02868135  0.25299781]
Stock Position:  -0.0034460815938606444
Bond Position:  [-7.99684526]


portfolio before change:  [-8.34708179]
curr_Stock_Price:  100.47269553204737
curr_Factors:  [100.47269553  -0.95239453  -1.03110476]
mat_Sqrt:  [[13.82373053  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01045462 -0.01339229 -0.29108372]
Stock Position:  -0.010454616635154736
Bond Position:  [-7.29667828]


portfolio before change:  [-8.36121505]
curr_Stock_Price:  101.4755066128898
curr_Factors:  [101.47550661  -1.09569841  -1.02769596]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-8.36121505]
Stock Price:  100.38811448999894
PL:  [-8.74932954]
Settle:  Tensor("sub_68:0", shape=(), dtype=float64)
PL:  Tensor("sub_69:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  35
output_Z_Vals[:, i, :]:  [[ 1.19279309e+02 -2.92921948e+01 -2.92556094e+01]
 [-4.91079662e-02  7.26535885e-02  1.60748467e-01]
 [ 2.29496539e-01  6.82798891e-02 -1.83891868e-01]
 [-6.19468072e-02  1.07498959e-01 -1.84640137e-01]
 [-2.07815505e-02 -2.25421092e-02  2.77259188e-02]
 [ 5.81999701e-02 -2.26895730e-02  1.68670852e-02]
 [ 7.55901796e-02  1.30283450e-02 -1.70270616e-01]
 [-2.54556563e-02 -1.04494095e-01  8.95396860e-02]
 [-4.75034003e-02 -7.38359614e-02 -3.27217569e-02]
 [-1.41795126e-02 -9.16181934e-02 -1.69154031e-03]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.27930914 -29.29219478 -29.25560936]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  8.31647217  -9.26300532 -83.45811031]
init_Out:  [2.54002979]
Stock Position:  8.316472170547405
Bond position:  [-829.10718727]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-7.45105406]
curr_Stock_Price:  98.84849893046194
curr_Factors:  [98.84849893 -0.64645227 -1.0444346 ]
mat_Sqrt:  [[18.22330922  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00079126  0.02297508  0.45857063]
Stock Position:  -0.0007912621657528166
Bond Position:  [-7.37283898]


portfolio before change:  [-7.45569459]
curr_Stock_Price:  100.05314218097082
curr_Factors:  [100.05314218  -0.354841    -1.05322766]
mat_Sqrt:  [[24.47452552  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00791528  0.021592   -0.52459231]
Stock Position:  0.007915281024102931
Bond Position:  [-8.24764333]


portfolio before change:  [-7.45178636]
curr_Stock_Price:  101.06802491140081
curr_Factors:  [101.06802491  -0.85600947  -1.04952835]
mat_Sqrt:  [[15.03312328  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00644315  0.03399416 -0.52672692]
Stock Position:  -0.0064431525200414255
Bond Position:  [-6.80058966]


portfolio before change:  [-7.45310257]
curr_Stock_Price:  100.7444346810919
curr_Factors:  [100.74443468  -0.82474998  -1.14529699]
mat_Sqrt:  [[14.04884227  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00111782 -0.00712844  0.07909433]
Stock Position:  -0.00111781850047319
Bond Position:  [-7.34048857]


portfolio before change:  [-7.45519609]
curr_Stock_Price:  99.33308003212868
curr_Factors:  [99.33308003 -1.3143666  -1.20598368]
mat_Sqrt:  [[ 7.98950158  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00764217 -0.00717507  0.0481171 ]
Stock Position:  0.007642167228897491
Bond Position:  [-8.2143161]


portfolio before change:  [-7.45610307]
curr_Stock_Price:  99.75196671996072
curr_Factors:  [99.75196672 -1.06004465 -1.20358941]
mat_Sqrt:  [[10.37140713  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00396959  0.00411992 -0.48573467]
Stock Position:  0.003969589233979934
Bond Position:  [-7.85207741]


portfolio before change:  [-7.46678972]
curr_Stock_Price:  98.04911336869138
curr_Factors:  [98.04911337 -1.33781615 -1.14869564]
mat_Sqrt:  [[ 8.15765476  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0012107  -0.03304393  0.2554318 ]
Stock Position:  -0.0012106997223320735
Bond Position:  [-7.34808169]


portfolio before change:  [-7.47137084]
curr_Stock_Price:  98.79757168091326
curr_Factors:  [98.79757168 -1.34081542 -1.19285244]
mat_Sqrt:  [[ 7.84130417  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00715304 -0.02334898 -0.09334606]
Stock Position:  -0.007153036796204047
Bond Position:  [-6.76466817]


portfolio before change:  [-7.45992119]
curr_Stock_Price:  96.72393060317896
curr_Factors:  [96.7239306  -1.04808236 -1.09794977]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-7.45992119]
Stock Price:  94.62193006948849
PL:  [-7.45992119]
Settle:  Tensor("sub_70:0", shape=(), dtype=float64)
PL:  Tensor("sub_71:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  36
output_Z_Vals[:, i, :]:  [[ 1.19279309e+02 -2.92921948e+01 -2.92556094e+01]
 [-7.04779654e-02 -1.14653620e-01 -1.72427800e-03]
 [ 1.96265233e-01  6.17021868e-02 -1.00673310e-01]
 [ 2.87136164e-01 -1.24141445e-01 -1.62112423e-01]
 [-2.23765866e-01  2.48913845e-01  3.35321139e-01]
 [ 1.21177178e-01  1.61717951e-01 -5.14764983e-02]
 [ 8.73464367e-02 -2.80371258e-02  1.60129511e-01]
 [ 1.25691959e-01 -1.04479110e-01 -7.36197298e-02]
 [ 1.28330810e-01 -9.15064923e-02  8.54636783e-02]
 [-1.26461199e-02 -8.55528367e-02 -2.99023063e-03]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.27930914 -29.29219478 -29.25560936]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  8.31647217  -9.26300532 -83.45811031]
init_Out:  [2.54002979]
Stock Position:  8.316472170547405
Bond position:  [-829.10718727]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [3.5258939]
curr_Stock_Price:  100.16840330083542
curr_Factors:  [100.1684033   -1.0662795   -0.96646369]
mat_Sqrt:  [[13.11963044  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00562442 -0.03625666 -0.00491889]
Stock Position:  -0.005624417260504777
Bond Position:  [4.0892828]


portfolio before change:  [3.52380229]
curr_Stock_Price:  100.90390355553302
curr_Factors:  [100.90390356  -0.81376549  -0.91873594]
mat_Sqrt:  [[17.84399754  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00993659  0.01951194 -0.28719293]
Stock Position:  0.00993659197684165
Bond Position:  [2.52116138]


portfolio before change:  [3.49364009]
curr_Stock_Price:  97.74154182951372
curr_Factors:  [97.74154183 -0.71620547 -0.88139806]
mat_Sqrt:  [[19.7810248   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01268083 -0.03925697 -0.46246162]
Stock Position:  0.012680828630936144
Bond Position:  [2.25419635]


portfolio before change:  [3.47977118]
curr_Stock_Price:  96.5589464478971
curr_Factors:  [96.55894645 -1.04095005 -0.8784078 ]
mat_Sqrt:  [[14.16530717  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01051102  0.07871347  0.95657788]
Stock Position:  -0.010511017875086874
Bond Position:  [4.49470399]


portfolio before change:  [3.50580251]
curr_Stock_Price:  94.29623327387087
curr_Factors:  [94.29623327 -1.09811805 -0.89294826]
mat_Sqrt:  [[12.87612646  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00891923  0.05113971 -0.14684812]
Stock Position:  0.008919229068741596
Bond Position:  [2.66475281]


portfolio before change:  [3.49102525]
curr_Stock_Price:  92.49002659018684
curr_Factors:  [92.49002659 -1.21640151 -0.87269825]
mat_Sqrt:  [[11.45012972  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01041987 -0.00886612  0.45680492]
Stock Position:  0.010419866306924177
Bond Position:  [2.52729154]


portfolio before change:  [3.50896409]
curr_Stock_Price:  94.09032315188259
curr_Factors:  [94.09032315 -1.10529778 -0.9218019 ]
mat_Sqrt:  [[12.39329399  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00871171 -0.0330392  -0.2100166 ]
Stock Position:  0.008711707787771064
Bond Position:  [2.68927669]


portfolio before change:  [3.50847241]
curr_Stock_Price:  93.87949750594576
curr_Factors:  [93.87949751 -1.08529317 -0.85509461]
mat_Sqrt:  [[13.48562407  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01063453 -0.02893689  0.24380409]
Stock Position:  0.010634533672397714
Bond Position:  [2.51010774]


portfolio before change:  [3.52983516]
curr_Stock_Price:  95.77026026690963
curr_Factors:  [95.77026027 -1.02231899 -0.88805244]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [3.52983516]
Stock Price:  96.27247266406627
PL:  [3.52983516]
Settle:  Tensor("sub_72:0", shape=(), dtype=float64)
PL:  Tensor("sub_73:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  37
output_Z_Vals[:, i, :]:  [[ 1.19279309e+02 -2.92921948e+01 -2.92556094e+01]
 [-7.04779654e-02 -1.14653620e-01 -1.72427800e-03]
 [ 3.48517217e-01  6.83938083e-02 -2.33725766e-01]
 [ 2.99596353e-02  3.98639193e-02 -2.20354686e-01]
 [-4.21288601e-02  1.56088580e-02  6.33594297e-02]
 [ 4.28531778e-02 -5.91043051e-02  3.20782914e-02]
 [ 8.73464367e-02 -2.80371258e-02  1.60129511e-01]
 [-5.37140176e-02 -9.43464075e-02  9.24872903e-02]
 [-9.86107178e-02 -4.91649593e-02 -8.05434813e-02]
 [-1.29981365e-02 -8.69452433e-02 -2.69209400e-03]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.27930914 -29.29219478 -29.25560936]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  8.31647217  -9.26300532 -83.45811031]
init_Out:  [2.54002979]
Stock Position:  8.316472170547405
Bond position:  [-829.10718727]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-1.88636096]
curr_Stock_Price:  99.5176159538678
curr_Factors:  [99.51761595 -1.0436652  -0.94365631]
mat_Sqrt:  [[13.64008882  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00540981 -0.03625666 -0.00491889]
Stock Position:  -0.005409809044986643
Bond Position:  [-1.34798966]


portfolio before change:  [-1.8894524]
curr_Stock_Price:  99.96444820980012
curr_Factors:  [99.96444821 -0.88826423 -0.9854503 ]
mat_Sqrt:  [[15.34976354  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01971197  0.02162802 -0.66675455]
Stock Position:  0.019711969176057862
Bond Position:  [-3.85994852]


portfolio before change:  [-1.89045174]
curr_Stock_Price:  100.01168428928645
curr_Factors:  [100.01168429  -0.75564353  -0.98842661]
mat_Sqrt:  [[17.48278857  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00080026  0.01260608 -0.62861059]
Stock Position:  -0.0008002610499355917
Bond Position:  [-1.81041628]


portfolio before change:  [-1.89157315]
curr_Stock_Price:  100.2815619658987
curr_Factors:  [100.28156197  -1.12197162  -0.93497861]
mat_Sqrt:  [[12.82032268  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00224586  0.00493595  0.18074682]
Stock Position:  -0.0022458601383060998
Bond Position:  [-1.66635478]


portfolio before change:  [-1.89154416]
curr_Stock_Price:  99.89757719294492
curr_Factors:  [99.89757719 -0.84662899 -0.92045682]
mat_Sqrt:  [[17.06551265  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00280537 -0.01869042  0.09151044]
Stock Position:  0.0028053692866796148
Bond Position:  [-2.17179375]


portfolio before change:  [-1.89475044]
curr_Stock_Price:  99.14184349496928
curr_Factors:  [99.14184349 -0.46358343 -0.90915839]
mat_Sqrt:  [[25.12365348  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00474886 -0.00886612  0.45680492]
Stock Position:  0.004748864289900333
Bond Position:  [-2.3655616]


portfolio before change:  [-1.8973214]
curr_Stock_Price:  98.84958642774437
curr_Factors:  [98.84958643 -1.00614335 -0.88656197]
mat_Sqrt:  [[14.89304088  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00250259 -0.02983495  0.2638405 ]
Stock Position:  -0.002502587789694433
Bond Position:  [-1.64994163]


portfolio before change:  [-1.89869082]
curr_Stock_Price:  99.06705869463748
curr_Factors:  [99.06705869 -0.34753752 -0.91996691]
mat_Sqrt:  [[27.89067904  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00417061 -0.01554733 -0.22976813]
Stock Position:  -0.004170605552865551
Bond Position:  [-1.4855212]


portfolio before change:  [-1.88620699]
curr_Stock_Price:  95.89562890428037
curr_Factors:  [95.8956289  -0.82929621 -0.92116849]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-1.88620699]
Stock Price:  97.94292650104315
PL:  [-1.88620699]
Settle:  Tensor("sub_74:0", shape=(), dtype=float64)
PL:  Tensor("sub_75:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  38
output_Z_Vals[:, i, :]:  [[ 1.19279309e+02 -2.92921948e+01 -2.92556094e+01]
 [-7.04779654e-02 -1.14653620e-01 -1.72427800e-03]
 [ 3.65229622e-01  6.80539107e-02 -2.43400308e-01]
 [ 9.32750636e-02 -8.55345650e-04 -2.08158281e-01]
 [ 3.66048369e-02 -5.14338793e-02 -4.33792054e-02]
 [ 1.06389273e-01  2.36970818e-01 -3.09916643e-02]
 [ 8.54318460e-02  5.70752970e-03 -1.48995350e-01]
 [-1.82153220e-01  1.94058285e-02 -1.20942000e-01]
 [ 2.52712018e-02  4.43950603e-02 -1.09886950e-01]
 [ 7.06906483e-02  3.79660309e-01 -8.66285429e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.27930914 -29.29219478 -29.25560936]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  8.31647217  -9.26300532 -83.45811031]
init_Out:  [2.54002979]
Stock Position:  8.316472170547405
Bond position:  [-829.10718727]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-11.29692244]
curr_Stock_Price:  98.38605905238656
curr_Factors:  [98.38605905 -1.20927547 -0.96845116]
mat_Sqrt:  [[11.14702323  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00661973 -0.03625666 -0.00491889]
Stock Position:  -0.006619729261490931
Bond Position:  [-10.64563336]


portfolio before change:  [-11.31309677]
curr_Stock_Price:  100.02512607829092
curr_Factors:  [100.02512608  -1.0462152   -0.96894673]
mat_Sqrt:  [[13.33323103  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0237979   0.02152054 -0.69435333]
Stock Position:  0.023797899069882625
Bond Position:  [-13.69348462]


portfolio before change:  [-11.33044607]
curr_Stock_Price:  99.58387494157175
curr_Factors:  [99.58387494 -0.75813445 -0.97620338]
mat_Sqrt:  [[17.57825139  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 2.88782123e-03 -2.70484044e-04 -5.93817634e-01]
Stock Position:  0.0028878212309891163
Bond Position:  [-11.6180265]


portfolio before change:  [-11.32759785]
curr_Stock_Price:  102.582220727416
curr_Factors:  [102.58222073  -1.15515996  -0.97959326]
mat_Sqrt:  [[12.13278643  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00217774 -0.01626482 -0.1237488 ]
Stock Position:  0.002177741833673043
Bond Position:  [-11.55099544]


portfolio before change:  [-11.329235]
curr_Stock_Price:  104.48317580898714
curr_Factors:  [104.48317581  -1.5445217   -0.96789846]
mat_Sqrt:  [[ 8.47063862  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01253526  0.07493675 -0.08841059]
Stock Position:  0.012535263346800309
Bond Position:  [-12.63895913]


portfolio before change:  [-11.33811828]
curr_Stock_Price:  104.2787747026194
curr_Factors:  [104.2787747   -1.13920454  -0.94938177]
mat_Sqrt:  [[12.91618953  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00427105  0.00180488 -0.42504226]
Stock Position:  0.0042710479888023335
Bond Position:  [-11.78349793]


portfolio before change:  [-11.3435591]
curr_Stock_Price:  104.38469776928834
curr_Factors:  [104.38469777  -1.07302528  -0.9651778 ]
mat_Sqrt:  [[13.59741929  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01517489  0.00613666 -0.34501386]
Stock Position:  -0.015174890319680313
Bond Position:  [-9.75953276]


portfolio before change:  [-11.36075113]
curr_Stock_Price:  105.1959747700516
curr_Factors:  [105.19597477  -1.33764645  -0.9383187 ]
mat_Sqrt:  [[10.8033891   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00036904  0.01403895 -0.31347688]
Stock Position:  0.000369041370739823
Bond Position:  [-11.3995728]


portfolio before change:  [-11.36639093]
curr_Stock_Price:  105.36239352546903
curr_Factors:  [105.36239353  -0.76265042  -0.98523672]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-11.36639093]
Stock Price:  109.70832416014818
PL:  [-21.07471509]
Settle:  Tensor("sub_76:0", shape=(), dtype=float64)
PL:  Tensor("sub_77:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  39
output_Z_Vals[:, i, :]:  [[ 1.19279309e+02 -2.92921948e+01 -2.92556094e+01]
 [-8.03932326e-03  2.04078412e-01  2.91201621e-01]
 [ 7.25077032e-01  7.67023175e-02 -3.31604877e-01]
 [ 3.40907243e-01 -2.02247323e-01 -1.19196386e-01]
 [-1.07479136e-01  9.09840063e-02  1.58310832e-01]
 [ 5.68980159e-02 -2.69538372e-02  1.81583065e-02]
 [ 8.73464367e-02 -2.80371258e-02  1.60129511e-01]
 [ 1.27135256e-01 -1.01244158e-01 -6.95793892e-02]
 [ 1.36549241e-01 -9.15870129e-02  9.04736363e-02]
 [-8.81425198e-03 -6.42383898e-02 -3.01201037e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.27930914 -29.29219478 -29.25560936]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  8.31647217  -9.26300532 -83.45811031]
init_Out:  [2.54002979]
Stock Position:  8.316472170547405
Bond position:  [-829.10718727]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-21.01794581]
curr_Stock_Price:  97.2171711911689
curr_Factors:  [97.21717119 -0.35678506 -0.96715321]
mat_Sqrt:  [[25.86806205  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00219078 0.06453526 0.83071717]
Stock Position:  0.0021907802996209403
Bond Position:  [-21.23092727]


portfolio before change:  [-21.02688737]
curr_Stock_Price:  97.98244951685179
curr_Factors:  [97.98244952 -0.65728587 -0.98541024]
mat_Sqrt:  [[18.95546472  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.03478516  0.0242554  -0.94597641]
Stock Position:  0.034785162221200344
Bond Position:  [-24.43522277]


portfolio before change:  [-21.06202855]
curr_Stock_Price:  97.32353315490138
curr_Factors:  [97.32353315 -1.1643157  -0.99752237]
mat_Sqrt:  [[11.20323698  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.02779147 -0.06395622 -0.34003411]
Stock Position:  0.027791466012429083
Bond Position:  [-23.76679221]


portfolio before change:  [-21.04166123]
curr_Stock_Price:  98.48409387367221
curr_Factors:  [98.48409387 -1.50814762 -1.05036757]
mat_Sqrt:  [[ 7.62459997  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00954999  0.02877167  0.45161674]
Stock Position:  -0.009549992902001836
Bond Position:  [-20.10113883]


portfolio before change:  [-21.0581487]
curr_Stock_Price:  99.15785195295989
curr_Factors:  [99.15785195 -1.15781225 -1.03907654]
mat_Sqrt:  [[11.02123927  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00543574 -0.00852355  0.05180059]
Stock Position:  0.0054357425868744825
Bond Position:  [-21.59714526]


portfolio before change:  [-21.07458429]
curr_Stock_Price:  98.12132103402946
curr_Factors:  [98.12132103 -0.73885832 -0.99572022]
mat_Sqrt:  [[17.31591703  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00689012 -0.00886612  0.45680492]
Stock Position:  0.006890124307186414
Bond Position:  [-21.75065239]


portfolio before change:  [-21.1177823]
curr_Stock_Price:  93.43055426305908
curr_Factors:  [93.43055426 -0.78370876 -0.93407962]
mat_Sqrt:  [[16.7672913   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00657938 -0.03201621 -0.19849063]
Stock Position:  0.00657937575957298
Bond Position:  [-21.73249702]


portfolio before change:  [-21.11788894]
curr_Stock_Price:  95.06632078109953
curr_Factors:  [95.06632078 -0.50333681 -0.9153082 ]
mat_Sqrt:  [[23.01001949  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00663417 -0.02896236  0.2580961 ]
Stock Position:  0.006634167707467125
Bond Position:  [-21.74857486]


portfolio before change:  [-21.14218749]
curr_Stock_Price:  93.0432272319883
curr_Factors:  [93.04322723 -0.12526537 -0.86877134]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-21.14218749]
Stock Price:  93.9720303241687
PL:  [-21.14218749]
Settle:  Tensor("sub_78:0", shape=(), dtype=float64)
PL:  Tensor("sub_79:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  40
output_Z_Vals[:, i, :]:  [[ 1.19279309e+02 -2.92921948e+01 -2.92556094e+01]
 [-5.62058447e-02  1.04409607e-02  1.06784413e-01]
 [-7.22317302e-02 -4.59776346e-02  6.16977010e-02]
 [-5.07767276e-02  1.44016073e-01  2.90083633e-02]
 [ 3.55082739e-02 -7.58720161e-02 -5.05680880e-02]
 [ 1.08277320e-01  2.46822883e-01 -3.28665499e-02]
 [ 9.09124695e-02  8.80685286e-04 -1.38327963e-01]
 [-2.04093428e-01  4.09286112e-02 -1.46726174e-01]
 [-1.31677526e-01 -3.32487951e-02 -1.15104292e-01]
 [ 5.19521452e-02  2.69010490e-01 -1.10823075e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.27930914 -29.29219478 -29.25560936]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  8.31647217  -9.26300532 -83.45811031]
init_Out:  [2.54002979]
Stock Position:  8.316472170547405
Bond position:  [-829.10718727]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [3.66117275]
curr_Stock_Price:  100.1846696747559
curr_Factors:  [100.18466967  -0.59436041  -0.99976971]
mat_Sqrt:  [[20.3460147   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00167792  0.00330172  0.30462621]
Stock Position:  -0.0016779199166881622
Bond Position:  [3.8292746]


portfolio before change:  [3.65449265]
curr_Stock_Price:  105.30721373837548
curr_Factors:  [105.30721374  -0.9201557   -1.04732224]
mat_Sqrt:  [[14.72289834  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00413131 -0.0145394   0.17600637]
Stock Position:  -0.004131311358642649
Bond Position:  [4.08954953]


portfolio before change:  [3.66141361]
curr_Stock_Price:  104.12703746145152
curr_Factors:  [104.12703746  -1.54572762  -1.08065183]
mat_Sqrt:  [[ 7.53253934  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00546123  0.04554188  0.08275279]
Stock Position:  -0.005461231508704827
Bond Position:  [4.23007546]


portfolio before change:  [3.66874253]
curr_Stock_Price:  103.17242528110718
curr_Factors:  [103.17242528  -1.00791333  -1.07760574]
mat_Sqrt:  [[12.81841175  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00181201 -0.02399284 -0.14425668]
Stock Position:  0.0018120106928883398
Bond Position:  [3.48179299]


portfolio before change:  [3.67342149]
curr_Stock_Price:  104.79362239640353
curr_Factors:  [104.7936224   -0.52364142  -1.11128891]
mat_Sqrt:  [[20.4311885   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00528317  0.07805225 -0.09375912]
Stock Position:  0.005283168068719508
Bond Position:  [3.11977917]


portfolio before change:  [3.65562622]
curr_Stock_Price:  101.12999712323128
curr_Factors:  [101.12999712  -0.71823495  -1.1401758 ]
mat_Sqrt:  [[15.76821238  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 3.97629927e-03  2.78497140e-04 -3.94611176e-01]
Stock Position:  0.003976299271717849
Bond Position:  [3.25350309]


portfolio before change:  [3.66535516]
curr_Stock_Price:  103.16751573357544
curr_Factors:  [103.16751573  -0.77307031  -1.13499351]
mat_Sqrt:  [[15.30669346  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01522125  0.01294276 -0.41856893]
Stock Position:  -0.015221250197496901
Bond Position:  [5.23569373]


portfolio before change:  [3.71429328]
curr_Stock_Price:  100.12442720452376
curr_Factors:  [100.1244272   -0.49152187  -1.08065515]
mat_Sqrt:  [[20.78510591  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00750689 -0.01051419 -0.32836051]
Stock Position:  -0.007506893278847297
Bond Position:  [4.46591667]


portfolio before change:  [3.7024004]
curr_Stock_Price:  102.00621675412056
curr_Factors:  [102.00621675  -0.88333475  -1.0785148 ]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [3.7024004]
Stock Price:  102.63470522784316
PL:  [1.06769517]
Settle:  Tensor("sub_80:0", shape=(), dtype=float64)
PL:  Tensor("sub_81:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  41
output_Z_Vals[:, i, :]:  [[ 1.19279309e+02 -2.92921948e+01 -2.92556094e+01]
 [-5.14922925e-02  5.17550614e-02  1.42620809e-01]
 [ 2.13830450e-01  6.42604082e-02 -1.24828684e-01]
 [-6.63742903e-02  1.06873576e-01 -2.07245076e-01]
 [-8.73889414e-02  6.30902037e-02  1.27524540e-01]
 [ 4.50711836e-02 -6.56900237e-02  2.98876427e-02]
 [ 7.30412705e-02  2.45568741e-02 -2.03009024e-01]
 [-1.75786113e-01  5.14013318e-03 -7.55979932e-02]
 [-1.29660579e-01 -1.69176951e-02 -1.31119794e-01]
 [ 4.76640948e-02  2.55790884e-01 -2.81383923e-03]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.27930914 -29.29219478 -29.25560936]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  8.31647217  -9.26300532 -83.45811031]
init_Out:  [2.54002979]
Stock Position:  8.316472170547405
Bond position:  [-829.10718727]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-1.157037]
curr_Stock_Price:  99.60531226829877
curr_Factors:  [99.60531227 -0.55132324 -0.99422752]
mat_Sqrt:  [[21.23529679  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00099097  0.01636639  0.40685747]
Stock Position:  -0.0009909742285237034
Bond Position:  [-1.0583307]


portfolio before change:  [-1.1587443]
curr_Stock_Price:  100.7940447667331
curr_Factors:  [100.79404477  -0.86525302  -1.01845841]
mat_Sqrt:  [[15.3231973   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01240009  0.02032093 -0.35610149]
Stock Position:  0.01240009475540621
Bond Position:  [-2.40860001]


portfolio before change:  [-1.15972351]
curr_Stock_Price:  100.81222165905221
curr_Factors:  [100.81222166  -0.98816721  -1.01293975]
mat_Sqrt:  [[13.62835613  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00777192  0.03379639 -0.59121252]
Stock Position:  -0.007771924168189694
Bond Position:  [-0.37621856]


portfolio before change:  [-1.14934907]
curr_Stock_Price:  99.45315172049219
curr_Factors:  [99.45315172 -0.97134426 -1.06127952]
mat_Sqrt:  [[13.02750522  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00458485  0.01995087  0.36379202]
Stock Position:  -0.004584847265412704
Bond Position:  [-0.69337156]


portfolio before change:  [-1.1509533]
curr_Stock_Price:  99.72741368963555
curr_Factors:  [99.72741369 -1.08824329 -1.0512162 ]
mat_Sqrt:  [[11.73975694  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00421439 -0.02077301  0.08526113]
Stock Position:  0.004214385720292899
Bond Position:  [-1.57124308]


portfolio before change:  [-1.14900313]
curr_Stock_Price:  100.37661505839277
curr_Factors:  [100.37661506  -1.22142801  -1.04685194]
mat_Sqrt:  [[10.3879794   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00310323  0.00776557 -0.57912824]
Stock Position:  0.0031032293641626773
Bond Position:  [-1.46049479]


portfolio before change:  [-1.14657766]
curr_Stock_Price:  101.39358680712714
curr_Factors:  [101.39358681  -1.03402438  -1.10747709]
mat_Sqrt:  [[11.91154831  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01604198  0.00162545 -0.21566003]
Stock Position:  -0.016041975942586065
Bond Position:  [0.47997582]


portfolio before change:  [-1.14050236]
curr_Stock_Price:  101.02983752859855
curr_Factors:  [101.02983753  -0.48966137  -1.11381523]
mat_Sqrt:  [[20.32678121  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00771702 -0.00534984 -0.37404828]
Stock Position:  -0.007717016584365749
Bond Position:  [-0.36085343]


portfolio before change:  [-1.14606671]
curr_Stock_Price:  101.72750120776996
curr_Factors:  [101.72750121  -0.75377249  -1.1257878 ]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-1.14606671]
Stock Price:  101.64115228918352
PL:  [-2.787219]
Settle:  Tensor("sub_82:0", shape=(), dtype=float64)
PL:  Tensor("sub_83:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  42
output_Z_Vals[:, i, :]:  [[ 1.19279309e+02 -2.92921948e+01 -2.92556094e+01]
 [-5.99616077e-02 -2.24781552e-02  7.82299368e-02]
 [ 4.54066028e-01  6.95236716e-02 -2.70179978e-01]
 [ 1.23228296e-01 -2.29339014e-02 -2.20021102e-01]
 [-2.16533614e-01  2.38850743e-01  3.24231302e-01]
 [ 1.06611649e-01  1.17583608e-01 -3.60693880e-02]
 [ 8.26590379e-02 -1.49779378e-02 -2.07156456e-02]
 [ 1.24766453e-01 -1.06553505e-01 -7.62105767e-02]
 [ 1.54733807e-01 -9.17651774e-02  1.01558953e-01]
 [-8.87717660e-03 -6.51668928e-02 -2.74306487e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.27930914 -29.29219478 -29.25560936]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  8.31647217  -9.26300532 -83.45811031]
init_Out:  [2.54002979]
Stock Position:  8.316472170547405
Bond position:  [-829.10718727]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-6.73132614]
curr_Stock_Price:  98.93504138622559
curr_Factors:  [98.93504139 -0.82159305 -1.04109203]
mat_Sqrt:  [[15.36017932  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00290188 -0.00710822  0.22316823]
Stock Position:  -0.002901878371346003
Bond Position:  [-6.44422868]


portfolio before change:  [-6.73627817]
curr_Stock_Price:  99.53090195223591
curr_Factors:  [99.53090195 -0.98669185 -1.06842233]
mat_Sqrt:  [[12.74773977  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.03143388  0.02198532 -0.77074827]
Stock Position:  0.03143387546601066
Bond Position:  [-9.86492015]


portfolio before change:  [-6.74979873]
curr_Stock_Price:  99.25772955650537
curr_Factors:  [99.25772956 -0.29522224 -1.05426184]
mat_Sqrt:  [[25.7448785   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00301903 -0.00725234 -0.62765896]
Stock Position:  0.003019028646788525
Bond Position:  [-7.04946066]


portfolio before change:  [-6.75928979]
curr_Stock_Price:  97.28177988780622
curr_Factors:  [97.28177989 -0.46721165 -1.04377113]
mat_Sqrt:  [[21.46940572  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00671575  0.07553124  0.92494166]
Stock Position:  -0.006715746065952801
Bond Position:  [-6.10597006]


portfolio before change:  [-6.74275431]
curr_Stock_Price:  94.36486904263161
curr_Factors:  [94.36486904 -0.93094421 -1.07083381]
mat_Sqrt:  [[12.74820951  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00802348  0.0371832  -0.10289592]
Stock Position:  0.008023480615973477
Bond Position:  [-7.49988901]


portfolio before change:  [-6.7409555]
curr_Stock_Price:  95.05654997271334
curr_Factors:  [95.05654997 -1.60062515 -1.09022596]
mat_Sqrt:  [[ 6.44703847  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01210536 -0.00473644 -0.05909597]
Stock Position:  0.01210536374029759
Bond Position:  [-7.89164962]


portfolio before change:  [-6.75287053]
curr_Stock_Price:  94.39831131961535
curr_Factors:  [94.39831132 -0.85269115 -1.04217811]
mat_Sqrt:  [[14.19165236  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00750151 -0.03369518 -0.21740756]
Stock Position:  0.007501510851396255
Bond Position:  [-7.46100049]


portfolio before change:  [-6.75686564]
curr_Stock_Price:  94.363161552586
curr_Factors:  [94.36316155 -0.51376768 -0.98772185]
mat_Sqrt:  [[21.02392819  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00823324 -0.0290187   0.28971943]
Stock Position:  0.008233241339490355
Bond Position:  [-7.53378032]


portfolio before change:  [-6.76948399]
curr_Stock_Price:  93.28818809645252
curr_Factors:  [93.2881881  -0.26632554 -0.97211407]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-6.76948399]
Stock Price:  88.37393573938935
PL:  [-6.76948399]
Settle:  Tensor("sub_84:0", shape=(), dtype=float64)
PL:  Tensor("sub_85:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  43
output_Z_Vals[:, i, :]:  [[ 1.19279309e+02 -2.92921948e+01 -2.92556094e+01]
 [-7.04779654e-02 -1.14653620e-01 -1.72427800e-03]
 [ 8.21252766e-02  8.80965314e-03  4.14845408e-02]
 [-5.06115397e-02  1.19712676e-01 -7.91949245e-02]
 [ 3.62027919e-02 -1.19296467e-01 -4.72190560e-02]
 [ 4.09095930e-02 -6.73203978e-02  3.40070660e-02]
 [ 8.73464367e-02 -2.80371258e-02  1.60129511e-01]
 [ 7.65611933e-02 -1.05858669e-01 -2.29636213e-02]
 [ 1.14558179e-01 -9.13715540e-02  7.70678778e-02]
 [-1.48669557e-02 -9.43373842e-02 -1.10931787e-03]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.27930914 -29.29219478 -29.25560936]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  8.31647217  -9.26300532 -83.45811031]
init_Out:  [2.54002979]
Stock Position:  8.316472170547405
Bond position:  [-829.10718727]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [12.97144323]
curr_Stock_Price:  101.30416725624079
curr_Factors:  [101.30416726  -1.26978449  -1.0480166 ]
mat_Sqrt:  [[ 9.9774391   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00739571 -0.03625666 -0.00491889]
Stock Position:  -0.007395712985098644
Bond Position:  [13.72065977]


portfolio before change:  [12.97075114]
curr_Stock_Price:  102.32558739354053
curr_Factors:  [102.32558739  -1.36241011  -1.01690322]
mat_Sqrt:  [[ 9.47679738  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00958348 0.00278586 0.11834385]
Stock Position:  0.009583484131414551
Bond Position:  [11.9901155]


portfolio before change:  [12.97997248]
curr_Stock_Price:  102.66208041596792
curr_Factors:  [102.66208042  -1.00039481  -0.97355088]
mat_Sqrt:  [[14.26055212  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0044659   0.03785647 -0.22592108]
Stock Position:  -0.0044658977744094115
Bond Position:  [13.43845083]


portfolio before change:  [12.97989295]
curr_Stock_Price:  104.18482705119749
curr_Factors:  [104.18482705  -0.52866587  -0.97862175]
mat_Sqrt:  [[23.0779794   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00101759 -0.03772486 -0.13470282]
Stock Position:  0.0010175943288685124
Bond Position:  [12.87387506]


portfolio before change:  [12.98157541]
curr_Stock_Price:  99.51097699633623
curr_Factors:  [99.510977   -0.85628266 -0.99513258]
mat_Sqrt:  [[15.62469567  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00295129 -0.02128858  0.09701269]
Stock Position:  0.0029512927551292806
Bond Position:  [12.68788939]


portfolio before change:  [12.98349705]
curr_Stock_Price:  98.01200696722826
curr_Factors:  [98.01200697 -0.73871624 -0.92186717]
mat_Sqrt:  [[18.6250339   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00640583 -0.00886612  0.45680492]
Stock Position:  0.006405831071867313
Bond Position:  [12.35564869]


portfolio before change:  [12.9759409]
curr_Stock_Price:  95.86778612475318
curr_Factors:  [95.86778612 -1.0484684  -0.89929639]
mat_Sqrt:  [[13.67002148  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00505782 -0.03347545 -0.06550882]
Stock Position:  0.005057819754829675
Bond Position:  [12.49105892]


portfolio before change:  [12.98245857]
curr_Stock_Price:  95.92128410491553
curr_Factors:  [95.9212841  -0.49832269 -0.94577275]
mat_Sqrt:  [[22.63353057  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00565225 -0.02889422  0.2198532 ]
Stock Position:  0.0056522507627142365
Bond Position:  [12.44028742]


portfolio before change:  [12.9930633]
curr_Stock_Price:  96.69673215164829
curr_Factors:  [96.69673215 -0.53454784 -0.94219912]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [12.9930633]
Stock Price:  94.58763437643846
PL:  [12.9930633]
Settle:  Tensor("sub_86:0", shape=(), dtype=float64)
PL:  Tensor("sub_87:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  44
output_Z_Vals[:, i, :]:  [[ 1.19279309e+02 -2.92921948e+01 -2.92556094e+01]
 [-7.04779654e-02 -1.14653620e-01 -1.72427800e-03]
 [ 5.48169372e-01  7.19854643e-02 -2.91740673e-01]
 [-4.12262660e-02  8.93486082e-02 -2.10868157e-01]
 [ 3.40881475e-02 -1.89935143e-02 -2.97197243e-02]
 [ 7.79493490e-02  1.06215053e-01 -2.76155445e-03]
 [ 7.33685586e-02  2.20693866e-02 -2.13729561e-01]
 [-2.14391669e-01  5.10309224e-02 -1.58828687e-01]
 [ 7.51710262e-02  2.47658420e-02 -6.48312905e-02]
 [ 6.61023712e-02  3.54931570e-01 -5.95746511e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.27930914 -29.29219478 -29.25560936]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  8.31647217  -9.26300532 -83.45811031]
init_Out:  [2.54002979]
Stock Position:  8.316472170547405
Bond position:  [-829.10718727]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-6.40021842]
curr_Stock_Price:  98.97485486827526
curr_Factors:  [98.97485487 -1.15747912 -0.98067346]
mat_Sqrt:  [[11.66640391  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00632502 -0.03625666 -0.00491889]
Stock Position:  -0.006325023240790078
Bond Position:  [-5.77420016]


portfolio before change:  [-6.40364203]
curr_Stock_Price:  99.05956334873859
curr_Factors:  [99.05956335 -0.93576332 -0.98761279]
mat_Sqrt:  [[14.47387365  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.03388704  0.0227638  -0.83225494]
Stock Position:  0.03388703845301218
Bond Position:  [-9.76047726]


portfolio before change:  [-6.35688545]
curr_Stock_Price:  100.58339197761092
curr_Factors:  [100.58339198  -1.22313725  -0.98344091]
mat_Sqrt:  [[11.07188482  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00740277  0.02825451 -0.60154816]
Stock Position:  -0.007402766416844386
Bond Position:  [-5.61229009]


portfolio before change:  [-6.37240659]
curr_Stock_Price:  102.30089785102109
curr_Factors:  [102.30089785  -1.60774034  -0.99604787]
mat_Sqrt:  [[ 7.56952441  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00363711 -0.00600628 -0.0847821 ]
Stock Position:  0.003637114071284248
Bond Position:  [-6.74448662]


portfolio before change:  [-6.37200109]
curr_Stock_Price:  103.3397932751533
curr_Factors:  [103.33979328  -1.59228172  -1.04227295]
mat_Sqrt:  [[ 7.41472469  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01080662  0.03358815 -0.00787795]
Stock Position:  0.01080661969702928
Bond Position:  [-7.48875494]


portfolio before change:  [-6.38037665]
curr_Stock_Price:  102.91133015792559
curr_Factors:  [102.91133016  -1.45636944  -1.06468655]
mat_Sqrt:  [[ 8.27146601  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00366453  0.00697895 -0.60971095]
Stock Position:  0.0036645285975222693
Bond Position:  [-6.75749816]


portfolio before change:  [-6.37983569]
curr_Stock_Price:  103.98119594770306
curr_Factors:  [103.98119595  -1.53010525  -1.13222895]
mat_Sqrt:  [[ 7.25634222  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.03383176  0.01613739 -0.45309403]
Stock Position:  -0.0338317597517328
Bond Position:  [-2.86196885]


portfolio before change:  [-6.42325083]
curr_Stock_Price:  105.22215419629448
curr_Factors:  [105.2221542   -2.11853623  -1.12340422]
mat_Sqrt:  [[ 4.11292076  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0152147   0.00783165 -0.18494563]
Stock Position:  0.015214697636414835
Bond Position:  [-8.02417409]


portfolio before change:  [-6.42428144]
curr_Stock_Price:  105.41818038117958
curr_Factors:  [105.41818038  -1.90478588  -1.12577021]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-6.42428144]
Stock Price:  105.90723836594216
PL:  [-12.33151981]
Settle:  Tensor("sub_88:0", shape=(), dtype=float64)
PL:  Tensor("sub_89:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  45
output_Z_Vals[:, i, :]:  [[ 1.19279309e+02 -2.92921948e+01 -2.92556094e+01]
 [-2.40094946e-02  1.67742735e-01  2.50918499e-01]
 [ 6.47755432e-01  7.60100721e-02 -3.03880807e-01]
 [ 5.33027350e-01 -4.82109028e-01  1.80494452e-01]
 [-4.41554636e-01  6.09545448e-01  6.88702614e-01]
 [ 2.09633727e-01  3.94951970e-01 -1.54411668e-01]
 [-3.57665816e-01 -1.53240494e-01  3.92738209e-01]
 [ 1.36312683e-01 -8.06742210e-02 -4.38882599e-02]
 [-5.14086715e-01 -4.24140377e-02  1.57882191e-01]
 [-3.04935957e-03  2.08271950e-02 -2.76516796e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.27930914 -29.29219478 -29.25560936]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  8.31647217  -9.26300532 -83.45811031]
init_Out:  [2.54002979]
Stock Position:  8.316472170547405
Bond position:  [-829.10718727]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-17.34812175]
curr_Stock_Price:  97.65844292039911
curr_Factors:  [97.65844292 -0.44096473 -0.97247914]
mat_Sqrt:  [[23.76068294  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00132741 0.05304491 0.71580064]
Stock Position:  0.0013274083215523691
Bond Position:  [-17.47775438]


portfolio before change:  [-17.35618998]
curr_Stock_Price:  98.16531839088549
curr_Factors:  [98.16531839 -0.45333777 -1.01883944]
mat_Sqrt:  [[22.52162081  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.02609442  0.0240365  -0.86688736]
Stock Position:  0.026094418270880375
Bond Position:  [-19.91775686]


portfolio before change:  [-17.50571049]
curr_Stock_Price:  92.81708135135179
curr_Factors:  [92.81708135 -0.56578584 -0.93800407]
mat_Sqrt:  [[20.63194869  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.02701745 -0.15245626  0.51490043]
Stock Position:  0.027017449102969198
Bond Position:  [-20.01339126]


portfolio before change:  [-17.557323]
curr_Stock_Price:  91.27721290678242
curr_Factors:  [91.27721291 -0.74494869 -0.95322735]
mat_Sqrt:  [[16.70528495  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01707456  0.1927552   1.96467686]
Stock Position:  -0.017074561059303345
Bond Position:  [-15.99880466]


portfolio before change:  [-17.52873102]
curr_Stock_Price:  89.13406095573356
curr_Factors:  [89.13406096 -0.33869656 -0.93956547]
mat_Sqrt:  [[24.82570259  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00758537  0.12489478 -0.44049351]
Stock Position:  0.0075853721424787015
Bond Position:  [-18.20484605]


portfolio before change:  [-17.55294417]
curr_Stock_Price:  87.14227349607704
curr_Factors:  [87.1422735  -0.41363372 -0.9063713 ]
mat_Sqrt:  [[23.27866067  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01209069 -0.0484589   1.12037279]
Stock Position:  -0.01209069203175338
Bond Position:  [-16.49933378]


portfolio before change:  [-17.58382716]
curr_Stock_Price:  89.01406511578253
curr_Factors:  [89.01406512 -0.51022918 -0.89121379]
mat_Sqrt:  [[21.91894699  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00571519 -0.02551143 -0.12520099]
Stock Position:  0.00571519381433572
Bond Position:  [-18.09255979]


portfolio before change:  [-17.61998502]
curr_Stock_Price:  84.27068794370145
curr_Factors:  [84.27068794 -0.46612378 -0.84752158]
mat_Sqrt:  [[22.65518478  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0213176  -0.0134125   0.45039395]
Stock Position:  -0.02131760468574321
Bond Position:  [-15.82353581]


portfolio before change:  [-17.64480713]
curr_Stock_Price:  85.06385210832507
curr_Factors:  [85.06385211 -0.21461099 -0.82133923]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-17.64480713]
Stock Price:  85.66110143671922
PL:  [-17.64480713]
Settle:  Tensor("sub_90:0", shape=(), dtype=float64)
PL:  Tensor("sub_91:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  46
output_Z_Vals[:, i, :]:  [[ 1.19279309e+02 -2.92921948e+01 -2.92556094e+01]
 [-2.57956388e-02  8.98036440e-02  1.92011666e-01]
 [ 1.42131083e+00  9.09761009e-02 -5.20761510e-01]
 [ 2.21284388e-01 -7.98957158e-02 -1.62926039e-01]
 [-1.08918445e-01  9.23121681e-02  1.60291109e-01]
 [ 1.04977663e-01  1.30520464e-01 -2.95249892e-02]
 [ 7.74329831e-02 -4.18043333e-04 -2.22342760e-01]
 [ 7.64748615e-02 -1.06031920e-01 -2.31702521e-02]
 [ 1.04174816e-01 -9.12698223e-02  7.07381760e-02]
 [-1.45196446e-02 -9.29635901e-02 -1.40346926e-03]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.27930914 -29.29219478 -29.25560936]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  8.31647217  -9.26300532 -83.45811031]
init_Out:  [2.54002979]
Stock Position:  8.316472170547405
Bond position:  [-829.10718727]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-20.95487329]
curr_Stock_Price:  97.22475523791948
curr_Factors:  [97.22475524 -0.77545703 -0.98906365]
mat_Sqrt:  [[16.65157293  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00094389 0.02839841 0.54775584]
Stock Position:  0.0009438927215810427
Bond Position:  [-21.04664303]


portfolio before change:  [-20.96786926]
curr_Stock_Price:  94.6079211782837
curr_Factors:  [94.60792118 -0.54645536 -0.90705291]
mat_Sqrt:  [[22.11448735  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.05956999  0.02876917 -1.48558763]
Stock Position:  0.05956999165689848
Bond Position:  [-26.60366233]


portfolio before change:  [-20.73133985]
curr_Stock_Price:  98.80188793136132
curr_Factors:  [98.80188793 -1.18357403 -0.93160077]
mat_Sqrt:  [[11.91671355  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01560534 -0.02526524 -0.46478264]
Stock Position:  0.015605338671817428
Bond Position:  [-22.27317677]


portfolio before change:  [-20.74435908]
curr_Stock_Price:  98.68142536769292
curr_Factors:  [98.68142537 -1.30673607 -0.89717508]
mat_Sqrt:  [[10.89153178  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00677735  0.02919167  0.45726592]
Stock Position:  -0.006777345056963217
Bond Position:  [-20.07556101]


portfolio before change:  [-20.74603108]
curr_Stock_Price:  97.44668015759862
curr_Factors:  [97.44668016 -1.47199352 -0.88112046]
mat_Sqrt:  [[ 9.26451378  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01104439  0.04127419 -0.08422658]
Stock Position:  0.011044392172936792
Bond Position:  [-21.82227043]


portfolio before change:  [-20.77361116]
curr_Stock_Price:  95.93765917036913
curr_Factors:  [95.93765917 -1.62973359 -0.88281124]
mat_Sqrt:  [[ 7.77686859  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 4.11948114e-03 -1.32196909e-04 -6.34282006e-01]
Stock Position:  0.004119481135878944
Bond Position:  [-21.16882454]


portfolio before change:  [-20.78496055]
curr_Stock_Price:  95.75260432075947
curr_Factors:  [95.75260432 -1.41854551 -0.93454438]
mat_Sqrt:  [[ 9.10367276  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00758018 -0.03353024 -0.06609828]
Stock Position:  0.007580184716296585
Bond Position:  [-21.51078298]


portfolio before change:  [-20.80396868]
curr_Stock_Price:  94.66423345215438
curr_Factors:  [94.66423345 -1.13820297 -0.86335873]
mat_Sqrt:  [[12.7914189   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00908872 -0.02886205  0.20179633]
Stock Position:  0.009088718749733797
Bond Position:  [-21.66434528]


portfolio before change:  [-20.7959368]
curr_Stock_Price:  96.74007719290198
curr_Factors:  [96.74007719 -1.18676679 -0.89381198]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-20.7959368]
Stock Price:  97.33520732790402
PL:  [-20.7959368]
Settle:  Tensor("sub_92:0", shape=(), dtype=float64)
PL:  Tensor("sub_93:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  47
output_Z_Vals[:, i, :]:  [[ 1.19279309e+02 -2.92921948e+01 -2.92556094e+01]
 [-6.95740977e-02 -1.06731255e-01  5.14768587e-03]
 [ 7.90419518e-01  7.49860546e-02 -3.72344083e-01]
 [ 2.67002987e-01 -1.08226164e-01 -1.47404808e-01]
 [-1.59243552e-01  1.61507711e-01  2.37180676e-01]
 [ 1.00079787e-01  1.14478552e-01 -2.46674902e-02]
 [ 7.37694147e-02  2.21983699e-02 -1.79804474e-01]
 [-1.30993776e-02 -9.28023555e-02  8.43394869e-02]
 [ 4.37376184e-02 -8.59122364e-02  3.06096112e-02]
 [ 1.73151910e-03  1.40215755e-02  8.82081787e-03]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.27930914 -29.29219478 -29.25560936]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  8.31647217  -9.26300532 -83.45811031]
init_Out:  [2.54002979]
Stock Position:  8.316472170547405
Bond position:  [-829.10718727]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-12.86279647]
curr_Stock_Price:  98.19777320240924
curr_Factors:  [98.1977732  -1.02312339 -0.95721396]
mat_Sqrt:  [[13.55351851  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00525909 -0.03375139  0.01468491]
Stock Position:  -0.005259086031282453
Bond Position:  [-12.34636593]


portfolio before change:  [-12.86927643]
curr_Stock_Price:  98.2558123743271
curr_Factors:  [98.25581237 -1.32447272 -0.95050798]
mat_Sqrt:  [[10.10058867  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.07092173  0.02371267 -1.06219403]
Stock Position:  0.07092173088262528
Bond Position:  [-19.83774871]


portfolio before change:  [-12.8623109]
curr_Stock_Price:  98.4939183510061
curr_Factors:  [98.49391835 -1.28770121 -0.95068366]
mat_Sqrt:  [[10.50246437  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.02229188 -0.03422412 -0.42050489]
Stock Position:  0.022291884121980462
Bond Position:  [-15.05792591]


portfolio before change:  [-12.89718898]
curr_Stock_Price:  97.2671381824525
curr_Factors:  [97.26713818 -1.65628383 -0.91171757]
mat_Sqrt:  [[ 7.45928673  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01429884  0.05107322  0.67661045]
Stock Position:  -0.014298838676474445
Bond Position:  [-11.50638187]


portfolio before change:  [-12.91462405]
curr_Stock_Price:  98.08401797442335
curr_Factors:  [98.08401797 -1.5082385  -0.8823251 ]
mat_Sqrt:  [[ 8.98234368  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01091034  0.0362013  -0.07036948]
Stock Position:  0.010910335220554174
Bond Position:  [-13.98475356]


portfolio before change:  [-12.91541219]
curr_Stock_Price:  98.65283501976873
curr_Factors:  [98.65283502 -1.13252689 -0.90295157]
mat_Sqrt:  [[12.8858333   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00292105  0.00701974 -0.51293212]
Stock Position:  0.002921048153360547
Bond Position:  [-13.20358187]


portfolio before change:  [-12.92363807]
curr_Stock_Price:  98.09740461084024
curr_Factors:  [98.09740461 -0.85343271 -0.89912441]
mat_Sqrt:  [[17.00323778  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 1.01169058e-04 -2.93466816e-02  2.40597081e-01]
Stock Position:  0.0001011690581937727
Bond Position:  [-12.93356249]


portfolio before change:  [-12.93018928]
curr_Stock_Price:  97.2788024706249
curr_Factors:  [97.27880247 -0.76494414 -0.87077187]
mat_Sqrt:  [[18.95115919  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00252056 -0.02716783  0.0873207 ]
Stock Position:  0.00252056004612965
Bond Position:  [-13.17538634]


portfolio before change:  [-12.93116483]
curr_Stock_Price:  99.50600436508843
curr_Factors:  [99.50600437 -0.71983231 -0.91101796]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-12.93116483]
Stock Price:  98.72313051695343
PL:  [-12.93116483]
Settle:  Tensor("sub_94:0", shape=(), dtype=float64)
PL:  Tensor("sub_95:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  48
output_Z_Vals[:, i, :]:  [[ 1.19279309e+02 -2.92921948e+01 -2.92556094e+01]
 [-7.04779654e-02 -1.14653620e-01 -1.72427800e-03]
 [ 3.80894041e-01  6.63681673e-02 -2.62752095e-01]
 [ 1.93875885e-01 -6.35956055e-02 -1.76516134e-01]
 [ 4.35900508e-03 -1.65687373e-02  2.92534843e-03]
 [ 4.26164371e-02 -6.00116993e-02  3.23131670e-02]
 [ 7.77066725e-02  6.67474843e-03 -9.53857015e-02]
 [-2.00601907e-01  3.32380185e-02 -1.29361784e-01]
 [-9.89444975e-02 -4.63929118e-02 -8.54662007e-02]
 [ 5.35187293e-02  2.67903518e-01 -2.05664959e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.27930914 -29.29219478 -29.25560936]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  8.31647217  -9.26300532 -83.45811031]
init_Out:  [2.54002979]
Stock Position:  8.316472170547405
Bond position:  [-829.10718727]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [3.56878014]
curr_Stock_Price:  100.17356008382157
curr_Factors:  [100.17356008  -1.45596292  -0.96289924]
mat_Sqrt:  [[ 8.91773618  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00827455 -0.03625666 -0.00491889]
Stock Position:  -0.008274552463232132
Bond Position:  [4.39767152]


portfolio before change:  [3.56994682]
curr_Stock_Price:  100.29836613016678
curr_Factors:  [100.29836613  -1.45578762  -1.00589459]
mat_Sqrt:  [[ 8.55458325  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.03845583  0.02098746 -0.74955859]
Stock Position:  0.03845583156541803
Bond Position:  [-0.28711026]


portfolio before change:  [3.51738479]
curr_Stock_Price:  98.93528460411878
curr_Factors:  [98.9352846  -0.98826657 -0.96901004]
mat_Sqrt:  [[13.97387251  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01117819 -0.0201107  -0.5035514 ]
Stock Position:  0.011178193362405355
Bond Position:  [2.41146705]


portfolio before change:  [3.5432063]
curr_Stock_Price:  101.13738249750175
curr_Factors:  [101.1373825   -1.19925381  -0.96988479]
mat_Sqrt:  [[11.55757676  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00039181 -0.00523949  0.0083452 ]
Stock Position:  0.0003918067309886739
Bond Position:  [3.50357999]


portfolio before change:  [3.54448045]
curr_Stock_Price:  99.91718122095352
curr_Factors:  [99.91718122 -0.78188701 -0.93888752]
mat_Sqrt:  [[17.87793227  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00266602 -0.01897737  0.09218047]
Stock Position:  0.0026660152054751004
Bond Position:  [3.27809972]


portfolio before change:  [3.54831438]
curr_Stock_Price:  100.74031068050446
curr_Factors:  [100.74031068  -0.84113791  -0.921979  ]
mat_Sqrt:  [[17.27791532  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00338053  0.00211074 -0.27210886]
Stock Position:  0.003380528721319714
Bond Position:  [3.20775887]


portfolio before change:  [3.55502746]
curr_Stock_Price:  102.25155280793543
curr_Factors:  [102.25155281  -1.16714051  -0.91267531]
mat_Sqrt:  [[12.77666112  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01770021  0.01051078 -0.36903316]
Stock Position:  -0.017700208698158804
Bond Position:  [5.36490128]


portfolio before change:  [3.58070905]
curr_Stock_Price:  100.95221947114534
curr_Factors:  [100.95221947  -1.36633095  -0.90792488]
mat_Sqrt:  [[10.38530157  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01132255 -0.01467073 -0.24381128]
Stock Position:  -0.011322547706989752
Bond Position:  [4.72374537]


portfolio before change:  [3.56502026]
curr_Stock_Price:  102.54649496750363
curr_Factors:  [102.54649497  -1.3274355   -0.94490178]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [3.56502026]
Stock Price:  104.8602878556125
PL:  [-1.2952676]
Settle:  Tensor("sub_96:0", shape=(), dtype=float64)
PL:  Tensor("sub_97:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  49
output_Z_Vals[:, i, :]:  [[ 1.19279309e+02 -2.92921948e+01 -2.92556094e+01]
 [-7.04779654e-02 -1.14653620e-01 -1.72427800e-03]
 [ 9.66358418e-02  3.98146093e-02 -1.49548652e-02]
 [ 4.39687018e-01 -3.49512069e-01  9.08881153e-03]
 [-2.86953207e-01  3.35803330e-01  4.31865303e-01]
 [ 4.65946327e-02 -6.07003013e-02  2.83767524e-02]
 [ 8.73464367e-02 -2.80371258e-02  1.60129511e-01]
 [ 9.38781702e-02 -1.06748346e-01 -4.31994856e-02]
 [ 1.69082520e-01 -9.19057599e-02  1.10305934e-01]
 [-1.40119489e-02 -9.09553925e-02 -1.83345662e-03]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.27930914 -29.29219478 -29.25560936]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  8.31647217  -9.26300532 -83.45811031]
init_Out:  [2.54002979]
Stock Position:  8.316472170547405
Bond position:  [-829.10718727]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [19.32199334]
curr_Stock_Price:  102.06777831361673
curr_Factors:  [102.06777831  -0.9904237   -0.99961962]
mat_Sqrt:  [[13.95159387  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00528902 -0.03625666 -0.00491889]
Stock Position:  -0.005289021209628135
Bond Position:  [19.86183198]


portfolio before change:  [19.33764896]
curr_Stock_Price:  100.98587185444096
curr_Factors:  [100.98587185  -0.16781023  -1.03783923]
mat_Sqrt:  [[30.24500864  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00312816  0.01259048 -0.04266207]
Stock Position:  0.0031281591842094378
Bond Position:  [19.02174908]


portfolio before change:  [19.32732372]
curr_Stock_Price:  94.64396350505916
curr_Factors:  [94.64396351 -0.65436216 -1.06326831]
mat_Sqrt:  [[16.98773533  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0254606  -0.11052542  0.02592785]
Stock Position:  0.0254605980415732
Bond Position:  [16.9176318]


portfolio before change:  [19.35167443]
curr_Stock_Price:  95.26805675413334
curr_Factors:  [95.26805675 -0.98565772 -1.09916666]
mat_Sqrt:  [[11.84457775  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01605196  0.10619034  1.2319915 ]
Stock Position:  -0.016051958197733914
Bond Position:  [20.8809133]


portfolio before change:  [19.33144354]
curr_Stock_Price:  97.17897365031278
curr_Factors:  [97.17897365 -0.69702643 -1.07460858]
mat_Sqrt:  [[16.52574326  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00307519 -0.01919512  0.08095098]
Stock Position:  0.003075186224789771
Bond Position:  [19.0326001]


portfolio before change:  [19.33318328]
curr_Stock_Price:  94.64938828856805
curr_Factors:  [94.64938829 -0.93978868 -1.00560924]
mat_Sqrt:  [[13.52826897  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00881922 -0.00886612  0.45680492]
Stock Position:  0.008819223001446792
Bond Position:  [18.49844921]


portfolio before change:  [19.34906334]
curr_Stock_Price:  95.40098842589883
curr_Factors:  [95.40098843 -0.93717023 -0.99703938]
mat_Sqrt:  [[13.78911251  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00596876 -0.03375679 -0.12323611]
Stock Position:  0.005968758439848921
Bond Position:  [18.77963789]


portfolio before change:  [19.35195383]
curr_Stock_Price:  94.31170314405594
curr_Factors:  [94.31170314 -0.14095678 -0.97524468]
mat_Sqrt:  [[30.8891141   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00612596 -0.02906315  0.31467213]
Stock Position:  0.006125964863133868
Bond Position:  [18.77420365]


portfolio before change:  [19.37332323]
curr_Stock_Price:  96.2673053333777
curr_Factors:  [96.26730533 -0.39598566 -0.97826611]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [19.37332323]
Stock Price:  96.53940128076151
PL:  [19.37332323]
Settle:  Tensor("sub_98:0", shape=(), dtype=float64)
PL:  Tensor("sub_99:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  50
output_Z_Vals[:, i, :]:  [[ 1.19279309e+02 -2.92921948e+01 -2.92556094e+01]
 [-6.99994230e-02 -1.10459214e-01  1.91400447e-03]
 [-9.36484403e-02 -4.00797358e-02  6.52947828e-02]
 [-5.33424583e-02  1.49352547e-01  4.14545215e-02]
 [ 1.00722258e-02  7.15316977e-03  4.07587499e-03]
 [ 1.86466165e-01  5.97553701e-01 -1.10472830e-01]
 [ 8.62481236e-02  1.33539005e-02 -2.28157647e-01]
 [-3.16572369e-02 -1.28065345e-01  5.54414698e-02]
 [ 4.91515425e-02  1.02109894e-01 -1.62476829e-01]
 [ 6.86473537e-02  4.01246530e-01 -1.98699359e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.27930914 -29.29219478 -29.25560936]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  8.31647217  -9.26300532 -83.45811031]
init_Out:  [2.54002979]
Stock Position:  8.316472170547405
Bond position:  [-829.10718727]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [20.12578818]
curr_Stock_Price:  102.16442925242374
curr_Factors:  [102.16442925  -0.86232007  -1.05459367]
mat_Sqrt:  [[15.02431398  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0048229  -0.03493027  0.00546012]
Stock Position:  -0.004822900614014055
Bond Position:  [20.61851707]


portfolio before change:  [20.12513748]
curr_Stock_Price:  104.4374473453769
curr_Factors:  [104.43744735  -0.88071892  -1.06982212]
mat_Sqrt:  [[14.85070392  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0054782  -0.01267433  0.18626784]
Stock Position:  -0.005478195062236814
Bond Position:  [20.69726618]


portfolio before change:  [20.1342563]
curr_Stock_Price:  104.66241174049013
curr_Factors:  [104.66241174  -1.35737258  -1.05034134]
mat_Sqrt:  [[ 9.42179974  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00435419  0.04722942  0.11825821]
Stock Position:  -0.004354191817604258
Bond Position:  [20.58997651]


portfolio before change:  [20.1359647]
curr_Stock_Price:  106.635030068806
curr_Factors:  [106.63503007  -1.62182994  -1.04784127]
mat_Sqrt:  [[ 7.38714155  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00150111 0.00226203 0.01162734]
Stock Position:  0.0015011089596419312
Bond Position:  [19.9758939]


portfolio before change:  [20.14723335]
curr_Stock_Price:  107.48653772023688
curr_Factors:  [107.48653772  -1.53289605  -1.00904004]
mat_Sqrt:  [[ 8.46067975  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.02119744  0.18896307 -0.31514823]
Stock Position:  0.021197441471548104
Bond Position:  [17.86879376]


portfolio before change:  [20.14684477]
curr_Stock_Price:  107.04661595450696
curr_Factors:  [107.04661595  -1.589068    -0.99466841]
mat_Sqrt:  [[ 8.08109993  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00495235  0.00422287 -0.65087026]
Stock Position:  0.00495234999210272
Bond Position:  [19.61671246]


portfolio before change:  [20.16280644]
curr_Stock_Price:  108.28862559333886
curr_Factors:  [108.28862559  -1.3601918   -1.05458226]
mat_Sqrt:  [[ 9.67965313  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00244295 -0.04049782  0.15815908]
Stock Position:  -0.002442951931604726
Bond Position:  [20.42735035]


portfolio before change:  [20.17217555]
curr_Stock_Price:  108.63538699092297
curr_Factors:  [108.63538699  -1.65627335  -1.08036948]
mat_Sqrt:  [[ 7.03821352  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00264592  0.03228998 -0.46350117]
Stock Position:  0.0026459221006929793
Bond Position:  [19.88473478]


portfolio before change:  [20.1808738]
curr_Stock_Price:  108.16424475837744
curr_Factors:  [108.16424476  -1.49642528  -1.14681565]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [20.1808738]
Stock Price:  107.51408858065363
PL:  [12.66678522]
Settle:  Tensor("sub_100:0", shape=(), dtype=float64)
PL:  Tensor("sub_101:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  51
output_Z_Vals[:, i, :]:  [[ 1.19279309e+02 -2.92921948e+01 -2.92556094e+01]
 [-6.05640586e-02 -3.02852635e-02  7.16134831e-02]
 [-9.78029141e-02 -2.11335794e-02  6.75743330e-02]
 [ 1.68792082e-01 -4.97871916e-02 -1.95900986e-01]
 [-4.57335218e-02  9.92902571e-03  6.52699426e-02]
 [ 3.99889777e-02 -7.08945473e-02  3.49204582e-02]
 [ 8.73464367e-02 -2.80371258e-02  1.60129511e-01]
 [ 7.50032662e-02 -1.06358693e-01 -2.21469861e-02]
 [ 9.69249263e-02 -9.11987911e-02  6.63186410e-02]
 [-1.10735403e-02 -7.93324761e-02 -4.32210978e-03]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.27930914 -29.29219478 -29.25560936]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  8.31647217  -9.26300532 -83.45811031]
init_Out:  [2.54002979]
Stock Position:  8.316472170547405
Bond position:  [-829.10718727]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [8.50307333]
curr_Stock_Price:  100.76687574541768
curr_Factors:  [100.76687575  -0.75716603  -1.0393459 ]
mat_Sqrt:  [[16.71485354  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0027956  -0.00957704  0.20429333]
Stock Position:  -0.002795596121395031
Bond Position:  [8.78477682]


portfolio before change:  [8.5030865]
curr_Stock_Price:  102.33373813368736
curr_Factors:  [102.33373813  -0.35747586  -1.03996543]
mat_Sqrt:  [[25.29984123  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00334212 -0.00668302  0.19277076]
Stock Position:  -0.0033421169338043845
Bond Position:  [8.84509782]


portfolio before change:  [8.51864581]
curr_Stock_Price:  99.00182228849266
curr_Factors:  [99.00182229 -0.63080984 -1.04621556]
mat_Sqrt:  [[18.50633036  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00689053 -0.01574409 -0.55885099]
Stock Position:  0.006890531959583982
Bond Position:  [7.83647059]


portfolio before change:  [8.53166864]
curr_Stock_Price:  100.32299975177887
curr_Factors:  [100.32299975  -0.87358396  -1.06723644]
mat_Sqrt:  [[14.40498851  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00223214  0.00313983  0.18619698]
Stock Position:  -0.002232142300129502
Bond Position:  [8.75560385]


portfolio before change:  [8.53772316]
curr_Stock_Price:  99.57232123988567
curr_Factors:  [99.57232124 -0.78148336 -1.05325315]
mat_Sqrt:  [[15.89727502  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0028487  -0.02241882  0.09961835]
Stock Position:  0.0028487018703813437
Bond Position:  [8.2540713]


portfolio before change:  [8.53733723]
curr_Stock_Price:  97.98774255472809
curr_Factors:  [97.98774255 -0.62634967 -1.03016874]
mat_Sqrt:  [[18.69626889  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00638142 -0.00886612  0.45680492]
Stock Position:  0.006381424098503461
Bond Position:  [7.91203589]


portfolio before change:  [8.52810103]
curr_Stock_Price:  95.92030273037143
curr_Factors:  [95.92030273 -0.59976901 -1.01616431]
mat_Sqrt:  [[19.05985613  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00355388 -0.03363357 -0.06317919]
Stock Position:  0.0035538758260294273
Bond Position:  [8.18721219]


portfolio before change:  [8.53145337]
curr_Stock_Price:  95.7114337651269
curr_Factors:  [95.71143377 -0.85217836 -1.06364148]
mat_Sqrt:  [[14.09074119  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00767223 -0.02883959  0.18918862]
Stock Position:  0.007672230868396949
Bond Position:  [7.79713315]


portfolio before change:  [8.53121754]
curr_Stock_Price:  95.17242914653588
curr_Factors:  [95.17242915 -1.02230886 -1.04662801]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [8.53121754]
Stock Price:  94.05072207064053
PL:  [8.53121754]
Settle:  Tensor("sub_102:0", shape=(), dtype=float64)
PL:  Tensor("sub_103:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  52
output_Z_Vals[:, i, :]:  [[ 1.19279309e+02 -2.92921948e+01 -2.92556094e+01]
 [-7.04779654e-02 -1.14653620e-01 -1.72427800e-03]
 [ 3.43784920e-01  7.00101103e-02 -2.19552306e-01]
 [ 3.16347286e-02  4.47112484e-02 -1.82922628e-01]
 [-4.46498539e-02  4.38701727e-02  7.55935181e-02]
 [ 5.39174383e-02 -3.67160633e-02  2.11143133e-02]
 [ 7.40784938e-02  2.20652620e-02 -1.57092640e-01]
 [-3.80074604e-02 -8.51223673e-02  1.07183159e-01]
 [ 4.91937704e-02 -9.07311419e-02  3.72217128e-02]
 [-1.17780376e-02 -8.21191251e-02 -3.72544344e-03]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.27930914 -29.29219478 -29.25560936]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  8.31647217  -9.26300532 -83.45811031]
init_Out:  [2.54002979]
Stock Position:  8.316472170547405
Bond position:  [-829.10718727]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [0.81936593]
curr_Stock_Price:  99.84296146484765
curr_Factors:  [99.84296146 -1.2108669  -1.00832107]
mat_Sqrt:  [[10.85266421  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00679928 -0.03625666 -0.00491889]
Stock Position:  -0.006799277529281979
Bond Position:  [1.49822593]


portfolio before change:  [0.82124008]
curr_Stock_Price:  99.67752489645744
curr_Factors:  [99.6775249  -0.52878008 -0.98346908]
mat_Sqrt:  [[21.97028948  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01369015  0.02213914 -0.62632162]
Stock Position:  0.013690154016152742
Bond Position:  [-0.54336059]


portfolio before change:  [0.82780077]
curr_Stock_Price:  100.17660201435687
curr_Factors:  [100.17660201  -1.54953425  -0.9171723 ]
mat_Sqrt:  [[ 8.5013765   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00053518  0.01413894 -0.52182734]
Stock Position:  -0.0005351788645754189
Bond Position:  [0.88141317]


portfolio before change:  [0.82838087]
curr_Stock_Price:  99.91635879544366
curr_Factors:  [99.9163588  -1.61511961 -0.90001726]
mat_Sqrt:  [[ 8.078422    0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00347675  0.01387297  0.21564727]
Stock Position:  -0.0034767518543099324
Bond Position:  [1.17576525]


portfolio before change:  [0.83384548]
curr_Stock_Price:  98.51373187492186
curr_Factors:  [98.51373187 -0.89426576 -0.8667091 ]
mat_Sqrt:  [[16.93226699  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00338285 -0.01161064  0.06023326]
Stock Position:  0.00338285327280773
Bond Position:  [0.50058798]


portfolio before change:  [0.8367929]
curr_Stock_Price:  99.31100736611843
curr_Factors:  [99.31100737 -0.98698721 -0.87670254]
mat_Sqrt:  [[15.40306728  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0027645   0.00697765 -0.44814158]
Stock Position:  0.0027645023319001487
Bond Position:  [0.56224739]


portfolio before change:  [0.83540054]
curr_Stock_Price:  98.70563170037529
curr_Factors:  [98.7056317  -0.72821043 -0.88102289]
mat_Sqrt:  [[19.7451655   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00092816 -0.02691806  0.30576372]
Stock Position:  -0.0009281583307579436
Bond Position:  [0.92701499]


portfolio before change:  [0.83749144]
curr_Stock_Price:  96.95239471182505
curr_Factors:  [96.95239471 -1.05709236 -0.81873327]
mat_Sqrt:  [[14.85586082  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00366515 -0.02869171  0.10618319]
Stock Position:  0.003665149624367652
Bond Position:  [0.48214641]


portfolio before change:  [0.8322383]
curr_Stock_Price:  95.45333691777667
curr_Factors:  [95.45333692 -1.37147726 -0.84924422]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [0.8322383]
Stock Price:  96.75545888932666
PL:  [0.8322383]
Settle:  Tensor("sub_104:0", shape=(), dtype=float64)
PL:  Tensor("sub_105:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  53
output_Z_Vals[:, i, :]:  [[ 1.19279309e+02 -2.92921948e+01 -2.92556094e+01]
 [-7.04779654e-02 -1.14653620e-01 -1.72427800e-03]
 [ 3.33371006e-01  6.90339503e-02 -2.22459797e-01]
 [-4.60735786e-02  1.01019336e-01 -1.65594600e-01]
 [ 1.53275230e-02 -2.31515204e-02 -1.09994075e-02]
 [ 4.92115957e-02 -5.21290149e-02  2.57813627e-02]
 [ 9.51911747e-02  5.66614661e-03 -2.12570552e-01]
 [-1.93377719e-01  3.04167748e-02 -1.34133053e-01]
 [ 1.46157565e-02  2.48514202e-02 -9.75008177e-02]
 [ 7.26926769e-02  3.78323294e-01 -5.22596485e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.27930914 -29.29219478 -29.25560936]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  8.31647217  -9.26300532 -83.45811031]
init_Out:  [2.54002979]
Stock Position:  8.316472170547405
Bond position:  [-829.10718727]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [7.28859023]
curr_Stock_Price:  100.62084229777494
curr_Factors:  [100.6208423   -1.21925942  -1.06227456]
mat_Sqrt:  [[10.27614748  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00718073 -0.03625666 -0.00491889]
Stock Position:  -0.007180733444924998
Bond Position:  [8.01112168]


portfolio before change:  [7.29300777]
curr_Stock_Price:  100.56360929693211
curr_Factors:  [100.5636093   -1.4346459   -1.09624373]
mat_Sqrt:  [[ 8.00367508  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.03620137  0.02183045 -0.63461588]
Stock Position:  0.03620137446765592
Bond Position:  [3.65246689]


portfolio before change:  [7.29788991]
curr_Stock_Price:  100.64801097221712
curr_Factors:  [100.64801097  -1.83650641  -1.08531162]
mat_Sqrt:  [[ 5.41845847  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01425998  0.03194512 -0.4723953 ]
Stock Position:  -0.014259983186021834
Bond Position:  [8.73312886]


portfolio before change:  [7.29365603]
curr_Stock_Price:  101.25120480730567
curr_Factors:  [101.25120481  -1.55607447  -1.13001478]
mat_Sqrt:  [[ 6.89995819  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00180936 -0.00732115 -0.03137825]
Stock Position:  0.0018093600526460367
Bond Position:  [7.11045615]


portfolio before change:  [7.29795964]
curr_Stock_Price:  101.66432555140469
curr_Factors:  [101.66432555  -1.57637822  -1.20834971]
mat_Sqrt:  [[ 6.27735384  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00846348 -0.01648464  0.07354705]
Stock Position:  0.008463475266778776
Bond Position:  [6.43752613]


portfolio before change:  [7.31032806]
curr_Stock_Price:  102.74530619433855
curr_Factors:  [102.74530619  -0.98095657  -1.26137686]
mat_Sqrt:  [[10.91261808  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00476024  0.00179179 -0.60640462]
Stock Position:  0.004760240970013085
Bond Position:  [6.82123564]


portfolio before change:  [7.3162613]
curr_Stock_Price:  103.27506407756327
curr_Factors:  [103.27506408  -0.86555403  -1.31706429]
mat_Sqrt:  [[11.64384401  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01889171  0.00961863 -0.38264426]
Stock Position:  -0.018891712741524302
Bond Position:  [9.26730415]


portfolio before change:  [7.30599688]
curr_Stock_Price:  104.06372935382204
curr_Factors:  [104.06372935  -1.37718935  -1.37496483]
mat_Sqrt:  [[ 6.63825627  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00069971  0.00785871 -0.27814269]
Stock Position:  -0.0006997099092034306
Bond Position:  [7.3788113]


portfolio before change:  [7.3091992]
curr_Stock_Price:  104.76116178760782
curr_Factors:  [104.76116179  -1.42377417  -1.39079669]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [7.3091992]
Stock Price:  104.55499867710986
PL:  [2.75420053]
Settle:  Tensor("sub_106:0", shape=(), dtype=float64)
PL:  Tensor("sub_107:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  54
output_Z_Vals[:, i, :]:  [[ 1.19279309e+02 -2.92921948e+01 -2.92556094e+01]
 [-7.04779654e-02 -1.14653620e-01 -1.72427800e-03]
 [ 1.68173544e-01  6.15504433e-02 -9.99770423e-02]
 [-4.58035789e-02  1.20336918e-01 -5.48934446e-02]
 [-1.21648181e-01  1.09823811e-01  1.79744832e-01]
 [ 3.96067061e-02 -7.72533866e-02  3.51659794e-02]
 [-3.40480639e-01 -1.48405476e-01  3.83755487e-01]
 [-3.40206256e-02 -7.75962115e-02  1.10606684e-01]
 [-7.39621099e-02 -5.18893875e-02 -6.38055686e-02]
 [-8.65975224e-03 -6.19586229e-02 -3.67235619e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.27930914 -29.29219478 -29.25560936]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  8.31647217  -9.26300532 -83.45811031]
init_Out:  [2.54002979]
Stock Position:  8.316472170547405
Bond position:  [-829.10718727]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-10.67549174]
curr_Stock_Price:  98.46078192626749
curr_Factors:  [98.46078193 -1.0224154  -1.02964664]
mat_Sqrt:  [[12.64922913  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00583358 -0.03625666 -0.00491889]
Stock Position:  -0.005833578878137972
Bond Position:  [-10.101113]


portfolio before change:  [-10.69358656]
curr_Stock_Price:  100.69663088178477
curr_Factors:  [100.69663088  -0.49727615  -1.04239018]
mat_Sqrt:  [[21.59465893  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0069163   0.01946396 -0.28520667]
Stock Position:  0.006916295459231452
Bond Position:  [-11.39003421]


portfolio before change:  [-10.6849032]
curr_Stock_Price:  102.77574925789953
curr_Factors:  [102.77574926  -0.67566624  -1.04253112]
mat_Sqrt:  [[18.43686244  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00292358  0.03805387 -0.15659572]
Stock Position:  -0.0029235761082480483
Bond Position:  [-10.38443048]


portfolio before change:  [-10.68061591]
curr_Stock_Price:  99.53286851597026
curr_Factors:  [99.53286852 -0.18464119 -1.01334161]
mat_Sqrt:  [[30.03925781  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00273383  0.03472934  0.51276197]
Stock Position:  -0.0027338319385299997
Bond Position:  [-10.40850977]


portfolio before change:  [-10.67924451]
curr_Stock_Price:  97.12710364085372
curr_Factors:  [97.12710364  0.37141302 -0.99792235]
mat_Sqrt:  [[51.90998395  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00086284 -0.02442967  0.10031875]
Stock Position:  0.0008628447623230533
Bond Position:  [-10.76305012]


portfolio before change:  [-10.68657806]
curr_Stock_Price:  94.8663503742835
curr_Factors:  [94.86635037  0.25671044 -1.03923688]
mat_Sqrt:  [[43.37757583  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00613171 -0.04692993  1.09474759]
Stock Position:  -0.006131709435162415
Bond Position:  [-10.10488516]


portfolio before change:  [-10.71497548]
curr_Stock_Price:  98.67339926852475
curr_Factors:  [98.67339927 -0.42447212 -0.96066471]
mat_Sqrt:  [[24.69692074  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00054447 -0.02453808  0.31553008]
Stock Position:  -0.0005444669186590295
Bond Position:  [-10.66125108]


portfolio before change:  [-10.72041656]
curr_Stock_Price:  98.87381970352367
curr_Factors:  [98.8738197  -0.18473291 -0.94657017]
mat_Sqrt:  [[31.89793929  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00276902 -0.01640887 -0.18201953]
Stock Position:  -0.002769023554313106
Bond Position:  [-10.44663262]


portfolio before change:  [-10.70859231]
curr_Stock_Price:  92.71682253620918
curr_Factors:  [92.71682254  0.29004439 -0.9206774 ]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-10.70859231]
Stock Price:  92.742668560125
PL:  [-10.70859231]
Settle:  Tensor("sub_108:0", shape=(), dtype=float64)
PL:  Tensor("sub_109:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  55
output_Z_Vals[:, i, :]:  [[ 1.19279309e+02 -2.92921948e+01 -2.92556094e+01]
 [-3.23577181e-02  1.50502059e-01  2.32520706e-01]
 [ 1.18772904e+00  9.12812119e-02 -4.18984143e-01]
 [ 3.66064928e-01 -2.27277012e-01 -1.23702871e-01]
 [-4.27303343e-01  5.69636415e-01  6.60079534e-01]
 [ 6.26273560e-02 -2.20300462e-02  1.08936890e-02]
 [ 3.96348394e-02 -4.14606948e-02  1.85068448e-01]
 [ 5.80612969e-02 -8.78802597e-02  8.65875412e-03]
 [-3.98834078e-02 -6.23210321e-02 -3.60682419e-02]
 [-1.48124539e-02 -9.41218016e-02 -1.15547757e-03]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.27930914 -29.29219478 -29.25560936]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  8.31647217  -9.26300532 -83.45811031]
init_Out:  [2.54002979]
Stock Position:  8.316472170547405
Bond position:  [-829.10718727]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-14.49236935]
curr_Stock_Price:  98.00182799320903
curr_Factors:  [98.00182799 -0.33862112 -0.97884266]
mat_Sqrt:  [[26.24622991  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00072358 0.04759293 0.66331685]
Stock Position:  0.0007235827333233703
Bond Position:  [-14.56328178]


portfolio before change:  [-14.5019632]
curr_Stock_Price:  94.80883754106918
curr_Factors:  [94.80883754  0.49673267 -0.93440741]
mat_Sqrt:  [[61.20249092  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01804765  0.02886565 -1.19524514]
Stock Position:  0.018047650004153162
Bond Position:  [-16.21303992]


portfolio before change:  [-14.49052015]
curr_Stock_Price:  95.89216949517787
curr_Factors:  [95.8921695  -0.47559769 -0.93570519]
mat_Sqrt:  [[23.38094668  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01432559 -0.0718713  -0.35288986]
Stock Position:  0.014325592642440519
Bond Position:  [-15.86423231]


portfolio before change:  [-14.54655453]
curr_Stock_Price:  92.53452282645617
curr_Factors:  [92.53452283 -0.13060505 -0.91337685]
mat_Sqrt:  [[32.57678414  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0085293   0.18013485  1.88302318]
Stock Position:  -0.008529301799891665
Bond Position:  [-13.75729966]


portfolio before change:  [-14.57381351]
curr_Stock_Price:  94.92376909131889
curr_Factors:  [94.92376909 -0.39223853 -0.91907917]
mat_Sqrt:  [[25.57860959  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00251312 -0.00696651  0.03107666]
Stock Position:  0.002513123606157337
Bond Position:  [-14.81236867]


portfolio before change:  [-14.57726361]
curr_Stock_Price:  96.49867225529064
curr_Factors:  [96.49867226 -0.63016129 -0.91390887]
mat_Sqrt:  [[20.60346141  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00370526 -0.01311102  0.52794877]
Stock Position:  0.0037052641883467932
Bond Position:  [-14.93481669]


portfolio before change:  [-14.58449128]
curr_Stock_Price:  96.56387901017133
curr_Factors:  [96.56387901 -0.2668856  -0.87929965]
mat_Sqrt:  [[30.69253608  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00187536 -0.02779018  0.02470102]
Stock Position:  0.0018753647135067654
Bond Position:  [-14.76558377]


portfolio before change:  [-14.58842561]
curr_Stock_Price:  98.40368771070624
curr_Factors:  [98.40368771 -0.38565051 -0.93232322]
mat_Sqrt:  [[26.34041763  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00185475 -0.01970764 -0.10289265]
Stock Position:  -0.0018547514940434248
Bond Position:  [-14.40591122]


portfolio before change:  [-14.59225972]
curr_Stock_Price:  96.58638416695595
curr_Factors:  [96.58638417 -0.40958911 -0.90703074]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-14.59225972]
Stock Price:  95.40393874660656
PL:  [-14.59225972]
Settle:  Tensor("sub_110:0", shape=(), dtype=float64)
PL:  Tensor("sub_111:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  56
output_Z_Vals[:, i, :]:  [[ 1.19279309e+02 -2.92921948e+01 -2.92556094e+01]
 [-7.04779654e-02 -1.14653620e-01 -1.72427800e-03]
 [ 8.50024945e-01  7.79880760e-02 -3.75148492e-01]
 [ 3.47990322e-01 -2.10144373e-01 -1.19418431e-01]
 [-2.95651911e-01  3.46827732e-01  4.44841022e-01]
 [ 7.54660440e-02  3.38616520e-02 -2.56653447e-04]
 [ 8.46541278e-02 -2.05362988e-02  5.62571848e-02]
 [-5.35667184e-02 -9.87627562e-02  1.03381980e-01]
 [ 9.38241205e-02 -9.11684107e-02  6.44283888e-02]
 [ 7.21700344e-03  4.92011141e-02  1.26888914e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.27930914 -29.29219478 -29.25560936]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  8.31647217  -9.26300532 -83.45811031]
init_Out:  [2.54002979]
Stock Position:  8.316472170547405
Bond position:  [-829.10718727]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-4.60695863]
curr_Stock_Price:  99.19048233103115
curr_Factors:  [99.19048233 -1.09992125 -1.0668755 ]
mat_Sqrt:  [[11.36166901  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00649467 -0.03625666 -0.00491889]
Stock Position:  -0.006494668683418497
Bond Position:  [-3.96274931]


portfolio before change:  [-4.59829577]
curr_Stock_Price:  97.55148792256738
curr_Factors:  [97.55148792 -0.85304795 -1.02126843]
mat_Sqrt:  [[14.97023561  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.05180024  0.024662   -1.07019423]
Stock Position:  0.05180023504882928
Bond Position:  [-9.65148578]


portfolio before change:  [-4.64718273]
curr_Stock_Price:  96.70091252380075
curr_Factors:  [96.70091252 -0.85464823 -1.02916652]
mat_Sqrt:  [[14.69942067  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.02164631 -0.06645349 -0.34066755]
Stock Position:  0.02164631109482494
Bond Position:  [-6.74040076]


portfolio before change:  [-4.67247139]
curr_Stock_Price:  95.68837907483072
curr_Factors:  [95.68837907 -0.41329797 -1.01332377]
mat_Sqrt:  [[22.97657271  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00852582  0.10967656  1.26900762]
Stock Position:  -0.008525817429828261
Bond Position:  [-3.85664974]


portfolio before change:  [-4.67591287]
curr_Stock_Price:  95.86580259779983
curr_Factors:  [95.8658026  -0.88582222 -1.05420607]
mat_Sqrt:  [[13.77590476  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00553778  0.01070799 -0.00073216]
Stock Position:  0.005537782107599656
Bond Position:  [-5.2067968]


portfolio before change:  [-4.674594]
curr_Stock_Price:  96.5741957092583
curr_Factors:  [96.57419571 -1.18662919 -1.04614519]
mat_Sqrt:  [[10.35570116  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00923234 -0.00649415  0.16048609]
Stock Position:  0.009232337934739956
Bond Position:  [-5.56619961]


portfolio before change:  [-4.65738207]
curr_Stock_Price:  98.74003122715715
curr_Factors:  [98.74003123 -1.01944481 -1.10257488]
mat_Sqrt:  [[11.8280137   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00296026 -0.03123153  0.29492001]
Stock Position:  -0.002960260649269573
Bond Position:  [-4.36508584]


portfolio before change:  [-4.65381938]
curr_Stock_Price:  96.79906067745084
curr_Factors:  [96.79906068 -0.47557748 -1.10044403]
mat_Sqrt:  [[20.017678    0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00522646 -0.02882998  0.18379626]
Stock Position:  0.005226457934594888
Bond Position:  [-5.15973559]


portfolio before change:  [-4.64449018]
curr_Stock_Price:  99.07779553167505
curr_Factors:  [99.07779553 -0.25657215 -1.100593  ]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-4.64449018]
Stock Price:  93.90522398438371
PL:  [-4.64449018]
Settle:  Tensor("sub_112:0", shape=(), dtype=float64)
PL:  Tensor("sub_113:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  57
output_Z_Vals[:, i, :]:  [[ 1.19279309e+02 -2.92921948e+01 -2.92556094e+01]
 [-5.98576841e-02 -2.73753777e-02  7.43395560e-02]
 [ 1.42975274e-01  2.69522581e-02  1.78266570e-02]
 [ 1.10372063e-01 -9.73044470e-03 -1.91584305e-01]
 [-5.69984917e-02  2.19092910e-02  8.12944820e-02]
 [ 4.98238303e-02 -5.01237754e-02  2.51741751e-02]
 [ 7.42537052e-02  1.92503720e-02 -1.84809948e-01]
 [-1.33548139e-01 -4.26841597e-02  1.59112169e-02]
 [-8.40138312e-02 -5.82021215e-02 -6.55122272e-02]
 [ 1.61423473e-02  1.03905747e-01  1.58195615e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.27930914 -29.29219478 -29.25560936]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  8.31647217  -9.26300532 -83.45811031]
init_Out:  [2.54002979]
Stock Position:  8.316472170547405
Bond position:  [-829.10718727]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [10.53267808]
curr_Stock_Price:  101.01092210387831
curr_Factors:  [101.0109221   -0.74562498  -1.02048553]
mat_Sqrt:  [[17.27254316  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00262787 -0.00865685  0.21207006]
Stock Position:  -0.0026278709828853695
Bond Position:  [10.79812175]


portfolio before change:  [10.53648047]
curr_Stock_Price:  101.6190284107746
curr_Factors:  [101.61902841  -0.92322396  -1.05570138]
mat_Sqrt:  [[14.04554774  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01048802 0.00852305 0.05085449]
Stock Position:  0.010488023129848601
Bond Position:  [9.47069775]


portfolio before change:  [10.51851818]
curr_Stock_Price:  99.45476706415138
curr_Factors:  [99.45476706 -0.94058219 -1.04844431]
mat_Sqrt:  [[13.60825279  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00521844 -0.00307704 -0.54653669]
Stock Position:  0.005218439297093372
Bond Position:  [9.99951951]


portfolio before change:  [10.52707565]
curr_Stock_Price:  100.13628670127217
curr_Factors:  [100.1362867   -0.91052762  -1.10013126]
mat_Sqrt:  [[13.40829093  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00297119  0.00692833  0.23191053]
Stock Position:  -0.0029711937038362428
Bond Position:  [10.82459996]


portfolio before change:  [10.5349401]
curr_Stock_Price:  99.31143556475635
curr_Factors:  [99.31143556 -1.100325   -1.0704394 ]
mat_Sqrt:  [[11.33047873  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00473663 -0.01585053  0.07181491]
Stock Position:  0.004736631013084708
Bond Position:  [10.06453848]


portfolio before change:  [10.54505772]
curr_Stock_Price:  100.38479098003315
curr_Factors:  [100.38479098  -1.13673846  -1.11276097]
mat_Sqrt:  [[10.58577672  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00349777  0.0060875  -0.52721134]
Stock Position:  0.0034977664821336085
Bond Position:  [10.19393516]


portfolio before change:  [10.54829501]
curr_Stock_Price:  99.85275226656128
curr_Factors:  [99.85275227 -0.95030458 -1.16500566]
mat_Sqrt:  [[12.04182955  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01091216 -0.01349792  0.04539027]
Stock Position:  -0.010912160401178907
Bond Position:  [11.63790426]


portfolio before change:  [10.56179426]
curr_Stock_Price:  99.14905645755763
curr_Factors:  [99.14905646 -0.77726204 -1.11325215]
mat_Sqrt:  [[14.97092743  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00660542 -0.01840513 -0.18688815]
Stock Position:  -0.006605417823725905
Bond Position:  [11.2167152]


portfolio before change:  [10.561652]
curr_Stock_Price:  100.01986016113946
curr_Factors:  [100.01986016  -0.48772653  -1.09604605]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [10.561652]
Stock Price:  96.43406831333384
PL:  [10.561652]
Settle:  Tensor("sub_114:0", shape=(), dtype=float64)
PL:  Tensor("sub_115:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  58
output_Z_Vals[:, i, :]:  [[ 1.19279309e+02 -2.92921948e+01 -2.92556094e+01]
 [-7.04779654e-02 -1.14653620e-01 -1.72427800e-03]
 [ 1.12407536e-01  1.78821124e-02  3.74206670e-02]
 [-6.50657302e-02  1.07058410e-01 -2.00564098e-01]
 [-7.04500256e-02  4.62953268e-02  1.03841585e-01]
 [ 4.06709243e-02 -6.80030160e-02  3.42437024e-02]
 [ 8.18714314e-02 -1.25757172e-02 -4.80212959e-02]
 [-2.14391669e-01  5.10309224e-02 -1.58828687e-01]
 [-2.73504348e-02  2.66293061e-02 -1.19820717e-01]
 [ 7.19466291e-02  3.78047449e-01 -6.21197910e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.27930914 -29.29219478 -29.25560936]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  8.31647217  -9.26300532 -83.45811031]
init_Out:  [2.54002979]
Stock Position:  8.316472170547405
Bond position:  [-829.10718727]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [3.5183971]
curr_Stock_Price:  100.16750186014278
curr_Factors:  [100.16750186  -1.0206397   -1.0697864 ]
mat_Sqrt:  [[12.3841533   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00595844 -0.03625666 -0.00491889]
Stock Position:  -0.005958443352357047
Bond Position:  [4.11523948]


portfolio before change:  [3.51091722]
curr_Stock_Price:  101.76825782344291
curr_Factors:  [101.76825782  -0.87995749  -1.12536373]
mat_Sqrt:  [[13.69974231  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00879635 0.00565482 0.10675075]
Stock Position:  0.008796348772041943
Bond Position:  [2.61572813]


portfolio before change:  [3.50404793]
curr_Stock_Price:  100.83861308218054
curr_Factors:  [100.83861308  -0.97943285  -1.09808996]
mat_Sqrt:  [[12.62903506  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00817493  0.03385484 -0.57215354]
Stock Position:  -0.00817492931225037
Bond Position:  [4.32839646]


portfolio before change:  [3.51183859]
curr_Stock_Price:  100.15042075298639
curr_Factors:  [100.15042075  -0.46788866  -1.04307032]
mat_Sqrt:  [[22.10302075  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00217428  0.01463987  0.29623114]
Stock Position:  -0.0021742779441359466
Bond Position:  [3.72959344]


portfolio before change:  [3.51465131]
curr_Stock_Price:  99.71466415415813
curr_Factors:  [99.71466415 -0.77560325 -1.0276973 ]
mat_Sqrt:  [[16.42841074  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00279425 -0.02150444  0.09768775]
Stock Position:  0.002794248398972464
Bond Position:  [3.23602377]


portfolio before change:  [3.5165347]
curr_Stock_Price:  99.80949115445294
curr_Factors:  [99.80949115 -0.77421366 -1.02308802]
mat_Sqrt:  [[16.54297599  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00433685 -0.00397679 -0.13699139]
Stock Position:  0.004336850991104129
Bond Position:  [3.08367581]


portfolio before change:  [3.53135235]
curr_Stock_Price:  102.8705671534448
curr_Factors:  [102.87056715  -0.92990323  -1.02723274]
mat_Sqrt:  [[14.53174547  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01689369  0.01613739 -0.45309403]
Stock Position:  -0.016893691622165675
Bond Position:  [5.26921599]


portfolio before change:  [3.51536077]
curr_Stock_Price:  103.97315876491345
curr_Factors:  [103.97315876  -0.66124327  -1.0453079 ]
mat_Sqrt:  [[18.87015555  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0027091   0.00842093 -0.34181515]
Stock Position:  -0.002709101701105103
Bond Position:  [3.79703464]


portfolio before change:  [3.5150155]
curr_Stock_Price:  104.80157505880364
curr_Factors:  [104.80157506  -0.85132096  -1.10736456]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [3.5150155]
Stock Price:  103.92642499312451
PL:  [-0.41140949]
Settle:  Tensor("sub_116:0", shape=(), dtype=float64)
PL:  Tensor("sub_117:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  59
output_Z_Vals[:, i, :]:  [[ 1.19279309e+02 -2.92921948e+01 -2.92556094e+01]
 [-7.04779654e-02 -1.14653620e-01 -1.72427800e-03]
 [ 3.26806543e-01  7.24800366e-02 -1.93742205e-01]
 [-6.34597991e-02  1.08251375e-01 -1.88034117e-01]
 [-4.66744982e-02  3.44777760e-02  7.45793805e-02]
 [ 9.66815260e-02  1.03348294e-01 -2.12972428e-02]
 [ 7.57518962e-02  1.50469624e-02 -1.27443961e-01]
 [-9.32674010e-02 -7.24946134e-02  6.38654536e-02]
 [-1.11690715e-01 -4.75336658e-02 -9.08273139e-02]
 [ 2.18010746e-02  1.06110512e-01 -6.99868023e-03]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.27930914 -29.29219478 -29.25560936]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  8.31647217  -9.26300532 -83.45811031]
init_Out:  [2.54002979]
Stock Position:  8.316472170547405
Bond position:  [-829.10718727]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [14.48198594]
curr_Stock_Price:  101.4857998855073
curr_Factors:  [101.48579989  -1.12908568  -1.00826213]
mat_Sqrt:  [[11.97200583  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00616357 -0.03625666 -0.00491889]
Stock Position:  -0.006163568322507148
Bond Position:  [15.1075006]


portfolio before change:  [14.49280747]
curr_Stock_Price:  100.95592893738812
curr_Factors:  [100.95592894  -1.72422821  -0.9876685 ]
mat_Sqrt:  [[ 6.70455646  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.04312448  0.0229202  -0.55269258]
Stock Position:  0.04312447944313573
Bond Position:  [10.13913559]


portfolio before change:  [14.51098155]
curr_Stock_Price:  101.25977601862552
curr_Factors:  [101.25977602  -1.68821748  -0.97416947]
mat_Sqrt:  [[ 7.06605484  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01401731  0.03423209 -0.536409  ]
Stock Position:  -0.014017307574882915
Bond Position:  [15.93037098]


portfolio before change:  [14.53779229]
curr_Stock_Price:  99.91546918444295
curr_Factors:  [99.91546918 -1.48899123 -0.94559722]
mat_Sqrt:  [[ 8.75597281  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00349028  0.01090283  0.21275421]
Stock Position:  -0.0034902842033106953
Bond Position:  [14.88652568]


portfolio before change:  [14.54554555]
curr_Stock_Price:  99.82718739552075
curr_Factors:  [99.8271874  -1.7877205  -0.93801979]
mat_Sqrt:  [[ 6.53845097  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01452985  0.0326816  -0.06075511]
Stock Position:  0.014529846054663991
Bond Position:  [13.09507188]


portfolio before change:  [14.55026311]
curr_Stock_Price:  99.70112916238429
curr_Factors:  [99.70112916 -0.89337682 -0.9020986 ]
mat_Sqrt:  [[16.55522194  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00302781  0.00475827 -0.36356215]
Stock Position:  0.003027807035928073
Bond Position:  [14.24838733]


portfolio before change:  [14.55621012]
curr_Stock_Price:  99.3117485704895
curr_Factors:  [99.31174857 -1.52291534 -0.88494695]
mat_Sqrt:  [[ 8.93880213  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00918498 -0.02292481  0.18219036]
Stock Position:  -0.00918498043777336
Bond Position:  [15.46838659]


portfolio before change:  [14.55052181]
curr_Stock_Price:  100.77331281864024
curr_Factors:  [100.77331282  -1.25225225  -0.85667276]
mat_Sqrt:  [[12.23069239  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01074821 -0.01503146 -0.25910505]
Stock Position:  -0.01074821216538607
Bond Position:  [15.63365475]


portfolio before change:  [14.55042507]
curr_Stock_Price:  101.50976266748859
curr_Factors:  [101.50976267  -1.72502657  -0.84778057]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [14.55042507]
Stock Price:  101.6486287708382
PL:  [12.9017963]
Settle:  Tensor("sub_118:0", shape=(), dtype=float64)
PL:  Tensor("sub_119:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  60
output_Z_Vals[:, i, :]:  [[ 1.19279309e+02 -2.92921948e+01 -2.92556094e+01]
 [-7.04779654e-02 -1.14653620e-01 -1.72427800e-03]
 [ 3.98305612e-01  6.77905707e-02 -2.59468214e-01]
 [ 5.83278406e-02  2.38267006e-02 -2.01067174e-01]
 [-9.91607620e-02  7.88132436e-02  1.45354530e-01]
 [ 5.35172648e-02 -3.80267436e-02  2.15111880e-02]
 [ 7.42346865e-02  1.68910950e-02 -2.21288022e-01]
 [-1.09788193e-01 -5.41984473e-02  2.90923365e-02]
 [-1.27328504e-01 -1.85690660e-02 -1.27008851e-01]
 [-6.01164264e-03 -3.50295595e-02  4.71524261e-03]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.27930914 -29.29219478 -29.25560936]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  8.31647217  -9.26300532 -83.45811031]
init_Out:  [2.54002979]
Stock Position:  8.316472170547405
Bond position:  [-829.10718727]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-0.6867745]
curr_Stock_Price:  99.66185817939984
curr_Factors:  [99.66185818 -1.31469134 -1.02225641]
mat_Sqrt:  [[ 9.62953833  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00766291 -0.03625666 -0.00491889]
Stock Position:  -0.007662908995696679
Bond Position:  [0.07692525]


portfolio before change:  [-0.68898452]
curr_Stock_Price:  99.95528362787071
curr_Factors:  [99.95528363 -1.16407757 -1.03494319]
mat_Sqrt:  [[11.0862119   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.03130846  0.02143726 -0.74019059]
Stock Position:  0.03130846068340218
Bond Position:  [-3.81843059]


portfolio before change:  [-0.69495828]
curr_Stock_Price:  99.82547639686723
curr_Factors:  [99.8254764  -0.97213491 -1.03575578]
mat_Sqrt:  [[13.40372612  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00133548  0.00753466 -0.57358868]
Stock Position:  0.0013354777807886868
Bond Position:  [-0.82827299]


portfolio before change:  [-0.69600097]
curr_Stock_Price:  99.35489682542882
curr_Factors:  [99.35489683 -0.83843593 -0.97409345]
mat_Sqrt:  [[16.21876446  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0041591   0.02492294  0.41465601]
Stock Position:  -0.004159098790156764
Bond Position:  [-0.28277414]


portfolio before change:  [-0.69455395]
curr_Stock_Price:  98.97297686097033
curr_Factors:  [98.97297686 -0.9633033  -0.86307783]
mat_Sqrt:  [[15.93416785  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0035726  -0.01202511  0.06136543]
Stock Position:  0.003572597695430105
Bond Position:  [-1.04814458]


portfolio before change:  [-0.69839883]
curr_Stock_Price:  98.04349040908626
curr_Factors:  [98.04349041 -1.24545118 -0.82429058]
mat_Sqrt:  [[12.3748898   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00238391  0.00534143 -0.63127313]
Stock Position:  0.002383906826768675
Bond Position:  [-0.93212538]


portfolio before change:  [-0.69502445]
curr_Stock_Price:  99.65452779474325
curr_Factors:  [99.65452779 -1.0729621  -0.79920124]
mat_Sqrt:  [[15.32592976  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00686739 -0.01713905  0.08299234]
Stock Position:  -0.0068673903534155175
Bond Position:  [-0.01065791]


portfolio before change:  [-0.70696378]
curr_Stock_Price:  101.39230545370602
curr_Factors:  [101.39230545  -0.52997187  -0.77854755]
mat_Sqrt:  [[27.39821283  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00561108 -0.00587205 -0.3623209 ]
Stock Position:  -0.005611078686810004
Bond Position:  [-0.13804357]


portfolio before change:  [-0.69208186]
curr_Stock_Price:  98.72776269029718
curr_Factors:  [98.72776269 -0.33591164 -0.80003634]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-0.69208186]
Stock Price:  101.59566243965291
PL:  [-2.2877443]
Settle:  Tensor("sub_120:0", shape=(), dtype=float64)
PL:  Tensor("sub_121:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  61
output_Z_Vals[:, i, :]:  [[ 1.19279309e+02 -2.92921948e+01 -2.92556094e+01]
 [-7.04779654e-02 -1.14653620e-01 -1.72427800e-03]
 [ 1.82145996e-01  3.30938432e-02  2.14502231e-03]
 [ 1.80417927e-01 -5.25569187e-02 -1.64178383e-01]
 [-4.58600080e-02  1.17351743e-02  6.60157093e-02]
 [ 4.20141154e-02 -6.12772431e-02  3.29100601e-02]
 [ 7.80527523e-02  1.24848763e-02 -1.66046271e-01]
 [-1.59667277e-01 -2.65230695e-03 -9.45164773e-02]
 [-1.50450145e-02  2.62408451e-02 -1.12874962e-01]
 [ 6.90556516e-02  3.53395023e-01 -1.84741172e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.27930914 -29.29219478 -29.25560936]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  8.31647217  -9.26300532 -83.45811031]
init_Out:  [2.54002979]
Stock Position:  8.316472170547405
Bond position:  [-829.10718727]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [14.64359537]
curr_Stock_Price:  101.50523233653888
curr_Factors:  [101.50523234  -1.13890886  -0.98153244]
mat_Sqrt:  [[12.17846283  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00605908 -0.03625666 -0.00491889]
Stock Position:  -0.006059079616273007
Bond Position:  [15.25862366]


portfolio before change:  [14.64972848]
curr_Stock_Price:  101.75248363918918
curr_Factors:  [101.75248364  -1.32516447  -1.0185043 ]
mat_Sqrt:  [[ 9.7656826   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01878397 0.01046519 0.00611915]
Stock Position:  0.01878397379170328
Bond Position:  [12.73841249]


portfolio before change:  [14.6056734]
curr_Stock_Price:  99.06796792498253
curr_Factors:  [99.06796792 -1.26820273 -0.98145425]
mat_Sqrt:  [[10.44526928  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01393436 -0.01661996 -0.46835523]
Stock Position:  0.013934359889174961
Bond Position:  [13.22522469]


portfolio before change:  [14.62992633]
curr_Stock_Price:  100.33380730733056
curr_Factors:  [100.33380731  -0.8217597   -1.0097578 ]
mat_Sqrt:  [[16.07049842  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0019963   0.00371099  0.18832444]
Stock Position:  -0.001996304411828531
Bond Position:  [14.83022315]


portfolio before change:  [14.63634559]
curr_Stock_Price:  100.83358456851903
curr_Factors:  [100.83358457  -0.87771096  -1.028117  ]
mat_Sqrt:  [[14.99390101  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00314459 -0.01937757  0.09388324]
Stock Position:  0.003144590698363234
Bond Position:  [14.31926524]


portfolio before change:  [14.64936049]
curr_Stock_Price:  102.69502891114931
curr_Factors:  [102.69502891  -1.20077919  -1.04250012]
mat_Sqrt:  [[10.89696594  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00408197  0.00394806 -0.47368379]
Stock Position:  0.0040819671722800936
Bond Position:  [14.23016276]


portfolio before change:  [14.66632121]
curr_Stock_Price:  105.10657523652073
curr_Factors:  [105.10657524  -1.23949862  -1.00169722]
mat_Sqrt:  [[11.17611603  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01601888 -0.00083873 -0.2696292 ]
Stock Position:  -0.016018879323982896
Bond Position:  [16.35001075]


portfolio before change:  [14.69208497]
curr_Stock_Price:  104.00870092401158
curr_Factors:  [104.00870092  -1.10885951  -0.96694481]
mat_Sqrt:  [[13.04846152  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00286685  0.00829808 -0.32200085]
Stock Position:  -0.0028668501559031977
Bond Position:  [14.99026233]


portfolio before change:  [14.70141371]
curr_Stock_Price:  103.36976672687774
curr_Factors:  [103.36976673  -0.79239171  -0.98601456]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [14.70141371]
Stock Price:  101.70945824787528
PL:  [12.99195546]
Settle:  Tensor("sub_122:0", shape=(), dtype=float64)
PL:  Tensor("sub_123:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  62
output_Z_Vals[:, i, :]:  [[ 1.19279309e+02 -2.92921948e+01 -2.92556094e+01]
 [-6.47673605e-02 -6.46003910e-02  4.16925534e-02]
 [ 5.02217255e-01  7.18117390e-02 -2.73476483e-01]
 [ 1.97765237e-01 -7.05718349e-02 -2.03796029e-01]
 [-1.73073113e-01  1.78889514e-01  2.57761190e-01]
 [ 4.20597572e-02 -6.23748721e-02  3.28656115e-02]
 [ 8.73464367e-02 -2.80371258e-02  1.60129511e-01]
 [-8.26848258e-02 -5.27534766e-02  3.65863660e-02]
 [-6.13941753e-02 -5.33147504e-02 -5.52461964e-02]
 [-1.49505793e-02 -9.46681586e-02 -1.03849376e-03]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.27930914 -29.29219478 -29.25560936]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  8.31647217  -9.26300532 -83.45811031]
init_Out:  [2.54002979]
Stock Position:  8.316472170547405
Bond position:  [-829.10718727]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [18.9919924]
curr_Stock_Price:  102.02809791479714
curr_Factors:  [102.02809791  -0.763569    -1.00398778]
mat_Sqrt:  [[17.42126295  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00332495 -0.02042844  0.11893725]
Stock Position:  -0.003324952890465421
Bond Position:  [19.33123102]


portfolio before change:  [19.01136693]
curr_Stock_Price:  99.1088117633224
curr_Factors:  [99.10881176 -0.7491638  -1.02121603]
mat_Sqrt:  [[16.87508926  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.02656272  0.02270887 -0.78015228]
Stock Position:  0.026562720133282168
Bond Position:  [16.3787673]


portfolio before change:  [19.00254599]
curr_Stock_Price:  98.46835163159106
curr_Factors:  [98.46835163 -0.2291606  -0.99215901]
mat_Sqrt:  [[29.03249107  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00531623 -0.02231677 -0.58137334]
Stock Position:  0.005316229644302228
Bond Position:  [18.47906562]


portfolio before change:  [19.01242848]
curr_Stock_Price:  98.58885826269236
curr_Factors:  [ 9.85888583e+01 -8.77124342e-02 -9.87533406e-01]
mat_Sqrt:  [[33.63988497  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0034435   0.05656983  0.73532093]
Stock Position:  -0.0034434993771153047
Bond Position:  [19.35191915]


portfolio before change:  [19.01821533]
curr_Stock_Price:  99.71896704564469
curr_Factors:  [99.71896705 -0.13212017 -1.00026106]
mat_Sqrt:  [[32.13592831  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00146745 -0.01972467  0.09375644]
Stock Position:  0.0014674512995280628
Bond Position:  [18.8718826]


portfolio before change:  [19.02611131]
curr_Stock_Price:  98.66794513972637
curr_Factors:  [98.66794514 -0.38837065 -1.0026833 ]
mat_Sqrt:  [[24.54986048  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00485986 -0.00886612  0.45680492]
Stock Position:  0.00485985738911178
Bond Position:  [18.54659916]


portfolio before change:  [19.03900068]
curr_Stock_Price:  99.41153773820032
curr_Factors:  [ 9.94115377e+01  8.20580478e-02 -9.46610197e-01]
mat_Sqrt:  [[41.87613236  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0018287  -0.01668211  0.10437072]
Stock Position:  -0.001828696913506747
Bond Position:  [19.22079425]


portfolio before change:  [19.04987795]
curr_Stock_Price:  98.7200741093932
curr_Factors:  [98.72007411 -0.11745558 -0.90799435]
mat_Sqrt:  [[35.40448061  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00209148 -0.0168596  -0.15760202]
Stock Position:  -0.0020914821382549426
Bond Position:  [19.25634923]


portfolio before change:  [19.06442092]
curr_Stock_Price:  96.37131617068985
curr_Factors:  [96.37131617  0.3951184  -0.94425315]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [19.06442092]
Stock Price:  102.85021825797304
PL:  [16.21420266]
Settle:  Tensor("sub_124:0", shape=(), dtype=float64)
PL:  Tensor("sub_125:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  63
output_Z_Vals[:, i, :]:  [[ 1.19279309e+02 -2.92921948e+01 -2.92556094e+01]
 [-7.04779654e-02 -1.14653620e-01 -1.72427800e-03]
 [ 2.11484499e-01  6.20438618e-02 -1.20786429e-01]
 [ 1.28640123e-03  6.03373813e-02 -2.13142835e-01]
 [ 2.07265556e-02 -7.38557868e-02 -2.83294616e-02]
 [ 1.13262763e-01  2.70542682e-01 -3.78157367e-02]
 [ 9.90099847e-02  6.87114064e-03 -2.49235707e-01]
 [-1.05406060e-01 -5.58811723e-02 -3.07485935e-02]
 [ 4.80223862e-02  1.01462425e-01 -1.62299808e-01]
 [ 6.57880056e-02  3.91164432e-01 -2.02127901e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.27930914 -29.29219478 -29.25560936]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  8.31647217  -9.26300532 -83.45811031]
init_Out:  [2.54002979]
Stock Position:  8.316472170547405
Bond position:  [-829.10718727]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [4.62086063]
curr_Stock_Price:  100.30006570618255
curr_Factors:  [100.30006571  -1.08553699  -1.04382653]
mat_Sqrt:  [[11.92697732  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00618684 -0.03625666 -0.00491889]
Stock Position:  -0.006186837947934926
Bond Position:  [5.24140088]


portfolio before change:  [4.62030158]
curr_Stock_Price:  100.81412623272062
curr_Factors:  [100.81412623  -0.86091173  -1.04255171]
mat_Sqrt:  [[15.02649606  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01253992  0.01961999 -0.34457006]
Stock Position:  0.012539918646390907
Bond Position:  [3.35610064]


portfolio before change:  [4.61399435]
curr_Stock_Price:  100.17730384872826
curr_Factors:  [100.17730385  -0.72286081  -1.07212314]
mat_Sqrt:  [[16.64246748  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00244335  0.01908036 -0.60803718]
Stock Position:  -0.0024433452126540883
Bond Position:  [4.85876208]


portfolio before change:  [4.61301205]
curr_Stock_Price:  101.57386804764981
curr_Factors:  [101.57386805  -0.39814334  -1.09362145]
mat_Sqrt:  [[22.85160834  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0005705  -0.02335525 -0.08081607]
Stock Position:  0.000570501648217258
Bond Position:  [4.55506399]


portfolio before change:  [4.61727901]
curr_Stock_Price:  105.0600252329668
curr_Factors:  [105.06002523  -0.85322202  -1.14261251]
mat_Sqrt:  [[14.27767784  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00788147  0.08555311 -0.10787777]
Stock Position:  0.00788146654385442
Bond Position:  [3.78925193]


portfolio before change:  [4.63199532]
curr_Stock_Price:  106.68678044419812
curr_Factors:  [106.68678044  -1.35217361  -1.146187  ]
mat_Sqrt:  [[ 8.77175274  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00550772  0.00217285 -0.7110001 ]
Stock Position:  0.005507721504047212
Bond Position:  [4.04439425]


portfolio before change:  [4.63327692]
curr_Stock_Price:  106.55222220708553
curr_Factors:  [106.55222221  -1.52039975  -1.17076426]
mat_Sqrt:  [[ 7.22445076  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01565869 -0.01767118 -0.08771718]
Stock Position:  -0.01565869014410653
Bond Position:  [6.30174515]


portfolio before change:  [4.61220448]
curr_Stock_Price:  108.09922897833765
curr_Factors:  [108.09922898  -1.66205421  -1.27266077]
mat_Sqrt:  [[ 5.74502701  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00304835  0.03208524 -0.46299618]
Stock Position:  0.0030483451199250604
Bond Position:  [4.28268072]


portfolio before change:  [4.61592012]
curr_Stock_Price:  108.61549882803207
curr_Factors:  [108.61549883  -2.14297082  -1.20924179]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [4.61592012]
Stock Price:  109.09042049681527
PL:  [-4.47450037]
Settle:  Tensor("sub_126:0", shape=(), dtype=float64)
PL:  Tensor("sub_127:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  64
output_Z_Vals[:, i, :]:  [[ 1.19279309e+02 -2.92921948e+01 -2.92556094e+01]
 [-7.04779654e-02 -1.14653620e-01 -1.72427800e-03]
 [ 4.70054397e-01  6.99466410e-02 -2.73807795e-01]
 [ 3.07321520e-01 -1.45799627e-01 -1.41544001e-01]
 [-2.93647249e-01  3.43857013e-01  4.41706125e-01]
 [ 8.39969001e-02  6.18025937e-02 -8.71718430e-03]
 [ 8.73464367e-02 -2.80371258e-02  1.60129511e-01]
 [ 2.50266726e-02 -1.04942514e-01  3.42607726e-02]
 [-5.50144946e-02 -6.61461538e-02 -4.25523083e-02]
 [-1.45801883e-02 -8.52155024e-02  3.69756351e-03]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.27930914 -29.29219478 -29.25560936]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  8.31647217  -9.26300532 -83.45811031]
init_Out:  [2.54002979]
Stock Position:  8.316472170547405
Bond position:  [-829.10718727]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [1.36882699]
curr_Stock_Price:  99.90903047170741
curr_Factors:  [99.90903047 -1.27704918 -1.02137354]
mat_Sqrt:  [[10.03257552  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00735507 -0.03625666 -0.00491889]
Stock Position:  -0.007355068070082789
Bond Position:  [2.10366471]


portfolio before change:  [1.37298358]
curr_Stock_Price:  99.48694088337894
curr_Factors:  [99.48694088 -1.0117161  -1.02302174]
mat_Sqrt:  [[13.00441017  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.03198681  0.02211907 -0.78109742]
Stock Position:  0.03198681246292911
Bond Position:  [-1.80928654]


portfolio before change:  [1.30803444]
curr_Stock_Price:  97.48473227634369
curr_Factors:  [97.48473228 -0.86415861 -1.01074554]
mat_Sqrt:  [[14.95120098  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01837073 -0.04610589 -0.40378564]
Stock Position:  0.01837072767254968
Bond Position:  [-0.48283103]


portfolio before change:  [1.27867905]
curr_Stock_Price:  95.89993290484577
curr_Factors:  [95.8999329  -0.2514316  -0.99373179]
mat_Sqrt:  [[27.60900239  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00704864  0.10873714  1.26006463]
Stock Position:  -0.007048643438452337
Bond Position:  [1.95464348]


portfolio before change:  [1.27820903]
curr_Stock_Price:  96.10530340334564
curr_Factors:  [96.1053034  -0.99697129 -0.97062075]
mat_Sqrt:  [[13.43485507  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00623849  0.0195437  -0.0248677 ]
Stock Position:  0.006238492930053171
Bond Position:  [0.67865677]


portfolio before change:  [1.27683225]
curr_Stock_Price:  95.83020645689737
curr_Factors:  [95.83020646 -1.06706023 -0.98783175]
mat_Sqrt:  [[12.2764889   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00971848 -0.00886612  0.45680492]
Stock Position:  0.009718480734134654
Bond Position:  [0.34550824]


portfolio before change:  [1.28874015]
curr_Stock_Price:  97.03771008445251
curr_Factors:  [97.03771008 -1.06931441 -0.97779034]
mat_Sqrt:  [[12.52836048  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00233953 -0.03318574  0.09773645]
Stock Position:  0.0023395335353119102
Bond Position:  [1.06171717]


portfolio before change:  [1.29284698]
curr_Stock_Price:  98.56615282823923
curr_Factors:  [98.56615283 -0.85438038 -1.00026903]
mat_Sqrt:  [[15.42637204  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00424003 -0.02091725 -0.12138989]
Stock Position:  -0.00424003351913427
Bond Position:  [1.71077078]


portfolio before change:  [1.29634479]
curr_Stock_Price:  97.94299491534123
curr_Factors:  [97.94299492 -0.62558361 -0.99410773]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [1.29634479]
Stock Price:  99.71334705385904
PL:  [1.29634479]
Settle:  Tensor("sub_128:0", shape=(), dtype=float64)
PL:  Tensor("sub_129:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  65
output_Z_Vals[:, i, :]:  [[ 1.19279309e+02 -2.92921948e+01 -2.92556094e+01]
 [-5.56769155e-02  1.50770046e-02  1.10805778e-01]
 [ 6.76506175e-01  7.30866105e-02 -3.38116285e-01]
 [ 2.19372516e-02  5.27276430e-02 -1.73642839e-01]
 [ 7.76947959e-03 -2.96991268e-02 -5.14332204e-03]
 [ 6.37856666e-02  4.11633197e-02  1.12975921e-02]
 [ 8.58737176e-02  6.06804780e-03 -1.55372050e-01]
 [-1.72540778e-01  9.97626904e-03 -1.09645441e-01]
 [ 1.47717229e-02  2.54305919e-02 -9.68464250e-02]
 [ 6.67732155e-02  3.45374341e-01 -1.61557612e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.27930914 -29.29219478 -29.25560936]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  8.31647217  -9.26300532 -83.45811031]
init_Out:  [2.54002979]
Stock Position:  8.316472170547405
Bond position:  [-829.10718727]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-7.05995837]
curr_Stock_Price:  98.89552556379807
curr_Factors:  [98.89552556 -0.77776487 -1.00482525]
mat_Sqrt:  [[16.6344172   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00196397  0.00476777  0.31609804]
Stock Position:  -0.001963969866498471
Bond Position:  [-6.86573054]


portfolio before change:  [-7.06295872]
curr_Stock_Price:  98.67486006887417
curr_Factors:  [98.67486007 -1.20009767 -1.0091334 ]
mat_Sqrt:  [[10.83302285  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.05625166  0.02311202 -0.96455165]
Stock Position:  0.05625166436695104
Bond Position:  [-12.61358383]


portfolio before change:  [-6.98357964]
curr_Stock_Price:  100.19814737417212
curr_Factors:  [100.19814737  -1.65825938  -1.02534011]
mat_Sqrt:  [[ 6.84521732  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00177438  0.01667394 -0.49535469]
Stock Position:  -0.0017743808532563945
Bond Position:  [-6.80578997]


portfolio before change:  [-6.98873205]
curr_Stock_Price:  101.18365535975578
curr_Factors:  [101.18365536  -1.18753208  -1.07235978]
mat_Sqrt:  [[10.55970537  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00056373 -0.00939169 -0.01467247]
Stock Position:  0.0005637255024659357
Bond Position:  [-7.04577186]


portfolio before change:  [-6.99132844]
curr_Stock_Price:  102.82874022712002
curr_Factors:  [102.82874023  -1.06445741  -1.11496922]
mat_Sqrt:  [[11.63058482  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00577397 0.01301698 0.03222889]
Stock Position:  0.005773966769252307
Bond Position:  [-7.58505817]


portfolio before change:  [-6.99932912]
curr_Stock_Price:  102.10009127171688
curr_Factors:  [102.10009127  -0.95615665  -1.09677251]
mat_Sqrt:  [[13.10540141  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00414449  0.00191889 -0.44323321]
Stock Position:  0.004144490154052915
Bond Position:  [-7.42248194]


portfolio before change:  [-6.99068782]
curr_Stock_Price:  105.08078638381441
curr_Factors:  [105.08078638  -1.5491789   -1.10056519]
mat_Sqrt:  [[ 7.42598519  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02621396  0.00315477 -0.31278792]
Stock Position:  -0.026213959381554897
Bond Position:  [-4.23610436]


portfolio before change:  [-6.97393502]
curr_Stock_Price:  104.36088818341752
curr_Factors:  [104.36088818  -1.43789821  -1.06392771]
mat_Sqrt:  [[ 8.55083594  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00050759  0.00804186 -0.27627589]
Stock Position:  -0.0005075943211364435
Bond Position:  [-6.92096203]


portfolio before change:  [-6.97730984]
curr_Stock_Price:  104.19042423198913
curr_Factors:  [104.19042423  -1.65514169  -1.09957004]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-6.97730984]
Stock Price:  104.94238365722775
PL:  [-11.9196935]
Settle:  Tensor("sub_130:0", shape=(), dtype=float64)
PL:  Tensor("sub_131:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  66
output_Z_Vals[:, i, :]:  [[ 1.19279309e+02 -2.92921948e+01 -2.92556094e+01]
 [-5.98005515e-02 -4.44121556e-02  6.06412033e-02]
 [ 7.81423587e-01  7.82841162e-02 -3.43704386e-01]
 [ 1.58617122e-01 -4.54396517e-02 -2.11616819e-01]
 [ 4.21743976e-02 -9.26015946e-02 -6.06136953e-02]
 [ 1.19790980e-01  2.99162753e-01 -4.42948785e-02]
 [ 1.06442754e-01 -6.58584891e-03 -1.07333264e-01]
 [-2.07273182e-01  4.40478681e-02 -1.50463027e-01]
 [-1.03289986e-01 -5.36291358e-03 -1.27884569e-01]
 [ 3.80020540e-02  2.09183372e-01  2.85947404e-03]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.27930914 -29.29219478 -29.25560936]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  8.31647217  -9.26300532 -83.45811031]
init_Out:  [2.54002979]
Stock Position:  8.316472170547405
Bond position:  [-829.10718727]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-17.79889686]
curr_Stock_Price:  97.60424023734215
curr_Factors:  [97.60424024 -0.95347121 -0.9997103 ]
mat_Sqrt:  [[13.84244269  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0035087  -0.01404436  0.17299247]
Stock Position:  -0.0035086968190438258
Bond Position:  [-17.45643317]


portfolio before change:  [-17.80760358]
curr_Stock_Price:  97.5974913315467
curr_Factors:  [97.59749133 -0.5260799  -1.00816253]
mat_Sqrt:  [[21.04387118  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.03389521  0.02475561 -0.98049294]
Stock Position:  0.0338952136632605
Bond Position:  [-21.1156914]


portfolio before change:  [-17.76964892]
curr_Stock_Price:  99.02881846097124
curr_Factors:  [99.02881846 -0.36761619 -1.04343594]
mat_Sqrt:  [[24.15179662  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0047304  -0.01436928 -0.60368388]
Stock Position:  0.004730404738592551
Bond Position:  [-18.23809531]


portfolio before change:  [-17.7619127]
curr_Stock_Price:  102.5924769036771
curr_Factors:  [102.5924769   -0.68911448  -1.04779068]
mat_Sqrt:  [[18.06288795  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00151752 -0.0292832  -0.172914  ]
Stock Position:  0.001517515697345347
Bond Position:  [-17.9175984]


portfolio before change:  [-17.76696509]
curr_Stock_Price:  105.16816613152949
curr_Factors:  [105.16816613  -0.6824849   -1.02444032]
mat_Sqrt:  [[19.07990005  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00620934  0.09460357 -0.12636096]
Stock Position:  0.006209344608657452
Bond Position:  [-18.41999048]


portfolio before change:  [-17.78148356]
curr_Stock_Price:  104.31362052919232
curr_Factors:  [104.31362053  -0.61088923  -1.00606469]
mat_Sqrt:  [[20.7065076   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00407425 -0.00208263 -0.30619193]
Stock Position:  0.004074245593014432
Bond Position:  [-18.20648287]


portfolio before change:  [-17.7962933]
curr_Stock_Price:  102.91355331315955
curr_Factors:  [102.91355331  -0.44463544  -0.94937724]
mat_Sqrt:  [[25.53057269  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00927707  0.01392916 -0.42922913]
Stock Position:  -0.009277073815714154
Bond Position:  [-16.84155666]


portfolio before change:  [-17.79720726]
curr_Stock_Price:  102.1041473028722
curr_Factors:  [102.1041473   -0.3202021   -0.95549468]
mat_Sqrt:  [[28.51118787  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00454323 -0.0016959  -0.36481908]
Stock Position:  -0.004543226485517244
Bond Position:  [-17.33332499]


portfolio before change:  [-17.80161384]
curr_Stock_Price:  101.16599160036753
curr_Factors:  [101.1659916   -0.28214726  -0.95099377]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-17.80161384]
Stock Price:  101.70939344399804
PL:  [-19.51100728]
Settle:  Tensor("sub_132:0", shape=(), dtype=float64)
PL:  Tensor("sub_133:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  67
output_Z_Vals[:, i, :]:  [[ 1.19279309e+02 -2.92921948e+01 -2.92556094e+01]
 [-6.99408044e-02 -1.09945425e-01  2.35967231e-03]
 [ 6.16928612e-01  7.42119272e-02 -3.04277509e-01]
 [ 2.70817616e-01 -1.10980249e-01 -1.48554271e-01]
 [-1.87141073e-01  1.99278263e-01  2.79606539e-01]
 [ 3.78778333e-02 -8.09394880e-02  3.70162496e-02]
 [ 4.56128638e-02 -3.97787887e-02  1.81943724e-01]
 [-1.91579165e-01  2.30219455e-02 -1.09813879e-01]
 [-4.41859505e-02  8.22098611e-03 -1.11450842e-01]
 [ 7.25380420e-02  3.77322800e-01 -5.07117142e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.27930914 -29.29219478 -29.25560936]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  8.31647217  -9.26300532 -83.45811031]
init_Out:  [2.54002979]
Stock Position:  8.316472170547405
Bond position:  [-829.10718727]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [7.91702367]
curr_Stock_Price:  100.69640720476913
curr_Factors:  [100.6964072   -0.91156271  -1.00049306]
mat_Sqrt:  [[14.88054046  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00485855 -0.0347678   0.00673149]
Stock Position:  -0.004858554512741825
Bond Position:  [8.40626266]


portfolio before change:  [7.93202978]
curr_Stock_Price:  98.47312778824723
curr_Factors:  [98.47312779 -0.65420418 -1.06898791]
mat_Sqrt:  [[17.5770065   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.03167402  0.02346787 -0.86801904]
Stock Position:  0.03167401507073569
Bond Position:  [4.81299045]


portfolio before change:  [7.92580494]
curr_Stock_Price:  98.20060355217643
curr_Factors:  [98.20060355 -0.98921073 -1.14202671]
mat_Sqrt:  [[11.65546204  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.02038775 -0.03509504 -0.42378399]
Stock Position:  0.02038774645587217
Bond Position:  [5.92371593]


portfolio before change:  [7.91770517]
curr_Stock_Price:  97.65800458056016
curr_Factors:  [97.65800458 -0.68137251 -1.17538043]
mat_Sqrt:  [[15.2521226   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00819042  0.06301732  0.79763963]
Stock Position:  -0.00819041967425213
Bond Position:  [8.71756521]


portfolio before change:  [7.91287809]
curr_Stock_Price:  98.77967534871792
curr_Factors:  [98.77967535 -0.65926319 -1.16825597]
mat_Sqrt:  [[15.88495947  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00272861 -0.02559531  0.10559706]
Stock Position:  0.0027286122548878388
Bond Position:  [7.64334666]


portfolio before change:  [7.91223011]
curr_Stock_Price:  97.14125730937664
curr_Factors:  [97.14125731 -0.31371301 -1.14158817]
mat_Sqrt:  [[22.66597715  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00360562 -0.01257916  0.5190348 ]
Stock Position:  0.0036056194069798196
Bond Position:  [7.56197571]


portfolio before change:  [7.93303722]
curr_Stock_Price:  101.86310378433659
curr_Factors:  [101.86310378  -0.65967091  -1.21465844]
mat_Sqrt:  [[15.63169268  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01365178  0.00728018 -0.31326843]
Stock Position:  -0.013651778443407033
Bond Position:  [9.32364975]


portfolio before change:  [7.92394589]
curr_Stock_Price:  102.87061517041163
curr_Factors:  [102.87061517  -1.01720638  -1.23128572]
mat_Sqrt:  [[10.85884479  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00614462  0.0025997  -0.31793823]
Stock Position:  -0.006144621709908676
Bond Position:  [8.55604691]


portfolio before change:  [7.91760887]
curr_Stock_Price:  104.59832379378953
curr_Factors:  [104.59832379  -1.05099921  -1.22886481]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [7.91760887]
Stock Price:  105.38525811300816
PL:  [2.53235076]
Settle:  Tensor("sub_134:0", shape=(), dtype=float64)
PL:  Tensor("sub_135:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  68
output_Z_Vals[:, i, :]:  [[ 1.19279309e+02 -2.92921948e+01 -2.92556094e+01]
 [-7.04779654e-02 -1.14653620e-01 -1.72427800e-03]
 [ 7.22191591e-02  9.45945169e-03  4.30263292e-02]
 [-4.77981858e-02  1.21593322e-01 -5.81822408e-02]
 [ 3.48012609e-02 -1.16014532e-01 -4.61515398e-02]
 [ 8.95525034e-02  1.58274155e-01 -1.42782639e-02]
 [ 8.81908591e-02 -1.03282608e-02 -7.26162855e-02]
 [-5.36665357e-02 -4.62622570e-02  7.52111761e-02]
 [ 3.47952119e-02  6.47002236e-02 -1.27850864e-01]
 [ 5.91558023e-02  3.06997934e-01 -1.27249470e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.27930914 -29.29219478 -29.25560936]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  8.31647217  -9.26300532 -83.45811031]
init_Out:  [2.54002979]
Stock Position:  8.316472170547405
Bond position:  [-829.10718727]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [26.7572863]
curr_Stock_Price:  102.96182242361354
curr_Factors:  [102.96182242  -0.94873113  -1.02120583]
mat_Sqrt:  [[14.35963719  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00513873 -0.03625666 -0.00491889]
Stock Position:  -0.005138728430683194
Bond Position:  [27.28637914]


portfolio before change:  [26.7756167]
curr_Stock_Price:  102.05035055509468
curr_Factors:  [102.05035056  -0.96141433  -1.00091926]
mat_Sqrt:  [[14.34114582  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00566525 0.00299134 0.12274214]
Stock Position:  0.005665245637830281
Bond Position:  [26.1974764]


portfolio before change:  [26.79322741]
curr_Stock_Price:  102.84620162457466
curr_Factors:  [102.84620162  -0.84366707  -0.97949281]
mat_Sqrt:  [[16.61116083  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00340344  0.03845118 -0.16597774]
Stock Position:  -0.003403438232006035
Bond Position:  [27.1432581]


portfolio before change:  [26.80186995]
curr_Stock_Price:  104.2954647555292
curr_Factors:  [104.29546476  -0.59726979  -0.99539606]
mat_Sqrt:  [[21.21189319  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00105531 -0.03668702 -0.1316575 ]
Stock Position:  0.0010553105634429727
Bond Position:  [26.69180585]


portfolio before change:  [26.81468389]
curr_Stock_Price:  103.78822104223143
curr_Factors:  [ 1.03788221e+02 -5.77774083e-02 -9.93769360e-01]
mat_Sqrt:  [[36.26328217  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00250183  0.05005068 -0.04073191]
Stock Position:  0.0025018305206906716
Bond Position:  [26.55502336]


portfolio before change:  [26.82349434]
curr_Stock_Price:  102.00137416469333
curr_Factors:  [102.00137416  -0.40807277  -0.91846286]
mat_Sqrt:  [[27.07066461  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00270039 -0.00326608 -0.20715405]
Stock Position:  0.0027003935221640704
Bond Position:  [26.54805049]


portfolio before change:  [26.8288474]
curr_Stock_Price:  99.06688349174811
curr_Factors:  [ 9.90668835e+01  8.24253669e-02 -9.11023627e-01]
mat_Sqrt:  [[43.25863874  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00091331 -0.01462941  0.21455655]
Stock Position:  -0.0009133113332383685
Bond Position:  [26.91932631]


portfolio before change:  [26.83409019]
curr_Stock_Price:  108.06736137168069
curr_Factors:  [ 1.08067361e+02  1.07296284e-01 -9.22825519e-01]
mat_Sqrt:  [[47.80955499  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 2.16867028e-04  2.04600072e-02 -3.64722929e-01]
Stock Position:  0.00021686702787172707
Bond Position:  [26.81065395]


portfolio before change:  [26.846134]
curr_Stock_Price:  101.77375954835506
curr_Factors:  [ 1.01773760e+02  7.50287693e-02 -9.36686938e-01]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [26.846134]
Stock Price:  97.89899637047539
PL:  [26.846134]
Settle:  Tensor("sub_136:0", shape=(), dtype=float64)
PL:  Tensor("sub_137:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  69
output_Z_Vals[:, i, :]:  [[ 1.19279309e+02 -2.92921948e+01 -2.92556094e+01]
 [-7.04779654e-02 -1.14653620e-01 -1.72427800e-03]
 [ 7.82781491e-01  7.38993077e-02 -3.77265668e-01]
 [ 3.36976915e-01 -2.02715770e-01 -1.13100098e-01]
 [-2.35216685e-01  2.64483093e-01  3.52757430e-01]
 [ 4.05785827e-02 -9.59882999e-02  3.27410271e-02]
 [-4.12655838e-01 -1.68711834e-01  4.21481592e-01]
 [ 1.47371061e-01 -5.58883923e-02 -1.29316305e-02]
 [-6.37843126e-01 -3.34485902e-02  1.66500651e-01]
 [-2.94314928e-03  2.23944125e-02 -2.81056319e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.27930914 -29.29219478 -29.25560936]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  8.31647217  -9.26300532 -83.45811031]
init_Out:  [2.54002979]
Stock Position:  8.316472170547405
Bond position:  [-829.10718727]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [0.30544457]
curr_Stock_Price:  99.78116586843272
curr_Factors:  [99.78116587 -1.49401384 -1.04502604]
mat_Sqrt:  [[ 7.87694047  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00936789 -0.03625666 -0.00491889]
Stock Position:  -0.009367885429954394
Bond Position:  [1.2401831]


portfolio before change:  [0.31961435]
curr_Stock_Price:  98.33478453802083
curr_Factors:  [98.33478454 -1.40286248 -1.06087574]
mat_Sqrt:  [[ 8.36988042  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.08455085  0.02336901 -1.07623394]
Stock Position:  0.08455085313915339
Bond Position:  [-7.99467557]


portfolio before change:  [0.26553129]
curr_Stock_Price:  97.7424223476846
curr_Factors:  [97.74242235 -1.42606533 -1.0428261 ]
mat_Sqrt:  [[ 8.2766992   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0372922  -0.06410436 -0.3226431 ]
Stock Position:  0.03729220407503875
Bond Position:  [-3.37949907]


portfolio before change:  [0.22694219]
curr_Stock_Price:  96.75296818942667
curr_Factors:  [96.75296819 -0.60347044 -1.0258815 ]
mat_Sqrt:  [[18.96905701  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00824403  0.0836369   1.00631876]
Stock Position:  -0.008244028809519613
Bond Position:  [1.02457645]


portfolio before change:  [0.23273551]
curr_Stock_Price:  96.11239491579302
curr_Factors:  [ 9.61123949e+01 -3.07370873e-02 -1.01590828e+00]
mat_Sqrt:  [[33.74637224  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00132706 -0.03035417  0.09340104]
Stock Position:  0.0013270584861931386
Bond Position:  [0.10518874]


portfolio before change:  [0.22982518]
curr_Stock_Price:  93.87968619307188
curr_Factors:  [93.87968619  0.23946165 -1.04514014]
mat_Sqrt:  [[41.94400633  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00789093 -0.05335137  1.20236966]
Stock Position:  -0.007890934074602727
Bond Position:  [0.9706236]


portfolio before change:  [0.31284422]
curr_Stock_Price:  83.42039205643313
curr_Factors:  [ 8.34203921e+01  5.28138682e-02 -1.02483395e+00]
mat_Sqrt:  [[31.55943861  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00454027 -0.01767346 -0.03689034]
Stock Position:  0.00454026994707795
Bond Position:  [-0.06590688]


portfolio before change:  [0.31026482]
curr_Stock_Price:  82.85953699780273
curr_Factors:  [82.859537   -0.22791641 -0.99865638]
mat_Sqrt:  [[24.30237445  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02488316 -0.01057737  0.47498001]
Stock Position:  -0.02488316368404284
Bond Position:  [2.37207224]


portfolio before change:  [0.2544458]
curr_Stock_Price:  85.15045752412303
curr_Factors:  [85.15045752 -0.30718773 -1.02030211]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [0.2544458]
Stock Price:  85.82341281858066
PL:  [0.2544458]
Settle:  Tensor("sub_138:0", shape=(), dtype=float64)
PL:  Tensor("sub_139:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  70
output_Z_Vals[:, i, :]:  [[ 1.19279309e+02 -2.92921948e+01 -2.92556094e+01]
 [-6.51811662e-02 -6.82273820e-02  3.85464534e-02]
 [ 1.93596403e-01  4.03452063e-02 -5.22105756e-02]
 [-6.25622185e-02  1.07412032e-01 -1.87782179e-01]
 [ 4.15502273e-02 -6.90821639e-02 -5.45164278e-02]
 [ 7.36204200e-02  8.36304988e-02  1.53719480e-03]
 [ 8.30555940e-02 -8.36383889e-04 -7.02492187e-02]
 [-2.09861970e-01  4.65874027e-02 -1.53505375e-01]
 [ 2.39966880e-02  4.91363350e-02 -1.15758938e-01]
 [ 6.51576663e-02  3.59174258e-01 -8.95442328e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.27930914 -29.29219478 -29.25560936]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  8.31647217  -9.26300532 -83.45811031]
init_Out:  [2.54002979]
Stock Position:  8.316472170547405
Bond position:  [-829.10718727]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-9.86100249]
curr_Stock_Price:  98.55871879577236
curr_Factors:  [98.5587188  -0.9435177  -0.94771232]
mat_Sqrt:  [[14.8711409   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00397243 -0.02157539  0.1099623 ]
Stock Position:  -0.003972427412916432
Bond Position:  [-9.46948513]


portfolio before change:  [-9.87678996]
curr_Stock_Price:  101.34078231510836
curr_Factors:  [101.34078232  -1.02237999  -0.95281429]
mat_Sqrt:  [[14.0594483   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01308591  0.01275827 -0.14894224]
Stock Position:  0.013085909803044788
Bond Position:  [-11.2029263]


portfolio before change:  [-9.88369454]
curr_Stock_Price:  101.24130770266399
curr_Factors:  [101.2413077   -0.93200754  -0.87178993]
mat_Sqrt:  [[16.67164528  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00588543  0.03396667 -0.53569029]
Stock Position:  -0.005885425635047416
Bond Position:  [-9.28784635]


portfolio before change:  [-9.89447623]
curr_Stock_Price:  102.2839863654219
curr_Factors:  [102.28398637  -0.6938961   -0.88352952]
mat_Sqrt:  [[21.12226082  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00135584 -0.0218457  -0.15552019]
Stock Position:  0.0013558403867390046
Bond Position:  [-10.03315699]


portfolio before change:  [-9.89863579]
curr_Stock_Price:  102.91700955014034
curr_Factors:  [102.91700955  -0.76379482  -0.88818246]
mat_Sqrt:  [[19.72615964  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00385749 0.02644629 0.00438519]
Stock Position:  0.003857493308786801
Bond Position:  [-10.29563746]


portfolio before change:  [-9.90835932]
curr_Stock_Price:  101.73115456260146
curr_Factors:  [101.73115456  -0.74225003  -0.88288342]
mat_Sqrt:  [[20.02937901  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00342968 -0.00026449 -0.20040147]
Stock Position:  0.0034296838092302234
Bond Position:  [-10.25726501]


portfolio before change:  [-9.90480874]
curr_Stock_Price:  104.26214519929174
curr_Factors:  [104.2621452   -1.38126736  -0.89396741]
mat_Sqrt:  [[10.71531028  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02239723  0.01473223 -0.43790811]
Stock Position:  -0.022397227430337646
Bond Position:  [-7.56962576]


portfolio before change:  [-9.94375362]
curr_Stock_Price:  105.83194303711595
curr_Factors:  [105.83194304  -0.9677182   -0.90173902]
mat_Sqrt:  [[16.32006241  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 1.00256255e-04  1.55382734e-02 -3.30228030e-01]
Stock Position:  0.00010025625503620095
Bond Position:  [-9.95436393]


portfolio before change:  [-9.94872053]
curr_Stock_Price:  105.94677056124037
curr_Factors:  [105.94677056  -1.44662916  -0.87602851]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-9.94872053]
Stock Price:  105.81376616242729
PL:  [-15.76248669]
Settle:  Tensor("sub_140:0", shape=(), dtype=float64)
PL:  Tensor("sub_141:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  71
output_Z_Vals[:, i, :]:  [[ 1.19279309e+02 -2.92921948e+01 -2.92556094e+01]
 [-4.89142816e-02  7.43512261e-02  1.62221020e-01]
 [ 1.70641045e-01  3.30854908e-02 -1.29573789e-02]
 [-4.57438697e-02  1.33548211e-01  4.59436493e-03]
 [ 3.17141029e-02 -7.27304711e-02 -4.55658756e-02]
 [ 1.45798516e-01  4.16099123e-01 -7.01088193e-02]
 [ 9.33921387e-02  4.30979204e-03 -1.87684385e-01]
 [-1.94706694e-01  3.17204655e-02 -1.35694867e-01]
 [-3.48090714e-03  7.16553527e-03 -8.79621167e-02]
 [ 6.37624849e-02  3.31930245e-01 -1.65617838e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.27930914 -29.29219478 -29.25560936]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  8.31647217  -9.26300532 -83.45811031]
init_Out:  [2.54002979]
Stock Position:  8.316472170547405
Bond position:  [-829.10718727]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-8.60712932]
curr_Stock_Price:  98.70948863458999
curr_Factors:  [98.70948863 -0.65727062 -0.98669506]
mat_Sqrt:  [[19.0718875   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00072784  0.02351192  0.46277142]
Stock Position:  -0.000727841650137521
Bond Position:  [-8.53528444]


portfolio before change:  [-8.61346001]
curr_Stock_Price:  101.54249915536339
curr_Factors:  [101.54249916  -1.01561627  -0.9411947 ]
mat_Sqrt:  [[14.34880194  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01176756  0.01046255 -0.0369638 ]
Stock Position:  0.011767560516142469
Bond Position:  [-9.80836752]


portfolio before change:  [-8.59385599]
curr_Stock_Price:  103.62529519465231
curr_Factors:  [103.62529519  -1.01873339  -0.97762823]
mat_Sqrt:  [[14.07527681  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00293833  0.04223165  0.01310644]
Stock Position:  -0.0029383328988764703
Bond Position:  [-8.28937038]


portfolio before change:  [-8.5981562]
curr_Stock_Price:  103.67787263293184
curr_Factors:  [103.67787263  -1.02239821  -1.0165083 ]
mat_Sqrt:  [[13.49584958  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00152159 -0.02299939 -0.12998676]
Stock Position:  0.0015215874126636162
Bond Position:  [-8.75591115]


portfolio before change:  [-8.59881344]
curr_Stock_Price:  106.12387840852031
curr_Factors:  [106.12387841  -0.94283241  -1.0400199 ]
mat_Sqrt:  [[14.61070913  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00973473  0.1315821  -0.20000095]
Stock Position:  0.009734725769651505
Bond Position:  [-9.6319003]


portfolio before change:  [-8.61102488]
curr_Stock_Price:  105.36430072643505
curr_Factors:  [105.36430073  -1.1787633   -1.03236767]
mat_Sqrt:  [[11.54546715  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00478045  0.00136288 -0.53541131]
Stock Position:  0.004780447740085548
Bond Position:  [-9.11471341]


portfolio before change:  [-8.62061666]
curr_Stock_Price:  104.31141123739876
curr_Factors:  [104.31141124  -1.24197993  -0.97115256]
mat_Sqrt:  [[11.40724042  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01942506  0.01003089 -0.38709969]
Stock Position:  -0.019425055149289088
Bond Position:  [-6.59436174]


portfolio before change:  [-8.61320616]
curr_Stock_Price:  103.76013828980832
curr_Factors:  [103.76013829  -1.56509246  -0.91150355]
mat_Sqrt:  [[ 8.71883706  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00243738  0.00226594 -0.25093143]
Stock Position:  -0.0024373761702674414
Bond Position:  [-8.36030367]


portfolio before change:  [-8.61789607]
curr_Stock_Price:  103.96885251858016
curr_Factors:  [103.96885252  -1.64266806  -0.9593831 ]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-8.61789607]
Stock Price:  103.75130024664236
PL:  [-12.36919631]
Settle:  Tensor("sub_142:0", shape=(), dtype=float64)
PL:  Tensor("sub_143:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  72
output_Z_Vals[:, i, :]:  [[ 1.19279309e+02 -2.92921948e+01 -2.92556094e+01]
 [-7.04779654e-02 -1.14653620e-01 -1.72427800e-03]
 [ 1.88824569e-01  6.72463764e-02 -1.17599616e-01]
 [-5.42603381e-02  1.08584676e-01 -1.45396134e-01]
 [-3.57666211e-02  5.84491443e-03  5.32947555e-02]
 [ 4.20223943e-02 -6.29101189e-02  3.29029369e-02]
 [ 7.64733497e-02  1.09048312e-02 -1.31203091e-01]
 [-1.57045027e-01 -1.60796157e-02 -3.49951460e-02]
 [-1.05745993e-01 -5.24613526e-02 -8.25719039e-02]
 [-1.43514123e-02 -9.22981451e-02 -1.54595172e-03]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.27930914 -29.29219478 -29.25560936]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  8.31647217  -9.26300532 -83.45811031]
init_Out:  [2.54002979]
Stock Position:  8.316472170547405
Bond position:  [-829.10718727]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [11.59250176]
curr_Stock_Price:  101.13835879296231
curr_Factors:  [101.13835879  -1.10186002  -1.00109618]
mat_Sqrt:  [[12.34848357  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00597565 -0.03625666 -0.00491889]
Stock Position:  -0.0059756548618632175
Bond Position:  [12.19686968]


portfolio before change:  [11.60132707]
curr_Stock_Price:  100.68228333538863
curr_Factors:  [100.68228334  -0.62964608  -0.98667146]
mat_Sqrt:  [[19.99840088  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00832846  0.02126517 -0.33547897]
Stock Position:  0.008328463002798036
Bond Position:  [10.7627984]


portfolio before change:  [11.61168697]
curr_Stock_Price:  101.27989205134516
curr_Factors:  [101.27989205  -0.18696384  -1.01721575]
mat_Sqrt:  [[30.37768528  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00267089  0.03433749 -0.4147747 ]
Stock Position:  -0.0026708932733005967
Bond Position:  [11.88219476]


portfolio before change:  [11.61943015]
curr_Stock_Price:  100.60573694648792
curr_Factors:  [100.60573695  -0.55424428  -0.99422932]
mat_Sqrt:  [[21.38598237  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00115669  0.00184832  0.1520351 ]
Stock Position:  -0.0011566903606454238
Bond Position:  [11.73579984]


portfolio before change:  [11.62662724]
curr_Stock_Price:  99.45787691858972
curr_Factors:  [99.45787692 -0.52851843 -0.95590995]
mat_Sqrt:  [[22.54032271  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00209022 -0.01989393  0.09386292]
Stock Position:  0.0020902249911557568
Bond Position:  [11.4187379]


portfolio before change:  [11.63552936]
curr_Stock_Price:  100.9846639806004
curr_Factors:  [100.98466398  -0.98804784  -1.00525835]
mat_Sqrt:  [[13.7585778   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00363215  0.00344841 -0.3742859 ]
Stock Position:  0.00363214811656208
Bond Position:  [11.26873811]


portfolio before change:  [11.64011934]
curr_Stock_Price:  100.69673358223058
curr_Factors:  [100.69673358  -1.13917207  -0.98988294]
mat_Sqrt:  [[11.97784093  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01374234 -0.00508482 -0.09983141]
Stock Position:  -0.013742339371140383
Bond Position:  [13.02392802]


portfolio before change:  [11.66370605]
curr_Stock_Price:  99.45435967113893
curr_Factors:  [99.45435967 -0.81265141 -1.02344948]
mat_Sqrt:  [[15.85679239  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00781718 -0.01658974 -0.23555466]
Stock Position:  -0.007817183696124356
Bond Position:  [12.44115905]


portfolio before change:  [11.69256962]
curr_Stock_Price:  96.55799272615944
curr_Factors:  [96.55799273 -0.68509115 -0.99188544]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [11.69256962]
Stock Price:  97.57165137852988
PL:  [11.69256962]
Settle:  Tensor("sub_144:0", shape=(), dtype=float64)
PL:  Tensor("sub_145:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  73
output_Z_Vals[:, i, :]:  [[ 1.19279309e+02 -2.92921948e+01 -2.92556094e+01]
 [-5.88690524e-02 -2.23377209e-02  7.89325971e-02]
 [ 6.61911993e-02  9.75800108e-03  4.39588345e-02]
 [-4.86139169e-02  1.09382236e-01 -1.16567790e-01]
 [ 3.33281297e-02 -2.54390091e-02 -3.09668605e-02]
 [ 5.45476605e-02 -3.46519091e-02  2.04892864e-02]
 [ 7.35653920e-02  2.13478392e-02 -2.08701431e-01]
 [-1.64984319e-01  2.56357556e-03 -1.00765075e-01]
 [-6.33681151e-04  3.44371480e-02 -1.13145160e-01]
 [ 6.33759087e-02  3.26378721e-01 -1.91167383e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.27930914 -29.29219478 -29.25560936]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  8.31647217  -9.26300532 -83.45811031]
init_Out:  [2.54002979]
Stock Position:  8.316472170547405
Bond position:  [-829.10718727]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [9.2630731]
curr_Stock_Price:  100.85826062054977
curr_Factors:  [100.85826062  -0.65691371  -1.000717  ]
mat_Sqrt:  [[19.22257663  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00225432 -0.00706381  0.22517273]
Stock Position:  -0.00225431594434678
Bond Position:  [9.49043949]


portfolio before change:  [9.26548486]
curr_Stock_Price:  101.89389715542484
curr_Factors:  [101.89389716  -0.73585257  -1.00162806]
mat_Sqrt:  [[17.92957202  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00420625 0.00308575 0.12540232]
Stock Position:  0.004206247045474528
Bond Position:  [8.83689395]


portfolio before change:  [9.27058696]
curr_Stock_Price:  102.05616872559033
curr_Factors:  [102.05616873  -0.52214051  -0.98270191]
mat_Sqrt:  [[22.66180508  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00307054  0.0345897  -0.33253546]
Stock Position:  -0.003070540051046997
Bond Position:  [9.58395452]


portfolio before change:  [9.27652072]
curr_Stock_Price:  101.68470777267547
curr_Factors:  [101.68470777  -1.37520067  -0.94738805]
mat_Sqrt:  [[ 9.96708544  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00264372 -0.00804452 -0.08833983]
Stock Position:  0.0026437230401373767
Bond Position:  [9.00769452]


portfolio before change:  [9.28197877]
curr_Stock_Price:  102.04521048694794
curr_Factors:  [102.04521049  -1.44502499  -0.92386379]
mat_Sqrt:  [[ 9.54986654  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00605614 -0.0109579   0.05845023]
Stock Position:  0.00605613805533946
Bond Position:  [8.66397888]


portfolio before change:  [9.30406906]
curr_Stock_Price:  104.97731324937027
curr_Factors:  [104.97731325  -1.61981828  -0.93394513]
mat_Sqrt:  [[ 8.16601354  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00385936  0.00675078 -0.59536709]
Stock Position:  0.003859360446100847
Bond Position:  [8.89892377]


portfolio before change:  [9.31012026]
curr_Stock_Price:  105.39205083383487
curr_Factors:  [105.39205083  -1.4376489   -0.91552463]
mat_Sqrt:  [[10.01930458  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01851293  0.00081067 -0.28745471]
Stock Position:  -0.018512932819482297
Bond Position:  [11.26123621]


portfolio before change:  [9.33175668]
curr_Stock_Price:  104.52755265639159
curr_Factors:  [104.52755266  -1.08464724  -0.91818249]
mat_Sqrt:  [[14.10629238  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00161915  0.01088998 -0.32277165]
Stock Position:  -0.0016191481315433961
Bond Position:  [9.50100227]


portfolio before change:  [9.3396457]
curr_Stock_Price:  102.58990601400095
curr_Factors:  [102.58990601  -0.61833077  -0.90086651]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [9.3396457]
Stock Price:  102.00431103052931
PL:  [7.33533467]
Settle:  Tensor("sub_146:0", shape=(), dtype=float64)
PL:  Tensor("sub_147:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  74
output_Z_Vals[:, i, :]:  [[ 1.19279309e+02 -2.92921948e+01 -2.92556094e+01]
 [-7.04779654e-02 -1.14653620e-01 -1.72427800e-03]
 [ 2.05518278e-01  7.08768617e-02 -1.54144869e-01]
 [-3.53676217e-02  8.78131294e-02 -1.95757263e-01]
 [-5.78703225e-02  2.71082434e-02  8.39806409e-02]
 [ 4.05396499e-02 -6.94178851e-02  3.43745397e-02]
 [ 4.78071002e-02 -3.91614444e-02  1.80796793e-01]
 [-1.90763684e-01  2.20986106e-02 -1.08047127e-01]
 [-1.39112240e-01 -2.40916960e-02 -1.27638499e-01]
 [ 3.22290245e-02  1.81921740e-01  6.68290184e-03]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.27930914 -29.29219478 -29.25560936]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  8.31647217  -9.26300532 -83.45811031]
init_Out:  [2.54002979]
Stock Position:  8.316472170547405
Bond position:  [-829.10718727]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [29.3436333]
curr_Stock_Price:  103.27281330380235
curr_Factors:  [103.2728133   -0.81585206  -1.02576693]
mat_Sqrt:  [[16.37498998  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00450628 -0.03625666 -0.00491889]
Stock Position:  -0.0045062791480012165
Bond Position:  [29.80900942]


portfolio before change:  [29.37176525]
curr_Stock_Price:  100.33830387033028
curr_Factors:  [100.33830387  -0.46654232  -1.02137975]
mat_Sqrt:  [[22.66054813  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00776167  0.02241323 -0.43973241]
Stock Position:  0.007761666680847456
Bond Position:  [28.59297278]


portfolio before change:  [29.38711324]
curr_Stock_Price:  100.47331766917439
curr_Factors:  [100.47331767  -0.49706081  -1.07166186]
mat_Sqrt:  [[20.92970681  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00349069  0.02776895 -0.55844098]
Stock Position:  -0.0034906881932583967
Bond Position:  [29.73783426]


portfolio before change:  [29.4028123]
curr_Stock_Price:  100.23656640272223
curr_Factors:  [100.2365664   -0.69162808  -1.08665644]
mat_Sqrt:  [[16.93273172  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00236394  0.00857238  0.23957339]
Stock Position:  -0.0023639371810361414
Bond Position:  [29.63976525]


portfolio before change:  [29.42067335]
curr_Stock_Price:  98.9516498304576
curr_Factors:  [98.95164983 -0.37674007 -1.00931342]
mat_Sqrt:  [[24.74387183  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00184951 -0.02195186  0.09806099]
Stock Position:  0.0018495068871426854
Bond Position:  [29.23766159]


portfolio before change:  [29.43236168]
curr_Stock_Price:  97.3651980663485
curr_Factors:  [97.36519807 -0.41579925 -1.02152742]
mat_Sqrt:  [[23.13027037  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00361868 -0.01238394  0.51576293]
Stock Position:  0.003618675682053141
Bond Position:  [29.08002861]


portfolio before change:  [29.46195772]
curr_Stock_Price:  101.52483795179116
curr_Factors:  [101.52483795  -0.22142865  -0.97892592]
mat_Sqrt:  [[30.56785302  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00694351  0.00698819 -0.30822838]
Stock Position:  -0.006943507870703382
Bond Position:  [30.16689623]


portfolio before change:  [29.48348292]
curr_Stock_Price:  100.5976445349461
curr_Factors:  [100.59764453  -0.10449294  -0.97726659]
mat_Sqrt:  [[34.10245268  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00486148 -0.00761846 -0.36411711]
Stock Position:  -0.004861479774995275
Bond Position:  [29.97253633]


portfolio before change:  [29.49675038]
curr_Stock_Price:  100.9519701896619
curr_Factors:  [100.95197019  -0.26739552  -0.91964592]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [29.49675038]
Stock Price:  103.58791322970876
PL:  [25.90883715]
Settle:  Tensor("sub_148:0", shape=(), dtype=float64)
PL:  Tensor("sub_149:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  75
output_Z_Vals[:, i, :]:  [[ 1.19279309e+02 -2.92921948e+01 -2.92556094e+01]
 [-7.04779654e-02 -1.14653620e-01 -1.72427800e-03]
 [ 4.91934716e-01  6.98583609e-02 -2.83790655e-01]
 [ 2.47889950e-01 -9.82356951e-02 -1.65501963e-01]
 [-3.58820704e-02  3.18453672e-03  5.25058438e-02]
 [ 4.20421005e-02 -7.56111185e-02  3.28917551e-02]
 [ 8.27792389e-02 -1.53128202e-02 -1.60781545e-02]
 [-1.57633727e-01 -1.54130553e-02 -3.62705734e-02]
 [-7.08258742e-02 -2.11583485e-02 -9.59695734e-02]
 [ 4.90192799e-02  2.57949395e-01 -6.98721725e-03]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.27930914 -29.29219478 -29.25560936]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  8.31647217  -9.26300532 -83.45811031]
init_Out:  [2.54002979]
Stock Position:  8.316472170547405
Bond position:  [-829.10718727]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [8.12312332]
curr_Stock_Price:  100.72118930485834
curr_Factors:  [100.7211893   -1.31655427  -0.97249607]
mat_Sqrt:  [[10.20936933  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0072277  -0.03625666 -0.00491889]
Stock Position:  -0.007227701680583006
Bond Position:  [8.85110603]


portfolio before change:  [8.13614464]
curr_Stock_Price:  99.5320614139322
curr_Factors:  [99.53206141 -1.17181784 -0.9750319 ]
mat_Sqrt:  [[11.63048977  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.03747133  0.02209115 -0.80957575]
Stock Position:  0.03747133046344312
Bond Position:  [4.40654588]


portfolio before change:  [8.10344898]
curr_Stock_Price:  98.60069639807733
curr_Factors:  [98.6006964  -1.0401063  -0.92123885]
mat_Sqrt:  [[13.87006844  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01525375 -0.03106485 -0.47213103]
Stock Position:  0.015253750897426805
Bond Position:  [6.59941852]


portfolio before change:  [8.13423942]
curr_Stock_Price:  100.40287008261596
curr_Factors:  [100.40287008  -1.0488877   -0.98113396]
mat_Sqrt:  [[13.18617772  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00190215  0.00100704  0.14978456]
Stock Position:  -0.0019021536098238318
Bond Position:  [8.3252211]


portfolio before change:  [8.13866862]
curr_Stock_Price:  100.26326868378212
curr_Factors:  [100.26326868  -1.1258855   -1.03865986]
mat_Sqrt:  [[11.51043546  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00406621 -0.02391034  0.09383102]
Stock Position:  0.004066208564866206
Bond Position:  [7.73097725]


portfolio before change:  [8.1373057]
curr_Stock_Price:  98.97721290409247
curr_Factors:  [98.9772129  -0.87286823 -1.01578759]
mat_Sqrt:  [[14.97277926  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00528305 -0.00484234 -0.0458665 ]
Stock Position:  0.005283048836584451
Bond Position:  [7.61440425]


portfolio before change:  [8.14962516]
curr_Stock_Price:  100.58827153242208
curr_Factors:  [100.58827153  -0.79755969  -1.02062604]
mat_Sqrt:  [[16.32748594  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01013232 -0.00487404 -0.10346985]
Stock Position:  -0.010132324759220062
Bond Position:  [9.16881819]


portfolio before change:  [8.14102724]
curr_Stock_Price:  101.88940159862437
curr_Factors:  [101.8894016   -1.23865619  -1.04919747]
mat_Sqrt:  [[10.34014887  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00879696 -0.00669086 -0.27377448]
Stock Position:  -0.008796961117671052
Bond Position:  [9.03734434]


portfolio before change:  [8.14584596]
curr_Stock_Price:  101.85542163568695
curr_Factors:  [101.85542164  -0.84024278  -1.09335816]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [8.14584596]
Stock Price:  102.65719504091645
PL:  [5.48865092]
Settle:  Tensor("sub_150:0", shape=(), dtype=float64)
PL:  Tensor("sub_151:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  76
output_Z_Vals[:, i, :]:  [[ 1.19279309e+02 -2.92921948e+01 -2.92556094e+01]
 [-7.04779654e-02 -1.14653620e-01 -1.72427800e-03]
 [ 5.87292269e-02  6.22025495e-03  4.48837806e-02]
 [-6.06185251e-02  1.07686580e-01 -1.77858466e-01]
 [ 4.27682886e-02 -9.58048050e-02 -5.79997786e-02]
 [ 6.96853678e-02  6.67221909e-02  5.44244116e-03]
 [ 7.97755998e-02  8.46985205e-03 -1.38582390e-01]
 [-1.60253540e-01 -2.07719790e-03 -9.52054547e-02]
 [ 1.45497844e-02  3.76174030e-02 -1.07951742e-01]
 [ 6.97948132e-02  3.93510068e-01 -1.52462165e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.27930914 -29.29219478 -29.25560936]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  8.31647217  -9.26300532 -83.45811031]
init_Out:  [2.54002979]
Stock Position:  8.316472170547405
Bond position:  [-829.10718727]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [19.10190308]
curr_Stock_Price:  102.04131393651204
curr_Factors:  [102.04131394  -1.26753311  -1.00506937]
mat_Sqrt:  [[10.51471062  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00701781 -0.03625666 -0.00491889]
Stock Position:  -0.007017813287771166
Bond Position:  [19.81800997]


portfolio before change:  [19.1107521]
curr_Stock_Price:  102.19270897589259
curr_Factors:  [102.19270898  -1.06507753  -0.99678876]
mat_Sqrt:  [[13.00058088  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00523451 0.00196702 0.12804093]
Stock Position:  0.0052345119948618
Bond Position:  [18.57582314]


portfolio before change:  [19.1152903]
curr_Stock_Price:  101.28488196186007
curr_Factors:  [101.28488196  -0.88498187  -0.96762978]
mat_Sqrt:  [[15.88420958  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00592685  0.03405349 -0.5073807 ]
Stock Position:  -0.0059268468105956275
Bond Position:  [19.71559028]


portfolio before change:  [19.11692388]
curr_Stock_Price:  102.67291954770168
curr_Factors:  [102.67291955  -0.5578807   -0.98515592]
mat_Sqrt:  [[21.9443955   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00129671 -0.03029614 -0.16545722]
Stock Position:  0.0012967075788404058
Bond Position:  [18.98378713]


portfolio before change:  [19.12668441]
curr_Stock_Price:  102.87825519811217
curr_Factors:  [102.8782552   -1.03299228  -0.9773172 ]
mat_Sqrt:  [[13.78025569  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00526253 0.02109941 0.01552577]
Stock Position:  0.005262533773950218
Bond Position:  [18.58528411]


portfolio before change:  [19.13438435]
curr_Stock_Price:  102.57516437014425
curr_Factors:  [102.57516437  -1.07711917  -0.98924295]
mat_Sqrt:  [[12.99070014  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00398025  0.0026784  -0.39533699]
Stock Position:  0.003980253408156287
Bond Position:  [18.7261092]


portfolio before change:  [19.15282604]
curr_Stock_Price:  104.85549578827764
curr_Factors:  [104.85549579  -1.0008293   -0.93663946]
mat_Sqrt:  [[15.1063383   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01189838 -0.00065687 -0.27159466]
Stock Position:  -0.011898376772094559
Bond Position:  [20.40043623]


portfolio before change:  [19.15936449]
curr_Stock_Price:  105.16346323142221
curr_Factors:  [105.16346323  -0.83933382  -0.87432277]
mat_Sqrt:  [[18.95104998  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00034375  0.01189567 -0.30795627]
Stock Position:  -0.00034375379747217936
Bond Position:  [19.19551483]


portfolio before change:  [19.16839798]
curr_Stock_Price:  106.81194683423699
curr_Factors:  [106.81194683  -0.69912883  -0.90104493]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [19.16839798]
Stock Price:  108.05397854710185
PL:  [11.11441943]
Settle:  Tensor("sub_152:0", shape=(), dtype=float64)
PL:  Tensor("sub_153:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  77
output_Z_Vals[:, i, :]:  [[ 1.19279309e+02 -2.92921948e+01 -2.92556094e+01]
 [-7.04779654e-02 -1.14653620e-01 -1.72427800e-03]
 [ 9.00180798e-01  7.76300981e-02 -3.99202572e-01]
 [ 4.27208659e-01 -3.30086320e-01 -1.91627108e-02]
 [-3.16249554e-01  3.80242739e-01  4.78029065e-01]
 [ 7.81430612e-02  3.65236276e-02 -4.55553458e-03]
 [-2.78707220e-01 -1.31025640e-01  3.51466411e-01]
 [ 1.24707445e-01 -1.06685763e-01 -7.63757621e-02]
 [ 9.07670575e-02 -8.62322505e-02  1.15759863e-01]
 [-6.83235124e-03 -3.49938639e-02 -1.14828325e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.27930914 -29.29219478 -29.25560936]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  8.31647217  -9.26300532 -83.45811031]
init_Out:  [2.54002979]
Stock Position:  8.316472170547405
Bond position:  [-829.10718727]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-16.38646443]
curr_Stock_Price:  97.77407576331638
curr_Factors:  [97.77407576 -1.13896862 -1.03186807]
mat_Sqrt:  [[11.15427437  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00661543 -0.03625666 -0.00491889]
Stock Position:  -0.006615425930482982
Bond Position:  [-15.73964728]


portfolio before change:  [-16.39301082]
curr_Stock_Price:  97.5737257440753
curr_Factors:  [97.57372574 -1.15024705 -1.0051297 ]
mat_Sqrt:  [[11.30484628  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.07259703  0.02454879 -1.13881382]
Stock Position:  0.07259703437850455
Bond Position:  [-23.47657394]


portfolio before change:  [-16.54156239]
curr_Stock_Price:  95.68920880093692
curr_Factors:  [95.6892088  -1.10041797 -0.92140591]
mat_Sqrt:  [[12.67056582  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.03273526 -0.10438246 -0.05466588]
Stock Position:  0.032735262219092266
Bond Position:  [-19.67397373]


portfolio before change:  [-16.5790651]
curr_Stock_Price:  94.84414843681566
curr_Factors:  [94.84414844 -0.74641381 -0.89152301]
mat_Sqrt:  [[18.43586924  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0113287   0.12024331  1.36368386]
Stock Position:  -0.011328701208214042
Bond Position:  [-15.50460409]


portfolio before change:  [-16.58798915]
curr_Stock_Price:  94.94740878430103
curr_Factors:  [94.94740878 -0.64282137 -0.84038613]
mat_Sqrt:  [[21.54439413  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00362768  0.01154979 -0.01299567]
Stock Position:  0.0036276816193925032
Bond Position:  [-16.93242812]


portfolio before change:  [-16.60162149]
curr_Stock_Price:  93.52390909667562
curr_Factors:  [93.5239091  -0.33551577 -0.80809268]
mat_Sqrt:  [[29.8029883   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00705793 -0.04143395  1.00263584]
Stock Position:  -0.007057933415253549
Bond Position:  [-15.94153596]


portfolio before change:  [-16.61895896]
curr_Stock_Price:  94.85074372684633
curr_Factors:  [94.85074373 -0.72024694 -0.82263282]
mat_Sqrt:  [[20.27573364  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00524581 -0.033737   -0.21787879]
Stock Position:  0.005245812308664789
Bond Position:  [-17.11652816]


portfolio before change:  [-16.64073834]
curr_Stock_Price:  92.3308329517244
curr_Factors:  [92.33083295 -0.64148344 -0.80644963]
mat_Sqrt:  [[21.70288193  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00516843 -0.02726903  0.33023067]
Stock Position:  0.005168434946875342
Bond Position:  [-17.11794424]


portfolio before change:  [-16.66047158]
curr_Stock_Price:  90.1692249008378
curr_Factors:  [ 9.01692249e+01 -1.38086676e-02 -7.77068358e-01]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-16.66047158]
Stock Price:  95.25992460765734
PL:  [-16.66047158]
Settle:  Tensor("sub_154:0", shape=(), dtype=float64)
PL:  Tensor("sub_155:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  78
output_Z_Vals[:, i, :]:  [[ 1.19279309e+02 -2.92921948e+01 -2.92556094e+01]
 [-7.04779654e-02 -1.14653620e-01 -1.72427800e-03]
 [ 2.24771756e-01  3.84720792e-02 -5.94847451e-04]
 [-6.48771357e-02  1.07085049e-01 -1.99601210e-01]
 [ 1.64003184e-02 -4.18200782e-02 -1.84327900e-02]
 [ 4.33765347e-02 -5.52392455e-02  3.15578399e-02]
 [ 8.72686554e-02 -1.69680408e-02  1.85828295e-02]
 [-7.18146361e-02 -5.86276306e-02  5.32371006e-02]
 [-1.25827844e-01 -1.21559302e-02 -1.33286118e-01]
 [ 3.46819237e-03  2.61217071e-02  1.11266355e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.27930914 -29.29219478 -29.25560936]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  8.31647217  -9.26300532 -83.45811031]
init_Out:  [2.54002979]
Stock Position:  8.316472170547405
Bond position:  [-829.10718727]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [21.7155059]
curr_Stock_Price:  102.35558214631055
curr_Factors:  [102.35558215  -1.81939271  -1.00422309]
mat_Sqrt:  [[ 6.07898085  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01213859 -0.03625666 -0.00491889]
Stock Position:  -0.0121385932424968
Bond Position:  [22.95795868]


portfolio before change:  [21.73103326]
curr_Stock_Price:  102.0223054263003
curr_Factors:  [102.02230543  -1.90043329  -1.03803808]
mat_Sqrt:  [[ 5.40173449  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.04177245  0.01216594 -0.00169693]
Stock Position:  0.041772449024851624
Bond Position:  [17.46931171]


portfolio before change:  [21.70870399]
curr_Stock_Price:  101.27860687544886
curr_Factors:  [101.27860688  -1.44385629  -1.01442051]
mat_Sqrt:  [[ 8.66765608  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0118666   0.03386327 -0.56940669]
Stock Position:  -0.011866603499676241
Bond Position:  [22.91053706]


portfolio before change:  [21.71862586]
curr_Stock_Price:  101.40806826328128
curr_Factors:  [101.40806826  -0.91025917  -1.00105616]
mat_Sqrt:  [[14.99680716  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00077069 -0.01322467 -0.05258362]
Stock Position:  0.0007706941232555535
Bond Position:  [21.64047126]


portfolio before change:  [21.72933392]
curr_Stock_Price:  101.25900610063634
curr_Factors:  [101.2590061   -0.30825956  -1.02636539]
mat_Sqrt:  [[26.65713117  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00181535 -0.01746818  0.09002573]
Stock Position:  0.0018153484063342864
Bond Position:  [21.54551354]


portfolio before change:  [21.73782454]
curr_Stock_Price:  100.00038935770976
curr_Factors:  [100.00038936   0.20159745  -1.00266359]
mat_Sqrt:  [[44.88519211  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00201901 -0.00536577  0.05301164]
Stock Position:  0.0020190121148798545
Bond Position:  [21.53592254]


portfolio before change:  [21.74701775]
curr_Stock_Price:  99.2190935218279
curr_Factors:  [99.21909352  0.15755558 -1.06867614]
mat_Sqrt:  [[39.89336087  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00156571 -0.01853968  0.15187063]
Stock Position:  -0.0015657095806763486
Bond Position:  [21.90236603]


portfolio before change:  [21.75402322]
curr_Stock_Price:  101.74091907483188
curr_Factors:  [101.74091907   0.20292252  -1.07985361]
mat_Sqrt:  [[42.33010285  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00362268 -0.00384404 -0.3802282 ]
Stock Position:  -0.003622684881007552
Bond Position:  [22.12259851]


portfolio before change:  [21.77521018]
curr_Stock_Price:  98.94661125885851
curr_Factors:  [98.94661126 -0.35987268 -1.07350699]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [21.77521018]
Stock Price:  98.43213399704723
PL:  [21.77521018]
Settle:  Tensor("sub_156:0", shape=(), dtype=float64)
PL:  Tensor("sub_157:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  79
output_Z_Vals[:, i, :]:  [[ 1.19279309e+02 -2.92921948e+01 -2.92556094e+01]
 [-7.04779654e-02 -1.14653620e-01 -1.72427800e-03]
 [ 4.36065102e-01  6.83670664e-02 -2.71213493e-01]
 [ 1.51413056e-01 -3.30444947e-02 -1.64385882e-01]
 [-2.84039374e-02  1.32265572e-02  4.79194090e-02]
 [ 8.91970775e-02  7.88346303e-02 -1.38744934e-02]
 [ 7.05988460e-02  3.46616572e-02 -2.48339894e-01]
 [-1.54542604e-01 -1.89130042e-02 -2.95736095e-02]
 [-6.53807992e-02 -1.38877402e-02 -1.00134500e-01]
 [ 6.99567633e-02  3.59737933e-01 -2.15070500e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.27930914 -29.29219478 -29.25560936]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  8.31647217  -9.26300532 -83.45811031]
init_Out:  [2.54002979]
Stock Position:  8.316472170547405
Bond position:  [-829.10718727]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [1.68225436]
curr_Stock_Price:  99.94671801118048
curr_Factors:  [99.94671801 -1.33949796 -1.07683   ]
mat_Sqrt:  [[ 8.92011875  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00827234 -0.03625666 -0.00491889]
Stock Position:  -0.00827234232453124
Bond Position:  [2.50904783]


portfolio before change:  [1.68485207]
curr_Stock_Price:  99.78438554413623
curr_Factors:  [99.78438554 -1.17746647 -1.05121773]
mat_Sqrt:  [[10.74378569  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0355991   0.02161956 -0.77369661]
Stock Position:  0.035599100728813726
Bond Position:  [-1.86738233]


portfolio before change:  [1.66310361]
curr_Stock_Price:  99.19969288692842
curr_Factors:  [99.19969289 -1.26227864 -1.09500469]
mat_Sqrt:  [[ 9.39193725  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.012458   -0.01044959 -0.46894717]
Stock Position:  0.012457996660073333
Bond Position:  [0.42727417]


portfolio before change:  [1.67763462]
curr_Stock_Price:  100.34894018085399
curr_Factors:  [100.34894018  -1.50974523  -1.04644324]
mat_Sqrt:  [[ 7.78707299  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0023476   0.0041826   0.13670074]
Stock Position:  -0.0023475984893556157
Bond Position:  [1.91321364]


portfolio before change:  [1.67854524]
curr_Stock_Price:  100.36863135496982
curr_Factors:  [100.36863135  -1.83290874  -1.03651565]
mat_Sqrt:  [[ 5.69407026  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.015525    0.0249297  -0.03958007]
Stock Position:  0.015525003342505724
Bond Position:  [0.1203219]


portfolio before change:  [1.6763943]
curr_Stock_Price:  100.22620863183396
curr_Factors:  [100.22620863  -1.39953209  -1.00473666]
mat_Sqrt:  [[ 9.05358645  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00229761  0.01096098 -0.70844459]
Stock Position:  0.002297612959293453
Bond Position:  [1.44611326]


portfolio before change:  [1.67768051]
curr_Stock_Price:  100.47123348998154
curr_Factors:  [100.47123349  -0.81232237  -0.99929384]
mat_Sqrt:  [[16.41597989  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00981164 -0.00598082 -0.08436528]
Stock Position:  -0.009811636268097244
Bond Position:  [2.66346771]


portfolio before change:  [1.66224637]
curr_Stock_Price:  102.18004212965697
curr_Factors:  [102.18004213  -1.1868818   -1.02155436]
mat_Sqrt:  [[11.22676009  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00767623 -0.00439169 -0.28565586]
Stock Position:  -0.007676234959395785
Bond Position:  [2.44660438]


portfolio before change:  [1.6488218]
curr_Stock_Price:  104.08829263722076
curr_Factors:  [104.08829264  -1.045378    -1.04444096]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [1.6488218]
Stock Price:  104.37067116488342
PL:  [-2.72184937]
Settle:  Tensor("sub_158:0", shape=(), dtype=float64)
PL:  Tensor("sub_159:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  80
output_Z_Vals[:, i, :]:  [[ 1.19279309e+02 -2.92921948e+01 -2.92556094e+01]
 [-6.57178194e-02 -7.29311260e-02  3.44663638e-02]
 [ 3.93877795e-02  5.89687534e-03  4.78006131e-02]
 [-6.08561929e-02  1.07653009e-01 -1.79071902e-01]
 [ 2.45786000e-02 -6.83705619e-02 -3.61114359e-02]
 [ 3.88797897e-02 -7.69229623e-02  3.60220717e-02]
 [ 8.99764272e-02 -2.65185176e-02  1.42606622e-01]
 [-5.70439255e-02 -9.58747813e-02  9.84594235e-02]
 [-6.53433691e-02 -6.43045305e-02 -5.00489092e-02]
 [ 1.21534562e-02  7.90952370e-02  1.41830559e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.27930914 -29.29219478 -29.25560936]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  8.31647217  -9.26300532 -83.45811031]
init_Out:  [2.54002979]
Stock Position:  8.316472170547405
Bond position:  [-829.10718727]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [10.06591782]
curr_Stock_Price:  100.95479731339287
curr_Factors:  [100.95479731  -0.82890102  -1.04345227]
mat_Sqrt:  [[15.5229501   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00390167 -0.02306285  0.09832294]
Stock Position:  -0.003901673039857732
Bond Position:  [10.45981043]


portfolio before change:  [10.06766837]
curr_Stock_Price:  101.84689303919754
curr_Factors:  [101.84689304  -0.55604664  -1.04492307]
mat_Sqrt:  [[20.54260298  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00239976 0.00186476 0.13636184]
Stock Position:  0.0023997589533123137
Bond Position:  [9.82326038]


portfolio before change:  [10.07123584]
curr_Stock_Price:  101.28625888617017
curr_Factors:  [101.28625889  -1.05244706  -1.07289605]
mat_Sqrt:  [[12.09276873  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0078253   0.03404287 -0.51084229]
Stock Position:  -0.007825296683119038
Bond Position:  [10.86383087]


portfolio before change:  [10.07436015]
curr_Stock_Price:  101.58132254195921
curr_Factors:  [101.58132254  -0.68443708  -1.10256219]
mat_Sqrt:  [[17.01100374  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00090777 -0.02162067 -0.10301588]
Stock Position:  0.0009077691074262165
Bond Position:  [9.98214777]


portfolio before change:  [10.07630975]
curr_Stock_Price:  98.22945586665062
curr_Factors:  [98.22945587 -0.3752343  -1.04629211]
mat_Sqrt:  [[23.70722178  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00186638 -0.02432518  0.10276094]
Stock Position:  0.0018663773566994343
Bond Position:  [9.89297652]


portfolio before change:  [10.08291037]
curr_Stock_Price:  99.11506755302602
curr_Factors:  [99.11506755 -0.40885694 -1.08521699]
mat_Sqrt:  [[22.24700827  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00532212 -0.00838589  0.406817  ]
Stock Position:  0.0053221168117879285
Bond Position:  [9.5554084]


portfolio before change:  [10.08601111]
curr_Stock_Price:  98.79975065243896
curr_Factors:  [98.79975065 -1.02133847 -1.07780659]
mat_Sqrt:  [[12.10901255  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00325555 -0.03031827  0.28087733]
Stock Position:  -0.0032555467132869497
Bond Position:  [10.40765831]


portfolio before change:  [10.09115026]
curr_Stock_Price:  98.8200189088334
curr_Factors:  [98.82001891 -0.91950806 -1.05333934]
mat_Sqrt:  [[13.74194453  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00561928 -0.02033488 -0.14277561]
Stock Position:  -0.005619284486361353
Bond Position:  [10.64644806]


portfolio before change:  [10.09278144]
curr_Stock_Price:  99.477285862487
curr_Factors:  [99.47728586 -0.2370856  -1.08269952]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [10.09278144]
Stock Price:  98.322718343525
PL:  [10.09278144]
Settle:  Tensor("sub_160:0", shape=(), dtype=float64)
PL:  Tensor("sub_161:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  81
output_Z_Vals[:, i, :]:  [[ 1.19279309e+02 -2.92921948e+01 -2.92556094e+01]
 [-5.31130376e-02  3.75492943e-02  1.30298539e-01]
 [-1.11115038e-01 -2.81178118e-02  6.94720485e-02]
 [-5.32243740e-02  1.49106943e-01  4.08817038e-02]
 [ 2.09623836e-02 -1.02344930e-01 -1.98399009e-02]
 [ 1.27970384e-01  3.35324629e-01 -5.24129943e-02]
 [ 1.11709339e-01 -7.74768439e-03 -8.58875268e-02]
 [-3.44479427e-02 -1.25489270e-01  5.26415191e-02]
 [ 6.96212773e-02  1.27876828e-01 -1.81252848e-01]
 [ 7.43660290e-02  4.68530544e-01 -3.71250326e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.27930914 -29.29219478 -29.25560936]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  8.31647217  -9.26300532 -83.45811031]
init_Out:  [2.54002979]
Stock Position:  8.316472170547405
Bond position:  [-829.10718727]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-3.11311932]
curr_Stock_Price:  99.37010648905542
curr_Factors:  [99.37010649 -0.76590659 -0.95912219]
mat_Sqrt:  [[17.70456566  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00144293  0.01187413  0.37170546]
Stock Position:  -0.0014429295548600417
Bond Position:  [-2.96973525]


portfolio before change:  [-3.11956286]
curr_Stock_Price:  102.80638491561442
curr_Factors:  [102.80638492  -0.68341827  -1.00371271]
mat_Sqrt:  [[19.02428805  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00513344 -0.00889163  0.19818442]
Stock Position:  -0.005133443827715353
Bond Position:  [-2.59181206]


portfolio before change:  [-3.13179746]
curr_Stock_Price:  104.93718877891399
curr_Factors:  [104.93718878  -0.80603643  -1.03070369]
mat_Sqrt:  [[16.72027165  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00245388  0.04715176  0.11662412]
Stock Position:  -0.002453877980205587
Bond Position:  [-2.8742944]


portfolio before change:  [-3.13759077]
curr_Stock_Price:  106.71226153366601
curr_Factors:  [106.71226153  -0.72708384  -0.99508496]
mat_Sqrt:  [[19.06715591  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00074841 -0.03236431 -0.05659771]
Stock Position:  0.0007484097851384069
Bond Position:  [-3.21745528]


portfolio before change:  [-3.14017313]
curr_Stock_Price:  105.41186487743947
curr_Factors:  [ 1.05411865e+02  7.85438316e-02 -9.56374366e-01]
mat_Sqrt:  [[43.81799883  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00287393  0.10603896 -0.14951968]
Stock Position:  0.002873925662350465
Bond Position:  [-3.443119]


portfolio before change:  [-3.14180604]
curr_Stock_Price:  105.44286287585058
curr_Factors:  [105.44286288  -0.55665409  -0.94566067]
mat_Sqrt:  [[23.4730854   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00400363 -0.00245003 -0.24501321]
Stock Position:  0.004003631203127367
Bond Position:  [-3.56396037]


portfolio before change:  [-3.13992444]
curr_Stock_Price:  106.35803696614325
curr_Factors:  [ 1.06358037e+02  9.09570286e-02 -9.30248897e-01]
mat_Sqrt:  [[45.94840982  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00058637 -0.03968319  0.1501716 ]
Stock Position:  -0.0005863675537876961
Bond Position:  [-3.07755954]


portfolio before change:  [-3.14523114]
curr_Stock_Price:  112.7832453420573
curr_Factors:  [ 1.12783245e+02  5.18157263e-02 -9.40555278e-01]
mat_Sqrt:  [[46.37350308  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00077469  0.0404382  -0.51706392]
Stock Position:  0.0007746872183211466
Bond Position:  [-3.23260288]


portfolio before change:  [-3.14817628]
curr_Stock_Price:  111.06845060659028
curr_Factors:  [ 1.11068451e+02  3.62499445e-02 -9.36130208e-01]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-3.14817628]
Stock Price:  106.92992054712639
PL:  [-10.07809682]
Settle:  Tensor("sub_162:0", shape=(), dtype=float64)
PL:  Tensor("sub_163:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  82
output_Z_Vals[:, i, :]:  [[ 1.19279309e+02 -2.92921948e+01 -2.92556094e+01]
 [-7.04779654e-02 -1.14653620e-01 -1.72427800e-03]
 [ 1.86251814e-01  3.58702486e-02 -2.29076234e-02]
 [-6.54093220e-02  1.07009878e-01 -2.02318338e-01]
 [ 2.84607709e-02 -1.05439389e-02 -2.07836744e-02]
 [ 4.76442202e-02 -5.72626085e-02  2.73358173e-02]
 [ 7.86787430e-02  5.22732471e-03 -1.00091702e-01]
 [-1.81594620e-01  1.17168629e-02 -8.81822115e-02]
 [-1.12316166e-01 -3.75507619e-02 -1.01234541e-01]
 [ 3.06998504e-03  2.22885957e-02  9.38757426e-03]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.27930914 -29.29219478 -29.25560936]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  8.31647217  -9.26300532 -83.45811031]
init_Out:  [2.54002979]
Stock Position:  8.316472170547405
Bond position:  [-829.10718727]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [0.16030911]
curr_Stock_Price:  99.76371430277715
curr_Factors:  [99.7637143  -1.22272937 -1.05051881]
mat_Sqrt:  [[10.27338276  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00718267 -0.03625666 -0.00491889]
Stock Position:  -0.007182665882868492
Bond Position:  [0.87687854]


portfolio before change:  [0.1479041]
curr_Stock_Price:  101.551846413301
curr_Factors:  [101.55184641  -1.17347875  -1.01552157]
mat_Sqrt:  [[11.37671993  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0160417   0.01134317 -0.06534907]
Stock Position:  0.016041704663449455
Bond Position:  [-1.48116062]


portfolio before change:  [0.13730386]
curr_Stock_Price:  100.93723088289792
curr_Factors:  [100.93723088  -1.41711175  -1.03581463]
mat_Sqrt:  [[ 8.68478348  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01196857  0.03383949 -0.5771579 ]
Stock Position:  -0.011968565120408281
Bond Position:  [1.34537768]


portfolio before change:  [0.12887502]
curr_Stock_Price:  101.69769764977524
curr_Factors:  [101.69769765  -1.71042896  -1.03799848]
mat_Sqrt:  [[ 6.51154802  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00367748 -0.00333429 -0.05929004]
Stock Position:  0.003677478484769745
Bond Position:  [-0.24511608]


portfolio before change:  [0.1282588]
curr_Stock_Price:  101.56346806774864
curr_Factors:  [101.56346807  -1.40508397  -1.00534129]
mat_Sqrt:  [[ 9.1180744   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00567506 -0.01810803  0.07798148]
Stock Position:  0.005675058584533561
Bond Position:  [-0.44811983]


portfolio before change:  [0.12365778]
curr_Stock_Price:  100.79221384748674
curr_Factors:  [100.79221385  -0.83440117  -0.98880383]
mat_Sqrt:  [[16.2786772   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00358644  0.00165303 -0.28553377]
Stock Position:  0.003586444900337278
Bond Position:  [-0.23782795]


portfolio before change:  [0.12653563]
curr_Stock_Price:  101.6278027266772
curr_Factors:  [101.62780273  -1.264995    -0.96145921]
mat_Sqrt:  [[10.96669483  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0181725  0.0037052 -0.2515593]
Stock Position:  -0.018172495354345276
Bond Position:  [1.9733664]


portfolio before change:  [0.14009044]
curr_Stock_Price:  100.936214363581
curr_Factors:  [100.93621436  -1.06240804  -0.94214036]
mat_Sqrt:  [[13.59824003  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00985055 -0.01187459 -0.28879397]
Stock Position:  -0.009850549481921893
Bond Position:  [1.13436762]


portfolio before change:  [0.15405552]
curr_Stock_Price:  99.576112273388
curr_Factors:  [99.57611227 -0.70541689 -0.9206507 ]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [0.15405552]
Stock Price:  98.75590016981522
PL:  [0.15405552]
Settle:  Tensor("sub_164:0", shape=(), dtype=float64)
PL:  Tensor("sub_165:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  83
output_Z_Vals[:, i, :]:  [[ 1.19279309e+02 -2.92921948e+01 -2.92556094e+01]
 [-7.04779654e-02 -1.14653620e-01 -1.72427800e-03]
 [ 2.47052342e-01  6.54973671e-02 -1.34421711e-01]
 [-5.54657006e-02  1.13951964e-01 -1.26727702e-01]
 [ 2.44230402e-02 -1.43731911e-02 -1.77320790e-02]
 [ 4.35657533e-02 -5.47652299e-02  3.13702766e-02]
 [ 7.39485398e-02  2.09653660e-02 -1.83769226e-01]
 [-1.55465027e-01 -1.78685839e-02 -3.15720517e-02]
 [-1.16814658e-01 -5.25237405e-02 -8.92015665e-02]
 [ 2.47919465e-03  2.05120868e-02  1.06363999e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.27930914 -29.29219478 -29.25560936]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  8.31647217  -9.26300532 -83.45811031]
init_Out:  [2.54002979]
Stock Position:  8.316472170547405
Bond position:  [-829.10718727]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [9.05077151]
curr_Stock_Price:  100.8327327778971
curr_Factors:  [100.83273278  -1.5877194   -0.93518191]
mat_Sqrt:  [[ 8.08945793  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00912178 -0.03625666 -0.00491889]
Stock Position:  -0.009121782510165204
Bond Position:  [9.97054577]


portfolio before change:  [9.05468041]
curr_Stock_Price:  100.95086985070435
curr_Factors:  [100.95086985  -1.18561715  -0.93410958]
mat_Sqrt:  [[12.12060899  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01825855  0.02071209 -0.38346773]
Stock Position:  0.018258551246182905
Bond Position:  [7.21146378]


portfolio before change:  [9.08156714]
curr_Stock_Price:  102.22589420265565
curr_Factors:  [102.2258942   -1.18876513  -0.9202295 ]
mat_Sqrt:  [[12.406126    0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00631879  0.03603477 -0.36151886]
Stock Position:  -0.006318786176747183
Bond Position:  [9.72751071]


portfolio before change:  [9.09106577]
curr_Stock_Price:  101.49257998831686
curr_Factors:  [101.49257999  -1.40453097  -0.9055884 ]
mat_Sqrt:  [[10.07307802  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00202841 -0.0045452  -0.05058469]
Stock Position:  0.0020284147964177396
Bond Position:  [8.88519672]


portfolio before change:  [9.09474152]
curr_Stock_Price:  101.11398318263998
curr_Factors:  [101.11398318  -0.94827416  -0.96098883]
mat_Sqrt:  [[14.98403697  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00324046 -0.01731829  0.08949067]
Stock Position:  0.0032404586370554677
Bond Position:  [8.76708584]


portfolio before change:  [9.099989]
curr_Stock_Price:  101.38025155930353
curr_Factors:  [101.38025156  -1.23338528  -0.9837327 ]
mat_Sqrt:  [[11.04259797  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00334868  0.00662983 -0.52424245]
Stock Position:  0.0033486800124694427
Bond Position:  [8.76049897]


portfolio before change:  [9.10226218]
curr_Stock_Price:  100.75070182775626
curr_Factors:  [100.75070183  -1.36532496  -1.01876559]
mat_Sqrt:  [[ 9.28647109  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01748468 -0.00565054 -0.09006628]
Stock Position:  -0.01748468368698047
Bond Position:  [10.86385633]


portfolio before change:  [9.12019316]
curr_Stock_Price:  100.03592255905441
curr_Factors:  [100.03592256  -1.18229435  -0.99707108]
mat_Sqrt:  [[11.3153919   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01205252 -0.01660947 -0.25446724]
Stock Position:  -0.01205252188132612
Bond Position:  [10.3258783]


portfolio before change:  [9.12912317]
curr_Stock_Price:  99.72347466725353
curr_Factors:  [99.72347467 -1.10904136 -1.0330648 ]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [9.12912317]
Stock Price:  99.23231721738661
PL:  [9.12912317]
Settle:  Tensor("sub_166:0", shape=(), dtype=float64)
PL:  Tensor("sub_167:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  84
output_Z_Vals[:, i, :]:  [[ 1.19279309e+02 -2.92921948e+01 -2.92556094e+01]
 [-6.70242121e-02 -8.43816068e-02  2.45340656e-02]
 [ 7.60855160e-01  7.55077426e-02 -3.55828460e-01]
 [ 3.04281302e-01 -1.48515895e-01 -1.36491314e-01]
 [-1.24464112e-01  1.13432106e-01  1.83956982e-01]
 [ 5.04634683e-02 -4.80287820e-02  2.45398101e-02]
 [ 7.45380816e-02  1.86709292e-02 -1.70684640e-01]
 [-1.59774183e-01 -1.29895064e-02 -4.09079038e-02]
 [-9.64498050e-02 -6.03436863e-02 -7.15324617e-02]
 [ 5.55330598e-03  3.73214098e-02  9.86867671e-03]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.27930914 -29.29219478 -29.25560936]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  8.31647217  -9.26300532 -83.45811031]
init_Out:  [2.54002979]
Stock Position:  8.316472170547405
Bond position:  [-829.10718727]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-6.08745363]
curr_Stock_Price:  99.0124627369475
curr_Factors:  [99.01246274 -0.94624748 -0.97190215]
mat_Sqrt:  [[14.542801    0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00441421 -0.02668381  0.06998886]
Stock Position:  -0.004414207457593284
Bond Position:  [-5.65039208]


portfolio before change:  [-6.08663263]
curr_Stock_Price:  98.18628831360331
curr_Factors:  [98.18628831 -1.08375205 -0.95976106]
mat_Sqrt:  [[12.72226315  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.05424912  0.02387764 -1.01507955]
Stock Position:  0.05424912010678889
Bond Position:  [-11.41315237]


portfolio before change:  [-6.08885589]
curr_Stock_Price:  98.25052417587641
curr_Factors:  [98.25052418 -1.350746   -0.9348464 ]
mat_Sqrt:  [[ 9.99343304  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.02727646 -0.04696485 -0.38937173]
Stock Position:  0.02727645883629002
Bond Position:  [-8.76878227]


portfolio before change:  [-6.08312722]
curr_Stock_Price:  98.62132595449584
curr_Factors:  [98.62132595 -1.04305374 -0.95799856]
mat_Sqrt:  [[13.33290742  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00629909  0.03587038  0.52477807]
Stock Position:  -0.006299094652187103
Bond Position:  [-5.46190215]


portfolio before change:  [-6.09616133]
curr_Stock_Price:  100.25687517627897
curr_Factors:  [100.25687518  -1.19213842  -0.95209058]
mat_Sqrt:  [[11.7459283   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00461714 -0.01518803  0.07000525]
Stock Position:  0.004617135131694566
Bond Position:  [-6.55906087]


portfolio before change:  [-6.09226835]
curr_Stock_Price:  101.81050715512656
curr_Factors:  [101.81050716  -1.22031765  -0.95022991]
mat_Sqrt:  [[11.6181178   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00345833  0.00590427 -0.48691577]
Stock Position:  0.00345833183046976
Bond Position:  [-6.44436287]


portfolio before change:  [-6.09904904]
curr_Stock_Price:  100.78177412564666
curr_Factors:  [100.78177413  -1.20613064  -0.90717958]
mat_Sqrt:  [[12.17819811  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01383291 -0.00410764 -0.11669886]
Stock Position:  -0.013832905323673301
Bond Position:  [-4.7049443]


portfolio before change:  [-6.09696433]
curr_Stock_Price:  100.46096166043522
curr_Factors:  [100.46096166  -1.79222507  -0.86023909]
mat_Sqrt:  [[ 7.08022044  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01590478 -0.01908235 -0.2040622 ]
Stock Position:  -0.015904783737129828
Bond Position:  [-4.49915446]


portfolio before change:  [-6.10544773]
curr_Stock_Price:  100.85287263019849
curr_Factors:  [100.85287263  -1.79009625  -0.91406987]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-6.10544773]
Stock Price:  100.62631098146245
PL:  [-6.73175871]
Settle:  Tensor("sub_168:0", shape=(), dtype=float64)
PL:  Tensor("sub_169:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  85
output_Z_Vals[:, i, :]:  [[ 1.19279309e+02 -2.92921948e+01 -2.92556094e+01]
 [-6.28174469e-02 -4.75094748e-02  5.65174397e-02]
 [ 1.62547954e-01  4.33612190e-02 -5.43344757e-02]
 [ 3.88177243e-02  3.53084976e-02 -2.11499269e-01]
 [ 3.40563378e-02 -7.59315200e-02 -4.90836828e-02]
 [ 4.72859081e-02 -3.68092575e-02  2.76770088e-02]
 [ 8.75033570e-02 -2.79465169e-02  1.59083995e-01]
 [-2.80067060e-02 -8.78277983e-02  1.03434737e-01]
 [-1.33308996e-01 -3.42335126e-02 -1.14633739e-01]
 [-5.75454900e-03 -3.18654593e-02  6.37745886e-03]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.27930914 -29.29219478 -29.25560936]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  8.31647217  -9.26300532 -83.45811031]
init_Out:  [2.54002979]
Stock Position:  8.316472170547405
Bond position:  [-829.10718727]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [0.96855268]
curr_Stock_Price:  99.86090017052281
curr_Factors:  [99.86090017 -0.83157538 -1.05329265]
mat_Sqrt:  [[15.16378755  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00346269 -0.01502382  0.16122852]
Stock Position:  -0.0034626943995186704
Bond Position:  [1.31434046]


portfolio before change:  [0.96495565]
curr_Stock_Price:  101.08952810589123
curr_Factors:  [101.08952811  -0.67364651  -1.04620162]
mat_Sqrt:  [[18.10446178  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00842757  0.01371202 -0.15500114]
Stock Position:  0.008427566593664755
Bond Position:  [0.11301692]


portfolio before change:  [0.95548132]
curr_Stock_Price:  99.9586148523682
curr_Factors:  [99.95861485 -0.47148807 -0.97828199]
mat_Sqrt:  [[23.45271329  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-1.46794178e-04  1.11655273e-02 -6.03348545e-01]
Stock Position:  -0.00014679417766597186
Bond Position:  [0.97015467]


portfolio before change:  [0.95545932]
curr_Stock_Price:  103.41382001292463
curr_Factors:  [103.41382001  -0.92600368  -1.00025674]
mat_Sqrt:  [[15.06656717  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00146527 -0.02401165 -0.14002208]
Stock Position:  0.0014652727004180622
Bond Position:  [0.80392987]


portfolio before change:  [0.95374041]
curr_Stock_Price:  101.9663254388546
curr_Factors:  [101.96632544  -0.46742493  -1.02592868]
mat_Sqrt:  [[22.90348332  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00226974 -0.01164011  0.0789548 ]
Stock Position:  0.0022697439609052268
Bond Position:  [0.72230296]


portfolio before change:  [0.94855038]
curr_Stock_Price:  99.52055511114487
curr_Factors:  [99.52055511 -0.55547886 -1.01543795]
mat_Sqrt:  [[20.68579836  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00576505 -0.00883746  0.45382236]
Stock Position:  0.005765050183126831
Bond Position:  [0.37480938]


portfolio before change:  [0.94273053]
curr_Stock_Price:  98.47853396890284
curr_Factors:  [98.47853397 -0.51936385 -0.98837289]
mat_Sqrt:  [[21.80418351  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00042014 -0.02777359  0.29507051]
Stock Position:  -0.0004201433496915515
Bond Position:  [0.98410563]


portfolio before change:  [0.94247435]
curr_Stock_Price:  100.25970472678212
curr_Factors:  [100.25970473  -0.55148414  -0.94754432]
mat_Sqrt:  [[22.39270884  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00703767 -0.01082559 -0.32701815]
Stock Position:  -0.007037666428337148
Bond Position:  [1.64806871]


portfolio before change:  [0.95633338]
curr_Stock_Price:  98.40755861051451
curr_Factors:  [98.40755861 -0.27573155 -0.93997698]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [0.95633338]
Stock Price:  99.01482761761272
PL:  [0.95633338]
Settle:  Tensor("sub_170:0", shape=(), dtype=float64)
PL:  Tensor("sub_171:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  86
output_Z_Vals[:, i, :]:  [[ 1.19279309e+02 -2.92921948e+01 -2.92556094e+01]
 [-5.12098771e-02  1.35752488e-02  1.12005780e-01]
 [ 4.41203933e-01  7.17156348e-02 -2.48213864e-01]
 [ 6.38958302e-02  1.80435153e-02 -2.13789022e-01]
 [-5.48156275e-02  2.72728135e-02  8.07906662e-02]
 [ 4.38317527e-02 -5.47864899e-02  3.11070546e-02]
 [ 7.62253449e-02  1.21448977e-02 -1.32634674e-01]
 [-2.14391669e-01  5.10309224e-02 -1.58828687e-01]
 [-2.53338068e-02  1.89138117e-02 -1.10968979e-01]
 [ 6.37291922e-02  3.30294097e-01 -1.83653729e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.27930914 -29.29219478 -29.25560936]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  8.31647217  -9.26300532 -83.45811031]
init_Out:  [2.54002979]
Stock Position:  8.316472170547405
Bond position:  [-829.10718727]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-17.32741466]
curr_Stock_Price:  97.66093280911548
curr_Factors:  [97.66093281 -0.90086088 -0.8951889 ]
mat_Sqrt:  [[16.20713905  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0017274   0.00429287  0.31952131]
Stock Position:  -0.0017274042865480386
Bond Position:  [-17.15871475]


portfolio before change:  [-17.33899339]
curr_Stock_Price:  99.39603621498948
curr_Factors:  [99.39603621 -0.70393531 -0.85480422]
mat_Sqrt:  [[20.91303627  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0187629   0.02267847 -0.70808506]
Stock Position:  0.018762898660476146
Bond Position:  [-19.20395114]


portfolio before change:  [-17.34036085]
curr_Stock_Price:  99.83503615641516
curr_Factors:  [99.83503616 -0.36709783 -0.87761602]
mat_Sqrt:  [[28.75481804  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00072065  0.00570586 -0.60988057]
Stock Position:  0.0007206517647029613
Bond Position:  [-17.41230715]


portfolio before change:  [-17.34875477]
curr_Stock_Price:  100.27132689634112
curr_Factors:  [100.2713269   -0.62117503  -0.87881684]
mat_Sqrt:  [[22.37373905  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00168144  0.00862442  0.23047328]
Stock Position:  -0.0016814409378696688
Bond Position:  [-17.18015446]


portfolio before change:  [-17.35731466]
curr_Stock_Price:  100.25209435317282
curr_Factors:  [100.25209435  -0.96430156  -0.88540644]
mat_Sqrt:  [[15.76795881  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00309278 -0.01732501  0.08873977]
Stock Position:  0.0030927828476629946
Bond Position:  [-17.66737262]


portfolio before change:  [-17.36179216]
curr_Stock_Price:  101.66130943504449
curr_Factors:  [101.66130944  -1.06000481  -0.92993872]
mat_Sqrt:  [[13.89742065  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00355929  0.00384055 -0.37836981]
Stock Position:  0.0035592925184522073
Bond Position:  [-17.72363449]


portfolio before change:  [-17.36254311]
curr_Stock_Price:  103.94071831215804
curr_Factors:  [103.94071831  -1.57622414  -0.97827084]
mat_Sqrt:  [[ 8.07946564  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.03038503  0.01613739 -0.45309403]
Stock Position:  -0.030385032573891666
Bond Position:  [-14.20430099]


portfolio before change:  [-17.36220284]
curr_Stock_Price:  103.6957228590752
curr_Factors:  [103.69572286  -1.11993693  -0.9349131 ]
mat_Sqrt:  [[13.28467132  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00357532  0.00598107 -0.31656361]
Stock Position:  -0.0035753163208480402
Bond Position:  [-16.99145783]


portfolio before change:  [-17.36817644]
curr_Stock_Price:  102.98969998888255
curr_Factors:  [102.98969999  -0.90207773  -0.88698794]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-17.36817644]
Stock Price:  101.08252170281645
PL:  [-18.45069814]
Settle:  Tensor("sub_172:0", shape=(), dtype=float64)
PL:  Tensor("sub_173:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  87
output_Z_Vals[:, i, :]:  [[ 1.19279309e+02 -2.92921948e+01 -2.92556094e+01]
 [-5.85669799e-02 -2.10494537e-02  8.01337379e-02]
 [ 2.26280676e-01  6.83824293e-02 -1.81750917e-01]
 [-6.35805606e-02  1.07268191e-01 -1.92981422e-01]
 [-1.68410826e-02 -1.06409165e-03  3.07618159e-02]
 [ 4.27953138e-02 -5.80936042e-02  3.21348922e-02]
 [ 8.54474774e-02  2.92803998e-03 -1.22267044e-01]
 [-1.90331900e-01  2.16097192e-02 -1.07111660e-01]
 [-7.52191088e-02 -6.56602187e-02 -5.50676245e-02]
 [ 5.31998423e-03  3.88431492e-02  1.22185513e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.27930914 -29.29219478 -29.25560936]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  8.31647217  -9.26300532 -83.45811031]
init_Out:  [2.54002979]
Stock Position:  8.316472170547405
Bond position:  [-829.10718727]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [8.97624731]
curr_Stock_Price:  100.82377174257677
curr_Factors:  [100.82377174  -0.60899373  -1.06636292]
mat_Sqrt:  [[18.87838284  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00226467 -0.00665642  0.22859925]
Stock Position:  -0.0022646666308734215
Bond Position:  [9.20457954]


portfolio before change:  [8.98251861]
curr_Stock_Price:  100.0873006955128
curr_Factors:  [100.0873007   -0.37264576  -1.06449664]
mat_Sqrt:  [[23.78132027  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00802927  0.02162442 -0.51848478]
Stock Position:  0.008029266227304589
Bond Position:  [8.17889103]


portfolio before change:  [8.9945819]
curr_Stock_Price:  101.0802705708902
curr_Factors:  [101.08027057  -1.08416106  -1.06280266]
mat_Sqrt:  [[11.81005437  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00848456  0.03392118 -0.55052228]
Stock Position:  -0.008484556675626316
Bond Position:  [9.85220318]


portfolio before change:  [9.00279087]
curr_Stock_Price:  100.6934921965778
curr_Factors:  [100.6934922   -1.37161977  -1.04497527]
mat_Sqrt:  [[ 8.98436762  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00117864 -0.0003365   0.0877549 ]
Stock Position:  -0.0011786392152659479
Bond Position:  [9.12147217]


portfolio before change:  [9.007162]
curr_Stock_Price:  100.85533570905693
curr_Factors:  [100.85533571  -0.55689446  -1.01113263]
mat_Sqrt:  [[21.02390401  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00227621 -0.01837081  0.0916719 ]
Stock Position:  0.0022762114378560186
Bond Position:  [8.77759393]


portfolio before change:  [9.01259319]
curr_Stock_Price:  101.31280557456424
curr_Factors:  [101.31280557  -0.80238721  -1.0555162 ]
mat_Sqrt:  [[15.80473233  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00383211  0.00092593 -0.34879384]
Stock Position:  0.0038321068653616986
Bond Position:  [8.62435169]


portfolio before change:  [9.01910008]
curr_Stock_Price:  101.88524204396472
curr_Factors:  [101.88524204  -1.01301798  -1.05335221]
mat_Sqrt:  [[12.90322026  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01640195  0.00683359 -0.30555975]
Stock Position:  -0.016401953242395916
Bond Position:  [10.69021706]


portfolio before change:  [9.06950264]
curr_Stock_Price:  99.13824525391645
curr_Factors:  [99.13824525 -1.31036581 -1.05634378]
mat_Sqrt:  [[ 9.2980593   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00948102 -0.02076358 -0.1570926 ]
Stock Position:  -0.009481019342986438
Bond Position:  [10.00943426]


portfolio before change:  [9.06292204]
curr_Stock_Price:  100.36032565555833
curr_Factors:  [100.36032566  -1.57972017  -1.06833763]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [9.06292204]
Stock Price:  100.66095453303906
PL:  [8.40196751]
Settle:  Tensor("sub_174:0", shape=(), dtype=float64)
PL:  Tensor("sub_175:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  88
output_Z_Vals[:, i, :]:  [[ 1.19279309e+02 -2.92921948e+01 -2.92556094e+01]
 [-5.42405801e-02  2.76664278e-02  1.21726010e-01]
 [ 1.67145474e-01  4.23051678e-02 -5.39460040e-02]
 [ 1.46620312e-01 -2.94968312e-02 -1.62394241e-01]
 [-1.32024163e-01  1.23966149e-01  1.95554450e-01]
 [ 3.91747502e-02 -7.46347296e-02  3.57286766e-02]
 [ 8.61256086e-02 -2.46358741e-02  1.13028582e-01]
 [-2.72601839e-02 -1.04266732e-01  9.18814164e-02]
 [-3.03204578e-02 -7.20644658e-02 -2.35846567e-02]
 [-1.41441394e-02 -8.28840411e-02  3.71179060e-03]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.27930914 -29.29219478 -29.25560936]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  8.31647217  -9.26300532 -83.45811031]
init_Out:  [2.54002979]
Stock Position:  8.316472170547405
Bond position:  [-829.10718727]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [0.73128266]
curr_Stock_Price:  99.83237004223786
curr_Factors:  [99.83237004 -0.7098668  -0.9965989 ]
mat_Sqrt:  [[18.12019     0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00158271  0.00874889  0.34725042]
Stock Position:  -0.0015827106816575908
Bond Position:  [0.88928842]


portfolio before change:  [0.72967943]
curr_Stock_Price:  101.12634451287839
curr_Factors:  [101.12634451  -0.72380095  -1.04606207]
mat_Sqrt:  [[17.2275121   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00912645  0.01337807 -0.15389293]
Stock Position:  0.009126454580400917
Bond Position:  [-0.19324556]


portfolio before change:  [0.71245558]
curr_Stock_Price:  99.24969033064343
curr_Factors:  [99.24969033 -1.32947643 -1.08539379]
mat_Sqrt:  [[ 8.87083185  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0127057  -0.00932772 -0.46326557]
Stock Position:  0.012705699249154915
Bond Position:  [-0.54858114]


portfolio before change:  [0.70277163]
curr_Stock_Price:  98.50911025670685
curr_Factors:  [98.50911026 -0.98690613 -1.0550872 ]
mat_Sqrt:  [[12.78350542  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00695474  0.03920154  0.55786241]
Stock Position:  -0.006954742327757327
Bond Position:  [1.38787711]


portfolio before change:  [0.69897735]
curr_Stock_Price:  99.15448276035669
curr_Factors:  [99.15448276 -0.64422012 -1.0765846 ]
mat_Sqrt:  [[17.74092914  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00251062 -0.02360157  0.10192397]
Stock Position:  0.0025106224707473397
Bond Position:  [0.45003787]


portfolio before change:  [0.69462997]
curr_Stock_Price:  97.33324237649433
curr_Factors:  [97.33324238 -0.9948405  -1.04084326]
mat_Sqrt:  [[12.71086097  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00854084 -0.00779055  0.32243908]
Stock Position:  0.00854083574506596
Bond Position:  [-0.13667726]


portfolio before change:  [0.7019946]
curr_Stock_Price:  98.20353030987685
curr_Factors:  [98.20353031 -0.99873341 -1.11181164]
mat_Sqrt:  [[11.89950875  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00094097 -0.03297204  0.26211211]
Stock Position:  -0.0009409736108177575
Bond Position:  [0.79440154]


portfolio before change:  [0.70234603]
curr_Stock_Price:  98.25227974968996
curr_Factors:  [98.25227975 -0.83106568 -1.0564059 ]
mat_Sqrt:  [[14.88072688  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00248613 -0.02278879 -0.06728046]
Stock Position:  -0.0024861253371720017
Bond Position:  [0.94661352]


portfolio before change:  [0.70349758]
curr_Stock_Price:  97.9795178506825
curr_Factors:  [97.97951785 -0.83210758 -1.06048101]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [0.70349758]
Stock Price:  98.67469755940489
PL:  [0.70349758]
Settle:  Tensor("sub_176:0", shape=(), dtype=float64)
PL:  Tensor("sub_177:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  89
output_Z_Vals[:, i, :]:  [[ 1.19279309e+02 -2.92921948e+01 -2.92556094e+01]
 [-7.04779654e-02 -1.14653620e-01 -1.72427800e-03]
 [ 4.38656348e-01  7.02337712e-02 -2.58275570e-01]
 [ 3.25565628e-01 -1.71548832e-01 -1.35455600e-01]
 [-1.97589670e-01  2.13140244e-01  2.95400902e-01]
 [ 7.31771420e-02  1.96811087e-02  2.13900194e-04]
 [-2.05306452e-01 -1.10374471e-01  3.13099698e-01]
 [ 1.31319545e-01 -9.18656522e-02 -5.78659645e-02]
 [ 3.05127840e-02 -8.18671713e-02  1.19956001e-01]
 [-7.44478636e-03 -4.40308325e-02 -8.86522973e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.27930914 -29.29219478 -29.25560936]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  8.31647217  -9.26300532 -83.45811031]
init_Out:  [2.54002979]
Stock Position:  8.316472170547405
Bond position:  [-829.10718727]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-12.49283487]
curr_Stock_Price:  98.24225860342534
curr_Factors:  [98.2422586  -1.08605748 -1.03065685]
mat_Sqrt:  [[11.83098731  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00623703 -0.03625666 -0.00491889]
Stock Position:  -0.006237034487667568
Bond Position:  [-11.88009452]


portfolio before change:  [-12.50648522]
curr_Stock_Price:  99.4782328451011
curr_Factors:  [99.47823285 -0.82799057 -1.01880438]
mat_Sqrt:  [[15.69188832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.02471019  0.02220987 -0.73678831]
Stock Position:  0.024710187105658525
Bond Position:  [-14.96461096]


portfolio before change:  [-12.58361528]
curr_Stock_Price:  96.65972394912488
curr_Factors:  [96.65972395 -0.56100899 -1.04835187]
mat_Sqrt:  [[19.33343433  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01518026 -0.0542485  -0.38641712]
Stock Position:  0.015180256793494185
Bond Position:  [-14.05093471]


portfolio before change:  [-12.57754209]
curr_Stock_Price:  97.5227136302601
curr_Factors:  [97.52271363 -0.61652035 -1.04865352]
mat_Sqrt:  [[18.44717873  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00714407  0.06740086  0.84269655]
Stock Position:  -0.007144071087124961
Bond Position:  [-11.8808329]


portfolio before change:  [-12.56425817]
curr_Stock_Price:  94.83155573121309
curr_Factors:  [94.83155573 -0.57584983 -1.0220268 ]
mat_Sqrt:  [[19.18685839  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00384268 0.00622371 0.0006102 ]
Stock Position:  0.003842680588567979
Bond Position:  [-12.92866555]


portfolio before change:  [-12.57703776]
curr_Stock_Price:  93.18852643797733
curr_Factors:  [93.18852644 -0.43289999 -0.95375423]
mat_Sqrt:  [[23.28874941  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00619377 -0.03490347  0.89318629]
Stock Position:  -0.006193767536428336
Bond Position:  [-11.99984969]


portfolio before change:  [-12.57216213]
curr_Stock_Price:  91.43239769935961
curr_Factors:  [91.4323977  -0.29813532 -0.95582127]
mat_Sqrt:  [[26.092379    0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00448927 -0.02905047 -0.16507549]
Stock Position:  0.004489270347718047
Bond Position:  [-12.98262688]


portfolio before change:  [-12.57702221]
curr_Stock_Price:  91.79612152142136
curr_Factors:  [91.79612152 -0.13765694 -0.97421569]
mat_Sqrt:  [[30.19563608  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00175141 -0.02588867  0.34220108]
Stock Position:  0.0017514086740706997
Bond Position:  [-12.73779474]


portfolio before change:  [-12.58401135]
curr_Stock_Price:  91.44289100422503
curr_Factors:  [91.442891   -0.60252788 -0.97364167]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-12.58401135]
Stock Price:  91.4811736493883
PL:  [-12.58401135]
Settle:  Tensor("sub_178:0", shape=(), dtype=float64)
PL:  Tensor("sub_179:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  90
output_Z_Vals[:, i, :]:  [[ 1.19279309e+02 -2.92921948e+01 -2.92556094e+01]
 [-5.43119279e-02  2.70410670e-02  1.21183564e-01]
 [ 1.24515550e-01  5.25993758e-02 -5.38479214e-02]
 [-5.42631164e-02  1.51267428e-01  4.59205616e-02]
 [ 4.12228277e-02 -1.09294846e-01 -5.19565939e-02]
 [ 1.25373906e-01  3.23475812e-01 -4.98357292e-02]
 [ 1.01733235e-01 -3.28710855e-03 -1.56908623e-01]
 [-1.36815634e-01 -2.50691840e-02 -6.76611837e-02]
 [ 2.07454009e-02  4.61103889e-02 -1.13960291e-01]
 [ 6.64307031e-02  3.52385527e-01 -4.50790242e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.27930914 -29.29219478 -29.25560936]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  8.31647217  -9.26300532 -83.45811031]
init_Out:  [2.54002979]
Stock Position:  8.316472170547405
Bond position:  [-829.10718727]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [1.2535375]
curr_Stock_Price:  99.89516768429232
curr_Factors:  [99.89516768 -0.64725835 -0.99865686]
mat_Sqrt:  [[19.26338412  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00149907  0.00855114  0.34570298]
Stock Position:  -0.0014990740460037377
Bond Position:  [1.40328775]


portfolio before change:  [1.2528486]
curr_Stock_Price:  100.82288765708884
curr_Factors:  [100.82288766  -0.2778136   -0.99645145]
mat_Sqrt:  [[28.1937505   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00407473  0.01663338 -0.15361313]
Stock Position:  0.004074732784325378
Bond Position:  [0.84202227]


portfolio before change:  [1.27089391]
curr_Stock_Price:  105.14812779575003
curr_Factors:  [105.1481278   -0.7746417   -0.99610824]
mat_Sqrt:  [[17.89676843  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00229002  0.04783496  0.13099858]
Stock Position:  -0.002290017495387018
Bond Position:  [1.51168497]


portfolio before change:  [1.27588291]
curr_Stock_Price:  103.29968526947182
curr_Factors:  [103.29968527  -0.4158483   -0.93724736]
mat_Sqrt:  [[26.69666541  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00104115 -0.03456206 -0.1482177 ]
Stock Position:  0.0010411506881950893
Bond Position:  [1.16833237]


portfolio before change:  [1.27851383]
curr_Stock_Price:  105.26540410592844
curr_Factors:  [105.26540411  -0.26759828  -0.92533744]
mat_Sqrt:  [[31.93009873  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00386949  0.10229203 -0.14216746]
Stock Position:  0.00386949444395423
Bond Position:  [0.87118994]


portfolio before change:  [1.28526711]
curr_Stock_Price:  106.89806553435474
curr_Factors:  [106.89806553  -1.05848794  -0.92073256]
mat_Sqrt:  [[14.77084376  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00471331 -0.00103947 -0.44761663]
Stock Position:  0.004713307176176924
Bond Position:  [0.78142369]


portfolio before change:  [1.27825045]
curr_Stock_Price:  105.32645886181672
curr_Factors:  [105.32645886  -0.96473619  -0.96494836]
mat_Sqrt:  [[15.29276917  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00989188 -0.00792757 -0.19301852]
Stock Position:  -0.009891877452538354
Bond Position:  [2.32012688]


portfolio before change:  [1.28118991]
curr_Stock_Price:  105.1466037855498
curr_Factors:  [105.14660379  -1.23159846  -0.9627398 ]
mat_Sqrt:  [[11.71672542  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-1.13178467e-04  1.45813853e-02 -3.25096990e-01]
Stock Position:  -0.00011317846688660988
Bond Position:  [1.29309024]


portfolio before change:  [1.28186272]
curr_Stock_Price:  104.91601584144118
curr_Factors:  [104.91601584  -1.43750302  -0.95847466]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [1.28186272]
Stock Price:  105.01073942217555
PL:  [-3.7288767]
Settle:  Tensor("sub_180:0", shape=(), dtype=float64)
PL:  Tensor("sub_181:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  91
output_Z_Vals[:, i, :]:  [[ 1.19279309e+02 -2.92921948e+01 -2.92556094e+01]
 [ 3.15224444e-03  1.99885390e-01  3.03043768e-01]
 [ 8.22837079e-01  8.05044974e-02 -3.44640438e-01]
 [ 3.58354091e-01 -2.14107412e-01 -1.29092140e-01]
 [-4.04361785e-01  5.34640656e-01  6.23863281e-01]
 [ 1.33106275e-01  1.95160041e-01 -6.48227753e-02]
 [ 8.73464367e-02 -2.80371258e-02  1.60129511e-01]
 [ 1.31316324e-01 -9.18728714e-02 -5.78749810e-02]
 [-3.85624864e-02 -7.80075792e-02  1.12357120e-01]
 [-7.51581230e-03 -4.50788768e-02 -8.56165848e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.27930914 -29.29219478 -29.25560936]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  8.31647217  -9.26300532 -83.45811031]
init_Out:  [2.54002979]
Stock Position:  8.316472170547405
Bond position:  [-829.10718727]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-22.40396357]
curr_Stock_Price:  97.05051185079208
curr_Factors:  [97.05051185 -0.43079406 -1.04642176]
mat_Sqrt:  [[22.15394909  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00316746 0.06320931 0.86449952]
Stock Position:  0.003167462958317337
Bond Position:  [-22.71136747]


portfolio before change:  [-22.41495744]
curr_Stock_Price:  97.16563612224517
curr_Factors:  [97.16563612 -0.24698177 -0.98703142]
mat_Sqrt:  [[28.28704498  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.02667533  0.02545776 -0.98316324]
Stock Position:  0.026675330065224906
Bond Position:  [-25.00688286]


portfolio before change:  [-22.46761138]
curr_Stock_Price:  95.66059889264815
curr_Factors:  [95.66059889 -0.252655   -0.9794368 ]
mat_Sqrt:  [[27.9024555   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01170058 -0.06770671 -0.36826394]
Stock Position:  0.011700584511868652
Bond Position:  [-23.5868963]


portfolio before change:  [-22.51396456]
curr_Stock_Price:  92.70717488258953
curr_Factors:  [92.70717488 -0.48321246 -1.01194645]
mat_Sqrt:  [[20.78615123  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01266285  0.16906822  1.77970829]
Stock Position:  -0.01266284750887779
Bond Position:  [-21.34002774]


portfolio before change:  [-22.54045702]
curr_Stock_Price:  93.95648097768536
curr_Factors:  [93.95648098 -1.17668563 -1.0250269 ]
mat_Sqrt:  [[10.39286158  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01201915  0.06171502 -0.18492133]
Stock Position:  0.012019152903995063
Bond Position:  [-23.66973433]


portfolio before change:  [-22.57205595]
curr_Stock_Price:  92.31234629667016
curr_Factors:  [92.3123463  -1.47847797 -1.02051234]
mat_Sqrt:  [[ 7.58511355  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01572934 -0.00886612  0.45680492]
Stock Position:  0.01572933879280851
Bond Position:  [-24.02406812]


portfolio before change:  [-22.60500186]
curr_Stock_Price:  90.98165646320449
curr_Factors:  [90.98165646 -1.5902428  -1.03119338]
mat_Sqrt:  [[ 6.614219    0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01770889 -0.02905275 -0.16510121]
Stock Position:  0.01770889285725454
Bond Position:  [-24.21618626]


portfolio before change:  [-22.61339466]
curr_Stock_Price:  91.19162531787475
curr_Factors:  [91.19162532 -1.81448319 -1.00204345]
mat_Sqrt:  [[ 5.4544753   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00323438 -0.02466816  0.32052359]
Stock Position:  -0.0032343775183994333
Bond Position:  [-22.31844652]


portfolio before change:  [-22.62705918]
curr_Stock_Price:  91.96534674684507
curr_Factors:  [91.96534675 -1.57940877 -1.01210304]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-22.62705918]
Stock Price:  91.45512696635886
PL:  [-22.62705918]
Settle:  Tensor("sub_182:0", shape=(), dtype=float64)
PL:  Tensor("sub_183:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  92
output_Z_Vals[:, i, :]:  [[ 1.19279309e+02 -2.92921948e+01 -2.92556094e+01]
 [-4.84630258e-02  7.83064658e-02  1.65651848e-01]
 [ 2.48345248e-01  7.12048593e-02 -1.69917610e-01]
 [-6.47050906e-02  1.07109351e-01 -1.98722817e-01]
 [-1.70138862e-02  1.00004096e-03  3.16429515e-02]
 [ 4.22590685e-02 -6.11288606e-02  3.26675546e-02]
 [ 1.08597202e-01 -5.17631290e-03 -1.23914204e-01]
 [-7.84831171e-03 -1.31399581e-01  2.39659362e-02]
 [ 4.14452486e-02  8.59517854e-02 -1.48242903e-01]
 [ 6.91313018e-02  3.85585089e-01 -1.31991352e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.27930914 -29.29219478 -29.25560936]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  8.31647217  -9.26300532 -83.45811031]
init_Out:  [2.54002979]
Stock Position:  8.316472170547405
Bond position:  [-829.10718727]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-7.64237863]
curr_Stock_Price:  98.8254934346929
curr_Factors:  [98.82549343 -0.53185036 -0.99533537]
mat_Sqrt:  [[21.45955238  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00058844  0.02476268  0.47255861]
Stock Position:  -0.0005884381704507059
Bond Position:  [-7.58422594]


portfolio before change:  [-7.64717682]
curr_Stock_Price:  100.53362998121075
curr_Factors:  [100.53362998  -0.89396425  -1.02660541]
mat_Sqrt:  [[14.73053631  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01462944  0.02251695 -0.48472765]
Stock Position:  0.014629437683937041
Bond Position:  [-9.1179273]


portfolio before change:  [-7.64369312]
curr_Stock_Price:  101.08346672158335
curr_Factors:  [101.08346672  -1.1677209   -1.02105395]
mat_Sqrt:  [[11.32680152  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00904966  0.03387095 -0.56690088]
Stock Position:  -0.00904965661339635
Bond Position:  [-6.72892246]


portfolio before change:  [-7.64354857]
curr_Stock_Price:  100.69562320716321
curr_Factors:  [100.69562321  -1.36571192  -1.02261301]
mat_Sqrt:  [[ 9.24217647  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00113923  0.00031624  0.09026853]
Stock Position:  -0.0011392310906851563
Bond Position:  [-7.52883299]


portfolio before change:  [-7.64667695]
curr_Stock_Price:  100.13648736798895
curr_Factors:  [100.13648737  -0.58219923  -0.98721599]
mat_Sqrt:  [[20.8450999   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00227147 -0.01933064  0.09319144]
Stock Position:  0.002271467396592614
Bond Position:  [-7.87413371]


portfolio before change:  [-7.63856736]
curr_Stock_Price:  105.44038717173504
curr_Factors:  [105.44038717  -0.71613427  -1.002586  ]
mat_Sqrt:  [[18.90498185  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00439935 -0.00163689 -0.35349273]
Stock Position:  0.0043993519596247635
Bond Position:  [-8.10243674]


portfolio before change:  [-7.62788176]
curr_Stock_Price:  108.79038916720346
curr_Factors:  [108.79038917  -1.07424488  -1.04333732]
mat_Sqrt:  [[13.08989805  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00048503 -0.0415522   0.06836815]
Stock Position:  -0.00048503112962801386
Bond Position:  [-7.57511503]


portfolio before change:  [-7.63139748]
curr_Stock_Price:  108.22799718367284
curr_Factors:  [108.22799718  -0.69056448  -1.1372753 ]
mat_Sqrt:  [[17.39878379  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00077043  0.02718034 -0.42289574]
Stock Position:  0.000770430757729329
Bond Position:  [-7.71477966]


portfolio before change:  [-7.63649436]
curr_Stock_Price:  106.62042701639149
curr_Factors:  [106.62042702  -1.29998105  -1.09685276]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-7.63649436]
Stock Price:  106.61068634922844
PL:  [-14.24718071]
Settle:  Tensor("sub_184:0", shape=(), dtype=float64)
PL:  Tensor("sub_185:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  93
output_Z_Vals[:, i, :]:  [[ 1.19279309e+02 -2.92921948e+01 -2.92556094e+01]
 [-7.04779654e-02 -1.14653620e-01 -1.72427800e-03]
 [ 2.49762716e-01  4.58536566e-02 -4.86137565e-02]
 [-6.14455125e-02  1.18600387e-01 -1.32635023e-01]
 [ 3.36541766e-02 -2.23236425e-02 -3.04044560e-02]
 [ 6.81238964e-02  9.81406362e-03  7.02496809e-03]
 [ 7.05681304e-02  3.36943169e-02 -2.65126763e-01]
 [-2.14391669e-01  5.10309224e-02 -1.58828687e-01]
 [-7.82947756e-03  6.63707748e-04 -8.40064783e-02]
 [ 6.20969540e-02  3.23509589e-01 -1.79758166e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.27930914 -29.29219478 -29.25560936]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  8.31647217  -9.26300532 -83.45811031]
init_Out:  [2.54002979]
Stock Position:  8.316472170547405
Bond position:  [-829.10718727]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [10.59835482]
curr_Stock_Price:  101.01881929164395
curr_Factors:  [101.01881929  -1.53324591  -0.96130152]
mat_Sqrt:  [[ 8.33746655  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00885044 -0.03625666 -0.00491889]
Stock Position:  -0.008850443404524943
Bond Position:  [11.49241617]


portfolio before change:  [10.59751896]
curr_Stock_Price:  101.76268097272958
curr_Factors:  [101.76268097  -1.8313746   -0.98198403]
mat_Sqrt:  [[ 6.10607888  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0394727   0.0145002  -0.13868152]
Stock Position:  0.039472698542221824
Bond Position:  [6.58067133]


portfolio before change:  [10.62336584]
curr_Stock_Price:  102.33410676586213
curr_Factors:  [102.33410677  -1.77162884  -0.93505835]
mat_Sqrt:  [[ 6.83157897  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01250915  0.03750474 -0.3783708 ]
Stock Position:  -0.012509154140151479
Bond Position:  [11.90347895]


portfolio before change:  [10.62796747]
curr_Stock_Price:  102.44215507103524
curr_Factors:  [102.44215507  -1.52927634  -0.96249092]
mat_Sqrt:  [[ 8.47847879  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00316938 -0.00705936 -0.08673545]
Stock Position:  0.0031693773963296363
Bond Position:  [10.30328962]


portfolio before change:  [10.63269235]
curr_Stock_Price:  102.30709582008677
curr_Factors:  [102.30709582  -1.66608852  -0.97822144]
mat_Sqrt:  [[ 7.26936595  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00960349 0.00310348 0.02004028]
Stock Position:  0.00960348681346722
Bond Position:  [9.65018751]


portfolio before change:  [10.64557738]
curr_Stock_Price:  103.1462413524682
curr_Factors:  [103.14624135  -1.69516512  -0.98687766]
mat_Sqrt:  [[ 7.05759979  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.002454    0.01065508 -0.75633286]
Stock Position:  0.0024539986082327547
Bond Position:  [10.39245664]


portfolio before change:  [10.6514429]
curr_Stock_Price:  103.4184482755165
curr_Factors:  [103.41844828  -1.65712578  -0.98419711]
mat_Sqrt:  [[ 7.37031522  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.03330859  0.01613739 -0.45309403]
Stock Position:  -0.03330859255762448
Bond Position:  [14.09616586]


portfolio before change:  [10.65583874]
curr_Stock_Price:  103.49812763959918
curr_Factors:  [103.49812764  -1.61480438  -0.94746886]
mat_Sqrt:  [[ 7.98272857  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-3.12676186e-03  2.09882818e-04 -2.39647100e-01]
Stock Position:  -0.0031267618629189442
Bond Position:  [10.97945273]


portfolio before change:  [10.6620017]
curr_Stock_Price:  103.28325347933038
curr_Factors:  [103.28325348  -1.41352808  -0.93063121]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [10.6620017]
Stock Price:  102.76391626236362
PL:  [7.89808543]
Settle:  Tensor("sub_186:0", shape=(), dtype=float64)
PL:  Tensor("sub_187:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  94
output_Z_Vals[:, i, :]:  [[ 1.19279309e+02 -2.92921948e+01 -2.92556094e+01]
 [-7.04779654e-02 -1.14653620e-01 -1.72427800e-03]
 [ 6.80837054e-01  7.37788020e-02 -3.34754072e-01]
 [ 3.43801968e-01 -1.99939326e-01 -1.26103675e-01]
 [-2.28071313e-01  2.54705373e-01  3.41856107e-01]
 [ 4.99907501e-02 -6.65414468e-02  2.37039020e-02]
 [-2.50744176e-02 -5.96665236e-02  2.18892092e-01]
 [ 1.24570606e-01 -1.06992469e-01 -7.67588270e-02]
 [ 9.86550322e-02 -9.12157419e-02  6.73733142e-02]
 [-8.91908074e-03 -6.57852218e-02 -2.56396281e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.27930914 -29.29219478 -29.25560936]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  8.31647217  -9.26300532 -83.45811031]
init_Out:  [2.54002979]
Stock Position:  8.316472170547405
Bond position:  [-829.10718727]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [2.93943817]
curr_Stock_Price:  100.09788593233057
curr_Factors:  [100.09788593  -1.15986783  -0.9960231 ]
mat_Sqrt:  [[11.5913326   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00636599 -0.03625666 -0.00491889]
Stock Position:  -0.006365987280309738
Bond Position:  [3.57666004]


portfolio before change:  [2.95071742]
curr_Stock_Price:  98.60707724908977
curr_Factors:  [98.60707725 -1.13098813 -0.95437362]
mat_Sqrt:  [[12.25312849  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.05014316  0.02333091 -0.95496019]
Stock Position:  0.05014316352694177
Bond Position:  [-1.99375338]


portfolio before change:  [2.86704233]
curr_Stock_Price:  96.9582391487484
curr_Factors:  [96.95823915 -0.91983005 -0.94314369]
mat_Sqrt:  [[15.04892597  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0207921  -0.06322637 -0.35973868]
Stock Position:  0.020792098557495177
Bond Position:  [0.85107707]


portfolio before change:  [2.86241265]
curr_Stock_Price:  96.71510227094517
curr_Factors:  [96.71510227 -0.79467615 -0.94392755]
mat_Sqrt:  [[16.99919291  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00892476  0.08054491  0.97522032]
Stock Position:  -0.008924762694486789
Bond Position:  [3.72557199]


portfolio before change:  [2.87587149]
curr_Stock_Price:  95.41584175609096
curr_Factors:  [95.41584176 -0.3501469  -0.97968487]
mat_Sqrt:  [[25.23956624  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00210428 -0.02104225  0.06762063]
Stock Position:  0.0021042832332650576
Bond Position:  [2.67508954]


portfolio before change:  [2.87298967]
curr_Stock_Price:  93.41055163543929
curr_Factors:  [93.41055164 -0.70873111 -0.92040307]
mat_Sqrt:  [[18.31774257  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00098627 -0.01886821  0.62443821]
Stock Position:  0.000986265670558252
Bond Position:  [2.78086205]


portfolio before change:  [2.87555794]
curr_Stock_Price:  94.60443353317339
curr_Factors:  [94.60443353 -1.14401644 -0.94065488]
mat_Sqrt:  [[11.76387063  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00902252 -0.03383399 -0.21897157]
Stock Position:  0.009022518650859278
Bond Position:  [2.02198767]


portfolio before change:  [2.87442183]
curr_Stock_Price:  94.36643422217553
curr_Factors:  [94.36643422 -1.33642259 -0.85772275]
mat_Sqrt:  [[10.51749547  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01046374 -0.02884495  0.19219731]
Stock Position:  0.010463743230454507
Bond Position:  [1.88699569]


portfolio before change:  [2.86868528]
curr_Stock_Price:  93.7280123512736
curr_Factors:  [93.72801235 -1.43697287 -0.89027159]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [2.86868528]
Stock Price:  94.74221679261336
PL:  [2.86868528]
Settle:  Tensor("sub_188:0", shape=(), dtype=float64)
PL:  Tensor("sub_189:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  95
output_Z_Vals[:, i, :]:  [[ 1.19279309e+02 -2.92921948e+01 -2.92556094e+01]
 [-4.51793265e-02  1.07087962e-01  1.90617297e-01]
 [ 1.24705920e+00  8.81031167e-02 -4.68158744e-01]
 [ 3.42727558e-02  3.90372343e-02 -2.07327632e-01]
 [-1.23417668e-01  1.11598092e-01  1.82225324e-01]
 [ 6.38417278e-02 -4.21123712e-03  1.12718360e-02]
 [-1.24112778e-02 -5.61037729e-02  2.12273047e-01]
 [ 1.26290311e-01 -1.03137988e-01 -7.19447154e-02]
 [ 1.38478246e-01 -9.16059125e-02  9.16495584e-02]
 [-9.52044182e-03 -7.31891729e-02 -5.63748968e-03]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.27930914 -29.29219478 -29.25560936]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  8.31647217  -9.26300532 -83.45811031]
init_Out:  [2.54002979]
Stock Position:  8.316472170547405
Bond position:  [-829.10718727]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-9.50554933]
curr_Stock_Price:  98.60145965452602
curr_Factors:  [98.60145965 -0.32388146 -0.97027872]
mat_Sqrt:  [[27.02941958  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-1.29663689e-04  3.38641870e-02  5.43778092e-01]
Stock Position:  -0.0001296636892535029
Bond Position:  [-9.4927643]


portfolio before change:  [-9.50986819]
curr_Stock_Price:  95.29521669649691
curr_Factors:  [95.2952167  -0.39827437 -0.95199916]
mat_Sqrt:  [[24.69760033  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.04671594  0.02786065 -1.33552659]
Stock Position:  0.046715935514983035
Bond Position:  [-13.96167339]


portfolio before change:  [-9.29632166]
curr_Stock_Price:  100.01585671727145
curr_Factors:  [100.01585672  -0.38697355  -0.95123806]
mat_Sqrt:  [[26.23559638  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-2.68333250e-04  1.23446574e-02 -5.91448026e-01]
Stock Position:  -0.0002683332496873396
Bond Position:  [-9.26948408]


portfolio before change:  [-9.3006921]
curr_Stock_Price:  99.0265696288804
curr_Factors:  [99.02656963 -0.67171374 -0.95948166]
mat_Sqrt:  [[19.37905406  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0043005   0.03529042  0.51983813]
Stock Position:  -0.00430050036037171
Bond Position:  [-8.87482831]


portfolio before change:  [-9.30156487]
curr_Stock_Price:  98.19742110579854
curr_Factors:  [98.19742111 -1.06817735 -0.99304468]
mat_Sqrt:  [[12.50036598  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00528255 -0.00133171  0.03215541]
Stock Position:  0.005282553181267075
Bond Position:  [-9.82029797]


portfolio before change:  [-9.32649678]
curr_Stock_Price:  94.40748774773219
curr_Factors:  [94.40748775 -0.69054926 -0.93855953]
mat_Sqrt:  [[18.51371107  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0015918  -0.01774157  0.60555592]
Stock Position:  0.0015918031278974473
Bond Position:  [-9.47677491]


portfolio before change:  [-9.33241027]
curr_Stock_Price:  93.67001119074867
curr_Factors:  [93.67001119 -0.86542521 -1.02417876]
mat_Sqrt:  [[14.15650324  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00769552 -0.0326151  -0.20523825]
Stock Position:  0.007695519420273611
Bond Position:  [-10.05324966]


portfolio before change:  [-9.33536572]
curr_Stock_Price:  93.93931374392317
curr_Factors:  [93.93931374 -0.92609944 -1.04560831]
mat_Sqrt:  [[13.07812816  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01183815 -0.02896833  0.26145068]
Stock Position:  0.011838152785723345
Bond Position:  [-10.44743367]


portfolio before change:  [-9.33515647]
curr_Stock_Price:  94.39836174938252
curr_Factors:  [94.39836175 -0.93301957 -1.05326453]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-9.33515647]
Stock Price:  94.6854241365566
PL:  [-9.33515647]
Settle:  Tensor("sub_190:0", shape=(), dtype=float64)
PL:  Tensor("sub_191:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  96
output_Z_Vals[:, i, :]:  [[ 1.19279309e+02 -2.92921948e+01 -2.92556094e+01]
 [-7.04779654e-02 -1.14653620e-01 -1.72427800e-03]
 [ 7.43743184e-01  7.43450018e-02 -3.57286731e-01]
 [ 2.20802242e-01 -7.69559688e-02 -1.46547712e-01]
 [-1.34834464e-01  1.27835176e-01  1.99849850e-01]
 [ 5.54794906e-02 -3.15999047e-02  1.95651380e-02]
 [ 8.51277663e-02 -2.18558652e-02  7.45306949e-02]
 [ 5.57911413e-03 -1.04946594e-01  5.52501166e-02]
 [-8.16926486e-02 -5.61121320e-02 -6.55540741e-02]
 [ 1.34140880e-02  8.79171228e-02  1.50600672e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.27930914 -29.29219478 -29.25560936]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  8.31647217  -9.26300532 -83.45811031]
init_Out:  [2.54002979]
Stock Position:  8.316472170547405
Bond position:  [-829.10718727]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-7.18879047]
curr_Stock_Price:  98.88003436875435
curr_Factors:  [98.88003437 -1.19924821 -0.98968937]
mat_Sqrt:  [[11.07809536  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00666092 -0.03625666 -0.00491889]
Stock Position:  -0.006660917198127835
Bond Position:  [-6.53015875]


portfolio before change:  [-7.18867823]
curr_Stock_Price:  98.37287651096548
curr_Factors:  [98.37287651 -1.21669121 -0.99986754]
mat_Sqrt:  [[10.72102073  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.06274887  0.02350995 -1.0192396 ]
Stock Position:  0.06274886800169427
Bond Position:  [-13.36146487]


portfolio before change:  [-7.17233455]
curr_Stock_Price:  98.73983264129689
curr_Factors:  [98.73983264 -1.34431802 -1.0891879 ]
mat_Sqrt:  [[ 8.66231937  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.02180725 -0.02433561 -0.41805983]
Stock Position:  0.02180724507522663
Bond Position:  [-9.32557828]


portfolio before change:  [-7.18206899]
curr_Stock_Price:  98.50731868228142
curr_Factors:  [98.50731868 -0.92758912 -1.08950728]
mat_Sqrt:  [[13.10553217  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00692376  0.04042503  0.57011599]
Stock Position:  -0.006923762652230986
Bond Position:  [-6.5000277]


portfolio before change:  [-7.18631278]
curr_Stock_Price:  98.65073213508096
curr_Factors:  [98.65073214 -1.05619549 -1.04597232]
mat_Sqrt:  [[12.05425658  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00486611 -0.00999277  0.05581389]
Stock Position:  0.0048661069465583805
Bond Position:  [-7.66635779]


portfolio before change:  [-7.19646907]
curr_Stock_Price:  97.35150969931725
curr_Factors:  [97.3515097  -1.03927042 -1.04552632]
mat_Sqrt:  [[12.10394585  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00824334 -0.00691143  0.21261533]
Stock Position:  0.00824334196237148
Bond Position:  [-7.99897086]


portfolio before change:  [-7.19945304]
curr_Stock_Price:  97.47482385332897
curr_Factors:  [97.47482385 -0.84585974 -1.0829471 ]
mat_Sqrt:  [[14.16518627  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00099874 -0.03318703  0.1576132 ]
Stock Position:  0.0009987364293551947
Bond Position:  [-7.29680469]


portfolio before change:  [-7.20158475]
curr_Stock_Price:  98.99434381367578
curr_Factors:  [98.99434381 -0.51779829 -1.09331957]
mat_Sqrt:  [[19.76563551  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00488336 -0.01774421 -0.18700753]
Stock Position:  -0.0048833556051447145
Bond Position:  [-6.71816017]


portfolio before change:  [-7.21247874]
curr_Stock_Price:  100.53714925250462
curr_Factors:  [100.53714925  -1.19973457  -1.09534165]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-7.21247874]
Stock Price:  100.74462048395063
PL:  [-7.95709922]
Settle:  Tensor("sub_192:0", shape=(), dtype=float64)
PL:  Tensor("sub_193:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  97
output_Z_Vals[:, i, :]:  [[ 1.19279309e+02 -2.92921948e+01 -2.92556094e+01]
 [-4.83149110e-02  5.29079372e-02  1.45264223e-01]
 [ 1.25974651e+00  8.76625317e-02 -4.76876385e-01]
 [ 4.66138454e-01 -3.80030873e-01  4.42880033e-02]
 [-4.05582383e-01  5.49300040e-01  6.30105188e-01]
 [ 1.60526999e-01  2.73572367e-01 -9.50862176e-02]
 [ 8.73464367e-02 -2.80371258e-02  1.60129511e-01]
 [ 1.27257855e-01 -1.00969369e-01 -6.92361873e-02]
 [ 9.22745193e-02 -9.11532284e-02  6.34837515e-02]
 [-8.69170909e-03 -6.24301718e-02 -3.53576971e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.27930914 -29.29219478 -29.25560936]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  8.31647217  -9.26300532 -83.45811031]
init_Out:  [2.54002979]
Stock Position:  8.316472170547405
Bond position:  [-829.10718727]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-15.23120157]
curr_Stock_Price:  97.91298837396627
curr_Factors:  [97.91298837 -0.79244257 -0.97549971]
mat_Sqrt:  [[16.71216561  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00103499  0.01673096  0.41439839]
Stock Position:  -0.0010349884616802697
Bond Position:  [-15.12986276]


portfolio before change:  [-15.23613687]
curr_Stock_Price:  95.37042800550492
curr_Factors:  [95.37042801 -0.5529398  -0.94305043]
mat_Sqrt:  [[21.36551812  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.05451157  0.02772133 -1.36039559]
Stock Position:  0.05451157132119779
Bond Position:  [-20.43492876]


portfolio before change:  [-15.32482693]
curr_Stock_Price:  93.93091650014499
curr_Factors:  [93.9309165  -0.43730263 -0.94714   ]
mat_Sqrt:  [[23.52625318  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01978073 -0.12017631  0.12634135]
Stock Position:  0.019780725233177584
Bond Position:  [-17.18284858]


portfolio before change:  [-15.37186123]
curr_Stock_Price:  91.9875736987888
curr_Factors:  [91.9875737  -0.96825252 -0.8927802 ]
mat_Sqrt:  [[14.30516667  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01836958  0.17370392  1.79751471]
Stock Position:  -0.018369575114668604
Bond Position:  [-13.68208858]


portfolio before change:  [-15.40126025]
curr_Stock_Price:  93.21548810186066
curr_Factors:  [93.2154881  -1.27697705 -0.898826  ]
mat_Sqrt:  [[10.58153863  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01400375  0.08651118 -0.27125451]
Stock Position:  0.014003749280105065
Bond Position:  [-16.70662657]


portfolio before change:  [-15.40707467]
curr_Stock_Price:  93.39693822700956
curr_Factors:  [93.39693823 -1.56894838 -0.85347351]
mat_Sqrt:  [[ 8.28491726  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01440073 -0.00886612  0.45680492]
Stock Position:  0.014400725686077143
Bond Position:  [-16.75205836]


portfolio before change:  [-15.41811968]
curr_Stock_Price:  93.21174672020607
curr_Factors:  [93.21174672 -1.9286757  -0.8642794 ]
mat_Sqrt:  [[ 5.70828511  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01936099 -0.03192932 -0.19751157]
Stock Position:  0.019360991555817577
Bond Position:  [-17.22279153]


portfolio before change:  [-15.40830143]
curr_Stock_Price:  94.16375417040521
curr_Factors:  [94.16375417 -1.5133342  -0.89115793]
mat_Sqrt:  [[ 8.50405578  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0120977  -0.02882518  0.18110147]
Stock Position:  0.012097700464408969
Bond Position:  [-16.54746632]


portfolio before change:  [-15.42627504]
curr_Stock_Price:  93.36212945559468
curr_Factors:  [93.36212946 -1.19070758 -0.93651765]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-15.42627504]
Stock Price:  94.25935219652845
PL:  [-15.42627504]
Settle:  Tensor("sub_194:0", shape=(), dtype=float64)
PL:  Tensor("sub_195:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  98
output_Z_Vals[:, i, :]:  [[ 1.19279309e+02 -2.92921948e+01 -2.92556094e+01]
 [-7.04779654e-02 -1.14653620e-01 -1.72427800e-03]
 [ 3.89015175e-01  6.78676203e-02 -2.54931850e-01]
 [-6.15855370e-02  1.07549989e-01 -1.82795638e-01]
 [ 1.22112225e-02 -3.46578532e-02 -1.15488547e-02]
 [ 4.24143387e-02 -7.43919344e-02  3.25225856e-02]
 [ 8.73464367e-02 -2.80371258e-02  1.60129511e-01]
 [-1.60022170e-04 -1.04401629e-01  6.23894778e-02]
 [-2.24225390e-02 -7.79810245e-02 -1.47436596e-02]
 [-1.48033418e-02 -8.75989314e-02  3.36140758e-03]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.27930914 -29.29219478 -29.25560936]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  8.31647217  -9.26300532 -83.45811031]
init_Out:  [2.54002979]
Stock Position:  8.316472170547405
Bond position:  [-829.10718727]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-8.66122743]
curr_Stock_Price:  98.70298369915486
curr_Factors:  [98.7029837  -1.21119519 -0.98802761]
mat_Sqrt:  [[10.9451056   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00674185 -0.03625666 -0.00491889]
Stock Position:  -0.006741851436393956
Bond Position:  [-7.99578658]


portfolio before change:  [-8.67404189]
curr_Stock_Price:  100.01057170779147
curr_Factors:  [100.01057171  -1.16429359  -0.98537413]
mat_Sqrt:  [[11.65351878  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.02906674  0.02146163 -0.72724961]
Stock Position:  0.02906673682359419
Bond Position:  [-11.58102286]


portfolio before change:  [-8.63964867]
curr_Stock_Price:  101.39308618935759
curr_Factors:  [101.39308619  -1.19532748  -1.0050331 ]
mat_Sqrt:  [[11.2306239   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00855888  0.03401029 -0.52146507]
Stock Position:  -0.008558884393714081
Bond Position:  [-7.77183696]


portfolio before change:  [-8.64298414]
curr_Stock_Price:  101.3286596341463
curr_Factors:  [101.32865963  -0.94334732  -0.97423844]
mat_Sqrt:  [[14.89139501  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00060162 -0.01095978 -0.03294567]
Stock Position:  0.000601619959469352
Bond Position:  [-8.70394548]


portfolio before change:  [-8.64898192]
curr_Stock_Price:  98.59483803667962
curr_Factors:  [98.59483804 -0.84169979 -1.02476142]
mat_Sqrt:  [[15.24966738  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0030907  -0.0235248   0.09277788]
Stock Position:  0.0030907029638831455
Bond Position:  [-8.95370928]


portfolio before change:  [-8.6631512]
curr_Stock_Price:  95.45920553410839
curr_Factors:  [95.45920553 -1.05403337 -1.00259983]
mat_Sqrt:  [[12.20768645  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00977325 -0.00886612  0.45680492]
Stock Position:  0.009773254034851667
Bond Position:  [-9.59609827]


portfolio before change:  [-8.6466295]
curr_Stock_Price:  97.64076679885422
curr_Factors:  [97.6407668  -1.01389173 -0.99673118]
mat_Sqrt:  [[13.07461001  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00075563 -0.03301469  0.17797981]
Stock Position:  0.0007556277538761722
Bond Position:  [-8.72040957]


portfolio before change:  [-8.65062609]
curr_Stock_Price:  98.12341768210051
curr_Factors:  [98.12341768 -1.17399774 -1.00661489]
mat_Sqrt:  [[11.08522809  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00247587 -0.02465977 -0.04205956]
Stock Position:  -0.0024758658204609746
Bond Position:  [-8.40768567]


portfolio before change:  [-8.65637266]
curr_Stock_Price:  98.74609884785781
curr_Factors:  [98.74609885 -1.55503024 -1.01926517]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-8.65637266]
Stock Price:  98.66072570810036
PL:  [-8.65637266]
Settle:  Tensor("sub_196:0", shape=(), dtype=float64)
PL:  Tensor("sub_197:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  99
output_Z_Vals[:, i, :]:  [[ 1.19279309e+02 -2.92921948e+01 -2.92556094e+01]
 [-6.96920083e-02 -1.07764737e-01  4.25123001e-03]
 [ 1.63986890e-01  3.25626696e-02 -1.60065180e-02]
 [-5.08066165e-02  1.25779330e-01 -5.28730875e-02]
 [ 3.36664548e-02 -7.52818867e-02 -4.84583288e-02]
 [ 1.09231809e-01  2.51544647e-01 -3.38142163e-02]
 [ 8.22679911e-02  1.45840402e-02 -2.13941647e-01]
 [-2.14391669e-01  5.10309224e-02 -1.58828687e-01]
 [ 2.13897048e-02  5.05138783e-02 -1.18537443e-01]
 [ 7.18407787e-02  3.89145828e-01 -1.05924629e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.27930914 -29.29219478 -29.25560936]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  8.31647217  -9.26300532 -83.45811031]
init_Out:  [2.54002979]
Stock Position:  8.316472170547405
Bond position:  [-829.10718727]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-3.43693496]
curr_Stock_Price:  99.33116982950078
curr_Factors:  [99.33116983 -0.96935637 -1.01153905]
mat_Sqrt:  [[13.70230399  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00522589 -0.0340782   0.01212758]
Stock Position:  -0.005225887791513003
Bond Position:  [-2.91784142]


portfolio before change:  [-3.44950614]
curr_Stock_Price:  101.45748583804578
curr_Factors:  [101.45748584  -0.92850026  -1.03721407]
mat_Sqrt:  [[14.20970972  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01136971  0.01029722 -0.04566214]
Stock Position:  0.011369714137605628
Bond Position:  [-4.60304875]


portfolio before change:  [-3.43484484]
curr_Stock_Price:  102.9494672399612
curr_Factors:  [102.94946724  -1.21048228  -1.06844911]
mat_Sqrt:  [[10.54136321  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0055355   0.03977492 -0.1508322 ]
Stock Position:  -0.0055354967663440455
Bond Position:  [-2.86496839]


portfolio before change:  [-3.43892847]
curr_Stock_Price:  103.42833879071698
curr_Factors:  [103.42833879  -1.02736976  -1.06567415]
mat_Sqrt:  [[12.75387419  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00171173 -0.02380622 -0.13823812]
Stock Position:  0.001711728493396996
Bond Position:  [-3.6159697]


portfolio before change:  [-3.43838361]
curr_Stock_Price:  104.80314847130396
curr_Factors:  [104.80314847  -1.28254713  -1.09323599]
mat_Sqrt:  [[ 9.74058033  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01117227  0.0795454  -0.09646255]
Stock Position:  0.011172267210061575
Bond Position:  [-4.60927238]


portfolio before change:  [-3.44854649]
curr_Stock_Price:  104.09982873190933
curr_Factors:  [104.09982873  -1.37204164  -1.10799815]
mat_Sqrt:  [[ 8.71730856  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00447086  0.00461188 -0.61031597]
Stock Position:  0.004470863151212525
Bond Position:  [-3.91396258]


portfolio before change:  [-3.45557732]
curr_Stock_Price:  102.96506788994111
curr_Factors:  [102.96506789  -0.98018149  -1.05917403]
mat_Sqrt:  [[13.39704643  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01832455  0.01613739 -0.45309403]
Stock Position:  -0.018324548468369454
Bond Position:  [-1.56878895]


portfolio before change:  [-3.49668403]
curr_Stock_Price:  105.16551058178867
curr_Factors:  [105.16551058  -1.17046262  -1.09145969]
mat_Sqrt:  [[10.95299665  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-1.37166732e-04  1.59738909e-02 -3.38154331e-01]
Stock Position:  -0.00013716673209448107
Bond Position:  [-3.48225882]


portfolio before change:  [-3.49851039]
curr_Stock_Price:  105.78368786906219
curr_Factors:  [105.78368787  -0.92223699  -1.13144635]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-3.49851039]
Stock Price:  106.64664767329057
PL:  [-10.14515807]
Settle:  Tensor("sub_198:0", shape=(), dtype=float64)
PL:  Tensor("sub_199:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  100
output_Z_Vals[:, i, :]:  [[ 1.19279309e+02 -2.92921948e+01 -2.92556094e+01]
 [-4.50304848e-02  1.08392553e-01  1.91748917e-01]
 [ 4.18817390e-01  7.22767980e-02 -2.34458330e-01]
 [ 9.78516234e-02 -5.07937481e-03 -2.15298887e-01]
 [-1.99456842e-01  2.14529668e-01  2.97857729e-01]
 [ 7.62965437e-02  9.58892813e-02 -1.11915643e-03]
 [-7.98794346e-02 -6.75226214e-02  1.95665206e-01]
 [-1.25474344e-01 -3.61946990e-02 -5.43328787e-02]
 [-1.32491562e-01 -1.91835791e-02 -1.29294721e-01]
 [ 7.43964794e-02  4.14294730e-01 -1.64303261e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.27930914 -29.29219478 -29.25560936]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  8.31647217  -9.26300532 -83.45811031]
init_Out:  [2.54002979]
Stock Position:  8.316472170547405
Bond position:  [-829.10718727]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-11.48164866]
curr_Stock_Price:  98.36384696271749
curr_Factors:  [98.36384696 -0.47843835 -0.96128508]
mat_Sqrt:  [[23.31157209  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-1.32604412e-04  3.42767350e-02  5.47006288e-01]
Stock Position:  -0.0001326044117057334
Bond Position:  [-11.46860518]


portfolio before change:  [-11.48749059]
curr_Stock_Price:  99.16464125263506
curr_Factors:  [99.16464125 -0.34729382 -0.9889243 ]
mat_Sqrt:  [[26.0642174   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01430409  0.02285593 -0.66884435]
Stock Position:  0.01430409196415814
Bond Position:  [-12.90595074]


portfolio before change:  [-11.48871431]
curr_Stock_Price:  99.53033134799419
curr_Factors:  [99.53033135 -0.26569741 -0.94426619]
mat_Sqrt:  [[29.68075423  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00181171 -0.00160624 -0.6141878 ]
Stock Position:  0.0018117050768326696
Bond Position:  [-11.66903392]


portfolio before change:  [-11.4966413]
curr_Stock_Price:  98.37616538150743
curr_Factors:  [98.37616538  0.23743898 -0.96651308]
mat_Sqrt:  [[47.45227398  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0028053   0.06784024  0.84970519]
Stock Position:  -0.0028052976990922732
Bond Position:  [-11.22066687]


portfolio before change:  [-11.51555735]
curr_Stock_Price:  103.11873391480265
curr_Factors:  [103.11873391   0.3346986   -0.93781746]
mat_Sqrt:  [[56.41653129  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00139222  0.03032285 -0.00319264]
Stock Position:  0.001392215112140552
Bond Position:  [-11.65912081]


portfolio before change:  [-11.52819048]
curr_Stock_Price:  98.23291492342362
curr_Factors:  [98.23291492  0.14974146 -0.88451609]
mat_Sqrt:  [[47.11383555  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00088473 -0.02135253  0.55817837]
Stock Position:  -0.0008847267015032009
Bond Position:  [-11.4412812]


portfolio before change:  [-11.53927485]
curr_Stock_Price:  104.29387987921797
curr_Factors:  [ 1.04293880e+02  2.55353711e-02 -9.03774032e-01]
mat_Sqrt:  [[43.33558063  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0031729  -0.01144577 -0.15499658]
Stock Position:  -0.0031729017471002876
Bond Position:  [-11.20836061]


portfolio before change:  [-11.53659123]
curr_Stock_Price:  101.68138275513402
curr_Factors:  [101.68138276   0.24544604  -0.93319911]
mat_Sqrt:  [[51.11567241  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00311801 -0.00606638 -0.36884185]
Stock Position:  -0.0031180075853042806
Bond Position:  [-11.21954791]


portfolio before change:  [-11.55746157]
curr_Stock_Price:  106.57526597257774
curr_Factors:  [ 1.06575266e+02  3.42091901e-02 -9.26121434e-01]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-11.55746157]
Stock Price:  107.93440787587267
PL:  [-19.49186945]
Settle:  Tensor("sub_200:0", shape=(), dtype=float64)
PL:  Tensor("sub_201:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  101
output_Z_Vals[:, i, :]:  [[ 1.19279309e+02 -2.92921948e+01 -2.92556094e+01]
 [-7.04779654e-02 -1.14653620e-01 -1.72427800e-03]
 [-1.15042349e-01 -2.94342833e-02  6.97146784e-02]
 [-2.20391407e-02  7.63111885e-02 -2.11543157e-01]
 [-5.01065915e-02  2.92638346e-02  7.64611623e-02]
 [ 4.49438337e-02 -6.61071302e-02  3.00139428e-02]
 [ 8.73464367e-02 -2.80371258e-02  1.60129511e-01]
 [ 2.74549528e-02 -9.80345745e-02  3.65224853e-02]
 [-1.24668321e-01 -4.36855953e-02 -1.01346968e-01]
 [-5.78567776e-03 -3.21784022e-02  5.62336965e-03]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.27930914 -29.29219478 -29.25560936]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  8.31647217  -9.26300532 -83.45811031]
init_Out:  [2.54002979]
Stock Position:  8.316472170547405
Bond position:  [-829.10718727]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [18.51801117]
curr_Stock_Price:  101.97110485085807
curr_Factors:  [101.97110485  -1.41894012  -0.96738626]
mat_Sqrt:  [[ 9.37796801  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00786847 -0.03625666 -0.00491889]
Stock Position:  -0.007868471702418603
Bond Position:  [19.32036793]


portfolio before change:  [18.51950458]
curr_Stock_Price:  103.00932387971076
curr_Factors:  [103.00932388  -0.93429438  -0.95849647]
mat_Sqrt:  [[15.51843485  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00654524 -0.00930794  0.19887657]
Stock Position:  -0.006545240625649429
Bond Position:  [19.19372539]


portfolio before change:  [18.54571852]
curr_Stock_Price:  100.47088635889841
curr_Factors:  [100.47088636  -1.18097053  -0.93819819]
mat_Sqrt:  [[12.0697133   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00524038  0.02413172 -0.60347375]
Stock Position:  -0.005240378037337426
Bond Position:  [19.07222395]


portfolio before change:  [18.5576118]
curr_Stock_Price:  100.02153253719534
curr_Factors:  [100.02153254  -1.26848255  -0.9061543 ]
mat_Sqrt:  [[11.36738894  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00296844  0.00925404  0.21812241]
Stock Position:  -0.0029684418621400933
Bond Position:  [18.85451991]


portfolio before change:  [18.57002095]
curr_Stock_Price:  99.01779661806854
curr_Factors:  [99.01779662 -0.88609063 -0.92616462]
mat_Sqrt:  [[16.16816763  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00305313 -0.02090491  0.08562142]
Stock Position:  0.0030531304781439075
Bond Position:  [18.2677067]


portfolio before change:  [18.57027712]
curr_Stock_Price:  96.10931514720662
curr_Factors:  [96.10931515 -0.9375736  -0.8887459 ]
mat_Sqrt:  [[15.47408586  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00771023 -0.00886612  0.45680492]
Stock Position:  0.007710233867080058
Bond Position:  [17.82925182]


portfolio before change:  [18.58719208]
curr_Stock_Price:  97.14665210066534
curr_Factors:  [97.1466521  -0.89720958 -0.84152019]
mat_Sqrt:  [[17.07289207  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00189651 -0.03100125  0.10418848]
Stock Position:  0.0018965054057856487
Bond Position:  [18.40295293]


portfolio before change:  [18.60301033]
curr_Stock_Price:  100.63436632590427
curr_Factors:  [100.63436633  -1.02625426  -0.8635516 ]
mat_Sqrt:  [[15.20596761  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0096333  -0.0138146  -0.28911469]
Stock Position:  -0.009633299601161728
Bond Position:  [19.57245133]


portfolio before change:  [18.62407967]
curr_Stock_Price:  99.46335845309216
curr_Factors:  [99.46335845 -1.1161982  -0.84409782]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [18.62407967]
Stock Price:  102.15669119650101
PL:  [16.46738847]
Settle:  Tensor("sub_202:0", shape=(), dtype=float64)
PL:  Tensor("sub_203:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  102
output_Z_Vals[:, i, :]:  [[ 1.19279309e+02 -2.92921948e+01 -2.92556094e+01]
 [-5.81516084e-02 -6.61358265e-03  9.19910764e-02]
 [ 3.56383704e-01  6.86241675e-02 -2.35343312e-01]
 [-5.77189554e-02  1.11638688e-01 -1.47174681e-01]
 [-1.95991337e-02  4.77302217e-04  3.42250686e-02]
 [ 3.99108334e-02 -6.99223256e-02  3.49971538e-02]
 [ 8.47505411e-02  8.81721055e-03 -1.74547389e-01]
 [-1.83452111e-01  1.38200219e-02 -9.22064931e-02]
 [-1.15708681e-01 -1.69267345e-02 -1.23939424e-01]
 [ 2.22382665e-02  1.40978024e-01  1.80459090e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.27930914 -29.29219478 -29.25560936]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  8.31647217  -9.26300532 -83.45811031]
init_Out:  [2.54002979]
Stock Position:  8.316472170547405
Bond position:  [-829.10718727]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [4.51567903]
curr_Stock_Price:  100.28741832379822
curr_Factors:  [100.28741832  -0.74435459  -0.97392866]
mat_Sqrt:  [[17.98893779  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00219828 -0.0020914   0.26242494]
Stock Position:  -0.002198282689537913
Bond Position:  [4.73613912]


portfolio before change:  [4.51897634]
curr_Stock_Price:  99.86497552011437
curr_Factors:  [99.86497552 -0.82668107 -1.02630173]
mat_Sqrt:  [[15.65571815  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0198085   0.02170087 -0.67136896]
Stock Position:  0.01980850170011976
Bond Position:  [2.5408008]


portfolio before change:  [4.55958731]
curr_Stock_Price:  101.85100439776092
curr_Factors:  [101.8510044   -1.35407612  -1.14897196]
mat_Sqrt:  [[ 8.33499506  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01018337  0.03530325 -0.4198484 ]
Stock Position:  -0.010183372898450928
Bond Position:  [5.59677407]


portfolio before change:  [4.57598851]
curr_Stock_Price:  100.5152868435027
curr_Factors:  [100.51528684  -1.54167741  -1.1286346 ]
mat_Sqrt:  [[ 6.95873576  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00181077  0.00015094  0.09763459]
Stock Position:  -0.001810766693440535
Bond Position:  [4.75799824]


portfolio before change:  [4.57818851]
curr_Stock_Price:  100.61446919009877
curr_Factors:  [100.61446919  -0.90702798  -1.12156426]
mat_Sqrt:  [[13.23286929  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00341946 -0.02211138  0.09983714]
Stock Position:  0.003419455738765074
Bond Position:  [4.23414178]


portfolio before change:  [4.58593935]
curr_Stock_Price:  102.2618780593125
curr_Factors:  [102.26187806  -1.04772067  -1.12983107]
mat_Sqrt:  [[11.58817539  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00425855  0.00278825 -0.49793512]
Stock Position:  0.0042585534210425715
Bond Position:  [4.15045168]


portfolio before change:  [4.58468081]
curr_Stock_Price:  101.47891602935708
curr_Factors:  [101.47891603  -0.56769236  -1.11850582]
mat_Sqrt:  [[18.79616519  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01074245  0.00437027 -0.26303946]
Stock Position:  -0.010742449281036362
Bond Position:  [5.67481292]


portfolio before change:  [4.59036149]
curr_Stock_Price:  101.21430556698813
curr_Factors:  [101.21430557  -0.64009227  -1.14763197]
mat_Sqrt:  [[16.93725886  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0083511  -0.0053527  -0.35356468]
Stock Position:  -0.008351100809596765
Bond Position:  [5.43561236]


portfolio before change:  [4.59697405]
curr_Stock_Price:  100.74801066350496
curr_Factors:  [100.74801066  -0.90224466  -1.15844323]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [4.59697405]
Stock Price:  102.79190112773792
PL:  [1.80507292]
Settle:  Tensor("sub_204:0", shape=(), dtype=float64)
PL:  Tensor("sub_205:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  103
output_Z_Vals[:, i, :]:  [[ 1.19279309e+02 -2.92921948e+01 -2.92556094e+01]
 [-6.44975148e-02 -6.22352041e-02  4.37441477e-02]
 [ 1.46632822e+00  8.70805824e-02 -5.69236843e-01]
 [ 5.13201436e-01 -4.51928078e-01  1.41206311e-01]
 [-4.55698225e-01  6.34314672e-01  7.12106715e-01]
 [ 1.18846278e-01  1.45050750e-01 -5.15967460e-02]
 [-1.32677026e-01 -8.99403171e-02  2.75136168e-01]
 [ 1.28514577e-01 -9.81526019e-02 -6.57181439e-02]
 [-8.18011583e-02 -7.37306655e-02  1.27777602e-01]
 [-7.82503804e-03 -4.96417492e-02 -7.23999981e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.27930914 -29.29219478 -29.25560936]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  8.31647217  -9.26300532 -83.45811031]
init_Out:  [2.54002979]
Stock Position:  8.316472170547405
Bond position:  [-829.10718727]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-8.28818304]
curr_Stock_Price:  98.74783978576373
curr_Factors:  [98.74783979 -0.90443364 -0.99522498]
mat_Sqrt:  [[14.77462094  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00386982 -0.0196805   0.12478988]
Stock Position:  -0.0038698240968557257
Bond Position:  [-7.90604627]


portfolio before change:  [-8.27617106]
curr_Stock_Price:  94.62207376292734
curr_Factors:  [94.62207376 -1.0087243  -1.00888571]
mat_Sqrt:  [[12.58217065  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.10748397  0.0275373  -1.62387427]
Stock Position:  0.10748396947411187
Bond Position:  [-18.44652715]


portfolio before change:  [-8.48423411]
curr_Stock_Price:  92.77214688788335
curr_Factors:  [92.77214689 -0.31608103 -1.00347398]
mat_Sqrt:  [[24.79374586  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.02139073 -0.14291221  0.4028223 ]
Stock Position:  0.021390729882117557
Bond Position:  [-10.46869805]


portfolio before change:  [-8.52891382]
curr_Stock_Price:  90.92816831474755
curr_Factors:  [90.92816831 -0.70782966 -0.98536379]
mat_Sqrt:  [[16.7245281   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01757671  0.20058791  2.03144225]
Stock Position:  -0.01757670616817802
Bond Position:  [-6.93069612]


portfolio before change:  [-8.56733426]
curr_Stock_Price:  92.91683603945799
curr_Factors:  [92.91683604 -0.50633507 -1.0528048 ]
mat_Sqrt:  [[19.54198013  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00573429  0.04586907 -0.14719115]
Stock Position:  0.00573428740487983
Bond Position:  [-9.10014611]


portfolio before change:  [-8.57372813]
curr_Stock_Price:  92.59549594363413
curr_Factors:  [92.59549594 -0.55965317 -0.98185456]
mat_Sqrt:  [[19.82081747  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0039775  -0.02844163  0.7848869 ]
Stock Position:  -0.003977501962153123
Bond Position:  [-8.20542936]


portfolio before change:  [-8.57807483]
curr_Stock_Price:  92.65657835228467
curr_Factors:  [92.65657835 -0.58036502 -1.01206484]
mat_Sqrt:  [[18.84919289  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00597191 -0.03103858 -0.18747557]
Stock Position:  0.005971907018530904
Bond Position:  [-9.1314113]


portfolio before change:  [-8.59633663]
curr_Stock_Price:  90.36334787562636
curr_Factors:  [90.36334788 -0.2127215  -1.01839576]
mat_Sqrt:  [[26.38304268  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00218407 -0.02331568  0.36451393]
Stock Position:  -0.0021840688657019883
Bond Position:  [-8.39897686]


portfolio before change:  [-8.60409414]
curr_Stock_Price:  91.99194725681036
curr_Factors:  [91.99194726 -0.50803825 -1.0351734 ]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-8.60409414]
Stock Price:  91.72202539340753
PL:  [-8.60409414]
Settle:  Tensor("sub_206:0", shape=(), dtype=float64)
PL:  Tensor("sub_207:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  104
output_Z_Vals[:, i, :]:  [[ 1.19279309e+02 -2.92921948e+01 -2.92556094e+01]
 [-7.04779654e-02 -1.14653620e-01 -1.72427800e-03]
 [ 4.12176825e-01  6.73930609e-02 -2.68366060e-01]
 [-5.85597011e-02  1.17175883e-01 -1.26113903e-01]
 [-2.62605261e-02 -1.10782351e-02  3.74340104e-02]
 [ 7.96956401e-02  4.77147633e-02 -4.45138236e-03]
 [ 7.08906536e-02  3.39812007e-02 -2.35117900e-01]
 [-6.91920703e-02 -9.11024842e-02  9.44944197e-02]
 [ 4.91633882e-02 -8.90609736e-02  3.60517274e-02]
 [-7.75774697e-03 -4.21154334e-02  6.94499468e-03]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.27930914 -29.29219478 -29.25560936]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  8.31647217  -9.26300532 -83.45811031]
init_Out:  [2.54002979]
Stock Position:  8.316472170547405
Bond position:  [-829.10718727]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [13.36222081]
curr_Stock_Price:  101.35115563881523
curr_Factors:  [101.35115564  -1.39305792  -1.03066159]
mat_Sqrt:  [[ 8.97884961  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00821823 -0.03625666 -0.00491889]
Stock Position:  -0.008218232744906224
Bond Position:  [14.19514819]


portfolio before change:  [13.3760708]
curr_Stock_Price:  100.52973211894069
curr_Factors:  [100.52973212  -1.84004606  -0.97546023]
mat_Sqrt:  [[ 6.0191571   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.05966565  0.02131156 -0.76557367]
Stock Position:  0.05966564892257344
Bond Position:  [7.3778991]


portfolio before change:  [13.4844542]
curr_Stock_Price:  102.28440215336487
curr_Factors:  [102.28440215  -1.52962731  -0.98898939]
mat_Sqrt:  [[ 8.24115488  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00986235  0.03705427 -0.35976786]
Stock Position:  -0.009862346573629504
Bond Position:  [14.49321842]


portfolio before change:  [13.50830138]
curr_Stock_Price:  100.60135868979486
curr_Factors:  [100.60135869  -0.92850739  -0.99950415]
mat_Sqrt:  [[14.63117068  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00129213 -0.00350325  0.10678881]
Stock Position:  -0.001292130335462283
Bond Position:  [13.63829145]


portfolio before change:  [13.51577105]
curr_Stock_Price:  100.09923082211812
curr_Factors:  [100.09923082  -1.61604218  -0.98647609]
mat_Sqrt:  [[ 7.41602891  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01079001  0.01508873 -0.01269855]
Stock Position:  0.010790005863918158
Bond Position:  [12.43569976]


portfolio before change:  [13.51323238]
curr_Stock_Price:  99.28754685498134
curr_Factors:  [99.28754685 -1.2766404  -0.99160505]
mat_Sqrt:  [[10.27562612  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00231371  0.0107458  -0.67072593]
Stock Position:  0.002313708548281217
Bond Position:  [13.28350993]


portfolio before change:  [13.51905244]
curr_Stock_Price:  98.93168788615948
curr_Factors:  [98.93168789 -1.49604083 -0.99250216]
mat_Sqrt:  [[ 8.21438267  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00636149 -0.02880914  0.26956628]
Stock Position:  -0.006361492489255648
Bond Position:  [14.14840563]


portfolio before change:  [13.53634259]
curr_Stock_Price:  97.32606097700967
curr_Factors:  [97.32606098 -0.84406346 -1.02849596]
mat_Sqrt:  [[14.96190607  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00362406 -0.02816355  0.10284554]
Stock Position:  0.0036240617704798163
Bond Position:  [13.18362694]


portfolio before change:  [13.54891266]
curr_Stock_Price:  98.97520547002414
curr_Factors:  [98.97520547 -1.12867221 -1.01902924]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [13.54891266]
Stock Price:  99.35929586211557
PL:  [13.54891266]
Settle:  Tensor("sub_208:0", shape=(), dtype=float64)
PL:  Tensor("sub_209:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  105
output_Z_Vals[:, i, :]:  [[ 1.19279309e+02 -2.92921948e+01 -2.92556094e+01]
 [-6.78346797e-02 -9.14853244e-02  1.83722072e-02]
 [-4.62399331e-02 -5.31354561e-02  5.73322023e-02]
 [-5.21907206e-02  1.46957043e-01  3.58675323e-02]
 [ 1.50957539e-02 -5.20026504e-02 -9.70101777e-03]
 [ 1.88298133e-01  6.05691171e-01 -1.12291095e-01]
 [ 1.13792609e-01 -6.39632477e-04 -1.79201588e-01]
 [-1.61373172e-01 -9.78866799e-04 -9.65212492e-02]
 [-4.69351350e-02  6.36023997e-03 -1.11186846e-01]
 [ 1.47550703e-02  9.79770163e-02  1.71803116e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.27930914 -29.29219478 -29.25560936]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  8.31647217  -9.26300532 -83.45811031]
init_Out:  [2.54002979]
Stock Position:  8.316472170547405
Bond position:  [-829.10718727]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [22.5399266]
curr_Stock_Price:  102.45471320543864
curr_Factors:  [102.45471321  -0.59497451  -1.01732214]
mat_Sqrt:  [[20.43244809  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00325201 -0.0289302   0.05241079]
Stock Position:  -0.00325201411462282
Bond Position:  [22.87311077]


portfolio before change:  [22.53898368]
curr_Stock_Price:  106.26230157668722
curr_Factors:  [106.26230158  -0.44315142  -1.00416834]
mat_Sqrt:  [[24.99287571  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00143677 -0.01680291  0.16355281]
Stock Position:  -0.001436769355951201
Bond Position:  [22.6916581]


portfolio before change:  [22.55250419]
curr_Stock_Price:  104.75068484430727
curr_Factors:  [104.75068484  -0.83940946  -1.02595964]
mat_Sqrt:  [[16.21949634  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00253244  0.0464719   0.10232009]
Stock Position:  -0.0025324384811220815
Bond Position:  [22.81777886]


portfolio before change:  [22.55798018]
curr_Stock_Price:  107.09457307355292
curr_Factors:  [107.09457307  -1.02190983  -1.06349757]
mat_Sqrt:  [[13.30719549  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0008847  -0.01644468 -0.0276743 ]
Stock Position:  0.0008846972526645834
Bond Position:  [22.46323391]


portfolio before change:  [22.56970147]
curr_Stock_Price:  107.64489129215484
curr_Factors:  [107.64489129  -1.16168514  -1.10476708]
mat_Sqrt:  [[11.16055344  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01621924  0.19153637 -0.32033524]
Stock Position:  0.01621923936047464
Bond Position:  [20.82378321]


portfolio before change:  [22.54294636]
curr_Stock_Price:  105.35319282647288
curr_Factors:  [105.35319283  -0.76455768  -1.19587992]
mat_Sqrt:  [[14.83339183  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 5.20425293e-03 -2.02269549e-04 -5.11212252e-01]
Stock Position:  0.00520425292733857
Bond Position:  [21.9946617]


portfolio before change:  [22.54845495]
curr_Stock_Price:  104.29799993915582
curr_Factors:  [104.29799994  -0.93244473  -1.21662855]
mat_Sqrt:  [[12.16032861  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01489275 -0.00030954 -0.27534826]
Stock Position:  -0.014892752482345062
Bond Position:  [24.10173925]


portfolio before change:  [22.58352653]
curr_Stock_Price:  102.75243626751761
curr_Factors:  [102.75243627  -1.00954059  -1.26376201]
mat_Sqrt:  [[10.58057708  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00656551  0.00201128 -0.31718512]
Stock Position:  -0.006565505227402688
Bond Position:  [23.25814819]


portfolio before change:  [22.61012835]
curr_Stock_Price:  100.47236172047207
curr_Factors:  [100.47236172  -1.28446055  -1.2279571 ]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [22.61012835]
Stock Price:  101.42351873323453
PL:  [21.18660962]
Settle:  Tensor("sub_210:0", shape=(), dtype=float64)
PL:  Tensor("sub_211:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  106
output_Z_Vals[:, i, :]:  [[ 1.19279309e+02 -2.92921948e+01 -2.92556094e+01]
 [-6.42102899e-02 -5.97176889e-02  4.59278736e-02]
 [ 3.62427437e-01  6.80465399e-02 -2.42262304e-01]
 [ 1.50517087e-02  5.40199884e-02 -1.94611017e-01]
 [-1.66346607e-02  1.31045980e-03  3.13443732e-02]
 [ 8.08620300e-02  5.15350165e-02 -5.60815691e-03]
 [ 6.94713367e-02  3.92965519e-02 -2.69708234e-01]
 [-1.64834728e-01 -7.25966225e-03 -5.18716521e-02]
 [-1.04955709e-01 -6.07584405e-02 -7.63742029e-02]
 [-6.51184423e-04  1.11143361e-03  8.72865128e-03]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.27930914 -29.29219478 -29.25560936]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  8.31647217  -9.26300532 -83.45811031]
init_Out:  [2.54002979]
Stock Position:  8.316472170547405
Bond position:  [-829.10718727]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [7.52839865]
curr_Stock_Price:  100.64967765219404
curr_Factors:  [100.64967765  -0.82316747  -1.00679475]
mat_Sqrt:  [[16.14618383  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00349167 -0.01888439  0.13101944]
Stock Position:  -0.0034916737375841507
Bond Position:  [7.87983449]


portfolio before change:  [7.53484302]
curr_Stock_Price:  99.93269635557832
curr_Factors:  [99.93269636 -0.9452219  -1.052225  ]
mat_Sqrt:  [[13.55899308  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.02321211  0.02151821 -0.69110692]
Stock Position:  0.023212107508716547
Bond Position:  [5.21519453]


portfolio before change:  [7.54298741]
curr_Stock_Price:  100.17119865735448
curr_Factors:  [100.17119866  -1.26425883  -1.03813403]
mat_Sqrt:  [[10.01904572  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00232341  0.01708262 -0.55517106]
Stock Position:  -0.0023234057747744535
Bond Position:  [7.77572575]


portfolio before change:  [7.54560552]
curr_Stock_Price:  100.71811977741457
curr_Factors:  [100.71811978  -1.31225432  -0.99125497]
mat_Sqrt:  [[10.06250799  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00101393  0.0004144   0.08941677]
Stock Position:  -0.0010139302656762023
Bond Position:  [7.64772667]


portfolio before change:  [7.54973375]
curr_Stock_Price:  100.41888418541495
curr_Factors:  [100.41888419  -1.7093772   -1.02121802]
mat_Sqrt:  [[ 6.54535119  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01238251  0.0162968  -0.01599851]
Stock Position:  0.01238251329985174
Bond Position:  [6.30629558]


portfolio before change:  [7.54514391]
curr_Stock_Price:  99.79350403990632
curr_Factors:  [99.79350404 -1.45074538 -1.01091779]
mat_Sqrt:  [[ 8.51168498  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00181304  0.01242666 -0.76940252]
Stock Position:  0.001813037793917298
Bond Position:  [7.36421451]


portfolio before change:  [7.55122222]
curr_Stock_Price:  101.11464790587826
curr_Factors:  [101.11464791  -1.44992859  -0.99432891]
mat_Sqrt:  [[ 8.7757962   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02001077 -0.00229571 -0.14797539]
Stock Position:  -0.02001076878615521
Bond Position:  [9.57460406]


portfolio before change:  [7.57607119]
curr_Stock_Price:  100.11216391979926
curr_Factors:  [100.11216392  -1.72227728  -0.97444932]
mat_Sqrt:  [[ 6.75014914  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01809061 -0.01921351 -0.21787434]
Stock Position:  -0.018090608256089342
Bond Position:  [9.38716113]


portfolio before change:  [7.5749863]
curr_Stock_Price:  100.43164739761389
curr_Factors:  [100.4316474   -1.84021446  -0.93400151]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [7.5749863]
Stock Price:  101.16878069522872
PL:  [6.4062056]
Settle:  Tensor("sub_212:0", shape=(), dtype=float64)
PL:  Tensor("sub_213:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  107
output_Z_Vals[:, i, :]:  [[ 1.19279309e+02 -2.92921948e+01 -2.92556094e+01]
 [-7.04779654e-02 -1.14653620e-01 -1.72427800e-03]
 [ 4.86503204e-02  1.01313944e-03  4.61079407e-02]
 [-5.60754637e-02  1.23810616e-01 -8.52625624e-02]
 [ 6.30616944e-03 -3.07204452e-02 -3.92308396e-03]
 [ 4.40814588e-02 -6.89316493e-02  3.08692086e-02]
 [ 7.87538775e-02  1.42291291e-03 -8.95724389e-02]
 [-1.73840041e-01  2.93667644e-03 -7.13817974e-02]
 [-1.75998690e-03  2.70675892e-02 -1.06521108e-01]
 [ 6.55240981e-02  3.49265260e-01 -4.64571230e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.27930914 -29.29219478 -29.25560936]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  8.31647217  -9.26300532 -83.45811031]
init_Out:  [2.54002979]
Stock Position:  8.316472170547405
Bond position:  [-829.10718727]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [25.73898134]
curr_Stock_Price:  102.83937808269403
curr_Factors:  [102.83937808  -1.52131861  -0.98552366]
mat_Sqrt:  [[ 8.38400784  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00880131 -0.03625666 -0.00491889]
Stock Position:  -0.00880131284626778
Bond Position:  [26.64410288]


portfolio before change:  [25.75401213]
curr_Stock_Price:  102.6456109157905
curr_Factors:  [102.64561092  -1.5900439   -1.03214974]
mat_Sqrt:  [[ 7.45651945  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00779026 0.00032038 0.13153312]
Stock Position:  0.0077902597733745865
Bond Position:  [24.95437616]


portfolio before change:  [25.76720969]
curr_Stock_Price:  102.73768054299373
curr_Factors:  [102.73768054  -1.53376656  -1.00574275]
mat_Sqrt:  [[ 8.10652782  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00866991  0.03915235 -0.24323036]
Stock Position:  -0.008669906099819928
Bond Position:  [26.65793573]


portfolio before change:  [25.79372491]
curr_Stock_Price:  101.21714272743716
curr_Factors:  [101.21714273  -0.94297708  -0.97583188]
mat_Sqrt:  [[14.85682235  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00031717 -0.00971466 -0.01119147]
Stock Position:  0.0003171724532064425
Bond Position:  [25.76162162]


portfolio before change:  [25.80629893]
curr_Stock_Price:  100.23973794787497
curr_Factors:  [100.23973795  -1.07843499  -0.92529154]
mat_Sqrt:  [[13.51551338  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00359608 -0.0217981   0.08806126]
Stock Position:  0.00359607517175796
Bond Position:  [25.4458293]


portfolio before change:  [25.81610376]
curr_Stock_Price:  99.4273886376837
curr_Factors:  [99.42738864 -0.86689025 -0.9218038 ]
mat_Sqrt:  [[16.6221071   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00364014  0.00044996 -0.25552524]
Stock Position:  0.0036401353352718577
Bond Position:  [25.45417461]


portfolio before change:  [25.8353415]
curr_Stock_Price:  101.21509041708563
curr_Factors:  [101.21509042  -1.01454497  -0.91478377]
mat_Sqrt:  [[14.70105288  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01281098  0.00092866 -0.2036324 ]
Stock Position:  -0.012810984761751307
Bond Position:  [27.13200649]


portfolio before change:  [25.80955181]
curr_Stock_Price:  104.28738256090845
curr_Factors:  [104.28738256  -1.25844498  -0.90798096]
mat_Sqrt:  [[11.94991827  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00190835  0.00855952 -0.30387507]
Stock Position:  -0.0019083506953456657
Bond Position:  [26.00856871]


portfolio before change:  [25.82116668]
curr_Stock_Price:  105.01715655759935
curr_Factors:  [105.01715656  -1.51099391  -0.92500488]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [25.82116668]
Stock Price:  104.72150931149882
PL:  [21.09965737]
Settle:  Tensor("sub_214:0", shape=(), dtype=float64)
PL:  Tensor("sub_215:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  108
output_Z_Vals[:, i, :]:  [[ 1.19279309e+02 -2.92921948e+01 -2.92556094e+01]
 [-7.04779654e-02 -1.14653620e-01 -1.72427800e-03]
 [ 9.91642983e-01  7.97690177e-02 -4.22067083e-01]
 [ 2.73671924e-01 -1.15272186e-01 -1.63389611e-01]
 [-2.74541268e-01  3.17607504e-01  4.12521862e-01]
 [ 5.97957981e-02 -1.74627897e-02  1.52844126e-02]
 [-1.23571607e-02 -5.60885471e-02  2.12244759e-01]
 [ 6.60050396e-02 -1.01880712e-01 -8.88281840e-03]
 [-1.12853922e-01 -5.11615355e-02 -8.77531719e-02]
 [-1.37227225e-02 -7.94000326e-02  4.24921956e-03]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.27930914 -29.29219478 -29.25560936]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  8.31647217  -9.26300532 -83.45811031]
init_Out:  [2.54002979]
Stock Position:  8.316472170547405
Bond position:  [-829.10718727]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-13.78178434]
curr_Stock_Price:  98.08727107514189
curr_Factors:  [98.08727108 -1.24067119 -0.97781314]
mat_Sqrt:  [[10.66932999  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00691611 -0.03625666 -0.00491889]
Stock Position:  -0.006916111503965066
Bond Position:  [-13.10340183]


portfolio before change:  [-13.78139773]
curr_Stock_Price:  97.08382503740143
curr_Factors:  [97.08382504 -1.08126228 -0.99349588]
mat_Sqrt:  [[12.1924465   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.07443531  0.02522518 -1.20403991]
Stock Position:  0.07443530938688388
Bond Position:  [-21.00786228]


portfolio before change:  [-13.7290954]
curr_Stock_Price:  97.92763006209806
curr_Factors:  [97.92763006 -0.72674227 -0.95409411]
mat_Sqrt:  [[18.23590321  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0130152  -0.03645227 -0.46610508]
Stock Position:  0.013015195415474086
Bond Position:  [-15.00364264]


portfolio before change:  [-13.75722441]
curr_Stock_Price:  96.34291985640932
curr_Factors:  [96.34291986 -0.21342332 -0.95760124]
mat_Sqrt:  [[29.87103688  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00609738  0.10043631  1.17681005]
Stock Position:  -0.006097378075949874
Bond Position:  [-13.1697852]


portfolio before change:  [-13.76014685]
curr_Stock_Price:  95.74198921138661
curr_Factors:  [95.74198921 -0.57594655 -0.96222341]
mat_Sqrt:  [[20.56286938  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00303775 -0.00552222  0.04360217]
Stock Position:  0.003037748636244008
Bond Position:  [-14.05098695]


portfolio before change:  [-13.76660946]
curr_Stock_Price:  95.92786426178928
curr_Factors:  [95.92786426 -0.556758   -0.94750983]
mat_Sqrt:  [[21.3132439   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.001385   -0.01773676  0.60547522]
Stock Position:  0.0013850035894308961
Bond Position:  [-13.89946989]


portfolio before change:  [-13.77310166]
curr_Stock_Price:  96.2594640181073
curr_Factors:  [96.25946402 -0.4787572  -0.91106957]
mat_Sqrt:  [[23.98000901  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00256719 -0.03221751 -0.02534021]
Stock Position:  0.002567192245722237
Bond Position:  [-14.02021821]


portfolio before change:  [-13.77179344]
curr_Stock_Price:  99.50039030938615
curr_Factors:  [99.50039031 -0.9202693  -0.9002631 ]
mat_Sqrt:  [[16.11304458  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00819755 -0.0161787  -0.25033537]
Stock Position:  -0.008197547523881472
Bond Position:  [-12.95613427]


portfolio before change:  [-13.76856132]
curr_Stock_Price:  98.31566900724617
curr_Factors:  [98.31566901 -0.85211534 -0.97371076]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-13.76856132]
Stock Price:  99.65722558517346
PL:  [-13.76856132]
Settle:  Tensor("sub_216:0", shape=(), dtype=float64)
PL:  Tensor("sub_217:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  109
output_Z_Vals[:, i, :]:  [[ 1.19279309e+02 -2.92921948e+01 -2.92556094e+01]
 [-7.04779654e-02 -1.14653620e-01 -1.72427800e-03]
 [ 5.54276859e-01  7.22113595e-02 -2.92642641e-01]
 [-5.59432305e-02  1.01086996e-01 -1.99461849e-01]
 [-2.13821671e-01  2.34549123e-01  3.19895302e-01]
 [ 4.58383153e-02 -9.74377870e-02  2.64918751e-02]
 [-4.17790151e-01 -1.70156363e-01  4.24165307e-01]
 [ 1.25793950e-01 -1.04250511e-01 -7.33342179e-02]
 [ 1.69082520e-01 -9.19057599e-02  1.10305934e-01]
 [-8.05255161e-03 -5.29988934e-02 -6.26758633e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.27930914 -29.29219478 -29.25560936]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  8.31647217  -9.26300532 -83.45811031]
init_Out:  [2.54002979]
Stock Position:  8.316472170547405
Bond position:  [-829.10718727]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-2.5244886]
curr_Stock_Price:  99.44088538441996
curr_Factors:  [99.44088538 -1.07911237 -0.98469379]
mat_Sqrt:  [[12.62598759  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00584432 -0.03625666 -0.00491889]
Stock Position:  -0.005844317156570436
Bond Position:  [-1.94332453]


portfolio before change:  [-2.52313233]
curr_Stock_Price:  99.04251826221827
curr_Factors:  [99.04251826 -0.94246949 -0.96042851]
mat_Sqrt:  [[14.77078488  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.03360728  0.02283524 -0.834828  ]
Stock Position:  0.03360728110294322
Bond Position:  [-5.85168208]


portfolio before change:  [-2.4696354]
curr_Stock_Price:  100.72142516930784
curr_Factors:  [100.72142517  -0.6271754   -0.93172878]
mat_Sqrt:  [[21.1884105   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00443866  0.03196651 -0.56900914]
Stock Position:  -0.004438660228137035
Bond Position:  [-2.02256722]


portfolio before change:  [-2.45719757]
curr_Stock_Price:  97.69137447772377
curr_Factors:  [97.69137448 -0.13592434 -0.95877751]
mat_Sqrt:  [[32.69137945  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00435795  0.07417095  0.91257226]
Stock Position:  -0.004357946535756531
Bond Position:  [-2.03146379]


portfolio before change:  [-2.44718325]
curr_Stock_Price:  95.16029611594107
curr_Factors:  [95.16029612 -0.14786738 -0.93776309]
mat_Sqrt:  [[32.13456791  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00151644 -0.03081253  0.07557395]
Stock Position:  0.0015164390540180605
Bond Position:  [-2.59148804]


portfolio before change:  [-2.45211552]
curr_Stock_Price:  92.76244584817884
curr_Factors:  [ 9.27624458e+01 -6.34749524e-02 -9.68703653e-01]
mat_Sqrt:  [[33.04476884  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01015596 -0.05380817  1.21002556]
Stock Position:  -0.010155955111600366
Bond Position:  [-1.51002428]


portfolio before change:  [-2.46682127]
curr_Stock_Price:  94.13607913123597
curr_Factors:  [ 9.41360791e+01 -7.85858827e-02 -1.00977754e+00]
mat_Sqrt:  [[31.70194274  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00341092 -0.03296691 -0.20920211]
Stock Position:  0.003410924370177662
Bond Position:  [-2.78791232]


portfolio before change:  [-2.46608922]
curr_Stock_Price:  94.75947649337152
curr_Factors:  [ 9.47594765e+01 -6.72968037e-02 -1.05930005e+00]
mat_Sqrt:  [[30.71481163  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00616073 -0.02906315  0.31467213]
Stock Position:  0.006160728899262025
Bond Position:  [-3.04987666]


portfolio before change:  [-2.48349543]
curr_Stock_Price:  92.18171400704391
curr_Factors:  [92.18171401 -0.2431758  -1.01499225]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-2.48349543]
Stock Price:  93.84584468998041
PL:  [-2.48349543]
Settle:  Tensor("sub_218:0", shape=(), dtype=float64)
PL:  Tensor("sub_219:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  110
output_Z_Vals[:, i, :]:  [[ 1.19279309e+02 -2.92921948e+01 -2.92556094e+01]
 [-6.13489344e-02 -3.67473457e-02  6.59824981e-02]
 [-1.21214243e-01 -3.15031596e-02  7.00959789e-02]
 [-5.66440316e-02  1.10294656e-01 -1.48391900e-01]
 [ 3.31940293e-02 -4.09201815e-02 -3.62628294e-02]
 [ 6.16822403e-02 -1.01030828e-02  1.34127479e-02]
 [ 6.97718203e-02  3.72626824e-02 -2.75847870e-01]
 [-2.12159799e-01  4.81206699e-02 -1.54065191e-01]
 [ 3.08571700e-02  6.64908083e-02 -1.31725891e-01]
 [ 7.01893898e-02  3.95795621e-01 -1.55393961e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.27930914 -29.29219478 -29.25560936]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  8.31647217  -9.26300532 -83.45811031]
init_Out:  [2.54002979]
Stock Position:  8.316472170547405
Bond position:  [-829.10718727]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [12.51356553]
curr_Stock_Price:  101.2491105344884
curr_Factors:  [101.24911053  -0.21492385  -1.03264303]
mat_Sqrt:  [[29.07902265  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00167919 -0.01162053  0.1882297 ]
Stock Position:  -0.001679187309020433
Bond Position:  [12.68358176]


portfolio before change:  [12.51665174]
curr_Stock_Price:  103.18884056465065
curr_Factors:  [103.18884056  -0.7477588   -1.03217548]
mat_Sqrt:  [[17.40271867  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0061898  -0.00996217  0.19996432]
Stock Position:  -0.006189801242555573
Bond Position:  [13.15537015]


portfolio before change:  [12.53121998]
curr_Stock_Price:  101.89818338568045
curr_Factors:  [101.89818339  -1.20110716  -1.01933026]
mat_Sqrt:  [[11.06223098  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00760123  0.03487823 -0.42332079]
Stock Position:  -0.00760123394199811
Bond Position:  [13.30577191]


portfolio before change:  [12.53065376]
curr_Stock_Price:  102.84813111613776
curr_Factors:  [102.84813112  -1.38012517  -1.01364283]
mat_Sqrt:  [[ 9.38849914  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00263464 -0.0129401  -0.10344776]
Stock Position:  0.002634644294337566
Bond Position:  [12.25968552]


portfolio before change:  [12.53587696]
curr_Stock_Price:  102.50342530359057
curr_Factors:  [102.5034253   -1.55360385  -0.97475011]
mat_Sqrt:  [[ 8.17877399  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0078446  -0.00319488  0.03826284]
Stock Position:  0.007844604281096495
Bond Position:  [11.73177815]


portfolio before change:  [12.54844087]
curr_Stock_Price:  103.35707651949787
curr_Factors:  [103.35707652  -1.76708561  -0.91909121]
mat_Sqrt:  [[ 7.04285015  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00204842  0.01178349 -0.78691719]
Stock Position:  0.0020484218201757298
Bond Position:  [12.33672198]


portfolio before change:  [12.55354155]
curr_Stock_Price:  102.83510274745431
curr_Factors:  [102.83510275  -1.44299558  -0.96409998]
mat_Sqrt:  [[ 9.26302992  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02616485  0.01521709 -0.43950511]
Stock Position:  -0.026164846309834226
Bond Position:  [15.24420621]


portfolio before change:  [12.46261965]
curr_Stock_Price:  106.60145019339168
curr_Factors:  [106.60145019  -1.00680948  -1.07475274]
mat_Sqrt:  [[13.29695276  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00042758  0.02102624 -0.3757773 ]
Stock Position:  0.00042758070462634175
Bond Position:  [12.41703893]


portfolio before change:  [12.46901255]
curr_Stock_Price:  107.02902369624447
curr_Factors:  [107.0290237   -1.1697717   -1.11947677]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [12.46901255]
Stock Price:  107.24558806510659
PL:  [5.22342448]
Settle:  Tensor("sub_220:0", shape=(), dtype=float64)
PL:  Tensor("sub_221:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  111
output_Z_Vals[:, i, :]:  [[ 1.19279309e+02 -2.92921948e+01 -2.92556094e+01]
 [-3.65108008e-02  8.78149731e-02  1.79763178e-01]
 [ 6.94293897e-01  7.69105732e-02 -3.16927845e-01]
 [-5.84168926e-02  1.07997561e-01 -1.66617821e-01]
 [ 4.64756718e-02 -1.00147759e-01 -4.99898480e-02]
 [ 4.05594420e-02 -6.82388589e-02  3.43541809e-02]
 [-9.49496890e-02 -7.93258010e-02  2.55416021e-01]
 [-1.92559225e-01  2.96138525e-02 -1.33171156e-01]
 [-5.79000254e-02  1.36953191e-02 -1.22993571e-01]
 [ 2.70614610e-03  2.06357801e-02  1.00343570e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.27930914 -29.29219478 -29.25560936]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  8.31647217  -9.26300532 -83.45811031]
init_Out:  [2.54002979]
Stock Position:  8.316472170547405
Bond position:  [-829.10718727]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-18.06222357]
curr_Stock_Price:  97.57257696601938
curr_Factors:  [97.57257697 -0.74768159 -1.03569339]
mat_Sqrt:  [[16.39901887  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [1.49434371e-04 2.77695328e-02 5.12814309e-01]
Stock Position:  0.00014943437095474519
Bond Position:  [-18.07680427]


portfolio before change:  [-18.07122393]
curr_Stock_Price:  97.84227066792806
curr_Factors:  [97.84227067 -0.35670395 -1.10547252]
mat_Sqrt:  [[22.67312334  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0278562   0.02432126 -0.90410693]
Stock Position:  0.027856201583447666
Bond Position:  [-20.79673795]


portfolio before change:  [-17.98982074]
curr_Stock_Price:  101.13791583398655
curr_Factors:  [101.13791583  -0.57783921  -1.08543203]
mat_Sqrt:  [[19.16745608  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00467663  0.03415183 -0.47531426]
Stock Position:  -0.004676631442854742
Bond Position:  [-17.51683599]


portfolio before change:  [-18.00541038]
curr_Stock_Price:  102.59816010724586
curr_Factors:  [102.59816011  -0.29191695  -1.1376198 ]
mat_Sqrt:  [[24.56403179  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00137134 -0.0316695  -0.14260712]
Stock Position:  0.001371343805117772
Bond Position:  [-18.14610773]


portfolio before change:  [-18.01829936]
curr_Stock_Price:  99.81719322867866
curr_Factors:  [99.81719323 -0.25352929 -1.07766092]
mat_Sqrt:  [[26.36797578  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00173734 -0.02157902  0.09800292]
Stock Position:  0.0017373362459983182
Bond Position:  [-18.19171539]


portfolio before change:  [-18.03190064]
curr_Stock_Price:  97.22520913520694
curr_Factors:  [97.22520914 -0.10736892 -1.03151811]
mat_Sqrt:  [[31.12909787  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00144114 -0.02508502  0.72863081]
Stock Position:  -0.0014411370217010777
Bond Position:  [-17.89178579]


portfolio before change:  [-18.04963502]
curr_Stock_Price:  103.32196018528421
curr_Factors:  [103.32196019  -0.59511565  -1.05251707]
mat_Sqrt:  [[19.8900024   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01100945  0.00936472 -0.37990024]
Stock Position:  -0.011009452998593
Bond Position:  [-16.91211676]


portfolio before change:  [-18.05712116]
curr_Stock_Price:  103.23366919813215
curr_Factors:  [103.2336692   -0.5058643   -1.00967763]
mat_Sqrt:  [[22.6793115   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0036444   0.00433084 -0.35086642]
Stock Position:  -0.003644395083882636
Bond Position:  [-17.68089689]


portfolio before change:  [-18.05080614]
curr_Stock_Price:  99.07449416089023
curr_Factors:  [99.07449416 -0.39877085 -0.99952423]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-18.05080614]
Stock Price:  101.6469030123931
PL:  [-19.69770916]
Settle:  Tensor("sub_222:0", shape=(), dtype=float64)
PL:  Tensor("sub_223:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  112
output_Z_Vals[:, i, :]:  [[ 1.19279309e+02 -2.92921948e+01 -2.92556094e+01]
 [-4.78285957e-02  3.07992409e-02  1.27710204e-01]
 [ 9.48432943e-01  8.22989712e-02 -3.84633409e-01]
 [ 2.01188826e-01 -7.18585724e-02 -1.97405145e-01]
 [-8.61836535e-02  6.14324628e-02  1.25682758e-01]
 [ 5.62920041e-02 -2.89386955e-02  1.87593226e-02]
 [ 8.06573807e-02 -9.40128028e-03 -9.79418481e-02]
 [-1.78706814e-02 -1.04453664e-01  8.14205988e-02]
 [ 4.50903688e-02 -9.06909385e-02  3.47202779e-02]
 [-2.73739776e-03 -1.00252193e-02  1.01907648e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.27930914 -29.29219478 -29.25560936]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  8.31647217  -9.26300532 -83.45811031]
init_Out:  [2.54002979]
Stock Position:  8.316472170547405
Bond position:  [-829.10718727]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-17.28299834]
curr_Stock_Price:  97.66627357359049
curr_Factors:  [97.66627357 -0.82581388 -1.03086528]
mat_Sqrt:  [[15.25453952  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00137432  0.00973958  0.36432166]
Stock Position:  -0.0013743205057073294
Bond Position:  [-17.14877358]


portfolio before change:  [-17.2901933]
curr_Stock_Price:  96.66099301593266
curr_Factors:  [96.66099302 -0.35634407 -1.00576638]
mat_Sqrt:  [[24.75678256  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.03522449  0.02602522 -1.09725205]
Stock Position:  0.03522448546740676
Bond Position:  [-20.69502704]


portfolio before change:  [-17.22894477]
curr_Stock_Price:  98.6936310270323
curr_Factors:  [98.69363103 -0.45172296 -1.0269179 ]
mat_Sqrt:  [[22.49694563  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00706933 -0.02272368 -0.56314193]
Stock Position:  0.007069328075691993
Bond Position:  [-17.92664242]


portfolio before change:  [-17.23285798]
curr_Stock_Price:  99.4083175062838
curr_Factors:  [99.40831751 -1.04356836 -1.01822   ]
mat_Sqrt:  [[12.6473465   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00466047  0.01942665  0.35853792]
Stock Position:  -0.004660470767711302
Bond Position:  [-16.76956842]


portfolio before change:  [-17.23684759]
curr_Stock_Price:  98.46479206936938
curr_Factors:  [98.46479207 -1.04557594 -1.05950309]
mat_Sqrt:  [[11.99656083  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00494926 -0.00915122  0.05351513]
Stock Position:  0.004949255187756334
Bond Position:  [-17.72417497]


portfolio before change:  [-17.2450906]
curr_Stock_Price:  98.59032294734756
curr_Factors:  [98.59032295 -1.06985045 -1.08578229]
mat_Sqrt:  [[11.41970506  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00529106 -0.00297295 -0.27940083]
Stock Position:  0.005291059996562147
Bond Position:  [-17.76673792]


portfolio before change:  [-17.25693229]
curr_Stock_Price:  98.03162629965018
curr_Factors:  [98.0316263  -0.8063651  -1.10277895]
mat_Sqrt:  [[14.52899188  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00027172 -0.03303115  0.23227031]
Stock Position:  -0.0002717155683119033
Bond Position:  [-17.23029557]


portfolio before change:  [-17.26529765]
curr_Stock_Price:  97.1043969564056
curr_Factors:  [97.10439696 -1.09258444 -1.11872683]
mat_Sqrt:  [[10.63845623  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00468451 -0.02867899  0.09904729]
Stock Position:  0.004684512939937589
Bond Position:  [-17.72018446]


portfolio before change:  [-17.26565352]
curr_Stock_Price:  98.92026032241044
curr_Factors:  [98.92026032 -0.963241   -1.15728757]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-17.26565352]
Stock Price:  99.37971254134145
PL:  [-17.26565352]
Settle:  Tensor("sub_224:0", shape=(), dtype=float64)
PL:  Tensor("sub_225:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  113
output_Z_Vals[:, i, :]:  [[ 1.19279309e+02 -2.92921948e+01 -2.92556094e+01]
 [-6.12555340e-02 -3.63223071e-02  6.63754121e-02]
 [ 5.54761060e-01  7.48854318e-02 -2.72734233e-01]
 [ 1.15361545e-01 -1.65333385e-02 -2.13134998e-01]
 [-1.05811305e-01  8.79360129e-02  1.55508890e-01]
 [ 3.77558750e-02 -8.20534095e-02  3.71376706e-02]
 [ 8.73464367e-02 -2.80371258e-02  1.60129511e-01]
 [-2.89474463e-02 -1.01677919e-01  9.54066992e-02]
 [-1.32051987e-01 -3.38492538e-02 -1.14593470e-01]
 [ 3.39134182e-02  2.08492823e-01  1.99428917e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.27930914 -29.29219478 -29.25560936]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  8.31647217  -9.26300532 -83.45811031]
init_Out:  [2.54002979]
Stock Position:  8.316472170547405
Bond position:  [-829.10718727]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [12.59405511]
curr_Stock_Price:  101.25878886631475
curr_Factors:  [101.25878887  -0.77041935  -1.04877337]
mat_Sqrt:  [[16.41978134  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00296256 -0.01148612  0.18935058]
Stock Position:  -0.002962557580547922
Bond Position:  [12.8940401]


portfolio before change:  [12.60881485]
curr_Stock_Price:  98.45340792494335
curr_Factors:  [98.45340792 -0.2838365  -1.0463436 ]
mat_Sqrt:  [[26.03399853  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01924495  0.02368085 -0.77803485]
Stock Position:  0.01924494811580161
Bond Position:  [10.71408412]


portfolio before change:  [12.63129979]
curr_Stock_Price:  99.34333292441293
curr_Factors:  [99.34333292 -0.16385651 -1.0266292 ]
mat_Sqrt:  [[30.20767882  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00236459 -0.0052283  -0.60801482]
Stock Position:  0.0023645860616776
Bond Position:  [12.39639393]


portfolio before change:  [12.63745731]
curr_Stock_Price:  99.32547493188991
curr_Factors:  [99.32547493 -0.72318502 -1.0830597 ]
mat_Sqrt:  [[16.31618179  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0044004   0.02780781  0.44362358]
Stock Position:  -0.00440039760164668
Bond Position:  [13.07452889]


portfolio before change:  [12.6495411]
curr_Stock_Price:  98.0653861692666
curr_Factors:  [98.06538617 -0.51336743 -1.11679789]
mat_Sqrt:  [[19.21073321  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00224968 -0.02594757  0.10594344]
Stock Position:  0.0022496778160679986
Bond Position:  [12.42892558]


portfolio before change:  [12.65687993]
curr_Stock_Price:  98.56448742564415
curr_Factors:  [98.56448743 -0.6140694  -1.13350586]
mat_Sqrt:  [[17.16952078  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00694887 -0.00886612  0.45680492]
Stock Position:  0.0069488730882589465
Bond Position:  [11.97196782]


portfolio before change:  [12.66156128]
curr_Stock_Price:  98.37652353663854
curr_Factors:  [98.37652354 -0.51362831 -1.10079142]
mat_Sqrt:  [[19.57752959  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00061795 -0.03215338  0.27216876]
Stock Position:  -0.0006179506911548593
Bond Position:  [12.72235312]


portfolio before change:  [12.66692535]
curr_Stock_Price:  99.9926590868379
curr_Factors:  [99.99265909 -0.44527003 -1.09872578]
mat_Sqrt:  [[21.35105093  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00732129 -0.01070407 -0.32690327]
Stock Position:  -0.007321291381366912
Bond Position:  [13.39900074]


portfolio before change:  [12.66840702]
curr_Stock_Price:  100.7055811612969
curr_Factors:  [ 1.00705581e+02  2.49297947e-02 -1.11989642e+00]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [12.66840702]
Stock Price:  99.85341992813953
PL:  [12.66840702]
Settle:  Tensor("sub_226:0", shape=(), dtype=float64)
PL:  Tensor("sub_227:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  114
output_Z_Vals[:, i, :]:  [[ 1.19279309e+02 -2.92921948e+01 -2.92556094e+01]
 [-6.82954335e-02 -9.55238134e-02  1.48691685e-02]
 [ 3.83990562e-01  6.74831646e-02 -2.55683784e-01]
 [ 2.17797335e-01 -7.71642351e-02 -1.60535499e-01]
 [-1.16748704e-01  1.02947328e-01  1.72210517e-01]
 [ 3.98720776e-02 -7.20772277e-02  3.50369185e-02]
 [ 8.28666957e-02 -1.55564767e-02 -1.27039718e-02]
 [-1.64521238e-02 -8.33206162e-02  9.35236873e-02]
 [ 5.80933186e-02 -8.19043722e-02  3.65002295e-02]
 [-1.31667203e-02 -8.76120788e-02 -2.54931380e-03]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.27930914 -29.29219478 -29.25560936]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  8.31647217  -9.26300532 -83.45811031]
init_Out:  [2.54002979]
Stock Position:  8.316472170547405
Bond position:  [-829.10718727]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [18.59123942]
curr_Stock_Price:  101.97991005673417
curr_Factors:  [101.97991006  -0.89552652  -0.97962171]
mat_Sqrt:  [[15.63680765  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00433124 -0.03020728  0.0424176 ]
Stock Position:  -0.004331235184707262
Bond Position:  [19.0329384]


portfolio before change:  [18.60915029]
curr_Stock_Price:  100.04235176410761
curr_Factors:  [100.04235176  -1.18350577  -1.02358525]
mat_Sqrt:  [[11.00668258  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.03030357  0.02134005 -0.72939467]
Stock Position:  0.030303566316981372
Bond Position:  [15.57751025]


portfolio before change:  [18.57919492]
curr_Stock_Price:  98.79675326296837
curr_Factors:  [98.79675326 -1.1912312  -0.98334822]
mat_Sqrt:  [[11.2288384   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01630051 -0.02440147 -0.45796309]
Stock Position:  0.016300509949164373
Bond Position:  [16.96875746]


portfolio before change:  [18.58825538]
curr_Stock_Price:  98.83196420322088
curr_Factors:  [98.8319642  -0.98992476 -1.00097508]
mat_Sqrt:  [[13.49772611  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00584827  0.0325548   0.49126867]
Stock Position:  -0.0058482658476487395
Bond Position:  [19.16625098]


portfolio before change:  [18.59689966]
curr_Stock_Price:  98.99290779912609
curr_Factors:  [98.9929078  -0.73983072 -1.02173738]
mat_Sqrt:  [[17.00453565  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00265593 -0.02279282  0.09995058]
Stock Position:  0.0026559344864117555
Bond Position:  [18.33398098]


portfolio before change:  [18.60406154]
curr_Stock_Price:  98.23709260384837
curr_Factors:  [98.2370926  -0.9919946  -1.01331533]
mat_Sqrt:  [[13.22453668  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00603967 -0.00491939 -0.0362409 ]
Stock Position:  0.006039670328166163
Bond Position:  [18.01074189]


portfolio before change:  [18.61322509]
curr_Stock_Price:  98.26290968608811
curr_Factors:  [98.26290969 -0.39361799 -0.96486548]
mat_Sqrt:  [[25.25851089  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 1.92802297e-05 -2.63482923e-02  2.66797048e-01]
Stock Position:  1.928022969771254e-05
Bond Position:  [18.61133056]


portfolio before change:  [18.62251502]
curr_Stock_Price:  97.32596042537436
curr_Factors:  [97.32596043 -0.3188591  -0.91263643]
mat_Sqrt:  [[28.40514339  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00223302 -0.02590044  0.104125  ]
Stock Position:  0.0022330158354159336
Bond Position:  [18.40518461]


portfolio before change:  [18.62834365]
curr_Stock_Price:  95.81398545443514
curr_Factors:  [95.81398545 -0.4130166  -0.9232364 ]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [18.62834365]
Stock Price:  98.08240627676868
PL:  [18.62834365]
Settle:  Tensor("sub_228:0", shape=(), dtype=float64)
PL:  Tensor("sub_229:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  115
output_Z_Vals[:, i, :]:  [[ 1.19279309e+02 -2.92921948e+01 -2.92556094e+01]
 [-4.73667645e-02  8.79151534e-02  1.73986550e-01]
 [ 5.99324975e-01  7.67076330e-02 -2.78007195e-01]
 [ 1.22790580e-04  6.43812174e-02 -1.92725305e-01]
 [-6.33961379e-03 -1.69156408e-02  1.42240252e-02]
 [ 4.51966497e-02 -4.91047639e-02  2.97526158e-02]
 [-2.72790132e-01 -1.29360878e-01  3.48373538e-01]
 [ 1.27939709e-01 -9.94410875e-02 -6.73274171e-02]
 [ 3.58819452e-03 -7.99166381e-02  1.21831044e-01]
 [-5.01475758e-03 -8.17382002e-03 -1.92513915e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.27930914 -29.29219478 -29.25560936]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  8.31647217  -9.26300532 -83.45811031]
init_Out:  [2.54002979]
Stock Position:  8.316472170547405
Bond position:  [-829.10718727]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-4.04206259]
curr_Stock_Price:  99.2584072913739
curr_Factors:  [99.25840729 -0.26278109 -0.94191471]
mat_Sqrt:  [[29.75600109  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-3.22017368e-04  2.78012126e-02  4.96335199e-01]
Stock Position:  -0.00032201736781281906
Bond Position:  [-4.01009966]


portfolio before change:  [-4.04372956]
curr_Stock_Price:  98.20697691033902
curr_Factors:  [98.20697691 -0.21124331 -0.92533233]
mat_Sqrt:  [[31.51619759  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01727866  0.02425708 -0.79307715]
Stock Position:  0.01727865725556884
Bond Position:  [-5.74061425]


portfolio before change:  [-4.00967028]
curr_Stock_Price:  100.34431343974461
curr_Factors:  [100.34431344  -0.18339618  -0.87153819]
mat_Sqrt:  [[34.94142338  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00107479  0.02035913 -0.54979165]
Stock Position:  -0.001074792555652847
Bond Position:  [-3.90182096]


portfolio before change:  [-4.01235618]
curr_Stock_Price:  101.02770446375867
curr_Factors:  [101.02770446  -0.79623483  -0.8554001 ]
mat_Sqrt:  [[19.3706659   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00019994 -0.0053492   0.04057718]
Stock Position:  -0.00019993668763018655
Bond Position:  [-3.99215704]


portfolio before change:  [-4.01421988]
curr_Stock_Price:  100.36310086956526
curr_Factors:  [100.36310087  -0.21925883  -0.87389085]
mat_Sqrt:  [[33.63761531  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00148649 -0.01552829  0.08487593]
Stock Position:  0.0014864905556683657
Bond Position:  [-4.16340868]


portfolio before change:  [-4.02264436]
curr_Stock_Price:  96.09650417606316
curr_Factors:  [96.09650418  0.29909108 -0.90561185]
mat_Sqrt:  [[52.39610063  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00391286 -0.0409075   0.99381274]
Stock Position:  -0.003912863028192492
Bond Position:  [-3.6466319]


portfolio before change:  [-4.0130507]
curr_Stock_Price:  93.17858136955365
curr_Factors:  [93.17858137 -0.2185485  -0.92928375]
mat_Sqrt:  [[29.56779111  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00377536 -0.03144603 -0.19206638]
Stock Position:  0.0037753581125559515
Bond Position:  [-4.36483321]


portfolio before change:  [-4.02233848]
curr_Stock_Price:  91.29668915901813
curr_Factors:  [91.29668916 -0.49775852 -0.88899106]
mat_Sqrt:  [[22.81378485  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00115691 -0.02527186  0.34755006]
Stock Position:  0.0011569063887636693
Bond Position:  [-4.1279602]


portfolio before change:  [-4.02823884]
curr_Stock_Price:  87.98106703235715
curr_Factors:  [87.98106703 -0.52588341 -0.89991608]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-4.02823884]
Stock Price:  87.83914809794479
PL:  [-4.02823884]
Settle:  Tensor("sub_230:0", shape=(), dtype=float64)
PL:  Tensor("sub_231:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  116
output_Z_Vals[:, i, :]:  [[ 1.19279309e+02 -2.92921948e+01 -2.92556094e+01]
 [-7.04779654e-02 -1.14653620e-01 -1.72427800e-03]
 [ 2.44822646e-01  6.45225785e-02 -1.36068389e-01]
 [-4.53083797e-02  1.32642434e-01  2.48183718e-03]
 [ 1.10933991e-02 -1.74811304e-02 -3.43535929e-03]
 [ 1.73596836e-01  5.39938934e-01 -9.76994602e-02]
 [ 1.09857490e-01  2.56550916e-03 -2.26662538e-01]
 [-3.97848348e-02 -1.20253915e-01  4.63695934e-02]
 [ 3.59978433e-02  7.36907790e-02 -1.37250087e-01]
 [ 7.26487008e-02  4.38906580e-01 -2.83572389e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.27930914 -29.29219478 -29.25560936]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  8.31647217  -9.26300532 -83.45811031]
init_Out:  [2.54002979]
Stock Position:  8.316472170547405
Bond position:  [-829.10718727]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [19.6947462]
curr_Stock_Price:  102.1125993451054
curr_Factors:  [102.11259935  -1.44271925  -0.98850219]
mat_Sqrt:  [[ 8.97869619  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00821837 -0.03625666 -0.00491889]
Stock Position:  -0.008218373171914147
Bond Position:  [20.53394564]


portfolio before change:  [19.71485448]
curr_Stock_Price:  100.91543487237342
curr_Factors:  [100.91543487  -1.14839897  -0.9843191 ]
mat_Sqrt:  [[11.959965    0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01828716  0.02040383 -0.38816524]
Stock Position:  0.01828715785998353
Bond Position:  [17.86939799]


portfolio before change:  [19.77258179]
curr_Stock_Price:  103.58344774272445
curr_Factors:  [103.58344774  -0.90763166  -1.01766858]
mat_Sqrt:  [[15.10577777  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00273915  0.04194522  0.00707999]
Stock Position:  -0.0027391481951823276
Bond Position:  [20.0563122]


portfolio before change:  [19.7727311]
curr_Stock_Price:  107.19090329847593
curr_Factors:  [107.1909033   -1.20340068  -1.02708794]
mat_Sqrt:  [[11.52043914  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00086288 -0.00552802 -0.00980012]
Stock Position:  0.0008628836374940507
Bond Position:  [19.68023782]


portfolio before change:  [19.78249248]
curr_Stock_Price:  107.09680637607005
curr_Factors:  [107.09680638  -1.00365468  -1.06285269]
mat_Sqrt:  [[13.5613766   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01235827  0.17074368 -0.27870937]
Stock Position:  0.01235827195102101
Bond Position:  [18.45896102]


portfolio before change:  [19.81319588]
curr_Stock_Price:  108.83423492458428
curr_Factors:  [108.83423492  -1.27133675  -1.06109866]
mat_Sqrt:  [[10.56335079  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00602616  0.00081129 -0.64660513]
Stock Position:  0.006026159256711766
Bond Position:  [19.15734345]


portfolio before change:  [19.81782256]
curr_Stock_Price:  108.01208837203954
curr_Factors:  [108.01208837  -1.279973    -1.03151411]
mat_Sqrt:  [[10.70548297  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0031222  -0.03802763  0.13227954]
Stock Position:  -0.0031221967351965385
Bond Position:  [20.15505755]


portfolio before change:  [19.82910397]
curr_Stock_Price:  107.6273078086361
curr_Factors:  [107.62730781  -0.56893682  -1.06670671]
mat_Sqrt:  [[20.9687007   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00047139  0.02330307 -0.3915363 ]
Stock Position:  0.00047139183251260143
Bond Position:  [19.77836934]


portfolio before change:  [19.83985913]
curr_Stock_Price:  109.45912181432622
curr_Factors:  [109.45912181  -0.53650845  -1.04273077]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [19.83985913]
Stock Price:  110.94846471343807
PL:  [8.89139442]
Settle:  Tensor("sub_232:0", shape=(), dtype=float64)
PL:  Tensor("sub_233:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  117
output_Z_Vals[:, i, :]:  [[ 1.19279309e+02 -2.92921948e+01 -2.92556094e+01]
 [-7.04779654e-02 -1.14653620e-01 -1.72427800e-03]
 [ 2.41519165e-01  6.21991871e-02 -1.31106223e-01]
 [ 1.84869331e-01 -5.67243737e-02 -1.71492898e-01]
 [-1.75877147e-01  1.83832235e-01  2.62410833e-01]
 [ 4.15665058e-02 -6.45775576e-02  3.33551813e-02]
 [ 1.73245937e-02 -4.77376408e-02  1.96730053e-01]
 [ 3.10131158e-02 -1.05379998e-01  2.70404222e-02]
 [-7.03209616e-02 -6.21107170e-02 -5.45623737e-02]
 [ 8.22649780e-03  5.46786893e-02  1.21237842e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.27930914 -29.29219478 -29.25560936]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  8.31647217  -9.26300532 -83.45811031]
init_Out:  [2.54002979]
Stock Position:  8.316472170547405
Bond position:  [-829.10718727]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [7.19449186]
curr_Stock_Price:  100.60952760007062
curr_Factors:  [100.6095276   -0.96619945  -0.99173414]
mat_Sqrt:  [[14.20101401  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00519613 -0.03625666 -0.00491889]
Stock Position:  -0.005196127250882425
Bond Position:  [7.71727177]


portfolio before change:  [7.19664735]
curr_Stock_Price:  100.93748492992653
curr_Factors:  [100.93748493  -1.13878933  -1.00614747]
mat_Sqrt:  [[11.81730003  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01830902  0.01966911 -0.37400956]
Stock Position:  0.018309021118686986
Bond Position:  [5.34858081]


portfolio before change:  [7.16366995]
curr_Stock_Price:  98.99022837297962
curr_Factors:  [98.99022837 -1.08175098 -1.00787026]
mat_Sqrt:  [[12.24845623  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01211572 -0.01793782 -0.4892215 ]
Stock Position:  0.012115720547563132
Bond Position:  [5.96433201]


portfolio before change:  [7.14862978]
curr_Stock_Price:  97.5026498639151
curr_Factors:  [97.50264986 -1.08174128 -0.99436211]
mat_Sqrt:  [[12.22858405  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00961405  0.05813286  0.74858507]
Stock Position:  -0.009614051111089457
Bond Position:  [8.08602524]


portfolio before change:  [7.13237416]
curr_Stock_Price:  99.61410494479723
curr_Factors:  [99.61410494 -0.85110265 -0.96809764]
mat_Sqrt:  [[16.15296269  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00289159 -0.02042122  0.09515305]
Stock Position:  0.002891588322047847
Bond Position:  [6.84433118]


portfolio before change:  [7.128844]
curr_Stock_Price:  97.20947922923526
curr_Factors:  [97.20947923 -0.43104687 -0.96352685]
mat_Sqrt:  [[24.10199249  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00233381 -0.01509597  0.56121608]
Stock Position:  0.0023338056874258974
Bond Position:  [6.90197596]


portfolio before change:  [7.13170687]
curr_Stock_Price:  96.95711283987468
curr_Factors:  [96.95711284 -0.59681861 -1.04151699]
mat_Sqrt:  [[18.83907451  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00179477 -0.03332408  0.0771388 ]
Stock Position:  0.0017947707024779202
Bond Position:  [6.95769109]


portfolio before change:  [7.13852991]
curr_Stock_Price:  98.8199225273309
curr_Factors:  [98.81992253 -0.86018007 -0.98518547]
mat_Sqrt:  [[15.61034263  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00532097 -0.01964113 -0.15565127]
Stock Position:  -0.005320969134081932
Bond Position:  [7.66434766]


portfolio before change:  [7.13768484]
curr_Stock_Price:  99.69912238439466
curr_Factors:  [99.69912238 -0.60380064 -1.00784003]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [7.13768484]
Stock Price:  102.10682305996576
PL:  [5.03086178]
Settle:  Tensor("sub_234:0", shape=(), dtype=float64)
PL:  Tensor("sub_235:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  118
output_Z_Vals[:, i, :]:  [[ 1.19279309e+02 -2.92921948e+01 -2.92556094e+01]
 [-4.86127894e-02  7.69937936e-02  1.64513218e-01]
 [ 6.07814272e-02  1.20480335e-02  4.49144245e-02]
 [-1.67725553e-02  7.74706644e-02 -1.82051147e-01]
 [ 3.55797626e-02 -9.77318389e-02 -5.14207247e-02]
 [ 7.43775187e-02  8.99703824e-02  7.83808802e-04]
 [ 1.02299309e-01  1.13566464e-03 -2.15432705e-01]
 [ 6.69480908e-03 -1.33436220e-01  4.73984849e-03]
 [ 5.12717571e-02  1.05519764e-01 -1.65243800e-01]
 [ 7.23703322e-02  4.43243765e-01 -3.04157071e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.27930914 -29.29219478 -29.25560936]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  8.31647217  -9.26300532 -83.45811031]
init_Out:  [2.54002979]
Stock Position:  8.316472170547405
Bond position:  [-829.10718727]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-4.96858172]
curr_Stock_Price:  99.14699957949945
curr_Factors:  [99.14699958 -0.49620013 -1.00486285]
mat_Sqrt:  [[22.09918238  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00059023  0.02434758  0.46931042]
Stock Position:  -0.0005902344200312787
Bond Position:  [-4.91006175]


portfolio before change:  [-4.97241812]
curr_Stock_Price:  101.4863331493292
curr_Factors:  [101.48633315  -0.25365105  -1.11558068]
mat_Sqrt:  [[25.80820373  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00272241 0.00380992 0.12812835]
Stock Position:  0.0027224143670607917
Bond Position:  [-5.24870597]


portfolio before change:  [-4.97822986]
curr_Stock_Price:  100.3157807214401
curr_Factors:  [100.31578072  -0.11045316  -1.11616598]
mat_Sqrt:  [[29.42085794  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00176519  0.02449838 -0.51934125]
Stock Position:  -0.001765186665592066
Bond Position:  [-4.80115378]


portfolio before change:  [-4.98655404]
curr_Stock_Price:  103.67123246325589
curr_Factors:  [103.67123246  -0.79586589  -1.06752084]
mat_Sqrt:  [[16.08420835  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00140263 -0.03090552 -0.14668901]
Stock Position:  0.001402625815443325
Bond Position:  [-5.13196598]


portfolio before change:  [-4.98968131]
curr_Stock_Price:  103.2715150173202
curr_Factors:  [103.27151502  -1.00664008  -1.09812866]
mat_Sqrt:  [[12.58609779  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00610678 0.02845113 0.00223599]
Stock Position:  0.006106780632265821
Bond Position:  [-5.6203378]


portfolio before change:  [-4.97651961]
curr_Stock_Price:  105.8870626440128
curr_Factors:  [105.88706264  -1.11830592  -1.12603546]
mat_Sqrt:  [[11.22374584  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 5.19912121e-03  3.59128692e-04 -6.14569542e-01]
Stock Position:  0.005199121214950323
Bond Position:  [-5.52703928]


portfolio before change:  [-4.9634785]
curr_Stock_Price:  108.92706093404023
curr_Factors:  [108.92706093  -0.92357599  -1.16801755]
mat_Sqrt:  [[13.45142372  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0003135  -0.04219624  0.01352147]
Stock Position:  0.0003134997683591547
Bond Position:  [-4.99762711]


portfolio before change:  [-4.96579733]
curr_Stock_Price:  109.5031635932044
curr_Factors:  [109.50316359  -0.71432953  -1.20270769]
mat_Sqrt:  [[16.10156091  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00125864  0.03336828 -0.47139457]
Stock Position:  0.0012586367443936325
Bond Position:  [-5.10362204]


portfolio before change:  [-4.96768647]
curr_Stock_Price:  110.03016751703818
curr_Factors:  [110.03016752  -0.8379249   -1.14669584]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-4.96768647]
Stock Price:  108.4613318914829
PL:  [-13.42901837]
Settle:  Tensor("sub_236:0", shape=(), dtype=float64)
PL:  Tensor("sub_237:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  119
output_Z_Vals[:, i, :]:  [[ 1.19279309e+02 -2.92921948e+01 -2.92556094e+01]
 [-6.35821247e-02 -5.42118460e-02  5.07037144e-02]
 [ 1.16121155e+00  8.40704491e-02 -4.61930414e-01]
 [ 3.85657004e-01 -2.58060350e-01 -1.07975486e-01]
 [-3.20918128e-01  3.89706129e-01  4.86188759e-01]
 [ 1.70985445e-01  2.90960034e-01 -1.09999497e-01]
 [-5.18609532e-02 -6.72028655e-02  2.32893462e-01]
 [ 1.06144415e-01 -1.06592113e-01 -5.61722563e-02]
 [ 4.04280086e-02 -9.06452588e-02  3.18781016e-02]
 [-1.51309308e-02 -9.53618671e-02 -7.13600039e-05]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.27930914 -29.29219478 -29.25560936]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  8.31647217  -9.26300532 -83.45811031]
init_Out:  [2.54002979]
Stock Position:  8.316472170547405
Bond position:  [-829.10718727]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-7.43236894]
curr_Stock_Price:  98.850745691672
curr_Factors:  [98.85074569 -0.89983455 -0.96741531]
mat_Sqrt:  [[15.2771956   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00357605 -0.01714329  0.14464358]
Stock Position:  -0.0035760500592411375
Bond Position:  [-7.07887372]


portfolio before change:  [-7.4264957]
curr_Stock_Price:  96.21835720849992
curr_Factors:  [96.21835721 -0.97982873 -0.88274969]
mat_Sqrt:  [[14.93999355  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.07155901  0.02658541 -1.31775889]
Stock Position:  0.07155900574725917
Bond Position:  [-14.31178568]


portfolio before change:  [-7.44752594]
curr_Stock_Price:  96.02449545209848
curr_Factors:  [96.02449545 -0.74577335 -0.85696942]
mat_Sqrt:  [[19.33391001  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01846256 -0.08160585 -0.30802401]
Stock Position:  0.018462561895512132
Bond Position:  [-9.22038413]


portfolio before change:  [-7.47659385]
curr_Stock_Price:  94.6998381422638
curr_Factors:  [94.69983814 -0.74946067 -0.81191837]
mat_Sqrt:  [[19.87242803  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01064858  0.1232359   1.3869612 ]
Stock Position:  -0.010648577735753896
Bond Position:  [-6.46817527]


portfolio before change:  [-7.44070613]
curr_Stock_Price:  91.02586238944484
curr_Factors:  [91.02586239 -0.49033425 -0.810659  ]
mat_Sqrt:  [[24.78281386  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00629648  0.09200964 -0.31379795]
Stock Position:  0.006296478211549236
Bond Position:  [-8.01384849]


portfolio before change:  [-7.42638272]
curr_Stock_Price:  93.93722550914302
curr_Factors:  [93.93722551 -0.6667647  -0.82744503]
mat_Sqrt:  [[21.08194558  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-2.87304832e-04 -2.12514120e-02  6.64380223e-01]
Stock Position:  -0.0002873048316638606
Bond Position:  [-7.39939411]


portfolio before change:  [-7.43044519]
curr_Stock_Price:  95.19665032147452
curr_Factors:  [95.19665032 -0.88636767 -0.89911926]
mat_Sqrt:  [[15.96594196  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00575764 -0.03370739 -0.16024381]
Stock Position:  0.005757637426458533
Bond Position:  [-7.97855298]


portfolio before change:  [-7.42520048]
curr_Stock_Price:  96.80060244201232
curr_Factors:  [96.80060244 -1.2540402  -0.90821523]
mat_Sqrt:  [[11.13839093  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00400369 -0.02866455  0.09093935]
Stock Position:  0.004003688561789024
Bond Position:  [-7.81275995]


portfolio before change:  [-7.42393626]
curr_Stock_Price:  98.09230616108677
curr_Factors:  [98.09230616 -1.15979227 -0.92451903]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-7.42393626]
Stock Price:  96.50911181661102
PL:  [-7.42393626]
Settle:  Tensor("sub_238:0", shape=(), dtype=float64)
PL:  Tensor("sub_239:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  120
output_Z_Vals[:, i, :]:  [[ 1.19279309e+02 -2.92921948e+01 -2.92556094e+01]
 [-7.04779654e-02 -1.14653620e-01 -1.72427800e-03]
 [ 3.53859135e-01  6.88484169e-02 -2.32581275e-01]
 [ 3.27634171e-02  4.62077117e-02 -1.69339272e-01]
 [-5.02732113e-02  5.34714492e-02  8.48323564e-02]
 [ 9.61779327e-02  1.01698885e-01 -2.07978009e-02]
 [ 6.96343022e-02  3.97210542e-02 -2.50403037e-01]
 [-9.80061848e-03 -9.94252253e-02  7.69024440e-02]
 [-5.17587182e-02 -7.11735353e-02 -3.71229355e-02]
 [-1.38384306e-02 -8.95659557e-02 -9.31299572e-05]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.27930914 -29.29219478 -29.25560936]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  8.31647217  -9.26300532 -83.45811031]
init_Out:  [2.54002979]
Stock Position:  8.316472170547405
Bond position:  [-829.10718727]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-17.04688292]
curr_Stock_Price:  97.6946648695251
curr_Factors:  [97.69466487 -1.10447952 -0.95288963]
mat_Sqrt:  [[12.48437422  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00591061 -0.03625666 -0.00491889]
Stock Position:  -0.005910610701252025
Bond Position:  [-16.46944779]


portfolio before change:  [-17.07175509]
curr_Stock_Price:  100.50916008891078
curr_Factors:  [100.50916009  -1.47086309  -0.93534955]
mat_Sqrt:  [[ 9.06151412  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.03400771  0.02177178 -0.66348964]
Stock Position:  0.034007709502616126
Bond Position:  [-20.48984141]


portfolio before change:  [-17.09236699]
curr_Stock_Price:  100.20439318116253
curr_Factors:  [100.20439318  -1.78868324  -0.92400966]
mat_Sqrt:  [[ 6.64935019  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-9.16990317e-05  1.46121614e-02 -4.83077807e-01]
Stock Position:  -9.169903166800312e-05
Bond Position:  [-17.08317835]


portfolio before change:  [-17.10086528]
curr_Stock_Price:  99.70881058433149
curr_Factors:  [99.70881058 -1.69958944 -0.87911226]
mat_Sqrt:  [[ 7.56515129  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00417391  0.01690916  0.2420031 ]
Stock Position:  -0.0041739088892461815
Bond Position:  [-16.68468978]


portfolio before change:  [-17.10696653]
curr_Stock_Price:  99.17138334553864
curr_Factors:  [99.17138335 -1.62052629 -0.86151775]
mat_Sqrt:  [[ 8.28797321  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01140912  0.03216001 -0.05933034]
Stock Position:  0.0114091166720516
Bond Position:  [-18.23842442]


portfolio before change:  [-17.11568691]
curr_Stock_Price:  99.20654121521665
curr_Factors:  [99.20654122 -1.39857876 -0.83621259]
mat_Sqrt:  [[10.61653403  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00184115  0.0125609  -0.71433017]
Stock Position:  0.001841146024276361
Bond Position:  [-17.29834063]


portfolio before change:  [-17.1266329]
curr_Stock_Price:  97.9602206829922
curr_Factors:  [97.96022068 -1.19275182 -0.84592366]
mat_Sqrt:  [[12.75452372  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00026107 -0.03144102  0.21938127]
Stock Position:  0.0002610743423575962
Bond Position:  [-17.1522078]


portfolio before change:  [-17.13505431]
curr_Stock_Price:  98.56095526861196
curr_Factors:  [98.56095527 -1.31974249 -0.87420765]
mat_Sqrt:  [[10.98713513  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00556779 -0.02250705 -0.1059014 ]
Stock Position:  -0.005567793401968969
Bond Position:  [-16.58628727]


portfolio before change:  [-17.14710934]
curr_Stock_Price:  99.23623476889502
curr_Factors:  [99.23623477 -1.90351073 -0.86188027]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-17.14710934]
Stock Price:  98.88623758121545
PL:  [-17.14710934]
Settle:  Tensor("sub_240:0", shape=(), dtype=float64)
PL:  Tensor("sub_241:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  121
output_Z_Vals[:, i, :]:  [[ 1.19279309e+02 -2.92921948e+01 -2.92556094e+01]
 [-2.16029937e-02  1.94254546e-01  2.73581616e-01]
 [ 4.44756491e-01  7.22654206e-02 -2.45591354e-01]
 [-6.00819394e-02  1.07762373e-01 -1.75118876e-01]
 [ 5.50481110e-03 -2.07065599e-02  3.03529967e-04]
 [ 5.65114967e-02 -2.82197960e-02  1.85416394e-02]
 [ 7.27493141e-02  2.56835226e-02 -2.09631343e-01]
 [-8.59819670e-02 -7.52603800e-02  6.60037861e-02]
 [-1.09045556e-01 -4.55496799e-02 -8.93269918e-02]
 [-1.32422391e-02 -8.79107947e-02 -2.48535394e-03]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.27930914 -29.29219478 -29.25560936]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  8.31647217  -9.26300532 -83.45811031]
init_Out:  [2.54002979]
Stock Position:  8.316472170547405
Bond position:  [-829.10718727]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-15.78149541]
curr_Stock_Price:  97.84681923005152
curr_Factors:  [ 9.78468192e+01  1.65202283e-02 -9.81817578e-01]
mat_Sqrt:  [[37.26691131  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00105341 0.06142868 0.7804522 ]
Stock Position:  0.0010534076817243136
Bond Position:  [-15.88456801]


portfolio before change:  [-15.7881085]
curr_Stock_Price:  99.11051158914849
curr_Factors:  [99.11051159 -0.43238931 -1.00961817]
mat_Sqrt:  [[23.43493889  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01691881  0.02285233 -0.70060377]
Stock Position:  0.016918808837838462
Bond Position:  [-17.4649403]


portfolio before change:  [-15.76142921]
curr_Stock_Price:  101.20368195696966
curr_Factors:  [101.20368196  -0.81162783  -1.04460886]
mat_Sqrt:  [[15.81404462  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00588373  0.03407745 -0.49956541]
Stock Position:  -0.005883726776775189
Bond Position:  [-15.16597439]


portfolio before change:  [-15.76844174]
curr_Stock_Price:  101.10640474283711
curr_Factors:  [101.10640474  -1.37219629  -1.08621378]
mat_Sqrt:  [[ 8.65176551  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00058163 -0.00654799  0.00086589]
Stock Position:  0.0005816301674037657
Bond Position:  [-15.82724827]


portfolio before change:  [-15.77670323]
curr_Stock_Price:  100.51171764005905
curr_Factors:  [100.51171764  -1.3622204   -1.01178355]
mat_Sqrt:  [[ 9.35836281  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00636518 -0.00892388  0.05289414]
Stock Position:  0.006365179699680968
Bond Position:  [-16.41647837]


portfolio before change:  [-15.78298976]
curr_Stock_Price:  100.81394995230848
curr_Factors:  [100.81394995  -1.28549121  -1.02648324]
mat_Sqrt:  [[ 9.98718021  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00306609  0.00812184 -0.59801987]
Stock Position:  0.0030660947732342515
Bond Position:  [-16.09209488]


portfolio before change:  [-15.79592111]
curr_Stock_Price:  99.22127341244241
curr_Factors:  [99.22127341 -1.12672896 -0.99654198]
mat_Sqrt:  [[11.87079873  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00627188 -0.02379942  0.18829043]
Stock Position:  -0.006271879165976457
Bond Position:  [-15.17361727]


portfolio before change:  [-15.80384774]
curr_Stock_Price:  99.27515179022075
curr_Factors:  [99.27515179 -0.24637398 -0.97673498]
mat_Sqrt:  [[29.21804048  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00439644 -0.01440407 -0.25482504]
Stock Position:  -0.004396442656149718
Bond Position:  [-15.36739022]


portfolio before change:  [-15.7972278]
curr_Stock_Price:  96.0212586562805
curr_Factors:  [96.02125866 -0.61617823 -1.01493886]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-15.7972278]
Stock Price:  94.20397274051398
PL:  [-15.7972278]
Settle:  Tensor("sub_242:0", shape=(), dtype=float64)
PL:  Tensor("sub_243:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  122
output_Z_Vals[:, i, :]:  [[ 1.19279309e+02 -2.92921948e+01 -2.92556094e+01]
 [-7.04779654e-02 -1.14653620e-01 -1.72427800e-03]
 [ 2.64922848e-01  6.77246531e-02 -1.61544012e-01]
 [-6.72676306e-02  1.06747391e-01 -2.11806111e-01]
 [ 2.27174138e-02 -4.95662364e-02 -2.77841122e-02]
 [ 5.23282926e-02 -4.19209605e-02  2.26903587e-02]
 [ 7.30675310e-02  2.48526863e-02 -1.96528494e-01]
 [-1.53260104e-01 -2.03651261e-02 -2.67950525e-02]
 [ 2.83096828e-02  2.14933301e-02 -8.59731084e-02]
 [ 6.94539211e-02  3.56226834e-01 -1.71463498e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.27930914 -29.29219478 -29.25560936]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  8.31647217  -9.26300532 -83.45811031]
init_Out:  [2.54002979]
Stock Position:  8.316472170547405
Bond position:  [-829.10718727]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [4.19377598]
curr_Stock_Price:  100.24871164107716
curr_Factors:  [100.24871164  -1.37495696  -1.0442153 ]
mat_Sqrt:  [[ 8.9216593   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00827091 -0.03625666 -0.00491889]
Stock Position:  -0.008270913896745457
Bond Position:  [5.02292444]


portfolio before change:  [4.19162605]
curr_Stock_Price:  100.81237600953494
curr_Factors:  [100.81237601  -1.22138353  -1.07012748]
mat_Sqrt:  [[10.19349847  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.02292603  0.02141642 -0.4608401 ]
Stock Position:  0.022926030556246643
Bond Position:  [1.88039844]


portfolio before change:  [4.19351464]
curr_Stock_Price:  100.85373320656238
curr_Factors:  [100.85373321  -1.19274934  -1.04523614]
mat_Sqrt:  [[10.75838877  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01001508  0.03375649 -0.60422388]
Stock Position:  -0.010015083896092205
Bond Position:  [5.20357324]


portfolio before change:  [4.18951268]
curr_Stock_Price:  101.51317853616925
curr_Factors:  [101.51317854  -0.93790954  -1.04791181]
mat_Sqrt:  [[13.93449306  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00113145 -0.01567422 -0.07926034]
Stock Position:  0.001131452064893751
Bond Position:  [4.07465538]


portfolio before change:  [4.18878324]
curr_Stock_Price:  99.06740720438654
curr_Factors:  [99.0674072  -1.0388697  -0.98221664]
mat_Sqrt:  [[13.12756422  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00425651 -0.01325657  0.06472928]
Stock Position:  0.004256505408674612
Bond Position:  [3.76710229]


portfolio before change:  [4.19667829]
curr_Stock_Price:  100.47960474171505
curr_Factors:  [100.47960474  -1.2151023   -0.98411494]
mat_Sqrt:  [[11.14217574  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00301494  0.00785911 -0.56064109]
Stock Position:  0.0030149420137587173
Bond Position:  [3.89373811]


portfolio before change:  [4.19898316]
curr_Stock_Price:  100.59818544252616
curr_Factors:  [100.59818544  -1.19211617  -1.0216553 ]
mat_Sqrt:  [[10.99414379  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01448548 -0.00644002 -0.07643883]
Stock Position:  -0.014485479641319049
Bond Position:  [5.65619613]


portfolio before change:  [4.14591475]
curr_Stock_Price:  104.4570299199726
curr_Factors:  [104.45702992  -1.65213921  -1.07970112]
mat_Sqrt:  [[ 6.80008734  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00166402  0.00679679 -0.24525735]
Stock Position:  0.0016640155288427498
Bond Position:  [3.97209663]


portfolio before change:  [4.14687393]
curr_Stock_Price:  103.8396258387187
curr_Factors:  [103.83962584  -0.9795482   -1.00851569]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [4.14687393]
Stock Price:  105.50577228990895
PL:  [-1.35889836]
Settle:  Tensor("sub_244:0", shape=(), dtype=float64)
PL:  Tensor("sub_245:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  123
output_Z_Vals[:, i, :]:  [[ 1.19279309e+02 -2.92921948e+01 -2.92556094e+01]
 [-7.04779654e-02 -1.14653620e-01 -1.72427800e-03]
 [ 8.00673293e-01  7.73106846e-02 -3.59225067e-01]
 [-2.10417658e-02  7.83589968e-02 -1.94506728e-01]
 [ 3.60603169e-02 -1.26112015e-01 -4.77692308e-02]
 [ 6.34830751e-02  3.78072697e-02  1.15992383e-02]
 [ 9.76458644e-02 -6.70758631e-03 -1.06967855e-01]
 [-8.27277976e-02 -7.81279674e-02 -4.09705708e-03]
 [ 2.89432278e-02  6.35720620e-02 -1.29404964e-01]
 [ 6.99429266e-02  4.03728833e-01 -1.89203850e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.27930914 -29.29219478 -29.25560936]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  8.31647217  -9.26300532 -83.45811031]
init_Out:  [2.54002979]
Stock Position:  8.316472170547405
Bond position:  [-829.10718727]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-7.67146978]
curr_Stock_Price:  98.82199541850787
curr_Factors:  [98.82199542 -1.24411117 -0.97792725]
mat_Sqrt:  [[10.71111284  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00688913 -0.03625666 -0.00491889]
Stock Position:  -0.006889132528751708
Bond Position:  [-6.99067196]


portfolio before change:  [-7.66783412]
curr_Stock_Price:  97.78676002823065
curr_Factors:  [97.78676003 -0.84361938 -0.97790172]
mat_Sqrt:  [[15.81989128  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0461029   0.02444779 -1.02476913]
Stock Position:  0.04610290447392384
Bond Position:  [-12.17608777]


portfolio before change:  [-7.55223979]
curr_Stock_Price:  100.42615768952234
curr_Factors:  [100.42615769  -0.3671463   -0.98374717]
mat_Sqrt:  [[26.01125254  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00225756  0.02477929 -0.55487355]
Stock Position:  -0.002257563904722749
Bond Position:  [-7.32552132]


portfolio before change:  [-7.56471536]
curr_Stock_Price:  104.32943685226017
curr_Factors:  [104.32943685  -0.55020611  -1.04249452]
mat_Sqrt:  [[21.21806481  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00108649 -0.03988012 -0.13627232]
Stock Position:  0.0010864923570856637
Bond Position:  [-7.6780685]


portfolio before change:  [-7.57039904]
curr_Stock_Price:  102.63252595259065
curr_Factors:  [102.63252595  -0.47245378  -0.99348087]
mat_Sqrt:  [[23.69396208  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00282042 0.01195571 0.0330894 ]
Stock Position:  0.0028204206208784764
Bond Position:  [-7.85986593]


portfolio before change:  [-7.56839094]
curr_Stock_Price:  104.73824730937856
curr_Factors:  [104.73824731  -0.368129    -0.99105   ]
mat_Sqrt:  [[26.90427913  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00281137 -0.00212113 -0.30514952]
Stock Position:  0.0028113726038500437
Bond Position:  [-7.86284917]


portfolio before change:  [-7.56731898]
curr_Stock_Price:  106.51829060542636
curr_Factors:  [106.51829061  -0.91663719  -0.99464729]
mat_Sqrt:  [[15.75302234  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00543269 -0.02470623 -0.01168776]
Stock Position:  -0.005432694723793882
Bond Position:  [-6.98863762]


portfolio before change:  [-7.56859079]
curr_Stock_Price:  106.10903154381363
curr_Factors:  [106.10903154  -1.3652112   -1.04107871]
mat_Sqrt:  [[ 9.56563756  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00043593  0.02010325 -0.36915634]
Stock Position:  0.00043593265049926566
Bond Position:  [-7.61484718]


portfolio before change:  [-7.57170789]
curr_Stock_Price:  107.6947762111202
curr_Factors:  [107.69477621  -0.9511201   -1.01578922]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-7.57170789]
Stock Price:  107.8867263311795
PL:  [-15.45843422]
Settle:  Tensor("sub_246:0", shape=(), dtype=float64)
PL:  Tensor("sub_247:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  124
output_Z_Vals[:, i, :]:  [[ 1.19279309e+02 -2.92921948e+01 -2.92556094e+01]
 [-5.95724690e-02 -2.52542568e-02  7.62027611e-02]
 [ 2.10739118e-01  6.86630294e-02 -1.36941898e-01]
 [-5.79989426e-02  1.08056597e-01 -1.64483936e-01]
 [-6.57223881e-02  3.76545887e-02  9.58935194e-02]
 [ 4.35123482e-02 -5.50001459e-02  3.14232807e-02]
 [ 8.03625845e-02  6.50136441e-03 -1.23428146e-01]
 [-1.85851638e-01  1.65369057e-02 -9.74051041e-02]
 [-7.17609984e-02 -4.17073268e-02 -7.58494734e-02]
 [ 1.03598183e-02  6.48884681e-02  1.04794224e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.27930914 -29.29219478 -29.25560936]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  8.31647217  -9.26300532 -83.45811031]
init_Out:  [2.54002979]
Stock Position:  8.316472170547405
Bond position:  [-829.10718727]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [9.25580592]
curr_Stock_Price:  100.85738679018816
curr_Factors:  [100.85738679  -0.73118263  -1.01543219]
mat_Sqrt:  [[17.58581626  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0025401  -0.0079861   0.21738527]
Stock Position:  -0.002540098621615482
Bond Position:  [9.51199363]


portfolio before change:  [9.26108186]
curr_Stock_Price:  100.65316007919235
curr_Factors:  [100.65316008  -0.75959356  -1.04641454]
mat_Sqrt:  [[16.5381931   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01115955  0.02171316 -0.39065712]
Stock Position:  0.011159552954015984
Bond Position:  [8.13783759]


portfolio before change:  [9.27079116]
curr_Stock_Price:  101.15850004982059
curr_Factors:  [101.15850005  -0.50786589  -1.04851636]
mat_Sqrt:  [[21.33409164  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00416161  0.0341705  -0.46922689]
Stock Position:  -0.004161605643402461
Bond Position:  [9.69177295]


portfolio before change:  [9.27994477]
curr_Stock_Price:  100.12368000362112
curr_Factors:  [100.12368     -0.65020918  -0.99918662]
mat_Sqrt:  [[19.24036496  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00234798  0.01190743  0.27355752]
Stock Position:  -0.0023479787536472554
Bond Position:  [9.51503305]


portfolio before change:  [9.28247235]
curr_Stock_Price:  101.07391338068861
curr_Factors:  [101.07391338  -0.7670861   -0.97380066]
mat_Sqrt:  [[17.72480916  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00273664 -0.01739257  0.08964187]
Stock Position:  0.0027366444661031434
Bond Position:  [9.00586899]


portfolio before change:  [9.28856089]
curr_Stock_Price:  101.65289986388606
curr_Factors:  [101.65289986  -0.94103512  -1.00812756]
mat_Sqrt:  [[14.47468676  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00382293  0.00205591 -0.35210615]
Stock Position:  0.0038229348282304318
Bond Position:  [8.89994848]


portfolio before change:  [9.29282639]
curr_Stock_Price:  101.60435323864367
curr_Factors:  [101.60435324  -0.89911058  -0.91872414]
mat_Sqrt:  [[16.49820623  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01244422  0.00522943 -0.27786965]
Stock Position:  -0.012444224993641081
Bond Position:  [10.55721382]


portfolio before change:  [9.29958739]
curr_Stock_Price:  101.48533663332394
curr_Factors:  [101.48533663  -1.59588951  -0.91152209]
mat_Sqrt:  [[ 8.26891019  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01068104 -0.01318901 -0.21637744]
Stock Position:  -0.010681043060289584
Bond Position:  [10.38355664]


portfolio before change:  [9.3141083]
curr_Stock_Price:  100.61202919823047
curr_Factors:  [100.6120292   -1.11017771  -0.86387079]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [9.3141083]
Stock Price:  99.59723225478139
PL:  [9.3141083]
Settle:  Tensor("sub_248:0", shape=(), dtype=float64)
PL:  Tensor("sub_249:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  125
output_Z_Vals[:, i, :]:  [[ 1.19279309e+02 -2.92921948e+01 -2.92556094e+01]
 [-7.04779654e-02 -1.14653620e-01 -1.72427800e-03]
 [ 7.87013111e-01  7.40755307e-02 -3.77742345e-01]
 [ 2.09645380e-01 -7.52316229e-02 -1.82838653e-01]
 [-4.16254857e-02  4.67102595e-03  5.91252568e-02]
 [ 4.80409712e-02 -5.59631381e-02  2.69423370e-02]
 [ 4.46984685e-02 -4.00360522e-02  1.82421680e-01]
 [ 4.71361730e-02 -1.05634269e-01  9.19323239e-03]
 [ 1.29853550e-01 -9.15214115e-02  8.63919408e-02]
 [-1.40828469e-02 -9.12358306e-02 -1.77341032e-03]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.27930914 -29.29219478 -29.25560936]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  8.31647217  -9.26300532 -83.45811031]
init_Out:  [2.54002979]
Stock Position:  8.316472170547405
Bond position:  [-829.10718727]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-9.94188096]
curr_Stock_Price:  98.54899370137915
curr_Factors:  [98.5489937  -1.31816035 -0.95358872]
mat_Sqrt:  [[10.16351909  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00726031 -0.03625666 -0.00491889]
Stock Position:  -0.007260307698307709
Bond Position:  [-9.22638495]


portfolio before change:  [-9.9456174]
curr_Stock_Price:  98.42807409164843
curr_Factors:  [98.42807409 -1.5052542  -0.94894727]
mat_Sqrt:  [[ 8.45810026  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.08415831  0.02342474 -1.07759377]
Stock Position:  0.08415830709998738
Bond Position:  [-18.22915748]


portfolio before change:  [-9.92380582]
curr_Stock_Price:  98.79557715808744
curr_Factors:  [98.79557716 -0.80373595 -0.96898441]
mat_Sqrt:  [[16.78242957  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01015235 -0.02379033 -0.52158778]
Stock Position:  0.010152351505422217
Bond Position:  [-10.92681325]


portfolio before change:  [-9.9136584]
curr_Stock_Price:  100.33336831340048
curr_Factors:  [100.33336831  -0.94357462  -0.98890005]
mat_Sqrt:  [[14.52721306  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00202627  0.00147711  0.1686679 ]
Stock Position:  -0.002026265305513562
Bond Position:  [-9.71035637]


portfolio before change:  [-9.91116934]
curr_Stock_Price:  96.7082533420205
curr_Factors:  [96.70825334 -0.56828089 -0.96527667]
mat_Sqrt:  [[20.8664204   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00249662 -0.0176971   0.07685899]
Stock Position:  0.0024966232662424165
Bond Position:  [-10.15261342]


portfolio before change:  [-9.91816775]
curr_Stock_Price:  95.93888251362527
curr_Factors:  [95.93888251 -0.64765435 -0.97970308]
mat_Sqrt:  [[18.84700311  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00429253 -0.01266051  0.52039828]
Stock Position:  0.004292534529270935
Bond Position:  [-10.32998871]


portfolio before change:  [-9.92086504]
curr_Stock_Price:  96.51406626564692
curr_Factors:  [96.51406627 -0.93879949 -1.00820403]
mat_Sqrt:  [[13.77265692  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00336066 -0.03340449  0.02622573]
Stock Position:  0.003360663730667237
Bond Position:  [-10.24521636]


portfolio before change:  [-9.92958029]
curr_Stock_Price:  95.4454197737582
curr_Factors:  [95.44541977 -0.45720414 -0.94821447]
mat_Sqrt:  [[23.40936021  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00619945 -0.02894161  0.24645216]
Stock Position:  0.0061994500127143266
Bond Position:  [-10.5212894]


portfolio before change:  [-9.92954354]
curr_Stock_Price:  96.30012563528315
curr_Factors:  [96.30012564 -0.45132317 -0.95492888]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-9.92954354]
Stock Price:  100.23596676926398
PL:  [-10.16551031]
Settle:  Tensor("sub_250:0", shape=(), dtype=float64)
PL:  Tensor("sub_251:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  126
output_Z_Vals[:, i, :]:  [[ 1.19279309e+02 -2.92921948e+01 -2.92556094e+01]
 [-7.04779654e-02 -1.14653620e-01 -1.72427800e-03]
 [ 6.89776454e-01  7.46573572e-02 -3.31952778e-01]
 [ 2.61806283e-01 -1.07353530e-01 -1.63873534e-01]
 [-1.31540512e-01  1.22957182e-01  1.94699878e-01]
 [ 3.91209758e-02 -7.76567671e-02  3.57429598e-02]
 [ 1.04666093e-01 -8.68572356e-03 -8.10488440e-02]
 [-1.26962367e-01 -3.49266748e-02 -7.68318184e-03]
 [ 1.00578271e-01 -8.79226743e-02  6.62619830e-02]
 [-1.55221094e-02 -9.69222000e-02 -2.79004871e-04]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.27930914 -29.29219478 -29.25560936]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  8.31647217  -9.26300532 -83.45811031]
init_Out:  [2.54002979]
Stock Position:  8.316472170547405
Bond position:  [-829.10718727]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-13.28905197]
curr_Stock_Price:  98.14651883803474
curr_Factors:  [98.14651884 -1.38988845 -1.00502959]
mat_Sqrt:  [[ 8.94901453  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00824563 -0.03625666 -0.00491889]
Stock Position:  -0.008245631477927435
Bond Position:  [-12.47977194]


portfolio before change:  [-13.2971097]
curr_Stock_Price:  98.36679130236189
curr_Factors:  [98.3667913  -0.9166029  -1.01333789]
mat_Sqrt:  [[14.27860799  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.04369785  0.02360873 -0.94696888]
Stock Position:  0.043697853582517744
Bond Position:  [-17.59552734]


portfolio before change:  [-13.31265743]
curr_Stock_Price:  98.21237242534669
curr_Factors:  [98.21237243 -0.8095408  -1.00719644]
mat_Sqrt:  [[15.96493825  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01412996 -0.03394817 -0.46748558]
Stock Position:  0.014129956455809601
Bond Position:  [-14.70039398]


portfolio before change:  [-13.31257267]
curr_Stock_Price:  98.73868688621224
curr_Factors:  [98.73868689 -0.77984123 -1.010861  ]
mat_Sqrt:  [[16.4738553   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0053796   0.03888248  0.55542456]
Stock Position:  -0.00537960445846997
Bond Position:  [-12.78139759]


portfolio before change:  [-13.31132252]
curr_Stock_Price:  97.31805411610618
curr_Factors:  [97.31805412 -0.1739587  -0.98822673]
mat_Sqrt:  [[30.44126519  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00145894 -0.02455723  0.10196472]
Stock Position:  0.001458936991087391
Bond Position:  [-13.45330343]


portfolio before change:  [-13.30938666]
curr_Stock_Price:  103.25675586987413
curr_Factors:  [103.25675587  -0.47859108  -0.98641273]
mat_Sqrt:  [[23.86027304  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00368386 -0.00274667 -0.23120979]
Stock Position:  0.0036838557065102845
Bond Position:  [-13.68976965]


portfolio before change:  [-13.32837959]
curr_Stock_Price:  99.9595767200066
curr_Factors:  [99.95957672 -0.1388401  -0.97066884]
mat_Sqrt:  [[32.95875507  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00392711 -0.01104478 -0.02191798]
Stock Position:  -0.003927105029609321
Bond Position:  [-12.93582784]


portfolio before change:  [-13.3229981]
curr_Stock_Price:  96.94182488180269
curr_Factors:  [96.94182488 -0.13186032 -0.92716755]
mat_Sqrt:  [[33.61872463  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00332653 -0.02780359  0.18902699]
Stock Position:  0.00332653273472422
Bond Position:  [-13.64547825]


portfolio before change:  [-13.32867055]
curr_Stock_Price:  97.28812904058637
curr_Factors:  [97.28812904 -0.6027013  -0.83966495]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-13.32867055]
Stock Price:  97.12410228844296
PL:  [-13.32867055]
Settle:  Tensor("sub_252:0", shape=(), dtype=float64)
PL:  Tensor("sub_253:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  127
output_Z_Vals[:, i, :]:  [[ 1.19279309e+02 -2.92921948e+01 -2.92556094e+01]
 [-7.04779654e-02 -1.14653620e-01 -1.72427800e-03]
 [ 4.56165023e-01  7.22945720e-02 -2.50230959e-01]
 [ 2.76816566e-02  4.57429280e-02 -1.93145963e-01]
 [-3.24017896e-04 -4.10764196e-02 -3.37357729e-04]
 [ 4.72785720e-02 -3.75730078e-02  2.76847690e-02]
 [ 8.73464367e-02 -2.80371258e-02  1.60129511e-01]
 [-5.25575119e-02 -9.67722256e-02  9.77710619e-02]
 [ 2.00036834e-02 -8.55057351e-02  1.60214376e-02]
 [-1.45571171e-02 -9.31118130e-02 -1.37173235e-03]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.27930914 -29.29219478 -29.25560936]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  8.31647217  -9.26300532 -83.45811031]
init_Out:  [2.54002979]
Stock Position:  8.316472170547405
Bond position:  [-829.10718727]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-3.23419356]
curr_Stock_Price:  99.3555481233829
curr_Factors:  [99.35554812 -1.17411333 -1.02043803]
mat_Sqrt:  [[11.06905582  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00666636 -0.03625666 -0.00491889]
Stock Position:  -0.0066663568282039
Bond Position:  [-2.57185402]


portfolio before change:  [-3.23392299]
curr_Stock_Price:  99.1220149621718
curr_Factors:  [99.12201496 -0.50153587 -0.98313761]
mat_Sqrt:  [[22.45870032  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01812008  0.02286155 -0.71383927]
Stock Position:  0.018120081520556247
Bond Position:  [-5.03002199]


portfolio before change:  [-3.21883053]
curr_Stock_Price:  100.0937600161647
curr_Factors:  [ 1.00093760e+02 -8.48392570e-02 -9.31577619e-01]
mat_Sqrt:  [[36.22286217  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-2.91611984e-04  1.44651839e-02 -5.50991671e-01]
Stock Position:  -0.00029161198366155786
Bond Position:  [-3.18964199]


portfolio before change:  [-3.22075554]
curr_Stock_Price:  101.22465387911299
curr_Factors:  [101.22465388  -0.40952872  -0.95771298]
mat_Sqrt:  [[25.79293569  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-5.63514509e-05 -1.29895044e-02 -9.62387700e-04]
Stock Position:  -5.6351450866189696e-05
Bond Position:  [-3.21505138]


portfolio before change:  [-3.22239856]
curr_Stock_Price:  101.84751472012628
curr_Factors:  [101.84751472  -0.79804661  -0.95021951]
mat_Sqrt:  [[17.72915798  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00293074 -0.01188163  0.07897694]
Stock Position:  0.0029307410419399595
Bond Position:  [-3.52088725]


portfolio before change:  [-3.23446022]
curr_Stock_Price:  98.33278033753916
curr_Factors:  [98.33278034 -0.49685581 -0.93440971]
mat_Sqrt:  [[23.50215038  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00507651 -0.00886612  0.45680492]
Stock Position:  0.005076506571902796
Bond Position:  [-3.73364723]


portfolio before change:  [-3.2339348]
curr_Stock_Price:  98.80411001130537
curr_Factors:  [98.80411001 -1.0982947  -0.91638709]
mat_Sqrt:  [[13.17679618  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00266368 -0.03060206  0.27891363]
Stock Position:  -0.0026636767503313893
Bond Position:  [-2.97075259]


portfolio before change:  [-3.23205206]
curr_Stock_Price:  97.53950648046994
curr_Factors:  [97.53950648 -1.02169852 -0.97534261]
mat_Sqrt:  [[13.23965325  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00159115 -0.02703929  0.0457047 ]
Stock Position:  0.0015911517241327662
Bond Position:  [-3.38725221]


portfolio before change:  [-3.23481735]
curr_Stock_Price:  96.86625404443738
curr_Factors:  [96.86625404 -1.17144736 -1.00932021]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-3.23481735]
Stock Price:  97.67287662968151
PL:  [-3.23481735]
Settle:  Tensor("sub_254:0", shape=(), dtype=float64)
PL:  Tensor("sub_255:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  128
output_Z_Vals[:, i, :]:  [[ 1.19279309e+02 -2.92921948e+01 -2.92556094e+01]
 [-7.04779654e-02 -1.14653620e-01 -1.72427800e-03]
 [ 2.43506424e-01  4.65391958e-02 -6.44009379e-02]
 [-6.36434894e-02  1.09478711e-01 -1.83354019e-01]
 [ 3.49176624e-02 -1.15135009e-02 -2.80311736e-02]
 [ 6.54731462e-02  1.13211481e-03  9.65386645e-03]
 [ 7.80687450e-02  5.97112452e-03 -7.68953762e-02]
 [-2.14391669e-01  5.10309224e-02 -1.58828687e-01]
 [-1.15915136e-01 -4.78759887e-02 -9.18641661e-02]
 [ 6.07184009e-02  3.17797409e-01 -1.76251936e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.27930914 -29.29219478 -29.25560936]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  8.31647217  -9.26300532 -83.45811031]
init_Out:  [2.54002979]
Stock Position:  8.316472170547405
Bond position:  [-829.10718727]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [24.09048112]
curr_Stock_Price:  102.6411569872065
curr_Factors:  [102.64115699  -1.26915658  -1.01092168]
mat_Sqrt:  [[10.49774774  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00702915 -0.03625666 -0.00491889]
Stock Position:  -0.007029153082145165
Bond Position:  [24.81196152]


portfolio before change:  [24.11044799]
curr_Stock_Price:  101.56595036666506
curr_Factors:  [101.56595037  -1.63774712  -1.05785336]
mat_Sqrt:  [[ 6.85588814  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.03377568  0.01471699 -0.18371795]
Stock Position:  0.033775678624907116
Bond Position:  [20.67998909]


portfolio before change:  [24.12417038]
curr_Stock_Price:  101.66601658099282
curr_Factors:  [101.66601658  -1.69484975  -0.97383265]
mat_Sqrt:  [[ 7.04988073  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01393552  0.03462021 -0.52305798]
Stock Position:  -0.013935518553333356
Bond Position:  [25.54093904]


portfolio before change:  [24.13123156]
curr_Stock_Price:  102.07593923699922
curr_Factors:  [102.07593924  -1.56484819  -0.9059777 ]
mat_Sqrt:  [[ 8.62695103  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0033498  -0.00364089 -0.07996514]
Stock Position:  0.0033497982856644662
Bond Position:  [23.78929775]


portfolio before change:  [24.13715287]
curr_Stock_Price:  100.29185786140665
curr_Factors:  [100.29185786  -1.35878435  -0.86078181]
mat_Sqrt:  [[10.89733605  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00619169 0.00035801 0.02753979]
Stock Position:  0.0061916934800472345
Bond Position:  [23.51617642]


portfolio before change:  [24.15112045]
curr_Stock_Price:  100.64823127569171
curr_Factors:  [100.64823128  -0.77846873  -0.82258836]
mat_Sqrt:  [[20.2990582   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00308028  0.00188824 -0.2193611 ]
Stock Position:  0.0030802766946734605
Bond Position:  [23.84109605]


portfolio before change:  [24.1692132]
curr_Stock_Price:  102.65104626058162
curr_Factors:  [102.65104626  -0.74947537  -0.83413493]
mat_Sqrt:  [[21.06736233  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01165285  0.01613739 -0.45309403]
Stock Position:  -0.011652850640995714
Bond Position:  [25.36539051]


portfolio before change:  [24.21993433]
curr_Stock_Price:  99.38701562680545
curr_Factors:  [99.38701563 -0.71401402 -0.80481755]
mat_Sqrt:  [[21.76253488  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00624481 -0.01513972 -0.2620629 ]
Stock Position:  -0.006244814018372855
Bond Position:  [24.84058776]


portfolio before change:  [24.20897329]
curr_Stock_Price:  103.13163327762753
curr_Factors:  [103.13163328  -1.19810048  -0.840334  ]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [24.20897329]
Stock Price:  103.35934198094216
PL:  [20.84963131]
Settle:  Tensor("sub_256:0", shape=(), dtype=float64)
PL:  Tensor("sub_257:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  129
output_Z_Vals[:, i, :]:  [[ 1.19279309e+02 -2.92921948e+01 -2.92556094e+01]
 [-7.04779654e-02 -1.14653620e-01 -1.72427800e-03]
 [ 5.74902956e-01  7.13587616e-02 -3.07840603e-01]
 [ 4.70489724e-02  2.95182004e-02 -2.13024423e-01]
 [-1.88371212e-01  2.00381666e-01  2.81288358e-01]
 [ 4.18031622e-02 -1.03122056e-01  3.07901529e-02]
 [-1.27948007e-01 -8.43408118e-02  2.43781063e-01]
 [-1.42401681e-02 -9.38026680e-02  8.41512404e-02]
 [ 5.18619708e-02 -9.07572838e-02  3.88482487e-02]
 [-1.43641357e-02 -9.23484724e-02 -1.53517585e-03]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.27930914 -29.29219478 -29.25560936]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  8.31647217  -9.26300532 -83.45811031]
init_Out:  [2.54002979]
Stock Position:  8.316472170547405
Bond position:  [-829.10718727]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [9.69753143]
curr_Stock_Price:  100.91050132072148
curr_Factors:  [100.91050132  -1.10933984  -1.03139107]
mat_Sqrt:  [[11.86393449  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00621971 -0.03625666 -0.00491889]
Stock Position:  -0.006219713698490829
Bond Position:  [10.32516586]


portfolio before change:  [9.71420107]
curr_Stock_Price:  99.06061464279622
curr_Factors:  [99.06061464 -1.10177687 -1.05641782]
mat_Sqrt:  [[11.4448202   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.04490308  0.02256562 -0.87818355]
Stock Position:  0.044903084720372646
Bond Position:  [5.2660739]


portfolio before change:  [9.75108909]
curr_Stock_Price:  99.8234648202922
curr_Factors:  [99.82346482 -0.50663746 -1.08219748]
mat_Sqrt:  [[20.3802914   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 2.12347349e-04  9.33447457e-03 -6.07699384e-01]
Stock Position:  0.00021234734928022984
Bond Position:  [9.72989184]


portfolio before change:  [9.75554674]
curr_Stock_Price:  97.899641023228
curr_Factors:  [97.89964102 -0.43640826 -1.06216936]
mat_Sqrt:  [[21.87545555  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00574981  0.06336625  0.80243739]
Stock Position:  -0.0057498063720749
Bond Position:  [10.31845072]


portfolio before change:  [9.77380809]
curr_Stock_Price:  95.62115733868073
curr_Factors:  [95.62115734 -0.21562989 -1.03701948]
mat_Sqrt:  [[27.32343416  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00166251 -0.03261006  0.08783574]
Stock Position:  0.001662513414340242
Bond Position:  [9.61483663]


portfolio before change:  [9.78156931]
curr_Stock_Price:  97.39714231257123
curr_Factors:  [ 9.73971423e+01 -3.85656877e-02 -1.02310550e+00]
mat_Sqrt:  [[33.68746057  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00238558 -0.02667091  0.69543952]
Stock Position:  -0.002385578340899886
Bond Position:  [10.01391782]


portfolio before change:  [9.7848497]
curr_Stock_Price:  98.12142081905766
curr_Factors:  [98.12142082 -0.3285139  -1.0613313 ]
mat_Sqrt:  [[24.44340635  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 2.10755195e-05 -2.96630081e-02  2.40060066e-01]
Stock Position:  2.1075519493287106e-05
Bond Position:  [9.78278174]


portfolio before change:  [9.78972503]
curr_Stock_Price:  97.30127383800199
curr_Factors:  [97.30127384 -0.91798034 -1.14303137]
mat_Sqrt:  [[12.38889329  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0046371  -0.02869997  0.11082324]
Stock Position:  0.004637096468214578
Bond Position:  [9.33852963]


portfolio before change:  [9.79116644]
curr_Stock_Price:  96.60492926274001
curr_Factors:  [96.60492926 -0.56394785 -1.08159101]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [9.79116644]
Stock Price:  97.31274975103804
PL:  [9.79116644]
Settle:  Tensor("sub_258:0", shape=(), dtype=float64)
PL:  Tensor("sub_259:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  130
output_Z_Vals[:, i, :]:  [[ 1.19279309e+02 -2.92921948e+01 -2.92556094e+01]
 [-7.04779654e-02 -1.14653620e-01 -1.72427800e-03]
 [ 2.41944165e-01  4.66305441e-02 -6.74668231e-02]
 [-5.80481765e-02  1.15025817e-01 -1.33464000e-01]
 [ 3.58830175e-02 -4.17983605e-02 -3.93486593e-02]
 [ 5.92999296e-02  1.09327473e-02  1.57565288e-02]
 [ 7.35719516e-02  2.18870238e-02 -2.00188048e-01]
 [-2.02407221e-01  3.54037738e-02 -1.33250201e-01]
 [-8.63794612e-02  1.59756088e-03 -1.26083848e-01]
 [ 6.52569982e-02  3.34159853e-01 -1.97723949e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.27930914 -29.29219478 -29.25560936]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  8.31647217  -9.26300532 -83.45811031]
init_Out:  [2.54002979]
Stock Position:  8.316472170547405
Bond position:  [-829.10718727]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-5.01066878]
curr_Stock_Price:  99.14193889319208
curr_Factors:  [99.14193889 -1.10597016 -0.98831726]
mat_Sqrt:  [[12.21012014  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00604337 -0.03625666 -0.00491889]
Stock Position:  -0.0060433701765329785
Bond Position:  [-4.41151734]


portfolio before change:  [-5.02731759]
curr_Stock_Price:  101.53174869629906
curr_Factors:  [101.5317487   -1.57696639  -1.01488628]
mat_Sqrt:  [[ 7.60281724  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.03016994  0.01474587 -0.19246407]
Stock Position:  0.03016994173397459
Bond Position:  [-8.09052454]


portfolio before change:  [-5.01315287]
curr_Stock_Price:  102.13536269458265
curr_Factors:  [102.13536269  -1.44259344  -1.03245792]
mat_Sqrt:  [[ 8.595576    0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00957719  0.03637436 -0.38073564]
Stock Position:  -0.00957718803222913
Bond Position:  [-4.0349833]


portfolio before change:  [-5.01856041]
curr_Stock_Price:  102.4892815498177
curr_Factors:  [102.48928155  -1.30686952  -0.99769257]
mat_Sqrt:  [[10.22868608  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00261732 -0.0132178  -0.11225077]
Stock Position:  0.002617323166532608
Bond Position:  [-5.28680798]


portfolio before change:  [-5.02153112]
curr_Stock_Price:  102.36448170489432
curr_Factors:  [102.3644817   -1.43422647  -0.94514507]
mat_Sqrt:  [[ 9.47984766  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00662442 0.00345724 0.04494899]
Stock Position:  0.0066244207877986854
Bond Position:  [-5.69963652]


portfolio before change:  [-5.01987311]
curr_Stock_Price:  103.04507530042656
curr_Factors:  [103.0450753   -1.43047711  -0.96780907]
mat_Sqrt:  [[ 9.36407296  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00355335  0.00692128 -0.57108078]
Stock Position:  0.0035533531233084316
Bond Position:  [-5.38602865]


portfolio before change:  [-5.02505627]
curr_Stock_Price:  102.34447829938797
curr_Factors:  [102.3444783   -1.15547171  -0.97271226]
mat_Sqrt:  [[12.18444813  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01876923  0.01119566 -0.38012573]
Stock Position:  -0.01876922782846731
Bond Position:  [-3.10412944]


portfolio before change:  [-5.02554699]
curr_Stock_Price:  102.28791078933497
curr_Factors:  [102.28791079  -0.70604992  -0.97206569]
mat_Sqrt:  [[19.09976201  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00586787  0.00050519 -0.35968212]
Stock Position:  -0.005867872597901089
Bond Position:  [-4.42533456]


portfolio before change:  [-5.02913042]
curr_Stock_Price:  102.52142166866261
curr_Factors:  [102.52142167  -0.63185264  -0.99739395]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-5.02913042]
Stock Price:  101.27943348338835
PL:  [-6.30856391]
Settle:  Tensor("sub_260:0", shape=(), dtype=float64)
PL:  Tensor("sub_261:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  131
output_Z_Vals[:, i, :]:  [[ 1.19279309e+02 -2.92921948e+01 -2.92556094e+01]
 [-4.95087608e-02  6.91406389e-02  1.57701288e-01]
 [ 6.03238515e-01  7.38949326e-02 -3.00831372e-01]
 [ 2.11251345e-01 -7.95573018e-02 -2.03154417e-01]
 [-2.63351894e-01  3.02406604e-01  3.95488003e-01]
 [ 1.28623835e-01  1.73720207e-01 -6.21969145e-02]
 [ 8.33186785e-02 -2.91703281e-02  1.62234828e-01]
 [ 1.28331534e-01 -9.85628660e-02 -6.62305494e-02]
 [-3.40029570e-02 -7.71933731e-02  1.24448911e-01]
 [-6.97489850e-03 -3.70972623e-02 -1.08735728e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.27930914 -29.29219478 -29.25560936]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  8.31647217  -9.26300532 -83.45811031]
init_Out:  [2.54002979]
Stock Position:  8.316472170547405
Bond position:  [-829.10718727]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-5.44504002]
curr_Stock_Price:  99.08970866459075
curr_Factors:  [99.08970866 -0.6132669  -1.01276608]
mat_Sqrt:  [[19.49177549  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0007969   0.02186419  0.44987788]
Stock Position:  -0.0007968959285378243
Bond Position:  [-5.36607584]


portfolio before change:  [-5.44733618]
curr_Stock_Price:  98.60338274240466
curr_Factors:  [98.60338274 -0.71777872 -1.02148086]
mat_Sqrt:  [[17.3197245   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.03139424  0.02336763 -0.85818817]
Stock Position:  0.0313942365000431
Bond Position:  [-8.5429141]


portfolio before change:  [-5.47006464]
curr_Stock_Price:  98.01550630666395
curr_Factors:  [ 9.80155063e+01 -6.26998406e-02 -9.54197864e-01]
mat_Sqrt:  [[35.4537131   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00473091 -0.02515823 -0.579543  ]
Stock Position:  0.004730913857486366
Bond Position:  [-5.93376755]


portfolio before change:  [-5.48033356]
curr_Stock_Price:  96.47218892006627
curr_Factors:  [96.47218892 -0.31559259 -0.94941166]
mat_Sqrt:  [[27.22812712  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00642039  0.09562936  1.12821719]
Stock Position:  -0.006420387914857202
Bond Position:  [-4.86094469]


portfolio before change:  [-5.45858633]
curr_Stock_Price:  92.70632373247155
curr_Factors:  [92.70632373 -0.53807824 -0.88869561]
mat_Sqrt:  [[22.25713952  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0054101   0.05493515 -0.17743048]
Stock Position:  0.005410101299436544
Bond Position:  [-5.96013693]


portfolio before change:  [-5.45349171]
curr_Stock_Price:  94.19898180940712
curr_Factors:  [94.19898181 -0.85261272 -0.89849694]
mat_Sqrt:  [[16.35117411  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00707482 -0.00922447  0.46281081]
Stock Position:  0.007074816072340541
Bond Position:  [-6.11993218]


portfolio before change:  [-5.46477356]
curr_Stock_Price:  93.03695572466226
curr_Factors:  [93.03695572 -0.87093345 -0.80909719]
mat_Sqrt:  [[17.33913608  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0064748  -0.03116831 -0.18893732]
Stock Position:  0.00647479765858971
Bond Position:  [-6.06716903]


portfolio before change:  [-5.48280949]
curr_Stock_Price:  90.72003552083467
curr_Factors:  [90.72003552 -1.06629166 -0.84051476]
mat_Sqrt:  [[13.47682863  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00078602 -0.02441069  0.3550181 ]
Stock Position:  -0.0007860197725962167
Bond Position:  [-5.41150175]


portfolio before change:  [-5.48567612]
curr_Stock_Price:  90.9238438066788
curr_Factors:  [90.92384381 -1.16307691 -0.88139882]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-5.48567612]
Stock Price:  93.16989213438026
PL:  [-5.48567612]
Settle:  Tensor("sub_262:0", shape=(), dtype=float64)
PL:  Tensor("sub_263:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  132
output_Z_Vals[:, i, :]:  [[ 1.19279309e+02 -2.92921948e+01 -2.92556094e+01]
 [-7.04779654e-02 -1.14653620e-01 -1.72427800e-03]
 [ 2.94619018e-01  6.88167970e-02 -2.07588805e-01]
 [ 1.83235594e-01 -6.20149100e-02 -2.11526469e-01]
 [-3.48519256e-01  4.18213829e-01  5.25176108e-01]
 [ 1.24089191e-01  1.05872304e-01 -6.34638343e-02]
 [-5.30512344e-02 -6.75377489e-02  2.33515624e-01]
 [ 1.32338650e-01 -8.95814694e-02 -5.50131004e-02]
 [-2.35660055e-02 -7.79494709e-02  1.23722076e-01]
 [-3.21007512e-03 -1.50069265e-02  8.35502237e-03]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.27930914 -29.29219478 -29.25560936]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  8.31647217  -9.26300532 -83.45811031]
init_Out:  [2.54002979]
Stock Position:  8.316472170547405
Bond position:  [-829.10718727]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [3.37891647]
curr_Stock_Price:  100.15073025031927
curr_Factors:  [100.15073025  -1.25828803  -0.9835739 ]
mat_Sqrt:  [[10.64206372  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00693383 -0.03625666 -0.00491889]
Stock Position:  -0.006933831428439259
Bond Position:  [4.07334475]


portfolio before change:  [3.38195471]
curr_Stock_Price:  100.0063565245491
curr_Factors:  [100.00635652  -0.62903462  -0.94044589]
mat_Sqrt:  [[20.81665175  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01220283  0.02176178 -0.59219308]
Stock Position:  0.012202825670685643
Bond Position:  [2.16159458]


portfolio before change:  [3.36977279]
curr_Stock_Price:  98.91947813502381
curr_Factors:  [98.91947814 -0.37464192 -0.94344144]
mat_Sqrt:  [[26.47558023  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0052296  -0.01961084 -0.60342614]
Stock Position:  0.005229600822058904
Bond Position:  [2.85246341]


portfolio before change:  [3.35167482]
curr_Stock_Price:  95.18600740949384
curr_Factors:  [95.18600741  0.1592805  -0.92866722]
mat_Sqrt:  [[44.0994023   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00522728  0.13225082  1.49818125]
Stock Position:  -0.005227279399493457
Bond Position:  [3.84923868]


portfolio before change:  [3.37378619]
curr_Stock_Price:  91.32429061151696
curr_Factors:  [91.32429061  0.25897342 -0.9956644 ]
mat_Sqrt:  [[43.71650958  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0026047   0.03347976 -0.18104465]
Stock Position:  0.0026046979189814
Bond Position:  [3.135914]


portfolio before change:  [3.38179395]
curr_Stock_Price:  93.79652044629051
curr_Factors:  [93.79652045 -0.63677111 -1.00550911]
mat_Sqrt:  [[18.15321238  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-3.92705943e-04 -2.13573115e-02  6.66155078e-01]
Stock Position:  -0.0003927059433683656
Bond Position:  [3.41862841]


portfolio before change:  [3.38468035]
curr_Stock_Price:  90.80024559828878
curr_Factors:  [90.8002456  -0.26501234 -1.03112491]
mat_Sqrt:  [[24.84172601  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00478212 -0.02832815 -0.15693706]
Stock Position:  0.004782121978310336
Bond Position:  [2.9504625]


portfolio before change:  [3.38775381]
curr_Stock_Price:  91.13437664866126
curr_Factors:  [ 9.11343766e+01  4.16913584e-02 -1.01444801e+00]
mat_Sqrt:  [[34.45239217  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-9.40396748e-06 -2.46497870e-02  3.52944646e-01]
Stock Position:  -9.403967476797067e-06
Bond Position:  [3.38861083]


portfolio before change:  [3.38937764]
curr_Stock_Price:  98.67379405882143
curr_Factors:  [98.67379406 -0.51030164 -1.02748833]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [3.38937764]
Stock Price:  96.40294886470525
PL:  [3.38937764]
Settle:  Tensor("sub_264:0", shape=(), dtype=float64)
PL:  Tensor("sub_265:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  133
output_Z_Vals[:, i, :]:  [[ 1.19279309e+02 -2.92921948e+01 -2.92556094e+01]
 [ 3.54993443e-02  1.42918440e-01  3.06465489e-01]
 [ 7.10901093e-01  7.80196250e-02 -3.15658443e-01]
 [ 5.68408912e-01 -5.26894638e-01  2.36178467e-01]
 [-5.63084746e-01  8.25026817e-01  8.90699052e-01]
 [ 2.07151176e-01  3.74568210e-01 -1.53723194e-01]
 [-1.80258868e-01 -1.03327380e-01  3.00007281e-01]
 [ 1.27084123e-01 -1.01358766e-01 -6.97225302e-02]
 [-8.66419059e-02 -7.33799809e-02  1.28114714e-01]
 [-8.13466828e-03 -5.42105903e-02 -5.91661231e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.27930914 -29.29219478 -29.25560936]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  8.31647217  -9.26300532 -83.45811031]
init_Out:  [2.54002979]
Stock Position:  8.316472170547405
Bond position:  [-829.10718727]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-28.09638803]
curr_Stock_Price:  96.36603598921705
curr_Factors:  [96.36603599 -0.67057934 -0.92346654]
mat_Sqrt:  [[19.57215585  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00519853 0.04519478 0.87426074]
Stock Position:  0.005198532520359557
Bond Position:  [-28.59735]


portfolio before change:  [-28.10319279]
curr_Stock_Price:  97.80826807529985
curr_Factors:  [97.80826808 -0.36638692 -0.94361364]
mat_Sqrt:  [[26.39061787  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.02457245  0.02467197 -0.90048567]
Stock Position:  0.024572446352174423
Bond Position:  [-30.50658121]


portfolio before change:  [-28.27256825]
curr_Stock_Price:  91.53626921057794
curr_Factors:  [91.53626921 -0.13583167 -0.89963667]
mat_Sqrt:  [[32.50087249  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01855379 -0.16661871  0.67375143]
Stock Position:  0.018553787400684623
Bond Position:  [-29.97091273]


portfolio before change:  [-28.3473114]
curr_Stock_Price:  88.31568937366667
curr_Factors:  [88.31568937 -0.37602248 -0.86241049]
mat_Sqrt:  [[25.59724692  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01406282  0.26089639  2.54091647]
Stock Position:  -0.014062819454941389
Bond Position:  [-27.10534381]


portfolio before change:  [-28.36068626]
curr_Stock_Price:  88.3028038790337
curr_Factors:  [88.30280388  0.0969479  -0.85300794]
mat_Sqrt:  [[41.45928357  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00447292  0.11844887 -0.43852948]
Stock Position:  0.0044729154410736655
Bond Position:  [-28.75565723]


portfolio before change:  [-28.3433011]
curr_Stock_Price:  95.40478962469471
curr_Factors:  [95.40478962 -0.3370352  -0.87069185]
mat_Sqrt:  [[28.51418627  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00426763 -0.03267499  0.85583727]
Stock Position:  -0.004267631514175886
Bond Position:  [-27.93614861]


portfolio before change:  [-28.34944001]
curr_Stock_Price:  93.56942524365417
curr_Factors:  [93.56942524 -0.6598782  -0.88743624]
mat_Sqrt:  [[19.91332761  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00553574 -0.03205246 -0.19889897]
Stock Position:  0.0055357397498203495
Bond Position:  [-28.867416]


portfolio before change:  [-28.38396982]
curr_Stock_Price:  89.9398306405531
curr_Factors:  [89.93983064 -0.49178267 -0.80369081]
mat_Sqrt:  [[24.62266651  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00253365 -0.02320479  0.36547562]
Stock Position:  -0.0025336517577858515
Bond Position:  [-28.15609361]


portfolio before change:  [-28.40372118]
curr_Stock_Price:  92.17762822468234
curr_Factors:  [92.17762822 -0.36899582 -0.84582226]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-28.40372118]
Stock Price:  89.38008417752226
PL:  [-28.40372118]
Settle:  Tensor("sub_266:0", shape=(), dtype=float64)
PL:  Tensor("sub_267:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  134
output_Z_Vals[:, i, :]:  [[ 1.19279309e+02 -2.92921948e+01 -2.92556094e+01]
 [-4.88455762e-02  7.49534265e-02  1.62743377e-01]
 [ 3.80479961e-01  7.03718542e-02 -2.32459621e-01]
 [-6.24945226e-02  1.04854846e-01 -2.03513632e-01]
 [-1.38462035e-01  1.32127410e-01  2.05158445e-01]
 [ 6.81401631e-02  9.86734166e-03  7.00883547e-03]
 [ 7.36881389e-02  2.35691064e-02 -1.65984228e-01]
 [ 3.39376346e-02 -9.05685000e-02  3.38125070e-02]
 [ 1.08973119e-01 -9.13168340e-02  7.36632230e-02]
 [-7.87206343e-03 -5.03356464e-02 -7.03900904e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.27930914 -29.29219478 -29.25560936]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  8.31647217  -9.26300532 -83.45811031]
init_Out:  [2.54002979]
Stock Position:  8.316472170547405
Bond position:  [-829.10718727]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-7.70907462]
curr_Stock_Price:  98.8174736886536
curr_Factors:  [98.81747369 -0.5241053  -0.94791976]
mat_Sqrt:  [[22.67469147  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00060378  0.02370235  0.46426156]
Stock Position:  -0.0006037759910545488
Bond Position:  [-7.649411]


portfolio before change:  [-7.71341748]
curr_Stock_Price:  99.67407805785966
curr_Factors:  [99.67407806 -0.70236061 -0.89103524]
mat_Sqrt:  [[20.25719015  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01652975  0.02225353 -0.66314259]
Stock Position:  0.01652975218617424
Bond Position:  [-9.36100529]


portfolio before change:  [-7.69978257]
curr_Stock_Price:  100.78217622713159
curr_Factors:  [100.78217623  -0.74306554  -0.90954204]
mat_Sqrt:  [[19.30480316  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00524891  0.03315801 -0.58056774]
Stock Position:  -0.005248912789456118
Bond Position:  [-7.17078571]


portfolio before change:  [-7.691782]
curr_Stock_Price:  98.57469815372139
curr_Factors:  [98.57469815 -0.81320072 -0.8915686 ]
mat_Sqrt:  [[17.92229187  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00519871  0.04178236  0.58525994]
Stock Position:  -0.005198706090577329
Bond Position:  [-7.17932111]


portfolio before change:  [-7.70307199]
curr_Stock_Price:  100.05572700889427
curr_Factors:  [100.05572701  -1.37119165  -0.88096679]
mat_Sqrt:  [[10.52305819  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00663549 0.00312033 0.01999426]
Stock Position:  0.006635486387343633
Bond Position:  [-8.3669904]


portfolio before change:  [-7.71035636]
curr_Stock_Price:  99.58856724614513
curr_Factors:  [99.58856725 -1.04567553 -0.8679232 ]
mat_Sqrt:  [[14.69413805  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00275044  0.00745321 -0.4735068 ]
Stock Position:  0.0027504370605691167
Bond Position:  [-7.98426845]


portfolio before change:  [-7.72126806]
curr_Stock_Price:  97.07312528659158
curr_Factors:  [97.07312529 -0.57541396 -0.86227961]
mat_Sqrt:  [[23.05242545  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00167015 -0.02864027  0.09645767]
Stock Position:  0.001670154627886532
Bond Position:  [-7.88339519]


portfolio before change:  [-7.72609868]
curr_Stock_Price:  96.54147457191478
curr_Factors:  [96.54147457 -0.32803845 -0.81212831]
mat_Sqrt:  [[30.87065176  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00394069 -0.02887692  0.21014067]
Stock Position:  0.003940693299392131
Bond Position:  [-8.10653902]


portfolio before change:  [-7.74883636]
curr_Stock_Price:  91.80033118136913
curr_Factors:  [91.80033118 -0.33748453 -0.8439156 ]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-7.74883636]
Stock Price:  92.05856640162189
PL:  [-7.74883636]
Settle:  Tensor("sub_268:0", shape=(), dtype=float64)
PL:  Tensor("sub_269:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  135
output_Z_Vals[:, i, :]:  [[ 1.19279309e+02 -2.92921948e+01 -2.92556094e+01]
 [-7.04779654e-02 -1.14653620e-01 -1.72427800e-03]
 [ 3.17527337e-01  6.72597962e-02 -2.29057350e-01]
 [-6.63286767e-02  1.06880019e-01 -2.07012191e-01]
 [-3.78671003e-02 -3.86932574e-03  5.22410228e-02]
 [ 3.88466530e-02 -7.42106708e-02  3.60530874e-02]
 [ 8.36884997e-02  7.42113620e-03 -1.54108973e-01]
 [-1.52046583e-01 -2.17391451e-02 -2.41659411e-02]
 [ 4.52959857e-02 -8.49978409e-02  3.09185400e-02]
 [ 2.88840324e-03  2.46055262e-02  1.31264548e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.27930914 -29.29219478 -29.25560936]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  8.31647217  -9.26300532 -83.45811031]
init_Out:  [2.54002979]
Stock Position:  8.316472170547405
Bond position:  [-829.10718727]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [11.11195327]
curr_Stock_Price:  101.08057606079836
curr_Factors:  [101.08057606  -1.29360164  -1.03300036]
mat_Sqrt:  [[ 9.86818533  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00747759 -0.03625666 -0.00491889]
Stock Position:  -0.0074775932335271935
Bond Position:  [11.86779271]


portfolio before change:  [11.12544081]
curr_Stock_Price:  100.07060434870533
curr_Factors:  [100.07060435  -0.87218221  -1.10463361]
mat_Sqrt:  [[13.86073694  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01966042  0.02126942 -0.65343686]
Stock Position:  0.019660415101207314
Bond Position:  [9.15801119]


portfolio before change:  [11.14300305]
curr_Stock_Price:  100.7309201726208
curr_Factors:  [100.73092017  -0.98646861  -1.10020378]
mat_Sqrt:  [[12.50064712  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00846558  0.03379843 -0.59054816]
Stock Position:  -0.00846558038571425
Bond Position:  [11.99574875]


portfolio before change:  [11.15241579]
curr_Stock_Price:  100.32771411152373
curr_Factors:  [100.32771411  -1.10699285  -1.11608567]
mat_Sqrt:  [[10.86301004  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00251342 -0.00122359  0.1490291 ]
Stock Position:  -0.0025134241480636553
Bond Position:  [11.40458189]


portfolio before change:  [11.15743199]
curr_Stock_Price:  100.60125381250626
curr_Factors:  [100.60125381  -1.16004899  -1.15885691]
mat_Sqrt:  [[ 9.8972686   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00447496 -0.02346747  0.10284942]
Stock Position:  0.004474956594203975
Bond Position:  [10.70724574]


portfolio before change:  [11.16448346]
curr_Stock_Price:  100.98036675450301
curr_Factors:  [100.98036675  -0.89930263  -1.14646051]
mat_Sqrt:  [[13.05489257  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00401556  0.00234677 -0.43963   ]
Stock Position:  0.004015563509967962
Bond Position:  [10.75899039]


portfolio before change:  [11.16746524]
curr_Stock_Price:  100.3829239542108
curr_Factors:  [100.38292395  -0.56852905  -1.20538153]
mat_Sqrt:  [[17.03178893  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00924981 -0.00687452 -0.0689387 ]
Stock Position:  -0.009249805626963334
Bond Position:  [12.09598777]


portfolio before change:  [11.19879314]
curr_Stock_Price:  97.6500662230833
curr_Factors:  [97.65006622 -0.59184944 -1.22751998]
mat_Sqrt:  [[15.83180545  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0031211  -0.02687868  0.08820199]
Stock Position:  0.0031210951676270463
Bond Position:  [10.89401799]


portfolio before change:  [11.20573997]
curr_Stock_Price:  98.1301717773222
curr_Factors:  [ 9.81301718e+01 -8.29361817e-03 -1.27901329e+00]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [11.20573997]
Stock Price:  97.15207016952608
PL:  [11.20573997]
Settle:  Tensor("sub_270:0", shape=(), dtype=float64)
PL:  Tensor("sub_271:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  136
output_Z_Vals[:, i, :]:  [[ 1.19279309e+02 -2.92921948e+01 -2.92556094e+01]
 [-7.04779654e-02 -1.14653620e-01 -1.72427800e-03]
 [ 1.26433405e-01  2.80654222e-02 -1.40264219e-03]
 [-5.07080396e-02  1.10024602e-01 -1.23054142e-01]
 [ 3.06287717e-02 -5.82093903e-02 -3.94942616e-02]
 [ 8.72167116e-02  1.48089226e-01 -1.19600672e-02]
 [ 7.14479070e-02  3.07597756e-02 -2.38347861e-01]
 [-2.14391669e-01  5.10309224e-02 -1.58828687e-01]
 [-4.23104666e-02  1.53642372e-02 -1.16614279e-01]
 [ 6.98658998e-02  3.55488156e-01 -2.02092573e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.27930914 -29.29219478 -29.25560936]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  8.31647217  -9.26300532 -83.45811031]
init_Out:  [2.54002979]
Stock Position:  8.316472170547405
Bond position:  [-829.10718727]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [5.72548932]
curr_Stock_Price:  100.43288989730846
curr_Factors:  [100.4328899   -1.0313191   -1.01530422]
mat_Sqrt:  [[12.97295007  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00568801 -0.03625666 -0.00491889]
Stock Position:  -0.0056880104762808545
Bond Position:  [6.29675265]


portfolio before change:  [5.72354699]
curr_Stock_Price:  101.32801818218408
curr_Factors:  [101.32801818  -0.5442043   -1.04190634]
mat_Sqrt:  [[20.74390189  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0061161   0.00887507 -0.00400135]
Stock Position:  0.0061160980376483865
Bond Position:  [5.10381489]


portfolio before change:  [5.7304294]
curr_Stock_Price:  102.03596497364624
curr_Factors:  [102.03596497  -0.75003312  -1.02600532]
mat_Sqrt:  [[17.27545846  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00422481  0.03479283 -0.35103921]
Stock Position:  -0.004224810490836857
Bond Position:  [6.16151202]


portfolio before change:  [5.72710992]
curr_Stock_Price:  103.55106511333393
curr_Factors:  [103.55106511  -1.20894711  -1.01236114]
mat_Sqrt:  [[11.23188513  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00187538 -0.01840743 -0.11266614]
Stock Position:  0.0018753823638353287
Bond Position:  [5.53291208]


portfolio before change:  [5.73005063]
curr_Stock_Price:  103.64361220749392
curr_Factors:  [103.64361221  -1.35601489  -0.97235649]
mat_Sqrt:  [[10.10051924  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00877173  0.04682993 -0.03411874]
Stock Position:  0.008771729296272639
Bond Position:  [4.82091692]


portfolio before change:  [5.72063233]
curr_Stock_Price:  102.29503450335059
curr_Factors:  [102.2950345   -1.52802606  -0.95561946]
mat_Sqrt:  [[ 8.5353436   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00276375  0.0097271  -0.6799401 ]
Stock Position:  0.002763751370110795
Bond Position:  [5.43791429]


portfolio before change:  [5.72595064]
curr_Stock_Price:  103.2353053452552
curr_Factors:  [103.23530535  -1.4799088   -0.96135154]
mat_Sqrt:  [[ 8.98674358  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02731744  0.01613739 -0.45309403]
Stock Position:  -0.02731743978191136
Bond Position:  [8.54607488]


portfolio before change:  [5.72884327]
curr_Stock_Price:  103.28587660347466
curr_Factors:  [103.2858766   -0.97183273  -1.00071796]
mat_Sqrt:  [[14.36723054  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00457413  0.0048586  -0.33266808]
Stock Position:  -0.0045741281543141615
Bond Position:  [6.20128611]


portfolio before change:  [5.73596549]
curr_Stock_Price:  102.40684506085846
curr_Factors:  [ 1.02406845e+02 -8.60183212e-02 -9.87510950e-01]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [5.73596549]
Stock Price:  103.41354694681499
PL:  [2.32241854]
Settle:  Tensor("sub_272:0", shape=(), dtype=float64)
PL:  Tensor("sub_273:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  137
output_Z_Vals[:, i, :]:  [[ 1.19279309e+02 -2.92921948e+01 -2.92556094e+01]
 [-5.91244386e-02 -1.86908529e-02  8.17336510e-02]
 [ 4.60203959e-01  7.23078232e-02 -2.51851461e-01]
 [-6.03090144e-02  1.07730298e-01 -1.76278229e-01]
 [-1.31842173e-01  1.23293519e-01  1.95134406e-01]
 [ 4.29394972e-02 -8.26010066e-02  3.12381089e-02]
 [ 8.06634822e-02 -9.41827914e-03 -9.77064460e-02]
 [-9.20197639e-03 -9.99361712e-02  7.46251169e-02]
 [-9.21131020e-02 -5.42244239e-02 -7.31376608e-02]
 [ 3.16464962e-02  1.82018915e-01  9.25042074e-03]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.27930914 -29.29219478 -29.25560936]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  8.31647217  -9.26300532 -83.45811031]
init_Out:  [2.54002979]
Stock Position:  8.316472170547405
Bond position:  [-829.10718727]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [6.62665475]
curr_Stock_Price:  100.54124899642629
curr_Factors:  [100.541249    -0.71805863  -1.02474485]
mat_Sqrt:  [[17.59763648  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00243915 -0.00591057  0.23316336]
Stock Position:  -0.002439147028380841
Bond Position:  [6.87188964]


portfolio before change:  [6.63368505]
curr_Stock_Price:  99.06798973890992
curr_Factors:  [99.06798974 -0.47142076 -1.02306203]
mat_Sqrt:  [[22.22735176  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01847552  0.02286574 -0.71846212]
Stock Position:  0.018475524189983876
Bond Position:  [4.80335201]


portfolio before change:  [6.67551233]
curr_Stock_Price:  101.20189394205923
curr_Factors:  [101.20189394  -0.78938077  -1.00872133]
mat_Sqrt:  [[16.76033975  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00557925  0.03406731 -0.50287272]
Stock Position:  -0.005579246862979732
Bond Position:  [7.24014268]


portfolio before change:  [6.69132956]
curr_Stock_Price:  99.01589063728706
curr_Factors:  [99.01589064 -0.49471541 -1.09798951]
mat_Sqrt:  [[20.13733236  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00441107  0.03898883  0.55666414]
Stock Position:  -0.004411066113089225
Bond Position:  [7.1280952]


portfolio before change:  [6.70583595]
curr_Stock_Price:  96.53543480102498
curr_Factors:  [96.5354348  -0.54069527 -1.11796999]
mat_Sqrt:  [[18.37966494  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00256714 -0.02612073  0.08911363]
Stock Position:  0.002567141500994995
Bond Position:  [6.45801583]


portfolio before change:  [6.71452873]
curr_Stock_Price:  98.66346773957451
curr_Factors:  [98.66346774 -1.0703321  -1.11272732]
mat_Sqrt:  [[11.11899972  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00543898 -0.00297832 -0.27872929]
Stock Position:  0.005438983720049869
Bond Position:  [6.17789973]


portfolio before change:  [6.71376298]
curr_Stock_Price:  97.9546084832436
curr_Factors:  [97.95460848 -0.33242909 -1.0976769 ]
mat_Sqrt:  [[23.43892722  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 1.47211131e-04 -3.16025921e-02  2.12884687e-01]
Stock Position:  0.00014721113059307345
Bond Position:  [6.69934297]


portfolio before change:  [6.71728741]
curr_Stock_Price:  99.1360901682032
curr_Factors:  [99.13609017 -0.6392197  -1.00494223]
mat_Sqrt:  [[19.15055365  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00566262 -0.01714727 -0.20864139]
Stock Position:  -0.005662621303526693
Bond Position:  [7.27865755]


portfolio before change:  [6.71035163]
curr_Stock_Price:  101.00378025329888
curr_Factors:  [101.00378025  -0.47468491  -1.00739776]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [6.71035163]
Stock Price:  99.5726434076296
PL:  [6.71035163]
Settle:  Tensor("sub_274:0", shape=(), dtype=float64)
PL:  Tensor("sub_275:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  138
output_Z_Vals[:, i, :]:  [[ 1.19279309e+02 -2.92921948e+01 -2.92556094e+01]
 [-5.47390906e-02  2.32970025e-02  1.17935913e-01]
 [ 8.45894433e-01  7.89985730e-02 -3.65788254e-01]
 [ 4.18366036e-01 -3.02000797e-01 -6.10526210e-02]
 [-3.46928271e-01  4.16182612e-01  5.22797865e-01]
 [ 6.71387121e-02 -1.39204142e-02  2.49863898e-03]
 [-3.41710865e-01 -1.48751598e-01  3.84398528e-01]
 [ 1.25235660e-01 -1.05501842e-01 -7.48970871e-02]
 [ 9.40599045e-02 -8.64707985e-02  1.15530547e-01]
 [-7.26984225e-03 -4.14493926e-02 -9.61295661e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.27930914 -29.29219478 -29.25560936]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  8.31647217  -9.26300532 -83.45811031]
init_Out:  [2.54002979]
Stock Position:  8.316472170547405
Bond position:  [-829.10718727]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-11.29648303]
curr_Stock_Price:  98.3861118878486
curr_Factors:  [98.38611189 -0.78426007 -1.02823159]
mat_Sqrt:  [[16.0612252   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00187184  0.00736716  0.33643833]
Stock Position:  -0.0018718371010638605
Bond Position:  [-11.11232026]


portfolio before change:  [-11.30013121]
curr_Stock_Price:  97.36605683220031
curr_Factors:  [97.36605683 -0.61651284 -1.0264506 ]
mat_Sqrt:  [[18.8311841   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.04106316  0.02498154 -1.04349207]
Stock Position:  0.04106316140923628
Bond Position:  [-15.29828931]


portfolio before change:  [-11.44918041]
curr_Stock_Price:  93.92262629390322
curr_Factors:  [93.92262629  0.16886764 -1.0037573 ]
mat_Sqrt:  [[40.75512728  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00976825 -0.09550104 -0.17416613]
Stock Position:  0.009768245662735884
Bond Position:  [-12.36663969]


portfolio before change:  [-11.44281318]
curr_Stock_Price:  95.20761572166693
curr_Factors:  [95.20761572  0.15418714 -0.9790746 ]
mat_Sqrt:  [[41.72800433  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00549911  0.1316085   1.49139679]
Stock Position:  -0.005499108311594389
Bond Position:  [-10.91925619]


portfolio before change:  [-11.44269995]
curr_Stock_Price:  94.19395514457513
curr_Factors:  [ 9.41939551e+01  3.98664002e-02 -9.63585769e-01]
mat_Sqrt:  [[37.39872603  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00179924 -0.00440202  0.00712792]
Stock Position:  0.0017992409961260648
Bond Position:  [-11.61217757]


portfolio before change:  [-11.45174288]
curr_Stock_Price:  92.39575576337468
curr_Factors:  [92.39575576 -0.25106463 -0.94873144]
mat_Sqrt:  [[27.83474258  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00959544 -0.04703939  1.096582  ]
Stock Position:  -0.009595439699015334
Bond Position:  [-10.56516498]


portfolio before change:  [-11.47677062]
curr_Stock_Price:  94.45338271348596
curr_Factors:  [94.45338271 -0.64226156 -0.90927906]
mat_Sqrt:  [[20.01667721  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0053567  -0.03336261 -0.21366054]
Stock Position:  0.005356698749281048
Bond Position:  [-11.98272894]


portfolio before change:  [-11.49317603]
curr_Stock_Price:  92.50954488259124
curr_Factors:  [92.50954488 -0.48104173 -0.88759681]
mat_Sqrt:  [[23.5393453   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00490285 -0.02734447  0.32957649]
Stock Position:  0.004902847160576069
Bond Position:  [-11.94673619]


portfolio before change:  [-11.50785928]
curr_Stock_Price:  90.73335585243791
curr_Factors:  [90.73335585  0.26791851 -0.84870441]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-11.50785928]
Stock Price:  87.27975999533602
PL:  [-11.50785928]
Settle:  Tensor("sub_276:0", shape=(), dtype=float64)
PL:  Tensor("sub_277:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  139
output_Z_Vals[:, i, :]:  [[ 1.19279309e+02 -2.92921948e+01 -2.92556094e+01]
 [-7.04779654e-02 -1.14653620e-01 -1.72427800e-03]
 [ 1.82184628e-01  3.77408330e-02 -4.88113154e-02]
 [-5.56348154e-02  1.08390531e-01 -1.52413659e-01]
 [-1.28693277e-02 -2.60079071e-02  1.81241280e-02]
 [ 4.29027519e-02 -5.75097837e-02  3.20281878e-02]
 [ 9.19235653e-02  7.58085285e-04 -1.43772459e-01]
 [-1.84256723e-01  2.14693112e-02 -1.23414041e-01]
 [-1.34789492e-01 -3.07645772e-02 -1.18899866e-01]
 [-5.89815468e-03 -3.19677297e-02  7.15145236e-03]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.27930914 -29.29219478 -29.25560936]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  8.31647217  -9.26300532 -83.45811031]
init_Out:  [2.54002979]
Stock Position:  8.316472170547405
Bond position:  [-829.10718727]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [13.80072744]
curr_Stock_Price:  101.40388312043723
curr_Factors:  [101.40388312  -1.22656296  -1.00819197]
mat_Sqrt:  [[10.85207664  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00679965 -0.03625666 -0.00491889]
Stock Position:  -0.006799645662867741
Bond Position:  [14.49023791]


portfolio before change:  [13.80879658]
curr_Stock_Price:  101.28296332206591
curr_Factors:  [101.28296332  -0.91121463  -1.04379705]
mat_Sqrt:  [[14.33790223  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01207956  0.0119347  -0.1392451 ]
Stock Position:  0.01207955815298926
Bond Position:  [12.58534314]


portfolio before change:  [13.82000489]
curr_Stock_Price:  101.6897715895067
curr_Factors:  [101.68977159  -0.89131341  -1.00626535]
mat_Sqrt:  [[15.24646947  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00550603  0.0342761  -0.43479375]
Stock Position:  -0.00550602826858796
Bond Position:  [14.37991165]


portfolio before change:  [13.83116694]
curr_Stock_Price:  100.96869031855354
curr_Factors:  [100.96869032  -0.53463299  -0.9595964 ]
mat_Sqrt:  [[22.65954283  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00043431 -0.00822442  0.05170309]
Stock Position:  -0.000434310475363947
Bond Position:  [13.8750187]


portfolio before change:  [13.83809191]
curr_Stock_Price:  101.00155819603911
curr_Factors:  [101.0015582   -0.72941547  -1.00352714]
mat_Sqrt:  [[17.85338876  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00268608 -0.01818619  0.0913675 ]
Stock Position:  0.0026860772928360586
Bond Position:  [13.56679391]


portfolio before change:  [13.85201746]
curr_Stock_Price:  103.65988252988122
curr_Factors:  [103.65988253  -0.93539257  -1.01114838]
mat_Sqrt:  [[14.79921629  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 4.22966375e-03  2.39727616e-04 -4.10142807e-01]
Stock Position:  0.004229663752445253
Bond Position:  [13.41357102]


portfolio before change:  [13.8581185]
curr_Stock_Price:  103.51627080306739
curr_Factors:  [103.5162708   -0.58360267  -1.04596721]
mat_Sqrt:  [[20.29062445  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01029511  0.00678919 -0.35206591]
Stock Position:  -0.010295108179960466
Bond Position:  [14.9238297]


portfolio before change:  [13.90070811]
curr_Stock_Price:  100.10437590445802
curr_Factors:  [100.1043759   -0.38977618  -1.04466802]
mat_Sqrt:  [[23.84964184  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00670258 -0.00972861 -0.33918822]
Stock Position:  -0.006702581302448145
Bond Position:  [14.57166582]


portfolio before change:  [13.92121598]
curr_Stock_Price:  98.13196864816845
curr_Factors:  [98.13196865 -0.16612735 -1.01609899]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [13.92121598]
Stock Price:  98.14057256353523
PL:  [13.92121598]
Settle:  Tensor("sub_278:0", shape=(), dtype=float64)
PL:  Tensor("sub_279:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  140
output_Z_Vals[:, i, :]:  [[ 1.19279309e+02 -2.92921948e+01 -2.92556094e+01]
 [-4.37548572e-02  1.19573380e-01  2.01447313e-01]
 [ 1.28812091e+00  8.83809464e-02 -4.83557033e-01]
 [ 2.72834434e-01 -1.15494406e-01 -1.68316434e-01]
 [-2.73198199e-01  3.15943598e-01  4.10531283e-01]
 [ 2.08810417e-01  4.00315598e-01 -1.51425081e-01]
 [-1.58680184e-02 -5.70763204e-02  2.14079891e-01]
 [ 1.27161449e-01 -1.01185452e-01 -6.95060666e-02]
 [ 1.32815346e-01 -9.15504298e-02  8.81974524e-02]
 [-1.34989312e-02 -8.89261441e-02 -2.26795132e-03]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.27930914 -29.29219478 -29.25560936]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  8.31647217  -9.26300532 -83.45811031]
init_Out:  [2.54002979]
Stock Position:  8.316472170547405
Bond position:  [-829.10718727]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-10.89438114]
curr_Stock_Price:  98.43446194354884
curr_Factors:  [98.43446194 -0.32879077 -0.99194795]
mat_Sqrt:  [[26.27590197  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [1.72315624e-05 3.78124227e-02 5.74673113e-01]
Stock Position:  1.7231562364535705e-05
Bond Position:  [-10.89607732]


portfolio before change:  [-10.89988639]
curr_Stock_Price:  95.19374328753302
curr_Factors:  [95.19374329 -0.50614481 -0.95202034]
mat_Sqrt:  [[22.14804122  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.05380599  0.02794851 -1.37945362]
Stock Position:  0.05380598750063577
Bond Position:  [-16.02187975]


portfolio before change:  [-10.78052949]
curr_Stock_Price:  97.560949030408
curr_Factors:  [97.56094903 -0.47409219 -0.95408343]
mat_Sqrt:  [[23.38983861  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01006826 -0.03652254 -0.48015994]
Stock Position:  0.010068258161538297
Bond Position:  [-11.76279831]


portfolio before change:  [-10.80164792]
curr_Stock_Price:  96.04772143534059
curr_Factors:  [96.04772144 -0.53451735 -0.89104165]
mat_Sqrt:  [[23.08738047  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00785023  0.09991014  1.17113148]
Stock Position:  -0.00785022897694906
Bond Position:  [-10.04765132]


portfolio before change:  [-10.76134057]
curr_Stock_Price:  90.27305728889222
curr_Factors:  [90.27305729 -0.78923161 -0.83657136]
mat_Sqrt:  [[17.76155135  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.010598    0.12659091 -0.43197361]
Stock Position:  0.010598004756878509
Bond Position:  [-11.71805486]


portfolio before change:  [-10.75433098]
curr_Stock_Price:  91.48744427781857
curr_Factors:  [91.48744428 -0.80134501 -0.85110533]
mat_Sqrt:  [[17.52715513  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00150379 -0.01804912  0.61071034]
Stock Position:  0.001503789513564986
Bond Position:  [-10.89190884]


portfolio before change:  [-10.7567293]
curr_Stock_Price:  93.51498347059197
curr_Factors:  [93.51498347 -0.8112159  -0.87548389]
mat_Sqrt:  [[17.31238051  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00637469 -0.03199765 -0.19828146]
Stock Position:  0.006374685733130794
Bond Position:  [-11.35285794]


portfolio before change:  [-10.75816632]
curr_Stock_Price:  94.18024566872842
curr_Factors:  [94.18024567 -0.90022309 -0.84695293]
mat_Sqrt:  [[16.41235559  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0090453  -0.02895079  0.25160278]
Stock Position:  0.009045304458642307
Bond Position:  [-11.61005531]


portfolio before change:  [-10.74724572]
curr_Stock_Price:  96.02950027587072
curr_Factors:  [96.02950028 -0.76965311 -0.83737997]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-10.74724572]
Stock Price:  95.96616810841624
PL:  [-10.74724572]
Settle:  Tensor("sub_280:0", shape=(), dtype=float64)
PL:  Tensor("sub_281:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  141
output_Z_Vals[:, i, :]:  [[ 1.19279309e+02 -2.92921948e+01 -2.92556094e+01]
 [-5.88476121e-02 -2.12447479e-02  7.98249433e-02]
 [ 4.02082982e-01  7.01041208e-02 -2.43674246e-01]
 [ 6.07015840e-02  2.29787460e-02 -1.96359183e-01]
 [-1.05048885e-02 -1.74441798e-02  1.84801904e-02]
 [ 4.16648400e-02 -6.17525766e-02  3.32560182e-02]
 [ 7.21746663e-02  2.77424774e-02 -2.25015755e-01]
 [-1.69346225e-01 -2.15148287e-03 -6.16458784e-02]
 [-6.58817189e-02 -3.59642665e-02 -7.87756214e-02]
 [ 1.49898885e-02  9.24727167e-02  1.18077899e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.27930914 -29.29219478 -29.25560936]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  8.31647217  -9.26300532 -83.45811031]
init_Out:  [2.54002979]
Stock Position:  8.316472170547405
Bond position:  [-829.10718727]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [7.92594863]
curr_Stock_Price:  100.69748037129114
curr_Factors:  [100.69748037  -0.67360978  -0.99175178]
mat_Sqrt:  [[19.04413585  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00226327 -0.00671818  0.22771834]
Stock Position:  -0.0022632662962941297
Bond Position:  [8.15385385]


portfolio before change:  [7.93263229]
curr_Stock_Price:  99.54617658228838
curr_Factors:  [99.54617658 -0.70607978 -1.01958168]
mat_Sqrt:  [[17.72471792  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01998076  0.02216887 -0.6951348 ]
Stock Position:  0.01998075609325335
Bond Position:  [5.94362441]


portfolio before change:  [7.94126441]
curr_Stock_Price:  99.82942735259634
curr_Factors:  [99.82942735 -1.06289455 -1.02743242]
mat_Sqrt:  [[12.34357926  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00171856  0.00726652 -0.56015809]
Stock Position:  0.0017185649213387218
Bond Position:  [7.76970106]


portfolio before change:  [7.94689582]
curr_Stock_Price:  100.8451508054646
curr_Factors:  [100.84515081  -1.16206955  -1.06495167]
mat_Sqrt:  [[10.87607005  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00066044 -0.00551633  0.05271884]
Stock Position:  -0.0006604446415828328
Bond Position:  [8.01349846]


portfolio before change:  [7.95039376]
curr_Stock_Price:  101.61706852591621
curr_Factors:  [101.61706853  -1.30388987  -1.07133916]
mat_Sqrt:  [[ 9.44969513  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00495876 -0.01952788  0.09487016]
Stock Position:  0.004958758033107159
Bond Position:  [7.4464993]


portfolio before change:  [7.95398171]
curr_Stock_Price:  101.58959610866128
curr_Factors:  [101.58959611  -1.40931648  -1.01384379]
mat_Sqrt:  [[ 9.00500796  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00299387  0.00877294 -0.64190732]
Stock Position:  0.0029938702454555695
Bond Position:  [7.64983564]


portfolio before change:  [7.95668575]
curr_Stock_Price:  101.21488703854547
curr_Factors:  [101.21488704  -1.33619851  -0.96491813]
mat_Sqrt:  [[10.13636259  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0179537  -0.00068036 -0.17585853]
Stock Position:  -0.017953697589450843
Bond Position:  [9.77386723]


portfolio before change:  [7.95419763]
curr_Stock_Price:  101.62573730752743
curr_Factors:  [101.62573731  -1.5451078   -1.01566167]
mat_Sqrt:  [[ 7.85010844  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01055913 -0.0113729  -0.22472492]
Stock Position:  -0.010559130399595825
Bond Position:  [9.02727704]


portfolio before change:  [7.96511634]
curr_Stock_Price:  101.01925344711182
curr_Factors:  [101.01925345  -1.55848111  -1.03641105]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [7.96511634]
Stock Price:  100.79177167901561
PL:  [7.17334466]
Settle:  Tensor("sub_282:0", shape=(), dtype=float64)
PL:  Tensor("sub_283:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  142
output_Z_Vals[:, i, :]:  [[ 1.19279309e+02 -2.92921948e+01 -2.92556094e+01]
 [-7.04779654e-02 -1.14653620e-01 -1.72427800e-03]
 [ 1.56639719e-01  2.48189102e-02  3.03095400e-02]
 [-4.83185699e-02  1.31728586e-01 -1.50774269e-02]
 [ 3.39892624e-02 -9.15250397e-02 -5.01892486e-02]
 [ 8.02111435e-02  1.17214578e-01 -5.00705624e-03]
 [ 1.17619829e-01 -3.43420213e-03 -1.37382693e-01]
 [-1.67134195e-01 -4.65607181e-03 -5.68534823e-02]
 [-1.23897199e-01 -3.63474954e-02 -1.08962877e-01]
 [ 1.71448916e-02  1.11283378e-01  1.71983723e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.27930914 -29.29219478 -29.25560936]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  8.31647217  -9.26300532 -83.45811031]
init_Out:  [2.54002979]
Stock Position:  8.316472170547405
Bond position:  [-829.10718727]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [12.60589259]
curr_Stock_Price:  101.26021224403081
curr_Factors:  [101.26021224  -1.10660672  -0.98979952]
mat_Sqrt:  [[12.4446066   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0059295  -0.03625666 -0.00491889]
Stock Position:  -0.005929498476188167
Bond Position:  [13.20631487]


portfolio before change:  [12.6083856]
curr_Stock_Price:  101.95366060229915
curr_Factors:  [101.9536606   -1.3013807   -0.97363058]
mat_Sqrt:  [[10.48040287  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01559744 0.00784843 0.08646468]
Stock Position:  0.015597439487777582
Bond Position:  [11.01816955]


portfolio before change:  [12.63670395]
curr_Stock_Price:  103.41594452848149
curr_Factors:  [103.41594453  -1.17614124  -1.01420786]
mat_Sqrt:  [[11.56993651  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00414825  0.04165624 -0.0430117 ]
Stock Position:  -0.004148252606102891
Bond Position:  [13.06569941]


portfolio before change:  [12.64187558]
curr_Stock_Price:  103.74448046783733
curr_Factors:  [103.74448047  -0.8775376   -1.07316268]
mat_Sqrt:  [[14.74981705  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00144959 -0.02894276 -0.14317596]
Stock Position:  0.0014495948352516216
Bond Position:  [12.49148812]


portfolio before change:  [12.64789946]
curr_Stock_Price:  103.59035276780382
curr_Factors:  [103.59035277  -0.63412329  -1.13620272]
mat_Sqrt:  [[17.63910301  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00466098  0.0370665  -0.01428374]
Stock Position:  0.004660982465848873
Bond Position:  [12.16506665]


portfolio before change:  [12.65851229]
curr_Stock_Price:  104.56198667933793
curr_Factors:  [104.56198668  -0.51192861  -1.18445121]
mat_Sqrt:  [[19.17102931  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00466788 -0.00108599 -0.39191458]
Stock Position:  0.004667878390726635
Bond Position:  [12.17042965]


portfolio before change:  [12.64763825]
curr_Stock_Price:  100.92847794733748
curr_Factors:  [100.92847795  -0.64981645  -1.1329969 ]
mat_Sqrt:  [[16.97257439  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01053815 -0.00147238 -0.16218716]
Stock Position:  -0.010538152852834253
Bond Position:  [13.71123797]


portfolio before change:  [12.65892466]
curr_Stock_Price:  100.50818754443301
curr_Factors:  [100.50818754  -0.81561287  -1.13422042]
mat_Sqrt:  [[14.30209319  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01028364 -0.01149409 -0.31084076]
Stock Position:  -0.010283644460748826
Bond Position:  [13.69251513]


portfolio before change:  [12.66918449]
curr_Stock_Price:  100.17641284557199
curr_Factors:  [100.17641285  -0.72126333  -1.1778481 ]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [12.66918449]
Stock Price:  99.2555259923008
PL:  [12.66918449]
Settle:  Tensor("sub_284:0", shape=(), dtype=float64)
PL:  Tensor("sub_285:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  143
output_Z_Vals[:, i, :]:  [[ 1.19279309e+02 -2.92921948e+01 -2.92556094e+01]
 [-5.84820901e-02 -9.51024178e-03  8.94784761e-02]
 [ 3.34884198e-01  6.93883853e-02 -2.20438170e-01]
 [ 5.68782429e-02  2.31718875e-02 -2.11287209e-01]
 [-2.66189099e-01  3.06838381e-01  4.00001242e-01]
 [ 4.10102143e-02 -6.69720248e-02  3.39072619e-02]
 [ 8.11029497e-02  1.09329230e-03 -7.60765934e-02]
 [-6.09244141e-02 -8.15822610e-02  7.44028040e-02]
 [-1.05297281e-01 -3.21387100e-02 -1.02904699e-01]
 [ 2.38822468e-03  1.78280239e-02  8.86633648e-03]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.27930914 -29.29219478 -29.25560936]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  8.31647217  -9.26300532 -83.45811031]
init_Out:  [2.54002979]
Stock Position:  8.316472170547405
Bond position:  [-829.10718727]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-4.60326409]
curr_Stock_Price:  99.1909265746281
curr_Factors:  [99.19092657 -0.82130515 -0.99814049]
mat_Sqrt:  [[16.0803962   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00251629 -0.0030074   0.25525719]
Stock Position:  -0.002516289124129428
Bond Position:  [-4.35367104]


portfolio before change:  [-4.6068894]
curr_Stock_Price:  99.76634915895775
curr_Factors:  [99.76634916 -0.59090073 -1.01402499]
mat_Sqrt:  [[20.04350619  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0145523   0.02194253 -0.62884874]
Stock Position:  0.014552296503779838
Bond Position:  [-6.05871889]


portfolio before change:  [-4.60984018]
curr_Stock_Price:  99.77180097546757
curr_Factors:  [99.77180098 -0.40840829 -1.05137456]
mat_Sqrt:  [[23.17566345  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00061909  0.00732759 -0.6027436 ]
Stock Position:  0.0006190855166396257
Bond Position:  [-4.67160746]


portfolio before change:  [-4.61444645]
curr_Stock_Price:  96.10528789179105
curr_Factors:  [96.10528789 -0.60267483 -1.03717729]
mat_Sqrt:  [[18.64526483  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00947247  0.09703082  1.14109221]
Stock Position:  -0.009472466924911552
Bond Position:  [-3.70409229]


portfolio before change:  [-4.64788851]
curr_Stock_Price:  99.44016913808963
curr_Factors:  [99.44016914 -0.61611837 -1.00183759]
mat_Sqrt:  [[19.71934597  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00234299 -0.02117841  0.09672798]
Stock Position:  0.0023429932718081643
Bond Position:  [-4.88087616]


portfolio before change:  [-4.64740678]
curr_Stock_Price:  100.6876258233585
curr_Factors:  [100.68762582  -0.70726223  -0.94769609]
mat_Sqrt:  [[19.24140728  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00340942  0.00034573 -0.21702535]
Stock Position:  0.0034094236369328376
Bond Position:  [-4.99069355]


portfolio before change:  [-4.65564389]
curr_Stock_Price:  99.00372335241535
curr_Factors:  [99.00372335 -0.48213643 -0.95856741]
mat_Sqrt:  [[23.44022623  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00204108 -0.02579858  0.21225049]
Stock Position:  -0.002041083125169298
Bond Position:  [-4.45356906]


portfolio before change:  [-4.66228996]
curr_Stock_Price:  101.16861884102525
curr_Factors:  [101.16861884  -1.05014677  -0.95449893]
mat_Sqrt:  [[13.6282238   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00932861 -0.01016315 -0.29355846]
Stock Position:  -0.009328613526749668
Bond Position:  [-3.71852701]


portfolio before change:  [-4.64924457]
curr_Stock_Price:  99.5708335767328
curr_Factors:  [99.57083358 -0.70369063 -0.89571788]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-4.64924457]
Stock Price:  97.1712175781293
PL:  [-4.64924457]
Settle:  Tensor("sub_286:0", shape=(), dtype=float64)
PL:  Tensor("sub_287:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  144
output_Z_Vals[:, i, :]:  [[ 1.19279309e+02 -2.92921948e+01 -2.92556094e+01]
 [-5.93919606e-02 -2.31614253e-02  7.79866742e-02]
 [ 1.62405026e-01  6.75442316e-02 -1.09341463e-01]
 [-5.24911806e-02  1.47581971e-01  3.73250403e-02]
 [ 1.64652920e-02 -6.03490754e-02 -2.46135974e-02]
 [ 1.60016097e-01  4.80176291e-01 -8.42206657e-02]
 [ 8.39409484e-02  1.77853491e-02 -2.55810921e-01]
 [-1.44182843e-01 -1.78421400e-02 -7.63191420e-02]
 [ 2.71755110e-02  5.97609984e-02 -1.26023815e-01]
 [ 6.91744334e-02  3.70268542e-01 -7.30431434e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.27930914 -29.29219478 -29.25560936]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  8.31647217  -9.26300532 -83.45811031]
init_Out:  [2.54002979]
Stock Position:  8.316472170547405
Bond position:  [-829.10718727]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [7.36753543]
curr_Stock_Price:  100.63033492910107
curr_Factors:  [100.63033493  -0.73064982  -1.02993623]
mat_Sqrt:  [[17.30278904  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00254705 -0.00732429  0.22247427]
Stock Position:  -0.0025470473444458947
Bond Position:  [7.62384566]


portfolio before change:  [7.37151204]
curr_Stock_Price:  100.56605193222455
curr_Factors:  [100.56605193  -0.38064539  -1.01631987]
mat_Sqrt:  [[24.87465689  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00570178  0.02135936 -0.31192076]
Stock Position:  0.005701778247795339
Bond Position:  [6.79810671]


portfolio before change:  [7.39800662]
curr_Stock_Price:  104.61648665887519
curr_Factors:  [104.61648666  -1.23966056  -0.99383369]
mat_Sqrt:  [[11.21000746  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00366295  0.04666952  0.10647795]
Stock Position:  -0.0036629492638020665
Bond Position:  [7.78121151]


portfolio before change:  [7.39726106]
curr_Stock_Price:  105.88244645906255
curr_Factors:  [105.88244646  -1.26151078  -0.99941396]
mat_Sqrt:  [[11.03867192  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00089529 -0.01908405 -0.07021574]
Stock Position:  0.0008952939404851188
Bond Position:  [7.30246514]


portfolio before change:  [7.40158541]
curr_Stock_Price:  106.63327308342421
curr_Factors:  [106.63327308  -1.64677718  -1.05320995]
mat_Sqrt:  [[ 7.16643608  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.02165968  0.15184508 -0.24025812]
Stock Position:  0.021659681649887883
Bond Position:  [5.09194266]


portfolio before change:  [7.39908165]
curr_Stock_Price:  106.40010398096706
curr_Factors:  [106.40010398  -1.65789013  -1.09007951]
mat_Sqrt:  [[ 6.81575552  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00472185  0.00562422 -0.72975735]
Stock Position:  0.00472185048953784
Bond Position:  [6.89667627]


portfolio before change:  [7.4003588]
curr_Stock_Price:  105.94010364756605
curr_Factors:  [105.94010365  -1.63340711  -1.06475575]
mat_Sqrt:  [[ 7.13285097  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02246256 -0.00564218 -0.21771727]
Stock Position:  -0.022462561664469173
Bond Position:  [9.78004491]


portfolio before change:  [7.40818207]
curr_Stock_Price:  105.80957427580303
curr_Factors:  [105.80957428  -1.31845216  -1.06961623]
mat_Sqrt:  [[ 9.71404347  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 3.08216631e-04  1.88980870e-02 -3.59510867e-01]
Stock Position:  0.000308216630519219
Bond Position:  [7.3755698]


portfolio before change:  [7.41170916]
curr_Stock_Price:  105.28523064139252
curr_Factors:  [105.28523064  -1.15436473  -1.03717572]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [7.41170916]
Stock Price:  103.63784340761266
PL:  [3.77386576]
Settle:  Tensor("sub_288:0", shape=(), dtype=float64)
PL:  Tensor("sub_289:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  145
output_Z_Vals[:, i, :]:  [[ 1.19279309e+02 -2.92921948e+01 -2.92556094e+01]
 [-6.54236990e-02 -7.03531721e-02  3.67025150e-02]
 [ 5.06729525e-01  7.26060170e-02 -2.69423619e-01]
 [ 2.71318535e-01 -1.14189247e-01 -1.66539841e-01]
 [-1.80757184e-01  1.90094932e-01  2.69716503e-01]
 [ 6.62465267e-02  1.19715309e-03  8.22239702e-03]
 [-1.40860435e-01 -9.22427038e-02  2.79413650e-01]
 [ 7.91539446e-02 -1.06503045e-01 -2.68780575e-02]
 [ 7.73528088e-02 -9.10070319e-02  5.43874718e-02]
 [-1.42602950e-02 -9.19377292e-02 -1.62312256e-03]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.27930914 -29.29219478 -29.25560936]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  8.31647217  -9.26300532 -83.45811031]
init_Out:  [2.54002979]
Stock Position:  8.316472170547405
Bond position:  [-829.10718727]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [11.22555346]
curr_Stock_Price:  101.09423572112708
curr_Factors:  [101.09423572  -0.87994339  -0.95441872]
mat_Sqrt:  [[16.1463012   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00370044 -0.02224763  0.10470206]
Stock Position:  -0.0037004351534422665
Bond Position:  [11.59964612]


portfolio before change:  [11.23876898]
curr_Stock_Price:  99.09062184715292
curr_Factors:  [99.09062185 -0.72334937 -0.90782865]
mat_Sqrt:  [[19.39192589  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.02339161  0.02296004 -0.76859059]
Stock Position:  0.023391608507981207
Bond Position:  [8.92087994]


portfolio before change:  [11.21449046]
curr_Stock_Price:  97.86197309309635
curr_Factors:  [97.86197309 -0.6492957  -0.94276129]
mat_Sqrt:  [[19.9155546   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01176846 -0.03610981 -0.47509181]
Stock Position:  0.011768458551617076
Bond Position:  [10.06280589]


portfolio before change:  [11.21779744]
curr_Stock_Price:  97.71533655203191
curr_Factors:  [97.71533655 -0.78050474 -0.96679313]
mat_Sqrt:  [[17.02632462  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0070945   0.0601133   0.76942611]
Stock Position:  -0.007094502557469715
Bond Position:  [11.91103914]


portfolio before change:  [11.24205976]
curr_Stock_Price:  95.13512535009674
curr_Factors:  [95.13512535 -0.57720908 -0.97288526]
mat_Sqrt:  [[20.19033269  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00336576 0.00037857 0.02345621]
Stock Position:  0.003365760626560166
Bond Position:  [10.9218577]


portfolio before change:  [11.24500353]
curr_Stock_Price:  94.38684618423758
curr_Factors:  [94.38684618 -0.46935168 -0.95884814]
mat_Sqrt:  [[22.62831278  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0038097  -0.0291697   0.79708937]
Stock Position:  -0.003809698916004624
Bond Position:  [11.60458899]


portfolio before change:  [11.24545794]
curr_Stock_Price:  95.79098078887331
curr_Factors:  [95.79098079 -0.69595269 -1.02429785]
mat_Sqrt:  [[17.14862497  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00413547 -0.03367922 -0.07667562]
Stock Position:  0.00413546785155016
Bond Position:  [10.84931742]


portfolio before change:  [11.25057464]
curr_Stock_Price:  95.71618510677979
curr_Factors:  [95.71618511 -1.13260055 -0.95200071]
mat_Sqrt:  [[11.9029485   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00723391 -0.02877895  0.15515232]
Stock Position:  0.007233906244765579
Bond Position:  [10.55817273]


portfolio before change:  [11.26211029]
curr_Stock_Price:  96.58089661639698
curr_Factors:  [96.58089662 -0.96905245 -0.94573928]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [11.26211029]
Stock Price:  94.00972219751132
PL:  [11.26211029]
Settle:  Tensor("sub_290:0", shape=(), dtype=float64)
PL:  Tensor("sub_291:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  146
output_Z_Vals[:, i, :]:  [[ 1.19279309e+02 -2.92921948e+01 -2.92556094e+01]
 [-7.04779654e-02 -1.14653620e-01 -1.72427800e-03]
 [ 5.05726795e-01  7.39598901e-02 -2.58812594e-01]
 [-5.21346893e-02  1.08884925e-01 -1.34543430e-01]
 [-6.93940323e-02  5.17156423e-02  1.04554319e-01]
 [ 7.05916797e-02  7.14176231e-02  4.54246927e-03]
 [ 1.26319076e-01 -5.53355748e-03 -9.95342657e-02]
 [ 3.78805916e-01 -5.60648146e-02  2.18001599e-01]
 [ 8.22976545e-02  1.52457034e-01 -2.02448828e-01]
 [ 7.81784174e-02  6.09331702e-01 -8.51594392e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.27930914 -29.29219478 -29.25560936]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  8.31647217  -9.26300532 -83.45811031]
init_Out:  [2.54002979]
Stock Position:  8.316472170547405
Bond position:  [-829.10718727]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [3.21829793]
curr_Stock_Price:  100.13141694838829
curr_Factors:  [100.13141695  -1.0824493   -0.97331216]
mat_Sqrt:  [[12.81635425  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00575751 -0.03625666 -0.00491889]
Stock Position:  -0.005757509072363335
Bond Position:  [3.79480547]


portfolio before change:  [3.2284428]
curr_Stock_Price:  98.69902843887958
curr_Factors:  [98.69902844 -0.29586216 -1.03257859]
mat_Sqrt:  [[26.14438247  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01739596  0.02338817 -0.73832029]
Stock Position:  0.017395956186471575
Bond Position:  [1.51147882]


portfolio before change:  [3.27734767]
curr_Stock_Price:  101.46685229395092
curr_Factors:  [101.46685229  -0.28409692  -1.09126008]
mat_Sqrt:  [[25.64568091  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00299414  0.03443244 -0.38381496]
Stock Position:  -0.002994143756471644
Bond Position:  [3.58115401]


portfolio before change:  [3.28257316]
curr_Stock_Price:  100.31978958507437
curr_Factors:  [100.31978959  -0.14674301  -1.05096305]
mat_Sqrt:  [[30.28513274  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00154256  0.01635392  0.29826437]
Stock Position:  -0.0015425614795973365
Bond Position:  [3.43732261]


portfolio before change:  [3.27997349]
curr_Stock_Price:  103.11952649145418
curr_Factors:  [103.11952649   0.51545727  -1.10170489]
mat_Sqrt:  [[57.37686356  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00127861 0.02258424 0.0129584 ]
Stock Position:  0.001278614722302272
Bond Position:  [3.14812334]


portfolio before change:  [3.28004859]
curr_Stock_Price:  101.94688446671098
curr_Factors:  [101.94688447   0.70565623  -1.07858436]
mat_Sqrt:  [[70.21232118  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0015077  -0.00174986 -0.28394356]
Stock Position:  0.0015076962486959909
Bond Position:  [3.12634365]


portfolio before change:  [3.30219554]
curr_Stock_Price:  115.59909714142768
curr_Factors:  [115.59909714   0.61535146  -1.06025418]
mat_Sqrt:  [[ 7.40859146e+01  0.00000000e+00  0.00000000e+00]
 [-8.16496581e-02  3.16227766e+00  0.00000000e+00]
 [-7.15541753e-02  0.00000000e+00  3.50542437e-01]]
grads:  [ 0.00569417 -0.01772925  0.62189788]
Stock Position:  0.005694169011391272
Bond Position:  [2.64395474]


portfolio before change:  [3.29868426]
curr_Stock_Price:  114.75023116471466
curr_Factors:  [114.75023116   0.52501974  -1.07438057]
mat_Sqrt:  [[66.24745357  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0006779   0.04821115 -0.57753015]
Stock Position:  0.0006779035540815534
Bond Position:  [3.22089467]


portfolio before change:  [3.30466153]
curr_Stock_Price:  121.19128747204425
curr_Factors:  [121.19128747   0.35906833  -1.10174257]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [3.30466153]
Stock Price:  127.12373307693984
PL:  [-23.81907155]
Settle:  Tensor("sub_292:0", shape=(), dtype=float64)
PL:  Tensor("sub_293:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  147
output_Z_Vals[:, i, :]:  [[ 1.19279309e+02 -2.92921948e+01 -2.92556094e+01]
 [-6.52187802e-02 -6.85570668e-02  3.82604805e-02]
 [ 1.80583117e-01  6.57569907e-02 -1.12558039e-01]
 [ 1.61360017e-01 -4.71997890e-02 -2.11064240e-01]
 [-2.28695742e-01  2.55367904e-01  3.42744247e-01]
 [ 3.99069069e-02 -7.24413828e-02  3.50026896e-02]
 [-6.47583328e-03 -5.44338466e-02  2.09170579e-01]
 [-9.20157605e-02 -6.61641364e-02  4.72961698e-02]
 [-8.19197270e-02 -5.72345870e-02 -6.49169747e-02]
 [-9.63769714e-03 -5.38519506e-02  6.33471861e-03]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.27930914 -29.29219478 -29.25560936]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  8.31647217  -9.26300532 -83.45811031]
init_Out:  [2.54002979]
Stock Position:  8.316472170547405
Bond position:  [-829.10718727]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-9.65595118]
curr_Stock_Price:  98.58337484029707
curr_Factors:  [98.58337484 -0.91709805 -1.01676414]
mat_Sqrt:  [[14.25404106  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00415174 -0.02167965  0.1091465 ]
Stock Position:  -0.004151736892799036
Bond Position:  [-9.24665895]


portfolio before change:  [-9.66923388]
curr_Stock_Price:  100.66881869027561
curr_Factors:  [100.66881869  -0.56533535  -1.00974892]
mat_Sqrt:  [[20.83744975  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00764514  0.02079419 -0.32109676]
Stock Position:  0.007645136234796459
Bond Position:  [-10.43886071]


portfolio before change:  [-9.68717604]
curr_Stock_Price:  99.00482884306926
curr_Factors:  [99.00482884 -0.36080582 -1.05019539]
mat_Sqrt:  [[24.1471754   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00484769 -0.01492588 -0.60210753]
Stock Position:  0.004847689791682056
Bond Position:  [-10.16712074]


portfolio before change:  [-9.70176441]
curr_Stock_Price:  97.04440412700279
curr_Factors:  [97.04440413 -0.45505433 -1.01086949]
mat_Sqrt:  [[22.40411904  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00679071  0.08075442  0.97775394]
Stock Position:  -0.006790706409674651
Bond Position:  [-9.04276435]


portfolio before change:  [-9.7165285]
curr_Stock_Price:  98.5525796618003
curr_Factors:  [98.55257966 -0.42797074 -1.01107112]
mat_Sqrt:  [[23.37222483  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00193312 -0.02290798  0.09985293]
Stock Position:  0.0019331224508856882
Bond Position:  [-9.9070427]


portfolio before change:  [-9.72569201]
curr_Stock_Price:  96.37539975555939
curr_Factors:  [96.37539976 -0.44263945 -1.00975923]
mat_Sqrt:  [[22.55264386  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00154374 -0.01721349  0.59670544]
Stock Position:  0.0015437416885735404
Bond Position:  [-9.87447073]


portfolio before change:  [-9.72600835]
curr_Stock_Price:  99.36951067574974
curr_Factors:  [99.36951068 -0.65464065 -1.02055997]
mat_Sqrt:  [[18.60898836  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0045177  -0.02092294  0.13492281]
Stock Position:  -0.004517699691274055
Bond Position:  [-9.27708674]


portfolio before change:  [-9.72901624]
curr_Stock_Price:  99.00830772601242
curr_Factors:  [99.00830773 -0.65209196 -1.05188158]
mat_Sqrt:  [[18.01545898  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00536476 -0.01809917 -0.18519006]
Stock Position:  -0.005364761438842791
Bond Position:  [-9.19786029]


portfolio before change:  [-9.73030243]
curr_Stock_Price:  98.3905922026738
curr_Factors:  [98.3905922  -0.73830362 -1.03681238]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-9.73030243]
Stock Price:  97.54262053660874
PL:  [-9.73030243]
Settle:  Tensor("sub_294:0", shape=(), dtype=float64)
PL:  Tensor("sub_295:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  148
output_Z_Vals[:, i, :]:  [[ 1.19279309e+02 -2.92921948e+01 -2.92556094e+01]
 [-7.04779654e-02 -1.14653620e-01 -1.72427800e-03]
 [ 1.53407765e-01  2.55014798e-02  3.04577219e-02]
 [-5.31776305e-02  1.08737609e-01 -1.39868266e-01]
 [ 4.46831501e-02 -8.76838046e-02 -5.97184785e-02]
 [ 9.33101768e-02  1.76167747e-01 -1.80086196e-02]
 [ 1.26711179e-01  3.06297465e-03 -2.09138034e-01]
 [ 1.06534500e-01 -1.47417913e-01 -1.27248787e-01]
 [ 1.14760428e-01  2.13925110e-01 -2.55088188e-01]
 [ 7.16357261e-02  4.81963938e-01 -4.62326424e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.27930914 -29.29219478 -29.25560936]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  8.31647217  -9.26300532 -83.45811031]
init_Out:  [2.54002979]
Stock Position:  8.316472170547405
Bond position:  [-829.10718727]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [19.66105297]
curr_Stock_Price:  102.10854796053074
curr_Factors:  [102.10854796  -1.61350947  -0.99286167]
mat_Sqrt:  [[ 7.5358023   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00979196 -0.03625666 -0.00491889]
Stock Position:  -0.00979196015541728
Bond Position:  [20.6608958]


portfolio before change:  [19.67361497]
curr_Stock_Price:  101.88091542879648
curr_Factors:  [101.88091543  -1.22343988  -1.00926092]
mat_Sqrt:  [[10.92554729  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01467051 0.00806428 0.0868874 ]
Stock Position:  0.014670511452216083
Bond Position:  [18.17896983]


portfolio before change:  [19.67950507]
curr_Stock_Price:  101.66267756319716
curr_Factors:  [101.66267756  -0.47204143  -0.93695943]
mat_Sqrt:  [[24.84507115  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00317651  0.03438585 -0.39900523]
Stock Position:  -0.0031765064094750463
Bond Position:  [20.00243721]


portfolio before change:  [19.68769551]
curr_Stock_Price:  102.2335176505873
curr_Factors:  [102.23351765  -0.54776832  -0.98947352]
mat_Sqrt:  [[21.97746802  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00137546 -0.02772805 -0.1703602 ]
Stock Position:  0.0013754623882962175
Bond Position:  [19.54707715]


portfolio before change:  [19.69997371]
curr_Stock_Price:  104.05269842489832
curr_Factors:  [104.05269842   0.37304097  -1.05594845]
mat_Sqrt:  [[52.56182059  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00179185  0.05570913 -0.05137358]
Stock Position:  0.0017918484058564836
Bond Position:  [19.51352704]


portfolio before change:  [19.71540154]
curr_Stock_Price:  107.21626472222226
curr_Factors:  [ 1.07216265e+02 -2.72611487e-02 -1.08690220e+00]
mat_Sqrt:  [[35.18727835  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00239007  0.0009686  -0.5966126 ]
Stock Position:  0.0023900723715604643
Bond Position:  [19.45914691]


portfolio before change:  [19.75025383]
curr_Stock_Price:  117.72652452835995
curr_Factors:  [117.72652453  -0.96777579  -1.04804634]
mat_Sqrt:  [[15.68244935  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00489424 -0.04661764 -0.36300537]
Stock Position:  0.004894237793960377
Bond Position:  [19.17407222]


portfolio before change:  [19.76381164]
curr_Stock_Price:  118.53735094913996
curr_Factors:  [118.53735095  -0.415194    -1.05361898]
mat_Sqrt:  [[27.28712908  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00249987  0.06764906 -0.7276956 ]
Stock Position:  0.002499870615760302
Bond Position:  [19.4674836]


portfolio before change:  [19.76071817]
curr_Stock_Price:  113.40522841210857
curr_Factors:  [113.40522841  -0.58073531  -1.00108436]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [19.76071817]
Stock Price:  116.63302465111695
PL:  [3.12769352]
Settle:  Tensor("sub_296:0", shape=(), dtype=float64)
PL:  Tensor("sub_297:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  149
output_Z_Vals[:, i, :]:  [[ 1.19279309e+02 -2.92921948e+01 -2.92556094e+01]
 [-6.48885941e-02 -6.56629991e-02  4.07708331e-02]
 [ 1.08481007e+00  8.23483657e-02 -4.42344767e-01]
 [ 3.02668764e-01 -1.44985173e-01 -1.37807661e-01]
 [-9.47041085e-02  7.29251335e-02  1.38626141e-01]
 [ 4.51136549e-02 -6.55509181e-02  2.98455215e-02]
 [ 7.53118970e-02  1.47570705e-02 -1.70013109e-01]
 [-2.14391669e-01  5.10309224e-02 -1.58828687e-01]
 [-2.43121049e-02  6.54334858e-03 -9.82511223e-02]
 [ 6.71837255e-02  3.50768617e-01 -2.79102600e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.27930914 -29.29219478 -29.25560936]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  8.31647217  -9.26300532 -83.45811031]
init_Out:  [2.54002979]
Stock Position:  8.316472170547405
Bond position:  [-829.10718727]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-10.81803952]
curr_Stock_Price:  98.44364151146635
curr_Factors:  [98.44364151 -0.93956018 -0.96836695]
mat_Sqrt:  [[14.60782121  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00398839 -0.02076446  0.11630784]
Stock Position:  -0.003988390410104665
Bond Position:  [-10.42540784]


portfolio before change:  [-10.81565676]
curr_Stock_Price:  96.53892015281316
curr_Factors:  [96.53892015 -0.95168518 -0.95830166]
mat_Sqrt:  [[14.29570875  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.06971624  0.02604084 -1.26188649]
Stock Position:  0.06971623926567483
Bond Position:  [-17.54598721]


portfolio before change:  [-10.70684429]
curr_Stock_Price:  98.22558106482326
curr_Factors:  [98.22558106 -1.2886408  -0.98012166]
mat_Sqrt:  [[10.16046504  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.02665187 -0.04584834 -0.3931269 ]
Stock Position:  0.026651869839239742
Bond Position:  [-13.32473969]


portfolio before change:  [-10.68752907]
curr_Stock_Price:  99.20034399195895
curr_Factors:  [99.20034399 -1.08037355 -0.96795405]
mat_Sqrt:  [[12.79192198  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00504414  0.02306095  0.39546179]
Stock Position:  -0.005044140134902591
Bond Position:  [-10.18714863]


portfolio before change:  [-10.69621837]
curr_Stock_Price:  99.9129444744157
curr_Factors:  [99.91294447 -1.05401484 -0.94913622]
mat_Sqrt:  [[13.47920589  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00367331 -0.02072902  0.08514097]
Stock Position:  0.0036733120238850326
Bond Position:  [-11.06322979]


portfolio before change:  [-10.69051028]
curr_Stock_Price:  102.9731494275115
curr_Factors:  [102.97314943  -1.29327518  -1.01995935]
mat_Sqrt:  [[10.18823612  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00402318  0.0046666  -0.48500008]
Stock Position:  0.004023183397910544
Bond Position:  [-11.10479015]


portfolio before change:  [-10.69552667]
curr_Stock_Price:  103.10672525160996
curr_Factors:  [103.10672525  -1.78491967  -0.94350155]
mat_Sqrt:  [[ 6.73517234  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.03644967  0.01613739 -0.45309403]
Stock Position:  -0.036449672597206266
Bond Position:  [-6.93732029]


portfolio before change:  [-10.71048993]
curr_Stock_Price:  103.42205695261038
curr_Factors:  [103.42205695  -1.33950615  -0.91291134]
mat_Sqrt:  [[10.87428429  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0040645   0.00206919 -0.2802831 ]
Stock Position:  -0.004064504985416605
Bond Position:  [-10.29013046]


portfolio before change:  [-10.71966989]
curr_Stock_Price:  104.41445427607593
curr_Factors:  [104.41445428  -1.18651029  -0.90831042]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-10.71966989]
Stock Price:  103.30565235620918
PL:  [-14.02532224]
Settle:  Tensor("sub_298:0", shape=(), dtype=float64)
PL:  Tensor("sub_299:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  150
output_Z_Vals[:, i, :]:  [[ 1.19279309e+02 -2.92921948e+01 -2.92556094e+01]
 [-6.24200336e-02 -4.40261621e-02  5.95389111e-02]
 [ 4.17325800e-01  6.92760356e-02 -2.56395086e-01]
 [ 1.18215390e-01 -1.35889199e-02 -1.82646661e-01]
 [-6.28863002e-02  2.97695376e-02  9.02110629e-02]
 [ 5.69823938e-02 -2.66774760e-02  1.80746242e-02]
 [ 6.73751318e-02  4.52383714e-02 -3.49074482e-01]
 [-1.89902746e-02 -1.04564786e-01  8.24370443e-02]
 [-3.57925136e-02 -7.46829068e-02 -2.50779009e-02]
 [-1.36373498e-02 -8.94736605e-02 -2.15071925e-03]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.27930914 -29.29219478 -29.25560936]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  8.31647217  -9.26300532 -83.45811031]
init_Out:  [2.54002979]
Stock Position:  8.316472170547405
Bond position:  [-829.10718727]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [14.31357495]
curr_Stock_Price:  101.46554959419514
curr_Factors:  [101.46554959  -0.37612685  -1.00095783]
mat_Sqrt:  [[25.60108271  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00200786 -0.01392229  0.16984794]
Stock Position:  -0.0020078625350650595
Bond Position:  [14.51730383]


portfolio before change:  [14.32432982]
curr_Stock_Price:  99.72518923723048
curr_Factors:  [99.72518924 -0.98717641 -0.97961787]
mat_Sqrt:  [[13.95201594  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.02628854  0.02190701 -0.73142381]
Stock Position:  0.026288535876586184
Bond Position:  [11.70270061]


portfolio before change:  [14.32413816]
curr_Stock_Price:  99.49526119910556
curr_Factors:  [99.4952612  -1.17746721 -0.9560841 ]
mat_Sqrt:  [[11.78183234  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00683951 -0.00429719 -0.52104009]
Stock Position:  0.006839507600688634
Bond Position:  [13.64363957]


portfolio before change:  [14.33438772]
curr_Stock_Price:  99.99617858743078
curr_Factors:  [99.99617859 -0.93690243 -1.01682592]
mat_Sqrt:  [[14.17391943  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00308337  0.00941395  0.25734705]
Stock Position:  -0.0030833671797424788
Bond Position:  [14.64271265]


portfolio before change:  [14.34431379]
curr_Stock_Price:  99.15200912334318
curr_Factors:  [99.15200912 -1.16203834 -1.04521601]
mat_Sqrt:  [[10.90694531  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00549953 -0.00843616  0.05156187]
Stock Position:  0.005499528042632457
Bond Position:  [13.79902454]


portfolio before change:  [14.34771123]
curr_Stock_Price:  98.51490001017777
curr_Factors:  [98.51490001 -1.5932493  -1.07288459]
mat_Sqrt:  [[ 6.84880313  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-3.95886490e-04  1.43056291e-02 -9.95812332e-01]
Stock Position:  -0.00039588649022509123
Bond Position:  [14.38671195]


portfolio before change:  [14.35513131]
curr_Stock_Price:  97.94673127994893
curr_Factors:  [97.94673128 -1.17925911 -1.13029495]
mat_Sqrt:  [[ 9.72665167  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00049994 -0.03306629  0.23516994]
Stock Position:  -0.0004999392087561541
Bond Position:  [14.40409872]


portfolio before change:  [14.36206266]
curr_Stock_Price:  98.4917972356165
curr_Factors:  [98.49179724 -1.12984188 -1.16688064]
mat_Sqrt:  [[ 9.90709083  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00432416 -0.02361681 -0.07154027]
Stock Position:  -0.004324157700010945
Bond Position:  [14.78795673]


portfolio before change:  [14.37851029]
curr_Stock_Price:  96.39848776450586
curr_Factors:  [96.39848776 -0.70582516 -1.16878463]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [14.37851029]
Stock Price:  96.13714329036516
PL:  [14.37851029]
Settle:  Tensor("sub_300:0", shape=(), dtype=float64)
PL:  Tensor("sub_301:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  151
output_Z_Vals[:, i, :]:  [[ 1.19279309e+02 -2.92921948e+01 -2.92556094e+01]
 [-5.90092678e-02 -2.51399727e-02  7.65987339e-02]
 [-1.01657964e-01 -3.78740114e-02  6.66400366e-02]
 [-5.62815678e-02  1.55465613e-01  5.57119111e-02]
 [ 2.20523352e-02 -1.10048398e-01 -2.77999732e-02]
 [ 1.14433891e-01  2.74674651e-01 -3.89774041e-02]
 [ 1.05197138e-01 -6.54873943e-03 -1.09208273e-01]
 [-1.80737098e-01  1.80166487e-02 -1.19277771e-01]
 [-4.50970728e-02  2.13991560e-02 -1.24206217e-01]
 [ 7.44145720e-02  3.83732664e-01 -4.76742287e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.27930914 -29.29219478 -29.25560936]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  8.31647217  -9.26300532 -83.45811031]
init_Out:  [2.54002979]
Stock Position:  8.316472170547405
Bond position:  [-829.10718727]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [12.2532168]
curr_Stock_Price:  101.21780534500732
curr_Factors:  [101.21780535  -0.63209509  -1.01247741]
mat_Sqrt:  [[19.54466167  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00225242 -0.00794996  0.21851487]
Stock Position:  -0.00225241698795392
Bond Position:  [12.4812015]


portfolio before change:  [12.25303374]
curr_Stock_Price:  104.07039180589557
curr_Factors:  [104.07039181  -0.67565275  -1.10320663]
mat_Sqrt:  [[17.5702676   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00506725 -0.01197681  0.19010548]
Stock Position:  -0.00506725498753057
Bond Position:  [12.78038496]


portfolio before change:  [12.25323623]
curr_Stock_Price:  105.29182324415386
curr_Factors:  [105.29182324  -0.99642369  -1.11999105]
mat_Sqrt:  [[12.68374207  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00322423  0.04916254  0.15893058]
Stock Position:  -0.003224231186227804
Bond Position:  [12.59272141]


portfolio before change:  [12.25620209]
curr_Stock_Price:  106.32527088524418
curr_Factors:  [106.32527089  -0.89821493  -1.13200336]
mat_Sqrt:  [[13.96123694  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00096956 -0.03480036 -0.07930559]
Stock Position:  0.0009695596497409357
Bond Position:  [12.1531134]


portfolio before change:  [12.26098521]
curr_Stock_Price:  104.98965310869151
curr_Factors:  [104.98965311  -0.47511998  -1.06152245]
mat_Sqrt:  [[22.58349601  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00502888  0.08685975 -0.11119168]
Stock Position:  0.005028881732287232
Bond Position:  [11.73300466]


portfolio before change:  [12.25488845]
curr_Stock_Price:  102.61045117189634
curr_Factors:  [102.61045117  -0.48856836  -1.09734532]
mat_Sqrt:  [[21.01057979  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00393783 -0.00207089 -0.3115408 ]
Stock Position:  0.003937825894883665
Bond Position:  [11.85082636]


portfolio before change:  [12.26295704]
curr_Stock_Price:  103.15432782099317
curr_Factors:  [103.15432782  -0.35298599  -1.12383327]
mat_Sqrt:  [[23.5566211   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00868628  0.00569736 -0.34026628]
Stock Position:  -0.008686278990920455
Bond Position:  [13.15898431]


portfolio before change:  [12.2659711]
curr_Stock_Price:  103.56498442914156
curr_Factors:  [103.56498443  -0.44810406  -1.11844467]
mat_Sqrt:  [[21.62068622  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00323292  0.00676701 -0.35432577]
Stock Position:  -0.0032329240692171774
Bond Position:  [12.60078883]


portfolio before change:  [12.27022539]
curr_Stock_Price:  104.1983652162394
curr_Factors:  [104.19836522  -0.39035713  -1.09209638]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [12.27022539]
Stock Price:  100.38826738657238
PL:  [11.88195801]
Settle:  Tensor("sub_302:0", shape=(), dtype=float64)
PL:  Tensor("sub_303:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  152
output_Z_Vals[:, i, :]:  [[ 1.19279309e+02 -2.92921948e+01 -2.92556094e+01]
 [-6.65821794e-02 -8.05072079e-02  2.78947703e-02]
 [ 4.47920807e-01  7.33188686e-02 -2.39014896e-01]
 [-5.08209495e-02  1.09070491e-01 -1.27836006e-01]
 [ 6.31115050e-03 -4.88382031e-02 -6.62912282e-03]
 [ 4.28040245e-02 -5.79478511e-02  3.21261765e-02]
 [ 7.40818312e-02  2.12639203e-02 -1.68700179e-01]
 [-1.69864518e-01 -1.56464144e-03 -6.27687679e-02]
 [-1.39097728e-01 -2.40090505e-02 -1.27722170e-01]
 [ 6.98823386e-02  3.94474662e-01 -1.54854839e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.27930914 -29.29219478 -29.25560936]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  8.31647217  -9.26300532 -83.45811031]
init_Out:  [2.54002979]
Stock Position:  8.316472170547405
Bond position:  [-829.10718727]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-1.32516899]
curr_Stock_Price:  99.58509552453135
curr_Factors:  [99.58509552 -0.9072674  -1.04938552]
mat_Sqrt:  [[14.0744288   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00447385 -0.02545861  0.07957602]
Stock Position:  -0.0044738490856689
Bond Position:  [-0.8796403]


portfolio before change:  [-1.3224254]
curr_Stock_Price:  98.8735123904899
curr_Factors:  [98.87351239 -0.18382881 -1.04453176]
mat_Sqrt:  [[28.94741202  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01385358  0.02318546 -0.68184297]
Stock Position:  0.013853576276726856
Bond Position:  [-2.69217715]


portfolio before change:  [-1.28759577]
curr_Stock_Price:  101.48482747057355
curr_Factors:  [ 1.01484827e+02 -7.56997496e-02 -1.03258867e+00]
mat_Sqrt:  [[33.5025276   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00221175  0.03449112 -0.36468054]
Stock Position:  -0.002211748851846738
Bond Position:  [-1.06313682]


portfolio before change:  [-1.2879623]
curr_Stock_Price:  101.41014449221046
curr_Factors:  [101.41014449  -0.24955556  -1.03239707]
mat_Sqrt:  [[28.14080058  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00013137 -0.015444   -0.01891104]
Stock Position:  0.00013137470896928358
Bond Position:  [-1.30128502]


portfolio before change:  [-1.28866939]
curr_Stock_Price:  100.98167671302016
curr_Factors:  [100.98167671  -0.86393106  -0.99783095]
mat_Sqrt:  [[15.69240872  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00305024 -0.01832472  0.09164704]
Stock Position:  0.003050235726538769
Bond Position:  [-1.59668731]


portfolio before change:  [-1.29265231]
curr_Stock_Price:  99.93769948023308
curr_Factors:  [99.93769948 -1.06788206 -0.9512588 ]
mat_Sqrt:  [[13.26867676  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00302932  0.00672424 -0.48125465]
Stock Position:  0.003029321179234429
Bond Position:  [-1.5953957]


portfolio before change:  [-1.2905997]
curr_Stock_Price:  100.87867032477274
curr_Factors:  [100.87867032  -0.54709245  -0.92920532]
mat_Sqrt:  [[23.04896223  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00792737 -0.00049478 -0.17906182]
Stock Position:  -0.007927365076243824
Bond Position:  [-0.49089766]


portfolio before change:  [-1.28820637]
curr_Stock_Price:  100.54579244847953
curr_Factors:  [100.54579245  -0.30375622  -0.93446302]
mat_Sqrt:  [[29.14822513  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00568778 -0.00759233 -0.3643558 ]
Stock Position:  -0.005687784313025106
Bond Position:  [-0.71632359]


portfolio before change:  [-1.32434714]
curr_Stock_Price:  106.83691028434568
curr_Factors:  [106.83691028  -0.63725298  -0.88223945]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-1.32434714]
Stock Price:  111.98031969661392
PL:  [-13.30466684]
Settle:  Tensor("sub_304:0", shape=(), dtype=float64)
PL:  Tensor("sub_305:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  153
output_Z_Vals[:, i, :]:  [[ 1.19279309e+02 -2.92921948e+01 -2.92556094e+01]
 [-6.35045548e-02 -5.35319482e-02  5.12934668e-02]
 [ 6.09310349e-01  7.34835383e-02 -3.06511908e-01]
 [ 2.10275049e-01 -7.71360925e-02 -1.92109742e-01]
 [-4.91851332e-02  1.98193675e-02  7.22851873e-02]
 [ 4.31583465e-02 -5.60026922e-02  3.17742614e-02]
 [ 9.97789952e-02 -6.46504403e-03 -1.16318636e-01]
 [-1.99704050e-01  3.66227436e-02 -1.41567769e-01]
 [ 1.19696103e-02  4.13756432e-02 -1.13620514e-01]
 [ 7.22023194e-02  3.85684604e-01 -8.74588162e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.27930914 -29.29219478 -29.25560936]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  8.31647217  -9.26300532 -83.45811031]
init_Out:  [2.54002979]
Stock Position:  8.316472170547405
Bond position:  [-829.10718727]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [11.26828408]
curr_Stock_Price:  101.09937379215181
curr_Factors:  [101.09937379  -0.82889197  -0.9932821 ]
mat_Sqrt:  [[16.34512789  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00332922 -0.01692829  0.14632598]
Stock Position:  -0.003329218897853056
Bond Position:  [11.60486603]


portfolio before change:  [11.2821991]
curr_Stock_Price:  98.66302589497371
curr_Factors:  [98.66302589 -0.82213    -1.02830053]
mat_Sqrt:  [[15.50681704  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.03538065  0.02323754 -0.87439316]
Stock Position:  0.03538064598362284
Bond Position:  [7.79143751]


portfolio before change:  [11.27827352]
curr_Stock_Price:  98.44193675565562
curr_Factors:  [98.44193676 -0.39094773 -1.04688513]
mat_Sqrt:  [[23.37422768  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00723314 -0.02439257 -0.54803562]
Stock Position:  0.007233144509927008
Bond Position:  [10.56622877]


portfolio before change:  [11.29779308]
curr_Stock_Price:  100.40997799649512
curr_Factors:  [100.409978    -0.58416174  -1.06702003]
mat_Sqrt:  [[19.26095161  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00176099  0.00626743  0.20620952]
Stock Position:  -0.0017609850194524079
Bond Position:  [11.47461355]


portfolio before change:  [11.30187529]
curr_Stock_Price:  101.3506624648037
curr_Factors:  [101.35066246  -0.37407956  -1.03964196]
mat_Sqrt:  [[24.65216902  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00195513 -0.01770961  0.09064312]
Stock Position:  0.0019551325131692224
Bond Position:  [11.10372132]


portfolio before change:  [11.31096758]
curr_Stock_Price:  103.16079113000167
curr_Factors:  [103.16079113  -0.65450222  -1.0229945 ]
mat_Sqrt:  [[19.27467642  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00393618 -0.00204443 -0.33182469]
Stock Position:  0.003936181583630714
Bond Position:  [10.90490798]


portfolio before change:  [11.31565144]
curr_Stock_Price:  102.96517965758142
curr_Factors:  [102.96517966  -0.50589777  -1.08998612]
mat_Sqrt:  [[20.87405464  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01090616  0.01158113 -0.40385344]
Stock Position:  -0.010906163589865823
Bond Position:  [12.43860653]


portfolio before change:  [11.29886937]
curr_Stock_Price:  105.07434670224029
curr_Factors:  [105.0743467   -0.68522376  -1.05329199]
mat_Sqrt:  [[18.4700852   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0005498   0.01308413 -0.3241277 ]
Stock Position:  -0.0005497952719332286
Bond Position:  [11.35663875]


portfolio before change:  [11.30443897]
curr_Stock_Price:  105.27468488934895
curr_Factors:  [105.27468489  -0.67561548  -1.05562467]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [11.30443897]
Stock Price:  103.30641052808858
PL:  [7.99802844]
Settle:  Tensor("sub_306:0", shape=(), dtype=float64)
PL:  Tensor("sub_307:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  154
output_Z_Vals[:, i, :]:  [[ 1.19279309e+02 -2.92921948e+01 -2.92556094e+01]
 [-7.04779654e-02 -1.14653620e-01 -1.72427800e-03]
 [ 6.34883472e-01  7.22204807e-02 -3.26904321e-01]
 [ 9.46674151e-02  1.46809172e-03 -1.87728280e-01]
 [-1.85913901e-01  1.97146183e-01  2.77582091e-01]
 [ 6.70731765e-02  6.37266164e-03  8.06702630e-03]
 [ 8.73464367e-02 -2.80371258e-02  1.60129511e-01]
 [ 1.27939116e-01 -9.94424182e-02 -6.73290791e-02]
 [ 1.50847230e-01 -9.17270984e-02  9.91896948e-02]
 [-6.14407568e-03 -2.48378091e-02 -1.44245843e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.27930914 -29.29219478 -29.25560936]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  8.31647217  -9.26300532 -83.45811031]
init_Out:  [2.54002979]
Stock Position:  8.316472170547405
Bond position:  [-829.10718727]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-1.89135653]
curr_Stock_Price:  99.51701526929672
curr_Factors:  [99.51701527 -1.08003187 -0.97319412]
mat_Sqrt:  [[12.77005074  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00577839 -0.03625666 -0.00491889]
Stock Position:  -0.005778385486341326
Bond Position:  [-1.31630886]


portfolio before change:  [-1.88863821]
curr_Stock_Price:  98.9326567862432
curr_Factors:  [98.93265679 -1.25980786 -0.96780899]
mat_Sqrt:  [[10.66345568  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.05345539  0.02283812 -0.93256704]
Stock Position:  0.053455385323903565
Bond Position:  [-7.17712149]


portfolio before change:  [-1.85399785]
curr_Stock_Price:  99.64782921149636
curr_Factors:  [99.64782921 -1.15959801 -0.96687312]
mat_Sqrt:  [[11.88374062  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 4.74475573e-03  4.64251365e-04 -5.35536530e-01]
Stock Position:  0.00474475572734963
Bond Position:  [-2.32680245]


portfolio before change:  [-1.8654774]
curr_Stock_Price:  97.47366851960122
curr_Factors:  [97.47366852 -0.91669263 -0.91346295]
mat_Sqrt:  [[15.63366648  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00794199  0.0623431   0.79186444]
Stock Position:  -0.007941988632528024
Bond Position:  [-1.09134263]


portfolio before change:  [-1.8655833]
curr_Stock_Price:  97.41827841665176
curr_Factors:  [97.41827842 -0.89689162 -0.85773965]
mat_Sqrt:  [[16.85053803  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00408796 0.00201521 0.02301298]
Stock Position:  0.004087963993925475
Bond Position:  [-2.26382571]


portfolio before change:  [-1.8731391]
curr_Stock_Price:  95.84693339970671
curr_Factors:  [95.8469334  -0.87738103 -0.84979664]
mat_Sqrt:  [[17.04019236  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00700161 -0.00886612  0.45680492]
Stock Position:  0.0070016123264079275
Bond Position:  [-2.54422217]


portfolio before change:  [-1.89335233]
curr_Stock_Price:  93.14172779690269
curr_Factors:  [93.1417278  -1.06722403 -0.83263318]
mat_Sqrt:  [[13.93306892  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00801173 -0.03144645 -0.19207112]
Stock Position:  0.008011733334389832
Bond Position:  [-2.63957901]


portfolio before change:  [-1.89265176]
curr_Stock_Price:  93.39394317057942
curr_Factors:  [93.39394317 -0.93567691 -0.79653629]
mat_Sqrt:  [[16.52068608  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01021301 -0.02900666  0.28296059]
Stock Position:  0.010213005502986079
Bond Position:  [-2.84648462]


portfolio before change:  [-1.93324096]
curr_Stock_Price:  89.55906797599486
curr_Factors:  [89.55906798 -0.93118856 -0.75523415]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-1.93324096]
Stock Price:  91.00116704119951
PL:  [-1.93324096]
Settle:  Tensor("sub_308:0", shape=(), dtype=float64)
PL:  Tensor("sub_309:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  155
output_Z_Vals[:, i, :]:  [[ 1.19279309e+02 -2.92921948e+01 -2.92556094e+01]
 [-6.69309282e-02 -8.35639774e-02  2.52432882e-02]
 [ 6.77743555e-01  7.22881090e-02 -3.44649689e-01]
 [ 2.00620875e-01 -6.66009410e-02 -1.66870695e-01]
 [-2.05188796e-01  2.23567657e-01  3.07004167e-01]
 [ 6.16526852e-02 -1.13809644e-02  1.34428330e-02]
 [ 7.17038553e-02  3.10991857e-02 -2.12877597e-01]
 [-4.23898269e-02 -9.55677113e-02  1.03836520e-01]
 [-1.35292939e-01 -2.92830301e-02 -1.20675381e-01]
 [ 2.01195061e-02  1.24007917e-01  1.41113633e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.27930914 -29.29219478 -29.25560936]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  8.31647217  -9.26300532 -83.45811031]
init_Out:  [2.54002979]
Stock Position:  8.316472170547405
Bond position:  [-829.10718727]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-8.50934171]
curr_Stock_Price:  98.72124693878764
curr_Factors:  [98.72124694 -0.93521244 -1.00573088]
mat_Sqrt:  [[14.1732569   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00451102 -0.02642525  0.07201207]
Stock Position:  -0.004511015121133189
Bond Position:  [-8.06400867]


portfolio before change:  [-8.51398213]
curr_Stock_Price:  98.85589599216563
curr_Factors:  [98.85589599 -1.40878741 -0.97762919]
mat_Sqrt:  [[ 9.09065165  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.06702036  0.02285951 -0.98318963]
Stock Position:  0.06702035522962572
Bond Position:  [-15.13933939]


portfolio before change:  [-8.51648329]
curr_Stock_Price:  98.93155064818262
curr_Factors:  [98.93155065 -1.17001013 -0.94885348]
mat_Sqrt:  [[11.88841732  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0138655  -0.02106107 -0.47603564]
Stock Position:  0.013865504853246087
Bond Position:  [-9.88821918]


portfolio before change:  [-8.5477264]
curr_Stock_Price:  97.03491815997522
curr_Factors:  [97.03491816 -0.94957277 -0.93005741]
mat_Sqrt:  [[14.81204516  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00923231  0.0706983   0.87579743]
Stock Position:  -0.009232306526672134
Bond Position:  [-7.65187029]


portfolio before change:  [-8.55950216]
curr_Stock_Price:  97.89590223661433
curr_Factors:  [97.89590224 -0.9428094  -0.92723556]
mat_Sqrt:  [[15.08739662  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00424877 -0.00359898  0.03834866]
Stock Position:  0.00424876725991409
Bond Position:  [-8.97543906]


portfolio before change:  [-8.55811527]
curr_Stock_Price:  99.27882896423877
curr_Factors:  [99.27882896 -1.19625693 -0.94085381]
mat_Sqrt:  [[11.71443217  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00248014  0.00983443 -0.60728053]
Stock Position:  0.002480135169345288
Bond Position:  [-8.80434018]


portfolio before change:  [-8.56392829]
curr_Stock_Price:  98.71041254378443
curr_Factors:  [98.71041254 -0.84383962 -0.92247409]
mat_Sqrt:  [[16.87573391  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00140212 -0.03022116  0.29621669]
Stock Position:  -0.0014021217576808116
Bond Position:  [-8.42552427]


portfolio before change:  [-8.5704293]
curr_Stock_Price:  100.34165091009106
curr_Factors:  [100.34165091  -0.45001189  -0.98121564]
mat_Sqrt:  [[23.98319421  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00669977 -0.00926011 -0.34425327]
Stock Position:  -0.0066997657373131705
Bond Position:  [-7.89816374]


portfolio before change:  [-8.57673411]
curr_Stock_Price:  100.69311673362708
curr_Factors:  [100.69311673  -0.63814354  -0.9446027 ]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-8.57673411]
Stock Price:  99.36544700153708
PL:  [-8.57673411]
Settle:  Tensor("sub_310:0", shape=(), dtype=float64)
PL:  Tensor("sub_311:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  156
output_Z_Vals[:, i, :]:  [[ 1.19279309e+02 -2.92921948e+01 -2.92556094e+01]
 [-6.27954310e-02 -4.73165061e-02  5.66848233e-02]
 [-7.11964095e-05 -5.73030274e-03  5.31074252e-02]
 [-4.84661818e-02  1.16706070e-01 -8.30773339e-02]
 [ 3.16479150e-02 -7.51130797e-02 -4.63089605e-02]
 [ 5.78725993e-02 -2.37618040e-02  1.71917573e-02]
 [ 7.56680913e-02  1.35386737e-02 -1.56486376e-01]
 [-2.14391669e-01  5.10309224e-02 -1.58828687e-01]
 [ 3.53153287e-02  3.59524826e-02 -9.62377136e-02]
 [ 6.73204118e-02  3.70613361e-01 -1.01469776e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.27930914 -29.29219478 -29.25560936]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  8.31647217  -9.26300532 -83.45811031]
init_Out:  [2.54002979]
Stock Position:  8.316472170547405
Bond position:  [-829.10718727]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [12.95755796]
curr_Stock_Price:  101.30249764548435
curr_Factors:  [101.30249765  -0.81204209  -1.01029926]
mat_Sqrt:  [[16.37522812  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00320279 -0.01496279  0.16170602]
Stock Position:  -0.0032027887766153773
Bond Position:  [13.28200846]


portfolio before change:  [12.96027506]
curr_Stock_Price:  102.52816733152426
curr_Factors:  [102.52816733  -1.21275208  -1.08729976]
mat_Sqrt:  [[10.27882263  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00103332 -0.00181208  0.1515007 ]
Stock Position:  0.001033324141898022
Bond Position:  [12.85433023]


portfolio before change:  [12.96664759]
curr_Stock_Price:  102.4737332388991
curr_Factors:  [102.47373324  -0.77779186  -1.05819954]
mat_Sqrt:  [[16.33998386  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00381952  0.0369057  -0.23699651]
Stock Position:  -0.003819522362753099
Bond Position:  [13.3580483]


portfolio before change:  [12.96846691]
curr_Stock_Price:  103.7465033368921
curr_Factors:  [103.74650334  -0.9552412   -0.98706913]
mat_Sqrt:  [[14.87437788  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00136179 -0.02375284 -0.13210657]
Stock Position:  0.0013617864741621544
Bond Position:  [12.82718632]


portfolio before change:  [12.97280008]
curr_Stock_Price:  102.21761127887802
curr_Factors:  [102.21761128  -1.52965979  -0.98422523]
mat_Sqrt:  [[ 8.27483489  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00734375 -0.00751414  0.0490433 ]
Stock Position:  0.0073437507467858905
Bond Position:  [12.22213942]


portfolio before change:  [12.98218393]
curr_Stock_Price:  102.66305830225858
curr_Factors:  [102.6630583   -1.22194003  -0.98826115]
mat_Sqrt:  [[11.25993857  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00391432  0.0042813  -0.44641207]
Stock Position:  0.003914320704868443
Bond Position:  [12.58032779]


portfolio before change:  [12.9935018]
curr_Stock_Price:  103.94709496415932
curr_Factors:  [103.94709496  -1.45604382  -1.02340745]
mat_Sqrt:  [[ 8.7096429   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02818655  0.01613739 -0.45309403]
Stock Position:  -0.028186554780973486
Bond Position:  [15.92341228]


portfolio before change:  [12.97234226]
curr_Stock_Price:  104.980326420525
curr_Factors:  [104.98032642  -1.5069948   -1.02000495]
mat_Sqrt:  [[ 8.38775758  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00197898  0.01136917 -0.27453941]
Stock Position:  0.001978976696751353
Bond Position:  [12.76458864]


portfolio before change:  [12.98090853]
curr_Stock_Price:  106.083107224604
curr_Factors:  [106.08310722  -1.40039427  -1.00912318]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [12.98090853]
Stock Price:  106.55877821830425
PL:  [6.42213031]
Settle:  Tensor("sub_312:0", shape=(), dtype=float64)
PL:  Tensor("sub_313:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  157
output_Z_Vals[:, i, :]:  [[ 1.19279309e+02 -2.92921948e+01 -2.92556094e+01]
 [-6.68655133e-02 -8.29906181e-02  2.57406276e-02]
 [ 2.41277351e-01  6.90925022e-02 -1.82796752e-01]
 [-5.31485100e-02  1.08741723e-01 -1.39719589e-01]
 [ 4.01798263e-02 -1.30334607e-01 -4.05592797e-02]
 [ 7.59481102e-02  9.53962518e-02 -7.74019900e-04]
 [-2.28687587e-01 -1.16952709e-01  3.25321059e-01]
 [ 8.84151634e-02 -9.45010710e-02 -2.93036630e-02]
 [-1.31284797e-01 -7.01458576e-02  1.31223668e-01]
 [-7.43499738e-03 -4.38863882e-02 -8.90706873e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.27930914 -29.29219478 -29.25560936]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  8.31647217  -9.26300532 -83.45811031]
init_Out:  [2.54002979]
Stock Position:  8.316472170547405
Bond position:  [-829.10718727]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-3.58200655]
curr_Stock_Price:  99.31372594382549
curr_Factors:  [99.31372594 -0.94375958 -0.97963636]
mat_Sqrt:  [[14.51072234  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00439358 -0.02624394  0.07343085]
Stock Position:  -0.004393581293328328
Bond Position:  [-3.14566362]


portfolio before change:  [-3.5862219]
curr_Stock_Price:  99.91508628751227
curr_Factors:  [99.91508629 -0.25382542 -1.03194179]
mat_Sqrt:  [[27.620368    0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00744914  0.02184897 -0.52146825]
Stock Position:  0.0074491433796015335
Bond Position:  [-4.33050371]


portfolio before change:  [-3.57676083]
curr_Stock_Price:  101.47591937498554
curr_Factors:  [101.47591937  -0.31444019  -1.01271676]
mat_Sqrt:  [[26.91448397  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00293006  0.03438715 -0.3985811 ]
Stock Position:  -0.00293005626311915
Bond Position:  [-3.27943067]


portfolio before change:  [-3.58635642]
curr_Stock_Price:  104.19104246477625
curr_Factors:  [104.19104246  -0.19773088  -1.0498568 ]
mat_Sqrt:  [[29.92333101  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00095362 -0.04121542 -0.11570434]
Stock Position:  0.0009536195332040498
Bond Position:  [-3.68571503]


portfolio before change:  [-3.58912172]
curr_Stock_Price:  103.22421326369565
curr_Factors:  [103.22421326   0.17122666  -1.01717659]
mat_Sqrt:  [[44.29861978  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00176649  0.03016694 -0.00220806]
Stock Position:  0.0017664937430771689
Bond Position:  [-3.77146665]


portfolio before change:  [-3.60320792]
curr_Stock_Price:  96.31788088732233
curr_Factors:  [ 9.63178809e+01  4.38646646e-02 -9.50356973e-01]
mat_Sqrt:  [[38.90651324  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00424868 -0.03698369  0.92805043]
Stock Position:  -0.004248682186169461
Bond Position:  [-3.19398385]


portfolio before change:  [-3.60274137]
curr_Stock_Price:  95.83209717893612
curr_Factors:  [ 9.58320972e+01 -2.88129703e-02 -9.35814587e-01]
mat_Sqrt:  [[36.5240196   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00219016 -0.02988386 -0.08359519]
Stock Position:  0.002190163404288911
Bond Position:  [-3.81262932]


portfolio before change:  [-3.61836467]
curr_Stock_Price:  89.56931960526377
curr_Factors:  [ 8.95693196e+01 -8.49456534e-02 -9.43507333e-01]
mat_Sqrt:  [[32.02637748  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00331945 -0.02218207  0.3743446 ]
Stock Position:  -0.003319452416195521
Bond Position:  [-3.32104357]


portfolio before change:  [-3.62545621]
curr_Stock_Price:  91.20531365294626
curr_Factors:  [ 9.12053137e+01 -5.65920973e-02 -9.65359929e-01]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-3.62545621]
Stock Price:  85.49646433287751
PL:  [-3.62545621]
Settle:  Tensor("sub_314:0", shape=(), dtype=float64)
PL:  Tensor("sub_315:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  158
output_Z_Vals[:, i, :]:  [[ 1.19279309e+02 -2.92921948e+01 -2.92556094e+01]
 [-6.94643689e-02 -1.18126639e-01 -2.35783470e-03]
 [ 4.27748344e-01  6.68865455e-02 -2.78808014e-01]
 [ 5.83932436e-02  2.88175459e-02 -1.69530463e-01]
 [-5.02521748e-02  2.45194477e-02  7.50098964e-02]
 [ 7.03257918e-02  1.70258873e-02  4.84122435e-03]
 [ 7.28551828e-02  2.53718353e-02 -2.05794783e-01]
 [-1.48624282e-01 -2.56140735e-02 -1.67514742e-02]
 [-8.56366518e-02 -6.37598245e-03 -1.18420548e-01]
 [ 6.85697692e-02  3.52143781e-01 -1.74288279e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.27930914 -29.29219478 -29.25560936]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  8.31647217  -9.26300532 -83.45811031]
init_Out:  [2.54002979]
Stock Position:  8.316472170547405
Bond position:  [-829.10718727]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [4.98905245]
curr_Stock_Price:  100.34433830288808
curr_Factors:  [100.3443383   -1.63130481  -1.03589228]
mat_Sqrt:  [[ 6.96857366  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01047498 -0.03735492 -0.00672625]
Stock Position:  -0.010474980988052982
Bond Position:  [6.04015749]


portfolio before change:  [4.99016535]
curr_Stock_Price:  100.52648003522839
curr_Factors:  [100.52648004  -1.93353241  -0.99877893]
mat_Sqrt:  [[ 5.35542376  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.06956759  0.02115138 -0.79536166]
Stock Position:  0.06956758549338811
Bond Position:  [-2.00321914]


portfolio before change:  [4.950587]
curr_Stock_Price:  99.9719618085489
curr_Factors:  [99.97196181 -1.64276959 -0.97915284]
mat_Sqrt:  [[ 7.26426649  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00337709  0.00911291 -0.48362322]
Stock Position:  0.0033770854232052483
Bond Position:  [4.61297314]


portfolio before change:  [4.95239377]
curr_Stock_Price:  99.82381770116342
curr_Factors:  [99.8238177  -1.42176847 -1.01483155]
mat_Sqrt:  [[ 8.7303616   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00392971  0.00775373  0.21398236]
Stock Position:  -0.003929706006361626
Bond Position:  [5.34467202]


portfolio before change:  [4.95659999]
curr_Stock_Price:  99.43365666248523
curr_Factors:  [99.43365666 -1.39528613 -1.03042601]
mat_Sqrt:  [[ 8.79143993  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00816176 0.00538406 0.01381067]
Stock Position:  0.008161758447068042
Bond Position:  [4.1450465]


portfolio before change:  [4.96104311]
curr_Stock_Price:  99.7240447962078
curr_Factors:  [99.7240448  -1.17705523 -1.07503856]
mat_Sqrt:  [[10.4888525   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00300344  0.00802328 -0.58707523]
Stock Position:  0.0030034359385641175
Bond Position:  [4.66152833]


portfolio before change:  [4.96487589]
curr_Stock_Price:  100.22394904358315
curr_Factors:  [100.22394904  -0.64542103  -1.07478215]
mat_Sqrt:  [[17.94307047  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00851053 -0.00809988 -0.04778729]
Stock Position:  -0.008510528607595222
Bond Position:  [5.81783467]


portfolio before change:  [4.95292066]
curr_Stock_Price:  101.97059338835189
curr_Factors:  [101.97059339  -0.81379044  -1.115716  ]
mat_Sqrt:  [[14.80815495  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00742657 -0.00201626 -0.33782086]
Stock Position:  -0.007426568164612802
Bond Position:  [5.71021223]


portfolio before change:  [4.94245338]
curr_Stock_Price:  103.76457255755678
curr_Factors:  [103.76457256  -1.23466748  -1.08894232]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [4.94245338]
Stock Price:  105.85025394060902
PL:  [-0.90780057]
Settle:  Tensor("sub_316:0", shape=(), dtype=float64)
PL:  Tensor("sub_317:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  159
output_Z_Vals[:, i, :]:  [[ 1.19279309e+02 -2.92921948e+01 -2.92556094e+01]
 [-7.04779654e-02 -1.14653620e-01 -1.72427800e-03]
 [-1.27543713e-02 -8.57295061e-03  5.48657008e-02]
 [-5.28542199e-02  1.20090437e-01 -8.75318020e-02]
 [ 3.57061915e-02 -5.47178275e-02 -4.35666519e-02]
 [ 5.40653152e-02 -4.50440624e-03  2.09468724e-02]
 [ 7.43365545e-02  1.85550912e-02 -1.88495795e-01]
 [-2.07094898e-01  4.15162802e-02 -1.43255139e-01]
 [ 1.80580628e-02  4.04101149e-02 -1.09697130e-01]
 [ 6.92825594e-02  3.70777528e-01 -7.33998314e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.27930914 -29.29219478 -29.25560936]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  8.31647217  -9.26300532 -83.45811031]
init_Out:  [2.54002979]
Stock Position:  8.316472170547405
Bond position:  [-829.10718727]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [10.14096736]
curr_Stock_Price:  100.963821517023
curr_Factors:  [100.96382152  -1.1453111   -1.02415157]
mat_Sqrt:  [[11.53400445  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00639763 -0.03625666 -0.00491889]
Stock Position:  -0.006397628526298432
Bond Position:  [10.78689639]


portfolio before change:  [10.13565359]
curr_Stock_Price:  102.6376552141294
curr_Factors:  [102.63765521  -1.27517863  -1.07286107]
mat_Sqrt:  [[ 9.8076743   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00018111 -0.00271101  0.15651657]
Stock Position:  -0.0001811142595155703
Bond Position:  [10.15424273]


portfolio before change:  [10.14074454]
curr_Stock_Price:  102.56833150977836
curr_Factors:  [102.56833151  -1.19889162  -1.04714781]
mat_Sqrt:  [[10.85352374  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00623031  0.03797593 -0.24970387]
Stock Position:  -0.006230313215221332
Bond Position:  [10.77977737]


portfolio before change:  [10.14493954]
curr_Stock_Price:  102.76033311271348
curr_Factors:  [102.76033311  -1.17216653  -1.01163744]
mat_Sqrt:  [[11.57208163  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00219497 -0.0173033  -0.12428353]
Stock Position:  0.002194970493627642
Bond Position:  [9.91938364]


portfolio before change:  [10.14888137]
curr_Stock_Price:  102.29603964976808
curr_Factors:  [102.29603965  -1.33933958  -1.04913257]
mat_Sqrt:  [[ 9.38768581  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00620225 -0.00142442  0.0597556 ]
Stock Position:  0.006202250004874401
Bond Position:  [9.51441575]


portfolio before change:  [10.15431819]
curr_Stock_Price:  102.4054230880488
curr_Factors:  [102.40542309  -1.31980837  -1.04530872]
mat_Sqrt:  [[ 9.61979146  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00377754  0.00586764 -0.53772604]
Stock Position:  0.003777535295912656
Bond Position:  [9.76747809]


portfolio before change:  [10.15966884]
curr_Stock_Price:  102.52870301462545
curr_Factors:  [102.52870301  -1.10360647  -1.0256786 ]
mat_Sqrt:  [[12.19294765  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01929515  0.0131286  -0.40866704]
Stock Position:  -0.019295152529395884
Bond Position:  [12.1379758]


portfolio before change:  [10.12177296]
curr_Stock_Price:  104.80732654883454
curr_Factors:  [104.80732655  -1.23422041  -1.04030721]
mat_Sqrt:  [[10.7789598   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-3.05260013e-04  1.27788004e-02 -3.12935377e-01]
Stock Position:  -0.00030526001310547023
Bond Position:  [10.15376644]


portfolio before change:  [10.12670697]
curr_Stock_Price:  105.27951187694495
curr_Factors:  [105.27951188  -1.13206277  -1.03571546]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [10.12670697]
Stock Price:  105.07752872318964
PL:  [5.04917825]
Settle:  Tensor("sub_318:0", shape=(), dtype=float64)
PL:  Tensor("sub_319:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  160
output_Z_Vals[:, i, :]:  [[ 1.19279309e+02 -2.92921948e+01 -2.92556094e+01]
 [-6.65793939e-02 -8.04827934e-02  2.79159479e-02]
 [ 2.65184332e-01  6.94638558e-02 -1.90185358e-01]
 [ 3.59141942e-03  6.08132667e-02 -2.00432921e-01]
 [-1.94745784e-02  1.58397994e-02  3.92724958e-02]
 [ 1.00447594e-01  1.15683221e-01 -2.50322646e-02]
 [ 6.73257746e-02  4.78221967e-02 -3.14729852e-01]
 [-1.08523654e-01 -6.02952278e-02  4.34413860e-02]
 [-1.18568003e-01 -5.14784649e-02 -9.09793335e-02]
 [ 8.44958504e-03  5.63017474e-02  1.20389406e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.27930914 -29.29219478 -29.25560936]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  8.31647217  -9.26300532 -83.45811031]
init_Out:  [2.54002979]
Stock Position:  8.316472170547405
Bond position:  [-829.10718727]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [14.63060094]
curr_Stock_Price:  101.50366984246956
curr_Factors:  [101.50366984  -0.85092934  -1.04407404]
mat_Sqrt:  [[15.25781096  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00412635 -0.02545089  0.07963643]
Stock Position:  -0.004126354160999424
Bond Position:  [15.04944103]


portfolio before change:  [14.64287379]
curr_Stock_Price:  100.35344117403922
curr_Factors:  [100.35344117  -0.83307463  -1.03543793]
mat_Sqrt:  [[15.48986282  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0147294   0.0219664  -0.54254589]
Stock Position:  0.014729404624787105
Bond Position:  [13.16472735]


portfolio before change:  [14.64781351]
curr_Stock_Price:  100.24180817529994
curr_Factors:  [100.24180818  -1.20029259  -1.03364219]
mat_Sqrt:  [[10.73651527  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00332991  0.01923084 -0.57177933]
Stock Position:  -0.0033299060787118735
Bond Position:  [14.98160932]


portfolio before change:  [14.65405026]
curr_Stock_Price:  100.61897436861615
curr_Factors:  [100.61897437  -1.56511991  -0.98607291]
mat_Sqrt:  [[ 7.84713138  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00140805  0.00500898  0.1120335 ]
Stock Position:  -0.001408047270743798
Bond Position:  [14.79572653]


portfolio before change:  [14.66260623]
curr_Stock_Price:  99.79779778230329
curr_Factors:  [99.79779778 -1.85534384 -0.96491512]
mat_Sqrt:  [[ 5.94700158  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01653351  0.03658225 -0.07141008]
Stock Position:  0.01653351371158798
Bond Position:  [13.01259797]


portfolio before change:  [14.67779161]
curr_Stock_Price:  100.32263830405684
curr_Factors:  [100.3226383   -1.67700561  -0.98461079]
mat_Sqrt:  [[ 7.00605639  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 6.16120694e-04  1.51227064e-02 -8.97836665e-01]
Stock Position:  0.0006161206941684478
Bond Position:  [14.61598076]


portfolio before change:  [14.68460755]
curr_Stock_Price:  99.52104774716835
curr_Factors:  [99.52104775 -1.20138177 -0.99430864]
mat_Sqrt:  [[11.07487194  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00913898 -0.01906703  0.12392618]
Stock Position:  -0.009138980130829574
Bond Position:  [15.59412843]


portfolio before change:  [14.68820557]
curr_Stock_Price:  99.9807272630879
curr_Factors:  [99.98072726 -1.12642275 -0.97035444]
mat_Sqrt:  [[12.28280407  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01127334 -0.01627892 -0.25953871]
Stock Position:  -0.011273341876379442
Bond Position:  [15.81532248]


portfolio before change:  [14.69100085]
curr_Stock_Price:  100.43439537111401
curr_Factors:  [100.43439537  -1.24776013  -0.9781045 ]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [14.69100085]
Stock Price:  102.2658688148233
PL:  [12.42513203]
Settle:  Tensor("sub_320:0", shape=(), dtype=float64)
PL:  Tensor("sub_321:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  161
output_Z_Vals[:, i, :]:  [[ 1.19279309e+02 -2.92921948e+01 -2.92556094e+01]
 [-7.04779654e-02 -1.14653620e-01 -1.72427800e-03]
 [ 3.72109618e-01  6.76430842e-02 -2.49420769e-01]
 [-8.75870900e-03  6.59074056e-02 -2.20653440e-01]
 [-1.65261548e-02 -1.91298361e-02  2.43492340e-02]
 [ 4.15254435e-02 -6.57328700e-02  3.33965737e-02]
 [ 1.27752757e-01  3.33615987e-03 -2.11882011e-01]
 [ 5.02519315e-02 -1.39536021e-01 -5.28429131e-02]
 [ 2.36138328e-02  4.96835696e-02 -1.16549717e-01]
 [ 7.65124847e-02  4.41603102e-01 -2.37334264e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.27930914 -29.29219478 -29.25560936]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  8.31647217  -9.26300532 -83.45811031]
init_Out:  [2.54002979]
Stock Position:  8.316472170547405
Bond position:  [-829.10718727]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [10.73454729]
curr_Stock_Price:  101.03519552206328
curr_Factors:  [101.03519552  -1.38649339  -0.96082437]
mat_Sqrt:  [[ 9.6615218   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00763754 -0.03625666 -0.00491889]
Stock Position:  -0.007637541729339317
Bond Position:  [11.50620781]


portfolio before change:  [10.74733547]
curr_Stock_Price:  100.11426557161093
curr_Factors:  [100.11426557  -1.18241896  -0.94956057]
mat_Sqrt:  [[11.87378057  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.02719802  0.02139062 -0.71152803]
Stock Position:  0.027198022702616925
Bond Position:  [8.0244254]


portfolio before change:  [10.75732645]
curr_Stock_Price:  100.33405218339556
curr_Factors:  [100.33405218  -0.9429833   -0.94699186]
mat_Sqrt:  [[15.15802335  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00343697  0.02084175 -0.62946284]
Stock Position:  -0.0034369706808609667
Bond Position:  [11.10217164]


portfolio before change:  [10.76071273]
curr_Stock_Price:  100.96431332678776
curr_Factors:  [100.96431333  -0.4415907   -1.00770325]
mat_Sqrt:  [[23.69995541  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00050843 -0.00604939  0.06946159]
Stock Position:  -0.000508432114326413
Bond Position:  [10.81204623]


portfolio before change:  [10.76727463]
curr_Stock_Price:  98.69355388278538
curr_Factors:  [98.69355388  0.18816875 -0.97917473]
mat_Sqrt:  [[44.74651937  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00104243 -0.02078656  0.09527113]
Stock Position:  0.0010424335985763265
Bond Position:  [10.66439316]


portfolio before change:  [10.78345862]
curr_Stock_Price:  109.10232504202611
curr_Factors:  [109.10232504  -0.24902984  -1.02132701]
mat_Sqrt:  [[30.62845115  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00276177  0.00105499 -0.6044404 ]
Stock Position:  0.0027617675249462796
Bond Position:  [10.48214336]


portfolio before change:  [10.79087295]
curr_Stock_Price:  109.8887609206303
curr_Factors:  [109.88876092  -0.35434368  -1.0770838 ]
mat_Sqrt:  [[26.25984882  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00136568 -0.04412516 -0.15074612]
Stock Position:  0.0013656823643468762
Bond Position:  [10.64079981]


portfolio before change:  [10.7912933]
curr_Stock_Price:  106.29979535602055
curr_Factors:  [ 1.06299795e+02 -4.21645059e-02 -1.07919558e+00]
mat_Sqrt:  [[34.63633491  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 3.19331033e-05  1.57113242e-02 -3.32483901e-01]
Stock Position:  3.1933103299137135e-05
Bond Position:  [10.78789881]


portfolio before change:  [10.79674711]
curr_Stock_Price:  108.13223236686999
curr_Factors:  [108.13223237  -0.16989705  -1.16120628]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [10.79674711]
Stock Price:  112.01388901006916
PL:  [-1.2171419]
Settle:  Tensor("sub_322:0", shape=(), dtype=float64)
PL:  Tensor("sub_323:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  162
output_Z_Vals[:, i, :]:  [[ 1.19279309e+02 -2.92921948e+01 -2.92556094e+01]
 [-7.04779654e-02 -1.14653620e-01 -1.72427800e-03]
 [ 6.21338853e-01  7.16033981e-02 -3.25777434e-01]
 [ 1.68837353e-02  5.35921836e-02 -1.89557887e-01]
 [-7.47599030e-02  4.65837389e-02  1.08518084e-01]
 [ 6.99875589e-02  1.59180797e-02  5.17666902e-03]
 [ 7.76306320e-02 -9.68697207e-04 -2.14717241e-01]
 [-8.07562483e-03 -1.05160903e-01  6.96214544e-02]
 [ 4.93014991e-02 -9.07321974e-02  3.72873843e-02]
 [-1.25960584e-02 -8.53548177e-02 -3.03262968e-03]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.27930914 -29.29219478 -29.25560936]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  8.31647217  -9.26300532 -83.45811031]
init_Out:  [2.54002979]
Stock Position:  8.316472170547405
Bond position:  [-829.10718727]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-7.10770903]
curr_Stock_Price:  98.88978386805786
curr_Factors:  [98.88978387 -1.31636637 -1.07410878]
mat_Sqrt:  [[ 9.05693521  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00814738 -0.03625666 -0.00491889]
Stock Position:  -0.008147378132342065
Bond Position:  [-6.30201657]


portfolio before change:  [-7.11061436]
curr_Stock_Price:  98.85953287467245
curr_Factors:  [98.85953287 -1.14564943 -1.14125213]
mat_Sqrt:  [[10.04222216  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0554348   0.02264298 -0.92935234]
Stock Position:  0.05543480273492148
Bond Position:  [-12.59087306]


portfolio before change:  [-7.05024017]
curr_Stock_Price:  100.06222854926158
curr_Factors:  [100.06222855  -1.20616006  -1.18535525]
mat_Sqrt:  [[ 9.1547875   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00223117  0.01694734 -0.54075589]
Stock Position:  -0.0022311672553063638
Bond Position:  [-6.8269846]


portfolio before change:  [-7.05180536]
curr_Stock_Price:  99.23344295523805
curr_Factors:  [99.23344296 -1.42641494 -1.19791999]
mat_Sqrt:  [[ 7.19322893  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00714644  0.01473107  0.30957189]
Stock Position:  -0.0071464366686816915
Bond Position:  [-6.34263984]


portfolio before change:  [-7.04671899]
curr_Stock_Price:  98.07783494188135
curr_Factors:  [98.07783494 -1.24642864 -1.1604741 ]
mat_Sqrt:  [[ 8.83621534  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00808663 0.00503374 0.0147676 ]
Stock Position:  0.00808663464036707
Bond Position:  [-7.83983861]


portfolio before change:  [-7.05334236]
curr_Stock_Price:  97.7436452749504
curr_Factors:  [97.74364527 -1.39340978 -1.20220267]
mat_Sqrt:  [[ 7.29169289  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 4.63220923e-03 -3.06328954e-04 -6.12528522e-01]
Stock Position:  0.00463220922622468
Bond Position:  [-7.50611138]


portfolio before change:  [-7.05802467]
curr_Stock_Price:  97.54324051104409
curr_Factors:  [97.54324051 -1.54548731 -1.1970518 ]
mat_Sqrt:  [[ 6.28242883  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00054446 -0.0332548   0.19861063]
Stock Position:  0.0005444633431412782
Bond Position:  [-7.11113339]


portfolio before change:  [-7.06166354]
curr_Stock_Price:  97.39186576391369
curr_Factors:  [97.39186576 -0.93910083 -1.26394604]
mat_Sqrt:  [[10.75849659  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00507228 -0.02869204  0.10637053]
Stock Position:  0.005072275555560698
Bond Position:  [-7.55566192]


portfolio before change:  [-7.07146619]
curr_Stock_Price:  96.2042580755777
curr_Factors:  [96.20425808 -1.2377959  -1.26498033]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-7.07146619]
Stock Price:  95.79728662079148
PL:  [-7.07146619]
Settle:  Tensor("sub_324:0", shape=(), dtype=float64)
PL:  Tensor("sub_325:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  163
output_Z_Vals[:, i, :]:  [[ 1.19279309e+02 -2.92921948e+01 -2.92556094e+01]
 [-7.04779654e-02 -1.14653620e-01 -1.72427800e-03]
 [ 4.23146180e-01  6.87958237e-02 -2.62486182e-01]
 [ 3.06972322e-03  5.87073041e-02 -2.15825832e-01]
 [-9.80385141e-02  7.73755704e-02  1.43675471e-01]
 [ 6.17468450e-02  3.11121452e-02  1.33218162e-02]
 [ 9.08345651e-02  4.09751124e-03 -1.68869719e-01]
 [-2.14391669e-01  5.10309224e-02 -1.58828687e-01]
 [-3.00794486e-02  1.60786012e-02 -1.10898213e-01]
 [ 7.04449100e-02  3.59157778e-01 -1.88199439e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.27930914 -29.29219478 -29.25560936]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  8.31647217  -9.26300532 -83.45811031]
init_Out:  [2.54002979]
Stock Position:  8.316472170547405
Bond position:  [-829.10718727]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [12.264217]
curr_Stock_Price:  101.21912804612346
curr_Factors:  [101.21912805  -1.11014232  -0.99290805]
mat_Sqrt:  [[12.35718144  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00597145 -0.03625666 -0.00491889]
Stock Position:  -0.005971448769894066
Bond Position:  [12.86864184]


portfolio before change:  [12.27892865]
curr_Stock_Price:  99.83324730598794
curr_Factors:  [99.83324731 -1.13841119 -0.95599907]
mat_Sqrt:  [[12.29375009  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.03020581  0.02175515 -0.74880002]
Stock Position:  0.030205812746568642
Bond Position:  [9.26338428]


portfolio before change:  [12.29531263]
curr_Stock_Price:  100.22228256080938
curr_Factors:  [100.22228256  -0.93931256  -0.997704  ]
mat_Sqrt:  [[14.44537049  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00273234  0.01856488 -0.61569103]
Stock Position:  -0.002732344200077753
Bond Position:  [12.5691544]


portfolio before change:  [12.30375201]
curr_Stock_Price:  99.43423009603072
curr_Factors:  [99.4342301  -0.77638488 -1.04879412]
mat_Sqrt:  [[16.02768314  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00416236  0.0244683   0.40986613]
Stock Position:  -0.004162364083803245
Bond Position:  [12.71763347]


portfolio before change:  [12.29658888]
curr_Stock_Price:  102.68323217856097
curr_Factors:  [102.68323218  -0.86449078  -1.07809058]
mat_Sqrt:  [[14.71794464  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00443469 0.00983852 0.03800343]
Stock Position:  0.004434685892773341
Bond Position:  [11.841221]


portfolio before change:  [12.30829811]
curr_Stock_Price:  103.98820352521398
curr_Factors:  [103.98820353  -1.05759892  -1.0498217 ]
mat_Sqrt:  [[12.63987939  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0044676   0.00129575 -0.4817383 ]
Stock Position:  0.004467603972343439
Bond Position:  [11.84372]


portfolio before change:  [12.30916566]
curr_Stock_Price:  102.8565478062109
curr_Factors:  [102.85654781  -1.1068656   -1.02418012]
mat_Sqrt:  [[12.21041851  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02010536  0.01613739 -0.45309403]
Stock Position:  -0.02010535727958242
Bond Position:  [14.37713331]


portfolio before change:  [12.30347675]
curr_Stock_Price:  103.49713730779473
curr_Factors:  [103.49713731  -1.09953717  -0.99541822]
mat_Sqrt:  [[12.73798615  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00410593  0.0050845  -0.31636173]
Stock Position:  -0.004105931914862969
Bond Position:  [12.72842895]


portfolio before change:  [12.31077541]
curr_Stock_Price:  103.26993888350123
curr_Factors:  [103.26993888  -0.61285198  -1.00252037]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [12.31077541]
Stock Price:  104.09595652093303
PL:  [8.21481889]
Settle:  Tensor("sub_326:0", shape=(), dtype=float64)
PL:  Tensor("sub_327:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  164
output_Z_Vals[:, i, :]:  [[ 1.19279309e+02 -2.92921948e+01 -2.92556094e+01]
 [-6.98307499e-02 -1.08980802e-01  3.19639925e-03]
 [ 2.25159855e-01  4.90115151e-02 -8.95405599e-02]
 [-4.73732044e-02  1.31757225e-01 -1.07209679e-02]
 [ 4.28567590e-02 -6.61677812e-02 -5.48609900e-02]
 [ 8.91199282e-02  1.57979552e-01 -1.38499898e-02]
 [ 7.11093549e-02  3.12181955e-02 -2.58593129e-01]
 [-1.94376104e-01  2.61888021e-02 -1.15873488e-01]
 [-5.95597457e-02 -1.19449894e-02 -9.90087548e-02]
 [ 6.80046159e-02  3.49086964e-01 -1.81499267e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.27930914 -29.29219478 -29.25560936]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  8.31647217  -9.26300532 -83.45811031]
init_Out:  [2.54002979]
Stock Position:  8.316472170547405
Bond position:  [-829.10718727]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-3.78616596]
curr_Stock_Price:  99.2891771440815
curr_Factors:  [99.28917714 -0.97628289 -0.99813891]
mat_Sqrt:  [[13.78546503  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00522232 -0.03446276  0.00911844]
Stock Position:  -0.0052223236386066555
Bond Position:  [-3.26764575]


portfolio before change:  [-3.79785627]
curr_Stock_Price:  101.21477192830663
curr_Factors:  [101.21477193  -1.17473735  -0.97792912]
mat_Sqrt:  [[11.75852191  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01770188  0.0154988  -0.25543429]
Stock Position:  0.0177018793775657
Bond Position:  [-5.58954796]


portfolio before change:  [-3.76088657]
curr_Stock_Price:  103.46115370757438
curr_Factors:  [103.46115371  -1.09969774  -0.99052509]
mat_Sqrt:  [[12.79396263  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00360792  0.04166529 -0.03058394]
Stock Position:  -0.0036079248656075064
Bond Position:  [-3.3876065]


portfolio before change:  [-3.75700649]
curr_Stock_Price:  101.9161360730121
curr_Factors:  [101.91613607  -0.83072277  -1.02246458]
mat_Sqrt:  [[15.9740085   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00187491 -0.02092409 -0.15650313]
Stock Position:  0.001874912079655882
Bond Position:  [-3.94809028]


portfolio before change:  [-3.7553157]
curr_Stock_Price:  103.87106636568346
curr_Factors:  [103.87106637  -1.21163478  -1.06500844]
mat_Sqrt:  [[10.66009321  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00847758  0.04995752 -0.03951017]
Stock Position:  0.008477583037724232
Bond Position:  [-4.63589129]


portfolio before change:  [-3.76703174]
curr_Stock_Price:  102.76255307476949
curr_Factors:  [102.76255307  -1.62679063  -1.05430328]
mat_Sqrt:  [[ 7.03802162  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00271814  0.00987206 -0.73769422]
Stock Position:  0.002718136542498221
Bond Position:  [-4.04635439]


portfolio before change:  [-3.77061548]
curr_Stock_Price:  102.1886102385311
curr_Factors:  [102.18861024  -1.38355261  -1.05015724]
mat_Sqrt:  [[ 8.96304828  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02424984  0.00828163 -0.33055481]
Stock Position:  -0.02424984019028856
Bond Position:  [-1.29255801]


portfolio before change:  [-3.77430552]
curr_Stock_Price:  102.31412049165986
curr_Factors:  [102.31412049  -1.21973942  -1.02628262]
mat_Sqrt:  [[10.82681196  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00739629 -0.00377734 -0.28244442]
Stock Position:  -0.007396290038281961
Bond Position:  [-3.01756061]


portfolio before change:  [-3.7845069]
curr_Stock_Price:  103.48933382427134
curr_Factors:  [103.48933382  -1.0736232   -1.03261932]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-3.7845069]
Stock Price:  102.04440039156982
PL:  [-5.82890729]
Settle:  Tensor("sub_328:0", shape=(), dtype=float64)
PL:  Tensor("sub_329:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  165
output_Z_Vals[:, i, :]:  [[ 1.19279309e+02 -2.92921948e+01 -2.92556094e+01]
 [-7.04779654e-02 -1.14653620e-01 -1.72427800e-03]
 [-1.16545187e-01 -2.99380484e-02  6.98075239e-02]
 [-5.44984951e-02  1.08551037e-01 -1.46612067e-01]
 [ 4.24682687e-02 -9.90213555e-02 -5.64600883e-02]
 [ 4.70353509e-02 -4.01758806e-02  2.79271683e-02]
 [ 2.39361430e-02 -3.54164532e-02  1.01687558e-01]
 [-1.76208341e-01  1.35740544e-02 -1.13955568e-01]
 [-1.09312819e-01 -9.55931772e-03 -1.26676871e-01]
 [ 7.32807643e-02  3.84499522e-01 -6.71751549e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.27930914 -29.29219478 -29.25560936]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  8.31647217  -9.26300532 -83.45811031]
init_Out:  [2.54002979]
Stock Position:  8.316472170547405
Bond position:  [-829.10718727]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [25.64533736]
curr_Stock_Price:  102.82811802168428
curr_Factors:  [102.82811802  -1.21864178  -0.98012911]
mat_Sqrt:  [[11.40769302  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00646847 -0.03625666 -0.00491889]
Stock Position:  -0.0064684661269309935
Bond Position:  [26.31047756]


portfolio before change:  [25.65737407]
curr_Stock_Price:  103.00154729019074
curr_Factors:  [103.00154729  -0.67139463  -1.02653378]
mat_Sqrt:  [[18.85570659  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00546619 -0.00946724  0.19914144]
Stock Position:  -0.005466185127813707
Bond Position:  [26.22039959]


portfolio before change:  [25.67760942]
curr_Stock_Price:  101.69865118245357
curr_Factors:  [101.69865118  -0.70193574  -0.95544703]
mat_Sqrt:  [[19.38755314  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00421006  0.03432685 -0.41824342]
Stock Position:  -0.004210061047463044
Bond Position:  [26.10576695]


portfolio before change:  [25.68595608]
curr_Stock_Price:  102.81727680887263
curr_Factors:  [102.81727681  -0.47950157  -0.90459021]
mat_Sqrt:  [[25.7609974   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00110192 -0.0313133  -0.16106492]
Stock Position:  0.0011019247667874348
Bond Position:  [25.57265918]


portfolio before change:  [25.69749111]
curr_Stock_Price:  101.67881776041884
curr_Factors:  [101.67881776  -0.41279238  -0.8555238 ]
mat_Sqrt:  [[28.60274866  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00180747 -0.01270473  0.07966844]
Stock Position:  0.001807470465408759
Bond Position:  [25.51370965]


portfolio before change:  [25.70587804]
curr_Stock_Price:  99.25934902194291
curr_Factors:  [99.25934902  0.21992751 -0.80871567]
mat_Sqrt:  [[55.08888369  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00079469 -0.01119967  0.2900863 ]
Stock Position:  0.000794689909706645
Bond Position:  [25.62699763]


portfolio before change:  [25.72191475]
curr_Stock_Price:  103.3112512186075
curr_Factors:  [103.31125122  -0.10571647  -0.86724935]
mat_Sqrt:  [[39.04756319  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00509939  0.00429249 -0.32508352]
Stock Position:  -0.0050993948737896285
Bond Position:  [26.24873961]


portfolio before change:  [25.7409936]
curr_Stock_Price:  102.14420994203711
curr_Factors:  [ 1.02144210e+02 -4.31729966e-02 -9.29247311e-01]
mat_Sqrt:  [[38.62753368  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00350572 -0.00302292 -0.36137385]
Stock Position:  -0.003505723377967836
Bond Position:  [26.09908295]


portfolio before change:  [25.74522786]
curr_Stock_Price:  104.65967978395099
curr_Factors:  [104.65967978  -0.34303223  -0.99494087]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [25.74522786]
Stock Price:  104.86569258239908
PL:  [20.87953528]
Settle:  Tensor("sub_330:0", shape=(), dtype=float64)
PL:  Tensor("sub_331:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  166
output_Z_Vals[:, i, :]:  [[ 1.19279309e+02 -2.92921948e+01 -2.92556094e+01]
 [-7.04779654e-02 -1.14653620e-01 -1.72427800e-03]
 [ 1.43817638e-01  2.91240139e-02 -4.89899555e-03]
 [-5.13457938e-02  1.45199676e-01  3.17688587e-02]
 [ 3.08225300e-02 -1.10481743e-01 -4.26410363e-02]
 [ 4.68248735e-02 -3.86717877e-02  2.81344737e-02]
 [ 1.08056193e-01 -7.42352729e-03 -9.42830012e-02]
 [-6.28247038e-02 -9.76523932e-02  1.92930961e-02]
 [-7.93879797e-02  6.27241216e-03 -1.27089822e-01]
 [ 7.58592525e-02  4.16618294e-01 -1.51758171e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.27930914 -29.29219478 -29.25560936]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  8.31647217  -9.26300532 -83.45811031]
init_Out:  [2.54002979]
Stock Position:  8.316472170547405
Bond position:  [-829.10718727]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [7.90379881]
curr_Stock_Price:  100.69481700310516
curr_Factors:  [100.694817    -1.28932638  -1.03470208]
mat_Sqrt:  [[ 9.85585671  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00748695 -0.03625666 -0.00491889]
Stock Position:  -0.0074869469024060895
Bond Position:  [8.65769556]


portfolio before change:  [7.90273375]
curr_Stock_Price:  101.41540317383178
curr_Factors:  [101.41540317  -0.75000331  -1.06678832]
mat_Sqrt:  [[16.4847111   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00870926  0.00920982 -0.01397547]
Stock Position:  0.008709258690807273
Bond Position:  [7.01948077]


portfolio before change:  [7.93423106]
curr_Stock_Price:  104.6288452981172
curr_Factors:  [104.6288453   -0.76195407  -1.05995103]
mat_Sqrt:  [[16.92030152  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00242974  0.04591617  0.09062771]
Stock Position:  -0.002429741756501445
Bond Position:  [8.18845214]


portfolio before change:  [7.93814379]
curr_Stock_Price:  104.70396425753407
curr_Factors:  [104.70396426  -0.7644932   -1.04339402]
mat_Sqrt:  [[17.17147815  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00112197 -0.03493739 -0.12164301]
Stock Position:  0.0011219673937918298
Bond Position:  [7.82066936]


portfolio before change:  [7.93899665]
curr_Stock_Price:  101.97799278368325
curr_Factors:  [101.97799278  -0.47853796  -1.046833  ]
mat_Sqrt:  [[22.18432764  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00232458 -0.01222909  0.08025982]
Stock Position:  0.0023245824023650228
Bond Position:  [7.70194041]


portfolio before change:  [7.9473512]
curr_Stock_Price:  103.91494854402538
curr_Factors:  [103.91494854  -0.51109599  -1.01599293]
mat_Sqrt:  [[22.56689136  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00392695 -0.00234753 -0.26896316]
Stock Position:  0.003926951210167601
Bond Position:  [7.53928227]


portfolio before change:  [7.96120175]
curr_Stock_Price:  106.48181549177403
curr_Factors:  [106.48181549  -0.58362957  -1.02423559]
mat_Sqrt:  [[21.32988323  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00287896 -0.0308804   0.05503783]
Stock Position:  -0.0028789604856915936
Bond Position:  [8.26775869]


portfolio before change:  [7.97613113]
curr_Stock_Price:  102.73238344457984
curr_Factors:  [102.73238344  -0.30120054  -1.05419348]
mat_Sqrt:  [[26.4891012   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00397024  0.00198351 -0.36255189]
Stock Position:  -0.003970241465716142
Bond Position:  [8.38400349]


portfolio before change:  [7.96630761]
curr_Stock_Price:  106.26278952023306
curr_Factors:  [ 1.06262790e+02 -5.09938415e-02 -1.06203938e+00]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [7.96630761]
Stock Price:  104.08935834928988
PL:  [3.87694926]
Settle:  Tensor("sub_332:0", shape=(), dtype=float64)
PL:  Tensor("sub_333:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  167
output_Z_Vals[:, i, :]:  [[ 1.19279309e+02 -2.92921948e+01 -2.92556094e+01]
 [-7.04779654e-02 -1.14653620e-01 -1.72427800e-03]
 [ 1.13216934e-01  1.71050758e-02  3.72521900e-02]
 [-5.42552977e-02  1.10640432e-01 -1.36158489e-01]
 [ 4.12631284e-02 -6.04660446e-02 -5.12836692e-02]
 [ 7.51387528e-02  9.29781917e-02  2.85129407e-05]
 [ 8.47064388e-02  7.50032963e-03 -1.61546266e-01]
 [-1.65876366e-01 -6.08025976e-03 -5.41283753e-02]
 [-1.33426773e-01 -2.35627768e-02 -1.26155642e-01]
 [ 1.48329376e-02  9.53040328e-02  1.48207612e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.27930914 -29.29219478 -29.25560936]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  8.31647217  -9.26300532 -83.45811031]
init_Out:  [2.54002979]
Stock Position:  8.316472170547405
Bond position:  [-829.10718727]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [30.80683588]
curr_Stock_Price:  103.44875360111574
curr_Factors:  [103.4487536   -0.69181769  -0.94769119]
mat_Sqrt:  [[20.07685128  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00367539 -0.03625666 -0.00491889]
Stock Position:  -0.0036753908691265487
Bond Position:  [31.18705049]


portfolio before change:  [30.82810265]
curr_Stock_Price:  101.90623941671585
curr_Factors:  [101.90623942  -0.95617234  -0.90783767]
mat_Sqrt:  [[15.80052474  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.0076746  0.0054091  0.10627013]
Stock Position:  0.007674596780509633
Bond Position:  [30.04601335]


portfolio before change:  [30.84406578]
curr_Stock_Price:  102.02824824877119
curr_Factors:  [102.02824825  -1.01583702  -0.96031418]
mat_Sqrt:  [[14.14128467  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00560004  0.03498758 -0.38842227]
Stock Position:  -0.005600043493564945
Bond Position:  [31.41542841]


portfolio before change:  [30.85929079]
curr_Stock_Price:  102.11514705996532
curr_Factors:  [102.11514706  -0.91616485  -0.94249857]
mat_Sqrt:  [[15.91779474  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00183654 -0.01912104 -0.14629803]
Stock Position:  0.0018365399992062684
Bond Position:  [30.67175223]


portfolio before change:  [30.87666621]
curr_Stock_Price:  103.22359488018932
curr_Factors:  [103.22359488  -1.21328254  -1.04591592]
mat_Sqrt:  [[10.78006936  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [7.19339152e-03 2.94022859e-02 8.13394834e-05]
Stock Position:  0.007193391521603947
Bond Position:  [30.13413847]


portfolio before change:  [30.88293743]
curr_Stock_Price:  102.00030346145495
curr_Factors:  [102.00030346  -0.98896809  -1.11155915]
mat_Sqrt:  [[12.48400913  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00415929  0.00237181 -0.46084653]
Stock Position:  0.004159289089780218
Bond Position:  [30.45868868]


portfolio before change:  [30.89432578]
curr_Stock_Price:  101.0759155570475
curr_Factors:  [101.07591556  -1.12098078  -1.11780174]
mat_Sqrt:  [[10.77349943  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01643684 -0.00192275 -0.15441319]
Stock Position:  -0.016436838084051802
Bond Position:  [32.55569424]


portfolio before change:  [30.91611572]
curr_Stock_Price:  100.74081370679424
curr_Factors:  [100.74081371  -0.51017975  -1.05757995]
mat_Sqrt:  [[21.00564728  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00760684 -0.0074512  -0.35988693]
Stock Position:  -0.007606838857050003
Bond Position:  [31.68243485]


portfolio before change:  [30.93792594]
curr_Stock_Price:  99.95664520979578
curr_Factors:  [99.95664521 -0.43675101 -1.05010798]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [30.93792594]
Stock Price:  105.71597349744455
PL:  [25.22195244]
Settle:  Tensor("sub_334:0", shape=(), dtype=float64)
PL:  Tensor("sub_335:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  168
output_Z_Vals[:, i, :]:  [[ 1.19279309e+02 -2.92921948e+01 -2.92556094e+01]
 [-4.99088824e-02  6.56335894e-02  1.54659227e-01]
 [ 5.50738697e-01  7.26331955e-02 -2.87962650e-01]
 [-2.36717959e-02  7.74178458e-02 -2.11502708e-01]
 [-1.20478977e-02 -3.33558291e-02  1.47627968e-02]
 [ 4.07668447e-02 -6.67312638e-02  3.41479454e-02]
 [ 8.28396236e-02 -1.54810534e-02 -1.37484424e-02]
 [-1.47839221e-01 -2.65029651e-02 -1.50506280e-02]
 [-1.19768369e-01 -1.12904249e-02 -1.31549518e-01]
 [ 7.21526935e-02  3.69367856e-01 -2.60588757e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.27930914 -29.29219478 -29.25560936]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  8.31647217  -9.26300532 -83.45811031]
init_Out:  [2.54002979]
Stock Position:  8.316472170547405
Bond position:  [-829.10718727]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-9.01284314]
curr_Stock_Price:  98.6607042691907
curr_Factors:  [98.66070427 -0.7129669  -0.99541708]
mat_Sqrt:  [[17.87320663  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00093126  0.02075516  0.44119973]
Stock Position:  -0.0009312569443705029
Bond Position:  [-8.92096467]


portfolio before change:  [-9.01751048]
curr_Stock_Price:  98.88163911379219
curr_Factors:  [98.88163911 -0.75599327 -1.0359986 ]
mat_Sqrt:  [[16.47644351  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.02997212  0.02296863 -0.82147729]
Stock Position:  0.029972120402228845
Bond Position:  [-11.98120287]


portfolio before change:  [-8.97792347]
curr_Stock_Price:  100.40235591962677
curr_Factors:  [100.40235592  -1.08005648  -1.04480396]
mat_Sqrt:  [[11.99302502  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00540695  0.02448167 -0.60335836]
Stock Position:  -0.005406949886298182
Bond Position:  [-8.43505297]


portfolio before change:  [-8.98483042]
curr_Stock_Price:  100.89956128076265
curr_Factors:  [100.89956128  -0.76786676  -1.09902502]
mat_Sqrt:  [[15.59942104  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00063436 -0.01054804  0.04211415]
Stock Position:  -0.0006343631762818444
Bond Position:  [-8.92082345]


portfolio before change:  [-8.98900942]
curr_Stock_Price:  100.45419918527514
curr_Factors:  [100.45419919  -0.99812643  -1.0587619 ]
mat_Sqrt:  [[12.84318819  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00358278 -0.02110228  0.09741458]
Stock Position:  0.00358277635747519
Bond Position:  [-9.34891435]


portfolio before change:  [-8.9984667]
curr_Stock_Price:  99.11957656731147
curr_Factors:  [99.11957657 -0.86791082 -1.0607146 ]
mat_Sqrt:  [[14.40681779  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00552749 -0.00489554 -0.03922048]
Stock Position:  0.0055274882126074365
Bond Position:  [-9.546349]


portfolio before change:  [-8.99735072]
curr_Stock_Price:  100.18522366555685
curr_Factors:  [100.18522367  -0.62964883  -1.06805972]
mat_Sqrt:  [[18.34417639  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00826397 -0.00838097 -0.04293525]
Stock Position:  -0.008263969870549412
Bond Position:  [-8.16942305]


portfolio before change:  [-9.01064297]
curr_Stock_Price:  101.29927850150762
curr_Factors:  [101.2992785   -0.50325674  -1.14021907]
mat_Sqrt:  [[19.5818571   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00750247 -0.00357035 -0.37527416]
Stock Position:  -0.007502471235344562
Bond Position:  [-8.25064805]


portfolio before change:  [-9.03517838]
curr_Stock_Price:  104.01959002228986
curr_Factors:  [104.01959002  -0.88100439  -1.13152704]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-9.03517838]
Stock Price:  104.24898665426085
PL:  [-13.28416504]
Settle:  Tensor("sub_336:0", shape=(), dtype=float64)
PL:  Tensor("sub_337:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  169
output_Z_Vals[:, i, :]:  [[ 1.19279309e+02 -2.92921948e+01 -2.92556094e+01]
 [-7.04779654e-02 -1.14653620e-01 -1.72427800e-03]
 [ 8.40667249e-01  7.71021113e-02 -3.77827368e-01]
 [ 1.33481005e-01 -2.16835905e-02 -1.68914410e-01]
 [-1.99114443e-02  3.48739643e-02  4.61646126e-02]
 [ 6.85104714e-02  1.10802050e-02  6.64157987e-03]
 [ 6.98482714e-02  3.89486831e-02 -2.44759466e-01]
 [-1.00948778e-01 -6.07687768e-02  3.96867600e-02]
 [ 8.67932746e-03 -7.89618366e-02  4.68224792e-03]
 [-1.72311684e-03 -7.97045125e-03  6.96663799e-03]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.27930914 -29.29219478 -29.25560936]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  8.31647217  -9.26300532 -83.45811031]
init_Out:  [2.54002979]
Stock Position:  8.316472170547405
Bond position:  [-829.10718727]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-11.14021071]
curr_Stock_Price:  98.40490258655481
curr_Factors:  [98.40490259 -1.42677797 -0.93261571]
mat_Sqrt:  [[ 9.29704811  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00793696 -0.03625666 -0.00491889]
Stock Position:  -0.007936957516203274
Bond Position:  [-10.35917518]


portfolio before change:  [-11.14035114]
curr_Stock_Price:  97.76984158075669
curr_Factors:  [97.76984158 -1.04498636 -0.98268906]
mat_Sqrt:  [[12.87053693  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0594796   0.02438183 -1.07783631]
Stock Position:  0.05947959530725488
Bond Position:  [-16.95566175]


portfolio before change:  [-11.04963385]
curr_Stock_Price:  99.4375941159841
curr_Factors:  [99.43759412 -1.40121445 -0.94010786]
mat_Sqrt:  [[ 9.56593112  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01029086 -0.00685695 -0.48186579]
Stock Position:  0.010290856811859157
Bond Position:  [-12.07293189]


portfolio before change:  [-11.04474093]
curr_Stock_Price:  100.49978885659837
curr_Factors:  [100.49978886  -1.79709078  -0.90719631]
mat_Sqrt:  [[ 6.7252462   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00142563  0.01102812  0.13169479]
Stock Position:  -0.0014256266599959344
Bond Position:  [-10.90146575]


portfolio before change:  [-11.04959186]
curr_Stock_Price:  100.0781081623904
curr_Factors:  [100.07810816  -1.36206039  -0.852657  ]
mat_Sqrt:  [[10.92696478  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00642011 0.00350387 0.01894658]
Stock Position:  0.006420105610677257
Bond Position:  [-11.69210389]


portfolio before change:  [-11.0595618]
curr_Stock_Price:  99.43599712579521
curr_Factors:  [99.43599713 -1.36923751 -0.84548799]
mat_Sqrt:  [[10.85676831  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00192439  0.01231666 -0.69823063]
Stock Position:  0.0019243852900560523
Bond Position:  [-11.25091497]


portfolio before change:  [-11.06502827]
curr_Stock_Price:  99.51934251754797
curr_Factors:  [99.51934252 -1.04476568 -0.83586883]
mat_Sqrt:  [[15.17603469  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00622144 -0.01921677  0.11321528]
Stock Position:  -0.006221440403312353
Bond Position:  [-10.44587462]


portfolio before change:  [-11.05858042]
curr_Stock_Price:  97.6432344946738
curr_Factors:  [97.64323449 -0.7967788  -0.85962421]
mat_Sqrt:  [[18.63268629  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00040769 -0.02496993  0.01335715]
Stock Position:  0.00040768686512523234
Bond Position:  [-11.09838829]


portfolio before change:  [-11.06356044]
curr_Stock_Price:  99.04275413412974
curr_Factors:  [99.04275413 -0.44002228 -0.86351422]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-11.06356044]
Stock Price:  102.84694850537036
PL:  [-13.91050894]
Settle:  Tensor("sub_338:0", shape=(), dtype=float64)
PL:  Tensor("sub_339:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  170
output_Z_Vals[:, i, :]:  [[ 1.19279309e+02 -2.92921948e+01 -2.92556094e+01]
 [-5.83500531e-02 -2.13218998e-02  8.00312291e-02]
 [ 2.23481440e-02  1.23045340e-03  5.01130787e-02]
 [-5.49577345e-02  1.52712167e-01  4.92900998e-02]
 [ 2.37795035e-02 -8.75157985e-02 -3.50564199e-02]
 [ 8.83482273e-02  1.54480525e-01 -1.30840141e-02]
 [ 7.62406766e-02  1.70459981e-02 -1.98196791e-01]
 [-2.14391669e-01  5.10309224e-02 -1.58828687e-01]
 [-1.01356781e-01 -2.00547535e-02 -1.12838467e-01]
 [ 4.93173811e-02  2.41805675e-01 -2.14964686e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.27930914 -29.29219478 -29.25560936]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  8.31647217  -9.26300532 -83.45811031]
init_Out:  [2.54002979]
Stock Position:  8.316472170547405
Bond position:  [-829.10718727]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [10.90230537]
curr_Stock_Price:  101.05536730582227
curr_Factors:  [101.05536731  -0.58898599  -0.96348692]
mat_Sqrt:  [[21.39582162  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00198937 -0.00674258  0.22830682]
Stock Position:  -0.0019893732844383
Bond Position:  [11.10334221]


portfolio before change:  [10.90577388]
curr_Stock_Price:  102.10320920375985
curr_Factors:  [102.1032092   -0.76496171  -1.00257622]
mat_Sqrt:  [[17.43441689  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00187039 0.0003891  0.14295866]
Stock Position:  0.0018703925530429454
Bond Position:  [10.71480079]


portfolio before change:  [10.91663232]
curr_Stock_Price:  105.04361071199389
curr_Factors:  [105.04361071  -1.15568444  -1.03229847]
mat_Sqrt:  [[11.77987649  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00347656  0.04829183  0.14061093]
Stock Position:  -0.0034765580023972125
Bond Position:  [11.28182253]


portfolio before change:  [10.92178006]
curr_Stock_Price:  105.18587299673712
curr_Factors:  [105.185873    -1.02699978  -1.00766231]
mat_Sqrt:  [[13.7503863   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00104462 -0.02767493 -0.10000621]
Stock Position:  0.0010446247302372971
Bond Position:  [10.8119003]


portfolio before change:  [10.92576216]
curr_Stock_Price:  103.82155833902934
curr_Factors:  [103.82155834  -1.48111611  -1.05613259]
mat_Sqrt:  [[ 8.2105913   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01092079  0.04885103 -0.03732505]
Stock Position:  0.010920788873556025
Bond Position:  [9.79194885]


portfolio before change:  [10.92820002]
curr_Stock_Price:  103.59636014085218
curr_Factors:  [103.59636014  -1.40831018  -1.06123009]
mat_Sqrt:  [[ 8.76671286  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.004132    0.00539042 -0.56540028]
Stock Position:  0.00413199936195651
Bond Position:  [10.50013993]


portfolio before change:  [10.93166811]
curr_Stock_Price:  103.16477774322226
curr_Factors:  [103.16477774  -1.09519196  -1.03449624]
mat_Sqrt:  [[12.26364619  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02001809  0.01613739 -0.45309403]
Stock Position:  -0.020018094367274527
Bond Position:  [12.99683036]


portfolio before change:  [10.97170843]
curr_Stock_Price:  101.48927955377728
curr_Factors:  [101.48927955  -0.88591668  -1.00132589]
mat_Sqrt:  [[15.3745048   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00812434 -0.00634187 -0.32189674]
Stock Position:  -0.00812433634496723
Bond Position:  [11.79624147]


portfolio before change:  [10.969581]
curr_Stock_Price:  102.47730089408275
curr_Factors:  [102.47730089  -1.63281004  -0.9889611 ]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [10.969581]
Stock Price:  102.03756751159945
PL:  [8.93201349]
Settle:  Tensor("sub_340:0", shape=(), dtype=float64)
PL:  Tensor("sub_341:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  171
output_Z_Vals[:, i, :]:  [[ 1.19279309e+02 -2.92921948e+01 -2.92556094e+01]
 [-2.86869089e-02 -2.57847815e-01 -2.78461164e-02]
 [ 1.14706265e+00  7.99083842e-02 -4.87211863e-01]
 [ 3.87104112e-01 -2.81164634e-01 -7.82983227e-02]
 [-2.27254308e-01  2.54032357e-01  3.40759222e-01]
 [ 1.02067282e-01  1.08057701e-01 -3.01198918e-02]
 [ 8.73464367e-02 -2.80371258e-02  1.60129511e-01]
 [ 1.29218895e-01 -9.65739682e-02 -6.37464859e-02]
 [-4.18064807e-02 -7.66280523e-02  1.24992352e-01]
 [-6.54306094e-03 -3.07251549e-02 -1.27192853e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.27930914 -29.29219478 -29.25560936]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  8.31647217  -9.26300532 -83.45811031]
init_Out:  [2.54002979]
Stock Position:  8.316472170547405
Bond position:  [-829.10718727]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-22.61928203]
curr_Stock_Price:  97.02462125103735
curr_Factors:  [97.02462125 -1.64900905 -0.97372808]
mat_Sqrt:  [[ 7.04436246  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00582431 -0.08153864 -0.07943722]
Stock Position:  -0.005824313525004092
Bond Position:  [-22.05418021]


portfolio before change:  [-22.62935873]
curr_Stock_Price:  96.86097298305086
curr_Factors:  [96.86097298 -1.67783869 -0.99812769]
mat_Sqrt:  [[ 6.66793555  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.15742116  0.02526925 -1.38987983]
Stock Position:  0.15742116318563665
Bond Position:  [-37.87732577]


portfolio before change:  [-22.6271155]
curr_Stock_Price:  96.9955586462127
curr_Factors:  [96.99555865 -1.52659608 -1.01818178]
mat_Sqrt:  [[ 7.61322857  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.04779338 -0.08891206 -0.22336332]
Stock Position:  0.04779337584274021
Bond Position:  [-27.26286069]


portfolio before change:  [-22.66546382]
curr_Stock_Price:  96.47846861441437
curr_Factors:  [96.47846861 -1.03209291 -1.01093735]
mat_Sqrt:  [[12.50701391  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01208426  0.08033208  0.97209121]
Stock Position:  -0.01208426219963087
Bond Position:  [-21.49959271]


portfolio before change:  [-22.65948326]
curr_Stock_Price:  95.0937716359276
curr_Factors:  [95.09377164 -1.11793368 -1.00901789]
mat_Sqrt:  [[11.33518842  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0087082   0.03417085 -0.08592367]
Stock Position:  0.0087082030425031
Bond Position:  [-23.48757913]


portfolio before change:  [-22.67567005]
curr_Stock_Price:  94.58390025635737
curr_Factors:  [94.58390026 -1.18656929 -0.90346379]
mat_Sqrt:  [[11.69842473  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01019871 -0.00886612  0.45680492]
Stock Position:  0.010198708256350528
Bond Position:  [-23.64030365]


portfolio before change:  [-22.70915326]
curr_Stock_Price:  92.46009153703986
curr_Factors:  [92.46009154 -0.82963189 -0.89125316]
mat_Sqrt:  [[16.54182562  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00687428 -0.03053937 -0.18185098]
Stock Position:  0.006874281712410697
Bond Position:  [-23.34474998]


portfolio before change:  [-22.73274555]
curr_Stock_Price:  90.7265294664265
curr_Factors:  [90.72652947 -0.87385004 -0.9083519 ]
mat_Sqrt:  [[15.2663013   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00119682 -0.02423192  0.35656839]
Stock Position:  -0.0011968224037844802
Bond Position:  [-22.62416201]


portfolio before change:  [-22.74349333]
curr_Stock_Price:  90.25266962596737
curr_Factors:  [90.25266963 -1.05008566 -0.85142598]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-22.74349333]
Stock Price:  89.82478719957598
PL:  [-22.74349333]
Settle:  Tensor("sub_342:0", shape=(), dtype=float64)
PL:  Tensor("sub_343:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  172
output_Z_Vals[:, i, :]:  [[ 1.19279309e+02 -2.92921948e+01 -2.92556094e+01]
 [-7.04779654e-02 -1.14653620e-01 -1.72427800e-03]
 [ 3.86442986e-01  6.85794195e-02 -2.48482135e-01]
 [-5.42260049e-02  1.17774237e-01 -1.04049582e-01]
 [ 2.95476044e-02 -5.11711261e-02 -3.59761147e-02]
 [ 6.00390342e-02  2.21073774e-02  1.50177830e-02]
 [ 7.83908597e-02 -1.31010088e-02 -3.72232661e-02]
 [-8.79224992e-02 -7.30320980e-02 -1.02018802e-02]
 [ 2.47870672e-02  5.14288585e-02 -1.17923737e-01]
 [ 6.57828722e-02  3.44016975e-01 -1.27019375e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.27930914 -29.29219478 -29.25560936]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  8.31647217  -9.26300532 -83.45811031]
init_Out:  [2.54002979]
Stock Position:  8.316472170547405
Bond position:  [-829.10718727]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [8.65131991]
curr_Stock_Price:  100.78470140201428
curr_Factors:  [100.7847014   -1.37188328  -1.0169351 ]
mat_Sqrt:  [[ 9.24578889  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00798096 -0.03625666 -0.00491889]
Stock Position:  -0.007980960498940282
Bond Position:  [9.45567863]


portfolio before change:  [8.66316676]
curr_Stock_Price:  99.89285038207767
curr_Factors:  [99.89285038 -1.01153112 -0.97762173]
mat_Sqrt:  [[13.66646828  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.02469493  0.02168672 -0.70885037]
Stock Position:  0.024694931300394758
Bond Position:  [6.19631968]


portfolio before change:  [8.72883738]
curr_Stock_Price:  102.42663698433428
curr_Factors:  [102.42663698  -1.2247982   -1.00203171]
mat_Sqrt:  [[11.04874556  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00655496  0.03724348 -0.2968245 ]
Stock Position:  -0.00655496307722233
Bond Position:  [9.4002402]


portfolio before change:  [8.72608285]
curr_Stock_Price:  103.56406835728946
curr_Factors:  [103.56406836  -1.32203123  -1.02091763]
mat_Sqrt:  [[ 9.94670737  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00209947 -0.01618173 -0.10262984]
Stock Position:  0.0020994664073292727
Bond Position:  [8.50865357]


portfolio before change:  [8.72815284]
curr_Stock_Price:  102.52313357384455
curr_Factors:  [102.52313357  -0.33781914  -1.02081149]
mat_Sqrt:  [[26.34972492  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00241655 0.00699097 0.04284155]
Stock Position:  0.00241654652907726
Bond Position:  [8.48040091]


portfolio before change:  [8.72939085]
curr_Stock_Price:  101.2803471797767
curr_Factors:  [ 1.01280347e+02 -8.46694766e-02 -1.02868510e+00]
mat_Sqrt:  [[33.26606489  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00211791 -0.0041429  -0.10618762]
Stock Position:  0.002117906821104386
Bond Position:  [8.51488851]


portfolio before change:  [8.742694]
curr_Stock_Price:  105.55090363651935
curr_Factors:  [105.55090364  -0.37380582  -1.04235539]
mat_Sqrt:  [[25.61126058  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0035879  -0.02309478 -0.02910312]
Stock Position:  -0.0035878995356557765
Bond Position:  [9.12140003]


portfolio before change:  [8.74405307]
curr_Stock_Price:  106.44356176779326
curr_Factors:  [ 1.06443562e+02 -8.76842360e-02 -1.05993684e+00]
mat_Sqrt:  [[33.78422016  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 6.04978470e-05  1.62632330e-02 -3.36403598e-01]
Stock Position:  6.049784699242394e-05
Bond Position:  [8.73761346]


portfolio before change:  [8.748153]
curr_Stock_Price:  101.98113927903154
curr_Factors:  [ 1.01981139e+02  2.99506720e-02 -1.06039899e+00]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [8.748153]
Stock Price:  104.72824812496795
PL:  [4.01990488]
Settle:  Tensor("sub_344:0", shape=(), dtype=float64)
PL:  Tensor("sub_345:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  173
output_Z_Vals[:, i, :]:  [[ 1.19279309e+02 -2.92921948e+01 -2.92556094e+01]
 [-5.35909400e-02 -1.72515856e-01 -1.22796500e-02]
 [ 5.60631223e-01  6.93093151e-02 -3.17178417e-01]
 [ 6.29750011e-02  2.15953859e-02 -1.95428220e-01]
 [-7.47490705e-02  4.60614044e-02  1.08330234e-01]
 [ 5.18970443e-02 -4.33334193e-02  2.31180520e-02]
 [ 7.31861073e-02 -3.20211081e-02  1.67531141e-01]
 [-1.77007998e-01  6.52362157e-03 -7.82452238e-02]
 [-1.25586897e-01 -3.37678513e-02 -1.11701465e-01]
 [ 3.22458526e-02  1.76238672e-01  2.19935883e-03]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.27930914 -29.29219478 -29.25560936]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  8.31647217  -9.26300532 -83.45811031]
init_Out:  [2.54002979]
Stock Position:  8.316472170547405
Bond position:  [-829.10718727]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [7.04429016]
curr_Stock_Price:  100.59146685305227
curr_Factors:  [100.59146685  -2.09600439  -0.96857974]
mat_Sqrt:  [[ 4.69493046  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01289728 -0.0545543  -0.03503042]
Stock Position:  -0.012897284400985322
Bond Position:  [8.34164692]


portfolio before change:  [7.06218328]
curr_Stock_Price:  99.52758008623182
curr_Factors:  [99.52758009 -1.54850784 -0.99203527]
mat_Sqrt:  [[ 7.84512     0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.06343778  0.02191753 -0.90482174]
Stock Position:  0.06343778154566358
Bond Position:  [0.74837439]


portfolio before change:  [7.08147862]
curr_Stock_Price:  99.82584175441622
curr_Factors:  [99.82584175 -1.0861224  -1.0136306 ]
mat_Sqrt:  [[12.22733579  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00193345  0.00682906 -0.55750232]
Stock Position:  0.0019334525104151325
Bond Position:  [6.88847009]


portfolio before change:  [7.08410551]
curr_Stock_Price:  99.40266027611639
curr_Factors:  [99.40266028 -1.2812007  -1.00087259]
mat_Sqrt:  [[10.14626421  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00507053  0.0145659   0.309036  ]
Stock Position:  -0.005070531645126194
Bond Position:  [7.58812985]


portfolio before change:  [7.09231724]
curr_Stock_Price:  98.53160554390148
curr_Factors:  [98.53160554 -0.92558773 -0.95619519]
mat_Sqrt:  [[15.00816603  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0036978  -0.01370323  0.06594937]
Stock Position:  0.0036977957653111485
Bond Position:  [6.72796748]


portfolio before change:  [7.09256251]
curr_Stock_Price:  97.68798107783499
curr_Factors:  [97.68798108 -0.52561535 -0.92992195]
mat_Sqrt:  [[22.78816291  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00467596 -0.01012596  0.47791971]
Stock Position:  0.004675957301056474
Bond Position:  [6.63577768]


portfolio before change:  [7.11278105]
curr_Stock_Price:  101.30217703615182
curr_Factors:  [101.30217704  -0.93872866  -0.9231383 ]
mat_Sqrt:  [[15.7405619   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01224933  0.00206295 -0.22321184]
Stock Position:  -0.012249327503787887
Bond Position:  [8.3536646]


portfolio before change:  [7.12226775]
curr_Stock_Price:  100.86877986881044
curr_Factors:  [100.86877987  -0.86067087  -0.89480029]
mat_Sqrt:  [[17.4327271   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00856204 -0.01067833 -0.31865319]
Stock Position:  -0.008562042196972715
Bond Position:  [7.9859105]


portfolio before change:  [7.12338072]
curr_Stock_Price:  101.20526324523054
curr_Factors:  [101.20526325  -0.69013977  -0.94088559]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [7.12338072]
Stock Price:  100.23532265484275
PL:  [6.88805807]
Settle:  Tensor("sub_346:0", shape=(), dtype=float64)
PL:  Tensor("sub_347:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  174
output_Z_Vals[:, i, :]:  [[ 1.19279309e+02 -2.92921948e+01 -2.92556094e+01]
 [-7.04779654e-02 -1.14653620e-01 -1.72427800e-03]
 [-1.21795265e-01 -3.16979237e-02  7.01318745e-02]
 [-5.12679895e-02  1.45037851e-01  3.13914363e-02]
 [ 3.65528557e-02 -1.17918922e-01 -5.10464533e-02]
 [ 9.87300349e-02  2.01930378e-01 -2.33890461e-02]
 [ 9.90325186e-02 -6.50614447e-03 -1.08235638e-01]
 [-4.86515024e-02 -1.11555941e-01  3.59494690e-02]
 [-1.54582000e-02  2.53735299e-02 -1.12303248e-01]
 [ 6.98540941e-02  3.56379581e-01 -1.90689159e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.27930914 -29.29219478 -29.25560936]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  8.31647217  -9.26300532 -83.45811031]
init_Out:  [2.54002979]
Stock Position:  8.316472170547405
Bond position:  [-829.10718727]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [11.55284397]
curr_Stock_Price:  101.13359020977964
curr_Factors:  [101.13359021  -1.25687867  -1.02823938]
mat_Sqrt:  [[10.29156135  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00716998 -0.03625666 -0.00491889]
Stock Position:  -0.007169978719304398
Bond Position:  [12.27796966]


portfolio before change:  [11.54379666]
curr_Stock_Price:  103.2518431165847
curr_Factors:  [103.25184312  -0.96450579  -1.03901505]
mat_Sqrt:  [[13.92450502  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00777752 -0.01002376  0.20006672]
Stock Position:  -0.007777518355493422
Bond Position:  [12.34683977]


portfolio before change:  [11.53925011]
curr_Stock_Price:  104.63036889355199
curr_Factors:  [104.63036889  -0.69215099  -1.09465066]
mat_Sqrt:  [[17.52506588  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00234609  0.045865    0.08955103]
Stock Position:  -0.002346089793475427
Bond Position:  [11.78472236]


portfolio before change:  [11.54660408]
curr_Stock_Price:  104.00799998496203
curr_Factors:  [104.00799998  -0.66710491  -1.10304609]
mat_Sqrt:  [[17.7133186   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00130345 -0.03728924 -0.14562132]
Stock Position:  0.001303447937460119
Bond Position:  [11.41103507]


portfolio before change:  [11.55267552]
curr_Stock_Price:  104.2876381589862
curr_Factors:  [104.28763816  -0.5539349   -1.05682469]
mat_Sqrt:  [[20.82997885  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00476091  0.06385599 -0.06672244]
Stock Position:  0.004760906699611541
Bond Position:  [11.05617181]


portfolio before change:  [11.56079731]
curr_Stock_Price:  104.83213995170654
curr_Factors:  [104.83213995  -0.35937812  -1.00247329]
mat_Sqrt:  [[26.85652982  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00285856 -0.00205742 -0.30876615]
Stock Position:  0.002858560812651265
Bond Position:  [11.26112826]


portfolio before change:  [11.57262235]
curr_Stock_Price:  106.99863935699959
curr_Factors:  [106.99863936  -0.67040959  -0.99076896]
mat_Sqrt:  [[20.32064924  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00217482 -0.03527709  0.10255383]
Stock Position:  -0.002174817806620275
Bond Position:  [11.8053249]


portfolio before change:  [11.5851226]
curr_Stock_Price:  103.96569303947102
curr_Factors:  [103.96569304  -1.11478101  -0.98353989]
mat_Sqrt:  [[12.7526624   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00295835  0.00802381 -0.32036991]
Stock Position:  -0.002958351890254658
Bond Position:  [11.8926897]


portfolio before change:  [11.59341012]
curr_Stock_Price:  103.17481579773609
curr_Factors:  [103.1748158   -0.62769811  -0.99261042]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [11.59341012]
Stock Price:  101.91658113570249
PL:  [9.67682899]
Settle:  Tensor("sub_348:0", shape=(), dtype=float64)
PL:  Tensor("sub_349:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  175
output_Z_Vals[:, i, :]:  [[ 1.19279309e+02 -2.92921948e+01 -2.92556094e+01]
 [-6.51872715e-02 -1.32781820e-01 -5.03126904e-03]
 [ 5.46625549e-01  7.33152493e-02 -2.81080389e-01]
 [ 1.74090832e-01 -5.37457732e-02 -1.98330673e-01]
 [-2.28470748e-01  2.55065118e-01  3.42402698e-01]
 [ 4.00573270e-02 -8.15415793e-02  3.43254764e-02]
 [-3.06597294e-01 -1.38872460e-01  3.66044602e-01]
 [-4.13130890e-03 -8.17414847e-02  8.11856235e-02]
 [-1.38654605e-01 -2.42623834e-02 -1.27289718e-01]
 [ 6.95697298e-02  3.69938472e-01 -6.60054822e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.27930914 -29.29219478 -29.25560936]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  8.31647217  -9.26300532 -83.45811031]
init_Out:  [2.54002979]
Stock Position:  8.316472170547405
Bond position:  [-829.10718727]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-17.17690209]
curr_Stock_Price:  97.6790309366959
curr_Factors:  [97.67903094 -1.26611564 -0.99807622]
mat_Sqrt:  [[10.1502166   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0068612  -0.0419893  -0.01435281]
Stock Position:  -0.00686120204649486
Bond Position:  [-16.50670652]


portfolio before change:  [-17.19293245]
curr_Stock_Price:  98.81220636764017
curr_Factors:  [98.81220637 -0.64167593 -0.99317098]
mat_Sqrt:  [[19.26662325  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.02549192  0.02318432 -0.80184411]
Stock Position:  0.02549192147098962
Bond Position:  [-19.71184545]


portfolio before change:  [-17.19864069]
curr_Stock_Price:  98.97500892655793
curr_Factors:  [98.97500893 -0.59107851 -1.01837894]
mat_Sqrt:  [[19.79461504  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00667955 -0.01699591 -0.56578221]
Stock Position:  0.006679546047319854
Bond Position:  [-17.85974882]


portfolio before change:  [-17.22020789]
curr_Stock_Price:  97.08339856489154
curr_Factors:  [97.08339856 -0.41990994 -1.02675993]
mat_Sqrt:  [[22.84884381  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00665208  0.08065867  0.97677959]
Stock Position:  -0.0066520799871777935
Bond Position:  [-16.57440136]


portfolio before change:  [-17.22705132]
curr_Stock_Price:  96.86604640190265
curr_Factors:  [96.8660464  -0.10062751 -0.96448139]
mat_Sqrt:  [[33.38878821  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00134652 -0.02578571  0.09792103]
Stock Position:  0.0013465176015175493
Bond Position:  [-17.35748316]


portfolio before change:  [-17.24281816]
curr_Stock_Price:  91.60363751932536
curr_Factors:  [91.60363752 -0.34135969 -0.8987482 ]
mat_Sqrt:  [[26.5057873   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00888351 -0.04391533  1.04422336]
Stock Position:  -0.008883509904545374
Bond Position:  [-16.42905634]


portfolio before change:  [-17.30786653]
curr_Stock_Price:  98.00108534150138
curr_Factors:  [98.00108534 -0.4861253  -0.89955544]
mat_Sqrt:  [[24.51530985  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00042137 -0.02584893  0.23159999]
Stock Position:  0.00042137264827364683
Bond Position:  [-17.34916151]


portfolio before change:  [-17.31539784]
curr_Stock_Price:  100.71945547879453
curr_Factors:  [100.71945548  -0.45512678  -0.86129231]
mat_Sqrt:  [[27.00224194  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00612038 -0.00767244 -0.36312213]
Stock Position:  -0.006120379278195546
Bond Position:  [-16.69895657]


portfolio before change:  [-17.34993359]
curr_Stock_Price:  104.99765324505037
curr_Factors:  [104.99765325  -0.83958104  -0.93681144]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-17.34993359]
Stock Price:  105.39270090918407
PL:  [-22.7426345]
Settle:  Tensor("sub_350:0", shape=(), dtype=float64)
PL:  Tensor("sub_351:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  176
output_Z_Vals[:, i, :]:  [[ 1.19279309e+02 -2.92921948e+01 -2.92556094e+01]
 [-7.04779654e-02 -1.14653620e-01 -1.72427800e-03]
 [ 3.86197974e-01  6.91846005e-02 -2.43825555e-01]
 [ 1.88494971e-01 -6.07795956e-02 -1.81589861e-01]
 [-1.67712716e-01  1.72317126e-01  2.49839517e-01]
 [ 4.01893409e-02 -7.26152203e-02  3.47233038e-02]
 [-2.23687224e-01 -1.15545866e-01  3.22707360e-01]
 [ 8.95064687e-02 -9.42601561e-02 -3.01402670e-02]
 [ 1.69082520e-01 -9.19057599e-02  1.10305934e-01]
 [-6.47611918e-03 -2.97373757e-02 -1.30054005e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.27930914 -29.29219478 -29.25560936]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  8.31647217  -9.26300532 -83.45811031]
init_Out:  [2.54002979]
Stock Position:  8.316472170547405
Bond position:  [-829.10718727]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-5.65714848]
curr_Stock_Price:  99.06420404487297
curr_Factors:  [99.06420404 -1.00088494 -1.0200458 ]
mat_Sqrt:  [[13.12918255  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00562033 -0.03625666 -0.00491889]
Stock Position:  -0.00562032522379742
Bond Position:  [-5.10037544]


portfolio before change:  [-5.66340931]
curr_Stock_Price:  99.72430885970469
curr_Factors:  [99.72430886 -0.82760044 -1.02760248]
mat_Sqrt:  [[15.59899601  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.02168176  0.02187809 -0.69556644]
Stock Position:  0.021681756286343896
Bond Position:  [-7.82560747]


portfolio before change:  [-5.68447714]
curr_Stock_Price:  98.933134617161
curr_Factors:  [98.93313462 -0.87588676 -1.00322117]
mat_Sqrt:  [[15.10969028  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00991806 -0.0192202  -0.51802533]
Stock Position:  0.009918057283071388
Bond Position:  [-6.66570164]


portfolio before change:  [-5.69828816]
curr_Stock_Price:  97.8767450254258
curr_Factors:  [97.87674503 -0.89138781 -0.93973972]
mat_Sqrt:  [[15.68306477  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00715837  0.05449146  0.7127226 ]
Stock Position:  -0.007158373091939573
Bond Position:  [-4.9976499]


portfolio before change:  [-5.69801961]
curr_Stock_Price:  97.49006610154498
curr_Factors:  [97.4900661  -0.22908607 -0.93574579]
mat_Sqrt:  [[30.41447442  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00149279 -0.02296295  0.09905592]
Stock Position:  0.0014927855741688136
Bond Position:  [-5.84355138]


portfolio before change:  [-5.7043117]
curr_Stock_Price:  95.23282471682133
curr_Factors:  [95.23282472 -0.23290614 -0.89997952]
mat_Sqrt:  [[30.67472466  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00524204 -0.03653881  0.92059427]
Stock Position:  -0.005242043500929625
Bond Position:  [-5.20509709]


portfolio before change:  [-5.70992995]
curr_Stock_Price:  95.80799140668928
curr_Factors:  [95.80799141 -0.16413986 -0.89243907]
mat_Sqrt:  [[33.306986    0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00242953 -0.02980768 -0.08598179]
Stock Position:  0.0024295301189593654
Bond Position:  [-5.94269835]


portfolio before change:  [-5.71606193]
curr_Stock_Price:  94.50737272905252
curr_Factors:  [ 9.45073727e+01  2.11700079e-02 -8.69246627e-01]
mat_Sqrt:  [[40.47162983  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00467551 -0.02906315  0.31467213]
Stock Position:  0.00467551290607708
Bond Position:  [-6.15793237]


portfolio before change:  [-5.74107411]
curr_Stock_Price:  89.81645660717697
curr_Factors:  [89.81645661 -0.18260086 -0.85071961]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-5.74107411]
Stock Price:  94.4042810866219
PL:  [-5.74107411]
Settle:  Tensor("sub_352:0", shape=(), dtype=float64)
PL:  Tensor("sub_353:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  177
output_Z_Vals[:, i, :]:  [[ 1.19279309e+02 -2.92921948e+01 -2.92556094e+01]
 [-7.04779654e-02 -1.14653620e-01 -1.72427800e-03]
 [ 2.42046388e-01  4.83381918e-02 -8.60756969e-02]
 [-5.63616812e-02  1.12406331e-01 -1.37663345e-01]
 [ 2.86257446e-02 -3.12653847e-02 -2.79148859e-02]
 [ 7.66846863e-02  3.78530466e-02 -1.46524970e-03]
 [ 8.11585775e-02 -1.07607873e-02 -7.80592578e-02]
 [-2.23316978e-02 -1.04060803e-01  8.66625679e-02]
 [-1.25352161e-01 -3.74966982e-02 -1.08251673e-01]
 [ 4.71015640e-02  2.62766082e-01  4.99655907e-03]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.27930914 -29.29219478 -29.25560936]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  8.31647217  -9.26300532 -83.45811031]
init_Out:  [2.54002979]
Stock Position:  8.316472170547405
Bond position:  [-829.10718727]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [4.17075114]
curr_Stock_Price:  100.24594305871919
curr_Factors:  [100.24594306  -1.35886012  -0.9934899 ]
mat_Sqrt:  [[ 9.53793092  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00773651 -0.03625666 -0.00491889]
Stock Position:  -0.007736507689260703
Bond Position:  [4.94630465]


portfolio before change:  [4.16458077]
curr_Stock_Price:  101.3632617471048
curr_Factors:  [101.36326175  -1.4202627   -1.00288813]
mat_Sqrt:  [[ 8.98503026  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.02512227  0.01528588 -0.24555   ]
Stock Position:  0.025122268894677065
Bond Position:  [1.61810565]


portfolio before change:  [4.18193849]
curr_Stock_Price:  102.02197869110833
curr_Factors:  [102.02197869  -1.2429445   -1.03359769]
mat_Sqrt:  [[10.47138263  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00778883  0.035546   -0.3927152 ]
Stock Position:  -0.007788825753554238
Bond Position:  [4.9765699]


portfolio before change:  [4.18807373]
curr_Stock_Price:  101.55382832910246
curr_Factors:  [101.55382833  -1.36894982  -1.02890499]
mat_Sqrt:  [[ 9.2325398   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00239591 -0.00988698 -0.0796334 ]
Stock Position:  0.0023959142501944466
Bond Position:  [3.94475947]


portfolio before change:  [4.18823333]
curr_Stock_Price:  100.79700569761913
curr_Factors:  [100.7970057   -1.71335884  -1.02363609]
mat_Sqrt:  [[ 6.52808554  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01185079  0.01197018 -0.00417995]
Stock Position:  0.011850787563978773
Bond Position:  [2.99370942]


portfolio before change:  [4.16963921]
curr_Stock_Price:  99.10164589533595
curr_Factors:  [99.1016459  -0.94143331 -1.0484194 ]
mat_Sqrt:  [[13.54873708  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00479358 -0.00340286 -0.22268134]
Stock Position:  0.004793580059916943
Bond Position:  [3.69458753]


portfolio before change:  [4.16719987]
curr_Stock_Price:  98.20730497744452
curr_Factors:  [98.20730498 -0.55806788 -1.09260841]
mat_Sqrt:  [[18.84795293  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00038883 -0.03290692  0.24722418]
Stock Position:  -0.0003888280889888546
Bond Position:  [4.20538562]


portfolio before change:  [4.16849107]
curr_Stock_Price:  100.295672499954
curr_Factors:  [100.2956725   -0.73503882  -1.12835353]
mat_Sqrt:  [[15.56041519  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00953812 -0.0118575  -0.30881189]
Stock Position:  -0.009538119651100938
Bond Position:  [5.12512319]


portfolio before change:  [4.1591572]
curr_Stock_Price:  101.54299129824501
curr_Factors:  [101.5429913   -0.59070227  -1.21961944]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [4.1591572]
Stock Price:  101.97572707397006
PL:  [2.18343012]
Settle:  Tensor("sub_354:0", shape=(), dtype=float64)
PL:  Tensor("sub_355:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  178
output_Z_Vals[:, i, :]:  [[ 1.19279309e+02 -2.92921948e+01 -2.92556094e+01]
 [-7.04779654e-02 -1.14653620e-01 -1.72427800e-03]
 [ 4.69941045e-01  6.90377893e-02 -2.80595988e-01]
 [-4.92339649e-02  9.59072017e-02 -2.03587132e-01]
 [ 4.36701192e-02 -7.97732998e-02 -6.03554444e-02]
 [ 6.84753790e-02  6.18989479e-02  6.64301875e-03]
 [ 1.15771612e-01 -5.97204820e-03 -1.05285866e-01]
 [-1.54437773e-01 -7.78231638e-03 -8.83707546e-02]
 [ 3.08072248e-02  6.72126528e-02 -1.32550792e-01]
 [ 6.76457005e-02  3.70277210e-01 -9.54327741e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.27930914 -29.29219478 -29.25560936]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  8.31647217  -9.26300532 -83.45811031]
init_Out:  [2.54002979]
Stock Position:  8.316472170547405
Bond position:  [-829.10718727]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-4.86636455]
curr_Stock_Price:  99.15929050939334
curr_Factors:  [99.15929051 -1.03007824 -1.03342119]
mat_Sqrt:  [[12.59409585  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00585912 -0.03625666 -0.00491889]
Stock Position:  -0.005859116584570902
Bond Position:  [-4.2853787]


portfolio before change:  [-4.8714698]
curr_Stock_Price:  99.66483195347698
curr_Factors:  [99.66483195 -1.21489587 -1.0128942 ]
mat_Sqrt:  [[10.7405125   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.03858728  0.02183167 -0.80046225]
Stock Position:  0.03858728133187491
Bond Position:  [-8.71726471]


portfolio before change:  [-4.84058681]
curr_Stock_Price:  100.57815641895058
curr_Factors:  [100.57815642  -1.27643635  -1.10141968]
mat_Sqrt:  [[ 9.32854518  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00946715  0.03032852 -0.58077742]
Stock Position:  -0.009467146182743708
Bond Position:  [-3.8883987]


portfolio before change:  [-4.85671027]
curr_Stock_Price:  102.07583854033113
curr_Factors:  [102.07583854  -0.87465531  -1.11862584]
mat_Sqrt:  [[13.90759235  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00210607 -0.02522653 -0.17217728]
Stock Position:  0.0021060710761218807
Bond Position:  [-5.07168924]


portfolio before change:  [-4.85744781]
curr_Stock_Price:  102.93000789073281
curr_Factors:  [102.93000789  -0.91647861  -1.04531647]
mat_Sqrt:  [[14.47255561  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00493552 0.01957417 0.01895068]
Stock Position:  0.004935521090393425
Bond Position:  [-5.36546103]


portfolio before change:  [-4.8530074]
curr_Stock_Price:  104.37338321900944
curr_Factors:  [104.37338322  -0.44159276  -1.099019  ]
mat_Sqrt:  [[22.36199652  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0042092  -0.00188853 -0.30035127]
Stock Position:  0.004209196031725356
Bond Position:  [-5.29233543]


portfolio before change:  [-4.85736149]
curr_Stock_Price:  103.9677799903702
curr_Factors:  [103.96777999  -0.47638027  -1.12132217]
mat_Sqrt:  [[21.03901563  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00820748 -0.00246098 -0.25209717]
Stock Position:  -0.008207480761468449
Bond Position:  [-4.00404794]


portfolio before change:  [-4.87922221]
curr_Stock_Price:  106.3873035805385
curr_Factors:  [106.38730358  -1.31260889  -1.05922816]
mat_Sqrt:  [[ 9.92690933  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00055262  0.02125451 -0.37813052]
Stock Position:  0.0005526222362661703
Bond Position:  [-4.9380142]


portfolio before change:  [-4.88194279]
curr_Stock_Price:  105.9331887208574
curr_Factors:  [105.93318872  -1.39225584  -1.02817095]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-4.88194279]
Stock Price:  107.11619727407188
PL:  [-11.99814006]
Settle:  Tensor("sub_356:0", shape=(), dtype=float64)
PL:  Tensor("sub_357:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  179
output_Z_Vals[:, i, :]:  [[ 1.19279309e+02 -2.92921948e+01 -2.92556094e+01]
 [-7.04779654e-02 -1.14653620e-01 -1.72427800e-03]
 [-1.16985457e-01 -3.36530080e-02  6.92143932e-02]
 [-6.64761615e-02  1.76669391e-01  1.05165085e-01]
 [ 1.62171189e-02 -6.10432628e-02 -1.37827500e-02]
 [ 1.27351516e-01  3.34289569e-01 -5.17998777e-02]
 [ 8.09498808e-02  1.68662910e-02 -2.27331988e-01]
 [-1.65875177e-01  3.43748421e-03 -1.01812013e-01]
 [ 4.53613492e-02  5.36734021e-02 -1.10549343e-01]
 [ 6.53846930e-02  3.42918364e-01 -2.43301483e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.27930914 -29.29219478 -29.25560936]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  8.31647217  -9.26300532 -83.45811031]
init_Out:  [2.54002979]
Stock Position:  8.316472170547405
Bond position:  [-829.10718727]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [7.94461557]
curr_Stock_Price:  100.69972494458739
curr_Factors:  [100.69972494  -1.02089775  -0.98778086]
mat_Sqrt:  [[13.51046349  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00546171 -0.03625666 -0.00491889]
Stock Position:  -0.00546171313351179
Bond Position:  [8.49460858]


portfolio before change:  [7.933337]
curr_Stock_Price:  103.5425938848706
curr_Factors:  [103.54259388  -1.01613352  -0.99191578]
mat_Sqrt:  [[13.90062444  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00746197 -0.01064202  0.1974494 ]
Stock Position:  -0.007461970211617874
Bond Position:  [8.70596875]


portfolio before change:  [7.91269835]
curr_Stock_Price:  106.89194002931798
curr_Factors:  [106.89194003  -1.27178734  -1.04829945]
mat_Sqrt:  [[10.50374255  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0038508   0.05586777  0.30000671]
Stock Position:  -0.003850803108102809
Bond Position:  [8.32431816]


portfolio before change:  [7.91715794]
curr_Stock_Price:  106.81497073455753
curr_Factors:  [106.81497073  -1.01333809  -1.03108004]
mat_Sqrt:  [[13.82778493  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00085535 -0.01930357 -0.03931835]
Stock Position:  0.0008553500542798192
Bond Position:  [7.82579375]


portfolio before change:  [7.9199529]
curr_Stock_Price:  105.5068332171583
curr_Factors:  [105.50683322  -1.15538607  -1.04822079]
mat_Sqrt:  [[11.64840035  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01076622  0.10571164 -0.14777063]
Stock Position:  0.010766219077672034
Bond Position:  [6.78404322]


portfolio before change:  [7.91663144]
curr_Stock_Price:  104.88318533493683
curr_Factors:  [104.88318533  -1.50608225  -1.08840165]
mat_Sqrt:  [[ 7.83313892  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00446582  0.00533359 -0.64851489]
Stock Position:  0.004465823875426338
Bond Position:  [7.44824161]


portfolio before change:  [7.92369026]
curr_Stock_Price:  105.62969214335861
curr_Factors:  [105.62969214  -1.80364866  -1.08254326]
mat_Sqrt:  [[ 5.89289617  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.03165994  0.00108703 -0.29044133]
Stock Position:  -0.03165993526609046
Bond Position:  [11.26791948]


portfolio before change:  [7.92057458]
curr_Stock_Price:  105.90609997723153
curr_Factors:  [105.90609998  -1.60854355  -1.08807986]
mat_Sqrt:  [[ 7.14154723  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00338602  0.01697302 -0.31536651]
Stock Position:  0.003386016992681346
Bond Position:  [7.56197472]


portfolio before change:  [7.92022948]
curr_Stock_Price:  104.68725379161718
curr_Factors:  [104.68725379  -1.90242179  -1.07247082]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [7.92022948]
Stock Price:  105.1990777571074
PL:  [2.72115172]
Settle:  Tensor("sub_358:0", shape=(), dtype=float64)
PL:  Tensor("sub_359:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  180
output_Z_Vals[:, i, :]:  [[ 1.19279309e+02 -2.92921948e+01 -2.92556094e+01]
 [-7.04779654e-02 -1.14653620e-01 -1.72427800e-03]
 [ 1.86832288e-01  3.40253739e-02 -1.89087901e-03]
 [-2.87966554e-02  9.18570459e-02 -1.54800508e-01]
 [-8.31459181e-03  2.74075302e-02  3.12755680e-02]
 [ 8.51314602e-02  6.55185957e-02 -9.84239154e-03]
 [ 6.42923121e-02  5.90041923e-02 -3.91301326e-01]
 [-1.39485118e-01 -3.59619667e-02  3.04866242e-03]
 [-6.02441764e-02 -5.74009429e-02 -5.45160376e-02]
 [-2.05650883e-03 -8.19531907e-03  7.73985542e-03]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.27930914 -29.29219478 -29.25560936]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  8.31647217  -9.26300532 -83.45811031]
init_Out:  [2.54002979]
Stock Position:  8.316472170547405
Bond position:  [-829.10718727]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [6.78712055]
curr_Stock_Price:  100.56054393263787
curr_Factors:  [100.56054393  -1.40891912  -1.01653655]
mat_Sqrt:  [[ 8.89335441  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00829724 -0.03625666 -0.00491889]
Stock Position:  -0.008297237744643493
Bond Position:  [7.62149529]


portfolio before change:  [6.78105059]
curr_Stock_Price:  101.75150259794368
curr_Factors:  [101.7515026   -1.34721201  -0.98849719]
mat_Sqrt:  [[ 9.84362851  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01903006  0.01075977 -0.00539415]
Stock Position:  0.019030060438245115
Bond Position:  [4.84471334]


portfolio before change:  [6.76187234]
curr_Stock_Price:  100.61639255293133
curr_Factors:  [100.61639255  -1.98305743  -0.9651939 ]
mat_Sqrt:  [[ 5.27544934  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01099877  0.02904775 -0.44160276]
Stock Position:  -0.010998767000713
Bond Position:  [7.86852859]


portfolio before change:  [6.76508092]
curr_Stock_Price:  100.6824603785192
curr_Factors:  [100.68246038  -1.9398233   -0.96936933]
mat_Sqrt:  [[ 5.48918053  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00022277  0.00866702  0.08922049]
Stock Position:  -0.00022277165716218337
Bond Position:  [6.78751012]


portfolio before change:  [6.7684467]
curr_Stock_Price:  100.81182897321372
curr_Factors:  [100.81182897  -1.79386663  -0.9530049 ]
mat_Sqrt:  [[ 6.46487817  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01311921  0.0207188  -0.0280776 ]
Stock Position:  0.013119206759377723
Bond Position:  [5.44587548]


portfolio before change:  [6.76571721]
curr_Stock_Price:  100.39617038198922
curr_Factors:  [100.39617038  -2.08113374  -0.97492348]
mat_Sqrt:  [[ 4.72594171  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0029747   0.01865876 -1.11627376]
Stock Position:  -0.0029746991520112893
Bond Position:  [7.06436561]


portfolio before change:  [6.7695583]
curr_Stock_Price:  100.29262260581237
curr_Factors:  [100.29262261  -1.72761018  -0.95686688]
mat_Sqrt:  [[ 6.84566139  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02042043 -0.01137217  0.00869699]
Stock Position:  -0.0204204295557356
Bond Position:  [8.81757674]


portfolio before change:  [6.7542129]
curr_Stock_Price:  101.260050295411
curr_Factors:  [101.2600503   -1.98126043  -0.92325798]
mat_Sqrt:  [[ 5.54653578  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0131351  -0.01815177 -0.15551908]
Stock Position:  -0.013135099978010401
Bond Position:  [8.08427379]


portfolio before change:  [6.77324212]
curr_Stock_Price:  100.1191322836504
curr_Factors:  [100.11913228  -1.57722179  -0.8996134 ]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [6.77324212]
Stock Price:  100.62314845459156
PL:  [6.15009367]
Settle:  Tensor("sub_360:0", shape=(), dtype=float64)
PL:  Tensor("sub_361:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  181
output_Z_Vals[:, i, :]:  [[ 1.19279309e+02 -2.92921948e+01 -2.92556094e+01]
 [-5.73548956e-02  3.69574466e-04  9.80483591e-02]
 [ 6.45016051e-01  7.41096411e-02 -3.17009333e-01]
 [ 2.00112774e-01 -7.01179305e-02 -1.91044330e-01]
 [-2.71689991e-01  3.13837533e-01  4.08216092e-01]
 [ 4.26815614e-02 -9.71276604e-02  3.00749004e-02]
 [-1.52860709e-01 -9.56189587e-02  2.85686215e-01]
 [ 9.62113124e-02 -1.01823250e-01 -4.21817256e-02]
 [ 1.37496025e-01 -9.15962891e-02  9.10507958e-02]
 [-1.25183259e-02 -8.50473459e-02 -3.09846434e-03]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.27930914 -29.29219478 -29.25560936]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  8.31647217  -9.26300532 -83.45811031]
init_Out:  [2.54002979]
Stock Position:  8.316472170547405
Bond position:  [-829.10718727]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-1.37496372]
curr_Stock_Price:  99.57910804129048
curr_Factors:  [99.57910804 -0.80753519 -0.98239435]
mat_Sqrt:  [[16.6269163   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-2.24523387e-03  1.16869708e-04  2.79704677e-01]
Stock Position:  -0.002245233874339479
Bond Position:  [-1.15138534]


portfolio before change:  [-1.37329815]
curr_Stock_Price:  98.58081236093409
curr_Factors:  [98.58081236 -0.90593693 -0.96303809]
mat_Sqrt:  [[15.20921697  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.03828075  0.02343553 -0.90433939]
Stock Position:  0.038280754121069134
Bond Position:  [-5.14704599]


portfolio before change:  [-1.36508501]
curr_Stock_Price:  98.86260694117519
curr_Factors:  [98.86260694 -0.7109803  -0.93972469]
mat_Sqrt:  [[18.97317397  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00839636 -0.02217324 -0.5449963 ]
Stock Position:  0.008396358787771728
Bond Position:  [-2.19517093]


portfolio before change:  [-1.38903725]
curr_Stock_Price:  96.14066726234518
curr_Factors:  [96.14066726 -0.47407938 -0.89889155]
mat_Sqrt:  [[24.35754066  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00740058  0.09924414  1.16452688]
Stock Position:  -0.007400582125152381
Bond Position:  [-0.67754035]


portfolio before change:  [-1.3841836]
curr_Stock_Price:  95.43903164522204
curr_Factors:  [95.43903165 -0.15646974 -0.89809253]
mat_Sqrt:  [[33.24569752  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00139304 -0.03071446  0.08579532]
Stock Position:  0.0013930448979898608
Bond Position:  [-1.51713445]


portfolio before change:  [-1.38528033]
curr_Stock_Price:  95.1964110683111
curr_Factors:  [95.19641107 -0.38898774 -0.9057021 ]
mat_Sqrt:  [[26.08218214  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00371956 -0.03023737  0.81498325]
Stock Position:  -0.003719555568285151
Bond Position:  [-1.03119199]


portfolio before change:  [-1.3872563]
curr_Stock_Price:  95.58899462995934
curr_Factors:  [95.58899463 -0.3326096  -0.88884739]
mat_Sqrt:  [[28.17966739  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00301536 -0.03219934 -0.12033272]
Stock Position:  0.0030153634358244153
Bond Position:  [-1.67549186]


portfolio before change:  [-1.38992157]
curr_Stock_Price:  94.9829925889139
curr_Factors:  [94.98299259 -0.52289819 -0.92829201]
mat_Sqrt:  [[22.25368577  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00690747 -0.02896529  0.25974258]
Stock Position:  0.006907470788413457
Bond Position:  [-2.04601381]


portfolio before change:  [-1.38663241]
curr_Stock_Price:  95.60730561404023
curr_Factors:  [95.60730561 -0.70401281 -0.91254665]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-1.38663241]
Stock Price:  94.98330939277783
PL:  [-1.38663241]
Settle:  Tensor("sub_362:0", shape=(), dtype=float64)
PL:  Tensor("sub_363:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  182
output_Z_Vals[:, i, :]:  [[ 1.19279309e+02 -2.92921948e+01 -2.92556094e+01]
 [-4.99916621e-02  3.52830356e-02  1.30156407e-01]
 [ 5.53549391e-01  7.25610755e-02 -2.89702216e-01]
 [ 2.23781323e-01 -8.45901783e-02 -1.81791055e-01]
 [ 1.06784511e-03 -3.59521577e-02 -1.02542015e-04]
 [ 4.14150028e-02 -6.50893611e-02  3.35054456e-02]
 [ 9.09811150e-02 -3.04662440e-03 -1.00867122e-01]
 [-1.31637507e-01 -3.01487935e-02 -6.15758397e-02]
 [-2.44815611e-02  2.75507276e-02 -1.19196311e-01]
 [ 7.09596193e-02  3.60821833e-01 -1.95177414e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.27930914 -29.29219478 -29.25560936]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  8.31647217  -9.26300532 -83.45811031]
init_Out:  [2.54002979]
Stock Position:  8.316472170547405
Bond position:  [-829.10718727]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-15.8133431]
curr_Stock_Price:  97.84298975983086
curr_Factors:  [97.84298976 -0.80660094 -1.02457977]
mat_Sqrt:  [[15.67682226  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00143604  0.01115748  0.3713    ]
Stock Position:  -0.001436043114158556
Bond Position:  [-15.67283635]


portfolio before change:  [-15.82269516]
curr_Stock_Price:  98.89705931798477
curr_Factors:  [98.89705932 -0.78805611 -1.03109483]
mat_Sqrt:  [[16.03748129  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.03094549  0.02294583 -0.82643979]
Stock Position:  0.030945488491555467
Bond Position:  [-18.88311298]


portfolio before change:  [-15.83932003]
curr_Stock_Price:  98.66500775127064
curr_Factors:  [98.66500775 -0.73228314 -1.00513594]
mat_Sqrt:  [[17.36247505  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01062575 -0.02674976 -0.51859928]
Stock Position:  0.010625747188525044
Bond Position:  [-16.88770946]


portfolio before change:  [-15.82176032]
curr_Stock_Price:  101.11242884349525
curr_Factors:  [101.11242884  -0.90003805  -1.04453589]
mat_Sqrt:  [[14.46394666  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 8.20198573e-06 -1.13690705e-02 -2.92523827e-04]
Stock Position:  8.201985732518886e-06
Bond Position:  [-15.82258964]


portfolio before change:  [-15.82968567]
curr_Stock_Price:  99.6392289367256
curr_Factors:  [99.63922894 -0.46058964 -1.00544602]
mat_Sqrt:  [[23.0005999   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00202489 -0.02058306  0.09558171]
Stock Position:  0.0020248894972153043
Bond Position:  [-16.0314441]


portfolio before change:  [-15.8330929]
curr_Stock_Price:  101.9161457635646
curr_Factors:  [101.91614576  -0.68048732  -0.99797193]
mat_Sqrt:  [[19.02380578  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00369606 -0.00096343 -0.28774582]
Stock Position:  0.0036960552048672067
Bond Position:  [-16.2097806]


portfolio before change:  [-15.83011516]
curr_Stock_Price:  104.91519483849156
curr_Factors:  [104.91519484  -0.65079183  -1.02439046]
mat_Sqrt:  [[19.64789232  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00737917 -0.00953389 -0.17565873]
Stock Position:  -0.007379166124084318
Bond Position:  [-15.05592851]


portfolio before change:  [-15.8303008]
curr_Stock_Price:  103.91993276064005
curr_Factors:  [103.91993276  -0.89119833  -1.00774622]
mat_Sqrt:  [[15.55957457  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00309141  0.00871231 -0.3400339 ]
Stock Position:  -0.0030914116052846085
Bond Position:  [-15.50904152]


portfolio before change:  [-15.83537059]
curr_Stock_Price:  103.05085659667982
curr_Factors:  [103.0508566   -0.55391839  -1.0459883 ]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-15.83537059]
Stock Price:  105.01026664347992
PL:  [-20.84563724]
Settle:  Tensor("sub_364:0", shape=(), dtype=float64)
PL:  Tensor("sub_365:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  183
output_Z_Vals[:, i, :]:  [[ 1.19279309e+02 -2.92921948e+01 -2.92556094e+01]
 [-5.60132690e-02  1.21288790e-02  1.08248535e-01]
 [ 1.17337316e-01  6.56629954e-02 -7.91840642e-02]
 [-4.96110476e-02  1.09241391e-01 -1.21658736e-01]
 [ 2.30756829e-03 -4.88635952e-02 -5.77465821e-03]
 [ 4.07568975e-02 -7.98205184e-02  3.41663635e-02]
 [ 8.73464367e-02 -2.80371258e-02  1.60129511e-01]
 [-1.97051372e-02 -1.04170060e-01  8.38919741e-02]
 [-7.90049064e-02 -6.13635990e-02 -6.03126187e-02]
 [-1.38342020e-02 -9.02523125e-02 -1.98399736e-03]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.27930914 -29.29219478 -29.25560936]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  8.31647217  -9.26300532 -83.45811031]
init_Out:  [2.54002979]
Stock Position:  8.316472170547405
Bond position:  [-829.10718727]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [3.90517778]
curr_Stock_Price:  100.21400964309035
curr_Factors:  [100.21400964  -0.51067755  -0.98476324]
mat_Sqrt:  [[22.46294808  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00149597  0.00383549  0.30880294]
Stock Position:  -0.0014959729620705495
Bond Position:  [4.05509523]


portfolio before change:  [3.9067348]
curr_Stock_Price:  100.52887520922467
curr_Factors:  [ 1.00528875e+02 -5.40718502e-02 -9.64458299e-01]
mat_Sqrt:  [[36.30352531  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00283359  0.02076446 -0.22589009]
Stock Position:  0.0028335911320344037
Bond Position:  [3.62187707]


portfolio before change:  [3.91197023]
curr_Stock_Price:  101.73724741615695
curr_Factors:  [101.73724742  -0.22972607  -0.99882779]
mat_Sqrt:  [[29.7800773   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0024051   0.03454516 -0.34705851]
Stock Position:  -0.0024050955857293776
Bond Position:  [4.15665803]


portfolio before change:  [3.91527804]
curr_Stock_Price:  101.22626451981436
curr_Factors:  [101.22626452  -0.54890888  -1.08770961]
mat_Sqrt:  [[19.70238646  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-6.74189811e-06 -1.54520255e-02 -1.64734925e-02]
Stock Position:  -6.741898114008256e-06
Bond Position:  [3.91596049]


portfolio before change:  [3.91725685]
curr_Stock_Price:  98.2090128154339
curr_Factors:  [98.20901282 -0.7754095  -1.06012651]
mat_Sqrt:  [[15.66708458  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00291504 -0.02524146  0.09746712]
Stock Position:  0.0029150363000658573
Bond Position:  [3.63097401]


portfolio before change:  [3.9154798]
curr_Stock_Price:  96.97644126010717
curr_Factors:  [96.97644126 -0.69230884 -1.03651189]
mat_Sqrt:  [[17.21269768  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00693144 -0.00886612  0.45680492]
Stock Position:  0.006931442304360165
Bond Position:  [3.24329319]


portfolio before change:  [3.92495265]
curr_Stock_Price:  98.10907719551936
curr_Factors:  [98.1090772  -0.83509639 -1.05212174]
mat_Sqrt:  [[14.86280468  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0003546  -0.03294147  0.23932045]
Stock Position:  -0.00035460461024674475
Bond Position:  [3.95974258]


portfolio before change:  [3.92657777]
curr_Stock_Price:  99.11088148860969
curr_Factors:  [99.11088149 -0.96931749 -1.09033201]
mat_Sqrt:  [[12.63650365  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00735176 -0.01940487 -0.17205511]
Stock Position:  -0.007351762171321196
Bond Position:  [4.6552174]


portfolio before change:  [3.94704895]
curr_Stock_Price:  96.64303997540429
curr_Factors:  [96.64303998 -1.28050554 -1.09079771]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [3.94704895]
Stock Price:  96.78027085688377
PL:  [3.94704895]
Settle:  Tensor("sub_366:0", shape=(), dtype=float64)
PL:  Tensor("sub_367:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  184
output_Z_Vals[:, i, :]:  [[ 1.19279309e+02 -2.92921948e+01 -2.92556094e+01]
 [-5.66246208e-02  6.77040424e-03  1.03600523e-01]
 [ 4.71313298e-01  6.90606844e-02 -2.81008210e-01]
 [ 6.92118126e-02  2.23036144e-02 -1.64667455e-01]
 [-2.28542511e-02 -3.47405535e-03  3.63639118e-02]
 [ 5.13069884e-02 -4.52660174e-02  2.37032436e-02]
 [ 6.52944703e-02  5.36795158e-02 -3.90165010e-01]
 [-1.97161935e-01  2.93430819e-02 -1.21909033e-01]
 [-5.44232845e-02 -6.93755481e-02 -3.99690618e-02]
 [-6.91087454e-03 -3.54816099e-02  8.89766751e-03]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.27930914 -29.29219478 -29.25560936]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  8.31647217  -9.26300532 -83.45811031]
init_Out:  [2.54002979]
Stock Position:  8.316472170547405
Bond position:  [-829.10718727]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [5.17299242]
curr_Stock_Price:  100.36645585109487
curr_Factors:  [100.36645585  -0.57732816  -1.11591939]
mat_Sqrt:  [[18.45952495  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00191242  0.00214099  0.29554346]
Stock Position:  -0.0019124241577638894
Bond Position:  [5.36493566]


portfolio before change:  [5.17740507]
curr_Stock_Price:  99.46210347626078
curr_Factors:  [99.46210348 -1.03103736 -1.18148833]
mat_Sqrt:  [[10.88353417  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.03819861  0.02183891 -0.80163821]
Stock Position:  0.03819860996736545
Bond Position:  [1.37809097]


portfolio before change:  [5.19044519]
curr_Stock_Price:  99.78543730485198
curr_Factors:  [99.7854373  -1.53363621 -1.13846252]
mat_Sqrt:  [[ 6.89587583  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0052459   0.00705302 -0.46975041]
Stock Position:  0.005245901588005556
Bond Position:  [4.6669806]


portfolio before change:  [5.19633117]
curr_Stock_Price:  100.46252034252461
curr_Factors:  [100.46252034  -1.45877242  -1.15143503]
mat_Sqrt:  [[ 7.3859332   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00210145 -0.00109859  0.10373612]
Stock Position:  -0.0021014539413309625
Bond Position:  [5.40744853]


portfolio before change:  [5.19654035]
curr_Stock_Price:  101.6499017711234
curr_Factors:  [101.64990177  -1.61304725  -1.22133581]
mat_Sqrt:  [[ 5.97241588  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00920509 -0.01431437  0.06761876]
Stock Position:  0.009205090592040251
Bond Position:  [4.26084379]


portfolio before change:  [5.20127918]
curr_Stock_Price:  101.93320965311025
curr_Factors:  [101.93320965  -2.06194914  -1.20757981]
mat_Sqrt:  [[ 3.87594244  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00334412  0.01697495 -1.11303217]
Stock Position:  -0.0033441233784282207
Bond Position:  [5.54215641]


portfolio before change:  [5.20335368]
curr_Stock_Price:  102.14171552415266
curr_Factors:  [102.14171552  -0.88873851  -1.17210533]
mat_Sqrt:  [[13.00738636  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01701256  0.0092791  -0.34777254]
Stock Position:  -0.01701255505815109
Bond Position:  [6.94104524]


portfolio before change:  [5.26360364]
curr_Stock_Price:  98.80426431820021
curr_Factors:  [98.80426432 -1.08838578 -1.17107002]
mat_Sqrt:  [[10.31588525  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0062402  -0.02193847 -0.11402061]
Stock Position:  -0.006240201634160283
Bond Position:  [5.88016217]


portfolio before change:  [5.2692416]
curr_Stock_Price:  98.3720430688755
curr_Factors:  [98.37204307 -0.78458269 -1.17695272]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [5.2692416]
Stock Price:  97.05841389851174
PL:  [5.2692416]
Settle:  Tensor("sub_368:0", shape=(), dtype=float64)
PL:  Tensor("sub_369:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  185
output_Z_Vals[:, i, :]:  [[ 1.19279309e+02 -2.92921948e+01 -2.92556094e+01]
 [-7.04779654e-02 -1.14653620e-01 -1.72427800e-03]
 [ 3.80893622e-01  6.75832996e-02 -2.53611574e-01]
 [-6.41624817e-02  1.07185994e-01 -1.95952476e-01]
 [ 3.13341351e-02 -7.82416313e-02 -4.50841398e-02]
 [ 4.34418322e-02 -5.48389224e-02  3.14929586e-02]
 [ 9.56769513e-02 -5.37150959e-03 -1.09207008e-01]
 [-1.46473100e-01 -1.55954568e-02 -7.90106559e-02]
 [-1.22406609e-02 -5.92130498e-02 -2.15470859e-02]
 [-3.17926074e-03  1.89103996e-02 -2.70964702e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.27930914 -29.29219478 -29.25560936]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  8.31647217  -9.26300532 -83.45811031]
init_Out:  [2.54002979]
Stock Position:  8.316472170547405
Bond position:  [-829.10718727]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [11.81848153]
curr_Stock_Price:  101.16553134535849
curr_Factors:  [101.16553135  -1.5106258   -1.00219904]
mat_Sqrt:  [[ 8.19835285  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00900062 -0.03625666 -0.00491889]
Stock Position:  -0.009000622102861618
Bond Position:  [12.72903425]


portfolio before change:  [11.83445013]
curr_Stock_Price:  100.09866238197134
curr_Factors:  [100.09866238  -1.2160681   -0.96297797]
mat_Sqrt:  [[11.32610511  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.02921308  0.02137172 -0.72348323]
Stock Position:  0.02921307602290965
Bond Position:  [8.91026029]


portfolio before change:  [11.87290188]
curr_Stock_Price:  101.26237086322217
curr_Factors:  [101.26237086  -1.21144266  -0.91826783]
mat_Sqrt:  [[12.03723049  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00842333  0.03389519 -0.55899787]
Stock Position:  -0.00842333150015407
Bond Position:  [12.72586839]


portfolio before change:  [11.85711458]
curr_Stock_Price:  103.89218744124658
curr_Factors:  [103.89218744  -0.88968485  -0.94804177]
mat_Sqrt:  [[16.53744299  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0012161  -0.02474218 -0.1286125 ]
Stock Position:  0.001216099935972428
Bond Position:  [11.7307713]


portfolio before change:  [11.85993928]
curr_Stock_Price:  101.39061718573119
curr_Factors:  [101.39061719  -0.46505706  -1.02106836]
mat_Sqrt:  [[22.93938125  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00211228 -0.01734159  0.08984064]
Stock Position:  0.002112278880568247
Bond Position:  [11.64577402]


portfolio before change:  [11.86786741]
curr_Stock_Price:  102.38660070119688
curr_Factors:  [102.3866007   -0.64805311  -1.01970673]
mat_Sqrt:  [[19.31720246  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00379177 -0.00169862 -0.3115372 ]
Stock Position:  0.0037917743215691514
Bond Position:  [11.47964053]


portfolio before change:  [11.88006215]
curr_Stock_Price:  104.0885686092779
curr_Factors:  [104.08856861  -0.30297194  -1.00908863]
mat_Sqrt:  [[28.02737149  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00581588 -0.00493172 -0.22539541]
Stock Position:  -0.005815877361809086
Bond Position:  [12.4854285]


portfolio before change:  [11.91853992]
curr_Stock_Price:  98.54624176960837
curr_Factors:  [98.54624177  0.45652948 -0.98620896]
mat_Sqrt:  [[58.02340207  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00031311 -0.01872481 -0.06146784]
Stock Position:  -0.0003131118667048774
Bond Position:  [11.94939591]


portfolio before change:  [11.92868821]
curr_Stock_Price:  85.22159588985065
curr_Factors:  [ 8.52215959e+01  6.83696264e-02 -9.12422085e-01]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [11.92868821]
Stock Price:  91.0980711165778
PL:  [11.92868821]
Settle:  Tensor("sub_370:0", shape=(), dtype=float64)
PL:  Tensor("sub_371:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  186
output_Z_Vals[:, i, :]:  [[ 1.19279309e+02 -2.92921948e+01 -2.92556094e+01]
 [-7.04779654e-02 -1.14653620e-01 -1.72427800e-03]
 [ 2.57153765e-01  7.09481443e-02 -1.75600186e-01]
 [ 1.04925532e-01 -7.92832540e-03 -2.03285594e-01]
 [ 4.04541823e-02 -1.04554673e-01 -5.59718105e-02]
 [ 6.30863474e-02  3.66359793e-02  1.19926116e-02]
 [ 7.34557193e-02  2.24955478e-02 -2.00453838e-01]
 [-1.77998528e-01  7.64515823e-03 -8.03912238e-02]
 [-2.58979294e-02 -3.72270022e-02 -5.66711676e-02]
 [ 1.26799137e-02  7.39400028e-02  7.43246530e-03]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.27930914 -29.29219478 -29.25560936]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  8.31647217  -9.26300532 -83.45811031]
init_Out:  [2.54002979]
Stock Position:  8.316472170547405
Bond position:  [-829.10718727]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-7.24195518]
curr_Stock_Price:  98.87364166816613
curr_Factors:  [98.87364167 -1.31856123 -1.01178666]
mat_Sqrt:  [[ 9.61663872  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00767319 -0.03625666 -0.00491889]
Stock Position:  -0.007673187902120625
Bond Position:  [-6.48327915]


portfolio before change:  [-7.25815565]
curr_Stock_Price:  100.5623817424234
curr_Factors:  [100.56238174  -0.98369307  -1.08294859]
mat_Sqrt:  [[12.73223019  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01752571  0.02243577 -0.50093845]
Stock Position:  0.017525712072943442
Bond Position:  [-9.020583]


portfolio before change:  [-7.28232246]
curr_Stock_Price:  99.44086432279529
curr_Factors:  [99.44086432 -0.71234846 -1.07000882]
mat_Sqrt:  [[16.73003925  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00377915 -0.00250716 -0.57991721]
Stock Position:  0.0037791498735486396
Bond Position:  [-7.65812439]


portfolio before change:  [-7.27207987]
curr_Stock_Price:  103.16461523566532
curr_Factors:  [103.16461524  -0.60688888  -1.02813543]
mat_Sqrt:  [[20.11169755  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00130916 -0.03306309 -0.159672  ]
Stock Position:  0.0013091582265020415
Bond Position:  [-7.40713868]


portfolio before change:  [-7.27640657]
curr_Stock_Price:  102.68934624637616
curr_Factors:  [102.68934625  -0.5421833   -1.04216712]
mat_Sqrt:  [[21.05963022  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00315676 0.01158531 0.03421158]
Stock Position:  0.003156763210322623
Bond Position:  [-7.60057252]


portfolio before change:  [-7.28255684]
curr_Stock_Price:  101.94521718194665
curr_Factors:  [101.94521718  -1.33852085  -1.01212622]
mat_Sqrt:  [[ 9.71614082  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00340867  0.00711372 -0.57183901]
Stock Position:  0.003408666465617609
Bond Position:  [-7.63005409]


portfolio before change:  [-7.28700011]
curr_Stock_Price:  101.76119072059198
curr_Factors:  [101.76119072  -1.83137469  -1.00496042]
mat_Sqrt:  [[ 5.96729477  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.03254589  0.00241761 -0.22933378]
Stock Position:  -0.032545890318910045
Bond Position:  [-3.97509156]


portfolio before change:  [-7.30331364]
curr_Stock_Price:  102.20135336969861
curr_Factors:  [102.20135337  -2.01555428  -1.02614554]
mat_Sqrt:  [[ 4.88048747  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00787362 -0.01177221 -0.16166707]
Stock Position:  -0.007873615149459152
Bond Position:  [-6.49861951]


portfolio before change:  [-7.29854649]
curr_Stock_Price:  101.18310780261437
curr_Factors:  [101.1831078   -1.9331868   -1.00848835]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-7.29854649]
Stock Price:  100.50231181613505
PL:  [-7.8008583]
Settle:  Tensor("sub_372:0", shape=(), dtype=float64)
PL:  Tensor("sub_373:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  187
output_Z_Vals[:, i, :]:  [[ 1.19279309e+02 -2.92921948e+01 -2.92556094e+01]
 [-7.04779654e-02 -1.14653620e-01 -1.72427800e-03]
 [ 1.22665872e-01  1.63409250e-02  3.57730828e-02]
 [-4.51224815e-02  1.31374151e-01 -2.37193505e-03]
 [ 3.18862186e-02 -4.14728727e-02 -3.48309464e-02]
 [ 7.74200894e-02  1.01306661e-01 -2.23457818e-03]
 [ 1.04111683e-01 -9.08073938e-03 -7.63475904e-02]
 [-1.56573769e-01 -1.66132009e-02 -3.39741593e-02]
 [-1.12516288e-01 -3.78317989e-02 -1.00907153e-01]
 [ 1.41925455e-02  8.89782498e-02  1.25698118e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.27930914 -29.29219478 -29.25560936]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  8.31647217  -9.26300532 -83.45811031]
init_Out:  [2.54002979]
Stock Position:  8.316472170547405
Bond position:  [-829.10718727]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [8.68350942]
curr_Stock_Price:  100.78857197512299
curr_Factors:  [100.78857198  -1.18744024  -0.97283172]
mat_Sqrt:  [[11.62029355  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00635012 -0.03625666 -0.00491889]
Stock Position:  -0.006350121499578102
Bond Position:  [9.3235291]


portfolio before change:  [8.67932663]
curr_Stock_Price:  102.18157232857497
curr_Factors:  [102.18157233  -1.37655275  -0.97132457]
mat_Sqrt:  [[ 9.76567834  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01335186 0.00516745 0.10205065]
Stock Position:  0.013351857228668258
Bond Position:  [7.31501287]


portfolio before change:  [8.70058445]
curr_Stock_Price:  103.49969616656547
curr_Factors:  [103.49969617  -0.91967953  -0.98887617]
mat_Sqrt:  [[15.34842677  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00275042  0.04154415 -0.00676647]
Stock Position:  -0.0027504177045617416
Bond Position:  [8.98525185]


portfolio before change:  [8.71006304]
curr_Stock_Price:  101.68730181724737
curr_Factors:  [101.68730182  -1.03964948  -0.95107058]
mat_Sqrt:  [[13.89018357  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00170664 -0.01311487 -0.099363  ]
Stock Position:  0.0017066409785173136
Bond Position:  [8.53651933]


portfolio before change:  [8.71676323]
curr_Stock_Price:  103.11165619570154
curr_Factors:  [103.1116562   -0.57236374  -0.90472191]
mat_Sqrt:  [[23.54060471  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00338053  0.03203598 -0.00637463]
Stock Position:  0.003380528485128516
Bond Position:  [8.36819134]


portfolio before change:  [8.72362763]
curr_Stock_Price:  103.90421232555019
curr_Factors:  [103.90421233  -0.53287559  -0.93104293]
mat_Sqrt:  [[24.03595687  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00367336 -0.00287158 -0.21779842]
Stock Position:  0.0036733645777019923
Bond Position:  [8.34194958]


portfolio before change:  [8.71554604]
curr_Stock_Price:  100.56841140431015
curr_Factors:  [100.5684114   -0.96163723  -0.92118012]
mat_Sqrt:  [[15.30257109  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01071308 -0.00525356 -0.09691882]
Stock Position:  -0.010713079884020971
Bond Position:  [9.79294346]


portfolio before change:  [8.71619787]
curr_Stock_Price:  100.96473641994375
curr_Factors:  [100.96473642  -1.074198    -0.89926603]
mat_Sqrt:  [[14.03153482  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00955638 -0.01196347 -0.28786002]
Stock Position:  -0.00955638060047729
Bond Position:  [9.68105532]


portfolio before change:  [8.72792076]
curr_Stock_Price:  100.24467879029191
curr_Factors:  [100.24467879  -0.52893446  -0.91190857]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [8.72792076]
Stock Price:  102.62610760135776
PL:  [6.10181315]
Settle:  Tensor("sub_374:0", shape=(), dtype=float64)
PL:  Tensor("sub_375:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  188
output_Z_Vals[:, i, :]:  [[ 1.19279309e+02 -2.92921948e+01 -2.92556094e+01]
 [-7.04779654e-02 -1.14653620e-01 -1.72427800e-03]
 [-8.33152720e-02 -4.29253634e-02  6.35592570e-02]
 [-6.05752413e-02  1.64396042e-01  7.65401842e-02]
 [ 2.13526869e-02 -1.03527605e-01 -2.84953723e-02]
 [ 2.34048541e-01  8.08816836e-01 -1.57699255e-01]
 [ 1.10240952e-01 -4.00653445e-06 -1.91674738e-01]
 [-4.74989907e-02 -1.12686526e-01  3.73039030e-02]
 [ 5.12394056e-02  1.01774726e-01 -1.61103844e-01]
 [ 6.67493820e-02  4.28466896e-01 -3.30096825e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.27930914 -29.29219478 -29.25560936]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  8.31647217  -9.26300532 -83.45811031]
init_Out:  [2.54002979]
Stock Position:  8.316472170547405
Bond position:  [-829.10718727]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [19.32303207]
curr_Stock_Price:  102.06790321454544
curr_Factors:  [102.06790321  -0.97703379  -1.02716006]
mat_Sqrt:  [[13.75557867  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00536439 -0.03625666 -0.00491889]
Stock Position:  -0.005364389069741937
Bond Position:  [19.87056402]


portfolio before change:  [19.31749613]
curr_Stock_Price:  104.95242635760671
curr_Factors:  [104.95242636  -1.38243082  -1.05670486]
mat_Sqrt:  [[ 9.15565285  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00780388 -0.01357419  0.18131687]
Stock Position:  -0.007803880539737454
Bond Position:  [20.13653233]


portfolio before change:  [19.32105561]
curr_Stock_Price:  105.7867947215126
curr_Factors:  [105.78679472  -1.5530618   -1.01062822]
mat_Sqrt:  [[ 8.14769997  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00499612  0.05198659  0.21834784]
Stock Position:  -0.004996115988694363
Bond Position:  [19.8495787]


portfolio before change:  [19.33000247]
curr_Stock_Price:  105.98302845740204
curr_Factors:  [105.98302846  -0.90720693  -0.96790899]
mat_Sqrt:  [[16.25113992  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00079152 -0.0327383  -0.08128937]
Stock Position:  0.0007915150662639456
Bond Position:  [19.24611531]


portfolio before change:  [19.3421054]
curr_Stock_Price:  109.11305556097689
curr_Factors:  [109.11305556  -1.08979416  -1.01930265]
mat_Sqrt:  [[13.24059837  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01682264  0.25577034 -0.44987208]
Stock Position:  0.016822644260360328
Bond Position:  [17.50653528]


portfolio before change:  [19.35259775]
curr_Stock_Price:  109.21630298803782
curr_Factors:  [109.21630299  -1.2029712   -0.95940261]
mat_Sqrt:  [[12.56551978  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 5.65956743e-03 -1.26697744e-06 -5.46794675e-01]
Stock Position:  0.005659567426856577
Bond Position:  [18.73448072]


portfolio before change:  [19.35605022]
curr_Stock_Price:  108.1707961632183
curr_Factors:  [108.17079616  -1.47070901  -0.9830441 ]
mat_Sqrt:  [[ 9.29947846  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00460175 -0.03563461  0.10641765]
Stock Position:  -0.004601754508326524
Bond Position:  [19.85382566]


portfolio before change:  [19.3609109]
curr_Stock_Price:  109.27226911026422
curr_Factors:  [109.27226911  -1.26943477  -0.99206503]
mat_Sqrt:  [[11.38552542  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00184287  0.03218399 -0.45958443]
Stock Position:  0.0018428691164834822
Bond Position:  [19.15953641]


portfolio before change:  [19.37379544]
curr_Stock_Price:  111.06424111770266
curr_Factors:  [111.06424112  -1.37362475  -0.97270833]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [19.37379544]
Stock Price:  110.24700927194273
PL:  [9.12678616]
Settle:  Tensor("sub_376:0", shape=(), dtype=float64)
PL:  Tensor("sub_377:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  189
output_Z_Vals[:, i, :]:  [[ 1.19279309e+02 -2.92921948e+01 -2.92556094e+01]
 [-7.04779654e-02 -1.14653620e-01 -1.72427800e-03]
 [ 4.93140266e-01  7.04413934e-02 -2.79918472e-01]
 [ 2.42028184e-02  4.33746288e-02 -2.22663728e-01]
 [-1.06467314e-03 -4.11222995e-02  4.35961876e-04]
 [ 4.46748164e-02 -5.02724776e-02  3.02697928e-02]
 [ 9.11498978e-02 -1.73267699e-04 -1.29710417e-01]
 [-1.70635352e-01  8.10709404e-03 -1.07406180e-01]
 [ 2.57465905e-02  5.55746105e-02 -1.22063765e-01]
 [ 6.51130199e-02  3.56070397e-01 -7.83792689e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.27930914 -29.29219478 -29.25560936]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  8.31647217  -9.26300532 -83.45811031]
init_Out:  [2.54002979]
Stock Position:  8.316472170547405
Bond position:  [-829.10718727]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [5.24062681]
curr_Stock_Price:  100.37458843205327
curr_Factors:  [100.37458843  -1.04337929  -0.95644332]
mat_Sqrt:  [[13.58663337  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00543109 -0.03625666 -0.00491889]
Stock Position:  -0.005431093476592146
Bond Position:  [5.78577058]


portfolio before change:  [5.248383]
curr_Stock_Price:  99.47926471703339
curr_Factors:  [99.47926472 -1.10488808 -0.92781192]
mat_Sqrt:  [[13.02993278  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.03360117  0.02227552 -0.79852949]
Stock Position:  0.03360116614603926
Bond Position:  [1.9057637]


portfolio before change:  [5.27026197]
curr_Stock_Price:  100.1020361310677
curr_Factors:  [100.10203613  -0.8060289   -0.9165845 ]
mat_Sqrt:  [[17.87810228  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00112586  0.01371626 -0.63519764]
Stock Position:  -0.001125863151959146
Bond Position:  [5.38296316]


portfolio before change:  [5.27172242]
curr_Stock_Price:  101.19604030465267
curr_Factors:  [101.1960403   -0.45325434  -0.97592233]
mat_Sqrt:  [[24.23706224  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-8.40636535e-05 -1.30040129e-02  1.24367788e-03]
Stock Position:  -8.406365351259241e-05
Bond Position:  [5.28022933]


portfolio before change:  [5.2743704]
curr_Stock_Price:  101.11037200198366
curr_Factors:  [101.110372    -0.38739973  -0.94190825]
mat_Sqrt:  [[26.75990603  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00185186 -0.01589755  0.08635129]
Stock Position:  0.0018518593480845724
Bond Position:  [5.08712821]


portfolio before change:  [5.28197886]
curr_Stock_Price:  103.84505975463169
curr_Factors:  [103.84505975  -0.92811788  -0.95947524]
mat_Sqrt:  [[15.72586579  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 4.11223121e-03 -5.47920574e-05 -3.70027714e-01]
Stock Position:  0.004112231210037526
Bond Position:  [4.85494396]


portfolio before change:  [5.28976871]
curr_Stock_Price:  105.14891883071031
curr_Factors:  [105.14891883  -1.40392555  -0.95359934]
mat_Sqrt:  [[ 9.9527881   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01932627  0.00256369 -0.30639993]
Stock Position:  -0.019326265166497665
Bond Position:  [7.32190459]


portfolio before change:  [5.28197862]
curr_Stock_Price:  105.7414781888527
curr_Factors:  [105.74147819  -1.357684    -0.96205974]
mat_Sqrt:  [[10.3942575   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 2.17943334e-04  1.75742349e-02 -3.48213944e-01]
Stock Position:  0.00021794333420556
Bond Position:  [5.25893296]


portfolio before change:  [5.2846166]
curr_Stock_Price:  105.77752429725129
curr_Factors:  [105.7775243   -1.6399753   -0.95054611]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [5.2846166]
Stock Price:  107.08133486742885
PL:  [-1.79671827]
Settle:  Tensor("sub_378:0", shape=(), dtype=float64)
PL:  Tensor("sub_379:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  190
output_Z_Vals[:, i, :]:  [[ 1.19279309e+02 -2.92921948e+01 -2.92556094e+01]
 [-7.04779654e-02 -1.14653620e-01 -1.72427800e-03]
 [ 1.52720433e-01  2.11045984e-02  3.14908049e-02]
 [-5.43650435e-02  1.31293389e-01 -4.40706531e-02]
 [ 2.86441908e-02 -4.13251500e-02 -3.16856822e-02]
 [ 8.21752100e-02  1.24745265e-01 -6.95565075e-03]
 [ 7.01847665e-02  3.57997750e-02 -2.64545461e-01]
 [-1.98017591e-01  3.03119058e-02 -1.23762825e-01]
 [-4.15790635e-02 -1.59895043e-02 -8.52465677e-02]
 [ 5.36322250e-02  2.70102770e-01 -2.01033321e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.27930914 -29.29219478 -29.25560936]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  8.31647217  -9.26300532 -83.45811031]
init_Out:  [2.54002979]
Stock Position:  8.316472170547405
Bond position:  [-829.10718727]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [12.69842652]
curr_Stock_Price:  101.27133882843191
curr_Factors:  [101.27133883  -1.23754029  -0.98024479]
mat_Sqrt:  [[11.02337869  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00669398 -0.03625666 -0.00491889]
Stock Position:  -0.006693979947484702
Bond Position:  [13.37633483]


portfolio before change:  [12.69906682]
curr_Stock_Price:  102.17506764755801
curr_Factors:  [102.17506765  -1.52335985  -0.96366785]
mat_Sqrt:  [[ 8.49654826  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01879509 0.00667386 0.0898345 ]
Stock Position:  0.018795089503311137
Bond Position:  [10.77867728]


portfolio before change:  [12.72475811]
curr_Stock_Price:  103.255168911111
curr_Factors:  [103.25516891  -1.60790063  -0.97824032]
mat_Sqrt:  [[ 7.77615764  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00771216  0.04151862 -0.12572131]
Stock Position:  -0.007712156815097603
Bond Position:  [13.52107816]


portfolio before change:  [12.72945488]
curr_Stock_Price:  103.52298659727518
curr_Factors:  [103.5229866   -1.38605871  -0.96950023]
mat_Sqrt:  [[ 9.81816992  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00215003 -0.01306816 -0.09039043]
Stock Position:  0.00215003075032162
Bond Position:  [12.50687728]


portfolio before change:  [12.73548661]
curr_Stock_Price:  103.41914042487214
curr_Factors:  [103.41914042  -1.38415159  -0.97144616]
mat_Sqrt:  [[ 9.80794039  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00856207  0.03944792 -0.01984254]
Stock Position:  0.008562073103798659
Bond Position:  [11.85000437]


portfolio before change:  [12.73268646]
curr_Stock_Price:  102.39992051075814
curr_Factors:  [102.39992051  -1.64235041  -0.9493689 ]
mat_Sqrt:  [[ 7.66884969  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00223097  0.01132088 -0.75467457]
Stock Position:  0.002230972995892876
Bond Position:  [12.504235]


portfolio before change:  [12.73867181]
curr_Stock_Price:  102.27964485692056
curr_Factors:  [102.27964486  -1.44165314  -0.92216474]
mat_Sqrt:  [[ 9.62046689  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02312756  0.00958547 -0.35306089]
Stock Position:  -0.023127559634094443
Bond Position:  [15.1041504]


portfolio before change:  [12.73906075]
curr_Stock_Price:  102.58944933514266
curr_Factors:  [102.58944934  -1.5136535   -0.91626208]
mat_Sqrt:  [[ 9.03241265  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00657552 -0.00505633 -0.24318473]
Stock Position:  -0.006575518165795531
Bond Position:  [13.41363954]


portfolio before change:  [12.74615074]
curr_Stock_Price:  102.53143251751193
curr_Factors:  [102.53143252  -1.15027493  -0.87356671]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [12.74615074]
Stock Price:  102.06163713943553
PL:  [10.6845136]
Settle:  Tensor("sub_380:0", shape=(), dtype=float64)
PL:  Tensor("sub_381:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  191
output_Z_Vals[:, i, :]:  [[ 1.19279309e+02 -2.92921948e+01 -2.92556094e+01]
 [-5.15159395e-02  5.15477964e-02  1.42441024e-01]
 [ 2.66933047e-01  7.09763090e-02 -1.79553316e-01]
 [-2.98231896e-02  8.08998710e-02 -2.15656870e-01]
 [ 3.42426267e-02 -6.08240051e-02 -4.41301004e-02]
 [ 4.58118723e-02 -4.33320075e-02  2.91400034e-02]
 [ 8.95799048e-02 -2.70999738e-03 -9.49313661e-02]
 [-1.44889617e-01 -2.98426777e-02 -8.66026765e-03]
 [-1.31513412e-01 -3.50641568e-02 -1.13092128e-01]
 [ 5.82397368e-02  2.92014959e-01 -2.08992916e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.27930914 -29.29219478 -29.25560936]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  8.31647217  -9.26300532 -83.45811031]
init_Out:  [2.54002979]
Stock Position:  8.316472170547405
Bond position:  [-829.10718727]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-4.0826314]
curr_Stock_Price:  99.25352916389949
curr_Factors:  [99.25352916 -0.73034962 -0.9906666 ]
mat_Sqrt:  [[17.75489511  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00118893  0.01630084  0.40634459]
Stock Position:  -0.0011889300734164428
Bond Position:  [-3.96462589]


portfolio before change:  [-4.08616615]
curr_Stock_Price:  100.55886082415849
curr_Factors:  [100.55886082  -1.0233238   -1.01622301]
mat_Sqrt:  [[13.08146617  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01774377  0.02244468 -0.51221563]
Stock Position:  0.01774376639630646
Bond Position:  [-5.87045909]


portfolio before change:  [-4.09065104]
curr_Stock_Price:  100.4715671748093
curr_Factors:  [100.47156717  -1.07202108  -0.9967014 ]
mat_Sqrt:  [[12.69429012  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00565255  0.02558279 -0.61520902]
Stock Position:  -0.005652552250019854
Bond Position:  [-3.52273025]


portfolio before change:  [-4.10712652]
curr_Stock_Price:  103.07458169183414
curr_Factors:  [103.07458169  -1.16169007  -1.04213765]
mat_Sqrt:  [[11.3773565   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00207993 -0.01923424 -0.12589089]
Stock Position:  0.0020799329500200948
Bond Position:  [-4.32151474]


portfolio before change:  [-4.11166378]
curr_Stock_Price:  101.93225592615747
curr_Factors:  [101.93225593  -0.53151623  -1.04643817]
mat_Sqrt:  [[21.03849882  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00240707 -0.01370278  0.08312832]
Stock Position:  0.002407073974670529
Bond Position:  [-4.35702226]


portfolio before change:  [-4.11547113]
curr_Stock_Price:  101.2557901036676
curr_Factors:  [101.2557901   -0.63466378  -1.01326088]
mat_Sqrt:  [[19.48656468  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.003599   -0.00085698 -0.27081276]
Stock Position:  0.003599000136858444
Bond Position:  [-4.47989074]


portfolio before change:  [-4.12177324]
curr_Stock_Price:  100.1272533905196
curr_Factors:  [100.12725339  -0.83654942  -0.99241649]
mat_Sqrt:  [[16.0783878   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00916932 -0.00943708 -0.02470533]
Stock Position:  -0.009169322419772877
Bond Position:  [-3.20367417]


portfolio before change:  [-4.12537385]
curr_Stock_Price:  100.34519357493977
curr_Factors:  [100.34519357  -0.62760818  -0.95790171]
mat_Sqrt:  [[20.55504251  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00756523 -0.01108826 -0.32262036]
Stock Position:  -0.00756522875732605
Bond Position:  [-3.3662395]


portfolio before change:  [-4.14248021]
curr_Stock_Price:  102.38383963763403
curr_Factors:  [102.38383964  -0.96715866  -1.00053093]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-4.14248021]
Stock Price:  102.07481892741235
PL:  [-6.21729914]
Settle:  Tensor("sub_382:0", shape=(), dtype=float64)
PL:  Tensor("sub_383:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  192
output_Z_Vals[:, i, :]:  [[ 1.19279309e+02 -2.92921948e+01 -2.92556094e+01]
 [-7.04779654e-02 -1.14653620e-01 -1.72427800e-03]
 [ 4.44231493e-01  6.94053770e-02 -2.66881280e-01]
 [ 2.03835248e-01 -6.47298234e-02 -1.41583345e-01]
 [-1.53195054e-01  1.52736656e-01  2.27786640e-01]
 [ 6.11316595e-02 -1.30874696e-02  1.39595636e-02]
 [ 7.12232159e-02  3.32100096e-02 -2.19985567e-01]
 [-1.59366945e-01 -1.34506046e-02 -4.00256173e-02]
 [-1.22620460e-01 -4.87193349e-02 -9.53249015e-02]
 [-5.12938200e-03 -3.01404813e-02  4.31606610e-03]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.27930914 -29.29219478 -29.25560936]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  8.31647217  -9.26300532 -83.45811031]
init_Out:  [2.54002979]
Stock Position:  8.316472170547405
Bond position:  [-829.10718727]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-8.99118964]
curr_Stock_Price:  98.66330795646418
curr_Factors:  [98.66330796 -1.15825655 -0.99518094]
mat_Sqrt:  [[11.45327397  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00644272 -0.03625666 -0.00491889]
Stock Position:  -0.006442723372212316
Bond Position:  [-8.35552924]


portfolio before change:  [-9.00187503]
curr_Stock_Price:  99.67321914435983
curr_Factors:  [99.67321914 -1.07361767 -0.97543695]
mat_Sqrt:  [[12.84355852  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.03048584  0.02194791 -0.76133801]
Stock Position:  0.030485836037436324
Bond Position:  [-12.04049645]


portfolio before change:  [-9.02865147]
curr_Stock_Price:  98.992421625988
curr_Factors:  [98.99242163 -1.65169528 -0.94658532]
mat_Sqrt:  [[ 7.36517414  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.02352468 -0.02046937 -0.40389787]
Stock Position:  0.023524678295263935
Bond Position:  [-11.35741634]


portfolio before change:  [-9.06176554]
curr_Stock_Price:  97.8262444736754
curr_Factors:  [97.82624447 -1.2394703  -0.89429561]
mat_Sqrt:  [[11.5817082   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00887215  0.04829957  0.64981188]
Stock Position:  -0.00887215038621554
Bond Position:  [-8.19383638]


portfolio before change:  [-9.082726]
curr_Stock_Price:  99.72685654644602
curr_Factors:  [99.72685655 -1.2276868  -0.90332541]
mat_Sqrt:  [[11.83927988  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0053756  -0.00413862  0.03982275]
Stock Position:  0.005375599453653217
Bond Position:  [-9.61881763]


portfolio before change:  [-9.08411109]
curr_Stock_Price:  100.36409041264571
curr_Factors:  [100.36409041  -1.32544573  -0.84957612]
mat_Sqrt:  [[11.40192984  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00238349  0.01050193 -0.62755759]
Stock Position:  0.0023834850053316555
Bond Position:  [-9.3233274]


portfolio before change:  [-9.08723896]
curr_Stock_Price:  101.00808760072748
curr_Factors:  [101.0080876   -1.87502335  -0.82151248]
mat_Sqrt:  [[ 6.81185697  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02464591 -0.00425345 -0.11418195]
Stock Position:  -0.02464591284742993
Bond Position:  [-6.59780244]


portfolio before change:  [-9.07530204]
curr_Stock_Price:  100.38986527283018
curr_Factors:  [100.38986527  -1.13856177  -0.80651943]
mat_Sqrt:  [[14.35330255  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00998631 -0.01540641 -0.27193541]
Stock Position:  -0.009986308157336487
Bond Position:  [-8.07277791]


portfolio before change:  [-9.06804295]
curr_Stock_Price:  99.25866774754789
curr_Factors:  [99.25866775 -0.6433243  -0.7271199 ]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-9.06804295]
Stock Price:  99.33427400821941
PL:  [-9.06804295]
Settle:  Tensor("sub_384:0", shape=(), dtype=float64)
PL:  Tensor("sub_385:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  193
output_Z_Vals[:, i, :]:  [[ 1.19279309e+02 -2.92921948e+01 -2.92556094e+01]
 [-5.39189569e-02  3.04854430e-02  1.24171261e-01]
 [ 1.23364312e+00  8.93504094e-02 -4.53062592e-01]
 [ 2.67619326e-01 -1.10832190e-01 -1.61126425e-01]
 [-3.98623269e-01  5.22797101e-01  6.13762260e-01]
 [ 1.06858794e-01  1.11479522e-01 -3.81758455e-02]
 [ 8.73464367e-02 -2.80371258e-02  1.60129511e-01]
 [ 1.28137963e-01 -9.89967292e-02 -6.67724292e-02]
 [-3.77245646e-03 -7.93834008e-02  1.22343643e-01]
 [-9.16429432e-03 -6.94035437e-02 -1.51589789e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.27930914 -29.29219478 -29.25560936]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  8.31647217  -9.26300532 -83.45811031]
init_Out:  [2.54002979]
Stock Position:  8.316472170547405
Bond position:  [-829.10718727]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [4.27163429]
curr_Stock_Price:  100.25807358077887
curr_Factors:  [100.25807358  -0.23887645  -1.07777217]
mat_Sqrt:  [[26.87237956  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00103398  0.00964034  0.35422605]
Stock Position:  -0.0010339789047016722
Bond Position:  [4.37529902]


portfolio before change:  [4.27931928]
curr_Stock_Price:  94.94191718872469
curr_Factors:  [ 9.49419172e+01  5.37615592e-02 -1.07375081e+00]
mat_Sqrt:  [[34.2359431   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.03339967  0.02825508 -1.29246147]
Stock Position:  0.03339966767206569
Bond Position:  [1.1082908]


portfolio before change:  [4.36301522]
curr_Stock_Price:  97.43121296575318
curr_Factors:  [97.43121297 -0.42635166 -1.1205384 ]
mat_Sqrt:  [[20.74399002  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01117759 -0.03504822 -0.45964884]
Stock Position:  0.011177592038134471
Bond Position:  [3.27396886]


portfolio before change:  [4.31390969]
curr_Stock_Price:  92.89151217476123
curr_Factors:  [92.89151217 -0.47513735 -1.12055733]
mat_Sqrt:  [[18.83539077  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01379536  0.16532296  1.75089289]
Stock Position:  -0.013795360693168024
Bond Position:  [5.5953816]


portfolio before change:  [4.31007476]
curr_Stock_Price:  93.37234906413877
curr_Factors:  [93.37234906 -0.53128116 -1.16314197]
mat_Sqrt:  [[17.15298341  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00594326  0.03525292 -0.10890506]
Stock Position:  0.0059432559571764715
Bond Position:  [3.75513899]


portfolio before change:  [4.31573534]
curr_Stock_Price:  94.00879206409525
curr_Factors:  [94.00879206 -0.85059099 -1.13165132]
mat_Sqrt:  [[12.95065025  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00921257 -0.00886612  0.45680492]
Stock Position:  0.009212573773120642
Bond Position:  [3.44967241]


portfolio before change:  [4.3050803]
curr_Stock_Price:  92.6649434749396
curr_Factors:  [92.66494347 -0.44721504 -1.13101434]
mat_Sqrt:  [[19.12049601  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00585508 -0.03130551 -0.19048315]
Stock Position:  0.0058550789366230175
Bond Position:  [3.76251974]


portfolio before change:  [4.30069643]
curr_Stock_Price:  91.59482870194319
curr_Factors:  [91.5948287  -0.30666872 -1.12550009]
mat_Sqrt:  [[21.87197228  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0008756  -0.02510324  0.34901236]
Stock Position:  0.0008756029995660509
Bond Position:  [4.22049572]


portfolio before change:  [4.30473806]
curr_Stock_Price:  93.80000406182725
curr_Factors:  [93.80000406 -0.2579241  -1.09172195]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [4.30473806]
Stock Price:  92.6997183815522
PL:  [4.30473806]
Settle:  Tensor("sub_386:0", shape=(), dtype=float64)
PL:  Tensor("sub_387:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  194
output_Z_Vals[:, i, :]:  [[ 1.19279309e+02 -2.92921948e+01 -2.92556094e+01]
 [-7.04779654e-02 -1.14653620e-01 -1.72427800e-03]
 [ 2.40897656e-01  6.22249837e-02 -1.26379290e-01]
 [-5.98475249e-02  1.07795484e-01 -1.73922051e-01]
 [ 4.29338285e-02 -6.65084050e-02 -5.50734911e-02]
 [ 6.77987191e-02  5.82708387e-02  7.31502530e-03]
 [ 1.08391862e-01 -1.09972237e-03 -1.78977922e-01]
 [-1.87570834e-02 -1.29871901e-01  3.83873940e-02]
 [ 4.22702673e-02  8.91697730e-02 -1.51417982e-01]
 [ 6.82179056e-02  4.10547923e-01 -2.40394596e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.27930914 -29.29219478 -29.25560936]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  8.31647217  -9.26300532 -83.45811031]
init_Out:  [2.54002979]
Stock Position:  8.316472170547405
Bond position:  [-829.10718727]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-7.71552626]
curr_Stock_Price:  98.81669792228706
curr_Factors:  [98.81669792 -1.21182501 -0.97270504]
mat_Sqrt:  [[11.11990274  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00663587 -0.03625666 -0.00491889]
Stock Position:  -0.006635874218295087
Bond Position:  [-7.05979108]


portfolio before change:  [-7.73342096]
curr_Stock_Price:  100.98128352243084
curr_Factors:  [100.98128352  -1.16159298  -0.96111805]
mat_Sqrt:  [[12.08813208  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01792727  0.01967727 -0.36052494]
Stock Position:  0.01792727217789395
Bond Position:  [-9.54373991]


portfolio before change:  [-7.72716401]
curr_Stock_Price:  101.596547615861
curr_Factors:  [101.59654762  -1.21700686  -0.96878987]
mat_Sqrt:  [[11.41824853  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00810684  0.03408793 -0.4961512 ]
Stock Position:  -0.008106842929080486
Bond Position:  [-6.90353676]


portfolio before change:  [-7.73385186]
curr_Stock_Price:  101.9956198578669
curr_Factors:  [101.99561986  -0.84186851  -1.0055819 ]
mat_Sqrt:  [[16.07844346  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00186428 -0.0210318  -0.15710934]
Stock Position:  0.0018642824251407745
Bond Position:  [-7.9240005]


portfolio before change:  [-7.73619845]
curr_Stock_Price:  102.86265560004264
curr_Factors:  [102.8626556   -0.67063723  -1.01991418]
mat_Sqrt:  [[18.96970524  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00373208 0.01842686 0.02086773]
Stock Position:  0.0037320790237350514
Bond Position:  [-8.12009001]


portfolio before change:  [-7.7286933]
curr_Stock_Price:  105.96178891897418
curr_Factors:  [105.96178892  -0.91537948  -1.10081388]
mat_Sqrt:  [[14.11002004  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 5.09069097e-03 -3.47762749e-04 -5.10574195e-01]
Stock Position:  0.005090690973724029
Bond Position:  [-8.26811203]


portfolio before change:  [-7.72104611]
curr_Stock_Price:  108.2762658594567
curr_Factors:  [108.27626586  -1.03789687  -1.07910193]
mat_Sqrt:  [[13.03564046  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00109504 -0.0410691   0.10950855]
Stock Position:  -0.001095041515590586
Bond Position:  [-7.6024791]


portfolio before change:  [-7.72461553]
curr_Stock_Price:  108.06370458851703
curr_Factors:  [108.06370459  -1.0680434   -1.14417326]
mat_Sqrt:  [[11.82840991  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00115523  0.02819796 -0.43195336]
Stock Position:  0.0011552317638272717
Bond Position:  [-7.84945416]


portfolio before change:  [-7.72731585]
curr_Stock_Price:  109.12443662059412
curr_Factors:  [109.12443662  -1.5893545   -1.15707898]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-7.72731585]
Stock Price:  109.39942385714451
PL:  [-17.12673971]
Settle:  Tensor("sub_388:0", shape=(), dtype=float64)
PL:  Tensor("sub_389:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  195
output_Z_Vals[:, i, :]:  [[ 1.19279309e+02 -2.92921948e+01 -2.92556094e+01]
 [-7.04779654e-02 -1.14653620e-01 -1.72427800e-03]
 [ 1.30185444e-01  1.93927529e-02  3.48108658e-02]
 [-5.76103078e-02  1.08111492e-01 -1.62499724e-01]
 [ 4.03660537e-02 -5.23449926e-02 -4.75874313e-02]
 [ 4.86067978e-02 -5.41098974e-02  2.63811748e-02]
 [ 7.51015527e-02  1.53721015e-02 -1.74564964e-01]
 [-2.14391669e-01  5.10309224e-02 -1.58828687e-01]
 [-5.20377064e-04  3.43871854e-02 -1.13407182e-01]
 [ 7.04565171e-02  3.87436467e-01 -1.19660107e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.27930914 -29.29219478 -29.25560936]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  8.31647217  -9.26300532 -83.45811031]
init_Out:  [2.54002979]
Stock Position:  8.316472170547405
Bond position:  [-829.10718727]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [26.02278428]
curr_Stock_Price:  102.87350348269888
curr_Factors:  [102.87350348  -1.20050757  -1.05489313]
mat_Sqrt:  [[10.78438672  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00684232 -0.03625666 -0.00491889]
Stock Position:  -0.006842324723749991
Bond Position:  [26.7266782]


portfolio before change:  [26.04253257]
curr_Stock_Price:  101.94083762115915
curr_Factors:  [101.94083762  -1.13700488  -1.01410973]
mat_Sqrt:  [[11.86126454  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01161697 0.00613253 0.09930571]
Stock Position:  0.011616965463619754
Bond Position:  [24.85828938]


portfolio before change:  [26.05187175]
curr_Stock_Price:  101.6745835198287
curr_Factors:  [101.67458352  -1.041709    -0.95728439]
mat_Sqrt:  [[13.77401674  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00638804  0.03418786 -0.46356648]
Stock Position:  -0.006388042069528402
Bond Position:  [26.70137327]


portfolio before change:  [26.06285343]
curr_Stock_Price:  102.04595633896692
curr_Factors:  [102.04595634  -1.14346706  -1.02226061]
mat_Sqrt:  [[11.70124914  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00250407 -0.01655294 -0.1357537 ]
Stock Position:  0.002504071807038004
Bond Position:  [25.80732303]


portfolio before change:  [26.07494609]
curr_Stock_Price:  101.72079254429322
curr_Factors:  [101.72079254  -1.41643104  -0.96561926]
mat_Sqrt:  [[ 9.39503567  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00559814 -0.01711105  0.07525815]
Stock Position:  0.005598139577510382
Bond Position:  [25.50549889]


portfolio before change:  [26.09872092]
curr_Stock_Price:  103.68910697188366
curr_Factors:  [103.68910697  -1.37351108  -0.9881963 ]
mat_Sqrt:  [[ 9.77364701  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00407888  0.00486109 -0.49798525]
Stock Position:  0.0040788801377304425
Bond Position:  [25.67578549]


portfolio before change:  [26.10861461]
curr_Stock_Price:  102.96650296574312
curr_Factors:  [102.96650297  -1.13686714  -0.98704703]
mat_Sqrt:  [[12.31095543  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01994117  0.01613739 -0.45309403]
Stock Position:  -0.01994116768781276
Bond Position:  [28.16188691]


portfolio before change:  [26.09415821]
curr_Stock_Price:  104.39775629820879
curr_Factors:  [104.3977563   -1.12983499  -1.00977414]
mat_Sqrt:  [[12.28770362  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00185402  0.01087418 -0.32351912]
Stock Position:  -0.0018540199674466793
Bond Position:  [26.28771374]


portfolio before change:  [26.10407232]
curr_Stock_Price:  106.14155755621076
curr_Factors:  [106.14155756  -0.90076416  -1.02690825]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [26.10407232]
Stock Price:  105.09141628398817
PL:  [21.01265603]
Settle:  Tensor("sub_390:0", shape=(), dtype=float64)
PL:  Tensor("sub_391:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  196
output_Z_Vals[:, i, :]:  [[ 1.19279309e+02 -2.92921948e+01 -2.92556094e+01]
 [-5.83345311e-02 -2.17266099e-02  7.97134662e-02]
 [-1.19996874e-01 -3.28237010e-02  6.97201810e-02]
 [-4.72323386e-02  1.36644084e-01  1.18148105e-02]
 [ 1.88754239e-02 -8.63879180e-02 -9.04463958e-03]
 [ 2.84687567e-01  1.03312893e+00 -2.07959122e-01]
 [ 1.30747113e-01  4.12151977e-03 -2.19770465e-01]
 [ 2.32995288e-02 -1.35761569e-01 -1.72116846e-02]
 [ 3.62511234e-02  7.14926781e-02 -1.34689647e-01]
 [ 6.50291392e-02  3.52437847e-01 -6.57751016e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.27930914 -29.29219478 -29.25560936]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  8.31647217  -9.26300532 -83.45811031]
init_Out:  [2.54002979]
Stock Position:  8.316472170547405
Bond position:  [-829.10718727]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [11.40900766]
curr_Stock_Price:  101.11629485868399
curr_Factors:  [101.11629486  -0.57033956  -1.00240613]
mat_Sqrt:  [[20.97907685  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00203174 -0.00687056  0.22740033]
Stock Position:  -0.0020317417659374863
Bond Position:  [11.61444986]


portfolio before change:  [11.41032255]
curr_Stock_Price:  103.3280867193765
curr_Factors:  [103.32808672  -0.54092386  -0.99410341]
mat_Sqrt:  [[22.26201731  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.004789   -0.01037977  0.19889227]
Stock Position:  -0.004789000215447463
Bond Position:  [11.90516078]


portfolio before change:  [11.41287714]
curr_Stock_Price:  104.0379384445132
curr_Factors:  [104.03793844  -0.66023623  -0.99451663]
mat_Sqrt:  [[19.88573756  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00207649  0.04321065  0.03370437]
Stock Position:  -0.0020764890057783387
Bond Position:  [11.62891077]


portfolio before change:  [11.41168308]
curr_Stock_Price:  107.41381201739965
curr_Factors:  [107.41381202  -0.62910029  -0.9879193 ]
mat_Sqrt:  [[21.32050304  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00069411 -0.02731826 -0.02580184]
Stock Position:  0.0006941050154552973
Bond Position:  [11.33712662]


portfolio before change:  [11.4197068]
curr_Stock_Price:  110.80484925127968
curr_Factors:  [110.80484925  -0.25777622  -0.99839225]
mat_Sqrt:  [[31.55089845  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00852316  0.32670405 -0.59324949]
Stock Position:  0.008523160232787498
Bond Position:  [10.47529932]


portfolio before change:  [11.41280434]
curr_Stock_Price:  109.38032848513889
curr_Factors:  [109.38032849  -0.18292721  -0.99516522]
mat_Sqrt:  [[33.67442433  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00255366  0.00130334 -0.62694396]
Stock Position:  0.002553661215523603
Bond Position:  [11.13348404]


portfolio before change:  [11.41730773]
curr_Stock_Price:  108.96337980390945
curr_Factors:  [108.9633798   -0.2616486   -0.94016967]
mat_Sqrt:  [[32.75951952  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00049698 -0.04293158 -0.04910015]
Stock Position:  0.0004969810291539177
Bond Position:  [11.363155]


portfolio before change:  [11.42233503]
curr_Stock_Price:  107.64402470586164
curr_Factors:  [107.64402471  -0.72704682  -0.95005745]
mat_Sqrt:  [[20.12022325  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00052701  0.02260797 -0.38423207]
Stock Position:  0.0005270143974659942
Bond Position:  [11.36560508]


portfolio before change:  [11.42688138]
curr_Stock_Price:  105.48492866966454
curr_Factors:  [105.48492867  -1.57708459  -0.91841639]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [11.42688138]
Stock Price:  104.54556058965883
PL:  [6.88132079]
Settle:  Tensor("sub_392:0", shape=(), dtype=float64)
PL:  Tensor("sub_393:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  197
output_Z_Vals[:, i, :]:  [[ 1.19279309e+02 -2.92921948e+01 -2.92556094e+01]
 [-7.04779654e-02 -1.14653620e-01 -1.72427800e-03]
 [-6.81939967e-02 -4.70895768e-02  6.10195362e-02]
 [-6.58150517e-02  1.75294346e-01  1.01958093e-01]
 [ 3.99996711e-03  4.24095350e-02  2.23793975e-02]
 [ 2.34273864e-01  8.10150837e-01 -1.57923111e-01]
 [ 1.07543854e-01  1.77823031e-03 -2.18627819e-01]
 [-6.28827611e-02 -9.75954405e-02  1.92248671e-02]
 [ 4.65597967e-02  9.53304919e-02 -1.56197137e-01]
 [ 7.02167976e-02  4.26908848e-01 -2.73456113e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.27930914 -29.29219478 -29.25560936]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  8.31647217  -9.26300532 -83.45811031]
init_Out:  [2.54002979]
Stock Position:  8.316472170547405
Bond position:  [-829.10718727]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [31.29905339]
curr_Stock_Price:  103.50793945506392
curr_Factors:  [103.50793946  -0.94857661  -1.00148064]
mat_Sqrt:  [[14.72565285  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.005011   -0.03625666 -0.00491889]
Stock Position:  -0.005011002000085119
Bond Position:  [31.81773188]


portfolio before change:  [31.30521684]
curr_Stock_Price:  105.45353828874723
curr_Factors:  [105.45353829  -0.81848558  -1.02119667]
mat_Sqrt:  [[16.75318207  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00339961 -0.01489103  0.17407175]
Stock Position:  -0.003399609902753629
Bond Position:  [31.66371773]


portfolio before change:  [31.31682119]
curr_Stock_Price:  106.69822867790944
curr_Factors:  [106.69822868  -1.54865815  -0.95245977]
mat_Sqrt:  [[ 8.74853836  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0046267   0.05543294  0.29085806]
Stock Position:  -0.004626700023822025
Bond Position:  [31.81048189]


portfolio before change:  [31.32429797]
curr_Stock_Price:  108.52078774334473
curr_Factors:  [108.52078774  -1.24847645  -1.03111838]
mat_Sqrt:  [[11.10446097  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.0008702  0.01341107 0.06384219]
Stock Position:  0.0008702045065662838
Bond Position:  [31.2298627]


portfolio before change:  [31.34045451]
curr_Stock_Price:  109.13869174590015
curr_Factors:  [109.13869175  -1.34440517  -1.03259983]
mat_Sqrt:  [[10.1311464   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.02200698  0.25619219 -0.45051068]
Stock Position:  0.02200698121118013
Bond Position:  [28.93864137]


portfolio before change:  [31.33243079]
curr_Stock_Price:  108.11644064371886
curr_Factors:  [108.11644064  -1.22820989  -1.05911187]
mat_Sqrt:  [[10.97793151  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 5.73537474e-03  5.62325798e-04 -6.23684313e-01]
Stock Position:  0.005735374740350536
Bond Position:  [30.71234249]


portfolio before change:  [31.34631417]
curr_Stock_Price:  107.85898030312255
curr_Factors:  [107.8589803   -1.61889369  -1.07992041]
mat_Sqrt:  [[ 7.25731939  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00847123 -0.03086239  0.05484319]
Stock Position:  -0.008471227696705358
Bond Position:  [32.26001215]


portfolio before change:  [31.35552153]
curr_Stock_Price:  108.67665133826371
curr_Factors:  [108.67665134  -1.09980351  -1.08544116]
mat_Sqrt:  [[12.22071301  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00140234  0.03014615 -0.44558695]
Stock Position:  0.0014023414484913986
Bond Position:  [31.20311976]


portfolio before change:  [31.37229485]
curr_Stock_Price:  109.50944191686101
curr_Factors:  [109.50944192  -0.94858831  -1.03917228]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [31.37229485]
Stock Price:  106.2384530801428
PL:  [25.13384177]
Settle:  Tensor("sub_394:0", shape=(), dtype=float64)
PL:  Tensor("sub_395:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  198
output_Z_Vals[:, i, :]:  [[ 1.19279309e+02 -2.92921948e+01 -2.92556094e+01]
 [-7.04779654e-02 -1.14653620e-01 -1.72427800e-03]
 [ 4.56936337e-01  7.00714767e-02 -2.67281797e-01]
 [-3.88751397e-02  8.63057052e-02 -2.20003905e-01]
 [-1.74032989e-02 -7.89769258e-03  2.90621081e-02]
 [ 6.76542833e-02  5.62133427e-02  7.45930833e-03]
 [ 1.08881228e-01 -6.85340982e-03 -1.01040749e-01]
 [-2.06301435e-01  4.04816424e-02 -1.41561646e-01]
 [-9.51572903e-02 -2.00755120e-03 -1.26942120e-01]
 [ 1.00959276e-02  6.42715636e-02  1.11279496e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.27930914 -29.29219478 -29.25560936]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  8.31647217  -9.26300532 -83.45811031]
init_Out:  [2.54002979]
Stock Position:  8.316472170547405
Bond position:  [-829.10718727]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-2.32582734]
curr_Stock_Price:  99.46477306847558
curr_Factors:  [99.46477307 -1.08990855 -0.95607861]
mat_Sqrt:  [[12.85607402  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00573972 -0.03625666 -0.00491889]
Stock Position:  -0.005739720832882561
Bond Position:  [-1.75492731]


portfolio before change:  [-2.32747569]
curr_Stock_Price:  99.59904136348763
curr_Factors:  [99.59904136 -1.04328068 -0.92137393]
mat_Sqrt:  [[13.96421423  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.02894448  0.02215855 -0.76248057]
Stock Position:  0.02894447906912924
Bond Position:  [-5.21031806]


portfolio before change:  [-2.30123997]
curr_Stock_Price:  100.59548460294127
curr_Factors:  [100.5954846   -1.11623763  -0.90452494]
mat_Sqrt:  [[13.33436863  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00611614  0.02729226 -0.62760991]
Stock Position:  -0.006116138480905324
Bond Position:  [-1.68598406]


portfolio before change:  [-2.30317607]
curr_Stock_Price:  100.77417488997993
curr_Factors:  [100.77417489  -0.97524748  -0.92789732]
mat_Sqrt:  [[15.02532814  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00077702 -0.00249747  0.08290611]
Stock Position:  -0.0007770172036550307
Bond Position:  [-2.2248728]


portfolio before change:  [-2.30579036]
curr_Stock_Price:  102.70666089320687
curr_Factors:  [102.70666089  -0.46669875  -0.92169046]
mat_Sqrt:  [[25.62293287  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00275645 0.01777622 0.02127933]
Stock Position:  0.002756449890500775
Bond Position:  [-2.58889612]


portfolio before change:  [-2.30006153]
curr_Stock_Price:  105.25471935427598
curr_Factors:  [105.25471935  -0.63249081  -0.96211936]
mat_Sqrt:  [[21.36540744  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00412252 -0.00216724 -0.28824113]
Stock Position:  0.004122524586276463
Bond Position:  [-2.7339767]


portfolio before change:  [-2.31336972]
curr_Stock_Price:  102.35822754807872
curr_Factors:  [102.35822755  -0.85016533  -0.96356618]
mat_Sqrt:  [[16.68895614  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01403038  0.01280142 -0.40383597]
Stock Position:  -0.014030377403234602
Bond Position:  [-0.87724516]


portfolio before change:  [-2.31077311]
curr_Stock_Price:  102.14188642652616
curr_Factors:  [102.14188643  -0.62974895  -0.92327622]
mat_Sqrt:  [[21.6139236   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00560384 -0.00063484 -0.36213053]
Stock Position:  -0.005603844961205556
Bond Position:  [-1.73838581]


portfolio before change:  [-2.2999988]
curr_Stock_Price:  100.06407735470096
curr_Factors:  [100.06407735  -0.56516599  -0.87407851]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-2.2999988]
Stock Price:  105.11289616749725
PL:  [-7.41289496]
Settle:  Tensor("sub_396:0", shape=(), dtype=float64)
PL:  Tensor("sub_397:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  199
output_Z_Vals[:, i, :]:  [[ 1.19279309e+02 -2.92921948e+01 -2.92556094e+01]
 [-7.04779654e-02 -1.14653620e-01 -1.72427800e-03]
 [ 1.88930044e-01  3.76943607e-02 -3.93928429e-02]
 [-2.58543288e-02  8.10896340e-02 -1.97716266e-01]
 [ 3.47901589e-02 -5.83769998e-02 -4.36285536e-02]
 [ 4.05241652e-02 -7.03572677e-02  3.43904789e-02]
 [ 5.65126034e-02 -2.10210950e-02  4.83033276e-02]
 [ 6.29177357e-02 -8.32515604e-02  6.30914280e-03]
 [-1.30605028e-01 -1.79076053e-02 -1.29630178e-01]
 [ 5.10046760e-02  2.51405391e-01 -2.05557100e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.27930914 -29.29219478 -29.25560936]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  8.31647217  -9.26300532 -83.45811031]
init_Out:  [2.54002979]
Stock Position:  8.316472170547405
Bond position:  [-829.10718727]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [12.14851684]
curr_Stock_Price:  101.20521587721979
curr_Factors:  [101.20521588  -1.07524059  -1.01695684]
mat_Sqrt:  [[12.49030661  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0059078  -0.03625666 -0.00491889]
Stock Position:  -0.005907803402929617
Bond Position:  [12.74641736]


portfolio before change:  [12.15360572]
curr_Stock_Price:  101.42288134558072
curr_Factors:  [101.42288135  -1.06413139  -0.98461382]
mat_Sqrt:  [[13.07305845  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01391123  0.01192    -0.11237682]
Stock Position:  0.013911226547005629
Bond Position:  [10.74268904]


portfolio before change:  [12.14559391]
curr_Stock_Price:  100.46074524440415
curr_Factors:  [100.46074524  -0.4630332   -0.98176133]
mat_Sqrt:  [[23.68809318  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00270681  0.02564279 -0.56402947]
Stock Position:  -0.0027068142132216596
Bond Position:  [12.41752248]


portfolio before change:  [12.14822491]
curr_Stock_Price:  101.78308096542794
curr_Factors:  [101.78308097  -0.77553756  -0.97423156]
mat_Sqrt:  [[17.69133149  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00137792 -0.01846043 -0.12446012]
Stock Position:  0.0013779194672926146
Bond Position:  [12.00797602]


portfolio before change:  [12.14934972]
curr_Stock_Price:  98.24101989320152
curr_Factors:  [98.24101989 -0.30995141 -0.9650282 ]
mat_Sqrt:  [[27.45214324  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00166572 -0.02224892  0.09810646]
Stock Position:  0.0016657160437761006
Bond Position:  [11.98570808]


portfolio before change:  [12.1581222]
curr_Stock_Price:  99.9088485758907
curr_Factors:  [99.90884858 -0.17481961 -0.88352517]
mat_Sqrt:  [[34.67134229  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00189868 -0.00664745  0.13779595]
Stock Position:  0.0018986780492112186
Bond Position:  [11.96842747]


portfolio before change:  [12.15763042]
curr_Stock_Price:  96.49726638933554
curr_Factors:  [96.49726639 -0.23355659 -0.84229666]
mat_Sqrt:  [[32.90621102  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00188585 -0.02632645  0.01799823]
Stock Position:  0.0018858457464101792
Bond Position:  [11.97565146]


portfolio before change:  [12.17258407]
curr_Stock_Price:  101.25074452959372
curr_Factors:  [101.25074453  -0.53862134  -0.83931455]
mat_Sqrt:  [[25.52514803  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00617148 -0.00566288 -0.36979882]
Stock Position:  -0.006171484253511092
Bond Position:  [12.79745144]


portfolio before change:  [12.17483571]
curr_Stock_Price:  101.92297829582355
curr_Factors:  [101.9229783   -0.52991991  -0.80262502]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [12.17483571]
Stock Price:  99.68416611771325
PL:  [12.17483571]
Settle:  Tensor("sub_398:0", shape=(), dtype=float64)
PL:  Tensor("sub_399:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


FINAL AVERAGE P&L:  -0.09578934527444066
FINAL STD P&L:  12.150098574146094
