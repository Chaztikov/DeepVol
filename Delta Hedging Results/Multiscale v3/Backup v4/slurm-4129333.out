WARNING:tensorflow:From main.py:92: The name tf.reset_default_graph is deprecated. Please use tf.compat.v1.reset_default_graph instead.

WARNING From main.py:92: The name tf.reset_default_graph is deprecated. Please use tf.compat.v1.reset_default_graph instead.

WARNING:tensorflow:From main.py:93: The name tf.Session is deprecated. Please use tf.compat.v1.Session instead.

WARNING From main.py:93: The name tf.Session is deprecated. Please use tf.compat.v1.Session instead.

2019-12-17 23:48:31.255512: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcuda.so.1
2019-12-17 23:48:31.278309: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1618] Found device 0 with properties: 
name: Tesla P100-PCIE-16GB major: 6 minor: 0 memoryClockRate(GHz): 1.3285
pciBusID: 0000:03:00.0
2019-12-17 23:48:31.278862: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcudart.so.10.0
2019-12-17 23:48:31.280996: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcublas.so.10.0
2019-12-17 23:48:31.282957: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcufft.so.10.0
2019-12-17 23:48:31.283968: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcurand.so.10.0
2019-12-17 23:48:31.286377: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcusolver.so.10.0
2019-12-17 23:48:31.288274: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcusparse.so.10.0
2019-12-17 23:48:31.293385: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcudnn.so.7
2019-12-17 23:48:31.295502: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1746] Adding visible gpu devices: 0
2019-12-17 23:48:31.295918: I tensorflow/core/platform/cpu_feature_guard.cc:142] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX AVX2 FMA
2019-12-17 23:48:31.302782: I tensorflow/core/platform/profile_utils/cpu_utils.cc:94] CPU Frequency: 2399855000 Hz
2019-12-17 23:48:31.302957: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x55e8a018a610 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2019-12-17 23:48:31.302975: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2019-12-17 23:48:31.304130: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1618] Found device 0 with properties: 
name: Tesla P100-PCIE-16GB major: 6 minor: 0 memoryClockRate(GHz): 1.3285
pciBusID: 0000:03:00.0
2019-12-17 23:48:31.304154: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcudart.so.10.0
2019-12-17 23:48:31.304167: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcublas.so.10.0
2019-12-17 23:48:31.304180: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcufft.so.10.0
2019-12-17 23:48:31.304192: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcurand.so.10.0
2019-12-17 23:48:31.304204: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcusolver.so.10.0
2019-12-17 23:48:31.304216: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcusparse.so.10.0
2019-12-17 23:48:31.304228: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcudnn.so.7
2019-12-17 23:48:31.306274: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1746] Adding visible gpu devices: 0
2019-12-17 23:48:31.306305: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcudart.so.10.0
2019-12-17 23:48:31.399575: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1159] Device interconnect StreamExecutor with strength 1 edge matrix:
2019-12-17 23:48:31.399608: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1165]      0 
2019-12-17 23:48:31.399619: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1178] 0:   N 
2019-12-17 23:48:31.402838: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1304] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 15216 MB memory) -> physical GPU (device: 0, name: Tesla P100-PCIE-16GB, pci bus id: 0000:03:00.0, compute capability: 6.0)
2019-12-17 23:48:31.405107: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x55e8a07c3920 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2019-12-17 23:48:31.405124: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Tesla P100-PCIE-16GB, Compute Capability 6.0
INFO   Y0_true: -1.0000e+00
WARNING:tensorflow:From /home/dz4/DeepBSDE/solver.py:229: The name tf.placeholder is deprecated. Please use tf.compat.v1.placeholder instead.

WARNING From /home/dz4/DeepBSDE/solver.py:229: The name tf.placeholder is deprecated. Please use tf.compat.v1.placeholder instead.

WARNING:tensorflow:From /home/dz4/DeepBSDE/solver.py:234: The name tf.random_uniform is deprecated. Please use tf.random.uniform instead.

WARNING From /home/dz4/DeepBSDE/solver.py:234: The name tf.random_uniform is deprecated. Please use tf.random.uniform instead.

WARNING:tensorflow:From /home/dz4/DeepBSDE/solver.py:308: The name tf.variable_scope is deprecated. Please use tf.compat.v1.variable_scope instead.

WARNING From /home/dz4/DeepBSDE/solver.py:308: The name tf.variable_scope is deprecated. Please use tf.compat.v1.variable_scope instead.

WARNING:tensorflow:From /home/dz4/DeepBSDE/solver.py:314: calling reduce_sum_v1 (from tensorflow.python.ops.math_ops) with keep_dims is deprecated and will be removed in a future version.
Instructions for updating:
keep_dims is deprecated, use keepdims instead
WARNING From /home/dz4/DeepBSDE/solver.py:314: calling reduce_sum_v1 (from tensorflow.python.ops.math_ops) with keep_dims is deprecated and will be removed in a future version.
Instructions for updating:
keep_dims is deprecated, use keepdims instead
WARNING:tensorflow:From /home/dz4/DeepBSDE/solver.py:484: The name tf.get_variable is deprecated. Please use tf.compat.v1.get_variable instead.

WARNING From /home/dz4/DeepBSDE/solver.py:484: The name tf.get_variable is deprecated. Please use tf.compat.v1.get_variable instead.

WARNING:tensorflow:From /home/dz4/DeepBSDE/solver.py:486: calling RandomNormal.__init__ (from tensorflow.python.ops.init_ops) with dtype is deprecated and will be removed in a future version.
Instructions for updating:
Call initializer instance with the dtype argument instead of passing it to the constructor
WARNING From /home/dz4/DeepBSDE/solver.py:486: calling RandomNormal.__init__ (from tensorflow.python.ops.init_ops) with dtype is deprecated and will be removed in a future version.
Instructions for updating:
Call initializer instance with the dtype argument instead of passing it to the constructor
WARNING:tensorflow:From /home/dz4/DeepBSDE/solver.py:489: calling RandomUniform.__init__ (from tensorflow.python.ops.init_ops) with dtype is deprecated and will be removed in a future version.
Instructions for updating:
Call initializer instance with the dtype argument instead of passing it to the constructor
WARNING From /home/dz4/DeepBSDE/solver.py:489: calling RandomUniform.__init__ (from tensorflow.python.ops.init_ops) with dtype is deprecated and will be removed in a future version.
Instructions for updating:
Call initializer instance with the dtype argument instead of passing it to the constructor
WARNING:tensorflow:From /home/dz4/DeepBSDE/solver.py:491: calling Constant.__init__ (from tensorflow.python.ops.init_ops) with dtype is deprecated and will be removed in a future version.
Instructions for updating:
Call initializer instance with the dtype argument instead of passing it to the constructor
WARNING From /home/dz4/DeepBSDE/solver.py:491: calling Constant.__init__ (from tensorflow.python.ops.init_ops) with dtype is deprecated and will be removed in a future version.
Instructions for updating:
Call initializer instance with the dtype argument instead of passing it to the constructor
WARNING:tensorflow:From /home/dz4/DeepBSDE/solver.py:327: where (from tensorflow.python.ops.array_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.where in 2.0, which has the same broadcast rule as np.where
WARNING From /home/dz4/DeepBSDE/solver.py:327: where (from tensorflow.python.ops.array_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.where in 2.0, which has the same broadcast rule as np.where
WARNING:tensorflow:From /home/dz4/DeepBSDE/solver.py:334: The name tf.train.piecewise_constant is deprecated. Please use tf.compat.v1.train.piecewise_constant instead.

WARNING From /home/dz4/DeepBSDE/solver.py:334: The name tf.train.piecewise_constant is deprecated. Please use tf.compat.v1.train.piecewise_constant instead.

WARNING:tensorflow:From /home/dz4/DeepBSDE/solver.py:337: The name tf.trainable_variables is deprecated. Please use tf.compat.v1.trainable_variables instead.

WARNING From /home/dz4/DeepBSDE/solver.py:337: The name tf.trainable_variables is deprecated. Please use tf.compat.v1.trainable_variables instead.

WARNING:tensorflow:From /home/dz4/DeepBSDE/solver.py:339: The name tf.train.AdamOptimizer is deprecated. Please use tf.compat.v1.train.AdamOptimizer instead.

WARNING From /home/dz4/DeepBSDE/solver.py:339: The name tf.train.AdamOptimizer is deprecated. Please use tf.compat.v1.train.AdamOptimizer instead.

WARNING:tensorflow:From /home/dz4/DeepBSDE/solver.py:192: The name tf.global_variables_initializer is deprecated. Please use tf.compat.v1.global_variables_initializer instead.

WARNING From /home/dz4/DeepBSDE/solver.py:192: The name tf.global_variables_initializer is deprecated. Please use tf.compat.v1.global_variables_initializer instead.

2019-12-17 23:49:06.700253: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcublas.so.10.0
INFO   step:     0,    loss: 1.1588e+02,   Y0: 2.4261e+00,  elapsed time  35
INFO   step:     1,    loss: 6.1234e+01,   Y0: 2.4211e+00,  elapsed time  52
INFO   step:     2,    loss: 6.1227e+01,   Y0: 2.4167e+00,  elapsed time  54
INFO   step:     3,    loss: 6.1219e+01,   Y0: 2.4189e+00,  elapsed time  56
INFO   step:     4,    loss: 6.1213e+01,   Y0: 2.4221e+00,  elapsed time  59
INFO   step:     5,    loss: 6.1211e+01,   Y0: 2.4257e+00,  elapsed time  61
INFO   step:     6,    loss: 6.1206e+01,   Y0: 2.4293e+00,  elapsed time  63
INFO   step:     7,    loss: 6.1200e+01,   Y0: 2.4322e+00,  elapsed time  65
INFO   step:     8,    loss: 6.1197e+01,   Y0: 2.4352e+00,  elapsed time  68
INFO   step:     9,    loss: 6.1190e+01,   Y0: 2.4376e+00,  elapsed time  70
INFO   step:    10,    loss: 6.1182e+01,   Y0: 2.4408e+00,  elapsed time  72
INFO   step:    11,    loss: 6.1176e+01,   Y0: 2.4440e+00,  elapsed time  75
INFO   step:    12,    loss: 6.1171e+01,   Y0: 2.4472e+00,  elapsed time  77
INFO   step:    13,    loss: 6.1166e+01,   Y0: 2.4500e+00,  elapsed time  79
INFO   step:    14,    loss: 6.1161e+01,   Y0: 2.4528e+00,  elapsed time  82
INFO   step:    15,    loss: 6.1156e+01,   Y0: 2.4560e+00,  elapsed time  84
INFO   step:    16,    loss: 6.1153e+01,   Y0: 2.4597e+00,  elapsed time  86
INFO   step:    17,    loss: 6.1148e+01,   Y0: 2.4631e+00,  elapsed time  89
INFO   step:    18,    loss: 6.1143e+01,   Y0: 2.4661e+00,  elapsed time  91
INFO   step:    19,    loss: 6.1137e+01,   Y0: 2.4691e+00,  elapsed time  93
INFO   step:    20,    loss: 6.1132e+01,   Y0: 2.4716e+00,  elapsed time  95
INFO   step:    21,    loss: 6.1127e+01,   Y0: 2.4735e+00,  elapsed time  98
INFO   step:    22,    loss: 6.1122e+01,   Y0: 2.4755e+00,  elapsed time 100
INFO   step:    23,    loss: 6.1116e+01,   Y0: 2.4769e+00,  elapsed time 102
INFO   step:    24,    loss: 6.1111e+01,   Y0: 2.4783e+00,  elapsed time 105
INFO   step:    25,    loss: 6.1105e+01,   Y0: 2.4792e+00,  elapsed time 107
INFO   step:    26,    loss: 6.1100e+01,   Y0: 2.4807e+00,  elapsed time 109
INFO   step:    27,    loss: 6.1094e+01,   Y0: 2.4824e+00,  elapsed time 112
INFO   step:    28,    loss: 6.1088e+01,   Y0: 2.4843e+00,  elapsed time 114
INFO   step:    29,    loss: 6.1082e+01,   Y0: 2.4862e+00,  elapsed time 116
INFO   step:    30,    loss: 6.1076e+01,   Y0: 2.4880e+00,  elapsed time 119
INFO   step:    31,    loss: 6.1070e+01,   Y0: 2.4892e+00,  elapsed time 121
INFO   step:    32,    loss: 6.1064e+01,   Y0: 2.4903e+00,  elapsed time 123
INFO   step:    33,    loss: 6.1059e+01,   Y0: 2.4916e+00,  elapsed time 125
INFO   step:    34,    loss: 6.1053e+01,   Y0: 2.4933e+00,  elapsed time 128
INFO   step:    35,    loss: 6.1049e+01,   Y0: 2.4948e+00,  elapsed time 130
INFO   step:    36,    loss: 6.1044e+01,   Y0: 2.4965e+00,  elapsed time 132
INFO   step:    37,    loss: 6.1040e+01,   Y0: 2.4976e+00,  elapsed time 135
INFO   step:    38,    loss: 6.1037e+01,   Y0: 2.4991e+00,  elapsed time 137
INFO   step:    39,    loss: 6.1033e+01,   Y0: 2.5004e+00,  elapsed time 139
INFO   step:    40,    loss: 6.1028e+01,   Y0: 2.5021e+00,  elapsed time 142
INFO   step:    41,    loss: 6.1022e+01,   Y0: 2.5027e+00,  elapsed time 144
INFO   step:    42,    loss: 6.1016e+01,   Y0: 2.5026e+00,  elapsed time 146
INFO   step:    43,    loss: 6.1011e+01,   Y0: 2.5029e+00,  elapsed time 149
INFO   step:    44,    loss: 6.1006e+01,   Y0: 2.5030e+00,  elapsed time 151
INFO   step:    45,    loss: 6.1001e+01,   Y0: 2.5027e+00,  elapsed time 153
INFO   step:    46,    loss: 6.0996e+01,   Y0: 2.5024e+00,  elapsed time 155
INFO   step:    47,    loss: 6.0992e+01,   Y0: 2.5023e+00,  elapsed time 158
INFO   step:    48,    loss: 6.0989e+01,   Y0: 2.5018e+00,  elapsed time 160
INFO   step:    49,    loss: 6.0986e+01,   Y0: 2.5015e+00,  elapsed time 162
INFO   step:    50,    loss: 6.0983e+01,   Y0: 2.5012e+00,  elapsed time 165
INFO   step:    51,    loss: 6.0978e+01,   Y0: 2.5008e+00,  elapsed time 167
INFO   step:    52,    loss: 6.0974e+01,   Y0: 2.4996e+00,  elapsed time 169
INFO   step:    53,    loss: 6.0969e+01,   Y0: 2.4991e+00,  elapsed time 172
INFO   step:    54,    loss: 6.0964e+01,   Y0: 2.4978e+00,  elapsed time 174
INFO   step:    55,    loss: 6.0958e+01,   Y0: 2.4966e+00,  elapsed time 176
INFO   step:    56,    loss: 6.0951e+01,   Y0: 2.4958e+00,  elapsed time 179
INFO   step:    57,    loss: 6.0944e+01,   Y0: 2.4963e+00,  elapsed time 181
INFO   step:    58,    loss: 6.0937e+01,   Y0: 2.4966e+00,  elapsed time 183
INFO   step:    59,    loss: 6.0930e+01,   Y0: 2.4973e+00,  elapsed time 185
INFO   step:    60,    loss: 6.0923e+01,   Y0: 2.4972e+00,  elapsed time 188
INFO   step:    61,    loss: 6.0918e+01,   Y0: 2.4967e+00,  elapsed time 190
INFO   step:    62,    loss: 6.0912e+01,   Y0: 2.4970e+00,  elapsed time 192
INFO   step:    63,    loss: 6.0907e+01,   Y0: 2.4970e+00,  elapsed time 195
INFO   step:    64,    loss: 6.0900e+01,   Y0: 2.4966e+00,  elapsed time 197
INFO   step:    65,    loss: 6.0893e+01,   Y0: 2.4968e+00,  elapsed time 199
INFO   step:    66,    loss: 6.0887e+01,   Y0: 2.4972e+00,  elapsed time 202
INFO   step:    67,    loss: 6.0881e+01,   Y0: 2.4977e+00,  elapsed time 204
INFO   step:    68,    loss: 6.0876e+01,   Y0: 2.4989e+00,  elapsed time 206
INFO   step:    69,    loss: 6.0871e+01,   Y0: 2.5000e+00,  elapsed time 209
INFO   step:    70,    loss: 6.0865e+01,   Y0: 2.5018e+00,  elapsed time 211
INFO   step:    71,    loss: 6.0860e+01,   Y0: 2.5035e+00,  elapsed time 213
INFO   step:    72,    loss: 6.0854e+01,   Y0: 2.5048e+00,  elapsed time 215
INFO   step:    73,    loss: 6.0847e+01,   Y0: 2.5056e+00,  elapsed time 218
INFO   step:    74,    loss: 6.0841e+01,   Y0: 2.5059e+00,  elapsed time 220
INFO   step:    75,    loss: 6.0834e+01,   Y0: 2.5062e+00,  elapsed time 222
INFO   step:    76,    loss: 6.0827e+01,   Y0: 2.5071e+00,  elapsed time 225
INFO   step:    77,    loss: 6.0820e+01,   Y0: 2.5083e+00,  elapsed time 227
INFO   step:    78,    loss: 6.0813e+01,   Y0: 2.5091e+00,  elapsed time 229
INFO   step:    79,    loss: 6.0807e+01,   Y0: 2.5101e+00,  elapsed time 232
INFO   step:    80,    loss: 6.0801e+01,   Y0: 2.5111e+00,  elapsed time 234
INFO   step:    81,    loss: 6.0793e+01,   Y0: 2.5124e+00,  elapsed time 236
INFO   step:    82,    loss: 6.0785e+01,   Y0: 2.5134e+00,  elapsed time 239
INFO   step:    83,    loss: 6.0777e+01,   Y0: 2.5144e+00,  elapsed time 241
INFO   step:    84,    loss: 6.0769e+01,   Y0: 2.5152e+00,  elapsed time 243
INFO   step:    85,    loss: 6.0763e+01,   Y0: 2.5149e+00,  elapsed time 245
INFO   step:    86,    loss: 6.0756e+01,   Y0: 2.5147e+00,  elapsed time 248
INFO   step:    87,    loss: 6.0750e+01,   Y0: 2.5146e+00,  elapsed time 250
INFO   step:    88,    loss: 6.0742e+01,   Y0: 2.5146e+00,  elapsed time 252
INFO   step:    89,    loss: 6.0736e+01,   Y0: 2.5147e+00,  elapsed time 255
INFO   step:    90,    loss: 6.0730e+01,   Y0: 2.5145e+00,  elapsed time 257
INFO   step:    91,    loss: 6.0723e+01,   Y0: 2.5139e+00,  elapsed time 259
INFO   step:    92,    loss: 6.0716e+01,   Y0: 2.5129e+00,  elapsed time 262
INFO   step:    93,    loss: 6.0709e+01,   Y0: 2.5118e+00,  elapsed time 264
INFO   step:    94,    loss: 6.0702e+01,   Y0: 2.5101e+00,  elapsed time 266
INFO   step:    95,    loss: 6.0694e+01,   Y0: 2.5086e+00,  elapsed time 268
INFO   step:    96,    loss: 6.0687e+01,   Y0: 2.5069e+00,  elapsed time 271
INFO   step:    97,    loss: 6.0680e+01,   Y0: 2.5056e+00,  elapsed time 273
INFO   step:    98,    loss: 6.0673e+01,   Y0: 2.5051e+00,  elapsed time 275
INFO   step:    99,    loss: 6.0665e+01,   Y0: 2.5052e+00,  elapsed time 278
INFO   step:   100,    loss: 6.0658e+01,   Y0: 2.5058e+00,  elapsed time 280
INFO   step:   101,    loss: 6.0651e+01,   Y0: 2.5061e+00,  elapsed time 282
INFO   step:   102,    loss: 6.0644e+01,   Y0: 2.5076e+00,  elapsed time 285
INFO   step:   103,    loss: 6.0637e+01,   Y0: 2.5092e+00,  elapsed time 287
INFO   step:   104,    loss: 6.0630e+01,   Y0: 2.5110e+00,  elapsed time 289
INFO   step:   105,    loss: 6.0623e+01,   Y0: 2.5122e+00,  elapsed time 292
INFO   step:   106,    loss: 6.0616e+01,   Y0: 2.5139e+00,  elapsed time 294
INFO   step:   107,    loss: 6.0610e+01,   Y0: 2.5152e+00,  elapsed time 296
INFO   step:   108,    loss: 6.0606e+01,   Y0: 2.5170e+00,  elapsed time 298
INFO   step:   109,    loss: 6.0600e+01,   Y0: 2.5185e+00,  elapsed time 301
INFO   step:   110,    loss: 6.0594e+01,   Y0: 2.5194e+00,  elapsed time 303
INFO   step:   111,    loss: 6.0588e+01,   Y0: 2.5200e+00,  elapsed time 305
INFO   step:   112,    loss: 6.0582e+01,   Y0: 2.5208e+00,  elapsed time 308
INFO   step:   113,    loss: 6.0575e+01,   Y0: 2.5219e+00,  elapsed time 310
INFO   step:   114,    loss: 6.0568e+01,   Y0: 2.5235e+00,  elapsed time 312
INFO   step:   115,    loss: 6.0562e+01,   Y0: 2.5247e+00,  elapsed time 315
INFO   step:   116,    loss: 6.0556e+01,   Y0: 2.5257e+00,  elapsed time 317
INFO   step:   117,    loss: 6.0549e+01,   Y0: 2.5269e+00,  elapsed time 319
INFO   step:   118,    loss: 6.0543e+01,   Y0: 2.5276e+00,  elapsed time 321
INFO   step:   119,    loss: 6.0536e+01,   Y0: 2.5275e+00,  elapsed time 324
INFO   step:   120,    loss: 6.0530e+01,   Y0: 2.5269e+00,  elapsed time 326
INFO   step:   121,    loss: 6.0525e+01,   Y0: 2.5263e+00,  elapsed time 328
INFO   step:   122,    loss: 6.0520e+01,   Y0: 2.5256e+00,  elapsed time 331
INFO   step:   123,    loss: 6.0514e+01,   Y0: 2.5254e+00,  elapsed time 333
INFO   step:   124,    loss: 6.0507e+01,   Y0: 2.5253e+00,  elapsed time 335
INFO   step:   125,    loss: 6.0500e+01,   Y0: 2.5254e+00,  elapsed time 338
INFO   step:   126,    loss: 6.0492e+01,   Y0: 2.5253e+00,  elapsed time 340
INFO   step:   127,    loss: 6.0485e+01,   Y0: 2.5253e+00,  elapsed time 342
INFO   step:   128,    loss: 6.0480e+01,   Y0: 2.5250e+00,  elapsed time 345
INFO   step:   129,    loss: 6.0474e+01,   Y0: 2.5243e+00,  elapsed time 347
INFO   step:   130,    loss: 6.0467e+01,   Y0: 2.5230e+00,  elapsed time 349
INFO   step:   131,    loss: 6.0461e+01,   Y0: 2.5213e+00,  elapsed time 351
INFO   step:   132,    loss: 6.0456e+01,   Y0: 2.5196e+00,  elapsed time 354
INFO   step:   133,    loss: 6.0450e+01,   Y0: 2.5171e+00,  elapsed time 356
INFO   step:   134,    loss: 6.0444e+01,   Y0: 2.5149e+00,  elapsed time 358
INFO   step:   135,    loss: 6.0439e+01,   Y0: 2.5121e+00,  elapsed time 361
INFO   step:   136,    loss: 6.0432e+01,   Y0: 2.5097e+00,  elapsed time 363
INFO   step:   137,    loss: 6.0424e+01,   Y0: 2.5076e+00,  elapsed time 365
INFO   step:   138,    loss: 6.0417e+01,   Y0: 2.5052e+00,  elapsed time 368
INFO   step:   139,    loss: 6.0411e+01,   Y0: 2.5026e+00,  elapsed time 370
INFO   step:   140,    loss: 6.0404e+01,   Y0: 2.5012e+00,  elapsed time 372
INFO   step:   141,    loss: 6.0397e+01,   Y0: 2.4999e+00,  elapsed time 374
INFO   step:   142,    loss: 6.0391e+01,   Y0: 2.4988e+00,  elapsed time 377
INFO   step:   143,    loss: 6.0385e+01,   Y0: 2.4988e+00,  elapsed time 379
INFO   step:   144,    loss: 6.0379e+01,   Y0: 2.4988e+00,  elapsed time 381
INFO   step:   145,    loss: 6.0373e+01,   Y0: 2.4994e+00,  elapsed time 384
INFO   step:   146,    loss: 6.0368e+01,   Y0: 2.5005e+00,  elapsed time 386
INFO   step:   147,    loss: 6.0361e+01,   Y0: 2.5006e+00,  elapsed time 388
INFO   step:   148,    loss: 6.0356e+01,   Y0: 2.5006e+00,  elapsed time 391
INFO   step:   149,    loss: 6.0349e+01,   Y0: 2.5000e+00,  elapsed time 393
Delta:  120 ,  120.05
Other1:  -30.05 ,  -30
Other2:  -30.05 ,  -30
all_one_vec:  Tensor("ones:0", shape=(?, 1), dtype=float64)
y:  Tensor("mul:0", shape=(?, 1), dtype=float64)
z output:  [<tf.Tensor 'MatMul:0' shape=(?, 3) dtype=float64>, <tf.Tensor 'MatMul_1:0' shape=(?, 3) dtype=float64>, <tf.Tensor 'MatMul_2:0' shape=(?, 3) dtype=float64>, <tf.Tensor 'MatMul_3:0' shape=(?, 3) dtype=float64>, <tf.Tensor 'MatMul_4:0' shape=(?, 3) dtype=float64>, <tf.Tensor 'MatMul_5:0' shape=(?, 3) dtype=float64>, <tf.Tensor 'MatMul_6:0' shape=(?, 3) dtype=float64>, <tf.Tensor 'MatMul_7:0' shape=(?, 3) dtype=float64>, <tf.Tensor 'MatMul_8:0' shape=(?, 3) dtype=float64>, <tf.Tensor 'MatMul_9:0' shape=(?, 3) dtype=float64>, <tf.Tensor 'MatMul_10:0' shape=(?, 3) dtype=float64>, <tf.Tensor 'MatMul_11:0' shape=(?, 3) dtype=float64>, <tf.Tensor 'MatMul_12:0' shape=(?, 3) dtype=float64>, <tf.Tensor 'MatMul_13:0' shape=(?, 3) dtype=float64>, <tf.Tensor 'MatMul_14:0' shape=(?, 3) dtype=float64>, <tf.Tensor 'MatMul_15:0' shape=(?, 3) dtype=float64>, <tf.Tensor 'MatMul_16:0' shape=(?, 3) dtype=float64>, <tf.Tensor 'MatMul_17:0' shape=(?, 3) dtype=float64>, <tf.Tensor 'MatMul_18:0' shape=(?, 3) dtype=float64>, <tf.Tensor 'MatMul_19:0' shape=(?, 3) dtype=float64>, <tf.Tensor 'MatMul_20:0' shape=(?, 3) dtype=float64>, <tf.Tensor 'MatMul_21:0' shape=(?, 3) dtype=float64>, <tf.Tensor 'MatMul_22:0' shape=(?, 3) dtype=float64>, <tf.Tensor 'MatMul_23:0' shape=(?, 3) dtype=float64>, <tf.Tensor 'MatMul_24:0' shape=(?, 3) dtype=float64>, <tf.Tensor 'MatMul_25:0' shape=(?, 3) dtype=float64>, <tf.Tensor 'MatMul_26:0' shape=(?, 3) dtype=float64>, <tf.Tensor 'MatMul_27:0' shape=(?, 3) dtype=float64>, <tf.Tensor 'MatMul_28:0' shape=(?, 3) dtype=float64>, <tf.Tensor 'MatMul_29:0' shape=(?, 3) dtype=float64>, <tf.Tensor 'MatMul_30:0' shape=(?, 3) dtype=float64>, <tf.Tensor 'MatMul_31:0' shape=(?, 3) dtype=float64>, <tf.Tensor 'MatMul_32:0' shape=(?, 3) dtype=float64>, <tf.Tensor 'MatMul_33:0' shape=(?, 3) dtype=float64>, <tf.Tensor 'MatMul_34:0' shape=(?, 3) dtype=float64>, <tf.Tensor 'MatMul_35:0' shape=(?, 3) dtype=float64>, <tf.Tensor 'MatMul_36:0' shape=(?, 3) dtype=float64>, <tf.Tensor 'MatMul_37:0' shape=(?, 3) dtype=float64>, <tf.Tensor 'MatMul_38:0' shape=(?, 3) dtype=float64>, <tf.Tensor 'MatMul_39:0' shape=(?, 3) dtype=float64>]
num_iterations:  150
total time intervals:  40
# of dimensions:  3
Loss out:  60.609437753351685
Output_Z_Vals:  [[[ 1.19260232e+02 -2.92559343e+01 -2.92733494e+01]
  [ 1.19260232e+02 -2.92559343e+01 -2.92733494e+01]
  [ 1.19260232e+02 -2.92559343e+01 -2.92733494e+01]
  ...
  [ 1.19260232e+02 -2.92559343e+01 -2.92733494e+01]
  [ 1.19260232e+02 -2.92559343e+01 -2.92733494e+01]
  [ 1.19260232e+02 -2.92559343e+01 -2.92733494e+01]]

 [[-7.09098951e-02  1.56492678e-01  1.65108665e-02]
  [-7.03637535e-03 -5.38878423e-02 -2.42651750e-02]
  [-1.42599780e-01  4.14383514e-01  7.01688844e-02]
  ...
  [-8.48522874e-02  2.02493842e-01  2.56739060e-02]
  [ 4.88187003e-02  1.66078437e-03 -9.58130076e-02]
  [ 3.49095459e-02  4.54022051e-02 -5.41354422e-02]]

 [[-2.90020863e-02  4.39638799e-02  9.24910550e-02]
  [-5.31237288e-02 -6.63316939e-02 -5.97654663e-02]
  [ 1.71579104e-01  1.82124351e-02 -2.00135300e-01]
  ...
  [-5.37004743e-02 -6.72220608e-02 -5.14674979e-02]
  [-3.10881279e-02  4.98441280e-02  1.12979921e-01]
  [-4.52944076e-02  2.32436216e-02  1.04734715e-01]]

 ...

 [[-1.34872331e-02  3.38194500e-02 -5.55398802e-02]
  [-2.33098234e-02  1.99081172e-02 -7.00762340e-02]
  [-3.56061745e-02 -1.04287973e-02 -1.11185457e-02]
  ...
  [-2.56765898e-02  2.38962124e-02 -5.99978221e-02]
  [-4.33634676e-02 -2.35181272e-02  2.52940986e-02]
  [-5.45939921e-02 -4.99856985e-02  7.89812654e-02]]

 [[ 7.08123996e-02 -1.50221428e-01 -1.04427962e-02]
  [-3.14684916e-02  1.58852251e-02  1.67711040e-02]
  [-4.24121741e-02  9.06787715e-02 -2.18608499e-02]
  ...
  [ 1.46071138e-02 -3.62321668e-02  6.04866512e-04]
  [-3.62812944e-02  7.78216113e-02 -2.57076993e-02]
  [-2.96080580e-02  6.38270668e-02 -2.98948529e-02]]

 [[-8.31415295e-01  4.16735568e-01  5.04572056e-01]
  [-8.20706904e-01  4.07979508e-01  5.03153581e-01]
  [-8.53293105e-02  6.09093131e-02  4.85186399e-02]
  ...
  [-7.08547627e-01  3.54303379e-01  4.34854469e-01]
  [-3.22137303e-02  3.58579430e-02  1.56567073e-02]
  [ 1.71183237e-01 -1.00117191e-02 -1.66473250e-01]]]
Z_Vals dimensionality:  (40, 200, 3)
X_test:  [[[100.         100.68787629  99.70769077 ...  95.91227867  96.41757018
    96.6557451 ]
  [ -1.          -0.96737788  -0.85636296 ...  -1.29273765  -1.42173204
    -1.28125641]
  [ -1.          -0.99101866  -0.99888873 ...  -1.01817099  -1.02445666
    -1.04307719]]

 [[100.         100.27482679 100.32660618 ...  98.58767594  98.09501758
    98.05115687]
  [ -1.          -0.96675612  -1.06932906 ...  -1.03957972  -0.93311374
    -1.09404159]
  [ -1.          -0.97947775  -0.95491004 ...  -1.02705033  -1.02398354
    -0.98864676]]

 [[100.         101.1415655  101.88129296 ... 102.87926917 103.37549393
   103.33513407]
  [ -1.          -1.10968146  -1.09386105 ...  -1.05483115  -0.95888673
    -0.95696244]
  [ -1.          -1.05385055  -1.06389528 ...  -0.92018154  -0.90665124
    -0.90657749]]

 ...

 [[100.         100.7451683  100.63932655 ...  98.10147146  99.10970314
    99.46723714]
  [ -1.          -1.10677532  -1.01118433 ...  -0.61412929  -0.67362571
    -0.80940561]
  [ -1.          -1.02342883  -0.99196001 ...  -1.11017001  -1.12158112
    -1.12006761]]

 [[100.          99.15018306  99.51527444 ... 104.25922112 103.97132445
   104.01215163]
  [ -1.          -0.9089617   -0.95742619 ...  -1.12036716  -1.24061098
    -1.22628993]
  [ -1.          -1.025573    -1.00546719 ...  -0.69483187  -0.66665383
    -0.65588025]]

 [[100.          99.36359862  99.21770381 ... 105.90864629 106.39053689
   105.7017412 ]
  [ -1.          -0.89755647  -0.74488839 ...  -0.70727606  -0.79346252
    -0.94737809]
  [ -1.          -0.98940478  -1.00217399 ...  -1.0343185   -1.03295918
    -1.03497714]]]
X_test type:  <class 'numpy.ndarray'>
first element:  100.0
first element type:  <class 'float'>
---------------------------- TESTING DELTA HEDGING ----------------------------

Test sample:  0
output_Z_Vals[:, i, :]:  [[ 1.19260232e+02 -2.92559343e+01 -2.92733494e+01]
 [-7.09098951e-02  1.56492678e-01  1.65108665e-02]
 [-2.90020863e-02  4.39638799e-02  9.24910550e-02]
 [ 8.52032765e-02  1.72459076e-01  3.79852201e-02]
 [ 2.18962918e-01 -2.73238246e-02 -5.30778130e-02]
 [ 7.34264401e-02  3.08708336e-02  1.60231366e-03]
 [ 6.49401718e-02  2.00043298e-02 -5.61575071e-02]
 [-1.09341277e-01 -6.41215265e-02 -1.21102326e-01]
 [-7.59455943e-02 -7.41626345e-02  8.53007237e-02]
 [-2.55581562e-02 -1.00463102e-01 -1.32624665e-01]
 [ 5.59986515e-02  1.75612270e-01 -8.38742270e-02]
 [-1.73162007e-01 -1.01586759e-01  3.35820031e-02]
 [-6.54921359e-02 -8.46452952e-03  2.53856992e-02]
 [-1.11371099e-01 -1.20100082e-01  5.25237020e-02]
 [-2.21160214e-02  2.23459523e-01  2.90290852e-01]
 [-1.28883956e-03 -6.94042449e-01  2.24381294e-02]
 [-6.75904788e-02 -1.98220199e-01 -1.26730079e-01]
 [ 2.37956893e-01 -1.34553973e-02 -3.35653857e-01]
 [-8.68277387e-02  4.19790140e-02 -1.66162419e-01]
 [-4.72843738e-02 -1.73312840e-02  1.18916590e-01]
 [ 9.35650032e-02 -1.08652575e-01  6.68887716e-02]
 [ 1.15724466e-01  1.32375161e-01  3.09754850e-01]
 [-4.55851184e-02 -1.08529613e-02  2.54203768e-01]
 [-7.07816280e-02 -5.13752948e-04 -8.13716922e-02]
 [-4.73246119e-01  1.39024814e-01  8.47890485e-02]
 [-1.34216421e-01 -2.56465414e-01  1.31335461e-01]
 [ 5.31456475e-02  6.54016141e-02 -3.26917339e-02]
 [ 3.05230246e-02 -2.04689395e-03  7.85250993e-03]
 [-1.38103470e-01 -2.10412511e-01 -5.18789470e-02]
 [ 2.03807470e-01  2.82192926e-01  2.10884592e-01]
 [ 8.53612240e-02 -7.73232625e-02  7.23110090e-02]
 [ 8.66961695e-02 -5.16561505e-02 -4.14471402e-02]
 [ 4.30814123e-01 -4.10042159e-01 -3.52974662e-01]
 [-4.12563234e-02 -7.69147933e-02  1.65590433e-02]
 [-1.47932419e-01 -8.49364858e-02  1.66713775e-02]
 [ 2.27971805e-01  3.51163746e-02  1.31673338e-02]
 [ 2.32376009e-02  7.74830414e-03 -9.66962402e-02]
 [-1.34872331e-02  3.38194500e-02 -5.55398802e-02]
 [ 7.08123996e-02 -1.50221428e-01 -1.04427962e-02]
 [-8.31415295e-01  4.16735568e-01  5.04572056e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.26023247 -29.25593426 -29.27334937]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  8.31486419  -9.25153874 -83.50871763]
init_Out:  [2.49911038]
Stock Position:  8.31486419409362
Bond position:  [-828.98730903]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [8.11507839]
curr_Stock_Price:  100.68787628597772
curr_Factors:  [100.68787629  -0.96737788  -0.99101866]
mat_Sqrt:  [[14.2054949   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00447003  0.04948733  0.04710091]
Stock Position:  -0.004470031170618239
Bond Position:  [8.56515634]


portfolio before change:  [8.12053056]
curr_Stock_Price:  99.70769076892567
curr_Factors:  [99.70769077 -0.85636296 -0.99888873]
mat_Sqrt:  [[15.59563578  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00057627  0.0139026   0.26385124]
Stock Position:  -0.0005762693070590151
Bond Position:  [8.17798904]


portfolio before change:  [8.12137965]
curr_Stock_Price:  100.00828798216142
curr_Factors:  [100.00828798  -1.09497753  -1.02051784]
mat_Sqrt:  [[12.05835394  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.0080782  0.05453635 0.10836126]
Stock Position:  0.008078204686726221
Bond Position:  [7.31349223]


portfolio before change:  [8.12871489]
curr_Stock_Price:  100.80314277199506
curr_Factors:  [100.80314277  -1.11084714  -1.04765456]
mat_Sqrt:  [[11.64256565  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01781591 -0.00864055 -0.15141623]
Stock Position:  0.017815914734976356
Bond Position:  [6.3328147]


portfolio before change:  [8.12409938]
curr_Stock_Price:  100.49964098121828
curr_Factors:  [100.49964098  -1.03900037  -1.04613191]
mat_Sqrt:  [[12.49116856  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00596826 0.00976221 0.00457095]
Stock Position:  0.005968264066336583
Bond Position:  [7.52429099]


portfolio before change:  [8.12427739]
curr_Stock_Price:  100.37186772091917
curr_Factors:  [100.37186772  -1.01017559  -1.02137168]
mat_Sqrt:  [[13.16201061  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00410223  0.00632592 -0.16020174]
Stock Position:  0.004102228738882419
Bond Position:  [7.71252903]


portfolio before change:  [8.12205104]
curr_Stock_Price:  99.59412440659209
curr_Factors:  [99.59412441 -1.36351854 -0.99234694]
mat_Sqrt:  [[ 9.4426598   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01437273 -0.02027701 -0.34547123]
Stock Position:  -0.014372729716263181
Bond Position:  [9.55349047]


portfolio before change:  [8.1267771]
curr_Stock_Price:  99.34839521388494
curr_Factors:  [99.34839521 -1.15273325 -0.99767186]
mat_Sqrt:  [[11.56782696  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00522557 -0.02345228  0.24333922]
Stock Position:  -0.005225573324117361
Bond Position:  [8.64592942]


portfolio before change:  [8.12727942]
curr_Stock_Price:  99.45909781223781
curr_Factors:  [99.45909781 -1.03755338 -1.00948865]
mat_Sqrt:  [[12.84178683  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00430034 -0.03176922 -0.37834125]
Stock Position:  -0.004300336038288993
Bond Position:  [8.55498696]


portfolio before change:  [8.12889618]
curr_Stock_Price:  99.33182441702289
curr_Factors:  [99.33182442 -1.11137084 -0.97745775]
mat_Sqrt:  [[12.30046925  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00352931  0.05553348 -0.23926982]
Stock Position:  0.0035293113635808996
Bond Position:  [7.77832324]


portfolio before change:  [8.1252061]
curr_Stock_Price:  98.01076338803988
curr_Factors:  [98.01076339 -0.87647247 -0.98136723]
mat_Sqrt:  [[15.29058991  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01104798 -0.03212455  0.09580011]
Stock Position:  -0.011047975851348877
Bond Position:  [9.20802664]


portfolio before change:  [8.13893704]
curr_Stock_Price:  96.87210538002003
curr_Factors:  [96.87210538 -0.7258336  -0.96953621]
mat_Sqrt:  [[17.77906782  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0034045  -0.00267672  0.07241833]
Stock Position:  -0.003404501046182188
Bond Position:  [8.46873822]


portfolio before change:  [8.14341178]
curr_Stock_Price:  95.86870295470054
curr_Factors:  [95.86870295 -0.54207793 -0.95351069]
mat_Sqrt:  [[21.48577221  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00482881 -0.03797898  0.1498355 ]
Stock Position:  -0.004828810127741626
Bond Position:  [8.60634354]


portfolio before change:  [8.14799105]
curr_Stock_Price:  95.14318007112763
curr_Factors:  [95.14318007 -0.36758087 -0.95197139]
mat_Sqrt:  [[25.42748444  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00168751 0.07066411 0.828119  ]
Stock Position:  0.0016875067156038345
Bond Position:  [7.9874363]


portfolio before change:  [8.14757027]
curr_Stock_Price:  94.30213140255866
curr_Factors:  [94.3021314  -0.4652326  -0.95301357]
mat_Sqrt:  [[22.83415901  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00064065 -0.21947549  0.06400974]
Stock Position:  -0.0006406530907870632
Bond Position:  [8.20798522]


portfolio before change:  [8.14870166]
curr_Stock_Price:  94.1377241848306
curr_Factors:  [94.13772418 -0.47882264 -0.93381378]
mat_Sqrt:  [[22.92257972  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00430044 -0.06268273 -0.36152564]
Stock Position:  -0.004300439675374112
Bond Position:  [8.55353526]


portfolio before change:  [8.15189647]
curr_Stock_Price:  93.643460154713
curr_Factors:  [93.64346015 -0.44746039 -0.93270933]
mat_Sqrt:  [[23.55468818  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0071788  -0.00425497 -0.95752702]
Stock Position:  0.0071788010144195865
Bond Position:  [7.4796487]


portfolio before change:  [8.16731581]
curr_Stock_Price:  95.66111209966076
curr_Factors:  [95.6611121  -0.65704746 -0.93939095]
mat_Sqrt:  [[19.38255537  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00617368  0.01327493 -0.47401513]
Stock Position:  -0.006173675488025087
Bond Position:  [8.75789647]


portfolio before change:  [8.16641921]
curr_Stock_Price:  95.9836755487235
curr_Factors:  [95.98367555 -0.51382035 -0.95933565]
mat_Sqrt:  [[21.99955289  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0010663  -0.00548063  0.33923593]
Stock Position:  -0.0010662997815350753
Bond Position:  [8.26876658]


portfolio before change:  [8.16730642]
curr_Stock_Price:  96.12102108059419
curr_Factors:  [96.12102108 -0.75914581 -0.95740191]
mat_Sqrt:  [[17.27154427  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00604539 -0.03435896  0.19081505]
Stock Position:  0.00604538988676138
Bond Position:  [7.58621737]


portfolio before change:  [8.16522703]
curr_Stock_Price:  95.62018844326063
curr_Factors:  [95.62018844 -0.83861756 -0.97672399]
mat_Sqrt:  [[15.56527426  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01171652 0.0418607  0.88364437]
Stock Position:  0.011716518349760063
Bond Position:  [7.04489134]


portfolio before change:  [8.16216956]
curr_Stock_Price:  95.2840702711672
curr_Factors:  [95.28407027 -0.73133614 -0.96741016]
mat_Sqrt:  [[17.42866648  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 3.45625187e-04 -3.43200769e-03  7.25172593e-01]
Stock Position:  0.0003456251873576862
Bond Position:  [8.12923699]


portfolio before change:  [8.16321526]
curr_Stock_Price:  95.3693652302969
curr_Factors:  [95.36936523 -0.51958417 -0.98999958]
mat_Sqrt:  [[21.07681593  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-4.14696511e-03 -1.62462947e-04 -2.32130788e-01]
Stock Position:  -0.004146965105148738
Bond Position:  [8.55870869]


portfolio before change:  [8.16198756]
curr_Stock_Price:  95.92340928076513
curr_Factors:  [95.92340928 -0.42515004 -0.98787531]
mat_Sqrt:  [[23.34831249  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01937395  0.04396351  0.24187955]
Stock Position:  -0.019373949257164715
Bond Position:  [10.02040283]


portfolio before change:  [8.18284767]
curr_Stock_Price:  94.91135556989771
curr_Factors:  [94.91135557 -0.34464468 -0.96944491]
mat_Sqrt:  [[25.50447083  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00447096 -0.08110148  0.37466351]
Stock Position:  -0.0044709647831896885
Bond Position:  [8.607193]


portfolio before change:  [8.18560709]
curr_Stock_Price:  94.53482542696224
curr_Factors:  [94.53482543 -0.43155014 -0.96853182]
mat_Sqrt:  [[23.31009044  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00206611  0.02068181 -0.09326042]
Stock Position:  0.002066106857694049
Bond Position:  [7.99028804]


portfolio before change:  [8.18669885]
curr_Stock_Price:  94.57979560998405
curr_Factors:  [94.57979561 -0.41442395 -0.97245039]
mat_Sqrt:  [[23.6312394   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00135723 -0.00064728  0.02240103]
Stock Position:  0.0013572314316610853
Bond Position:  [8.05833218]


portfolio before change:  [8.18541334]
curr_Stock_Price:  92.89042714492753
curr_Factors:  [92.89042714 -0.39617717 -0.96930747]
mat_Sqrt:  [[23.71092591  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00650021 -0.06653828 -0.1479962 ]
Stock Position:  -0.006500211937862376
Bond Position:  [8.7892208]


portfolio before change:  [8.18631708]
curr_Stock_Price:  92.92042384680556
curr_Factors:  [92.92042385 -0.36697743 -0.99531178]
mat_Sqrt:  [[23.7944952   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01068063 0.08923724 0.60159504]
Stock Position:  0.010680634125847929
Bond Position:  [7.19386803]


portfolio before change:  [8.20067327]
curr_Stock_Price:  94.1803586002718
curr_Factors:  [94.1803586  -0.5726627  -1.00796791]
mat_Sqrt:  [[19.38657938  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0050615  -0.02445176  0.20628318]
Stock Position:  0.005061499862128176
Bond Position:  [7.7239794]


portfolio before change:  [8.20533449]
curr_Stock_Price:  94.91050996081238
curr_Factors:  [94.91050996 -0.76401534 -0.99872685]
mat_Sqrt:  [[16.28415021  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00472251 -0.01633511 -0.11823715]
Stock Position:  0.00472250933204036
Bond Position:  [7.75711872]


portfolio before change:  [8.19852144]
curr_Stock_Price:  93.26249846045069
curr_Factors:  [93.26249846 -0.90251378 -0.9870989 ]
mat_Sqrt:  [[14.09479252  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.02470247 -0.12966672 -1.00693846]
Stock Position:  0.024702472800509682
Bond Position:  [5.89470711]


portfolio before change:  [8.20079435]
curr_Stock_Price:  93.32467961038111
curr_Factors:  [93.32467961 -0.83188886 -0.97588311]
mat_Sqrt:  [[15.30703657  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00260417 -0.02432259  0.04723834]
Stock Position:  -0.002604171882100687
Bond Position:  [8.44382786]


portfolio before change:  [8.19904356]
curr_Stock_Price:  94.40231055938777
curr_Factors:  [94.40231056 -0.98690073 -0.99144417]
mat_Sqrt:  [[13.05564549  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01123824 -0.02685928  0.0475588 ]
Stock Position:  -0.011238237044976729
Bond Position:  [9.2599591]


portfolio before change:  [8.20776497]
curr_Stock_Price:  93.72926536299843
curr_Factors:  [93.72926536 -0.92829978 -0.97608534]
mat_Sqrt:  [[13.9576166   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01659067 0.01110477 0.03756274]
Stock Position:  0.016590674674407342
Bond Position:  [6.65273322]


portfolio before change:  [8.22541021]
curr_Stock_Price:  94.74270230221754
curr_Factors:  [94.7427023  -0.78359891 -0.99098007]
mat_Sqrt:  [[16.06408196  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 2.30304099e-04  2.45022891e-03 -2.75847458e-01]
Stock Position:  0.0002303040986098126
Bond Position:  [8.20359058]


portfolio before change:  [8.22653497]
curr_Stock_Price:  95.17361322251175
curr_Factors:  [95.17361322 -0.97712641 -0.99500567]
mat_Sqrt:  [[13.24434478  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0018084   0.01069465 -0.15843982]
Stock Position:  -0.0018083981991028567
Bond Position:  [8.39864676]


portfolio before change:  [8.22624906]
curr_Stock_Price:  95.91227867117817
curr_Factors:  [95.91227867 -1.29273765 -1.01817099]
mat_Sqrt:  [[ 9.5117262   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00681286 -0.04750419 -0.02979039]
Stock Position:  0.006812861385265727
Bond Position:  [7.572812]


portfolio before change:  [8.2306382]
curr_Stock_Price:  96.41757017759136
curr_Factors:  [96.41757018 -1.42173204 -1.02445666]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [8.2306382]
Stock Price:  96.65574510179029
PL:  [8.2306382]
Settle:  Tensor("sub:0", shape=(), dtype=float64)
PL:  Tensor("sub_1:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  1
output_Z_Vals[:, i, :]:  [[ 1.19260232e+02 -2.92559343e+01 -2.92733494e+01]
 [-7.03637535e-03 -5.38878423e-02 -2.42651750e-02]
 [-5.31237288e-02 -6.63316939e-02 -5.97654663e-02]
 [ 8.43958843e-02  1.65117434e-01  3.78871363e-02]
 [ 1.16650630e-01  4.29722770e-03 -6.60487493e-02]
 [ 6.90244209e-02  2.88804251e-02 -1.00724149e-01]
 [ 7.22309864e-02  1.38862783e-02 -6.88659587e-02]
 [-1.09341277e-01 -6.41215265e-02 -1.21102326e-01]
 [-7.47852345e-02 -7.46459259e-02  8.08103903e-02]
 [-4.38647946e-02 -1.10583185e-01 -1.30650314e-01]
 [ 7.23261276e-02  1.12261734e-01 -9.81947571e-02]
 [-2.07681522e-01 -1.00701584e-01  4.72340248e-02]
 [-1.11166136e-01  4.12092055e-02 -2.19167067e-02]
 [-9.62623594e-02 -1.14884369e-01  6.32126881e-02]
 [ 2.38623911e-01  3.00365109e-01  3.90841631e-02]
 [-2.43540056e-02 -5.79325503e-01 -6.22034028e-03]
 [-6.79962579e-02 -2.76079092e-02 -7.84430683e-02]
 [ 5.79484783e-02  7.61458000e-02 -1.18556578e-01]
 [-4.14738271e-03  4.82479880e-02 -5.39682405e-02]
 [-3.61303066e-02 -1.08532283e-02  1.02902674e-01]
 [ 3.14224233e-02 -7.07189746e-02  3.99044969e-02]
 [ 1.23661004e-01 -1.43029584e-02  2.27313732e-01]
 [-3.47327974e-02 -4.87641068e-02  2.34511644e-01]
 [-6.82276548e-02 -5.74527900e-04 -8.21158503e-02]
 [-3.30821687e-01  1.14446991e-01  6.95046390e-02]
 [-3.55818500e-02 -1.45416292e-01  9.96918853e-02]
 [ 2.25229352e-01  4.53329406e-02 -1.36264546e-01]
 [-4.00168019e-02  6.51887929e-02  2.61932974e-02]
 [-8.64720778e-02 -8.25967324e-02 -1.90129949e-01]
 [ 3.96318561e-02  2.90293968e-02 -1.08887349e-01]
 [ 3.51535993e-02 -4.65702286e-03  2.69245606e-02]
 [ 6.86207621e-02 -1.03119970e-01 -8.36341983e-02]
 [ 3.75539575e-01 -4.23059934e-01 -4.05539616e-01]
 [-4.66263338e-02 -8.21573224e-02  1.78615852e-03]
 [-1.77971514e-01  6.29684593e-02  2.05921835e-02]
 [ 7.70141150e-02 -1.08647792e-01 -7.07141798e-02]
 [-5.68730764e-02 -1.81766715e-01 -2.85515036e-02]
 [-2.33098234e-02  1.99081172e-02 -7.00762340e-02]
 [-3.14684916e-02  1.58852251e-02  1.67711040e-02]
 [-8.20706904e-01  4.07979508e-01  5.03153581e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.26023247 -29.25593426 -29.27334937]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  8.31486419  -9.25153874 -83.50871763]
init_Out:  [2.49911038]
Stock Position:  8.31486419409362
Bond position:  [-828.98730903]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [4.68062792]
curr_Stock_Price:  100.27482678903755
curr_Factors:  [100.27482679  -0.96675612  -0.97947775]
mat_Sqrt:  [[14.32033876  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0009344  -0.01704083 -0.06922179]
Stock Position:  -0.0009343956024359806
Bond Position:  [4.77432428]


portfolio before change:  [4.68117636]
curr_Stock_Price:  100.3266061838417
curr_Factors:  [100.32660618  -1.06932906  -0.95491004]
mat_Sqrt:  [[13.25257437  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00505834 -0.02097592 -0.17049424]
Stock Position:  -0.005058336489561278
Bond Position:  [5.1886621]


portfolio before change:  [4.68136423]
curr_Stock_Price:  100.41769454714914
curr_Factors:  [100.41769455  -1.00210669  -0.95143429]
mat_Sqrt:  [[14.2363343   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00677091 0.05221472 0.10808145]
Stock Position:  0.006770905729733988
Bond Position:  [4.00144549]


portfolio before change:  [4.6766557]
curr_Stock_Price:  99.6484111759417
curr_Factors:  [99.64841118 -0.93792977 -0.95331213]
mat_Sqrt:  [[15.03538171  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00686909  0.0013589  -0.1884187 ]
Stock Position:  0.006869093268360171
Bond Position:  [3.99216147]


portfolio before change:  [4.67544812]
curr_Stock_Price:  99.39996074592028
curr_Factors:  [99.39996075 -1.05793779 -0.93642452]
mat_Sqrt:  [[13.52837613  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00363753  0.00913279 -0.28733796]
Stock Position:  0.0036375304043089573
Bond Position:  [4.31387774]


portfolio before change:  [4.6751289]
curr_Stock_Price:  99.16395216315014
curr_Factors:  [99.16395216 -1.33344511 -0.95349491]
mat_Sqrt:  [[10.0727579   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00581095  0.00439123 -0.19645541]
Stock Position:  0.005810953080581194
Bond Position:  [4.09889183]


portfolio before change:  [4.67925119]
curr_Stock_Price:  99.7851756231563
curr_Factors:  [99.78517562 -1.45232568 -0.95450454]
mat_Sqrt:  [[ 8.99068838  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01509526 -0.02027701 -0.34547123]
Stock Position:  -0.015095262045248118
Bond Position:  [6.18553457]


portfolio before change:  [4.68757509]
curr_Stock_Price:  99.28497539878975
curr_Factors:  [99.2849754  -1.20712731 -0.95468322]
mat_Sqrt:  [[11.42933997  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00526865 -0.02360511  0.23052955]
Stock Position:  -0.005268653511159644
Bond Position:  [5.21067322]


portfolio before change:  [4.69146475]
curr_Stock_Price:  98.67034200516385
curr_Factors:  [98.67034201 -0.94095452 -0.93745785]
mat_Sqrt:  [[15.08004058  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00486663 -0.03496947 -0.37270898]
Stock Position:  -0.0048666264163971145
Bond Position:  [5.17165645]


portfolio before change:  [4.69643885]
curr_Stock_Price:  97.78110174668879
curr_Factors:  [97.78110175 -1.09470821 -0.95569853]
mat_Sqrt:  [[12.58272174  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00438544  0.03550028 -0.28012231]
Stock Position:  0.0043854416669570845
Bond Position:  [4.26762553]


portfolio before change:  [4.69641612]
curr_Stock_Price:  97.65426859451529
curr_Factors:  [97.65426859 -1.03463915 -0.94378132]
mat_Sqrt:  [[13.50436417  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01485742 -0.03184464  0.13474553]
Stock Position:  -0.014857420767444474
Bond Position:  [6.14730668]


portfolio before change:  [4.6953397]
curr_Stock_Price:  97.77844054136361
curr_Factors:  [97.77844054 -1.12504222 -0.96150966]
mat_Sqrt:  [[12.13570859  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00944122  0.01303149 -0.06252226]
Stock Position:  -0.009441216154750489
Bond Position:  [5.6184871]


portfolio before change:  [4.69323575]
curr_Stock_Price:  98.0756803690307
curr_Factors:  [98.07568037 -0.75337463 -0.93834212]
mat_Sqrt:  [[18.06583669  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00477838 -0.03632963  0.1803282 ]
Stock Position:  -0.004778379580138171
Bond Position:  [5.16187858]


portfolio before change:  [4.69977488]
curr_Stock_Price:  96.84223931865105
curr_Factors:  [96.84223932 -0.64604331 -0.92440595]
mat_Sqrt:  [[20.13851192  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01263039 0.09498379 0.11149624]
Stock Position:  0.01263039331141515
Bond Position:  [3.47661931]


portfolio before change:  [4.68898731]
curr_Stock_Price:  95.9537335472121
curr_Factors:  [95.95373355 -0.72086469 -0.94316546]
mat_Sqrt:  [[18.17116467  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00223331 -0.18319881 -0.0177449 ]
Stock Position:  -0.0022333101996880123
Bond Position:  [4.90328176]


portfolio before change:  [4.69105992]
curr_Stock_Price:  95.30014624998422
curr_Factors:  [95.30014625 -0.49196783 -0.94261536]
mat_Sqrt:  [[22.70188925  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0037319  -0.00873039 -0.22377624]
Stock Position:  -0.003731901535757689
Bond Position:  [5.04671068]


portfolio before change:  [4.69014498]
curr_Stock_Price:  95.71436248186974
curr_Factors:  [95.71436248 -0.71887734 -0.92473551]
mat_Sqrt:  [[18.49971848  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00193053  0.02407942 -0.33820892]
Stock Position:  0.001930531772521353
Bond Position:  [4.50536536]


portfolio before change:  [4.69270363]
curr_Stock_Price:  96.74798392980014
curr_Factors:  [96.74798393 -0.62880135 -0.94361874]
mat_Sqrt:  [[20.07929955  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00069314  0.01525735 -0.15395637]
Stock Position:  -0.0006931439990337375
Bond Position:  [4.75976391]


portfolio before change:  [4.69258795]
curr_Stock_Price:  97.7732820241901
curr_Factors:  [97.77328202 -0.76947747 -0.95563867]
mat_Sqrt:  [[17.41854085  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00088444 -0.00343209  0.29355269]
Stock Position:  -0.000884437762881622
Bond Position:  [4.77906234]


portfolio before change:  [4.69353261]
curr_Stock_Price:  97.38067464859836
curr_Factors:  [97.38067465 -0.93999551 -0.96419508]
mat_Sqrt:  [[14.5041845   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00260214 -0.0223633   0.11383642]
Stock Position:  0.0026021413733991684
Bond Position:  [4.44013433]


portfolio before change:  [4.69394539]
curr_Stock_Price:  97.32599934179238
curr_Factors:  [97.32599934 -0.83057814 -0.97864961]
mat_Sqrt:  [[15.94010734  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01064559 -0.00452299  0.64846281]
Stock Position:  0.010645594827848121
Bond Position:  [3.65785223]


portfolio before change:  [4.6966697]
curr_Stock_Price:  97.53895589848594
curr_Factors:  [97.5389559  -0.92090956 -0.95999928]
mat_Sqrt:  [[14.86995898  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00079877 -0.01542056  0.66899644]
Stock Position:  0.0007987653272885833
Bond Position:  [4.61875896]


portfolio before change:  [4.69776814]
curr_Stock_Price:  98.19128699310856
curr_Factors:  [98.19128699 -0.87983806 -0.95039314]
mat_Sqrt:  [[15.74757339  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-5.39793114e-03 -1.81681674e-04 -2.34253664e-01]
Stock Position:  -0.005397931142597212
Bond Position:  [5.22779795]


portfolio before change:  [4.70025777]
curr_Stock_Price:  97.85113610827938
curr_Factors:  [97.85113611 -0.68286696 -0.92568607]
mat_Sqrt:  [[19.58755233  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01601421  0.03619132  0.19827739]
Stock Position:  -0.016014206294735735
Bond Position:  [6.26726605]


portfolio before change:  [4.68787432]
curr_Stock_Price:  98.67333771551984
curr_Factors:  [98.67333772 -0.85106101 -0.93623727]
mat_Sqrt:  [[16.51908689  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0011494  -0.04598467  0.2843932 ]
Stock Position:  -0.0011493953465843503
Bond Position:  [4.80128899]


portfolio before change:  [4.68960716]
curr_Stock_Price:  97.68790754151914
curr_Factors:  [97.68790754 -0.77977202 -0.92471621]
mat_Sqrt:  [[17.76605387  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01117778  0.01433553 -0.38872482]
Stock Position:  0.01117777539357556
Bond Position:  [3.59767368]


portfolio before change:  [4.68662626]
curr_Stock_Price:  97.38099124456129
curr_Factors:  [97.38099124 -0.85689659 -0.917201  ]
mat_Sqrt:  [[16.51936685  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00199687  0.02061451  0.07472219]
Stock Position:  -0.001996865277346117
Bond Position:  [4.88108298]


portfolio before change:  [4.68441412]
curr_Stock_Price:  98.79436146626806
curr_Factors:  [98.79436147 -0.98389016 -0.92590277]
mat_Sqrt:  [[14.63253675  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00870764 -0.02611938 -0.54238782]
Stock Position:  -0.008707637770077825
Bond Position:  [5.54467964]


portfolio before change:  [4.69356743]
curr_Stock_Price:  97.82278063011007
curr_Factors:  [97.82278063 -0.81546381 -0.93983659]
mat_Sqrt:  [[16.90918699  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00107367  0.0091799  -0.3106253 ]
Stock Position:  0.0010736681083356814
Bond Position:  [4.58853823]


portfolio before change:  [4.69398769]
curr_Stock_Price:  97.67996212052459
curr_Factors:  [97.67996212 -1.15898444 -0.95898328]
mat_Sqrt:  [[11.74853709  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00344973 -0.00147268  0.07680828]
Stock Position:  0.003449732348539382
Bond Position:  [4.35701796]


portfolio before change:  [4.69178344]
curr_Stock_Price:  96.88311519539782
curr_Factors:  [96.8831152  -1.09970633 -0.96076789]
mat_Sqrt:  [[12.34228331  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00396089 -0.0326094  -0.23858509]
Stock Position:  0.003960892443332551
Bond Position:  [4.30803984]


portfolio before change:  [4.69397992]
curr_Stock_Price:  97.30169245565541
curr_Factors:  [97.30169246 -1.31967514 -0.97846562]
mat_Sqrt:  [[ 9.77350951  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0288367  -0.1337833  -1.15689165]
Stock Position:  0.028836702605374468
Bond Position:  [1.88811995]


portfolio before change:  [4.69140873]
curr_Stock_Price:  97.20434364427848
curr_Factors:  [97.20434364 -1.04846083 -1.01269738]
mat_Sqrt:  [[12.37473871  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00390982 -0.02598043  0.00509541]
Stock Position:  -0.003909822241175299
Bond Position:  [5.07146044]


portfolio before change:  [4.69276712]
curr_Stock_Price:  97.01906273612147
curr_Factors:  [97.01906274 -0.85898236 -0.99680574]
mat_Sqrt:  [[15.16696015  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01134982  0.01991238  0.05874377]
Stock Position:  -0.01134982301052672
Bond Position:  [5.79391631]


portfolio before change:  [4.69287983]
curr_Stock_Price:  97.07294648022332
curr_Factors:  [97.07294648 -0.92730238 -1.00089054]
mat_Sqrt:  [[14.11544799  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00423468 -0.03435745 -0.20172787]
Stock Position:  0.004234677467797044
Bond Position:  [4.28180721]


portfolio before change:  [4.70289279]
curr_Stock_Price:  99.31106162618768
curr_Factors:  [99.31106163 -0.99575673 -1.03089794]
mat_Sqrt:  [[13.08677647  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0051498  -0.05747968 -0.08144949]
Stock Position:  -0.005149803254452446
Bond Position:  [5.21432522]


portfolio before change:  [4.7054148]
curr_Stock_Price:  98.94790505198948
curr_Factors:  [98.94790505 -1.04134368 -1.00895269]
mat_Sqrt:  [[12.73427441  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0029134   0.0062955  -0.19990799]
Stock Position:  -0.002913401124806223
Bond Position:  [4.99368974]


portfolio before change:  [4.70708855]
curr_Stock_Price:  98.58767593884671
curr_Factors:  [98.58767594 -1.03957972 -1.02705033]
mat_Sqrt:  [[12.48235708  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00221392  0.00502335  0.04784329]
Stock Position:  -0.0022139207698296357
Bond Position:  [4.92535385]


portfolio before change:  [4.70879496]
curr_Stock_Price:  98.09501758151147
curr_Factors:  [98.09501758 -0.93311374 -1.02398354]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [4.70879496]
Stock Price:  98.05115686890484
PL:  [4.70879496]
Settle:  Tensor("sub_2:0", shape=(), dtype=float64)
PL:  Tensor("sub_3:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  2
output_Z_Vals[:, i, :]:  [[ 1.19260232e+02 -2.92559343e+01 -2.92733494e+01]
 [-1.42599780e-01  4.14383514e-01  7.01688844e-02]
 [ 1.71579104e-01  1.82124351e-02 -2.00135300e-01]
 [ 8.38205454e-02  1.59885861e-01  3.78172430e-02]
 [ 2.24363599e-01 -2.30711831e-02 -4.49337911e-02]
 [ 1.90912793e-02  2.96615640e-02  8.21054085e-02]
 [ 5.73458838e-02  2.47354742e-02 -5.87967973e-02]
 [-1.06771128e-01 -5.47938507e-02 -1.17700526e-01]
 [ 3.54301502e-03 -5.58345404e-02 -1.10929459e-02]
 [-6.72017101e-02 -1.23484052e-01 -1.28133454e-01]
 [ 6.66444447e-02  1.22498727e-01 -9.24793214e-02]
 [-8.64044070e-02 -8.94870263e-02  4.77389761e-03]
 [-1.14240990e-01  4.59387545e-02 -3.74539582e-02]
 [-1.10222352e-01 -1.06116966e-01  5.96948394e-02]
 [ 3.35901976e-01  4.33683254e-01  6.42709705e-02]
 [-7.30379196e-02 -9.60231932e-02 -1.06615322e-01]
 [-7.28237537e-02 -5.50012183e-02 -5.88621123e-02]
 [-8.45710138e-02  1.12028023e-01  1.15546402e-01]
 [ 1.06816199e-01  7.13335225e-02  1.30679652e-01]
 [ 1.40421253e-01 -4.59975486e-02  2.91926572e-02]
 [-4.24759666e-02 -5.17446289e-03 -3.83010491e-02]
 [ 7.96146739e-02 -6.04288184e-02  7.74150024e-02]
 [-5.16279783e-02  1.37104421e-02  2.34987660e-01]
 [-6.01764262e-02 -1.05290518e-03 -8.38275917e-02]
 [-1.73297425e-01  8.82749013e-02  5.68904984e-02]
 [ 2.23394962e-02 -8.02838725e-02  8.11187758e-02]
 [ 2.25615605e-01  4.51979220e-02 -1.35538203e-01]
 [-4.58344256e-02  6.97470963e-02  2.79095569e-02]
 [-7.26036979e-02 -6.75118181e-02 -2.10552943e-01]
 [ 7.59974488e-03 -6.11957476e-03 -1.15516648e-01]
 [ 3.38186117e-02  1.07136120e-01  3.16772222e-02]
 [ 1.50159023e-02 -7.06399270e-02 -8.55362852e-02]
 [ 1.93616491e-01 -2.06150433e-01 -1.44005032e-01]
 [-5.17184014e-02 -8.71285070e-02 -1.22221062e-02]
 [-1.36288335e-01  8.12924963e-02  3.55764258e-02]
 [ 8.47165236e-02 -1.65012150e-01 -1.38726811e-01]
 [-1.80774360e-01 -2.93751449e-01  4.88002954e-02]
 [-3.56061745e-02 -1.04287973e-02 -1.11185457e-02]
 [-4.24121741e-02  9.06787715e-02 -2.18608499e-02]
 [-8.53293105e-02  6.09093131e-02  4.85186399e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.26023247 -29.25593426 -29.27334937]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  8.31486419  -9.25153874 -83.50871763]
init_Out:  [2.49911038]
Stock Position:  8.31486419409362
Bond position:  [-828.98730903]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [11.88744262]
curr_Stock_Price:  101.14156550328856
curr_Factors:  [101.1415655   -1.10968146  -1.05385055]
mat_Sqrt:  [[11.62303792  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01011588  0.13103957  0.2001723 ]
Stock Position:  -0.010115882026962803
Bond Position:  [12.91057876]


portfolio before change:  [11.88157355]
curr_Stock_Price:  101.88129296094998
curr_Factors:  [101.88129296  -1.09386105  -1.06389528]
mat_Sqrt:  [[11.77586393  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01114117  0.00575928 -0.5709303 ]
Stock Position:  0.011141169877306784
Bond Position:  [10.74649675]


portfolio before change:  [11.89114436]
curr_Stock_Price:  102.6197632257396
curr_Factors:  [102.61976323  -1.16612731  -1.06187893]
mat_Sqrt:  [[11.05656428  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00865261 0.05056035 0.10788207]
Stock Position:  0.008652614916301924
Bond Position:  [11.00321507]


portfolio before change:  [11.88151513]
curr_Stock_Price:  101.34792562936565
curr_Factors:  [101.34792563  -1.088518    -1.08033234]
mat_Sqrt:  [[11.58497579  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01852363 -0.00729575 -0.1281836 ]
Stock Position:  0.018523632296190185
Bond Position:  [10.00418342]


portfolio before change:  [11.88443234]
curr_Stock_Price:  101.43789769186475
curr_Factors:  [101.43789769  -0.77675483  -1.07136895]
mat_Sqrt:  [[15.97976096  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00229145 0.00937981 0.23422388]
Stock Position:  0.0022914506676036143
Bond Position:  [11.6519924]


portfolio before change:  [11.88387893]
curr_Stock_Price:  100.56072101010464
curr_Factors:  [100.56072101  -0.82812216  -1.06337706]
mat_Sqrt:  [[15.16913106  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00303133  0.00782204 -0.1677309 ]
Stock Position:  0.003031334153332075
Bond Position:  [11.57904578]


portfolio before change:  [11.88151281]
curr_Stock_Price:  99.3026669938064
curr_Factors:  [99.30266699 -0.94114023 -1.08678283]
mat_Sqrt:  [[13.06908304  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01011635 -0.01732734 -0.33576684]
Stock Position:  -0.01011635003293775
Bond Position:  [12.88609335]


portfolio before change:  [11.89583711]
curr_Stock_Price:  98.04594516677979
curr_Factors:  [98.04594517 -0.91861267 -1.06356832]
mat_Sqrt:  [[13.50763676  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-1.20646348e-05 -1.76564320e-02 -3.16450869e-02]
Stock Position:  -1.2064634839277308e-05
Bond Position:  [11.89702]


portfolio before change:  [11.8973216]
curr_Stock_Price:  98.2728140282474
curr_Factors:  [98.27281403 -0.86669293 -1.07843235]
mat_Sqrt:  [[14.04999653  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00687155 -0.03904909 -0.36552908]
Stock Position:  -0.006871545214890493
Bond Position:  [12.57260768]


portfolio before change:  [11.8989089]
curr_Stock_Price:  98.2705392183389
curr_Factors:  [98.27053922 -0.95080958 -1.05778977]
mat_Sqrt:  [[13.18559474  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00386256  0.0387375  -0.26381776]
Stock Position:  0.003862555067220197
Bond Position:  [11.51933353]


portfolio before change:  [11.90305431]
curr_Stock_Price:  98.97095543072139
curr_Factors:  [98.97095543 -0.89745464 -1.05579503]
mat_Sqrt:  [[14.03531649  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00625141 -0.02829828  0.0136186 ]
Stock Position:  -0.006251407611340335
Bond Position:  [12.52176209]


portfolio before change:  [11.9025983]
curr_Stock_Price:  99.29429521648656
curr_Factors:  [99.29429522 -0.80975068 -1.03722565]
mat_Sqrt:  [[15.66003302  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00770753  0.01452711 -0.10684572]
Stock Position:  -0.007707526151053156
Bond Position:  [12.66791167]


portfolio before change:  [11.90030177]
curr_Stock_Price:  99.79771442578729
curr_Factors:  [99.79771443 -1.06007605 -1.04607678]
mat_Sqrt:  [[12.14590956  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00829721 -0.03355713  0.17029276]
Stock Position:  -0.008297206677302185
Bond Position:  [12.72834403]


portfolio before change:  [11.90288998]
curr_Stock_Price:  99.67754512108941
curr_Factors:  [99.67754512 -1.32295365 -1.04731986]
mat_Sqrt:  [[ 9.31538116  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.03866926 0.13714269 0.18334719]
Stock Position:  0.03866925890730644
Bond Position:  [8.04843318]


portfolio before change:  [11.90879928]
curr_Stock_Price:  99.80434303185199
curr_Factors:  [99.80434303 -1.21358113 -1.02655592]
mat_Sqrt:  [[10.62356496  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.009157   -0.0303652  -0.30414384]
Stock Position:  -0.009157000461289045
Bond Position:  [12.82270769]


portfolio before change:  [11.90298041]
curr_Stock_Price:  100.61484948967951
curr_Factors:  [100.61484949  -1.32489928  -1.01877247]
mat_Sqrt:  [[ 9.65646956  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00893277 -0.01739291 -0.16791722]
Stock Position:  -0.008932773712654255
Bond Position:  [12.80175009]


portfolio before change:  [11.9055298]
curr_Stock_Price:  100.50860314574362
curr_Factors:  [100.50860315  -1.19595527  -1.02448806]
mat_Sqrt:  [[10.91131135  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00532408  0.03542637  0.32962172]
Stock Position:  -0.005324076115654964
Bond Position:  [12.44064525]


portfolio before change:  [11.90614943]
curr_Stock_Price:  100.68432290987626
curr_Factors:  [100.68432291  -1.3473984   -1.00185763]
mat_Sqrt:  [[ 9.60932588  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.0140835  0.02255764 0.37279267]
Stock Position:  0.014083495191631452
Bond Position:  [10.48816226]


portfolio before change:  [11.90128278]
curr_Stock_Price:  100.24567066482018
curr_Factors:  [100.24567066  -1.31619847  -0.99635101]
mat_Sqrt:  [[ 9.92517444  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01462871 -0.0145457   0.08327853]
Stock Position:  0.014628712969227353
Bond Position:  [10.43481764]


portfolio before change:  [11.91237084]
curr_Stock_Price:  100.91446711014126
curr_Factors:  [100.91446711  -1.2723808   -0.98262237]
mat_Sqrt:  [[10.58322419  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00476487 -0.00163631 -0.10926223]
Stock Position:  -0.004764874929296984
Bond Position:  [12.39321566]


portfolio before change:  [11.91422867]
curr_Stock_Price:  100.84970683206173
curr_Factors:  [100.84970683  -1.16969458  -0.95583039]
mat_Sqrt:  [[12.03845832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0077964  -0.01910927  0.22084345]
Stock Position:  0.007796403596733019
Bond Position:  [11.12796365]


portfolio before change:  [11.91426551]
curr_Stock_Price:  100.67600672787387
curr_Factors:  [100.67600673  -1.01729699  -0.9451155 ]
mat_Sqrt:  [[14.14689281  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-2.33784271e-04  4.33562248e-03  6.70354386e-01]
Stock Position:  -0.00023378427119989662
Bond Position:  [11.93780198]


portfolio before change:  [11.9159631]
curr_Stock_Price:  99.79799381818869
curr_Factors:  [99.79799382 -0.84820478 -0.9392841 ]
mat_Sqrt:  [[16.70418347  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00462847 -0.00033296 -0.23913679]
Stock Position:  -0.004628472124446199
Bond Position:  [12.37787533]


portfolio before change:  [11.9164476]
curr_Stock_Price:  100.02762312333016
curr_Factors:  [100.02762312  -1.04500669  -0.89563031]
mat_Sqrt:  [[14.36521098  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01109663  0.02791497  0.16229276]
Stock Position:  -0.011096631462075034
Bond Position:  [13.02641727]


portfolio before change:  [11.9102681]
curr_Stock_Price:  100.73125063891095
curr_Factors:  [100.73125064  -0.86192482  -0.91159973]
mat_Sqrt:  [[17.09748766  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00215382 -0.02538799  0.23140929]
Stock Position:  0.002153817976532597
Bond Position:  [11.69331133]


portfolio before change:  [11.90501566]
curr_Stock_Price:  97.61390407939348
curr_Factors:  [97.61390408 -0.77941969 -0.8585242 ]
mat_Sqrt:  [[18.97412202  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01049408  0.01429284 -0.38665277]
Stock Position:  0.010494081882623907
Bond Position:  [10.88064736]


portfolio before change:  [11.92419049]
curr_Stock_Price:  99.31149527465867
curr_Factors:  [99.31149527 -0.85649129 -0.86250761]
mat_Sqrt:  [[17.80113879  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0021536   0.02205597  0.0796182 ]
Stock Position:  -0.0021536009204917803
Bond Position:  [12.13806782]


portfolio before change:  [11.92291298]
curr_Stock_Price:  100.609257145524
curr_Factors:  [100.60925715  -0.93866913  -0.84974114]
mat_Sqrt:  [[16.82446367  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00697352 -0.02134911 -0.60064894]
Stock Position:  -0.006973523041513001
Bond Position:  [12.62451396]


portfolio before change:  [11.92965323]
curr_Stock_Price:  99.86901708812228
curr_Factors:  [99.86901709 -1.00618802 -0.86517098]
mat_Sqrt:  [[15.37127477  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00104988 -0.00193518 -0.32953684]
Stock Position:  -0.0010498803201996264
Bond Position:  [12.03450374]


portfolio before change:  [11.92914853]
curr_Stock_Price:  101.78266496749617
curr_Factors:  [101.78266497  -1.28381409  -0.87035769]
mat_Sqrt:  [[11.8067101   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00364631 0.03387942 0.0903663 ]
Stock Position:  0.0036463112891568336
Bond Position:  [11.55801725]


portfolio before change:  [11.93162744]
curr_Stock_Price:  102.06625744048608
curr_Factors:  [102.06625744  -1.27248098  -0.90173862]
mat_Sqrt:  [[11.60461171  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00036779 -0.02233831 -0.24401121]
Stock Position:  -0.0003677877407201951
Bond Position:  [11.96916616]


portfolio before change:  [11.93325258]
curr_Stock_Price:  101.71577937911931
curr_Factors:  [101.71577938  -1.2274662   -0.90907663]
mat_Sqrt:  [[12.00879885  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01323187 -0.06519049 -0.41080627]
Stock Position:  0.013231865041822418
Bond Position:  [10.58736312]


portfolio before change:  [11.93653992]
curr_Stock_Price:  101.86419635498787
curr_Factors:  [101.86419635  -1.17620878  -0.93870981]
mat_Sqrt:  [[12.28921347  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00459451 -0.02755245 -0.03486627]
Stock Position:  -0.004594506952972376
Bond Position:  [12.40455568]


portfolio before change:  [11.93752146]
curr_Stock_Price:  101.9880678133914
curr_Factors:  [101.98806781  -1.28932453  -0.94519607]
mat_Sqrt:  [[10.91715304  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01162642  0.02570694  0.10148964]
Stock Position:  -0.011626416137348055
Bond Position:  [13.12327717]


portfolio before change:  [11.94323173]
curr_Stock_Price:  101.63802370893163
curr_Factors:  [101.63802371  -1.44345374  -0.9391326 ]
mat_Sqrt:  [[ 9.38236036  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00555707 -0.05218142 -0.39574898]
Stock Position:  0.005557070342002633
Bond Position:  [11.37842208]


portfolio before change:  [11.94917971]
curr_Stock_Price:  102.45240887385286
curr_Factors:  [102.45240887  -1.34804053  -0.93592988]
mat_Sqrt:  [[10.43773895  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0170916  -0.09289236  0.13921366]
Stock Position:  -0.017091601166397928
Bond Position:  [13.70025543]


portfolio before change:  [11.95229073]
curr_Stock_Price:  102.37059255156328
curr_Factors:  [102.37059255  -1.19230489  -0.91290606]
mat_Sqrt:  [[12.47078292  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00305875 -0.00329788 -0.03171812]
Stock Position:  -0.0030587500989220262
Bond Position:  [12.26541679]


portfolio before change:  [11.95226808]
curr_Stock_Price:  102.87926916553806
curr_Factors:  [102.87926917  -1.05483115  -0.92018154]
mat_Sqrt:  [[14.27548133  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00311956  0.02867515 -0.06236292]
Stock Position:  -0.0031195575548066653
Bond Position:  [12.27320588]


portfolio before change:  [11.95225433]
curr_Stock_Price:  103.37549393427487
curr_Factors:  [103.37549393  -0.95888673  -0.90665124]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [11.95225433]
Stock Price:  103.33513406723168
PL:  [8.61712026]
Settle:  Tensor("sub_4:0", shape=(), dtype=float64)
PL:  Tensor("sub_5:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  3
output_Z_Vals[:, i, :]:  [[ 1.19260232e+02 -2.92559343e+01 -2.92733494e+01]
 [-1.46918956e-01  4.24663159e-01  7.17910659e-02]
 [ 5.43720687e-02  4.80830572e-02 -1.89409904e-02]
 [ 8.18478194e-02  1.41947805e-01  3.75775920e-02]
 [ 1.67109614e-01 -1.27548461e-02 -6.19901625e-02]
 [ 4.90832284e-02  2.90566562e-02  4.27218964e-02]
 [ 3.05667363e-02  4.54116360e-02 -2.70429854e-02]
 [-1.31407771e-01  1.63757908e-01 -3.15973926e-02]
 [ 2.01008520e-03  3.49872589e-02 -1.67648987e-02]
 [-3.34902496e-02  2.88438514e-01  1.12084498e-01]
 [ 2.20342336e-02 -1.23302019e-01 -2.76715012e-02]
 [-1.00373544e-01  1.13595652e-01  3.83969745e-02]
 [-4.22405691e-02 -9.90958776e-02 -5.24126823e-02]
 [ 2.43218673e-01  2.01044477e-01  2.89335325e-01]
 [ 1.81571722e-01  2.25164453e-01  2.75123470e-02]
 [-7.55614822e-02 -8.04049298e-02 -1.09898555e-01]
 [-7.63155012e-02 -3.74033903e-02 -7.10695580e-02]
 [-3.99809192e-02 -1.85219537e-03  3.67941634e-02]
 [ 1.94364831e-02  6.57578791e-02  1.80415321e-02]
 [ 2.87134409e-01 -6.75986901e-02 -4.57725421e-02]
 [-3.82288184e-02 -1.19503059e-03  1.42536579e-02]
 [ 6.02505660e-02 -4.70554040e-02  5.85525218e-02]
 [-4.89062922e-02  9.53000409e-03  1.83490750e-01]
 [ 3.85628524e-02 -1.28519041e-02 -4.46751174e-02]
 [-7.35678848e-02  6.99520180e-02  6.54980756e-02]
 [ 4.41255095e-02 -5.58397383e-02  7.41390161e-02]
 [-1.76607225e-01  7.24858169e-02  6.51525319e-02]
 [ 1.93760388e-02  1.14516099e-02  1.17425062e-02]
 [ 2.20517140e-02 -8.01466751e-02 -2.12288294e-01]
 [ 3.58359604e-02  9.51645896e-03 -3.53255605e-02]
 [-7.44016217e-03  2.28791505e-01  2.37223679e-02]
 [ 2.16771465e-02 -1.17461444e-01 -6.74708473e-02]
 [ 8.14423195e-02 -5.92048571e-02  3.37458257e-02]
 [-5.10977975e-02 -8.65226360e-02 -1.05148267e-02]
 [-1.51309241e-01  1.22372174e-01  3.45330934e-02]
 [ 8.47165236e-02 -1.65012150e-01 -1.38726811e-01]
 [-1.62280220e-01 -2.49349817e-01  2.51468679e-02]
 [-4.38619246e-02 -2.43592025e-02  2.76338499e-02]
 [-4.07201885e-02  8.71304831e-02 -2.29224943e-02]
 [ 9.16797216e-02 -3.87288162e-03 -8.18044235e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.26023247 -29.25593426 -29.27334937]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  8.31486419  -9.25153874 -83.50871763]
init_Out:  [2.49911038]
Stock Position:  8.31486419409362
Bond position:  [-828.98730903]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [11.97431481]
curr_Stock_Price:  101.15201332175549
curr_Factors:  [101.15201332  -1.14152672  -1.02408138]
mat_Sqrt:  [[11.60013074  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01045677  0.13429028  0.20479993]
Stock Position:  -0.01045677098607217
Bond Position:  [13.03203825]


portfolio before change:  [11.97769827]
curr_Stock_Price:  100.98424091830641
curr_Factors:  [100.98424092  -0.94396592  -1.03873631]
mat_Sqrt:  [[13.90519134  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00372143  0.0152052  -0.05403337]
Stock Position:  0.0037214341858302605
Bond Position:  [11.60189207]


portfolio before change:  [11.98035053]
curr_Stock_Price:  101.30721663074715
curr_Factors:  [101.30721663  -0.88967515  -1.07982591]
mat_Sqrt:  [[14.13503663  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00659237 0.04488784 0.10719841]
Stock Position:  0.006592369889163787
Bond Position:  [11.31249589]


portfolio before change:  [11.97499788]
curr_Stock_Price:  100.28075637371688
curr_Factors:  [100.28075637  -0.73472977  -1.09406899]
mat_Sqrt:  [[16.10572913  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00956968 -0.00403344 -0.17684068]
Stock Position:  0.0095696751670227
Bond Position:  [11.01534362]


portfolio before change:  [11.97915655]
curr_Stock_Price:  100.57143192402616
curr_Factors:  [100.57143192  -0.78376561  -1.09797749]
mat_Sqrt:  [[15.3194789   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.0038222  0.00918852 0.12187368]
Stock Position:  0.003822195190584904
Bond Position:  [11.59475291]


portfolio before change:  [11.98136923]
curr_Stock_Price:  100.7711184881417
curr_Factors:  [100.77111849  -0.63229269  -1.10438343]
mat_Sqrt:  [[17.74627559  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00147744  0.01436042 -0.07714611]
Stock Position:  0.001477444285552672
Bond Position:  [11.83248552]


portfolio before change:  [11.9822597]
curr_Stock_Price:  100.37267346866085
curr_Factors:  [100.37267347  -0.65354297  -1.0731975 ]
mat_Sqrt:  [[17.85260655  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00748515  0.0517848  -0.09013857]
Stock Position:  -0.007485145143209926
Bond Position:  [12.73356373]


portfolio before change:  [11.97240046]
curr_Stock_Price:  101.90250856341585
curr_Factors:  [101.90250856  -0.85698336  -1.08697708]
mat_Sqrt:  [[14.58591179  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-3.48739440e-05  1.10639427e-02 -4.78255895e-02]
Stock Position:  -3.487394403371763e-05
Bond Position:  [11.9759542]


portfolio before change:  [11.97387058]
curr_Stock_Price:  102.67565189216738
curr_Factors:  [102.67565189  -0.72987103  -1.06889779]
mat_Sqrt:  [[16.99307976  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-1.86172661e-04  9.12122669e-02  3.19745874e-01]
Stock Position:  -0.00018617266126226849
Bond Position:  [11.99298598]


portfolio before change:  [11.97525012]
curr_Stock_Price:  103.31850077459096
curr_Factors:  [103.31850077  -0.90606815  -1.04718974]
mat_Sqrt:  [[14.65173221  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00090107 -0.03899152 -0.07893909]
Stock Position:  0.0009010653106469612
Bond Position:  [11.8821534]


portfolio before change:  [11.97690737]
curr_Stock_Price:  103.5092607648541
curr_Factors:  [103.50926076  -0.75826763  -1.04548611]
mat_Sqrt:  [[17.04585974  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00525657  0.0359221   0.10953588]
Stock Position:  -0.005256570698010316
Bond Position:  [12.52101112]


portfolio before change:  [11.97779492]
curr_Stock_Price:  103.6381802256479
curr_Factors:  [103.63818023  -1.00730271  -1.0726914 ]
mat_Sqrt:  [[12.94761616  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00428634 -0.03133687 -0.14951879]
Stock Position:  -0.0042863417425971035
Bond Position:  [12.42202358]


portfolio before change:  [11.98272663]
curr_Stock_Price:  102.84989424263301
curr_Factors:  [102.84989424  -1.01703426  -1.06758521]
mat_Sqrt:  [[12.78984011  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.02404017 0.06357585 0.82539315]
Stock Position:  0.024040171080839758
Bond Position:  [9.51019758]


portfolio before change:  [11.98030158]
curr_Stock_Price:  102.6995667499852
curr_Factors:  [102.69956675  -1.12533034  -1.04082306]
mat_Sqrt:  [[11.77118386  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01639609 0.07120325 0.07848507]
Stock Position:  0.016396088965876163
Bond Position:  [10.29643035]


portfolio before change:  [11.9551146]
curr_Stock_Price:  101.08490609683909
curr_Factors:  [101.0849061   -1.05721313  -1.02945709]
mat_Sqrt:  [[12.54460386  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00797717 -0.02542627 -0.31350999]
Stock Position:  -0.007977173151419254
Bond Position:  [12.7614864]


portfolio before change:  [11.9538716]
curr_Stock_Price:  101.44070628467549
curr_Factors:  [101.44070628  -1.21485317  -1.05194313]
mat_Sqrt:  [[10.51368936  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00873036 -0.01182799 -0.20274167]
Stock Position:  -0.00873035737144341
Bond Position:  [12.83948522]


portfolio before change:  [11.95347049]
curr_Stock_Price:  101.67049695855539
curr_Factors:  [101.67049696  -1.06547702  -1.04783047]
mat_Sqrt:  [[12.28562244  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00264685 -0.00058572  0.10496351]
Stock Position:  -0.0026468472125630764
Bond Position:  [12.22257676]


portfolio before change:  [11.95497284]
curr_Stock_Price:  101.68015430217885
curr_Factors:  [101.6801543   -0.84526714  -1.0262577 ]
mat_Sqrt:  [[15.64743969  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00158601 0.02079447 0.05146747]
Stock Position:  0.0015860138818398252
Bond Position:  [11.79370671]


portfolio before change:  [11.95636975]
curr_Stock_Price:  101.63135384450709
curr_Factors:  [101.63135384  -0.70671792  -1.033351  ]
mat_Sqrt:  [[17.83714657  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01547589 -0.02137658 -0.13057632]
Stock Position:  0.015475891080393024
Bond Position:  [10.38353399]


portfolio before change:  [11.95924674]
curr_Stock_Price:  101.7333812613592
curr_Factors:  [101.73338126  -0.9308289   -1.03654916]
mat_Sqrt:  [[14.22466494  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00248513 -0.0003779   0.04066172]
Stock Position:  -0.0024851311695970797
Bond Position:  [12.21206753]


portfolio before change:  [11.96058977]
curr_Stock_Price:  101.80724676996647
curr_Factors:  [101.80724677  -1.30059847  -1.00991645]
mat_Sqrt:  [[10.1003125   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00702826 -0.01488023  0.16703405]
Stock Position:  0.007028256215880515
Bond Position:  [11.24506236]


portfolio before change:  [11.9595247]
curr_Stock_Price:  101.45569434454407
curr_Factors:  [101.45569434  -1.23244269  -0.98232114]
mat_Sqrt:  [[11.07686135  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0010116   0.00301365  0.52344804]
Stock Position:  -0.0010115984665915543
Bond Position:  [12.06215712]


portfolio before change:  [11.96057306]
curr_Stock_Price:  101.90992377833531
curr_Factors:  [101.90992378  -1.1305455   -0.99695693]
mat_Sqrt:  [[12.1409847   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00239781 -0.00406413 -0.12744567]
Stock Position:  0.0023978077771452883
Bond Position:  [11.71621265]


portfolio before change:  [11.96037725]
curr_Stock_Price:  101.21744493541772
curr_Factors:  [101.21744494  -1.25337293  -1.00753062]
mat_Sqrt:  [[10.55255045  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00553345  0.02212077  0.18684778]
Stock Position:  -0.0055334483356287816
Bond Position:  [12.52045875]


portfolio before change:  [11.95951035]
curr_Stock_Price:  101.6569642550092
curr_Factors:  [101.65696426  -1.33431521  -1.00440058]
mat_Sqrt:  [[ 9.8049589   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00589674 -0.01765808  0.21149798]
Stock Position:  0.0058967403697414
Bond Position:  [11.36006562]


portfolio before change:  [11.96268259]
curr_Stock_Price:  101.95410272620741
curr_Factors:  [101.95410273  -1.52780455  -0.98823297]
mat_Sqrt:  [[ 8.23575645  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0196019   0.02292203  0.18586204]
Stock Position:  -0.019601896343568292
Bond Position:  [13.96117634]


portfolio before change:  [11.9578595]
curr_Stock_Price:  102.28918991651557
curr_Factors:  [102.28918992  -1.35159713  -0.99015721]
mat_Sqrt:  [[ 9.83600527  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00224366 0.00362132 0.0334981 ]
Stock Position:  0.0022436595470295027
Bond Position:  [11.72835739]


portfolio before change:  [11.95910917]
curr_Stock_Price:  102.19271133600304
curr_Factors:  [102.19271134  -1.22770054  -1.02276415]
mat_Sqrt:  [[10.76602855  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00216894 -0.0253446  -0.60559941]
Stock Position:  -0.0021689363588979116
Bond Position:  [12.18075866]


portfolio before change:  [11.95974794]
curr_Stock_Price:  102.60025091799287
curr_Factors:  [102.60025092  -1.12093629  -1.00808429]
mat_Sqrt:  [[12.20468391  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00236556  0.00300937 -0.10077399]
Stock Position:  0.002365556921531583
Bond Position:  [11.7170412]


portfolio before change:  [11.96052368]
curr_Stock_Price:  102.30899612151781
curr_Factors:  [102.30899612  -0.8748155   -1.01072352]
mat_Sqrt:  [[15.52510812  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00021317 0.07235023 0.06767331]
Stock Position:  0.00021317192313288606
Bond Position:  [11.93871427]


portfolio before change:  [11.96226832]
curr_Stock_Price:  103.49212433227395
curr_Factors:  [103.49212433  -0.72646314  -1.00344274]
mat_Sqrt:  [[18.34926714  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00026551 -0.03714457 -0.19247555]
Stock Position:  0.0002655079316765235
Bond Position:  [11.93479034]


portfolio before change:  [11.96365641]
curr_Stock_Price:  103.10098578507694
curr_Factors:  [103.10098579  -0.89435933  -0.99345295]
mat_Sqrt:  [[15.60976491  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00556075 -0.01872222  0.09626745]
Stock Position:  0.005560749636051482
Bond Position:  [11.39033764]


portfolio before change:  [11.96149011]
curr_Stock_Price:  102.45535646251369
curr_Factors:  [102.45535646  -1.06234866  -1.0050599 ]
mat_Sqrt:  [[12.96195578  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00428007 -0.02736086 -0.02999587]
Stock Position:  -0.004280074192644242
Bond Position:  [12.40000664]


portfolio before change:  [11.96166737]
curr_Stock_Price:  102.77610838019447
curr_Factors:  [102.77610838  -0.86985526  -1.01314266]
mat_Sqrt:  [[15.63567245  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00902427  0.03869748  0.0985133 ]
Stock Position:  -0.009024272353847024
Bond Position:  [12.88914696]


portfolio before change:  [11.97175935]
curr_Stock_Price:  101.83633840857371
curr_Factors:  [101.83633841  -0.93984658  -1.00556854]
mat_Sqrt:  [[14.55525182  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0035821  -0.05218142 -0.39574898]
Stock Position:  0.0035821047350465
Bond Position:  [11.60697092]


portfolio before change:  [11.97542238]
curr_Stock_Price:  102.45387027028113
curr_Factors:  [102.45387027  -0.84753813  -1.00931006]
mat_Sqrt:  [[15.99961181  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01022433 -0.07885134  0.07173701]
Stock Position:  -0.010224330644160737
Bond Position:  [13.02294462]


portfolio before change:  [11.97083909]
curr_Stock_Price:  103.06136758355802
curr_Factors:  [103.06136758  -0.63010995  -1.01515042]
mat_Sqrt:  [[19.88696009  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00195355 -0.00770306  0.07883168]
Stock Position:  -0.0019535484734667127
Bond Position:  [12.17217447]


portfolio before change:  [11.97225903]
curr_Stock_Price:  103.11341698422649
curr_Factors:  [103.11341698  -0.75476751  -1.0244816 ]
mat_Sqrt:  [[17.40191757  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00247958  0.02755308 -0.0653915 ]
Stock Position:  -0.002479584420047115
Bond Position:  [12.22793745]


portfolio before change:  [11.9696212]
curr_Stock_Price:  104.79370420333524
curr_Factors:  [104.7937042   -0.8330009   -1.02605663]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [11.9696212]
Stock Price:  105.64931245061558
PL:  [6.32030875]
Settle:  Tensor("sub_6:0", shape=(), dtype=float64)
PL:  Tensor("sub_7:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  4
output_Z_Vals[:, i, :]:  [[ 1.19260232e+02 -2.92559343e+01 -2.92733494e+01]
 [-8.86544892e-02  2.16835316e-01  2.87230873e-02]
 [-4.65926037e-02 -3.64682968e-02 -1.85408115e-02]
 [ 5.56456104e-02  1.26864672e-01  3.27200443e-02]
 [ 2.13331439e-01 -2.68789282e-02 -5.56666162e-02]
 [ 7.15499976e-02  3.00873798e-02  6.51914005e-03]
 [ 6.89414667e-02  1.66466627e-02 -6.31320725e-02]
 [-1.23608129e-01 -2.44611520e-02 -1.11049504e-01]
 [ 3.18563517e-02 -1.63085314e-02 -3.50748805e-02]
 [-3.32854853e-02  3.95965800e-01  1.67729177e-01]
 [ 5.05343371e-02  2.27504780e-03 -6.87425714e-02]
 [-6.13261783e-02  6.30837124e-02  1.35242278e-02]
 [-7.08138682e-02 -5.11377726e-02 -5.71009275e-02]
 [-4.67748131e-02 -8.22257024e-02  9.47569538e-02]
 [ 1.76110056e-01  1.40219715e-01 -6.19371186e-02]
 [-9.16448173e-02 -2.03574941e-01 -1.05305714e-01]
 [-6.73667565e-02 -4.76922717e-02 -6.00554906e-02]
 [-2.14791584e-02  1.60094236e-01  8.53166640e-02]
 [ 7.06009554e-02  4.43072676e-02  3.93104844e-02]
 [-3.73267505e-02 -1.15480986e-02  1.04620411e-01]
 [ 1.80597353e-02 -6.05237930e-02  2.95022280e-02]
 [ 1.23932669e-01 -5.65400959e-02  2.01039525e-01]
 [-5.53685198e-02  2.07348873e-02  2.94583993e-01]
 [-6.77506271e-02 -5.85879364e-04 -8.22548431e-02]
 [-3.06301154e-01  1.08710140e-01  7.26373821e-02]
 [-2.99589664e-02 -1.39313070e-01  9.79138316e-02]
 [ 2.23187003e-01  4.46416858e-02 -1.35215923e-01]
 [-4.04000243e-02  6.54890606e-02  2.63063520e-02]
 [-7.42229637e-02 -6.92731259e-02 -2.08168363e-01]
 [ 9.08990488e-02  1.00331469e-01 -5.88567468e-02]
 [ 5.22237195e-02  1.20430154e-03  3.28540704e-02]
 [ 4.28910162e-02 -9.55199681e-02 -7.93818907e-02]
 [ 2.91755492e-01 -1.28805429e-01  4.02221781e-02]
 [-3.85131055e-02 -7.42366980e-02  2.41056285e-02]
 [-1.97961970e-01  1.01974928e-01  1.77725798e-02]
 [ 1.82486446e-01 -3.53148594e-02 -1.83816966e-02]
 [ 3.21420368e-02  7.29483233e-02 -1.04666847e-01]
 [-3.53972273e-02 -2.13883441e-03 -1.31247824e-02]
 [-6.29673168e-03  6.43067885e-02 -2.01894947e-02]
 [-2.77027153e-01  1.50764670e-01  1.67901994e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.26023247 -29.25593426 -29.27334937]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  8.31486419  -9.25153874 -83.50871763]
init_Out:  [2.49911038]
Stock Position:  8.31486419409362
Bond position:  [-828.98730903]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [8.98820191]
curr_Stock_Price:  100.79288383640765
curr_Factors:  [100.79288384  -0.88989488  -1.01827265]
mat_Sqrt:  [[14.95282479  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00516242  0.06856935  0.08193897]
Stock Position:  -0.00516241919891796
Bond Position:  [9.50853703]


portfolio before change:  [8.99292185]
curr_Stock_Price:  100.10884561003456
curr_Factors:  [100.10884561  -0.70011749  -1.00854369]
mat_Sqrt:  [[18.13052303  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00283052 -0.01153229 -0.05289177]
Stock Position:  -0.0028305216719350474
Bond Position:  [9.2762821]


portfolio before change:  [8.99352552]
curr_Stock_Price:  100.30525330181281
curr_Factors:  [100.3052533   -0.67296903  -1.01439668]
mat_Sqrt:  [[18.55709795  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00353505 0.04011813 0.09334118]
Stock Position:  0.0035350459101655247
Bond Position:  [8.63894184]


portfolio before change:  [8.99596775]
curr_Stock_Price:  100.69062306040318
curr_Factors:  [100.69062306  -0.66612925  -1.02433639]
mat_Sqrt:  [[18.57073655  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01083826 -0.00849986 -0.15880136]
Stock Position:  0.010838263054128546
Bond Position:  [7.90465629]


portfolio before change:  [8.98942494]
curr_Stock_Price:  99.99577438032173
curr_Factors:  [99.99577438 -0.71489565 -0.9867819 ]
mat_Sqrt:  [[18.2369613   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00403892 0.00951446 0.01859729]
Stock Position:  0.004038916519563905
Bond Position:  [8.58555036]


portfolio before change:  [8.99003184]
curr_Stock_Price:  99.88030767160573
curr_Factors:  [99.88030767 -0.9707618  -0.97208855]
mat_Sqrt:  [[14.31234142  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00394656  0.00526414 -0.18009823]
Stock Position:  0.003946559105389096
Bond Position:  [8.59584831]


portfolio before change:  [8.99067147]
curr_Stock_Price:  99.77010594860612
curr_Factors:  [99.77010595 -0.87856859 -0.97948158]
mat_Sqrt:  [[15.56178812  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00944028 -0.0077353  -0.31679332]
Stock Position:  -0.009440277488992881
Bond Position:  [9.93252896]


portfolio before change:  [8.98370668]
curr_Stock_Price:  100.63940589553573
curr_Factors:  [100.6394059   -0.7393083   -0.98550678]
mat_Sqrt:  [[17.93454618  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00135357 -0.00515721 -0.10005887]
Stock Position:  0.0013535685272701536
Bond Position:  [8.84748435]


portfolio before change:  [8.9862971]
curr_Stock_Price:  101.73606748189255
curr_Factors:  [101.73606748  -0.74544297  -0.98874956]
mat_Sqrt:  [[17.96075961  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00062224 0.12521538 0.47848466]
Stock Position:  0.0006222388627304868
Bond Position:  [8.92299296]


portfolio before change:  [8.98775591]
curr_Stock_Price:  102.2879007625515
curr_Factors:  [102.28790076  -0.73737502  -0.98706282]
mat_Sqrt:  [[18.23519552  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00200497  0.00071943 -0.19610342]
Stock Position:  0.002004972191524414
Bond Position:  [8.78267152]


portfolio before change:  [8.98794242]
curr_Stock_Price:  101.83333609184572
curr_Factors:  [101.83333609  -0.60934384  -0.97399384]
mat_Sqrt:  [[20.90523976  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00272356  0.01994882  0.03858086]
Stock Position:  -0.0027235632351158725
Bond Position:  [9.26529196]


portfolio before change:  [8.99038428]
curr_Stock_Price:  101.36203420856322
curr_Factors:  [101.36203421  -0.6089179   -0.9547887 ]
mat_Sqrt:  [[21.22101586  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00394844 -0.01617118 -0.16289305]
Stock Position:  -0.003948440470175033
Bond Position:  [9.39060624]


portfolio before change:  [8.99631101]
curr_Stock_Price:  100.15831078278694
curr_Factors:  [100.15831078  -0.47653879  -0.97152808]
mat_Sqrt:  [[23.53962494  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00125557 -0.02600205  0.27031521]
Stock Position:  -0.0012555718044456798
Bond Position:  [9.12206696]


portfolio before change:  [8.9983483]
curr_Stock_Price:  99.4439229720471
curr_Factors:  [99.44392297 -0.4844048  -0.98087921]
mat_Sqrt:  [[22.9727765   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00727329  0.04434137 -0.17668936]
Stock Position:  0.007273289399317396
Bond Position:  [8.27506387]


portfolio before change:  [8.99898614]
curr_Stock_Price:  99.38939312125422
curr_Factors:  [99.38939312 -0.32144705 -0.96194756]
mat_Sqrt:  [[27.54031121  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00429903 -0.06437605 -0.30040789]
Stock Position:  -0.004299026893610483
Bond Position:  [9.42626381]


portfolio before change:  [9.00143457]
curr_Stock_Price:  99.0939597735471
curr_Factors:  [ 9.90939598e+01 -7.95591335e-02 -9.64817996e-01]
mat_Sqrt:  [[34.87224914  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00231866 -0.01508162 -0.1713216 ]
Stock Position:  -0.002318661495510137
Bond Position:  [9.23119992]


portfolio before change:  [9.004908]
curr_Stock_Price:  98.09361737376753
curr_Factors:  [98.09361737 -0.20876349 -0.96418732]
mat_Sqrt:  [[30.35531083  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [2.29442830e-06 5.06262427e-02 2.43384695e-01]
Stock Position:  2.2944282994194328e-06
Bond Position:  [9.00468293]


portfolio before change:  [9.00603413]
curr_Stock_Price:  98.30000412634149
curr_Factors:  [98.30000413 -0.36654928 -0.97483146]
mat_Sqrt:  [[25.70391532  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00310339 0.01401119 0.11214187]
Stock Position:  0.0031033864760210994
Bond Position:  [8.70097123]


portfolio before change:  [9.00117981]
curr_Stock_Price:  96.38531906148266
curr_Factors:  [96.38531906 -0.29254645 -0.98157598]
mat_Sqrt:  [[26.95668897  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00060354 -0.00365183  0.29845291]
Stock Position:  -0.0006035373693332664
Bond Position:  [9.05935195]


portfolio before change:  [9.00162307]
curr_Stock_Price:  97.52730415907799
curr_Factors:  [97.52730416 -0.37177266 -0.98197258]
mat_Sqrt:  [[25.18849003  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00089402 -0.0191393   0.08416164]
Stock Position:  0.0008940248011702695
Bond Position:  [8.91443124]


portfolio before change:  [9.00270859]
curr_Stock_Price:  97.4950256455864
curr_Factors:  [97.49502565 -0.42946726 -0.97935526]
mat_Sqrt:  [[23.83079927  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00686128 -0.01787955  0.57350981]
Stock Position:  0.006861281875467232
Bond Position:  [8.33376773]


portfolio before change:  [9.00691257]
curr_Stock_Price:  97.95590130221515
curr_Factors:  [97.9559013  -0.60143766 -1.00033371]
mat_Sqrt:  [[19.7419542   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [2.68390780e-04 6.55694709e-03 8.40366136e-01]
Stock Position:  0.00026839077956316627
Bond Position:  [8.98062211]


portfolio before change:  [9.00818144]
curr_Stock_Price:  98.50071455611096
curr_Factors:  [98.50071456 -0.69606528 -1.00529355]
mat_Sqrt:  [[17.97002286  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-4.70538934e-03 -1.85271323e-04 -2.34650172e-01]
Stock Position:  -0.004705389340257233
Bond Position:  [9.47166565]


portfolio before change:  [9.01105136]
curr_Stock_Price:  98.14242511108866
curr_Factors:  [98.14242511 -0.72208036 -0.9999047 ]
mat_Sqrt:  [[17.53913518  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01645846  0.03437716  0.20721423]
Stock Position:  -0.016458464077828822
Bond Position:  [10.62632494]


portfolio before change:  [9.00331223]
curr_Stock_Price:  98.6933581632692
curr_Factors:  [98.69335816 -0.68181275 -1.01890561]
mat_Sqrt:  [[18.01670322  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00075316 -0.04405466  0.27932091]
Stock Position:  -0.0007531587251269351
Bond Position:  [9.07764399]


portfolio before change:  [9.00507304]
curr_Stock_Price:  97.86214565412662
curr_Factors:  [97.86214565 -0.55867535 -1.01328153]
mat_Sqrt:  [[20.31994542  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00968205  0.01411694 -0.38573339]
Stock Position:  0.00968205412439676
Bond Position:  [8.05756645]


portfolio before change:  [8.99889229]
curr_Stock_Price:  97.11974049320433
curr_Factors:  [97.11974049 -0.4161865  -1.00818813]
mat_Sqrt:  [[23.37273162  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00142642  0.02070946  0.0750447 ]
Stock Position:  -0.001426420453411732
Bond Position:  [9.13742587]


portfolio before change:  [8.99785318]
curr_Stock_Price:  98.64899129538844
curr_Factors:  [98.6489913  -0.68483505 -1.01914341]
mat_Sqrt:  [[17.94998982  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00660189 -0.02190609 -0.5938464 ]
Stock Position:  -0.006601885492027766
Bond Position:  [9.64912253]


portfolio before change:  [9.00904189]
curr_Stock_Price:  97.13692416956931
curr_Factors:  [97.13692417 -0.60527806 -1.00153476]
mat_Sqrt:  [[19.4784505   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00418285  0.0317276  -0.16790192]
Stock Position:  0.004182853919191031
Bond Position:  [8.60273233]


portfolio before change:  [9.0076883]
curr_Stock_Price:  96.55621844249353
curr_Factors:  [96.55621844 -0.63330206 -1.01518525]
mat_Sqrt:  [[18.57168506  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00317479 0.00038083 0.09372352]
Stock Position:  0.003174785877128969
Bond Position:  [8.70114298]


portfolio before change:  [9.01091136]
curr_Stock_Price:  97.22881596955412
curr_Factors:  [97.22881597 -0.51183254 -1.01356355]
mat_Sqrt:  [[21.15065844  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00114516 -0.03020607 -0.22645444]
Stock Position:  0.001145162489742902
Bond Position:  [8.89956857]


portfolio before change:  [9.00938603]
curr_Stock_Price:  94.92534745272818
curr_Factors:  [94.92534745 -0.17880074 -1.00762797]
mat_Sqrt:  [[28.98162635  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01023545 -0.04073185  0.11474268]
Stock Position:  0.010235452763430025
Bond Position:  [8.03778212]


portfolio before change:  [9.00377023]
curr_Stock_Price:  94.2785192286098
curr_Factors:  [ 9.42785192e+01 -4.76822491e-02 -1.03916220e+00]
mat_Sqrt:  [[31.79817571  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00111671 -0.02347571  0.06876665]
Stock Position:  -0.0011167102261584046
Bond Position:  [9.10905202]


portfolio before change:  [9.00345049]
curr_Stock_Price:  95.58453705373437
curr_Factors:  [95.58453705 -0.34256229 -1.04734413]
mat_Sqrt:  [[23.80997568  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0080513   0.0322473   0.05070022]
Stock Position:  -0.008051296573031766
Bond Position:  [9.77302995]


portfolio before change:  [9.00417344]
curr_Stock_Price:  95.64648466729248
curr_Factors:  [95.64648467 -0.41528543 -1.04434007]
mat_Sqrt:  [[22.22090357  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00800249 -0.01116754 -0.05243786]
Stock Position:  0.008002486099378802
Bond Position:  [8.23876378]


portfolio before change:  [9.01383431]
curr_Stock_Price:  96.72501946839166
curr_Factors:  [96.72501947 -0.11228217 -1.04631643]
mat_Sqrt:  [[30.36447987  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00041695  0.02306829 -0.29858538]
Stock Position:  0.0004169517729094924
Bond Position:  [8.97350464]


portfolio before change:  [9.01653975]
curr_Stock_Price:  100.5232451183679
curr_Factors:  [100.52324512  -0.20000672  -1.05743729]
mat_Sqrt:  [[28.58679754  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00133389 -0.00067636 -0.03744135]
Stock Position:  -0.001333886272409091
Bond Position:  [9.15062632]


portfolio before change:  [9.01833721]
curr_Stock_Price:  100.03327559589005
curr_Factors:  [ 1.00033276e+02 -2.82666609e-02 -1.05370032e+00]
mat_Sqrt:  [[33.90409855  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0002583   0.02033559 -0.05759501]
Stock Position:  -0.0002583021307349117
Bond Position:  [9.04417602]


portfolio before change:  [9.01881014]
curr_Stock_Price:  102.57936518940846
curr_Factors:  [102.57936519  -0.1793618   -1.02440306]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [9.01881014]
Stock Price:  103.18673816630647
PL:  [5.83207197]
Settle:  Tensor("sub_8:0", shape=(), dtype=float64)
PL:  Tensor("sub_9:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  5
output_Z_Vals[:, i, :]:  [[ 1.19260232e+02 -2.92559343e+01 -2.92733494e+01]
 [-7.95268746e-03 -5.09973896e-02 -2.41038471e-02]
 [-5.23945954e-02 -6.29977504e-02 -5.51631544e-02]
 [ 7.86262867e-02  1.12654313e-01  3.71862334e-02]
 [ 2.28393502e-01 -1.98979284e-02 -3.88568490e-02]
 [-6.79216420e-02  2.39032319e-02  2.25220629e-01]
 [-1.12704241e-01 -6.31943815e-02 -6.79876179e-02]
 [ 2.54691812e-01  2.66279753e-01  1.89935276e-01]
 [ 7.34183338e-02  6.07683009e-02  7.92309292e-02]
 [-5.89330881e-02 -5.64163298e-03 -2.18060867e-02]
 [-4.05087474e-03 -2.38238142e-01  9.91935596e-03]
 [-1.14016952e-01  1.01801196e-01  4.63141860e-02]
 [ 3.78092940e-02 -2.15867677e-01 -5.68373293e-03]
 [ 6.11800305e-01  4.15584891e-01  4.95973630e-01]
 [-3.58860289e-02 -1.63751623e-01 -9.32411732e-03]
 [-1.74567460e-02 -1.03498098e-01 -1.79911501e-01]
 [-1.30127000e-01  2.28953047e-01 -2.27737075e-01]
 [ 4.78879771e-01 -2.68797970e-01 -4.89041693e-01]
 [ 1.39753787e-01 -1.72867134e-02  6.99853890e-02]
 [-1.41398821e+00 -6.44141945e-01  3.76804341e-01]
 [ 1.08161235e+00 -4.86925209e-02  1.58984242e+00]
 [-3.19527263e-01  2.15230176e-01 -3.11387160e-01]
 [-4.79851019e-01  1.73004048e+00  5.27546936e-01]
 [ 6.18164836e-01 -6.55191056e-02  2.22084377e-01]
 [-7.04420556e-01 -2.96901611e-01 -7.22116527e-01]
 [ 9.28054673e-02 -1.23199338e-01  7.24150864e-02]
 [ 3.45802908e-01  3.94016755e-01  1.53408183e-01]
 [-5.33935271e-02  6.25944683e-02  1.28056596e-02]
 [-9.58554477e-02  5.58190184e-01  2.63212765e-01]
 [-2.88331071e-01 -4.43065377e-01  2.11645273e-01]
 [-3.96484642e-01  1.52321796e+00 -1.09289453e-01]
 [ 8.85507155e-02  7.13967608e-01  7.95967063e-01]
 [-9.57065970e-02  2.74723368e-02  8.53747615e-02]
 [-9.29324363e-01  1.45057211e-01  5.94221965e-03]
 [-9.94197066e-02  1.69800917e-01  1.96554239e-02]
 [ 9.66789832e-02 -1.59374497e-01 -1.33298043e-01]
 [-4.36985405e-01 -8.25691068e-01  2.87525432e-01]
 [-1.29856423e-01 -1.87205331e-01  4.38625795e-01]
 [ 2.91985479e-02 -1.81376754e-02 -5.84911347e-02]
 [ 4.51323832e-01 -3.16426819e-02 -4.64814461e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.26023247 -29.25593426 -29.27334937]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  8.31486419  -9.25153874 -83.50871763]
init_Out:  [2.49911038]
Stock Position:  8.31486419409362
Bond position:  [-828.98730903]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [5.04816011]
curr_Stock_Price:  100.31902861680531
curr_Factors:  [100.31902862  -0.75748171  -0.99661558]
mat_Sqrt:  [[17.36155197  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0008173  -0.01612679 -0.06876157]
Stock Position:  -0.0008173008731499175
Bond Position:  [5.13015094]


portfolio before change:  [5.04881645]
curr_Stock_Price:  100.30064124770479
curr_Factors:  [100.30064125  -0.56008     -0.98687977]
mat_Sqrt:  [[21.35342852  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00305718 -0.01992164 -0.15736512]
Stock Position:  -0.0030571822203432574
Bond Position:  [5.35545379]


portfolio before change:  [5.04410981]
curr_Stock_Price:  102.05915885522933
curr_Factors:  [102.05915886  -0.57618657  -1.00132387]
mat_Sqrt:  [[21.07404512  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00422917 0.03562442 0.10608197]
Stock Position:  0.004229165124833969
Bond Position:  [4.61248478]


portfolio before change:  [5.04318084]
curr_Stock_Price:  101.70316213985569
curr_Factors:  [101.70316214  -0.57665148  -1.00389714]
mat_Sqrt:  [[20.9368294   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01050532 -0.00629228 -0.11084777]
Stock Position:  0.010505321256532717
Bond Position:  [3.97475645]


portfolio before change:  [5.05406965]
curr_Stock_Price:  102.6923685894594
curr_Factors:  [102.69236859  -0.24659539  -1.00873365]
mat_Sqrt:  [[29.26548274  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0007289   0.00755887  0.64249177]
Stock Position:  -0.0007288960491777258
Bond Position:  [5.12892171]


portfolio before change:  [5.05398577]
curr_Stock_Price:  103.68706836533174
curr_Factors:  [103.68706837  -0.15098171  -1.02655013]
mat_Sqrt:  [[31.93956608  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00401426 -0.01998382 -0.19394975]
Stock Position:  -0.00401426328503943
Bond Position:  [5.47021296]


portfolio before change:  [5.05867795]
curr_Stock_Price:  102.68854026088546
curr_Factors:  [102.68854026  -0.10699751  -1.03819436]
mat_Sqrt:  [[32.67168039  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00919259 0.08420505 0.54183247]
Stock Position:  0.009192594256182619
Bond Position:  [4.11470386]


portfolio before change:  [5.07194375]
curr_Stock_Price:  104.0756825795576
curr_Factors:  [104.07568258  -0.38961053  -1.03772047]
mat_Sqrt:  [[24.97280303  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00365038 0.01921662 0.22602379]
Stock Position:  0.0036503835857019033
Bond Position:  [4.69202759]


portfolio before change:  [5.0741316]
curr_Stock_Price:  104.51434999302833
curr_Factors:  [104.51434999  -0.30982602  -1.04047488]
mat_Sqrt:  [[27.08617591  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00234547 -0.00178404 -0.0622067 ]
Stock Position:  -0.0023454733320652653
Bond Position:  [5.31926722]


portfolio before change:  [5.07574882]
curr_Stock_Price:  104.10834707210111
curr_Factors:  [ 1.04108347e+02  9.87961494e-03 -1.02710484e+00]
mat_Sqrt:  [[37.64525562  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00021722 -0.07533752  0.02829716]
Stock Position:  -0.00021722198283227485
Bond Position:  [5.09836344]


portfolio before change:  [5.07640312]
curr_Stock_Price:  104.0302482558043
curr_Factors:  [ 1.04030248e+02  7.90541427e-02 -1.05744305e+00]
mat_Sqrt:  [[39.10666065  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00260658  0.03219236  0.13212148]
Stock Position:  -0.0026065793213290106
Bond Position:  [5.34756621]


portfolio before change:  [5.07899847]
curr_Stock_Price:  103.29101498741188
curr_Factors:  [ 1.03291015e+02  3.29538935e-02 -1.08136128e+00]
mat_Sqrt:  [[36.20303691  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00085837 -0.06826335 -0.01621411]
Stock Position:  0.0008583652122420916
Bond Position:  [4.99033706]


portfolio before change:  [5.08242462]
curr_Stock_Price:  106.55572794685264
curr_Factors:  [106.55572795   0.10731486  -1.08225317]
mat_Sqrt:  [[40.19448522  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01800672 0.13141948 1.41487471]
Stock Position:  0.01800672031950323
Bond Position:  [3.16370543]


portfolio before change:  [5.12337583]
curr_Stock_Price:  108.80798260430177
curr_Factors:  [ 1.08807983e+02 -2.80897637e-02 -1.11033872e+00]
mat_Sqrt:  [[34.85359253  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00120554 -0.05178281 -0.02659911]
Stock Position:  -0.00120553871289298
Bond Position:  [5.25454806]


portfolio before change:  [5.11909814]
curr_Stock_Price:  112.90120947572376
curr_Factors:  [ 1.12901209e+02 -3.14440791e-02 -1.10370690e+00]
mat_Sqrt:  [[36.28346769  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00156692 -0.03272897 -0.51323743]
Stock Position:  -0.0015669212568846954
Bond Position:  [5.29600545]


portfolio before change:  [5.11750864]
curr_Stock_Price:  114.33813636759378
curr_Factors:  [ 1.14338136e+02 -1.08043259e-03 -1.11275117e+00]
mat_Sqrt:  [[37.53705451  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00454756  0.07240131 -0.64967048]
Stock Position:  -0.0045475622946113455
Bond Position:  [5.63746843]


portfolio before change:  [5.12455366]
curr_Stock_Price:  112.9439177121656
curr_Factors:  [112.94391771   0.18954047  -1.11505515]
mat_Sqrt:  [[44.76276734  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00831303 -0.08500138 -1.39509983]
Stock Position:  0.008313029827736743
Bond Position:  [4.1856475]


portfolio before change:  [5.17014327]
curr_Stock_Price:  118.36509054381426
curr_Factors:  [118.36509054   0.24060082  -1.13118354]
mat_Sqrt:  [[48.57898937  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00316172 -0.00546654  0.19964883]
Stock Position:  0.0031617198229044055
Bond Position:  [4.79590602]


portfolio before change:  [5.17056015]
curr_Stock_Price:  118.30732175907745
curr_Factors:  [118.30732176   0.44231025  -1.13402288]
mat_Sqrt:  [[59.23858128  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02285175 -0.20369557  1.0749179 ]
Stock Position:  -0.02285174607632721
Bond Position:  [7.87408902]


portfolio before change:  [5.17718578]
curr_Stock_Price:  118.0604560171976
curr_Factors:  [118.06045602   0.19114185  -1.14796268]
mat_Sqrt:  [[45.34845034  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.03097968 -0.01539793  4.53537791]
Stock Position:  0.030979676899321653
Bond Position:  [1.519711]


portfolio before change:  [5.20606239]
curr_Stock_Price:  118.98643834564625
curr_Factors:  [118.98643835   0.34127498  -1.13313435]
mat_Sqrt:  [[53.90106027  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00700416  0.06806176 -0.88830089]
Stock Position:  -0.00700416058753363
Bond Position:  [6.03946251]


portfolio before change:  [5.2132197]
curr_Stock_Price:  118.07236298396823
curr_Factors:  [118.07236298   0.29231486  -1.10752497]
mat_Sqrt:  [[52.25249165  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00626758  0.54708684  1.50494457]
Stock Position:  -0.006267576682309876
Bond Position:  [5.95324729]


portfolio before change:  [5.25595003]
curr_Stock_Price:  111.3734222865481
curr_Factors:  [111.37342229   0.25137791  -1.1078802 ]
mat_Sqrt:  [[47.29414177  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0139934  -0.02071896  0.63354491]
Stock Position:  0.013993401684405264
Bond Position:  [3.69745699]


portfolio before change:  [5.2816275]
curr_Stock_Price:  113.1753618640227
curr_Factors:  [113.17536186   0.1684406   -1.10986772]
mat_Sqrt:  [[44.14639914  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01946904 -0.09388853 -2.05999745]
Stock Position:  -0.0194690384307643
Bond Position:  [7.48504297]


portfolio before change:  [5.29593092]
curr_Stock_Price:  112.48874705608476
curr_Factors:  [112.48874706   0.15015293  -1.0997621 ]
mat_Sqrt:  [[43.52101925  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00239898 -0.03895905  0.20658008]
Stock Position:  0.0023989819975905333
Bond Position:  [5.02607244]


portfolio before change:  [5.30128035]
curr_Stock_Price:  114.45671742471922
curr_Factors:  [ 1.14456717e+02 -6.12029406e-02 -1.12521297e+00]
mat_Sqrt:  [[34.94518978  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.0110828  0.12459904 0.43763085]
Stock Position:  0.011082804047089546
Bond Position:  [4.03277898]


portfolio before change:  [5.32417371]
curr_Stock_Price:  116.47689488616797
curr_Factors:  [116.47689489  -0.30811687  -1.0996985 ]
mat_Sqrt:  [[28.49924384  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00172508  0.01979411  0.03653098]
Stock Position:  -0.0017250773696466353
Bond Position:  [5.52510536]


portfolio before change:  [5.32359569]
curr_Stock_Price:  117.2123367176916
curr_Factors:  [117.21233672  -0.39784684  -1.07951203]
mat_Sqrt:  [[26.75250898  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00103598  0.17651523  0.75087276]
Stock Position:  -0.0010359760445354045
Bond Position:  [5.44502487]


portfolio before change:  [5.32450157]
curr_Stock_Price:  116.99494763336116
curr_Factors:  [116.99494763  -0.15568184  -1.07992343]
mat_Sqrt:  [[34.00560887  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0075449  -0.14010957  0.60376505]
Stock Position:  -0.0075449041384820495
Bond Position:  [6.20721724]


portfolio before change:  [5.31089672]
curr_Stock_Price:  118.90097653309314
curr_Factors:  [118.90097653  -0.36347315  -1.09434186]
mat_Sqrt:  [[27.67352021  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01371217  0.48168381 -0.31177239]
Stock Position:  -0.013712167312777399
Bond Position:  [6.9412868]


portfolio before change:  [5.32018237]
curr_Stock_Price:  118.28707380597525
curr_Factors:  [118.28707381  -0.3789116   -1.04979225]
mat_Sqrt:  [[28.34386633  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00950687 0.22577638 2.27067248]
Stock Position:  0.009506867312565297
Bond Position:  [4.19564286]


portfolio before change:  [5.30518354]
curr_Stock_Price:  116.65422078915707
curr_Factors:  [116.65422079  -0.47916454  -1.053599  ]
mat_Sqrt:  [[25.19008946  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00307939  0.00868752  0.24355043]
Stock Position:  -0.003079394149848827
Bond Position:  [5.66440787]


portfolio before change:  [5.30752908]
curr_Stock_Price:  116.12247979929342
curr_Factors:  [116.1224798   -0.59566989  -1.06162563]
mat_Sqrt:  [[22.13920387  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.04175245  0.04587112  0.0169515 ]
Stock Position:  -0.04175245220075353
Bond Position:  [10.15592737]


portfolio before change:  [5.33896461]
curr_Stock_Price:  115.39998419297483
curr_Factors:  [115.39998419  -0.49101463  -1.05774482]
mat_Sqrt:  [[24.52381711  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00371163  0.05369576  0.05607145]
Stock Position:  -0.003711629342732788
Bond Position:  [5.76728658]


portfolio before change:  [5.33838288]
curr_Stock_Price:  115.75095761556217
curr_Factors:  [115.75095762  -0.5841065   -1.06425653]
mat_Sqrt:  [[22.26638053  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00293512 -0.05039864 -0.38026221]
Stock Position:  0.0029351246513983536
Bond Position:  [4.9986394]


portfolio before change:  [5.34227469]
curr_Stock_Price:  116.86400628697898
curr_Factors:  [116.86400629  -0.77903052  -1.05628062]
mat_Sqrt:  [[18.64727055  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02143015 -0.26110644  0.82023003]
Stock Position:  -0.02143014829822782
Bond Position:  [7.84668768]


portfolio before change:  [5.34915458]
curr_Stock_Price:  116.58874033612769
curr_Factors:  [116.58874034  -0.61735856  -1.06803492]
mat_Sqrt:  [[21.61222724  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00208937 -0.05919952  1.2512773 ]
Stock Position:  -0.0020893694956593263
Bond Position:  [5.59275154]


portfolio before change:  [5.3480124]
curr_Stock_Price:  117.47001597115323
curr_Factors:  [117.47001597  -0.84450847  -1.08001479]
mat_Sqrt:  [[17.14419899  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00097939 -0.00573564 -0.16685893]
Stock Position:  0.00097938563946946
Bond Position:  [5.23296396]


portfolio before change:  [5.34785708]
curr_Stock_Price:  116.64349587867258
curr_Factors:  [116.64349588  -0.68449874  -1.06198651]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [5.34785708]
Stock Price:  115.93634590395556
PL:  [-10.58848882]
Settle:  Tensor("sub_10:0", shape=(), dtype=float64)
PL:  Tensor("sub_11:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  6
output_Z_Vals[:, i, :]:  [[ 1.19260232e+02 -2.92559343e+01 -2.92733494e+01]
 [-1.04089216e-01  2.65963660e-01  3.83165522e-02]
 [ 1.70343700e-01  1.55630993e-01 -1.02298877e-02]
 [ 8.78860664e-02  1.96853763e-01  3.83111311e-02]
 [ 2.31897704e-01 -1.71386252e-02 -3.35726448e-02]
 [ 7.07080283e-02  3.33735601e-02 -7.05516807e-02]
 [-1.90188033e-02  5.58506647e-02 -9.97004559e-02]
 [ 5.16051762e-02  7.46144933e-02  7.67981919e-02]
 [-1.40186950e-01 -4.53775331e-02  1.10815191e-01]
 [-5.78874215e-02  2.00872431e-01  6.18127613e-02]
 [ 5.44221356e-02  5.19380735e-02 -7.59269717e-02]
 [-3.48945517e-02  7.84129587e-02 -2.01149351e-03]
 [-8.97084092e-02 -5.25333786e-03 -5.67710948e-02]
 [ 3.96587662e-02  8.25583057e-02  1.75213322e-01]
 [ 2.25130814e-01  3.31192164e-01  9.16110685e-02]
 [-7.27688371e-02 -6.19314736e-02 -1.03102421e-01]
 [-7.38579938e-02 -5.06793809e-02 -5.89298909e-02]
 [-4.52334119e-02  7.50170516e-04  4.28506183e-02]
 [ 4.66120128e-02  6.81197089e-02  5.41068739e-02]
 [ 3.18226454e-01 -9.70952485e-02 -6.15155875e-02]
 [ 2.97182608e-02  7.75021809e-03  7.84282725e-02]
 [ 1.19525980e-02 -1.36994270e-02  1.15057131e-02]
 [-8.38784301e-02  1.57866170e-01  1.16265588e-01]
 [ 1.41686932e-01 -5.30866719e-02  3.00430120e-02]
 [ 5.32487207e-02  3.40462127e-02  7.72512421e-02]
 [ 7.48663591e-02 -2.10087690e-02  6.42517238e-02]
 [-1.74404964e-01  7.24808563e-02  7.38756336e-02]
 [ 4.49220775e-02 -2.89570395e-02 -6.72896442e-04]
 [-6.36938192e-02 -5.78203648e-02 -2.23673898e-01]
 [ 3.30077433e-02  9.68079365e-03 -4.01329798e-02]
 [ 1.01330674e-02  1.86580272e-01  2.26236767e-02]
 [ 3.45751380e-02 -1.19895560e-01 -7.01722859e-02]
 [ 1.68448084e-01 -1.90573229e-01 -1.32820995e-01]
 [-3.63777504e-02 -7.56489374e-02  1.14040036e-02]
 [-1.21324023e-01  3.66596567e-02  3.62770654e-02]
 [ 8.47165236e-02 -1.65012150e-01 -1.38726811e-01]
 [-2.11210098e-01 -3.64271527e-01  6.91752882e-02]
 [-4.33073362e-02 -2.57556255e-02  2.53319196e-02]
 [-3.74597005e-02  8.02928645e-02 -2.49683029e-02]
 [-4.10514637e-02  3.98107043e-02  2.14272377e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.26023247 -29.25593426 -29.27334937]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  8.31486419  -9.25153874 -83.50871763]
init_Out:  [2.49911038]
Stock Position:  8.31486419409362
Bond position:  [-828.98730903]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [9.40859123]
curr_Stock_Price:  100.8434426073634
curr_Factors:  [100.84344261  -1.27991867  -0.98292771]
mat_Sqrt:  [[10.49315211  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00851991  0.08410509  0.10930646]
Stock Position:  -0.008519911773173862
Bond Position:  [10.26776846]


portfolio before change:  [9.40547592]
curr_Stock_Price:  101.35974620206333
curr_Factors:  [101.3597462   -1.42082096  -0.97597395]
mat_Sqrt:  [[ 9.22466731  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01867535  0.04921484 -0.02918302]
Stock Position:  0.0186753518184953
Bond Position:  [7.512547]


portfolio before change:  [9.42151874]
curr_Stock_Price:  102.16849659829448
curr_Factors:  [102.1684966   -1.49362346  -0.99011268]
mat_Sqrt:  [[ 8.524013    0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01182413 0.06225063 0.10929099]
Stock Position:  0.011824129728402364
Bond Position:  [8.21346518]


portfolio before change:  [9.41919966]
curr_Stock_Price:  101.88553046851737
curr_Factors:  [101.88553047  -1.62017024  -0.99756402]
mat_Sqrt:  [[ 7.43438364  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.03021127 -0.00541971 -0.09577341]
Stock Position:  0.030211273800183687
Bond Position:  [6.341108]


portfolio before change:  [9.41218668]
curr_Stock_Price:  101.6271611813535
curr_Factors:  [101.62716118  -1.76660787  -1.00697855]
mat_Sqrt:  [[ 6.3453637   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00900948  0.01055365 -0.20126431]
Stock Position:  0.0090094801629782
Bond Position:  [8.49657879]


portfolio before change:  [9.4153788]
curr_Stock_Price:  101.86357650934447
curr_Factors:  [101.86357651  -1.60423996  -1.01244618]
mat_Sqrt:  [[ 7.44057624  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00509746  0.01766153 -0.28441765]
Stock Position:  -0.005097456762660652
Bond Position:  [9.93462398]


portfolio before change:  [9.41736631]
curr_Stock_Price:  101.71730742983343
curr_Factors:  [101.71730743  -1.55317026  -1.02474006]
mat_Sqrt:  [[ 7.72365076  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00896054 0.02359517 0.21908387]
Stock Position:  0.008960539728281324
Bond Position:  [8.50592433]


portfolio before change:  [9.41490413]
curr_Stock_Price:  101.32386239695042
curr_Factors:  [101.3238624   -1.31179677  -1.01901356]
mat_Sqrt:  [[ 9.85039552  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01205419 -0.01434964  0.31612489]
Stock Position:  -0.012054189797365753
Bond Position:  [10.6362812]


portfolio before change:  [9.42155542]
curr_Stock_Price:  100.88238337789346
curr_Factors:  [100.88238338  -1.22928334  -1.02090455]
mat_Sqrt:  [[10.63092735  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00377046  0.06352144  0.1763346 ]
Stock Position:  -0.0037704556952420157
Bond Position:  [9.80192798]


portfolio before change:  [9.42138409]
curr_Stock_Price:  101.25280326340422
curr_Factors:  [101.25280326  -1.36016566  -1.04297254]
mat_Sqrt:  [[ 9.15666647  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0043973   0.01642426 -0.21659852]
Stock Position:  0.004397303631741114
Bond Position:  [8.97614477]


portfolio before change:  [9.42167645]
curr_Stock_Price:  101.06411223829865
curr_Factors:  [101.06411224  -1.39809585  -1.02397089]
mat_Sqrt:  [[ 8.96823014  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00371094  0.02479635 -0.00573823]
Stock Position:  -0.003710936452457649
Bond Position:  [9.79671894]


portfolio before change:  [9.42330288]
curr_Stock_Price:  100.9558478938691
curr_Factors:  [100.95584789  -1.00939862  -1.02663806]
mat_Sqrt:  [[13.17928912  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00769635 -0.00166125 -0.16195213]
Stock Position:  -0.007696348424605695
Bond Position:  [10.20029426]


portfolio before change:  [9.42185264]
curr_Stock_Price:  101.30995701512803
curr_Factors:  [101.30995702  -1.34862679  -1.04069783]
mat_Sqrt:  [[ 9.28927101  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00834895 0.02610723 0.49983484]
Stock Position:  0.008348952453577826
Bond Position:  [8.57602063]


portfolio before change:  [9.42485345]
curr_Stock_Price:  101.5409726159184
curr_Factors:  [101.54097262  -1.24604852  -1.02939306]
mat_Sqrt:  [[10.43348986  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.02418962 0.10473216 0.26134088]
Stock Position:  0.024189623393436343
Bond Position:  [6.96861557]


portfolio before change:  [9.41203682]
curr_Stock_Price:  100.97511995060401
curr_Factors:  [100.97511995  -1.34547048  -0.97138822]
mat_Sqrt:  [[ 9.95440787  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00958506 -0.01958445 -0.29412251]
Stock Position:  -0.009585059773327208
Bond Position:  [10.37988938]


portfolio before change:  [9.41409925]
curr_Stock_Price:  100.89532283846567
curr_Factors:  [100.89532284  -1.23178327  -0.99377732]
mat_Sqrt:  [[10.89738649  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00800151 -0.01602623 -0.16811058]
Stock Position:  -0.008001509670434184
Bond Position:  [10.22141415]


portfolio before change:  [9.40974428]
curr_Stock_Price:  101.5992802999367
curr_Factors:  [101.5992803   -1.0935933   -0.98445661]
mat_Sqrt:  [[12.71759586  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00286746  0.00023722  0.12224089]
Stock Position:  -0.00286745994736811
Bond Position:  [9.70107615]


portfolio before change:  [9.41172039]
curr_Stock_Price:  101.33305256697491
curr_Factors:  [101.33305257  -1.00846294  -0.95257224]
mat_Sqrt:  [[14.25884574  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00416691 0.02154134 0.15435185]
Stock Position:  0.0041669134099824034
Bond Position:  [8.98947433]


portfolio before change:  [9.4165972]
curr_Stock_Price:  102.23373278621023
curr_Factors:  [102.23373279  -1.03128301  -0.95418823]
mat_Sqrt:  [[14.03831595  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.02159537 -0.03070421 -0.17548685]
Stock Position:  0.021595371552671803
Bond Position:  [7.20882176]


portfolio before change:  [9.44261342]
curr_Stock_Price:  103.39671627509613
curr_Factors:  [103.39671628  -1.23113431  -0.91946297]
mat_Sqrt:  [[12.03688781  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00381556 0.00245083 0.22373403]
Stock Position:  0.0038155605819134328
Bond Position:  [9.04809699]


portfolio before change:  [9.44635621]
curr_Stock_Price:  104.08120407477888
curr_Factors:  [104.08120407  -1.38780572  -0.93334726]
mat_Sqrt:  [[10.21664667  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00136517 -0.00433214  0.0328226 ]
Stock Position:  0.001365171430876541
Bond Position:  [9.30426752]


portfolio before change:  [9.44802479]
curr_Stock_Price:  104.4514726617115
curr_Factors:  [104.45147266  -1.62526679  -0.91743719]
mat_Sqrt:  [[ 8.21546712  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0068249   0.04992167  0.33167336]
Stock Position:  -0.006824898512577674
Bond Position:  [10.16089549]


portfolio before change:  [9.45284269]
curr_Stock_Price:  103.93165476894332
curr_Factors:  [103.93165477  -1.29347782  -0.90056324]
mat_Sqrt:  [[11.58478333  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01264147 -0.01678748  0.08570435]
Stock Position:  0.012641474573908967
Bond Position:  [8.13899332]


portfolio before change:  [9.45506166]
curr_Stock_Price:  104.02670169706332
curr_Factors:  [104.0267017   -1.19810025  -0.87351514]
mat_Sqrt:  [[13.10550308  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00533338 0.01076636 0.22037629]
Stock Position:  0.005333380446796557
Bond Position:  [8.90024768]


portfolio before change:  [9.44985041]
curr_Stock_Price:  102.84098936433281
curr_Factors:  [102.84098936  -1.22281729  -0.83849369]
mat_Sqrt:  [[13.09032006  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00667969 -0.00664356  0.18329228]
Stock Position:  0.006679687189169995
Bond Position:  [8.76290477]


portfolio before change:  [9.44910861]
curr_Stock_Price:  102.56594212012105
curr_Factors:  [102.56594212  -1.03588933  -0.83652833]
mat_Sqrt:  [[15.76966684  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00998459  0.02292046  0.21074662]
Stock Position:  -0.009984593672035915
Bond Position:  [10.47318787]


portfolio before change:  [9.44362919]
curr_Stock_Price:  103.24585444464446
curr_Factors:  [103.24585444  -1.45351945  -0.83228242]
mat_Sqrt:  [[10.49932753  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00419427 -0.00915702 -0.00191959]
Stock Position:  0.004194273913306515
Bond Position:  [9.0105878]


portfolio before change:  [9.44356348]
curr_Stock_Price:  102.96163205319776
curr_Factors:  [102.96163205  -1.3100429   -0.80479781]
mat_Sqrt:  [[12.42257892  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00892278 -0.0182844  -0.63807937]
Stock Position:  -0.00892278314820826
Bond Position:  [10.36226779]


portfolio before change:  [9.44692038]
curr_Stock_Price:  102.73059039786345
curr_Factors:  [102.7305904   -1.3005795   -0.80241733]
mat_Sqrt:  [[12.54237732  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00199847  0.00306134 -0.11448822]
Stock Position:  0.0019984720193303167
Bond Position:  [9.24161617]


portfolio before change:  [9.44882749]
curr_Stock_Price:  103.10679539230843
curr_Factors:  [103.10679539  -1.33860135  -0.81572731]
mat_Sqrt:  [[11.95843206  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00163638 0.05900186 0.06453905]
Stock Position:  0.0016363840905208682
Bond Position:  [9.28010517]


portfolio before change:  [9.45232176]
curr_Stock_Price:  104.53322451946448
curr_Factors:  [104.53322452  -1.34849319  -0.83954179]
mat_Sqrt:  [[11.72203002  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00146353 -0.03791431 -0.200182  ]
Stock Position:  0.0014635340485796644
Bond Position:  [9.29933382]


portfolio before change:  [9.45239913]
curr_Stock_Price:  103.79178789532862
curr_Factors:  [103.7917879   -1.42296509  -0.84312092]
mat_Sqrt:  [[10.76500765  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01267213 -0.06026455 -0.37890133]
Stock Position:  0.012672125944039575
Bond Position:  [8.13713652]


portfolio before change:  [9.45179402]
curr_Stock_Price:  103.6637652511316
curr_Factors:  [103.66376525  -1.28197938  -0.82569838]
mat_Sqrt:  [[12.59720399  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00285803 -0.02392229  0.03253245]
Stock Position:  -0.00285802826453971
Bond Position:  [9.74806799]


portfolio before change:  [9.45402031]
curr_Stock_Price:  103.3111771177194
curr_Factors:  [103.31117712  -1.4017652   -0.79241473]
mat_Sqrt:  [[11.51402248  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00981173  0.0115928   0.10348837]
Stock Position:  -0.009811727378677271
Bond Position:  [10.46768141]


portfolio before change:  [9.45347816]
curr_Stock_Price:  103.49979777886178
curr_Factors:  [103.49979778  -1.47125618  -0.78342583]
mat_Sqrt:  [[10.85784266  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00480191 -0.05218142 -0.39574898]
Stock Position:  0.0048019149034008056
Bond Position:  [8.95648093]


portfolio before change:  [9.45633656]
curr_Stock_Price:  103.86189761448202
curr_Factors:  [103.86189761  -1.53050757  -0.80050344]
mat_Sqrt:  [[10.09510955  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02045497 -0.11519277  0.19733784]
Stock Position:  -0.020454973859382188
Bond Position:  [11.58082896]


portfolio before change:  [9.4412143]
curr_Stock_Price:  104.67196722258903
curr_Factors:  [104.67196722  -1.38618798  -0.79460709]
mat_Sqrt:  [[11.82287565  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0032819  -0.00814464  0.07226492]
Stock Position:  -0.003281899285493135
Bond Position:  [9.78473715]


portfolio before change:  [9.44361204]
curr_Stock_Price:  104.31407251405014
curr_Factors:  [104.31407251  -1.42897584  -0.78732867]
mat_Sqrt:  [[11.37140384  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00356009  0.02539083 -0.07122762]
Stock Position:  -0.003560086483687475
Bond Position:  [9.81497916]


portfolio before change:  [9.44679789]
curr_Stock_Price:  103.76383301899673
curr_Factors:  [103.76383302  -1.08344547  -0.81017491]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [9.44679789]
Stock Price:  103.1289295829055
PL:  [6.31786831]
Settle:  Tensor("sub_12:0", shape=(), dtype=float64)
PL:  Tensor("sub_13:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  7
output_Z_Vals[:, i, :]:  [[ 1.19260232e+02 -2.92559343e+01 -2.92733494e+01]
 [ 4.58164578e-02  2.85383578e-02 -8.17991330e-02]
 [-6.72269136e-02 -1.78238346e-02  9.20052715e-02]
 [-1.22617770e-02  1.17595982e-01  1.99071520e-02]
 [ 1.07228290e-01  7.59233009e-03 -6.72402955e-02]
 [ 5.51487479e-02  3.07496341e-02  2.80162039e-02]
 [-9.40854127e-03  6.04426435e-02 -7.43908676e-02]
 [ 1.34097638e-01  8.06084255e-02  1.12167675e-01]
 [-4.54568170e-02  1.61752200e-02  7.35016418e-02]
 [-3.69098823e-02  2.48912811e-01  9.40889971e-02]
 [ 1.29543193e-03 -2.14681263e-01  2.21487387e-03]
 [-1.12183206e-01  1.19941133e-01  4.56849666e-02]
 [-4.94340463e-02 -8.86024771e-02 -5.66118604e-02]
 [ 3.13599379e-01  2.42010995e-01  3.28792933e-01]
 [ 1.42793498e-01  1.47921052e-01 -1.00678083e-02]
 [-5.45011797e-02 -5.24916118e-02 -1.16448798e-01]
 [-9.03578098e-02  3.08315989e-02 -1.02992266e-01]
 [ 1.30337731e-01 -1.75495857e-01 -1.58550882e-01]
 [ 2.57131205e-02  6.48377854e-02  2.67566324e-02]
 [ 2.25316596e-01 -1.95317537e-01 -3.52367078e-02]
 [ 1.30808360e-01 -3.01018998e-03  2.04183603e-01]
 [ 2.34615999e-03 -7.06494235e-03  2.14812994e-03]
 [-8.08296377e-02  1.54619571e-01  8.18504472e-02]
 [ 7.97576294e-02 -1.42376165e-01  7.82731829e-02]
 [ 5.33054499e-02  3.42063290e-02  7.69982126e-02]
 [ 1.02489870e-01  2.23537961e-03  5.62830946e-02]
 [-1.26708956e-01  7.69283932e-02  8.11336619e-02]
 [ 4.94556478e-02 -6.95908875e-02 -2.20049044e-02]
 [ 2.59944125e-03 -6.73646912e-02 -2.28093516e-01]
 [ 1.18616756e-02 -3.73689529e-02  6.06563438e-03]
 [-3.80878755e-02  3.41136807e-01  8.63968382e-03]
 [ 3.63519843e-02 -1.12560358e-01 -4.05115957e-02]
 [-1.17336294e-02 -3.04233260e-04  7.71834518e-02]
 [-9.07375825e-02 -5.31729636e-02  2.79446275e-02]
 [-1.26444595e-01  5.19323718e-02  3.60373167e-02]
 [ 8.47165236e-02 -1.65012150e-01 -1.38726811e-01]
 [-2.18078413e-01 -3.72806760e-01  7.12596245e-02]
 [-5.05219634e-02 -4.44046332e-02  6.00338541e-02]
 [-2.73622881e-02  5.91174290e-02 -3.13039718e-02]
 [ 1.45408687e-01 -8.02154583e-03 -1.39024138e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.26023247 -29.25593426 -29.27334937]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  8.31486419  -9.25153874 -83.50871763]
init_Out:  [2.49911038]
Stock Position:  8.31486419409362
Bond position:  [-828.98730903]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-3.39856749]
curr_Stock_Price:  99.30316986025566
curr_Factors:  [99.30316986 -0.95270773 -0.99850211]
mat_Sqrt:  [[14.11118368  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00211578  0.00902462 -0.23335016]
Stock Position:  0.002115778353051767
Bond Position:  [-3.60867099]


portfolio before change:  [-3.40013382]
curr_Stock_Price:  98.77607468411581
curr_Factors:  [98.77607468 -0.59434341 -0.97869484]
mat_Sqrt:  [[20.48754566  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00238714 -0.00563639  0.26246543]
Stock Position:  -0.002387139311390079
Bond Position:  [-3.16434157]


portfolio before change:  [-3.4028618]
curr_Stock_Price:  99.75314832297897
curr_Factors:  [99.75314832 -0.66085597 -0.96742373]
mat_Sqrt:  [[19.57824347  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00026366  0.03718711  0.05678956]
Stock Position:  -0.00026365651503055496
Bond Position:  [-3.37656123]


portfolio before change:  [-3.40328446]
curr_Stock_Price:  99.75528647922187
curr_Factors:  [99.75528648 -0.44363423 -0.95189119]
mat_Sqrt:  [[24.70966934  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.003792    0.00240091 -0.19181785]
Stock Position:  0.0037919955305026408
Bond Position:  [-3.78155606]


portfolio before change:  [-3.3994046]
curr_Stock_Price:  100.90312002759967
curr_Factors:  [100.90312003  -0.84286851  -0.96012926]
mat_Sqrt:  [[16.62924818  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00370801 0.00972389 0.07992243]
Stock Position:  0.003708013922301018
Bond Position:  [-3.77355477]


portfolio before change:  [-3.39681919]
curr_Stock_Price:  101.72758786250411
curr_Factors:  [101.72758786  -1.29992633  -0.95782363]
mat_Sqrt:  [[10.63923495  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0021649   0.01911364 -0.21221644]
Stock Position:  -0.002164901075507568
Bond Position:  [-3.17658902]


portfolio before change:  [-3.39836097]
curr_Stock_Price:  102.25633644617069
curr_Factors:  [102.25633645  -1.24380972  -0.94183849]
mat_Sqrt:  [[11.49410793  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01383971 0.02549062 0.31998316]
Stock Position:  0.013839705525625894
Bond Position:  [-4.81355856]


portfolio before change:  [-3.38381216]
curr_Stock_Price:  103.35105262228929
curr_Factors:  [103.35105262  -1.25082325  -0.9154505 ]
mat_Sqrt:  [[11.84443007  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00253585  0.00511505  0.20967973]
Stock Position:  -0.0025358514214188685
Bond Position:  [-3.12172924]


portfolio before change:  [-3.3851934]
curr_Stock_Price:  103.74185092977908
curr_Factors:  [103.74185093  -1.12020468  -0.92920703]
mat_Sqrt:  [[13.36305629  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0008439   0.07871314  0.26840972]
Stock Position:  -0.0008439046290609093
Bond Position:  [-3.29764517]


portfolio before change:  [-3.38589284]
curr_Stock_Price:  104.08217871394179
curr_Factors:  [104.08217871  -0.92224297  -0.95254388]
mat_Sqrt:  [[15.9649217   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00023774 -0.06788818  0.00631842]
Stock Position:  -0.0002377402953923518
Bond Position:  [-3.36114831]


portfolio before change:  [-3.38623277]
curr_Stock_Price:  103.74468420108919
curr_Factors:  [103.7446842   -0.97781877  -0.93659586]
mat_Sqrt:  [[15.29488257  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0065225   0.03792872  0.13032649]
Stock Position:  -0.006522504124321361
Bond Position:  [-2.70955764]


portfolio before change:  [-3.38699748]
curr_Stock_Price:  103.80999476848253
curr_Factors:  [103.80999477  -1.04617978  -0.91721068]
mat_Sqrt:  [[14.57301888  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00434211 -0.02801856 -0.16149788]
Stock Position:  -0.004342106502186633
Bond Position:  [-2.93624342]


portfolio before change:  [-3.38506432]
curr_Stock_Price:  103.28025053820342
curr_Factors:  [103.28025054  -1.18370265  -0.92723308]
mat_Sqrt:  [[12.50977629  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.03093282 0.0765306  0.93795472]
Stock Position:  0.030932819522235196
Bond Position:  [-6.57981367]


portfolio before change:  [-3.34844302]
curr_Stock_Price:  104.49073942639359
curr_Factors:  [104.49073943  -1.22962568  -0.95377427]
mat_Sqrt:  [[11.77170183  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0122801   0.04677674 -0.02872065]
Stock Position:  0.012280103808039329
Bond Position:  [-4.63160014]


portfolio before change:  [-3.3536764]
curr_Stock_Price:  104.11172045157264
curr_Factors:  [104.11172045  -1.30579507  -0.94033885]
mat_Sqrt:  [[11.01580035  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00722839 -0.01659931 -0.33219601]
Stock Position:  -0.007228391597958032
Bond Position:  [-2.60111611]


portfolio before change:  [-3.35917884]
curr_Stock_Price:  104.82796344868532
curr_Factors:  [104.82796345  -1.29707201  -0.9310554 ]
mat_Sqrt:  [[11.2931139   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00979225  0.00974981 -0.29380827]
Stock Position:  -0.009792246026165826
Bond Position:  [-2.33267763]


portfolio before change:  [-3.36463783]
curr_Stock_Price:  105.35566524951598
curr_Factors:  [105.35566525  -1.75659843  -0.95508206]
mat_Sqrt:  [[ 6.99825911  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01335223 -0.05549666 -0.45230153]
Stock Position:  0.013352232706768134
Bond Position:  [-4.77137119]


portfolio before change:  [-3.36691461]
curr_Stock_Price:  105.22981975712186
curr_Factors:  [105.22981976  -1.85604493  -0.96267818]
mat_Sqrt:  [[ 6.28033681  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00523044 0.02050351 0.07632922]
Stock Position:  0.00523043599006233
Bond Position:  [-3.91731244]


portfolio before change:  [-3.36868181]
curr_Stock_Price:  104.98557446034111
curr_Factors:  [104.98557446  -1.68988092  -0.98660206]
mat_Sqrt:  [[ 7.22350272  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.02949827 -0.06176483 -0.10052052]
Stock Position:  0.029498273157530886
Bond Position:  [-6.46557496]


portfolio before change:  [-3.36403845]
curr_Stock_Price:  105.1703855135508
curr_Factors:  [105.17038551  -1.45655272  -0.97998273]
mat_Sqrt:  [[ 9.19855408  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0187431  -0.00095191  0.58247899]
Stock Position:  0.01874310238295238
Bond Position:  [-5.33525775]


portfolio before change:  [-3.37276945]
curr_Stock_Price:  104.74014477134747
curr_Factors:  [104.74014477  -1.46972957  -0.98108144]
mat_Sqrt:  [[ 9.03107553  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00028814 -0.00223413  0.00612802]
Stock Position:  0.0002881416663874774
Bond Position:  [-3.40294945]


portfolio before change:  [-3.37320792]
curr_Stock_Price:  104.69476091492744
curr_Factors:  [104.69476091  -1.74535901  -0.96925435]
mat_Sqrt:  [[ 6.93399221  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00867173  0.048895    0.23349654]
Stock Position:  -0.008671732415054863
Bond Position:  [-2.46532297]


portfolio before change:  [-3.37283178]
curr_Stock_Price:  104.61584726392267
curr_Factors:  [104.61584726  -2.01001598  -0.96737108]
mat_Sqrt:  [[ 5.32763801  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0172795 -0.0450233  0.2232916]
Stock Position:  0.01727950340981771
Bond Position:  [-5.18054167]


portfolio before change:  [-3.37248554]
curr_Stock_Price:  104.67336336426132
curr_Factors:  [104.67336336  -2.11811109  -0.94471559]
mat_Sqrt:  [[ 4.89403929  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01428388 0.01081699 0.21965447]
Stock Position:  0.014283875497624469
Bond Position:  [-4.86762683]


portfolio before change:  [-3.37464256]
curr_Stock_Price:  104.56495258417316
curr_Factors:  [104.56495258  -1.85591821  -0.94506919]
mat_Sqrt:  [[ 6.35232594  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.0179519  0.00070689 0.16056   ]
Stock Position:  0.017951900966762503
Bond Position:  [-5.25178223]


portfolio before change:  [-3.37545534]
curr_Stock_Price:  104.55624798475984
curr_Factors:  [104.55624798  -1.94445331  -0.91097039]
mat_Sqrt:  [[ 6.01527151  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01798112  0.02432689  0.23145175]
Stock Position:  -0.01798112253502059
Bond Position:  [-1.49541663]


portfolio before change:  [-3.3717518]
curr_Stock_Price:  104.33988360394497
curr_Factors:  [104.3398836   -1.69371391  -0.8950443 ]
mat_Sqrt:  [[ 7.83730845  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0055079  -0.02200657 -0.06277387]
Stock Position:  0.005507896848060319
Bond Position:  [-3.94644512]


portfolio before change:  [-3.37281697]
curr_Stock_Price:  104.23606357524326
curr_Factors:  [104.23606358  -1.3380742   -0.89388544]
mat_Sqrt:  [[11.18639741  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00408526 -0.02130259 -0.65068731]
Stock Position:  -0.004085256399914851
Bond Position:  [-2.94698592]


portfolio before change:  [-3.37691953]
curr_Stock_Price:  105.15012318987122
curr_Factors:  [105.15012319  -1.2273465   -0.90294964]
mat_Sqrt:  [[12.49205613  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00097141 -0.0118171   0.01730357]
Stock Position:  0.000971413811486161
Bond Position:  [-3.47906382]


portfolio before change:  [-3.37788946]
curr_Stock_Price:  104.59936134439482
curr_Factors:  [104.59936134  -1.11043661  -0.88430416]
mat_Sqrt:  [[14.2306298   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00193359  0.10787693  0.02464661]
Stock Position:  -0.001933589263431214
Bond Position:  [-3.17563726]


portfolio before change:  [-3.37901981]
curr_Stock_Price:  104.97863760251174
curr_Factors:  [104.9786376   -0.9557217   -0.88694819]
mat_Sqrt:  [[16.62798274  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00151409 -0.03559471 -0.11556831]
Stock Position:  0.0015140918724005912
Bond Position:  [-3.53796711]


portfolio before change:  [-3.38010373]
curr_Stock_Price:  104.55485358649638
curr_Factors:  [104.55485359  -0.90139374  -0.84968617]
mat_Sqrt:  [[18.14929916  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 2.21139198e-04 -9.62070042e-05  2.20182904e-01]
Stock Position:  0.000221139198334352
Bond Position:  [-3.4032249]


portfolio before change:  [-3.38032645]
curr_Stock_Price:  105.47151851917052
curr_Factors:  [105.47151852  -0.94890089  -0.85189353]
mat_Sqrt:  [[17.42048     0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00496004 -0.01681477  0.07971824]
Stock Position:  -0.004960042966476994
Bond Position:  [-2.85718318]


portfolio before change:  [-3.37992629]
curr_Stock_Price:  105.31883317512185
curr_Factors:  [105.31883318  -0.97880442  -0.83770926]
mat_Sqrt:  [[17.12395866  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00687619  0.01642246  0.10280443]
Stock Position:  -0.006876191589210231
Bond Position:  [-2.65573382]


portfolio before change:  [-3.38496621]
curr_Stock_Price:  106.00350454790464
curr_Factors:  [106.00350455  -0.94452767  -0.85375065]
mat_Sqrt:  [[17.55245506  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00297044 -0.05218142 -0.39574898]
Stock Position:  0.002970435549118765
Bond Position:  [-3.69984279]


portfolio before change:  [-3.38688575]
curr_Stock_Price:  105.5129929501656
curr_Factors:  [105.51299295  -0.92701494  -0.84546523]
mat_Sqrt:  [[17.92782434  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01188981 -0.11789185  0.20328387]
Stock Position:  -0.01188981037990645
Bond Position:  [-2.13235627]


portfolio before change:  [-3.39643331]
curr_Stock_Price:  106.29357717681023
curr_Factors:  [106.29357718  -1.12616682  -0.84357   ]
mat_Sqrt:  [[14.82726989  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00265822 -0.01404198  0.17125988]
Stock Position:  -0.0026582187555733183
Bond Position:  [-3.11388173]


portfolio before change:  [-3.39831204]
curr_Stock_Price:  106.85390406605634
curr_Factors:  [106.85390407  -1.1134723   -0.82978003]
mat_Sqrt:  [[15.30546865  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00210551  0.01869457 -0.08930152]
Stock Position:  -0.0021055075050151976
Bond Position:  [-3.17333035]


portfolio before change:  [-3.39730372]
curr_Stock_Price:  106.18660177859049
curr_Factors:  [106.18660178  -1.10224529  -0.83805168]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-3.39730372]
Stock Price:  105.24316818216869
PL:  [-8.64047191]
Settle:  Tensor("sub_14:0", shape=(), dtype=float64)
PL:  Tensor("sub_15:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  8
output_Z_Vals[:, i, :]:  [[ 1.19260232e+02 -2.92559343e+01 -2.92733494e+01]
 [ 4.54105123e-02  3.21725848e-02 -7.99042595e-02]
 [-3.87412018e-02  3.55141525e-02  1.08538141e-01]
 [-5.63280797e-02  1.12449129e-01  1.15861292e-02]
 [ 1.56705726e-02  3.77835360e-02 -7.16733288e-02]
 [ 6.00357432e-02  2.87326630e-02  2.77162459e-02]
 [ 5.59158491e-02  2.51372692e-02 -6.10369836e-02]
 [-4.41409525e-02  2.90186941e-01  5.76614115e-02]
 [ 2.08498553e-02  3.60117144e-02 -4.13940844e-02]
 [-4.08654973e-02  4.17290550e-01  1.83809845e-01]
 [ 5.99412259e-02  1.39764250e-01 -8.69682394e-02]
 [-9.85808473e-02 -1.04730279e-01  4.75025014e-03]
 [-1.00112868e-01  2.46826591e-02 -1.09743781e-02]
 [-9.90331749e-02 -1.15840887e-01  6.12524183e-02]
 [ 1.62786080e-01  2.90607973e-01  1.26482077e-01]
 [-7.79350083e-02 -4.12761862e-01 -6.77538885e-02]
 [-6.69366611e-02 -3.90762856e-02 -4.88332708e-02]
 [-9.48726685e-02 -1.11963569e-02  8.57190414e-02]
 [ 7.80888864e-02  5.35648317e-02  6.88267496e-02]
 [ 2.13122804e-01 -4.93944966e-02 -1.84598846e-02]
 [-4.70073252e-02 -9.73693029e-04 -4.10280579e-03]
 [ 7.10306087e-02 -5.45004141e-02  6.90533075e-02]
 [-5.70013503e-02  2.95887059e-02  2.70020070e-01]
 [ 4.70330960e-02 -2.07147671e-02 -6.74839064e-02]
 [ 4.22469632e-02  2.80447170e-02  1.13793510e-01]
 [ 3.30452096e-02 -6.88448637e-02  7.77540551e-02]
 [ 7.91307940e-02  4.51910988e-02 -6.82631048e-02]
 [-5.07806065e-02  7.36225950e-02  2.93687317e-02]
 [-1.16563461e-02 -8.04590615e-03  1.65107360e-01]
 [ 1.00098441e-01  1.25355026e-01 -1.76278988e-02]
 [ 3.20256616e-02  1.32708457e-01  1.33431358e-02]
 [ 5.18797593e-02 -1.08522620e-01 -7.51971160e-02]
 [ 2.91705279e-01 -1.28784168e-01  4.02282934e-02]
 [-4.22891077e-02 -7.79230599e-02  1.37178561e-02]
 [-2.12118223e-01  1.44561723e-01  1.71430375e-02]
 [ 2.20991086e-01  2.75511435e-02  1.20819348e-02]
 [ 2.51599562e-02  1.76890404e-02 -1.02989139e-01]
 [-9.17393766e-03  5.21042425e-02 -2.66278785e-02]
 [ 1.84733452e-01 -2.51339533e-01 -5.01221098e-02]
 [-7.35158630e-01  3.71647119e-01  4.44583800e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.26023247 -29.25593426 -29.27334937]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  8.31486419  -9.25153874 -83.50871763]
init_Out:  [2.49911038]
Stock Position:  8.31486419409362
Bond position:  [-828.98730903]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-2.60054423]
curr_Stock_Price:  99.3991453613276
curr_Factors:  [99.39914536 -1.01048071 -1.00228341]
mat_Sqrt:  [[13.28159708  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00225356  0.01017386 -0.22794461]
Stock Position:  0.0022535555042433237
Bond Position:  [-2.82454572]


portfolio before change:  [-2.60095121]
curr_Stock_Price:  99.37523353335261
curr_Factors:  [99.37523353 -0.92349584 -0.98927628]
mat_Sqrt:  [[14.67478625  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00106775  0.01123056  0.3096291 ]
Stock Position:  -0.001067748099764475
Bond Position:  [-2.49484349]


portfolio before change:  [-2.6010959]
curr_Stock_Price:  99.2186562346364
curr_Factors:  [99.21865623 -0.81068912 -0.98270866]
mat_Sqrt:  [[16.50937313  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00309277  0.03555954  0.033052  ]
Stock Position:  -0.003092767156253005
Bond Position:  [-2.2942357]


portfolio before change:  [-2.59964579]
curr_Stock_Price:  98.65705361366925
curr_Factors:  [98.65705361 -0.69582445 -1.00961192]
mat_Sqrt:  [[17.92530431  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 1.12460148e-04  1.19482032e-02 -2.04464057e-01]
Stock Position:  0.00011246014833273787
Bond Position:  [-2.61074078]


portfolio before change:  [-2.60004525]
curr_Stock_Price:  98.00703028977972
curr_Factors:  [98.00703029 -0.70469802 -1.01172893]
mat_Sqrt:  [[17.61255956  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00377203 0.00908607 0.07906673]
Stock Position:  0.0037720339343496776
Bond Position:  [-2.9697311]


portfolio before change:  [-2.59788166]
curr_Stock_Price:  98.67903666903939
curr_Factors:  [98.67903667 -0.69460366 -1.04512014]
mat_Sqrt:  [[17.32496848  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00254579  0.0079491  -0.17412152]
Stock Position:  0.002545792132621507
Bond Position:  [-2.84909798]


portfolio before change:  [-2.59164455]
curr_Stock_Price:  101.26890590635016
curr_Factors:  [101.26890591  -0.60482481  -1.05652021]
mat_Sqrt:  [[19.22928537  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00129377  0.09176517  0.16449196]
Stock Position:  -0.0012937699471679788
Bond Position:  [-2.46062589]


portfolio before change:  [-2.59246215]
curr_Stock_Price:  101.66310279966243
curr_Factors:  [101.6631028   -0.78692861  -1.06400244]
mat_Sqrt:  [[15.97034199  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00083468  0.0113879  -0.1180858 ]
Stock Position:  0.0008346810399138758
Bond Position:  [-2.67731841]


portfolio before change:  [-2.59312725]
curr_Stock_Price:  101.26724466352942
curr_Factors:  [101.26724466  -0.62388258  -1.05921683]
mat_Sqrt:  [[18.81517247  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [3.94836984e-04 1.31958858e-01 5.24358326e-01]
Stock Position:  0.00039483698381710046
Bond Position:  [-2.6331113]


portfolio before change:  [-2.59411142]
curr_Stock_Price:  99.60830218916023
curr_Factors:  [99.60830219 -0.40940251 -1.02805524]
mat_Sqrt:  [[23.66004505  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00193565  0.04419734 -0.24809618]
Stock Position:  0.0019356516746341715
Bond Position:  [-2.7869184]


portfolio before change:  [-2.59601299]
curr_Stock_Price:  98.80589762302759
curr_Factors:  [98.80589762 -0.53557363 -1.02134168]
mat_Sqrt:  [[20.8268286   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00481664 -0.03311862  0.01355114]
Stock Position:  -0.004816639758842032
Bond Position:  [-2.12010057]


portfolio before change:  [-2.59813588]
curr_Stock_Price:  99.19161520636764
curr_Factors:  [99.19161521 -0.48088705 -1.00582947]
mat_Sqrt:  [[22.42860072  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00453509  0.00780534 -0.03130685]
Stock Position:  -0.004535089003435045
Bond Position:  [-2.14829307]


portfolio before change:  [-2.58783107]
curr_Stock_Price:  96.86015963455435
curr_Factors:  [96.86015963 -0.47171802 -0.99947851]
mat_Sqrt:  [[22.24398771  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00402451 -0.0366321   0.1747361 ]
Stock Position:  -0.0040245066362934526
Bond Position:  [-2.19801672]


portfolio before change:  [-2.58556828]
curr_Stock_Price:  96.22963212527125
curr_Factors:  [96.22963213 -0.56512292 -0.99831443]
mat_Sqrt:  [[20.1519284   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00973146 0.09189831 0.36081816]
Stock Position:  0.009731455347821279
Bond Position:  [-3.52202265]


portfolio before change:  [-2.56822537]
curr_Stock_Price:  98.05702443751146
curr_Factors:  [98.05702444 -0.20933842 -1.01037799]
mat_Sqrt:  [[28.95760282  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00353699 -0.13052676 -0.19328298]
Stock Position:  -0.003536987469617957
Bond Position:  [-2.22139891]


portfolio before change:  [-2.56904846]
curr_Stock_Price:  98.21122082319832
curr_Factors:  [98.21122082 -0.29331904 -1.00166452]
mat_Sqrt:  [[26.90028567  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00289639 -0.01235701 -0.13930773]
Stock Position:  -0.002896387685062751
Bond Position:  [-2.28459069]


portfolio before change:  [-2.57539651]
curr_Stock_Price:  100.30433359205351
curr_Factors:  [100.30433359  -0.50978743  -1.04571218]
mat_Sqrt:  [[21.17262961  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00366815 -0.0035406   0.24453257]
Stock Position:  -0.0036681523532684835
Bond Position:  [-2.20746494]


portfolio before change:  [-2.57489045]
curr_Stock_Price:  100.09114323104362
curr_Factors:  [100.09114323  -0.55641896  -1.0763432 ]
mat_Sqrt:  [[19.55672167  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00478205 0.01693869 0.19634356]
Stock Position:  0.004782045140116276
Bond Position:  [-3.05353081]


portfolio before change:  [-2.57164469]
curr_Stock_Price:  100.84970445300173
curr_Factors:  [100.84970445  -0.51416031  -1.10475426]
mat_Sqrt:  [[19.97970021  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01041454 -0.01561991 -0.05266091]
Stock Position:  0.01041453742405845
Bond Position:  [-3.62194771]


portfolio before change:  [-2.57436595]
curr_Stock_Price:  100.63188466741288
curr_Factors:  [100.63188467  -0.55721767  -1.11205598]
mat_Sqrt:  [[18.95742173  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00252513 -0.00030791 -0.01170416]
Stock Position:  -0.002525129644149606
Bond Position:  [-2.3202574]


portfolio before change:  [-2.57476708]
curr_Stock_Price:  100.67587368452223
curr_Factors:  [100.67587368  -0.58724369  -1.12595597]
mat_Sqrt:  [[18.15065268  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00461244 -0.01723454  0.19698987]
Stock Position:  0.004612443581333463
Bond Position:  [-3.03912887]


portfolio before change:  [-2.57869059]
curr_Stock_Price:  99.90760557644882
curr_Factors:  [99.90760558 -0.6265565  -1.15046888]
mat_Sqrt:  [[16.89842525  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-6.62639987e-05  9.35677038e-03  7.70292100e-01]
Stock Position:  -6.626399874159566e-05
Bond Position:  [-2.57207031]


portfolio before change:  [-2.57906252]
curr_Stock_Price:  100.66815519263423
curr_Factors:  [100.66815519  -0.44927134  -1.17516731]
mat_Sqrt:  [[19.83386575  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00164986 -0.00655058 -0.1925128 ]
Stock Position:  0.001649862347301421
Bond Position:  [-2.74515112]


portfolio before change:  [-2.57932902]
curr_Stock_Price:  100.71462241990245
curr_Factors:  [100.71462242  -0.25729671  -1.17820792]
mat_Sqrt:  [[23.9696      0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00276179 0.00886852 0.32462121]
Stock Position:  0.0027617931747507523
Bond Position:  [-2.85748197]


portfolio before change:  [-2.57981842]
curr_Stock_Price:  100.66675540622481
curr_Factors:  [100.66675541  -0.51812656  -1.15806928]
mat_Sqrt:  [[18.83317166  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00250298 -0.02177066  0.22181068]
Stock Position:  0.002502983767657328
Bond Position:  [-2.83178568]


portfolio before change:  [-2.58293783]
curr_Stock_Price:  99.56190857080739
curr_Factors:  [99.56190857 -0.45253736 -1.15142144]
mat_Sqrt:  [[20.02178335  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00331456  0.01429068 -0.19473564]
Stock Position:  0.0033145636481428597
Bond Position:  [-2.91294212]


portfolio before change:  [-2.57928825]
curr_Stock_Price:  100.77284560856697
curr_Factors:  [100.77284561  -0.41409788  -1.21494472]
mat_Sqrt:  [[19.76329317  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00216992  0.02328151  0.08378082]
Stock Position:  -0.002169922372528149
Bond Position:  [-2.36061899]


portfolio before change:  [-2.57564794]
curr_Stock_Price:  98.959230999376
curr_Factors:  [98.959231   -0.3333671  -1.18031168]
mat_Sqrt:  [[21.78080729  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00100264 -0.00254434  0.47100534]
Stock Position:  0.001002639976722218
Bond Position:  [-2.67486842]


portfolio before change:  [-2.57789295]
curr_Stock_Price:  97.05363063644924
curr_Factors:  [97.05363064 -0.52787889 -1.13575895]
mat_Sqrt:  [[18.38666879  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00542441  0.03964074 -0.05028749]
Stock Position:  0.005424409146654096
Bond Position:  [-3.10435155]


portfolio before change:  [-2.57205109]
curr_Stock_Price:  98.2021290220067
curr_Factors:  [98.20212902 -0.46714457 -1.16161992]
mat_Sqrt:  [[19.26448818  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00198167 0.0419661  0.03806425]
Stock Position:  0.0019816688136850076
Bond Position:  [-2.76665519]


portfolio before change:  [-2.57660702]
curr_Stock_Price:  96.0776207044911
curr_Factors:  [96.0776207  -0.31280361 -1.140292  ]
mat_Sqrt:  [[22.46729751  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00150121 -0.03431787 -0.21451644]
Stock Position:  0.0015012117187100528
Bond Position:  [-2.72083987]


portfolio before change:  [-2.57544357]
curr_Stock_Price:  97.07919358774889
curr_Factors:  [97.07919359 -0.34413655 -1.1326789 ]
mat_Sqrt:  [[22.1693705   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01337844 -0.04072513  0.11476012]
Stock Position:  0.01337844265933982
Bond Position:  [-3.874212]


portfolio before change:  [-2.57511284]
curr_Stock_Price:  97.14011554812454
curr_Factors:  [97.14011555 -0.19495976 -1.11730018]
mat_Sqrt:  [[26.15118453  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00158696 -0.02464144  0.03913323]
Stock Position:  -0.0015869616460457644
Bond Position:  [-2.4209552]


portfolio before change:  [-2.57658674]
curr_Stock_Price:  97.87817366997237
curr_Factors:  [97.87817367 -0.15553932 -1.13316218]
mat_Sqrt:  [[26.97800971  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00759457  0.04571443  0.04890431]
Stock Position:  -0.007594568666827839
Bond Position:  [-1.83324423]


portfolio before change:  [-2.55153241]
curr_Stock_Price:  94.54901793171533
curr_Factors:  [94.54901793 -0.35222823 -1.16546578]
mat_Sqrt:  [[20.72673474  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01081544 0.00871244 0.0344664 ]
Stock Position:  0.010815435775481956
Bond Position:  [-3.57412124]


portfolio before change:  [-2.55284594]
curr_Stock_Price:  94.46887918863288
curr_Factors:  [94.46887919 -0.28190612 -1.2210749 ]
mat_Sqrt:  [[21.01611319  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 2.18599659e-04  5.59376573e-03 -2.93799348e-01]
Stock Position:  0.0002185996593781997
Bond Position:  [-2.57349681]


portfolio before change:  [-2.55337088]
curr_Stock_Price:  93.53917843040264
curr_Factors:  [93.53917843 -0.32760884 -1.22941737]
mat_Sqrt:  [[19.71449513  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0006728   0.01647681 -0.07596193]
Stock Position:  -0.0006728046935032079
Bond Position:  [-2.49043728]


portfolio before change:  [-2.55460992]
curr_Stock_Price:  94.91805656800078
curr_Factors:  [94.91805657 -0.28382837 -1.22611751]
mat_Sqrt:  [[20.96948066  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00801225 -0.07948054 -0.14298443]
Stock Position:  0.008012251842952112
Bond Position:  [-3.31511729]


portfolio before change:  [-2.54524588]
curr_Stock_Price:  96.13849488684306
curr_Factors:  [96.13849489 -0.30174106 -1.19646778]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-2.54524588]
Stock Price:  95.03992148766658
PL:  [-2.54524588]
Settle:  Tensor("sub_16:0", shape=(), dtype=float64)
PL:  Tensor("sub_17:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  9
output_Z_Vals[:, i, :]:  [[ 1.19260232e+02 -2.92559343e+01 -2.92733494e+01]
 [-7.63287794e-02  1.74371603e-01  2.00721958e-02]
 [-5.88165176e-02 -8.86134422e-02 -8.40352451e-02]
 [ 4.50543933e-02  1.41733677e-01  3.05992674e-02]
 [ 2.05477987e-01 -2.58015321e-02 -5.85893169e-02]
 [ 7.63004223e-02  3.09365746e-02 -2.73705226e-03]
 [ 3.68096521e-02  4.78092041e-02 -3.44356850e-02]
 [-1.27331497e-01  2.08435295e-01 -9.80567293e-03]
 [-1.58966650e-01 -7.14846494e-02  1.46683438e-01]
 [-3.10664601e-02  4.24559382e-02 -4.47144973e-02]
 [ 5.53257088e-02  1.33831756e-01 -8.10172354e-02]
 [-2.85804055e-02  4.11297047e-02 -7.94942563e-03]
 [-9.58066560e-02  1.09211799e-02 -5.41791610e-02]
 [-7.83246066e-02 -9.74409726e-02  7.66723758e-02]
 [ 2.05274564e-01  2.34605739e-01  7.56344566e-03]
 [-8.40276376e-02 -1.28930059e-01 -1.16265584e-01]
 [-6.97029680e-02 -6.02941022e-02 -5.37096574e-02]
 [-9.39195715e-02  2.23530198e-02  9.69635462e-02]
 [ 5.85163284e-02  4.90573384e-02  3.85485237e-02]
 [ 2.59296237e-01 -7.24605614e-02 -4.91234684e-02]
 [ 2.70534919e-01  7.65909394e-03  3.89825357e-01]
 [-4.35063459e-02  2.46021277e-02 -4.25165664e-02]
 [-1.71776659e-01  4.62454136e-01  3.66423084e-01]
 [ 2.75442452e-01 -3.38190226e-02  5.98493941e-02]
 [-1.25819475e-01 -4.66756891e-02 -1.17395468e-01]
 [ 1.02927825e-01  1.28359253e-03  5.63069088e-02]
 [-1.51035838e-01  7.17946982e-02  8.52134473e-02]
 [-5.07806065e-02  7.36225950e-02  2.93687317e-02]
 [ 6.20848838e-02 -6.23725319e-02  9.08311027e-02]
 [-7.79506109e-02 -1.30234120e-01 -2.01595953e-02]
 [-1.07523338e-01  5.51622946e-01 -6.86244104e-03]
 [ 3.07715446e-02 -9.54690598e-02 -1.85694209e-02]
 [ 6.05133769e-02 -3.08945445e-02  6.83846475e-02]
 [-7.34363064e-02 -6.37514157e-02  1.93543855e-02]
 [-1.38992967e-01  8.93593832e-02  3.54497931e-02]
 [ 8.47165236e-02 -1.65012150e-01 -1.38726811e-01]
 [-2.36112797e-01 -4.10446790e-01  8.92301614e-02]
 [-5.45433432e-02 -5.18614813e-02  7.89968959e-02]
 [-3.41276162e-02  7.33051005e-02 -2.70590348e-02]
 [ 7.14613045e-02 -2.31172327e-03 -6.02724243e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.26023247 -29.25593426 -29.27334937]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  8.31486419  -9.25153874 -83.50871763]
init_Out:  [2.49911038]
Stock Position:  8.31486419409362
Bond position:  [-828.98730903]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [8.47223639]
curr_Stock_Price:  100.73083044493202
curr_Factors:  [100.73083044  -0.82985721  -0.98262109]
mat_Sqrt:  [[16.44421294  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00411873  0.05514114  0.05726039]
Stock Position:  -0.004118731882779196
Bond Position:  [8.88711967]


portfolio before change:  [8.47402094]
curr_Stock_Price:  100.5672874001979
curr_Factors:  [100.5672874   -0.97765585  -0.9821949 ]
mat_Sqrt:  [[14.16786369  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00552364 -0.02802203 -0.23972916]
Stock Position:  -0.005523636531056243
Bond Position:  [9.02951808]


portfolio before change:  [8.47915178]
curr_Stock_Price:  99.8427504431942
curr_Factors:  [99.84275044 -0.81486243 -0.98783455]
mat_Sqrt:  [[16.45944491  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00333912 0.04482012 0.08729119]
Stock Position:  0.0033391156668012654
Bond Position:  [8.14576528]


portfolio before change:  [8.48231155]
curr_Stock_Price:  100.48408356978484
curr_Factors:  [100.48408357  -0.86407099  -1.01723748]
mat_Sqrt:  [[15.31282749  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01259417 -0.00815916 -0.16713901]
Stock Position:  0.012594166572936513
Bond Position:  [7.21679826]


portfolio before change:  [8.48261177]
curr_Stock_Price:  100.43628911499218
curr_Factors:  [100.43628911  -1.01337345  -1.01954799]
mat_Sqrt:  [[13.15237231  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00581952  0.009783   -0.00780805]
Stock Position:  0.005819520692840841
Bond Position:  [7.89812071]


portfolio before change:  [8.48755739]
curr_Stock_Price:  101.11646410724731
curr_Factors:  [101.11646411  -1.12818552  -1.0109563 ]
mat_Sqrt:  [[11.90705573  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00260475  0.0151186  -0.09823542]
Stock Position:  0.0026047518658740654
Bond Position:  [8.22417409]


portfolio before change:  [8.48773388]
curr_Stock_Price:  100.78952397422702
curr_Factors:  [100.78952397  -1.11613073  -1.01215834]
mat_Sqrt:  [[11.99806455  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01033094  0.06591303 -0.02797286]
Stock Position:  -0.01033094085383039
Bond Position:  [9.52898449]


portfolio before change:  [8.4922683]
curr_Stock_Price:  100.46591152451326
curr_Factors:  [100.46591152  -1.40586473  -1.02923103]
mat_Sqrt:  [[ 8.79974476  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01487211 -0.02260543  0.41844702]
Stock Position:  -0.014872106837714016
Bond Position:  [9.98640807]


portfolio before change:  [8.49263286]
curr_Stock_Price:  100.52533965531745
curr_Factors:  [100.52533966  -1.39229385  -1.02039748]
mat_Sqrt:  [[ 9.00444639  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00434203  0.01342575 -0.12755801]
Stock Position:  -0.004342028303277891
Bond Position:  [8.92911673]


portfolio before change:  [8.49578268]
curr_Stock_Price:  100.05698278935002
curr_Factors:  [100.05698279  -1.33273933  -1.02407037]
mat_Sqrt:  [[ 9.47759085  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00445721  0.04232132 -0.23111962]
Stock Position:  0.004457214558183402
Bond Position:  [8.04980724]


portfolio before change:  [8.49749602]
curr_Stock_Price:  100.21561232358222
curr_Factors:  [100.21561232  -1.0438581   -1.03270874]
mat_Sqrt:  [[12.56301456  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0023196   0.01300635 -0.0226775 ]
Stock Position:  -0.0023195953983535895
Bond Position:  [8.72995569]


portfolio before change:  [8.49840299]
curr_Stock_Price:  100.29508216686928
curr_Factors:  [100.29508217  -0.97566129  -1.06131235]
mat_Sqrt:  [[13.08076762  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00814814  0.00345358 -0.15455807]
Stock Position:  -0.008148141637325364
Bond Position:  [9.31562153]


portfolio before change:  [8.50118197]
curr_Stock_Price:  100.09694451446322
curr_Factors:  [100.09694451  -0.8521806   -1.0469249 ]
mat_Sqrt:  [[14.98475971  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00435041 -0.03081354  0.21872495]
Stock Position:  -0.004350409335058885
Bond Position:  [8.93664465]


portfolio before change:  [8.50359517]
curr_Stock_Price:  99.79902963432546
curr_Factors:  [99.79902963 -0.74631391 -1.03524881]
mat_Sqrt:  [[16.80364349  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01266844 0.07418885 0.02157641]
Stock Position:  0.01266843942641564
Bond Position:  [7.23929721]


portfolio before change:  [8.50810974]
curr_Stock_Price:  100.08395827020568
curr_Factors:  [100.08395827  -0.60021522  -1.04344026]
mat_Sqrt:  [[19.34345137  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00574299 -0.04077126 -0.33167335]
Stock Position:  -0.0057429880631555495
Bond Position:  [9.08289072]


portfolio before change:  [8.509045]
curr_Stock_Price:  100.11881361273223
curr_Factors:  [100.11881361  -0.57068502  -1.055323  ]
mat_Sqrt:  [[19.69470068  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00417489 -0.01906667 -0.1532187 ]
Stock Position:  -0.004174889186849634
Bond Position:  [8.92702995]


portfolio before change:  [8.51172752]
curr_Stock_Price:  99.74357790143857
curr_Factors:  [99.7435779  -0.37802232 -1.0560594 ]
mat_Sqrt:  [[23.77229804  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00309393  0.00706865  0.27661001]
Stock Position:  -0.00309392966276544
Bond Position:  [8.82032713]


portfolio before change:  [8.51175873]
curr_Stock_Price:  100.08986768041608
curr_Factors:  [100.08986768  -0.30732135  -1.06429432]
mat_Sqrt:  [[25.39247297  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00266424 0.01551329 0.10996821]
Stock Position:  0.002664241011297345
Bond Position:  [8.2450952]


portfolio before change:  [8.51684276]
curr_Stock_Price:  101.61125089529276
curr_Factors:  [101.6112509   -0.27621268  -1.06028344]
mat_Sqrt:  [[26.69985522  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00926589 -0.02291404 -0.14013558]
Stock Position:  0.009265893984212199
Bond Position:  [7.57532369]


portfolio before change:  [8.55259388]
curr_Stock_Price:  105.36740690949973
curr_Factors:  [105.36740691  -0.377552    -1.08404965]
mat_Sqrt:  [[24.43097292  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01433858 0.00242202 1.11206324]
Stock Position:  0.014338579357914428
Bond Position:  [7.04177496]


portfolio before change:  [8.53708068]
curr_Stock_Price:  104.22409399606676
curr_Factors:  [104.224094    -0.46100024  -1.06124419]
mat_Sqrt:  [[22.74394387  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00226653  0.00777988 -0.12128793]
Stock Position:  -0.0022665277306111844
Bond Position:  [8.77330748]


portfolio before change:  [8.53531358]
curr_Stock_Price:  105.48762701096345
curr_Factors:  [105.48762701  -0.37381707  -1.03198548]
mat_Sqrt:  [[25.86242442  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00328818  0.14624084  1.04530307]
Stock Position:  -0.0032881815222514355
Bond Position:  [8.88217604]


portfolio before change:  [8.53578821]
curr_Stock_Price:  105.68095854940387
curr_Factors:  [105.68095855  -0.3227737   -1.02322266]
mat_Sqrt:  [[27.50666601  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01042605 -0.01069451  0.17073366]
Stock Position:  0.010426052890237082
Bond Position:  [7.43395295]


portfolio before change:  [8.539314]
curr_Stock_Price:  105.9299967467649
curr_Factors:  [105.92999675  -0.24394021  -1.02366375]
mat_Sqrt:  [[29.81985679  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00506333 -0.01476015 -0.33489659]
Stock Position:  -0.005063333708240962
Bond Position:  [9.07567292]


portfolio before change:  [8.54247641]
curr_Stock_Price:  105.5294929774144
curr_Factors:  [105.52949298  -0.34151212  -1.03204596]
mat_Sqrt:  [[26.72053524  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00428339 0.00040591 0.16062794]
Stock Position:  0.00428339348919805
Bond Position:  [8.09045207]


portfolio before change:  [8.53686334]
curr_Stock_Price:  103.9829535271138
curr_Factors:  [103.98295353  -0.49785247  -1.04502477]
mat_Sqrt:  [[22.22793292  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00592894  0.02270348  0.24309025]
Stock Position:  -0.005928935666954155
Bond Position:  [9.15337158]


portfolio before change:  [8.53538694]
curr_Stock_Price:  104.42496344211598
curr_Factors:  [104.42496344  -0.61144972  -1.01625618]
mat_Sqrt:  [[20.50692968  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00209124  0.02328151  0.08378082]
Stock Position:  -0.002091235141793831
Bond Position:  [8.75376409]


portfolio before change:  [8.53472592]
curr_Stock_Price:  105.26432666299975
curr_Factors:  [105.26432666  -0.48265792  -1.00906501]
mat_Sqrt:  [[23.68286171  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00333639 -0.01972393  0.25911585]
Stock Position:  0.003336389585116595
Bond Position:  [8.18352312]


portfolio before change:  [8.54256183]
curr_Stock_Price:  107.30632613720456
curr_Factors:  [107.30632614  -0.53081693  -1.00090652]
mat_Sqrt:  [[23.19563601  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00368295 -0.04118364 -0.05750971]
Stock Position:  -0.00368294715392787
Bond Position:  [8.93776536]


portfolio before change:  [8.54995764]
curr_Stock_Price:  105.60157224504218
curr_Factors:  [105.60157225  -0.36622379  -1.01021272]
mat_Sqrt:  [[26.66193116  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00355118  0.17443849 -0.01957663]
Stock Position:  -0.003551178806528056
Bond Position:  [8.92496771]


portfolio before change:  [8.55423]
curr_Stock_Price:  104.71266603192879
curr_Factors:  [104.71266603  -0.55440723  -0.99558065]
mat_Sqrt:  [[22.22532056  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00110307 -0.03018997 -0.05297339]
Stock Position:  0.0011030696669570802
Bond Position:  [8.43872463]


portfolio before change:  [8.55391551]
curr_Stock_Price:  103.47123264236315
curr_Factors:  [103.47123264  -0.78335257  -0.9983244 ]
mat_Sqrt:  [[17.41995978  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00422932 -0.00976971  0.19508236]
Stock Position:  0.004229323253204596
Bond Position:  [8.11630222]


portfolio before change:  [8.56171838]
curr_Stock_Price:  105.07627978147482
curr_Factors:  [105.07627978  -0.82655758  -0.99476861]
mat_Sqrt:  [[17.00249965  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0041836  -0.02015997  0.05521267]
Stock Position:  -0.00418360034911127
Bond Position:  [9.00131554]


portfolio before change:  [8.56376501]
curr_Stock_Price:  104.85603874666204
curr_Factors:  [104.85603875  -0.77714275  -0.98589433]
mat_Sqrt:  [[17.98523717  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00719755  0.02825792  0.10112839]
Stock Position:  -0.007197545289090677
Bond Position:  [9.3184711]


portfolio before change:  [8.55111815]
curr_Stock_Price:  106.77499134213633
curr_Factors:  [106.77499134  -0.82574363  -0.97714472]
mat_Sqrt:  [[17.59888224  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0029626  -0.05218142 -0.39574898]
Stock Position:  0.002962599316093041
Bond Position:  [8.23478663]


portfolio before change:  [8.55194819]
curr_Stock_Price:  106.70769418346339
curr_Factors:  [106.70769418  -0.73822349  -0.96984283]
mat_Sqrt:  [[19.33712725  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01181646 -0.12979467  0.25454881]
Stock Position:  -0.011816463460555877
Bond Position:  [9.81285575]


portfolio before change:  [8.55571213]
curr_Stock_Price:  106.49297150714513
curr_Factors:  [106.49297151  -0.75856066  -0.92782718]
mat_Sqrt:  [[19.72113977  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00201597 -0.01640004  0.22535616]
Stock Position:  -0.002015970045702535
Bond Position:  [8.77039877]


portfolio before change:  [8.56073722]
curr_Stock_Price:  104.54417038992474
curr_Factors:  [104.54417039  -0.67354671  -0.90083498]
mat_Sqrt:  [[21.65481821  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00174364  0.02318111 -0.07719189]
Stock Position:  -0.00174364377793877
Bond Position:  [8.74302502]


portfolio before change:  [8.56159271]
curr_Stock_Price:  104.68035952693202
curr_Factors:  [104.68035953  -0.73448689  -0.8868371 ]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [8.56159271]
Stock Price:  104.5935995449387
PL:  [3.96799316]
Settle:  Tensor("sub_18:0", shape=(), dtype=float64)
PL:  Tensor("sub_19:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  10
output_Z_Vals[:, i, :]:  [[ 1.19260232e+02 -2.92559343e+01 -2.92733494e+01]
 [ 5.43518959e-03 -1.07080145e-01 -3.71916544e-02]
 [-3.71482960e-02  6.71555107e-03  4.10719384e-02]
 [-5.51455618e-02  9.70503091e-02  1.19259952e-02]
 [ 1.56705726e-02  3.77835360e-02 -7.16733288e-02]
 [ 4.43354852e-02  2.89101830e-02  4.92340858e-02]
 [ 8.68762313e-04  1.98750602e-02  7.52251148e-02]
 [-2.37816627e-02 -8.41451285e-02 -3.81028777e-02]
 [ 1.10757283e-01 -4.43267434e-02 -1.42457100e-01]
 [-1.23865952e-01 -1.57405267e-01 -9.41260119e-02]
 [ 8.66103606e-02  9.73068624e-02 -7.30312969e-02]
 [-2.04535938e-01 -9.95617987e-02  4.53315787e-02]
 [-9.72548201e-02  1.36620268e-02 -1.32966417e-02]
 [-9.62623594e-02 -1.14884369e-01  6.32126881e-02]
 [ 4.01767075e-01  4.69301569e-01  1.92156181e-02]
 [-3.75633098e-02 -3.97812852e-01 -4.59473719e-02]
 [-6.72019015e-02 -5.29075284e-02 -3.88928012e-02]
 [-6.86713296e-02  2.64543981e-01  1.47151442e-01]
 [ 8.83176414e-02  7.49463651e-02  1.03577439e-01]
 [-4.97647153e-02 -1.90664663e-02  1.22910757e-01]
 [ 4.91707779e-02 -7.58685008e-02  3.47826673e-02]
 [ 1.30815618e-01 -6.60127614e-02  2.05616814e-01]
 [-1.17958761e-02 -1.24722105e-01  1.56456048e-01]
 [-6.83635523e-02 -5.71294052e-04 -8.20762535e-02]
 [-4.14257617e-01  1.31116801e-01  6.97611419e-02]
 [-1.07691364e-01 -2.26669649e-01  1.22833506e-01]
 [ 1.61015395e-01  5.79443013e-02 -1.12864245e-01]
 [-1.27936576e-02  4.53157064e-02  2.25447504e-02]
 [-9.48348339e-02 -9.72748019e-02 -1.72968180e-01]
 [ 7.33899261e-02  8.18183513e-02 -6.98854799e-02]
 [ 5.15481370e-02 -1.77048233e-02  3.92858439e-02]
 [ 6.27595133e-02 -9.93849354e-02 -8.33577088e-02]
 [ 3.12933694e-01 -3.06387224e-01 -2.45308136e-01]
 [-4.74341871e-02 -8.29459977e-02 -4.36243724e-04]
 [-1.83904710e-01  8.32227035e-02  2.05480694e-02]
 [ 6.95727841e-02 -1.15230402e-01 -7.75881634e-02]
 [-2.15745668e-02 -1.35963469e-01 -5.61205454e-02]
 [-2.25630582e-02  1.86497881e-02 -7.32561877e-02]
 [-2.70444629e-03 -3.83397185e-02  1.04913416e-02]
 [-8.50116246e-01  4.22053953e-01  5.21062327e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.26023247 -29.25593426 -29.27334937]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  8.31486419  -9.25153874 -83.50871763]
init_Out:  [2.49911038]
Stock Position:  8.31486419409362
Bond position:  [-828.98730903]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [1.9262032]
curr_Stock_Price:  99.94356164076044
curr_Factors:  [99.94356164 -0.88348542 -1.02560656]
mat_Sqrt:  [[14.81312583  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00033223 -0.03386172 -0.10609744]
Stock Position:  -0.0003322271472107852
Bond Position:  [1.95940716]


portfolio before change:  [1.92647391]
curr_Stock_Price:  99.86599336881972
curr_Factors:  [99.86599337 -1.00787313 -1.00500064]
mat_Sqrt:  [[13.34251365  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00214286  0.00212364  0.11716681]
Stock Position:  -0.0021428591040480215
Bond Position:  [2.14047266]


portfolio before change:  [1.92925358]
curr_Stock_Price:  98.69368146496181
curr_Factors:  [98.69368146 -0.83345814 -0.99931598]
mat_Sqrt:  [[15.78794711  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00317998  0.03069     0.03402154]
Stock Position:  -0.0031799796154983843
Bond Position:  [2.24309748]


portfolio before change:  [1.93029852]
curr_Stock_Price:  98.45326114889528
curr_Factors:  [98.45326115 -0.65257275 -1.00970256]
mat_Sqrt:  [[18.67725789  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 1.07932460e-04  1.19482032e-02 -2.04464057e-01]
Stock Position:  0.00010793245951260847
Bond Position:  [1.91967222]


portfolio before change:  [1.93042001]
curr_Stock_Price:  97.35545428000556
curr_Factors:  [97.35545428 -0.64097937 -0.99449684]
mat_Sqrt:  [[18.97064047  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00290616 0.0091422  0.14045114]
Stock Position:  0.002906164852006981
Bond Position:  [1.64748901]


portfolio before change:  [1.92760694]
curr_Stock_Price:  96.31662144458747
curr_Factors:  [96.31662144 -0.6649368  -0.97690836]
mat_Sqrt:  [[18.64905997  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00089748 0.00628505 0.21459631]
Stock Position:  0.0008974820413013045
Bond Position:  [1.8411645]


portfolio before change:  [1.92764466]
curr_Stock_Price:  96.10220049250958
curr_Factors:  [96.10220049 -0.73877117 -1.00602505]
mat_Sqrt:  [[16.78718826  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00200939 -0.02660903 -0.1086969 ]
Stock Position:  -0.002009389384293907
Bond Position:  [2.1207514]


portfolio before change:  [1.9269954]
curr_Stock_Price:  96.55724595003824
curr_Factors:  [96.55724595 -0.66440517 -1.00647427]
mat_Sqrt:  [[18.16063987  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00443453 -0.01401735 -0.40639045]
Stock Position:  0.004434526453802158
Bond Position:  [1.49880974]


portfolio before change:  [1.92676754]
curr_Stock_Price:  96.4636106122448
curr_Factors:  [96.46361061 -0.72858748 -1.00135955]
mat_Sqrt:  [[17.10240019  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00860368 -0.04977592 -0.26851531]
Stock Position:  -0.008603677168975414
Bond Position:  [2.7567093]


portfolio before change:  [1.91799982]
curr_Stock_Price:  97.52273074295815
curr_Factors:  [97.52273074 -1.05586309 -1.01288611]
mat_Sqrt:  [[12.32138399  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0060233   0.03077113 -0.20833796]
Stock Position:  0.0060232975448327565
Bond Position:  [1.3305914]


portfolio before change:  [1.91694841]
curr_Stock_Price:  97.32055882186769
curr_Factors:  [97.32055882 -1.07618859 -1.03910204]
mat_Sqrt:  [[11.73668766  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01685768 -0.03148421  0.12931838]
Stock Position:  -0.016857681545161658
Bond Position:  [3.5575474]


portfolio before change:  [1.92160303]
curr_Stock_Price:  97.07082696269592
curr_Factors:  [97.07082696 -1.04403889 -1.03421926]
mat_Sqrt:  [[12.14822092  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00820007  0.00432031 -0.03793162]
Stock Position:  -0.0082000676776209
Bond Position:  [2.71759038]


portfolio before change:  [1.92178006]
curr_Stock_Price:  97.0906678533164
curr_Factors:  [97.09066785 -1.29600725 -1.02592334]
mat_Sqrt:  [[ 9.52304524  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0090649  -0.03632963  0.1803282 ]
Stock Position:  -0.009064897099401807
Bond Position:  [2.80189697]


portfolio before change:  [1.91490287]
curr_Stock_Price:  97.88796805307963
curr_Factors:  [97.88796805 -1.22286707 -1.04027029]
mat_Sqrt:  [[10.1826601   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.0410312  0.14840619 0.05481681]
Stock Position:  0.04103119976121717
Bond Position:  [-2.1015579]


portfolio before change:  [1.89850783]
curr_Stock_Price:  97.49479586938646
curr_Factors:  [97.49479587 -1.18424244 -1.04132506]
mat_Sqrt:  [[10.53003341  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00543339 -0.12579947 -0.13107506]
Stock Position:  -0.00543338841569678
Bond Position:  [2.42823493]


portfolio before change:  [1.89746671]
curr_Stock_Price:  97.74227858388318
curr_Factors:  [97.74227858 -1.10750421 -1.03395361]
mat_Sqrt:  [[11.48309993  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00666257 -0.01673083 -0.11095034]
Stock Position:  -0.006662567446318565
Bond Position:  [2.54868124]


portfolio before change:  [1.89310098]
curr_Stock_Price:  98.44536127021298
curr_Factors:  [98.44536127 -1.25525672 -1.04359191]
mat_Sqrt:  [[ 9.88138867  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00321854  0.08365615  0.4197821 ]
Stock Position:  -0.0032185426770796983
Bond Position:  [2.20995158]


portfolio before change:  [1.89444688]
curr_Stock_Price:  98.11302722791166
curr_Factors:  [98.11302723 -1.41092162 -1.03247121]
mat_Sqrt:  [[ 8.52264996  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01307051 0.02370012 0.2954776 ]
Stock Position:  0.01307051268109244
Bond Position:  [0.61205931]


portfolio before change:  [1.89329145]
curr_Stock_Price:  98.01877387804583
curr_Factors:  [98.01877388 -1.46981575 -1.02951871]
mat_Sqrt:  [[ 8.05122761  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00312598 -0.00602935  0.35063018]
Stock Position:  -0.0031259774869682824
Bond Position:  [2.19969593]


portfolio before change:  [1.89486748]
curr_Stock_Price:  97.60256764789963
curr_Factors:  [97.60256765 -1.3327269  -1.02253356]
mat_Sqrt:  [[ 9.25943785  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00586557 -0.02399173  0.09922527]
Stock Position:  0.005865566006110399
Bond Position:  [1.32237318]


portfolio before change:  [1.8990498]
curr_Stock_Price:  98.28741392999137
curr_Factors:  [98.28741393 -1.33134273 -1.03141286]
mat_Sqrt:  [[ 9.25478199  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01848585 -0.02087507  0.58656754]
Stock Position:  0.018485852246596657
Bond Position:  [0.08212318]


portfolio before change:  [1.89161232]
curr_Stock_Price:  97.88452504039361
curr_Factors:  [97.88452504 -1.25538315 -1.01364447]
mat_Sqrt:  [[10.12250181  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00167155 -0.03944059  0.44632555]
Stock Position:  0.0016715502074096432
Bond Position:  [1.72799342]


portfolio before change:  [1.89210667]
curr_Stock_Price:  98.05103789257517
curr_Factors:  [98.05103789 -1.13571901 -1.04311677]
mat_Sqrt:  [[11.09675092  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-7.67179950e-03 -1.80659042e-04 -2.34140705e-01]
Stock Position:  -0.007671799495433848
Bond Position:  [2.64433457]


portfolio before change:  [1.89909169]
curr_Stock_Price:  97.1836452175025
curr_Factors:  [97.18364522 -0.79760386 -1.0420337 ]
mat_Sqrt:  [[15.44005154  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02568853  0.04146277  0.19900912]
Stock Position:  -0.025688532262188812
Bond Position:  [4.3955969]


portfolio before change:  [1.92950193]
curr_Stock_Price:  96.02122959073543
curr_Factors:  [96.02122959 -0.82841331 -1.05036944]
mat_Sqrt:  [[14.66973546  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00603083 -0.07167924  0.3504098 ]
Stock Position:  -0.006030828898718371
Bond Position:  [2.50858953]


portfolio before change:  [1.92613954]
curr_Stock_Price:  96.63076068282162
curr_Factors:  [96.63076068 -0.75944783 -1.07045891]
mat_Sqrt:  [[15.50233082  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00899692  0.0183236  -0.32197028]
Stock Position:  0.008996917604948501
Bond Position:  [1.05676055]


portfolio before change:  [1.92571538]
curr_Stock_Price:  96.56893216654046
curr_Factors:  [96.56893217 -0.65079415 -1.0791021 ]
mat_Sqrt:  [[17.12194256  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0004101   0.01433008  0.0643139 ]
Stock Position:  -0.0004100985100677801
Bond Position:  [1.96531815]


portfolio before change:  [1.92589513]
curr_Stock_Price:  96.7296982721535
curr_Factors:  [96.72969827 -0.81009035 -1.09169046]
mat_Sqrt:  [[14.44198614  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00918526 -0.03076099 -0.49343007]
Stock Position:  -0.009185262966882528
Bond Position:  [2.81438284]


portfolio before change:  [1.92649847]
curr_Stock_Price:  96.70231535266342
curr_Factors:  [96.70231535 -1.10535438 -1.07329614]
mat_Sqrt:  [[10.94613934  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00559441  0.02587323 -0.19936382]
Stock Position:  0.005594406494947623
Bond Position:  [1.38550641]


portfolio before change:  [1.92737599]
curr_Stock_Price:  96.82821291758472
curr_Factors:  [96.82821292 -1.03807082 -1.07732212]
mat_Sqrt:  [[11.67611688  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00506249 -0.00559876  0.11207158]
Stock Position:  0.005062486981725028
Bond Position:  [1.43718442]


portfolio before change:  [1.92858566]
curr_Stock_Price:  97.03167204341055
curr_Factors:  [97.03167204 -1.10161587 -1.07238463]
mat_Sqrt:  [[11.03461274  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00391297 -0.03142828 -0.23779634]
Stock Position:  0.003912967789149693
Bond Position:  [1.54890385]


portfolio before change:  [1.9306442]
curr_Stock_Price:  97.50827150356209
curr_Factors:  [97.5082715  -0.99951624 -1.06218439]
mat_Sqrt:  [[12.40669916  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.02054934 -0.09688815 -0.69979583]
Stock Position:  0.020549341375127143
Bond Position:  [-0.07308656]


portfolio before change:  [1.9386917]
curr_Stock_Price:  97.90033435176284
curr_Factors:  [97.90033435 -1.09625944 -1.06704543]
mat_Sqrt:  [[11.25311626  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00441343 -0.02622983 -0.00124448]
Stock Position:  -0.004413434486091603
Bond Position:  [2.37076841]


portfolio before change:  [1.93825094]
curr_Stock_Price:  98.06735194915076
curr_Factors:  [98.06735195 -0.81802084 -1.05251923]
mat_Sqrt:  [[15.1063388   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01175411  0.02631733  0.05861792]
Stock Position:  -0.011754108937891918
Bond Position:  [3.09094528]


portfolio before change:  [1.94801202]
curr_Stock_Price:  97.26978480202335
curr_Factors:  [97.2697848  -1.02992099 -1.05087691]
mat_Sqrt:  [[12.14224277  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00418044 -0.03643905 -0.22133743]
Stock Position:  0.004180441074475889
Bond Position:  [1.54138142]


portfolio before change:  [1.94972379]
curr_Stock_Price:  97.63316243926867
curr_Factors:  [97.63316244 -1.10106062 -1.09036713]
mat_Sqrt:  [[10.91119654  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00334892 -0.04299542 -0.1600963 ]
Stock Position:  -0.0033489165611205363
Bond Position:  [2.2766891]


portfolio before change:  [1.9490081]
curr_Stock_Price:  97.93185342271153
curr_Factors:  [97.93185342 -1.08488625 -1.1078603 ]
mat_Sqrt:  [[10.9301531   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00338832  0.00589758 -0.20897951]
Stock Position:  -0.0033883221085599835
Bond Position:  [2.28083277]


portfolio before change:  [1.94998056]
curr_Stock_Price:  97.72899838872853
curr_Factors:  [97.72899839 -1.03917897 -1.1053409 ]
mat_Sqrt:  [[11.4464364   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00013566 -0.01212408  0.02992888]
Stock Position:  -0.00013566121186340762
Bond Position:  [1.9632386]


portfolio before change:  [1.95026794]
curr_Stock_Price:  97.41970036802489
curr_Factors:  [97.41970037 -0.96655802 -1.11823456]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [1.95026794]
Stock Price:  97.14291868346773
PL:  [1.95026794]
Settle:  Tensor("sub_20:0", shape=(), dtype=float64)
PL:  Tensor("sub_21:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  11
output_Z_Vals[:, i, :]:  [[ 1.19260232e+02 -2.92559343e+01 -2.92733494e+01]
 [ 4.03706775e-03 -1.27034308e-01 -3.91946428e-02]
 [-5.45715711e-02  5.87262421e-03  9.93503265e-02]
 [-7.87136497e-02  5.80927118e-02  9.91990177e-03]
 [ 1.63533234e-01 -1.17471268e-02 -6.14924470e-02]
 [ 7.74768476e-02  3.07009745e-02 -7.23890557e-03]
 [ 5.26732547e-02  2.92694861e-02 -5.60074792e-02]
 [-1.28350912e-01  1.97262153e-01 -1.52554540e-02]
 [ 5.04975804e-02  7.68727938e-03 -8.37354854e-02]
 [-2.78188269e-02  3.53991452e-01  1.41929835e-01]
 [ 3.76839344e-02 -5.43463566e-02 -5.02240494e-02]
 [-7.74418142e-02  9.28981117e-02  2.40252801e-02]
 [-5.16625812e-02 -8.53516280e-02 -5.79127633e-02]
 [ 1.54050476e-01  1.41586155e-01  2.36744808e-01]
 [ 1.42984582e-01  9.58738197e-02 -6.94535116e-02]
 [-7.17163254e-02 -9.57550653e-02 -1.21703455e-01]
 [-7.12073115e-02 -5.61131731e-02 -4.80079331e-02]
 [-1.02186825e-01 -5.69496892e-02  8.05300838e-02]
 [ 2.55177327e-02  5.72792577e-02  1.59445193e-02]
 [ 1.86758666e-01 -4.34543903e-02 -8.07054125e-03]
 [-6.39187461e-02  8.43138411e-03  1.85000941e-03]
 [ 9.68069104e-02 -5.96274008e-02  1.14621948e-01]
 [-7.10597997e-02  7.40708370e-02  3.35986204e-01]
 [ 6.19408387e-02 -2.70980557e-02 -6.82421298e-02]
 [-7.84030281e-02  6.40674685e-02  7.62374593e-02]
 [ 1.29081417e-02 -9.10415077e-02  8.41603396e-02]
 [-1.23623674e-01  6.05323188e-02  2.25086206e-02]
 [-5.07806065e-02  7.36225950e-02  2.93687317e-02]
 [ 6.10959020e-02 -7.45427958e-02  3.08956089e-03]
 [ 2.59917254e-02  2.27937254e-03 -6.66110216e-02]
 [-2.79413334e-02  2.94745964e-01  1.74254308e-02]
 [ 3.45282897e-02 -8.32488360e-02 -4.96001047e-03]
 [-2.09442954e-02  3.59568114e-03  7.83051986e-02]
 [-1.38644155e-01 -5.13113540e-02  1.76969107e-02]
 [-1.21222584e-01  3.63571043e-02  3.62818149e-02]
 [ 8.47165236e-02 -1.65012150e-01 -1.38726811e-01]
 [-2.35068623e-01 -4.07662614e-01  8.79076434e-02]
 [-5.75352554e-02 -5.72262361e-02  9.30817640e-02]
 [-1.94138041e-02  4.24485436e-02 -3.62912855e-02]
 [ 2.82988311e-01 -1.86447107e-02 -2.85542253e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.26023247 -29.25593426 -29.27334937]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  8.31486419  -9.25153874 -83.50871763]
init_Out:  [2.49911038]
Stock Position:  8.31486419409362
Bond position:  [-828.98730903]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-1.14120556]
curr_Stock_Price:  99.57465498331743
curr_Factors:  [99.57465498 -0.8474099  -0.99155067]
mat_Sqrt:  [[15.83063679  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00045756 -0.04017178 -0.11181141]
Stock Position:  -0.00045756320745854234
Bond Position:  [-1.09564386]


portfolio before change:  [-1.14109237]
curr_Stock_Price:  99.02794534557039
curr_Factors:  [99.02794535 -0.72919561 -0.99113405]
mat_Sqrt:  [[17.72670798  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00192592  0.00185709  0.28341883]
Stock Position:  -0.0019259154102272942
Bond Position:  [-0.95037292]


portfolio before change:  [-1.13996894]
curr_Stock_Price:  98.38293645485327
curr_Factors:  [98.38293645 -0.808067   -0.97458244]
mat_Sqrt:  [[16.54721715  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00454389  0.01837053  0.02829872]
Stock Position:  -0.004543894615245291
Bond Position:  [-0.69292725]


portfolio before change:  [-1.1475598]
curr_Stock_Price:  100.03443658509421
curr_Factors:  [100.03443659  -0.99621699  -0.99770444]
mat_Sqrt:  [[13.62073227  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01106239 -0.00371477 -0.17542084]
Stock Position:  0.011062388460451206
Bond Position:  [-2.2541796]


portfolio before change:  [-1.14704452]
curr_Stock_Price:  100.10648932674555
curr_Factors:  [100.10648933  -0.90945284  -0.99339128]
mat_Sqrt:  [[14.93026548  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00514337  0.0097085  -0.02065058]
Stock Position:  0.005143371900036847
Bond Position:  [-1.66192942]


portfolio before change:  [-1.14478364]
curr_Stock_Price:  100.58645403282942
curr_Factors:  [100.58645403  -0.82207098  -0.98138787]
mat_Sqrt:  [[16.56941859  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00253458  0.00925582 -0.15977375]
Stock Position:  0.0025345796257182783
Bond Position:  [-1.39972801]


portfolio before change:  [-1.14473741]
curr_Stock_Price:  100.67372936402359
curr_Factors:  [100.67372936  -0.80361989  -0.95734395]
mat_Sqrt:  [[17.30371204  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00730315  0.06237977 -0.04351956]
Stock Position:  -0.007303151546033994
Bond Position:  [-0.4095019]


portfolio before change:  [-1.14738321]
curr_Stock_Price:  101.0290021634042
curr_Factors:  [101.02900216  -0.63383788  -0.97353764]
mat_Sqrt:  [[20.24751584  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00165964  0.00243093 -0.23887403]
Stock Position:  0.0016596421486119795
Bond Position:  [-1.3150552]


portfolio before change:  [-1.14555245]
curr_Stock_Price:  102.23115677894647
curr_Factors:  [102.23115678  -0.78979613  -0.9839199 ]
mat_Sqrt:  [[17.34875019  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00059327 0.11194193 0.40488631]
Stock Position:  0.0005932703685795563
Bond Position:  [-1.20620317]


portfolio before change:  [-1.14538605]
curr_Stock_Price:  102.76580829918414
curr_Factors:  [102.7658083   -0.8518058   -0.98541729]
mat_Sqrt:  [[16.36638605  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00159038 -0.01718583 -0.14327523]
Stock Position:  0.00159038019881271
Bond Position:  [-1.30882275]


portfolio before change:  [-1.14586773]
curr_Stock_Price:  102.56581354016892
curr_Factors:  [102.56581354  -0.68381314  -0.94271987]
mat_Sqrt:  [[20.16546861  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00347818  0.02937696  0.06853744]
Stock Position:  -0.0034781763237286163
Bond Position:  [-0.78912574]


portfolio before change:  [-1.14855215]
curr_Stock_Price:  103.30924312512015
curr_Factors:  [103.30924313  -0.95087441  -0.96504918]
mat_Sqrt:  [[15.20772104  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00431937 -0.02699055 -0.16520899]
Stock Position:  -0.0043193680282390574
Bond Position:  [-0.70232151]


portfolio before change:  [-1.14382739]
curr_Stock_Price:  102.19506257084807
curr_Factors:  [102.19506257  -0.72670005  -1.00411871]
mat_Sqrt:  [[18.10276336  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01138122 0.04477347 0.67536704]
Stock Position:  0.011381220740969483
Bond Position:  [-2.30693196]


portfolio before change:  [-1.14597489]
curr_Stock_Price:  102.03171319007664
curr_Factors:  [102.03171319  -0.72735186  -0.98845746]
mat_Sqrt:  [[18.34715208  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00715549  0.03031796 -0.19813154]
Stock Position:  0.007155491704376298
Bond Position:  [-1.87606197]


portfolio before change:  [-1.14406765]
curr_Stock_Price:  102.33103152485533
curr_Factors:  [102.33103152  -0.58164686  -1.01637833]
mat_Sqrt:  [[20.70111942  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00478386 -0.03028041 -0.34718608]
Stock Position:  -0.004783863241912757
Bond Position:  [-0.65452999]


portfolio before change:  [-1.13588312]
curr_Stock_Price:  100.60306673324882
curr_Factors:  [100.60306673  -0.5536857   -1.00430769]
mat_Sqrt:  [[21.18279604  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00389258 -0.01774454 -0.13695327]
Stock Position:  -0.003892579880535579
Bond Position:  [-0.74427765]


portfolio before change:  [-1.13486482]
curr_Stock_Price:  100.31756427971193
curr_Factors:  [100.31756428  -0.29465539  -1.01722373]
mat_Sqrt:  [[27.01687526  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00322832 -0.01800907  0.22972991]
Stock Position:  -0.0032283202229498697
Bond Position:  [-0.8110076]


portfolio before change:  [-1.14298226]
curr_Stock_Price:  102.8006082995983
curr_Factors:  [102.8006083   -0.44062662  -1.01066952]
mat_Sqrt:  [[24.0827334   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00125614 0.01811329 0.04548528]
Stock Position:  0.001256142219562112
Bond Position:  [-1.27211445]


portfolio before change:  [-1.1461364]
curr_Stock_Price:  100.41623060234585
curr_Factors:  [100.4162306   -0.35426892  -0.9989673 ]
mat_Sqrt:  [[25.94782107  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00709074 -0.01374148 -0.02302301]
Stock Position:  0.007090741286285252
Bond Position:  [-1.85816192]


portfolio before change:  [-1.14784647]
curr_Stock_Price:  100.2078204235526
curr_Factors:  [100.20782042  -0.18027349  -1.00946571]
mat_Sqrt:  [[30.49330138  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00207663  0.00266624  0.00527756]
Stock Position:  -0.002076633693772771
Bond Position:  [-0.93975154]


portfolio before change:  [-1.14588756]
curr_Stock_Price:  99.20793742384117
curr_Factors:  [99.20793742 -0.2123199  -0.99602538]
mat_Sqrt:  [[29.63253004  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00400453 -0.01885584  0.32698451]
Stock Position:  0.004004533007139135
Bond Position:  [-1.54316902]


portfolio before change:  [-1.14637993]
curr_Stock_Price:  99.1331572832101
curr_Factors:  [99.13315728 -0.45739851 -0.96386294]
mat_Sqrt:  [[23.93166601  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-2.35839082e-05  2.34232553e-02  9.58475120e-01]
Stock Position:  -2.3583908247785626e-05
Bond Position:  [-1.14404198]


portfolio before change:  [-1.14654873]
curr_Stock_Price:  100.22689201054672
curr_Factors:  [100.22689201  -0.39766195  -0.98810348]
mat_Sqrt:  [[25.06997975  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00188717 -0.00856916 -0.1946758 ]
Stock Position:  0.0018871695946737826
Bond Position:  [-1.33569388]


portfolio before change:  [-1.14624267]
curr_Stock_Price:  100.47755212271014
curr_Factors:  [100.47755212  -0.78504855  -0.96741449]
mat_Sqrt:  [[17.41742766  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00351297  0.02025991  0.21748425]
Stock Position:  -0.0035129703494332872
Bond Position:  [-0.79326801]


portfolio before change:  [-1.14545294]
curr_Stock_Price:  100.22451970948914
curr_Factors:  [100.22451971  -0.61938622  -0.95497588]
mat_Sqrt:  [[20.76047149  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00133603 -0.02878985  0.24008602]
Stock Position:  0.0013360302301120952
Bond Position:  [-1.27935593]


portfolio before change:  [-1.14443851]
curr_Stock_Price:  101.10350844917853
curr_Factors:  [101.10350845  -0.73555223  -0.99629407]
mat_Sqrt:  [[17.89101308  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00656565  0.019142    0.06421083]
Stock Position:  -0.006565652991475539
Bond Position:  [-0.48062796]


portfolio before change:  [-1.14965966]
curr_Stock_Price:  101.88957953600958
curr_Factors:  [101.88957954  -0.88095496  -0.99118017]
mat_Sqrt:  [[15.67010166  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00273673  0.02328151  0.08378082]
Stock Position:  -0.002736728385755619
Bond Position:  [-0.87081556]


portfolio before change:  [-1.15324658]
curr_Stock_Price:  103.1604598870614
curr_Factors:  [103.16045989  -0.79486573  -1.01878893]
mat_Sqrt:  [[16.82104833  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00355518 -0.0235725   0.00881366]
Stock Position:  0.003555180873454661
Bond Position:  [-1.52000067]


portfolio before change:  [-1.15584806]
curr_Stock_Price:  102.48216147402218
curr_Factors:  [102.48216147  -0.69144132  -1.01316009]
mat_Sqrt:  [[18.63585363  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00066826  0.0007208  -0.1900227 ]
Stock Position:  0.0006682634981818642
Bond Position:  [-1.22433315]


portfolio before change:  [-1.15568501]
curr_Stock_Price:  102.95517837203336
curr_Factors:  [102.95517837  -0.7632625   -0.99747093]
mat_Sqrt:  [[17.69992326  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00094769  0.09320686  0.0497099 ]
Stock Position:  -0.0009476919166609827
Bond Position:  [-1.05811522]


portfolio before change:  [-1.15790413]
curr_Stock_Price:  105.15721088939786
curr_Factors:  [105.15721089  -0.69192065  -0.99053502]
mat_Sqrt:  [[19.55049892  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00160438 -0.02632559 -0.01414953]
Stock Position:  0.001604376250297621
Bond Position:  [-1.32661587]


portfolio before change:  [-1.15662455]
curr_Stock_Price:  106.0581352639042
curr_Factors:  [106.05813526  -0.78597087  -0.99434779]
mat_Sqrt:  [[17.87974896  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00027223  0.00113705  0.22338294]
Stock Position:  -0.0002722338891383318
Bond Position:  [-1.12775193]


portfolio before change:  [-1.15670227]
curr_Stock_Price:  105.82578656972875
curr_Factors:  [105.82578657  -0.52087903  -1.01842812]
mat_Sqrt:  [[22.70277284  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00600617 -0.01622607  0.05048436]
Stock Position:  -0.00600616683264692
Bond Position:  [-0.52109495]


portfolio before change:  [-1.16417454]
curr_Stock_Price:  107.05903993280931
curr_Factors:  [107.05903993  -0.74373263  -1.03928881]
mat_Sqrt:  [[17.99977075  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00627107  0.01149713  0.10350192]
Stock Position:  -0.006271071732123507
Bond Position:  [-0.49279962]


portfolio before change:  [-1.16093627]
curr_Stock_Price:  106.53283399572098
curr_Factors:  [106.532834    -0.84069242  -1.04170284]
mat_Sqrt:  [[16.21696603  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00321505 -0.05218142 -0.39574898]
Stock Position:  0.0032150549235572213
Bond Position:  [-1.50344518]


portfolio before change:  [-1.16191272]
curr_Stock_Price:  106.28757803944495
curr_Factors:  [106.28757804  -0.90263208  -1.046938  ]
mat_Sqrt:  [[15.12846913  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01504781 -0.12891424  0.25077604]
Stock Position:  -0.015047811650683961
Bond Position:  [0.43748273]


portfolio before change:  [-1.16687129]
curr_Stock_Price:  106.62073282624448
curr_Factors:  [106.62073283  -0.53725254  -1.02997194]
mat_Sqrt:  [[22.24358191  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00179884 -0.01809652  0.26553636]
Stock Position:  -0.0017988377559612343
Bond Position:  [-0.97507789]


portfolio before change:  [-1.17041221]
curr_Stock_Price:  108.52142444745179
curr_Factors:  [108.52142445  -0.45632149  -1.0395229 ]
mat_Sqrt:  [[24.31523767  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00105801  0.01342341 -0.10352894]
Stock Position:  -0.001058007963047201
Bond Position:  [-1.05559568]


portfolio before change:  [-1.17151093]
curr_Stock_Price:  109.43517573972883
curr_Factors:  [109.43517574  -0.67718806  -1.04470111]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-1.17151093]
Stock Price:  109.37055435267013
PL:  [-10.54206528]
Settle:  Tensor("sub_22:0", shape=(), dtype=float64)
PL:  Tensor("sub_23:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  12
output_Z_Vals[:, i, :]:  [[ 1.19260232e+02 -2.92559343e+01 -2.92733494e+01]
 [ 5.95882105e-02 -9.47532475e-02 -1.46082953e-01]
 [-5.01798431e-02  1.40959022e-02  1.01899249e-01]
 [-5.69583733e-02  1.20656850e-01  1.14049773e-02]
 [-8.61086273e-02  8.10288671e-02 -6.99596690e-02]
 [ 1.20288850e-02  2.87241441e-02  9.56889246e-02]
 [ 6.60944347e-02  4.15197857e-02 -1.35300039e-02]
 [-5.19510589e-02  2.45759639e-02 -6.25134748e-02]
 [-1.37251647e-02 -3.77578704e-02 -4.62511807e-02]
 [-1.63021027e-01 -1.77060994e-01 -1.11277170e-01]
 [ 1.09139199e-01  8.05902209e-02 -1.51346229e-02]
 [-2.38493170e-01 -1.11866012e-01  6.58688803e-02]
 [-8.56772313e-02 -3.66725368e-02  3.26567874e-03]
 [-1.07613879e-01 -1.08241346e-01  5.95769959e-02]
 [ 2.99790009e-01  5.23988004e-01  2.13799976e-01]
 [-5.80810676e-03 -3.74947756e-01 -1.73407605e-02]
 [-6.68041540e-02 -4.40477487e-02 -3.76083110e-02]
 [-6.50097927e-02  2.99666868e-01  1.54429763e-01]
 [-1.59513992e-02  5.45085857e-02 -2.36553625e-02]
 [-4.58147861e-02 -3.05199807e-02  1.37448741e-01]
 [ 1.01718031e-01 -1.09428850e-01  6.09494010e-02]
 [ 1.26244498e-01  4.48021856e-02  2.69612026e-01]
 [ 5.50231963e-02 -9.61888987e-02  3.24809828e-02]
 [-1.97106509e-01 -1.78624571e-01 -4.79603919e-02]
 [-6.78603927e-01  2.06585934e-01 -1.61718057e-02]
 [-9.78879864e-02 -2.14870890e-01  1.19601823e-01]
 [ 2.43375407e-01  4.24464188e-02 -1.39996369e-01]
 [ 5.40603515e-02 -1.37555501e-01 -5.87586790e-02]
 [-1.11227379e-01 -1.23087649e-01 -1.41897088e-01]
 [ 4.04822934e-02  3.14423186e-02 -1.07683834e-01]
 [ 6.94760816e-02 -3.27340646e-02  5.20926892e-02]
 [ 7.03386667e-02 -1.02454916e-01 -8.48182173e-02]
 [ 3.54260130e-01 -3.72814790e-01 -3.33211647e-01]
 [-4.81990517e-02 -8.36927049e-02 -2.54038441e-03]
 [-9.67068298e-02 -4.26721137e-02  2.70833758e-02]
 [-2.13479423e-02 -1.19558800e-01 -9.61293051e-02]
 [-7.10915507e-02 -2.28425159e-01 -4.74489343e-03]
 [-2.01769913e-02  1.46291708e-02 -8.34167869e-02]
 [-3.37114540e-02  2.91387812e-02  2.33005748e-02]
 [-7.58525292e-01  3.79163591e-01  4.63964121e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.26023247 -29.25593426 -29.27334937]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  8.31486419  -9.25153874 -83.50871763]
init_Out:  [2.49911038]
Stock Position:  8.31486419409362
Bond position:  [-828.98730903]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-2.94627739]
curr_Stock_Price:  99.35756522876686
curr_Factors:  [99.35756523 -1.17023673 -0.99592424]
mat_Sqrt:  [[11.38804529  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00239924 -0.02996361 -0.416734  ]
Stock Position:  0.002399238289270184
Bond Position:  [-3.18465986]


portfolio before change:  [-2.94733632]
curr_Stock_Price:  99.0821349393844
curr_Factors:  [99.08213494 -1.1981629  -0.98929027]
mat_Sqrt:  [[11.1172281   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00260998  0.00445752  0.29069019]
Stock Position:  -0.0026099843583948196
Bond Position:  [-2.68873349]


portfolio before change:  [-2.943359]
curr_Stock_Price:  97.4294719194939
curr_Factors:  [97.42947192 -1.38049514 -0.98659406]
mat_Sqrt:  [[ 9.13432737  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00563971  0.03815505  0.03253523]
Stock Position:  -0.00563971417854355
Bond Position:  [-2.39388463]


portfolio before change:  [-2.94445065]
curr_Stock_Price:  97.56997360437491
curr_Factors:  [97.5699736  -1.26034801 -0.99296296]
mat_Sqrt:  [[10.24980654  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00959013  0.02562358 -0.19957546]
Stock Position:  -0.00959012525424358
Bond Position:  [-2.00874238]


portfolio before change:  [-2.93576325]
curr_Stock_Price:  96.63792011753898
curr_Factors:  [96.63792012 -1.3109051  -0.9802523 ]
mat_Sqrt:  [[ 9.77486025  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.0033047  0.00908337 0.27297387]
Stock Position:  0.0033046978027390455
Bond Position:  [-3.25512237]


portfolio before change:  [-2.93436949]
curr_Stock_Price:  97.18280292699372
curr_Factors:  [97.18280293 -1.26473249 -0.9698915 ]
mat_Sqrt:  [[10.40170545  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00619174  0.01312971 -0.03859734]
Stock Position:  0.006191741418570149
Bond Position:  [-3.53610028]


portfolio before change:  [-2.93552252]
curr_Stock_Price:  97.06797442794644
curr_Factors:  [97.06797443 -1.41405771 -0.94333359]
mat_Sqrt:  [[ 9.18912021  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00697314  0.0077716  -0.17833354]
Stock Position:  -0.00697313979106347
Bond Position:  [-2.25865396]


portfolio before change:  [-2.93715536]
curr_Stock_Price:  97.26164569522706
curr_Factors:  [97.2616457  -1.76101326 -0.92704879]
mat_Sqrt:  [[ 6.61501902  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00364943 -0.01194009 -0.13194174]
Stock Position:  -0.0036494303916425512
Bond Position:  [-2.58220576]


portfolio before change:  [-2.93496977]
curr_Stock_Price:  96.57430729234414
curr_Factors:  [96.57430729 -1.70373234 -0.93332125]
mat_Sqrt:  [[ 6.9120008   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02753285 -0.0559916  -0.31744279]
Stock Position:  -0.027532849806553468
Bond Position:  [-0.27600387]


portfolio before change:  [-2.93241855]
curr_Stock_Price:  96.48039328694458
curr_Factors:  [96.48039329 -1.9507124  -0.93538364]
mat_Sqrt:  [[ 5.38298884  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.02008748  0.02548487 -0.04317487]
Stock Position:  0.02008748131083008
Bond Position:  [-4.87046665]


portfolio before change:  [-2.93286728]
curr_Stock_Price:  96.48836432526838
curr_Factors:  [96.48836433 -1.79736076 -0.92076993]
mat_Sqrt:  [[ 6.36804001  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.03579376 -0.03537514  0.18790558]
Stock Position:  -0.035793762090573666
Bond Position:  [0.52081428]


portfolio before change:  [-2.94895434]
curr_Stock_Price:  96.9396207530038
curr_Factors:  [96.93962075 -1.9144455  -0.93508046]
mat_Sqrt:  [[ 5.61006533  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01532202 -0.01159687  0.00931607]
Stock Position:  -0.015322015539899503
Bond Position:  [-1.46364396]


portfolio before change:  [-2.95691374]
curr_Stock_Price:  97.44715419100032
curr_Factors:  [97.44715419 -1.81149415 -0.91220919]
mat_Sqrt:  [[ 6.39557848  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01536179 -0.03422892  0.16995659]
Stock Position:  -0.015361793421086699
Bond Position:  [-1.45995069]


portfolio before change:  [-2.94795003]
curr_Stock_Price:  96.85176718115424
curr_Factors:  [96.85176718 -1.4969126  -0.90678679]
mat_Sqrt:  [[ 8.75375058  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.04077807 0.16569956 0.60991182]
Stock Position:  0.04077807051928992
Bond Position:  [-6.89737822]


portfolio before change:  [-2.95222555]
curr_Stock_Price:  96.76806310191147
curr_Factors:  [96.7680631  -1.71453162 -0.89136709]
mat_Sqrt:  [[ 7.14503924  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00266323 -0.11856889 -0.04946836]
Stock Position:  -0.002663230173682907
Bond Position:  [-2.69450992]


portfolio before change:  [-2.95269212]
curr_Stock_Price:  96.81677592200279
curr_Factors:  [96.81677592 -1.75845344 -0.90228267]
mat_Sqrt:  [[ 6.76717813  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01117426 -0.01392912 -0.10728604]
Stock Position:  -0.011174262722245532
Bond Position:  [-1.87083603]


portfolio before change:  [-2.95538093]
curr_Stock_Price:  97.03647249334027
curr_Factors:  [97.03647249 -1.93015751 -0.90298501]
mat_Sqrt:  [[ 5.70843205  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0045108   0.09476298  0.44054513]
Stock Position:  -0.004510798014515776
Bond Position:  [-2.51766901]


portfolio before change:  [-2.95652276]
curr_Stock_Price:  97.21983232595322
curr_Factors:  [97.21983233 -1.89259041 -0.88287316]
mat_Sqrt:  [[ 6.05879637  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00319744  0.01723713 -0.06748216]
Stock Position:  -0.0031974377506035485
Bond Position:  [-2.6456684]


portfolio before change:  [-2.95684269]
curr_Stock_Price:  97.21645569875685
curr_Factors:  [97.2164557  -1.81646153 -0.89359252]
mat_Sqrt:  [[ 6.46812291  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00286732 -0.00965127  0.392103  ]
Stock Position:  -0.002867323645044748
Bond Position:  [-2.67809165]


portfolio before change:  [-2.95679197]
curr_Stock_Price:  97.08200771401965
curr_Factors:  [97.08200771 -1.83377875 -0.90177835]
mat_Sqrt:  [[ 6.29653168  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01768177 -0.03460444  0.17387168]
Stock Position:  0.01768177159175022
Bond Position:  [-4.67337386]


portfolio before change:  [-2.95205797]
curr_Stock_Price:  97.3827814936635
curr_Factors:  [97.38278149 -1.81734175 -0.88184798]
mat_Sqrt:  [[ 6.54996485  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.02785291 0.0141677  0.76912807]
Stock Position:  0.027852914345444253
Bond Position:  [-5.66445224]


portfolio before change:  [-2.9558795]
curr_Stock_Price:  97.2710003224391
curr_Factors:  [97.27100032 -2.17033912 -0.90758367]
mat_Sqrt:  [[ 4.47979866  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01320813 -0.0304176   0.0926592 ]
Stock Position:  0.013208129842527347
Bond Position:  [-4.2406475]


portfolio before change:  [-2.95795651]
curr_Stock_Price:  97.15388291045574
curr_Factors:  [97.15388291 -2.21298347 -0.91645274]
mat_Sqrt:  [[ 4.24974903  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.04976963 -0.05648605 -0.13681765]
Stock Position:  -0.04976963297952656
Bond Position:  [1.87735658]


portfolio before change:  [-2.95463438]
curr_Stock_Price:  97.09184809538961
curr_Factors:  [97.0918481  -2.14795533 -0.86602554]
mat_Sqrt:  [[ 4.76680629  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.14193381  0.06532821 -0.04613366]
Stock Position:  -0.14193380535391098
Bond Position:  [10.82598109]


portfolio before change:  [-2.97247724]
curr_Stock_Price:  97.2270955815511
curr_Factors:  [97.22709558 -2.01292745 -0.83866993]
mat_Sqrt:  [[ 5.61505881  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01407328 -0.06794814  0.34119071]
Stock Position:  -0.01407328254039928
Bond Position:  [-1.60417285]


portfolio before change:  [-2.97876966]
curr_Stock_Price:  97.65996450931276
curr_Factors:  [97.65996451 -1.77924606 -0.84013447]
mat_Sqrt:  [[ 7.11433072  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.03034646  0.01342274 -0.39937067]
Stock Position:  0.03034645676563239
Bond Position:  [-5.94240355]


portfolio before change:  [-2.97714319]
curr_Stock_Price:  97.73804001712693
curr_Factors:  [97.73804002 -1.5441703  -0.86842762]
mat_Sqrt:  [[ 8.75559493  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00439886 -0.04349887 -0.16762216]
Stock Position:  0.004398857975243521
Bond Position:  [-3.40707895]


portfolio before change:  [-2.97870656]
curr_Stock_Price:  97.47945955759779
curr_Factors:  [97.47945956 -1.42503445 -0.90613941]
mat_Sqrt:  [[ 9.47321007  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01513427 -0.03892373 -0.4047929 ]
Stock Position:  -0.01513426909789948
Bond Position:  [-1.50342619]


portfolio before change:  [-2.96995813]
curr_Stock_Price:  96.88898722948859
curr_Factors:  [96.88898723 -1.22710469 -0.90032672]
mat_Sqrt:  [[11.54363796  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00167307  0.00994293 -0.307192  ]
Stock Position:  0.0016730652961778037
Bond Position:  [-3.13205974]


portfolio before change:  [-2.9709108]
curr_Stock_Price:  96.55359497763246
curr_Factors:  [96.55359498 -1.12763286 -0.86857027]
mat_Sqrt:  [[13.11681656  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00604295 -0.01035142  0.14860594]
Stock Position:  0.006042950053038858
Bond Position:  [-3.55437935]


portfolio before change:  [-2.96816245]
curr_Stock_Price:  97.0819252667884
curr_Factors:  [97.08192527 -1.15118736 -0.85151877]
mat_Sqrt:  [[13.10310313  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00384488 -0.03239909 -0.24196277]
Stock Position:  0.0038448789987808366
Bond Position:  [-3.34143071]


portfolio before change:  [-2.9695271]
curr_Stock_Price:  96.8356385371111
curr_Factors:  [96.83563854 -1.23049724 -0.83212615]
mat_Sqrt:  [[12.30975085  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.02247142 -0.11789439 -0.95056008]
Stock Position:  0.022471417492981993
Bond Position:  [-5.14556116]


portfolio before change:  [-2.95625675]
curr_Stock_Price:  97.45480635287895
curr_Factors:  [97.45480635 -1.26202949 -0.85246028]
mat_Sqrt:  [[11.76229381  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00432556 -0.02646596 -0.00724701]
Stock Position:  -0.00432556291130999
Bond Position:  [-2.53470986]


portfolio before change:  [-2.96006535]
curr_Stock_Price:  98.2620400782536
curr_Factors:  [98.26204008 -1.70221321 -0.82157951]
mat_Sqrt:  [[ 7.87619619  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01171635 -0.01349411  0.07726133]
Stock Position:  -0.011716347057785285
Bond Position:  [-1.80879319]


portfolio before change:  [-2.9601159]
curr_Stock_Price:  98.2470551587361
curr_Factors:  [98.24705516 -1.72392206 -0.85477536]
mat_Sqrt:  [[ 7.45427625  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00591033 -0.03780781 -0.27423015]
Stock Position:  -0.005910332260121392
Bond Position:  [-2.37944316]


portfolio before change:  [-2.96479239]
curr_Stock_Price:  98.98796759458291
curr_Factors:  [98.98796759 -1.67932858 -0.83266658]
mat_Sqrt:  [[ 8.02854367  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00971011 -0.07223438 -0.01353586]
Stock Position:  -0.009710106027019225
Bond Position:  [-2.00360872]


portfolio before change:  [-2.96763423]
curr_Stock_Price:  99.25484160466401
curr_Factors:  [99.2548416  -1.49037036 -0.86925051]
mat_Sqrt:  [[ 9.37521804  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00392808  0.00462615 -0.23796487]
Stock Position:  -0.003928084432750444
Bond Position:  [-2.57775283]


portfolio before change:  [-2.96562688]
curr_Stock_Price:  98.6617829242566
curr_Factors:  [98.66178292 -1.41242467 -0.87992307]
mat_Sqrt:  [[ 9.96770069  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00282943  0.00921449  0.06647005]
Stock Position:  -0.002829427252978658
Bond Position:  [-2.68647054]


portfolio before change:  [-2.96637181]
curr_Stock_Price:  98.80636965270126
curr_Factors:  [98.80636965 -1.3362803  -0.89819017]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-2.96637181]
Stock Price:  98.33577331853458
PL:  [-2.96637181]
Settle:  Tensor("sub_24:0", shape=(), dtype=float64)
PL:  Tensor("sub_25:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  13
output_Z_Vals[:, i, :]:  [[ 1.19260232e+02 -2.92559343e+01 -2.92733494e+01]
 [ 5.12206158e-03 -1.16088365e-01 -3.83136603e-02]
 [-3.05122019e-02  3.70589161e-02  8.29591605e-02]
 [-1.63716937e-03  1.47195953e-01  2.17006184e-02]
 [ 8.03722483e-02  1.64481242e-02 -6.85406089e-02]
 [ 6.74318940e-02  2.96978895e-02  1.42487368e-02]
 [ 2.92780454e-02  4.60804460e-02 -2.52647204e-02]
 [-1.34621599e-01  1.28533238e-01 -4.87784806e-02]
 [ 3.61499893e-02  3.89687157e-03 -9.37190082e-02]
 [-7.04575714e-02  4.48131797e-01  2.15236498e-01]
 [ 5.92196399e-02  4.05442022e-02 -8.12588307e-02]
 [-5.67019528e-02  4.04877180e-02  1.01421914e-02]
 [-4.44400871e-03 -1.54231167e-01 -3.03490149e-02]
 [ 2.59503847e-01  2.10523593e-01  2.98465299e-01]
 [ 7.70871489e-02 -8.48930966e-02 -1.89563711e-01]
 [-7.35664053e-02 -1.08000323e-01 -1.26209362e-01]
 [-8.45042505e-02  6.33457169e-03 -7.37634316e-02]
 [ 1.42768033e-01 -2.37502045e-01 -1.86777640e-01]
 [ 5.91699863e-02  4.07443772e-02  3.94389391e-02]
 [ 1.39073262e-01 -2.65893557e-01 -1.41552113e-02]
 [ 3.47749651e-01  4.55722883e-03  4.96267324e-01]
 [-8.09498263e-02  5.04616809e-02 -7.89900732e-02]
 [-1.46274581e-01  3.51699193e-01  3.73533754e-01]
 [ 2.18372337e-01 -2.88659641e-02  3.23681236e-02]
 [-7.07794136e-02 -1.99899245e-02 -5.57456798e-02]
 [ 1.02997187e-01  1.13285131e-03  5.63106805e-02]
 [-6.67927578e-02  9.99541213e-02  1.01249493e-01]
 [-5.02771453e-02  7.32281163e-02  2.92202054e-02]
 [ 5.34483547e-02 -2.90786856e-02  9.78797620e-02]
 [-9.56003137e-02 -1.56303697e-01 -6.77332326e-04]
 [-1.64761250e-01  7.53679335e-01 -3.08567718e-02]
 [ 5.87672944e-02  1.03685448e-01  2.00218120e-01]
 [-6.60716506e-02  2.27031835e-02  8.38011601e-02]
 [-4.72786795e-01  4.32518656e-02  3.14548180e-02]
 [-1.14715512e-01  1.69489860e-02  3.65864806e-02]
 [ 8.83399839e-02 -1.63480246e-01 -1.36874375e-01]
 [-3.25570257e-01 -5.95560094e-01  1.77626855e-01]
 [-7.25382149e-02 -9.47689691e-02  1.65085151e-01]
 [-7.56443356e-03  1.75990502e-02 -4.37262289e-02]
 [ 3.39871776e-01 -2.30369485e-02 -3.46121412e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.26023247 -29.25593426 -29.27334937]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  8.31486419  -9.25153874 -83.50871763]
init_Out:  [2.49911038]
Stock Position:  8.31486419409362
Bond position:  [-828.98730903]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [1.49863047]
curr_Stock_Price:  99.89213894577847
curr_Factors:  [99.89213895 -0.97576748 -0.98583041]
mat_Sqrt:  [[14.0481836   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00040547 -0.03671036 -0.10929821]
Stock Position:  -0.00040546667371958343
Bond Position:  [1.53913341]


portfolio before change:  [1.49888497]
curr_Stock_Price:  99.73900716273623
curr_Factors:  [99.73900716 -1.13209794 -0.98572856]
mat_Sqrt:  [[11.99788456  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00105197  0.01171906  0.23665939]
Stock Position:  -0.001051966868296621
Bond Position:  [1.6038071]


portfolio before change:  [1.49975039]
curr_Stock_Price:  99.10691788092021
curr_Factors:  [99.10691788 -1.08214045 -0.97161444]
mat_Sqrt:  [[12.71070251  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.0005187  0.04654745 0.06190582]
Stock Position:  0.0005186994167177118
Bond Position:  [1.44834369]


portfolio before change:  [1.5000448]
curr_Stock_Price:  99.32544676733477
curr_Factors:  [99.32544677 -0.90157938 -0.95404263]
mat_Sqrt:  [[15.53009551  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00430172  0.00520135 -0.19552728]
Stock Position:  0.004301721373518413
Bond Position:  [1.0727744]


portfolio before change:  [1.5041418]
curr_Stock_Price:  100.24668128477171
curr_Factors:  [100.24668128  -0.69277052  -0.95214276]
mat_Sqrt:  [[19.3505469   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00367469 0.0093913  0.04064768]
Stock Position:  0.0036746869128145227
Bond Position:  [1.13576663]


portfolio before change:  [1.50133073]
curr_Stock_Price:  99.4430630250148
curr_Factors:  [99.44306303 -0.53032254 -0.94723891]
mat_Sqrt:  [[22.69225773  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00111539  0.01457192 -0.07207322]
Stock Position:  0.0011153891431886895
Bond Position:  [1.39041302]


portfolio before change:  [1.5024428]
curr_Stock_Price:  100.28425329855102
curr_Factors:  [100.2842533   -0.56994199  -0.954914  ]
mat_Sqrt:  [[21.8271084   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00647176  0.04064578 -0.13915143]
Stock Position:  -0.006471757432778928
Bond Position:  [2.15145816]


portfolio before change:  [1.49653111]
curr_Stock_Price:  101.23927064502996
curr_Factors:  [101.23927065  -0.43280039  -0.95094248]
mat_Sqrt:  [[25.37447768  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00067471  0.0012323  -0.26735424]
Stock Position:  0.0006747052656569
Bond Position:  [1.42822444]


portfolio before change:  [1.49617578]
curr_Stock_Price:  100.4480132202752
curr_Factors:  [100.44801322  -0.39471028  -0.9817544 ]
mat_Sqrt:  [[25.36006346  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-5.89584172e-04  1.41711717e-01  6.14009818e-01]
Stock Position:  -0.0005895841718333935
Bond Position:  [1.55539834]


portfolio before change:  [1.49575301]
curr_Stock_Price:  101.49486702477125
curr_Factors:  [101.49486702  -0.38458674  -1.00057615]
mat_Sqrt:  [[25.40244265  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0017195   0.0128212  -0.23180883]
Stock Position:  0.0017195038283614873
Bond Position:  [1.3212322]


portfolio before change:  [1.49596046]
curr_Stock_Price:  101.51946164258398
curr_Factors:  [101.51946164  -0.42704665  -0.98610603]
mat_Sqrt:  [[24.7072776   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00216885  0.01280334  0.02893285]
Stock Position:  -0.0021688467299991717
Bond Position:  [1.71614062]


portfolio before change:  [1.49238806]
curr_Stock_Price:  103.26552097539793
curr_Factors:  [103.26552098  -0.40905122  -1.00686298]
mat_Sqrt:  [[25.06291712  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00058338 -0.04877218 -0.08657729]
Stock Position:  -0.0005833800975683683
Bond Position:  [1.55263111]


portfolio before change:  [1.49272094]
curr_Stock_Price:  103.02760625091952
curr_Factors:  [103.02760625  -0.36928298  -1.00572075]
mat_Sqrt:  [[26.04936103  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01250946 0.06657341 0.85143842]
Stock Position:  0.012509462952232958
Bond Position:  [0.20390092]


portfolio before change:  [1.49035607]
curr_Stock_Price:  102.83652183957
curr_Factors:  [102.83652184  -0.34545352  -1.02693876]
mat_Sqrt:  [[26.06903666  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00138865 -0.02684555 -0.5407725 ]
Stock Position:  0.001388646945260543
Bond Position:  [1.34755245]


portfolio before change:  [1.48990924]
curr_Stock_Price:  102.39343666178571
curr_Factors:  [102.39343666  -0.26411015  -1.00897468]
mat_Sqrt:  [[28.66674644  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00356222 -0.0341527  -0.36004018]
Stock Position:  -0.0035622228670766265
Bond Position:  [1.85465748]


portfolio before change:  [1.48433205]
curr_Stock_Price:  104.0241695708989
curr_Factors:  [ 1.04024170e+02 -5.72322386e-02 -1.00002192e+00]
mat_Sqrt:  [[36.1388735   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00275043  0.00200317 -0.21042654]
Stock Position:  -0.0027504341004246607
Bond Position:  [1.77044367]


portfolio before change:  [1.47862464]
curr_Stock_Price:  106.1797310254546
curr_Factors:  [106.17973103  -0.16702023  -1.02694699]
mat_Sqrt:  [[32.17423632  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00306176 -0.07510474 -0.53282462]
Stock Position:  0.003061764377592592
Bond Position:  [1.15352732]


portfolio before change:  [1.48134467]
curr_Stock_Price:  107.02101971078146
curr_Factors:  [107.02101971  -0.35900185  -1.01404958]
mat_Sqrt:  [[27.11192954  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00251817 0.0128845  0.11250832]
Stock Position:  0.002518169767863872
Bond Position:  [1.21184757]


portfolio before change:  [1.48050765]
curr_Stock_Price:  106.62846953704941
curr_Factors:  [106.62846954  -0.33145664  -0.94718504]
mat_Sqrt:  [[29.68698907  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00435607 -0.08408293 -0.04038088]
Stock Position:  0.004356066536268159
Bond Position:  [1.01602694]


portfolio before change:  [1.47996201]
curr_Stock_Price:  106.47405259153325
curr_Factors:  [106.47405259  -0.30764303  -0.93391229]
mat_Sqrt:  [[30.76402507  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01460041 0.00144112 1.41571254]
Stock Position:  0.014600412660985511
Bond Position:  [-0.0746031]


portfolio before change:  [1.47664079]
curr_Stock_Price:  106.24721727428391
curr_Factors:  [106.24721727  -0.38944458  -0.96385309]
mat_Sqrt:  [[27.4528762   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00348855  0.01595738 -0.22533669]
Stock Position:  -0.003488548588120027
Bond Position:  [1.84728937]


portfolio before change:  [1.48391599]
curr_Stock_Price:  104.22796123501149
curr_Factors:  [104.22796124  -0.37327419  -0.97521439]
mat_Sqrt:  [[27.06095361  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00225219  0.11121705  1.06558783]
Stock Position:  -0.0022521929402659125
Bond Position:  [1.71865747]


portfolio before change:  [1.48308519]
curr_Stock_Price:  104.69224066061098
curr_Factors:  [104.69224066  -0.40412089  -0.98909026]
mat_Sqrt:  [[25.99265116  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00862683 -0.00912822  0.09233725]
Stock Position:  0.008626828233011127
Bond Position:  [0.57992321]


portfolio before change:  [1.4888969]
curr_Stock_Price:  105.3575156982955
curr_Factors:  [105.3575157   -0.51599215  -0.99932462]
mat_Sqrt:  [[23.15110958  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00357109 -0.00632137 -0.15902691]
Stock Position:  -0.003571085445042837
Bond Position:  [1.86513759]


portfolio before change:  [1.4889429]
curr_Stock_Price:  105.40992485382121
curr_Factors:  [105.40992485  -0.62084406  -0.99052674]
mat_Sqrt:  [[21.04127522  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00544267 0.00035824 0.1606387 ]
Stock Position:  0.005442674227373258
Bond Position:  [0.91523102]


portfolio before change:  [1.49733036]
curr_Stock_Price:  106.92995830047549
curr_Factors:  [106.9299583   -0.73412767  -1.00314754]
mat_Sqrt:  [[18.81959875  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00231378  0.03160827  0.28883662]
Stock Position:  -0.002313784040397277
Bond Position:  [1.74474319]


portfolio before change:  [1.49337753]
curr_Stock_Price:  108.73260219611808
curr_Factors:  [108.7326022   -0.76307353  -1.00786076]
mat_Sqrt:  [[18.50345336  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00229265  0.02315676  0.08335711]
Stock Position:  -0.0022926452255420315
Bond Position:  [1.74266282]


portfolio before change:  [1.49519837]
curr_Stock_Price:  108.03341378823096
curr_Factors:  [108.03341379  -0.70242797  -1.01137511]
mat_Sqrt:  [[19.46537964  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00373366 -0.00919549  0.27922372]
Stock Position:  0.0037336630657196714
Bond Position:  [1.091838]


portfolio before change:  [1.49569462]
curr_Stock_Price:  108.1297695268617
curr_Factors:  [108.12976953  -0.48871155  -0.98538852]
mat_Sqrt:  [[24.76006325  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00402965 -0.04942757 -0.00193224]
Stock Position:  -0.004029647125968185
Bond Position:  [1.93141943]


portfolio before change:  [1.49183572]
curr_Stock_Price:  109.14731293840237
curr_Factors:  [109.14731294  -0.69528629  -1.00247928]
mat_Sqrt:  [[19.98401876  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00758606  0.23833433 -0.08802578]
Stock Position:  -0.007586059011784708
Bond Position:  [2.31983368]


portfolio before change:  [1.49335084]
curr_Stock_Price:  108.98581591695661
curr_Factors:  [108.98581592  -0.84793531  -1.02787425]
mat_Sqrt:  [[16.69999097  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00612658 0.03278822 0.57116657]
Stock Position:  0.006126577782068939
Bond Position:  [0.82564077]


portfolio before change:  [1.49398907]
curr_Stock_Price:  109.07314342302433
curr_Factors:  [109.07314342  -0.9011425   -1.02908303]
mat_Sqrt:  [[15.82820021  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00305655  0.00717938  0.23906138]
Stock Position:  -0.003056545668150324
Bond Position:  [1.82737612]


portfolio before change:  [1.49031363]
curr_Stock_Price:  110.35036334109147
curr_Factors:  [110.35036334  -0.84995514  -1.02949218]
mat_Sqrt:  [[16.84768241  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02761504  0.01367744  0.08973184]
Stock Position:  -0.027615035530466802
Bond Position:  [4.53764283]


portfolio before change:  [1.50596127]
curr_Stock_Price:  109.80426943689324
curr_Factors:  [109.80426944  -0.75137705  -1.03046671]
mat_Sqrt:  [[18.4830786   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00577878  0.00535974  0.10437105]
Stock Position:  -0.0057787833295812755
Bond Position:  [2.14049636]


portfolio before change:  [1.50609866]
curr_Stock_Price:  109.82679965432588
curr_Factors:  [109.82679965  -0.60892482  -1.01652547]
mat_Sqrt:  [[21.6164432   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00259893 -0.05169699 -0.39046449]
Stock Position:  0.0025989279038516134
Bond Position:  [1.22066672]


portfolio before change:  [1.5102516]
curr_Stock_Price:  111.36603146552359
curr_Factors:  [111.36603147  -0.67229632  -1.04278844]
mat_Sqrt:  [[20.04014668  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01520396 -0.18833264  0.50671998]
Stock Position:  -0.015203961684071364
Bond Position:  [3.20345648]


portfolio before change:  [1.52679478]
curr_Stock_Price:  110.30428691317405
curr_Factors:  [110.30428691  -0.53319254  -1.05617516]
mat_Sqrt:  [[22.50809672  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00183433 -0.02996858  0.47094198]
Stock Position:  -0.0018343298591666326
Bond Position:  [1.72912923]


portfolio before change:  [1.524036]
curr_Stock_Price:  111.92609982630741
curr_Factors:  [111.92609983  -0.483259    -1.05642451]
mat_Sqrt:  [[24.00243601  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00066808  0.00556531 -0.12473876]
Stock Position:  -0.0006680824869104843
Bond Position:  [1.59881186]


portfolio before change:  [1.52412037]
curr_Stock_Price:  112.09897019532576
curr_Factors:  [112.0989702   -0.43977696  -1.04951151]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [1.52412037]
Stock Price:  112.06123679941103
PL:  [-10.53711643]
Settle:  Tensor("sub_26:0", shape=(), dtype=float64)
PL:  Tensor("sub_27:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  14
output_Z_Vals[:, i, :]:  [[ 1.19260232e+02 -2.92559343e+01 -2.92733494e+01]
 [ 4.65126664e-02  2.23055515e-02 -8.50488968e-02]
 [ 1.79779988e-02  1.42706709e-02 -2.03544588e-02]
 [ 8.81973274e-02  1.99684068e-01  3.83489437e-02]
 [ 2.13882555e-01 -2.87447016e-02 -5.60056436e-02]
 [ 7.47313994e-02  2.96270821e-02 -9.03635869e-02]
 [ 4.81326311e-02  3.66170527e-02 -4.31774372e-02]
 [-1.24659481e-01  2.30758403e-01  1.67212219e-03]
 [ 6.08331361e-02 -4.33347187e-02 -1.99391323e-02]
 [-3.48782436e-02 -5.81838764e-02 -1.03245879e-01]
 [ 1.00751124e-01  8.16062214e-02 -3.95045400e-02]
 [-2.09494111e-01 -1.01358365e-01  4.83302768e-02]
 [-1.14381596e-01  4.81663601e-02 -2.65709671e-02]
 [-9.62623594e-02 -1.14884369e-01  6.32126881e-02]
 [ 2.17846870e-01  2.80242313e-01  4.31465335e-02]
 [-7.72798469e-02 -8.74224395e-02 -1.11823516e-01]
 [-7.23209616e-02 -5.48251710e-02 -5.19293324e-02]
 [-8.59360522e-02 -2.69953526e-02  6.79440878e-02]
 [ 4.94563979e-02  6.30033230e-02  4.95036136e-02]
 [ 1.11277348e-01 -3.56747749e-02  3.29634580e-02]
 [-5.18756595e-02  4.93907140e-03 -3.83011609e-02]
 [ 6.21484386e-02 -4.83661299e-02  6.04012301e-02]
 [-4.92968009e-02  4.82679775e-03  2.37224618e-01]
 [-6.23908978e-02 -7.13420752e-04 -8.38165220e-02]
 [-2.57632879e-01  9.94258767e-02  7.08058544e-02]
 [ 1.16149028e-02 -9.25530068e-02  8.45815420e-02]
 [ 7.75856656e-02  4.71135983e-02 -6.85831917e-02]
 [-5.00407674e-02  7.30429062e-02  2.91504715e-02]
 [-6.49122635e-02 -5.91456910e-02 -2.21879580e-01]
 [ 8.96157825e-03 -9.75907692e-03 -1.19836521e-01]
 [ 4.46988948e-02  9.54994770e-02  1.68681315e-02]
 [ 2.30382154e-02 -7.36277282e-02 -8.40477371e-02]
 [ 2.23269245e-01 -1.03494287e-01  4.24798121e-02]
 [-4.36951530e-02 -7.92957264e-02  9.84982923e-03]
 [-2.03010093e-01  1.24553235e-01  1.82234135e-02]
 [ 1.68279489e-01 -8.12384180e-02 -4.85056296e-02]
 [ 2.81737189e-02  5.93960946e-02 -1.01438317e-01]
 [-2.62368216e-02  2.73219743e-02 -5.30203153e-02]
 [ 8.86995525e-03  1.28448605e-02 -1.09733641e-02]
 [-2.77576480e-01  1.51502816e-01  1.67568728e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.26023247 -29.25593426 -29.27334937]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  8.31486419  -9.25153874 -83.50871763]
init_Out:  [2.49911038]
Stock Position:  8.31486419409362
Bond position:  [-828.98730903]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-4.6694318]
curr_Stock_Price:  99.15032739883208
curr_Factors:  [99.1503274  -0.86225238 -0.99421607]
mat_Sqrt:  [[15.48959814  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00191923  0.00705363 -0.24262083]
Stock Position:  0.001919227315520634
Bond Position:  [-4.85972381]


portfolio before change:  [-4.66661337]
curr_Stock_Price:  100.93538424199052
curr_Factors:  [100.93538424  -1.10676378  -0.99140864]
mat_Sqrt:  [[12.38279646  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00114608  0.00451278 -0.05806561]
Stock Position:  0.0011460762930068328
Bond Position:  [-4.78229302]


portfolio before change:  [-4.66750734]
curr_Stock_Price:  100.67698909697971
curr_Factors:  [100.6769891   -1.40789171  -0.97024293]
mat_Sqrt:  [[ 9.33511053  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01083877 0.06314565 0.10939886]
Stock Position:  0.010838767562833843
Bond Position:  [-5.75872182]


portfolio before change:  [-4.67196087]
curr_Stock_Price:  100.33251766323318
curr_Factors:  [100.33251766  -1.24640988  -0.96416069]
mat_Sqrt:  [[11.00026409  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01833667 -0.00908987 -0.15976851]
Stock Position:  0.018336674879014594
Bond Position:  [-6.51172562]


portfolio before change:  [-4.67705564]
curr_Stock_Price:  100.09906448253068
curr_Factors:  [100.09906448  -1.19890231  -0.95755024]
mat_Sqrt:  [[11.58496098  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00492457  0.00936891 -0.25778216]
Stock Position:  0.004924572258914064
Bond Position:  [-5.17000071]


portfolio before change:  [-4.67493711]
curr_Stock_Price:  100.66049870153286
curr_Factors:  [100.6604987   -1.20562718  -0.95814133]
mat_Sqrt:  [[11.5650191   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00348158  0.01157933 -0.12317321]
Stock Position:  0.0034815785031895845
Bond Position:  [-5.02539453]


portfolio before change:  [-4.67458004]
curr_Stock_Price:  100.94349536460093
curr_Factors:  [100.94349536  -1.08520321  -0.93968373]
mat_Sqrt:  [[13.32542644  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00888227  0.07297221  0.0047701 ]
Stock Position:  -0.008882267670538553
Bond Position:  [-3.7779729]


portfolio before change:  [-4.66156499]
curr_Stock_Price:  99.42503964663126
curr_Factors:  [99.42503965 -0.74763163 -0.92882443]
mat_Sqrt:  [[18.59602666  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00299226 -0.01370364 -0.05688079]
Stock Position:  0.0029922617984916235
Bond Position:  [-4.95907074]


portfolio before change:  [-4.66383795]
curr_Stock_Price:  98.872602907161
curr_Factors:  [98.87260291 -0.70298802 -0.92176679]
mat_Sqrt:  [[19.47394421  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00295038 -0.01839936 -0.29453176]
Stock Position:  -0.002950379290055896
Bond Position:  [-4.37212627]


portfolio before change:  [-4.65987021]
curr_Stock_Price:  97.34253293416832
curr_Factors:  [97.34253293 -0.81369969 -0.92062352]
mat_Sqrt:  [[17.18286758  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00551679  0.02580615 -0.11269546]
Stock Position:  0.005516794962664455
Bond Position:  [-5.19688901]


portfolio before change:  [-4.66340397]
curr_Stock_Price:  96.81974665291169
curr_Factors:  [96.81974665 -0.82850736 -0.93297399]
mat_Sqrt:  [[16.63268308  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01215954 -0.03205233  0.13787283]
Stock Position:  -0.012159541249110147
Bond Position:  [-3.48612026]


portfolio before change:  [-4.68596362]
curr_Stock_Price:  98.6392116407517
curr_Factors:  [98.63921164 -1.01845599 -0.94072424]
mat_Sqrt:  [[13.90555817  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00852621  0.01523154 -0.07579957]
Stock Position:  -0.008526210903517916
Bond Position:  [-3.8449449]


portfolio before change:  [-4.68961108]
curr_Stock_Price:  99.01063206258279
curr_Factors:  [99.01063206 -0.85401861 -0.97495093]
mat_Sqrt:  [[15.89902363  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00542961 -0.03632963  0.1803282 ]
Stock Position:  -0.005429605438323415
Bond Position:  [-4.15202241]


portfolio before change:  [-4.69631264]
curr_Stock_Price:  100.1493010256306
curr_Factors:  [100.14930103  -0.9455864   -0.9850424 ]
mat_Sqrt:  [[14.52735301  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01609997 0.0886204  0.12308505]
Stock Position:  0.016099969765128605
Bond Position:  [-6.30871335]


portfolio before change:  [-4.68359303]
curr_Stock_Price:  100.98832408438817
curr_Factors:  [100.98832408  -0.79186794  -0.99235691]
mat_Sqrt:  [[16.95868451  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00603602 -0.0276454  -0.31900137]
Stock Position:  -0.006036020319113444
Bond Position:  [-4.07402545]


portfolio before change:  [-4.68247068]
curr_Stock_Price:  100.71800794311767
curr_Factors:  [100.71800794  -0.85046524  -1.00113735]
mat_Sqrt:  [[15.81125484  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00533396 -0.01733724 -0.14813993]
Stock Position:  -0.005333958174424701
Bond Position:  [-4.14524504]


portfolio before change:  [-4.68385764]
curr_Stock_Price:  100.8808845851386
curr_Factors:  [100.88088459  -0.67754995  -0.97012862]
mat_Sqrt:  [[19.41919268  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00374702 -0.00853668  0.19382557]
Stock Position:  -0.0037470167546731635
Bond Position:  [-4.30585528]


portfolio before change:  [-4.68490893]
curr_Stock_Price:  101.01779951585021
curr_Factors:  [101.01779952  -0.82228034  -0.99387891]
mat_Sqrt:  [[16.43046915  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00372406 0.0199234  0.14122003]
Stock Position:  0.003724057962823903
Bond Position:  [-5.06110507]


portfolio before change:  [-4.69037944]
curr_Stock_Price:  99.7187246226025
curr_Factors:  [99.71872462 -0.68451603 -0.98693507]
mat_Sqrt:  [[18.74453734  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00624635 -0.01128135  0.09403557]
Stock Position:  0.006246346078935924
Bond Position:  [-5.3132571]


portfolio before change:  [-4.68133929]
curr_Stock_Price:  101.27232905138723
curr_Factors:  [101.27232905  -1.03441672  -1.01935068]
mat_Sqrt:  [[12.98825928  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00458617  0.00156187 -0.10926255]
Stock Position:  -0.004586166914983008
Bond Position:  [-4.21688748]


portfolio before change:  [-4.68339372]
curr_Stock_Price:  101.60534928774376
curr_Factors:  [101.60534929  -1.01235193  -1.00479692]
mat_Sqrt:  [[13.51698901  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00541755 -0.01529471  0.1723079 ]
Stock Position:  0.00541755119618296
Bond Position:  [-5.2338459]


portfolio before change:  [-4.69099006]
curr_Stock_Price:  100.32394561753229
curr_Factors:  [100.32394562  -0.93533436  -1.0094851 ]
mat_Sqrt:  [[14.34763255  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-5.21968374e-05  1.52636747e-03  6.76735805e-01]
Stock Position:  -5.219683740850792e-05
Bond Position:  [-4.68575347]


portfolio before change:  [-4.69154434]
curr_Stock_Price:  99.72095577300514
curr_Factors:  [99.72095577 -0.85755531 -0.99824515]
mat_Sqrt:  [[15.58915357  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-5.10087310e-03 -2.25603451e-04 -2.39105207e-01]
Stock Position:  -0.005100873104526504
Bond Position:  [-4.1828804]


portfolio before change:  [-4.68679141]
curr_Stock_Price:  98.6866578581667
curr_Factors:  [98.68665786 -0.7487652  -0.98155524]
mat_Sqrt:  [[17.49000042  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01375715  0.03144122  0.20198939]
Stock Position:  -0.01375714829860765
Bond Position:  [-3.32914442]


portfolio before change:  [-4.70828569]
curr_Stock_Price:  100.21881462961878
curr_Factors:  [100.21881463  -0.8015023   -1.01372252]
mat_Sqrt:  [[16.31575367  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0016236  -0.02926783  0.2412876 ]
Stock Position:  0.0016236043977818256
Bond Position:  [-4.8710014]


portfolio before change:  [-4.71007381]
curr_Stock_Price:  99.49252554917547
curr_Factors:  [99.49252555 -0.80106421 -1.01175487]
mat_Sqrt:  [[16.23652682  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00399116  0.01489863 -0.19564876]
Stock Position:  0.00399116441744863
Bond Position:  [-5.10716484]


portfolio before change:  [-4.71007729]
curr_Stock_Price:  99.65161639290233
curr_Factors:  [99.65161639 -0.7660155  -1.01626432]
mat_Sqrt:  [[16.76679511  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00251715  0.0230982   0.08315818]
Stock Position:  -0.0025171472708885095
Bond Position:  [-4.45923949]


portfolio before change:  [-4.71118692]
curr_Stock_Price:  99.87098892496584
curr_Factors:  [99.87098892 -1.01115343 -1.0286504 ]
mat_Sqrt:  [[12.98864364  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00860216 -0.01870351 -0.63296068]
Stock Position:  -0.00860215904740507
Bond Position:  [-3.85208079]


portfolio before change:  [-4.70414796]
curr_Stock_Price:  98.99673158689076
curr_Factors:  [98.99673159 -0.86311567 -1.01416007]
mat_Sqrt:  [[15.14713027  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00103993 -0.00308609 -0.34186024]
Stock Position:  -0.0010399281643737558
Bond Position:  [-4.60119847]


portfolio before change:  [-4.70464221]
curr_Stock_Price:  98.91890310444434
curr_Factors:  [98.9189031  -0.84558004 -1.05071576]
mat_Sqrt:  [[14.85006969  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00340792 0.03019959 0.04812008]
Stock Position:  0.0034079216243985393
Bond Position:  [-5.04175008]


portfolio before change:  [-4.70521671]
curr_Stock_Price:  98.93526389019085
curr_Factors:  [98.93526389 -0.81736519 -1.05258368]
mat_Sqrt:  [[15.24904475  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00026106 -0.02328313 -0.2397648 ]
Stock Position:  0.00026106442984582216
Bond Position:  [-4.73104519]


portfolio before change:  [-4.70582153]
curr_Stock_Price:  98.88392277707834
curr_Factors:  [98.88392278 -0.56456783 -1.05183059]
mat_Sqrt:  [[19.63960603  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01167377 -0.03272777  0.12118308]
Stock Position:  0.011673767247236703
Bond Position:  [-5.86016943]


portfolio before change:  [-4.71691027]
curr_Stock_Price:  97.99679040560426
curr_Factors:  [97.99679041 -0.24084076 -1.02265112]
mat_Sqrt:  [[27.70028895  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00157876 -0.02507551  0.02809882]
Stock Position:  -0.0015787550796288836
Bond Position:  [-4.56219734]


portfolio before change:  [-4.71558569]
curr_Stock_Price:  96.79654543184272
curr_Factors:  [96.79654543 -0.35376768 -1.02610634]
mat_Sqrt:  [[24.35500273  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00805068  0.03938719  0.05198633]
Stock Position:  -0.008050678779158691
Bond Position:  [-3.9363078]


portfolio before change:  [-4.71533025]
curr_Stock_Price:  96.70369421721172
curr_Factors:  [96.70369422 -0.41475846 -1.0135471 ]
mat_Sqrt:  [[23.18130286  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00674167 -0.02568984 -0.13837306]
Stock Position:  0.0067416724945163565
Bond Position:  [-5.36727488]


portfolio before change:  [-4.71316523]
curr_Stock_Price:  97.1243571593005
curr_Factors:  [97.12435716 -0.20829475 -1.00927082]
mat_Sqrt:  [[28.74393     0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00031316  0.01878269 -0.28937528]
Stock Position:  0.000313155145236498
Bond Position:  [-4.74358022]


portfolio before change:  [-4.71352923]
curr_Stock_Price:  97.85556940830232
curr_Factors:  [97.85556941 -0.2401682  -1.01262352]
mat_Sqrt:  [[27.95793024  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00130031  0.00863997 -0.1512522 ]
Stock Position:  -0.0013003143453468853
Bond Position:  [-4.58628623]


portfolio before change:  [-4.71561682]
curr_Stock_Price:  99.0201142209895
curr_Factors:  [99.02011422 -0.27776121 -1.03024905]
mat_Sqrt:  [[26.77082659  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00026005  0.0040619  -0.03130395]
Stock Position:  0.00026004723946570867
Bond Position:  [-4.74136673]


portfolio before change:  [-4.71533713]
curr_Stock_Price:  102.37488410719169
curr_Factors:  [102.37488411  -0.40395573  -1.01447015]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-4.71533713]
Stock Price:  103.09235518994059
PL:  [-7.80769232]
Settle:  Tensor("sub_28:0", shape=(), dtype=float64)
PL:  Tensor("sub_29:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  15
output_Z_Vals[:, i, :]:  [[ 1.19260232e+02 -2.92559343e+01 -2.92733494e+01]
 [-7.84046303e-02  1.81220611e-01  2.14364598e-02]
 [-2.67708856e-02 -3.09426274e-02 -2.90193625e-02]
 [ 8.38344477e-02  1.60012275e-01  3.78189318e-02]
 [ 2.25918557e-01 -2.18467674e-02 -4.25889736e-02]
 [ 7.39986523e-02  3.12736104e-02 -6.14280943e-04]
 [ 4.91336821e-02  3.55628873e-02 -4.35296071e-02]
 [-1.37364072e-01  9.84747876e-02 -6.34397076e-02]
 [-1.51597177e-01 -7.72047710e-02  1.46645077e-01]
 [-2.58874014e-02 -5.90468765e-02 -1.07704981e-01]
 [ 5.67067739e-02  1.70810760e-01 -8.45095377e-02]
 [-3.84321559e-02  6.19244816e-02 -3.29438411e-03]
 [-9.55852169e-02  1.03338519e-02 -5.42732792e-02]
 [-9.27943536e-03  5.19446807e-03  1.30958125e-01]
 [ 2.49026694e-01  3.80056852e-01  1.16144904e-01]
 [-7.19217033e-02 -7.07195296e-02 -1.08508286e-01]
 [-7.62739850e-02 -3.73289722e-02 -7.11564193e-02]
 [-7.85602783e-02  1.69685337e-01  1.27494409e-01]
 [ 1.20533553e-01  6.48894076e-02  1.36946918e-01]
 [ 1.20738763e-01 -4.26045836e-02  3.81149402e-02]
 [-3.23099281e-02 -1.54611097e-02 -2.46767753e-02]
 [ 1.03750001e-01 -6.26842494e-02  1.06859804e-01]
 [-4.23766948e-03 -1.45713817e-01  9.54448068e-02]
 [-4.20666053e-02 -2.51101717e-03 -8.97602731e-02]
 [-2.27476995e-01  1.04904901e-01  4.12175040e-02]
 [ 2.08697503e-02 -8.19282659e-02  8.15891182e-02]
 [-7.09751663e-02  5.47569348e-02 -1.59922579e-02]
 [-7.78990752e-03  3.68548867e-02  1.83257366e-02]
 [-7.57487968e-02 -7.09328051e-02 -2.05921376e-01]
 [ 7.21706621e-03 -5.09686533e-03 -1.14302753e-01]
 [ 5.12651644e-02  6.38686241e-02  2.94060553e-02]
 [ 1.50225273e-02 -6.18154831e-02 -8.98741698e-02]
 [ 1.84847810e-01 -1.56835219e-01 -6.76941913e-02]
 [-4.77669349e-02 -8.32708463e-02 -1.35163210e-03]
 [-1.86833937e-01  1.51442426e-01  2.58453619e-02]
 [ 1.30102560e-01 -1.37535793e-01 -1.00518383e-01]
 [-8.63365748e-03 -8.87567207e-02 -8.15650664e-02]
 [-2.62313321e-02  2.48309752e-02 -5.76355605e-02]
 [ 1.97056315e-02 -5.15647028e-02  1.24862650e-03]
 [-8.43778099e-01  4.19020703e-01  5.17202728e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.26023247 -29.25593426 -29.27334937]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  8.31486419  -9.25153874 -83.50871763]
init_Out:  [2.49911038]
Stock Position:  8.31486419409362
Bond position:  [-828.98730903]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [8.19425796]
curr_Stock_Price:  100.69739893899397
curr_Factors:  [100.69739894  -1.25495112  -1.02362732]
mat_Sqrt:  [[10.31440567  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00672359  0.05730699  0.06115225]
Stock Position:  -0.0067235900369139266
Bond Position:  [8.87130599]


portfolio before change:  [8.19499581]
curr_Stock_Price:  100.7525971224353
curr_Factors:  [100.75259712  -1.20139913  -0.99981343]
mat_Sqrt:  [[11.15017756  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00300384 -0.00978492 -0.08278416]
Stock Position:  -0.0030038421554329283
Bond Position:  [8.49764071]


portfolio before change:  [8.19428579]
curr_Stock_Price:  101.34260647800593
curr_Factors:  [101.34260648  -1.05178677  -1.01845461]
mat_Sqrt:  [[12.78490954  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00748427 0.05060032 0.10788689]
Stock Position:  0.007484269144743813
Bond Position:  [7.43581044]


portfolio before change:  [8.19598624]
curr_Stock_Price:  101.44561128825634
curr_Factors:  [101.44561129  -1.08229996  -1.03854907]
mat_Sqrt:  [[12.16634795  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01780822 -0.00690855 -0.12149449]
Stock Position:  0.017808223021934737
Bond Position:  [6.38942017]


portfolio before change:  [8.18189101]
curr_Stock_Price:  100.60925854919904
curr_Factors:  [100.60925855  -1.0740592   -1.02788293]
mat_Sqrt:  [[12.29634615  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00607341  0.00988958 -0.00175237]
Stock Position:  0.006073409366459988
Bond Position:  [7.57084979]


portfolio before change:  [8.18365296]
curr_Stock_Price:  100.7435381422009
curr_Factors:  [100.74353814  -1.20599836  -1.04112642]
mat_Sqrt:  [[10.64886463  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00386581  0.01124597 -0.12417785]
Stock Position:  0.0038658081919262085
Bond Position:  [7.79419776]


portfolio before change:  [8.18269709]
curr_Stock_Price:  100.24423720137636
curr_Factors:  [100.2442372   -1.10284209  -1.06913148]
mat_Sqrt:  [[11.42308161  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01293618  0.03114046 -0.18097583]
Stock Position:  -0.012936179985735003
Bond Position:  [9.47947459]


portfolio before change:  [8.18558163]
curr_Stock_Price:  100.11285885748846
curr_Factors:  [100.11285886  -1.3305098   -1.06806148]
mat_Sqrt:  [[ 9.09501853  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0135961  -0.02441429  0.41833759]
Stock Position:  -0.01359610142707941
Bond Position:  [9.54672622]


portfolio before change:  [8.1907387]
curr_Stock_Price:  99.82133070633293
curr_Factors:  [99.82133071 -1.03393282 -1.05785518]
mat_Sqrt:  [[12.32455854  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00400803 -0.01867226 -0.30725233]
Stock Position:  -0.004008027731975196
Bond Position:  [8.59082536]


portfolio before change:  [8.19397077]
curr_Stock_Price:  99.28287170211453
curr_Factors:  [99.2828717  -1.10625492 -1.0888457 ]
mat_Sqrt:  [[11.05488542  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00396808  0.05401511 -0.24108219]
Stock Position:  0.003968078364781198
Bond Position:  [7.80000856]


portfolio before change:  [8.19833748]
curr_Stock_Price:  100.13760412674782
curr_Factors:  [100.13760413  -1.22050302  -1.10328355]
mat_Sqrt:  [[ 9.80368873  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00382568  0.01958224 -0.00939796]
Stock Position:  -0.003825675927827588
Bond Position:  [8.5814315]


portfolio before change:  [8.19819322]
curr_Stock_Price:  100.45571965315331
curr_Factors:  [100.45571965  -1.03747685  -1.09068871]
mat_Sqrt:  [[11.9598053   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00889621  0.00326785 -0.15482656]
Stock Position:  -0.008896205415143582
Bond Position:  [9.09186794]


portfolio before change:  [8.19540113]
curr_Stock_Price:  100.8973284589728
curr_Factors:  [100.89732846  -1.12613158  -1.07614278]
mat_Sqrt:  [[11.15434486  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00157664 0.00164264 0.37358708]
Stock Position:  0.0015766412834159742
Bond Position:  [8.03632224]


portfolio before change:  [8.19778758]
curr_Stock_Price:  101.77377927454248
curr_Factors:  [101.77377927  -1.38488802  -1.08237493]
mat_Sqrt:  [[ 8.63211498  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.03273215 0.12018453 0.33132908]
Stock Position:  0.0327321519134835
Bond Position:  [4.86651278]


portfolio before change:  [8.18805573]
curr_Stock_Price:  101.45787554806003
curr_Factors:  [101.45787555  -1.40041067  -1.07731131]
mat_Sqrt:  [[ 8.51578681  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01126107 -0.02236348 -0.30954394]
Stock Position:  -0.011261065711109353
Bond Position:  [9.33057953]


portfolio before change:  [8.18975355]
curr_Stock_Price:  101.4106841479041
curr_Factors:  [101.41068415  -1.36786159  -1.04225011]
mat_Sqrt:  [[ 9.10721314  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01007581 -0.01180446 -0.20298946]
Stock Position:  -0.010075810981603388
Bond Position:  [9.21154843]


portfolio before change:  [8.2023722]
curr_Stock_Price:  100.27259895153978
curr_Factors:  [100.27259895  -1.35161376  -1.04653671]
mat_Sqrt:  [[ 9.11336479  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00528392  0.05365922  0.36370606]
Stock Position:  -0.005283924831033351
Bond Position:  [8.73220507]


portfolio before change:  [8.20424873]
curr_Stock_Price:  100.12404580486331
curr_Factors:  [100.1240458   -1.14326318  -1.04482862]
mat_Sqrt:  [[11.22696049  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01337523 0.02051983 0.39067144]
Stock Position:  0.013375228625467408
Bond Position:  [6.86506673]


portfolio before change:  [8.2041921]
curr_Stock_Price:  100.05564931705058
curr_Factors:  [100.05564932  -1.3208207   -0.99979712]
mat_Sqrt:  [[ 9.82675445  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01296653 -0.01347275  0.10873132]
Stock Position:  0.01296652906475332
Bond Position:  [6.90681762]


portfolio before change:  [8.21011063]
curr_Stock_Price:  100.44550867333028
curr_Factors:  [100.44550867  -1.52160788  -0.97499726]
mat_Sqrt:  [[ 8.27310779  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00456252 -0.00488923 -0.07039597]
Stock Position:  -0.004562524615765205
Bond Position:  [8.66839574]


portfolio before change:  [8.21268901]
curr_Stock_Price:  100.11789065238717
curr_Factors:  [100.11789065  -1.63150582  -0.96479905]
mat_Sqrt:  [[ 7.46364217  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01660639 -0.0198225   0.30484128]
Stock Position:  0.016606391839461544
Bond Position:  [6.55009209]


portfolio before change:  [8.2143731]
curr_Stock_Price:  100.16999529096253
curr_Factors:  [100.16999529  -1.64846353  -0.96512169]
mat_Sqrt:  [[ 7.33959364  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00156447 -0.04607875  0.27227747]
Stock Position:  0.0015644742870867315
Bond Position:  [8.05765971]


portfolio before change:  [8.21557803]
curr_Stock_Price:  100.29634344228552
curr_Factors:  [100.29634344  -1.37342101  -0.96775848]
mat_Sqrt:  [[ 9.64992118  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00626468 -0.00079405 -0.25606107]
Stock Position:  -0.006264681063616295
Bond Position:  [8.84390264]


portfolio before change:  [8.21694481]
curr_Stock_Price:  100.25464633380517
curr_Factors:  [100.25464633  -1.51288146  -0.97342566]
mat_Sqrt:  [[ 8.34286177  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02593293  0.03317384  0.11758207]
Stock Position:  -0.02593293287472293
Bond Position:  [10.81684182]


portfolio before change:  [8.20226944]
curr_Stock_Price:  100.87268513353445
curr_Factors:  [100.87268513  -1.35454511  -0.98629385]
mat_Sqrt:  [[ 9.70867897  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00364712 -0.02590799  0.23275104]
Stock Position:  0.003647116224296526
Bond Position:  [7.83437503]


portfolio before change:  [8.20145633]
curr_Stock_Price:  100.38120914681406
curr_Factors:  [100.38120915  -1.12611532  -1.00447191]
mat_Sqrt:  [[11.92202815  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0061085   0.01731566 -0.04562146]
Stock Position:  -0.006108503803801115
Bond Position:  [8.81463533]


portfolio before change:  [8.20541499]
curr_Stock_Price:  99.91353974664027
curr_Factors:  [99.91353975 -1.15048181 -0.99369749]
mat_Sqrt:  [[11.70628543  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00026461  0.01165454  0.05227823]
Stock Position:  -0.0002646093962132652
Bond Position:  [8.23185305]


portfolio before change:  [8.2065166]
curr_Stock_Price:  99.63929286294682
curr_Factors:  [99.63929286 -1.29272341 -0.99311063]
mat_Sqrt:  [[10.1322414   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01180527 -0.02243092 -0.58743637]
Stock Position:  -0.011805265388859667
Bond Position:  [9.3827849]


portfolio before change:  [8.20786148]
curr_Stock_Price:  99.62472673466173
curr_Factors:  [99.62472673 -1.38416314 -0.99649997]
mat_Sqrt:  [[ 9.21421396  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0017632  -0.00161177 -0.32607394]
Stock Position:  -0.0017631982532458816
Bond Position:  [8.38351962]


portfolio before change:  [8.20820403]
curr_Stock_Price:  100.02482850809474
curr_Factors:  [100.02482851  -1.14874557  -1.01030093]
mat_Sqrt:  [[11.54637961  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00510262 0.02019703 0.08388729]
Stock Position:  0.005102615111201318
Bond Position:  [7.69781583]


portfolio before change:  [8.2116855]
curr_Stock_Price:  100.51853256295217
curr_Factors:  [100.51853256  -1.13798029  -1.02393547]
mat_Sqrt:  [[11.57012504  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00042515 -0.01954777 -0.25638599]
Stock Position:  -0.0004251492243783802
Bond Position:  [8.25442087]


portfolio before change:  [8.21283686]
curr_Stock_Price:  100.23746813253146
curr_Factors:  [100.23746813  -0.89732044  -1.01832563]
mat_Sqrt:  [[14.75963336  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01131331 -0.04959565 -0.19311269]
Stock Position:  0.011313311053482718
Bond Position:  [7.0788192]


portfolio before change:  [8.20730256]
curr_Stock_Price:  99.67006488700812
curr_Factors:  [99.67006489 -0.68529325 -0.9912377 ]
mat_Sqrt:  [[18.6404589   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00269268 -0.02633255 -0.00385583]
Stock Position:  -0.0026926847609897355
Bond Position:  [8.47568262]


portfolio before change:  [8.20610643]
curr_Stock_Price:  100.50775979009921
curr_Factors:  [100.50775979  -0.59689313  -1.00698987]
mat_Sqrt:  [[20.21352495  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00878857  0.0478903   0.07372962]
Stock Position:  -0.008788573396940814
Bond Position:  [9.08942626]


portfolio before change:  [8.22579103]
curr_Stock_Price:  98.39725235042535
curr_Factors:  [98.39725235 -0.61127251 -1.0232715 ]
mat_Sqrt:  [[19.19152672  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.005525   -0.04349264 -0.28675097]
Stock Position:  0.0055249993189643585
Bond Position:  [7.68214628]


portfolio before change:  [8.22573806]
curr_Stock_Price:  98.21384866924397
curr_Factors:  [98.21384867 -0.29308658 -1.03745839]
mat_Sqrt:  [[25.96117798  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00106215 -0.02806734 -0.23268243]
Stock Position:  -0.0010621530978956507
Bond Position:  [8.3300562]


portfolio before change:  [8.22681041]
curr_Stock_Price:  98.1846309446859
curr_Factors:  [98.18463094 -0.47445683 -1.05950509]
mat_Sqrt:  [[21.17640883  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00176399  0.00785224 -0.16441821]
Stock Position:  -0.0017639916620042315
Bond Position:  [8.40000728]


portfolio before change:  [8.22834482]
curr_Stock_Price:  97.91005961505418
curr_Factors:  [97.91005962 -0.69615746 -1.06259785]
mat_Sqrt:  [[16.86590264  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00110454 -0.01630619  0.00356198]
Stock Position:  0.0011045428080492768
Bond Position:  [8.12019897]


portfolio before change:  [8.22912188]
curr_Stock_Price:  97.69456051589428
curr_Factors:  [97.69456052 -0.73563482 -1.0291468 ]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [8.22912188]
Stock Price:  99.28647441239671
PL:  [8.22912188]
Settle:  Tensor("sub_30:0", shape=(), dtype=float64)
PL:  Tensor("sub_31:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  16
output_Z_Vals[:, i, :]:  [[ 1.19260232e+02 -2.92559343e+01 -2.92733494e+01]
 [-4.49885262e-02  7.09683919e-02 -5.24841573e-04]
 [ 5.79837921e-02  4.80130075e-02 -2.54428494e-02]
 [ 8.67546340e-02  1.86565614e-01  3.81736823e-02]
 [ 2.26563524e-01 -2.13389029e-02 -4.16163875e-02]
 [ 1.08373394e-02  3.32539353e-02  7.90500219e-02]
 [-5.71340550e-02  3.30623834e-02 -2.08096657e-01]
 [ 3.51326986e-01 -1.66419927e-01  1.66709754e-01]
 [-7.97909729e-02 -1.14198510e-04  1.08136617e-01]
 [-3.23041940e-02  3.02147495e-01  1.18326006e-01]
 [ 8.32367128e-03 -2.27810394e-01  5.05593675e-02]
 [-1.76655494e-01  1.54582912e-01  8.54721764e-02]
 [-6.84035862e-02 -6.17606016e-02 -6.58262697e-02]
 [ 6.00351054e-01  4.00353162e-01  4.33624986e-01]
 [ 1.67312955e-01  2.47237427e-01  7.10465256e-02]
 [-4.97935865e-02 -5.45597164e-02 -1.22223461e-01]
 [-8.96640448e-02  2.88151449e-02 -1.06312431e-01]
 [ 8.54470123e-02 -1.34856005e-01 -1.09444963e-01]
 [ 1.89456237e-02  6.97112862e-02  2.41913154e-02]
 [ 3.23547977e-01 -1.80805994e-01 -6.51341996e-02]
 [ 2.74171540e-02  5.02650548e-03  7.08334940e-02]
 [ 1.56128217e-02 -1.62272836e-02  1.50711186e-02]
 [-1.05057247e-01  2.23499373e-01  2.04778148e-01]
 [ 1.56663144e-01 -2.44918249e-02  1.61006980e-02]
 [ 9.59685220e-03  1.86575166e-02  3.38494809e-02]
 [ 1.02266238e-01  2.72139046e-03  5.62709344e-02]
 [-1.24063394e-01  7.42516376e-02  8.94759119e-02]
 [-5.07806065e-02  7.36225950e-02  2.93687317e-02]
 [ 6.20848838e-02 -6.23725319e-02  9.08311027e-02]
 [-1.02634714e-02 -6.34305805e-02 -1.03276861e-03]
 [-6.67326043e-02  4.38684000e-01 -9.51529297e-04]
 [ 4.74049013e-02 -7.23222262e-02  4.65428037e-03]
 [ 8.40947159e-02 -8.15558344e-02 -1.60275498e-03]
 [-9.24456003e-02 -5.13185512e-02  2.88876298e-02]
 [-1.14715512e-01  1.69489860e-02  3.65864806e-02]
 [ 8.47165236e-02 -1.65012150e-01 -1.38726811e-01]
 [-2.50126745e-01 -4.37894897e-01  1.02354805e-01]
 [-5.00514296e-02 -4.00927316e-02  5.73706870e-02]
 [-3.21652096e-02  6.91897080e-02 -2.82903561e-02]
 [ 9.32521202e-02 -3.99429385e-03 -8.34789802e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.26023247 -29.25593426 -29.27334937]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  8.31486419  -9.25153874 -83.50871763]
init_Out:  [2.49911038]
Stock Position:  8.31486419409362
Bond position:  [-828.98730903]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [6.84013679]
curr_Stock_Price:  100.53454346246244
curr_Factors:  [100.53454346  -1.06764612  -1.00902811]
mat_Sqrt:  [[12.60164235  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00343314  0.02244218 -0.00149723]
Stock Position:  -0.0034331448091981043
Bond Position:  [7.18528643]


portfolio before change:  [6.83907878]
curr_Stock_Price:  101.10434721623128
curr_Factors:  [101.10434722  -1.19870955  -1.01299662]
mat_Sqrt:  [[11.0723051   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00487974  0.01518305 -0.07258137]
Stock Position:  0.004879741146429482
Bond Position:  [6.34571574]


portfolio before change:  [6.8411068]
curr_Stock_Price:  101.35738307960293
curr_Factors:  [101.35738308  -1.33222829  -1.00247708]
mat_Sqrt:  [[ 9.8153486   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01012332 0.05899723 0.10889889]
Stock Position:  0.010123319271128133
Bond Position:  [5.81503365]


portfolio before change:  [6.84269981]
curr_Stock_Price:  101.44293638672626
curr_Factors:  [101.44293639  -1.24331736  -1.00247472]
mat_Sqrt:  [[10.73709277  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.02025852 -0.00674795 -0.11871997]
Stock Position:  0.020258523479853782
Bond Position:  [4.7876157]


portfolio before change:  [6.86697892]
curr_Stock_Price:  102.61185800662975
curr_Factors:  [102.61185801  -1.24620424  -1.01690036]
mat_Sqrt:  [[10.67440589  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00260736 0.01051582 0.22550771]
Stock Position:  0.00260735545808
Bond Position:  [6.59943333]


portfolio before change:  [6.86932185]
curr_Stock_Price:  103.19403746388629
curr_Factors:  [103.19403746  -1.56329973  -1.02617791]
mat_Sqrt:  [[ 7.74566581  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01275009  0.01045524 -0.59364184]
Stock Position:  -0.012750090513682625
Bond Position:  [8.18505517]


portfolio before change:  [6.86398498]
curr_Stock_Price:  103.69286280958767
curr_Factors:  [103.69286281  -1.47549753  -1.01073805]
mat_Sqrt:  [[ 8.62959617  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.04415728 -0.0526266   0.47557652]
Stock Position:  0.04415728390181879
Bond Position:  [2.2851898]


portfolio before change:  [6.85281958]
curr_Stock_Price:  103.4335384176059
curr_Factors:  [103.43353842  -1.44322729  -0.99790434]
mat_Sqrt:  [[ 9.00515907  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-6.40972876e-03 -3.61127397e-05  3.08483668e-01]
Stock Position:  -0.006409728760886041
Bond Position:  [7.51580051]


portfolio before change:  [6.85198207]
curr_Stock_Price:  103.7107815385657
curr_Factors:  [103.71078154  -1.37598933  -0.98345257]
mat_Sqrt:  [[ 9.79786185  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-3.56796697e-05  9.55474275e-02  3.37551159e-01]
Stock Position:  -3.567966974655028e-05
Bond Position:  [6.85568243]


portfolio before change:  [6.85280043]
curr_Stock_Price:  104.79403707508435
curr_Factors:  [104.79403708  -1.59841765  -0.98958121]
mat_Sqrt:  [[ 7.87740091  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00162008 -0.07203997  0.1442318 ]
Stock Position:  0.0016200800271625477
Bond Position:  [6.6830257]


portfolio before change:  [6.85503751]
curr_Stock_Price:  105.65921364225589
curr_Factors:  [105.65921364  -2.03358296  -0.98879299]
mat_Sqrt:  [[ 5.14406181  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.03017406  0.04888341  0.24382833]
Stock Position:  -0.03017406307551849
Bond Position:  [10.04320529]


portfolio before change:  [6.85679381]
curr_Stock_Price:  105.64261591498365
curr_Factors:  [105.64261591  -1.9166007   -1.01635284]
mat_Sqrt:  [[ 5.62436647  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01483455 -0.01953042 -0.18778402]
Stock Position:  -0.014834554171838422
Bond Position:  [8.42395492]


portfolio before change:  [6.86092063]
curr_Stock_Price:  105.43541374555564
curr_Factors:  [105.43541375  -1.71653852  -1.00781006]
mat_Sqrt:  [[ 6.91539439  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.10110797 0.12660279 1.23701139]
Stock Position:  0.10110796563316911
Bond Position:  [-3.79943956]


portfolio before change:  [6.8910832]
curr_Stock_Price:  105.7384317186562
curr_Factors:  [105.73843172  -1.62236989  -1.01984898]
mat_Sqrt:  [[ 7.52890452  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.02499685 0.07818334 0.20267596]
Stock Position:  0.024996851639134083
Bond Position:  [4.24795531]


portfolio before change:  [6.87541704]
curr_Stock_Price:  105.09046260200792
curr_Factors:  [105.0904626   -1.39372621  -1.01028533]
mat_Sqrt:  [[ 9.49542384  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00801977 -0.0172533  -0.34866951]
Stock Position:  -0.008019765423258829
Bond Position:  [7.7182179]


portfolio before change:  [6.88033736]
curr_Stock_Price:  104.5972459140761
curr_Factors:  [104.59724591  -1.49988742  -0.97801329]
mat_Sqrt:  [[ 8.77771833  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01260247  0.00911215 -0.30327977]
Stock Position:  -0.012602474912321965
Bond Position:  [8.19852152]


portfolio before change:  [6.88419892]
curr_Stock_Price:  104.37215624344242
curr_Factors:  [104.37215624  -1.53849762  -0.98445827]
mat_Sqrt:  [[ 8.37295656  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0071211  -0.04264521 -0.31221601]
Stock Position:  0.0071211029645645236
Bond Position:  [6.14095405]


portfolio before change:  [6.87969582]
curr_Stock_Price:  103.63199417035439
curr_Factors:  [103.63199417  -1.61494307  -0.9913556 ]
mat_Sqrt:  [[ 7.6487898   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00335786 0.02204464 0.06901109]
Stock Position:  0.0033578636175856176
Bond Position:  [6.53171372]


portfolio before change:  [6.88166384]
curr_Stock_Price:  103.97492313615913
curr_Factors:  [103.97492314  -1.45161398  -1.01615464]
mat_Sqrt:  [[ 8.81435046  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.03466893 -0.05717588 -0.18580974]
Stock Position:  0.0346689327333616
Bond Position:  [3.27696423]


portfolio before change:  [6.8647031]
curr_Stock_Price:  103.47388682494523
curr_Factors:  [103.47388682  -1.34595742  -1.02061639]
mat_Sqrt:  [[ 9.70601189  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00432781 0.00158952 0.20206824]
Stock Position:  0.004327808857842936
Bond Position:  [6.41688789]


portfolio before change:  [6.86715274]
curr_Stock_Price:  103.85456140494503
curr_Factors:  [103.8545614   -1.21789744  -1.04011519]
mat_Sqrt:  [[10.85883297  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00168252 -0.00513152  0.04299371]
Stock Position:  0.0016825209737820767
Bond Position:  [6.69241527]


portfolio before change:  [6.86874002]
curr_Stock_Price:  104.30072225443075
curr_Factors:  [104.30072225  -1.11400524  -1.03231165]
mat_Sqrt:  [[12.19421173  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00471423  0.07067671  0.58417506]
Stock Position:  -0.00471423286218651
Bond Position:  [7.36043792]


portfolio before change:  [6.87122486]
curr_Stock_Price:  103.96880629019171
curr_Factors:  [103.96880629  -1.08280982  -1.03531832]
mat_Sqrt:  [[12.50292692  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0127424  -0.007745    0.04593081]
Stock Position:  0.012742401041689225
Bond Position:  [5.54641264]


portfolio before change:  [6.88018202]
curr_Stock_Price:  104.6173347897202
curr_Factors:  [104.61733479  -1.09982209  -1.01884597]
mat_Sqrt:  [[12.5741259   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00135103 0.00590002 0.09656315]
Stock Position:  0.00135103495028534
Bond Position:  [6.73884034]


portfolio before change:  [6.88082861]
curr_Stock_Price:  104.47239463180343
curr_Factors:  [104.47239463  -1.23201145  -1.01967538]
mat_Sqrt:  [[10.9927508   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01035435 0.00086058 0.16052531]
Stock Position:  0.010354347348486167
Bond Position:  [5.79908515]


portfolio before change:  [6.88831768]
curr_Stock_Price:  105.1256601961587
curr_Factors:  [105.1256602   -0.95243452  -1.0180053 ]
mat_Sqrt:  [[14.65404755  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00708897  0.02348043  0.25524987]
Stock Position:  -0.007088965040006781
Bond Position:  [7.63354981]


portfolio before change:  [6.88622483]
curr_Stock_Price:  105.55549727708046
curr_Factors:  [105.55549728  -1.08488318  -1.02488446]
mat_Sqrt:  [[12.80030775  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0033503   0.02328151  0.08378082]
Stock Position:  -0.00335029538673418
Bond Position:  [7.23986693]


portfolio before change:  [6.88408234]
curr_Stock_Price:  106.46512773601718
curr_Factors:  [106.46512774  -1.13759699  -1.03420455]
mat_Sqrt:  [[12.13405499  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00651186 -0.01972393  0.25911585]
Stock Position:  0.006511858830029581
Bond Position:  [6.19079646]


portfolio before change:  [6.87976774]
curr_Stock_Price:  105.68370678448083
curr_Factors:  [105.68370678  -1.13064435  -1.02168243]
mat_Sqrt:  [[12.28186702  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00098617 -0.02005851 -0.0029462 ]
Stock Position:  -0.0009861737564836098
Bond Position:  [6.98399023]


portfolio before change:  [6.88022797]
curr_Stock_Price:  106.1023146492511
curr_Factors:  [106.10231465  -1.22357506  -1.05084761]
mat_Sqrt:  [[10.91328873  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00509471  0.13872406 -0.00271445]
Stock Position:  -0.00509471192370717
Bond Position:  [7.4207887]


portfolio before change:  [6.87916027]
curr_Stock_Price:  106.49396654494296
curr_Factors:  [106.49396654  -1.46633315  -1.05080749]
mat_Sqrt:  [[ 8.59299808  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00540994 -0.0228703   0.01327737]
Stock Position:  0.00540993958450115
Bond Position:  [6.30303435]


portfolio before change:  [6.87792745]
curr_Stock_Price:  106.12044117233376
curr_Factors:  [106.12044117  -1.26050368  -1.0171008 ]
mat_Sqrt:  [[10.88047841  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00750535 -0.02579022 -0.00457221]
Stock Position:  0.007505349422155943
Bond Position:  [6.08145646]


portfolio before change:  [6.873552]
curr_Stock_Price:  105.43617183753591
curr_Factors:  [105.43617184  -1.16768748  -1.03303313]
mat_Sqrt:  [[11.67424523  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00752717 -0.01622835  0.08240837]
Stock Position:  -0.007527165578946564
Bond Position:  [7.66718752]


portfolio before change:  [6.86665871]
curr_Stock_Price:  106.479293571932
curr_Factors:  [106.47929357  -1.09132839  -1.02942026]
mat_Sqrt:  [[12.77131814  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00836325  0.00535974  0.10437105]
Stock Position:  -0.008363248436846049
Bond Position:  [7.75717149]


portfolio before change:  [6.8708547]
curr_Stock_Price:  106.09352365851915
curr_Factors:  [106.09352366  -1.22966944  -1.02793194]
mat_Sqrt:  [[11.09749742  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00469822 -0.05218142 -0.39574898]
Stock Position:  0.004698215687651617
Bond Position:  [6.37240445]


portfolio before change:  [6.87331501]
curr_Stock_Price:  106.44763754452066
curr_Factors:  [106.44763754  -1.24395978  -0.99568718]
mat_Sqrt:  [[11.33625763  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02121865 -0.13847453  0.29198977]
Stock Position:  -0.021218647609160462
Bond Position:  [9.13198992]


portfolio before change:  [6.89420012]
curr_Stock_Price:  105.51715679720506
curr_Factors:  [105.5171568   -1.11135856  -1.0106371 ]
mat_Sqrt:  [[12.64014557  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00311514 -0.01267843  0.1636626 ]
Stock Position:  -0.0031151442725222515
Bond Position:  [7.22290129]


portfolio before change:  [6.89493569]
curr_Stock_Price:  105.57087922110576
curr_Factors:  [105.57087922  -1.05375602  -1.02968366]
mat_Sqrt:  [[13.14370438  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00275063  0.02187971 -0.08070451]
Stock Position:  -0.002750631232701371
Bond Position:  [7.18532224]


portfolio before change:  [6.89795096]
curr_Stock_Price:  104.80122042572383
curr_Factors:  [104.80122043  -0.78363785  -1.04381746]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [6.89795096]
Stock Price:  102.95418455734684
PL:  [3.9437664]
Settle:  Tensor("sub_32:0", shape=(), dtype=float64)
PL:  Tensor("sub_33:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  17
output_Z_Vals[:, i, :]:  [[ 1.19260232e+02 -2.92559343e+01 -2.92733494e+01]
 [-1.54491998e-01  5.01194794e-01  9.25579593e-02]
 [ 1.33038082e-01  4.56510629e-02 -1.14503461e-01]
 [ 8.49513907e-02  1.70168670e-01  3.79546204e-02]
 [ 2.15149049e-01 -2.81293990e-02 -5.47966889e-02]
 [ 5.15277204e-02  3.18170772e-02  2.87193874e-02]
 [ 3.06734872e-02  5.39447919e-02 -2.83789908e-02]
 [ 7.85132473e-02  1.13701969e-01  9.38055095e-02]
 [-1.11257610e-01 -1.78238869e-02  1.02097222e-01]
 [-4.07964313e-02  3.45012491e-01  1.40542629e-01]
 [ 5.43130942e-02  1.89249956e-02 -7.41880814e-02]
 [-3.69831379e-02  7.95351826e-02 -7.22582873e-04]
 [-9.82013664e-02  1.72727244e-02 -5.31613389e-02]
 [-1.12944870e-01 -1.00216298e-01  5.91326993e-02]
 [ 2.64056639e-01  3.58403553e-01  7.20170727e-02]
 [-8.06300669e-02 -9.81523450e-02 -1.14044931e-01]
 [-7.07040816e-02 -6.05924867e-02 -6.69664356e-02]
 [-7.85665181e-02  1.69625483e-01  1.27482005e-01]
 [ 1.48419526e-01  6.37862449e-02  1.66771977e-01]
 [ 2.54125167e-02 -2.56217998e-02  7.93556682e-02]
 [-1.78926459e-02 -2.60963670e-02 -1.42762221e-02]
 [ 1.19639251e-01 -6.47102118e-02  1.53819476e-01]
 [ 2.90068744e-02 -1.48706454e-01  5.23075736e-02]
 [-5.79446148e-02 -8.19225556e-04 -8.51120475e-02]
 [-3.66109942e-01  1.31514219e-01  3.12583479e-02]
 [-4.56033473e-02 -1.56733736e-01  1.02910880e-01]
 [ 1.90147194e-01  4.36663182e-02 -1.14899871e-01]
 [ 2.69153084e-02 -1.88303073e-02 -3.89850870e-03]
 [-8.21216937e-02 -7.78647326e-02 -1.96536456e-01]
 [ 7.91728509e-03 -6.96820157e-03 -1.16523917e-01]
 [ 3.69697147e-02 -2.71541365e-02  3.47831874e-02]
 [ 6.04801904e-02 -8.89822595e-02 -8.76782260e-02]
 [ 3.96924999e-01 -4.73936705e-01 -4.78863533e-01]
 [-4.79077471e-02 -8.34083157e-02 -1.73900630e-03]
 [-1.36755811e-01 -4.23744074e-02  2.23180418e-02]
 [ 4.10295985e-02 -1.23694257e-01 -9.03319298e-02]
 [-1.11717889e-02 -1.11616685e-01 -7.06708476e-02]
 [-1.58328372e-02  2.38760356e-02 -7.12624547e-02]
 [ 3.74148129e-02 -9.51856361e-02 -1.36577703e-03]
 [-8.68989803e-01  4.31086282e-01  5.32555332e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.26023247 -29.25593426 -29.27334937]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  8.31486419  -9.25153874 -83.50871763]
init_Out:  [2.49911038]
Stock Position:  8.31486419409362
Bond position:  [-828.98730903]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [14.27067475]
curr_Stock_Price:  101.42818860131545
curr_Factors:  [101.4281886   -0.87096307  -1.03423728]
mat_Sqrt:  [[15.09178709  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00812746  0.15849171  0.26404209]
Stock Position:  -0.008127459598223502
Bond Position:  [15.09502826]


portfolio before change:  [14.27143013]
curr_Stock_Price:  101.56742261648064
curr_Factors:  [101.56742262  -1.17520046  -1.05603422]
mat_Sqrt:  [[10.90790941  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01016179  0.01443613 -0.3266465 ]
Stock Position:  0.010161788342703105
Bond Position:  [13.23932348]


portfolio before change:  [14.26589341]
curr_Stock_Price:  100.85969868645363
curr_Factors:  [100.85969869  -1.16847876  -1.08477605]
mat_Sqrt:  [[10.59598995  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00916314 0.05381206 0.10827397]
Stock Position:  0.00916314395421714
Bond Position:  [13.34170147]


portfolio before change:  [14.26483586]
curr_Stock_Price:  100.56227150553376
curr_Factors:  [100.56227151  -1.24065827  -1.07516459]
mat_Sqrt:  [[ 9.92398234  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.02047942 -0.0088953  -0.1563197 ]
Stock Position:  0.02047942213214822
Bond Position:  [12.20537865]


portfolio before change:  [14.28199371]
curr_Stock_Price:  101.32557825988943
curr_Factors:  [101.32557826  -1.21164183  -1.08929039]
mat_Sqrt:  [[10.14931952  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00573551 0.01006144 0.08192842]
Stock Position:  0.0057355130112861485
Bond Position:  [13.70083953]


portfolio before change:  [14.2838079]
curr_Stock_Price:  101.34327190239485
curr_Factors:  [101.3432719   -1.21339238  -1.08407763]
mat_Sqrt:  [[10.1862979   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0025793   0.01705884 -0.08095736]
Stock Position:  0.0025792980733204776
Bond Position:  [14.0224134]


portfolio before change:  [14.2867472]
curr_Stock_Price:  101.80323735495344
curr_Factors:  [101.80323735  -1.30829745  -1.06136663]
mat_Sqrt:  [[ 9.51983793  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01056709 0.03595572 0.26760101]
Stock Position:  0.010567090498179482
Bond Position:  [13.21098318]


portfolio before change:  [14.29035549]
curr_Stock_Price:  101.98841772313108
curr_Factors:  [101.98841772  -1.14606494  -1.06750258]
mat_Sqrt:  [[11.14835256  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00815164 -0.00563641  0.29125496]
Stock Position:  -0.008151636045337453
Bond Position:  [15.12172796]


portfolio before change:  [14.29438582]
curr_Stock_Price:  101.72589454429276
curr_Factors:  [101.72589454  -1.02815312  -1.09311969]
mat_Sqrt:  [[12.19479325  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-2.62415522e-04  1.09102529e-01  4.00929002e-01]
Stock Position:  -0.0002624155217071933
Bond Position:  [14.32108028]


portfolio before change:  [14.29610644]
curr_Stock_Price:  101.99125143498141
curr_Factors:  [101.99125143  -1.01602961  -1.1024876 ]
mat_Sqrt:  [[12.26034201  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00323467  0.00598461 -0.21163795]
Stock Position:  0.0032346696968372367
Bond Position:  [13.96619842]


portfolio before change:  [14.29553287]
curr_Stock_Price:  101.27419150022239
curr_Factors:  [101.2741915   -1.17428656  -1.10114693]
mat_Sqrt:  [[10.40616176  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0033708   0.02515123 -0.00206133]
Stock Position:  -0.0033707956584465987
Bond Position:  [14.63690747]


portfolio before change:  [14.30027569]
curr_Stock_Price:  100.40997683955835
curr_Factors:  [100.40997684  -1.08966275  -1.09715563]
mat_Sqrt:  [[11.27336872  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00963393  0.00546212 -0.1516545 ]
Stock Position:  -0.009633934817253149
Bond Position:  [15.26761886]


portfolio before change:  [14.3063424]
curr_Stock_Price:  99.97836288079296
curr_Factors:  [99.97836288 -1.0948353  -1.11211558]
mat_Sqrt:  [[11.00118415  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00940463 -0.03169118  0.16868913]
Stock Position:  -0.009404626857765044
Bond Position:  [15.24660159]


portfolio before change:  [14.30664583]
curr_Stock_Price:  100.14875854732614
curr_Factors:  [100.14875855  -1.08560835  -1.12835991]
mat_Sqrt:  [[10.9428734   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.0263195  0.11333716 0.20544466]
Stock Position:  0.026319504195058463
Bond Position:  [11.67078016]


portfolio before change:  [14.32242552]
curr_Stock_Price:  100.69286995885676
curr_Factors:  [100.69286996  -0.98893524  -1.14628804]
mat_Sqrt:  [[11.9037291   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00894204 -0.0310385  -0.32533845]
Stock Position:  -0.008942044367033017
Bond Position:  [15.22282563]


portfolio before change:  [14.33027797]
curr_Stock_Price:  100.027532440926
curr_Factors:  [100.02753244  -1.07284045  -1.14517886]
mat_Sqrt:  [[10.88544054  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00789477 -0.01916103 -0.1910366 ]
Stock Position:  -0.007894769069232581
Bond Position:  [15.11997223]


portfolio before change:  [14.33232212]
curr_Stock_Price:  100.0080210372988
curr_Factors:  [100.00802104  -1.22083977  -1.11097667]
mat_Sqrt:  [[ 9.71269659  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00495894  0.05364029  0.36367068]
Stock Position:  -0.004958937112743245
Bond Position:  [14.82825561]


portfolio before change:  [14.33771637]
curr_Stock_Price:  99.2940363990431
curr_Factors:  [99.2940364  -1.1831435  -1.12290418]
mat_Sqrt:  [[ 9.89508171  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01860608 0.02017098 0.47575403]
Stock Position:  0.018606078489547425
Bond Position:  [12.49024374]


portfolio before change:  [14.33718516]
curr_Stock_Price:  99.18156855997779
curr_Factors:  [99.18156856 -1.25938911 -1.11581282]
mat_Sqrt:  [[ 9.22346024  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0044397  -0.00810232  0.22637963]
Stock Position:  0.004439697420875565
Bond Position:  [13.89684901]


portfolio before change:  [14.34057956]
curr_Stock_Price:  99.55483327965044
curr_Factors:  [99.55483328 -1.33457021 -1.11918518]
mat_Sqrt:  [[ 8.5587418   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00250978 -0.0082524  -0.04072609]
Stock Position:  -0.002509781617298918
Bond Position:  [14.59044045]


portfolio before change:  [14.34352681]
curr_Stock_Price:  99.10725278714102
curr_Factors:  [99.10725279 -1.62558806 -1.10651426]
mat_Sqrt:  [[ 6.45013013  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.02315716 -0.02046317  0.43880415]
Stock Position:  0.023157162158875727
Bond Position:  [12.04848409]


portfolio before change:  [14.34143842]
curr_Stock_Price:  98.95202908201955
curr_Factors:  [98.95202908 -1.80267196 -1.08909795]
mat_Sqrt:  [[ 5.48965421  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00652947 -0.04702511  0.14921895]
Stock Position:  0.006529469359624885
Bond Position:  [13.69533418]


portfolio before change:  [14.34155985]
curr_Stock_Price:  98.70842578618569
curr_Factors:  [98.70842579 -1.71932261 -1.07884615]
mat_Sqrt:  [[ 6.01346759  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01252841 -0.00025906 -0.24280098]
Stock Position:  -0.012528410602605618
Bond Position:  [15.57821954]


portfolio before change:  [14.33821272]
curr_Stock_Price:  99.13102753181737
curr_Factors:  [99.13102753 -1.59769623 -1.08091558]
mat_Sqrt:  [[ 6.80617767  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.05235445  0.04158845  0.08917137]
Stock Position:  -0.05235444810520867
Bond Position:  [19.52816295]


portfolio before change:  [14.37050069]
curr_Stock_Price:  98.5609366179224
curr_Factors:  [98.56093662 -1.54899508 -1.07634691]
mat_Sqrt:  [[ 7.13728901  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00401323 -0.04956356  0.29357609]
Stock Position:  -0.004013232423415272
Bond Position:  [14.76604863]


portfolio before change:  [14.37111018]
curr_Stock_Price:  98.86901169323797
curr_Factors:  [98.86901169 -1.36388792 -1.10600936]
mat_Sqrt:  [[ 8.36368048  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.02006543  0.0138085  -0.32777735]
Stock Position:  0.020065426484272616
Bond Position:  [12.38726129]


portfolio before change:  [14.35857551]
curr_Stock_Price:  98.16714875932408
curr_Factors:  [98.16714876 -1.31447494 -1.11378278]
mat_Sqrt:  [[ 8.65739537  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00296086 -0.00595467 -0.01112136]
Stock Position:  0.002960859599480684
Bond Position:  [14.06791636]


portfolio before change:  [14.36049335]
curr_Stock_Price:  98.22093328902082
curr_Factors:  [98.22093329 -1.3107298  -1.10898735]
mat_Sqrt:  [[ 8.73643498  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01422205 -0.02462299 -0.5606638 ]
Stock Position:  -0.014222046960743473
Bond Position:  [15.75739608]


portfolio before change:  [14.36599393]
curr_Stock_Price:  97.9726724516656
curr_Factors:  [97.97267245 -1.49220652 -1.0953576 ]
mat_Sqrt:  [[ 7.3678391   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00217811 -0.00220354 -0.3324103 ]
Stock Position:  -0.0021781119172832666
Bond Position:  [14.57938937]


portfolio before change:  [14.36853755]
curr_Stock_Price:  97.64161549615986
curr_Factors:  [97.6416155  -1.54246353 -1.11126278]
mat_Sqrt:  [[ 6.87284049  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00631015 -0.00858689  0.09922675]
Stock Position:  0.006310154637121352
Bond Position:  [13.75240385]


portfolio before change:  [14.37182339]
curr_Stock_Price:  97.88989545508004
curr_Factors:  [97.88989546 -1.52755529 -1.11799059]
mat_Sqrt:  [[ 6.94691341  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00579904 -0.02813866 -0.25012157]
Stock Position:  0.005799040954243766
Bond Position:  [13.80415588]


portfolio before change:  [14.37291372]
curr_Stock_Price:  97.78034430590101
curr_Factors:  [97.78034431 -1.41268538 -1.12288749]
mat_Sqrt:  [[ 7.74579958  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.03704465 -0.14987195 -1.36606437]
Stock Position:  0.03704464508822616
Bond Position:  [10.75067557]


portfolio before change:  [14.37466807]
curr_Stock_Price:  97.79142362800357
curr_Factors:  [97.79142363 -1.24806883 -1.12644417]
mat_Sqrt:  [[ 9.1004502   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00553998 -0.02637603 -0.0049609 ]
Stock Position:  -0.0055399801813044635
Bond Position:  [14.91643062]


portfolio before change:  [14.37937965]
curr_Stock_Price:  97.27754020825287
curr_Factors:  [97.27754021 -1.40841287 -1.11805704]
mat_Sqrt:  [[ 7.77643662  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01714079 -0.01339996  0.06366716]
Stock Position:  -0.017140789370066134
Bond Position:  [16.04679347]


portfolio before change:  [14.37626287]
curr_Stock_Price:  97.5764033206408
curr_Factors:  [97.57640332 -1.31955415 -1.1237372 ]
mat_Sqrt:  [[ 8.47689597  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00228821 -0.03911556 -0.25769185]
Stock Position:  0.0022882076913766213
Bond Position:  [14.15298779]


portfolio before change:  [14.37629757]
curr_Stock_Price:  96.81837325792097
curr_Factors:  [96.81837326 -1.12746706 -1.09348693]
mat_Sqrt:  [[10.50533042  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00271094 -0.03529629 -0.20160426]
Stock Position:  -0.0027109424021409933
Bond Position:  [14.63876661]


portfolio before change:  [14.37953087]
curr_Stock_Price:  96.3007188212774
curr_Factors:  [96.30071882 -1.06093743 -1.09729259]
mat_Sqrt:  [[11.12556667  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00267517  0.00755027 -0.20329195]
Stock Position:  -0.0026751669515753117
Bond Position:  [14.63715137]


portfolio before change:  [14.37982615]
curr_Stock_Price:  96.87431995323246
curr_Factors:  [96.87431995 -1.07462369 -1.08532757]
mat_Sqrt:  [[11.17258717  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00310388 -0.03010034 -0.00389618]
Stock Position:  0.0031038775328783978
Bond Position:  [14.07914012]


portfolio before change:  [14.38350471]
curr_Stock_Price:  97.49243775197166
curr_Factors:  [97.49243775 -1.38699392 -1.077428  ]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [14.38350471]
Stock Price:  97.53158981604966
PL:  [14.38350471]
Settle:  Tensor("sub_34:0", shape=(), dtype=float64)
PL:  Tensor("sub_35:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  18
output_Z_Vals[:, i, :]:  [[ 1.19260232e+02 -2.92559343e+01 -2.92733494e+01]
 [ 3.38721873e-03 -9.74267138e-02 -3.43572989e-02]
 [-5.11661478e-02 -5.73807064e-02 -4.74091571e-02]
 [ 8.25237653e-02  1.48094201e-01  3.76597074e-02]
 [ 2.22269489e-01 -2.47201419e-02 -4.80916301e-02]
 [ 3.74950844e-02  3.13442701e-02  4.99678575e-02]
 [ 6.05205702e-02  2.44336717e-02 -5.31408857e-02]
 [-1.33933905e-01  1.36070606e-01 -4.51020748e-02]
 [-1.09924800e-02 -3.99550376e-02  1.99550232e-02]
 [-7.30995356e-02  2.72460218e-01  1.11307901e-01]
 [ 5.79317935e-02  1.38653190e-01 -8.44489400e-02]
 [-8.07882948e-02 -9.28163666e-02  4.11451273e-03]
 [-1.11930072e-01  4.39085556e-02 -2.27965253e-02]
 [-9.62623594e-02 -1.14884369e-01  6.32126881e-02]
 [ 3.04625206e-01  3.63630027e-01  2.52725370e-02]
 [-6.57008537e-02 -2.34780780e-01 -8.26312857e-02]
 [-6.71176887e-02 -5.43765562e-02 -4.22831595e-02]
 [-7.69889244e-02  1.36408160e-01  1.12095584e-01]
 [ 9.92654675e-02  5.90642275e-02  9.84379115e-02]
 [ 4.73169457e-02 -2.78447663e-02  6.73286934e-02]
 [ 1.38989312e-02 -5.61739736e-02  2.36108594e-02]
 [ 1.21554521e-01 -6.58723963e-02  1.64323401e-01]
 [-6.55841498e-02  5.48087133e-02  3.27218502e-01]
 [-6.72555130e-02 -5.97661216e-04 -8.23991059e-02]
 [-2.61690758e-02  4.66800399e-02  9.49876523e-02]
 [ 5.24191607e-02 -4.68042066e-02  7.15126220e-02]
 [-1.75888246e-01  7.01041439e-02  7.97290938e-02]
 [-5.07806065e-02  7.36225950e-02  2.93687317e-02]
 [ 6.19847723e-02 -6.36044889e-02  8.19493067e-02]
 [-2.92171103e-02 -7.04720749e-02 -3.87169375e-02]
 [-6.41358618e-02  4.21478010e-01  2.56219121e-03]
 [ 3.92692544e-02 -9.28428588e-02 -1.77087183e-02]
 [ 9.04743754e-02 -8.88891870e-02 -1.00226100e-02]
 [-1.04953948e-01 -4.66551723e-02  3.15978036e-02]
 [-1.18161031e-01  2.72256579e-02  3.64251589e-02]
 [ 8.47165236e-02 -1.65012150e-01 -1.38726811e-01]
 [-2.49042091e-01 -4.35989998e-01  1.01441350e-01]
 [-4.83550864e-02 -3.61127865e-02  4.92636863e-02]
 [-3.17471402e-02  6.83129685e-02 -2.85526757e-02]
 [ 1.27928268e-01 -6.67180110e-03 -1.20408023e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.26023247 -29.25593426 -29.27334937]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  8.31486419  -9.25153874 -83.50871763]
init_Out:  [2.49911038]
Stock Position:  8.31486419409362
Bond position:  [-828.98730903]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [2.20655528]
curr_Stock_Price:  99.97727861697253
curr_Factors:  [99.97727862 -1.13567815 -0.99460554]
mat_Sqrt:  [[11.87765916  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00051706 -0.03080903 -0.09801181]
Stock Position:  -0.0005170616863854724
Bond Position:  [2.2582497]


portfolio before change:  [2.20673461]
curr_Stock_Price:  100.17641527705098
curr_Factors:  [100.17641528  -0.89620586  -1.01661214]
mat_Sqrt:  [[14.79241838  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00421331 -0.01814537 -0.13524513]
Stock Position:  -0.004213311394690075
Bond Position:  [2.62880904]


portfolio before change:  [2.20343713]
curr_Stock_Price:  101.03704455618917
curr_Factors:  [101.03704456  -0.8809835   -0.98586438]
mat_Sqrt:  [[15.62136223  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00601963 0.0468315  0.10743266]
Stock Position:  0.00601962846444439
Bond Position:  [1.59523166]


portfolio before change:  [2.20392926]
curr_Stock_Price:  101.0856712629611
curr_Factors:  [101.08567126  -0.93181713  -1.00465684]
mat_Sqrt:  [[14.57772116  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01453002 -0.0078172  -0.13719203]
Stock Position:  0.014530018235339424
Bond Position:  [0.73515262]


portfolio before change:  [2.20962486]
curr_Stock_Price:  101.47133488374251
curr_Factors:  [101.47133488  -0.94196087  -0.98438625]
mat_Sqrt:  [[14.78228083  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00328123 0.00991193 0.14254439]
Stock Position:  0.0032812281646040016
Bond Position:  [1.87667426]


portfolio before change:  [2.20644307]
curr_Stock_Price:  100.4301426164962
curr_Factors:  [100.43014262  -0.96229227  -0.93331343]
mat_Sqrt:  [[15.08735064  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00333419  0.00772661 -0.15159616]
Stock Position:  0.003334190889198729
Bond Position:  [1.8715898]


portfolio before change:  [2.20651825]
curr_Stock_Price:  100.38251875167634
curr_Factors:  [100.38251875  -0.74768399  -0.95380194]
mat_Sqrt:  [[18.31100323  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00762531  0.0430293  -0.12866367]
Stock Position:  -0.007625305823684255
Bond Position:  [2.97196565]


portfolio before change:  [2.20741896]
curr_Stock_Price:  100.3131190119765
curr_Factors:  [100.31311901  -0.94678894  -0.95588484]
mat_Sqrt:  [[14.96363177  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00053134 -0.01263489  0.05692613]
Stock Position:  -0.000531342440806749
Bond Position:  [2.26071958]


portfolio before change:  [2.20770714]
curr_Stock_Price:  100.30263481978294
curr_Factors:  [100.30263482  -0.97248485  -0.92218835]
mat_Sqrt:  [[15.08225312  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00287384  0.08615949  0.31753046]
Stock Position:  -0.0028738420239996934
Bond Position:  [2.49596107]


portfolio before change:  [2.20912684]
curr_Stock_Price:  99.91719733457887
curr_Factors:  [99.91719733 -0.62220428 -0.92607316]
mat_Sqrt:  [[21.24378504  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00208408  0.04384599 -0.24090932]
Stock Position:  0.002084079448641651
Bond Position:  [2.00089146]


portfolio before change:  [2.20772602]
curr_Stock_Price:  99.12502695949021
curr_Factors:  [99.12502696 -0.79566452 -0.92586453]
mat_Sqrt:  [[17.72281684  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00464627 -0.02935111  0.01173756]
Stock Position:  -0.004646266582963361
Bond Position:  [2.66828732]


portfolio before change:  [2.20926558]
curr_Stock_Price:  98.86546361010917
curr_Factors:  [98.86546361 -0.78425322 -0.93172485]
mat_Sqrt:  [[17.77480317  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00649513  0.0138851  -0.06503214]
Stock Position:  -0.006495131229331517
Bond Position:  [2.85140974]


portfolio before change:  [2.21541938]
curr_Stock_Price:  97.9728947986897
curr_Factors:  [97.9728948  -0.72889664 -0.92785228]
mat_Sqrt:  [[18.68912742  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00461902 -0.03632963  0.1803282 ]
Stock Position:  -0.0046190184913544
Bond Position:  [2.66795799]


portfolio before change:  [2.21434478]
curr_Stock_Price:  98.27774572957568
curr_Factors:  [98.27774573 -0.96730919 -0.97297865]
mat_Sqrt:  [[14.11883565  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.02260617 0.11498991 0.07209551]
Stock Position:  0.022606172073396467
Bond Position:  [-0.00733885]


portfolio before change:  [2.22722342]
curr_Stock_Price:  98.84748185308264
curr_Factors:  [98.84748185 -1.00297156 -1.00033112]
mat_Sqrt:  [[13.33344305  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00664719 -0.0742442  -0.23572406]
Stock Position:  -0.006647188395939364
Bond Position:  [2.88428125]


portfolio before change:  [2.23123254]
curr_Stock_Price:  98.29859339519666
curr_Factors:  [98.2985934  -0.83956585 -0.96905961]
mat_Sqrt:  [[16.10909885  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00478939 -0.01719538 -0.12062208]
Stock Position:  -0.0047893864088287014
Bond Position:  [2.70202249]


portfolio before change:  [2.22800136]
curr_Stock_Price:  99.04377367878557
curr_Factors:  [99.04377368 -0.80585618 -0.95566155]
mat_Sqrt:  [[17.01413005  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00297314  0.04313605  0.3197775 ]
Stock Position:  -0.002973144402506029
Bond Position:  [2.5224728]


portfolio before change:  [2.22880896]
curr_Stock_Price:  98.87819923474531
curr_Factors:  [98.87819923 -0.7860758  -0.95213055]
mat_Sqrt:  [[17.3862981   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00695283 0.01867775 0.28081596]
Stock Position:  0.006952834532082018
Bond Position:  [1.54132521]


portfolio before change:  [2.23150794]
curr_Stock_Price:  99.23867029901018
curr_Factors:  [99.2386703  -1.0253278  -0.97770317]
mat_Sqrt:  [[13.38984784  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0045065  -0.00880529  0.19207002]
Stock Position:  0.004506504451725536
Bond Position:  [1.78428843]


portfolio before change:  [2.22557612]
curr_Stock_Price:  97.87289554489048
curr_Factors:  [97.87289554 -0.61439653 -0.99118746]
mat_Sqrt:  [[19.65016352  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00087877 -0.01776377  0.06735521]
Stock Position:  0.0008787749726918002
Bond Position:  [2.13956787]


portfolio before change:  [2.2262675]
curr_Stock_Price:  98.35529408212548
curr_Factors:  [98.35529408 -0.57438528 -0.97713686]
mat_Sqrt:  [[20.84396029  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00735926 -0.02083068  0.46876892]
Stock Position:  0.0073592577634422835
Bond Position:  [1.50244554]


portfolio before change:  [2.22392354]
curr_Stock_Price:  98.01126788579043
curr_Factors:  [98.01126789 -0.45948223 -0.98435234]
mat_Sqrt:  [[23.13271556  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [1.13441164e-04 1.73320370e-02 9.33463307e-01]
Stock Position:  0.00011344116351652968
Bond Position:  [2.21280503]


portfolio before change:  [2.22418849]
curr_Stock_Price:  97.90844257251821
curr_Factors:  [97.90844257 -0.28718483 -0.96669496]
mat_Sqrt:  [[27.94261633  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-3.00940294e-03 -1.88997071e-04 -2.35061714e-01]
Stock Position:  -0.003009402936270367
Bond Position:  [2.51883445]


portfolio before change:  [2.2175038]
curr_Stock_Price:  100.23434090883411
curr_Factors:  [100.23434091  -0.32532077  -0.95869846]
mat_Sqrt:  [[27.75709881  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-2.00832553e-04  1.47615247e-02  2.70973332e-01]
Stock Position:  -0.00020083255281565186
Bond Position:  [2.23763412]


portfolio before change:  [2.21755607]
curr_Stock_Price:  101.36688905601339
curr_Factors:  [101.36688906  -0.20732416  -0.96988274]
mat_Sqrt:  [[31.23501057  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00210687 -0.01480079  0.20400561]
Stock Position:  0.002106870876612465
Bond Position:  [2.00398912]


portfolio before change:  [2.2209313]
curr_Stock_Price:  102.84999624494615
curr_Factors:  [102.84999624  -0.23583158  -0.96173348]
mat_Sqrt:  [[31.05334483  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00508169  0.02216888  0.22744491]
Stock Position:  -0.0050816919367781994
Bond Position:  [2.7435833]


portfolio before change:  [2.21621349]
curr_Stock_Price:  103.84588087895044
curr_Factors:  [103.84588088  -0.41754163  -0.96703497]
mat_Sqrt:  [[26.00610414  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00164903  0.02328151  0.08378082]
Stock Position:  -0.0016490286965999972
Bond Position:  [2.38745833]


portfolio before change:  [2.21550577]
curr_Stock_Price:  104.45604066680244
curr_Factors:  [104.45604067  -0.73366842  -0.96585273]
mat_Sqrt:  [[19.0915374   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00403689 -0.02011351  0.23377856]
Stock Position:  0.004036885142621423
Bond Position:  [1.79382873]


portfolio before change:  [2.22073088]
curr_Stock_Price:  105.69483351000216
curr_Factors:  [105.69483351  -0.88904627  -0.96535696]
mat_Sqrt:  [[16.54613906  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0023534  -0.02228523 -0.11044865]
Stock Position:  -0.002353404202661006
Bond Position:  [2.46947354]


portfolio before change:  [2.22241143]
curr_Stock_Price:  105.11191159228206
curr_Factors:  [105.11191159  -0.90955621  -0.97427569]
mat_Sqrt:  [[15.9776954   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00330025  0.13328305  0.00730922]
Stock Position:  -0.003300247000395521
Bond Position:  [2.5693067]


portfolio before change:  [2.2214775]
curr_Stock_Price:  105.49221966068491
curr_Factors:  [105.49221966  -1.04927494  -0.96865188]
mat_Sqrt:  [[14.02316194  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0023716  -0.02935949 -0.05051804]
Stock Position:  0.0023715967373534753
Bond Position:  [1.9712925]


portfolio before change:  [2.22194184]
curr_Stock_Price:  105.58410047503187
curr_Factors:  [105.58410048  -1.26649739  -0.94665893]
mat_Sqrt:  [[11.54614341  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00745993 -0.02810923 -0.02859172]
Stock Position:  0.007459928979476788
Bond Position:  [1.43429194]


portfolio before change:  [2.22270842]
curr_Stock_Price:  105.66282536988298
curr_Factors:  [105.66282537  -1.13169747  -0.9437052 ]
mat_Sqrt:  [[13.26130587  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00751877 -0.01475366  0.09013974]
Stock Position:  -0.007518769697095018
Bond Position:  [3.01716287]


portfolio before change:  [2.22456057]
curr_Stock_Price:  105.46665099959122
curr_Factors:  [105.466651    -1.08578616  -0.91650801]
mat_Sqrt:  [[14.24065106  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00772597  0.00860951  0.10391084]
Stock Position:  -0.0077259679184636856
Bond Position:  [3.03939254]


portfolio before change:  [2.21696224]
curr_Stock_Price:  106.4993092405865
curr_Factors:  [106.49930924  -0.93890883  -0.93490482]
mat_Sqrt:  [[16.3515853   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00318859 -0.05218142 -0.39574898]
Stock Position:  0.0031885860315444374
Bond Position:  [1.87738003]


portfolio before change:  [2.21746937]
curr_Stock_Price:  106.58475209498027
curr_Factors:  [106.58475209  -1.16325831  -0.93980687]
mat_Sqrt:  [[13.01204268  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01841315 -0.13787214  0.28938394]
Stock Position:  -0.018413148618255597
Bond Position:  [4.18003025]


portfolio before change:  [2.2436793]
curr_Stock_Price:  105.18969465927354
curr_Factors:  [105.18969466  -1.08062595  -0.92467081]
mat_Sqrt:  [[14.16067247  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00277046 -0.01141987  0.14053558]
Stock Position:  -0.002770462117414464
Bond Position:  [2.53510337]


portfolio before change:  [2.24285551]
curr_Stock_Price:  105.60143247650957
curr_Factors:  [105.60143248  -1.03088401  -0.94507218]
mat_Sqrt:  [[14.63938861  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00244625  0.02160246 -0.08145284]
Stock Position:  -0.002446249529506036
Bond Position:  [2.50118296]


portfolio before change:  [2.24306345]
curr_Stock_Price:  105.64424084333592
curr_Factors:  [105.64424084  -1.12176584  -0.9329569 ]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [2.24306345]
Stock Price:  106.00191966636815
PL:  [-3.75885621]
Settle:  Tensor("sub_36:0", shape=(), dtype=float64)
PL:  Tensor("sub_37:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  19
output_Z_Vals[:, i, :]:  [[ 1.19260232e+02 -2.92559343e+01 -2.92733494e+01]
 [ 3.13850200e-02  3.12054011e-02 -5.08500015e-02]
 [-5.44366992e-02  6.12516468e-03  9.94286051e-02]
 [ 8.20916791e-02  1.99649703e-01  3.71909239e-02]
 [ 1.45275285e-01 -6.22343396e-03 -6.04338344e-02]
 [ 6.55629783e-02  2.84917222e-02 -5.99687218e-02]
 [ 6.92577452e-02  1.63812591e-02 -6.36833704e-02]
 [-1.09341277e-01 -6.41215265e-02 -1.21102326e-01]
 [-1.50575100e-01 -8.70392486e-02  1.34238223e-01]
 [-6.65387315e-02 -1.23117551e-01 -1.28204956e-01]
 [ 5.41774567e-02  1.91486189e-01 -8.24116857e-02]
 [-1.35721487e-01  1.03664326e-01  4.43023921e-02]
 [-1.09347321e-01  4.21972186e-02 -4.60374923e-02]
 [-1.06295365e-01 -1.09012954e-01  5.99992929e-02]
 [ 2.85256663e-01  3.62637258e-01  4.92972513e-02]
 [-7.13502059e-02 -1.96853134e-01 -9.90897896e-02]
 [-6.91473401e-02 -6.49927897e-02 -6.32459691e-02]
 [-7.96813677e-02  1.58931411e-01  1.25265932e-01]
 [ 1.48531177e-01  6.95056315e-02  1.77381177e-01]
 [ 3.39160487e-02 -2.81755182e-02  7.72142474e-02]
 [-1.81329756e-03 -4.02598884e-02  2.51885376e-03]
 [ 1.15206287e-01 -6.20856406e-02  1.37378955e-01]
 [-1.23877818e-02 -1.20754011e-01  1.40922222e-01]
 [-6.50953590e-02 -6.49064753e-04 -8.30285158e-02]
 [-3.01808220e-01  1.15492426e-01  4.32171179e-02]
 [-2.81810746e-02 -1.37323764e-01  9.73448605e-02]
 [ 2.01886388e-01  4.32559997e-02 -1.20053307e-01]
 [ 2.83865316e-02 -4.66878289e-02 -1.91668233e-02]
 [-7.77080315e-02 -7.30639039e-02 -2.03036148e-01]
 [ 7.21706621e-03 -5.09686533e-03 -1.14302753e-01]
 [ 2.46501008e-02  5.50568960e-03  2.04627897e-02]
 [ 4.38649339e-02 -7.59350065e-02 -8.91433281e-02]
 [ 3.91500643e-01 -4.96276723e-01 -5.19241982e-01]
 [-4.47742281e-02 -8.23444024e-02 -5.46867763e-03]
 [-9.95789523e-02 -4.99790816e-02  2.56401169e-02]
 [ 8.19146795e-03 -1.28657221e-01 -1.07462858e-01]
 [-4.32723055e-02 -1.86339854e-01 -2.81485188e-02]
 [-1.99779320e-02  1.42937481e-02 -8.42644417e-02]
 [-2.41584750e-02  6.29979871e-04  2.65965013e-02]
 [-8.28182107e-01  4.12240746e-01  5.06744747e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.26023247 -29.25593426 -29.27334937]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  8.31486419  -9.25153874 -83.50871763]
init_Out:  [2.49911038]
Stock Position:  8.31486419409362
Bond position:  [-828.98730903]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-3.47882137]
curr_Stock_Price:  99.29351800349565
curr_Factors:  [99.293518   -0.84785592 -1.00911298]
mat_Sqrt:  [[15.50420671  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00140678  0.00986801 -0.1450609 ]
Stock Position:  0.0014067812214088459
Bond Position:  [-3.61850562]


portfolio before change:  [-3.47973896]
curr_Stock_Price:  98.96279487692306
curr_Factors:  [98.96279488 -0.82939458 -1.01972199]
mat_Sqrt:  [[15.57438217  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00218197  0.00193695  0.28364213]
Stock Position:  -0.0021819657889434667
Bond Position:  [-3.26380553]


portfolio before change:  [-3.48129996]
curr_Stock_Price:  99.49121348821338
curr_Factors:  [99.49121349 -1.40867039 -1.04802787]
mat_Sqrt:  [[ 8.52813821  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01112062 0.06313478 0.10609535]
Stock Position:  0.011120619224660592
Bond Position:  [-4.58770386]


portfolio before change:  [-3.48014911]
curr_Stock_Price:  99.64627213233256
curr_Factors:  [99.64627213 -1.40539844 -1.03974268]
mat_Sqrt:  [[ 8.64071651  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01536662 -0.00196802 -0.17240091]
Stock Position:  0.015366618201750566
Bond Position:  [-5.01137533]


portfolio before change:  [-3.4937984]
curr_Stock_Price:  98.79879657954368
curr_Factors:  [98.79879658 -1.38133695 -1.03836702]
mat_Sqrt:  [[ 8.78794992  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00615133  0.00900987 -0.17107407]
Stock Position:  0.006151328564798648
Bond Position:  [-4.10154226]


portfolio before change:  [-3.48947689]
curr_Stock_Price:  99.58468079597328
curr_Factors:  [99.5846808  -1.36932431 -1.05776343]
mat_Sqrt:  [[ 8.79268922  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00644642  0.00518021 -0.18167093]
Stock Position:  0.0064464229938226035
Bond Position:  [-4.13144187]


portfolio before change:  [-3.49089167]
curr_Stock_Price:  99.44532981267488
curr_Factors:  [99.44532981 -1.51321232 -1.08297189]
mat_Sqrt:  [[ 7.41439835  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01830449 -0.02027701 -0.34547123]
Stock Position:  -0.01830449224363819
Bond Position:  [-1.6705954]


portfolio before change:  [-3.48342288]
curr_Stock_Price:  99.02589042319181
curr_Factors:  [99.02589042 -1.42337552 -1.08323407]
mat_Sqrt:  [[ 8.07499094  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01553205 -0.02752423  0.38294428]
Stock Position:  -0.015532052204897048
Bond Position:  [-1.94534758]


portfolio before change:  [-3.48286712]
curr_Stock_Price:  98.97445154413654
curr_Factors:  [98.97445154 -1.4425601  -1.05611796]
mat_Sqrt:  [[ 8.13506469  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01178692 -0.03893319 -0.36573305]
Stock Position:  -0.011786917947393656
Bond Position:  [-2.31626338]


portfolio before change:  [-3.48575894]
curr_Stock_Price:  99.19522808363192
curr_Factors:  [99.19522808 -1.50736776 -1.05445358]
mat_Sqrt:  [[ 7.65430752  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00552622  0.06055325 -0.2350976 ]
Stock Position:  0.0055262208609041
Bond Position:  [-4.03393368]


portfolio before change:  [-3.48590948]
curr_Stock_Price:  99.25923878847763
curr_Factors:  [99.25923879 -1.48506946 -1.06115914]
mat_Sqrt:  [[ 7.77961146  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01593932  0.03278154  0.12638239]
Stock Position:  -0.015939317644095223
Bond Position:  [-1.90378494]


portfolio before change:  [-3.47936157]
curr_Stock_Price:  98.83350537885694
curr_Factors:  [98.83350538 -1.28185005 -1.07010648]
mat_Sqrt:  [[ 9.40724501  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01250687  0.01334393 -0.13133215]
Stock Position:  -0.012506866496071908
Bond Position:  [-2.24326411]


portfolio before change:  [-3.48758554]
curr_Stock_Price:  99.46864000755463
curr_Factors:  [99.46864001 -1.12966113 -1.07613532]
mat_Sqrt:  [[10.95773904  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00883967 -0.03447292  0.17116128]
Stock Position:  -0.008839666870119167
Bond Position:  [-2.60831589]


portfolio before change:  [-3.48602045]
curr_Stock_Price:  99.2547018882686
curr_Factors:  [99.25470189 -1.01220127 -1.09084901]
mat_Sqrt:  [[12.11735848  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.02514431 0.11467597 0.14063134]
Stock Position:  0.025144314808606662
Bond Position:  [-5.98171192]


portfolio before change:  [-3.48802612]
curr_Stock_Price:  99.20467441156771
curr_Factors:  [99.20467441 -1.03762709 -1.10300075]
mat_Sqrt:  [[11.6645846   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00828658 -0.06225043 -0.28267559]
Stock Position:  -0.008286583185604752
Bond Position:  [-2.66595833]


portfolio before change:  [-3.48884949]
curr_Stock_Price:  99.26381887746463
curr_Factors:  [99.26381888 -1.20682232 -1.10658895]
mat_Sqrt:  [[ 9.81949681  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00852747 -0.02055252 -0.18042315]
Stock Position:  -0.008527471183693371
Bond Position:  [-2.64238014]


portfolio before change:  [-3.49750892]
curr_Stock_Price:  100.24055776924848
curr_Factors:  [100.24055777  -1.2546802   -1.11135123]
mat_Sqrt:  [[ 9.40782175  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00531557  0.05025853  0.35734884]
Stock Position:  -0.005315574248087478
Bond Position:  [-2.9646728]


portfolio before change:  [-3.49687729]
curr_Stock_Price:  100.05200996003845
curr_Factors:  [100.05200996  -1.43529341  -1.09723202]
mat_Sqrt:  [[ 7.94994268  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.02346351 0.02197961 0.50601913]
Stock Position:  0.023463513264522697
Bond Position:  [-5.84444895]


portfolio before change:  [-3.51515635]
curr_Stock_Price:  99.30410590358896
curr_Factors:  [99.3041059  -1.34312599 -1.09233419]
mat_Sqrt:  [[ 8.69481385  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00562978 -0.00890988  0.22027076]
Stock Position:  0.005629775759230204
Bond Position:  [-4.0742162]


portfolio before change:  [-3.51800793]
curr_Stock_Price:  98.88805427933346
curr_Factors:  [98.88805428 -1.34134474 -1.09476455]
mat_Sqrt:  [[ 8.65276706  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00027028 -0.01273129  0.00718559]
Stock Position:  -0.00027027707105561525
Bond Position:  [-3.49128076]


portfolio before change:  [-3.51855922]
curr_Stock_Price:  99.31297180421974
curr_Factors:  [99.3129718  -1.44822443 -1.10979984]
mat_Sqrt:  [[ 7.6925469   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01841336 -0.0196332   0.39190392]
Stock Position:  0.018413356017231652
Bond Position:  [-5.34724432]


portfolio before change:  [-3.51629683]
curr_Stock_Price:  99.47214056337006
curr_Factors:  [99.47214056 -1.27990881 -1.10154181]
mat_Sqrt:  [[ 9.19285895  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00144242 -0.03818577  0.40201187]
Stock Position:  0.0014424229990748028
Bond Position:  [-3.65977774]


portfolio before change:  [-3.51717962]
curr_Stock_Price:  99.17729716441534
curr_Factors:  [99.17729716 -1.43212498 -1.12111555]
mat_Sqrt:  [[ 7.71887478  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-1.06311146e-02 -2.05252297e-04 -2.36857245e-01]
Stock Position:  -0.010631114626566568
Bond Position:  [-2.46281441]


portfolio before change:  [-3.52083016]
curr_Stock_Price:  99.49171982070936
curr_Factors:  [99.49171982 -1.4545432  -1.13498033]
mat_Sqrt:  [[ 7.46742995  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.03883593  0.03652191  0.12328641]
Stock Position:  -0.03883592649094669
Bond Position:  [0.34302296]


portfolio before change:  [-3.50343807]
curr_Stock_Price:  99.04498898908813
curr_Factors:  [99.04498899 -1.44662949 -1.14469344]
mat_Sqrt:  [[ 7.42053573  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00159777 -0.04342559  0.27769779]
Stock Position:  -0.001597771765684074
Bond Position:  [-3.34518678]


portfolio before change:  [-3.50348147]
curr_Stock_Price:  98.81042440994779
curr_Factors:  [98.81042441 -1.40671906 -1.12280131]
mat_Sqrt:  [[ 7.87491774  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.02266658  0.01367875 -0.34247867]
Stock Position:  0.0226665827316156
Bond Position:  [-5.74317613]


portfolio before change:  [-3.49556057]
curr_Stock_Price:  99.19155103052995
curr_Factors:  [99.19155103 -1.48801629 -1.14064217]
mat_Sqrt:  [[ 7.15917234  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00325019 -0.01476399 -0.05467761]
Stock Position:  0.0032501865455052143
Bond Position:  [-3.81795161]


portfolio before change:  [-3.49754593]
curr_Stock_Price:  98.72754998701552
curr_Factors:  [98.72754999 -1.57403619 -1.12756813]
mat_Sqrt:  [[ 6.62439942  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01827171 -0.02310484 -0.57920561]
Stock Position:  -0.01827171126374239
Bond Position:  [-1.69362465]


portfolio before change:  [-3.49783208]
curr_Stock_Price:  98.73162332896506
curr_Factors:  [98.73162333 -1.6994516  -1.10688938]
mat_Sqrt:  [[ 5.96592622  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00272321 -0.00161177 -0.32607394]
Stock Position:  -0.0027232126856087916
Bond Position:  [-3.22896487]


portfolio before change:  [-3.49856415]
curr_Stock_Price:  98.85222573106871
curr_Factors:  [98.85222573 -1.49213188 -1.11424138]
mat_Sqrt:  [[ 7.29546418  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00397085 0.00174105 0.05837464]
Stock Position:  0.00397085172609669
Bond Position:  [-3.89109168]


portfolio before change:  [-3.49882743]
curr_Stock_Price:  98.9084187776611
curr_Factors:  [98.90841878 -1.50959918 -1.09308803]
mat_Sqrt:  [[ 7.32656765  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00323589 -0.02401276 -0.2543011 ]
Stock Position:  0.003235893794246217
Bond Position:  [-3.81888457]


portfolio before change:  [-3.49941742]
curr_Stock_Price:  98.87362102616862
curr_Factors:  [98.87362103 -1.582129   -1.10385518]
mat_Sqrt:  [[ 6.73864114  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.04046766 -0.15693648 -1.48125284]
Stock Position:  0.04046765542526069
Bond Position:  [-7.50060105]


portfolio before change:  [-3.51617694]
curr_Stock_Price:  98.48264504229913
curr_Factors:  [98.48264504 -1.50442667 -1.07962623]
mat_Sqrt:  [[ 7.43224111  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00646059 -0.02603959 -0.01560062]
Stock Position:  -0.006460587036648412
Bond Position:  [-2.87992124]


portfolio before change:  [-3.51579916]
curr_Stock_Price:  98.36844600732991
curr_Factors:  [98.36844601 -1.60933443 -1.09277751]
mat_Sqrt:  [[ 6.59695476  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01449694 -0.01580477  0.07314412]
Stock Position:  -0.014496937312892477
Bond Position:  [-2.08975796]


portfolio before change:  [-3.51192462]
curr_Stock_Price:  98.0831597643626
curr_Factors:  [98.08315976 -1.60334376 -1.10831661]
mat_Sqrt:  [[ 6.51531348  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0026194  -0.04068499 -0.30656162]
Stock Position:  -0.002619399858444655
Bond Position:  [-3.2550056]


portfolio before change:  [-3.51129613]
curr_Stock_Price:  97.6878809410221
curr_Factors:  [97.68788094 -1.68716697 -1.07914946]
mat_Sqrt:  [[ 6.14390834  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00876142 -0.05892584 -0.08029989]
Stock Position:  -0.008761421750565488
Bond Position:  [-2.6554114]


portfolio before change:  [-3.51086273]
curr_Stock_Price:  97.60052697277695
curr_Factors:  [97.60052697 -1.85929661 -1.07267138]
mat_Sqrt:  [[ 5.2013328   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00707689  0.00452008 -0.240383  ]
Stock Position:  -0.007076893100056632
Bond Position:  [-2.82015423]


portfolio before change:  [-3.51033721]
curr_Stock_Price:  97.47645357841814
curr_Factors:  [97.47645358 -1.90333854 -1.08978779]
mat_Sqrt:  [[ 4.8865401   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00382954  0.00019922  0.07587242]
Stock Position:  -0.003829544116635583
Bond Position:  [-3.13704684]


portfolio before change:  [-3.51120827]
curr_Stock_Price:  97.60150890884525
curr_Factors:  [97.60150891 -1.82871529 -1.11261174]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-3.51120827]
Stock Price:  97.59417975986219
PL:  [-3.51120827]
Settle:  Tensor("sub_38:0", shape=(), dtype=float64)
PL:  Tensor("sub_39:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  20
output_Z_Vals[:, i, :]:  [[ 1.19260232e+02 -2.92559343e+01 -2.92733494e+01]
 [-1.27747822e-01  3.46200082e-01  5.45322912e-02]
 [-5.43596011e-02 -7.19826871e-02 -6.75663285e-02]
 [ 8.29734490e-02  1.52183188e-01  3.77143359e-02]
 [ 1.06149235e-01  7.94814907e-03 -6.72925411e-02]
 [ 4.71312686e-02  2.78442662e-02  4.97223965e-02]
 [-3.49667398e-03  6.42991701e-02  2.41636744e-02]
 [-1.23734916e-01  2.47855074e-01  9.42161008e-03]
 [ 3.58360618e-02 -3.25601839e-02 -1.62077056e-02]
 [-4.30532177e-02  4.19570621e-01  1.86133195e-01]
 [ 5.56055863e-02  2.46199705e-02 -7.60506724e-02]
 [-7.65306838e-02  7.97788168e-02  2.31312166e-02]
 [-8.12105722e-02 -2.94172755e-02 -5.95468452e-02]
 [-5.61439710e-02 -7.86710117e-02  9.04268161e-02]
 [ 3.32800412e-01  3.98261240e-01  2.80414054e-02]
 [-7.56917016e-02 -1.68134282e-01 -9.67839909e-02]
 [-6.89452944e-02 -6.30834786e-02 -6.60257887e-02]
 [-8.02542468e-02  1.53436132e-01  1.24127176e-01]
 [ 1.39521220e-01  6.87697113e-02  1.65603680e-01]
 [ 8.78540301e-02 -3.67940039e-02  5.29538770e-02]
 [-3.12205557e-03 -3.94081909e-02  1.83140547e-03]
 [ 1.04950767e-01 -6.23548058e-02  1.10440593e-01]
 [-3.03303253e-02 -6.12176626e-02  2.00952604e-01]
 [-5.14925239e-02 -9.72761042e-04 -8.69920108e-02]
 [-1.22806861e-01  8.01351200e-02  5.93759674e-02]
 [ 2.84643684e-02 -7.34518842e-02  7.91610711e-02]
 [-1.83753850e-01  7.10748720e-02  7.39038633e-02]
 [-5.07806065e-02  7.36225950e-02  2.93687317e-02]
 [ 2.61198735e-02 -8.28198408e-02 -2.08982862e-01]
 [ 4.57200845e-02  1.35217559e-02 -9.99038982e-03]
 [-4.25551261e-02  3.43941754e-01  1.19158818e-02]
 [ 2.41769893e-02 -1.14024888e-01 -6.95311712e-02]
 [ 9.47200394e-03 -9.28297102e-03  7.46008642e-02]
 [-9.62736151e-02 -5.03466201e-02  2.94303000e-02]
 [-1.23785453e-01  4.40011652e-02  3.61618195e-02]
 [ 8.47165236e-02 -1.65012150e-01 -1.38726811e-01]
 [-2.43867947e-01 -4.25939466e-01  9.66345733e-02]
 [-5.75575955e-02 -6.27136994e-02  9.38906899e-02]
 [-2.00665179e-02  4.38173595e-02 -3.58817372e-02]
 [ 2.85426953e-01 -1.88330096e-02 -2.88139332e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.26023247 -29.25593426 -29.27334937]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  8.31486419  -9.25153874 -83.50871763]
init_Out:  [2.49911038]
Stock Position:  8.31486419409362
Bond position:  [-828.98730903]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [10.61533267]
curr_Stock_Price:  100.98857323299129
curr_Factors:  [100.98857323  -1.11700053  -1.01469512]
mat_Sqrt:  [[11.98087626  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00898746  0.10947808  0.15556545]
Stock Position:  -0.008987457543201202
Bond Position:  [11.52296318]


portfolio before change:  [10.62325219]
curr_Stock_Price:  100.26767259336178
curr_Factors:  [100.26767259  -1.04034301  -0.99991873]
mat_Sqrt:  [[13.0342642   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00537124 -0.02276292 -0.19274793]
Stock Position:  -0.0053712356942353275
Bond Position:  [11.16181349]


portfolio before change:  [10.62544766]
curr_Stock_Price:  100.11870320930157
curr_Factors:  [100.11870321  -0.8640841   -0.99078914]
mat_Sqrt:  [[15.66585152  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00603869 0.04812455 0.1075885 ]
Stock Position:  0.006038689214099628
Bond Position:  [10.02086192]


portfolio before change:  [10.62447145]
curr_Stock_Price:  99.74960074124424
curr_Factors:  [99.74960074 -0.57200944 -1.00638073]
mat_Sqrt:  [[20.57903589  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00450062  0.00251343 -0.19196689]
Stock Position:  0.004500620133836271
Bond Position:  [10.17553639]


portfolio before change:  [10.6278153]
curr_Stock_Price:  100.20994368162938
curr_Factors:  [100.20994368  -0.49475672  -1.03806054]
mat_Sqrt:  [[21.63798114  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00268046 0.00880513 0.14184416]
Stock Position:  0.0026804601514789357
Bond Position:  [10.35920654]


portfolio before change:  [10.63171071]
curr_Stock_Price:  101.18008858682357
curr_Factors:  [101.18008859  -0.46027187  -1.04872227]
mat_Sqrt:  [[22.37418502  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00013837 0.02033318 0.06893224]
Stock Position:  0.0001383698591470392
Bond Position:  [10.61771044]


portfolio before change:  [10.63299116]
curr_Stock_Price:  100.84147685581827
curr_Factors:  [100.84147686  -0.7416209   -1.0011463 ]
mat_Sqrt:  [[17.65082543  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00653863  0.07837866  0.02687723]
Stock Position:  -0.006538626055056113
Bond Position:  [11.29235587]


portfolio before change:  [10.63904428]
curr_Stock_Price:  100.13161956363038
curr_Factors:  [100.13161956  -0.71431267  -0.99571887]
mat_Sqrt:  [[18.10981354  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00174971 -0.01029643 -0.04623607]
Stock Position:  0.0017497130688414308
Bond Position:  [10.46384268]


portfolio before change:  [10.64228682]
curr_Stock_Price:  101.23721659669997
curr_Factors:  [101.2372166   -0.61658494  -1.0024798 ]
mat_Sqrt:  [[20.0534599   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [2.87946742e-04 1.32679880e-01 5.30986195e-01]
Stock Position:  0.00028794674234206545
Bond Position:  [10.61313589]


portfolio before change:  [10.64383927]
curr_Stock_Price:  102.02113979784555
curr_Factors:  [102.0211398   -0.66017613  -1.00170599]
mat_Sqrt:  [[19.36172015  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00210299  0.00778552 -0.2169514 ]
Stock Position:  0.0021029894255919514
Bond Position:  [10.4292899]


portfolio before change:  [10.64621564]
curr_Stock_Price:  102.5311888937465
curr_Factors:  [102.53118889  -0.44868314  -1.01374563]
mat_Sqrt:  [[23.75369896  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00293635  0.02522828  0.06598692]
Stock Position:  -0.002936349574549922
Bond Position:  [10.94728306]


portfolio before change:  [10.65218432]
curr_Stock_Price:  100.96455743066754
curr_Factors:  [100.96455743  -0.76002748  -0.99976549]
mat_Sqrt:  [[17.37403003  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00541757 -0.00930256 -0.16987057]
Stock Position:  -0.005417572760712159
Bond Position:  [11.19916715]


portfolio before change:  [10.65721759]
curr_Stock_Price:  100.29390915926022
curr_Factors:  [100.29390916  -0.81934837  -1.03051396]
mat_Sqrt:  [[15.77210138  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00251818 -0.02487796  0.25796254]
Stock Position:  -0.0025181775272806
Bond Position:  [10.90977546]


portfolio before change:  [10.6634976]
curr_Stock_Price:  98.34162158410524
curr_Factors:  [98.34162158 -1.06208098 -1.01557813]
mat_Sqrt:  [[12.31463323  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.02832463 0.12594126 0.07999432]
Stock Position:  0.028324627673351838
Bond Position:  [7.87800778]


portfolio before change:  [10.69379736]
curr_Stock_Price:  99.3765847438152
curr_Factors:  [99.37658474 -0.96404544 -0.98535344]
mat_Sqrt:  [[14.14721294  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00705361 -0.05316873 -0.27609779]
Stock Position:  -0.007053605535144036
Bond Position:  [11.39476059]


portfolio before change:  [10.69466385]
curr_Stock_Price:  99.45568582400264
curr_Factors:  [99.45568582 -1.15172577 -0.9932392 ]
mat_Sqrt:  [[11.64348981  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00721876 -0.01994875 -0.1883532 ]
Stock Position:  -0.007218760169909143
Bond Position:  [11.41261059]


portfolio before change:  [10.69382542]
curr_Stock_Price:  99.7694637846173
curr_Factors:  [99.76946378 -1.13463339 -1.00008037]
mat_Sqrt:  [[11.80057671  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00431803  0.04852077  0.35410028]
Stock Position:  -0.0043180253446924565
Bond Position:  [11.1246325]


portfolio before change:  [10.69408661]
curr_Stock_Price:  100.03103756824538
curr_Factors:  [100.03103757  -1.34982883  -1.00186956]
mat_Sqrt:  [[ 9.52368755  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01838579 0.02174689 0.4724212 ]
Stock Position:  0.01838579387974197
Bond Position:  [8.85493657]


portfolio before change:  [10.68950269]
curr_Stock_Price:  99.72151280604247
curr_Factors:  [99.72151281 -1.31985635 -0.99234232]
mat_Sqrt:  [[ 9.87674256  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00989326 -0.01163529  0.15106267]
Stock Position:  0.009893259575859521
Bond Position:  [9.70293187]


portfolio before change:  [10.68484713]
curr_Stock_Price:  99.12833158286735
curr_Factors:  [99.12833158 -1.24405911 -0.97963267]
mat_Sqrt:  [[10.72656653  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00035107 -0.01246196  0.00522449]
Stock Position:  -0.0003510663544607208
Bond Position:  [10.71964775]


portfolio before change:  [10.68592944]
curr_Stock_Price:  99.8624656214754
curr_Factors:  [99.86246562 -1.31140962 -0.9607939 ]
mat_Sqrt:  [[10.29430033  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01222855 -0.01971832  0.31505627]
Stock Position:  0.012228549822586124
Bond Position:  [9.46475631]


portfolio before change:  [10.6854414]
curr_Stock_Price:  99.72580067526688
curr_Factors:  [99.72580068 -1.11928956 -0.96698957]
mat_Sqrt:  [[12.38078031  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00073568 -0.01935872  0.57326185]
Stock Position:  0.0007356822258532553
Bond Position:  [10.6120749]


portfolio before change:  [10.68720237]
curr_Stock_Price:  100.31624145707484
curr_Factors:  [100.31624146  -1.04135821  -0.96868342]
mat_Sqrt:  [[13.44068081  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00515411 -0.00030761 -0.24816399]
Stock Position:  -0.005154114681779535
Bond Position:  [11.20424378]


portfolio before change:  [10.68650592]
curr_Stock_Price:  100.72311340746413
curr_Factors:  [100.72311341  -1.21363243  -0.94700174]
mat_Sqrt:  [[11.60854106  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00935671  0.02534095  0.16938311]
Stock Position:  -0.00935670656479505
Bond Position:  [11.62894253]


portfolio before change:  [10.685543]
curr_Stock_Price:  100.9813904576818
curr_Factors:  [100.98139046  -1.02285062  -0.9626644 ]
mat_Sqrt:  [[13.86574241  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00308145 -0.02322753  0.2258245 ]
Stock Position:  0.0030814458844705163
Bond Position:  [10.37437431]


portfolio before change:  [10.69073895]
curr_Stock_Price:  102.2467289807172
curr_Factors:  [102.24672898  -0.72939493  -0.95557246]
mat_Sqrt:  [[18.96170494  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00879843  0.02247585  0.21082715]
Stock Position:  -0.008798425153638191
Bond Position:  [11.59034915]


portfolio before change:  [10.69810232]
curr_Stock_Price:  101.57450802171098
curr_Factors:  [101.57450802  -0.66383187  -0.94108788]
mat_Sqrt:  [[20.40689525  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00210149  0.02328151  0.08378082]
Stock Position:  -0.002101486359725817
Bond Position:  [10.91155977]


portfolio before change:  [10.69850847]
curr_Stock_Price:  102.0303226331047
curr_Factors:  [102.03032263  -0.7808992   -0.96261888]
mat_Sqrt:  [[17.84551062  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00104659 -0.02618993 -0.59616993]
Stock Position:  -0.0010465922757305112
Bond Position:  [10.80529261]


portfolio before change:  [10.69831299]
curr_Stock_Price:  103.50770642080649
curr_Factors:  [103.50770642  -0.99067735  -0.93136552]
mat_Sqrt:  [[15.14398169  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00290742  0.00427595 -0.0284998 ]
Stock Position:  0.0029074213044227018
Bond Position:  [10.39737248]


portfolio before change:  [10.69992578]
curr_Stock_Price:  103.61537367682908
curr_Factors:  [103.61537368  -0.74208726  -0.95320858]
mat_Sqrt:  [[19.01807548  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00164277  0.10876393  0.03399269]
Stock Position:  -0.0016427671150644793
Bond Position:  [10.87014171]


portfolio before change:  [10.70123434]
curr_Stock_Price:  103.64598755081501
curr_Factors:  [103.64598755  -0.93266443  -0.94014013]
mat_Sqrt:  [[15.92956103  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00044194 -0.03605784 -0.19835308]
Stock Position:  0.00044193863350675217
Bond Position:  [10.65542918]


portfolio before change:  [10.70369967]
curr_Stock_Price:  106.21040385333256
curr_Factors:  [106.21040385  -1.02653423  -0.96084857]
mat_Sqrt:  [[14.55652382  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00168036 -0.00293553  0.2128155 ]
Stock Position:  0.001680356972619235
Bond Position:  [10.52522828]


portfolio before change:  [10.70385974]
curr_Stock_Price:  105.52265313090734
curr_Factors:  [105.52265313  -1.08770823  -0.950297  ]
mat_Sqrt:  [[13.74837206  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00666014 -0.015921    0.08395645]
Stock Position:  -0.006660143033403947
Bond Position:  [11.4066557]


portfolio before change:  [10.70420896]
curr_Stock_Price:  105.6843158591704
curr_Factors:  [105.68431586  -0.93551578  -0.95900478]
mat_Sqrt:  [[15.89390864  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00725233  0.01391439  0.10315961]
Stock Position:  -0.007252328557241546
Bond Position:  [11.47066634]


portfolio before change:  [10.70195211]
curr_Stock_Price:  106.19322475556663
curr_Factors:  [106.19322476  -0.87647161  -0.9813326 ]
mat_Sqrt:  [[16.56771786  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00314699 -0.05218142 -0.39574898]
Stock Position:  0.003146989640942444
Bond Position:  [10.36776313]


portfolio before change:  [10.70502769]
curr_Stock_Price:  106.75869362532111
curr_Factors:  [106.75869363  -0.91531342  -0.98440849]
mat_Sqrt:  [[15.9721914   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01472185 -0.13469389  0.27567154]
Stock Position:  -0.014721850050475278
Bond Position:  [12.27671317]


portfolio before change:  [10.68866979]
curr_Stock_Price:  107.97406982316244
curr_Factors:  [107.97406982  -1.07926386  -0.99619285]
mat_Sqrt:  [[13.55064843  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00295274 -0.01983181  0.267844  ]
Stock Position:  -0.002952736883126155
Bond Position:  [11.0074888]


portfolio before change:  [10.68644087]
curr_Stock_Price:  109.19494971489314
curr_Factors:  [109.19494971  -1.23580031  -1.0106392 ]
mat_Sqrt:  [[11.550114    0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00227353  0.01385627 -0.10236061]
Stock Position:  -0.002273526258297267
Bond Position:  [10.93469846]


portfolio before change:  [10.68792408]
curr_Stock_Price:  109.14380312690022
curr_Factors:  [109.14380313  -1.10932745  -1.01438289]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [10.68792408]
Stock Price:  108.8243234826041
PL:  [1.86360059]
Settle:  Tensor("sub_40:0", shape=(), dtype=float64)
PL:  Tensor("sub_41:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  21
output_Z_Vals[:, i, :]:  [[ 1.19260232e+02 -2.92559343e+01 -2.92733494e+01]
 [ 1.88683071e-02 -1.92119660e-02 -3.91823563e-02]
 [-3.79337043e-02  3.12429236e-03  3.61144180e-02]
 [-5.61808419e-02  1.10531789e-01  1.16284466e-02]
 [ 3.49998464e-02  3.14096977e-02 -7.07374457e-02]
 [ 5.47904723e-02  2.88765273e-02  3.46341513e-02]
 [-1.07711676e-03  3.19693923e-02  4.74890449e-02]
 [-3.18658331e-02 -1.08469418e-02 -4.79014073e-02]
 [ 1.30988728e-01 -7.19394515e-02 -1.87041666e-01]
 [-1.85427963e-01 -1.98949508e-01 -6.78308203e-03]
 [ 3.42338408e-01  1.32414036e-01  6.54733058e-01]
 [-3.33400055e-01 -1.46254993e-01  1.23268474e-01]
 [ 1.12748195e-01 -3.07728543e-01  1.74098940e-01]
 [-1.24967317e-01 -1.21803434e-01 -2.89598384e-02]
 [-8.87903819e-02  1.65793375e-01  3.11339606e-01]
 [-1.29326406e-02 -6.06214480e-01 -1.82289604e-03]
 [-6.53496214e-02 -9.39115910e-02 -2.16825851e-02]
 [ 1.22873595e-01  4.34019493e-02 -1.97182261e-01]
 [-1.37390636e-01  3.04059234e-02 -2.36886911e-01]
 [-7.05809014e-02 -3.08614341e-02  1.52363458e-01]
 [ 2.08516762e-01 -1.65662879e-01  8.71065638e-02]
 [ 1.12307023e-01  2.11601184e-01  3.55027683e-01]
 [-5.39773949e-02 -5.76447720e-02  1.61004893e-01]
 [-1.60643780e-01 -1.29649931e-01 -5.73669859e-02]
 [-8.32535581e-01  1.84256252e-01  3.95202191e-02]
 [-1.89624828e-01 -3.18749388e-01  1.49100193e-01]
 [-2.10997757e-02  7.76566433e-02  4.58315352e-02]
 [ 1.33554200e-02 -2.05499663e-02 -1.27429544e-02]
 [-1.13208276e-01 -1.46984457e-01 -1.20101623e-01]
 [ 1.27422715e-01  1.76845202e-01  5.19334267e-02]
 [ 9.06747190e-02 -1.03087953e-01  8.21544887e-02]
 [ 1.03264153e-01  2.12372390e-03 -9.22058082e-03]
 [ 5.19152623e-01 -6.13260351e-01 -6.43784144e-01]
 [-4.63322572e-02 -8.18702271e-02  2.59516246e-03]
 [-6.66764771e-02 -1.98413506e-01  1.03854610e-02]
 [ 1.89403927e-01 -2.62940139e-02 -1.80651446e-02]
 [ 1.80855489e-02 -1.47027074e-02 -8.74117542e-02]
 [-1.43024279e-02  3.03637010e-02 -6.10041271e-02]
 [ 1.04628088e-01 -1.89739350e-01 -2.08453900e-02]
 [-7.13371894e-01  3.65886123e-01  4.24761362e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.26023247 -29.25593426 -29.27334937]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  8.31486419  -9.25153874 -83.50871763]
init_Out:  [2.49911038]
Stock Position:  8.31486419409362
Bond position:  [-828.98730903]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-2.29803958]
curr_Stock_Price:  99.4355265511802
curr_Factors:  [99.43552655 -0.86458291 -0.96852247]
mat_Sqrt:  [[15.90135112  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00065241 -0.00607536 -0.11177636]
Stock Position:  0.0006524094225781743
Bond Position:  [-2.36291225]


portfolio before change:  [-2.29801043]
curr_Stock_Price:  99.93295504536583
curr_Factors:  [99.93295505 -0.91061832 -0.98587015]
mat_Sqrt:  [[14.99941255  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00203216  0.00098799  0.10302438]
Stock Position:  -0.0020321602969682185
Bond Position:  [-2.09493065]


portfolio before change:  [-2.29565001]
curr_Stock_Price:  98.64255358779849
curr_Factors:  [98.64255359 -0.96906906 -0.99222807]
mat_Sqrt:  [[13.87662274  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00367188  0.03495322  0.03317272]
Stock Position:  -0.0036718787816045007
Bond Position:  [-1.93344651]


portfolio before change:  [-2.29714195]
curr_Stock_Price:  98.98304327742001
curr_Factors:  [98.98304328 -0.6147971  -0.98463516]
mat_Sqrt:  [[19.99568077  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00106881  0.00993262 -0.20179424]
Stock Position:  0.0010688118567083482
Bond Position:  [-2.4029362]


portfolio before change:  [-2.29884768]
curr_Stock_Price:  97.66817005326264
curr_Factors:  [97.66817005 -0.64931554 -1.01520836]
mat_Sqrt:  [[18.48670493  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00338653 0.00913156 0.09880159]
Stock Position:  0.003386527116224205
Bond Position:  [-2.62960359]


portfolio before change:  [-2.30244696]
curr_Stock_Price:  96.702416192748
curr_Factors:  [96.70241619 -0.62283872 -1.03437172]
mat_Sqrt:  [[18.43826183  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00051209 0.01010961 0.13547303]
Stock Position:  0.0005120867786739727
Bond Position:  [-2.35196699]


portfolio before change:  [-2.30249797]
curr_Stock_Price:  97.17694849716398
curr_Factors:  [97.1769485  -0.63268512 -0.98818668]
mat_Sqrt:  [[19.21443332  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00218189 -0.0034301  -0.13664938]
Stock Position:  -0.002181887599755565
Bond Position:  [-2.09046879]


portfolio before change:  [-2.29910535]
curr_Stock_Price:  95.50227857774817
curr_Factors:  [95.50227858 -0.35524079 -0.98617243]
mat_Sqrt:  [[24.97154262  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00364221 -0.02274925 -0.53357781]
Stock Position:  0.003642207458195792
Bond Position:  [-2.64694446]


portfolio before change:  [-2.30551628]
curr_Stock_Price:  93.83295104660428
curr_Factors:  [93.83295105 -0.26806    -0.97450367]
mat_Sqrt:  [[27.08425102  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00708712 -0.06291336 -0.01935024]
Stock Position:  -0.0070871226348017185
Bond Position:  [-1.64051065]


portfolio before change:  [-2.29356596]
curr_Stock_Price:  92.11781252423276
curr_Factors:  [92.11781252 -0.09903334 -0.96525877]
mat_Sqrt:  [[31.77806335  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01508601 0.04187299 1.86777117]
Stock Position:  0.01508600899061661
Bond Position:  [-3.68325611]


portfolio before change:  [-2.30306024]
curr_Stock_Price:  91.51898995097261
curr_Factors:  [ 9.15189900e+01 -3.74944661e-02 -9.73247835e-01]
mat_Sqrt:  [[33.30821922  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00936749 -0.04624989  0.35165065]
Stock Position:  -0.009367485795123939
Bond Position:  [-1.4457574]


portfolio before change:  [-2.31640469]
curr_Stock_Price:  92.92424660935406
curr_Factors:  [ 9.29242466e+01  6.64070154e-02 -9.91471950e-01]
mat_Sqrt:  [[36.84499079  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00380894 -0.09731231  0.49665582]
Stock Position:  0.0038089431614565634
Bond Position:  [-2.67034786]


portfolio before change:  [-2.31189413]
curr_Stock_Price:  94.19608855374118
curr_Factors:  [94.19608855 -0.24883072 -1.01308316]
mat_Sqrt:  [[26.66801166  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00502563 -0.03851763 -0.08261436]
Stock Position:  -0.00502563414767769
Bond Position:  [-1.83849905]


portfolio before change:  [-2.31157977]
curr_Stock_Price:  94.08780655273591
curr_Factors:  [94.08780655 -0.38001658 -1.0222795 ]
mat_Sqrt:  [[23.14855548  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00090536  0.05242847  0.88816523]
Stock Position:  -0.0009053560380555143
Bond Position:  [-2.22639681]


portfolio before change:  [-2.31310907]
curr_Stock_Price:  95.4695660598036
curr_Factors:  [95.46956606 -0.81023712 -1.02686124]
mat_Sqrt:  [[15.20628998  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00190429 -0.19170185 -0.00520022]
Stock Position:  -0.001904286207609566
Bond Position:  [-2.13130769]


portfolio before change:  [-2.31333932]
curr_Stock_Price:  95.45056762680035
curr_Factors:  [95.45056763 -1.02377749 -1.0485651 ]
mat_Sqrt:  [[12.01632213  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00600852 -0.02969745 -0.06185438]
Stock Position:  -0.006008522956853195
Bond Position:  [-1.7398224]


portfolio before change:  [-2.30638382]
curr_Stock_Price:  94.25676449163467
curr_Factors:  [94.25676449 -1.20972856 -1.04629162]
mat_Sqrt:  [[ 9.8749616   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0084805  0.0137249 -0.5625061]
Stock Position:  0.00848049556250494
Bond Position:  [-3.1057279]


portfolio before change:  [-2.30521756]
curr_Stock_Price:  94.44006774773236
curr_Factors:  [94.44006775 -1.04641417 -1.06466864]
mat_Sqrt:  [[11.4373305   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0161716   0.0096152  -0.67577242]
Stock Position:  -0.016171596706723357
Bond Position:  [-0.77797087]


portfolio before change:  [-2.30951588]
curr_Stock_Price:  94.6998483035483
curr_Factors:  [94.6998483  -1.0049884  -1.07249817]
mat_Sqrt:  [[11.86064565  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00339583 -0.00975924  0.43465054]
Stock Position:  -0.003395825213499074
Bond Position:  [-1.98793175]


portfolio before change:  [-2.31080028]
curr_Stock_Price:  95.0048975306657
curr_Factors:  [95.00489753 -0.99309099 -1.07816658]
mat_Sqrt:  [[11.97320065  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01854307 -0.0523872   0.24849078]
Stock Position:  0.01854307169097705
Bond Position:  [-4.07248291]


portfolio before change:  [-2.31553221]
curr_Stock_Price:  94.77716614606776
curr_Factors:  [94.77716615 -0.92302959 -1.0931342 ]
mat_Sqrt:  [[12.62103313  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01507327 0.06691417 1.01279516]
Stock Position:  0.015073271917333934
Bond Position:  [-3.74413421]


portfolio before change:  [-2.33053036]
curr_Stock_Price:  93.81320168713651
curr_Factors:  [93.81320169 -0.95823116 -1.07969589]
mat_Sqrt:  [[12.22372257  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00184893 -0.01822888  0.45930214]
Stock Position:  -0.0018489286068391689
Bond Position:  [-2.15707644]


portfolio before change:  [-2.32885725]
curr_Stock_Price:  92.76245521799093
curr_Factors:  [92.76245522 -1.08025951 -1.10631847]
mat_Sqrt:  [[10.41725958  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01686637 -0.04099891 -0.16365204]
Stock Position:  -0.016866366081251395
Bond Position:  [-0.76429172]


portfolio before change:  [-2.34080931]
curr_Stock_Price:  93.46542297062773
curr_Factors:  [93.46542297 -1.03981067 -1.079775  ]
mat_Sqrt:  [[11.22345613  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.07303553  0.05826694  0.11274018]
Stock Position:  -0.073035530622378
Bond Position:  [4.48548746]


portfolio before change:  [-2.32013678]
curr_Stock_Price:  93.19005287156139
curr_Factors:  [93.19005287 -0.94748729 -1.07889741]
mat_Sqrt:  [[12.28349249  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01362967 -0.10079741  0.42534135]
Stock Position:  -0.013629670230402473
Bond Position:  [-1.04998709]


portfolio before change:  [-2.30868764]
curr_Stock_Price:  92.34040641009734
curr_Factors:  [92.34040641 -0.76169422 -1.08243305]
mat_Sqrt:  [[14.60486283  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00066686  0.02455719  0.13074461]
Stock Position:  -0.0006668578093680235
Bond Position:  [-2.24710972]


portfolio before change:  [-2.31010539]
curr_Stock_Price:  94.04518962568831
curr_Factors:  [94.04518963 -0.72305931 -1.09125565]
mat_Sqrt:  [[15.32461637  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00066714 -0.00649847 -0.0363521 ]
Stock Position:  0.0006671408427473559
Bond Position:  [-2.37284678]


portfolio before change:  [-2.30987975]
curr_Stock_Price:  94.82803911099454
curr_Factors:  [94.82803911 -0.83136405 -1.10882654]
mat_Sqrt:  [[13.62456677  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01038705 -0.04648057 -0.3426165 ]
Stock Position:  -0.01038704880002538
Bond Position:  [-1.32489628]


portfolio before change:  [-2.31228012]
curr_Stock_Price:  95.04318711629992
curr_Factors:  [95.04318712 -0.8990624  -1.08024371]
mat_Sqrt:  [[13.13164906  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01085848 0.05592336 0.14815161]
Stock Position:  0.01085847664665515
Bond Position:  [-3.34430435]


portfolio before change:  [-2.31627416]
curr_Stock_Price:  94.71386137843864
curr_Factors:  [94.71386138 -1.20484436 -1.06370407]
mat_Sqrt:  [[ 9.7993095   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01069287 -0.03259927  0.23436389]
Stock Position:  0.010692867110018229
Bond Position:  [-3.3290369]


portfolio before change:  [-2.31827764]
curr_Stock_Price:  94.56541420170774
curr_Factors:  [94.5654142  -1.32970627 -1.06555806]
mat_Sqrt:  [[ 8.61950344  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01176829  0.00067158 -0.02630375]
Stock Position:  0.011768293290620842
Bond Position:  [-3.43115117]


portfolio before change:  [-2.31984848]
curr_Stock_Price:  94.46838114298056
curr_Factors:  [94.46838114 -1.48977459 -1.05384447]
mat_Sqrt:  [[ 7.4234665   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.05009875 -0.19392995 -1.83653697]
Stock Position:  0.050098753909246146
Bond Position:  [-7.05259666]


portfolio before change:  [-2.30089427]
curr_Stock_Price:  94.86431583404766
curr_Factors:  [94.86431583 -1.57565564 -1.04754245]
mat_Sqrt:  [[ 6.88434184  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0069602  -0.02588964  0.00740328]
Stock Position:  -0.006960200870699385
Bond Position:  [-1.64061958]


portfolio before change:  [-2.29882978]
curr_Stock_Price:  94.53823512356955
curr_Factors:  [94.53823512 -1.50218396 -1.03797487]
mat_Sqrt:  [[ 7.4547061   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00934706 -0.06274386  0.02962683]
Stock Position:  -0.009347057755591298
Bond Position:  [-1.41517543]


portfolio before change:  [-2.29787095]
curr_Stock_Price:  94.41672844163061
curr_Factors:  [94.41672844 -1.33088636 -1.04447965]
mat_Sqrt:  [[ 8.77891003  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0210775  -0.0083149  -0.05153483]
Stock Position:  0.021077501104157514
Bond Position:  [-4.28793965]


portfolio before change:  [-2.29034158]
curr_Stock_Price:  94.79938291852429
curr_Factors:  [94.79938292 -1.56185667 -1.02907205]
mat_Sqrt:  [[ 7.10525169  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-1.92706726e-05 -4.64940430e-03 -2.49361404e-01]
Stock Position:  -1.9270672564515176e-05
Bond Position:  [-2.28851473]


portfolio before change:  [-2.29063228]
curr_Stock_Price:  95.0389387823391
curr_Factors:  [95.03893878 -1.51320778 -1.0161891 ]
mat_Sqrt:  [[ 7.57527615  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00342837  0.00960185 -0.17402779]
Stock Position:  -0.0034283708285000455
Bond Position:  [-1.96480355]


portfolio before change:  [-2.29070643]
curr_Stock_Price:  94.9889269875793
curr_Factors:  [94.98892699 -1.39431241 -1.00699938]
mat_Sqrt:  [[ 8.6059045   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01109401 -0.06000085 -0.0594661 ]
Stock Position:  0.01109401014497721
Bond Position:  [-3.34451455]


portfolio before change:  [-2.28788425]
curr_Stock_Price:  95.28100126804013
curr_Factors:  [95.28100127 -1.42947551 -1.00799115]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-2.28788425]
Stock Price:  96.01516787198565
PL:  [-2.28788425]
Settle:  Tensor("sub_42:0", shape=(), dtype=float64)
PL:  Tensor("sub_43:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  22
output_Z_Vals[:, i, :]:  [[ 1.19260232e+02 -2.92559343e+01 -2.92733494e+01]
 [ 4.72961717e-02  1.52912202e-02 -8.87061451e-02]
 [-3.14712296e-02  4.91267903e-02  1.12757572e-01]
 [ 8.44569696e-02  1.65672885e-01  3.78945571e-02]
 [ 1.26903399e-01  1.10445278e-03 -6.62876679e-02]
 [-5.08473249e-02  2.48203455e-02  1.97992766e-01]
 [-6.37481224e-02  1.01923975e-02 -7.80657302e-02]
 [ 1.34439074e-01  2.59229603e-01  1.37898261e-01]
 [ 1.55107443e-02  3.66897814e-02 -3.87208166e-02]
 [-2.66808289e-02  3.67144962e-01  1.47918445e-01]
 [ 5.82457741e-02  5.41178326e-02 -8.07239968e-02]
 [-6.62321526e-02  9.13324619e-02  1.72246594e-02]
 [-5.12076062e-02 -8.60153174e-02 -5.76471725e-02]
 [ 8.03719706e-02  7.65308763e-02  1.87809982e-01]
 [ 1.91543351e-01  2.35743037e-01  2.66268024e-02]
 [-7.18661038e-02 -7.67881478e-02 -1.11712606e-01]
 [-7.65144318e-02 -3.61190004e-02 -6.46926891e-02]
 [-4.45800753e-02 -4.80853629e-03  3.86591531e-02]
 [ 3.64996327e-02  6.88827925e-02  4.32012992e-02]
 [ 3.22560802e-01 -1.23437751e-01 -7.50585889e-02]
 [-4.42762338e-02  1.40409022e-03  1.37558046e-02]
 [ 6.34915134e-02 -4.92936962e-02  6.17095125e-02]
 [-5.89145877e-02  3.83779932e-02  2.55089708e-01]
 [-1.42187663e-02 -1.00145682e-02 -7.98200175e-02]
 [-1.09480864e-01  6.76827424e-02  7.85581757e-02]
 [ 1.56221429e-02 -8.82105982e-02  8.33151964e-02]
 [-1.49289150e-01  6.52256928e-02  4.45104041e-02]
 [-5.07806065e-02  7.36225950e-02  2.93687317e-02]
 [ 5.94946471e-02 -9.42476032e-02 -1.38972288e-01]
 [ 1.16171248e-02 -2.79302488e-03 -1.02053887e-01]
 [ 2.96066527e-02  1.18896537e-01  3.11011065e-02]
 [ 1.52537671e-02 -7.29351550e-02 -8.90050279e-02]
 [ 7.53258167e-02 -3.71663219e-02  6.65806730e-02]
 [-5.11780001e-02 -8.66009346e-02 -1.07354637e-02]
 [-1.59217127e-01  1.28672356e-01  3.25835662e-02]
 [ 8.79586780e-02 -1.63641453e-01 -1.37069311e-01]
 [-1.36947986e-01 -2.07843085e-01  1.60249690e-03]
 [-3.91161423e-02 -1.63513693e-02  5.35720276e-03]
 [-4.23761972e-02  9.06033237e-02 -2.18834239e-02]
 [ 7.26092552e-02 -2.40036190e-03 -6.14949569e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.26023247 -29.25593426 -29.27334937]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  8.31486419  -9.25153874 -83.50871763]
init_Out:  [2.49911038]
Stock Position:  8.31486419409362
Bond position:  [-828.98730903]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-5.48174803]
curr_Stock_Price:  99.05263293099632
curr_Factors:  [99.05263293 -0.81864059 -1.01048135]
mat_Sqrt:  [[15.90334419  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00186023  0.00483551 -0.25305394]
Stock Position:  0.0018602328513201117
Bond Position:  [-5.66600899]


portfolio before change:  [-5.48163156]
curr_Stock_Price:  99.4960017682154
curr_Factors:  [99.49600177 -0.78813384 -1.01976915]
mat_Sqrt:  [[16.31711346  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00044041  0.01553526  0.32166597]
Stock Position:  -0.00044041113338245974
Bond Position:  [-5.43781241]


portfolio before change:  [-5.48243821]
curr_Stock_Price:  99.78410988569561
curr_Factors:  [99.78410989 -1.01704913 -1.03984946]
mat_Sqrt:  [[12.7573856   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00756188 0.05239037 0.10810262]
Stock Position:  0.007561880015542173
Bond Position:  [-6.23699368]


portfolio before change:  [-5.48123388]
curr_Stock_Price:  100.046479720039
curr_Factors:  [100.04647972  -0.45388921  -1.05441621]
mat_Sqrt:  [[22.13874967  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00512229  0.00034926 -0.18910027]
Stock Position:  0.0051222857438084765
Bond Position:  [-5.99370053]


portfolio before change:  [-5.47019306]
curr_Stock_Price:  102.3482012953353
curr_Factors:  [102.3482013   -0.34663298  -1.06220807]
mat_Sqrt:  [[25.01660213  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-3.91394569e-04  7.84888240e-03  5.64818251e-01]
Stock Position:  -0.000391394568987416
Bond Position:  [-5.43013453]


portfolio before change:  [-5.47108667]
curr_Stock_Price:  102.89701694642712
curr_Factors:  [102.89701695  -0.43842159  -1.05794516]
mat_Sqrt:  [[23.04299697  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0034466   0.00322312 -0.2226998 ]
Stock Position:  -0.0034466027307524824
Bond Position:  [-5.11644153]


portfolio before change:  [-5.46861807]
curr_Stock_Price:  101.99520116732505
curr_Factors:  [101.99520117  -0.52930062  -1.07739025]
mat_Sqrt:  [[20.45515429  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.0082757  0.0819756  0.39338535]
Stock Position:  0.008275699915568585
Bond Position:  [-6.31269974]


portfolio before change:  [-5.47012007]
curr_Stock_Price:  101.90906144571015
curr_Factors:  [101.90906145  -0.74061893  -1.08436092]
mat_Sqrt:  [[16.42986985  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00052065  0.01160233 -0.11045971]
Stock Position:  0.0005206503077918287
Bond Position:  [-5.52317905]


portfolio before change:  [-5.47082087]
curr_Stock_Price:  101.88916285645283
curr_Factors:  [101.88916286  -0.67557889  -1.08519141]
mat_Sqrt:  [[17.51600933  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00074175 0.11610143 0.42197015]
Stock Position:  0.0007417522556390677
Bond Position:  [-5.54639739]


portfolio before change:  [-5.47199724]
curr_Stock_Price:  101.23796902226545
curr_Factors:  [101.23796902  -0.77765551  -1.0638237 ]
mat_Sqrt:  [[16.05458798  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00268866  0.01711356 -0.23028309]
Stock Position:  0.0026886628156874187
Bond Position:  [-5.744192]


portfolio before change:  [-5.469775]
curr_Stock_Price:  102.33156304382253
curr_Factors:  [102.33156304  -0.70544141  -1.05790575]
mat_Sqrt:  [[17.5467894   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00343983  0.02888186  0.04913716]
Stock Position:  -0.003439830974803801
Bond Position:  [-5.11777172]


portfolio before change:  [-5.46892248]
curr_Stock_Price:  101.89773997290433
curr_Factors:  [101.89773997  -0.58128206  -1.06520265]
mat_Sqrt:  [[19.63836487  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00331981 -0.02720043 -0.16445134]
Stock Position:  -0.003319812640675845
Bond Position:  [-5.13064108]


portfolio before change:  [-5.46863598]
curr_Stock_Price:  101.61824369096584
curr_Factors:  [101.61824369  -0.88308391  -1.06592846]
mat_Sqrt:  [[14.47192712  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00833922 0.02420119 0.5357696 ]
Stock Position:  0.008339217043777877
Bond Position:  [-6.31605257]


portfolio before change:  [-5.46790363]
curr_Stock_Price:  101.80074375236786
curr_Factors:  [101.80074375  -1.0146247   -1.06030702]
mat_Sqrt:  [[12.78261049  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01588607 0.07454849 0.07595886]
Stock Position:  0.015886065182814692
Bond Position:  [-7.08511688]


portfolio before change:  [-5.47100249]
curr_Stock_Price:  101.66142882640708
curr_Factors:  [101.66142883  -1.09173711  -1.02256583]
mat_Sqrt:  [[12.27230416  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00787562 -0.02428254 -0.31868497]
Stock Position:  -0.007875620105832292
Bond Position:  [-4.6703557]


portfolio before change:  [-5.47165544]
curr_Stock_Price:  101.67020564988324
curr_Factors:  [101.67020565  -0.86027321  -1.02598981]
mat_Sqrt:  [[15.41700741  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00588002 -0.01142183 -0.18455023]
Stock Position:  -0.005880023133485751
Bond Position:  [-4.87383228]


portfolio before change:  [-5.47160506]
curr_Stock_Price:  101.55802136865836
curr_Factors:  [101.55802137  -1.00058066  -1.05030984]
mat_Sqrt:  [[13.06242483  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00281823 -0.00152059  0.1102838 ]
Stock Position:  -0.0028182336000488156
Bond Position:  [-5.18539084]


portfolio before change:  [-5.47240751]
curr_Stock_Price:  101.61274928047105
curr_Factors:  [101.61274928  -1.02555069  -1.0211304 ]
mat_Sqrt:  [[13.12459472  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00358842 0.02178265 0.12324128]
Stock Position:  0.0035884237236125304
Bond Position:  [-5.83703711]


portfolio before change:  [-5.46918332]
curr_Stock_Price:  102.71458996906148
curr_Factors:  [102.71458997  -0.80498809  -1.02761645]
mat_Sqrt:  [[16.43395519  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01850147 -0.03903444 -0.21412126]
Stock Position:  0.018501473283246774
Bond Position:  [-7.36955456]


portfolio before change:  [-5.49309666]
curr_Stock_Price:  101.47187303130183
curr_Factors:  [101.47187303  -0.77600654  -1.00632832]
mat_Sqrt:  [[17.07212114  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00242689  0.00044401  0.03924148]
Stock Position:  -0.002426885806821433
Bond Position:  [-5.24683602]


portfolio before change:  [-5.49333177]
curr_Stock_Price:  101.29848674609602
curr_Factors:  [101.29848675  -0.75141109  -1.02904311]
mat_Sqrt:  [[17.07503199  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00438155 -0.01558804  0.17604006]
Stock Position:  0.004381552969539472
Bond Position:  [-5.93717646]


portfolio before change:  [-5.496994]
curr_Stock_Price:  100.63204898148963
curr_Factors:  [100.63204898  -0.84051295  -1.03590932]
mat_Sqrt:  [[15.41049106  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-3.79851847e-04  1.21361870e-02  7.27699934e-01]
Stock Position:  -0.0003798518469720813
Bond Position:  [-5.45876873]


portfolio before change:  [-5.49750527]
curr_Stock_Price:  100.18156138437553
curr_Factors:  [100.18156138  -0.71361347  -1.03874513]
mat_Sqrt:  [[17.36793268  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00177169 -0.00316688 -0.22770429]
Stock Position:  -0.0017716866303859086
Bond Position:  [-5.32001493]


portfolio before change:  [-5.49807428]
curr_Stock_Price:  100.1273614043649
curr_Factors:  [100.1273614   -0.73942801  -1.05861936]
mat_Sqrt:  [[16.58329099  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00552952  0.02140316  0.22410461]
Stock Position:  -0.00552952262274427
Bond Position:  [-4.94441777]


portfolio before change:  [-5.4990952]
curr_Stock_Price:  100.20021130224421
curr_Factors:  [100.2002113   -0.60499505  -1.06422882]
mat_Sqrt:  [[18.87704118  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00160784 -0.02789464  0.23767506]
Stock Position:  0.0016078366318005482
Bond Position:  [-5.66020077]


portfolio before change:  [-5.49757704]
curr_Stock_Price:  101.58451181059692
curr_Factors:  [101.58451181  -0.83110947  -1.07791376]
mat_Sqrt:  [[15.05737429  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00919944  0.02062618  0.12697579]
Stock Position:  -0.00919943805987594
Bond Position:  [-4.56305662]


portfolio before change:  [-5.49593269]
curr_Stock_Price:  101.34376173663692
curr_Factors:  [101.34376174  -0.7676955   -1.08240702]
mat_Sqrt:  [[15.93337232  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00269151  0.02328151  0.08378082]
Stock Position:  -0.0026915088130008247
Bond Position:  [-5.22316507]


portfolio before change:  [-5.49688789]
curr_Stock_Price:  101.45606470158313
curr_Factors:  [101.4560647   -0.86217405  -1.06824359]
mat_Sqrt:  [[14.72001609  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00194929 -0.02980371 -0.39644926]
Stock Position:  0.001949290322530765
Bond Position:  [-5.69465522]


portfolio before change:  [-5.49831158]
curr_Stock_Price:  101.09090105790183
curr_Factors:  [101.09090106  -0.99743898  -1.10118287]
mat_Sqrt:  [[12.39630289  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00074915 -0.00088323 -0.29113133]
Stock Position:  -0.0007491470068610257
Bond Position:  [-5.42257963]


portfolio before change:  [-5.49887062]
curr_Stock_Price:  100.93228888446414
curr_Factors:  [100.93228888  -1.05365348  -1.07428473]
mat_Sqrt:  [[12.0192758   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00324687 0.03759839 0.0887228 ]
Stock Position:  0.0032468707357283205
Bond Position:  [-5.82658472]


portfolio before change:  [-5.49740809]
curr_Stock_Price:  101.60706101857406
curr_Factors:  [101.60706102  -1.05104447  -1.07460243]
mat_Sqrt:  [[12.1273852   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00039559 -0.02306412 -0.25390657]
Stock Position:  -0.00039559110724962047
Bond Position:  [-5.45721324]


portfolio before change:  [-5.49834279]
curr_Stock_Price:  102.24534512679362
curr_Factors:  [102.24534513  -0.49828372  -1.05715331]
mat_Sqrt:  [[21.58369649  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00407516 -0.01175302  0.18993613]
Stock Position:  0.004075155033156407
Bond Position:  [-5.91500842]


portfolio before change:  [-5.49769533]
curr_Stock_Price:  102.58567015429449
curr_Factors:  [102.58567015  -0.40419906  -1.03766353]
mat_Sqrt:  [[24.26016402  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00229205 -0.02738562 -0.03062529]
Stock Position:  -0.0022920452604140084
Bond Position:  [-5.26256433]


portfolio before change:  [-5.49772386]
curr_Stock_Price:  102.31109908078004
curr_Factors:  [102.31109908  -0.79771     -1.02969302]
mat_Sqrt:  [[16.45476564  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00906994  0.04068977  0.09295184]
Stock Position:  -0.009069939492548843
Bond Position:  [-4.56976839]


portfolio before change:  [-5.50258975]
curr_Stock_Price:  102.78460019711247
curr_Factors:  [102.7846002   -0.61863716  -1.03909643]
mat_Sqrt:  [[19.58770257  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00284639 -0.05174797 -0.39102059]
Stock Position:  0.002846393941850944
Bond Position:  [-5.79515521]


portfolio before change:  [-5.50523264]
curr_Stock_Price:  102.11060694199325
curr_Factors:  [102.11060694  -0.45543229  -1.06829882]
mat_Sqrt:  [[22.2496327   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00638156 -0.06572575  0.00457148]
Stock Position:  -0.006381559866258743
Bond Position:  [-4.85360769]


portfolio before change:  [-5.50429451]
curr_Stock_Price:  101.86852451021502
curr_Factors:  [101.86852451  -0.53758306  -1.06173691]
mat_Sqrt:  [[20.58089112  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00186799 -0.00517076  0.01528261]
Stock Position:  -0.0018679851227173844
Bond Position:  [-5.31400562]


portfolio before change:  [-5.50655874]
curr_Stock_Price:  102.72502854813747
curr_Factors:  [102.72502855  -0.73822112  -1.04694863]
mat_Sqrt:  [[17.23403227  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00258232  0.02865129 -0.06242732]
Stock Position:  -0.0025823187456848777
Bond Position:  [-5.24128997]


portfolio before change:  [-5.51142486]
curr_Stock_Price:  104.35570191919764
curr_Factors:  [104.35570192  -1.04062613  -1.03066647]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-5.51142486]
Stock Price:  103.88861634135091
PL:  [-9.4000412]
Settle:  Tensor("sub_44:0", shape=(), dtype=float64)
PL:  Tensor("sub_45:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  23
output_Z_Vals[:, i, :]:  [[ 1.19260232e+02 -2.92559343e+01 -2.92733494e+01]
 [ 4.30262101e-02  5.35180484e-02 -6.87748081e-02]
 [-3.86517468e-02 -1.58938148e-04  3.15821123e-02]
 [ 8.40407943e-02  1.61888590e-01  3.78439993e-02]
 [ 2.23348097e-01 -2.38708167e-02 -4.64651297e-02]
 [ 7.76847830e-02  3.03349788e-02 -3.78558864e-02]
 [ 7.19369446e-02  1.41330220e-02 -6.83534212e-02]
 [-1.37403512e-01  2.34046508e-02 -9.66870987e-02]
 [-1.40047061e-01 -6.11144643e-02  1.20806110e-01]
 [-3.27856966e-02  6.35359091e-02 -3.13504470e-02]
 [ 5.59457828e-02  7.71845538e-02 -7.90237600e-02]
 [-5.21340290e-02  4.04621068e-02  3.55163243e-03]
 [-9.29520350e-02  1.05184935e-03 -5.42100875e-02]
 [-9.13685182e-02 -1.12976458e-01  6.73612254e-02]
 [ 2.43305527e-01  2.97709972e-01  2.99867857e-02]
 [-6.99900314e-02 -3.32588330e-01 -7.25742310e-02]
 [-6.63393563e-02 -3.17089122e-02 -3.39333240e-02]
 [ 1.24440725e-01  4.26115945e-02 -1.99080088e-01]
 [-1.57021214e-01  1.89645963e-02 -2.90022041e-01]
 [-6.87574070e-02 -2.98023856e-02  1.49745464e-01]
 [ 3.73132583e-01 -2.67143505e-01  1.60832177e-01]
 [ 9.63166805e-02  5.09144199e-01  5.24698805e-01]
 [-2.30514020e-01  1.53288723e-01  1.93650179e-01]
 [-1.86715004e-01 -1.56988622e-01 -5.02345600e-02]
 [-1.19400853e+00  1.42226104e-01 -3.93812351e-02]
 [-3.23173335e-01 -4.69702592e-01  1.92012477e-01]
 [ 9.53522533e-02  7.27142311e-02  6.67838645e-02]
 [-1.88731481e-01 -5.51874500e-03 -7.48965023e-02]
 [-1.77297687e-01 -3.19219649e-01  6.32980918e-02]
 [ 3.17016305e-01  4.23277667e-01  5.05964957e-01]
 [ 1.08372674e-01 -1.62237289e-01  9.15029653e-02]
 [ 1.45451841e-01  3.05734159e-01  2.36061200e-01]
 [ 4.40439156e-01 -2.24146551e-01 -3.43316941e-02]
 [-3.39043537e-02 -6.97373555e-02  3.67842927e-02]
 [-1.33341638e-01 -2.21126817e-01  5.38559832e-03]
 [ 3.59297363e-01  2.49489202e-01  1.16968566e-01]
 [ 1.38148842e-02 -8.25665309e-02 -9.69237301e-02]
 [-4.11454244e-03  7.35518787e-02  7.28522671e-03]
 [ 3.96839163e-01 -4.85553783e-01 -1.19209768e-01]
 [-2.96954491e-01  1.88332593e-01  1.40650101e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.26023247 -29.25593426 -29.27334937]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  8.31486419  -9.25153874 -83.50871763]
init_Out:  [2.49911038]
Stock Position:  8.31486419409362
Bond position:  [-828.98730903]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-0.86152039]
curr_Stock_Price:  99.60829175247859
curr_Factors:  [99.60829175 -1.10527269 -0.98881875]
mat_Sqrt:  [[12.26995959  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00247511  0.01692389 -0.19619538]
Stock Position:  0.002475105240384544
Bond Position:  [-1.1080614]


portfolio before change:  [-0.86082746]
curr_Stock_Price:  99.94421432295313
curr_Factors:  [99.94421432 -1.11759308 -0.97734197]
mat_Sqrt:  [[12.30095771  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-2.61842855e-03 -5.02606554e-05  9.00949756e-02]
Stock Position:  -0.002618428550057901
Bond Position:  [-0.59913068]


portfolio before change:  [-0.86203162]
curr_Stock_Price:  100.37548751861756
curr_Factors:  [100.37548752  -0.97949754  -0.97713416]
mat_Sqrt:  [[14.18643654  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00676319 0.05119367 0.1079584 ]
Stock Position:  0.006763193377691897
Bond Position:  [-1.54089045]


portfolio before change:  [-0.85675784]
curr_Stock_Price:  101.18374461580085
curr_Factors:  [101.18374462  -1.0179541   -1.01222108]
mat_Sqrt:  [[13.28669211  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01604968 -0.00754862 -0.13255208]
Stock Position:  0.016049675743606856
Bond Position:  [-2.48072413]


portfolio before change:  [-0.87115095]
curr_Stock_Price:  100.30628132167509
curr_Factors:  [100.30628132  -1.15788892  -1.02655599]
mat_Sqrt:  [[11.28848754  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00626663  0.00959276 -0.10799231]
Stock Position:  0.0062666258972014464
Bond Position:  [-1.49973289]


portfolio before change:  [-0.87553436]
curr_Stock_Price:  99.63671380955815
curr_Factors:  [99.63671381 -0.89877483 -1.03355588]
mat_Sqrt:  [[14.42842195  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00404405  0.00446925 -0.19499328]
Stock Position:  0.0040440509807665405
Bond Position:  [-1.27847031]


portfolio before change:  [-0.8742725]
curr_Stock_Price:  99.98826324766218
curr_Factors:  [99.98826325 -1.21630161 -1.04821704]
mat_Sqrt:  [[10.38678329  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01507063  0.0074012  -0.27582138]
Stock Position:  -0.015070630933536841
Bond Position:  [0.63261372]


portfolio before change:  [-0.88493479]
curr_Stock_Price:  100.70099903368212
curr_Factors:  [100.70099903  -1.30320303  -1.03856896]
mat_Sqrt:  [[ 9.68311582  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01207933 -0.01932609  0.34462621]
Stock Position:  -0.012079333508771967
Bond Position:  [0.33146616]


portfolio before change:  [-0.8852074]
curr_Stock_Price:  100.72699774096306
curr_Factors:  [100.72699774  -1.49678158  -1.00869863]
mat_Sqrt:  [[ 8.22298806  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00456581  0.02009182 -0.0894341 ]
Stock Position:  -0.00456580860406771
Bond Position:  [-0.42530721]


portfolio before change:  [-0.88603333]
curr_Stock_Price:  100.89624673097313
curr_Factors:  [100.89624673  -1.2070451   -1.00930066]
mat_Sqrt:  [[10.99836882  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00380129  0.0244079  -0.22543279]
Stock Position:  0.0038012929593290983
Bond Position:  [-1.26956952]


portfolio before change:  [-0.88968011]
curr_Stock_Price:  99.97864371766704
curr_Factors:  [99.97864372 -0.9944282  -0.99571631]
mat_Sqrt:  [[13.66464849  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00368574  0.01279524  0.01013182]
Stock Position:  -0.0036857390086826427
Bond Position:  [-0.52118493]


portfolio before change:  [-0.89169619]
curr_Stock_Price:  100.50796149915622
curr_Factors:  [100.5079615   -0.88940203  -1.0052663 ]
mat_Sqrt:  [[15.1132012   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00688077  0.00033262 -0.15464629]
Stock Position:  -0.006880770176806501
Bond Position:  [-0.20012401]


portfolio before change:  [-0.88415743]
curr_Stock_Price:  99.40869746909813
curr_Factors:  [99.40869747 -0.69140079 -1.04565107]
mat_Sqrt:  [[17.49977015  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00460209 -0.03572629  0.19216283]
Stock Position:  -0.004602089318512758
Bond Position:  [-0.42666972]


portfolio before change:  [-0.88051189]
curr_Stock_Price:  98.60495951255054
curr_Factors:  [98.60495951 -0.75699831 -1.03081384]
mat_Sqrt:  [[16.49915914  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01558342 0.09414416 0.08554395]
Stock Position:  0.0155834239810873
Bond Position:  [-2.41711478]


portfolio before change:  [-0.88445767]
curr_Stock_Price:  98.37114573591863
curr_Factors:  [98.37114574 -0.62000391 -1.00181577]
mat_Sqrt:  [[19.43212923  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00480604 -0.10517366 -0.20703408]
Stock Position:  -0.0048060393615442275
Bond Position:  [-0.41168207]


portfolio before change:  [-0.8794724]
curr_Stock_Price:  97.32314650129996
curr_Factors:  [97.3231465 -0.5826023 -1.0017285]
mat_Sqrt:  [[19.95951661  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00371175 -0.01002724 -0.09680233]
Stock Position:  -0.003711747587129707
Bond Position:  [-0.51823345]


portfolio before change:  [-0.87186761]
curr_Stock_Price:  95.25684816893576
curr_Factors:  [95.25684817 -0.44173771 -0.98766088]
mat_Sqrt:  [[22.80952745  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0037223   0.01347497 -0.56792008]
Stock Position:  0.0037222997742062222
Bond Position:  [-1.22644215]


portfolio before change:  [-0.87913333]
curr_Stock_Price:  93.34609366140376
curr_Factors:  [93.34609366 -0.49089238 -0.99586088]
mat_Sqrt:  [[21.1060718   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01022133  0.00599713 -0.82735215]
Stock Position:  -0.010221326529044887
Bond Position:  [0.07498758]


portfolio before change:  [-0.8777245]
curr_Stock_Price:  93.20917910550413
curr_Factors:  [93.20917911 -0.31301327 -1.01242031]
mat_Sqrt:  [[24.76453587  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00157323 -0.00942434  0.42718213]
Stock Position:  -0.001573227000868108
Bond Position:  [-0.73108531]


portfolio before change:  [-0.87557268]
curr_Stock_Price:  91.7833073924573
curr_Factors:  [91.78330739 -0.45847823 -1.01655041]
mat_Sqrt:  [[20.99746689  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01900537 -0.08447819  0.45880943]
Stock Position:  0.019005373367939015
Bond Position:  [-2.6199487]


portfolio before change:  [-0.88944526]
curr_Stock_Price:  91.07061033000532
curr_Factors:  [91.07061033 -0.71252763 -1.00117576]
mat_Sqrt:  [[16.41067024  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01319668 0.16100553 1.49681964]
Stock Position:  0.013196683569124035
Bond Position:  [-2.09127529]


portfolio before change:  [-0.90192038]
curr_Stock_Price:  90.14509818234212
curr_Factors:  [90.14509818 -0.42921832 -1.01107579]
mat_Sqrt:  [[21.35159552  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00875941  0.04847415  0.55243006]
Stock Position:  -0.00875941309184385
Bond Position:  [-0.11230223]


portfolio before change:  [-0.89819178]
curr_Stock_Price:  89.7178280212772
curr_Factors:  [89.71782802 -0.36965881 -1.0214375 ]
mat_Sqrt:  [[22.32201011  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00900557 -0.04964416 -0.14330522]
Stock Position:  -0.009005574264617774
Bond Position:  [-0.09023122]


portfolio before change:  [-0.88194839]
curr_Stock_Price:  87.9128712079618
curr_Factors:  [87.91287121 -0.16332318 -1.04408955]
mat_Sqrt:  [[26.28329314  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.04559455  0.04497584 -0.1123437 ]
Stock Position:  -0.0455945501648455
Bond Position:  [3.12639943]


portfolio before change:  [-0.86726135]
curr_Stock_Price:  87.59932021193345
curr_Factors:  [87.59932021 -0.20925303 -1.01322928]
mat_Sqrt:  [[25.79784418  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01147796 -0.148533    0.54775815]
Stock Position:  -0.011477959905221418
Bond Position:  [0.13820014]


portfolio before change:  [-0.8683313]
curr_Stock_Price:  87.69404319994378
curr_Factors:  [87.6940432  -0.4148504  -1.03529662]
mat_Sqrt:  [[20.56739299  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00539018 0.02299426 0.19051578]
Stock Position:  0.0053901788137082395
Bond Position:  [-1.34101787]


portfolio before change:  [-0.8665452]
curr_Stock_Price:  88.05650579326016
curr_Factors:  [88.05650579 -0.42690038 -1.02961012]
mat_Sqrt:  [[20.52139956  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00994874 -0.00174518 -0.21365887]
Stock Position:  -0.009948744403244364
Bond Position:  [0.00950647]


portfolio before change:  [-0.87087663]
curr_Stock_Price:  88.4919999440031
curr_Factors:  [88.49199994 -0.23890251 -1.01267821]
mat_Sqrt:  [[25.31333735  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0068193  -0.10094612  0.18057184]
Stock Position:  -0.006819299695675551
Bond Position:  [-0.26742316]


portfolio before change:  [-0.86966469]
curr_Stock_Price:  88.30937586972306
curr_Factors:  [ 8.83093759e+01 -3.41236732e-02 -1.00494962e+00]
mat_Sqrt:  [[31.24230149  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.0138026  0.13385215 1.44337719]
Stock Position:  0.013802598754797182
Bond Position:  [-2.08856357]


portfolio before change:  [-0.85970092]
curr_Stock_Price:  89.05016798358683
curr_Factors:  [89.05016798 -0.13142151 -0.97726699]
mat_Sqrt:  [[29.38579485  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00418099 -0.05130394  0.26103249]
Stock Position:  0.0041809891788455
Bond Position:  [-1.23201871]


portfolio before change:  [-0.86114926]
curr_Stock_Price:  88.74059374164625
curr_Factors:  [ 8.87405937e+01  1.07804016e-02 -9.56021863e-01]
mat_Sqrt:  [[34.48332849  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00584432 0.09668163 0.6734169 ]
Stock Position:  0.005844321384418521
Bond Position:  [-1.37977781]


portfolio before change:  [-0.8532343]
curr_Stock_Price:  90.12440615457578
curr_Factors:  [90.12440615 -0.10588785 -0.98805853]
mat_Sqrt:  [[30.18196686  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01416885 -0.07088136 -0.09793877]
Stock Position:  0.014168850931036002
Bond Position:  [-2.13019358]


portfolio before change:  [-0.86051148]
curr_Stock_Price:  89.6295957788848
curr_Factors:  [89.62959578 -0.15761065 -0.95764214]
mat_Sqrt:  [[29.38348509  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0009596  -0.02205289  0.10493535]
Stock Position:  -0.0009596003357227032
Bond Position:  [-0.77450289]


portfolio before change:  [-0.86047671]
curr_Stock_Price:  89.4924610285044
curr_Factors:  [89.49246103 -0.44086949 -0.94073923]
mat_Sqrt:  [[22.47819377  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00613714 -0.06992644  0.01536361]
Stock Position:  -0.006137138002864829
Bond Position:  [-0.31124913]


portfolio before change:  [-0.8633366]
curr_Stock_Price:  89.95211931929126
curr_Factors:  [89.95211932 -0.75098357 -0.94344281]
mat_Sqrt:  [[16.52461592  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.02357787 0.07889541 0.33367876]
Stock Position:  0.023577870542619513
Bond Position:  [-2.98421603]


portfolio before change:  [-0.85424639]
curr_Stock_Price:  90.35348149291191
curr_Factors:  [90.35348149 -0.46506213 -0.97345646]
mat_Sqrt:  [[21.43898428  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00037788 -0.02610983 -0.27649642]
Stock Position:  -0.00037788394546893375
Bond Position:  [-0.82010326]


portfolio before change:  [-0.85445582]
curr_Stock_Price:  90.63639279569504
curr_Factors:  [90.6363928  -0.60562198 -0.97044961]
mat_Sqrt:  [[18.74232295  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-3.88612676e-05  2.32591463e-02  2.07827240e-02]
Stock Position:  -3.886126763940391e-05
Bond Position:  [-0.85093357]


portfolio before change:  [-0.85455543]
curr_Stock_Price:  90.46246691639897
curr_Factors:  [90.46246692 -0.36494205 -0.95416197]
mat_Sqrt:  [[24.18738     0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0148825  -0.15354559 -0.34007229]
Stock Position:  0.014882497680293387
Bond Position:  [-2.20086288]


portfolio before change:  [-0.86616878]
curr_Stock_Price:  89.70061756854925
curr_Factors:  [89.70061757 -0.60137034 -0.94576313]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-0.86616878]
Stock Price:  90.10102826996793
PL:  [-0.86616878]
Settle:  Tensor("sub_46:0", shape=(), dtype=float64)
PL:  Tensor("sub_47:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  24
output_Z_Vals[:, i, :]:  [[ 1.19260232e+02 -2.92559343e+01 -2.92733494e+01]
 [ 2.44244610e-02  3.16824311e-03 -4.43616101e-02]
 [-6.58776047e-02 -1.46283881e-02  9.66516151e-02]
 [-1.42015002e-02  1.35323943e-01  1.94061644e-02]
 [ 3.37860993e-02  3.18099315e-02 -7.07962128e-02]
 [ 6.99436314e-02  2.94749684e-02 -7.36729901e-02]
 [ 4.99786223e-02  3.27645352e-02 -5.34733843e-02]
 [-8.43966209e-02  2.64085005e-02 -8.80860492e-02]
 [ 3.58453302e-02 -5.01753982e-02 -3.15931626e-02]
 [-4.24165270e-02 -1.09782569e-01 -1.30806508e-01]
 [ 5.71797297e-02  1.46049121e-01 -8.38858618e-02]
 [-7.67793231e-02 -1.11229667e-01 -6.67267443e-04]
 [-1.10457497e-01  3.14834292e-02 -3.85379856e-02]
 [-6.00641820e-02 -9.20891864e-02  8.65387728e-02]
 [ 1.67878010e-01  1.39743288e-01 -5.18244399e-02]
 [-7.51074671e-02 -8.94893248e-02 -1.15065562e-01]
 [-8.33853869e-02 -3.84722539e-03 -8.56024421e-02]
 [ 1.55221106e-02 -1.16593523e-01 -5.27496291e-02]
 [ 2.38933157e-02  6.61482877e-02  2.60668092e-02]
 [ 3.13525912e-01 -2.05285792e-01 -6.53543349e-02]
 [ 1.17351380e-01  1.22719043e-02  1.69728177e-01]
 [ 1.46392745e-02 -1.55549236e-02  1.41227912e-02]
 [-9.53093365e-02  1.89170386e-01  1.79128696e-01]
 [ 1.33382442e-01 -6.07836279e-02  3.61073564e-02]
 [ 6.42780317e-02  3.25219204e-02  8.27288470e-02]
 [ 1.01515053e-01  4.35390725e-03  5.62300880e-02]
 [-1.35770570e-01  7.43080348e-02  8.45764244e-02]
 [-5.07806065e-02  7.36225950e-02  2.93687317e-02]
 [ 6.20848838e-02 -6.23725319e-02  9.08311027e-02]
 [ 1.55028013e-02 -2.13994321e-02 -1.69179631e-02]
 [-5.42686968e-02  3.83131758e-01  8.37630902e-03]
 [ 3.66993582e-02 -7.76774655e-02  1.12170053e-03]
 [ 6.63055557e-03 -8.07986525e-03  7.49469180e-02]
 [-9.42400819e-02 -7.38766365e-02  2.99945439e-03]
 [-1.69954906e-01  1.72088234e-01  3.31213461e-02]
 [ 9.96507147e-02 -1.58698369e-01 -1.31091943e-01]
 [-1.38506593e-01 -2.01281665e-01 -2.42283673e-03]
 [-4.14214261e-02 -2.02412081e-02  1.61781782e-02]
 [-3.69746184e-02  7.92755915e-02 -2.52726699e-02]
 [-1.65813813e-01  9.83881351e-02  9.89889369e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.26023247 -29.25593426 -29.27334937]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  8.31486419  -9.25153874 -83.50871763]
init_Out:  [2.49911038]
Stock Position:  8.31486419409362
Bond position:  [-828.98730903]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-0.74588226]
curr_Stock_Price:  99.62219915124754
curr_Factors:  [99.62219915 -1.01504126 -0.98351747]
mat_Sqrt:  [[13.50184427  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00114436  0.00100189 -0.12655133]
Stock Position:  0.0011443613659768632
Bond Position:  [-0.85988606]


portfolio before change:  [-0.74720781]
curr_Stock_Price:  98.55780221868731
curr_Factors:  [98.55780222 -0.95752684 -1.00355174]
mat_Sqrt:  [[13.86773093  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00335501 -0.0046259   0.27572016]
Stock Position:  -0.003355010271204225
Bond Position:  [-0.41654537]


portfolio before change:  [-0.74931488]
curr_Stock_Price:  99.17032046373643
curr_Factors:  [99.17032046 -0.98351958 -1.00972856]
mat_Sqrt:  [[13.51216841  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00049927  0.04279319  0.05536039]
Stock Position:  -0.0004992673373478721
Bond Position:  [-0.69980238]


portfolio before change:  [-0.74926569]
curr_Stock_Price:  98.89658039490558
curr_Factors:  [98.89658039 -0.82177899 -0.98042283]
mat_Sqrt:  [[16.31154018  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0012357   0.01005918 -0.20196189]
Stock Position:  0.001235702545517174
Bond Position:  [-0.87147245]


portfolio before change:  [-0.74877803]
curr_Stock_Price:  99.37938633317737
curr_Factors:  [99.37938633 -0.93706475 -0.99747422]
mat_Sqrt:  [[14.3594138   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00387664  0.0093208  -0.21016853]
Stock Position:  0.00387663705765624
Bond Position:  [-1.13403584]


portfolio before change:  [-0.75303211]
curr_Stock_Price:  98.31859043878835
curr_Factors:  [98.31859044 -0.6690403  -0.99175608]
mat_Sqrt:  [[18.67931469  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00213656  0.01036106 -0.15254468]
Stock Position:  0.0021365553711396846
Bond Position:  [-0.96309523]


portfolio before change:  [-0.75364604]
curr_Stock_Price:  98.08759565690892
curr_Factors:  [98.08759566 -0.68063339 -1.00888489]
mat_Sqrt:  [[18.10779708  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0056161   0.0083511  -0.25128498]
Stock Position:  -0.0056161025770195975
Bond Position:  [-0.20277604]


portfolio before change:  [-0.75455104]
curr_Stock_Price:  98.24422618236449
curr_Factors:  [98.24422618 -0.87212375 -0.98814493]
mat_Sqrt:  [[15.28982852  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00183788 -0.01586685 -0.0901265 ]
Stock Position:  0.0018378806295446556
Bond Position:  [-0.9351122]


portfolio before change:  [-0.75346847]
curr_Stock_Price:  98.89686523803017
curr_Factors:  [98.89686524 -0.98090202 -0.99577916]
mat_Sqrt:  [[13.70000725  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00525196 -0.0347163  -0.37315456]
Stock Position:  -0.005251958346415037
Bond Position:  [-0.23406625]


portfolio before change:  [-0.75838882]
curr_Stock_Price:  99.82815488007623
curr_Factors:  [99.82815488 -0.81907774 -0.98886757]
mat_Sqrt:  [[16.37089303  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00267716  0.04618479 -0.23930301]
Stock Position:  0.002677164397001615
Bond Position:  [-1.0256452]


portfolio before change:  [-0.76060563]
curr_Stock_Price:  99.04800149294468
curr_Factors:  [99.04800149 -0.72003192 -0.97880178]
mat_Sqrt:  [[18.11555379  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00440436 -0.03517391 -0.00190353]
Stock Position:  -0.004404362521848704
Bond Position:  [-0.32436233]


portfolio before change:  [-0.76290295]
curr_Stock_Price:  99.56039460245724
curr_Factors:  [99.5603946  -0.67824309 -0.99603017]
mat_Sqrt:  [[18.66203376  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0062968   0.00995593 -0.10993815]
Stock Position:  -0.006296801989528264
Bond Position:  [-0.13599086]


portfolio before change:  [-0.76653891]
curr_Stock_Price:  100.13512433980151
curr_Factors:  [100.13512434  -0.65978859  -0.98433698]
mat_Sqrt:  [[19.3442447   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00231476 -0.02912116  0.24687103]
Stock Position:  -0.002314758849822077
Bond Position:  [-0.53475024]


portfolio before change:  [-0.7676858]
curr_Stock_Price:  100.60171560554221
curr_Factors:  [100.60171561  -0.62058689  -1.02118621]
mat_Sqrt:  [[19.48015417  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00826008  0.04419071 -0.1478407 ]
Stock Position:  0.00826007562701029
Bond Position:  [-1.59866358]


portfolio before change:  [-0.76067035]
curr_Stock_Price:  101.47522998860227
curr_Factors:  [101.47522999  -0.77439737  -1.0140283 ]
mat_Sqrt:  [[16.96901535  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00594647 -0.02829901 -0.32825002]
Stock Position:  -0.005946469432949229
Bond Position:  [-0.157251]


portfolio before change:  [-0.77094031]
curr_Stock_Price:  103.19899237049785
curr_Factors:  [103.19899237  -0.92957862  -0.99938874]
mat_Sqrt:  [[14.99462388  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00673296 -0.0012166  -0.24419994]
Stock Position:  -0.006732962957921557
Bond Position:  [-0.07610532]


portfolio before change:  [-0.76809362]
curr_Stock_Price:  102.77478075223472
curr_Factors:  [102.77478075  -0.94179678  -1.01462638]
mat_Sqrt:  [[14.52856678  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 1.20053540e-04 -3.68701094e-02 -1.50480009e-01]
Stock Position:  0.00012005353951000786
Bond Position:  [-0.7804321]


portfolio before change:  [-0.76803517]
curr_Stock_Price:  104.07431524628484
curr_Factors:  [104.07431525  -1.45675154  -1.02964929]
mat_Sqrt:  [[ 8.65991049  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00357072 0.02091793 0.07436135]
Stock Position:  0.003570720778022025
Bond Position:  [-1.13965549]


portfolio before change:  [-0.76731048]
curr_Stock_Price:  104.31716669245834
curr_Factors:  [104.31716669  -0.84805843  -1.04623768]
mat_Sqrt:  [[15.69182425  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01879227 -0.06491707 -0.18643773]
Stock Position:  0.018792273812677427
Bond Position:  [-2.72766724]


portfolio before change:  [-0.78202488]
curr_Stock_Price:  103.5523088021947
curr_Factors:  [103.5523088   -0.77009783  -1.05367697]
mat_Sqrt:  [[16.71492581  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00911245 0.00388072 0.48418725]
Stock Position:  0.009112445993197821
Bond Position:  [-1.7256397]


portfolio before change:  [-0.77947182]
curr_Stock_Price:  103.8561548796939
curr_Factors:  [103.85615488  -1.1029075   -1.05476865]
mat_Sqrt:  [[12.00508933  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0014261  -0.0049189   0.04028839]
Stock Position:  0.0014260994026289693
Bond Position:  [-0.92758102]


portfolio before change:  [-0.77917214]
curr_Stock_Price:  104.14760375264038
curr_Factors:  [104.14760375  -1.22585569  -1.03954271]
mat_Sqrt:  [[10.809342    0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00498277  0.05982093  0.51100431]
Stock Position:  -0.004982771955350233
Bond Position:  [-0.26022838]


portfolio before change:  [-0.77952926]
curr_Stock_Price:  104.21274784486265
curr_Factors:  [104.21274784  -1.38724076  -1.03056193]
mat_Sqrt:  [[ 9.28715037  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01498666 -0.01922147  0.10300424]
Stock Position:  0.014986663587859897
Bond Position:  [-2.34133066]


portfolio before change:  [-0.78661754]
curr_Stock_Price:  103.75930514914006
curr_Factors:  [103.75930515  -1.40194601  -1.02667403]
mat_Sqrt:  [[ 9.14725472  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00896495 0.01028433 0.23600237]
Stock Position:  0.008964951966584684
Bond Position:  [-1.71681473]


portfolio before change:  [-0.78419259]
curr_Stock_Price:  104.05373727307095
curr_Factors:  [104.05373727  -1.2085324   -1.03486915]
mat_Sqrt:  [[11.03978896  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01024525 0.00137683 0.16040879]
Stock Position:  0.01024524919085051
Bond Position:  [-1.85024906]


portfolio before change:  [-0.7803396]
curr_Stock_Price:  104.4523883878893
curr_Factors:  [104.45238839  -1.16024624  -0.99901069]
mat_Sqrt:  [[12.0549387   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00967138  0.02349826  0.241273  ]
Stock Position:  -0.009671376807663258
Bond Position:  [0.2298588]


portfolio before change:  [-0.78265056]
curr_Stock_Price:  104.69430727237014
curr_Factors:  [104.69430727  -0.96769825  -1.02655188]
mat_Sqrt:  [[14.2505373   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00300935  0.02328151  0.08378082]
Stock Position:  -0.00300934702253796
Bond Position:  [-0.46758906]


portfolio before change:  [-0.78152929]
curr_Stock_Price:  104.30229029440326
curr_Factors:  [104.30229029  -0.99055914  -1.03042864]
mat_Sqrt:  [[13.82260841  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00571638 -0.01972393  0.25911585]
Stock Position:  0.005716377894322367
Bond Position:  [-1.3777606]


portfolio before change:  [-0.78119069]
curr_Stock_Price:  104.39165408802752
curr_Factors:  [104.39165409  -0.90468492  -1.03840035]
mat_Sqrt:  [[14.95528057  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00076875 -0.00676709 -0.04826224]
Stock Position:  0.0007687522499799613
Bond Position:  [-0.86144201]


portfolio before change:  [-0.78147045]
curr_Stock_Price:  104.16781446910156
curr_Factors:  [104.16781447  -0.77523777  -1.04166548]
mat_Sqrt:  [[16.93021586  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00252014  0.1211569   0.02389528]
Stock Position:  -0.0025201374165977597
Bond Position:  [-0.51895325]


portfolio before change:  [-0.78485186]
curr_Stock_Price:  105.48382729965869
curr_Factors:  [105.4838273   -0.85014222  -1.07349229]
mat_Sqrt:  [[15.40855893  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00226645 -0.02456377  0.0031999 ]
Stock Position:  0.0022664482117785217
Bond Position:  [-1.02392549]


portfolio before change:  [-0.78339676]
curr_Stock_Price:  106.18231969634442
curr_Factors:  [106.1823197   -0.7118769   -1.10468715]
mat_Sqrt:  [[17.2634848   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00125817 -0.00255508  0.2138027 ]
Stock Position:  0.001258170651654441
Bond Position:  [-0.91699224]


portfolio before change:  [-0.78499269]
curr_Stock_Price:  105.00497670641776
curr_Factors:  [105.00497671  -0.22068204  -1.09680397]
mat_Sqrt:  [[28.12114381  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00339728 -0.02336184  0.00855661]
Stock Position:  -0.0033972767262727965
Bond Position:  [-0.42826173]


portfolio before change:  [-0.78166668]
curr_Stock_Price:  104.01019630157214
curr_Factors:  [104.0101963   -0.32076505  -1.05797858]
mat_Sqrt:  [[26.19963049  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00605927  0.05441908  0.09448598]
Stock Position:  -0.006059274006597712
Bond Position:  [-0.1514404]


portfolio before change:  [-0.78106686]
curr_Stock_Price:  103.90807888759828
curr_Factors:  [103.90807889  -0.24885535  -1.01187143]
mat_Sqrt:  [[29.45253153  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00233576 -0.05018483 -0.37396883]
Stock Position:  0.0023357621911595187
Bond Position:  [-1.02377142]


portfolio before change:  [-0.784455]
curr_Stock_Price:  102.51231849656335
curr_Factors:  [102.5123185   -0.2393264   -1.02286484]
mat_Sqrt:  [[29.01438488  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00496989 -0.06365085 -0.00691168]
Stock Position:  -0.004969887297215197
Bond Position:  [-0.27498033]


portfolio before change:  [-0.7829808]
curr_Stock_Price:  102.20877562515001
curr_Factors:  [102.20877563  -0.37078236  -1.0079623 ]
mat_Sqrt:  [[25.74583541  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00150089 -0.00640083  0.04615184]
Stock Position:  -0.0015008910934369108
Bond Position:  [-0.62957656]


portfolio before change:  [-0.78527535]
curr_Stock_Price:  103.68513303832972
curr_Factors:  [103.68513304  -0.29491857  -0.99952599]
mat_Sqrt:  [[28.41491483  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00141076  0.02506914 -0.07209589]
Stock Position:  -0.0014107553649533675
Bond Position:  [-0.639001]


portfolio before change:  [-0.78455386]
curr_Stock_Price:  103.11708665151875
curr_Factors:  [103.11708665  -0.50143702  -0.98089917]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-0.78455386]
Stock Price:  103.39130317575564
PL:  [-4.17585704]
Settle:  Tensor("sub_48:0", shape=(), dtype=float64)
PL:  Tensor("sub_49:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  25
output_Z_Vals[:, i, :]:  [[ 1.19260232e+02 -2.92559343e+01 -2.92733494e+01]
 [ 1.35481131e-02 -4.06417280e-02 -3.42230560e-02]
 [-5.09441589e-02 -5.63656683e-02 -4.60079569e-02]
 [ 8.68839599e-02  1.87741579e-01  3.81893931e-02]
 [ 2.29629740e-01 -1.89244818e-02 -3.69926499e-02]
 [ 5.92899333e-03  2.89895205e-02  1.02954462e-01]
 [-1.45599034e-03  6.82768147e-02  1.83291024e-02]
 [ 1.55710982e-01  2.23416966e-01  1.42241334e-01]
 [ 3.19027402e-02  4.59565113e-02 -6.04133191e-03]
 [-3.34400329e-02  2.89018942e-01  1.12348759e-01]
 [ 4.03736469e-02 -4.24949534e-02 -5.41001538e-02]
 [-6.73296094e-02  9.58407268e-02  1.80048653e-02]
 [-4.73756812e-02 -9.16050930e-02 -5.54102939e-02]
 [ 4.68265967e-01  3.32037819e-01  4.15503824e-01]
 [ 8.42692676e-02 -4.03513826e-02 -1.48248605e-01]
 [-5.75372112e-02 -8.59782232e-02 -1.30791650e-01]
 [-8.68047030e-02  1.40732386e-02 -9.37549135e-02]
 [-3.60616066e-02 -1.19276094e-01 -2.10440802e-03]
 [ 2.64226889e-02  6.43268015e-02  2.70256045e-02]
 [ 3.16376038e-01 -2.18973860e-01 -6.11776814e-02]
 [ 2.21832497e-01  8.85465740e-03  3.16835772e-01]
 [-2.57638803e-02  1.23486665e-02 -2.52337195e-02]
 [-9.77018889e-02  1.74557590e-01  3.19517230e-01]
 [ 9.41069979e-02 -1.76710588e-02 -2.51872015e-02]
 [ 5.88891316e-02  3.31667997e-02  8.02197371e-02]
 [ 1.01546871e-01  4.28475812e-03  5.62318181e-02]
 [-1.46681890e-01  7.31043627e-02  8.34217615e-02]
 [-5.07806065e-02  7.36225950e-02  2.93687317e-02]
 [-5.73746539e-02 -5.09468823e-02 -2.32979691e-01]
 [ 4.06744602e-02  1.15017655e-02 -2.28775410e-02]
 [-1.28934937e-02  2.55189072e-01  1.81514550e-02]
 [ 1.89070683e-02 -1.07677457e-01 -7.09365031e-02]
 [-6.60716506e-02  2.27031835e-02  8.38011601e-02]
 [-5.08066393e-02 -8.62383897e-02 -9.71385116e-03]
 [-2.16346041e-01  1.95807002e-01  2.04748606e-02]
 [ 1.78076036e-01 -8.30519470e-02 -4.97895371e-02]
 [ 3.16967899e-02  6.84544702e-02 -1.05632343e-01]
 [-3.72194356e-02 -2.90573928e-02 -1.49094422e-03]
 [ 3.31271755e-03  8.07892327e-02 -3.09780463e-02]
 [-8.24390686e-01  4.10540694e-01  5.04275213e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.26023247 -29.25593426 -29.27334937]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  8.31486419  -9.25153874 -83.50871763]
init_Out:  [2.49911038]
Stock Position:  8.31486419409362
Bond position:  [-828.98730903]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-0.24524709]
curr_Stock_Price:  99.68240881351879
curr_Factors:  [99.68240881 -1.0103202  -0.98964206]
mat_Sqrt:  [[13.49105607  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00040864 -0.01285204 -0.09762885]
Stock Position:  0.0004086408107584474
Bond Position:  [-0.2859814]


portfolio before change:  [-0.24504404]
curr_Stock_Price:  100.26678589769047
curr_Factors:  [100.2667859   -1.09491964  -0.95841338]
mat_Sqrt:  [[12.86488466  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00480306 -0.01782439 -0.13124789]
Stock Position:  -0.004803062813678598
Bond Position:  [0.23654363]


portfolio before change:  [-0.25077766]
curr_Stock_Price:  101.46668449739477
curr_Factors:  [101.4666845   -1.33878652  -0.97941689]
mat_Sqrt:  [[ 9.98942571  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00996322 0.0593691  0.10894371]
Stock Position:  0.009963215780334418
Bond Position:  [-1.26171213]


portfolio before change:  [-0.24787192]
curr_Stock_Price:  101.77416258404794
curr_Factors:  [101.77416258  -0.62304811  -0.9707622 ]
mat_Sqrt:  [[20.67542836  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01071755 -0.00598445 -0.10552973]
Stock Position:  0.010717553932478082
Bond Position:  [-1.33864199]


portfolio before change:  [-0.25089456]
curr_Stock_Price:  101.50774870046058
curr_Factors:  [101.5077487   -0.47404594  -0.96459405]
mat_Sqrt:  [[24.08273386  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00114991 0.00916729 0.29370042]
Stock Position:  0.001149910605272673
Bond Position:  [-0.3676194]


portfolio before change:  [-0.25109843]
curr_Stock_Price:  101.37042592146808
curr_Factors:  [101.37042592  -0.49753404  -0.99759419]
mat_Sqrt:  [[22.72926191  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00017811 0.02159102 0.05228783]
Stock Position:  0.00017811056997843783
Bond Position:  [-0.26915357]


portfolio before change:  [-0.25098564]
curr_Stock_Price:  102.19254392940391
curr_Factors:  [102.19254393  -0.61765898  -1.00027735]
mat_Sqrt:  [[20.26554995  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.0094009  0.07065065 0.40577493]
Stock Position:  0.009400903219207762
Bond Position:  [-1.21168786]


portfolio before change:  [-0.24637854]
curr_Stock_Price:  102.69872716861873
curr_Factors:  [102.69872717  -0.71194107  -0.9890248 ]
mat_Sqrt:  [[18.74325317  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00169961  0.01453272 -0.01723424]
Stock Position:  0.0016996062628952795
Bond Position:  [-0.42092594]


portfolio before change:  [-0.24562231]
curr_Stock_Price:  103.17463108938882
curr_Factors:  [103.17463109  -1.00439948  -0.98252957]
mat_Sqrt:  [[14.14687778  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-2.15206605e-04  9.13958144e-02  3.20499737e-01]
Stock Position:  -0.00021520660511850458
Bond Position:  [-0.22341844]


portfolio before change:  [-0.2455438]
curr_Stock_Price:  102.68008025737117
curr_Factors:  [102.68008026  -0.91270053  -0.9867666 ]
mat_Sqrt:  [[15.36590362  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0018374  -0.01343808 -0.15433268]
Stock Position:  0.0018373982441582523
Bond Position:  [-0.434208]


portfolio before change:  [-0.24637066]
curr_Stock_Price:  102.25960685960537
curr_Factors:  [102.25960686  -1.00793007  -0.99225019]
mat_Sqrt:  [[13.83683846  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00442151  0.0303075   0.05136287]
Stock Position:  -0.004421514707684112
Bond Position:  [0.2057717]


portfolio before change:  [-0.24982685]
curr_Stock_Price:  103.04710054519819
curr_Factors:  [103.04710055  -0.8542085   -1.01765399]
mat_Sqrt:  [[15.85244398  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00385124 -0.02896807 -0.15807015]
Stock Position:  -0.003851235398088287
Bond Position:  [0.14703179]


portfolio before change:  [-0.25667857]
curr_Stock_Price:  104.83096919292792
curr_Factors:  [104.83096919  -0.6239298   -1.00881535]
mat_Sqrt:  [[20.48318049  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.02742023 0.10499958 1.18531676]
Stock Position:  0.02742022947530668
Bond Position:  [-3.1311678]


portfolio before change:  [-0.28236373]
curr_Stock_Price:  103.90852122237834
curr_Factors:  [103.90852122  -0.62615516  -1.0040829 ]
mat_Sqrt:  [[20.35390648  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00260227 -0.01276023 -0.422912  ]
Stock Position:  0.0026022660446702907
Bond Position:  [-0.55276134]


portfolio before change:  [-0.28040133]
curr_Stock_Price:  104.68918676490144
curr_Factors:  [104.68918676  -0.69293851  -1.02081173]
mat_Sqrt:  [[18.86381599  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00458311 -0.0271887  -0.37311217]
Stock Position:  -0.004583107317390322
Bond Position:  [0.19940045]


portfolio before change:  [-0.27773329]
curr_Stock_Price:  104.11247942167553
curr_Factors:  [104.11247942  -0.68838101  -1.0146022 ]
mat_Sqrt:  [[18.96297969  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00556764  0.00445035 -0.26745667]
Stock Position:  -0.00556763635439169
Bond Position:  [0.30192714]


portfolio before change:  [-0.26622503]
curr_Stock_Price:  102.05226760187621
curr_Factors:  [102.0522676   -0.69785729  -0.96794219]
mat_Sqrt:  [[19.29190604  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00205116 -0.03771841 -0.00600329]
Stock Position:  -0.0020511639691842103
Bond Position:  [-0.0568991]


portfolio before change:  [-0.26788035]
curr_Stock_Price:  102.85581321600904
curr_Factors:  [102.85581322  -0.78875608  -0.9760042 ]
mat_Sqrt:  [[17.61177746  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00190782 0.02034192 0.07709653]
Stock Position:  0.001907824366524783
Bond Position:  [-0.46411118]


portfolio before change:  [-0.26477849]
curr_Stock_Price:  104.5120839414518
curr_Factors:  [104.51208394  -0.6224341   -0.96691283]
mat_Sqrt:  [[21.32661393  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01398414 -0.06924561 -0.1745229 ]
Stock Position:  0.013984138153571423
Bond Position:  [-1.72628991]


portfolio before change:  [-0.25972741]
curr_Stock_Price:  104.88871685874471
curr_Factors:  [104.88871686  -0.57162372  -0.97265478]
mat_Sqrt:  [[22.39015719  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01280629 0.00280009 0.90384427]
Stock Position:  0.012806294822980539
Bond Position:  [-1.60296324]


portfolio before change:  [-0.27928998]
curr_Stock_Price:  103.37678901597586
curr_Factors:  [103.37678902  -0.4456072   -0.95323916]
mat_Sqrt:  [[25.52182846  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00119881  0.00390499 -0.07198478]
Stock Position:  -0.001198811071085381
Bond Position:  [-0.15536074]


portfolio before change:  [-0.27793266]
curr_Stock_Price:  102.2283664038811
curr_Factors:  [102.2283664   -0.61279862  -0.97181886]
mat_Sqrt:  [[20.95949385  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00133465  0.05519996  0.91149372]
Stock Position:  -0.0013346529291833739
Bond Position:  [-0.14149327]


portfolio before change:  [-0.27850548]
curr_Stock_Price:  102.64429995483917
curr_Factors:  [102.64429995  -0.6715759   -0.956389  ]
mat_Sqrt:  [[20.15202364  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00439209 -0.00558808 -0.07185208]
Stock Position:  0.004392085815847035
Bond Position:  [-0.72932805]


portfolio before change:  [-0.27499061]
curr_Stock_Price:  103.4653322651333
curr_Factors:  [103.46533227  -0.7221299   -0.93051671]
mat_Sqrt:  [[19.81798757  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00384097 0.01048826 0.22884458]
Stock Position:  0.003840969204638158
Bond Position:  [-0.67239776]


portfolio before change:  [-0.2710011]
curr_Stock_Price:  104.52588750903588
curr_Factors:  [104.52588751  -0.85453651  -0.92675861]
mat_Sqrt:  [[17.60423767  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00642662 0.00135496 0.16041373]
Stock Position:  0.006426621645171309
Bond Position:  [-0.94274943]


portfolio before change:  [-0.27426775]
curr_Stock_Price:  104.03592565320206
curr_Factors:  [104.03592565  -0.83997411  -0.90340938]
mat_Sqrt:  [[18.19874776  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00702059  0.02311763  0.23797907]
Stock Position:  -0.007020590068068059
Bond Position:  [0.45612584]


portfolio before change:  [-0.26613454]
curr_Stock_Price:  102.88556791954838
curr_Factors:  [102.88556792  -0.82511318  -0.90017349]
mat_Sqrt:  [[18.32618116  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00234008  0.02328151  0.08378082]
Stock Position:  -0.0023400844748452895
Bond Position:  [-0.02537362]


portfolio before change:  [-0.2626171]
curr_Stock_Price:  101.38108832778488
curr_Factors:  [101.38108833  -0.84613658  -0.8943724 ]
mat_Sqrt:  [[17.78539453  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00597383 -0.01611082 -0.66462621]
Stock Position:  -0.005973827395166748
Bond Position:  [0.34301602]


portfolio before change:  [-0.27366282]
curr_Stock_Price:  103.23728398091664
curr_Factors:  [103.23728398  -1.03800527  -0.89898326]
mat_Sqrt:  [[14.88034967  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00243956  0.00363718 -0.06526326]
Stock Position:  0.002439564714087228
Bond Position:  [-0.52551685]


portfolio before change:  [-0.27352349]
curr_Stock_Price:  103.32132353399054
curr_Factors:  [103.32132353  -1.08382949  -0.89921826]
mat_Sqrt:  [[14.22208495  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00018277  0.08069787  0.05178105]
Stock Position:  -0.0001827713690842727
Bond Position:  [-0.25463931]


portfolio before change:  [-0.27350018]
curr_Stock_Price:  103.01963978049015
curr_Factors:  [103.01963978  -0.70668251  -0.89902967]
mat_Sqrt:  [[20.68083595  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 7.96387196e-05 -3.40506017e-02 -2.02362098e-01]
Stock Position:  7.96387196137717e-05
Bond Position:  [-0.28170454]


portfolio before change:  [-0.27346412]
curr_Stock_Price:  103.91463744539237
curr_Factors:  [103.91463745  -0.21784993  -0.87406011]
mat_Sqrt:  [[34.87114608  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00138738  0.00717938  0.23906138]
Stock Position:  -0.001387382469858858
Bond Position:  [-0.12929478]


portfolio before change:  [-0.27113916]
curr_Stock_Price:  102.22719545107776
curr_Factors:  [102.22719545  -0.1351476   -0.86881508]
mat_Sqrt:  [[37.45855293  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00146872 -0.02727097 -0.02771091]
Stock Position:  -0.0014687202852333822
Bond Position:  [-0.120996]


portfolio before change:  [-0.26763281]
curr_Stock_Price:  99.82954656704048
curr_Factors:  [99.82954657 -0.17818711 -0.86401682]
mat_Sqrt:  [[35.20754016  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00588257  0.06191961  0.05840908]
Stock Position:  -0.005882572646673568
Bond Position:  [0.31962175]


portfolio before change:  [-0.25217316]
curr_Stock_Price:  97.20829761972674
curr_Factors:  [ 9.72082976e+01 -1.79432435e-02 -8.62928473e-01]
mat_Sqrt:  [[40.28520814  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00411487 -0.02626333 -0.14203569]
Stock Position:  0.00411487005922163
Bond Position:  [-0.65217268]


portfolio before change:  [-0.25409287]
curr_Stock_Price:  96.76158112513887
curr_Factors:  [ 9.67615811e+01  7.65191612e-02 -8.66512882e-01]
mat_Sqrt:  [[43.91501573  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 2.71027227e-04  2.16472042e-02 -3.01339674e-01]
Stock Position:  0.000271027226953395
Bond Position:  [-0.28031789]


portfolio before change:  [-0.25305442]
curr_Stock_Price:  100.72241775087535
curr_Factors:  [100.72241775   0.13524573  -0.88789296]
mat_Sqrt:  [[47.45211792  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00080658 -0.00918875 -0.00425325]
Stock Position:  -0.0008065821633914374
Bond Position:  [-0.17181351]


portfolio before change:  [-0.25399904]
curr_Stock_Price:  101.8669240661002
curr_Factors:  [101.86692407   0.34809865  -0.92612244]
mat_Sqrt:  [[57.14794899  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-1.61804694e-05  2.55477986e-02 -8.83717433e-02]
Stock Position:  -1.6180469427059057e-05
Bond Position:  [-0.25235078]


portfolio before change:  [-0.25395683]
curr_Stock_Price:  97.30888850589015
curr_Factors:  [97.30888851  0.52522598 -0.93950697]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-0.25395683]
Stock Price:  94.7330773446995
PL:  [-0.25395683]
Settle:  Tensor("sub_50:0", shape=(), dtype=float64)
PL:  Tensor("sub_51:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  26
output_Z_Vals[:, i, :]:  [[ 1.19260232e+02 -2.92559343e+01 -2.92733494e+01]
 [-1.86745956e-01  5.91067113e-01  1.08687108e-01]
 [ 1.64385048e-01  1.72523268e-02 -1.90171681e-01]
 [ 8.33474749e-02  1.55584216e-01  3.77597733e-02]
 [ 2.44741845e-01 -7.02480280e-03 -1.42041672e-02]
 [-7.09344284e-02  3.28226070e-02  1.93531866e-01]
 [-7.72673896e-02  2.11666035e-02 -2.63477132e-01]
 [ 5.51881138e-01 -2.33206735e-01  2.40594441e-01]
 [ 1.20871967e-01  9.36910114e-02  1.73154666e-01]
 [-7.85542550e-02 -1.36387978e-01 -7.52239311e-02]
 [-2.13742294e-03 -2.36625720e-01  1.62034413e-02]
 [-2.26475687e-01  1.81351934e-01  1.16217269e-01]
 [ 6.15004716e-02 -2.50426904e-01  8.14594515e-03]
 [ 7.34062657e-01  4.79752340e-01  5.18834661e-01]
 [-3.69245224e-02 -1.18907396e-01 -8.03011837e-02]
 [-3.75554890e-02 -6.64460018e-02 -1.40613341e-01]
 [-9.65896231e-02  6.02362217e-02 -1.16185177e-01]
 [ 1.91306264e-01 -2.32452257e-01 -2.32853165e-01]
 [ 4.79643452e-02  4.88139342e-02  3.51912795e-02]
 [ 5.91297757e-02 -2.16543187e-01  6.84251920e-03]
 [ 3.17316017e-01  1.77310295e-03  4.55070648e-01]
 [-9.78866811e-02  6.21587638e-02 -9.54881786e-02]
 [-2.46094240e-01  7.74755298e-01  3.80879483e-01]
 [ 3.74843597e-01 -4.75905928e-02  1.08800532e-01]
 [-2.21035019e-01 -9.29493340e-02 -2.24192061e-01]
 [ 1.10706276e-01 -1.56209715e-02  5.67298697e-02]
 [ 3.65461857e-03  1.50018402e-01  1.11089660e-01]
 [-5.07806065e-02  7.36225950e-02  2.93687317e-02]
 [ 3.45828287e-02  4.36479754e-02  1.13276765e-01]
 [-1.31378101e-01 -2.06174644e-01  3.94126749e-02]
 [-1.98107768e-01  8.52539223e-01 -3.90641258e-02]
 [ 4.22106669e-02  4.91045559e-02  1.51297751e-01]
 [-9.38080031e-02  2.71667960e-02  8.52739471e-02]
 [-7.46104866e-02 -7.71667919e-02  2.60254708e-03]
 [-2.21950229e-01  2.49545609e-01  2.35949796e-02]
 [ 9.21863570e-02 -1.61854102e-01 -1.34907977e-01]
 [-1.71736931e-01 -2.80165650e-01  2.69844133e-02]
 [-5.67409297e-02 -5.69531447e-02  8.94910839e-02]
 [-1.90665302e-02  4.17202702e-02 -3.65091842e-02]
 [ 2.33293463e-01 -1.48075395e-02 -2.32618750e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.26023247 -29.25593426 -29.27334937]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  8.31486419  -9.25153874 -83.50871763]
init_Out:  [2.49911038]
Stock Position:  8.31486419409362
Bond position:  [-828.98730903]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [15.03625891]
curr_Stock_Price:  101.52026276345096
curr_Factors:  [101.52026276  -1.14056976  -0.99433532]
mat_Sqrt:  [[12.00536137  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01243603  0.18691183  0.31005407]
Stock Position:  -0.012436027634735834
Bond Position:  [16.2987677]


portfolio before change:  [15.03266723]
curr_Stock_Price:  101.9729110394403
curr_Factors:  [101.97291104  -1.11548492  -1.00511814]
mat_Sqrt:  [[12.23259542  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01030132  0.00545566 -0.54250687]
Stock Position:  0.010301319130339954
Bond Position:  [13.98221174]


portfolio before change:  [15.03845804]
curr_Stock_Price:  102.36537687162135
curr_Factors:  [102.36537687  -1.07592064  -1.01950775]
mat_Sqrt:  [[12.59273605  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00754977 0.04920005 0.10771812]
Stock Position:  0.007549774979726443
Bond Position:  [14.26562247]


portfolio before change:  [15.04661286]
curr_Stock_Price:  103.20931078573946
curr_Factors:  [103.20931079  -1.00357684  -1.03542975]
mat_Sqrt:  [[13.43351196  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01798942 -0.00222144 -0.04052054]
Stock Position:  0.0179894172200793
Bond Position:  [13.18993751]


portfolio before change:  [15.06806313]
curr_Stock_Price:  104.31003695929932
curr_Factors:  [104.31003696  -1.0028416   -1.00692095]
mat_Sqrt:  [[13.97968279  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00218763  0.01037942  0.55209255]
Stock Position:  -0.0021876337259613314
Bond Position:  [15.29625528]


portfolio before change:  [15.06957304]
curr_Stock_Price:  104.49390611885583
curr_Factors:  [104.49390612  -0.8947056   -0.99130209]
mat_Sqrt:  [[15.8492324   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00823402  0.00669347 -0.75162692]
Stock Position:  -0.008234021136085274
Bond Position:  [15.92997807]


portfolio before change:  [15.06800653]
curr_Stock_Price:  104.92600153422258
curr_Factors:  [104.92600153  -0.99518411  -0.98914776]
mat_Sqrt:  [[14.42443277  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.04124744 -0.07374644  0.68634897]
Stock Position:  0.04124743829654913
Bond Position:  [10.74007776]


portfolio before change:  [15.14016498]
curr_Stock_Price:  106.6428561112096
curr_Factors:  [106.64285611  -0.94518186  -0.98141152]
mat_Sqrt:  [[15.5318395   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01021361 0.0296277  0.49396207]
Stock Position:  0.010213607155118995
Bond Position:  [14.05095674]


portfolio before change:  [15.14806539]
curr_Stock_Price:  107.24440042765914
curr_Factors:  [107.24440043  -1.08798975  -0.96370009]
mat_Sqrt:  [[13.78278722  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00706902 -0.04312967 -0.21459294]
Stock Position:  -0.0070690199649495
Bond Position:  [15.9061782]


portfolio before change:  [15.15084206]
curr_Stock_Price:  107.13288970056314
curr_Factors:  [107.1328897   -1.18895593  -0.94711356]
mat_Sqrt:  [[12.65434367  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00039034 -0.07482762  0.04622391]
Stock Position:  -0.0003903449502523794
Bond Position:  [15.19266085]


portfolio before change:  [15.1525496]
curr_Stock_Price:  107.62389505185496
curr_Factors:  [107.62389505  -1.07040577  -0.95766703]
mat_Sqrt:  [[14.16210715  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01398594  0.05734852  0.33153552]
Stock Position:  -0.013985944852751203
Bond Position:  [16.65777146]


portfolio before change:  [15.15204255]
curr_Stock_Price:  107.80903856566779
curr_Factors:  [107.80903857  -0.96446669  -0.93579101]
mat_Sqrt:  [[16.12069419  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00351705 -0.07919194  0.02323811]
Stock Position:  0.003517048343877993
Bond Position:  [14.77287295]


portfolio before change:  [15.15128079]
curr_Stock_Price:  107.06736975790888
curr_Factors:  [107.06736976  -1.00922264  -0.95906856]
mat_Sqrt:  [[14.95681523  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.05698783 0.15171101 1.48009087]
Stock Position:  0.05698783317179027
Bond Position:  [9.04974338]


portfolio before change:  [15.17678144]
curr_Stock_Price:  107.49499374368175
curr_Factors:  [107.49499374  -0.72881723  -0.95537472]
mat_Sqrt:  [[19.95046241  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00282631 -0.03760182 -0.22907693]
Stock Position:  -0.0028263058492191003
Bond Position:  [15.48059517]


portfolio before change:  [15.17786894]
curr_Stock_Price:  107.79492332000152
curr_Factors:  [107.79492332  -0.72962723  -0.92934166]
mat_Sqrt:  [[20.51716143  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00331302 -0.02101207 -0.40113072]
Stock Position:  -0.0033130165514134086
Bond Position:  [15.53499531]


portfolio before change:  [15.18446119]
curr_Stock_Price:  106.39129180015908
curr_Factors:  [106.3912918   -0.90086515  -0.90036305]
mat_Sqrt:  [[17.56477595  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00676072  0.01904837 -0.33144397]
Stock Position:  -0.006760719911020734
Bond Position:  [15.90374292]


portfolio before change:  [15.18447929]
curr_Stock_Price:  106.68268010716872
curr_Factors:  [106.68268011  -0.84942452  -0.89808998]
mat_Sqrt:  [[18.58480518  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00741323 -0.07350786 -0.66426527]
Stock Position:  0.007413229122862403
Bond Position:  [14.39361614]


portfolio before change:  [15.17906246]
curr_Stock_Price:  105.70926507886455
curr_Factors:  [105.70926508  -0.60322558  -0.88257741]
mat_Sqrt:  [[23.92417722  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00235779 0.01543632 0.10039093]
Stock Position:  0.00235778663812893
Bond Position:  [14.92982256]


portfolio before change:  [15.18513627]
curr_Stock_Price:  107.49376421285619
curr_Factors:  [107.49376421  -0.70956012  -0.87432422]
mat_Sqrt:  [[22.05520214  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00249081 -0.06847697  0.0195198 ]
Stock Position:  0.002490812720235712
Bond Position:  [14.91738943]


portfolio before change:  [15.18453358]
curr_Stock_Price:  106.50313370652408
curr_Factors:  [106.50313371  -0.58596169  -0.87134567]
mat_Sqrt:  [[24.80058011  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [1.65420609e-02 5.60704385e-04 1.29818989e+00]
Stock Position:  0.016542060850289586
Bond Position:  [13.42275226]


portfolio before change:  [15.20685833]
curr_Stock_Price:  107.75127319280277
curr_Factors:  [107.75127319  -0.49314764  -0.87061995]
mat_Sqrt:  [[27.5515268   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00420206  0.01965633 -0.27240119]
Stock Position:  -0.004202060828379249
Bond Position:  [15.65963574]


portfolio before change:  [15.2038446]
curr_Stock_Price:  108.93433698021303
curr_Factors:  [108.93433698  -0.48083044  -0.87262188]
mat_Sqrt:  [[28.14284008  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00527109  0.24499914  1.08654315]
Stock Position:  -0.005271090102636424
Bond Position:  [15.77804731]


portfolio before change:  [15.21588204]
curr_Stock_Price:  107.02485449253427
curr_Factors:  [107.02485449  -0.31619936  -0.84776874]
mat_Sqrt:  [[33.41794368  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01184464 -0.01504947  0.31037763]
Stock Position:  0.011844643487638097
Bond Position:  [13.94821079]


portfolio before change:  [15.22241505]
curr_Stock_Price:  107.42920415997135
curr_Factors:  [107.42920416  -0.24569731  -0.83476399]
mat_Sqrt:  [[36.46565177  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00738223 -0.02939316 -0.63955755]
Stock Position:  -0.007382233984737676
Bond Position:  [16.01548257]


portfolio before change:  [15.22073883]
curr_Stock_Price:  107.92746484953032
curr_Factors:  [107.92746485  -0.22400672  -0.83716191]
mat_Sqrt:  [[37.3484255   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0032634  -0.00493978  0.16183453]
Stock Position:  0.003263400779621806
Bond Position:  [14.86852826]


portfolio before change:  [15.22376021]
curr_Stock_Price:  108.28374869067028
curr_Factors:  [108.28374869  -0.38421441  -0.84258915]
mat_Sqrt:  [[31.75186688  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00095126 0.04743998 0.31690788]
Stock Position:  0.0009512561576921012
Bond Position:  [15.12075463]


portfolio before change:  [15.22553686]
curr_Stock_Price:  108.16437055451871
curr_Factors:  [108.16437055  -0.42490072  -0.84799355]
mat_Sqrt:  [[30.2881864   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00141589  0.02328151  0.08378082]
Stock Position:  -0.0014158923695158166
Bond Position:  [15.37868597]


portfolio before change:  [15.22620546]
curr_Stock_Price:  109.04993554380772
curr_Factors:  [109.04993554  -0.14432991  -0.8494643 ]
mat_Sqrt:  [[40.36696228  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00145744 0.0138027  0.32314708]
Stock Position:  0.0014574378180412385
Bond Position:  [15.06727196]


portfolio before change:  [15.22905477]
curr_Stock_Price:  109.71259666152983
curr_Factors:  [ 1.09712597e+02 -4.70170136e-02 -8.00865554e-01]
mat_Sqrt:  [[46.99219958  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00273783 -0.06519815  0.11243339]
Stock Position:  -0.0027378252050965874
Bond Position:  [15.52942868]


portfolio before change:  [15.23203907]
curr_Stock_Price:  109.33163558321348
curr_Factors:  [109.33163558  -0.12976109  -0.8095739 ]
mat_Sqrt:  [[42.73639084  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00430708  0.26959657 -0.11143908]
Stock Position:  -0.004307084145263045
Bond Position:  [15.70293963]


portfolio before change:  [15.2450021]
curr_Stock_Price:  106.77769623748303
curr_Factors:  [ 1.06777696e+02  2.65076750e-02 -7.77004936e-01]
mat_Sqrt:  [[50.41313755  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00147505 0.01552822 0.43161037]
Stock Position:  0.001475053304176351
Bond Position:  [15.0874993]


portfolio before change:  [15.24249736]
curr_Stock_Price:  103.80099359413765
curr_Factors:  [103.80099359   0.1137873   -0.7811662 ]
mat_Sqrt:  [[53.2552631   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00142146  0.0085909   0.24326284]
Stock Position:  -0.0014214574017962025
Bond Position:  [15.39004605]


portfolio before change:  [15.24301333]
curr_Stock_Price:  104.7914583237182
curr_Factors:  [104.79145832   0.11997074  -0.78218231]
mat_Sqrt:  [[54.04195523  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00140764 -0.02440228  0.00742434]
Stock Position:  -0.001407641185403347
Bond Position:  [15.3905221]


portfolio before change:  [15.24860758]
curr_Stock_Price:  102.18403844503261
curr_Factors:  [102.18403845   0.24172446  -0.76128962]
mat_Sqrt:  [[60.77693342  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00346662  0.07891325  0.06730991]
Stock Position:  -0.0034666224940851148
Bond Position:  [15.60284106]


portfolio before change:  [15.239645]
curr_Stock_Price:  105.33207593225876
curr_Factors:  [ 1.05332076e+02  7.59227809e-02 -7.81277631e-01]
mat_Sqrt:  [[52.02701679  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00116227 -0.05118276 -0.38485491]
Stock Position:  0.0011622678017878395
Bond Position:  [15.11722092]


portfolio before change:  [15.24134835]
curr_Stock_Price:  105.17168588477432
curr_Factors:  [105.17168588   0.11545232  -0.76785199]
mat_Sqrt:  [[54.77284015  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00316695 -0.08859616  0.07697902]
Stock Position:  -0.003166945635189891
Bond Position:  [15.57442136]


portfolio before change:  [15.23832678]
curr_Stock_Price:  106.74054514983045
curr_Factors:  [106.74054515  -0.33684548  -0.79227935]
mat_Sqrt:  [[34.51093571  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00115743 -0.01801017  0.25529315]
Stock Position:  -0.0011574349343057915
Bond Position:  [15.36187202]


portfolio before change:  [15.23885984]
curr_Stock_Price:  107.93914231034407
curr_Factors:  [ 1.07939142e+02 -3.62427726e-03 -8.08742780e-01]
mat_Sqrt:  [[47.90407214  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0005311   0.01319311 -0.10415054]
Stock Position:  -0.0005310973019411666
Bond Position:  [15.29618603]


portfolio before change:  [15.24063738]
curr_Stock_Price:  108.19258201879104
curr_Factors:  [108.19258202  -0.22185222  -0.81479199]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [15.24063738]
Stock Price:  109.81468665290359
PL:  [5.42595073]
Settle:  Tensor("sub_52:0", shape=(), dtype=float64)
PL:  Tensor("sub_53:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  27
output_Z_Vals[:, i, :]:  [[ 1.19260232e+02 -2.92559343e+01 -2.92733494e+01]
 [-8.59600330e-03 -4.89680876e-02 -2.39905835e-02]
 [-5.90651097e-02 -9.34985012e-02 -9.72676383e-02]
 [ 7.42031597e-02  1.42582688e-01  3.61225913e-02]
 [ 2.18824592e-01 -2.74327461e-02 -5.32864032e-02]
 [ 6.75013469e-02  2.90235898e-02 -6.82875330e-02]
 [ 8.02637880e-02  8.09988504e-03 -8.09731127e-02]
 [-8.71783904e-02  1.63128046e-02 -9.17679469e-02]
 [ 8.86305237e-02 -3.43106674e-02 -1.03068085e-01]
 [-4.75007633e-02 -1.12593183e-01 -1.30258179e-01]
 [ 1.24293453e-01  8.39579478e-02  2.83961626e-02]
 [-2.10086218e-01 -1.01572912e-01  4.86883826e-02]
 [-7.51609511e-02  6.28193477e-03  3.02579664e-02]
 [-9.62623594e-02 -1.14884369e-01  6.32126881e-02]
 [ 1.44584525e-01  2.00622117e-01  4.78498835e-02]
 [-6.59230430e-02 -4.39973176e-01 -6.06053183e-02]
 [-6.77241181e-02 -8.57582772e-03 -6.80561523e-02]
 [ 3.35547306e-03  1.17502177e-01 -1.85279135e-02]
 [ 6.76645140e-02  4.71127352e-02  3.55222257e-02]
 [-2.47271321e-02 -6.90272409e-03  8.99597967e-02]
 [ 7.46037709e-02 -9.25900115e-02  4.85266638e-02]
 [ 1.20529737e-01  4.69738569e-02  2.60892692e-01]
 [-3.35029293e-02 -5.27638383e-02  2.29687451e-01]
 [-6.92170189e-02 -5.50984757e-04 -8.18275766e-02]
 [-3.74164372e-01  1.19967436e-01  8.16573565e-02]
 [-1.31587878e-01 -2.53654252e-01  1.30509038e-01]
 [ 4.28256491e-02  6.70293074e-02 -2.25414959e-02]
 [ 2.96235257e-02 -1.97587839e-02 -4.50841387e-03]
 [-1.15579086e-01 -1.56077846e-01 -1.10953771e-01]
 [ 2.05074036e-01  2.89899146e-01  2.27567747e-01]
 [ 1.03985269e-01 -1.48737772e-01  9.02509442e-02]
 [ 1.32669602e-01  2.14677988e-01  1.57284818e-01]
 [ 4.34058701e-01 -3.03309999e-01 -1.71692655e-01]
 [-3.63993636e-02 -7.21731352e-02  2.99205269e-02]
 [-1.46750431e-01 -1.90854825e-01  7.37196739e-03]
 [ 3.84868979e-01  2.92451596e-01  1.38592383e-01]
 [ 1.27449108e-02 -8.51264757e-02 -9.49223208e-02]
 [-3.13403914e-03  7.77083988e-02  1.38575363e-02]
 [ 3.43821413e-01 -4.39835177e-01 -9.89862905e-02]
 [-2.84553045e-01  1.81423250e-01  1.34467361e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.26023247 -29.25593426 -29.27334937]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  8.31486419  -9.25153874 -83.50871763]
init_Out:  [2.49911038]
Stock Position:  8.31486419409362
Bond position:  [-828.98730903]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [5.11416149]
curr_Stock_Price:  100.32696637444329
curr_Factors:  [100.32696637  -0.90464732  -0.99898807]
mat_Sqrt:  [[14.95131293  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00098703 -0.01548507 -0.06843846]
Stock Position:  -0.000987031126254099
Bond Position:  [5.21318733]


portfolio before change:  [5.11471961]
curr_Stock_Price:  100.42175989673669
curr_Factors:  [100.4217599   -0.94913577  -0.98187443]
mat_Sqrt:  [[14.56132036  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00558561 -0.02956682 -0.2774775 ]
Stock Position:  -0.005585613264498855
Bond Position:  [5.67563673]


portfolio before change:  [5.11652939]
curr_Stock_Price:  100.22477530457515
curr_Factors:  [100.2247753   -0.77629858  -0.97638147]
mat_Sqrt:  [[17.36983981  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.0049084 0.0450886 0.1030477]
Stock Position:  0.004908400014608042
Bond Position:  [4.6245861]


portfolio before change:  [5.11941538]
curr_Stock_Price:  100.69496379729124
curr_Factors:  [100.6949638   -1.0025705   -0.95285002]
mat_Sqrt:  [[14.24883662  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01454429 -0.008675   -0.15201128]
Stock Position:  0.014544292000840255
Bond Position:  [3.65487842]


portfolio before change:  [5.09751896]
curr_Stock_Price:  99.15805138608413
curr_Factors:  [99.15805139 -0.9400481  -0.95271462]
mat_Sqrt:  [[14.93865768  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00363564  0.00917806 -0.19480532]
Stock Position:  0.0036356411401219963
Bond Position:  [4.73701587]


portfolio before change:  [5.09565558]
curr_Stock_Price:  98.4826411448392
curr_Factors:  [98.48264114 -0.88954497 -0.98475085]
mat_Sqrt:  [[15.11344092  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00423096  0.00256141 -0.23099375]
Stock Position:  0.0042309596539291455
Bond Position:  [4.67897949]


portfolio before change:  [5.09499079]
curr_Stock_Price:  98.1872719224293
curr_Factors:  [98.18727192 -0.87410808 -0.9834799 ]
mat_Sqrt:  [[15.32198329  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00688483  0.00515856 -0.26178841]
Stock Position:  -0.006884829941142926
Bond Position:  [5.77099346]


portfolio before change:  [5.10153414]
curr_Stock_Price:  97.34165463990276
curr_Factors:  [97.34165464 -0.82113598 -1.00156956]
mat_Sqrt:  [[15.72924101  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00424089 -0.01084999 -0.29402456]
Stock Position:  0.00424088747673205
Bond Position:  [4.68871914]


portfolio before change:  [5.10691875]
curr_Stock_Price:  98.4731356664934
curr_Factors:  [98.47313567 -0.65203517 -1.05401484]
mat_Sqrt:  [[17.88091187  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00430609 -0.03560509 -0.37159033]
Stock Position:  -0.004306086109268414
Bond Position:  [5.53095255]


portfolio before change:  [5.11397881]
curr_Stock_Price:  96.99414880255452
curr_Factors:  [96.9941488  -0.51481275 -1.04896484]
mat_Sqrt:  [[20.30511991  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00651351 0.02654983 0.08100635]
Stock Position:  0.006513508938811772
Bond Position:  [4.48220655]


portfolio before change:  [5.10963781]
curr_Stock_Price:  96.24166477880301
curr_Factors:  [96.24166478 -0.33491076 -1.05143817]
mat_Sqrt:  [[24.05910328  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00842801 -0.03212017  0.1388944 ]
Stock Position:  -0.008428009236744917
Bond Position:  [5.92076345]


portfolio before change:  [5.096134]
curr_Stock_Price:  97.93173788863919
curr_Factors:  [97.93173789 -0.27040655 -1.06846302]
mat_Sqrt:  [[25.67200522  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00268083  0.00198652  0.08631756]
Stock Position:  -0.002680833464302865
Bond Position:  [5.35867268]


portfolio before change:  [5.09635322]
curr_Stock_Price:  98.09984092926707
curr_Factors:  [98.09984093 -0.15454702 -1.0872636 ]
mat_Sqrt:  [[28.3371913   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00304636 -0.03632963  0.1803282 ]
Stock Position:  -0.003046364906951909
Bond Position:  [5.39520113]


portfolio before change:  [5.10287082]
curr_Stock_Price:  96.18176539046085
curr_Factors:  [96.18176539 -0.17686694 -1.06776618]
mat_Sqrt:  [[27.7048275   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00575827 0.06344228 0.1365024 ]
Stock Position:  0.00575827018015669
Bond Position:  [4.54903023]


portfolio before change:  [5.11239091]
curr_Stock_Price:  97.73629968899868
curr_Factors:  [97.73629969 -0.43013566 -1.06615899]
mat_Sqrt:  [[21.88887203  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00409588 -0.13913173 -0.1728901 ]
Stock Position:  -0.004095876214297769
Bond Position:  [5.51270669]


portfolio before change:  [5.1169983]
curr_Stock_Price:  96.77966372847288
curr_Factors:  [96.77966373 -0.30559652 -1.03279206]
mat_Sqrt:  [[25.38220425  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00322421 -0.00271191 -0.19414526]
Stock Position:  -0.0032242057534432327
Bond Position:  [5.42903585]


portfolio before change:  [5.11611995]
curr_Stock_Price:  97.26258250334065
curr_Factors:  [97.2625825  -0.37959233 -1.04991863]
mat_Sqrt:  [[23.28718943  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00011197  0.03715745 -0.05285498]
Stock Position:  0.00011196592573628371
Bond Position:  [5.10522985]


portfolio before change:  [5.11679418]
curr_Stock_Price:  97.5844710362221
curr_Factors:  [97.58447104 -0.55933388 -1.06382917]
mat_Sqrt:  [[19.25085212  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00395473 0.01489835 0.10133502]
Stock Position:  0.003954729017165074
Bond Position:  [4.73087404]


portfolio before change:  [5.11943646]
curr_Stock_Price:  98.10306011064469
curr_Factors:  [98.10306011 -0.62359379 -1.04038433]
mat_Sqrt:  [[18.57915846  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00035214 -0.00218283  0.25663026]
Stock Position:  -0.00035213613311569795
Bond Position:  [5.15398209]


portfolio before change:  [5.12058236]
curr_Stock_Price:  96.67855843295872
curr_Factors:  [96.67855843 -0.80314667 -1.04417116]
mat_Sqrt:  [[15.2422901   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00538755 -0.02927953  0.13843306]
Stock Position:  0.005387548088238789
Bond Position:  [4.59972198]


portfolio before change:  [5.1214053]
curr_Stock_Price:  96.7245783159029
curr_Factors:  [96.72457832 -0.93228951 -1.06490597]
mat_Sqrt:  [[13.12701156  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01333107 0.01485444 0.74425423]
Stock Position:  0.013331068857136811
Bond Position:  [3.83196328]


portfolio before change:  [5.12632523]
curr_Stock_Price:  97.05770292660408
curr_Factors:  [97.05770293 -0.83252293 -1.07139683]
mat_Sqrt:  [[14.45999568  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00083122 -0.01668539  0.65523436]
Stock Position:  0.0008312221528625961
Bond Position:  [5.04564872]


portfolio before change:  [5.12710089]
curr_Stock_Price:  97.23203727050003
curr_Factors:  [97.23203727 -0.68357536 -1.08371722]
mat_Sqrt:  [[16.60672413  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-5.17466472e-03 -1.74236679e-04 -2.33431300e-01]
Stock Position:  -0.005174664717001253
Bond Position:  [5.63024408]


portfolio before change:  [5.12738137]
curr_Stock_Price:  97.31384717899004
curr_Factors:  [97.31384718 -0.66353202 -1.10821118]
mat_Sqrt:  [[16.54688878  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02141784  0.03793703  0.23294571]
Stock Position:  -0.02141783827411544
Bond Position:  [7.21163361]


portfolio before change:  [5.17775078]
curr_Stock_Price:  95.0041883921007
curr_Factors:  [95.00418839 -0.5396663  -1.07304775]
mat_Sqrt:  [[18.93869025  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00588727 -0.08021252  0.37230596]
Stock Position:  -0.005887268638939303
Bond Position:  [5.73706596]


portfolio before change:  [5.18207267]
curr_Stock_Price:  94.39189952017315
curr_Factors:  [94.39189952 -0.41999953 -1.08629335]
mat_Sqrt:  [[20.92955732  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00190903  0.02119653 -0.06430461]
Stock Position:  0.001909026269918602
Bond Position:  [5.00187605]


portfolio before change:  [5.18127885]
curr_Stock_Price:  93.64854111019254
curr_Factors:  [93.64854111 -0.4040602  -1.09062643]
mat_Sqrt:  [[21.00713666  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00134207 -0.00624828 -0.01286125]
Stock Position:  0.0013420715261183588
Bond Position:  [5.05559581]


portfolio before change:  [5.18279255]
curr_Stock_Price:  94.30551967639555
curr_Factors:  [94.30551968 -0.37484753 -1.06407812]
mat_Sqrt:  [[22.36761311  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00635997 -0.04935615 -0.31652022]
Stock Position:  -0.006359969740486893
Bond Position:  [5.7825728]


portfolio before change:  [5.19306559]
curr_Stock_Price:  92.8039128524804
curr_Factors:  [92.80391285 -0.41441313 -1.06562697]
mat_Sqrt:  [[21.12482097  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01226099 0.09167416 0.64918744]
Stock Position:  0.0122609925292019
Bond Position:  [4.05519751]


portfolio before change:  [5.17351808]
curr_Stock_Price:  91.1682831848709
curr_Factors:  [91.16828318 -0.70961573 -1.06541368]
mat_Sqrt:  [[15.45106067  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00767373 -0.04703501  0.25746082]
Stock Position:  0.00767373034953432
Bond Position:  [4.47391726]


portfolio before change:  [5.17287983]
curr_Stock_Price:  91.01222795572443
curr_Factors:  [91.01222796 -0.82812206 -1.07626703]
mat_Sqrt:  [[13.55295746  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01256687 0.06788714 0.44868981]
Stock Position:  0.012566865431240132
Bond Position:  [4.02914141]


portfolio before change:  [5.17525926]
curr_Stock_Price:  91.16148960337149
curr_Factors:  [91.1614896  -0.37480499 -1.07254491]
mat_Sqrt:  [[21.44052114  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01824492 -0.09591504 -0.48979135]
Stock Position:  0.01824492284644423
Bond Position:  [3.51202491]


portfolio before change:  [5.17512774]
curr_Stock_Price:  91.13021814227952
curr_Factors:  [91.13021814 -0.40628534 -1.11539664]
mat_Sqrt:  [[19.89776622  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00161603 -0.02282315  0.08535494]
Stock Position:  -0.001616028835203249
Bond Position:  [5.3223968]


portfolio before change:  [5.17758879]
curr_Stock_Price:  90.019030330786
curr_Factors:  [90.01903033 -0.33568248 -1.11055749]
mat_Sqrt:  [[21.19533541  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00708521 -0.0603536   0.02103017]
Stock Position:  -0.007085213884562282
Bond Position:  [5.81539288]


portfolio before change:  [5.18257347]
curr_Stock_Price:  89.41810210153523
curr_Factors:  [89.4181021  -0.52382392 -1.1148479 ]
mat_Sqrt:  [[17.36838028  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.02422276 0.09248131 0.39536549]
Stock Position:  0.024222759470232308
Bond Position:  [3.01662029]


portfolio before change:  [5.20825182]
curr_Stock_Price:  90.46262602700565
curr_Factors:  [90.46262603 -0.78144721 -1.12199987]
mat_Sqrt:  [[13.48381012  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00065478 -0.02691936 -0.27078696]
Stock Position:  -0.0006547839907916323
Bond Position:  [5.2674853]


portfolio before change:  [5.20914861]
curr_Stock_Price:  90.0986736205475
curr_Factors:  [90.09867362 -0.60487697 -1.0926866 ]
mat_Sqrt:  [[16.49969461  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.0001031  0.02457355 0.03953169]
Stock Position:  0.00010309529287409057
Bond Position:  [5.19985986]


portfolio before change:  [5.2098372]
curr_Stock_Price:  90.47283290768678
curr_Factors:  [90.47283291 -0.87390482 -1.10462729]
mat_Sqrt:  [[12.50986467  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.02496106 -0.1390881  -0.28238033]
Stock Position:  0.02496105546775139
Bond Position:  [2.9515398]


portfolio before change:  [5.19878097]
curr_Stock_Price:  90.01511167669828
curr_Factors:  [90.01511168 -0.81068877 -1.09344023]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [5.19878097]
Stock Price:  90.18718099535056
PL:  [5.19878097]
Settle:  Tensor("sub_54:0", shape=(), dtype=float64)
PL:  Tensor("sub_55:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  28
output_Z_Vals[:, i, :]:  [[ 1.19260232e+02 -2.92559343e+01 -2.92733494e+01]
 [-7.53510219e-02  1.76765044e-01  2.11510010e-02]
 [-1.14196622e-02 -1.25290083e-02 -2.05022730e-02]
 [ 8.27694890e-02  1.50328574e-01  3.76895584e-02]
 [ 2.32417425e-01 -1.67293829e-02 -3.27889253e-02]
 [ 4.13153690e-02  3.29040785e-02  3.84322231e-02]
 [-2.04035217e-02  5.50180650e-02 -1.03700893e-01]
 [-3.83307337e-02  2.18191708e-01  5.33771084e-02]
 [-2.52283024e-02 -4.08311221e-02  2.88546465e-02]
 [-2.57290428e-02 -7.27088729e-02 -1.15947070e-01]
 [ 5.63815827e-02  1.72295661e-01 -8.41827723e-02]
 [-7.42216146e-02  5.88092014e-02  1.42297744e-02]
 [-1.05268475e-01  3.60169765e-02 -5.01576103e-02]
 [-1.10800882e-01 -1.04955899e-01  5.93245513e-02]
 [ 2.74504902e-01  3.75478831e-01  7.78546084e-02]
 [-7.24244586e-02 -8.46410841e-02 -1.06524572e-01]
 [-7.05834002e-02 -5.92581761e-02 -6.58508195e-02]
 [-8.23701689e-02  1.15624442e-01  1.13211451e-01]
 [ 1.19427095e-01  6.06761226e-02  1.26759684e-01]
 [ 8.89761960e-02 -3.45998011e-02  4.71243931e-02]
 [-3.51242883e-02 -2.34535891e-02 -3.98470603e-03]
 [ 1.04202132e-01 -6.22734152e-02  1.10402641e-01]
 [-6.07261683e-02  4.02047054e-02  2.97719887e-01]
 [ 5.17864963e-02 -2.40949977e-02 -7.02131518e-02]
 [ 6.97318072e-02  2.61784657e-02  9.47960868e-02]
 [ 7.52693339e-02 -2.12178772e-02  6.41978202e-02]
 [-1.54810274e-01  7.11766373e-02  8.53617815e-02]
 [-5.07806065e-02  7.36225950e-02  2.93687317e-02]
 [ 6.20848838e-02 -6.23725319e-02  9.08311027e-02]
 [-9.50225651e-02 -1.60278135e-01 -3.07393996e-03]
 [-1.33464210e-01  6.46956993e-01 -1.82991489e-02]
 [ 4.58535884e-02  7.10384891e-03  1.00079234e-01]
 [-3.94953563e-02  1.14504388e-02  8.05644915e-02]
 [-2.17117333e-01 -3.84766071e-02  1.26978430e-02]
 [-1.56329703e-01  1.41068259e-01  3.46380749e-02]
 [ 1.20848659e-01 -1.49736438e-01 -1.20254832e-01]
 [-2.66366578e-01 -4.74625474e-01  1.19859560e-01]
 [-7.92924004e-02 -1.07469055e-01  1.96957602e-01]
 [-1.08629211e-02  2.45163580e-02 -4.16565774e-02]
 [ 3.88595075e-01 -2.67991018e-02 -3.98010243e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.26023247 -29.25593426 -29.27334937]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  8.31486419  -9.25153874 -83.50871763]
init_Out:  [2.49911038]
Stock Position:  8.31486419409362
Bond position:  [-828.98730903]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [8.67495807]
curr_Stock_Price:  100.75521108142833
curr_Factors:  [100.75521108  -0.76295735  -0.97939126]
mat_Sqrt:  [[17.64310953  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00376745  0.05589801  0.06033792]
Stock Position:  -0.003767450289494517
Bond Position:  [9.05454832]


portfolio before change:  [8.67607656]
curr_Stock_Price:  100.7587687495824
curr_Factors:  [100.75876875  -0.76362231  -0.98712984]
mat_Sqrt:  [[17.49608394  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00091038 -0.00396202 -0.05848728]
Stock Position:  -0.000910384792569952
Bond Position:  [8.76780581]


portfolio before change:  [8.67687295]
curr_Stock_Price:  101.08791498282176
curr_Factors:  [101.08791498  -0.91139317  -0.99004659]
mat_Sqrt:  [[15.09782703  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00624887 0.04753807 0.10751782]
Stock Position:  0.006248866464333339
Bond Position:  [8.04518807]


portfolio before change:  [8.68360388]
curr_Stock_Price:  102.00411659084487
curr_Factors:  [102.00411659  -1.16964475  -1.00687688]
mat_Sqrt:  [[11.57087933  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01947064 -0.0052903  -0.09353768]
Stock Position:  0.01947064321486254
Bond Position:  [6.69751812]


portfolio before change:  [8.68115036]
curr_Stock_Price:  101.83510519730714
curr_Factors:  [101.8351052   -1.25288523  -1.01893401]
mat_Sqrt:  [[10.50168417  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00476208 0.01040518 0.10963644]
Stock Position:  0.004762083159047749
Bond Position:  [8.19620313]


portfolio before change:  [8.68369522]
curr_Stock_Price:  102.15434977550572
curr_Factors:  [102.15434978  -1.21088731  -1.01528715]
mat_Sqrt:  [[11.0265989   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00364127  0.01739824 -0.29582978]
Stock Position:  -0.0036412694264607
Bond Position:  [9.05566673]


portfolio before change:  [8.68795058]
curr_Stock_Price:  101.29659240940697
curr_Factors:  [101.29659241  -1.08874173  -1.02982171]
mat_Sqrt:  [[12.17627439  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00179049  0.06899828  0.15227003]
Stock Position:  -0.0017904895006094275
Bond Position:  [8.86932106]


portfolio before change:  [8.69069019]
curr_Stock_Price:  100.3857353058904
curr_Factors:  [100.38573531  -0.87320721  -1.03841842]
mat_Sqrt:  [[14.84101292  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00137407 -0.01291193  0.08231427]
Stock Position:  -0.0013740724768483478
Bond Position:  [8.82862747]


portfolio before change:  [8.69288856]
curr_Stock_Price:  99.58903704109642
curr_Factors:  [99.58903704 -0.95860124 -1.03508421]
mat_Sqrt:  [[13.56328669  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00378035 -0.02299256 -0.33076472]
Stock Position:  -0.0037803502681324963
Bond Position:  [9.06937]


portfolio before change:  [8.69487823]
curr_Stock_Price:  99.3626217266138
curr_Factors:  [99.36262173 -1.06503358 -1.03882531]
mat_Sqrt:  [[12.12072885  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00360098  0.05448467 -0.24015002]
Stock Position:  0.0036009799099150745
Bond Position:  [8.33707543]


portfolio before change:  [8.69742274]
curr_Stock_Price:  99.77981568249163
curr_Factors:  [99.77981568 -1.12981469 -1.03292033]
mat_Sqrt:  [[11.47569014  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00608229  0.0185971   0.04059359]
Stock Position:  -0.0060822945024692245
Bond Position:  [9.30431296]


portfolio before change:  [8.69586443]
curr_Stock_Price:  100.22724899611212
curr_Factors:  [100.227249    -1.16550139  -1.01626011]
mat_Sqrt:  [[11.30990168  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01013067  0.01138957 -0.1430857 ]
Stock Position:  -0.01013067162886094
Bond Position:  [9.71123378]


portfolio before change:  [8.70428743]
curr_Stock_Price:  99.51564582857625
curr_Factors:  [99.51564583 -1.15849882 -0.99610198]
mat_Sqrt:  [[11.53878617  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00878786 -0.03318997  0.16923643]
Stock Position:  -0.008787861789648172
Bond Position:  [9.57881717]


portfolio before change:  [8.69872054]
curr_Stock_Price:  100.28538022956006
curr_Factors:  [100.28538023  -1.22873183  -1.01341294]
mat_Sqrt:  [[10.65335809  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.02816875 0.11873683 0.22209753]
Stock Position:  0.02816874520053459
Bond Position:  [5.87380721]


portfolio before change:  [8.68904977]
curr_Stock_Price:  99.91599771069444
curr_Factors:  [99.91599771 -1.258969   -1.01993902]
mat_Sqrt:  [[10.23099454  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00941786 -0.02676586 -0.30388495]
Stock Position:  -0.009417864412516984
Bond Position:  [9.63004508]


portfolio before change:  [8.68971132]
curr_Stock_Price:  99.97357679216985
curr_Factors:  [99.97357679 -1.13009813 -1.05763725]
mat_Sqrt:  [[11.21408453  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00762926 -0.01873908 -0.18785406]
Stock Position:  -0.00762926137409456
Bond Position:  [9.45243587]


portfolio before change:  [8.69046894]
curr_Stock_Price:  100.02915364299909
curr_Factors:  [100.02915364  -1.02602945  -1.03867655]
mat_Sqrt:  [[12.68925632  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0044349   0.03656366  0.32296076]
Stock Position:  -0.004434898835102161
Bond Position:  [9.13408812]


portfolio before change:  [8.69538988]
curr_Stock_Price:  99.17702485873136
curr_Factors:  [99.17702486 -0.91578501 -1.00225096]
mat_Sqrt:  [[14.56862748  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01008115 0.01918747 0.3616101 ]
Stock Position:  0.01008114580512083
Bond Position:  [7.69557183]


portfolio before change:  [8.70103341]
curr_Stock_Price:  99.64140895951435
curr_Factors:  [99.64140896 -0.92240788 -0.98936837]
mat_Sqrt:  [[14.7287532   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00663342 -0.01094142  0.13443278]
Stock Position:  0.00663342363003952
Bond Position:  [8.04006973]


portfolio before change:  [8.69989536]
curr_Stock_Price:  99.31832960333868
curr_Factors:  [99.3183296  -0.70477168 -0.9651172 ]
mat_Sqrt:  [[18.69846183  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00195434 -0.00741668 -0.01136726]
Stock Position:  -0.0019543442910300497
Bond Position:  [8.89399757]


portfolio before change:  [8.7005207]
curr_Stock_Price:  99.56725346618393
curr_Factors:  [99.56725347 -0.76050481 -1.0060713 ]
mat_Sqrt:  [[17.01775519  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00735291 -0.01969258  0.314948  ]
Stock Position:  0.007352913619104192
Bond Position:  [7.96841128]


portfolio before change:  [8.70263803]
curr_Stock_Price:  99.71973954013998
curr_Factors:  [99.71973954 -0.64262765 -0.97572529]
mat_Sqrt:  [[19.76693744  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [5.48254001e-05 1.27138442e-02 8.49311969e-01]
Stock Position:  5.482540009148158e-05
Bond Position:  [8.69717085]


portfolio before change:  [8.70376036]
curr_Stock_Price:  100.36024559359913
curr_Factors:  [100.36024559  -0.47533197  -1.00295001]
mat_Sqrt:  [[22.88505757  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00160944 -0.00761951 -0.20029858]
Stock Position:  0.001609441727022705
Bond Position:  [8.54223639]


portfolio before change:  [8.70798387]
curr_Stock_Price:  102.3209699403576
curr_Factors:  [102.32096994  -0.26655199  -1.02171535]
mat_Sqrt:  [[28.21481784  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00318123 0.00827836 0.27042685]
Stock Position:  0.0031812327455465563
Bond Position:  [8.38247705]


portfolio before change:  [8.70860998]
curr_Stock_Price:  102.18838889166753
curr_Factors:  [102.18838889  -0.35110278  -1.04011104]
mat_Sqrt:  [[25.42172791  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00345475 -0.00670968  0.18313851]
Stock Position:  0.0034547539876203506
Bond Position:  [8.35557423]


portfolio before change:  [8.71544951]
curr_Stock_Price:  103.86579211202012
curr_Factors:  [103.86579211  -0.33795676  -1.06124213]
mat_Sqrt:  [[25.6335161   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00528792  0.02250803  0.2435134 ]
Stock Position:  -0.005287924590082207
Bond Position:  [9.26468398]


portfolio before change:  [8.71506036]
curr_Stock_Price:  104.15840241996604
curr_Factors:  [104.15840242  -0.40908929  -1.09314522]
mat_Sqrt:  [[23.18900712  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00184936  0.02328151  0.08378082]
Stock Position:  -0.0018493595601317399
Bond Position:  [8.9076867]


portfolio before change:  [8.71032488]
curr_Stock_Price:  107.3211258126424
curr_Factors:  [107.32112581  -0.76671665  -1.10950871]
mat_Sqrt:  [[16.43807282  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00480684 -0.01972393  0.25911585]
Stock Position:  0.0048068440872673784
Bond Position:  [8.19444896]


portfolio before change:  [8.71533075]
curr_Stock_Price:  108.14942289089232
curr_Factors:  [108.14942289  -0.71862172  -1.1360577 ]
mat_Sqrt:  [[16.92572067  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00589567 -0.0506844  -0.0087691 ]
Stock Position:  -0.0058956658977095434
Bond Position:  [9.35294361]


portfolio before change:  [8.71969357]
curr_Stock_Price:  107.60773082305383
curr_Factors:  [107.60773082  -0.72142635  -1.14076325]
mat_Sqrt:  [[16.71493948  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00720883  0.20458576 -0.05220238]
Stock Position:  -0.007208829566816162
Bond Position:  [9.49541936]


portfolio before change:  [8.72452958]
curr_Stock_Price:  107.10154572333495
curr_Factors:  [107.10154572  -0.8116731   -1.13450043]
mat_Sqrt:  [[15.29619154  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00434524 0.00224643 0.2854982 ]
Stock Position:  0.0043452382784334555
Bond Position:  [8.25914784]


portfolio before change:  [8.72354242]
curr_Stock_Price:  106.63675767036447
curr_Factors:  [106.63675767  -0.4592448   -1.15144124]
mat_Sqrt:  [[21.30074891  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00106825  0.00362095  0.22982807]
Stock Position:  -0.0010682511387228462
Bond Position:  [8.83745726]


portfolio before change:  [8.72465151]
curr_Stock_Price:  106.63269260443822
curr_Factors:  [106.6326926   -0.16491854  -1.17310058]
mat_Sqrt:  [[27.97667212  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00770352 -0.01216737  0.03622341]
Stock Position:  -0.007703520189303287
Bond Position:  [9.54609861]


portfolio before change:  [8.72762506]
curr_Stock_Price:  106.40160157420765
curr_Factors:  [106.40160157  -0.16795879  -1.14670859]
mat_Sqrt:  [[28.57560141  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00509585  0.0446097   0.09881279]
Stock Position:  -0.005095846160990794
Bond Position:  [9.26983126]


portfolio before change:  [8.72082152]
curr_Stock_Price:  107.96411757856386
curr_Factors:  [107.96411758  -0.11550453  -1.18679074]
mat_Sqrt:  [[29.35619672  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00314876 -0.04735082 -0.34305356]
Stock Position:  0.0031487582256785923
Bond Position:  [8.38086862]


portfolio before change:  [8.72632932]
curr_Stock_Price:  109.38058637936126
curr_Factors:  [ 1.09380586e+02 -6.61769549e-02 -1.18670712e+00]
mat_Sqrt:  [[31.24781163  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00813353 -0.15008975  0.34192596]
Stock Position:  -0.008133533563731409
Bond Position:  [9.61597999]


portfolio before change:  [8.71516543]
curr_Stock_Price:  110.90095411739155
curr_Factors:  [110.90095412  -0.22128721  -1.21953065]
mat_Sqrt:  [[26.25403362  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00159455 -0.0339847   0.56186521]
Stock Position:  -0.0015945525933267171
Bond Position:  [8.89200283]


portfolio before change:  [8.71621967]
curr_Stock_Price:  110.93690754889944
curr_Factors:  [110.93690755  -0.32231276  -1.23088193]
mat_Sqrt:  [[23.4710315   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00079813  0.00775275 -0.11883462]
Stock Position:  -0.0007981338472820915
Bond Position:  [8.80476217]


portfolio before change:  [8.71486853]
curr_Stock_Price:  114.00882226806748
curr_Factors:  [114.00882227  -0.55137077  -1.21380963]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [8.71486853]
Stock Price:  112.73512207446963
PL:  [-4.02025354]
Settle:  Tensor("sub_56:0", shape=(), dtype=float64)
PL:  Tensor("sub_57:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  29
output_Z_Vals[:, i, :]:  [[ 1.19260232e+02 -2.92559343e+01 -2.92733494e+01]
 [ 4.31389351e-03 -1.24241556e-01 -3.89698686e-02]
 [-3.29252565e-02  2.60252873e-02  6.77278881e-02]
 [ 8.32792523e-02  1.54963866e-01  3.77514855e-02]
 [ 1.20491752e-01  2.96810166e-03 -6.56183601e-02]
 [ 6.30749984e-02  2.91056539e-02  8.03408559e-03]
 [ 7.75902451e-02  9.38908243e-03 -7.82075597e-02]
 [-9.92672418e-02 -2.75604809e-02 -1.07768523e-01]
 [ 7.43744133e-02 -3.25227791e-02 -3.61674722e-02]
 [-7.50655521e-02  4.02398879e-01  1.89899733e-01]
 [ 5.73199110e-02  1.06979592e-01 -8.21582636e-02]
 [-2.12686153e-02 -5.23885158e-02 -1.66069820e-02]
 [-5.96081765e-02 -1.55553411e-02  4.86407507e-02]
 [-8.88711389e-02 -1.12002831e-01  6.94782681e-02]
 [ 1.40250987e-01  5.35398114e-02 -1.14017458e-01]
 [-9.24833590e-02 -3.03055059e-01 -9.21356580e-02]
 [-6.68649383e-02 -4.51743375e-02 -4.29597344e-02]
 [ 2.04265733e-02  1.70051230e-01  1.10850298e-01]
 [ 6.87611589e-02  4.03082986e-02  3.71172050e-02]
 [ 2.30109705e-01 -4.89154321e-02 -3.03745953e-02]
 [-5.93930845e-02  6.05217250e-03  4.00552702e-03]
 [ 9.39686836e-02 -5.57059233e-02  1.20126588e-01]
 [-8.98513732e-02  1.34790510e-01  4.13136441e-01]
 [-7.25813323e-02 -4.70926759e-04 -8.08473074e-02]
 [-6.77753979e-01  1.32303916e-01  1.01165795e-01]
 [-1.47868677e-01 -2.71903103e-01  1.35722958e-01]
 [ 1.24742700e-01  5.96269366e-02 -8.97497867e-02]
 [-5.07806065e-02  7.36225950e-02  2.93687317e-02]
 [ 4.77071600e-02 -9.70047308e-02 -1.91442913e-01]
 [ 1.57140827e-02 -4.98912405e-03 -9.87386532e-02]
 [-5.49543792e-02  3.76684470e-01  1.05726526e-02]
 [ 1.85691289e-02 -1.02190115e-01 -7.93466243e-02]
 [-6.60716506e-02  2.27031835e-02  8.38011601e-02]
 [-5.09127913e-02 -8.63420217e-02 -1.00058749e-02]
 [-1.83895879e-01  1.47321198e-01  2.64070119e-02]
 [ 8.47165236e-02 -1.65012150e-01 -1.38726811e-01]
 [-1.32261443e-01 -2.13691535e-01  3.47333299e-03]
 [-3.97302636e-02 -1.73876117e-02  8.23988103e-03]
 [-4.71110262e-02  1.00532805e-01 -1.89125331e-02]
 [-3.18218913e-01  1.70883860e-01  1.92415107e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.26023247 -29.25593426 -29.27334937]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  8.31486419  -9.25153874 -83.50871763]
init_Out:  [2.49911038]
Stock Position:  8.31486419409362
Bond position:  [-828.98730903]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [1.05852073]
curr_Stock_Price:  99.83920846711166
curr_Factors:  [99.83920847 -1.02610488 -0.98742252]
mat_Sqrt:  [[13.3302192   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00051377 -0.03928863 -0.11117019]
Stock Position:  -0.0005137725560593038
Bond Position:  [1.10981538]


portfolio before change:  [1.05870369]
curr_Stock_Price:  99.75312289271277
curr_Factors:  [99.75312289 -0.95819223 -1.01561393]
mat_Sqrt:  [[13.85840904  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00132976  0.00822992  0.19320881]
Stock Position:  -0.0013297622555509933
Bond Position:  [1.19135163]


portfolio before change:  [1.05750758]
curr_Stock_Price:  100.76461488205867
curr_Factors:  [100.76461488  -0.95641878  -1.01862741]
mat_Sqrt:  [[13.98158441  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00679368 0.04900388 0.10769448]
Stock Position:  0.006793678673129856
Bond Position:  [0.37294516]


portfolio before change:  [1.05032979]
curr_Stock_Price:  99.70121247865518
curr_Factors:  [99.70121248 -0.92701433 -0.97784141]
mat_Sqrt:  [[14.83993852  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.007222    0.0009386  -0.18719092]
Stock Position:  0.0072220040389989314
Bond Position:  [0.33028723]


portfolio before change:  [1.04180747]
curr_Stock_Price:  98.51544722203975
curr_Factors:  [98.51544722 -0.85192558 -0.97407022]
mat_Sqrt:  [[15.86662039  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00412605 0.00920402 0.02291901]
Stock Position:  0.004126049049351123
Bond Position:  [0.63532791]


portfolio before change:  [1.04353983]
curr_Stock_Price:  98.91605649771594
curr_Factors:  [98.9160565  -0.8959348  -0.98417491]
mat_Sqrt:  [[15.09195577  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00409944  0.00296909 -0.2231044 ]
Stock Position:  0.004099443428265638
Bond Position:  [0.63803905]


portfolio before change:  [1.04349158]
curr_Stock_Price:  98.88483104235047
curr_Factors:  [98.88483104 -0.9496577  -1.00068649]
mat_Sqrt:  [[14.06390602  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00867305 -0.00871539 -0.3074336 ]
Stock Position:  -0.008673053397599965
Bond Position:  [1.901125]


portfolio before change:  [1.03653442]
curr_Stock_Price:  99.71439044778256
curr_Factors:  [99.71439045 -0.59321512 -0.99545038]
mat_Sqrt:  [[20.36147232  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00324888 -0.01028461 -0.10317573]
Stock Position:  0.0032488821730094985
Bond Position:  [0.71257412]


portfolio before change:  [1.0399525]
curr_Stock_Price:  100.73905051645016
curr_Factors:  [100.73905052  -0.69782351  -0.9916926 ]
mat_Sqrt:  [[18.59731848  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00139335  0.1272497   0.54173108]
Stock Position:  -0.0013933480302021498
Bond Position:  [1.18031706]


portfolio before change:  [1.04054006]
curr_Stock_Price:  100.42325584529507
curr_Factors:  [100.42325585  -0.86262214  -0.96417548]
mat_Sqrt:  [[16.16092343  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00268002  0.03382992 -0.23437466]
Stock Position:  0.0026800217824274135
Bond Position:  [0.77140355]


portfolio before change:  [1.0392744]
curr_Stock_Price:  99.91501835361122
curr_Factors:  [99.91501835 -0.41596149 -1.00657197]
mat_Sqrt:  [[24.08975282  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00107976 -0.0165667  -0.0473751 ]
Stock Position:  -0.00107976064290496
Bond Position:  [1.14715871]


portfolio before change:  [1.0403637]
curr_Stock_Price:  99.0389968689087
curr_Factors:  [ 9.90389969e+01 -5.16071775e-02 -1.01831188e+00]
mat_Sqrt:  [[33.9739693   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0014741  -0.00491903  0.13875852]
Stock Position:  -0.00147410099685337
Bond Position:  [1.18635719]


portfolio before change:  [1.04026689]
curr_Stock_Price:  99.20527931440651
curr_Factors:  [99.20527931 -0.34072468 -1.0038242 ]
mat_Sqrt:  [[25.85857725  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0030002  -0.03541841  0.19820216]
Stock Position:  -0.003000197835647243
Bond Position:  [1.33790235]


portfolio before change:  [1.036758]
curr_Stock_Price:  100.43057835352995
curr_Factors:  [100.43057835  -0.38556268  -0.99937769]
mat_Sqrt:  [[25.14166317  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00470771  0.01693077 -0.32526007]
Stock Position:  0.0047077101280836205
Bond Position:  [0.56395995]


portfolio before change:  [1.02968153]
curr_Stock_Price:  98.91243814409464
curr_Factors:  [98.91243814 -0.20366141 -1.01624269]
mat_Sqrt:  [[29.20473638  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00407863 -0.09583442 -0.26283739]
Stock Position:  -0.004078630186688962
Bond Position:  [1.43310879]


portfolio before change:  [1.03169554]
curr_Stock_Price:  98.46256635860492
curr_Factors:  [98.46256636 -0.28856698 -1.01284848]
mat_Sqrt:  [[26.79622386  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00286609 -0.01428538 -0.12255216]
Stock Position:  -0.0028660924083649623
Bond Position:  [1.31389836]


portfolio before change:  [1.03249787]
curr_Stock_Price:  98.23993435536987
curr_Factors:  [ 9.82399344e+01  3.40511326e-02 -9.88776468e-01]
mat_Sqrt:  [[37.81430466  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00125467 0.05377492 0.31622504]
Stock Position:  0.0012546706827212958
Bond Position:  [0.90923911]


portfolio before change:  [1.03407902]
curr_Stock_Price:  99.40955472267093
curr_Factors:  [ 9.94095547e+01 -5.75191057e-02 -9.80453930e-01]
mat_Sqrt:  [[35.20806576  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00219775 0.0127466  0.10588505]
Stock Position:  0.0021977473261831078
Bond Position:  [0.81560194]


portfolio before change:  [1.03736458]
curr_Stock_Price:  100.85812594533655
curr_Factors:  [100.85812595  -0.21359759  -0.98896748]
mat_Sqrt:  [[30.30006211  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00734806 -0.01546842 -0.08665027]
Stock Position:  0.0073480550956081725
Bond Position:  [0.29625351]


portfolio before change:  [1.03453946]
curr_Stock_Price:  100.4686145202125
curr_Factors:  [100.46861452  -0.31842515  -0.98182602]
mat_Sqrt:  [[27.37401527  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00213411  0.00191386  0.01142665]
Stock Position:  -0.0021341112265903634
Bond Position:  [1.24895066]


portfolio before change:  [1.03798769]
curr_Stock_Price:  98.92600238966936
curr_Factors:  [ 9.89260024e+01 -6.02375763e-02 -9.79510513e-01]
mat_Sqrt:  [[34.9746681   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00334674 -0.01761576  0.34268772]
Stock Position:  0.0033467394081209967
Bond Position:  [0.70690814]


portfolio before change:  [1.03073043]
curr_Stock_Price:  96.73113974971011
curr_Factors:  [ 9.67311397e+01 -4.29948167e-02 -9.54502204e-01]
mat_Sqrt:  [[35.67457872  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-5.71828548e-05  4.26245019e-02  1.17856327e+00]
Stock Position:  -5.7182854753758863e-05
Bond Position:  [1.03626179]


portfolio before change:  [1.03101993]
curr_Stock_Price:  93.93382334849633
curr_Factors:  [93.93382335  0.26723222 -0.96444388]
mat_Sqrt:  [[46.77640285  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-1.90472917e-03 -1.48920117e-04 -2.30634865e-01]
Stock Position:  -0.0019047291727515023
Bond Position:  [1.20993842]


portfolio before change:  [1.03429291]
curr_Stock_Price:  92.29488746938088
curr_Factors:  [92.29488747  0.40123701 -0.91341349]
mat_Sqrt:  [[55.30217659  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01182029  0.04183817  0.28859785]
Stock Position:  -0.011820285661533661
Bond Position:  [2.12524484]


portfolio before change:  [1.01280285]
curr_Stock_Price:  94.13542933136831
curr_Factors:  [94.13542933  0.2989998  -0.91714994]
mat_Sqrt:  [[50.73339332  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00250693 -0.08598331  0.38717982]
Stock Position:  -0.002506925799915899
Bond Position:  [1.24879339]


portfolio before change:  [1.00790487]
curr_Stock_Price:  96.15147825114614
curr_Factors:  [96.15147825  0.13360375 -0.9031693 ]
mat_Sqrt:  [[44.5387368   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00242401  0.01885569 -0.25603116]
Stock Position:  0.002424005925322125
Bond Position:  [0.77483312]


portfolio before change:  [1.01676757]
curr_Stock_Price:  99.76773849472097
curr_Factors:  [99.76773849 -0.25549747 -0.91061951]
mat_Sqrt:  [[31.08507773  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00137959  0.02328151  0.08378082]
Stock Position:  -0.0013795948131795912
Bond Position:  [1.15440662]


portfolio before change:  [1.01347596]
curr_Stock_Price:  102.25827008155798
curr_Factors:  [102.25827008  -0.26802958  -0.88686953]
mat_Sqrt:  [[32.22048932  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 1.90077426e-04 -3.06755893e-02 -5.46133343e-01]
Stock Position:  0.00019007742574829543
Bond Position:  [0.99403897]


portfolio before change:  [1.01372389]
curr_Stock_Price:  102.9088902520241
curr_Factors:  [102.90889025  -0.20588452  -0.8890263 ]
mat_Sqrt:  [[34.43016982  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-1.32723107e-04 -1.57769955e-03 -2.81673894e-01]
Stock Position:  -0.0001327231072420077
Bond Position:  [1.02738227]


portfolio before change:  [1.0137961]
curr_Stock_Price:  103.33246812014465
curr_Factors:  [103.33246812  -0.38450561  -0.90941678]
mat_Sqrt:  [[28.333058    0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00152014  0.11911809  0.03016083]
Stock Position:  -0.0015201428077063794
Bond Position:  [1.17087621]


portfolio before change:  [1.01627702]
curr_Stock_Price:  101.7967235681281
curr_Factors:  [101.79672357  -0.22151953  -0.87986713]
mat_Sqrt:  [[33.83823103  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-7.86005621e-06 -3.23153516e-02 -2.26353833e-01]
Stock Position:  -7.86005621038794e-06
Bond Position:  [1.01707715]


portfolio before change:  [1.01638046]
curr_Stock_Price:  104.81224051409728
curr_Factors:  [104.81224051  -0.24264951  -0.88067093]
mat_Sqrt:  [[34.08475167  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00141939  0.00717938  0.23906138]
Stock Position:  -0.00141939179260452
Bond Position:  [1.16515009]


portfolio before change:  [1.01975593]
curr_Stock_Price:  102.53674920337568
curr_Factors:  [102.5367492   -0.35542332  -0.85674449]
mat_Sqrt:  [[30.50996801  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00180874 -0.02730374 -0.02854398]
Stock Position:  -0.0018087391418851434
Bond Position:  [1.20521816]


portfolio before change:  [1.02420894]
curr_Stock_Price:  100.1581024429433
curr_Factors:  [100.15810244  -0.74706034  -0.85956479]
mat_Sqrt:  [[20.08804435  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0086968   0.04658705  0.07533185]
Stock Position:  -0.008696802451154943
Bond Position:  [1.89526417]


portfolio before change:  [1.01038649]
curr_Stock_Price:  101.77471597558534
curr_Factors:  [101.77471598  -0.51332193  -0.88935898]
mat_Sqrt:  [[25.03014239  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00208303 -0.05218142 -0.39574898]
Stock Position:  0.0020830259642093535
Bond Position:  [0.79838712]


portfolio before change:  [1.01094823]
curr_Stock_Price:  101.99647575915081
curr_Factors:  [101.99647576  -0.53887542  -0.88291919]
mat_Sqrt:  [[24.60977341  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00556974 -0.0675752   0.00990845]
Stock Position:  -0.005569736098553252
Bond Position:  [1.57904168]


portfolio before change:  [1.01105712]
curr_Stock_Price:  102.01236580756095
curr_Factors:  [102.01236581  -0.30397171  -0.88335774]
mat_Sqrt:  [[31.11732036  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00123716 -0.00549845  0.02350609]
Stock Position:  -0.001237164726860188
Bond Position:  [1.13726322]


portfolio before change:  [1.01189649]
curr_Stock_Price:  101.44881449821962
curr_Factors:  [101.4488145   -0.47693397  -0.90783619]
mat_Sqrt:  [[25.4008902   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00190449  0.03179126 -0.05395219]
Stock Position:  -0.0019044917164620881
Bond Position:  [1.20510492]


portfolio before change:  [1.01052983]
curr_Stock_Price:  102.24551413904896
curr_Factors:  [102.24551414  -0.45904726  -0.9181047 ]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [1.01052983]
Stock Price:  103.74370972748451
PL:  [-2.7331799]
Settle:  Tensor("sub_58:0", shape=(), dtype=float64)
PL:  Tensor("sub_59:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  30
output_Z_Vals[:, i, :]:  [[ 1.19260232e+02 -2.92559343e+01 -2.92733494e+01]
 [-1.12154280e-01  2.92721354e-01  4.36623164e-02]
 [-4.41462906e-02 -5.43507029e-02 -4.35032615e-02]
 [ 8.43427278e-02  1.64634081e-01  3.78806788e-02]
 [ 9.82794726e-02  1.03624761e-02 -6.69669769e-02]
 [ 7.63737379e-02  3.04934808e-02 -2.34269993e-02]
 [ 7.39740589e-02  1.24235875e-02 -7.19042685e-02]
 [-1.09341277e-01 -6.41215265e-02 -1.21102326e-01]
 [-2.77517538e-02 -5.78887368e-02  4.86398575e-02]
 [-6.42056663e-02  2.35440803e-01  8.52624626e-02]
 [ 5.75511772e-02  8.96145810e-02 -8.15976978e-02]
 [-5.51195636e-02  6.77145586e-02  9.90325653e-03]
 [-6.65976764e-02 -6.42042271e-02 -6.60865969e-02]
 [ 1.78921186e-01  1.51426621e-01  2.49092852e-01]
 [ 1.08792277e-01  1.27189719e-02 -1.19685672e-01]
 [-6.12845268e-02 -8.88773064e-02 -1.28553339e-01]
 [-7.73408693e-02 -3.12847178e-02 -5.90418440e-02]
 [ 3.75285920e-02 -1.85113348e-01 -9.07270791e-02]
 [ 3.18983676e-02  6.03835821e-02  2.91012394e-02]
 [ 3.01422879e-01 -2.14073070e-01 -5.89540207e-02]
 [ 1.40066133e-01  1.18673881e-02  2.00396036e-01]
 [ 4.61168956e-03 -8.62958275e-03  4.35497094e-03]
 [-1.08415195e-01  2.18485435e-01  2.82130789e-01]
 [ 1.33842714e-01 -2.22429110e-02  1.05251218e-03]
 [ 7.55050279e-02  3.08322219e-02  8.85358218e-02]
 [ 8.46757636e-02 -1.02939274e-02  6.11421472e-02]
 [-1.60674845e-01  7.32219574e-02  7.74293703e-02]
 [-1.31188296e-02  4.14101935e-02  1.94875915e-02]
 [ 6.07616431e-02 -7.86561364e-02 -2.65655768e-02]
 [ 3.93350441e-02  1.19761222e-02 -2.44153586e-02]
 [ 1.43595941e-02  1.62529946e-01  2.91575282e-02]
 [ 1.51679541e-02 -6.96433501e-02 -8.89292701e-02]
 [ 1.52415555e-01 -1.69554826e-01 -1.07389233e-01]
 [-3.80149026e-02 -7.68740976e-02  8.40165398e-03]
 [-9.31088027e-02 -6.67502719e-03  3.59539310e-02]
 [ 8.47165236e-02 -1.65012150e-01 -1.38726811e-01]
 [-2.25009896e-01 -3.86430936e-01  7.77736198e-02]
 [-4.85787668e-02 -3.32506935e-02  4.98951223e-02]
 [-3.85333672e-02  8.25444671e-02 -2.42946256e-02]
 [ 6.76142963e-02 -2.01467781e-03 -5.61754775e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.26023247 -29.25593426 -29.27334937]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  8.31486419  -9.25153874 -83.50871763]
init_Out:  [2.49911038]
Stock Position:  8.31486419409362
Bond position:  [-828.98730903]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [9.85067171]
curr_Stock_Price:  100.89661010062525
curr_Factors:  [100.8966101   -1.05040335  -1.03581712]
mat_Sqrt:  [[12.52686909  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00763828  0.09256662  0.12455644]
Stock Position:  -0.007638278418633854
Bond Position:  [10.62134811]


portfolio before change:  [9.853933]
curr_Stock_Price:  100.64347174518933
curr_Factors:  [100.64347175  -1.09575457  -1.01760828]
mat_Sqrt:  [[12.16084588  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00447581 -0.0171872  -0.1241027 ]
Stock Position:  -0.004475814123005655
Bond Position:  [10.30439448]


portfolio before change:  [9.85512342]
curr_Stock_Price:  100.66530415025636
curr_Factors:  [100.66530415  -1.06363462  -1.03341256]
mat_Sqrt:  [[12.3635672   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00779111 0.05206187 0.10806303]
Stock Position:  0.0077911108629130634
Bond Position:  [9.07082887]


portfolio before change:  [9.84720774]
curr_Stock_Price:  99.50377543405318
curr_Factors:  [99.50377543 -0.97266869 -1.01432698]
mat_Sqrt:  [[13.64263637  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00622148  0.0032769  -0.19103815]
Stock Position:  0.006221484715446307
Bond Position:  [9.22814652]


portfolio before change:  [9.85159709]
curr_Stock_Price:  100.02386906151021
curr_Factors:  [100.02386906  -0.9878878   -1.02170681]
mat_Sqrt:  [[13.4074999   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0053984   0.00964289 -0.06683071]
Stock Position:  0.005398400930699296
Bond Position:  [9.31162814]


portfolio before change:  [9.84815569]
curr_Stock_Price:  99.17076028636293
curr_Factors:  [99.17076029 -1.12922172 -1.00272438]
mat_Sqrt:  [[11.76227187  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00506853  0.00392868 -0.20512286]
Stock Position:  0.005068530795194801
Bond Position:  [9.34550564]


portfolio before change:  [9.85150909]
curr_Stock_Price:  99.60187833286362
curr_Factors:  [99.60187833 -1.01965646 -0.99952805]
mat_Sqrt:  [[13.22351276  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01026329 -0.02027701 -0.34547123]
Stock Position:  -0.010263293840839018
Bond Position:  [10.87375243]


portfolio before change:  [9.8519467]
curr_Stock_Price:  99.69168258818392
curr_Factors:  [99.69168259 -1.01033718 -0.97273633]
mat_Sqrt:  [[13.72211457  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00140779 -0.01830603  0.13875597]
Stock Position:  -0.001407790694361066
Bond Position:  [9.99229173]


portfolio before change:  [9.85195813]
curr_Stock_Price:  100.57085367875686
curr_Factors:  [100.57085368  -1.09262109  -0.9766871 ]
mat_Sqrt:  [[12.6993943   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00320665  0.07445292  0.24323007]
Stock Position:  -0.0032066477016657008
Bond Position:  [10.17445343]


portfolio before change:  [9.85285695]
curr_Stock_Price:  100.68719538492529
curr_Factors:  [100.68719538  -0.84368015  -0.96797476]
mat_Sqrt:  [[16.4506292   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00262658  0.02833862 -0.23277552]
Stock Position:  0.002626583753444856
Bond Position:  [9.5883936]


portfolio before change:  [9.8566828]
curr_Stock_Price:  101.68743935174831
curr_Factors:  [101.68743935  -0.74651146  -0.99501347]
mat_Sqrt:  [[17.82102361  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00288141  0.02141322  0.02825123]
Stock Position:  -0.0028814106639335956
Bond Position:  [10.14968607]


portfolio before change:  [9.85769678]
curr_Stock_Price:  101.77587038816165
curr_Factors:  [101.77587039  -0.70541322  -1.01751303]
mat_Sqrt:  [[18.17136128  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00449858 -0.02030316 -0.18852667]
Stock Position:  -0.0044985783543198335
Bond Position:  [10.31554351]


portfolio before change:  [9.8561656]
curr_Stock_Price:  102.40289109914787
curr_Factors:  [102.4028911   -0.58633092  -1.04433626]
mat_Sqrt:  [[20.05037318  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01165449 0.0478853  0.71059257]
Stock Position:  0.01165448982738841
Bond Position:  [8.66271215]


portfolio before change:  [9.86378598]
curr_Stock_Price:  102.9638314990414
curr_Factors:  [102.9638315   -0.61125217  -1.03716269]
mat_Sqrt:  [[19.80556407  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00427607  0.00402209 -0.34142991]
Stock Position:  0.004276068268703476
Bond Position:  [9.42350561]


portfolio before change:  [9.86971097]
curr_Stock_Price:  104.07395759376776
curr_Factors:  [104.07395759  -0.6232098   -1.00797173]
mat_Sqrt:  [[20.36708763  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00441006 -0.02810547 -0.36672689]
Stock Position:  -0.004410064471939252
Bond Position:  [10.32868383]


portfolio before change:  [9.87987412]
curr_Stock_Price:  102.06219870856883
curr_Factors:  [102.06219871  -0.61135346  -0.98416533]
mat_Sqrt:  [[20.69854967  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00435782 -0.0098931  -0.16842995]
Stock Position:  -0.004357817558244033
Bond Position:  [10.32464256]


portfolio before change:  [9.87531556]
curr_Stock_Price:  103.40443466954834
curr_Factors:  [103.40443467  -0.87657514  -0.9960731 ]
mat_Sqrt:  [[15.89492066  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00089522 -0.05853798 -0.2588191 ]
Stock Position:  0.0008952167032325318
Bond Position:  [9.78274619]


portfolio before change:  [9.87703804]
curr_Stock_Price:  103.9624657609531
curr_Factors:  [103.96246576  -0.89432563  -0.97706405]
mat_Sqrt:  [[16.0008245   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00246223 0.01909497 0.08301774]
Stock Position:  0.0024622312804990438
Bond Position:  [9.62105841]


portfolio before change:  [9.8793299]
curr_Stock_Price:  104.40480904333053
curr_Factors:  [104.40480904  -0.90615936  -0.99120061]
mat_Sqrt:  [[15.65696347  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01813005 -0.06769585 -0.16817941]
Stock Position:  0.018130054246479305
Bond Position:  [7.98646505]


portfolio before change:  [9.86992255]
curr_Stock_Price:  103.83086041016497
curr_Factors:  [103.83086041  -0.7271101   -1.00819416]
mat_Sqrt:  [[18.3102126   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00990039 0.0037528  0.57167411]
Stock Position:  0.009900388437172798
Bond Position:  [8.8419567]


portfolio before change:  [9.86437496]
curr_Stock_Price:  103.15887627048073
curr_Factors:  [103.15887627  -0.72786851  -0.99968972]
mat_Sqrt:  [[18.33317142  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00028788 -0.00272891  0.01242352]
Stock Position:  0.00028788414661629395
Bond Position:  [9.83467716]


portfolio before change:  [9.86569217]
curr_Stock_Price:  103.46386353544901
curr_Factors:  [103.46386354  -0.75480757  -1.01983195]
mat_Sqrt:  [[17.54173495  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00257581  0.06909116  0.80484061]
Stock Position:  -0.002575812439680181
Bond Position:  [10.13219568]


portfolio before change:  [9.86695103]
curr_Stock_Price:  103.4668718425794
curr_Factors:  [103.46687184  -0.93750174  -0.9952421 ]
mat_Sqrt:  [[14.97687941  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00891262 -0.00703383  0.00300252]
Stock Position:  0.008912620867811385
Bond Position:  [8.94479003]


portfolio before change:  [9.86597641]
curr_Stock_Price:  103.23206054918519
curr_Factors:  [103.23206055  -1.09249582  -0.97916451]
mat_Sqrt:  [[13.00480812  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00725681 0.00975    0.25256806]
Stock Position:  0.0072568092130000945
Bond Position:  [9.11684105]


portfolio before change:  [9.86581459]
curr_Stock_Price:  103.0527119045832
curr_Factors:  [103.0527119   -1.29643568  -1.00689896]
mat_Sqrt:  [[10.29754988  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00940909 -0.00325523  0.17442153]
Stock Position:  0.009409089072784788
Bond Position:  [8.89618245]


portfolio before change:  [9.86836411]
curr_Stock_Price:  103.20548177918893
curr_Factors:  [103.20548178  -1.19162065  -1.03683905]
mat_Sqrt:  [[11.11463011  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01286404  0.02315482  0.22088444]
Stock Position:  -0.012864041035358502
Bond Position:  [11.19600366]


portfolio before change:  [9.86675492]
curr_Stock_Price:  103.43937191057047
curr_Factors:  [103.43937191  -1.37452496  -1.05429747]
mat_Sqrt:  [[ 9.11720448  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00088533  0.01309505  0.05559267]
Stock Position:  -0.0008853300491524818
Bond Position:  [9.95833291]


portfolio before change:  [9.86821828]
curr_Stock_Price:  103.1925853979181
curr_Factors:  [103.1925854   -1.24386872  -1.07791877]
mat_Sqrt:  [[10.12299449  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00526604 -0.02487325 -0.0757842 ]
Stock Position:  0.005266038108166157
Bond Position:  [9.32480219]


portfolio before change:  [9.86554657]
curr_Stock_Price:  102.46388174318251
curr_Factors:  [102.46388174  -1.27840144  -1.07837199]
mat_Sqrt:  [[ 9.70592893  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00357106  0.00378718 -0.06965022]
Stock Position:  0.0035710648963866625
Bond Position:  [9.4996414]


portfolio before change:  [9.86514066]
curr_Stock_Price:  102.01767200543208
curr_Factors:  [102.01767201  -1.12852536  -1.04653287]
mat_Sqrt:  [[11.5893645   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00211468 0.05139648 0.08317831]
Stock Position:  0.0021146849594735587
Bond Position:  [9.64940542]


portfolio before change:  [9.8653515]
curr_Stock_Price:  101.54695992110084
curr_Factors:  [101.54695992  -1.15175897  -1.03607982]
mat_Sqrt:  [[11.38939385  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00041994 -0.02202316 -0.25369045]
Stock Position:  -0.00041993813007473176
Bond Position:  [9.90799494]


portfolio before change:  [9.86611487]
curr_Stock_Price:  102.67857833489334
curr_Factors:  [102.67857833  -1.14345815  -1.04264597]
mat_Sqrt:  [[11.53630929  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01093217 -0.05361794 -0.30635159]
Stock Position:  0.010932173352498074
Bond Position:  [8.74361485]


portfolio before change:  [9.87624304]
curr_Stock_Price:  103.50505190181501
curr_Factors:  [103.5050519   -1.43662935  -1.06107825]
mat_Sqrt:  [[ 8.51571113  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00449578 -0.02430972  0.02396758]
Stock Position:  -0.00449578458307221
Bond Position:  [10.34157946]


portfolio before change:  [9.87360423]
curr_Stock_Price:  104.37955664527811
curr_Factors:  [104.37955665  -1.41400167  -1.06626636]
mat_Sqrt:  [[ 8.73873816  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00983461 -0.00211083  0.10256656]
Stock Position:  -0.009834610465599835
Bond Position:  [10.90013652]


portfolio before change:  [9.87630035]
curr_Stock_Price:  104.2439625000649
curr_Factors:  [104.2439625   -1.09888006  -1.08368992]
mat_Sqrt:  [[11.7536515   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00443594 -0.05218142 -0.39574898]
Stock Position:  0.004435935205294381
Bond Position:  [9.41388089]


portfolio before change:  [9.88308259]
curr_Stock_Price:  105.50760286764891
curr_Factors:  [105.50760287  -1.03509564  -1.06533567]
mat_Sqrt:  [[12.91451286  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01696634 -0.12220019  0.22186649]
Stock Position:  -0.01696634075283595
Bond Position:  [11.67316053]


portfolio before change:  [9.90249725]
curr_Stock_Price:  104.44930624853592
curr_Factors:  [104.44930625  -0.90885842  -1.04562731]
mat_Sqrt:  [[14.79391747  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00265329 -0.01051479  0.1423369 ]
Stock Position:  -0.002653286187553494
Bond Position:  [10.17963115]


portfolio before change:  [9.9056331]
curr_Stock_Price:  103.74703666789556
curr_Factors:  [103.74703667  -0.94036926  -1.01477805]
mat_Sqrt:  [[14.6847316   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00281661  0.02610285 -0.0693058 ]
Stock Position:  -0.0028166124533042566
Bond Position:  [10.1978483]


portfolio before change:  [9.90534652]
curr_Stock_Price:  104.30138769326288
curr_Factors:  [104.30138769  -1.03029321  -1.00816089]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [9.90534652]
Stock Price:  103.52420486789133
PL:  [6.38114165]
Settle:  Tensor("sub_60:0", shape=(), dtype=float64)
PL:  Tensor("sub_61:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  31
output_Z_Vals[:, i, :]:  [[ 1.19260232e+02 -2.92559343e+01 -2.92733494e+01]
 [-7.21580376e-03 -5.33218459e-02 -2.42335845e-02]
 [ 7.87139244e-02  6.30188567e-02 -2.95952157e-02]
 [ 8.66767962e-02  1.85857833e-01  3.81642264e-02]
 [ 1.25556353e-01  1.13147386e-03 -6.47218965e-02]
 [ 6.77440219e-02  2.86188705e-02 -9.02601012e-02]
 [ 7.51519259e-02  1.14351861e-02 -7.39573815e-02]
 [-8.76756965e-02  1.45079640e-02 -9.24261718e-02]
 [-4.01091006e-02 -5.52822133e-02  7.54121195e-03]
 [-1.21546826e-01 -1.53526546e-01 -1.22272394e-01]
 [ 1.06612382e-01  8.00286869e-02 -2.23929362e-02]
 [-2.29002888e-01 -1.08427262e-01  6.01291670e-02]
 [-7.23194689e-02 -4.68592367e-02  5.97168156e-03]
 [-9.62623594e-02 -1.14884369e-01  6.32126881e-02]
 [ 3.60351856e-01  4.11116748e-01  6.87204970e-03]
 [-2.21030648e-02 -4.91942873e-01 -1.88826431e-02]
 [-6.63936889e-02 -3.14242697e-02 -3.24720114e-02]
 [ 3.85533268e-02  8.59274066e-02 -9.50686410e-02]
 [-6.19206944e-02  4.87902571e-02 -1.24404026e-01]
 [-5.85016298e-02 -2.38460384e-02  1.35021225e-01]
 [ 1.04482861e-01 -1.10747704e-01  6.13175105e-02]
 [ 1.14869197e-01  1.69524437e-01  3.32339460e-01]
 [-3.41533751e-02 -4.88733152e-02  2.16724987e-01]
 [-5.66283878e-02 -1.08155772e-02 -8.56609429e-02]
 [-6.48249350e-01  1.80299356e-01  6.11647766e-02]
 [-1.58434258e-01 -2.83442279e-01  1.39072056e-01]
 [ 5.15807862e-02  6.58767592e-02 -2.88481707e-02]
 [-2.06199120e-03 -3.00351176e-02 -2.65432391e-02]
 [-1.48543205e-01 -2.34343466e-01 -2.55860337e-02]
 [ 1.86723639e-01  2.54127224e-01  1.76687088e-01]
 [ 8.81644409e-02 -9.09158258e-02  7.75040898e-02]
 [ 1.06532730e-01  5.00553689e-02  2.85401491e-02]
 [ 3.11767240e-01 -1.85979500e-01 -4.32005780e-02]
 [-4.10924527e-02 -7.67548128e-02  1.70098509e-02]
 [-1.63527334e-01 -3.83446544e-02  1.59483518e-02]
 [ 2.11697470e-01  8.50624130e-03  2.52665708e-04]
 [ 2.21091769e-02  1.02702973e-03 -9.39820005e-02]
 [-1.12999535e-02  4.30916999e-02 -4.08785542e-02]
 [ 2.58317615e-01 -3.43290368e-01 -7.29079693e-02]
 [-3.16965484e-01  1.92972088e-01  1.59772945e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.26023247 -29.25593426 -29.27334937]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  8.31486419  -9.25153874 -83.50871763]
init_Out:  [2.49911038]
Stock Position:  8.31486419409362
Bond position:  [-828.98730903]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [4.63699801]
curr_Stock_Price:  100.2695795707123
curr_Factors:  [100.26957957  -1.08260554  -0.9853708 ]
mat_Sqrt:  [[12.67822578  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00106791 -0.01686185 -0.06913167]
Stock Position:  -0.001067911855329759
Bond Position:  [4.74407708]


portfolio before change:  [4.63660851]
curr_Stock_Price:  101.18964091815695
curr_Factors:  [101.18964092  -1.09366729  -1.0190587 ]
mat_Sqrt:  [[12.23462927  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00607292  0.01992831 -0.08442691]
Stock Position:  0.006072923382419278
Bond Position:  [4.02209158]


portfolio before change:  [4.62830027]
curr_Stock_Price:  99.73876918823348
curr_Factors:  [99.73876919 -1.21289644 -1.00553254]
mat_Sqrt:  [[10.84957032  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00914929 0.05877341 0.10887191]
Stock Position:  0.009149289970141536
Bond Position:  [3.71576135]


portfolio before change:  [4.62862699]
curr_Stock_Price:  99.72371028946255
curr_Factors:  [99.72371029 -0.98109685 -1.00227885]
mat_Sqrt:  [[13.72237584  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00818913  0.0003578  -0.18463356]
Stock Position:  0.008189126068416666
Bond Position:  [3.81197696]


portfolio before change:  [4.6244222]
curr_Stock_Price:  99.15205991316162
curr_Factors:  [99.15205991 -1.24406437 -0.98317031]
mat_Sqrt:  [[10.69118907  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00468224  0.00905008 -0.25748695]
Stock Position:  0.004682238023630584
Bond Position:  [4.16016866]


portfolio before change:  [4.62414741]
curr_Stock_Price:  98.98230126629525
curr_Factors:  [98.98230127 -1.17331047 -0.99158979]
mat_Sqrt:  [[11.35934557  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00531287  0.00361612 -0.21097982]
Stock Position:  0.005312867147155603
Bond Position:  [4.09826759]


portfolio before change:  [4.62015268]
curr_Stock_Price:  98.13397494114497
curr_Factors:  [98.13397494 -1.07754744 -0.97543104]
mat_Sqrt:  [[12.59569588  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00842887  0.00458782 -0.26366614]
Stock Position:  -0.00842887258900414
Bond Position:  [5.44731145]


portfolio before change:  [4.62163591]
curr_Stock_Price:  98.0387925081331
curr_Factors:  [98.03879251 -1.45722652 -0.96009302]
mat_Sqrt:  [[ 8.74116701  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00457572 -0.01748177  0.02151298]
Stock Position:  -0.00457572058025728
Bond Position:  [5.07023403]


portfolio before change:  [4.62591983]
curr_Stock_Price:  97.24108250820005
curr_Factors:  [97.24108251 -1.34938982 -0.93733377]
mat_Sqrt:  [[ 9.87957699  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01523037 -0.04854936 -0.34880911]
Stock Position:  -0.01523036994713913
Bond Position:  [6.10693749]


portfolio before change:  [4.63413421]
curr_Stock_Price:  96.75186529256031
curr_Factors:  [96.75186529 -1.59155531 -0.95045796]
mat_Sqrt:  [[ 7.6151245   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01367118  0.02530729 -0.06388081]
Stock Position:  0.013671184910519942
Bond Position:  [3.31142156]


portfolio before change:  [4.63090154]
curr_Stock_Price:  96.48512740446927
curr_Factors:  [96.4851274  -1.42623212 -0.97095698]
mat_Sqrt:  [[ 8.77757153  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02501018 -0.03428771  0.17153178]
Stock Position:  -0.02501018107672673
Bond Position:  [7.04401204]


portfolio before change:  [4.63446831]
curr_Stock_Price:  96.37772257755164
curr_Factors:  [96.37772258 -1.38814449 -0.98045792]
mat_Sqrt:  [[ 9.02205988  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00801484 -0.01481819  0.01703555]
Stock Position:  -0.0080148442600598
Bond Position:  [5.40692074]


portfolio before change:  [4.6296586]
curr_Stock_Price:  97.06215370575926
curr_Factors:  [97.06215371 -1.2439354  -0.97844148]
mat_Sqrt:  [[10.51680705  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00820833 -0.03632963  0.1803282 ]
Stock Position:  -0.008208330224195448
Bond Position:  [5.42637681]


portfolio before change:  [4.62787312]
curr_Stock_Price:  97.36231529741927
curr_Factors:  [97.3623153  -0.99513291 -1.0000568 ]
mat_Sqrt:  [[13.24009226  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.0281244  0.13000653 0.01960404]
Stock Position:  0.02812439589583694
Bond Position:  [1.88961682]


portfolio before change:  [4.60612359]
curr_Stock_Price:  96.58058314611749
curr_Factors:  [96.58058315 -1.15590257 -0.97914683]
mat_Sqrt:  [[11.41956727  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00338536 -0.155566   -0.05386692]
Stock Position:  -0.0033853628247938632
Bond Position:  [4.93308391]


portfolio before change:  [4.60647924]
curr_Stock_Price:  96.65768717725798
curr_Factors:  [96.65768718 -1.12120641 -0.96893955]
mat_Sqrt:  [[11.95356754  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00617668 -0.00993723 -0.09263361]
Stock Position:  -0.006176681678524923
Bond Position:  [5.20350301]


portfolio before change:  [4.61305203]
curr_Stock_Price:  95.69886962711256
curr_Factors:  [95.69886963 -0.96495693 -0.97898987]
mat_Sqrt:  [[13.69813483  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00155979  0.02717263 -0.27120437]
Stock Position:  0.001559785917468373
Bond Position:  [4.46378228]


portfolio before change:  [4.61401899]
curr_Stock_Price:  95.96105196161018
curr_Factors:  [95.96105196 -0.99877994 -0.9635854 ]
mat_Sqrt:  [[13.48498785  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00638153  0.01542883 -0.35489006]
Stock Position:  -0.006381526020571441
Bond Position:  [5.22639694]


portfolio before change:  [4.61807461]
curr_Stock_Price:  95.42790652454808
curr_Factors:  [95.42790652 -0.75722394 -0.98709716]
mat_Sqrt:  [[16.67732397  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00189216 -0.00754078  0.38517797]
Stock Position:  -0.0018921644578212687
Bond Position:  [4.7986399]


portfolio before change:  [4.61688433]
curr_Stock_Price:  96.37398728201971
curr_Factors:  [96.37398728 -1.03029368 -0.99649519]
mat_Sqrt:  [[12.69803757  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00898877 -0.0350215   0.17492179]
Stock Position:  0.008988770983093981
Bond Position:  [3.75060063]


portfolio before change:  [4.60795565]
curr_Stock_Price:  95.32851166395614
curr_Factors:  [95.32851166 -1.02213926 -0.98258937]
mat_Sqrt:  [[12.84044965  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01456996 0.05360833 0.94807198]
Stock Position:  0.014569957626776125
Bond Position:  [3.21902327]


portfolio before change:  [4.60656059]
curr_Stock_Price:  95.20514433269614
curr_Factors:  [95.20514433 -0.90331241 -0.97335274]
mat_Sqrt:  [[14.57589056  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 6.05350596e-04 -1.54550993e-02  6.18256064e-01]
Stock Position:  0.0006053505959266103
Bond Position:  [4.5489281]


portfolio before change:  [4.60678672]
curr_Stock_Price:  94.63932030947144
curr_Factors:  [94.63932031 -0.79875833 -0.9679061 ]
mat_Sqrt:  [[16.17405813  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00459953 -0.00342019 -0.24436683]
Stock Position:  -0.004599532840423771
Bond Position:  [5.04208339]


portfolio before change:  [4.60618553]
curr_Stock_Price:  94.90706455690322
curr_Factors:  [94.90706456 -0.82490423 -0.98681864]
mat_Sqrt:  [[15.50519728  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.04070305  0.05701566  0.17448608]
Stock Position:  -0.040703050811305486
Bond Position:  [8.4691926]


portfolio before change:  [4.62257245]
curr_Stock_Price:  94.53047835543477
curr_Factors:  [94.53047836 -1.24173797 -0.99235002]
mat_Sqrt:  [[10.12324551  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01356924 -0.08963232  0.39673386]
Stock Position:  -0.013569239378726547
Bond Position:  [5.90527914]


portfolio before change:  [4.62764457]
curr_Stock_Price:  94.2110855999119
curr_Factors:  [94.2110856  -1.22329641 -1.00885519]
mat_Sqrt:  [[10.10859711  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0046884   0.02083206 -0.0822958 ]
Stock Position:  0.004688396234071957
Bond Position:  [4.18594567]


portfolio before change:  [4.62307681]
curr_Stock_Price:  93.12520558783379
curr_Factors:  [93.12520559 -0.68896154 -1.00710953]
mat_Sqrt:  [[17.07941286  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00048337 -0.00949794 -0.07572047]
Stock Position:  -0.00048336618292868825
Bond Position:  [4.66809039]


portfolio before change:  [4.62404088]
curr_Stock_Price:  92.33797589388057
curr_Factors:  [92.33797589 -0.74831995 -0.97331312]
mat_Sqrt:  [[16.50762556  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00968138 -0.07410591 -0.07298983]
Stock Position:  -0.009681383517169878
Bond Position:  [5.51800024]


portfolio before change:  [4.61839024]
curr_Stock_Price:  92.99288595083138
curr_Factors:  [92.99288595 -0.61856642 -0.97755446]
mat_Sqrt:  [[18.8479116   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01216852 0.08036208 0.50403908]
Stock Position:  0.012168524650147138
Bond Position:  [3.48680401]


portfolio before change:  [4.62758755]
curr_Stock_Price:  93.71289373619585
curr_Factors:  [93.71289374 -0.49039557 -0.99678142]
mat_Sqrt:  [[21.18003084  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00479874 -0.02875011  0.2210976 ]
Stock Position:  0.004798739968443715
Bond Position:  [4.17788374]


portfolio before change:  [4.62392739]
curr_Stock_Price:  92.8413260385344
curr_Factors:  [92.84132604 -0.44649487 -0.9915882 ]
mat_Sqrt:  [[22.03889375  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00515683 0.0158289  0.0814171 ]
Stock Position:  0.005156832682509812
Bond Position:  [4.1451602]


portfolio before change:  [4.63874392]
curr_Stock_Price:  95.61402782822684
curr_Factors:  [95.61402783 -0.51726957 -1.03032498]
mat_Sqrt:  [[20.3427582   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01465617 -0.05881188 -0.12323922]
Stock Position:  0.014656173283888428
Bond Position:  [3.23740816]


portfolio before change:  [4.62376722]
curr_Stock_Price:  94.56454484457808
curr_Factors:  [94.56454484 -0.52432107 -1.03294995]
mat_Sqrt:  [[19.92572463  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00198749 -0.024272    0.04852437]
Stock Position:  -0.0019874876794400685
Bond Position:  [4.81171309]


portfolio before change:  [4.6249484]
curr_Stock_Price:  94.27288302554882
curr_Factors:  [94.27288303 -0.70386059 -1.03298579]
mat_Sqrt:  [[16.59907897  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00971511 -0.01212564  0.04549621]
Stock Position:  -0.009715114055913054
Bond Position:  [5.54082021]


portfolio before change:  [4.62642366]
curr_Stock_Price:  94.19232624853142
curr_Factors:  [94.19232625 -0.95399543 -1.03647468]
mat_Sqrt:  [[12.86960862  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01647048 0.00268991 0.00072078]
Stock Position:  0.01647048338727801
Bond Position:  [3.07503052]


portfolio before change:  [4.63347999]
curr_Stock_Price:  94.59740995665108
curr_Factors:  [94.59740996 -1.05394444 -1.01187771]
mat_Sqrt:  [[11.98682287  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 2.46245331e-04  3.24775319e-04 -2.68104488e-01]
Stock Position:  0.0002462453311861012
Bond Position:  [4.61018582]


portfolio before change:  [4.63395737]
curr_Stock_Price:  94.1956643502268
curr_Factors:  [94.19566435 -0.8117441  -0.99585753]
mat_Sqrt:  [[15.45252666  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00119926  0.01362679 -0.11661514]
Stock Position:  -0.001199262164240302
Bond Position:  [4.74692267]


portfolio before change:  [4.63628407]
curr_Stock_Price:  92.75036302969887
curr_Factors:  [92.75036303 -0.76744211 -0.98936325]
mat_Sqrt:  [[16.00828266  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01465314 -0.10855795 -0.20798614]
Stock Position:  0.014653140754453326
Bond Position:  [3.27719994]


portfolio before change:  [4.62479857]
curr_Stock_Price:  91.9385799625212
curr_Factors:  [91.93857996 -0.56700762 -1.00696419]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [4.62479857]
Stock Price:  92.12585352549034
PL:  [4.62479857]
Settle:  Tensor("sub_62:0", shape=(), dtype=float64)
PL:  Tensor("sub_63:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  32
output_Z_Vals[:, i, :]:  [[ 1.19260232e+02 -2.92559343e+01 -2.92733494e+01]
 [-1.57919939e-01  4.78593171e-01  8.44226922e-02]
 [ 2.98715479e-01  1.12054669e-01 -2.26496942e-01]
 [ 8.58863203e-02  1.78670013e-01  3.80681977e-02]
 [ 2.31843813e-01 -1.71810605e-02 -3.36539107e-02]
 [ 3.27233187e-02  3.37574038e-02  4.68499920e-02]
 [-2.63419434e-02  5.14755257e-02 -1.20484238e-01]
 [ 3.11110964e-01 -1.14475403e-01  1.57430094e-01]
 [-6.16520278e-02  5.21058900e-03  8.53948084e-02]
 [-3.39991633e-02  2.82556253e-01  1.09406387e-01]
 [ 5.64165110e-03 -1.95530965e-01 -4.04839718e-03]
 [-1.03975021e-01  1.15530772e-01  4.06195225e-02]
 [-6.78938564e-02 -6.31125694e-02 -6.60429198e-02]
 [ 1.56319231e-01  1.50462895e-01  2.40616800e-01]
 [ 1.80487197e-01  2.22012413e-01  2.53344645e-02]
 [-7.34798426e-02 -9.45668982e-02 -1.19325686e-01]
 [-7.69291836e-02 -3.32218264e-02 -7.47777009e-02]
 [-3.74399349e-02  9.36102665e-03  3.89300171e-02]
 [ 8.28283048e-02  6.55571234e-02  9.30506281e-02]
 [ 1.75058628e-01 -5.21449199e-02  1.11657412e-02]
 [-5.71670189e-02  1.02900962e-02 -5.43568874e-02]
 [ 7.93027717e-02 -6.02134097e-02  7.71111800e-02]
 [-3.71913858e-02 -3.17641507e-02  1.65464209e-01]
 [-2.27518843e-02 -3.51722091e-03 -8.09553284e-02]
 [-1.82137171e-01  8.87904211e-02  5.79536470e-02]
 [ 2.69530271e-02 -7.53868762e-02  7.96724805e-02]
 [-1.15391148e-01  6.02504689e-02  1.77102414e-02]
 [-5.07806065e-02  7.36225950e-02  2.93687317e-02]
 [ 5.96058637e-02 -9.28789884e-02 -1.29105257e-01]
 [ 7.44399069e-03 -5.70332142e-03 -1.15022580e-01]
 [ 4.16731309e-02  1.00460114e-01  1.95088466e-02]
 [ 1.81029533e-02 -6.21919842e-02 -8.82317287e-02]
 [ 2.73343763e-01 -2.94077611e-01 -2.46742621e-01]
 [-4.70876018e-02 -8.26076402e-02  5.17211367e-04]
 [-1.91835161e-01  1.52871772e-01  2.43789744e-02]
 [ 8.47165236e-02 -1.65012150e-01 -1.38726811e-01]
 [-1.51001938e-01 -2.35921255e-01  1.69786872e-02]
 [-3.74826465e-02 -1.35950771e-02 -2.31040790e-03]
 [-4.52319977e-02  9.65922660e-02 -2.00915384e-02]
 [-5.90936924e-02  4.99955848e-02  3.02355487e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.26023247 -29.25593426 -29.27334937]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  8.31486419  -9.25153874 -83.50871763]
init_Out:  [2.49911038]
Stock Position:  8.31486419409362
Bond position:  [-828.98730903]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [13.11410421]
curr_Stock_Price:  101.28909185596203
curr_Factors:  [101.28909186  -1.09621498  -1.02338003]
mat_Sqrt:  [[12.16281948  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01055101  0.15134445  0.24083444]
Stock Position:  -0.010551008079144766
Bond Position:  [14.18280623]


portfolio before change:  [13.10678714]
curr_Stock_Price:  102.1506233897946
curr_Factors:  [102.15062339  -1.28135811  -1.03735097]
mat_Sqrt:  [[10.05167549  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.02540623  0.0354348  -0.64613273]
Stock Position:  0.02540623439844359
Bond Position:  [10.51152446]


portfolio before change:  [13.09145441]
curr_Stock_Price:  101.49540011750854
curr_Factors:  [101.49540012  -1.28793731  -1.05551243]
mat_Sqrt:  [[ 9.74314281  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01008609 0.05650042 0.10859797]
Stock Position:  0.010086088284711563
Bond Position:  [12.06776284]


portfolio before change:  [13.09787028]
curr_Stock_Price:  101.98194228411656
curr_Factors:  [101.98194228  -1.41569984  -1.06206974]
mat_Sqrt:  [[ 8.55936646  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.02623215 -0.00543313 -0.09600524]
Stock Position:  0.0262321546125596
Bond Position:  [10.4226642]


portfolio before change:  [13.10719566]
curr_Stock_Price:  102.28776807367446
curr_Factors:  [102.28776807  -1.47807558  -1.08543438]
mat_Sqrt:  [[ 7.87962363  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00547718 0.01067503 0.13364999]
Stock Position:  0.005477183647000192
Bond Position:  [12.54694677]


portfolio before change:  [13.10949776]
curr_Stock_Price:  102.42171022148823
curr_Factors:  [102.42171022  -1.37332362  -1.11885199]
mat_Sqrt:  [[ 8.47332581  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00585444  0.01627799 -0.34370799]
Stock Position:  -0.005854441829453608
Bond Position:  [13.7091197]


portfolio before change:  [13.10597403]
curr_Stock_Price:  103.31632597284039
curr_Factors:  [103.31632597  -1.37529068  -1.1175169 ]
mat_Sqrt:  [[ 8.5419373   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.03983763 -0.0362003   0.44910424]
Stock Position:  0.03983762625092871
Bond Position:  [8.99009685]


portfolio before change:  [13.10875652]
curr_Stock_Price:  103.35796161031708
curr_Factors:  [103.35796161  -1.39495652  -1.11798644]
mat_Sqrt:  [[ 8.37503587  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00526402  0.00164773  0.24360762]
Stock Position:  -0.005264019092293506
Bond Position:  [13.65283481]


portfolio before change:  [13.10844341]
curr_Stock_Price:  103.7416666016847
curr_Factors:  [103.7416666   -1.31498199  -1.10777726]
mat_Sqrt:  [[ 9.19945807  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00047515  0.08935213  0.31210597]
Stock Position:  -0.0004751483171261565
Bond Position:  [13.15773608]


portfolio before change:  [13.109997]
curr_Stock_Price:  103.93365343188026
curr_Factors:  [103.93365343  -1.16318735  -1.10361369]
mat_Sqrt:  [[10.77201649  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-2.16591137e-05 -6.18323203e-02 -1.15489503e-02]
Stock Position:  -2.1659113720048966e-05
Bond Position:  [13.11224811]


portfolio before change:  [13.11164438]
curr_Stock_Price:  103.55319319016405
curr_Factors:  [103.55319319  -1.18618124  -1.10479568]
mat_Sqrt:  [[10.47622607  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00884866  0.03653404  0.11587619]
Stock Position:  -0.0088486639846851
Bond Position:  [14.02795179]


portfolio before change:  [13.12185871]
curr_Stock_Price:  102.59703387888483
curr_Factors:  [102.59703388  -1.04693062  -1.11833677]
mat_Sqrt:  [[11.76985538  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00705228 -0.01995795 -0.18840207]
Stock Position:  -0.007052284659066756
Bond Position:  [13.8454022]


portfolio before change:  [13.12604076]
curr_Stock_Price:  102.24944977385476
curr_Factors:  [102.24944977  -0.99205221  -1.13667463]
mat_Sqrt:  [[12.166528    0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01720457 0.04758055 0.68641275]
Stock Position:  0.01720456851598533
Bond Position:  [11.36688309]


portfolio before change:  [13.13612815]
curr_Stock_Price:  102.75317918018538
curr_Factors:  [102.75317918  -1.06166242  -1.14208892]
mat_Sqrt:  [[11.34274641  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01687342 0.07020649 0.07227218]
Stock Position:  0.016873418656375903
Bond Position:  [11.40233074]


portfolio before change:  [13.12458104]
curr_Stock_Price:  101.98436676847841
curr_Factors:  [101.98436677  -0.96623907  -1.13782873]
mat_Sqrt:  [[12.43794315  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00806233 -0.02990468 -0.34040297]
Stock Position:  -0.008062330071621411
Bond Position:  [13.94681267]


portfolio before change:  [13.12897507]
curr_Stock_Price:  101.6556066919357
curr_Factors:  [101.65560669  -0.88891422  -1.11454787]
mat_Sqrt:  [[13.71004267  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00678706 -0.01050566 -0.21331997]
Stock Position:  -0.006787061427059288
Bond Position:  [13.81891792]


portfolio before change:  [13.13035023]
curr_Stock_Price:  101.70751611018295
curr_Factors:  [101.70751611  -1.10122952  -1.1046579 ]
mat_Sqrt:  [[11.20336065  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00261097  0.00296022  0.1110565 ]
Stock Position:  -0.002610973500446847
Bond Position:  [13.39590586]


portfolio before change:  [13.13430347]
curr_Stock_Price:  100.83479839256799
curr_Factors:  [100.83479839  -1.07207423  -1.13171704]
mat_Sqrt:  [[11.13053516  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00930008 0.02073098 0.26544754]
Stock Position:  0.009300079542377366
Bond Position:  [12.19653182]


portfolio before change:  [13.13467017]
curr_Stock_Price:  100.71028763004703
curr_Factors:  [100.71028763  -1.17403669  -1.13362449]
mat_Sqrt:  [[10.02003692  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01756395 -0.01648967  0.03185275]
Stock Position:  0.017563952184339163
Bond Position:  [11.3657995]


portfolio before change:  [13.14374084]
curr_Stock_Price:  101.14583024437493
curr_Factors:  [101.14583024  -1.02458492  -1.13993882]
mat_Sqrt:  [[11.61200642  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00585574  0.00325401 -0.15506507]
Stock Position:  -0.005855739345316586
Bond Position:  [13.73602445]


portfolio before change:  [13.14720407]
curr_Stock_Price:  100.84763933910901
curr_Factors:  [100.84763934  -1.08636085  -1.12254165]
mat_Sqrt:  [[11.07519987  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00844123 -0.01904115  0.21997673]
Stock Position:  0.008441231128547276
Bond Position:  [12.29592584]


portfolio before change:  [13.14922772]
curr_Stock_Price:  100.90527962622811
curr_Factors:  [100.90527963  -1.20527473  -1.10920485]
mat_Sqrt:  [[ 9.97121727  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-4.24852088e-04 -1.00447064e-02  4.72023331e-01]
Stock Position:  -0.0004248520878558016
Bond Position:  [13.19209753]


portfolio before change:  [13.15085795]
curr_Stock_Price:  100.94972626455652
curr_Factors:  [100.94972626  -1.30836041  -1.11017806]
mat_Sqrt:  [[ 8.98974217  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00437917 -0.00111224 -0.23094302]
Stock Position:  -0.004379172954543019
Bond Position:  [13.59293426]


portfolio before change:  [13.15572281]
curr_Stock_Price:  100.226840295965
curr_Factors:  [100.2268403   -1.21963092  -1.09628766]
mat_Sqrt:  [[ 9.88993366  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01698847  0.028078    0.16532562]
Stock Position:  -0.016988473254716904
Bond Position:  [14.85842381]


portfolio before change:  [13.14717302]
curr_Stock_Price:  100.83944460676234
curr_Factors:  [100.83944461  -1.11191444  -1.0976866 ]
mat_Sqrt:  [[11.06656668  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00372922 -0.02383942  0.22728341]
Stock Position:  0.0037292165222308563
Bond Position:  [12.7711209]


portfolio before change:  [13.14963865]
curr_Stock_Price:  101.07250643094369
curr_Factors:  [101.07250643  -0.96813694  -1.0969717 ]
mat_Sqrt:  [[12.81645004  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00859992  0.01905287  0.05052239]
Stock Position:  -0.0085999164612781
Bond Position:  [14.01885376]


portfolio before change:  [13.14865461]
curr_Stock_Price:  101.39070829928043
curr_Factors:  [101.3907083   -0.73557723  -1.06791564]
mat_Sqrt:  [[16.70133384  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00256775  0.02328151  0.08378082]
Stock Position:  -0.002567747726551622
Bond Position:  [13.40900037]


portfolio before change:  [13.15069147]
curr_Stock_Price:  101.2502586447854
curr_Factors:  [101.25025864  -0.64059328  -1.04851353]
mat_Sqrt:  [[18.69934416  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00165002 -0.02937092 -0.36830136]
Stock Position:  0.0016500171352006147
Bond Position:  [12.98362681]


portfolio before change:  [13.15169047]
curr_Stock_Price:  100.87204451504796
curr_Factors:  [100.87204452  -0.68064942  -1.05419789]
mat_Sqrt:  [[17.79656607  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00090929 -0.00180355 -0.3281274 ]
Stock Position:  -0.0009092852059496274
Bond Position:  [13.24341193]


portfolio before change:  [13.1547756]
curr_Stock_Price:  99.29981428494378
curr_Factors:  [99.29981428 -0.88753978 -1.05769546]
mat_Sqrt:  [[14.19526511  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00339897 0.03176828 0.05565331]
Stock Position:  0.003398966218993999
Bond Position:  [12.81725889]


portfolio before change:  [13.15847573]
curr_Stock_Price:  99.91702283130967
curr_Factors:  [99.91702283 -1.17005546 -1.04425824]
mat_Sqrt:  [[10.91378173  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-1.38637832e-04 -1.96668322e-02 -2.51700563e-01]
Stock Position:  -0.00013863783176485753
Bond Position:  [13.17232801]


portfolio before change:  [13.16016091]
curr_Stock_Price:  99.63910374221622
curr_Factors:  [99.63910374 -1.18735075 -1.02875149]
mat_Sqrt:  [[10.86397692  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01982557 -0.09299551 -0.70388802]
Stock Position:  0.0198255746672593
Bond Position:  [11.18475842]


portfolio before change:  [13.14864901]
curr_Stock_Price:  98.98792066148881
curr_Factors:  [98.98792066 -0.77093428 -1.01126735]
mat_Sqrt:  [[16.6564279   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00294871 -0.02612283  0.00147546]
Stock Position:  -0.0029487082634569372
Bond Position:  [13.44053551]


portfolio before change:  [13.14728213]
curr_Stock_Price:  100.02127262661453
curr_Factors:  [100.02127263  -0.58460862  -1.00948682]
mat_Sqrt:  [[20.31353575  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00900442  0.0483423   0.06954643]
Stock Position:  -0.009004424130203002
Bond Position:  [14.04791609]


portfolio before change:  [13.13971224]
curr_Stock_Price:  101.05698391362816
curr_Factors:  [101.05698391  -0.72750192  -1.04823804]
mat_Sqrt:  [[17.11481722  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00304639 -0.05218142 -0.39574898]
Stock Position:  0.0030463916618402374
Bond Position:  [12.83185309]


portfolio before change:  [13.14478946]
curr_Stock_Price:  102.1970652894081
curr_Factors:  [102.19706529  -0.75326215  -1.03667459]
mat_Sqrt:  [[17.06391893  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00900307 -0.07460485  0.04843547]
Stock Position:  -0.009003068920883825
Bond Position:  [14.06487668]


portfolio before change:  [13.14621736]
curr_Stock_Price:  102.23375472008827
curr_Factors:  [102.23375472  -1.01316964  -1.0489755 ]
mat_Sqrt:  [[13.00217649  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00294607 -0.00429914 -0.00659095]
Stock Position:  -0.0029460667535711467
Bond Position:  [13.44740483]


portfolio before change:  [13.14802427]
curr_Stock_Price:  102.19102630531019
curr_Factors:  [102.19102631  -0.93880164  -1.03618953]
mat_Sqrt:  [[14.18028616  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00330312  0.03054516 -0.05731557]
Stock Position:  -0.0033031184049085688
Bond Position:  [13.48557333]


portfolio before change:  [13.14770641]
curr_Stock_Price:  102.79762541118158
curr_Factors:  [102.79762541  -1.45468585  -1.0297632 ]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [13.14770641]
Stock Price:  103.12778853020596
PL:  [10.01991788]
Settle:  Tensor("sub_64:0", shape=(), dtype=float64)
PL:  Tensor("sub_65:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  33
output_Z_Vals[:, i, :]:  [[ 1.19260232e+02 -2.92559343e+01 -2.92733494e+01]
 [ 4.27249708e-02  5.62148934e-02 -6.73686823e-02]
 [-6.10281102e-02 -6.21690344e-03  9.56030052e-02]
 [-5.67707097e-02  1.18213084e-01  1.14589135e-02]
 [-1.13102126e-01  8.96241459e-02 -7.86912960e-02]
 [-3.07005686e-02  2.93428805e-02  1.53135496e-01]
 [-3.77813297e-02 -8.28732994e-02  2.40840680e-01]
 [-6.10632713e-02 -7.78523878e-02 -2.30159833e-02]
 [ 1.26647491e-01 -8.16721132e-02 -2.10470349e-01]
 [-1.58244645e-01 -1.79394676e-01 -5.83552915e-02]
 [ 1.64761757e-01  9.29512113e-02  1.44641879e-01]
 [-2.39664111e-01 -1.12290296e-01  6.65770646e-02]
 [ 1.67824696e-02 -1.11562463e-01  1.02392900e-01]
 [-9.62623594e-02 -1.14884369e-01  6.32126881e-02]
 [ 2.16400037e-01  2.47319376e-01  7.61052405e-03]
 [-6.78478240e-02 -3.31708215e-01 -7.41376441e-02]
 [-6.75577681e-02 -6.51200679e-02 -4.47344385e-02]
 [-8.18467308e-02  6.29559330e-02  9.21518344e-02]
 [ 9.46931603e-02  6.04670367e-02  9.93602653e-02]
 [ 1.60487032e-01 -4.44343196e-02  1.06462966e-02]
 [-3.57613851e-02 -2.18695194e-02 -6.95856154e-03]
 [ 9.32819005e-02 -6.36468693e-02  9.02542395e-02]
 [-6.89135632e-02  6.76922170e-02  3.22312616e-01]
 [ 1.77476536e-02 -1.80967576e-02 -7.29443144e-02]
 [ 7.09512047e-02  2.46296908e-02  1.08891190e-01]
 [ 1.15879331e-02 -9.28621413e-02  8.46218975e-02]
 [-3.79697811e-02  5.03613622e-02 -2.64071904e-02]
 [-5.07806065e-02  7.36225950e-02  2.93687317e-02]
 [-2.83008574e-02 -3.68620280e-02  1.87923365e-02]
 [ 1.91129040e-02  1.25284951e-03 -1.22447066e-01]
 [-2.30897211e-02  2.79088841e-01  1.19827215e-02]
 [ 1.67263497e-02 -8.48082268e-02 -8.95501234e-02]
 [ 1.19243342e-01 -5.57615668e-02  6.12320540e-02]
 [-5.02131539e-02 -8.56589933e-02 -8.08117438e-03]
 [-1.67397314e-01  1.23967514e-01  2.95416556e-02]
 [ 8.47165236e-02 -1.65012150e-01 -1.38726811e-01]
 [-1.46017707e-01 -2.47922457e-01  2.13550299e-02]
 [-3.92087856e-02 -1.65076917e-02  5.79206934e-03]
 [-4.03094316e-02  8.62690785e-02 -2.31802257e-02]
 [ 7.29821972e-02 -2.42915849e-03 -6.18921288e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.26023247 -29.25593426 -29.27334937]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  8.31486419  -9.25153874 -83.50871763]
init_Out:  [2.49911038]
Stock Position:  8.31486419409362
Bond position:  [-828.98730903]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-1.54364227]
curr_Stock_Price:  99.526255310398
curr_Factors:  [99.52625531 -1.05977174 -1.01022011]
mat_Sqrt:  [[12.55890067  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00242257  0.01777671 -0.1921841 ]
Stock Position:  0.0024225733740761107
Bond Position:  [-1.78475192]


portfolio before change:  [-1.54539757]
curr_Stock_Price:  98.89379052065843
curr_Factors:  [98.89379052 -0.80650582 -0.97974834]
mat_Sqrt:  [[16.5732889   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00251451 -0.00196596  0.27272876]
Stock Position:  -0.00251451287026446
Bond Position:  [-1.29672786]


portfolio before change:  [-1.54530659]
curr_Stock_Price:  98.79314481891912
curr_Factors:  [98.79314482 -0.99355288 -0.99253831]
mat_Sqrt:  [[13.55746108  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00378975  0.03738226  0.03268909]
Stock Position:  -0.0037897523574547095
Bond Position:  [-1.17090504]


portfolio before change:  [-1.53846104]
curr_Stock_Price:  96.94818887577466
curr_Factors:  [96.94818888 -0.72131706 -0.97334272]
mat_Sqrt:  [[17.80566956  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00712418  0.02834164 -0.22448436]
Stock Position:  -0.007124182179882229
Bond Position:  [-0.84778448]


portfolio before change:  [-1.52380672]
curr_Stock_Price:  94.87633061338039
curr_Factors:  [94.87633061 -0.4427132  -0.96674893]
mat_Sqrt:  [[23.17588113  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [5.67708062e-05 9.27903353e-03 4.36852944e-01]
Stock Position:  5.677080623185756e-05
Bond Position:  [-1.52919293]


portfolio before change:  [-1.5240094]
curr_Stock_Price:  94.67340428124041
curr_Factors:  [94.67340428 -0.59082041 -0.96744916]
mat_Sqrt:  [[19.92875271  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 4.63666187e-04 -2.62068383e-02  6.87051422e-01]
Stock Position:  0.0004636661867879774
Bond Position:  [-1.56790626]


portfolio before change:  [-1.52453147]
curr_Stock_Price:  93.97016567411485
curr_Factors:  [93.97016567 -0.48078788 -0.9612543 ]
mat_Sqrt:  [[22.21871994  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0030502  -0.02461909 -0.06565819]
Stock Position:  -0.0030501995361125757
Bond Position:  [-1.23790372]


portfolio before change:  [-1.52465827]
curr_Stock_Price:  93.96100229460663
curr_Factors:  [93.96100229 -0.51596648 -0.99680975]
mat_Sqrt:  [[20.69937693  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00394102 -0.02582699 -0.60041332]
Stock Position:  0.003941019386768747
Bond Position:  [-1.8949604]


portfolio before change:  [-1.5194263]
curr_Stock_Price:  95.34867853691073
curr_Factors:  [95.34867854 -0.65259003 -1.01827421]
mat_Sqrt:  [[17.93360321  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00974641 -0.05672958 -0.1664714 ]
Stock Position:  -0.009746413896042489
Bond Position:  [-0.59011861]


portfolio before change:  [-1.52692614]
curr_Stock_Price:  96.11060696196581
curr_Factors:  [96.11060696 -0.40481032 -1.04096697]
mat_Sqrt:  [[22.64009369  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00868754 0.02939375 0.41262302]
Stock Position:  0.008687536792874383
Bond Position:  [-2.36189057]


portfolio before change:  [-1.53576274]
curr_Stock_Price:  95.12743458861569
curr_Factors:  [95.12743459 -0.28936333 -1.03336127]
mat_Sqrt:  [[25.34275289  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00903507 -0.03550931  0.18992583]
Stock Position:  -0.0090350661175278
Bond Position:  [-0.67628008]


portfolio before change:  [-1.53703092]
curr_Stock_Price:  95.25844023796033
curr_Factors:  [95.25844024 -0.19584176 -1.02639002]
mat_Sqrt:  [[28.0604706   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00124028 -0.03527915  0.29209844]
Stock Position:  0.0012402786453909259
Bond Position:  [-1.65517793]


portfolio before change:  [-1.5333171]
curr_Stock_Price:  98.4196097484189
curr_Factors:  [98.41960975 -0.69582397 -1.04006886]
mat_Sqrt:  [[17.34574513  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00497675 -0.03632963  0.1803282 ]
Stock Position:  -0.004976749313148149
Bond Position:  [-1.04350738]


portfolio before change:  [-1.53550578]
curr_Stock_Price:  98.83318002957856
curr_Factors:  [98.83318003 -0.63792308 -1.0448287 ]
mat_Sqrt:  [[18.36931469  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01221272 0.07820925 0.02171071]
Stock Position:  0.012212719501281437
Bond Position:  [-2.74252769]


portfolio before change:  [-1.54162721]
curr_Stock_Price:  98.36001857288973
curr_Factors:  [98.36001857 -0.68998418 -1.03919921]
mat_Sqrt:  [[17.45194337  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00524559 -0.10489535 -0.21149406]
Stock Position:  -0.005245592115892858
Bond Position:  [-1.02567067]


portfolio before change:  [-1.543745]
curr_Stock_Price:  98.7393038895405
curr_Factors:  [98.73930389 -0.87966274 -1.02280179]
mat_Sqrt:  [[14.73194921  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00531977 -0.02059277 -0.1276149 ]
Stock Position:  -0.005319767194147884
Bond Position:  [-1.01847489]


portfolio before change:  [-1.55233632]
curr_Stock_Price:  100.33035181352257
curr_Factors:  [100.33035181  -0.8751345   -1.02266244]
mat_Sqrt:  [[15.03936842  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00408334  0.01990841  0.26288353]
Stock Position:  -0.004083336441454104
Bond Position:  [-1.14265374]


portfolio before change:  [-1.55195421]
curr_Stock_Price:  100.20179219084031
curr_Factors:  [100.20179219  -0.87230977  -1.01489902]
mat_Sqrt:  [[15.17997744  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00767697 0.01912136 0.28344718]
Stock Position:  0.007676970679742453
Bond Position:  [-2.32120043]


portfolio before change:  [-1.55129462]
curr_Stock_Price:  100.325507730485
curr_Factors:  [100.32550773  -0.69522924  -1.01918324]
mat_Sqrt:  [[18.06556231  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00894038 -0.01405137  0.03037092]
Stock Position:  0.008940375421904035
Bond Position:  [-2.44824232]


portfolio before change:  [-1.56114504]
curr_Stock_Price:  99.25794923517084
curr_Factors:  [99.25794924 -0.62217793 -1.02802071]
mat_Sqrt:  [[19.05869391  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00198054 -0.00691575 -0.01985084]
Stock Position:  -0.0019805378175842357
Bond Position:  [-1.36456092]


portfolio before change:  [-1.56303546]
curr_Stock_Price:  100.12631864028778
curr_Factors:  [100.12631864  -0.74427707  -1.02661873]
mat_Sqrt:  [[17.03954416  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00645919 -0.02012691  0.25747022]
Stock Position:  0.00645918774935955
Bond Position:  [-2.20977015]


portfolio before change:  [-1.56669358]
curr_Stock_Price:  99.60274189816589
curr_Factors:  [99.6027419  -0.47330914 -1.02813764]
mat_Sqrt:  [[22.19224513  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-6.19121874e-05  2.14061585e-02  9.19468179e-01]
Stock Position:  -6.191218743928997e-05
Bond Position:  [-1.56052696]


portfolio before change:  [-1.56687628]
curr_Stock_Price:  99.40278430397153
curr_Factors:  [99.4027843  -0.15091656 -1.06950833]
mat_Sqrt:  [[29.33423414  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 8.14986844e-05 -5.72269722e-03 -2.08089825e-01]
Stock Position:  8.149868436300219e-05
Bond Position:  [-1.57497748]


portfolio before change:  [-1.56694086]
curr_Stock_Price:  101.02617092022506
curr_Factors:  [101.02617092  -0.26943967  -1.06067195]
mat_Sqrt:  [[26.7161428   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00351153 0.00778859 0.31063626]
Stock Position:  0.0035115271857337196
Bond Position:  [-1.92169701]


portfolio before change:  [-1.57121211]
curr_Stock_Price:  99.87823008095779
curr_Factors:  [99.87823008 -0.29506517 -1.07554924]
mat_Sqrt:  [[25.36416471  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00104335 -0.02936559  0.24140272]
Stock Position:  0.0010433466143704338
Bond Position:  [-1.67541973]


portfolio before change:  [-1.57102806]
curr_Stock_Price:  100.25537124300459
curr_Factors:  [100.25537124  -0.30543609  -1.09713375]
mat_Sqrt:  [[24.65921851  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00170564  0.01592566 -0.07533236]
Stock Position:  -0.0017056421090238451
Bond Position:  [-1.40002828]


portfolio before change:  [-1.5683107]
curr_Stock_Price:  98.55959966064441
curr_Factors:  [98.55959966 -0.29838516 -1.08322909]
mat_Sqrt:  [[24.75548766  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00173234  0.02328151  0.08378082]
Stock Position:  -0.0017323355774879904
Bond Position:  [-1.3975724]


portfolio before change:  [-1.56886477]
curr_Stock_Price:  98.77859036855274
curr_Factors:  [98.77859037 -0.3282851  -1.10986027]
mat_Sqrt:  [[23.44683496  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00108401 -0.0116568   0.05360931]
Stock Position:  -0.00108401245967814
Bond Position:  [-1.46178755]


portfolio before change:  [-1.57017378]
curr_Stock_Price:  99.81757265792675
curr_Factors:  [99.81757266 -0.2710259  -1.10437354]
mat_Sqrt:  [[25.22775572  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-2.31853764e-04  3.96185801e-04 -3.49307395e-01]
Stock Position:  -0.0002318537638947469
Bond Position:  [-1.5470307]


portfolio before change:  [-1.57055643]
curr_Stock_Price:  100.6338576549508
curr_Factors:  [100.63385765  -0.19805601  -1.12047093]
mat_Sqrt:  [[26.92248511  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00049913  0.08825564  0.03418337]
Stock Position:  -0.0004991261179585713
Bond Position:  [-1.52032744]


portfolio before change:  [-1.57075684]
curr_Stock_Price:  100.65461057439056
curr_Factors:  [100.65461057  -0.28705837  -1.12970228]
mat_Sqrt:  [[24.40857037  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-1.53336786e-04 -2.68187161e-02 -2.55461576e-01]
Stock Position:  -0.00015333678608349464
Bond Position:  [-1.55532278]


portfolio before change:  [-1.571156]
curr_Stock_Price:  101.98982872723992
curr_Factors:  [101.98982873  -0.48238054  -1.13912907]
mat_Sqrt:  [[20.15320798  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0064656  -0.01763336  0.17467801]
Stock Position:  0.006465597211888196
Bond Position:  [-2.23058115]


portfolio before change:  [-1.58017208]
curr_Stock_Price:  100.63848561388045
curr_Factors:  [100.63848561  -0.78478993  -1.12832193]
mat_Sqrt:  [[14.85628316  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00363984 -0.02708775 -0.02305334]
Stock Position:  -0.0036398352045986337
Bond Position:  [-1.21386458]


portfolio before change:  [-1.58312396]
curr_Stock_Price:  101.40778911096382
curr_Factors:  [101.40778911  -0.76053121  -1.15954195]
mat_Sqrt:  [[14.86600027  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01063947  0.03920197  0.08427412]
Stock Position:  -0.01063946714023755
Bond Position:  [-0.50419912]


portfolio before change:  [-1.59093281]
curr_Stock_Price:  102.1358159127093
curr_Factors:  [102.13581591  -0.98908858  -1.14943732]
mat_Sqrt:  [[12.03450044  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00433241 -0.05218142 -0.39574898]
Stock Position:  0.004332413858725324
Bond Position:  [-2.03342743]


portfolio before change:  [-1.59344079]
curr_Stock_Price:  101.6156007669695
curr_Factors:  [101.61560077  -1.0347916   -1.14713173]
mat_Sqrt:  [[11.46471141  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01291441 -0.07839996  0.06091996]
Stock Position:  -0.012914407985189011
Bond Position:  [-0.28113547]


portfolio before change:  [-1.60042225]
curr_Stock_Price:  102.1534740057896
curr_Factors:  [102.15347401  -0.85172729  -1.15328857]
mat_Sqrt:  [[13.75579889  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00279538 -0.00522019  0.01652316]
Stock Position:  -0.0027953818951555204
Bond Position:  [-1.31486428]


portfolio before change:  [-1.60406881]
curr_Stock_Price:  103.3991692862044
curr_Factors:  [103.39916929  -0.942721    -1.16711875]
mat_Sqrt:  [[12.53791396  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00341473  0.02728068 -0.06612673]
Stock Position:  -0.003414732102015285
Bond Position:  [-1.25098835]


portfolio before change:  [-1.60643969]
curr_Stock_Price:  104.04768087119183
curr_Factors:  [104.04768087  -0.97789574  -1.19859989]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-1.60643969]
Stock Price:  103.90588231696168
PL:  [-5.51232201]
Settle:  Tensor("sub_66:0", shape=(), dtype=float64)
PL:  Tensor("sub_67:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  34
output_Z_Vals[:, i, :]:  [[ 1.19260232e+02 -2.92559343e+01 -2.92733494e+01]
 [-1.00166900e-03 -7.67390036e-02 -2.82831559e-02]
 [-6.09668667e-02 -1.00437705e-01 -1.03806050e-01]
 [ 8.28480247e-02  1.51042701e-01  3.76990991e-02]
 [ 8.96149698e-02  1.34003319e-02 -6.80930957e-02]
 [ 6.44234299e-02  2.92309758e-02 -8.62591325e-03]
 [ 6.07903771e-02  3.39301793e-02 -5.06103424e-02]
 [-5.93915744e-02  1.76155380e-02 -6.74560175e-02]
 [ 9.12222136e-02 -3.34246296e-02 -1.06263420e-01]
 [-7.96783078e-02 -1.30595006e-01 -1.24491304e-01]
 [ 5.79611436e-02  1.48022167e-01 -8.49404726e-02]
 [-3.23681608e-02  1.06451771e-02 -5.31519592e-03]
 [-1.01424780e-01  1.19714864e-02 -4.46646290e-02]
 [-4.79661712e-02 -8.35632949e-02  9.34900552e-02]
 [ 2.01665911e-01  2.02815618e-01 -2.38875526e-02]
 [-7.37486846e-02 -3.76429303e-01 -7.30456146e-02]
 [-6.68835432e-02 -1.05557402e-02 -4.15135544e-02]
 [-1.39204142e-02  1.20949906e-01 -6.46326061e-03]
 [ 6.14510841e-02  4.25178803e-02  2.16285419e-02]
 [-2.50688561e-02 -4.42896249e-03  8.70217292e-02]
 [ 8.14399007e-02 -9.89310102e-02  5.63878540e-02]
 [ 1.21790267e-01  1.81580851e-02  2.44292946e-01]
 [-5.14923956e-02  7.26177507e-03  2.86959652e-01]
 [-6.88378747e-02 -5.60006962e-04 -8.19380488e-02]
 [-4.07071950e-01  1.27912046e-01  7.65129950e-02]
 [-8.45130398e-02 -2.00734050e-01  1.15415724e-01]
 [ 1.82458069e-01  5.71592161e-02 -1.26602571e-01]
 [ 1.82213324e-02  8.03074560e-03  8.89463592e-03]
 [-1.08002136e-01 -1.23869042e-01 -1.42922131e-01]
 [ 8.04487966e-02  9.33563548e-02 -5.60010416e-02]
 [ 7.18924564e-02 -3.48735673e-02  5.38498782e-02]
 [ 8.24496287e-02 -9.50041685e-02 -7.24604430e-02]
 [ 4.11272012e-01 -4.49689583e-01 -4.30228659e-01]
 [-4.61626414e-02 -8.17046379e-02  3.06177511e-03]
 [-1.54295091e-01 -3.29374174e-02  1.93903734e-02]
 [ 1.11935503e-01 -7.09219032e-02 -4.18465691e-02]
 [ 2.31230290e-02  2.44979938e-02 -9.50205585e-02]
 [-1.51377220e-02  2.68227472e-02 -6.66031002e-02]
 [ 4.66193202e-02 -1.09495642e-01 -4.04344138e-03]
 [-8.48943552e-01  4.23072238e-01  5.18128869e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.26023247 -29.25593426 -29.27334937]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  8.31486419  -9.25153874 -83.50871763]
init_Out:  [2.49911038]
Stock Position:  8.31486419409362
Bond position:  [-828.98730903]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [3.33214585]
curr_Stock_Price:  100.11264950819022
curr_Factors:  [100.11264951  -0.77617813  -0.99435714]
mat_Sqrt:  [[17.04336152  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00051377 -0.024267   -0.08068397]
Stock Position:  -0.0005137681653652567
Bond Position:  [3.38358054]


portfolio before change:  [3.33240282]
curr_Stock_Price:  100.43576136849627
curr_Factors:  [100.43576137  -0.81658726  -1.00883522]
mat_Sqrt:  [[16.18517755  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00523624 -0.03176119 -0.29612977]
Stock Position:  -0.0052362402633436755
Bond Position:  [3.8583086]


portfolio before change:  [3.33263998]
curr_Stock_Price:  100.48258190761558
curr_Factors:  [100.48258191  -0.90579516  -1.03824773]
mat_Sqrt:  [[14.38148352  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.006567   0.0477639  0.10754504]
Stock Position:  0.006567001708977349
Bond Position:  [2.67277069]


portfolio before change:  [3.32654405]
curr_Stock_Price:  99.50343787628695
curr_Factors:  [99.50343788 -0.82415625 -1.01702355]
mat_Sqrt:  [[15.78424665  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00481882  0.00423756 -0.19425065]
Stock Position:  0.004818824844168995
Bond Position:  [2.84705442]


portfolio before change:  [3.32301632]
curr_Stock_Price:  98.69750736195944
curr_Factors:  [98.69750736 -0.88171244 -1.01481981]
mat_Sqrt:  [[14.81332981  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0042811   0.00924365 -0.02460733]
Stock Position:  0.0042811045228716175
Bond Position:  [2.90048197]


portfolio before change:  [3.31927084]
curr_Stock_Price:  97.73792767290517
curr_Factors:  [97.73792767 -0.80939969 -0.99973254]
mat_Sqrt:  [[16.00910238  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00320665  0.01072966 -0.14437722]
Stock Position:  0.003206654341672236
Bond Position:  [3.00585909]


portfolio before change:  [3.31863852]
curr_Stock_Price:  97.42355629515602
curr_Factors:  [97.4235563  -0.97724464 -0.98668928]
mat_Sqrt:  [[13.66904943  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00531903  0.00557052 -0.19243324]
Stock Position:  -0.005319034469735135
Bond Position:  [3.83683777]


portfolio before change:  [3.31944999]
curr_Stock_Price:  97.36116854629653
curr_Factors:  [97.36116855 -0.84988611 -0.97717328]
mat_Sqrt:  [[15.66404662  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00438381 -0.0105698  -0.30313996]
Stock Position:  0.004383813788709587
Bond Position:  [2.89263676]


portfolio before change:  [3.32046014]
curr_Stock_Price:  97.50910842869364
curr_Factors:  [97.50910843 -0.55984346 -0.98529179]
mat_Sqrt:  [[20.79703741  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00521526 -0.04129777 -0.35513904]
Stock Position:  -0.005215259036793473
Bond Position:  [3.8289954]


portfolio before change:  [3.3090801]
curr_Stock_Price:  99.78295450456305
curr_Factors:  [99.7829545  -0.61413025 -0.98723339]
mat_Sqrt:  [[20.1183782   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00220916  0.04680872 -0.24231153]
Stock Position:  0.0022091571067712258
Bond Position:  [3.08864387]


portfolio before change:  [3.31105552]
curr_Stock_Price:  100.50237807199062
curr_Factors:  [100.50237807  -0.51388662  -1.01300504]
mat_Sqrt:  [[21.83009962  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00151984  0.0033663  -0.01516277]
Stock Position:  -0.0015198402154040832
Bond Position:  [3.46380308]


portfolio before change:  [3.31240845]
curr_Stock_Price:  99.89709766514719
curr_Factors:  [99.89709767 -0.67267772 -1.01814762]
mat_Sqrt:  [[18.41775774  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00598514  0.00378572 -0.12741575]
Stock Position:  -0.005985137171326979
Bond Position:  [3.91030628]


portfolio before change:  [3.3111125]
curr_Stock_Price:  100.19529767289742
curr_Factors:  [100.19529767  -0.50771921  -1.03334229]
mat_Sqrt:  [[21.45718931  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00144661 -0.02642503  0.2667011 ]
Stock Position:  -0.001446610183133317
Bond Position:  [3.45605604]


portfolio before change:  [3.31352863]
curr_Stock_Price:  98.82375403042623
curr_Factors:  [98.82375403 -0.51163129 -1.05935087]
mat_Sqrt:  [[20.5396229   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00983594  0.06413593 -0.06814454]
Stock Position:  0.00983594306830435
Bond Position:  [2.34150381]


portfolio before change:  [3.30781618]
curr_Stock_Price:  98.2132224958442
curr_Factors:  [98.2132225  -0.43188738 -1.05249662]
mat_Sqrt:  [[22.2592323   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00441967 -0.1190374  -0.20837881]
Stock Position:  -0.004419668197184448
Bond Position:  [3.74188603]


portfolio before change:  [3.31705977]
curr_Stock_Price:  96.22759259876884
curr_Factors:  [96.2275926  -0.60244327 -1.05191247]
mat_Sqrt:  [[18.40017899  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00411029 -0.00333802 -0.11842662]
Stock Position:  -0.004110286650634862
Bond Position:  [3.71258276]


portfolio before change:  [3.31296139]
curr_Stock_Price:  97.33760698674902
curr_Factors:  [97.33760699 -0.46168344 -1.03358759]
mat_Sqrt:  [[21.82190738  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00055526  0.03824772 -0.01843788]
Stock Position:  -0.0005552589156763562
Bond Position:  [3.36700897]


portfolio before change:  [3.31323018]
curr_Stock_Price:  97.61155478760882
curr_Factors:  [97.61155479 -0.40238469 -1.05101359]
mat_Sqrt:  [[22.81909288  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00293455 0.01344533 0.06170021]
Stock Position:  0.0029345512979799654
Bond Position:  [3.02678407]


portfolio before change:  [3.31441469]
curr_Stock_Price:  97.88625954471303
curr_Factors:  [97.88625954 -0.42789503 -1.0326607 ]
mat_Sqrt:  [[22.72011067  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00032658 -0.00140056  0.24824877]
Stock Position:  -0.0003265818303736892
Bond Position:  [3.34638256]


portfolio before change:  [3.31535148]
curr_Stock_Price:  96.2987080307539
curr_Factors:  [96.29870803 -0.60813896 -1.02145592]
mat_Sqrt:  [[18.87541016  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00478907 -0.03128473  0.16085885]
Stock Position:  0.004789068671954168
Bond Position:  [2.85417035]


portfolio before change:  [3.319237]
curr_Stock_Price:  97.03553642311695
curr_Factors:  [97.03553642 -0.90087513 -1.04531684]
mat_Sqrt:  [[13.85831338  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01242036 0.00574209 0.69689978]
Stock Position:  0.012420356730840321
Bond Position:  [2.11402102]


portfolio before change:  [3.31959424]
curr_Stock_Price:  97.04302240800226
curr_Factors:  [97.04302241 -0.55785021 -1.06879061]
mat_Sqrt:  [[19.07757568  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [3.81101683e-04 2.29637491e-03 8.18616012e-01]
Stock Position:  0.0003811016827935448
Bond Position:  [3.28261098]


portfolio before change:  [3.32021926]
curr_Stock_Price:  97.60629020538848
curr_Factors:  [97.60629021 -0.70271392 -1.07307659]
mat_Sqrt:  [[16.52957884  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-5.17725642e-03 -1.77089751e-04 -2.33746446e-01]
Stock Position:  -0.005177256423399848
Bond Position:  [3.82555205]


portfolio before change:  [3.32312076]
curr_Stock_Price:  97.13822829048503
curr_Factors:  [97.13822829 -0.74612298 -1.10314851]
mat_Sqrt:  [[15.2848708   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02539447  0.04044934  0.21827028]
Stock Position:  -0.025394465569299685
Bond Position:  [5.78989415]


portfolio before change:  [3.3342336]
curr_Stock_Price:  96.72912102827443
curr_Factors:  [96.72912103 -0.70568815 -1.08583267]
mat_Sqrt:  [[16.12536805  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00410142 -0.06347768  0.32924893]
Stock Position:  -0.004101415514609016
Bond Position:  [3.73095992]


portfolio before change:  [3.33386242]
curr_Stock_Price:  96.93333743905981
curr_Factors:  [96.93333744 -0.92962421 -1.07507097]
mat_Sqrt:  [[13.05705127  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01210773  0.01807533 -0.36116189]
Stock Position:  0.012107731606017646
Bond Position:  [2.16021959]


portfolio before change:  [3.33452487]
curr_Stock_Price:  96.96574660587116
curr_Factors:  [96.96574661 -1.078295   -1.05825485]
mat_Sqrt:  [[11.44791872  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00176838 0.00253954 0.02537392]
Stock Position:  0.001768382171594199
Bond Position:  [3.16305237]


portfolio before change:  [3.33415778]
curr_Stock_Price:  96.53456491844968
curr_Factors:  [96.53456492 -1.23292161 -1.03001873]
mat_Sqrt:  [[10.04385286  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01397614 -0.03917083 -0.40771706]
Stock Position:  -0.013976138552884994
Bond Position:  [4.68333824]


portfolio before change:  [3.3381882]
curr_Stock_Price:  96.28807622365653
curr_Factors:  [96.28807622 -1.15261453 -1.04526426]
mat_Sqrt:  [[10.69167823  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00668072  0.02952187 -0.15975538]
Stock Position:  0.006680717563704749
Bond Position:  [2.69491475]


portfolio before change:  [3.33916639]
curr_Stock_Price:  96.38406981973125
curr_Factors:  [96.38406982 -1.18137447 -1.05969469]
mat_Sqrt:  [[10.24993929  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00799849 -0.01102799  0.15361871]
Stock Position:  0.007998494696547896
Bond Position:  [2.56823892]


portfolio before change:  [3.33472133]
curr_Stock_Price:  95.78819432858747
curr_Factors:  [95.78819433 -1.08543921 -1.05994556]
mat_Sqrt:  [[11.20942198  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00581704 -0.03004296 -0.20670947]
Stock Position:  0.0058170444209897365
Bond Position:  [2.77751715]


portfolio before change:  [3.33589314]
curr_Stock_Price:  95.92994926698627
curr_Factors:  [95.92994927 -1.22761948 -1.03281589]
mat_Sqrt:  [[10.00597947  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.03116547 -0.14220433 -1.22732261]
Stock Position:  0.031165466630804075
Bond Position:  [0.3461915]


portfolio before change:  [3.34563353]
curr_Stock_Price:  96.2410987718553
curr_Factors:  [96.24109877 -1.20894477 -1.05827373]
mat_Sqrt:  [[ 9.97057239  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00477879 -0.02583728  0.00873439]
Stock Position:  -0.004778789216664055
Bond Position:  [3.80554946]


portfolio before change:  [3.34825674]
curr_Stock_Price:  95.79172004779343
curr_Factors:  [95.79172005 -1.03596955 -1.06537234]
mat_Sqrt:  [[11.71458161  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01290592 -0.01041573  0.05531534]
Stock Position:  -0.012905922985160814
Bond Position:  [4.5845373]


portfolio before change:  [3.34458444]
curr_Stock_Price:  96.12067040055044
curr_Factors:  [96.1206704  -0.93734283 -1.06039028]
mat_Sqrt:  [[13.03804051  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0077897  -0.02242747 -0.11937661]
Stock Position:  0.007789699120210275
Bond Position:  [2.59583333]


portfolio before change:  [3.344559]
curr_Stock_Price:  96.07574722852846
curr_Factors:  [96.07574723 -0.81572495 -1.05966003]
mat_Sqrt:  [[14.72802194  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00029601  0.00774695 -0.2710672 ]
Stock Position:  0.0002960054108960232
Bond Position:  [3.31612006]


portfolio before change:  [3.34500392]
curr_Stock_Price:  96.17838259447852
curr_Factors:  [96.17838259 -0.83756001 -1.04298261]
mat_Sqrt:  [[14.66790831  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00191169  0.0084821  -0.19000011]
Stock Position:  -0.001911687878630902
Bond Position:  [3.52886697]


portfolio before change:  [3.34451607]
curr_Stock_Price:  96.66433299073236
curr_Factors:  [96.66433299 -1.10948047 -1.06029006]
mat_Sqrt:  [[11.03943612  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00389212 -0.03462556 -0.01153481]
Stock Position:  0.0038921182556476523
Bond Position:  [2.96828705]


portfolio before change:  [3.34570362]
curr_Stock_Price:  96.87411306548812
curr_Factors:  [96.87411307 -0.86969529 -1.04462959]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [3.34570362]
Stock Price:  96.89957040865576
PL:  [3.34570362]
Settle:  Tensor("sub_68:0", shape=(), dtype=float64)
PL:  Tensor("sub_69:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  35
output_Z_Vals[:, i, :]:  [[ 1.19260232e+02 -2.92559343e+01 -2.92733494e+01]
 [ 4.03706775e-03 -1.27034308e-01 -3.91946428e-02]
 [-5.16703345e-02  1.14525046e-02  1.01885834e-01]
 [-5.69640074e-02  1.20730218e-01  1.14033580e-02]
 [ 7.66394782e-02  1.72289802e-02 -6.69618812e-02]
 [ 5.86727592e-02  2.87704696e-02  2.98028487e-02]
 [ 7.57123442e-02  1.36979718e-02 -6.95080641e-02]
 [-9.37485935e-02 -7.53200803e-03 -1.00464144e-01]
 [-6.16663412e-02 -6.25412947e-02  3.44074877e-02]
 [-1.06626815e-01 -1.45278623e-01 -1.23881501e-01]
 [ 6.91941261e-02  1.15097505e-01 -9.42507320e-02]
 [-9.69283319e-02 -7.28303804e-02  9.92364391e-03]
 [-1.06750692e-01  3.82628227e-02 -4.86603953e-02]
 [-9.62623594e-02 -1.14884369e-01  6.32126881e-02]
 [ 2.63433882e-01  3.00952379e-01  7.53207213e-03]
 [-4.75431344e-02 -5.17123232e-01 -3.79936525e-02]
 [-6.72463365e-02 -5.58924498e-02 -4.12207929e-02]
 [-7.78629469e-02  1.76374411e-01  1.28880548e-01]
 [ 5.02543424e-02  5.57781537e-02  2.59818566e-02]
 [-3.82054299e-02 -1.20584178e-02  1.05881933e-01]
 [ 7.88106049e-02 -9.75591806e-02  5.57723337e-02]
 [ 1.19906621e-01  4.84644291e-02  2.61323277e-01]
 [-2.43209225e-02 -8.36326875e-02  2.02475372e-01]
 [-6.93836774e-02 -5.47018913e-04 -8.17790168e-02]
 [-5.16510940e-01  1.53597460e-01  6.22211151e-02]
 [-1.08308823e-01 -2.27311321e-01  1.23025512e-01]
 [ 1.62397502e-01  5.80301674e-02 -1.12805528e-01]
 [ 1.71014636e-02 -6.67200369e-03 -1.56697401e-03]
 [-1.17478153e-01 -1.53920416e-01 -1.11823980e-01]
 [ 1.56114180e-01  2.20178074e-01  1.00111091e-01]
 [ 8.41304736e-02 -7.13554571e-02  7.00309905e-02]
 [ 1.00793818e-01  1.74152904e-02  4.40321278e-03]
 [ 3.52346627e-01 -2.66747494e-01 -1.56997458e-01]
 [-4.05640235e-02 -7.62389283e-02  1.84635583e-02]
 [-1.71150118e-01 -4.63492231e-02  1.27829620e-02]
 [ 3.02755732e-01  1.61984183e-01  7.78232960e-02]
 [ 1.47710139e-02 -6.98120522e-02 -1.02699607e-01]
 [-3.20729382e-03  7.73978598e-02  1.33665105e-02]
 [ 4.13991113e-01 -4.99900330e-01 -1.25169002e-01]
 [-2.74016662e-01  1.75553009e-01  1.29214447e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.26023247 -29.25593426 -29.27334937]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  8.31486419  -9.25153874 -83.50871763]
init_Out:  [2.49911038]
Stock Position:  8.31486419409362
Bond position:  [-828.98730903]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-0.17958661]
curr_Stock_Price:  99.69030557271711
curr_Factors:  [99.69030557 -0.97174928 -1.02102644]
mat_Sqrt:  [[13.58943586  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00053303 -0.04017178 -0.11181141]
Stock Position:  -0.0005330255809592248
Bond Position:  [-0.12644913]


portfolio before change:  [-0.17918489]
curr_Stock_Price:  98.90698772820134
curr_Factors:  [98.90698773 -1.20932959 -1.04120778]
mat_Sqrt:  [[10.41911938  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00293473  0.0036216   0.29065192]
Stock Position:  -0.00293472722925538
Bond Position:  [0.11108014]


portfolio before change:  [-0.17834085]
curr_Stock_Price:  98.62411347768425
curr_Factors:  [98.62411348 -1.0797362  -1.03744609]
mat_Sqrt:  [[11.87141606  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00433976  0.03817825  0.03253061]
Stock Position:  -0.004339757417491237
Bond Position:  [0.24966388]


portfolio before change:  [-0.18069388]
curr_Stock_Price:  99.17350830435727
curr_Factors:  [99.1735083  -1.24376061 -1.05686821]
mat_Sqrt:  [[ 9.93677091  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00638193  0.00544828 -0.19102361]
Stock Position:  0.0063819315465888735
Bond Position:  [-0.81361242]


portfolio before change:  [-0.18848713]
curr_Stock_Price:  97.96830171789549
curr_Factors:  [97.96830172 -1.21918003 -1.06170172]
mat_Sqrt:  [[10.01177822  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.0065422  0.00909802 0.08501923]
Stock Position:  0.006542203501977059
Bond Position:  [-0.8294157]


portfolio before change:  [-0.18581573]
curr_Stock_Price:  98.39248359380666
curr_Factors:  [98.39248359 -1.46244453 -1.05765545]
mat_Sqrt:  [[ 7.91582909  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00781696  0.00433168 -0.19828716]
Stock Position:  0.007816963881328035
Bond Position:  [-0.95494622]


portfolio before change:  [-0.18702597]
curr_Stock_Price:  98.25293315798216
curr_Factors:  [98.25293316 -1.56609798 -1.05512482]
mat_Sqrt:  [[ 7.14435332  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01601968 -0.00238183 -0.28659624]
Stock Position:  -0.01601967615420688
Bond Position:  [1.3869542]


portfolio before change:  [-0.18472808]
curr_Stock_Price:  98.1203144818304
curr_Factors:  [98.12031448 -1.33930585 -1.05650092]
mat_Sqrt:  [[ 8.93867755  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00629374 -0.01977729  0.09815499]
Stock Position:  -0.006293744366877538
Bond Position:  [0.4328161]


portfolio before change:  [-0.18211727]
curr_Stock_Price:  97.71408421313674
curr_Factors:  [97.71408421 -1.23411804 -1.06782248]
mat_Sqrt:  [[ 9.77770887  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01387494 -0.04594113 -0.35339944]
Stock Position:  -0.013874937424275013
Bond Position:  [1.17365954]


portfolio before change:  [-0.18718084]
curr_Stock_Price:  98.08960268244334
curr_Factors:  [98.08960268 -0.97449739 -1.1012196 ]
mat_Sqrt:  [[12.30695298  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00430058  0.03639703 -0.2688711 ]
Stock Position:  0.004300583652667416
Bond Position:  [-0.60902339]


portfolio before change:  [-0.18385063]
curr_Stock_Price:  98.8816676100555
curr_Factors:  [98.88166761 -1.01500292 -1.10941438]
mat_Sqrt:  [[11.81661459  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00819043 -0.02303099  0.02830939]
Stock Position:  -0.008190429514056225
Bond Position:  [0.62603269]


portfolio before change:  [-0.18700708]
curr_Stock_Price:  99.27660502278971
curr_Factors:  [99.27660502 -1.12254629 -1.12442087]
mat_Sqrt:  [[10.49546006  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01102339  0.01209977 -0.13881456]
Stock Position:  -0.011023386430393585
Bond Position:  [0.9073573]


portfolio before change:  [-0.17646511]
curr_Stock_Price:  98.33056633728063
curr_Factors:  [98.33056634 -0.87768261 -1.08285632]
mat_Sqrt:  [[13.84322581  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00623593 -0.03632963  0.1803282 ]
Stock Position:  -0.006235932746699647
Bond Position:  [0.43671769]


portfolio before change:  [-0.17283543]
curr_Stock_Price:  97.75726231844904
curr_Factors:  [97.75726232 -0.64239756 -1.06446997]
mat_Sqrt:  [[17.73641664  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01537751 0.0951695  0.02148691]
Stock Position:  0.015377509589987926
Bond Position:  [-1.67609867]


portfolio before change:  [-0.18469132]
curr_Stock_Price:  96.99989873797367
curr_Factors:  [96.99989874 -0.61765938 -1.05951454]
mat_Sqrt:  [[18.12941976  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0037867  -0.16352872 -0.10838532]
Stock Position:  -0.0037866970734696482
Bond Position:  [0.18261791]


portfolio before change:  [-0.18944455]
curr_Stock_Price:  98.26117131106314
curr_Factors:  [98.26117131 -0.84594551 -1.02939599]
mat_Sqrt:  [[15.06369361  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00511851 -0.01767474 -0.11759145]
Stock Position:  -0.005118507751138107
Bond Position:  [0.31350602]


portfolio before change:  [-0.18892354]
curr_Stock_Price:  98.16703925442081
curr_Factors:  [98.16703925 -0.81789951 -1.03902632]
mat_Sqrt:  [[15.32897271  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00306618  0.05577449  0.36766033]
Stock Position:  -0.003066177254095787
Bond Position:  [0.112074]


portfolio before change:  [-0.18656374]
curr_Stock_Price:  97.40198548456293
curr_Factors:  [97.40198548 -0.85596104 -1.04968023]
mat_Sqrt:  [[14.48632824  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00393461 0.0176386  0.074119  ]
Stock Position:  0.003934610029118734
Bond Position:  [-0.56980257]


portfolio before change:  [-0.18803429]
curr_Stock_Price:  97.04634111890593
curr_Factors:  [97.04634112 -0.61857158 -1.0334143 ]
mat_Sqrt:  [[18.60076545  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00090876 -0.00381321  0.30205168]
Stock Position:  -0.0009087646387632867
Bond Position:  [-0.09984201]


portfolio before change:  [-0.18734075]
curr_Stock_Price:  96.26944120408422
curr_Factors:  [96.2694412  -0.52890876 -1.03188662]
mat_Sqrt:  [[20.21359831  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00433748 -0.03085092  0.15910294]
Stock Position:  0.004337481940787901
Bond Position:  [-0.60490772]


portfolio before change:  [-0.18589642]
curr_Stock_Price:  96.61986449268798
curr_Factors:  [96.61986449 -0.83510243 -1.02238702]
mat_Sqrt:  [[15.07887726  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.0115725  0.0153258  0.74548257]
Stock Position:  0.011572503376800544
Bond Position:  [-1.30403013]


portfolio before change:  [-0.18052213]
curr_Stock_Price:  97.09835190256507
curr_Factors:  [97.0983519  -1.01071668 -1.02151117]
mat_Sqrt:  [[12.72408379  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00116706 -0.02644698  0.57760588]
Stock Position:  0.0011670626548502864
Bond Position:  [-0.29384199]


portfolio before change:  [-0.18062061]
curr_Stock_Price:  97.04545101694417
curr_Factors:  [97.04545102 -1.01195071 -1.04393886]
mat_Sqrt:  [[12.41977384  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-6.93175853e-03 -1.72982569e-04 -2.33292772e-01]
Stock Position:  -0.006931758528348261
Bond Position:  [0.49207503]


portfolio before change:  [-0.17559109]
curr_Stock_Price:  96.32874899509741
curr_Factors:  [96.328749   -0.88588294 -1.02101787]
mat_Sqrt:  [[14.30867518  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.03493295  0.04857178  0.17749952]
Stock Position:  -0.03493295024544282
Bond Position:  [3.18945631]


portfolio before change:  [-0.16533304]
curr_Stock_Price:  96.04651285251717
curr_Factors:  [96.04651285 -0.8798835  -1.03195476]
mat_Sqrt:  [[14.19648386  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00627377 -0.07188215  0.35095754]
Stock Position:  -0.006273771662026984
Bond Position:  [0.43724085]


portfolio before change:  [-0.16806099]
curr_Stock_Price:  96.49004277191004
curr_Factors:  [96.49004277 -1.00927895 -1.01896841]
mat_Sqrt:  [[12.69480003  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01109663  0.01835075 -0.32180277]
Stock Position:  0.011096630303708077
Bond Position:  [-1.23877532]


portfolio before change:  [-0.17706324]
curr_Stock_Price:  95.69273752540786
curr_Factors:  [95.69273753 -0.94834049 -1.02548224]
mat_Sqrt:  [[13.29409136  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00124938 -0.00210987 -0.00447014]
Stock Position:  0.001249377297782905
Bond Position:  [-0.29661958]


portfolio before change:  [-0.17792104]
curr_Stock_Price:  95.03583815613092
curr_Factors:  [95.03583816 -0.78687457 -1.02250552]
mat_Sqrt:  [[15.5626524   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00927081 -0.04867391 -0.31900269]
Stock Position:  -0.009270806250219832
Bond Position:  [0.7031378]


portfolio before change:  [-0.17299364]
curr_Stock_Price:  94.51382341848088
curr_Factors:  [94.51382342 -0.6218483  -1.02213523]
mat_Sqrt:  [[18.26090752  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00997947 0.06962642 0.28558908]
Stock Position:  0.00997947357050537
Bond Position:  [-1.11619185]


portfolio before change:  [-0.1751635]
curr_Stock_Price:  94.31037391903419
curr_Factors:  [94.31037392 -0.57041658 -1.01558167]
mat_Sqrt:  [[19.30941781  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00500186 -0.02256458  0.19977892]
Stock Position:  0.005001864922812419
Bond Position:  [-0.64689125]


portfolio before change:  [-0.17932693]
curr_Stock_Price:  93.49416522518351
curr_Factors:  [93.49416523 -0.59804109 -1.02555244]
mat_Sqrt:  [[18.43600413  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00554037 0.0055072  0.01256114]
Stock Position:  0.005540369844050794
Bond Position:  [-0.69731918]


portfolio before change:  [-0.17912725]
curr_Stock_Price:  93.54593905641671
curr_Factors:  [93.54593906 -0.55209744 -1.01758835]
mat_Sqrt:  [[19.46789806  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01609893 -0.08435296 -0.44787005]
Stock Position:  0.016098926744438694
Bond Position:  [-1.68511647]


portfolio before change:  [-0.17329453]
curr_Stock_Price:  93.92132881193231
curr_Factors:  [93.92132881 -0.56380283 -1.02354632]
mat_Sqrt:  [[19.20380347  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00201854 -0.02410887  0.05267139]
Stock Position:  -0.002018540034826997
Bond Position:  [0.01628943]


portfolio before change:  [-0.1711704]
curr_Stock_Price:  92.87002837899338
curr_Factors:  [92.87002838 -0.40035489 -1.02161841]
mat_Sqrt:  [[22.4037346   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00757631 -0.01465691  0.03646623]
Stock Position:  -0.0075763055367069985
Bond Position:  [0.53244131]


portfolio before change:  [-0.16714187]
curr_Stock_Price:  92.34708573840983
curr_Factors:  [92.34708574 -0.10292834 -1.03464422]
mat_Sqrt:  [[29.60613466  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01090395 0.0512239  0.2220082 ]
Stock Position:  0.010903948226788621
Bond Position:  [-1.17408971]


portfolio before change:  [-0.1797146]
curr_Stock_Price:  91.207502713705
curr_Factors:  [ 9.12075027e+01 -5.15607538e-02 -1.02670326e+00]
mat_Sqrt:  [[31.02747628  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-2.57674678e-04 -2.20765093e-02 -2.92973392e-01]
Stock Position:  -0.0002576746780034108
Bond Position:  [-0.15621273]


portfolio before change:  [-0.17956869]
curr_Stock_Price:  90.56548590177371
curr_Factors:  [90.5654859  -0.20825824 -1.01570876]
mat_Sqrt:  [[26.63180522  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [5.70572608e-05 2.44753523e-02 3.81309339e-02]
Stock Position:  5.705726080333457e-05
Bond Position:  [-0.18473611]


portfolio before change:  [-0.17960478]
curr_Stock_Price:  90.33777915886598
curr_Factors:  [90.33777916 -0.17443528 -1.0155923 ]
mat_Sqrt:  [[27.4819152   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01366476 -0.15808236 -0.35707232]
Stock Position:  0.013664758222998995
Bond Position:  [-1.41404869]


portfolio before change:  [-0.17607872]
curr_Stock_Price:  90.6087553144913
curr_Factors:  [90.60875531 -0.18977468 -1.01450931]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-0.17607872]
Stock Price:  89.75860708532953
PL:  [-0.17607872]
Settle:  Tensor("sub_70:0", shape=(), dtype=float64)
PL:  Tensor("sub_71:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  36
output_Z_Vals[:, i, :]:  [[ 1.19260232e+02 -2.92559343e+01 -2.92733494e+01]
 [-1.50099817e-01  4.82933287e-01  8.85165074e-02]
 [ 1.68093236e-01  1.34442489e-02 -1.99566972e-01]
 [ 8.37429930e-02  1.59180675e-01  3.78078217e-02]
 [ 2.43894828e-01 -7.69176639e-03 -1.54814360e-02]
 [-1.61217962e-02  3.30097857e-02  1.17202937e-01]
 [-1.28318342e-02  6.12290500e-02 -5.98314182e-02]
 [ 1.45133799e-01  2.43285965e-01  1.40746512e-01]
 [ 4.72003383e-02  5.17630221e-02  2.53023555e-02]
 [-3.53567881e-02  4.03713759e-01  1.73272378e-01]
 [ 5.86505523e-02  5.28749776e-02 -8.11601720e-02]
 [-8.14209220e-02  8.56344730e-02  2.62338879e-02]
 [-2.18622713e-02 -1.28822480e-01 -4.05168913e-02]
 [ 3.36904376e-01  2.55576141e-01  3.41858438e-01]
 [ 1.42349018e-01  1.09620776e-01 -5.30110490e-02]
 [-5.89181163e-02 -7.47094120e-02 -1.23565517e-01]
 [-8.35725503e-02 -3.78739358e-03 -8.10206410e-02]
 [-4.13758414e-02 -2.51676011e-02  2.96081830e-02]
 [ 2.29629311e-02  6.68182888e-02  2.57141335e-02]
 [ 3.12524434e-01 -1.11252518e-01 -6.90249308e-02]
 [-1.52308275e-02  1.64572898e-02  5.72891762e-02]
 [ 1.23229996e-01 -6.85729408e-02  1.74851915e-01]
 [-6.98120453e-02  6.91357452e-02  3.38757951e-01]
 [-1.06612210e-02 -1.18904582e-02 -7.68956843e-02]
 [-1.19846762e-01  6.69078298e-02  8.94871118e-02]
 [-1.44245073e-02 -1.21529163e-01  9.28966645e-02]
 [ 2.29480496e-01  4.03138707e-02 -1.25934388e-01]
 [-5.07806065e-02  7.36225950e-02  2.93687317e-02]
 [-1.00716707e-01 -9.99373974e-02 -1.67549598e-01]
 [ 8.25699564e-02  8.15150583e-02 -7.47939142e-02]
 [ 5.82986238e-02  2.96517606e-02  2.51412576e-02]
 [ 2.03265532e-02 -9.09219325e-02 -7.47805748e-02]
 [ 2.71031891e-02 -1.67482415e-02  7.24536009e-02]
 [-5.07393468e-02 -8.61726946e-02 -9.52872950e-03]
 [-1.90900020e-01  1.81041436e-01  2.72511980e-02]
 [ 8.47165236e-02 -1.65012150e-01 -1.38726811e-01]
 [-6.70278359e-02 -1.49789147e-01 -3.93763065e-02]
 [-2.56379636e-02  2.38311257e-02 -6.01623044e-02]
 [-4.55100657e-02  9.71754066e-02 -1.99170633e-02]
 [-8.71193091e-01  4.32140711e-01  5.33897019e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.26023247 -29.25593426 -29.27334937]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  8.31486419  -9.25153874 -83.50871763]
init_Out:  [2.49911038]
Stock Position:  8.31486419409362
Bond position:  [-828.98730903]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [13.97830077]
curr_Stock_Price:  101.39302579221865
curr_Factors:  [101.39302579  -0.85844062  -1.01814564]
mat_Sqrt:  [[15.52447864  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00770153  0.15271691  0.25251296]
Stock Position:  -0.007701526062356779
Bond Position:  [14.7591818]


portfolio before change:  [13.97525394]
curr_Stock_Price:  102.02820424505539
curr_Factors:  [102.02820425  -1.08725024  -0.99502244]
mat_Sqrt:  [[12.71746961  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01004161  0.00425144 -0.56930902]
Stock Position:  0.010041614548111016
Bond Position:  [12.95072604]


portfolio before change:  [13.98139489]
curr_Stock_Price:  102.47853065469786
curr_Factors:  [102.47853065  -1.11610974  -1.00807836]
mat_Sqrt:  [[12.24925625  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00780215 0.05033735 0.10785519]
Stock Position:  0.007802147963789799
Bond Position:  [13.18184223]


portfolio before change:  [13.98794348]
curr_Stock_Price:  103.10666024589517
curr_Factors:  [103.10666025  -0.98150969  -1.01249405]
mat_Sqrt:  [[14.03789206  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01713477 -0.00243235 -0.04416423]
Stock Position:  0.0171347729174803
Bond Position:  [12.22123427]


portfolio before change:  [13.9901537]
curr_Stock_Price:  103.14648949885483
curr_Factors:  [103.1464895   -1.16609975  -1.02388508]
mat_Sqrt:  [[11.54399485  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00074969 0.01043861 0.33434736]
Stock Position:  0.0007496938684604926
Bond Position:  [13.9128254]


portfolio before change:  [13.99109547]
curr_Stock_Price:  102.0828051845227
curr_Factors:  [102.08280518  -0.74361944  -0.98323058]
mat_Sqrt:  [[18.15478704  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00129244  0.01936233 -0.17068238]
Stock Position:  -0.0012924384086738711
Bond Position:  [14.12303121]


portfolio before change:  [13.99277153]
curr_Stock_Price:  102.15199640378566
curr_Factors:  [102.1519964   -0.57873934  -0.95336494]
mat_Sqrt:  [[22.07305397  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00816132 0.07693378 0.40151062]
Stock Position:  0.00816131636785325
Bond Position:  [13.15907677]


portfolio before change:  [14.00355439]
curr_Stock_Price:  103.2716525317281
curr_Factors:  [103.27165253  -0.53012408  -0.93431985]
mat_Sqrt:  [[23.87707961  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00224909 0.0163689  0.07218058]
Stock Position:  0.002249088931482547
Bond Position:  [13.77128726]


portfolio before change:  [14.00104905]
curr_Stock_Price:  101.39228824976537
curr_Factors:  [101.39228825  -0.58567245  -0.91868598]
mat_Sqrt:  [[22.52528833  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [4.63307386e-04 1.27665500e-01 4.94297866e-01]
Stock Position:  0.0004633073855842477
Bond Position:  [13.95407325]


portfolio before change:  [14.00271422]
curr_Stock_Price:  101.22135582122313
curr_Factors:  [101.22135582  -0.62266739  -0.90185856]
mat_Sqrt:  [[22.03834334  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00197152  0.01672054 -0.23152738]
Stock Position:  0.0019715196804089064
Bond Position:  [13.80315433]


portfolio before change:  [14.00718615]
curr_Stock_Price:  102.61440624511029
curr_Factors:  [102.61440625  -0.56112827  -0.9205347 ]
mat_Sqrt:  [[23.32009322  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00316701  0.02708     0.07483798]
Stock Position:  -0.0031670061865158292
Bond Position:  [14.33216661]


portfolio before change:  [14.00821368]
curr_Stock_Price:  102.85567624277074
curr_Factors:  [102.85567624  -0.44048654  -0.92849667]
mat_Sqrt:  [[26.16293185  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00127887 -0.04073725 -0.11558341]
Stock Position:  -0.0012788677294531374
Bond Position:  [14.13975249]


portfolio before change:  [14.00901141]
curr_Stock_Price:  103.61404086232093
curr_Factors:  [103.61404086  -0.52010104  -0.93108687]
mat_Sqrt:  [[24.27592072  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01702448 0.08082027 0.97522697]
Stock Position:  0.01702447829397596
Bond Position:  [12.24503642]


portfolio before change:  [13.99563184]
curr_Stock_Price:  102.73822568709787
curr_Factors:  [102.73822569  -0.90075857  -0.92665326]
mat_Sqrt:  [[16.52331518  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00813145  0.03466513 -0.15122577]
Stock Position:  0.008131454133308057
Bond Position:  [13.16022067]


portfolio before change:  [14.00774774]
curr_Stock_Price:  104.02591229920492
curr_Factors:  [104.0259123   -0.76477496  -0.93546643]
mat_Sqrt:  [[18.99923355  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00453017 -0.02362519 -0.35249803]
Stock Position:  -0.0045301727755071765
Bond Position:  [14.47900309]


portfolio before change:  [14.01301297]
curr_Stock_Price:  103.26319527271828
curr_Factors:  [103.26319527  -1.08590481  -0.92633039]
mat_Sqrt:  [[13.80520671  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00725875 -0.00119768 -0.23112934]
Stock Position:  -0.0072587547282938385
Bond Position:  [14.76257517]


portfolio before change:  [14.02633309]
curr_Stock_Price:  101.68238886970906
curr_Factors:  [101.68238887  -1.02809554  -0.93036735]
mat_Sqrt:  [[14.34485342  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00250835 -0.00795869  0.0844639 ]
Stock Position:  -0.002508350549879533
Bond Position:  [14.28138816]


portfolio before change:  [14.02569275]
curr_Stock_Price:  102.64940923875194
curr_Factors:  [102.64940924  -0.95209443  -0.92791009]
mat_Sqrt:  [[15.66321346  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.0019113  0.0211298  0.07335527]
Stock Position:  0.0019112966491331357
Bond Position:  [13.82949928]


portfolio before change:  [14.02683676]
curr_Stock_Price:  102.34344530384061
curr_Factors:  [102.3434453   -0.68048224  -0.93320222]
mat_Sqrt:  [[20.38195201  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01450117 -0.03518114 -0.19690891]
Stock Position:  0.014501174921205414
Bond Position:  [12.54273655]


portfolio before change:  [14.02248429]
curr_Stock_Price:  101.93517439163789
curr_Factors:  [101.93517439  -0.54301036  -0.89877316]
mat_Sqrt:  [[24.1082366   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-1.29076133e-04  5.20425199e-03  1.63430073e-01]
Stock Position:  -0.00012907613326869187
Bond Position:  [14.03564169]


portfolio before change:  [14.02472695]
curr_Stock_Price:  98.1537171579775
curr_Factors:  [98.15371716 -0.61688923 -0.89459656]
mat_Sqrt:  [[21.65094292  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00725839 -0.02168467  0.49880384]
Stock Position:  0.007258388172536632
Bond Position:  [13.31228917]


portfolio before change:  [14.03064704]
curr_Stock_Price:  98.7400669962692
curr_Factors:  [98.740067   -0.50600776 -0.88831778]
mat_Sqrt:  [[24.4875608   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [4.58073095e-05 2.18626423e-02 9.66382144e-01]
Stock Position:  4.58073095001408e-05
Bond Position:  [14.02612403]


portfolio before change:  [14.03243416]
curr_Stock_Price:  99.4767120796114
curr_Factors:  [99.47671208 -0.44956042 -0.8758147 ]
mat_Sqrt:  [[26.43128756  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00100882 -0.00376009 -0.21936198]
Stock Position:  -0.0010088232400914771
Bond Position:  [14.13278858]


portfolio before change:  [14.03441569]
curr_Stock_Price:  99.26377532750332
curr_Factors:  [99.26377533 -0.29066867 -0.86800361]
mat_Sqrt:  [[31.15916493  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0032046   0.02115811  0.25528182]
Stock Position:  -0.0032046022160714
Bond Position:  [14.3525166]


portfolio before change:  [14.03591518]
curr_Stock_Price:  99.35573008372985
curr_Factors:  [99.35573008 -0.54481879 -0.82908158]
mat_Sqrt:  [[25.14870172  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 5.56718767e-05 -3.84308956e-02  2.65008326e-01]
Stock Position:  5.5671876738081016e-05
Bond Position:  [14.03038386]


portfolio before change:  [14.03760889]
curr_Stock_Price:  98.27427042519327
curr_Factors:  [98.27427043 -0.46658677 -0.79996485]
mat_Sqrt:  [[27.69385724  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00739569  0.01274837 -0.35925576]
Stock Position:  0.007395688676215597
Bond Position:  [13.31080298]


portfolio before change:  [14.04144548]
curr_Stock_Price:  98.5680416324007
curr_Factors:  [98.56804163 -0.49884052 -0.83013619]
mat_Sqrt:  [[26.09569547  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00164337  0.02328151  0.08378082]
Stock Position:  -0.0016433672772477982
Bond Position:  [14.20342897]


portfolio before change:  [14.04412684]
curr_Stock_Price:  98.0168459448803
curr_Factors:  [98.01684594 -0.52425897 -0.80726375]
mat_Sqrt:  [[25.88378326  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00531213 -0.03160298 -0.47797237]
Stock Position:  -0.005312129090833327
Bond Position:  [14.56480498]


portfolio before change:  [14.04895128]
curr_Stock_Price:  97.45139882168601
curr_Factors:  [97.45139882 -0.36102139 -0.82416534]
mat_Sqrt:  [[29.78982967  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0023299   0.02577732 -0.21336622]
Stock Position:  0.0023299032981858986
Bond Position:  [13.82189894]


portfolio before change:  [14.04731636]
curr_Stock_Price:  96.00809201119492
curr_Factors:  [ 9.60080920e+01  4.87494774e-02 -8.26437805e-01]
mat_Sqrt:  [[44.11254249  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00145528 0.00937671 0.07172101]
Stock Position:  0.0014552814920340946
Bond Position:  [13.90759756]


portfolio before change:  [14.05185946]
curr_Stock_Price:  97.93523808044125
curr_Factors:  [ 9.79352381e+01  5.41808964e-02 -8.17272096e-01]
mat_Sqrt:  [[45.65966135  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 5.94493705e-05 -2.87520396e-02 -2.13328165e-01]
Stock Position:  5.944937050586933e-05
Bond Position:  [14.04603727]


portfolio before change:  [14.05365079]
curr_Stock_Price:  98.53186502082124
curr_Factors:  [ 9.85318650e+01 -4.52448676e-02 -8.09125657e-01]
mat_Sqrt:  [[41.93033177  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00098879 -0.00529626  0.20668996]
Stock Position:  0.0009887897128458873
Bond Position:  [13.9562235]


portfolio before change:  [14.05919841]
curr_Stock_Price:  102.37796543191766
curr_Factors:  [102.37796543  -0.21026802  -0.81564395]
mat_Sqrt:  [[36.69936803  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00149619 -0.0272502  -0.02718281]
Stock Position:  -0.001496193609970037
Bond Position:  [14.21237567]


portfolio before change:  [14.06247073]
curr_Stock_Price:  101.37832527749636
curr_Factors:  [101.37832528  -0.44147201  -0.79185586]
mat_Sqrt:  [[29.53368392  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00611718  0.05725033  0.07774008]
Stock Position:  -0.006117182119489631
Bond Position:  [14.6826204]


portfolio before change:  [14.06543676]
curr_Stock_Price:  101.19350282163637
curr_Factors:  [101.19350282  -0.53652618  -0.79510264]
mat_Sqrt:  [[26.7198231   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0019513  -0.05218142 -0.39574898]
Stock Position:  0.0019513017087520478
Bond Position:  [13.86797771]


portfolio before change:  [14.06601085]
curr_Stock_Price:  100.59927829504217
curr_Factors:  [100.5992783   -0.22777281  -0.79186656]
mat_Sqrt:  [[36.28867496  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00217514 -0.04736749 -0.11232964]
Stock Position:  -0.0021751422462657276
Bond Position:  [14.28482859]


portfolio before change:  [14.0731401]
curr_Stock_Price:  98.14264356718347
curr_Factors:  [98.14264357 -0.34422942 -0.80567363]
mat_Sqrt:  [[31.07858268  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00120029  0.00753606 -0.17162631]
Stock Position:  -0.0012002872167917158
Bond Position:  [14.19093946]


portfolio before change:  [14.07063875]
curr_Stock_Price:  101.70456398978845
curr_Factors:  [101.70456399  -0.37165218  -0.7765667 ]
mat_Sqrt:  [[32.26081362  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00145894  0.03072956 -0.05681784]
Stock Position:  -0.0014589390571154918
Bond Position:  [14.21901951]


portfolio before change:  [14.0779111]
curr_Stock_Price:  97.93822095689437
curr_Factors:  [97.93822096 -0.29129043 -0.78895695]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [14.0779111]
Stock Price:  99.24636541749851
PL:  [14.0779111]
Settle:  Tensor("sub_72:0", shape=(), dtype=float64)
PL:  Tensor("sub_73:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  37
output_Z_Vals[:, i, :]:  [[ 1.19260232e+02 -2.92559343e+01 -2.92733494e+01]
 [ 5.23610124e-02 -3.00517617e-02 -1.12347820e-01]
 [-3.13700534e-02  3.31364124e-02  7.75443761e-02]
 [ 8.89775567e-02  2.06778717e-01  3.84437276e-02]
 [ 1.88674026e-01 -2.04401233e-02 -5.87003361e-02]
 [ 7.85014335e-02  3.05758420e-02 -1.86200674e-02]
 [ 6.47616047e-02  2.01541735e-02 -5.58462510e-02]
 [-1.09341277e-01 -6.41215265e-02 -1.21102326e-01]
 [-9.60113982e-02 -6.77192019e-02  1.00547646e-01]
 [-3.03988950e-02 -3.83292440e-02 -9.33331632e-02]
 [ 5.52118314e-02  1.59255095e-01 -8.21136200e-02]
 [-4.97984690e-02  5.91765543e-02  3.00059971e-03]
 [-1.07938686e-01  4.00628629e-02 -4.74603811e-02]
 [-1.11390476e-01 -1.02949465e-01  6.00343781e-02]
 [ 2.36034458e-01  3.01930992e-01  4.42266017e-02]
 [-6.36812182e-02 -2.25429355e-01 -7.49206207e-02]
 [-6.71760679e-02 -5.68555544e-02 -4.37621574e-02]
 [-7.87014279e-02  1.68331375e-01  1.27213834e-01]
 [-8.67766577e-03  5.48599384e-02 -4.88681802e-02]
 [-5.11220795e-02 -1.95601455e-02  1.24426391e-01]
 [ 2.10624028e-02 -6.10638031e-02  2.78883067e-02]
 [ 1.27334586e-01 -5.42574415e-02  2.08739026e-01]
 [-4.29625599e-02 -2.12419773e-02  2.60172188e-01]
 [-6.82925157e-02 -5.72984456e-04 -8.20969516e-02]
 [-3.25763305e-01  1.20547720e-01  4.22597474e-02]
 [-3.81551119e-02 -1.48162783e-01  1.00500297e-01]
 [ 2.18275146e-01  4.99779782e-02 -1.38637989e-01]
 [-3.88005885e-02  6.42358489e-02  2.58345018e-02]
 [-1.04190106e-01 -1.12691326e-01 -1.54640994e-01]
 [ 5.40896583e-02  4.86361575e-02 -9.66637001e-02]
 [ 6.96057294e-02 -3.28488572e-02  5.21869691e-02]
 [ 8.57654721e-02 -4.04253431e-02 -3.24739596e-02]
 [ 3.22167550e-01 -2.43794684e-01 -1.35319384e-01]
 [-4.15857675e-02 -7.72364166e-02  1.56527433e-02]
 [-1.79642022e-01  4.14977077e-02  1.80971664e-02]
 [ 2.05802606e-01  9.62261689e-04 -2.00114453e-03]
 [ 1.86199625e-02  1.04893938e-02 -9.38799039e-02]
 [-1.47751602e-02  3.25147059e-02 -5.64850435e-02]
 [ 1.01680604e-01 -1.42472673e-01 -2.67084786e-02]
 [-7.94798410e-01  3.95580465e-01  4.87376668e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.26023247 -29.25593426 -29.27334937]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  8.31486419  -9.25153874 -83.50871763]
init_Out:  [2.49911038]
Stock Position:  8.31486419409362
Bond position:  [-828.98730903]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-2.32687034]
curr_Stock_Price:  99.43205917487366
curr_Factors:  [99.43205917 -1.13265772 -1.01846557]
mat_Sqrt:  [[11.56925665  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00247658 -0.0095032  -0.32049706]
Stock Position:  0.00247657885990231
Bond Position:  [-2.57312168]


portfolio before change:  [-2.32660709]
curr_Stock_Price:  99.66823616781187
curr_Factors:  [99.66823617 -1.26922941 -1.02338173]
mat_Sqrt:  [[10.06672971  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00145884  0.01047865  0.22121252]
Stock Position:  -0.001458844718467644
Bond Position:  [-2.18120661]


portfolio before change:  [-2.32799244]
curr_Stock_Price:  100.43095296313217
curr_Factors:  [100.43095296  -1.48850037  -1.00445564]
mat_Sqrt:  [[ 8.30214939  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01230571 0.06538917 0.10966925]
Stock Position:  0.0123057112584144
Bond Position:  [-3.56386675]


portfolio before change:  [-2.33143243]
curr_Stock_Price:  100.18761251673448
curr_Factors:  [100.18761252  -1.10370775  -1.01019249]
mat_Sqrt:  [[12.09926023  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01455991 -0.00646373 -0.16745572]
Stock Position:  0.014559907390405266
Bond Position:  [-3.79015479]


portfolio before change:  [-2.3298635]
curr_Stock_Price:  100.32791068962459
curr_Factors:  [100.32791069  -1.0438163   -0.99773193]
mat_Sqrt:  [[13.02532697  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00579564  0.00966893 -0.05311787]
Stock Position:  0.005795639002209539
Bond Position:  [-2.91132785]


portfolio before change:  [-2.33086349]
curr_Stock_Price:  100.21816409360842
curr_Factors:  [100.21816409  -1.21123919  -1.01452624]
mat_Sqrt:  [[10.82203161  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00497896  0.00637331 -0.15931381]
Stock Position:  0.004978955609417242
Bond Position:  [-2.82984528]


portfolio before change:  [-2.33466922]
curr_Stock_Price:  99.52485076672667
curr_Factors:  [99.52485077 -1.34038606 -0.99867564]
mat_Sqrt:  [[ 9.59599344  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01414307 -0.02027701 -0.34547123]
Stock Position:  -0.01414306897198102
Bond Position:  [-0.92708239]


portfolio before change:  [-2.34100798]
curr_Stock_Price:  99.96484446042747
curr_Factors:  [99.96484446 -1.22580848 -0.99671638]
mat_Sqrt:  [[10.82971464  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00713183 -0.02141469  0.28683445]
Stock Position:  -0.00713183133767694
Bond Position:  [-1.62807557]


portfolio before change:  [-2.33991164]
curr_Stock_Price:  99.78258333853528
curr_Factors:  [99.78258334 -1.1091323  -0.99265835]
mat_Sqrt:  [[12.19715832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0041354  -0.01212077 -0.26625354]
Stock Position:  -0.0041353979914471855
Bond Position:  [-1.92727095]


portfolio before change:  [-2.33963801]
curr_Stock_Price:  99.65815550460866
curr_Factors:  [99.6581555 -1.2871734 -0.9713071]
mat_Sqrt:  [[10.41519066  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00408657  0.05036088 -0.2342473 ]
Stock Position:  0.004086570197381947
Bond Position:  [-2.74689806]


portfolio before change:  [-2.33810358]
curr_Stock_Price:  100.1176633239985
curr_Factors:  [100.11766332  -1.26424076  -0.95244483]
mat_Sqrt:  [[10.90978981  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00436837  0.01871327  0.00855988]
Stock Position:  -0.004368373992990413
Bond Position:  [-1.90075218]


portfolio before change:  [-2.3377532]
curr_Stock_Price:  99.98306170364387
curr_Factors:  [99.9830617  -1.1517245  -0.95361691]
mat_Sqrt:  [[12.17834505  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00957372  0.01266899 -0.13539126]
Stock Position:  -0.009573720916282322
Bond Position:  [-1.38054327]


portfolio before change:  [-2.33362434]
curr_Stock_Price:  99.53376504830915
curr_Factors:  [99.53376505 -1.15458064 -0.9241237 ]
mat_Sqrt:  [[12.45089601  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00817565 -0.03255548  0.17126137]
Stock Position:  -0.008175648882298804
Bond Position:  [-1.51987122]


portfolio before change:  [-2.33009293]
curr_Stock_Price:  99.07858402034152
curr_Factors:  [99.07858402 -0.9089987  -0.90074844]
mat_Sqrt:  [[16.21872072  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.0155905  0.09547896 0.12616618]
Stock Position:  0.01559050211268963
Bond Position:  [-3.87477781]


portfolio before change:  [-2.33468163]
curr_Stock_Price:  98.81532623859913
curr_Factors:  [98.81532624 -1.025401   -0.89951707]
mat_Sqrt:  [[14.41594152  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00588202 -0.07128702 -0.21372768]
Stock Position:  -0.005882022112083017
Bond Position:  [-1.7534477]


portfolio before change:  [-2.3315138]
curr_Stock_Price:  98.23949917757274
curr_Factors:  [98.23949918 -1.06721459 -0.91326501]
mat_Sqrt:  [[13.55734897  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00572214 -0.0179793  -0.12484125]
Stock Position:  -0.005722135292299609
Bond Position:  [-1.76937409]


portfolio before change:  [-2.32797008]
curr_Stock_Price:  97.58154529967813
curr_Factors:  [97.5815453  -1.03259052 -0.89553638]
mat_Sqrt:  [[14.19034056  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00340991  0.05323105  0.36290566]
Stock Position:  -0.003409905146078624
Bond Position:  [-1.99522627]


portfolio before change:  [-2.3254026]
curr_Stock_Price:  96.75545109897672
curr_Factors:  [96.7554511  -1.00130294 -0.8957562 ]
mat_Sqrt:  [[14.51420067  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00118755  0.01734824 -0.13940732]
Stock Position:  -0.001187551706058899
Bond Position:  [-2.2105005]


portfolio before change:  [-2.32603349]
curr_Stock_Price:  97.05401558885828
curr_Factors:  [97.05401559 -1.02645696 -0.87379102]
mat_Sqrt:  [[14.51263587  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0018073  -0.00618546  0.35495386]
Stock Position:  -0.0018073001897139908
Bond Position:  [-2.15062775]


portfolio before change:  [-2.32831641]
curr_Stock_Price:  98.16842881544771
curr_Factors:  [98.16842882 -1.13378986 -0.88302051]
mat_Sqrt:  [[13.06418212  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00192729 -0.01931007  0.07955758]
Stock Position:  0.0019272862792893447
Bond Position:  [-2.51751508]


portfolio before change:  [-2.32928833]
curr_Stock_Price:  97.82742753460701
curr_Factors:  [97.82742753 -0.94216713 -0.88053032]
mat_Sqrt:  [[15.80786387  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01066193 -0.01715771  0.59547434]
Stock Position:  0.010661930137027053
Bond Position:  [-3.37231753]


portfolio before change:  [-2.32867616]
curr_Stock_Price:  97.92438307455214
curr_Factors:  [97.92438307 -0.86238164 -0.89683531]
mat_Sqrt:  [[16.8605847   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 5.69161760e-04 -6.71730302e-03  7.42198834e-01]
Stock Position:  0.00056916175996016
Bond Position:  [-2.38441098]


portfolio before change:  [-2.32886585]
curr_Stock_Price:  98.11481004440766
curr_Factors:  [98.11481004 -1.00233072 -0.88883475]
mat_Sqrt:  [[14.80511691  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-5.74566757e-03 -1.81193595e-04 -2.34199751e-01]
Stock Position:  -0.0057456675699574895
Bond Position:  [-1.76513077]


portfolio before change:  [-2.33297863]
curr_Stock_Price:  98.79221226983762
curr_Factors:  [98.79221227 -1.15670245 -0.88562945]
mat_Sqrt:  [[12.81590369  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02450272  0.03812054  0.1205553 ]
Stock Position:  -0.0245027232675633
Bond Position:  [0.08769961]


portfolio before change:  [-2.33174071]
curr_Stock_Price:  98.74213804230341
curr_Factors:  [98.74213804 -1.06835816 -0.89684721]
mat_Sqrt:  [[13.83644998  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00155142 -0.04685319  0.28669937]
Stock Position:  -0.0015514182699827553
Bond Position:  [-2.17855036]


portfolio before change:  [-2.33002537]
curr_Stock_Price:  97.46093523089603
curr_Factors:  [97.46093523 -0.81938479 -0.90403875]
mat_Sqrt:  [[17.39230887  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01099717  0.01580442 -0.39549559]
Stock Position:  0.010997171948313598
Bond Position:  [-3.40182003]


portfolio before change:  [-2.32273202]
curr_Stock_Price:  98.16280690544289
curr_Factors:  [98.16280691 -0.93158901 -0.92777229]
mat_Sqrt:  [[15.29102569  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00208414  0.02031316  0.07369864]
Stock Position:  -0.0020841362165292076
Bond Position:  [-2.11814736]


portfolio before change:  [-2.32087707]
curr_Stock_Price:  97.14572495976921
curr_Factors:  [97.14572496 -0.75554704 -0.91512656]
mat_Sqrt:  [[18.27508349  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00758769 -0.03563613 -0.44114771]
Stock Position:  -0.0075876941796609535
Bond Position:  [-1.58376501]


portfolio before change:  [-2.31971014]
curr_Stock_Price:  96.96584056148937
curr_Factors:  [96.96584056 -1.02919541 -0.89925277]
mat_Sqrt:  [[14.0962751   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00252649  0.0153801  -0.27575463]
Stock Position:  0.002526486118240783
Bond Position:  [-2.56469299]


portfolio before change:  [-2.32260523]
curr_Stock_Price:  95.94684243264831
curr_Factors:  [95.94684243 -0.81710852 -0.88314177]
mat_Sqrt:  [[17.52352073  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00453163 -0.01038772  0.1488749 ]
Stock Position:  0.004531634779248025
Bond Position:  [-2.75740128]


portfolio before change:  [-2.32833195]
curr_Stock_Price:  94.75918654502853
curr_Factors:  [94.75918655 -0.58538126 -0.91094049]
mat_Sqrt:  [[21.22154732  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00367989 -0.01278362 -0.09263917]
Stock Position:  0.003679890715224893
Bond Position:  [-2.6770354]


portfolio before change:  [-2.32915426]
curr_Stock_Price:  94.62666771449678
curr_Factors:  [94.62666771 -0.65536884 -0.91020726]
mat_Sqrt:  [[19.7739071   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01457733 -0.07709465 -0.38602854]
Stock Position:  0.014577333812197755
Bond Position:  [-3.70855878]


portfolio before change:  [-2.33350224]
curr_Stock_Price:  94.36020066198134
curr_Factors:  [94.36020066 -0.62071842 -0.92193824]
mat_Sqrt:  [[20.17537344  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00200169 -0.0244243   0.04465292]
Stock Position:  -0.002001692829655814
Bond Position:  [-2.1446221]


portfolio before change:  [-2.33600343]
curr_Stock_Price:  95.47580801213779
curr_Factors:  [95.47580801 -0.6652725  -0.95379238]
mat_Sqrt:  [[18.91221511  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00924675  0.01312273  0.05162618]
Stock Position:  -0.009246747990315664
Bond Position:  [-1.4531627]


portfolio before change:  [-2.32892212]
curr_Stock_Price:  94.69034579408707
curr_Factors:  [94.69034579 -0.65481927 -0.93554365]
mat_Sqrt:  [[19.30278006  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01064194  0.00030429 -0.00570871]
Stock Position:  0.010641936998625355
Bond Position:  [-3.33661081]


portfolio before change:  [-2.30757533]
curr_Stock_Price:  96.73545211292884
curr_Factors:  [96.73545211 -0.59066181 -0.93102435]
mat_Sqrt:  [[21.12154889  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-1.28947750e-05  3.31703758e-03 -2.67813235e-01]
Stock Position:  -1.289477495250707e-05
Bond Position:  [-2.30632795]


portfolio before change:  [-2.3078546]
curr_Stock_Price:  96.03452081846878
curr_Factors:  [96.03452082 -0.41124287 -0.93355323]
mat_Sqrt:  [[25.02590816  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00101757  0.01028205 -0.16113611]
Stock Position:  -0.001017569280814154
Bond Position:  [-2.21013282]


portfolio before change:  [-2.30921682]
curr_Stock_Price:  97.10170917131857
curr_Factors:  [97.10170917 -0.27583451 -0.94993171]
mat_Sqrt:  [[28.50252747  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00324709 -0.04505382 -0.07619186]
Stock Position:  0.003247085034179525
Bond Position:  [-2.62451433]


portfolio before change:  [-2.30539912]
curr_Stock_Price:  98.3784818216789
curr_Factors:  [98.37848182 -0.39509027 -0.96864035]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-2.30539912]
Stock Price:  99.90251037479106
PL:  [-2.30539912]
Settle:  Tensor("sub_74:0", shape=(), dtype=float64)
PL:  Tensor("sub_75:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  38
output_Z_Vals[:, i, :]:  [[ 1.19260232e+02 -2.92559343e+01 -2.92733494e+01]
 [ 7.84151633e-02 -2.63301527e-01 -2.33963448e-01]
 [-7.18343788e-02 -2.45292366e-02  1.00430022e-01]
 [-5.41113567e-02  8.35828284e-02  1.22232348e-02]
 [-3.63619240e-02  5.98918110e-02 -7.07972559e-02]
 [ 3.97571273e-02  2.88976829e-02  5.60688263e-02]
 [ 4.73028520e-02  4.26280596e-02  6.31255818e-02]
 [-1.89050665e-02 -9.13801555e-03 -3.90479099e-02]
 [ 1.53099703e-02 -3.67522192e-02 -6.27216938e-02]
 [-1.03128967e-01 -1.43344979e-01 -1.24258740e-01]
 [ 1.01177077e-01  7.88208002e-02 -3.80059185e-02]
 [-2.09708902e-01 -1.01436194e-01  4.84601826e-02]
 [-1.14346343e-01  4.85175272e-02 -3.01142645e-02]
 [-9.62623594e-02 -1.14884369e-01  6.32126881e-02]
 [ 2.78357864e-01  3.21347898e-01  1.13306869e-02]
 [-4.85145727e-02 -4.57825434e-01 -4.34110128e-02]
 [-6.66327654e-02 -3.70729997e-02 -3.35981035e-02]
 [ 2.79797059e-03  1.06858456e-01 -4.16932928e-02]
 [-4.22783968e-02  4.55745710e-02 -1.05358502e-01]
 [-4.78165706e-02 -1.76403731e-02  1.19680666e-01]
 [ 4.98815061e-02 -8.31882954e-02  5.06312219e-02]
 [ 1.24101312e-01 -4.25022192e-02  2.09955340e-01]
 [-3.92570580e-02 -3.33231258e-02  2.45901629e-01]
 [-6.86860335e-02 -5.63620213e-04 -8.19822912e-02]
 [-3.44940543e-01  1.18244713e-01  6.58075288e-02]
 [-6.43689528e-02 -1.77935165e-01  1.08939596e-01]
 [ 1.96395769e-01  5.67990940e-02 -1.35038063e-01]
 [-4.54835184e-02  6.94721487e-02  2.78060356e-02]
 [-7.63520346e-02 -7.15889589e-02 -2.05033029e-01]
 [ 9.16424910e-03 -1.03007151e-02 -1.20479413e-01]
 [ 5.68151328e-02 -2.15238278e-02  4.28856403e-02]
 [ 7.48504360e-02 -1.10384055e-01 -8.19495801e-02]
 [ 3.46837430e-01 -3.27861231e-01 -2.62253487e-01]
 [-4.58913612e-02 -8.14397978e-02  3.80806606e-03]
 [-1.69612307e-01  8.04218864e-02  2.48559857e-02]
 [ 5.74620793e-02 -1.38860751e-01 -1.09958061e-01]
 [-2.50081313e-02 -1.43785656e-01 -5.14067528e-02]
 [-1.77653498e-02  2.01443671e-02 -7.59628653e-02]
 [ 3.97791979e-02 -1.00186004e-01 -2.94039073e-03]
 [-8.52531653e-01  4.25733218e-01  5.18987677e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.26023247 -29.25593426 -29.27334937]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  8.31486419  -9.25153874 -83.50871763]
init_Out:  [2.49911038]
Stock Position:  8.31486419409362
Bond position:  [-828.98730903]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-8.43635274]
curr_Stock_Price:  98.69729282669407
curr_Factors:  [98.69729283 -0.99839814 -0.99200658]
mat_Sqrt:  [[13.48600931  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00176918 -0.08326325 -0.66743259]
Stock Position:  0.0017691785446540065
Bond Position:  [-8.61096587]


portfolio before change:  [-8.43856367]
curr_Stock_Price:  98.05604021714976
curr_Factors:  [98.05604022 -1.17553026 -1.02397442]
mat_Sqrt:  [[10.87030199  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00478069 -0.00775683  0.2864989 ]
Stock Position:  -0.004780688573513571
Bond Position:  [-7.96978828]


portfolio before change:  [-8.43609694]
curr_Stock_Price:  97.33166408204913
curr_Factors:  [97.33166408 -1.1035621  -1.02674876]
mat_Sqrt:  [[11.5630366   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00427727  0.02643121  0.03486949]
Stock Position:  -0.0042772674427013005
Bond Position:  [-8.01978338]


portfolio before change:  [-8.43973639]
curr_Stock_Price:  97.9481596609163
curr_Factors:  [97.94815966 -1.23598007 -1.02388917]
mat_Sqrt:  [[10.22227454  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00481957  0.01893945 -0.20196486]
Stock Position:  -0.004819568607923991
Bond Position:  [-7.96766851]


portfolio before change:  [-8.43839071]
curr_Stock_Price:  97.4622854155951
curr_Factors:  [97.46228542 -1.32889412 -1.00737594]
mat_Sqrt:  [[ 9.42339495  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00551269 0.00913825 0.15994875]
Stock Position:  0.0055126908850080475
Bond Position:  [-8.97567016]


portfolio before change:  [-8.44616389]
curr_Stock_Price:  96.2557693551944
curr_Factors:  [96.25576936 -1.38731864 -0.99409479]
mat_Sqrt:  [[ 8.89594439  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00688954 0.01348018 0.18007971]
Stock Position:  0.006889539375983131
Bond Position:  [-9.1093218]


portfolio before change:  [-8.44507254]
curr_Stock_Price:  96.57946084120582
curr_Factors:  [96.57946084 -1.36306719 -1.00921328]
mat_Sqrt:  [[ 9.00775281  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00300981 -0.00288969 -0.11139282]
Stock Position:  -0.0030098106411219202
Bond Position:  [-8.15438665]


portfolio before change:  [-8.44781603]
curr_Stock_Price:  97.15229702439633
curr_Factors:  [97.15229702 -1.43362504 -1.00379991]
mat_Sqrt:  [[ 8.48971019  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00018352 -0.01162207 -0.17892753]
Stock Position:  0.00018351862153609272
Bond Position:  [-8.46564528]


portfolio before change:  [-8.44878703]
curr_Stock_Price:  97.62783340215887
curr_Factors:  [97.6278334  -1.28091044 -0.95784289]
mat_Sqrt:  [[10.40627821  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01270332 -0.04532966 -0.3544756 ]
Stock Position:  -0.012703324390533661
Bond Position:  [-7.20858899]


portfolio before change:  [-8.44396505]
curr_Stock_Price:  97.17731277976928
curr_Factors:  [97.17731278 -1.090586   -0.9780445 ]
mat_Sqrt:  [[12.27920012  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00777366  0.02492533 -0.10842031]
Stock Position:  0.0077736574996690915
Bond Position:  [-9.1993882]


portfolio before change:  [-8.44652557]
curr_Stock_Price:  96.99586345578552
curr_Factors:  [96.99586346 -1.03699366 -0.96111302]
mat_Sqrt:  [[13.15183971  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01539223 -0.03207694  0.13824341]
Stock Position:  -0.015392225331246935
Bond Position:  [-6.95354338]


portfolio before change:  [-8.46956449]
curr_Stock_Price:  98.43617991538927
curr_Factors:  [98.43617992 -1.08942254 -0.99031758]
mat_Sqrt:  [[12.30084923  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00969369  0.01534259 -0.08590761]
Stock Position:  -0.009693694504687496
Bond Position:  [-7.51535424]


portfolio before change:  [-8.47254951]
curr_Stock_Price:  98.6471977247418
curr_Factors:  [98.64719772 -1.07456869 -0.98069447]
mat_Sqrt:  [[12.63267445  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0068335  -0.03632963  0.1803282 ]
Stock Position:  -0.0068335035069782965
Bond Position:  [-7.79844354]


portfolio before change:  [-8.46794907]
curr_Stock_Price:  97.83131935239867
curr_Factors:  [97.83131935 -0.76156488 -0.99364737]
mat_Sqrt:  [[16.9121537   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.0170864  0.10161913 0.0323233 ]
Stock Position:  0.01708640440804904
Bond Position:  [-10.13953456]


portfolio before change:  [-8.47783179]
curr_Stock_Price:  97.3271057600236
curr_Factors:  [97.32710576 -0.74896575 -1.01914185]
mat_Sqrt:  [[16.60941872  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00416612 -0.14477711 -0.12383954]
Stock Position:  -0.004166118731008675
Bond Position:  [-8.07235551]


portfolio before change:  [-8.47790617]
curr_Stock_Price:  97.1027414609427
curr_Factors:  [97.10274146 -0.92403268 -1.03719049]
mat_Sqrt:  [[13.66101888  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00544968 -0.01172351 -0.09584604]
Stock Position:  -0.00544967918670088
Bond Position:  [-7.94872738]


portfolio before change:  [-8.4750149]
curr_Stock_Price:  96.38987011157225
curr_Factors:  [96.38987011 -0.89719384 -1.01400394]
mat_Sqrt:  [[14.25636293  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00020718  0.03379161 -0.11893936]
Stock Position:  -0.00020717511909796788
Bond Position:  [-8.45504532]


portfolio before change:  [-8.47602743]
curr_Stock_Price:  96.17549195022094
curr_Factors:  [96.17549195 -0.70488788 -1.01729401]
mat_Sqrt:  [[17.18423985  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00364333  0.01441194 -0.30055848]
Stock Position:  -0.0036433314022149325
Bond Position:  [-8.12562824]


portfolio before change:  [-8.47741516]
curr_Stock_Price:  96.27758506399488
curr_Factors:  [96.27758506 -0.68358511 -1.0119016 ]
mat_Sqrt:  [[17.66788902  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00134947 -0.00557838  0.34141563]
Stock Position:  -0.0013494724514739782
Bond Position:  [-8.34749121]


portfolio before change:  [-8.47896347]
curr_Stock_Price:  96.65166218345985
curr_Factors:  [96.65166218 -0.57796431 -0.99722327]
mat_Sqrt:  [[20.00387129  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00290287 -0.02630645  0.14443678]
Stock Position:  0.0029028705292993983
Bond Position:  [-8.75953073]


portfolio before change:  [-8.47766847]
curr_Stock_Price:  97.47498862395024
curr_Factors:  [97.47498862 -0.60160445 -1.0068689 ]
mat_Sqrt:  [[19.51381089  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00849967 -0.01344038  0.59894415]
Stock Position:  0.008499665406245263
Bond Position:  [-9.30617326]


portfolio before change:  [-8.47786799]
curr_Stock_Price:  97.58838363424489
curr_Factors:  [97.58838363 -0.81491797 -1.01638951]
mat_Sqrt:  [[15.63404611  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 6.44554983e-04 -1.05376976e-02  7.01488900e-01]
Stock Position:  0.0006445549834847515
Bond Position:  [-8.54076907]


portfolio before change:  [-8.47884036]
curr_Stock_Price:  97.7362274993123
curr_Factors:  [97.7362275  -0.97257526 -1.00355973]
mat_Sqrt:  [[13.54662316  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-6.30674894e-03 -1.78232361e-04 -2.33872657e-01]
Stock Position:  -0.0063067489359899575
Bond Position:  [-7.86244251]


portfolio before change:  [-8.48154479]
curr_Stock_Price:  98.00919917082416
curr_Factors:  [98.00919917 -0.86317792 -1.01734888]
mat_Sqrt:  [[14.94735771  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02197409  0.03739226  0.18773056]
Stock Position:  -0.021974089233798923
Bond Position:  [-6.32788191]


portfolio before change:  [-8.47252571]
curr_Stock_Price:  97.56275890217825
curr_Factors:  [97.5627589  -0.81743556 -1.01944805]
mat_Sqrt:  [[15.54302902  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00300624 -0.05626804  0.31077435]
Stock Position:  -0.003006236230677109
Bond Position:  [-8.17922901]


portfolio before change:  [-8.4720022]
curr_Stock_Price:  97.04850198821916
curr_Factors:  [97.04850199 -1.04417749 -1.01581093]
mat_Sqrt:  [[12.36936011  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01376771  0.01796145 -0.38522601]
Stock Position:  0.013767711883453316
Bond Position:  [-9.80813801]


portfolio before change:  [-8.46342567]
curr_Stock_Price:  97.76050308001209
curr_Factors:  [97.76050308 -0.74921753 -1.00480904]
mat_Sqrt:  [[16.91996129  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00224669  0.02196902  0.07932288]
Stock Position:  -0.002246687880107418
Bond Position:  [-8.24378833]


portfolio before change:  [-8.46778938]
curr_Stock_Price:  99.24409799954906
curr_Factors:  [99.244098   -1.10771094 -0.99862356]
mat_Sqrt:  [[12.07633735  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00994115 -0.02263842 -0.58490216]
Stock Position:  -0.009941147050161357
Bond Position:  [-7.48118921]


portfolio before change:  [-8.45871878]
curr_Stock_Price:  98.2375937779517
curr_Factors:  [98.23759378 -1.16086657 -0.9953393 ]
mat_Sqrt:  [[11.37232874  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00138006 -0.00325737 -0.34369423]
Stock Position:  -0.001380057838881886
Bond Position:  [-8.32314522]


portfolio before change:  [-8.45762089]
curr_Stock_Price:  96.68813328710587
curr_Factors:  [96.68813329 -1.00581751 -0.98004257]
mat_Sqrt:  [[13.27165546  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00489866 -0.00680643  0.12234079]
Stock Position:  0.004898664284715114
Bond Position:  [-8.9312636]


portfolio before change:  [-8.46062355]
curr_Stock_Price:  96.3030934910182
curr_Factors:  [96.30309349 -0.98853748 -0.95682632]
mat_Sqrt:  [[13.76510325  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0040154  -0.0349065  -0.23377934]
Stock Position:  0.00401540351073746
Bond Position:  [-8.84731933]


portfolio before change:  [-8.46326379]
curr_Stock_Price:  95.9210003295033
curr_Factors:  [95.92100033 -0.96163798 -0.95850219]
mat_Sqrt:  [[14.0607155   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.02025785 -0.10367882 -0.7481362 ]
Stock Position:  0.020257846824296863
Bond Position:  [-10.40641673]


portfolio before change:  [-8.44398358]
curr_Stock_Price:  96.9369573311478
curr_Factors:  [96.93695733 -0.9322371  -0.96563025]
mat_Sqrt:  [[14.52968068  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00324968 -0.02575353  0.01086335]
Stock Position:  -0.0032496797829566467
Bond Position:  [-8.12896951]


portfolio before change:  [-8.4505783]
curr_Stock_Price:  98.65359975878589
curr_Factors:  [98.65359976 -1.09601122 -0.96521991]
mat_Sqrt:  [[12.5583225   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01293661  0.02543163  0.07090721]
Stock Position:  -0.012936609650674304
Bond Position:  [-7.17433519]


portfolio before change:  [-8.44898204]
curr_Stock_Price:  98.4608825808383
curr_Factors:  [98.46088258 -1.03390569 -0.95228964]
mat_Sqrt:  [[13.51045733  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00232647 -0.04391163 -0.31367974]
Stock Position:  0.0023264656515518413
Bond Position:  [-8.6780479]


portfolio before change:  [-8.45090908]
curr_Stock_Price:  98.09886891780926
curr_Factors:  [98.09886892 -1.02514437 -0.96612105]
mat_Sqrt:  [[13.39270853  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00292801 -0.04546902 -0.14664916]
Stock Position:  -0.0029280126833251133
Bond Position:  [-8.16367434]


portfolio before change:  [-8.44852575]
curr_Stock_Price:  96.93635743233698
curr_Factors:  [96.93635743 -1.02589575 -0.92598918]
mat_Sqrt:  [[13.76555867  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0023792   0.00637021 -0.21670091]
Stock Position:  -0.0023792045214063883
Bond Position:  [-8.21789433]


portfolio before change:  [-8.44975014]
curr_Stock_Price:  97.01919573737112
curr_Factors:  [97.01919574 -1.12430592 -0.90293876]
mat_Sqrt:  [[12.77722354  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00286386 -0.0316816  -0.00838812]
Stock Position:  0.0028638617432120376
Bond Position:  [-8.7275997]


portfolio before change:  [-8.4513711]
curr_Stock_Price:  96.83415069712059
curr_Factors:  [96.8341507  -0.91001451 -0.90980021]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-8.4513711]
Stock Price:  97.65358435255182
PL:  [-8.4513711]
Settle:  Tensor("sub_76:0", shape=(), dtype=float64)
PL:  Tensor("sub_77:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  39
output_Z_Vals[:, i, :]:  [[ 1.19260232e+02 -2.92559343e+01 -2.92733494e+01]
 [ 4.23119442e-02  5.99125134e-02 -6.54407559e-02]
 [-6.74078738e-02 -1.77768809e-02  9.41282536e-02]
 [-9.60632077e-02  5.31990335e-02  8.11525952e-03]
 [ 8.65572342e-02  1.44086218e-02 -6.82411448e-02]
 [ 7.74982609e-02  3.07065871e-02 -6.79295630e-03]
 [ 7.41944645e-02  1.22386351e-02 -7.22884525e-02]
 [-1.42458209e-01  4.09429210e-02 -9.14246414e-02]
 [-8.68923044e-02 -7.56575538e-02  9.21603028e-02]
 [-2.94771277e-02 -1.02629547e-01 -1.32202008e-01]
 [ 6.02047776e-02  1.51977976e-01 -8.78854161e-02]
 [-1.10386935e-01 -3.39725841e-02  2.18053267e-02]
 [-1.14271074e-01  4.92673222e-02 -3.76797403e-02]
 [-9.62623594e-02 -1.14884369e-01  6.32126881e-02]
 [ 2.52904426e-01  3.05913723e-01  2.68447838e-02]
 [-5.84547366e-02 -3.62444666e-01 -5.52224194e-02]
 [-6.70454979e-02 -5.47861438e-02 -4.42591456e-02]
 [-7.48366119e-02  1.90282070e-01  1.29103145e-01]
 [ 2.92344875e-02  5.10223609e-02 -7.86391911e-03]
 [-3.53118458e-02 -1.03778829e-02  1.01727609e-01]
 [-3.35584015e-02 -2.73469918e-02  3.32457887e-03]
 [ 1.21488434e-01 -6.66269029e-02  1.65918936e-01]
 [-7.23698518e-02  7.62834578e-02  3.59022138e-01]
 [-7.03063876e-02 -5.25061881e-04 -8.15101642e-02]
 [-4.36088965e-01  1.33403464e-01  7.77736541e-02]
 [-1.44954192e-01 -2.68362366e-01  1.34758441e-01]
 [ 5.14595475e-02  6.56276512e-02 -3.14360443e-02]
 [ 3.02309843e-02  1.73517100e-03  1.02627881e-02]
 [-1.34964233e-01 -1.98307126e-01 -6.40479336e-02]
 [ 2.33754938e-01  2.95254901e-01  2.69473139e-01]
 [ 9.87219289e-02 -1.32735019e-01  8.88451408e-02]
 [ 9.69198559e-02  1.67044206e-02  7.20995849e-03]
 [ 2.74305964e-01 -1.48404802e-01 -2.30548373e-03]
 [-3.81038522e-02 -7.38371601e-02  2.52314832e-02]
 [-1.93406850e-01  1.78474632e-02  1.15411099e-02]
 [ 2.48856937e-01  7.40248585e-02  3.52486474e-02]
 [ 2.34910791e-02  5.14498530e-03 -1.01853757e-01]
 [-1.30939441e-02  3.54866690e-02 -5.29036655e-02]
 [-1.46624701e-03  5.69784353e-03 -4.48418697e-03]
 [-7.15098344e-01  3.57438359e-01  4.38843512e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.26023247 -29.25593426 -29.27334937]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  8.31486419  -9.25153874 -83.50871763]
init_Out:  [2.49911038]
Stock Position:  8.31486419409362
Bond position:  [-828.98730903]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-3.88401519]
curr_Stock_Price:  99.24478674149071
curr_Factors:  [99.24478674 -0.8713066  -1.00385068]
mat_Sqrt:  [[15.21728741  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00200435  0.018946   -0.18668426]
Stock Position:  0.002004354616699468
Bond Position:  [-4.08293694]


portfolio before change:  [-3.88581162]
curr_Stock_Price:  98.60316929907775
curr_Factors:  [98.6031693  -0.76758051 -1.00738883]
mat_Sqrt:  [[16.71211763  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00291124 -0.00562154  0.26852171]
Stock Position:  -0.0029112421688810477
Bond Position:  [-3.59875392]


portfolio before change:  [-3.88881167]
curr_Stock_Price:  99.4791444780254
curr_Factors:  [99.47914448 -0.603175   -1.00228428]
mat_Sqrt:  [[19.97514486  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00465744  0.01682301  0.02315058]
Stock Position:  -0.004657442774509298
Bond Position:  [-3.42549325]


portfolio before change:  [-3.88914729]
curr_Stock_Price:  99.45926426956494
curr_Factors:  [99.45926427 -0.88160092 -1.02457621]
mat_Sqrt:  [[14.7843772   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00493762  0.00455641 -0.19467299]
Stock Position:  0.00493761738277244
Bond Position:  [-4.38023908]


portfolio before change:  [-3.88645735]
curr_Stock_Price:  100.11494588409228
curr_Factors:  [100.11494588  -0.94375307  -1.01582377]
mat_Sqrt:  [[14.10800193  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00545113  0.00971028 -0.01937841]
Stock Position:  0.005451125932588917
Bond Position:  [-4.43219653]


portfolio before change:  [-3.89163428]
curr_Stock_Price:  99.26688848583021
curr_Factors:  [99.26688849 -0.98097841 -1.00051367]
mat_Sqrt:  [[13.68526877  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00436635  0.0038702  -0.20621883]
Stock Position:  0.004366348016397171
Bond Position:  [-4.32506806]


portfolio before change:  [-3.88894591]
curr_Stock_Price:  100.00641551027509
curr_Factors:  [100.00641551  -0.97450861  -0.99129733]
mat_Sqrt:  [[14.00519589  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01142883  0.01294729 -0.26080905]
Stock Position:  -0.011428832957533898
Bond Position:  [-2.74598929]


portfolio before change:  [-3.88234357]
curr_Stock_Price:  99.39868848212475
curr_Factors:  [99.39868848 -1.21724837 -0.97975783]
mat_Sqrt:  [[11.04671083  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00633977 -0.02392502  0.26290769]
Stock Position:  -0.006339772269515059
Bond Position:  [-3.25217852]


portfolio before change:  [-3.88228079]
curr_Stock_Price:  99.32465891955799
curr_Factors:  [99.32465892 -1.11624469 -0.9542095 ]
mat_Sqrt:  [[12.5276685   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00471857 -0.03245431 -0.37713553]
Stock Position:  -0.004718566198848619
Bond Position:  [-3.41361081]


portfolio before change:  [-3.87855673]
curr_Stock_Price:  98.44498738749841
curr_Factors:  [98.44498739 -1.23271684 -0.94254928]
mat_Sqrt:  [[11.18117735  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00413099  0.04805966 -0.25071263]
Stock Position:  0.004130986850660663
Bond Position:  [-4.28523168]


portfolio before change:  [-3.87666379]
curr_Stock_Price:  99.0328917665364
curr_Factors:  [99.03289177 -1.07993093 -0.94551131]
mat_Sqrt:  [[13.06595237  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00817492 -0.01074307  0.06220453]
Stock Position:  -0.008174919581144302
Bond Position:  [-3.06707786]


portfolio before change:  [-3.8775916]
curr_Stock_Price:  99.09948555384362
curr_Factors:  [99.09948555 -1.09502673 -0.96822575]
mat_Sqrt:  [[12.58960883  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0095865   0.0155797  -0.10748981]
Stock Position:  -0.009586504507369528
Bond Position:  [-2.92757393]


portfolio before change:  [-3.87392555]
curr_Stock_Price:  98.67889260015963
curr_Factors:  [98.6788926  -0.90871886 -0.94890121]
mat_Sqrt:  [[15.3982058   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0056062  -0.03632963  0.1803282 ]
Stock Position:  -0.00560620024551329
Bond Position:  [-3.32071192]


portfolio before change:  [-3.87297735]
curr_Stock_Price:  98.43571266319884
curr_Factors:  [98.43571266 -0.80647507 -0.9598187 ]
mat_Sqrt:  [[16.82910619  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01582275 0.09673841 0.0765807 ]
Stock Position:  0.015822750795124248
Bond Position:  [-5.4305011]


portfolio before change:  [-3.88094456]
curr_Stock_Price:  97.9750873940584
curr_Factors:  [97.97508739 -0.75474327 -0.92352882]
mat_Sqrt:  [[18.29158549  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00432359 -0.11461507 -0.15753419]
Stock Position:  -0.004323586209566462
Bond Position:  [-3.45734083]


portfolio before change:  [-3.88373431]
curr_Stock_Price:  98.5203640611572
curr_Factors:  [98.52036406 -0.77039211 -0.91141462]
mat_Sqrt:  [[18.32848738  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00422809 -0.0173249  -0.12625902]
Stock Position:  -0.0042280865145685785
Bond Position:  [-3.46718169]


portfolio before change:  [-3.88379526]
curr_Stock_Price:  98.4322699678905
curr_Factors:  [98.43226997 -0.70065126 -0.89628072]
mat_Sqrt:  [[19.93419727  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00218572  0.06017247  0.36829534]
Stock Position:  -0.002185715345432698
Bond Position:  [-3.66865034]


portfolio before change:  [-3.8817578]
curr_Stock_Price:  97.29027736303556
curr_Factors:  [97.29027736 -0.59262183 -0.86747866]
mat_Sqrt:  [[22.59206111  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00128128  0.01613469 -0.02243357]
Stock Position:  0.0012812759006861595
Bond Position:  [-4.00641349]


portfolio before change:  [-3.88199292]
curr_Stock_Price:  97.49766193286723
curr_Factors:  [97.49766193 -0.5736327  -0.86940968]
mat_Sqrt:  [[23.02973048  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00064329 -0.00328177  0.29020055]
Stock Position:  -0.0006432876150476046
Bond Position:  [-3.81927388]


portfolio before change:  [-3.88349353]
curr_Stock_Price:  99.08819230375165
curr_Factors:  [99.0881923  -0.38613598 -0.87752279]
mat_Sqrt:  [[28.00411636  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00119932 -0.00864788  0.0094841 ]
Stock Position:  -0.0011993190754014244
Bond Position:  [-3.76465517]


portfolio before change:  [-3.88299441]
curr_Stock_Price:  98.27962263698723
curr_Factors:  [98.27962264 -0.49774951 -0.86909153]
mat_Sqrt:  [[25.0525512   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00613256 -0.02106928  0.47332054]
Stock Position:  0.006132556889520264
Bond Position:  [-4.48569978]


portfolio before change:  [-3.88888233]
curr_Stock_Price:  97.41095070700916
curr_Factors:  [97.41095071 -0.40082968 -0.86859173]
mat_Sqrt:  [[27.37190775  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [1.05395124e-04 2.41229474e-02 1.02419023e+00]
Stock Position:  0.00010539512423661335
Bond Position:  [-3.89914897]


portfolio before change:  [-3.88950177]
curr_Stock_Price:  96.15843637116019
curr_Factors:  [96.15843637 -0.19272839 -0.87328418]
mat_Sqrt:  [[33.11494319  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-2.62594856e-03 -1.66039146e-04 -2.32525811e-01]
Stock Position:  -0.0026259485572931963
Bond Position:  [-3.63699466]


portfolio before change:  [-3.89030624]
curr_Stock_Price:  96.29165235682126
curr_Factors:  [96.29165236 -0.39463667 -0.84600783]
mat_Sqrt:  [[27.84733126  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01496621  0.04218588  0.22186659]
Stock Position:  -0.014966210522094372
Bond Position:  [-2.4491851]


portfolio before change:  [-3.86435513]
curr_Stock_Price:  94.53721526255772
curr_Factors:  [94.53721526 -0.12108739 -0.84814813]
mat_Sqrt:  [[35.86486246  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0034679  -0.08486363  0.38442832]
Stock Position:  -0.0034679019564954816
Bond Position:  [-3.53650934]


portfolio before change:  [-3.86438315]
curr_Stock_Price:  94.41781390696657
curr_Factors:  [94.41781391 -0.21246356 -0.821534  ]
mat_Sqrt:  [[33.57333669  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00139209  0.02075329 -0.08967828]
Stock Position:  0.001392092506938838
Bond Position:  [-3.99582148]


portfolio before change:  [-3.86398958]
curr_Stock_Price:  95.05935160593235
curr_Factors:  [ 9.50593516e+01  2.85147711e-02 -8.50771894e-01]
mat_Sqrt:  [[41.77275477  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00077492 0.00054871 0.02927688]
Stock Position:  0.0007749230141479678
Bond Position:  [-3.93765326]


portfolio before change:  [-3.8654781]
curr_Stock_Price:  93.77369239785112
curr_Factors:  [93.7736924  -0.10998864 -0.84605579]
mat_Sqrt:  [[36.04758711  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00424878 -0.06271022 -0.18271093]
Stock Position:  -0.004248778987573517
Bond Position:  [-3.46705441]


portfolio before change:  [-3.85425704]
curr_Stock_Price:  91.03067464989911
curr_Factors:  [91.03067465 -0.42033669 -0.80168884]
mat_Sqrt:  [[26.82062034  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01105062 0.0933678  0.76873186]
Stock Position:  0.011050615425038737
Bond Position:  [-4.86020201]


portfolio before change:  [-3.8462994]
curr_Stock_Price:  91.80576212356267
curr_Factors:  [91.80576212 -0.30332608 -0.79168936]
mat_Sqrt:  [[30.71218967  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00369333 -0.0419745   0.25345046]
Stock Position:  0.0036933271486876557
Bond Position:  [-4.18536812]


portfolio before change:  [-3.83937163]
curr_Stock_Price:  93.82317913788553
curr_Factors:  [93.82317914 -0.40150441 -0.78173288]
mat_Sqrt:  [[28.73668858  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00343891 0.0052824  0.020568  ]
Stock Position:  0.0034389101074594835
Bond Position:  [-4.16202111]


portfolio before change:  [-3.83792907]
curr_Stock_Price:  94.39395373142528
curr_Factors:  [94.39395373 -0.4569489  -0.79586536]
mat_Sqrt:  [[26.96831785  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01001188 -0.04692972 -0.0065769 ]
Stock Position:  0.01001188005980786
Bond Position:  [-4.78299001]


portfolio before change:  [-3.85844225]
curr_Stock_Price:  92.40478978823711
curr_Factors:  [92.40478979 -0.29005155 -0.79691853]
mat_Sqrt:  [[31.16229097  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00111866 -0.02334936  0.0719784 ]
Stock Position:  -0.0011186585927130653
Bond Position:  [-3.75507284]


portfolio before change:  [-3.85902683]
curr_Stock_Price:  92.50774235156126
curr_Factors:  [92.50774235 -0.13546401 -0.79899124]
mat_Sqrt:  [[36.33702156  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00524507  0.00564386  0.03292357]
Stock Position:  -0.0052450697008025035
Bond Position:  [-3.37381728]


portfolio before change:  [-3.86671056]
curr_Stock_Price:  93.89227477358035
curr_Factors:  [93.89227477 -0.18471003 -0.8063225 ]
mat_Sqrt:  [[34.85217617  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00740164 0.02340872 0.10055458]
Stock Position:  0.007401642564318248
Bond Position:  [-4.56166761]


portfolio before change:  [-3.8617801]
curr_Stock_Price:  94.63544789502053
curr_Factors:  [94.6354479  -0.18047348 -0.81162269]
mat_Sqrt:  [[35.09069356  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 8.07368198e-05  1.62698721e-03 -2.90560418e-01]
Stock Position:  8.073681984088186e-05
Bond Position:  [-3.86942066]


portfolio before change:  [-3.86218887]
curr_Stock_Price:  95.5635967462636
curr_Factors:  [95.56359675 -0.43371199 -0.83577017]
mat_Sqrt:  [[26.85118069  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0008557   0.01122187 -0.15091943]
Stock Position:  -0.0008557015809106789
Bond Position:  [-3.78041495]


portfolio before change:  [-3.86554808]
curr_Stock_Price:  98.93700647324629
curr_Factors:  [98.93700647 -0.6049906  -0.84518286]
mat_Sqrt:  [[23.20365702  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-9.62977581e-05  1.80181633e-03 -1.27921373e-02]
Stock Position:  -9.62977581474583e-05
Bond Position:  [-3.85602067]


portfolio before change:  [-3.86612513]
curr_Stock_Price:  99.92368189093416
curr_Factors:  [99.92368189 -0.44893316 -0.81885513]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-3.86612513]
Stock Price:  100.08385091405799
PL:  [-3.94997605]
Settle:  Tensor("sub_78:0", shape=(), dtype=float64)
PL:  Tensor("sub_79:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  40
output_Z_Vals[:, i, :]:  [[ 1.19260232e+02 -2.92559343e+01 -2.92733494e+01]
 [ 4.93471038e-03 -1.17978455e-01 -3.84657839e-02]
 [-2.77129828e-02  4.98582715e-02  1.00627914e-01]
 [ 8.47430147e-02  1.68273901e-01  3.79293065e-02]
 [ 1.70395157e-01 -1.42284913e-02 -6.03053874e-02]
 [ 7.37345116e-02  3.01584796e-02 -4.87407757e-02]
 [ 7.39590620e-02  1.24361720e-02 -7.18781278e-02]
 [-1.42432560e-01  4.08539262e-02 -9.14513448e-02]
 [-6.74020219e-02 -5.20920363e-02  6.84447954e-02]
 [-4.90025785e-02  1.39654894e-01  2.12958996e-02]
 [ 5.50433916e-02  1.04332047e-01 -7.92365830e-02]
 [-2.20494735e-02  7.15111353e-02 -9.93846235e-03]
 [-1.05268475e-01  3.60169765e-02 -5.01576103e-02]
 [ 8.82883538e-03  4.53831388e-02  1.51312118e-01]
 [ 2.46715277e-01  3.54218275e-01  8.97808705e-02]
 [-6.83282134e-02 -5.23553266e-02 -1.02568665e-01]
 [-7.77305589e-02 -3.09015394e-02 -7.02456974e-02]
 [-3.44168809e-02  5.11114589e-02  5.36768623e-02]
 [ 5.27491721e-02  7.17824747e-02  6.70694059e-02]
 [ 3.05672832e-01 -7.86446074e-02 -5.22638561e-02]
 [-4.31533804e-02 -3.49014931e-03 -4.14630975e-02]
 [ 6.03175586e-02 -4.71016710e-02  5.86177790e-02]
 [-4.52669020e-02 -3.46003518e-03  1.79301675e-01]
 [-5.11208348e-04 -8.46906048e-03 -7.31447621e-02]
 [-1.40352581e-01  8.18540543e-02  6.03401843e-02]
 [ 3.62978767e-03 -1.01394023e-01  8.71263362e-02]
 [ 3.14087945e-02  4.98822539e-02 -5.24212968e-02]
 [-4.04296617e-03  3.36568026e-02  1.75112799e-02]
 [-5.73778899e-02 -5.09504021e-02 -2.32974926e-01]
 [ 2.18581466e-02  3.51541331e-03 -7.17815299e-02]
 [ 1.72877228e-02  1.58553590e-01  2.75710332e-02]
 [ 1.62059764e-02 -8.34184654e-02 -7.94665176e-02]
 [ 1.37391795e-01 -1.45624207e-01 -7.65704957e-02]
 [-5.15530928e-02 -8.69671228e-02 -1.17673428e-02]
 [-1.35334014e-01  7.84461205e-02  3.56211078e-02]
 [ 8.47165236e-02 -1.65012150e-01 -1.38726811e-01]
 [-1.16697233e-01 -2.21244783e-01  2.96994550e-03]
 [-3.47527876e-02 -8.98882817e-03 -1.51243339e-02]
 [-4.24082340e-02  9.06705086e-02 -2.18633222e-02]
 [-7.86523879e-02  5.72749229e-02  4.50695971e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.26023247 -29.25593426 -29.27334937]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  8.31486419  -9.25153874 -83.50871763]
init_Out:  [2.49911038]
Stock Position:  8.31486419409362
Bond position:  [-828.98730903]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-1.19125011]
curr_Stock_Price:  99.56863629789582
curr_Factors:  [99.5686363  -0.87983477 -0.97546895]
mat_Sqrt:  [[15.57307556  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00038292 -0.03730806 -0.10973217]
Stock Position:  -0.00038292214331672676
Bond Position:  [-1.15312308]


portfolio before change:  [-1.19143803]
curr_Stock_Price:  99.68293553263283
curr_Factors:  [99.68293553 -1.02142347 -0.98761293]
mat_Sqrt:  [[13.36926089  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00044019  0.01576657  0.28706343]
Stock Position:  -0.0004401934245412378
Bond Position:  [-1.14755826]


portfolio before change:  [-1.19161918]
curr_Stock_Price:  99.76857952435549
curr_Factors:  [99.76857952 -1.02043838 -1.00032115]
mat_Sqrt:  [[13.22479885  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00732186 0.05321288 0.10820175]
Stock Position:  0.007321859223407768
Bond Position:  [-1.92211068]


portfolio before change:  [-1.18998254]
curr_Stock_Price:  100.02492482250796
curr_Factors:  [100.02492482  -1.10503711  -0.99814697]
mat_Sqrt:  [[12.20975626  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01291737 -0.00449944 -0.17203448]
Stock Position:  0.012917374411908844
Bond Position:  [-2.48204194]


portfolio before change:  [-1.19409218]
curr_Stock_Price:  99.73079655763506
curr_Factors:  [99.73079656 -0.96364698 -1.00694053]
mat_Sqrt:  [[13.89997461  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0046449   0.00953695 -0.13904387]
Stock Position:  0.00464490279843564
Bond Position:  [-1.65733203]


portfolio before change:  [-1.19591655]
curr_Stock_Price:  99.38263097014959
curr_Factors:  [99.38263097 -0.8916163  -1.014258  ]
mat_Sqrt:  [[14.77746023  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00403372  0.00393266 -0.20504829]
Stock Position:  0.004033717586266834
Bond Position:  [-1.59679802]


portfolio before change:  [-1.19354068]
curr_Stock_Price:  100.02111883947978
curr_Factors:  [100.02111884  -1.02718867  -0.99587856]
mat_Sqrt:  [[13.22771336  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01209923  0.01291915 -0.26088523]
Stock Position:  -0.012099229813431195
Bond Position:  [0.01663782]


portfolio before change:  [-1.19766799]
curr_Stock_Price:  100.36241222543292
curr_Factors:  [100.36241223  -1.10747089  -0.99367671]
mat_Sqrt:  [[12.27592651  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00446205 -0.01647295  0.19525395]
Stock Position:  -0.004462049943753259
Bond Position:  [-0.74984589]


portfolio before change:  [-1.19798997]
curr_Stock_Price:  100.41356373972552
curr_Factors:  [100.41356374  -1.15999241  -0.99793655]
mat_Sqrt:  [[11.60421426  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00353748  0.04416276  0.06075127]
Stock Position:  -0.0035374818518104497
Bond Position:  [-0.84277881]


portfolio before change:  [-1.19841102]
curr_Stock_Price:  100.5028072902978
curr_Factors:  [100.50280729  -1.40913813  -1.0200902 ]
mat_Sqrt:  [[ 8.8547791   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00469386  0.03299269 -0.22603992]
Stock Position:  0.004693864550808824
Bond Position:  [-1.67015758]


portfolio before change:  [-1.19841123]
curr_Stock_Price:  100.54724124118297
curr_Factors:  [100.54724124  -1.56252907  -0.99192943]
mat_Sqrt:  [[ 7.81597078  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0028444   0.02261381 -0.02835167]
Stock Position:  -0.0028443995907157385
Bond Position:  [-0.9124147]


portfolio before change:  [-1.1986385]
curr_Stock_Price:  100.5870404447433
curr_Factors:  [100.58704044  -1.39219685  -0.9951767 ]
mat_Sqrt:  [[ 9.24099786  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01239876  0.01138957 -0.1430857 ]
Stock Position:  -0.012398758429649383
Bond Position:  [0.04851592]


portfolio before change:  [-1.20417544]
curr_Stock_Price:  101.03410170493851
curr_Factors:  [101.0341017   -1.27012468  -0.99023223]
mat_Sqrt:  [[10.53919525  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00387953 0.01435141 0.43165136]
Stock Position:  0.0038795257825436002
Bond Position:  [-1.59613984]


portfolio before change:  [-1.2053706]
curr_Stock_Price:  100.77746305592154
curr_Factors:  [100.77746306  -1.22266782  -1.00909022]
mat_Sqrt:  [[10.81740827  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.02534688 0.11201365 0.25611983]
Stock Position:  0.025346884357482488
Bond Position:  [-3.75976531]


portfolio before change:  [-1.18772976]
curr_Stock_Price:  101.49198243756734
curr_Factors:  [101.49198244  -1.53768688  -0.96863371]
mat_Sqrt:  [[ 8.27847866  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01094606 -0.01655621 -0.29259985]
Stock Position:  -0.010946064699258835
Bond Position:  [-0.07679196]


portfolio before change:  [-1.19085072]
curr_Stock_Price:  101.77622666201444
curr_Factors:  [101.77622666  -1.53139329  -0.96789303]
mat_Sqrt:  [[ 8.3602659   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01110817 -0.00977192 -0.20039142]
Stock Position:  -0.011108172538915842
Bond Position:  [-0.06030283]


portfolio before change:  [-1.19158413]
curr_Stock_Price:  101.84157206262647
curr_Factors:  [101.84157206  -1.4478926   -0.97085803]
mat_Sqrt:  [[ 9.06723857  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00244181  0.01616286  0.15312515]
Stock Position:  -0.0024418068323186558
Bond Position:  [-0.94290668]


portfolio before change:  [-1.19089059]
curr_Stock_Price:  101.50927484392638
curr_Factors:  [101.50927484  -1.1858972   -0.98650627]
mat_Sqrt:  [[11.56226417  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00590655 0.02269961 0.19133035]
Stock Position:  0.005906548382731111
Bond Position:  [-1.79046003]


portfolio before change:  [-1.1889659]
curr_Stock_Price:  101.87302539795861
curr_Factors:  [101.8730254   -0.93573916  -0.97959309]
mat_Sqrt:  [[15.00517198  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01952486 -0.02486961 -0.14909423]
Stock Position:  0.01952486262915709
Bond Position:  [-3.17802273]


portfolio before change:  [-1.2063711]
curr_Stock_Price:  101.0019349894722
curr_Factors:  [101.00193499  -1.14931325  -0.97758262]
mat_Sqrt:  [[12.0401128   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00429457 -0.00110368 -0.11828268]
Stock Position:  -0.004294570645814601
Bond Position:  [-0.77261116]


portfolio before change:  [-1.21011099]
curr_Stock_Price:  101.85028769247681
curr_Factors:  [101.85028769  -1.42377532  -0.98743478]
mat_Sqrt:  [[ 9.13665063  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0077782  -0.01489486  0.16722021]
Stock Position:  0.00777820074110216
Bond Position:  [-2.00232298]


portfolio before change:  [-1.21462394]
curr_Stock_Price:  101.3022643136585
curr_Factors:  [101.30226431  -1.25201849  -0.98102631]
mat_Sqrt:  [[10.85975725  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00080632 -0.00109416  0.51149777]
Stock Position:  -0.000806319920336216
Bond Position:  [-1.1329419]


portfolio before change:  [-1.21455392]
curr_Stock_Price:  101.03978016917593
curr_Factors:  [101.03978017  -1.29024861  -0.9796932 ]
mat_Sqrt:  [[10.43924747  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00150016 -0.00267815 -0.20866165]
Stock Position:  -0.0015001551245068373
Bond Position:  [-1.06297857]


portfolio before change:  [-1.21380051]
curr_Stock_Price:  100.44898628511348
curr_Factors:  [100.44898629  -1.13104308  -0.96467283]
mat_Sqrt:  [[12.35343409  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0101933   0.02588452  0.17213375]
Stock Position:  -0.010193297561016237
Bond Position:  [-0.18989411]


portfolio before change:  [-1.21046805]
curr_Stock_Price:  100.1197302785321
curr_Factors:  [100.11973028  -1.09337145  -0.99319195]
mat_Sqrt:  [[12.42615304  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00151265 -0.03206361  0.24854719]
Stock Position:  0.001512647887914894
Bond Position:  [-1.36191395]


portfolio before change:  [-1.21119159]
curr_Stock_Price:  99.75395392927078
curr_Factors:  [99.75395393 -0.98665674 -0.98484433]
mat_Sqrt:  [[13.89050655  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00158355  0.01577415 -0.14954337]
Stock Position:  0.0015835488983628522
Bond Position:  [-1.36915685]


portfolio before change:  [-1.2098161]
curr_Stock_Price:  100.73064653297028
curr_Factors:  [100.73064653  -1.19646227  -0.97842891]
mat_Sqrt:  [[11.44506816  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [3.49953163e-05 1.06432155e-02 4.99548074e-02]
Stock Position:  3.499531629995721e-05
Bond Position:  [-1.2133412]


portfolio before change:  [-1.20994414]
curr_Stock_Price:  101.40604989738648
curr_Factors:  [101.4060499   -1.39390701  -0.98432468]
mat_Sqrt:  [[ 9.40179907  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01130095 -0.01611193 -0.66461262]
Stock Position:  -0.011300946800861866
Bond Position:  [-0.06395977]


portfolio before change:  [-1.21342928]
curr_Stock_Price:  101.71373519138876
curr_Factors:  [101.71373519  -1.25612129  -0.97119841]
mat_Sqrt:  [[10.96647233  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00066535  0.00111167 -0.20477272]
Stock Position:  0.0006653525858938263
Bond Position:  [-1.28110477]


portfolio before change:  [-1.21310775]
curr_Stock_Price:  102.43767137796108
curr_Factors:  [102.43767138  -1.28355151  -0.96748024]
mat_Sqrt:  [[10.78571727  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00250419 0.05013905 0.07865248]
Stock Position:  0.0025041888072911372
Bond Position:  [-1.46963102]


portfolio before change:  [-1.21253581]
curr_Stock_Price:  102.73942904842566
curr_Factors:  [102.73942905  -1.2689114   -0.94653854]
mat_Sqrt:  [[11.20932515  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-1.93491946e-04 -2.63792349e-02 -2.26695855e-01]
Stock Position:  -0.00019349194612133198
Bond Position:  [-1.19265656]


portfolio before change:  [-1.21261734]
curr_Stock_Price:  102.39027283233396
curr_Factors:  [102.39027283  -1.0981631   -0.95741013]
mat_Sqrt:  [[13.10794433  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00900232 -0.04605042 -0.21843431]
Stock Position:  0.009002319844122331
Bond Position:  [-2.13436733]


portfolio before change:  [-1.21636634]
curr_Stock_Price:  102.0034632492768
curr_Factors:  [102.00346325  -1.17481852  -0.96950922]
mat_Sqrt:  [[11.94937568  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00470322 -0.02750142 -0.03356895]
Stock Position:  -0.00470322254625218
Bond Position:  [-0.73662135]


portfolio before change:  [-1.21775856]
curr_Stock_Price:  102.2798997127984
curr_Factors:  [102.27989971  -1.2529231   -0.97355716]
mat_Sqrt:  [[11.03677529  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01141977  0.02480684  0.10161711]
Stock Position:  -0.011419768214404734
Bond Position:  [-0.04974581]


portfolio before change:  [-1.22344783]
curr_Stock_Price:  102.77754966031227
curr_Factors:  [102.77754966  -1.1073008   -0.94284586]
mat_Sqrt:  [[13.2291176   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00394119 -0.05218142 -0.39574898]
Stock Position:  0.00394118776744231
Bond Position:  [-1.62851345]


portfolio before change:  [-1.23011987]
curr_Stock_Price:  101.1363016742086
curr_Factors:  [101.13630167  -0.88292544  -0.94302217]
mat_Sqrt:  [[16.28951291  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00747742 -0.06996374  0.00847243]
Stock Position:  -0.007477418888591499
Bond Position:  [-0.47388138]


portfolio before change:  [-1.23384472]
curr_Stock_Price:  101.62652531920305
curr_Factors:  [101.62652532  -0.82844345  -0.94032807]
mat_Sqrt:  [[17.33162821  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00219668 -0.00284252 -0.04314551]
Stock Position:  -0.0021966845461318667
Bond Position:  [-1.0106033]


portfolio before change:  [-1.23633631]
curr_Stock_Price:  102.70326783881235
curr_Factors:  [102.70326784  -0.78570515  -0.93761277]
mat_Sqrt:  [[18.32976087  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00242938  0.02867253 -0.06236997]
Stock Position:  -0.0024293804914853074
Bond Position:  [-0.986831]


portfolio before change:  [-1.23836477]
curr_Stock_Price:  103.48745517939894
curr_Factors:  [103.48745518  -0.81425808  -0.94467677]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-1.23836477]
Stock Price:  104.28475345026509
PL:  [-5.52311822]
Settle:  Tensor("sub_80:0", shape=(), dtype=float64)
PL:  Tensor("sub_81:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  41
output_Z_Vals[:, i, :]:  [[ 1.19260232e+02 -2.92559343e+01 -2.92733494e+01]
 [-1.68501600e-01  4.92730720e-01  8.50129546e-02]
 [ 1.34949238e-01  7.78471430e-02 -7.15773703e-02]
 [ 8.51609813e-02  1.72074483e-01  3.79800820e-02]
 [ 2.28862966e-01 -1.95282601e-02 -3.81489157e-02]
 [ 5.22363373e-02  2.97474135e-02  3.58137862e-02]
 [ 7.04212942e-02  1.54048726e-02 -6.57115259e-02]
 [-1.06981904e-01 -5.55588053e-02 -1.17979504e-01]
 [-5.82223751e-02 -7.06902569e-02  7.17053708e-02]
 [-6.00599561e-02 -1.19536023e-01 -1.28903684e-01]
 [ 5.78022732e-02  1.63277236e-01 -8.54872710e-02]
 [-1.82861539e-01 -1.01528008e-01  3.75205290e-02]
 [-1.14402613e-01  4.79569960e-02 -2.44584713e-02]
 [-9.62623594e-02 -1.14884369e-01  6.32126881e-02]
 [ 3.85805412e-01  4.48852760e-01  1.67040258e-02]
 [-6.24905122e-02 -2.12931427e-01 -8.47083908e-02]
 [-6.87433514e-02 -6.49432940e-02 -6.05254827e-02]
 [-7.39828038e-02  2.13594254e-01  1.36593411e-01]
 [ 1.40194158e-01  6.43213698e-02  1.59448538e-01]
 [ 1.26671795e-01 -4.38760395e-02  3.44865009e-02]
 [-3.94591564e-02 -1.26754243e-02 -2.42191088e-02]
 [ 1.04473163e-01 -6.22035410e-02  1.11176549e-01]
 [-3.04341346e-02 -6.13934761e-02  2.05846754e-01]
 [-6.63106321e-02 -6.20145828e-04 -8.26744184e-02]
 [-1.73843350e-01  7.87135473e-02  8.57565519e-02]
 [ 7.66993324e-03 -9.72734382e-02  8.58788740e-02]
 [-1.68500272e-01  6.87619527e-02  6.11262143e-02]
 [-5.07806065e-02  7.36225950e-02  2.93687317e-02]
 [ 6.20848838e-02 -6.23725319e-02  9.08311027e-02]
 [ 4.13292819e-02  1.01884162e-02 -2.41409837e-02]
 [-4.07598101e-02  3.40762381e-01  1.27055360e-02]
 [ 1.76486606e-02 -9.54198297e-02 -7.90069224e-02]
 [ 1.47948215e-01 -6.79155788e-02  5.77361506e-02]
 [-5.17054584e-02 -8.71158713e-02 -1.21865000e-02]
 [-1.72662133e-01  1.48045462e-01  3.00603039e-02]
 [ 1.11110863e-01 -1.53853321e-01 -1.25233125e-01]
 [-2.05131842e-01 -3.46814837e-01  5.88388011e-02]
 [-5.31803895e-02 -4.20117313e-02  7.16238188e-02]
 [-2.96756664e-02  6.39688495e-02 -2.98524317e-02]
 [ 8.17447089e-02  8.68727734e-04 -7.56531014e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.26023247 -29.25593426 -29.27334937]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  8.31486419  -9.25153874 -83.50871763]
init_Out:  [2.49911038]
Stock Position:  8.31486419409362
Bond position:  [-828.98730903]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [12.74908945]
curr_Stock_Price:  101.24519279138686
curr_Factors:  [101.24519279  -1.28580742  -1.01885433]
mat_Sqrt:  [[10.10351593  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01370079  0.15581513  0.2425183 ]
Stock Position:  -0.013700790048576605
Bond Position:  [14.13622858]


portfolio before change:  [12.7475736]
curr_Stock_Price:  101.48481317355531
curr_Factors:  [101.48481317  -1.33268954  -1.03288195]
mat_Sqrt:  [[ 9.52897998  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01283963  0.02461743 -0.20419031]
Stock Position:  0.012839629567786082
Bond Position:  [11.44454619]


portfolio before change:  [12.74882247]
curr_Stock_Price:  101.4706551351456
curr_Factors:  [101.47065514  -1.21593938  -1.0580511 ]
mat_Sqrt:  [[10.44140515  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00932409 0.05441473 0.1083466 ]
Stock Position:  0.009324087680175706
Bond Position:  [11.80270118]


portfolio before change:  [12.75270652]
curr_Stock_Price:  101.72897708947612
curr_Factors:  [101.72897709  -1.10773235  -1.0488389 ]
mat_Sqrt:  [[11.77220137  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01873665 -0.00617538 -0.10882824]
Stock Position:  0.01873665141192337
Bond Position:  [10.84664613]


portfolio before change:  [12.73474747]
curr_Stock_Price:  100.69811196896799
curr_Factors:  [100.69811197  -0.82983105  -1.05478784]
mat_Sqrt:  [[15.29472739  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00394351 0.00940696 0.10216676]
Stock Position:  0.003943507405586019
Bond Position:  [12.33764372]


portfolio before change:  [12.7326388]
curr_Stock_Price:  99.77229304622438
curr_Factors:  [99.77229305 -0.95460175 -1.03420322]
mat_Sqrt:  [[13.65472407  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00420409  0.00487145 -0.18745669]
Stock Position:  0.004204093541057781
Bond Position:  [12.31318675]


portfolio before change:  [12.73232829]
curr_Stock_Price:  99.33230458094906
curr_Factors:  [99.33230458 -0.99004143 -1.01372153]
mat_Sqrt:  [[13.39267457  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00989339 -0.01756924 -0.33656269]
Stock Position:  -0.009893385446018815
Bond Position:  [13.71506107]


portfolio before change:  [12.73411044]
curr_Stock_Price:  99.32546543497769
curr_Factors:  [99.32546543 -1.0972514  -0.9909204 ]
mat_Sqrt:  [[12.3077629   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00368961 -0.02235422  0.20455546]
Stock Position:  -0.00368960569687973
Bond Position:  [13.10058225]


portfolio before change:  [12.7395879]
curr_Stock_Price:  98.28476306942956
curr_Factors:  [98.28476307 -0.92183447 -0.97115167]
mat_Sqrt:  [[14.80378476  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00604296 -0.03780061 -0.36772633]
Stock Position:  -0.006042962579101592
Bond Position:  [13.33351905]


portfolio before change:  [12.73613855]
curr_Stock_Price:  99.1313918472154
curr_Factors:  [99.13139185 -1.03362491 -0.98204392]
mat_Sqrt:  [[13.20740075  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00337448  0.0516328  -0.24387139]
Stock Position:  0.0033744760263197363
Bond Position:  [12.40162204]


portfolio before change:  [12.73356724]
curr_Stock_Price:  97.90998513858501
curr_Factors:  [97.90998514 -0.93367679 -0.97040733]
mat_Sqrt:  [[14.58457435  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01219262 -0.03210598  0.10703563]
Stock Position:  -0.012192617426979585
Bond Position:  [13.92734623]


portfolio before change:  [12.7350521]
curr_Stock_Price:  97.93099522527642
curr_Factors:  [97.93099523 -1.10718178 -0.99723188]
mat_Sqrt:  [[11.93946673  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00989633  0.01516533 -0.06977321]
Stock Position:  -0.009896332568668951
Bond Position:  [13.7042098]


portfolio before change:  [12.73512433]
curr_Stock_Price:  98.09680468134427
curr_Factors:  [98.09680468 -1.06608346 -1.00485845]
mat_Sqrt:  [[12.36676812  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00698044 -0.03632963  0.1803282 ]
Stock Position:  -0.0069804353318376625
Bond Position:  [13.41988273]


portfolio before change:  [12.73875712]
curr_Stock_Price:  97.81670712736332
curr_Factors:  [97.81670713 -1.16282382 -1.01502962]
mat_Sqrt:  [[11.08111098  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.03617006 0.14193971 0.04765194]
Stock Position:  0.03617005872529172
Bond Position:  [9.20072108]


portfolio before change:  [12.78001756]
curr_Stock_Price:  98.92564307342084
curr_Factors:  [98.92564307 -1.14815471 -1.01699506]
mat_Sqrt:  [[11.3500111   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0075136  -0.06733483 -0.24164946]
Stock Position:  -0.007513596690506385
Bond Position:  [13.52330494]


portfolio before change:  [12.77877459]
curr_Stock_Price:  99.31606728638423
curr_Factors:  [99.31606729 -1.05973118 -1.05254898]
mat_Sqrt:  [[12.01345408  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00689018 -0.02053687 -0.17266236]
Stock Position:  -0.006890182613830893
Bond Position:  [13.46308043]


portfolio before change:  [12.77836306]
curr_Stock_Price:  99.6200531454729
curr_Factors:  [99.62005315 -1.32198394 -1.03736702]
mat_Sqrt:  [[ 9.41225459  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00431202  0.06754443  0.38966298]
Stock Position:  -0.004312017931903203
Bond Position:  [13.20792652]


portfolio before change:  [12.77924244]
curr_Stock_Price:  99.79902172606816
curr_Factors:  [99.79902173 -1.18569476 -1.05066863]
mat_Sqrt:  [[10.6631619   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01635558 0.0203402  0.4548623 ]
Stock Position:  0.01635558257596993
Bond Position:  [11.1469713]


portfolio before change:  [12.78703434]
curr_Stock_Price:  100.19023009613124
curr_Factors:  [100.1902301   -1.27106612  -1.07766167]
mat_Sqrt:  [[ 9.56722205  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01385757 -0.01387482  0.09838039]
Stock Position:  0.01385756991579865
Bond Position:  [11.39864122]


portfolio before change:  [12.78564022]
curr_Stock_Price:  99.9868002900077
curr_Factors:  [99.98680029 -0.96548384 -1.07940299]
mat_Sqrt:  [[12.93777519  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00345733 -0.00400832 -0.06909038]
Stock Position:  -0.0034573285337179275
Bond Position:  [13.13132743]


portfolio before change:  [12.7887016]
curr_Stock_Price:  99.57611639360664
curr_Factors:  [99.57611639 -0.83052706 -1.08919501]
mat_Sqrt:  [[14.60260987  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00859852 -0.01967049  0.31715575]
Stock Position:  0.008598524056514074
Bond Position:  [11.93249397]


portfolio before change:  [12.7804632]
curr_Stock_Price:  98.44452060310466
curr_Factors:  [98.4445206  -0.92603957 -1.12377809]
mat_Sqrt:  [[12.67555686  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00078884 -0.01941432  0.58722349]
Stock Position:  0.0007888399326430034
Bond Position:  [12.70280624]


portfolio before change:  [12.78260958]
curr_Stock_Price:  99.15242290786979
curr_Factors:  [99.15242291 -0.85805786 -1.15229523]
mat_Sqrt:  [[13.28061156  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-6.26495917e-03 -1.96107330e-04 -2.35847104e-01]
Stock Position:  -0.0062649591656155435
Bond Position:  [13.40379546]


portfolio before change:  [12.78321698]
curr_Stock_Price:  99.32292290251435
curr_Factors:  [99.3229229  -0.66698303 -1.1267316 ]
mat_Sqrt:  [[16.52148679  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00933972  0.02489141  0.24463957]
Stock Position:  -0.009339715853795734
Bond Position:  [13.71086486]


portfolio before change:  [12.78013933]
curr_Stock_Price:  99.83595930325619
curr_Factors:  [99.8359593  -0.55417502 -1.12131989]
mat_Sqrt:  [[18.69083925  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00121387 -0.03076056  0.24498852]
Stock Position:  0.0012138724911806898
Bond Position:  [12.65895121]


portfolio before change:  [12.78429094]
curr_Stock_Price:  101.95244013834248
curr_Factors:  [101.95244014  -0.9060062   -1.1475742 ]
mat_Sqrt:  [[13.07792936  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01179449  0.02174444  0.17437608]
Stock Position:  -0.011794490241364822
Bond Position:  [13.986768]


portfolio before change:  [12.78719478]
curr_Stock_Price:  101.85447976064809
curr_Factors:  [101.85447976  -0.75384781  -1.14930583]
mat_Sqrt:  [[15.18626627  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00282392  0.02328151  0.08378082]
Stock Position:  -0.0028239207218051852
Bond Position:  [13.07482376]


portfolio before change:  [12.78616669]
curr_Stock_Price:  102.797336252093
curr_Factors:  [102.79733625  -0.93021348  -1.1664819 ]
mat_Sqrt:  [[12.6298627   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00625622 -0.01972393  0.25911585]
Stock Position:  0.006256224237342871
Bond Position:  [12.1430435]


portfolio before change:  [12.78812372]
curr_Stock_Price:  102.86751532558216
curr_Factors:  [102.86751533  -0.85314894  -1.1536322 ]
mat_Sqrt:  [[13.82751933  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00265157  0.00322186 -0.06886751]
Stock Position:  0.002651566573967304
Bond Position:  [12.51536365]


portfolio before change:  [12.79238669]
curr_Stock_Price:  103.88519713556532
curr_Factors:  [103.88519714  -0.92665734  -1.14075688]
mat_Sqrt:  [[13.14277529  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00223452  0.10775853  0.03624536]
Stock Position:  -0.0022345247466862284
Bond Position:  [13.02452073]


portfolio before change:  [12.79730357]
curr_Stock_Price:  102.4134214448153
curr_Factors:  [102.41342144  -0.80721639  -1.1263633 ]
mat_Sqrt:  [[14.81200627  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-6.36165866e-05 -3.01743996e-02 -2.25384758e-01]
Stock Position:  -6.3616586639554e-05
Bond Position:  [12.80381877]


portfolio before change:  [12.79896158]
curr_Stock_Price:  101.51076713724109
curr_Factors:  [101.51076714  -0.51214322  -1.14559726]
mat_Sqrt:  [[19.34481441  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00816653 -0.02147679  0.16470517]
Stock Position:  0.00816652881798009
Bond Position:  [11.96997097]


portfolio before change:  [12.80329324]
curr_Stock_Price:  101.8579553733425
curr_Factors:  [101.85795537  -0.47822439  -1.15079488]
mat_Sqrt:  [[19.97656769  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00282543 -0.02754846 -0.03476469]
Stock Position:  -0.002825427283057812
Bond Position:  [13.09108548]


portfolio before change:  [12.80320706]
curr_Stock_Price:  102.46765731050002
curr_Factors:  [102.46765731  -0.48597247  -1.18793162]
mat_Sqrt:  [[19.21407558  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00846794  0.04681609  0.08575368]
Stock Position:  -0.008467937033460632
Bond Position:  [13.67089673]


portfolio before change:  [12.79883127]
curr_Stock_Price:  103.18622144978498
curr_Factors:  [103.18622145  -0.32424739  -1.17926315]
mat_Sqrt:  [[22.94327336  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00355552 -0.04865269 -0.35725525]
Stock Position:  0.0035555206643295913
Bond Position:  [12.43195053]


portfolio before change:  [12.80864436]
curr_Stock_Price:  105.50908857403049
curr_Factors:  [105.50908857  -0.45202686  -1.1877382 ]
mat_Sqrt:  [[20.47146654  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00987111 -0.10967248  0.16785072]
Stock Position:  -0.009871112161852765
Bond Position:  [13.85013641]


portfolio before change:  [12.81769966]
curr_Stock_Price:  104.76713388681972
curr_Factors:  [104.76713389  -0.60445076  -1.19138444]
mat_Sqrt:  [[17.39016657  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00227974 -0.01328528  0.20432282]
Stock Position:  -0.0022797353203995044
Bond Position:  [13.05654099]


portfolio before change:  [12.81768439]
curr_Stock_Price:  105.48977940065129
curr_Factors:  [105.4897794   -0.26542037  -1.16907804]
mat_Sqrt:  [[25.13133964  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00135757  0.02022873 -0.08516068]
Stock Position:  -0.001357571876880287
Bond Position:  [12.96089434]


portfolio before change:  [12.82037772]
curr_Stock_Price:  104.69931185441276
curr_Factors:  [104.69931185  -0.10842878  -1.16183345]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [12.82037772]
Stock Price:  103.85030019828278
PL:  [8.97007752]
Settle:  Tensor("sub_82:0", shape=(), dtype=float64)
PL:  Tensor("sub_83:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  42
output_Z_Vals[:, i, :]:  [[ 1.19260232e+02 -2.92559343e+01 -2.92733494e+01]
 [-3.68487114e-02  4.41121001e-02 -5.87438576e-03]
 [ 5.25505313e-03  4.63322900e-03 -1.66158281e-02]
 [ 8.30984859e-02  1.53320152e-01  3.77295256e-02]
 [ 2.51145899e-02  3.46693663e-02 -7.12160692e-02]
 [ 6.35169906e-02  2.92220115e-02  5.01071122e-03]
 [ 2.48455468e-02  5.51572992e-02 -1.68363833e-02]
 [-1.25687072e-02 -4.47377025e-02 -3.31388689e-02]
 [ 1.21221725e-01 -6.57172561e-02 -1.80496992e-01]
 [-9.96834426e-02 -1.43310156e-01 -1.04542008e-01]
 [ 1.62007435e-01  9.23391188e-02  1.36730054e-01]
 [-2.26928220e-01 -1.07675517e-01  5.88744098e-02]
 [-2.10766823e-02 -5.33958040e-02  7.18823210e-02]
 [-9.62623594e-02 -1.14884369e-01  6.32126881e-02]
 [ 1.45714045e-01  6.09133308e-02 -1.12709694e-01]
 [-6.89003354e-02 -8.15107323e-02 -1.17124978e-01]
 [-7.80931347e-02 -2.87781055e-02 -5.91562623e-02]
 [-5.68913066e-03 -9.48483117e-02 -2.67945507e-02]
 [ 1.88363604e-02  6.30686199e-02  1.47756926e-02]
 [ 3.23633490e-01 -1.60708555e-01 -7.83223447e-02]
 [-2.27026975e-02  9.95798047e-03  4.65489376e-02]
 [ 5.05022384e-03 -8.93244724e-03  4.78214500e-03]
 [-1.01781907e-01  1.94139989e-01  2.80345025e-01]
 [ 8.01601337e-02 -1.76910319e-02 -2.68330697e-02]
 [ 9.45173580e-02  3.09440509e-02  9.33916315e-02]
 [ 9.09698148e-02 -3.33421692e-03  5.91373034e-02]
 [-1.67590502e-01  7.13904798e-02  7.95996582e-02]
 [-5.07806065e-02  7.36225950e-02  2.93687317e-02]
 [ 6.05181585e-02 -8.16524223e-02 -4.81673058e-02]
 [ 2.73185701e-02  4.67973339e-03 -5.97389214e-02]
 [-4.01208096e-02  3.35009971e-01  1.30450460e-02]
 [ 2.26559391e-02 -1.25943906e-01 -6.44132085e-02]
 [-4.91179043e-02  1.55247493e-02  8.17364005e-02]
 [-7.05571189e-02 -6.40831654e-02  2.00498874e-02]
 [-1.41299750e-01  9.62396387e-02  3.53417878e-02]
 [ 8.47165236e-02 -1.65012150e-01 -1.38726811e-01]
 [-2.33284069e-01 -4.04450293e-01  8.63682758e-02]
 [-5.45118569e-02 -5.28770657e-02  7.89871680e-02]
 [-2.56781141e-02  5.55855223e-02 -3.23607147e-02]
 [ 2.05234783e-01 -1.26409979e-02 -2.02737110e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.26023247 -29.25593426 -29.27334937]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  8.31486419  -9.25153874 -83.50871763]
init_Out:  [2.49911038]
Stock Position:  8.31486419409362
Bond position:  [-828.98730903]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [6.53758991]
curr_Stock_Price:  100.49815719435466
curr_Factors:  [100.49815719  -0.95829817  -1.01590077]
mat_Sqrt:  [[13.95643165  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00264458  0.01394947 -0.01675799]
Stock Position:  -0.002644576121952991
Bond Position:  [6.80336494]


portfolio before change:  [6.53758199]
curr_Stock_Price:  100.82274322609555
curr_Factors:  [100.82274323  -0.86356201  -0.99517294]
mat_Sqrt:  [[15.71520964  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00012618  0.00146516 -0.04740033]
Stock Position:  0.00012618290948945274
Bond Position:  [6.52485988]


portfolio before change:  [6.53830451]
curr_Stock_Price:  100.08464081648356
curr_Factors:  [100.08464082  -0.87503627  -0.99238773]
mat_Sqrt:  [[15.4651983   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00612722 0.04848409 0.10763183]
Stock Position:  0.006127221941377094
Bond Position:  [5.92506371]


portfolio before change:  [6.53127045]
curr_Stock_Price:  98.81575525692556
curr_Factors:  [98.81575526 -0.83321085 -0.99414528]
mat_Sqrt:  [[15.89335227  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00072186  0.01096342 -0.20315962]
Stock Position:  0.0007218634305120533
Bond Position:  [6.45993897]


portfolio before change:  [6.53186233]
curr_Stock_Price:  98.51699314555304
curr_Factors:  [98.51699315 -0.70446865 -1.01308832]
mat_Sqrt:  [[17.68420891  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00369224 0.00924081 0.01429416]
Stock Position:  0.0036922379239682293
Bond Position:  [6.16811415]


portfolio before change:  [6.52915216]
curr_Stock_Price:  97.57414308598904
curr_Factors:  [97.57414309 -0.59028998 -1.0233585 ]
mat_Sqrt:  [[19.43283282  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00117497  0.01744227 -0.04802952]
Stock Position:  0.0011749697011797173
Bond Position:  [6.4145055]


portfolio before change:  [6.52882951]
curr_Stock_Price:  96.61708219059531
curr_Factors:  [96.61708219 -0.63324807 -0.98262524]
mat_Sqrt:  [[19.19946197  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00106713 -0.0141473  -0.09453597]
Stock Position:  -0.0010671274554799447
Bond Position:  [6.63193225]


portfolio before change:  [6.53074266]
curr_Stock_Price:  95.60117179795442
curr_Factors:  [95.6011718  -0.5364688  -0.97041685]
mat_Sqrt:  [[21.1851279   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00390279 -0.02078162 -0.51490768]
Stock Position:  0.0039027906399603466
Bond Position:  [6.1576313]


portfolio before change:  [6.53639626]
curr_Stock_Price:  96.85254655274443
curr_Factors:  [96.85254655 -0.56853074 -0.96054561]
mat_Sqrt:  [[20.99141055  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00594163 -0.04531865 -0.29822925]
Stock Position:  -0.005941632300459772
Bond Position:  [7.11185848]


portfolio before change:  [6.54197512]
curr_Stock_Price:  96.06323215590062
curr_Factors:  [96.06323216 -0.53367331 -0.92966632]
mat_Sqrt:  [[22.23498633  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.0086486  0.02920019 0.39005279]
Stock Position:  0.00864860104776666
Bond Position:  [5.71116255]


portfolio before change:  [6.54204659]
curr_Stock_Price:  95.98894718942041
curr_Factors:  [95.98894719 -0.6192359  -0.94555673]
mat_Sqrt:  [[20.07430049  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01084425 -0.03404999  0.1679523 ]
Stock Position:  -0.01084424843365009
Bond Position:  [7.58297458]


portfolio before change:  [6.54071359]
curr_Stock_Price:  96.19928321124308
curr_Factors:  [96.19928321 -0.42324622 -0.94651238]
mat_Sqrt:  [[24.45080914  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00031829 -0.01688524  0.20506025]
Stock Position:  -0.0003182896183742072
Bond Position:  [6.57133282]


portfolio before change:  [6.54123596]
curr_Stock_Price:  97.1389752387998
curr_Factors:  [97.13897524 -0.63597408 -0.95173771]
mat_Sqrt:  [[19.85450418  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0043479  -0.03632963  0.1803282 ]
Stock Position:  -0.004347901329898079
Bond Position:  [6.96358664]


portfolio before change:  [6.52976881]
curr_Stock_Price:  99.9765879128673
curr_Factors:  [99.97658791 -0.38043469 -0.9360609 ]
mat_Sqrt:  [[26.80103357  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00463714  0.01926249 -0.32152938]
Stock Position:  0.004637136487491946
Bond Position:  [6.06616372]


portfolio before change:  [6.54159424]
curr_Stock_Price:  102.36321421161804
curr_Factors:  [102.36321421  -0.69129809  -0.93334615]
mat_Sqrt:  [[20.1636843   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00470712 -0.02577596 -0.33412496]
Stock Position:  -0.00470712435763151
Bond Position:  [7.02343061]


portfolio before change:  [6.54319974]
curr_Stock_Price:  102.20865712502588
curr_Factors:  [102.20865713  -0.71447886  -0.93962228]
mat_Sqrt:  [[19.5488263   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00465048 -0.00910044 -0.16875635]
Stock Position:  -0.004650478874461585
Bond Position:  [7.01851894]


portfolio before change:  [6.54330417]
curr_Stock_Price:  102.37486403550804
curr_Factors:  [102.37486404  -0.93897879  -0.94346337]
mat_Sqrt:  [[15.58328784  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00087321 -0.02999367 -0.0764374 ]
Stock Position:  -0.0008732122801085681
Bond Position:  [6.63269916]


portfolio before change:  [6.54433225]
curr_Stock_Price:  102.14703796021759
curr_Factors:  [102.14703796  -0.68159677  -0.94855653]
mat_Sqrt:  [[20.01055783  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00117342 0.01994405 0.04215094]
Stock Position:  0.0011734236005458802
Bond Position:  [6.4244705]


portfolio before change:  [6.546537]
curr_Stock_Price:  103.34152606187423
curr_Factors:  [103.34152606  -0.88727638  -0.94302994]
mat_Sqrt:  [[16.57230572  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01831348 -0.05082051 -0.22343185]
Stock Position:  0.018313476516005178
Bond Position:  [4.65399439]


portfolio before change:  [6.52656717]
curr_Stock_Price:  102.21931330429076
curr_Factors:  [102.2193133   -0.80874785  -0.93138724]
mat_Sqrt:  [[17.93915127  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00072154  0.00314899  0.13279116]
Stock Position:  -0.0007215403468323771
Bond Position:  [6.60032252]


portfolio before change:  [6.52659431]
curr_Stock_Price:  103.32520836394157
curr_Factors:  [103.32520836  -0.8019466   -0.97417966]
mat_Sqrt:  [[17.49220082  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00033133 -0.00282469  0.01364213]
Stock Position:  0.00033133282443070577
Bond Position:  [6.49235928]


portfolio before change:  [6.52734169]
curr_Stock_Price:  103.13141275194059
curr_Factors:  [103.13141275  -0.82368705  -0.94529406]
mat_Sqrt:  [[17.58458938  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00224879  0.06139245  0.79974632]
Stock Position:  -0.0022487897909296306
Bond Position:  [6.75926256]


portfolio before change:  [6.52968749]
curr_Stock_Price:  102.46401726631883
curr_Factors:  [102.46401727  -0.92901719  -0.93835267]
mat_Sqrt:  [[15.83371967  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00468785 -0.0055944  -0.07654728]
Stock Position:  0.004687848294756998
Bond Position:  [6.04935172]


portfolio before change:  [6.52880027]
curr_Stock_Price:  102.11344517075966
curr_Factors:  [102.11344517  -0.8982801   -0.95615545]
mat_Sqrt:  [[15.98496917  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00715546 0.00978537 0.26642033]
Stock Position:  0.0071554605914111655
Bond Position:  [5.79813154]


portfolio before change:  [6.53640872]
curr_Stock_Price:  103.07545628471871
curr_Factors:  [103.07545628  -0.77248342  -0.99250791]
mat_Sqrt:  [[17.64530909  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0058347  -0.00105437  0.16870227]
Stock Position:  0.005834699561340272
Bond Position:  [5.9349944]


portfolio before change:  [6.53736231]
curr_Stock_Price:  103.11173485290249
curr_Factors:  [103.11173485  -0.59597947  -0.99235632]
mat_Sqrt:  [[21.06214621  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00709799  0.02257565  0.22707567]
Stock Position:  -0.007097994393813539
Bond Position:  [7.26924883]


portfolio before change:  [6.53208432]
curr_Stock_Price:  103.98334762347251
curr_Factors:  [103.98334762  -0.53189436  -0.99623575]
mat_Sqrt:  [[22.55824578  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00190107  0.02328151  0.08378082]
Stock Position:  -0.0019010703412795807
Bond Position:  [6.72976398]


portfolio before change:  [6.53366438]
curr_Stock_Price:  103.5947320530299
curr_Factors:  [103.59473205  -0.80824374  -0.97025344]
mat_Sqrt:  [[17.49629783  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00277646 -0.02582076 -0.13740792]
Stock Position:  0.002776461191886264
Bond Position:  [6.24603763]


portfolio before change:  [6.53107752]
curr_Stock_Price:  102.38179657975284
curr_Factors:  [102.38179658  -0.96777364  -0.96093282]
mat_Sqrt:  [[14.87976846  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00102456  0.00147986 -0.17041851]
Stock Position:  0.0010245619097231965
Bond Position:  [6.42618103]


portfolio before change:  [6.53295647]
curr_Stock_Price:  103.43163566428458
curr_Factors:  [103.43163566  -0.71434884  -0.95078111]
mat_Sqrt:  [[19.56575651  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00147237  0.10593945  0.03721389]
Stock Position:  -0.0014723724292393882
Bond Position:  [6.68524635]


portfolio before change:  [6.53358888]
curr_Stock_Price:  103.56970799609047
curr_Factors:  [103.569708    -0.50775894  -0.95030887]
mat_Sqrt:  [[24.09916237  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00025959 -0.03982696 -0.18375295]
Stock Position:  0.00025958538345217816
Bond Position:  [6.5067037]


portfolio before change:  [6.53476546]
curr_Stock_Price:  104.96882411128581
curr_Factors:  [104.96882411  -0.58735993  -0.94394239]
mat_Sqrt:  [[22.69991256  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00141114  0.00490936  0.2331712 ]
Stock Position:  -0.0014111368946752856
Bond Position:  [6.68289084]


portfolio before change:  [6.53543508]
curr_Stock_Price:  105.0863134021985
curr_Factors:  [105.0863134   -0.77486644  -0.90723911]
mat_Sqrt:  [[19.5441594   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00348539 -0.02026488  0.05719675]
Stock Position:  -0.0034853928286725745
Bond Position:  [6.90170216]


portfolio before change:  [6.53661868]
curr_Stock_Price:  104.99426132190034
curr_Factors:  [104.99426132  -0.73525454  -0.9081562 ]
mat_Sqrt:  [[20.29744373  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00648361  0.03043365  0.10082028]
Stock Position:  -0.006483611589730579
Bond Position:  [7.21736069]


portfolio before change:  [6.53625266]
curr_Stock_Price:  105.18986906847118
curr_Factors:  [105.18986907  -0.75150519  -0.90749639]
mat_Sqrt:  [[20.02067348  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00260423 -0.05218142 -0.39574898]
Stock Position:  0.0026042298990127935
Bond Position:  [6.26231406]


portfolio before change:  [6.54027149]
curr_Stock_Price:  106.43245879310555
curr_Factors:  [106.43245879  -0.83779159  -0.88676673]
mat_Sqrt:  [[18.97177376  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01191755 -0.12789841  0.24638465]
Stock Position:  -0.01191755094832487
Bond Position:  [7.80868574]


portfolio before change:  [6.53761562]
curr_Stock_Price:  106.73722069196664
curr_Factors:  [106.73722069  -0.80966866  -0.88831936]
mat_Sqrt:  [[19.53840307  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00203466 -0.0167212   0.2253284 ]
Stock Position:  -0.0020346570093813274
Bond Position:  [6.75478926]


portfolio before change:  [6.53765411]
curr_Stock_Price:  107.13331381457745
curr_Factors:  [107.13331381  -0.89835465  -0.890185  ]
mat_Sqrt:  [[17.91313657  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00172212  0.01757769 -0.09231611]
Stock Position:  -0.0017221163459835976
Bond Position:  [6.72215014]


portfolio before change:  [6.53813219]
curr_Stock_Price:  107.34366331228487
curr_Factors:  [107.34366331  -1.00966514  -0.87289069]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [6.53813219]
Stock Price:  107.26904974816462
PL:  [-0.73091756]
Settle:  Tensor("sub_84:0", shape=(), dtype=float64)
PL:  Tensor("sub_85:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  43
output_Z_Vals[:, i, :]:  [[ 1.19260232e+02 -2.92559343e+01 -2.92733494e+01]
 [ 2.70723086e-04 -8.27366231e-02 -3.00441241e-02]
 [-5.84533214e-02 -9.07011155e-02 -9.34060127e-02]
 [ 8.23472083e-02  1.46488763e-01  3.76382588e-02]
 [ 1.38615323e-01 -3.27231605e-03 -6.37080716e-02]
 [ 7.83347863e-02  3.12149428e-02 -6.61163286e-03]
 [ 4.14528097e-02  4.32131469e-02 -3.79777887e-02]
 [-1.27186960e-01  2.10019471e-01 -9.03297960e-03]
 [-1.02765178e-01 -3.47240627e-02  7.54967968e-02]
 [-5.59545300e-02  2.17745044e-01  7.10583509e-02]
 [ 5.17174117e-02  7.48790752e-03 -7.04474825e-02]
 [-8.82304527e-02  1.07071015e-01  3.09032168e-02]
 [-6.83709567e-02 -6.18471456e-02 -6.58401382e-02]
 [ 9.99460221e-02  1.10359246e-01  2.06503593e-01]
 [ 1.35766163e-01  8.38313125e-02 -7.37945804e-02]
 [-7.39743536e-02 -9.41612438e-02 -1.18621325e-01]
 [-8.45819417e-02  4.16715531e-03 -8.85030800e-02]
 [ 1.99287294e-02 -2.16523450e-01 -7.77870138e-02]
 [ 2.34414203e-02  5.71564072e-02  1.29007524e-02]
 [ 3.23856786e-01 -1.44185292e-01 -8.51537938e-02]
 [ 5.94323539e-02  2.01945592e-02  1.11053932e-01]
 [ 1.02220533e-02 -1.25042626e-02  9.81999820e-03]
 [-1.07733652e-01  2.17060920e-01  2.72536071e-01]
 [ 1.98658360e-01 -2.71618148e-02  3.23377065e-02]
 [ 4.46551057e-02  3.37947637e-02  7.53927685e-02]
 [ 1.03736004e-01 -4.72787201e-04  5.63508544e-02]
 [-1.14105293e-01  7.37016686e-02  9.50067605e-02]
 [-5.07806065e-02  7.36225950e-02  2.93687317e-02]
 [ 6.20848838e-02 -6.23725319e-02  9.08311027e-02]
 [ 1.29831097e-02 -9.31150531e-03 -9.56683953e-02]
 [-4.89079789e-02  3.49275578e-01  1.63672797e-02]
 [ 2.12879913e-02 -1.27658990e-01 -6.47943878e-02]
 [ 9.86065321e-02 -4.70236761e-02  6.37453658e-02]
 [-5.19129756e-02 -8.73184621e-02 -1.27573793e-02]
 [-1.72483489e-01  1.45338558e-01  2.98700417e-02]
 [ 9.49406294e-02 -1.60689668e-01 -1.33499900e-01]
 [-1.66429862e-01 -2.59067766e-01  2.67036640e-02]
 [-4.20536971e-02 -2.13080756e-02  1.91460511e-02]
 [-4.40732024e-02  9.41621389e-02 -2.08186299e-02]
 [-1.62453516e-01  9.80533185e-02  9.51535550e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.26023247 -29.25593426 -29.27334937]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  8.31486419  -9.25153874 -83.50871763]
init_Out:  [2.49911038]
Stock Position:  8.31486419409362
Bond position:  [-828.98730903]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [2.9274422]
curr_Stock_Price:  100.06397719817721
curr_Factors:  [100.0639772   -0.91451413  -1.02600178]
mat_Sqrt:  [[14.37217206  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00055651 -0.02616362 -0.08570752]
Stock Position:  -0.0005565100701010356
Bond Position:  [2.98312882]


portfolio before change:  [2.92768433]
curr_Stock_Price:  100.2989845759862
curr_Factors:  [100.29898458  -0.80385936  -1.04380607]
mat_Sqrt:  [[15.807589    0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00505211 -0.02868221 -0.26646135]
Stock Position:  -0.005052107356359323
Bond Position:  [3.43440557]


portfolio before change:  [2.92677454]
curr_Stock_Price:  100.56404690774592
curr_Factors:  [100.56404691  -0.87354353  -1.05749912]
mat_Sqrt:  [[14.58147895  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00643367 0.04632381 0.10737148]
Stock Position:  0.006433669012834721
Bond Position:  [2.27977875]


portfolio before change:  [2.92282172]
curr_Stock_Price:  99.90535377584777
curr_Factors:  [99.90535378 -0.9089178  -1.04926052]
mat_Sqrt:  [[14.09816931  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00890374 -0.0010348  -0.1817414 ]
Stock Position:  0.008903742982225694
Bond Position:  [2.03329012]


portfolio before change:  [2.92826833]
curr_Stock_Price:  100.48852891494906
curr_Factors:  [100.48852891  -1.13261474  -1.0624138 ]
mat_Sqrt:  [[11.18993864  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00695188  0.00987103 -0.01886115]
Stock Position:  0.006951884298882796
Bond Position:  [2.22968371]


portfolio before change:  [2.93345656]
curr_Stock_Price:  101.19473999839131
curr_Factors:  [101.19474     -0.94022936  -1.07433314]
mat_Sqrt:  [[13.49722735  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00257952  0.0136652  -0.10834006]
Stock Position:  0.0025795212481789466
Bond Position:  [2.67242258]


portfolio before change:  [2.93247592]
curr_Stock_Price:  100.68506618964014
curr_Factors:  [100.68506619  -0.98617434  -1.08968037]
mat_Sqrt:  [[12.63085688  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0097862   0.06641399 -0.02576858]
Stock Position:  -0.0097862030056277
Bond Position:  [3.91780042]


portfolio before change:  [2.92688259]
curr_Stock_Price:  101.30666423466594
curr_Factors:  [101.30666423  -1.03841491  -1.1071451 ]
mat_Sqrt:  [[11.85313259  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00744538 -0.01098071  0.21537135]
Stock Position:  -0.0074453761501989645
Bond Position:  [3.68114881]


portfolio before change:  [2.92561267]
curr_Stock_Price:  101.53903614857546
curr_Factors:  [101.53903615  -1.32411501  -1.10119931]
mat_Sqrt:  [[ 8.98115955  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0039892   0.06885703  0.2027097 ]
Stock Position:  -0.003989201150522397
Bond Position:  [3.33067231]


portfolio before change:  [2.92409796]
curr_Stock_Price:  102.02310936664637
curr_Factors:  [102.02310937  -1.44453175  -1.07632397]
mat_Sqrt:  [[ 8.20171791  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00457596  0.00236788 -0.20096706]
Stock Position:  0.004575957978341278
Bond Position:  [2.4572445]


portfolio before change:  [2.92883452]
curr_Stock_Price:  102.99107900497
curr_Factors:  [102.991079    -1.19142121  -1.07739845]
mat_Sqrt:  [[10.65279946  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0074307   0.03385883  0.08815828]
Stock Position:  -0.007430703877035968
Bond Position:  [3.69413073]


portfolio before change:  [2.93252261]
curr_Stock_Price:  102.55689585774103
curr_Factors:  [102.55689586  -1.01677838  -1.07167195]
mat_Sqrt:  [[12.70464153  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00656511 -0.01955778 -0.18782359]
Stock Position:  -0.0065651128276227955
Bond Position:  [3.6058202]


portfolio before change:  [2.9380353]
curr_Stock_Price:  101.78585933034242
curr_Factors:  [101.78585933  -0.9725961   -1.04415106]
mat_Sqrt:  [[13.54644339  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01070007 0.03489866 0.58909727]
Stock Position:  0.010700067235102943
Bond Position:  [1.84891976]


portfolio before change:  [2.94595169]
curr_Stock_Price:  102.50410321052534
curr_Factors:  [102.50410321  -0.73501045  -1.03230035]
mat_Sqrt:  [[17.50684643  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00701825  0.02650979 -0.2105154 ]
Stock Position:  0.007018249848996404
Bond Position:  [2.22655228]


portfolio before change:  [2.94166834]
curr_Stock_Price:  101.85412762543184
curr_Factors:  [101.85412763  -0.71002701  -1.03907124]
mat_Sqrt:  [[17.71556129  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0056797  -0.0297764  -0.33839362]
Stock Position:  -0.00567969941532054
Bond Position:  [3.52016916]


portfolio before change:  [2.93206896]
curr_Stock_Price:  103.62172463105088
curr_Factors:  [103.62172463  -0.62259709  -1.04775024]
mat_Sqrt:  [[19.4997115   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00525854  0.00131777 -0.25247465]
Stock Position:  -0.005258537375768163
Bond Position:  [3.47696768]


portfolio before change:  [2.93385108]
curr_Stock_Price:  103.3654815369209
curr_Factors:  [103.36548154  -0.68437873  -1.07386684]
mat_Sqrt:  [[17.8147275   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-8.64503685e-05 -6.84707270e-02 -2.21904699e-01]
Stock Position:  -8.645036846417315e-05
Bond Position:  [2.94278706]


portfolio before change:  [2.93427293]
curr_Stock_Price:  102.74107754602676
curr_Factors:  [102.74107755  -0.45201228  -1.06985092]
mat_Sqrt:  [[22.42886643  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00122835 0.01807444 0.03680226]
Stock Position:  0.0012283522012536208
Bond Position:  [2.8080707]


portfolio before change:  [2.93513647]
curr_Stock_Price:  103.15831410986668
curr_Factors:  [103.15831411  -0.4824825   -1.05941381]
mat_Sqrt:  [[22.07329567  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01371576 -0.04559539 -0.24292007]
Stock Position:  0.01371575849638722
Bond Position:  [1.52024195]


portfolio before change:  [2.92906459]
curr_Stock_Price:  102.7017647967333
curr_Factors:  [102.7017648   -0.598156    -1.04090535]
mat_Sqrt:  [[19.94080133  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00414339 0.00638608 0.31680596]
Stock Position:  0.0041433923735743955
Bond Position:  [2.50353089]


portfolio before change:  [2.93095181]
curr_Stock_Price:  103.08170925883353
curr_Factors:  [103.08170926  -0.75573264  -1.05022487]
mat_Sqrt:  [[16.93808203  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00070278 -0.0039542   0.02801372]
Stock Position:  0.0007027769363006886
Bond Position:  [2.85850837]


portfolio before change:  [2.93163997]
curr_Stock_Price:  103.55244190923426
curr_Factors:  [103.55244191  -0.76280059  -1.06410745]
mat_Sqrt:  [[16.66265736  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00279055  0.06864069  0.77746955]
Stock Position:  -0.0027905495527267205
Bond Position:  [3.22060819]


portfolio before change:  [2.92898327]
curr_Stock_Price:  104.64875123640999
curr_Factors:  [104.64875124  -0.83609013  -1.06841797]
mat_Sqrt:  [[15.58176637  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01312803 -0.00858932  0.09225048]
Stock Position:  0.01312803356560489
Bond Position:  [1.55515095]


portfolio before change:  [2.91284409]
curr_Stock_Price:  103.40457518860752
curr_Factors:  [103.40457519  -0.39747231  -1.07193036]
mat_Sqrt:  [[23.78955307  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00256067 0.01068684 0.21507458]
Stock Position:  0.002560668834562712
Bond Position:  [2.64805921]


portfolio before change:  [2.91865165]
curr_Stock_Price:  105.5432895584121
curr_Factors:  [105.54328956  -0.75549313  -1.09490957]
mat_Sqrt:  [[16.58864618  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 6.94609827e-03 -1.49508440e-04  1.60753302e-01]
Stock Position:  0.006946098271662596
Bond Position:  [2.18553759]


portfolio before change:  [2.92051552]
curr_Stock_Price:  105.77228982997293
curr_Factors:  [105.77228983  -0.61999495  -1.09497099]
mat_Sqrt:  [[19.03582322  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0048755   0.02330651  0.27102784]
Stock Position:  -0.004875499682086644
Bond Position:  [3.43620829]


portfolio before change:  [2.91796948]
curr_Stock_Price:  106.38260565445958
curr_Factors:  [106.38260565  -0.4075196   -1.08247628]
mat_Sqrt:  [[23.97582918  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00178867  0.02328151  0.08378082]
Stock Position:  -0.0017886685662085304
Bond Position:  [3.1082527]


portfolio before change:  [2.91907751]
curr_Stock_Price:  105.98036472472782
curr_Factors:  [105.98036472  -0.37458669  -1.07896201]
mat_Sqrt:  [[24.77178095  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00318973 -0.01972393  0.25911585]
Stock Position:  0.003189728398337378
Bond Position:  [2.58102893]


portfolio before change:  [2.91185546]
curr_Stock_Price:  103.61505421979471
curr_Factors:  [103.61505422  -0.3081891   -1.04400757]
mat_Sqrt:  [[26.80225326  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-2.53170571e-04 -2.94455652e-03 -2.72915303e-01]
Stock Position:  -0.00025317057074353933
Bond Position:  [2.93808774]


portfolio before change:  [2.91251719]
curr_Stock_Price:  102.45204590199121
curr_Factors:  [102.4520459   -0.19415786  -1.06501287]
mat_Sqrt:  [[29.08504463  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00125662  0.11045064  0.04669129]
Stock Position:  -0.00125661712948934
Bond Position:  [3.04126018]


portfolio before change:  [2.91181798]
curr_Stock_Price:  103.31101246881701
curr_Factors:  [103.31101247  -0.33360786  -1.07618564]
mat_Sqrt:  [[25.22789874  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00018891 -0.04036932 -0.18484035]
Stock Position:  0.0001889079773022066
Bond Position:  [2.8923017]


portfolio before change:  [2.9119969]
curr_Stock_Price:  102.34423685884136
curr_Factors:  [102.34423686  -0.53778036  -1.10069482]
mat_Sqrt:  [[19.88303439  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00555269 -0.01487019  0.18184779]
Stock Position:  0.0055526914106881695
Bond Position:  [2.34371094]


portfolio before change:  [2.91216205]
curr_Stock_Price:  102.32121461273337
curr_Factors:  [102.32121461  -0.59466018  -1.13035597]
mat_Sqrt:  [[18.2305886   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00311409 -0.02761252 -0.03639325]
Stock Position:  -0.003114085833127525
Bond Position:  [3.2307991]


portfolio before change:  [2.91307979]
curr_Stock_Price:  102.15620313289764
curr_Factors:  [102.15620313  -0.55428881  -1.13452862]
mat_Sqrt:  [[18.87211833  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00861767  0.04596009  0.08521091]
Stock Position:  -0.008617668895539637
Bond Position:  [3.79342812]


portfolio before change:  [2.90654176]
curr_Stock_Price:  102.96990780089038
curr_Factors:  [102.9699078   -0.69833974  -1.15356681]
mat_Sqrt:  [[16.15985754  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00393203 -0.05081453 -0.38083805]
Stock Position:  0.003932032627266185
Bond Position:  [2.50166072]


portfolio before change:  [2.90523772]
curr_Stock_Price:  102.55872936386017
curr_Factors:  [102.55872936  -0.87835314  -1.14950744]
mat_Sqrt:  [[13.49845206  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01242128 -0.08192442  0.07617812]
Stock Position:  -0.012421283552417638
Bond Position:  [4.17914877]


portfolio before change:  [2.90027981]
curr_Stock_Price:  102.99993471897423
curr_Factors:  [102.99993472  -1.02865021  -1.14618365]
mat_Sqrt:  [[11.70357675  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00330631 -0.00673821  0.05461835]
Stock Position:  -0.003306313855037517
Bond Position:  [3.24082992]


portfolio before change:  [2.9019611]
curr_Stock_Price:  102.61395583787801
curr_Factors:  [102.61395584  -1.09889598  -1.13585203]
mat_Sqrt:  [[10.98165269  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00417893  0.02977668 -0.05938976]
Stock Position:  -0.004178927594361692
Bond Position:  [3.33077739]


portfolio before change:  [2.90290055]
curr_Stock_Price:  102.4887855104065
curr_Factors:  [102.48878551  -0.84425064  -1.12519011]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [2.90290055]
Stock Price:  101.81734334539924
PL:  [1.08555721]
Settle:  Tensor("sub_86:0", shape=(), dtype=float64)
PL:  Tensor("sub_87:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  44
output_Z_Vals[:, i, :]:  [[ 1.19260232e+02 -2.92559343e+01 -2.92733494e+01]
 [ 4.03706775e-03 -1.27034308e-01 -3.91946428e-02]
 [-5.67641109e-02 -8.29772450e-02 -8.27436658e-02]
 [ 5.50456422e-02  1.21922684e-01  3.26433059e-02]
 [ 2.10403974e-01 -2.66179772e-02 -5.69764737e-02]
 [ 3.50733785e-02  2.99192626e-02  5.90334012e-02]
 [ 1.30734533e-02  5.89255152e-02 -3.51784683e-03]
 [-5.08982700e-02  2.88262132e-01  5.43245911e-02]
 [ 5.76429121e-02 -6.63064351e-03 -9.87343608e-02]
 [-5.62636471e-02 -1.17437388e-01 -1.29313112e-01]
 [ 1.11247380e-01  1.00778786e-01 -7.09201447e-03]
 [-2.05300438e-01 -9.98388112e-02  4.57939478e-02]
 [ 4.55239918e-02 -1.22030895e-01  1.41617605e-01]
 [-1.19358368e-01 -1.16961478e-01 -5.28260957e-02]
 [ 1.57547763e-01  3.45509954e-02 -1.57979108e-01]
 [-8.33667821e-02 -1.23313907e-01 -1.24367145e-01]
 [-7.34144109e-02 -4.72207314e-02 -4.38301106e-02]
 [-6.78580907e-02 -1.69730476e-01  1.69932399e-02]
 [ 1.80329583e-02  5.78361740e-02  6.36660003e-03]
 [ 2.69941194e-01 -6.14953190e-02 -4.17001146e-02]
 [-4.25435545e-02  3.17699690e-04  1.46123494e-02]
 [ 4.76495580e-02 -3.83527825e-02  4.62779431e-02]
 [-6.13718912e-02  4.92633260e-02  2.39438712e-01]
 [-2.31773565e-03 -7.06378065e-03 -7.13825241e-02]
 [ 1.71738588e-02  4.24511244e-02  9.11685807e-02]
 [ 4.99659206e-02 -4.95180682e-02  7.22941850e-02]
 [-1.76084814e-01  7.18410383e-02  7.49322435e-02]
 [-4.94074713e-02  7.25466975e-02  2.89636425e-02]
 [ 6.20848838e-02 -6.23725319e-02  9.08311027e-02]
 [ 3.85395701e-02 -1.02586637e-03  4.45437170e-03]
 [-1.10092785e-02  2.42045852e-01  2.21830886e-02]
 [ 1.92509867e-02 -9.60072266e-02 -7.52183885e-02]
 [ 1.20596113e-01 -1.33817785e-01 -6.67784902e-02]
 [-3.06888390e-02 -7.15433036e-02  1.98256342e-02]
 [-1.23448549e-01  4.29963070e-02  3.61775937e-02]
 [ 8.47165236e-02 -1.65012150e-01 -1.38726811e-01]
 [-1.98735643e-01 -3.33050905e-01  5.22720790e-02]
 [-4.72727204e-02 -3.11602496e-02  4.37791958e-02]
 [-3.55136760e-02  7.62118272e-02 -2.61893451e-02]
 [ 1.29797946e-01 -6.81616765e-03 -1.22399173e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.26023247 -29.25593426 -29.27334937]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  8.31486419  -9.25153874 -83.50871763]
init_Out:  [2.49911038]
Stock Position:  8.31486419409362
Bond position:  [-828.98730903]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-0.53241223]
curr_Stock_Price:  99.64787245426527
curr_Factors:  [99.64787245 -0.92417109 -1.00508331]
mat_Sqrt:  [[14.47449732  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00050043 -0.04017178 -0.11181141]
Stock Position:  -0.0005004330573655905
Bond Position:  [-0.48254514]


portfolio before change:  [-0.53277787]
curr_Stock_Price:  100.25798049317852
curr_Factors:  [100.25798049  -0.80762981  -1.04471784]
mat_Sqrt:  [[15.72731511  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00481942 -0.02623971 -0.23604465]
Stock Position:  -0.004819421096936958
Bond Position:  [-0.04959245]


portfolio before change:  [-0.53331933]
curr_Stock_Price:  100.36904252157211
curr_Factors:  [100.36904252  -0.63968508  -1.04077813]
mat_Sqrt:  [[18.69751465  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00346875 0.03855534 0.09312227]
Stock Position:  0.003468747609247145
Bond Position:  [-0.8814742]


portfolio before change:  [-0.53264078]
curr_Stock_Price:  100.59642715507628
curr_Factors:  [100.59642716  -0.76111924  -1.01647397]
mat_Sqrt:  [[17.00527399  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01164853 -0.00841734 -0.16253802]
Stock Position:  0.011648529001991087
Bond Position:  [-1.70444118]


portfolio before change:  [-0.5265363]
curr_Stock_Price:  101.13877411371853
curr_Factors:  [101.13877411  -0.77474222  -1.02486096]
mat_Sqrt:  [[16.7247623   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00286378 0.0094613  0.16840586]
Stock Position:  0.002863779600963719
Bond Position:  [-0.81617546]


portfolio before change:  [-0.5281004]
curr_Stock_Price:  100.62823370224928
curr_Factors:  [100.6282337   -0.47786686  -1.01618311]
mat_Sqrt:  [[22.58718934  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00061437  0.01863388 -0.01003544]
Stock Position:  0.0006143671022363015
Bond Position:  [-0.58992308]


portfolio before change:  [-0.52781186]
curr_Stock_Price:  101.21793743432598
curr_Factors:  [101.21793743  -0.50698031  -1.03079425]
mat_Sqrt:  [[21.74755696  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00148828  0.09115649  0.15497294]
Stock Position:  -0.0014882781118961057
Bond Position:  [-0.37717141]


portfolio before change:  [-0.52674114]
curr_Stock_Price:  100.4668255025127
curr_Factors:  [100.4668255   -0.33403196  -1.0057718 ]
mat_Sqrt:  [[26.31196586  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00141828 -0.00209679 -0.28166165]
Stock Position:  0.0014182764899649594
Bond Position:  [-0.66923088]


portfolio before change:  [-0.53049988]
curr_Stock_Price:  97.8755961920776
curr_Factors:  [97.87559619 -0.32262493 -1.00765003]
mat_Sqrt:  [[25.87875298  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00331128 -0.03713696 -0.36889431]
Stock Position:  -0.0033112799481878974
Bond Position:  [-0.20640638]


portfolio before change:  [-0.52977299]
curr_Stock_Price:  97.64828491312309
curr_Factors:  [ 9.76482849e+01 -6.46338406e-02 -1.00784637e+00]
mat_Sqrt:  [[33.41122367  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00336419  0.03186905 -0.02023154]
Stock Position:  0.003364193622035233
Bond Position:  [-0.85828073]


portfolio before change:  [-0.53467144]
curr_Stock_Price:  96.22412244827014
curr_Factors:  [ 9.62241224e+01 -2.17558979e-03 -1.01487449e+00]
mat_Sqrt:  [[34.80043901  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00570483 -0.0315718   0.13063739]
Stock Position:  -0.005704830762999999
Bond Position:  [0.01427089]


portfolio before change:  [-0.52940597]
curr_Stock_Price:  95.3014509266326
curr_Factors:  [95.30145093  0.2871665  -1.01744669]
mat_Sqrt:  [[45.91375939  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00155249 -0.03858956  0.40399561]
Stock Position:  0.001552491911545282
Bond Position:  [-0.6773607]


portfolio before change:  [-0.52920133]
curr_Stock_Price:  95.4878064670252
curr_Factors:  [95.48780647  0.31840289 -1.01803189]
mat_Sqrt:  [[47.43543638  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00280721 -0.03698647 -0.15069815]
Stock Position:  -0.002807213179886006
Bond Position:  [-0.2611467]


portfolio before change:  [-0.53381202]
curr_Stock_Price:  97.11862054497058
curr_Factors:  [97.11862054  0.15481401 -1.04132534]
mat_Sqrt:  [[40.0216992   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0031531   0.01092598 -0.45067042]
Stock Position:  0.0031531023997542463
Bond Position:  [-0.84003698]


portfolio before change:  [-0.52212963]
curr_Stock_Price:  100.85697097237359
curr_Factors:  [ 1.00856971e+02 -8.88479639e-02 -1.03266286e+00]
mat_Sqrt:  [[32.85791166  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0034067  -0.03899528 -0.35478485]
Stock Position:  -0.003406700701137769
Bond Position:  [-0.17854012]


portfolio before change:  [-0.52399659]
curr_Stock_Price:  101.39844409889054
curr_Factors:  [101.3984441   -0.19664716  -1.03596075]
mat_Sqrt:  [[29.56082016  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00282741 -0.01493251 -0.12503511]
Stock Position:  -0.0028274056116983446
Bond Position:  [-0.23730206]


portfolio before change:  [-0.52532369]
curr_Stock_Price:  101.85732501906442
curr_Factors:  [101.85732502  -0.32358296  -1.03682802]
mat_Sqrt:  [[26.132038    0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0026317  -0.05367349  0.04847698]
Stock Position:  -0.0026317037406871965
Bond Position:  [-0.25726539]


portfolio before change:  [-0.52639453]
curr_Stock_Price:  102.2520042755904
curr_Factors:  [102.25200428  -0.47178903  -1.01796787]
mat_Sqrt:  [[23.05040861  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00090349 0.0182894  0.01816214]
Stock Position:  0.0009034919506168486
Bond Position:  [-0.61877839]


portfolio before change:  [-0.52718973]
curr_Stock_Price:  101.45747873522706
curr_Factors:  [101.45747874  -0.52448067  -1.0037245 ]
mat_Sqrt:  [[22.00862924  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01180634 -0.01944653 -0.11895882]
Stock Position:  0.011806341421951775
Bond Position:  [-1.72503137]


portfolio before change:  [-0.52606285]
curr_Stock_Price:  101.57119046641436
curr_Factors:  [101.57119047  -0.83082142  -0.9867828 ]
mat_Sqrt:  [[16.49662334  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00239762  0.00010047  0.04168497]
Stock Position:  -0.0023976190384038597
Bond Position:  [-0.28253383]


portfolio before change:  [-0.52768124]
curr_Stock_Price:  102.2314567036225
curr_Factors:  [102.2314567   -0.90798334  -1.0174665 ]
mat_Sqrt:  [[14.90638412  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00376387 -0.01212821  0.13201809]
Stock Position:  0.00376387315056789
Bond Position:  [-0.91246748]


portfolio before change:  [-0.53151224]
curr_Stock_Price:  101.24392807088753
curr_Factors:  [101.24392807  -0.95020065  -1.00567974]
mat_Sqrt:  [[14.31993113  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00078385  0.01557843  0.683052  ]
Stock Position:  -0.0007838511994363942
Bond Position:  [-0.45215206]


portfolio before change:  [-0.53150263]
curr_Stock_Price:  101.15956021252624
curr_Factors:  [101.15956021  -0.86019066  -1.01201449]
mat_Sqrt:  [[15.5567391   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00109734 -0.00223376 -0.20363447]
Stock Position:  -0.0010973391203088986
Bond Position:  [-0.42049629]


portfolio before change:  [-0.53153133]
curr_Stock_Price:  101.13781372541025
curr_Factors:  [101.13781373  -0.66430472  -1.01677631]
mat_Sqrt:  [[18.82909073  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00195865 0.01342422 0.26007858]
Stock Position:  0.001958652770959538
Bond Position:  [-0.72962519]


portfolio before change:  [-0.53098817]
curr_Stock_Price:  101.46169397213052
curr_Factors:  [101.46169397  -0.61991584  -1.01369631]
mat_Sqrt:  [[19.80766879  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00320302 -0.01565899  0.20623519]
Stock Position:  0.0032030199501044535
Bond Position:  [-0.855972]


portfolio before change:  [-0.5275928]
curr_Stock_Price:  102.55515290929492
curr_Factors:  [102.55515291  -0.91082668  -0.99745222]
mat_Sqrt:  [[15.21256651  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01044757  0.02271813  0.21376083]
Stock Position:  -0.01044757345096672
Bond Position:  [0.54385969]


portfolio before change:  [-0.53617411]
curr_Stock_Price:  103.38302901566772
curr_Factors:  [103.38302902  -1.01393345  -1.02099973]
mat_Sqrt:  [[13.51104694  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0030806   0.02294128  0.08262521]
Stock Position:  -0.0030806010062722723
Bond Position:  [-0.21769225]


portfolio before change:  [-0.53962181]
curr_Stock_Price:  104.49335819147649
curr_Factors:  [104.49335819  -1.17233807  -1.04299808]
mat_Sqrt:  [[11.40198386  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00692996 -0.01972393  0.25911585]
Stock Position:  0.006929956587739357
Bond Position:  [-1.26375624]


portfolio before change:  [-0.54331636]
curr_Stock_Price:  103.98302745889318
curr_Factors:  [103.98302746  -1.0424383   -1.02679475]
mat_Sqrt:  [[13.1312467   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00300218 -0.00032441  0.01270708]
Stock Position:  0.003002177024478073
Bond Position:  [-0.85549181]


portfolio before change:  [-0.54754891]
curr_Stock_Price:  102.60882104286641
curr_Factors:  [102.60882104  -0.92914137  -1.04012805]
mat_Sqrt:  [[14.31996178  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-1.61716508e-05  7.65416192e-02  6.32821773e-02]
Stock Position:  -1.617165080883283e-05
Bond Position:  [-0.54588956]


portfolio before change:  [-0.54762695]
curr_Stock_Price:  103.2148203735985
curr_Factors:  [103.21482037  -1.2129653   -1.04847716]
mat_Sqrt:  [[10.7549918   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 1.31864494e-04 -3.03601508e-02 -2.14577126e-01]
Stock Position:  0.00013186449408825047
Bond Position:  [-0.56123732]


portfolio before change:  [-0.54763856]
curr_Stock_Price:  103.65885666169851
curr_Factors:  [103.65885666  -1.14691806  -1.03328962]
mat_Sqrt:  [[11.71532258  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00883542 -0.0423169  -0.19050044]
Stock Position:  0.00883542472352963
Bond Position:  [-1.46350858]


portfolio before change:  [-0.54156729]
curr_Stock_Price:  104.36671331461666
curr_Factors:  [104.36671331  -1.21695296  -1.02473683]
mat_Sqrt:  [[11.09196533  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00256845 -0.02262398  0.05655702]
Stock Position:  -0.002568452716194729
Bond Position:  [-0.27350633]


portfolio before change:  [-0.54053026]
curr_Stock_Price:  103.94964407308845
curr_Factors:  [103.94964407  -1.19785008  -1.01582973]
mat_Sqrt:  [[11.36145832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01011786  0.01359663  0.1032046 ]
Stock Position:  -0.010117862074226686
Bond Position:  [0.5112179]


portfolio before change:  [-0.54641278]
curr_Stock_Price:  104.5373595836209
curr_Factors:  [104.53735958  -1.20353815  -1.02112717]
mat_Sqrt:  [[11.30086414  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00461367 -0.05218142 -0.39574898]
Stock Position:  0.004613668106568261
Bond Position:  [-1.02871346]


portfolio before change:  [-0.54739163]
curr_Stock_Price:  104.3530687510706
curr_Factors:  [104.35306875  -0.94847235  -1.01169989]
mat_Sqrt:  [[14.69647694  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01338178 -0.10531994  0.14911769]
Stock Position:  -0.013381777655361866
Bond Position:  [0.84903793]


portfolio before change:  [-0.54898344]
curr_Stock_Price:  104.47995380724568
curr_Factors:  [104.47995381  -1.09854082  -1.03638944]
mat_Sqrt:  [[12.35505103  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00316801 -0.00985374  0.12488986]
Stock Position:  -0.0031680066352757965
Bond Position:  [-0.21799026]


portfolio before change:  [-0.54990502]
curr_Stock_Price:  104.76225336327622
curr_Factors:  [104.76225336  -1.18666279  -1.01791383]
mat_Sqrt:  [[11.55498457  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0033658   0.0241003  -0.07471091]
Stock Position:  -0.003365800489568309
Bond Position:  [-0.19729618]


portfolio before change:  [-0.55253785]
curr_Stock_Price:  105.53715564927103
curr_Factors:  [105.53715565  -1.22459889  -0.99552536]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-0.55253785]
Stock Price:  105.74143996370955
PL:  [-6.29397782]
Settle:  Tensor("sub_88:0", shape=(), dtype=float64)
PL:  Tensor("sub_89:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  45
output_Z_Vals[:, i, :]:  [[ 1.19260232e+02 -2.92559343e+01 -2.92733494e+01]
 [-2.56081396e-03 -6.93897294e-02 -2.61253269e-02]
 [-5.64250084e-02 -8.14267078e-02 -8.06032409e-02]
 [ 8.49797013e-02  1.70426099e-01  3.79580597e-02]
 [ 1.56705726e-02  3.77835360e-02 -7.16733288e-02]
 [ 6.45837184e-02  2.88481601e-02 -2.81173251e-02]
 [ 7.48524056e-02  2.15436108e-02 -5.38651984e-02]
 [-5.99842560e-02  1.93087461e-02 -6.79023738e-02]
 [ 9.40501258e-02 -4.55407220e-02 -1.56249242e-01]
 [-1.46046058e-01 -1.71283108e-01 -7.43681464e-02]
 [ 1.92384187e-01  9.90897385e-02  2.23987659e-01]
 [-2.81799867e-01 -1.27557952e-01  9.20607295e-02]
 [ 5.42241921e-02 -2.86442468e-01  9.62448679e-02]
 [-1.19148268e-01 -1.16780108e-01 -5.37200796e-02]
 [-1.33789358e-01  1.15067068e-01  3.12126756e-01]
 [ 4.61648909e-02 -7.13219399e-01  5.67239058e-02]
 [-6.66651320e-02 -3.71021008e-01 -1.59320526e-01]
 [ 4.78291147e-01  3.62152345e-02 -5.62756840e-01]
 [-1.90717713e-01 -8.84159762e-03 -3.44982502e-01]
 [-8.43193366e-02 -3.88404382e-02  1.72087755e-01]
 [ 3.74614438e-01 -2.73230229e-01  1.73170535e-01]
 [ 1.01804183e-01  4.04605634e-01  4.65976019e-01]
 [-8.72305736e-02  4.36384939e-02  2.37956880e-01]
 [-1.78050250e-01 -1.48061011e-01 -5.26134042e-02]
 [-9.01646409e-01  1.52761525e-01  4.30877393e-02]
 [-2.35250022e-01 -3.70107795e-01  1.63736433e-01]
 [ 9.79357511e-03  7.63454796e-02  5.13899412e-02]
 [ 3.23301342e-02 -2.54498482e-02 -7.06199565e-03]
 [-1.31684214e-01 -1.96091677e-01 -6.77040147e-02]
 [ 1.71224894e-01  2.32987279e-01  1.02290573e-01]
 [ 7.82320805e-02 -4.27546452e-02  5.91039619e-02]
 [ 6.73066642e-02 -9.31077330e-02 -6.24481317e-02]
 [ 1.72544356e-01 -7.83299011e-02  5.47406406e-02]
 [-4.53153272e-02 -8.08774385e-02  5.39273415e-03]
 [-1.94868572e-01  1.01369790e-01  1.87050671e-02]
 [ 2.43026054e-01  6.34373058e-02  2.94023272e-02]
 [ 1.92802034e-02 -2.51584282e-02 -9.74990902e-02]
 [-8.11141085e-03  5.66084743e-02 -1.95057657e-02]
 [ 3.28133088e-01 -4.09739307e-01 -9.77139619e-02]
 [-4.66925310e-01  2.58254247e-01  2.60201519e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.26023247 -29.25593426 -29.27334937]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  8.31486419  -9.25153874 -83.50871763]
init_Out:  [2.49911038]
Stock Position:  8.31486419409362
Bond position:  [-828.98730903]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [3.45177585]
curr_Stock_Price:  100.12703699480925
curr_Factors:  [100.12703699  -1.01591343  -1.0056842 ]
mat_Sqrt:  [[13.26119528  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00073035 -0.02194296 -0.07452829]
Stock Position:  -0.000730345860958022
Bond Position:  [3.52490322]


portfolio before change:  [3.45207962]
curr_Stock_Price:  100.31444513003501
curr_Factors:  [100.31444513  -0.95240755  -1.00495711]
mat_Sqrt:  [[14.16742114  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00529246 -0.02574939 -0.22993861]
Stock Position:  -0.005292459643466972
Bond Position:  [3.98298977]


portfolio before change:  [3.45570625]
curr_Stock_Price:  99.72327791303451
curr_Factors:  [99.72327791 -1.03743847 -0.99492901]
mat_Sqrt:  [[13.06623789  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00743353 0.05389346 0.10828378]
Stock Position:  0.0074335276582685435
Bond Position:  [2.71441051]


portfolio before change:  [3.44791444]
curr_Stock_Price:  98.62943178849227
curr_Factors:  [98.62943179 -0.83076284 -0.97542527]
mat_Sqrt:  [[16.20276009  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 1.24415987e-04  1.19482032e-02 -2.04464057e-01]
Stock Position:  0.0001244159865141171
Bond Position:  [3.43564336]


portfolio before change:  [3.44835358]
curr_Stock_Price:  98.70709261332044
curr_Factors:  [98.70709261 -1.06218235 -0.99008559]
mat_Sqrt:  [[12.67826191  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0047001   0.00912259 -0.0802109 ]
Stock Position:  0.004700104020953061
Bond Position:  [2.98441998]


portfolio before change:  [3.44515557]
curr_Stock_Price:  97.94730396008806
curr_Factors:  [97.94730396 -0.98967454 -0.98933419]
mat_Sqrt:  [[13.5369216   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00475835  0.00681269 -0.15366242]
Stock Position:  0.004758354486907352
Bond Position:  [2.97908758]


portfolio before change:  [3.44288513]
curr_Stock_Price:  97.39189025149923
curr_Factors:  [97.39189025 -1.05331306 -0.98902325]
mat_Sqrt:  [[12.63419     0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00580538  0.00610596 -0.19370657]
Stock Position:  -0.005805375757349384
Bond Position:  [4.00828165]


portfolio before change:  [3.45215144]
curr_Stock_Price:  95.88204005061449
curr_Factors:  [95.88204005 -0.94509647 -1.0092756 ]
mat_Sqrt:  [[13.58201677  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00448976 -0.01440124 -0.4457356 ]
Stock Position:  0.004489762271248914
Bond Position:  [3.02166387]


portfolio before change:  [3.45232626]
curr_Stock_Price:  95.83684658367616
curr_Factors:  [95.83684658 -0.72302189 -1.02292877]
mat_Sqrt:  [[16.721521    0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00990633 -0.05416447 -0.21215162]
Stock Position:  -0.009906329894049574
Bond Position:  [4.40171768]


portfolio before change:  [3.45788325]
curr_Stock_Price:  95.33143912413354
curr_Factors:  [95.33143912 -0.6197733  -1.00994831]
mat_Sqrt:  [[18.6834487   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01288113 0.03133493 0.63897444]
Stock Position:  0.012881131641317276
Bond Position:  [2.22990643]


portfolio before change:  [3.43860741]
curr_Stock_Price:  93.8133586776117
curr_Factors:  [93.81335868 -0.56581364 -0.99840833]
mat_Sqrt:  [[19.63051591  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01356569 -0.04033737  0.26262364]
Stock Position:  -0.013565694474490067
Bond Position:  [4.71125077]


portfolio before change:  [3.44847865]
curr_Stock_Price:  93.12911056716129
curr_Factors:  [93.12911057 -0.68610419 -0.98160824]
mat_Sqrt:  [[17.57143178  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00378308 -0.09058106  0.27455982]
Stock Position:  0.0037830827705777254
Bond Position:  [3.09616352]


portfolio before change:  [3.44628406]
curr_Stock_Price:  92.44669338611118
curr_Factors:  [92.44669339 -0.67319082 -0.94835244]
mat_Sqrt:  [[18.266868    0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00728801 -0.03692911 -0.15324843]
Stock Position:  -0.007288008135077158
Bond Position:  [4.12003631]


portfolio before change:  [3.44410017]
curr_Stock_Price:  92.81701714330316
curr_Factors:  [92.81701714 -0.78229684 -0.94034381]
mat_Sqrt:  [[16.57655503  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00404823  0.0363874   0.89041075]
Stock Position:  -0.004048231474807872
Bond Position:  [3.81984494]


portfolio before change:  [3.44600379]
curr_Stock_Price:  92.46473842017919
curr_Factors:  [92.46473842 -0.81148896 -0.92561651]
mat_Sqrt:  [[16.27649257  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00241627 -0.22553978  0.16181751]
Stock Position:  0.002416267744452023
Bond Position:  [3.22258422]


portfolio before change:  [3.44565499]
curr_Stock_Price:  92.15366199951413
curr_Factors:  [92.153662   -0.68614764 -0.93609534]
mat_Sqrt:  [[18.19623023  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00597739 -0.11732714 -0.45449711]
Stock Position:  -0.005977393008653254
Bond Position:  [3.99649365]


portfolio before change:  [3.45342056]
curr_Stock_Price:  90.93808632268482
curr_Factors:  [90.93808632 -0.67841764 -0.94202702]
mat_Sqrt:  [[17.98852833  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0202548   0.01145226 -1.60538862]
Stock Position:  0.020254795403860805
Bond Position:  [1.61148822]


portfolio before change:  [3.48331406]
curr_Stock_Price:  92.40401338822302
curr_Factors:  [92.40401339 -0.6756788  -0.90970371]
mat_Sqrt:  [[18.93075607  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01380638 -0.00279596 -0.98413905]
Stock Position:  -0.013806382558517011
Bond Position:  [4.75907922]


portfolio before change:  [3.47515667]
curr_Stock_Price:  93.03794550189417
curr_Factors:  [93.0379455  -0.81020009 -0.93693707]
mat_Sqrt:  [[16.21392217  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00309579 -0.01228243  0.49091847]
Stock Position:  -0.0030957917497987817
Bond Position:  [3.76318278]


portfolio before change:  [3.47981243]
curr_Stock_Price:  91.68600395438871
curr_Factors:  [91.68600395 -0.64709428 -0.90760987]
mat_Sqrt:  [[19.36884006  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.02080186 -0.08640298  0.49400733]
Stock Position:  0.02080186268926479
Bond Position:  [1.57257276]


portfolio before change:  [3.49347188]
curr_Stock_Price:  92.33319945684451
curr_Factors:  [92.33319946 -0.77820114 -0.88788368]
mat_Sqrt:  [[17.44963876  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.0118838  0.12794754 1.32929988]
Stock Position:  0.011883799695584327
Bond Position:  [2.39620264]


portfolio before change:  [3.49146181]
curr_Stock_Price:  92.13884924783422
curr_Factors:  [92.13884925 -0.67314602 -0.88886964]
mat_Sqrt:  [[19.32270853  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00194233  0.0137997   0.67882474]
Stock Position:  -0.0019423305933991435
Bond Position:  [3.67042591]


portfolio before change:  [3.49332635]
curr_Stock_Price:  91.41512589320567
curr_Factors:  [91.41512589 -0.70476497 -0.8876905 ]
mat_Sqrt:  [[18.59616707  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01035766 -0.046821   -0.1500914 ]
Stock Position:  -0.010357663184596327
Bond Position:  [4.44017344]


portfolio before change:  [3.49316047]
curr_Stock_Price:  91.48473016591798
curr_Factors:  [91.48473017 -0.37305416 -0.89366974]
mat_Sqrt:  [[25.77611213  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.03448568  0.04830744  0.12291733]
Stock Position:  -0.03448568468232533
Bond Position:  [6.64807403]


portfolio before change:  [3.50429979]
curr_Stock_Price:  91.18581609101786
curr_Factors:  [91.18581609 -0.13037395 -0.88713243]
mat_Sqrt:  [[32.96323954  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00641271 -0.11703836  0.46709447]
Stock Position:  -0.006412707239274309
Bond Position:  [4.08904773]


portfolio before change:  [3.50581704]
curr_Stock_Price:  91.02892592680219
curr_Factors:  [91.02892593 -0.10724185 -0.91069139]
mat_Sqrt:  [[32.89248071  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00067659 0.02414256 0.1466012 ]
Stock Position:  0.0006765903408512409
Bond Position:  [3.44422775]


portfolio before change:  [3.50787658]
curr_Stock_Price:  93.4365557740734
curr_Factors:  [ 9.34365558e+01  1.28091500e-02 -9.22962839e-01]
mat_Sqrt:  [[37.60469723  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00080393 -0.00804795 -0.02014591]
Stock Position:  0.0008039287746672559
Bond Position:  [3.43276024]


portfolio before change:  [3.50811323]
curr_Stock_Price:  93.197151449949
curr_Factors:  [ 9.31971514e+01 -7.40964130e-02 -9.52197365e-01]
mat_Sqrt:  [[33.39557409  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0045086  -0.06200963 -0.19314071]
Stock Position:  -0.0045086005508513365
Bond Position:  [3.92830196]


portfolio before change:  [3.50083591]
curr_Stock_Price:  94.92016791907797
curr_Factors:  [94.92016792 -0.16499436 -0.92164749]
mat_Sqrt:  [[32.02107708  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00618719 0.07367705 0.29180653]
Stock Position:  0.0061871927515695846
Bond Position:  [2.91354653]


portfolio before change:  [3.49717134]
curr_Stock_Price:  94.26901939849616
curr_Factors:  [94.2690194  -0.125299   -0.88543593]
mat_Sqrt:  [[34.30934161  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00259966 -0.01352021  0.16860715]
Stock Position:  0.002599662419316534
Bond Position:  [3.25210372]


portfolio before change:  [3.5010196]
curr_Stock_Price:  95.5929271957709
curr_Factors:  [95.5929272  -0.3305559  -0.88721186]
mat_Sqrt:  [[28.28498435  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00184393 -0.02944325 -0.17814714]
Stock Position:  0.0018439275320224389
Bond Position:  [3.32475317]


portfolio before change:  [3.50437293]
curr_Stock_Price:  97.18610792548114
curr_Factors:  [97.18610793 -0.35595566 -0.86999597]
mat_Sqrt:  [[28.5220123   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00637037 -0.02477009  0.15615981]
Stock Position:  0.006370370041760896
Bond Position:  [2.88526145]


portfolio before change:  [3.51072379]
curr_Stock_Price:  98.12642690324881
curr_Factors:  [98.1264269  -0.50890231 -0.88793507]
mat_Sqrt:  [[24.27432817  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00190748 -0.02557569  0.01538397]
Stock Position:  -0.0019074796282531896
Bond Position:  [3.69789795]


portfolio before change:  [3.51534824]
curr_Stock_Price:  95.9443893618681
curr_Factors:  [95.94438936 -0.5265062  -0.89757909]
mat_Sqrt:  [[23.09655458  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00815849  0.03205594  0.05336035]
Stock Position:  -0.00815849215018226
Bond Position:  [4.29810979]


portfolio before change:  [3.53263333]
curr_Stock_Price:  93.8915845287041
curr_Factors:  [93.89158453 -0.34975426 -0.87643083]
mat_Sqrt:  [[27.54870881  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.009099   0.02006064 0.08387666]
Stock Position:  0.00909900078570196
Bond Position:  [2.67831373]


portfolio before change:  [3.53072172]
curr_Stock_Price:  93.64469772136735
curr_Factors:  [93.64469772 -0.59171888 -0.85798587]
mat_Sqrt:  [[21.97275022  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-5.78581585e-05 -7.95579354e-03 -2.78137766e-01]
Stock Position:  -5.785815850807201e-05
Bond Position:  [3.53613983]


portfolio before change:  [3.53120457]
curr_Stock_Price:  92.93940561129367
curr_Factors:  [92.93940561 -0.4322435  -0.8635777 ]
mat_Sqrt:  [[25.43500891  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00041798  0.01790117 -0.05564452]
Stock Position:  -0.00041798232158728166
Bond Position:  [3.5700516]


portfolio before change:  [3.53199772]
curr_Stock_Price:  92.10955550416628
curr_Factors:  [92.1095555  -0.35069032 -0.89504243]
mat_Sqrt:  [[26.50268219  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01122935 -0.12957095 -0.27875074]
Stock Position:  0.011229349678361193
Bond Position:  [2.49766731]


portfolio before change:  [3.54693041]
curr_Stock_Price:  93.41154208224734
curr_Factors:  [93.41154208 -0.39866583 -0.89798763]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [3.54693041]
Stock Price:  93.61624397952819
PL:  [3.54693041]
Settle:  Tensor("sub_90:0", shape=(), dtype=float64)
PL:  Tensor("sub_91:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  46
output_Z_Vals[:, i, :]:  [[ 1.19260232e+02 -2.92559343e+01 -2.92733494e+01]
 [-6.30779249e-03 -5.61861141e-02 -2.43934509e-02]
 [-5.83690533e-02 -8.62519381e-02 -8.02291885e-02]
 [-1.47798901e-01 -1.43292415e-02  1.90912479e-03]
 [ 2.25033766e-01 -2.25434753e-02 -4.39232043e-02]
 [-4.11408224e-02  2.88344264e-02  1.68478509e-01]
 [ 1.60454131e-02  6.15092361e-02 -8.18993076e-03]
 [ 6.29190900e-02  2.83015098e-01  1.06870011e-01]
 [ 9.58127456e-02 -1.97246959e-02 -6.46942256e-02]
 [-7.88357612e-02  4.44752161e-01  2.16888970e-01]
 [ 5.89064344e-02  5.51899574e-02 -8.15866573e-02]
 [-7.41053441e-02  3.75438329e-02  2.05592007e-02]
 [ 4.21690398e-02 -2.22227405e-01 -3.13873995e-03]
 [ 1.44391911e-01  7.42623671e-02  2.10098475e-01]
 [ 9.63316692e-02 -3.59325198e-02 -1.58839006e-01]
 [-6.08275371e-02 -9.32482845e-02 -1.31277693e-01]
 [-9.55280586e-02  5.59216598e-02 -1.19322097e-01]
 [ 2.34480479e-01 -2.36623745e-01 -2.71641191e-01]
 [ 6.22172161e-02  3.85499650e-02  4.05940355e-02]
 [-1.57844570e-01 -1.94721999e-01  6.24098358e-02]
 [ 4.40110431e-01 -2.05670957e-02  6.56008865e-01]
 [-8.86471531e-02  5.57776779e-02 -8.64880007e-02]
 [-2.41896946e-01  7.82748758e-01  2.89130584e-01]
 [ 5.37794223e-01 -6.38726358e-02  1.96318630e-01]
 [-4.94256758e-01 -2.19399766e-01 -5.21535713e-01]
 [ 8.82745896e-02 -1.23065094e-01  7.32732704e-02]
 [ 2.82047649e-01  3.48429118e-01  1.46393887e-01]
 [-4.46125330e-02  6.05618659e-02  1.66415668e-02]
 [-8.67434956e-02  5.13795343e-01  2.21340153e-01]
 [-1.84225253e-01 -2.87242538e-01  9.71424723e-02]
 [-2.96550582e-01  1.18354622e+00 -7.40287258e-02]
 [ 7.68232525e-02  4.96667761e-01  5.82774684e-01]
 [-9.88836555e-02  2.79836210e-02  8.55434618e-02]
 [-8.72170661e-01  1.31618964e-01  9.26311611e-03]
 [-1.02352339e-01  1.40494942e-01  2.29015794e-02]
 [ 8.47165236e-02 -1.65012150e-01 -1.38726811e-01]
 [-4.12411375e-01 -7.75464646e-01  2.63533922e-01]
 [-1.15251632e-01 -1.67014960e-01  3.67283243e-01]
 [ 9.52863704e-03 -1.96508996e-03 -5.11830273e-02]
 [ 3.76681826e-01 -2.58792242e-02 -3.85322996e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.26023247 -29.25593426 -29.27334937]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  8.31486419  -9.25153874 -83.50871763]
init_Out:  [2.49911038]
Stock Position:  8.31486419409362
Bond position:  [-828.98730903]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [4.64449265]
curr_Stock_Price:  100.2704809252609
curr_Factors:  [100.27048093  -0.677579    -1.00492537]
mat_Sqrt:  [[18.64106564  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00068332 -0.01776761 -0.06958773]
Stock Position:  -0.0006833195203160093
Bond Position:  [4.71300943]


portfolio before change:  [4.64490775]
curr_Stock_Price:  100.52521641802231
curr_Factors:  [100.52521642  -0.65791703  -0.98218009]
mat_Sqrt:  [[19.49799194  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00394773 -0.02727526 -0.22887154]
Stock Position:  -0.003947728747325633
Bond Position:  [5.04175403]


portfolio before change:  [4.64833474]
curr_Stock_Price:  99.81677407932384
curr_Factors:  [99.81677408 -0.42398277 -0.98327235]
mat_Sqrt:  [[24.43657864  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00604746 -0.0045313   0.0054462 ]
Stock Position:  -0.00604745797638799
Bond Position:  [5.25197249]


portfolio before change:  [4.63964461]
curr_Stock_Price:  101.36232719613146
curr_Factors:  [101.3623272   -0.46687924  -0.96780571]
mat_Sqrt:  [[24.14353274  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0089252  -0.00712887 -0.12530068]
Stock Position:  0.008925202113560016
Bond Position:  [3.73496536]


portfolio before change:  [4.65146285]
curr_Stock_Price:  102.63415710710376
curr_Factors:  [102.63415711  -0.46705543  -0.98343489]
mat_Sqrt:  [[24.06312225  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-2.49584780e-04  9.11824625e-03  4.80622291e-01]
Stock Position:  -0.0002495847801623978
Bond Position:  [4.67707878]


portfolio before change:  [4.65242108]
curr_Stock_Price:  101.13743469104871
curr_Factors:  [101.13743469  -0.63361246  -0.99205687]
mat_Sqrt:  [[19.90181642  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00080203  0.01945093 -0.02336359]
Stock Position:  0.0008020279047009526
Bond Position:  [4.57130604]


portfolio before change:  [4.65352516]
curr_Stock_Price:  101.80153543968805
curr_Factors:  [101.80153544  -0.53903818  -0.98135754]
mat_Sqrt:  [[22.25639676  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.0041355  0.08949723 0.30487039]
Stock Position:  0.004135496818475503
Bond Position:  [4.23252523]


portfolio before change:  [4.64624366]
curr_Stock_Price:  99.91286184889677
curr_Factors:  [99.91286185 -0.56895307 -0.95835981]
mat_Sqrt:  [[21.69291125  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00378455 -0.0062375  -0.18455462]
Stock Position:  0.0037845451743362623
Bond Position:  [4.26811892]


portfolio before change:  [4.64819089]
curr_Stock_Price:  100.28640374147442
curr_Factors:  [100.28640374  -0.39544247  -0.97516669]
mat_Sqrt:  [[25.46795433  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00090624  0.14064298  0.61872386]
Stock Position:  -0.0009062382425989139
Bond Position:  [4.73907426]


portfolio before change:  [4.64795649]
curr_Stock_Price:  101.1987728372994
curr_Factors:  [101.19877284  -0.58621572  -1.00415699]
mat_Sqrt:  [[20.62933161  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00211726  0.0174526  -0.23274402]
Stock Position:  0.0021172584309292496
Bond Position:  [4.43369253]


portfolio before change:  [4.65042881]
curr_Stock_Price:  102.10469593821973
curr_Factors:  [ 1.02104696e+02 -4.58630879e-02 -9.99487567e-01]
mat_Sqrt:  [[35.8967967   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00192049  0.0118724   0.05864968]
Stock Position:  -0.0019204871633175537
Bond Position:  [4.84651957]


portfolio before change:  [4.64672865]
curr_Stock_Price:  104.34684314921296
curr_Factors:  [104.34684315  -0.19586239  -1.01852114]
mat_Sqrt:  [[30.97984544  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00115528 -0.07027448 -0.00895395]
Stock Position:  0.0011552820796791442
Bond Position:  [4.52617861]


portfolio before change:  [4.64466105]
curr_Stock_Price:  102.06739328295886
curr_Factors:  [102.06739328  -0.28111941  -1.0288947 ]
mat_Sqrt:  [[27.53944132  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00686998 0.02348382 0.59935247]
Stock Position:  0.006869984278419328
Bond Position:  [3.94345966]


portfolio before change:  [4.64755477]
curr_Stock_Price:  102.4168494815077
curr_Factors:  [102.41684948  -0.42678059  -1.00655261]
mat_Sqrt:  [[24.42770773  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00257826 -0.01136286 -0.45312347]
Stock Position:  0.0025782615370863824
Bond Position:  [4.38349734]


portfolio before change:  [4.65298722]
curr_Stock_Price:  104.3113350662284
curr_Factors:  [104.31133507  -0.536537    -1.01942098]
mat_Sqrt:  [[22.00835269  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00409082 -0.0294877  -0.37449872]
Stock Position:  -0.004090817040257672
Bond Position:  [5.0797058]


portfolio before change:  [4.64623376]
curr_Stock_Price:  106.11744297146664
curr_Factors:  [106.11744297  -0.68367326  -0.99133988]
mat_Sqrt:  [[19.87640384  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00595886  0.01768398 -0.34039273]
Stock Position:  -0.005958859030680933
Bond Position:  [5.27857265]


portfolio before change:  [4.63866525]
curr_Stock_Price:  107.49830744688576
curr_Factors:  [107.49830745  -0.87247323  -0.97825866]
mat_Sqrt:  [[16.89036288  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01023793 -0.074827   -0.77491671]
Stock Position:  0.010237930074091553
Bond Position:  [3.5381051]


portfolio before change:  [4.65546584]
curr_Stock_Price:  109.0961201505935
curr_Factors:  [109.09612015  -1.05887028  -0.97164635]
mat_Sqrt:  [[14.32079529  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00499266 0.01219057 0.11580348]
Stock Position:  0.004992655316641335
Bond Position:  [4.11078651]


portfolio before change:  [4.6601776]
curr_Stock_Price:  109.93693120050759
curr_Factors:  [109.9369312   -1.08327063  -0.97284452]
mat_Sqrt:  [[14.06643825  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01067313 -0.0615765   0.17803789]
Stock Position:  -0.010673129432312049
Bond Position:  [5.83354869]


portfolio before change:  [4.66381349]
curr_Stock_Price:  109.66459740329972
curr_Factors:  [109.6645974   -1.07984819  -0.96958674]
mat_Sqrt:  [[14.12564098  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.04059898 -0.00650389  1.87141069]
Stock Position:  0.04059898167324197
Bond Position:  [0.21154251]


portfolio before change:  [4.68285355]
curr_Stock_Price:  110.13292485377995
curr_Factors:  [110.13292485  -1.07814851  -0.97255568]
mat_Sqrt:  [[14.16797106  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00740129  0.01763845 -0.24672619]
Stock Position:  -0.007401290447668985
Bond Position:  [5.49797932]


portfolio before change:  [4.68598085]
curr_Stock_Price:  109.80325102592535
curr_Factors:  [109.80325103  -0.84862525  -0.95706091]
mat_Sqrt:  [[18.04744238  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00901335  0.24752689  0.82480908]
Stock Position:  -0.009013350656285304
Bond Position:  [5.67567606]


portfolio before change:  [4.68525957]
curr_Stock_Price:  109.96199137306498
curr_Factors:  [109.96199137  -0.50707139  -0.93063374]
mat_Sqrt:  [[26.11290538  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.02206642 -0.0201983   0.56004241]
Stock Position:  0.022066422815158793
Bond Position:  [2.25879178]


portfolio before change:  [4.71010403]
curr_Stock_Price:  111.07508948295327
curr_Factors:  [111.07508948  -0.18783744  -0.92960133]
mat_Sqrt:  [[36.33449926  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01668881 -0.0693803  -1.48779622]
Stock Position:  -0.016688813109854806
Bond Position:  [6.56381544]


portfolio before change:  [4.69606251]
curr_Stock_Price:  111.96562925200897
curr_Factors:  [ 1.11965629e+02  4.36303581e-02 -9.10491189e-01]
mat_Sqrt:  [[47.0556579   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00212629 -0.0389166   0.20902825]
Stock Position:  0.0021262885410508045
Bond Position:  [4.45799128]


portfolio before change:  [4.69960474]
curr_Stock_Price:  113.36945679545045
curr_Factors:  [ 1.13369457e+02  9.56970231e-02 -9.08119546e-01]
mat_Sqrt:  [[50.31128932  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00637882 0.11018296 0.41762101]
Stock Position:  0.006378818383717775
Bond Position:  [3.97644156]


portfolio before change:  [4.71083486]
curr_Stock_Price:  115.05206243248954
curr_Factors:  [ 1.15052062e+02  4.36074098e-02 -8.74246524e-01]
mat_Sqrt:  [[50.13631662  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00079088  0.01915134  0.04747376]
Stock Position:  -0.0007908815286688273
Bond Position:  [4.80182741]


portfolio before change:  [4.71028952]
curr_Stock_Price:  116.50058293985066
curr_Factors:  [116.50058294  -0.14903993  -0.84179773]
mat_Sqrt:  [[43.25265451  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00065421  0.16247635  0.63142185]
Stock Position:  -0.0006542138890009063
Bond Position:  [4.78650582]


portfolio before change:  [4.71359943]
curr_Stock_Price:  112.35581672557207
curr_Factors:  [112.35581673  -0.3409196   -0.83380864]
mat_Sqrt:  [[34.70703945  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00495037 -0.09083407  0.27712043]
Stock Position:  -0.004950370364095098
Bond Position:  [5.26980234]


portfolio before change:  [4.70690775]
curr_Stock_Price:  113.84064395647025
curr_Factors:  [113.84064396  -0.1430508   -0.83404476]
mat_Sqrt:  [[42.8499317   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00656016  0.37427018 -0.21118335]
Stock Position:  -0.006560164493401977
Bond Position:  [5.4537211]


portfolio before change:  [4.7014965]
curr_Stock_Price:  114.76943314997939
curr_Factors:  [114.76943315  -0.4352237   -0.81712013]
mat_Sqrt:  [[32.80501351  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00635895 0.15706014 1.66249396]
Stock Position:  0.0063589531241150105
Bond Position:  [3.97168306]


portfolio before change:  [4.7010313]
curr_Stock_Price:  114.6181983300056
curr_Factors:  [114.61819833  -0.49887038  -0.84090133]
mat_Sqrt:  [[30.01913114  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00268827  0.0088492   0.24403169]
Stock Position:  -0.002688273526558273
Bond Position:  [5.00915637]


portfolio before change:  [4.69932432]
curr_Stock_Price:  115.48610034437209
curr_Factors:  [115.48610034  -0.40767278  -0.84085715]
mat_Sqrt:  [[33.13599812  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02616132  0.04162157  0.02642509]
Stock Position:  -0.026161319928434134
Bond Position:  [7.72059314]


portfolio before change:  [4.69643457]
curr_Stock_Price:  115.6334509904628
curr_Factors:  [115.63345099  -0.47520062  -0.82688364]
mat_Sqrt:  [[31.44817734  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00299063  0.0444284   0.06533183]
Stock Position:  -0.002990634676525808
Bond Position:  [5.04225198]


portfolio before change:  [4.69282988]
curr_Stock_Price:  117.04954140655583
curr_Factors:  [117.04954141  -0.58385231  -0.82130345]
mat_Sqrt:  [[28.71562832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00181568 -0.05218142 -0.39574898]
Stock Position:  0.0018156815476619648
Bond Position:  [4.48030519]


portfolio before change:  [4.69126966]
curr_Stock_Price:  115.8817727532174
curr_Factors:  [115.88177275  -0.72699349  -0.80394475]
mat_Sqrt:  [[25.06900523  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01510392 -0.24522345  0.75178892]
Stock Position:  -0.015103916008086719
Bond Position:  [6.44153822]


portfolio before change:  [4.69622959]
curr_Stock_Price:  115.60669937922985
curr_Factors:  [115.60669938  -0.54887407  -0.82341038]
mat_Sqrt:  [[29.30943464  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00152144 -0.05281477  1.04775686]
Stock Position:  -0.0015214405267351238
Bond Position:  [4.8721183]


portfolio before change:  [4.69823308]
curr_Stock_Price:  114.69016967795227
curr_Factors:  [114.69016968  -0.66125385  -0.79069894]
mat_Sqrt:  [[26.85042186  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-3.61183550e-05 -6.21416009e-04 -1.46010930e-01]
Stock Position:  -3.611835501169388e-05
Bond Position:  [4.7023755]


portfolio before change:  [4.69885036]
curr_Stock_Price:  113.87497760901063
curr_Factors:  [113.87497761  -0.36131452  -0.78198651]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [4.69885036]
Stock Price:  114.42182614757063
PL:  [-9.72297579]
Settle:  Tensor("sub_92:0", shape=(), dtype=float64)
PL:  Tensor("sub_93:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  47
output_Z_Vals[:, i, :]:  [[ 1.19260232e+02 -2.92559343e+01 -2.92733494e+01]
 [-6.17412003e-03 -5.66077760e-02 -2.44169856e-02]
 [-5.73544766e-02 -8.08974841e-02 -7.15993683e-02]
 [ 8.65919735e-02  1.85086538e-01  3.81539219e-02]
 [ 2.22223506e-01 -2.47563496e-02 -4.81609696e-02]
 [ 7.31404502e-02  3.14965156e-02 -1.60353254e-04]
 [ 7.88285849e-03  6.16962695e-02 -4.37770308e-02]
 [ 1.66245653e-02  1.20987011e-01  6.90057751e-02]
 [-1.53396091e-01 -5.50961283e-02  1.18712646e-01]
 [-4.15686075e-02  1.11588959e-01  1.24668182e-03]
 [ 5.21421319e-02  6.82140748e-02 -7.39210886e-02]
 [-4.39071471e-02  8.32555406e-02  3.55036937e-03]
 [-1.05268475e-01  3.60169765e-02 -5.01576103e-02]
 [-5.58178474e-03  6.35560982e-02  1.49889793e-01]
 [ 3.12413822e-01  4.38571175e-01  1.00329081e-01]
 [-8.13491574e-02 -1.04763717e-01 -1.16757163e-01]
 [-7.21646901e-02 -5.56340661e-02 -7.14415558e-02]
 [-7.73078317e-02  8.22187179e-02  9.18743048e-02]
 [ 4.94563863e-02  5.75580281e-02  4.08510420e-02]
 [ 1.65622170e-01 -3.80641057e-02 -5.02612118e-04]
 [-7.21397548e-03  2.01461023e-02  5.19610300e-02]
 [ 2.66857315e-02 -2.38745561e-02  2.58571847e-02]
 [-7.29900197e-02  8.75448711e-02  2.80663366e-01]
 [ 5.00103058e-02 -1.30465917e-02 -4.81820079e-02]
 [ 4.84653451e-02  3.10504015e-02  8.09982264e-02]
 [ 7.73855859e-02 -1.90705218e-02  6.35456467e-02]
 [-1.74725165e-01  7.07111981e-02  7.85519569e-02]
 [-5.07806065e-02  7.36225950e-02  2.93687317e-02]
 [ 6.20848838e-02 -6.23725319e-02  9.08311027e-02]
 [ 3.67730433e-02  6.21482096e-03 -3.97838108e-02]
 [-2.12277171e-02  2.70134882e-01  2.18001984e-02]
 [ 1.68618988e-02 -8.74037777e-02 -8.50549459e-02]
 [ 1.51448764e-01 -8.44267680e-02  3.25123216e-02]
 [-4.81112433e-02 -8.36055037e-02 -1.07100409e-03]
 [-1.57776096e-01  1.35036485e-01  3.36251466e-02]
 [ 9.49107089e-02 -1.60702318e-01 -1.33515196e-01]
 [-1.88027742e-01 -3.10799666e-01  4.16475506e-02]
 [-5.07412987e-02 -3.59671686e-02  5.99255521e-02]
 [-3.31017757e-02  7.11537948e-02 -2.77027033e-02]
 [ 1.50048713e-01 -8.37982386e-03 -1.43965624e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.26023247 -29.25593426 -29.27334937]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  8.31486419  -9.25153874 -83.50871763]
init_Out:  [2.49911038]
Stock Position:  8.31486419409362
Bond position:  [-828.98730903]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [4.34899379]
curr_Stock_Price:  100.23494229776998
curr_Factors:  [100.2349423   -1.00704343  -1.01981126]
mat_Sqrt:  [[13.20587977  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00095562 -0.01790095 -0.06965486]
Stock Position:  -0.0009556215145405229
Bond Position:  [4.44478046]


portfolio before change:  [4.34927656]
curr_Stock_Price:  100.5204764631716
curr_Factors:  [100.52047646  -1.12610376  -1.04213278]
mat_Sqrt:  [[11.49744582  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00644129 -0.02558203 -0.20425307]
Stock Position:  -0.006441291536575543
Bond Position:  [4.99675825]


portfolio before change:  [4.34859811]
curr_Stock_Price:  100.72277771607911
curr_Factors:  [100.72277772  -1.29828614  -1.04666731]
mat_Sqrt:  [[ 9.6544459   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01027081 0.0585295  0.10884252]
Stock Position:  0.010270814609128992
Bond Position:  [3.31409313]


portfolio before change:  [4.35299214]
curr_Stock_Price:  101.1102582089818
curr_Factors:  [101.11025821  -1.19241964  -1.05935492]
mat_Sqrt:  [[10.63804815  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01990529 -0.00782865 -0.13738984]
Stock Position:  0.019905294681533712
Bond Position:  [2.34036265]


portfolio before change:  [4.34530643]
curr_Stock_Price:  100.70944680182046
curr_Factors:  [100.7094468   -1.13199068  -1.04362808]
mat_Sqrt:  [[11.43433691  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00646482  0.00996007 -0.00045744]
Stock Position:  0.006464822168393377
Bond Position:  [3.69423777]


portfolio before change:  [4.35238259]
curr_Stock_Price:  101.73257558136781
curr_Factors:  [101.73257558  -1.15856393  -1.02785951]
mat_Sqrt:  [[11.42637316  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 4.72503672e-05  1.95100735e-02 -1.24883684e-01]
Stock Position:  4.725036720062497e-05
Bond Position:  [4.34757569]


portfolio before change:  [4.35291434]
curr_Stock_Price:  101.4844414266581
curr_Factors:  [101.48444143  -1.49678471  -1.00871278]
mat_Sqrt:  [[ 8.28467994  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00408395 0.03825945 0.19685427]
Stock Position:  0.004083945494497307
Bond Position:  [3.93845742]


portfolio before change:  [4.3517703]
curr_Stock_Price:  101.08375568788026
curr_Factors:  [101.08375569  -1.32955207  -1.04015232]
mat_Sqrt:  [[ 9.45217661  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0138155  -0.01742293  0.33865414]
Stock Position:  -0.013815500324463638
Bond Position:  [5.74829296]


portfolio before change:  [4.35079979]
curr_Stock_Price:  101.2060168930865
curr_Factors:  [101.20601689  -1.50559627  -1.06225422]
mat_Sqrt:  [[ 7.76252537  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00495108  0.03528753  0.00355644]
Stock Position:  -0.004951083995709112
Bond Position:  [4.85187928]


portfolio before change:  [4.35237704]
curr_Stock_Price:  101.00995251922406
curr_Factors:  [101.00995252  -1.7320969   -1.08114456]
mat_Sqrt:  [[ 6.06162307  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00640329  0.02157118 -0.21087629]
Stock Position:  0.006403290381599854
Bond Position:  [3.70558098]


portfolio before change:  [4.35541264]
curr_Stock_Price:  101.41167880315494
curr_Factors:  [101.4116788   -1.51623612  -1.10954725]
mat_Sqrt:  [[ 7.34048478  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00558993  0.02632771  0.01012822]
Stock Position:  -0.005589928104215382
Bond Position:  [4.92229663]


portfolio before change:  [4.35800065]
curr_Stock_Price:  101.05877924624401
curr_Factors:  [101.05877925  -1.51874728  -1.15150311]
mat_Sqrt:  [[ 6.99679323  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01637563  0.01138957 -0.1430857 ]
Stock Position:  -0.016375630411244926
Bond Position:  [6.01290186]


portfolio before change:  [4.35917434]
curr_Stock_Price:  101.03300733530723
curr_Factors:  [101.03300734  -1.75683853  -1.14991743]
mat_Sqrt:  [[ 5.52173052  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00482735 0.0200982  0.42759386]
Stock Position:  0.004827354825444515
Bond Position:  [3.87145216]


portfolio before change:  [4.3599913]
curr_Stock_Price:  101.10198883368973
curr_Factors:  [101.10198883  -1.44444903  -1.16155866]
mat_Sqrt:  [[ 7.46422873  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.04611558 0.13868838 0.28621094]
Stock Position:  0.046115584305794835
Bond Position:  [-0.30238599]


portfolio before change:  [4.3357909]
curr_Stock_Price:  100.57803147911883
curr_Factors:  [100.57803148  -1.00512931  -1.19254622]
mat_Sqrt:  [[11.17029842  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00965839 -0.0331292  -0.33307569]
Stock Position:  -0.00965839023011677
Bond Position:  [5.30721277]


portfolio before change:  [4.3384343]
curr_Stock_Price:  100.37303203882742
curr_Factors:  [100.37303204  -1.10625624  -1.20937462]
mat_Sqrt:  [[ 9.90720925  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.008901   -0.01759304 -0.20380287]
Stock Position:  -0.008901003271402398
Bond Position:  [5.23185499]


portfolio before change:  [4.34388774]
curr_Stock_Price:  99.83383235015624
curr_Factors:  [99.83383235 -0.64859034 -1.21899929]
mat_Sqrt:  [[15.42388837  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00365869  0.02599984  0.26209182]
Stock Position:  -0.0036586876337409056
Bond Position:  [4.70914855]


portfolio before change:  [4.34048026]
curr_Stock_Price:  100.92607346188035
curr_Factors:  [100.92607346  -0.66173288  -1.20863112]
mat_Sqrt:  [[15.5494349   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00381244 0.01820145 0.11653665]
Stock Position:  0.003812435150620144
Bond Position:  [3.95570615]


portfolio before change:  [4.33821228]
curr_Stock_Price:  100.20147963321436
curr_Factors:  [100.20147963  -0.43898518  -1.20141501]
mat_Sqrt:  [[19.42931039  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00846848 -0.01203693 -0.00143381]
Stock Position:  0.008468481895967332
Bond Position:  [3.48965787]


portfolio before change:  [4.35071013]
curr_Stock_Price:  101.62577370797061
curr_Factors:  [101.62577371  -0.40905336  -1.2141229 ]
mat_Sqrt:  [[20.04782992  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00019517 0.00637076 0.14823036]
Stock Position:  0.00019516803021828204
Bond Position:  [4.33087602]


portfolio before change:  [4.35121441]
curr_Stock_Price:  101.43561239456506
curr_Factors:  [101.43561239  -0.30201572  -1.21324644]
mat_Sqrt:  [[22.29053341  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00140631 -0.0075498   0.07376335]
Stock Position:  0.0014063086007493311
Bond Position:  [4.20856463]


portfolio before change:  [4.35100772]
curr_Stock_Price:  100.9145360423419
curr_Factors:  [100.91453604  -0.59967144  -1.18157198]
mat_Sqrt:  [[16.99689298  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-7.9070047e-04  2.7684119e-02  8.0065446e-01]
Stock Position:  -0.0007907004704491761
Bond Position:  [4.43080089]


portfolio before change:  [4.35077828]
curr_Stock_Price:  101.90519649053901
curr_Factors:  [101.90519649  -0.53011883  -1.17037533]
mat_Sqrt:  [[18.60720318  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00214102 -0.00412569 -0.13744986]
Stock Position:  0.002141016719620414
Bond Position:  [4.13259755]


portfolio before change:  [4.35386729]
curr_Stock_Price:  103.1066816125538
curr_Factors:  [103.10668161  -0.54556381  -1.20543914]
mat_Sqrt:  [[17.89929357  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00367617 0.009819   0.23106539]
Stock Position:  0.0036761650085276086
Bond Position:  [3.97483012]


portfolio before change:  [4.3511849]
curr_Stock_Price:  102.24184735103235
curr_Factors:  [102.24184735  -0.64262376  -1.2017166 ]
mat_Sqrt:  [[16.16746195  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00555835 -0.00603063  0.18127804]
Stock Position:  0.005558348508459691
Bond Position:  [3.78288908]


portfolio before change:  [4.35470966]
curr_Stock_Price:  102.79090651608752
curr_Factors:  [102.79090652  -0.57616715  -1.20568325]
mat_Sqrt:  [[17.30242195  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00906608  0.02236084  0.22408687]
Stock Position:  -0.009066075228626291
Bond Position:  [5.28661975]


portfolio before change:  [4.34840237]
curr_Stock_Price:  103.55950328509344
curr_Factors:  [103.55950329  -0.76367616  -1.20678009]
mat_Sqrt:  [[14.43549508  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00297079  0.02328151  0.08378082]
Stock Position:  -0.0029707891391329137
Bond Position:  [4.65605582]


portfolio before change:  [4.35337211]
curr_Stock_Price:  102.08255775232045
curr_Factors:  [102.08255775  -0.70506763  -1.1881615 ]
mat_Sqrt:  [[15.37207797  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00514018 -0.01972393  0.25911585]
Stock Position:  0.005140180351813941
Bond Position:  [3.82864935]


portfolio before change:  [4.35766706]
curr_Stock_Price:  102.8250107172626
curr_Factors:  [102.82501072  -0.56326466  -1.192616  ]
mat_Sqrt:  [[17.76353865  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00162201  0.0019653  -0.11349214]
Stock Position:  0.0016220120061876777
Bond Position:  [4.19088366]


portfolio before change:  [4.3577062]
curr_Stock_Price:  102.52615291801267
curr_Factors:  [102.52615292  -0.78162477  -1.19039082]
mat_Sqrt:  [[14.26918514  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.000687    0.08542415  0.0621899 ]
Stock Position:  -0.0006869991160141245
Bond Position:  [4.42814158]


portfolio before change:  [4.35876858]
curr_Stock_Price:  101.78550777933468
curr_Factors:  [101.78550778  -0.72369942  -1.17350046]
mat_Sqrt:  [[15.26660641  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-1.80565677e-04 -2.76395014e-02 -2.42638086e-01]
Stock Position:  -0.00018056567687513522
Bond Position:  [4.37714754]


portfolio before change:  [4.35909525]
curr_Stock_Price:  103.00669217253841
curr_Factors:  [103.00669217  -0.81565838  -1.17460288]
mat_Sqrt:  [[14.0768654   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01107529 -0.02669809  0.0927486 ]
Stock Position:  0.011075294108851243
Bond Position:  [3.21826584]


portfolio before change:  [4.37013789]
curr_Stock_Price:  103.96741888335647
curr_Factors:  [103.96741888  -0.65283227  -1.16928814]
mat_Sqrt:  [[16.80971782  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00300353 -0.02643838 -0.00305528]
Stock Position:  -0.0030035332227951856
Bond Position:  [4.68240748]


portfolio before change:  [4.37304675]
curr_Stock_Price:  103.19382183712291
curr_Factors:  [103.19382184  -0.65292878  -1.1313008 ]
mat_Sqrt:  [[17.32896545  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00850748  0.04270229  0.09592318]
Stock Position:  -0.008507476418663609
Bond Position:  [5.25096576]


portfolio before change:  [4.36805762]
curr_Stock_Price:  103.8574200895418
curr_Factors:  [103.85742009  -0.65701067  -1.13258362]
mat_Sqrt:  [[17.34708885  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.003661   -0.05081853 -0.38088169]
Stock Position:  0.00366100146307835
Bond Position:  [3.98783545]


portfolio before change:  [4.36985357]
curr_Stock_Price:  104.21181631161895
curr_Factors:  [104.21181631  -0.68478112  -1.15782605]
mat_Sqrt:  [[16.50755834  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01136154 -0.09828348  0.11880887]
Stock Position:  -0.011361540010843876
Bond Position:  [5.55386029]


portfolio before change:  [4.3708958]
curr_Stock_Price:  104.18119121770415
curr_Factors:  [104.18119122  -0.59300795  -1.13471981]
mat_Sqrt:  [[18.5117164   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00213042 -0.01137382  0.17095092]
Stock Position:  -0.00213041913622651
Bond Position:  [4.5928454]


portfolio before change:  [4.3699568]
curr_Stock_Price:  104.89144223725057
curr_Factors:  [104.89144224  -0.6050301   -1.15590737]
mat_Sqrt:  [[18.02912411  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00204776  0.02250081 -0.0790281 ]
Stock Position:  -0.0020477635509442292
Bond Position:  [4.58474968]


portfolio before change:  [4.36881307]
curr_Stock_Price:  105.7298533523419
curr_Factors:  [105.72985335  -0.65636173  -1.16790041]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [4.36881307]
Stock Price:  106.59475170217783
PL:  [-2.22593864]
Settle:  Tensor("sub_94:0", shape=(), dtype=float64)
PL:  Tensor("sub_95:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  48
output_Z_Vals[:, i, :]:  [[ 1.19260232e+02 -2.92559343e+01 -2.92733494e+01]
 [-6.75681509e-03 -5.47696987e-02 -2.43143950e-02]
 [ 8.48389013e-02  6.38183512e-02 -3.31850409e-02]
 [ 8.32312481e-02  1.54527363e-01  3.77456539e-02]
 [ 2.19773512e-01 -2.66855411e-02 -5.18554682e-02]
 [ 4.90977281e-02  2.93348615e-02  4.17354922e-02]
 [ 2.25399728e-02  5.63771309e-02 -1.69079701e-02]
 [-1.22145695e-01  2.65273489e-01  1.79175679e-02]
 [ 8.63277662e-02 -3.99393441e-02 -7.37413266e-02]
 [-4.50869873e-02 -1.11258824e-01 -1.30518502e-01]
 [ 8.77415906e-02  8.65322450e-02 -6.53037075e-02]
 [-2.15723621e-01 -1.03615593e-01  5.20978789e-02]
 [ 5.84633173e-03 -1.36094397e-01  8.12372210e-02]
 [-1.19444864e-01 -1.22887239e-01  4.68117526e-02]
 [-4.19594693e-02  2.00133759e-01  2.89550665e-01]
 [-5.23389751e-02 -5.68161427e-01 -2.23068405e-02]
 [-6.90618554e-02  1.83812026e-02 -9.58889742e-02]
 [ 7.64929069e-02  1.12045699e-01 -2.99880051e-02]
 [ 4.34812314e-02  4.21047518e-02  8.84977378e-04]
 [-3.39695207e-02 -9.59828774e-03  9.98004301e-02]
 [ 4.20617151e-02 -8.06935044e-02  5.23779492e-02]
 [ 1.21247464e-01 -3.80563515e-03  2.31212578e-01]
 [-6.01340945e-02  3.54801231e-02  3.19859519e-01]
 [-7.00762786e-02 -5.30537610e-04 -8.15772117e-02]
 [-4.88686726e-01  1.47717477e-01  6.33644352e-02]
 [-1.31477349e-01 -2.53130661e-01  1.30428185e-01]
 [ 4.73724759e-02  6.63990919e-02 -2.61362841e-02]
 [ 3.80767716e-02 -3.68767367e-02 -1.19120310e-02]
 [-1.29884625e-01 -1.75588090e-01 -8.64574399e-02]
 [ 1.50595323e-01  1.92428149e-01  6.53959090e-02]
 [ 9.07318970e-02 -1.03365204e-01  8.22604133e-02]
 [ 1.08488899e-01  5.44573660e-02  2.85252144e-02]
 [ 3.27108578e-01 -2.36812665e-01 -1.20790734e-01]
 [-4.26135961e-02 -7.82398450e-02  1.28251896e-02]
 [-1.73736218e-01  1.11003236e-02  1.72058430e-02]
 [ 1.03782113e-01 -8.53854291e-02 -5.01773617e-02]
 [ 2.32131042e-02  9.12849851e-03 -9.49499253e-02]
 [-1.30893565e-02  3.55061167e-02 -5.28729148e-02]
 [ 1.72178863e-01 -2.47716100e-01 -4.68401270e-02]
 [-8.08928013e-01  4.08030468e-01  4.87988693e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.26023247 -29.25593426 -29.27334937]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  8.31486419  -9.25153874 -83.50871763]
init_Out:  [2.49911038]
Stock Position:  8.31486419409362
Bond position:  [-828.98730903]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [4.74955]
curr_Stock_Price:  100.28311580930426
curr_Factors:  [100.28311581  -0.72850145  -0.99361726]
mat_Sqrt:  [[17.91930508  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00073296 -0.0173197  -0.0693622 ]
Stock Position:  -0.0007329591000487326
Bond Position:  [4.82305342]


portfolio before change:  [4.74947479]
curr_Stock_Price:  101.2082981954896
curr_Factors:  [101.2082982   -0.81393107  -1.0128988 ]
mat_Sqrt:  [[16.28673342  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00489434  0.02018113 -0.09466768]
Stock Position:  0.004894340313048233
Bond Position:  [4.25412694]


portfolio before change:  [4.74745836]
curr_Stock_Price:  100.68764835972343
curr_Factors:  [100.68764836  -0.95673496  -1.03597997]
mat_Sqrt:  [[13.72622457  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00691566 0.04886584 0.10767784]
Stock Position:  0.006915661791750196
Bond Position:  [4.05113663]


portfolio before change:  [4.74939228]
curr_Stock_Price:  100.89406424601874
curr_Factors:  [100.89406425  -0.89961537  -1.03679163]
mat_Sqrt:  [[14.55106368  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01432882 -0.00843871 -0.14792922]
Stock Position:  0.014328817874894442
Bond Position:  [3.30369961]


portfolio before change:  [4.74622765]
curr_Stock_Price:  100.64438449182043
curr_Factors:  [100.64438449  -0.74470059  -1.04618818]
mat_Sqrt:  [[16.78867558  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00347701 0.0092765  0.11905974]
Stock Position:  0.003477008792055668
Bond Position:  [4.39628624]


portfolio before change:  [4.74865598]
curr_Stock_Price:  101.1847211387213
curr_Factors:  [101.18472114  -0.68794784  -1.05094672]
mat_Sqrt:  [[17.77962617  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0011555   0.01782801 -0.04823373]
Stock Position:  0.0011554966865350157
Bond Position:  [4.63173737]


portfolio before change:  [4.7488757]
curr_Stock_Price:  100.87378424675913
curr_Factors:  [100.87378425  -0.70617664  -1.0405299 ]
mat_Sqrt:  [[17.58706227  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00634779  0.08388684  0.05111383]
Stock Position:  -0.006347788656448262
Bond Position:  [5.38920116]


portfolio before change:  [4.76810598]
curr_Stock_Price:  97.95046804002234
curr_Factors:  [97.95046804 -0.65741518 -1.03095871]
mat_Sqrt:  [[18.10318762  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00388021 -0.01262993 -0.21036348]
Stock Position:  0.003880208995728696
Bond Position:  [4.3880377]


portfolio before change:  [4.77021965]
curr_Stock_Price:  98.35383045043127
curr_Factors:  [98.35383045 -0.50075513 -1.04042608]
mat_Sqrt:  [[21.06031119  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00354229 -0.03518313 -0.37233296]
Stock Position:  -0.003542286474995713
Bond Position:  [5.1186171]


portfolio before change:  [4.77228323]
curr_Stock_Price:  97.9519110381343
curr_Factors:  [97.95191104 -0.42268218 -1.00568595]
mat_Sqrt:  [[23.47904968  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00326443  0.0273639  -0.1862933 ]
Stock Position:  0.003264432810257003
Bond Position:  [4.4525258]


portfolio before change:  [4.76714325]
curr_Stock_Price:  96.2068657498355
curr_Factors:  [96.20686575 -0.43868732 -0.98771118]
mat_Sqrt:  [[23.10622882  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00899171 -0.03276613  0.14862075]
Stock Position:  -0.00899171089689407
Bond Position:  [5.63220757]


portfolio before change:  [4.77691719]
curr_Stock_Price:  95.1981738357887
curr_Factors:  [95.19817384 -0.48171637 -0.94396788]
mat_Sqrt:  [[22.88030528  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00082669 -0.04303683  0.23174718]
Stock Position:  0.0008266877374406961
Bond Position:  [4.69821802]


portfolio before change:  [4.77790417]
curr_Stock_Price:  95.68163602126467
curr_Factors:  [95.68163602 -0.43616705 -0.92681786]
mat_Sqrt:  [[24.48452995  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00461771 -0.03886036  0.1335409 ]
Stock Position:  -0.004617707195368856
Bond Position:  [5.21973395]


portfolio before change:  [4.78138931]
curr_Stock_Price:  95.06820726885356
curr_Factors:  [95.06820727 -0.29044489 -0.94004409]
mat_Sqrt:  [[27.77414717  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [8.03345789e-04 6.32878515e-02 8.26007453e-01]
Stock Position:  0.0008033457887357924
Bond Position:  [4.70501667]


portfolio before change:  [4.78329794]
curr_Stock_Price:  96.71191359522815
curr_Factors:  [96.7119136  -0.27947686 -0.90072369]
mat_Sqrt:  [[29.71155565  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00240856 -0.17966842 -0.06363521]
Stock Position:  -0.0024085647214282355
Bond Position:  [5.01623485]


portfolio before change:  [4.78537778]
curr_Stock_Price:  96.10874435168893
curr_Factors:  [96.10874435 -0.20146411 -0.87695794]
mat_Sqrt:  [[32.68964134  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00269689  0.00581265 -0.27354455]
Stock Position:  -0.0026968943689035787
Bond Position:  [5.04457291]


portfolio before change:  [4.78421815]
curr_Stock_Price:  96.77255969138426
curr_Factors:  [96.77255969 -0.10791713 -0.86607737]
mat_Sqrt:  [[36.53859056  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00200513  0.03543196 -0.08554743]
Stock Position:  0.0020051303936420837
Bond Position:  [4.59017655]


portfolio before change:  [4.78713373]
curr_Stock_Price:  97.94044727335826
curr_Factors:  [97.94044727 -0.27405332 -0.89257126]
mat_Sqrt:  [[30.5002546   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00146717 0.01331469 0.00252459]
Stock Position:  0.0014671686265227486
Bond Position:  [4.64343858]


portfolio before change:  [4.78615434]
curr_Stock_Price:  96.87727183723045
curr_Factors:  [96.87727184 -0.29338321 -0.89156695]
mat_Sqrt:  [[29.62133219  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00046742 -0.00303525  0.28470285]
Stock Position:  -0.00046742225762679793
Bond Position:  [4.83143693]


portfolio before change:  [4.78672381]
curr_Stock_Price:  96.95108053531675
curr_Factors:  [96.95108054 -0.73603265 -0.87302101]
mat_Sqrt:  [[19.39766817  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00261216 -0.02551753  0.14941971]
Stock Position:  0.0026121604647115727
Bond Position:  [4.53347203]


portfolio before change:  [4.78739362]
curr_Stock_Price:  96.99054970128446
curr_Factors:  [96.9905497  -0.58384639 -0.84388046]
mat_Sqrt:  [[23.26352554  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00723645 -0.00120345  0.65958513]
Stock Position:  0.007236447110515527
Bond Position:  [4.08552664]


portfolio before change:  [4.78483346]
curr_Stock_Price:  96.56618551086797
curr_Factors:  [96.56618551 -0.56953294 -0.86210099]
mat_Sqrt:  [[23.071422    0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [2.63228212e-04 1.12198001e-02 9.12470175e-01]
Stock Position:  0.0002632282122763156
Bond Position:  [4.75941451]


portfolio before change:  [4.7853736]
curr_Stock_Price:  96.35792693165595
curr_Factors:  [96.35792693 -0.71603048 -0.86478978]
mat_Sqrt:  [[19.83106025  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-4.37404025e-03 -1.67770723e-04 -2.32717078e-01]
Stock Position:  -0.004374040245003274
Bond Position:  [5.20684705]


portfolio before change:  [4.78637508]
curr_Stock_Price:  96.27777665962864
curr_Factors:  [96.27777666 -0.67593695 -0.86272412]
mat_Sqrt:  [[20.66778987  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02283449  0.04671237  0.1807611 ]
Stock Position:  -0.0228344911948236
Bond Position:  [6.98482912]


portfolio before change:  [4.81171832]
curr_Stock_Price:  95.20614874660856
curr_Factors:  [95.20614875 -0.51419611 -0.86516877]
mat_Sqrt:  [[23.96704219  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00464762 -0.08004694  0.37207531]
Stock Position:  -0.004647616180722291
Bond Position:  [5.25419995]


portfolio before change:  [4.81717891]
curr_Stock_Price:  94.17254782441591
curr_Factors:  [94.17254782 -0.63740421 -0.857496  ]
mat_Sqrt:  [[21.12016991  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00207157  0.02099724 -0.07455954]
Stock Position:  0.0020715669694974462
Bond Position:  [4.62209417]


portfolio before change:  [4.81932331]
curr_Stock_Price:  94.92878502788285
curr_Factors:  [94.92878503 -0.8914983  -0.87622557]
mat_Sqrt:  [[16.20634945  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00214071 -0.01166145 -0.03398171]
Stock Position:  0.0021407094366249378
Bond Position:  [4.61610836]


portfolio before change:  [4.82082834]
curr_Stock_Price:  95.36227647547145
curr_Factors:  [95.36227648 -0.98701741 -0.86510266]
mat_Sqrt:  [[14.9627385   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.010163   -0.05552583 -0.24663901]
Stock Position:  -0.010163001966348355
Bond Position:  [5.78999534]


portfolio before change:  [4.83430583]
curr_Stock_Price:  94.10736211177323
curr_Factors:  [94.10736211 -0.78360135 -0.83051395]
mat_Sqrt:  [[18.73364266  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00901654 0.06085112 0.18655633]
Stock Position:  0.009016542270298446
Bond Position:  [3.98578282]


portfolio before change:  [4.83303873]
curr_Stock_Price:  93.91157157972859
curr_Factors:  [93.91157158 -0.66160362 -0.8180929 ]
mat_Sqrt:  [[21.38430182  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00490333 -0.03268695  0.23466606]
Stock Position:  0.004903333124353669
Bond Position:  [4.37255901]


portfolio before change:  [4.83068365]
curr_Stock_Price:  93.31979357669988
curr_Factors:  [93.31979358 -0.60316554 -0.80386   ]
mat_Sqrt:  [[22.85127     0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00506395 0.01722093 0.0813745 ]
Stock Position:  0.005063949075742936
Bond Position:  [4.35811696]


portfolio before change:  [4.83445152]
curr_Stock_Price:  93.95626725961554
curr_Factors:  [93.95626726 -0.63551444 -0.8004279 ]
mat_Sqrt:  [[22.35135825  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01325816 -0.07488674 -0.34458234]
Stock Position:  0.013258156075827556
Bond Position:  [3.58876466]


portfolio before change:  [4.84217538]
curr_Stock_Price:  94.5050042709568
curr_Factors:  [94.50500427 -0.73371505 -0.7880957 ]
mat_Sqrt:  [[20.63197457  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00203644 -0.02474161  0.0365867 ]
Stock Position:  -0.0020364415027810108
Bond Position:  [5.03462929]


portfolio before change:  [4.84191204]
curr_Stock_Price:  94.94337281573792
curr_Factors:  [94.94337282 -0.75555695 -0.82978623]
mat_Sqrt:  [[19.45175808  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00873636  0.00351023  0.04908348]
Stock Position:  -0.008736355889078954
Bond Position:  [5.67137113]


portfolio before change:  [4.82866485]
curr_Stock_Price:  96.5408527049758
curr_Factors:  [96.5408527  -0.70800294 -0.82954333]
mat_Sqrt:  [[20.74738046  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00440225 -0.02700124 -0.14314205]
Stock Position:  0.004402245396496731
Bond Position:  [4.40366833]


portfolio before change:  [4.82294591]
curr_Stock_Price:  95.1167092982657
curr_Factors:  [95.1167093  -0.88143377 -0.82801065]
mat_Sqrt:  [[17.2129195   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 2.36289299e-04  2.88668469e-03 -2.70865708e-01]
Stock Position:  0.000236289298947884
Bond Position:  [4.80047085]


portfolio before change:  [4.82358041]
curr_Stock_Price:  95.26228287370814
curr_Factors:  [95.26228287 -0.72553068 -0.80549322]
mat_Sqrt:  [[20.60657217  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00111446  0.01122802 -0.15083171]
Stock Position:  -0.001114461485500672
Bond Position:  [4.92974655]


portfolio before change:  [4.82444708]
curr_Stock_Price:  95.03758444840882
curr_Factors:  [95.03758445 -0.73633192 -0.78641565]
mat_Sqrt:  [[20.72881726  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00753645 -0.07833471 -0.13362184]
Stock Position:  0.0075364483136553745
Bond Position:  [4.10820124]


portfolio before change:  [4.83445457]
curr_Stock_Price:  96.29731966936309
curr_Factors:  [96.29731967 -1.06206396 -0.80073532]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [4.83445457]
Stock Price:  96.17968050802463
PL:  [4.83445457]
Settle:  Tensor("sub_96:0", shape=(), dtype=float64)
PL:  Tensor("sub_97:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  49
output_Z_Vals[:, i, :]:  [[ 1.19260232e+02 -2.92559343e+01 -2.92733494e+01]
 [ 6.64109438e-04 -8.45909114e-02 -3.05885638e-02]
 [-6.43380085e-02 -1.19826772e-02  9.61758854e-02]
 [-1.12599812e-01  1.30534376e-02  6.88427266e-03]
 [ 1.65109153e-01 -1.22287925e-02 -6.15646898e-02]
 [ 6.74090235e-02  2.91146881e-02 -6.28578413e-02]
 [ 7.55585344e-02  1.10939825e-02 -7.46661314e-02]
 [-9.91111522e-02 -2.69939950e-02 -1.07561925e-01]
 [-4.73121929e-02 -6.90580651e-02  6.98671530e-02]
 [-2.99742077e-02 -1.81747974e-02 -8.14629623e-02]
 [ 5.70517396e-02  9.35877961e-02 -8.11781408e-02]
 [-2.34957575e-02  4.49522903e-02 -9.76405129e-03]
 [-9.56329188e-02  1.04603726e-02 -5.42530045e-02]
 [-1.06077198e-01 -1.00947547e-01  6.26812869e-02]
 [ 2.44318368e-01  3.21924561e-01  5.61915423e-02]
 [-8.06340340e-02 -9.80962066e-02 -1.11926055e-01]
 [-7.37667779e-02 -4.97303981e-02 -6.01509925e-02]
 [-8.07280098e-02  8.57802338e-02  1.04373069e-01]
 [ 7.68833916e-02  6.34599287e-02  8.28358318e-02]
 [ 1.44171715e-01 -4.36672140e-02  2.06021735e-02]
 [-4.11561124e-02  7.71940989e-03  2.89556777e-02]
 [ 4.93292408e-02 -3.95128202e-02  4.79141137e-02]
 [-8.63376552e-02  1.30850615e-01  3.33919531e-01]
 [ 2.99933204e-02 -1.09890288e-02 -5.66034209e-02]
 [ 9.42631967e-02  2.64116605e-02  1.00912635e-01]
 [ 4.45384233e-02 -5.56173779e-02  7.40341277e-02]
 [-1.59334234e-01  6.46310825e-02  5.10351992e-02]
 [-5.07806065e-02  7.36225950e-02  2.93687317e-02]
 [-1.90511269e-02 -5.32275424e-02 -2.45712585e-01]
 [ 1.87020553e-02  4.07070479e-04 -8.32803813e-02]
 [ 1.42032259e-02  1.61616815e-01  2.92408478e-02]
 [ 1.50734986e-02 -6.66692664e-02 -8.85360813e-02]
 [ 1.75885721e-01 -1.99874030e-01 -1.43876816e-01]
 [-3.74624299e-02 -7.64526346e-02  9.48979005e-03]
 [-1.22718422e-01  4.08186164e-02  3.62117787e-02]
 [ 8.47165236e-02 -1.65012150e-01 -1.38726811e-01]
 [-1.89748051e-01 -3.06883926e-01  5.53091846e-02]
 [-3.52680782e-02 -9.85830787e-03 -1.27055657e-02]
 [-4.83008129e-02  1.03027925e-01 -1.81659958e-02]
 [-1.77664282e-01  1.07229268e-01  1.01751318e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.26023247 -29.25593426 -29.27334937]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  8.31486419  -9.25153874 -83.50871763]
init_Out:  [2.49911038]
Stock Position:  8.31486419409362
Bond position:  [-828.98730903]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [2.97146656]
curr_Stock_Price:  100.06927185529169
curr_Factors:  [100.06927186  -0.79665892  -1.00361489]
mat_Sqrt:  [[16.53681076  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00046949 -0.02674999 -0.08726066]
Stock Position:  -0.00046949094687397005
Bond Position:  [3.01844818]


portfolio before change:  [2.97251711]
curr_Stock_Price:  98.63533782815374
curr_Factors:  [98.63533783 -0.89062034 -1.01446204]
mat_Sqrt:  [[14.67796234  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00306688 -0.00378926  0.27436303]
Stock Position:  -0.0030668820653591976
Bond Position:  [3.27502006]


portfolio before change:  [2.97341168]
curr_Stock_Price:  98.47714320339666
curr_Factors:  [98.4771432  -0.72115481 -1.01155115]
mat_Sqrt:  [[17.41128412  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00636699  0.00412786  0.01963891]
Stock Position:  -0.00636699319821884
Bond Position:  [3.60041498]


portfolio before change:  [2.96318133]
curr_Stock_Price:  100.15461038034606
curr_Factors:  [100.15461038  -0.88088611  -1.06143733]
mat_Sqrt:  [[14.35921154  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01060132 -0.00386708 -0.17562692]
Stock Position:  0.01060131794520405
Bond Position:  [1.90141046]


portfolio before change:  [2.95215618]
curr_Stock_Price:  99.09221014025856
curr_Factors:  [99.09221014 -1.10350986 -1.06714766]
mat_Sqrt:  [[11.30667563  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00489357  0.00920687 -0.17931593]
Stock Position:  0.00489356555357535
Bond Position:  [2.46724196]


portfolio before change:  [2.952787]
curr_Stock_Price:  99.15809092605159
curr_Factors:  [99.15809093 -0.97568084 -1.05647618]
mat_Sqrt:  [[12.994919    0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00466366  0.00350823 -0.21300169]
Stock Position:  0.0046636550464664505
Bond Position:  [2.49034787]


portfolio before change:  [2.95156497]
curr_Stock_Price:  98.82930538006966
curr_Factors:  [98.82930538 -0.96500565 -1.07660185]
mat_Sqrt:  [[12.8300063   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00949057 -0.00853625 -0.30684423]
Stock Position:  -0.009490573688295922
Bond Position:  [3.88951177]


portfolio before change:  [2.94752821]
curr_Stock_Price:  99.30588114311995
curr_Factors:  [99.30588114 -0.94754812 -1.07131171]
mat_Sqrt:  [[13.18849639  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00264122 -0.02183808  0.19931154]
Stock Position:  -0.002641217814409005
Bond Position:  [3.20981667]


portfolio before change:  [2.94615061]
curr_Stock_Price:  99.97937849144324
curr_Factors:  [99.97937849 -1.04769294 -1.0621397 ]
mat_Sqrt:  [[12.12332524  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00388277 -0.00574738 -0.23239116]
Stock Position:  -0.003882766122237886
Bond Position:  [3.33434715]


portfolio before change:  [2.94395197]
curr_Stock_Price:  100.65298671019008
curr_Factors:  [100.65298671  -0.99660431  -1.0696821 ]
mat_Sqrt:  [[12.74822968  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.003365    0.02959506 -0.23157864]
Stock Position:  0.0033649964407725
Bond Position:  [2.60525502]


portfolio before change:  [2.94395464]
curr_Stock_Price:  100.55699890609682
curr_Factors:  [100.55699891  -0.96303545  -1.07978485]
mat_Sqrt:  [[13.03847261  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00186588  0.01421516 -0.02785412]
Stock Position:  -0.0018658759868676149
Bond Position:  [3.13158153]


portfolio before change:  [2.94498799]
curr_Stock_Price:  100.2129904749367
curr_Factors:  [100.21299047  -0.95812332  -1.07949572]
mat_Sqrt:  [[13.06162828  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00814884  0.00330786 -0.15476872]
Stock Position:  -0.008148844767057703
Bond Position:  [3.7616081]


portfolio before change:  [2.94741463]
curr_Stock_Price:  99.97290694650663
curr_Factors:  [99.97290695 -1.0340203  -1.06695655]
mat_Sqrt:  [[12.23037212  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00784023 -0.03192242  0.17881226]
Stock Position:  -0.00784022654835815
Bond Position:  [3.73122487]


portfolio before change:  [2.9509899]
curr_Stock_Price:  99.57638308425781
curr_Factors:  [99.57638308 -0.93841822 -1.05917369]
mat_Sqrt:  [[13.50868903  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01955041 0.10180148 0.16029883]
Stock Position:  0.019550414875006493
Bond Position:  [1.0042303]


portfolio before change:  [2.96500537]
curr_Stock_Price:  100.286850864866
curr_Factors:  [100.28685086  -0.97782483  -1.07699562]
mat_Sqrt:  [[12.8483338   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00825116 -0.03102074 -0.31929388]
Stock Position:  -0.008251161514957582
Bond Position:  [3.79248838]


portfolio before change:  [2.96004099]
curr_Stock_Price:  100.94596752346845
curr_Factors:  [100.94596752  -0.98627564  -1.04832005]
mat_Sqrt:  [[13.19700235  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00661734 -0.01572613 -0.17159404]
Stock Position:  -0.006617342243805199
Bond Position:  [3.628035]


portfolio before change:  [2.96087932]
curr_Stock_Price:  100.88781662789782
curr_Factors:  [100.88781663  -1.22054832  -1.01668639]
mat_Sqrt:  [[10.77010738  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00531175  0.02712609  0.29774731]
Stock Position:  -0.005311749276342411
Bond Position:  [3.49677011]


portfolio before change:  [2.96262649]
curr_Stock_Price:  100.6411859880784
curr_Factors:  [100.64118599  -0.93164334  -1.00082216]
mat_Sqrt:  [[14.5719154   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00654895 0.02006779 0.23630757]
Stock Position:  0.006548947798831229
Bond Position:  [2.30353261]


portfolio before change:  [2.96010554]
curr_Stock_Price:  100.2122769215681
curr_Factors:  [100.21227692  -0.82480709  -1.0270156 ]
mat_Sqrt:  [[15.72840031  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00936202 -0.01380879  0.05877227]
Stock Position:  0.009362022259400384
Bond Position:  [2.02191598]


portfolio before change:  [2.97659569]
curr_Stock_Price:  101.9466664055515
curr_Factors:  [101.94666641  -0.80275697  -1.03705561]
mat_Sqrt:  [[16.19394192  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00216416  0.00244109  0.08260249]
Stock Position:  -0.00216415776255961
Bond Position:  [3.19722436]


portfolio before change:  [2.97731906]
curr_Stock_Price:  101.79709814600211
curr_Factors:  [101.79709815  -0.76052044  -1.03960137]
mat_Sqrt:  [[16.8248975   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00345259 -0.01249505  0.13668563]
Stock Position:  0.003452588740200295
Bond Position:  [2.62585554]


portfolio before change:  [2.97482572]
curr_Stock_Price:  100.9798576886215
curr_Factors:  [100.97985769  -0.49067106  -1.01667319]
mat_Sqrt:  [[22.36677981  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-6.61609232e-04  4.13785977e-02  9.52579476e-01]
Stock Position:  -0.0006616092320456
Bond Position:  [3.04163492]


portfolio before change:  [2.9747901]
curr_Stock_Price:  101.60839277230141
curr_Factors:  [101.60839277  -0.70388515  -0.9976762 ]
mat_Sqrt:  [[18.53321966  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00097962 -0.00347504 -0.1614738 ]
Stock Position:  0.0009796171593519454
Bond Position:  [2.87525277]


portfolio before change:  [2.97525265]
curr_Stock_Price:  101.71365880435646
curr_Factors:  [101.7136588   -0.58480012  -0.98773228]
mat_Sqrt:  [[21.10751627  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00547406 0.0083521  0.28787566]
Stock Position:  0.005474061781161133
Bond Position:  [2.4184658]


portfolio before change:  [2.97269282]
curr_Stock_Price:  101.1908011607705
curr_Factors:  [101.19080116  -0.41039044  -0.98088356]
mat_Sqrt:  [[25.17203993  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00231267 -0.01758776  0.21119876]
Stock Position:  0.0023126668325727253
Bond Position:  [2.73867221]


portfolio before change:  [2.97411044]
curr_Stock_Price:  101.6557473069412
curr_Factors:  [101.65574731  -0.30818052  -0.99982203]
mat_Sqrt:  [[27.48360179  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00535767  0.02043814  0.14558922]
Stock Position:  -0.005357665666619184
Bond Position:  [3.51874795]


portfolio before change:  [2.97458648]
curr_Stock_Price:  101.64899681237334
curr_Factors:  [101.64899681  -0.47007432  -1.01039258]
mat_Sqrt:  [[23.12834165  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00185421  0.02328151  0.08378082]
Stock Position:  -0.001854210416854287
Bond Position:  [3.16306511]


portfolio before change:  [2.97584277]
curr_Stock_Price:  101.1847131907489
curr_Factors:  [101.18471319  -0.92295802  -0.98892043]
mat_Sqrt:  [[14.95535221  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00471947 -0.01683203 -0.70094961]
Stock Position:  -0.0047194694292079665
Bond Position:  [3.45338093]


portfolio before change:  [2.97290668]
curr_Stock_Price:  101.89830816817344
curr_Factors:  [101.89830817  -0.9328783   -0.96762901]
mat_Sqrt:  [[15.23305935  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 1.12454704e-04  1.28726988e-04 -2.37575747e-01]
Stock Position:  0.00011245470371379401
Bond Position:  [2.96144773]


portfolio before change:  [2.97326065]
curr_Stock_Price:  101.7539577670325
curr_Factors:  [101.75395777  -1.00864579  -0.96621768]
mat_Sqrt:  [[14.12144068  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00172397 0.05110772 0.083416  ]
Stock Position:  0.0017239683822681698
Bond Position:  [2.79784004]


portfolio before change:  [2.97321758]
curr_Stock_Price:  101.52609755515698
curr_Factors:  [101.52609756  -1.24243365  -0.97103809]
mat_Sqrt:  [[11.09887932  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00042529 -0.02108267 -0.2525688 ]
Stock Position:  -0.0004252903595782688
Bond Position:  [3.01639565]


portfolio before change:  [2.9731642]
curr_Stock_Price:  102.53821734858552
curr_Factors:  [102.53821735  -1.25508631  -0.96586743]
mat_Sqrt:  [[11.12596806  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01270508 -0.06320572 -0.41044051]
Stock Position:  0.012705075450874476
Bond Position:  [1.67040842]


portfolio before change:  [2.98658861]
curr_Stock_Price:  103.57839911185772
curr_Factors:  [103.57839911  -1.37545357  -0.98784613]
mat_Sqrt:  [[ 9.74767801  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.003847   -0.02417645  0.02707173]
Stock Position:  -0.0038470016306782163
Bond Position:  [3.38505488]


portfolio before change:  [2.98833201]
curr_Stock_Price:  103.2352121788041
curr_Factors:  [103.23521218  -1.3394862   -0.96056798]
mat_Sqrt:  [[10.34968227  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01104119  0.01290798  0.10330213]
Stock Position:  -0.011041188324410865
Bond Position:  [4.12817143]


portfolio before change:  [2.98898949]
curr_Stock_Price:  103.22240283144549
curr_Factors:  [103.22240283  -1.34809967  -0.96222871]
mat_Sqrt:  [[10.24262084  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00509034 -0.05218142 -0.39574898]
Stock Position:  0.005090341359979654
Bond Position:  [2.46355222]


portfolio before change:  [2.98643532]
curr_Stock_Price:  102.66013505134397
curr_Factors:  [102.66013505  -1.4322045   -0.94249815]
mat_Sqrt:  [[ 9.55171984  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01951291 -0.09704522  0.15778171]
Stock Position:  -0.01951290686261088
Bond Position:  [4.98963297]


portfolio before change:  [2.99108853]
curr_Stock_Price:  102.45363248969028
curr_Factors:  [102.45363249  -1.33493027  -0.93844244]
mat_Sqrt:  [[10.5490692   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00361322 -0.00311747 -0.03624544]
Stock Position:  -0.003613222231198888
Bond Position:  [3.36127627]


portfolio before change:  [2.99339833]
curr_Stock_Price:  101.93066030526164
curr_Factors:  [101.93066031  -1.6477135   -0.96728437]
mat_Sqrt:  [[ 7.45805689  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00661684  0.03258029 -0.05182253]
Stock Position:  -0.006616839002465449
Bond Position:  [3.6678571]


portfolio before change:  [2.99435279]
curr_Stock_Price:  101.85570651327518
curr_Factors:  [101.85570651  -1.73824088  -0.97715811]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [2.99435279]
Stock Price:  101.73753590306806
PL:  [1.25681689]
Settle:  Tensor("sub_98:0", shape=(), dtype=float64)
PL:  Tensor("sub_99:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  50
output_Z_Vals[:, i, :]:  [[ 1.19260232e+02 -2.92559343e+01 -2.92733494e+01]
 [ 3.73569785e-04 -8.32214072e-02 -3.01864621e-02]
 [-5.65962197e-02 -8.22095669e-02 -8.16839316e-02]
 [-5.41261099e-02  1.17032445e-01  1.19694679e-02]
 [ 5.65736477e-02  2.42957253e-02 -6.96928874e-02]
 [ 6.39194275e-02  2.91649198e-02 -3.18622833e-03]
 [ 3.62573612e-02  5.03781403e-02 -3.59916268e-02]
 [-9.62208616e-02 -1.65044505e-02 -1.03736391e-01]
 [ 1.22767510e-01 -3.95163960e-02 -1.24244560e-01]
 [-3.29329507e-02 -7.25600481e-02 -1.12698834e-01]
 [ 6.64715144e-02  1.23788983e-01 -9.23377703e-02]
 [-1.16834502e-01 -1.00200744e-01  1.78663013e-02]
 [-1.06295491e-01  2.90852714e-02 -1.80494736e-02]
 [-9.62623594e-02 -1.14884369e-01  6.32126881e-02]
 [ 3.69672247e-01  5.11512340e-01  1.08868542e-01]
 [-4.56108078e-02 -2.23008447e-01 -6.68830135e-02]
 [-6.89782670e-02 -6.03882386e-02 -6.78718794e-02]
 [-7.59982527e-02  1.94261283e-01  1.32587146e-01]
 [ 1.41639634e-01  6.62793568e-02  1.63963180e-01]
 [ 1.49501448e-01 -4.71737047e-02  2.47673208e-02]
 [-2.52351819e-02 -2.39729593e-02 -1.21415946e-02]
 [ 8.15273370e-02 -6.12286151e-02  7.92384148e-02]
 [-2.49509189e-02 -7.73937186e-02  1.68327530e-01]
 [-5.31480246e-02 -9.33366354e-04 -8.65096430e-02]
 [-5.67698616e-02  6.65297133e-02  6.75015028e-02]
 [ 3.66257777e-02 -6.41760092e-02  7.65328371e-02]
 [-1.78385677e-01  7.39400206e-02  6.82988913e-02]
 [ 3.75732889e-02 -5.94600104e-02 -2.20031211e-02]
 [-3.28480056e-02 -4.65726773e-02 -2.51952498e-01]
 [ 4.99902728e-02  1.41152951e-02  4.70987083e-03]
 [ 4.08147275e-02  9.43559549e-02  3.09110363e-02]
 [ 1.99000969e-02 -6.68230344e-02 -8.81842040e-02]
 [ 3.24246130e-01 -4.60395556e-01 -4.96608647e-01]
 [-4.84312861e-02 -8.46769426e-02 -7.86812677e-03]
 [ 3.29383274e-02 -3.22808787e-02  2.13567222e-02]
 [ 8.47165236e-02 -1.65012150e-01 -1.38726811e-01]
 [-1.88713577e-01 -3.10359027e-01  5.78137548e-02]
 [-3.59965468e-02 -1.10874951e-02 -9.28614247e-03]
 [-4.61664779e-02  9.85519785e-02 -1.95051944e-02]
 [-3.47426362e-02  3.93894348e-02  1.39351289e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.26023247 -29.25593426 -29.27334937]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  8.31486419  -9.25153874 -83.50871763]
init_Out:  [2.49911038]
Stock Position:  8.31486419409362
Bond position:  [-828.98730903]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [2.892489]
curr_Stock_Price:  100.0597734975052
curr_Factors:  [100.0597735   -1.01918625  -0.99122353]
mat_Sqrt:  [[13.40138376  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00059225 -0.02631692 -0.08611357]
Stock Position:  -0.0005922510402647712
Bond Position:  [2.95174951]


portfolio before change:  [2.89269047]
curr_Stock_Price:  100.34264502663751
curr_Factors:  [100.34264503  -1.06166229  -0.98700355]
mat_Sqrt:  [[12.93484647  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00582864 -0.02599695 -0.23302152]
Stock Position:  -0.005828636971306305
Bond Position:  [3.47755132]


portfolio before change:  [2.8996419]
curr_Stock_Price:  99.22459474100238
curr_Factors:  [99.22459474 -0.84011653 -0.95753979]
mat_Sqrt:  [[16.44020071  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00295988  0.03700891  0.03414556]
Stock Position:  -0.0029598840431543983
Bond Position:  [3.19333519]


portfolio before change:  [2.90036141]
curr_Stock_Price:  99.11637404419874
curr_Factors:  [99.11637404 -0.74880495 -0.93639084]
mat_Sqrt:  [[18.37698126  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00233852  0.00768298 -0.19881441]
Stock Position:  0.0023385211603375376
Bond Position:  [2.66857567]


portfolio before change:  [2.89962911]
curr_Stock_Price:  98.66057645488544
curr_Factors:  [98.66057645 -0.76235979 -0.93676897]
mat_Sqrt:  [[18.03937146  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00354902  0.00922276 -0.00908942]
Stock Position:  0.0035490192385669865
Bond Position:  [2.54948082]


portfolio before change:  [2.89686867]
curr_Stock_Price:  97.79297176186171
curr_Factors:  [97.79297176 -0.62938067 -0.91908236]
mat_Sqrt:  [[20.78828663  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00145329  0.01593097 -0.10267409]
Stock Position:  0.0014532875966335296
Bond Position:  [2.75474735]


portfolio before change:  [2.89884047]
curr_Stock_Price:  98.91280032028013
curr_Factors:  [98.91280032 -0.56234861 -0.9101568 ]
mat_Sqrt:  [[22.68566562  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00519368 -0.00521917 -0.29593105]
Stock Position:  -0.005193680837402403
Bond Position:  [3.41256198]


portfolio before change:  [2.90650024]
curr_Stock_Price:  97.52011222942187
curr_Factors:  [97.52011223 -0.65282465 -0.89681015]
mat_Sqrt:  [[20.70600665  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00465497 -0.01249618 -0.35443515]
Stock Position:  0.004654972249443124
Bond Position:  [2.45254682]


portfolio before change:  [2.91301712]
curr_Stock_Price:  98.85423303247916
curr_Factors:  [98.85423303 -0.73797422 -0.91390973]
mat_Sqrt:  [[18.94921343  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00305084 -0.0229455  -0.3214984 ]
Stock Position:  -0.003050838839064769
Bond Position:  [3.21460546]


portfolio before change:  [2.91533237]
curr_Stock_Price:  98.22706252720626
curr_Factors:  [98.22706253 -0.93590644 -0.90065605]
mat_Sqrt:  [[15.65388725  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00324644  0.03914551 -0.26341396]
Stock Position:  0.003246437320757167
Bond Position:  [2.59644437]


portfolio before change:  [2.91716028]
curr_Stock_Price:  98.69013593891559
curr_Factors:  [98.69013594 -1.0578873  -0.91666259]
mat_Sqrt:  [[13.70053819  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00845038 -0.03168626  0.05096758]
Stock Position:  -0.008450378316560364
Bond Position:  [3.75112927]


portfolio before change:  [2.92657612]
curr_Stock_Price:  97.63137666934233
curr_Factors:  [97.63137667 -1.1725723  -0.9195835 ]
mat_Sqrt:  [[12.04974053  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00906483  0.00919757 -0.05149012]
Stock Position:  -0.00906482969635926
Bond Position:  [3.81158792]


portfolio before change:  [2.92614293]
curr_Stock_Price:  97.73172767137498
curr_Factors:  [97.73172767 -1.28314369 -0.91295559]
mat_Sqrt:  [[10.87130739  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00794067 -0.03632963  0.1803282 ]
Stock Position:  -0.007940666386899572
Bond Position:  [3.70219798]


portfolio before change:  [2.92953662]
curr_Stock_Price:  97.36263040974421
curr_Factors:  [97.36263041 -1.44148841 -0.90621093]
mat_Sqrt:  [[ 9.30677955  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.04352764 0.1617544  0.31057165]
Stock Position:  0.04352763865639711
Bond Position:  [-1.30842878]


portfolio before change:  [2.98128117]
curr_Stock_Price:  98.55516267020191
curr_Factors:  [98.55516267 -1.46446286 -0.94355866]
mat_Sqrt:  [[ 8.86929131  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00733106 -0.07052146 -0.19079862]
Stock Position:  -0.007331059133991306
Bond Position:  [3.70379489]


portfolio before change:  [2.97678881]
curr_Stock_Price:  99.23110286137256
curr_Factors:  [99.23110286 -1.42842354 -0.95802103]
mat_Sqrt:  [[ 9.12489987  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00924852 -0.01909644 -0.19361958]
Stock Position:  -0.009248515074927688
Bond Position:  [3.89452916]


portfolio before change:  [2.96957532]
curr_Stock_Price:  100.06370502822926
curr_Factors:  [100.06370503  -1.43011557  -0.97352256]
mat_Sqrt:  [[ 9.04460913  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00485573  0.06143081  0.37823422]
Stock Position:  -0.004855733341125968
Bond Position:  [3.45545799]


portfolio before change:  [2.97158758]
curr_Stock_Price:  99.73825652821522
curr_Factors:  [99.73825653 -1.24568698 -0.98421369]
mat_Sqrt:  [[10.72576348  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01648552 0.02095937 0.46774131]
Stock Position:  0.016485521389512054
Bond Position:  [1.32735041]


portfolio before change:  [2.98090146]
curr_Stock_Price:  100.29316527529606
curr_Factors:  [100.29316528  -1.28286628  -0.96493051]
mat_Sqrt:  [[10.59413727  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01447395 -0.01491764  0.07065427]
Stock Position:  0.014473952164781902
Bond Position:  [1.52926299]


portfolio before change:  [2.97518246]
curr_Stock_Price:  99.88483338058522
curr_Factors:  [99.88483338 -1.24029632 -0.93488866]
mat_Sqrt:  [[11.34563259  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00249722 -0.00758092 -0.03463659]
Stock Position:  -0.002497221149991665
Bond Position:  [3.22461698]


portfolio before change:  [2.9731298]
curr_Stock_Price:  100.86822983937871
curr_Factors:  [100.86822984  -1.35280321  -0.96421344]
mat_Sqrt:  [[ 9.94229986  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00966787 -0.01936219  0.22604514]
Stock Position:  0.009667873226219006
Bond Position:  [1.99794854]


portfolio before change:  [2.96588291]
curr_Stock_Price:  100.09281091807958
curr_Factors:  [100.09281092  -1.29969599  -0.96526076]
mat_Sqrt:  [[10.39308957  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00071302 -0.02447404  0.48019159]
Stock Position:  0.0007130215757785729
Bond Position:  [2.89451458]


portfolio before change:  [2.96611516]
curr_Stock_Price:  99.91106486198348
curr_Factors:  [99.91106486 -1.34443322 -0.97189573]
mat_Sqrt:  [[ 9.85472943  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0071875  -0.00029516 -0.24678793]
Stock Position:  -0.00718749626096369
Bond Position:  [3.68422556]


portfolio before change:  [2.95561461]
curr_Stock_Price:  101.43608884284221
curr_Factors:  [101.43608884  -1.33138615  -1.02921033]
mat_Sqrt:  [[ 9.57190693  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00431193  0.02103854  0.192563  ]
Stock Position:  -0.0043119292282788714
Bond Position:  [3.39299985]


portfolio before change:  [2.95547683]
curr_Stock_Price:  101.56640873445521
curr_Factors:  [101.56640873  -1.65922942  -1.00985809]
mat_Sqrt:  [[ 7.04012088  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00718609 -0.02029424  0.21832688]
Stock Position:  0.007186092560479456
Bond Position:  [2.22561122]


portfolio before change:  [2.95945226]
curr_Stock_Price:  102.08090449742296
curr_Factors:  [102.0809045   -1.76363883  -1.04505606]
mat_Sqrt:  [[ 6.1538062   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02641213  0.02338189  0.19483773]
Stock Position:  -0.026412125451040186
Bond Position:  [5.65562592]


portfolio before change:  [2.95519355]
curr_Stock_Price:  102.26891318235134
curr_Factors:  [102.26891318  -1.64169388  -1.04463727]
mat_Sqrt:  [[ 6.96762625  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00452761 -0.01880291 -0.06276878]
Stock Position:  0.004527606486593106
Bond Position:  [2.49216016]


portfolio before change:  [2.95575224]
curr_Stock_Price:  102.3234993458815
curr_Factors:  [102.32349935  -1.69264743  -1.02990644]
mat_Sqrt:  [[ 6.72334291  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01271393 -0.01472757 -0.71875035]
Stock Position:  -0.01271392762863101
Bond Position:  [4.2566858]


portfolio before change:  [2.95389639]
curr_Stock_Price:  102.51132237949416
curr_Factors:  [102.51132238  -1.78215428  -1.01573287]
mat_Sqrt:  [[ 6.24690478  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00821465 0.00446365 0.01343595]
Stock Position:  0.008214648422082938
Bond Position:  [2.11180191]


portfolio before change:  [2.95700817]
curr_Stock_Price:  102.85799443095964
curr_Factors:  [102.85799443  -1.8067728   -1.02619232]
mat_Sqrt:  [[ 6.0519723   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00818918 0.02983797 0.08818058]
Stock Position:  0.008189177718437734
Bond Position:  [2.11468577]


portfolio before change:  [2.95146686]
curr_Stock_Price:  102.14905118547856
curr_Factors:  [102.14905119  -1.63872378  -0.99281549]
mat_Sqrt:  [[ 7.351422    0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 2.36972288e-05 -2.11312989e-02 -2.51564988e-01]
Stock Position:  2.3697228783069973e-05
Bond Position:  [2.94904621]


portfolio before change:  [2.95183089]
curr_Stock_Price:  101.95384201617361
curr_Factors:  [101.95384202  -1.82995134  -1.01617269]
mat_Sqrt:  [[ 5.92035343  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0356379  -0.14558986 -1.41668624]
Stock Position:  0.03563789809053051
Bond Position:  [-0.68158975]


portfolio before change:  [2.95111206]
curr_Stock_Price:  101.93606252528011
curr_Factors:  [101.93606253  -1.74553873  -1.02864199]
mat_Sqrt:  [[ 6.36086931  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00821015 -0.0267772  -0.02244558]
Stock Position:  -0.00821015296635777
Bond Position:  [3.78802272]


portfolio before change:  [2.94643941]
curr_Stock_Price:  102.56286915429577
curr_Factors:  [102.56286915  -1.88548133  -1.01635653]
mat_Sqrt:  [[ 5.6329772   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00647336 -0.01020811  0.06092478]
Stock Position:  0.006473355037443526
Bond Position:  [2.28251355]


portfolio before change:  [2.94738326]
curr_Stock_Price:  102.66459668694759
curr_Factors:  [102.66459669  -1.67088401  -1.02053263]
mat_Sqrt:  [[ 6.95910375  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00749212 -0.05218142 -0.39574898]
Stock Position:  0.007492119441308518
Bond Position:  [2.17820784]


portfolio before change:  [2.94546138]
curr_Stock_Price:  102.3717322249794
curr_Factors:  [102.37173222  -1.55773962  -1.0180549 ]
mat_Sqrt:  [[ 7.78980719  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02373946 -0.09814414  0.16492655]
Stock Position:  -0.02373946173643428
Bond Position:  [5.3757112]


portfolio before change:  [2.93051484]
curr_Stock_Price:  103.0296473598726
curr_Factors:  [103.02964736  -1.76888762  -1.03448876]
mat_Sqrt:  [[ 6.24412116  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00611429 -0.00350617 -0.02649078]
Stock Position:  -0.006114287287051757
Bond Position:  [3.5604677]


portfolio before change:  [2.93371752]
curr_Stock_Price:  102.57863856000803
curr_Factors:  [102.57863856  -1.79975497  -1.07344279]
mat_Sqrt:  [[ 5.79752995  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00821097  0.03116487 -0.05564289]
Stock Position:  -0.008210972311138435
Bond Position:  [3.77598788]


portfolio before change:  [2.93438599]
curr_Stock_Price:  102.55471383087733
curr_Factors:  [102.55471383  -1.80066023  -1.05997225]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [2.93438599]
Stock Price:  102.85618676042245
PL:  [0.07819923]
Settle:  Tensor("sub_100:0", shape=(), dtype=float64)
PL:  Tensor("sub_101:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  51
output_Z_Vals[:, i, :]:  [[ 1.19260232e+02 -2.92559343e+01 -2.92733494e+01]
 [ 3.13991608e-02  3.12623605e-02 -5.08631831e-02]
 [-3.10000994e-02  3.48280174e-02  7.98795367e-02]
 [ 8.49766206e-02  1.70398086e-01  3.79576854e-02]
 [ 2.16137038e-01 -2.90372070e-02 -5.64000524e-02]
 [ 7.04687181e-02  2.84808215e-02 -1.44137132e-01]
 [ 6.09724152e-02  2.37981888e-02 -5.22614044e-02]
 [-1.09341277e-01 -6.41215265e-02 -1.21102326e-01]
 [-1.91698152e-01 -8.19528522e-02  1.69806660e-01]
 [-4.38376581e-02 -1.10568183e-01 -1.30653241e-01]
 [ 5.47096175e-02  1.76486455e-01 -8.23352745e-02]
 [-8.05750351e-02  8.03012105e-02  1.82509507e-02]
 [-1.13655745e-01  4.87253160e-02 -4.16854732e-02]
 [-9.62623594e-02 -1.14884369e-01  6.32126881e-02]
 [ 3.17108003e-01  3.91105444e-01  4.02877671e-02]
 [-3.86498156e-02 -3.72614442e-01 -3.61572214e-02]
 [-6.69516466e-02 -5.23230349e-02 -4.35481188e-02]
 [-7.46852392e-02  2.06856221e-01  1.35197126e-01]
 [ 7.77437228e-02  7.37806039e-02  8.92414243e-02]
 [-4.58653916e-02 -2.08524126e-02  1.23266865e-01]
 [ 2.89064448e-02 -6.81241886e-02  3.64221574e-02]
 [ 1.20539939e-01  3.01906616e-02  2.52462049e-01]
 [-4.96806340e-02  1.79677901e-03  2.76119953e-01]
 [-6.21802617e-02 -1.96529683e-02 -8.41921389e-02]
 [-5.82318162e-01  1.71631722e-01  4.37129479e-02]
 [-1.14776179e-01 -2.34043960e-01  1.25037942e-01]
 [ 1.54815038e-01  5.89162083e-02 -1.06650728e-01]
 [ 4.02044327e-02 -5.67103455e-03  1.01103331e-02]
 [-1.37963323e-01 -1.92907340e-01 -6.71524124e-02]
 [ 1.88167373e-01  2.36395019e-01  1.32254524e-01]
 [ 8.27655896e-02 -6.47372496e-02  6.75024838e-02]
 [ 1.04121199e-01  5.08494134e-02  3.22268355e-02]
 [ 2.17727116e-01 -9.74608626e-02  4.92379314e-02]
 [-3.87274146e-02 -7.44459195e-02  2.35160646e-02]
 [-2.25825196e-01  1.74672824e-01  1.55171621e-02]
 [ 2.75078352e-01  1.17428508e-01  5.66691924e-02]
 [ 1.88760174e-02 -3.23518112e-02 -1.01818602e-01]
 [ 3.73586876e-03  7.76119480e-02  5.84359834e-03]
 [ 4.45802424e-01 -5.42642568e-01 -1.35488411e-01]
 [-3.09987314e-01  1.95593700e-01  1.47147615e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.26023247 -29.25593426 -29.27334937]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  8.31486419  -9.25153874 -83.50871763]
init_Out:  [2.49911038]
Stock Position:  8.31486419409362
Bond position:  [-828.98730903]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [0.37880581]
curr_Stock_Price:  99.75746150080855
curr_Factors:  [99.7574615  -1.13112059 -0.98360548]
mat_Sqrt:  [[12.03736767  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00181302  0.00988603 -0.1450985 ]
Stock Position:  0.001813016624943427
Bond Position:  [0.19794387]


portfolio before change:  [0.3788778]
curr_Stock_Price:  99.78352410569646
curr_Factors:  [99.78352411 -1.04671664 -0.97373321]
mat_Sqrt:  [[13.23087654  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00104267  0.01101359  0.22787408]
Stock Position:  -0.0010426748146296302
Bond Position:  [0.48291957]


portfolio before change:  [0.37879239]
curr_Stock_Price:  99.92333671200807
curr_Factors:  [99.92333671 -1.01954516 -0.94250077]
mat_Sqrt:  [[14.04627631  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.0069146  0.05388461 0.10828271]
Stock Position:  0.006914598447325357
Bond Position:  [-0.31213736]


portfolio before change:  [0.38219583]
curr_Stock_Price:  100.42119037819103
curr_Factors:  [100.42119038  -1.16705985  -0.93151225]
mat_Sqrt:  [[12.31479214  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01655527 -0.00918237 -0.16089365]
Stock Position:  0.01655526827437137
Bond Position:  [-1.28030391]


portfolio before change:  [0.37244841]
curr_Stock_Price:  99.84207743084019
curr_Factors:  [99.84207743 -1.3399905  -0.95050034]
mat_Sqrt:  [[10.10569244  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00413452  0.00900643 -0.41118312]
Stock Position:  0.004134523301404419
Bond Position:  [-0.04035098]


portfolio before change:  [0.37290005]
curr_Stock_Price:  99.95253391584077
curr_Factors:  [99.95253392 -1.65675827 -0.94019384]
mat_Sqrt:  [[ 7.44649385  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00683799  0.00752565 -0.14908724]
Stock Position:  0.006837992259351167
Bond Position:  [-0.3105746]


portfolio before change:  [0.37254267]
curr_Stock_Price:  99.90594711357501
curr_Factors:  [99.90594711 -1.67160764 -0.97584794]
mat_Sqrt:  [[ 7.07645889  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01917863 -0.02027701 -0.34547123]
Stock Position:  -0.019178631451284112
Bond Position:  [2.28860201]


portfolio before change:  [0.36472794]
curr_Stock_Price:  100.32833524151648
curr_Factors:  [100.32833524  -1.60022222  -0.9778837 ]
mat_Sqrt:  [[ 7.61669266  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02089523 -0.02591577  0.48441114]
Stock Position:  -0.020895227579149977
Bond Position:  [2.46111133]


portfolio before change:  [0.3831071]
curr_Stock_Price:  99.46347231271555
curr_Factors:  [99.46347231 -1.50686933 -0.96620969]
mat_Sqrt:  [[ 8.38723954  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00874686 -0.03496473 -0.37271733]
Stock Position:  -0.008746858502169936
Bond Position:  [1.25310002]


portfolio before change:  [0.38385824]
curr_Stock_Price:  99.39550639848713
curr_Factors:  [99.3955064  -1.36462416 -0.9342426 ]
mat_Sqrt:  [[ 9.97657803  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00425595  0.05580992 -0.23487962]
Stock Position:  0.004255954342911323
Bond Position:  [-0.0391645]


portfolio before change:  [0.38592087]
curr_Stock_Price:  99.8813031292639
curr_Factors:  [99.88130313 -1.45339855 -0.9287959 ]
mat_Sqrt:  [[ 9.22380885  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00810687  0.02539347  0.05206488]
Stock Position:  -0.008106868682217513
Bond Position:  [1.19564548]


portfolio before change:  [0.39123868]
curr_Stock_Price:  99.24377697217824
curr_Factors:  [99.24377697 -1.28107297 -0.90448783]
mat_Sqrt:  [[11.15645682  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01083737  0.0154083  -0.11891705]
Stock Position:  -0.010837372170187898
Bond Position:  [1.46678042]


portfolio before change:  [0.40211095]
curr_Stock_Price:  98.25747561033154
curr_Factors:  [98.25747561 -1.2442062  -0.88131973]
mat_Sqrt:  [[11.72901159  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00735999 -0.03632963  0.1803282 ]
Stock Position:  -0.007359991458289094
Bond Position:  [1.12528513]


portfolio before change:  [0.39866396]
curr_Stock_Price:  98.74492990114383
curr_Factors:  [98.7449299  -1.18689869 -0.85516757]
mat_Sqrt:  [[12.81317322  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.02617853 0.1236784  0.11492979]
Stock Position:  0.02617852759245338
Bond Position:  [-2.18633291]


portfolio before change:  [0.36738725]
curr_Stock_Price:  97.56062332128147
curr_Factors:  [97.56062332 -1.14154016 -0.8588769 ]
mat_Sqrt:  [[13.19788919  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00421668 -0.11783103 -0.10314649]
Stock Position:  -0.004216677397187956
Bond Position:  [0.77876893]


portfolio before change:  [0.36508918]
curr_Stock_Price:  98.12870643873251
curr_Factors:  [98.12870644 -1.03324504 -0.86245224]
mat_Sqrt:  [[14.7402621   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0052368  -0.016546   -0.12423066]
Stock Position:  -0.005236802680186811
Bond Position:  [0.87896985]


portfolio before change:  [0.3637771]
curr_Stock_Price:  98.40023786897385
curr_Factors:  [98.40023787 -1.04171682 -0.84406792]
mat_Sqrt:  [[14.92829626  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00279652  0.06541368  0.38567977]
Stock Position:  -0.00279651717012557
Bond Position:  [0.63895506]


portfolio before change:  [0.36415635]
curr_Stock_Price:  98.29318459274054
curr_Factors:  [98.29318459 -1.2350308  -0.83832525]
mat_Sqrt:  [[12.36164643  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00791683 0.02333148 0.25458094]
Stock Position:  0.007916830481198074
Bond Position:  [-0.41401413]


portfolio before change:  [0.35736547]
curr_Stock_Price:  97.4419441388042
curr_Factors:  [97.44194414 -1.21892704 -0.81667916]
mat_Sqrt:  [[12.72604345  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00166918 -0.00659411  0.35164605]
Stock Position:  -0.001669179839365953
Bond Position:  [0.5200136]


portfolio before change:  [0.35654019]
curr_Stock_Price:  97.97531265286351
curr_Factors:  [97.97531265 -1.09019696 -0.79519556]
mat_Sqrt:  [[14.8696618   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00232568 -0.02154276  0.10390228]
Stock Position:  0.002325683534921458
Bond Position:  [0.12868062]


portfolio before change:  [0.35372324]
curr_Stock_Price:  96.75716337355804
curr_Factors:  [96.75716337 -0.81366919 -0.75081126]
mat_Sqrt:  [[20.24127681  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00853963 0.00954713 0.72020395]
Stock Position:  0.008539632173767369
Bond Position:  [-0.47254734]


portfolio before change:  [0.34218772]
curr_Stock_Price:  95.4132587650443
curr_Factors:  [95.41325877 -0.82696636 -0.75153471]
mat_Sqrt:  [[19.68223557  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [3.41856895e-04 5.68191413e-04 7.87693368e-01]
Stock Position:  0.00034185689515379123
Bond Position:  [0.30957004]


portfolio before change:  [0.34188058]
curr_Stock_Price:  94.40161986726903
curr_Factors:  [94.40161987 -0.66187721 -0.73951393]
mat_Sqrt:  [[23.24679099  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00343589 -0.00621481 -0.24017674]
Stock Position:  -0.0034358870267141095
Bond Position:  [0.66623388]


portfolio before change:  [0.33737645]
curr_Stock_Price:  95.73676879305387
curr_Factors:  [95.73676879 -0.86606743 -0.73463457]
mat_Sqrt:  [[19.31535608  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02945655  0.05427472  0.12470087]
Stock Position:  -0.029456551529012602
Bond Position:  [3.15745151]


portfolio before change:  [0.32883894]
curr_Stock_Price:  96.04000224409103
curr_Factors:  [96.04000224 -0.72838515 -0.7352972 ]
mat_Sqrt:  [[22.22199237  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00428836 -0.0740112   0.35669844]
Stock Position:  -0.004288360082393563
Bond Position:  [0.74069305]


portfolio before change:  [0.32834941]
curr_Stock_Price:  96.17574773313144
curr_Factors:  [96.17574773 -0.62937642 -0.75828814]
mat_Sqrt:  [[24.01101465  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00560436  0.01863094 -0.30424484]
Stock Position:  0.005604355386840685
Bond Position:  [-0.21065366]


portfolio before change:  [0.32911762]
curr_Stock_Price:  96.31752048628493
curr_Factors:  [96.31752049 -0.86040543 -0.76718907]
mat_Sqrt:  [[18.91690066  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00222667 -0.00179334  0.02884197]
Stock Position:  0.002226673971556974
Bond Position:  [0.1146499]


portfolio before change:  [0.32664066]
curr_Stock_Price:  95.19868090874024
curr_Factors:  [95.19868091 -0.78244867 -0.75020034]
mat_Sqrt:  [[20.55937558  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00761947 -0.06100266 -0.19156714]
Stock Position:  -0.007619472563732584
Bond Position:  [1.0520044]


portfolio before change:  [0.34128207]
curr_Stock_Price:  93.29436212463614
curr_Factors:  [93.29436212 -0.39436084 -0.74037393]
mat_Sqrt:  [[29.99482618  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00737685 0.07475467 0.37728534]
Stock Position:  0.007376852486788863
Bond Position:  [-0.34693667]


portfolio before change:  [0.34856335]
curr_Stock_Price:  94.28728549150233
curr_Factors:  [94.28728549 -0.32712183 -0.71977101]
mat_Sqrt:  [[33.09735986  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00286648 -0.02047172  0.1925658 ]
Stock Position:  0.002866481442182729
Bond Position:  [0.0782906]


portfolio before change:  [0.34547759]
curr_Stock_Price:  93.20737295467599
curr_Factors:  [93.20737295 -0.29424771 -0.72500914]
mat_Sqrt:  [[33.63509364  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00333022 0.01608    0.09193419]
Stock Position:  0.0033302241441069014
Bond Position:  [0.03507615]


portfolio before change:  [0.3504924]
curr_Stock_Price:  94.7119039401848
curr_Factors:  [94.71190394 -0.35096896 -0.74396326]
mat_Sqrt:  [[31.68703085  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00710894 -0.03081983  0.14046211]
Stock Position:  0.007108944316729709
Bond Position:  [-0.32280925]


portfolio before change:  [0.34147969]
curr_Stock_Price:  93.44978132087348
curr_Factors:  [93.44978132 -0.14442719 -0.75275763]
mat_Sqrt:  [[38.10095606  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00094091 -0.02354187  0.06708479]
Stock Position:  -0.0009409056132493615
Bond Position:  [0.42940711]


portfolio before change:  [0.33943693]
curr_Stock_Price:  95.67788348930947
curr_Factors:  [ 9.56778835e+01  4.82469305e-02 -7.52063052e-01]
mat_Sqrt:  [[47.33126393  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00460896  0.0552364   0.04426614]
Stock Position:  -0.004608956484227724
Bond Position:  [0.78041214]


portfolio before change:  [0.3508069]
curr_Stock_Price:  93.23212263705193
curr_Factors:  [ 9.32321226e+01 -6.18127253e-02 -7.46768011e-01]
mat_Sqrt:  [[41.53396763  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00697448 0.03713415 0.16166143]
Stock Position:  0.0069744816112681995
Bond Position:  [-0.29943883]


portfolio before change:  [0.35122427]
curr_Stock_Price:  93.29733282384746
curr_Factors:  [93.29733282 -0.10196854 -0.75524619]
mat_Sqrt:  [[39.59000912  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-6.92835871e-05 -1.02305410e-02 -2.90460130e-01]
Stock Position:  -6.928358707962644e-05
Bond Position:  [0.35768825]


portfolio before change:  [0.35142513]
curr_Stock_Price:  91.04366608920925
curr_Factors:  [91.04366609 -0.11978965 -0.72846235]
mat_Sqrt:  [[38.9815027   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00017784 0.02454305 0.01667016]
Stock Position:  0.00017784384062258718
Bond Position:  [0.33523357]


portfolio before change:  [0.35117699]
curr_Stock_Price:  89.41275997699026
curr_Factors:  [89.41275998 -0.51963354 -0.74172143]
mat_Sqrt:  [[25.3279477   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01595609 -0.17159865 -0.38651073]
Stock Position:  0.015956089363440028
Bond Position:  [-1.075501]


portfolio before change:  [0.35465732]
curr_Stock_Price:  89.63930523205565
curr_Factors:  [89.63930523 -0.43135782 -0.73144025]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [0.35465732]
Stock Price:  91.52505463263896
PL:  [0.35465732]
Settle:  Tensor("sub_102:0", shape=(), dtype=float64)
PL:  Tensor("sub_103:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  52
output_Z_Vals[:, i, :]:  [[ 1.19260232e+02 -2.92559343e+01 -2.92733494e+01]
 [ 1.18983812e-02 -4.77255725e-02 -3.28114913e-02]
 [-6.80139732e-02 -1.88290823e-02  9.42540124e-02]
 [-5.60439858e-02  1.08749641e-01  1.16677803e-02]
 [ 2.12008242e-02  3.59599326e-02 -7.14055655e-02]
 [ 7.14319411e-02  2.97597536e-02 -6.34378473e-02]
 [ 7.86020303e-02  1.12360100e-02 -7.46186591e-02]
 [-6.37894498e-02  2.15228842e-02 -7.05653227e-02]
 [-6.19317345e-02 -6.49638928e-02  4.05725748e-02]
 [-5.84580947e-02 -1.18650499e-01 -1.29076443e-01]
 [ 6.13385494e-02  1.40857992e-01 -8.87357288e-02]
 [-1.07970341e-01 -1.09515642e-01  1.11751818e-02]
 [-1.13408305e-01  4.83503954e-02 -4.19354176e-02]
 [-1.02661754e-01 -1.11139379e-01  6.11630744e-02]
 [ 2.70389225e-01  3.40934397e-01  4.39394001e-02]
 [-7.15621047e-02 -1.54964263e-01 -1.02770013e-01]
 [-6.87314610e-02 -6.55144659e-02 -5.99252802e-02]
 [-8.03759104e-02  1.38646648e-01  1.18666759e-01]
 [ 7.22692815e-02  6.51079005e-02  7.98728629e-02]
 [ 1.67278937e-01 -4.91917216e-02  1.29281259e-02]
 [-3.82214966e-02 -1.57527271e-02 -1.84419301e-02]
 [ 9.70498377e-02 -6.36279271e-02  9.37248738e-02]
 [-6.47062735e-02  5.95603091e-02  2.57298121e-01]
 [-2.81144923e-03 -7.02836370e-03 -7.19044199e-02]
 [-2.76214903e-02  5.36819708e-02  8.23592561e-02]
 [ 1.64976761e-02 -8.70908088e-02  8.30190654e-02]
 [-1.57226049e-03  5.02382358e-02 -4.01150854e-02]
 [-5.07806065e-02  7.36225950e-02  2.93687317e-02]
 [-8.37084402e-02 -7.95906685e-02 -1.94199765e-01]
 [ 8.64535879e-03 -8.91397984e-03 -1.18833441e-01]
 [ 2.32342194e-02  1.56532934e-01  1.26588332e-02]
 [ 1.58532332e-02 -8.15679575e-02 -8.62596524e-02]
 [-6.75474774e-03 -2.41235575e-03  7.65770847e-02]
 [-5.04022015e-02 -8.58435530e-02 -8.60124370e-03]
 [-1.80769154e-01  1.85063328e-01  3.08535979e-02]
 [ 8.47165236e-02 -1.65012150e-01 -1.38726811e-01]
 [-5.26803834e-02 -1.43876099e-01 -4.54968267e-02]
 [-2.93010699e-02  1.73730425e-02 -4.29319253e-02]
 [ 1.37806376e-01 -1.87585059e-01 -3.82956932e-02]
 [-8.63993539e-01  4.30295734e-01  5.27263993e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.26023247 -29.25593426 -29.27334937]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  8.31486419  -9.25153874 -83.50871763]
init_Out:  [2.49911038]
Stock Position:  8.31486419409362
Bond position:  [-828.98730903]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-0.16811025]
curr_Stock_Price:  99.69168579593793
curr_Factors:  [99.6916858  -1.00523444 -0.98209382]
mat_Sqrt:  [[13.66385495  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00029044 -0.01509215 -0.09360205]
Stock Position:  0.00029043740749184663
Bond Position:  [-0.19706444]


portfolio before change:  [-0.16844321]
curr_Stock_Price:  98.63008420409285
curr_Factors:  [98.6300842  -0.88127079 -0.97107826]
mat_Sqrt:  [[15.47192787  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00318387 -0.00595428  0.26888046]
Stock Position:  -0.0031838707304966
Bond Position:  [0.14558223]


portfolio before change:  [-0.16974566]
curr_Stock_Price:  99.04487743502803
curr_Factors:  [99.04487744 -0.82581912 -0.97005703]
mat_Sqrt:  [[16.4396633   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0030934   0.03438966  0.03328493]
Stock Position:  -0.003093397080524804
Bond Position:  [0.13663948]


portfolio before change:  [-0.16891792]
curr_Stock_Price:  98.78281819160954
curr_Factors:  [98.78281819 -0.77081095 -0.97878272]
mat_Sqrt:  [[17.17285633  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00043986  0.01137153 -0.2037002 ]
Stock Position:  0.00043986308801329807
Bond Position:  [-0.21236884]


portfolio before change:  [-0.16862502]
curr_Stock_Price:  99.50906745328896
curr_Factors:  [99.50906745 -0.94656823 -1.00473176]
mat_Sqrt:  [[14.13916744  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00419057  0.00941086 -0.18097052]
Stock Position:  0.004190567695420531
Bond Position:  [-0.5856245]


portfolio before change:  [-0.1734275]
curr_Stock_Price:  98.3805159590839
curr_Factors:  [98.38051596 -1.00403105 -0.99669593]
mat_Sqrt:  [[13.30467929  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00478483  0.00355314 -0.21286626]
Stock Position:  0.00478483332685255
Bond Position:  [-0.64416187]


portfolio before change:  [-0.17797071]
curr_Stock_Price:  97.44784247752843
curr_Factors:  [97.44784248 -1.06148322 -0.99825721]
mat_Sqrt:  [[12.42333869  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00624935  0.00680613 -0.20130322]
Stock Position:  -0.0062493520772843045
Bond Position:  [0.43101516]


portfolio before change:  [-0.18380032]
curr_Stock_Price:  98.38929867914784
curr_Factors:  [98.38929868 -1.33493033 -0.99850329]
mat_Sqrt:  [[ 9.54004714  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00579947 -0.02054339  0.11574226]
Stock Position:  -0.005799473740886225
Bond Position:  [0.38680583]


portfolio before change:  [-0.18623437]
curr_Stock_Price:  98.81733792142518
curr_Factors:  [98.81733792 -1.24446257 -1.00355749]
mat_Sqrt:  [[10.43591281  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00841989 -0.03752058 -0.36821916]
Stock Position:  -0.008419891745155431
Bond Position:  [0.64579692]


portfolio before change:  [-0.18434512]
curr_Stock_Price:  98.6025457645526
curr_Factors:  [98.60254576 -0.99116453 -1.0033359 ]
mat_Sqrt:  [[13.41799399  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0034925   0.04454321 -0.25313834]
Stock Position:  0.0034925028565612605
Bond Position:  [-0.52871479]


portfolio before change:  [-0.18416726]
curr_Stock_Price:  98.67239517821372
curr_Factors:  [98.67239518 -0.94593008 -1.01533981]
mat_Sqrt:  [[13.88119907  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00781755 -0.03463189  0.03187968]
Stock Position:  -0.007817545021386596
Bond Position:  [0.58720863]


portfolio before change:  [-0.18684316]
curr_Stock_Price:  99.02407971850897
curr_Factors:  [99.02407972 -1.12224544 -1.03233852]
mat_Sqrt:  [[11.48198284  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01051386  0.01528974 -0.11963007]
Stock Position:  -0.010513857734566152
Bond Position:  [0.85428192]


portfolio before change:  [-0.18947781]
curr_Stock_Price:  99.2848246835095
curr_Factors:  [99.28482468 -1.13902739 -1.04606489]
mat_Sqrt:  [[11.16630156  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00833279 -0.03514536  0.17448123]
Stock Position:  -0.008332794897091536
Bond Position:  [0.63784227]


portfolio before change:  [-0.18767261]
curr_Stock_Price:  99.07775609124353
curr_Factors:  [99.07775609 -0.93398986 -1.06730766]
mat_Sqrt:  [[13.3913294   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.02151849 0.10781292 0.12534688]
Stock Position:  0.02151849135359408
Bond Position:  [-2.31967645]


portfolio before change:  [-0.18040171]
curr_Stock_Price:  99.42912265351396
curr_Factors:  [99.42912265 -1.142206   -1.07659626]
mat_Sqrt:  [[10.81185041  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00892919 -0.049004   -0.29317424]
Stock Position:  -0.008929193631475076
Bond Position:  [0.70742018]


portfolio before change:  [-0.17954229]
curr_Stock_Price:  99.34277840023451
curr_Factors:  [99.3427784  -1.02079587 -1.06571972]
mat_Sqrt:  [[12.33031289  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00670342 -0.02071749 -0.17095014]
Stock Position:  -0.006703417387879861
Bond Position:  [0.48639381]


portfolio before change:  [-0.18143]
curr_Stock_Price:  99.63345278620018
curr_Factors:  [99.63345279 -0.98533928 -1.04883006]
mat_Sqrt:  [[13.03096749  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00403449  0.04384392  0.33852323]
Stock Position:  -0.004034490804277745
Bond Position:  [0.22054025]


portfolio before change:  [-0.18634648]
curr_Stock_Price:  100.85889781057915
curr_Factors:  [100.85889781  -0.994082    -1.03961358]
mat_Sqrt:  [[13.19749327  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00683875 0.02058893 0.22785505]
Stock Position:  0.006838748714845283
Bond Position:  [-0.87609514]


portfolio before change:  [-0.18897383]
curr_Stock_Price:  100.49072623506699
curr_Factors:  [100.49072624  -1.01756301  -1.03685189]
mat_Sqrt:  [[12.87967582  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0130941  -0.01555579  0.03688034]
Stock Position:  0.013094099340429675
Bond Position:  [-1.50480938]


portfolio before change:  [-0.19724425]
curr_Stock_Price:  99.87347802831815
curr_Factors:  [99.87347803 -1.06425793 -1.04529454]
mat_Sqrt:  [[12.11387749  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00349951 -0.00498145 -0.05260969]
Stock Position:  -0.0034995131415628063
Bond Position:  [0.15226429]


portfolio before change:  [-0.19799354]
curr_Stock_Price:  100.09302814830052
curr_Factors:  [100.09302815  -0.99439574  -1.04072489]
mat_Sqrt:  [[13.0786275   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00875768 -0.02012092  0.26737098]
Stock Position:  0.008757683596130328
Bond Position:  [-1.07457661]


portfolio before change:  [-0.18968099]
curr_Stock_Price:  101.05753849598295
curr_Factors:  [101.0575385   -0.84760208  -1.02613556]
mat_Sqrt:  [[15.51725153  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-6.86182976e-04  1.88346235e-02  7.33999922e-01]
Stock Position:  -0.0006861829762781033
Bond Position:  [-0.12033703]


portfolio before change:  [-0.18975257]
curr_Stock_Price:  101.13993143068205
curr_Factors:  [101.13993143  -0.95253003  -1.01411155]
mat_Sqrt:  [[14.15210586  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0012486  -0.00222256 -0.2051233 ]
Stock Position:  -0.001248602096129171
Bond Position:  [-0.06346904]


portfolio before change:  [-0.18952554]
curr_Stock_Price:  100.95174587636545
curr_Factors:  [100.95174588  -0.80342057  -1.00583174]
mat_Sqrt:  [[16.53352819  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00056999  0.01697573  0.23494803]
Stock Position:  -0.0005699881440361043
Bond Position:  [-0.13198424]


portfolio before change:  [-0.18916686]
curr_Stock_Price:  100.293522183551
curr_Factors:  [100.29352218  -0.58383121  -0.99144114]
mat_Sqrt:  [[20.75586284  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00150296 -0.02754053  0.23683029]
Stock Position:  0.0015029583238349012
Bond Position:  [-0.33990384]


portfolio before change:  [-0.18970948]
curr_Stock_Price:  99.96075890625885
curr_Factors:  [99.96075891 -0.54085739 -0.96055506]
mat_Sqrt:  [[22.27277873  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00038     0.01588673 -0.11443717]
Stock Position:  -0.0003799962471484185
Bond Position:  [-0.15172476]


portfolio before change:  [-0.18957965]
curr_Stock_Price:  99.56920391774233
curr_Factors:  [99.56920392 -0.46639029 -0.95076528]
mat_Sqrt:  [[24.13582733  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00177681  0.02328151  0.08378082]
Stock Position:  -0.0017768113523967879
Bond Position:  [-0.01266396]


portfolio before change:  [-0.18678478]
curr_Stock_Price:  97.99534249908821
curr_Factors:  [97.9953425  -0.28026289 -0.94527668]
mat_Sqrt:  [[28.77135798  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00435865 -0.02516878 -0.55399788]
Stock Position:  -0.004358651532165323
Bond Position:  [0.24034277]


portfolio before change:  [-0.19816566]
curr_Stock_Price:  100.61333682192233
curr_Factors:  [100.61333682  -0.44630413  -0.93006588]
mat_Sqrt:  [[25.40420759  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00062358 -0.00281885 -0.33899873]
Stock Position:  -0.0006235807050406424
Bond Position:  [-0.13542513]


portfolio before change:  [-0.19684821]
curr_Stock_Price:  98.47346765953503
curr_Factors:  [98.47346766 -0.26414601 -0.92157706]
mat_Sqrt:  [[30.08612426  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00099248 0.04950006 0.03611213]
Stock Position:  0.0009924793124230574
Bond Position:  [-0.29458109]


portfolio before change:  [-0.19637664]
curr_Stock_Price:  98.98572061036239
curr_Factors:  [ 9.89857206e+01  2.74766134e-02 -9.29207470e-01]
mat_Sqrt:  [[40.17499339  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-9.60926171e-05 -2.57940530e-02 -2.46074778e-01]
Stock Position:  -9.60926171370435e-05
Bond Position:  [-0.18686484]


portfolio before change:  [-0.19654787]
curr_Stock_Price:  100.52457423960139
curr_Factors:  [ 1.00524574e+02 -3.05527566e-02 -9.24766655e-01]
mat_Sqrt:  [[38.67072313  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00022793 -0.00076285  0.21845311]
Stock Position:  0.00022792947089392602
Bond Position:  [-0.21946038]


portfolio before change:  [-0.19606889]
curr_Stock_Price:  102.74638587850482
curr_Factors:  [102.74638588  -0.14647983  -0.93431277]
mat_Sqrt:  [[34.86456806  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00155959 -0.02714611 -0.02453695]
Stock Position:  -0.0015595889187511411
Bond Position:  [-0.03582676]


portfolio before change:  [-0.19676494]
curr_Stock_Price:  103.18982067510444
curr_Factors:  [103.18982068  -0.2974114   -0.91502212]
mat_Sqrt:  [[30.69613321  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00552815  0.05852216  0.08801673]
Stock Position:  -0.005528151508509322
Bond Position:  [0.37368402]


portfolio before change:  [-0.19312558]
curr_Stock_Price:  102.53993802085897
curr_Factors:  [102.53993802  -0.43541586  -0.90795494]
mat_Sqrt:  [[26.7592862   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00194842 -0.05218142 -0.39574898]
Stock Position:  0.0019484240379976515
Bond Position:  [-0.39291686]


portfolio before change:  [-0.19814893]
curr_Stock_Price:  99.98698547792516
curr_Factors:  [99.98698548 -0.34768612 -0.90890311]
mat_Sqrt:  [[28.45861136  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00230799 -0.04549762 -0.12978978]
Stock Position:  -0.0023079920632935944
Bond Position:  [0.03262024]


portfolio before change:  [-0.19726308]
curr_Stock_Price:  99.6049336738921
curr_Factors:  [99.60493367 -0.33054687 -0.91632921]
mat_Sqrt:  [[28.62657888  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00131402  0.00549384 -0.12247283]
Stock Position:  -0.0013140215802853663
Bond Position:  [-0.06638005]


portfolio before change:  [-0.19327074]
curr_Stock_Price:  96.56035859827206
curr_Factors:  [96.5603586  -0.18941104 -0.9127252 ]
mat_Sqrt:  [[32.07356131  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00390184 -0.0593196  -0.10924695]
Stock Position:  0.0039018390855967756
Bond Position:  [-0.57003372]


portfolio before change:  [-0.19128537]
curr_Stock_Price:  97.08744933051558
curr_Factors:  [97.08744933 -0.60656877 -0.88297954]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-0.19128537]
Stock Price:  96.52622051293064
PL:  [-0.19128537]
Settle:  Tensor("sub_104:0", shape=(), dtype=float64)
PL:  Tensor("sub_105:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  53
output_Z_Vals[:, i, :]:  [[ 1.19260232e+02 -2.92559343e+01 -2.92733494e+01]
 [-3.56842591e-02  4.02701366e-02 -6.63967213e-03]
 [ 3.39235862e-02  2.60869712e-02 -2.55485498e-02]
 [ 8.16628577e-02  1.40265942e-01  3.75551225e-02]
 [ 2.35260096e-01 -1.44909871e-02 -2.85022851e-02]
 [-2.98013431e-05  3.26008096e-02  9.66584619e-02]
 [-1.80515575e-02  5.64322477e-02 -9.69060932e-02]
 [ 1.51046741e-01  1.69070671e-01  1.32285309e-01]
 [ 2.90772100e-02  3.00687556e-02 -5.03862937e-02]
 [-2.70545534e-02  3.62825281e-01  1.45951754e-01]
 [ 5.97041195e-02  5.88527969e-02 -8.27433892e-02]
 [-4.37250804e-02  6.19590120e-03  1.41620890e-03]
 [-3.10502789e-02 -1.03127445e-01 -2.23984254e-02]
 [-1.10115704e-02 -5.71316619e-02  1.15177690e-01]
 [ 1.40247297e-01  7.12892876e-02 -9.38449321e-02]
 [-8.10019205e-02 -1.06403466e-01 -1.17954766e-01]
 [-6.74663886e-02 -6.57353042e-02 -4.73416179e-02]
 [-7.96921080e-02  8.71131159e-02  9.77714131e-02]
 [ 9.48299800e-02  5.56374346e-02  8.65255157e-02]
 [-6.20647272e-03 -1.43081005e-02  8.66726862e-02]
 [-6.03301104e-03 -3.88994745e-02  3.42943177e-03]
 [ 1.10345022e-01 -6.12230260e-02  1.23862281e-01]
 [-5.03627489e-02  4.10963082e-03  2.77969673e-01]
 [-6.97541835e-02 -5.38202262e-04 -8.16710615e-02]
 [-2.57821862e-01  9.99977530e-02  6.87612951e-02]
 [ 1.07976987e-02 -9.33554197e-02  8.48303349e-02]
 [-1.41686441e-01  6.31745368e-02  3.61564744e-02]
 [-5.07806065e-02  7.36225950e-02  2.93687317e-02]
 [-6.41846569e-02 -5.83542588e-02 -2.22951076e-01]
 [ 8.08777560e-03 -7.42383774e-03 -1.17064731e-01]
 [ 5.04351033e-02  6.72851477e-02  1.63382694e-02]
 [ 3.42412030e-02 -8.87949888e-02 -8.02418342e-02]
 [ 2.43900347e-01 -1.28498518e-01  1.31241391e-02]
 [-4.26459122e-02 -7.82713940e-02  1.27362880e-02]
 [-1.99638271e-01  1.17146108e-01  1.86233678e-02]
 [ 1.55538064e-01 -9.44055960e-02 -5.80666887e-02]
 [ 1.21537256e-02 -1.26520896e-02 -9.14641185e-02]
 [-2.05369855e-02  3.00558541e-02 -5.44628925e-02]
 [-9.48761943e-03  2.19212995e-02 -2.42313228e-03]
 [-6.22828922e-01  3.14136413e-01  3.81454241e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.26023247 -29.25593426 -29.27334937]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  8.31486419  -9.25153874 -83.50871763]
init_Out:  [2.49911038]
Stock Position:  8.31486419409362
Bond position:  [-828.98730903]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [6.47532928]
curr_Stock_Price:  100.49066932335764
curr_Factors:  [100.49066932  -1.01479578  -0.99812557]
mat_Sqrt:  [[13.42533426  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00268148  0.01273454 -0.01894114]
Stock Position:  -0.0026814830339419718
Bond Position:  [6.7447933]


portfolio before change:  [6.47476226]
curr_Stock_Price:  101.01656216571519
curr_Factors:  [101.01656217  -1.03555743  -0.98720405]
mat_Sqrt:  [[13.36344517  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00219869  0.00824942 -0.0728829 ]
Stock Position:  0.002198689981655374
Bond Position:  [6.25265815]


portfolio before change:  [6.47810226]
curr_Stock_Price:  102.180150949897
curr_Factors:  [102.18015095  -0.87397349  -0.98265903]
mat_Sqrt:  [[15.96030854  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00582385 0.04435599 0.10713431]
Stock Position:  0.005823848316519434
Bond Position:  [5.88302056]


portfolio before change:  [6.47914694]
curr_Stock_Price:  102.23325280026067
curr_Factors:  [102.2332528   -1.15094967  -0.97341601]
mat_Sqrt:  [[12.21776835  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01874875 -0.00458245 -0.08130909]
Stock Position:  0.01874875421896749
Bond Position:  [4.56240081]


portfolio before change:  [6.48770303]
curr_Stock_Price:  102.65918781027491
curr_Factors:  [102.65918781  -1.0644581   -0.9813666 ]
mat_Sqrt:  [[13.27111598  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00154789 0.01030928 0.27573969]
Stock Position:  0.0015478934759803587
Bond Position:  [6.32879754]


portfolio before change:  [6.48781693]
curr_Stock_Price:  102.22166166435385
curr_Factors:  [102.22166166  -0.93825528  -0.98884549]
mat_Sqrt:  [[14.88036915  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00244452  0.01784544 -0.27644611]
Stock Position:  -0.0024445197718792858
Bond Position:  [6.7376998]


portfolio before change:  [6.48864034]
curr_Stock_Price:  102.2293761268725
curr_Factors:  [102.22937613  -0.84338643  -0.98743289]
mat_Sqrt:  [[16.38554837  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01113266 0.05346484 0.37737316]
Stock Position:  0.011132660816959516
Bond Position:  [5.35055537]


portfolio before change:  [6.48420097]
curr_Stock_Price:  101.77052537891487
curr_Factors:  [101.77052538  -0.75360721  -0.98556945]
mat_Sqrt:  [[17.87751663  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00109459  0.00950858 -0.14373807]
Stock Position:  0.00109458842592617
Bond Position:  [6.37280413]


portfolio before change:  [6.48449462]
curr_Stock_Price:  101.31099549723713
curr_Factors:  [101.3109955   -0.31154518  -1.00335275]
mat_Sqrt:  [[27.20217731  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00044503 0.11473543 0.41635973]
Stock Position:  0.0004450317354326448
Bond Position:  [6.43940802]


portfolio before change:  [6.48521813]
curr_Stock_Price:  101.12792846057286
curr_Factors:  [101.12792846  -0.37464676  -1.00651218]
mat_Sqrt:  [[25.41214987  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00174459  0.01861089 -0.23604386]
Stock Position:  0.0017445894519419476
Bond Position:  [6.30879141]


portfolio before change:  [6.4854611]
curr_Stock_Price:  100.81514591378534
curr_Factors:  [100.81514591  -0.29141124  -0.9854036 ]
mat_Sqrt:  [[28.11979442  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00153899  0.00195932  0.00404005]
Stock Position:  -0.0015389877964991658
Bond Position:  [6.64061438]


portfolio before change:  [6.48506177]
curr_Stock_Price:  101.61402074709953
curr_Factors:  [101.61402075  -0.27628152  -1.00391656]
mat_Sqrt:  [[28.24689235  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00135537 -0.03261176 -0.06389647]
Stock Position:  -0.0013553730792455713
Bond Position:  [6.62278668]


portfolio before change:  [6.48735892]
curr_Stock_Price:  100.53000153487724
curr_Factors:  [100.53000153  -0.44815167  -0.99038325]
mat_Sqrt:  [[23.85326926  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00046215 -0.01806662  0.32856989]
Stock Position:  0.0004621523284537112
Bond Position:  [6.44089875]


portfolio before change:  [6.48850324]
curr_Stock_Price:  101.26386326164554
curr_Factors:  [101.26386326  -0.55178773  -0.99449366]
mat_Sqrt:  [[21.57312303  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00569839  0.02254365 -0.26771347]
Stock Position:  0.005698385065910874
Bond Position:  [5.91146275]


portfolio before change:  [6.4873084]
curr_Stock_Price:  100.92450037156662
curr_Factors:  [100.92450037  -0.32600105  -0.98706712]
mat_Sqrt:  [[27.14803145  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0039718  -0.03364773 -0.33649211]
Stock Position:  -0.0039718040729987535
Bond Position:  [6.88816074]


portfolio before change:  [6.49513601]
curr_Stock_Price:  99.17050200387015
curr_Factors:  [99.170502   -0.65591333 -0.96836938]
mat_Sqrt:  [[19.54184185  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00403377 -0.02078733 -0.13505246]
Stock Position:  -0.004033766865356108
Bond Position:  [6.8951667]


portfolio before change:  [6.49556844]
curr_Stock_Price:  99.27698390148676
curr_Factors:  [99.2769839  -0.59872518 -0.98903388]
mat_Sqrt:  [[20.2905387   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00283311  0.02754759  0.27891463]
Stock Position:  -0.0028331111218641816
Bond Position:  [6.77683116]


portfolio before change:  [6.49837384]
curr_Stock_Price:  98.58578382355729
curr_Factors:  [98.58578382 -0.72314751 -0.9975101 ]
mat_Sqrt:  [[17.64177134  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00645788 0.0175941  0.24683321]
Stock Position:  0.006457882100679244
Bond Position:  [5.86171847]


portfolio before change:  [6.49840405]
curr_Stock_Price:  98.47699344226015
curr_Factors:  [98.47699344 -0.8108987  -0.97615532]
mat_Sqrt:  [[16.49024398  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0006741  -0.00452462  0.24725305]
Stock Position:  0.0006741004990101383
Bond Position:  [6.43202066]


portfolio before change:  [6.49952319]
curr_Stock_Price:  98.94442512791235
curr_Factors:  [98.94442513 -0.91253653 -0.96957618]
mat_Sqrt:  [[15.06607643  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00042064 -0.01230109  0.00978321]
Stock Position:  -0.00042063780571693855
Bond Position:  [6.54114296]


portfolio before change:  [6.50017905]
curr_Stock_Price:  99.32917188391963
curr_Factors:  [99.32917188 -0.92168709 -0.97981459]
mat_Sqrt:  [[14.8342341   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00903636 -0.01936042  0.35334461]
Stock Position:  0.009036363567523058
Bond Position:  [5.60260454]


portfolio before change:  [6.49135832]
curr_Stock_Price:  98.27552967776518
curr_Factors:  [98.27552968 -0.72808171 -0.95660142]
mat_Sqrt:  [[18.23042561  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [3.55651774e-04 1.29957937e-03 7.92970106e-01]
Stock Position:  0.0003556517741937624
Bond Position:  [6.45640646]


portfolio before change:  [6.49160334]
curr_Stock_Price:  96.69508510999478
curr_Factors:  [96.69508511 -0.51142524 -0.93758895]
mat_Sqrt:  [[22.70416487  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-3.80719202e-03 -1.70194499e-04 -2.32984806e-01]
Stock Position:  -0.0038071920246891384
Bond Position:  [6.8597401]


portfolio before change:  [6.48509919]
curr_Stock_Price:  98.62870678251934
curr_Factors:  [98.62870678 -0.70523645 -0.91488989]
mat_Sqrt:  [[19.51602685  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01235928  0.03162207  0.19615684]
Stock Position:  -0.012359282564433785
Bond Position:  [7.70407925]


portfolio before change:  [6.46701914]
curr_Stock_Price:  100.16950188245113
curr_Factors:  [100.16950188  -0.59064712  -0.92111854]
mat_Sqrt:  [[22.08940567  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0011636  -0.02952158  0.24199733]
Stock Position:  0.0011635981561460812
Bond Position:  [6.35046209]


portfolio before change:  [6.46917802]
curr_Stock_Price:  101.34260857369597
curr_Factors:  [101.34260857  -0.67018243  -0.94877431]
mat_Sqrt:  [[20.07650449  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00660846  0.01997754  0.10314436]
Stock Position:  -0.00660846473680366
Bond Position:  [7.13889708]


portfolio before change:  [6.4777425]
curr_Stock_Price:  100.18166351710566
curr_Factors:  [100.18166352  -0.44021019  -0.96131409]
mat_Sqrt:  [[24.66686636  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00173856  0.02328151  0.08378082]
Stock Position:  -0.001738559384899853
Bond Position:  [6.65191427]


portfolio before change:  [6.47880038]
curr_Stock_Price:  100.05147798282071
curr_Factors:  [100.05147798  -0.52199202  -0.93178102]
mat_Sqrt:  [[23.38072112  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0047561  -0.01845324 -0.63601736]
Stock Position:  -0.004756100318500414
Bond Position:  [6.95465525]


portfolio before change:  [6.47893419]
curr_Stock_Price:  100.20613701248934
curr_Factors:  [100.20613701  -0.72975118  -0.92587159]
mat_Sqrt:  [[19.13667531  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00083607 -0.00234762 -0.33395309]
Stock Position:  -0.000836072351885025
Bond Position:  [6.56271377]


portfolio before change:  [6.48133132]
curr_Stock_Price:  98.32025415573996
curr_Factors:  [98.32025416 -0.76969537 -0.94626588]
mat_Sqrt:  [[17.6770785   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00314008 0.02127743 0.04660853]
Stock Position:  0.003140079604468299
Bond Position:  [6.17259789]


portfolio before change:  [6.48047171]
curr_Stock_Price:  97.8007679890161
curr_Factors:  [97.80076799 -0.48155307 -0.9573399 ]
mat_Sqrt:  [[23.19738281  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00067116 -0.02807944 -0.22890762]
Stock Position:  0.0006711632337649112
Bond Position:  [6.41483143]


portfolio before change:  [6.48063674]
curr_Stock_Price:  96.85186054979785
curr_Factors:  [96.85186055 -0.52844134 -0.94695729]
mat_Sqrt:  [[22.1488145   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01098305 -0.0406348   0.03743952]
Stock Position:  0.010983047545573495
Bond Position:  [5.41690815]


portfolio before change:  [6.47392752]
curr_Stock_Price:  96.17933487803276
curr_Factors:  [96.17933488 -0.40392294 -0.92477191]
mat_Sqrt:  [[25.47046801  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0016516  -0.02475159  0.03633308]
Stock Position:  -0.0016516024358060495
Bond Position:  [6.63277754]


portfolio before change:  [6.47279426]
curr_Stock_Price:  97.36751708698381
curr_Factors:  [97.36751709 -0.50940606 -0.93124852]
mat_Sqrt:  [[23.05397215  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00836351  0.03704485  0.05312728]
Stock Position:  -0.008363508507100728
Bond Position:  [7.28712832]


portfolio before change:  [6.47545705]
curr_Stock_Price:  97.1580548137241
curr_Factors:  [97.15805481 -0.28611138 -0.9107272 ]
mat_Sqrt:  [[29.35610428  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00481153 -0.02985367 -0.1656481 ]
Stock Position:  0.004811527692623879
Bond Position:  [6.00797838]


portfolio before change:  [6.47647424]
curr_Stock_Price:  97.21336849232206
curr_Factors:  [97.21336849 -0.46231638 -0.90819982]
mat_Sqrt:  [[24.68984541  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00027716 -0.00400094 -0.26092167]
Stock Position:  -0.00027715786958233056
Bond Position:  [6.50341769]


portfolio before change:  [6.47735405]
curr_Stock_Price:  96.9722359003959
curr_Factors:  [96.9722359  -0.29457296 -0.9436969 ]
mat_Sqrt:  [[28.11082809  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00109844  0.0095045  -0.15536747]
Stock Position:  -0.0010984428480115215
Bond Position:  [6.58387251]


portfolio before change:  [6.47590957]
curr_Stock_Price:  99.03653172044433
curr_Factors:  [99.03653172 -0.5220051  -0.98515428]
mat_Sqrt:  [[21.94039391  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00042917  0.00693212 -0.00691252]
Stock Position:  -0.0004291734121266347
Bond Position:  [6.51841342]


portfolio before change:  [6.47629921]
curr_Stock_Price:  100.0273112102268
curr_Factors:  [100.02731121  -0.64755317  -0.98799458]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [6.47629921]
Stock Price:  99.06207634434094
PL:  [6.47629921]
Settle:  Tensor("sub_106:0", shape=(), dtype=float64)
PL:  Tensor("sub_107:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  54
output_Z_Vals[:, i, :]:  [[ 1.19260232e+02 -2.92559343e+01 -2.92733494e+01]
 [-8.06475754e-02  1.88620925e-01  2.29105393e-02]
 [ 1.21808569e-01  5.51737552e-02 -8.67812584e-02]
 [ 8.53884579e-02  1.74142935e-01  3.80077163e-02]
 [ 2.29821824e-01 -1.87732293e-02 -3.67029938e-02]
 [ 6.17866758e-02  3.31434051e-02  9.24423625e-03]
 [-4.83401491e-02  3.82451533e-02 -1.84081259e-01]
 [ 1.43389993e-01 -6.02911987e-02  9.52955486e-02]
 [-1.58675871e-01 -3.69162330e-02  1.53334824e-01]
 [-7.98162350e-02  3.26907984e-01  1.46824248e-01]
 [ 5.57951919e-02  3.58928550e-02 -7.68313840e-02]
 [-5.12693703e-02  8.72113565e-02  8.09375270e-03]
 [-8.77508798e-02 -1.04453375e-02 -5.76031023e-02]
 [-5.39679658e-02 -8.78526021e-02  8.99718054e-02]
 [ 1.98881506e-01  2.02891082e-01 -2.01981955e-02]
 [-7.45908886e-02 -2.56534740e-01 -8.70619581e-02]
 [-6.79758494e-02 -6.36442170e-02 -5.27484001e-02]
 [-7.58371637e-02  1.95806512e-01  1.32907355e-01]
 [ 1.00636702e-01  6.67072973e-02  1.08931217e-01]
 [-2.44745148e-03 -2.12725012e-02  9.47164937e-02]
 [ 1.81764160e-02 -5.77044565e-02  2.30295875e-02]
 [ 1.20494965e-01 -6.52037232e-02  1.57151106e-01]
 [ 1.29104141e-04 -1.63446264e-01  1.09174627e-01]
 [-6.16371539e-02 -7.31357023e-04 -8.40361424e-02]
 [-2.36151961e-01  1.02832561e-01  4.65078797e-02]
 [-1.52080908e-03 -1.07159451e-01  8.87749280e-02]
 [-9.69751566e-02  5.89115968e-02  1.34529004e-03]
 [ 2.37887889e-02  6.97402527e-03  1.08343646e-02]
 [-6.71778905e-02 -6.16100588e-02 -2.18543150e-01]
 [ 1.07465590e-02 -3.02072242e-03 -1.04052256e-01]
 [ 6.35178550e-02  2.17498021e-02  3.78447730e-02]
 [ 3.60951022e-02 -7.06980839e-02 -8.96981762e-02]
 [ 3.35170144e-01 -4.08354470e-01 -4.03438511e-01]
 [-4.00097164e-02 -7.98405388e-02 -5.65434221e-03]
 [-4.19174217e-02 -9.28528124e-03  2.56324491e-02]
 [ 7.96891339e-02 -1.60850363e-01 -1.36408897e-01]
 [-1.21848725e-01 -2.76214554e-01  2.74110970e-02]
 [-2.09263508e-02  1.43413191e-02 -8.00254682e-02]
 [-4.95322832e-02  9.43778490e-02  1.50791480e-02]
 [-3.88868982e-01  2.06741580e-01  2.32561518e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.26023247 -29.25593426 -29.27334937]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  8.31486419  -9.25153874 -83.50871763]
init_Out:  [2.49911038]
Stock Position:  8.31486419409362
Bond position:  [-828.98730903]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [8.36444926]
curr_Stock_Price:  100.71786725971413
curr_Factors:  [100.71786726  -1.19591731  -1.00799602]
mat_Sqrt:  [[11.1162709   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0063961   0.05964717  0.06535739]
Stock Position:  -0.006396102652352668
Bond Position:  [9.00865108]


portfolio before change:  [8.36045046]
curr_Stock_Price:  101.5191292091379
curr_Factors:  [101.51912921  -1.30129352  -1.03686035]
mat_Sqrt:  [[ 9.79716813  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01077036  0.01744747 -0.24756278]
Stock Position:  0.010770357099748457
Bond Position:  [7.26705319]


portfolio before change:  [8.36245179]
curr_Stock_Price:  101.62060128945518
curr_Factors:  [101.62060129  -1.20885381  -0.99152659]
mat_Sqrt:  [[11.25560112  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00867507 0.05506883 0.10842544]
Stock Position:  0.008675067696776855
Bond Position:  [7.4808862]


portfolio before change:  [8.36450643]
curr_Stock_Price:  101.74964553106363
curr_Factors:  [101.74964553  -1.29221944  -1.01028484]
mat_Sqrt:  [[10.17578685  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.02180128 -0.00593662 -0.10470343]
Stock Position:  0.02180127565224054
Bond Position:  [6.14623436]


portfolio before change:  [8.35847555]
curr_Stock_Price:  101.4377735942911
curr_Factors:  [101.43777359  -1.29071239  -0.99380011]
mat_Sqrt:  [[10.32876834  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00624754 0.01048086 0.02637123]
Stock Position:  0.006247541291050827
Bond Position:  [7.72473887]


portfolio before change:  [8.36705277]
curr_Stock_Price:  102.65610415743582
curr_Factors:  [102.65610416  -1.65925896  -0.99449   ]
mat_Sqrt:  [[ 7.22563881  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01175371  0.01209418 -0.52513259]
Stock Position:  -0.011753714130550829
Bond Position:  [9.57364327]


portfolio before change:  [8.37116352]
curr_Stock_Price:  102.40818505938255
curr_Factors:  [102.40818506  -1.75328071  -0.98750095]
mat_Sqrt:  [[ 6.60736527  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.02440994 -0.01906575  0.27185167]
Stock Position:  0.024409942095630188
Bond Position:  [5.87138566]


portfolio before change:  [8.36986496]
curr_Stock_Price:  102.32491835714579
curr_Factors:  [102.32491836  -1.6660159   -0.96589437]
mat_Sqrt:  [[ 7.36134712  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01743291 -0.01167394  0.43742157]
Stock Position:  -0.01743291027786913
Bond Position:  [10.15368608]


portfolio before change:  [8.37731708]
curr_Stock_Price:  101.97025364211692
curr_Factors:  [101.97025364  -1.59195426  -0.97576757]
mat_Sqrt:  [[ 7.82214886  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00529332  0.10337738  0.41884871]
Stock Position:  -0.00529331950569274
Bond Position:  [8.91707822]


portfolio before change:  [8.38099751]
curr_Stock_Price:  101.48554415210363
curr_Factors:  [101.48554415  -1.11195134  -1.00664384]
mat_Sqrt:  [[12.1985999   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00336422  0.01135032 -0.21917855]
Stock Position:  0.0033642222251204557
Bond Position:  [8.03957759]


portfolio before change:  [8.38264821]
curr_Stock_Price:  101.67747335729742
curr_Factors:  [101.67747336  -1.15869077  -1.00431053]
mat_Sqrt:  [[11.69082658  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00405151  0.02757865  0.02308922]
Stock Position:  -0.004051505858232102
Bond Position:  [8.79459509]


portfolio before change:  [8.38573907]
curr_Stock_Price:  101.18593583127235
curr_Factors:  [101.18593583  -1.02342201  -1.01192785]
mat_Sqrt:  [[13.21840165  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00754847 -0.00330311 -0.16432562]
Stock Position:  -0.007548474009505292
Bond Position:  [9.14953848]


portfolio before change:  [8.39422849]
curr_Stock_Price:  100.21280573916532
curr_Factors:  [100.21280574  -0.68072946  -0.98479598]
mat_Sqrt:  [[18.94936712  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00199853 -0.02778143  0.25666452]
Stock Position:  -0.0019985307236562496
Bond Position:  [8.59450686]


portfolio before change:  [8.39735158]
curr_Stock_Price:  99.18769304645403
curr_Factors:  [99.18769305 -0.60430095 -0.99279141]
mat_Sqrt:  [[20.0839621   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00995805  0.06415979 -0.05761983]
Stock Position:  0.009958054622534499
Bond Position:  [7.40963512]


portfolio before change:  [8.39523275]
curr_Stock_Price:  98.88190017841646
curr_Factors:  [98.88190018 -0.74799032 -1.02085884]
mat_Sqrt:  [[16.86224414  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00587028 -0.08112341 -0.24836353]
Stock Position:  -0.005870276462062698
Bond Position:  [8.97569684]


portfolio before change:  [8.39575949]
curr_Stock_Price:  98.98330649017514
curr_Factors:  [98.98330649 -0.99861553 -0.97637085]
mat_Sqrt:  [[13.73524061  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00585256 -0.02012607 -0.1504765 ]
Stock Position:  -0.0058525627921661985
Bond Position:  [8.97506551]


portfolio before change:  [8.39569874]
curr_Stock_Price:  99.18538984661103
curr_Factors:  [99.18538985 -1.10742997 -1.0151437 ]
mat_Sqrt:  [[11.87478267  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00367601  0.06191946  0.37914769]
Stock Position:  -0.0036760134627904888
Bond Position:  [8.76030557]


portfolio before change:  [8.39912382]
curr_Stock_Price:  98.55155808123031
curr_Factors:  [98.55155808 -1.06523181 -0.96983161]
mat_Sqrt:  [[12.87794841  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00967503 0.0210947  0.31075044]
Stock Position:  0.009675032417005063
Bond Position:  [7.4456343]


portfolio before change:  [8.40263613]
curr_Stock_Price:  98.81838359427567
curr_Factors:  [98.81838359 -1.3922844  -0.96990429]
mat_Sqrt:  [[ 9.3100547   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00175479 -0.00672696  0.27019979]
Stock Position:  0.0017547929368309895
Bond Position:  [8.22923033]


portfolio before change:  [8.40285819]
curr_Stock_Price:  98.35869621743994
curr_Factors:  [98.35869622 -1.41865517 -0.9509395 ]
mat_Sqrt:  [[ 9.19837     0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00232513 -0.01824775  0.065697  ]
Stock Position:  0.0023251280615236253
Bond Position:  [8.17416163]


portfolio before change:  [8.40521412]
curr_Stock_Price:  98.93247027416847
curr_Factors:  [98.93247027 -1.37979956 -0.95942128]
mat_Sqrt:  [[ 9.5373595   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01582091 -0.02061923  0.44830836]
Stock Position:  0.015820914262439
Bond Position:  [6.84001199]


portfolio before change:  [8.41126679]
curr_Stock_Price:  99.26099792650862
curr_Factors:  [99.26099793 -1.55511748 -0.96481904]
mat_Sqrt:  [[ 7.9870079   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00227796 -0.05168625  0.31144482]
Stock Position:  0.002277964077492511
Bond Position:  [8.1851538]


portfolio before change:  [8.41306073]
curr_Stock_Price:  99.59934066710763
curr_Factors:  [99.59934067 -1.35026758 -0.97481659]
mat_Sqrt:  [[ 9.73834683  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-8.09273325e-03 -2.31275397e-04 -2.39731723e-01]
Stock Position:  -0.008092733247509525
Bond Position:  [9.21909162]


portfolio before change:  [8.4120953]
curr_Stock_Price:  99.86104314889168
curr_Factors:  [99.86104315 -1.2977022  -0.98603652]
mat_Sqrt:  [[10.1760908   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02201272  0.03251851  0.13267404]
Stock Position:  -0.02201272170888615
Bond Position:  [10.61030865]


portfolio before change:  [8.41183656]
curr_Stock_Price:  99.93305187340822
curr_Factors:  [99.93305187 -1.047041   -0.97469828]
mat_Sqrt:  [[13.23362841  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00104533 -0.03388679  0.25325016]
Stock Position:  0.0010453257150342256
Bond Position:  [8.30737397]


portfolio before change:  [8.41367834]
curr_Stock_Price:  100.70151193676718
curr_Factors:  [100.70151194  -1.40302722  -0.99313011]
mat_Sqrt:  [[ 9.17060697  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01037875  0.01862948  0.00383774]
Stock Position:  -0.010378752440482305
Bond Position:  [9.4588344]


portfolio before change:  [8.41908275]
curr_Stock_Price:  100.29472085735281
curr_Factors:  [100.29472086  -1.2401953   -0.96348898]
mat_Sqrt:  [[11.07210385  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00236454 0.00220538 0.03090743]
Stock Position:  0.0023645382294992133
Bond Position:  [8.18193205]


portfolio before change:  [8.42012172]
curr_Stock_Price:  100.30155799264317
curr_Factors:  [100.30155799  -1.15773725  -0.97639423]
mat_Sqrt:  [[11.87042186  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00955135 -0.01948281 -0.62344278]
Stock Position:  -0.009551352964203093
Bond Position:  [9.37813731]


portfolio before change:  [8.41609912]
curr_Stock_Price:  100.84545387945637
curr_Factors:  [100.84545388  -1.39608144  -0.98045132]
mat_Sqrt:  [[ 9.365722    0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00112869 -0.00095524 -0.29683212]
Stock Position:  -0.0011286917859484856
Bond Position:  [8.52992256]


portfolio before change:  [8.4176408]
curr_Stock_Price:  100.424286512985
curr_Factors:  [100.42428651  -1.42388764  -0.95294507]
mat_Sqrt:  [[ 9.3238102   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00770119 0.00687789 0.1079606 ]
Stock Position:  0.0077011932807979026
Bond Position:  [7.64425396]


portfolio before change:  [8.41083256]
curr_Stock_Price:  99.4161535510481
curr_Factors:  [99.41615355 -1.41974392 -0.9827226 ]
mat_Sqrt:  [[ 8.99661221  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00177401 -0.0223567  -0.25588393]
Stock Position:  0.0017740146660637772
Bond Position:  [8.23446685]


portfolio before change:  [8.41191553]
curr_Stock_Price:  99.44636229271869
curr_Factors:  [99.44636229 -1.4785243  -0.98890725]
mat_Sqrt:  [[ 8.43328924  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0287284  -0.12913302 -1.15089778]
Stock Position:  0.028728403478659986
Bond Position:  [5.55498031]


portfolio before change:  [8.42931573]
curr_Stock_Price:  100.02786998658802
curr_Factors:  [100.02786999  -1.64574031  -1.01572479]
mat_Sqrt:  [[ 6.9865282   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00618696 -0.0252478  -0.01613026]
Stock Position:  -0.006186961072761597
Bond Position:  [9.04818427]


portfolio before change:  [8.42989827]
curr_Stock_Price:  100.11653311507798
curr_Factors:  [100.11653312  -2.02485323  -1.00868405]
mat_Sqrt:  [[ 4.82011389  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0076606  -0.00293626  0.07312224]
Stock Position:  -0.007660600077298935
Bond Position:  [9.19685099]


portfolio before change:  [8.42913578]
curr_Stock_Price:  100.36614414903032
curr_Factors:  [100.36614415  -1.91903102  -1.0074746 ]
mat_Sqrt:  [[ 5.3780149   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00886789 -0.05086535 -0.38913661]
Stock Position:  0.008867890277071607
Bond Position:  [7.53909982]


portfolio before change:  [8.42926727]
curr_Stock_Price:  100.27469558007742
curr_Factors:  [100.27469558  -1.79049863  -0.97983477]
mat_Sqrt:  [[ 6.28131889  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01964321 -0.08734671  0.07819623]
Stock Position:  -0.01964321340236351
Bond Position:  [10.39898451]


portfolio before change:  [8.4358412]
curr_Stock_Price:  100.00620701203921
curr_Factors:  [100.00620701  -1.688349    -0.94657054]
mat_Sqrt:  [[ 7.17291922  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00514312  0.00453512 -0.22829039]
Stock Position:  -0.005143120771929176
Bond Position:  [8.9501852]


portfolio before change:  [8.43640675]
curr_Stock_Price:  100.11378509108313
curr_Factors:  [100.11378509  -1.79245913  -0.96019106]
mat_Sqrt:  [[ 6.38312126  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00689591  0.0298449   0.04301661]
Stock Position:  -0.006895911521341772
Bond Position:  [9.12678256]


portfolio before change:  [8.43606502]
curr_Stock_Price:  100.32879023063649
curr_Factors:  [100.32879023  -2.01202289  -0.99150258]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [8.43606502]
Stock Price:  99.69696656312942
PL:  [8.43606502]
Settle:  Tensor("sub_108:0", shape=(), dtype=float64)
PL:  Tensor("sub_109:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  55
output_Z_Vals[:, i, :]:  [[ 1.19260232e+02 -2.92559343e+01 -2.92733494e+01]
 [ 8.41406288e-02 -3.14558753e-01 -2.60688789e-01]
 [-7.16226897e-02 -2.50474424e-02  9.52710271e-02]
 [-7.15940374e-02  7.01663291e-02  1.05217117e-02]
 [-7.64636107e-02  7.69307612e-02 -7.01220625e-02]
 [ 3.45227081e-02  2.89001956e-02  6.31292974e-02]
 [ 6.37387878e-02  3.60309616e-02 -3.88681711e-02]
 [-7.92779755e-02  2.36982311e-02 -8.12443323e-02]
 [ 6.39992179e-02 -4.68290390e-02 -3.79403768e-02]
 [-3.57411162e-02 -1.06092339e-01 -1.31526444e-01]
 [ 7.70148998e-02  8.54458274e-02 -8.99074543e-02]
 [-9.92446085e-02 -1.03995878e-01  4.62574557e-03]
 [-1.13532932e-01  3.78508170e-02 -3.25736704e-02]
 [-9.17996515e-02 -1.13254106e-01  6.73082735e-02]
 [ 1.63813935e-01  1.09253292e-01 -8.12087646e-02]
 [-8.32106778e-02 -1.21878673e-01 -1.23778358e-01]
 [-6.75169526e-02 -6.44316468e-02 -4.48443192e-02]
 [-5.00399435e-02  1.48095635e-01  6.83557176e-02]
 [ 1.05510930e-01  4.87844514e-02  9.00293789e-02]
 [ 1.13154937e-01 -3.29772509e-02  2.83375445e-02]
 [-5.49922041e-02  4.04112664e-03 -4.70900582e-02]
 [ 4.18065900e-02 -3.43174594e-02  4.05863372e-02]
 [-7.67953570e-02  1.05026921e-01  2.50962523e-01]
 [ 6.87790147e-02 -1.25545363e-02 -3.25105680e-02]
 [ 5.42171678e-02  3.39456748e-02  7.76764507e-02]
 [ 7.37575230e-02 -2.29832383e-02  6.46900288e-02]
 [-1.79528750e-01  7.11370802e-02  7.54478539e-02]
 [-5.07806065e-02  7.36225950e-02  2.93687317e-02]
 [ 6.20848838e-02 -6.23725319e-02  9.08311027e-02]
 [ 4.24927277e-02  1.04193033e-02 -2.16071191e-02]
 [-2.01442661e-02  2.70169089e-01  2.05549982e-02]
 [ 1.81014422e-02 -9.96088388e-02 -7.67325096e-02]
 [ 1.53592194e-01 -7.58886173e-02  4.78364648e-02]
 [-5.23946117e-02 -8.77886645e-02 -1.40823591e-02]
 [-1.59338521e-01  1.32606314e-01  3.29042149e-02]
 [ 9.92526791e-02 -1.58866648e-01 -1.31295433e-01]
 [-1.53202194e-01 -2.40301215e-01  7.96501650e-03]
 [-5.63068221e-02 -4.80707263e-02  8.64004896e-02]
 [-3.02319855e-02  6.51355147e-02 -2.95033666e-02]
 [ 9.68683139e-02 -4.27351705e-03 -8.73301165e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.26023247 -29.25593426 -29.27334937]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  8.31486419  -9.25153874 -83.50871763]
init_Out:  [2.49911038]
Stock Position:  8.31486419409362
Bond position:  [-828.98730903]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-9.71362216]
curr_Stock_Price:  98.54368004538581
curr_Factors:  [98.54368005 -0.99201752 -1.02174418]
mat_Sqrt:  [[13.15416193  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00173374 -0.09947221 -0.74367255]
Stock Position:  0.0017337387648452816
Bond Position:  [-9.88447115]


portfolio before change:  [-9.71523261]
curr_Stock_Price:  98.3274875323251
curr_Factors:  [98.32748753 -0.81914756 -1.01945478]
mat_Sqrt:  [[15.63795971  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00337783 -0.0079207   0.27178172]
Stock Position:  -0.003377825230225679
Bond Position:  [-9.38309954]


portfolio before change:  [-9.71726549]
curr_Stock_Price:  98.58206445760659
curr_Factors:  [98.58206446 -0.80028852 -1.03071623]
mat_Sqrt:  [[15.79801967  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00428121  0.02218854  0.03001551]
Stock Position:  -0.004281208440309543
Bond Position:  [-9.29521512]


portfolio before change:  [-9.7134181]
curr_Stock_Price:  97.4119835574568
curr_Factors:  [97.41198356 -0.98162913 -1.01682063]
mat_Sqrt:  [[13.20373154  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00672468  0.02432764 -0.20003873]
Stock Position:  -0.006724680278168407
Bond Position:  [-9.05835366]


portfolio before change:  [-9.71223854]
curr_Stock_Price:  97.06818525348034
curr_Factors:  [97.06818525 -0.86591207 -1.04607303]
mat_Sqrt:  [[14.34538909  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00335684 0.00913904 0.18009031]
Stock Position:  0.0033568362267476248
Bond Position:  [-10.03808054]


portfolio before change:  [-9.71192381]
curr_Stock_Price:  97.53575666143479
curr_Factors:  [97.53575666 -0.83680448 -1.05734964]
mat_Sqrt:  [[14.67381965  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00386642  0.01139399 -0.11088007]
Stock Position:  0.0038664214481839584
Bond Position:  [-10.08903816]


portfolio before change:  [-9.71207202]
curr_Stock_Price:  97.82362009622939
curr_Factors:  [97.8236201  -0.82251501 -1.05153842]
mat_Sqrt:  [[15.01594489  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00634326  0.00749404 -0.23176747]
Stock Position:  -0.006343258477784835
Bond Position:  [-9.09155151]


portfolio before change:  [-9.71677591]
curr_Stock_Price:  98.38600786113798
curr_Factors:  [98.38600786 -0.63584039 -1.06348237]
mat_Sqrt:  [[17.98567907  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00306052 -0.01480864 -0.10823333]
Stock Position:  0.00306052110413669
Bond Position:  [-10.01788836]


portfolio before change:  [-9.71694329]
curr_Stock_Price:  98.7405016889981
curr_Factors:  [98.74050169 -0.58247942 -1.07000115]
mat_Sqrt:  [[18.91612332  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00345357 -0.03354934 -0.37520833]
Stock Position:  -0.0034535687054289533
Bond Position:  [-9.37593618]


portfolio before change:  [-9.71620714]
curr_Stock_Price:  98.18796858013671
curr_Factors:  [98.18796858 -0.43574297 -1.07890127]
mat_Sqrt:  [[21.59019877  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00281928  0.02702034 -0.25648094]
Stock Position:  0.002819280169858231
Bond Position:  [-9.99302653]


portfolio before change:  [-9.71583863]
curr_Stock_Price:  98.76177415168999
curr_Factors:  [98.76177415 -0.59027126 -1.06958936]
mat_Sqrt:  [[18.78108069  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00537698 -0.03288638  0.01319596]
Stock Position:  -0.005376982604465148
Bond Position:  [-9.18479829]


portfolio before change:  [-9.71804729]
curr_Stock_Price:  98.9590016586378
curr_Factors:  [98.95900166 -0.60015291 -1.07923814]
mat_Sqrt:  [[18.4546171   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00645934  0.01196948 -0.09292362]
Stock Position:  -0.0064593429183611795
Bond Position:  [-9.07883716]


portfolio before change:  [-9.72354091]
curr_Stock_Price:  99.63379071770532
curr_Factors:  [99.63379072 -0.72234006 -1.06052522]
mat_Sqrt:  [[16.75398417  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00483375 -0.03581409  0.19201177]
Stock Position:  -0.004833752695414886
Bond Position:  [-9.2419358]


portfolio before change:  [-9.72531143]
curr_Stock_Price:  99.76106437502834
curr_Factors:  [99.76106438 -0.39631126 -1.06438023]
mat_Sqrt:  [[23.15212305  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0064814   0.03454892 -0.231666  ]
Stock Position:  0.006481400106580019
Bond Position:  [-10.3719028]


portfolio before change:  [-9.72316417]
curr_Stock_Price:  100.29240469964049
curr_Factors:  [100.2924047   -0.34693793  -1.06430555]
mat_Sqrt:  [[24.45528845  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0045644  -0.03854142 -0.3531052 ]
Stock Position:  -0.004564400188349137
Bond Position:  [-9.2653895]


portfolio before change:  [-9.71984109]
curr_Stock_Price:  99.310604214937
curr_Factors:  [99.31060421 -0.31310694 -1.09689737]
mat_Sqrt:  [[24.24591261  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00323083 -0.02037508 -0.12792836]
Stock Position:  -0.003230828228688563
Bond Position:  [-9.39898558]


portfolio before change:  [-9.71679703]
curr_Stock_Price:  98.00474705207834
curr_Factors:  [98.00474705 -0.5074258  -1.08253122]
mat_Sqrt:  [[19.98653709  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00161424  0.04683195  0.19499984]
Stock Position:  -0.001614240529142479
Bond Position:  [-9.5585938]


portfolio before change:  [-9.71892316]
curr_Stock_Price:  98.5816326572062
curr_Factors:  [98.58163266 -0.56358684 -1.10191718]
mat_Sqrt:  [[18.64132589  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00671346 0.015427   0.25682876]
Stock Position:  0.006713455342543339
Bond Position:  [-10.38074655]


portfolio before change:  [-9.71290535]
curr_Stock_Price:  99.67130874232575
curr_Factors:  [99.67130874 -0.6081875  -1.11242503]
mat_Sqrt:  [[17.83682841  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00662045 -0.01042832  0.08083913]
Stock Position:  0.006620450798457979
Bond Position:  [-10.37277434]


portfolio before change:  [-9.7084549]
curr_Stock_Price:  100.5393953182626
curr_Factors:  [100.53939532  -0.77642291  -1.12726735]
mat_Sqrt:  [[14.98214837  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00430513  0.00127792 -0.13433483]
Stock Position:  -0.004305128939842264
Bond Position:  [-9.27561984]


portfolio before change:  [-9.71651982]
curr_Stock_Price:  102.14338896028305
curr_Factors:  [102.14338896  -0.77120738  -1.14432102]
mat_Sqrt:  [[15.04204367  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00327118 -0.01085213  0.11578152]
Stock Position:  0.0032711757433095743
Bond Position:  [-10.0506488]


portfolio before change:  [-9.71834032]
curr_Stock_Price:  101.97094667069376
curr_Factors:  [101.97094667  -0.79248659  -1.13556903]
mat_Sqrt:  [[14.82970582  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00154124  0.03321243  0.71592622]
Stock Position:  -0.0015412350930495032
Bond Position:  [-9.56117912]


portfolio before change:  [-9.72049464]
curr_Stock_Price:  102.59323974952747
curr_Factors:  [102.59323975  -0.86524129  -1.12753508]
mat_Sqrt:  [[13.98514466  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00442031 -0.00397009 -0.0927436 ]
Stock Position:  0.0044203093763474765
Bond Position:  [-10.1739885]


portfolio before change:  [-9.71700878]
curr_Stock_Price:  103.66956480286902
curr_Factors:  [103.6695648   -1.00121906  -1.14308922]
mat_Sqrt:  [[12.14479039  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00584195 0.01073456 0.22158929]
Stock Position:  0.005841951825452883
Bond Position:  [-10.32264139]


portfolio before change:  [-9.72635482]
curr_Stock_Price:  102.29063740544284
curr_Factors:  [102.29063741  -0.87823701  -1.15556334]
mat_Sqrt:  [[13.3834357   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00645342 -0.00726794  0.18454265]
Stock Position:  0.00645341727952282
Bond Position:  [-10.38647899]


portfolio before change:  [-9.72659604]
curr_Stock_Price:  102.45445284653647
curr_Factors:  [102.45445285  -0.79052903  -1.15687174]
mat_Sqrt:  [[14.61454953  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01110477  0.02249552  0.21523173]
Stock Position:  -0.011104773981677855
Bond Position:  [-8.5888625]


portfolio before change:  [-9.73269163]
curr_Stock_Price:  102.90668262654252
curr_Factors:  [102.90668263  -0.7746425   -1.16309911]
mat_Sqrt:  [[14.82153166  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00289341  0.02328151  0.08378082]
Stock Position:  -0.0028934129743936714
Bond Position:  [-9.4349401]


portfolio before change:  [-9.73236082]
curr_Stock_Price:  102.3847206748066
curr_Factors:  [102.38472067  -0.66201982  -1.17200237]
mat_Sqrt:  [[16.35797093  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00483038 -0.01972393  0.25911585]
Stock Position:  0.004830382295236449
Bond Position:  [-10.22691816]


portfolio before change:  [-9.73063072]
curr_Stock_Price:  103.00755688391119
curr_Factors:  [103.00755688  -0.79933551  -1.14837368]
mat_Sqrt:  [[14.6889155   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0026109   0.00329487 -0.0616391 ]
Stock Position:  0.0026108951520934895
Bond Position:  [-9.99957266]


portfolio before change:  [-9.73239323]
curr_Stock_Price:  102.81127238232315
curr_Factors:  [102.81127238  -0.89388811  -1.14821682]
mat_Sqrt:  [[13.34030722  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00067261  0.08543497  0.05863769]
Stock Position:  -0.0006726051072880755
Bond Position:  [-9.66324184]


portfolio before change:  [-9.73347209]
curr_Stock_Price:  102.61930917953002
curr_Factors:  [102.61930918  -0.79655173  -1.13524252]
mat_Sqrt:  [[14.86830648  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-8.97243323e-06 -3.14990806e-02 -2.18896492e-01]
Stock Position:  -8.972433226341187e-06
Bond Position:  [-9.73255135]


portfolio before change:  [-9.73468658]
curr_Stock_Price:  102.37920249627885
curr_Factors:  [102.3792025   -0.75721647  -1.1353293 ]
mat_Sqrt:  [[15.42728697  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01046181 -0.02399809  0.13646412]
Stock Position:  0.010461809409604063
Bond Position:  [-10.80575829]


portfolio before change:  [-9.74279088]
curr_Stock_Price:  101.73366442145436
curr_Factors:  [101.73366442  -0.72745068  -1.1616571 ]
mat_Sqrt:  [[15.38280732  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00374027 -0.02776121 -0.04017305]
Stock Position:  -0.0037402701345909347
Bond Position:  [-9.3622795]


portfolio before change:  [-9.74824681]
curr_Stock_Price:  102.87945592277661
curr_Factors:  [102.87945592  -0.67264784  -1.14206069]
mat_Sqrt:  [[16.75755903  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00890333  0.0419338   0.09386657]
Stock Position:  -0.008903331044175537
Bond Position:  [-8.83227696]


portfolio before change:  [-9.74876883]
curr_Stock_Price:  102.81407787980406
curr_Factors:  [102.81407788  -0.51635702  -1.12577266]
mat_Sqrt:  [[19.90145032  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00343443 -0.05023805 -0.37454932]
Stock Position:  0.00343443270745708
Bond Position:  [-10.10187687]


portfolio before change:  [-9.74796242]
curr_Stock_Price:  103.41657205645322
curr_Factors:  [103.41657206  -0.16364974  -1.15731319]
mat_Sqrt:  [[27.59962798  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00571678 -0.07598992  0.02272198]
Stock Position:  -0.00571677606463549
Bond Position:  [-9.15675304]


portfolio before change:  [-9.75768393]
curr_Stock_Price:  104.91686624141796
curr_Factors:  [104.91686624  -0.14581416  -1.14711327]
mat_Sqrt:  [[28.79612587  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00138601 -0.0152013   0.24647655]
Stock Position:  -0.001386005084385836
Bond Position:  [-9.61226862]


portfolio before change:  [-9.75945922]
curr_Stock_Price:  105.33077429700546
curr_Factors:  [105.3307743   -0.30074642  -1.11327291]
mat_Sqrt:  [[25.61264806  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00134982  0.02059766 -0.08416489]
Stock Position:  -0.0013498230716357269
Bond Position:  [-9.61728131]


portfolio before change:  [-9.76009921]
curr_Stock_Price:  104.91423937623487
curr_Factors:  [104.91423938  -0.15675589  -1.09225848]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-9.76009921]
Stock Price:  104.50206470511601
PL:  [-14.26216391]
Settle:  Tensor("sub_110:0", shape=(), dtype=float64)
PL:  Tensor("sub_111:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  56
output_Z_Vals[:, i, :]:  [[ 1.19260232e+02 -2.92559343e+01 -2.92733494e+01]
 [ 4.03706775e-03 -1.27034308e-01 -3.91946428e-02]
 [-3.89381526e-02 -1.46852112e-03  2.97743104e-02]
 [-1.27602157e-01  6.02517320e-03  5.36233024e-03]
 [ 1.67717855e-02  3.74204105e-02 -7.16200103e-02]
 [ 5.50536990e-02  2.83187218e-02  3.67426570e-02]
 [-3.18041430e-02  1.06526340e-02  1.03849574e-01]
 [-8.56535155e-02  2.78362167e-01  3.71621571e-02]
 [ 2.28645327e-02  3.52788241e-02 -2.29534657e-02]
 [-2.94446054e-02  3.35199949e-01  1.33374326e-01]
 [ 2.17791529e-02 -1.24425955e-01 -2.73039082e-02]
 [-1.26926008e-01  1.27862628e-01  5.47830605e-02]
 [-2.70307353e-02 -1.21283044e-01 -4.35339719e-02]
 [ 3.11545145e-01  2.40815286e-01  3.27641266e-01]
 [ 9.24770197e-02 -2.62116386e-02 -1.42804969e-01]
 [-7.20190859e-02 -8.27373564e-02 -1.14646652e-01]
 [-7.93885483e-02 -2.25947225e-02 -6.29488040e-02]
 [ 2.91920301e-02 -2.13074640e-01 -8.81499023e-02]
 [ 3.75684735e-02  5.63003492e-02  3.12505747e-02]
 [ 1.75917046e-01 -2.26009941e-01 -2.30378913e-02]
 [ 1.71327077e-01  1.29905999e-02  2.40240809e-01]
 [-3.79910440e-02  2.07931003e-02 -3.71441385e-02]
 [-1.24373838e-01  2.84627433e-01  2.79518563e-01]
 [ 2.25932833e-01 -3.33113769e-02  4.74370682e-02]
 [-2.79429715e-02  7.28319667e-04 -7.83318097e-03]
 [ 1.02472119e-01  2.27395844e-03  5.62821294e-02]
 [-1.16001775e-01  7.48109065e-02  9.12253570e-02]
 [-4.26066799e-02  6.72180492e-02  2.69573383e-02]
 [ 6.06640598e-02 -7.98569827e-02 -3.52230801e-02]
 [-4.24011665e-02 -1.15829752e-01  1.87280858e-02]
 [-8.59573052e-02  5.15530426e-01 -1.32122256e-02]
 [ 5.20251847e-02  2.73734525e-02  1.10974717e-01]
 [ 1.43388476e-01 -1.50406979e-01 -8.10028682e-02]
 [-3.79719558e-01  3.38240321e-02  4.33139976e-02]
 [ 5.99478939e-02  3.25886750e-01 -1.71194618e-02]
 [ 8.47165236e-02 -1.65012150e-01 -1.38726811e-01]
 [-2.84234650e-01 -5.09585311e-01  1.36576468e-01]
 [-6.05638014e-02 -7.09055875e-02  1.08404777e-01]
 [-2.12903865e-02  4.63839529e-02 -3.51138150e-02]
 [ 2.84577660e-01 -1.87674318e-02 -2.87234861e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.26023247 -29.25593426 -29.27334937]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  8.31486419  -9.25153874 -83.50871763]
init_Out:  [2.49911038]
Stock Position:  8.31486419409362
Bond position:  [-828.98730903]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [0.39179434]
curr_Stock_Price:  99.75902358700466
curr_Factors:  [99.75902359 -0.86827792 -0.99106624]
mat_Sqrt:  [[15.53993806  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00046612 -0.04017178 -0.11181141]
Stock Position:  -0.00046612263960291416
Bond Position:  [0.43829428]


portfolio before change:  [0.39176323]
curr_Stock_Price:  99.94330454133626
curr_Factors:  [99.94330454 -0.71764021 -1.00256553]
mat_Sqrt:  [[17.89278088  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00183864 -0.00046439  0.08493782]
Stock Position:  -0.0018386417510900973
Bond Position:  [0.57552317]


portfolio before change:  [0.39313326]
curr_Stock_Price:  99.23730525990229
curr_Factors:  [99.23730526 -0.56983002 -1.00994101]
mat_Sqrt:  [[20.44509432  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00618006  0.00190533  0.01529724]
Stock Position:  -0.006180064761937859
Bond Position:  [1.00642623]


portfolio before change:  [0.39570211]
curr_Stock_Price:  98.84199514315381
curr_Factors:  [98.84199514 -0.49841845 -0.99260097]
mat_Sqrt:  [[22.2535855   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 1.40139347e-04  1.18333728e-02 -2.04311954e-01]
Stock Position:  0.00014013934705855765
Bond Position:  [0.38185046]


portfolio before change:  [0.39593114]
curr_Stock_Price:  100.1356696449644
curr_Factors:  [100.13566964  -0.49513653  -0.98064214]
mat_Sqrt:  [[22.89107954  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00276461 0.00895517 0.10481657]
Stock Position:  0.0027646118036443036
Bond Position:  [0.11909489]


portfolio before change:  [0.39499929]
curr_Stock_Price:  99.79322034657949
curr_Factors:  [99.79322035 -0.10885875 -0.97529878]
mat_Sqrt:  [[33.74872794  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00030611  0.00336866  0.29625393]
Stock Position:  -0.00030611191551631643
Bond Position:  [0.42554718]


portfolio before change:  [0.39468496]
curr_Stock_Price:  100.99383487228796
curr_Factors:  [100.99383487  -0.30165599  -0.98005334]
mat_Sqrt:  [[28.03209609  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00252855  0.08802585  0.10601329]
Stock Position:  -0.002528549470998152
Bond Position:  [0.65005287]


portfolio before change:  [0.3923595]
curr_Stock_Price:  101.9456553937069
curr_Factors:  [101.94565539  -0.15192692  -1.01825632]
mat_Sqrt:  [[31.63476386  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00060345  0.01115614 -0.06547985]
Stock Position:  0.000603452313847719
Bond Position:  [0.33084016]


portfolio before change:  [0.39221198]
curr_Stock_Price:  101.63266222726867
curr_Factors:  [101.63266223  -0.3573748   -1.00245653]
mat_Sqrt:  [[26.0895182   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [2.46656163e-04 1.05999531e-01 3.80479829e-01]
Stock Position:  0.00024665616275547706
Bond Position:  [0.36714366]


portfolio before change:  [0.39265966]
curr_Stock_Price:  103.26158703151562
curr_Factors:  [103.26158703  -0.45034394  -0.99499561]
mat_Sqrt:  [[24.33524952  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00053392 -0.03934694 -0.07789045]
Stock Position:  0.0005339210367837294
Bond Position:  [0.33752613]


portfolio before change:  [0.39333572]
curr_Stock_Price:  104.4487755040236
curr_Factors:  [104.4487755   -0.42351113  -0.97099763]
mat_Sqrt:  [[25.89857643  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00434163  0.04043371  0.15628082]
Stock Position:  -0.004341631040496922
Bond Position:  [0.84681377]


portfolio before change:  [0.3997971]
curr_Stock_Price:  102.98492080746465
curr_Factors:  [102.98492081  -0.56771676  -0.97210251]
mat_Sqrt:  [[22.08201133  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00176834 -0.03835307 -0.1241903 ]
Stock Position:  -0.0017683436626331755
Bond Position:  [0.58190983]


portfolio before change:  [0.39926683]
curr_Stock_Price:  103.32592333089421
curr_Factors:  [103.32592333  -0.77524763  -0.94241005]
mat_Sqrt:  [[18.54556376  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.0207404  0.07615248 0.93466933]
Stock Position:  0.020740402805922722
Bond Position:  [-1.74375444]


portfolio before change:  [0.40032356]
curr_Stock_Price:  103.38738361638862
curr_Factors:  [103.38738362  -0.62731079  -0.94385207]
mat_Sqrt:  [[21.48424931  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0029161  -0.00828885 -0.40738283]
Stock Position:  0.0029161035652627587
Bond Position:  [0.09883524]


portfolio before change:  [0.39575969]
curr_Stock_Price:  101.81809078982006
curr_Factors:  [101.81809079  -0.74895352  -0.95349399]
mat_Sqrt:  [[18.55501841  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00525774 -0.02616385 -0.32705499]
Stock Position:  -0.005257742297720452
Bond Position:  [0.93109297]


portfolio before change:  [0.39226152]
curr_Stock_Price:  102.50556506234018
curr_Factors:  [102.50556506  -0.71237829  -0.93589595]
mat_Sqrt:  [[19.72018729  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00470692 -0.00714508 -0.17957542]
Stock Position:  -0.004706918396020763
Bond Position:  [0.87474685]


portfolio before change:  [0.38790358]
curr_Stock_Price:  103.45465694692982
curr_Factors:  [103.45465695  -0.78740512  -0.91758982]
mat_Sqrt:  [[18.80529509  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00030294 -0.06738012 -0.25146714]
Stock Position:  0.0003029435605238102
Bond Position:  [0.35656265]


portfolio before change:  [0.38824596]
curr_Stock_Price:  104.43770158061
curr_Factors:  [104.43770158  -0.74361985  -0.91358148]
mat_Sqrt:  [[19.91333082  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00227994 0.01780373 0.08914919]
Stock Position:  0.0022799369668853814
Bond Position:  [0.15013458]


portfolio before change:  [0.39245304]
curr_Stock_Price:  106.27473317628072
curr_Factors:  [106.27473318  -0.66009581  -0.90341148]
mat_Sqrt:  [[22.25396678  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00743143 -0.07147062 -0.06572069]
Stock Position:  0.007431434879490293
Bond Position:  [-0.39732072]


portfolio before change:  [0.3759729]
curr_Stock_Price:  104.06379108282421
curr_Factors:  [104.06379108  -0.59770547  -0.93426017]
mat_Sqrt:  [[22.48927336  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00981363 0.00410799 0.68534016]
Stock Position:  0.009813631542078947
Bond Position:  [-0.6452708]


portfolio before change:  [0.39321837]
curr_Stock_Price:  105.82930848415738
curr_Factors:  [105.82930848  -0.90950784  -0.92235934]
mat_Sqrt:  [[16.94478844  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00265782  0.00657536 -0.10596189]
Stock Position:  -0.002657819199130189
Bond Position:  [0.67449354]


portfolio before change:  [0.39715719]
curr_Stock_Price:  104.37906127148419
curr_Factors:  [104.37906127  -0.86697073  -0.91193534]
mat_Sqrt:  [[17.62155778  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00340312  0.0900071   0.79738866]
Stock Position:  -0.0034031214641273336
Bond Position:  [0.75237181]


portfolio before change:  [0.3955463]
curr_Stock_Price:  104.8800527176861
curr_Factors:  [104.88005272  -0.94635655  -0.9233052 ]
mat_Sqrt:  [[16.16996621  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01451801 -0.01053398  0.13532475]
Stock Position:  0.014518013539200025
Bond Position:  [-1.12710372]


portfolio before change:  [0.39819376]
curr_Stock_Price:  105.072114094319
curr_Factors:  [105.07211409  -0.88168125  -0.91301916]
mat_Sqrt:  [[17.46059286  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00169084  0.00023031 -0.02234588]
Stock Position:  -0.0016908422308005151
Bond Position:  [0.57585412]


portfolio before change:  [0.39846952]
curr_Stock_Price:  104.95159659281694
curr_Factors:  [104.95159659  -1.01247579  -0.89965736]
mat_Sqrt:  [[15.50815657  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00735222 0.00071909 0.16055725]
Stock Position:  0.007352219658792195
Bond Position:  [-0.37315767]


portfolio before change:  [0.40250911]
curr_Stock_Price:  105.50737914345703
curr_Factors:  [105.50737914  -0.96512726  -0.90372424]
mat_Sqrt:  [[16.27987043  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.005863    0.02365729  0.26024055]
Stock Position:  -0.005862999224939059
Bond Position:  [1.02109879]


portfolio before change:  [0.39683461]
curr_Stock_Price:  106.4969994268344
curr_Factors:  [106.49699943  -1.37372972  -0.90830703]
mat_Sqrt:  [[10.87079748  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00325353  0.02125621  0.07690178]
Stock Position:  -0.0032535307298539
Bond Position:  [0.74332587]


portfolio before change:  [0.3963731]
curr_Stock_Price:  106.66740928519343
curr_Factors:  [106.66740929  -1.55516359  -0.91207115]
mat_Sqrt:  [[ 9.04743166  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00568253 -0.025253   -0.10048164]
Stock Position:  0.005682527615772662
Bond Position:  [-0.2097674]


portfolio before change:  [0.40056364]
curr_Stock_Price:  107.40946780624937
curr_Factors:  [107.40946781  -1.48792915  -0.90446133]
mat_Sqrt:  [[ 9.81839683  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00423379 -0.03662858  0.05342602]
Stock Position:  -0.004233789288938653
Bond Position:  [0.8553127]


portfolio before change:  [0.39755692]
curr_Stock_Price:  108.1448946682214
curr_Factors:  [108.14489467  -1.54315065  -0.89448697]
mat_Sqrt:  [[ 9.44829522  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00797427  0.16302503 -0.0376908 ]
Stock Position:  -0.007974274654536014
Bond Position:  [1.25993401]


portfolio before change:  [0.39605922]
curr_Stock_Price:  108.35246241822867
curr_Factors:  [108.35246242  -1.76546451  -0.88678652]
mat_Sqrt:  [[ 7.63802014  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00986965 0.00865625 0.31657998]
Stock Position:  0.009869649720481629
Bond Position:  [-0.67334163]


portfolio before change:  [0.40118653]
curr_Stock_Price:  108.88049331292899
curr_Factors:  [108.88049331  -1.79328992  -0.8981541 ]
mat_Sqrt:  [[ 7.38024523  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01666209 -0.04756286 -0.23107864]
Stock Position:  0.016662094409689493
Bond Position:  [-1.41299053]


portfolio before change:  [0.41086016]
curr_Stock_Price:  109.47167160622729
curr_Factors:  [109.47167161  -1.61018357  -0.90616299]
mat_Sqrt:  [[ 8.84028613  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.04185439  0.0106961   0.12356278]
Stock Position:  -0.04185439100250992
Bond Position:  [4.99273031]


portfolio before change:  [0.40393022]
curr_Stock_Price:  109.65215609983127
curr_Factors:  [109.6521561   -1.68987562  -0.88964338]
mat_Sqrt:  [[ 8.31278037  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00780338  0.10305444 -0.04883706]
Stock Position:  0.007803376876775145
Bond Position:  [-0.45172688]


portfolio before change:  [0.40132138]
curr_Stock_Price:  109.32507093326964
curr_Factors:  [109.32507093  -1.40136896  -0.87471812]
mat_Sqrt:  [[11.22606902  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00464441 -0.05218142 -0.39574898]
Stock Position:  0.004644407263307809
Bond Position:  [-0.10642877]


portfolio before change:  [0.3992013]
curr_Stock_Price:  108.87145548768473
curr_Factors:  [108.87145549  -0.93287229  -0.87513968]
mat_Sqrt:  [[17.85272056  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0150965  -0.16114502  0.38961465]
Stock Position:  -0.015096496375634403
Bond Position:  [2.04277884]


portfolio before change:  [0.39886406]
curr_Stock_Price:  108.91071010345145
curr_Factors:  [108.9107101   -1.08210963  -0.90018258]
mat_Sqrt:  [[15.00278977  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00268394 -0.02242232  0.30924866]
Stock Position:  -0.0026839370490465376
Bond Position:  [0.69117355]


portfolio before change:  [0.3992707]
curr_Stock_Price:  108.7913934928062
curr_Factors:  [108.79139349  -1.25004065  -0.91220898]
mat_Sqrt:  [[12.51818754  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00217766  0.01466789 -0.10016994]
Stock Position:  -0.0021776583416083096
Bond Position:  [0.63618119]


portfolio before change:  [0.39856641]
curr_Stock_Price:  109.15133073732892
curr_Factors:  [109.15133074  -1.11713037  -0.9018302 ]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [0.39856641]
Stock Price:  110.12005627315156
PL:  [-9.72148987]
Settle:  Tensor("sub_112:0", shape=(), dtype=float64)
PL:  Tensor("sub_113:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  57
output_Z_Vals[:, i, :]:  [[ 1.19260232e+02 -2.92559343e+01 -2.92733494e+01]
 [ 4.66493003e-02  2.10823362e-02 -8.56866771e-02]
 [-4.75118763e-02 -4.06716464e-02 -2.43432872e-02]
 [ 8.23001967e-02  1.46061285e-01  3.76325478e-02]
 [ 7.52408309e-02  1.81402118e-02 -6.87890614e-02]
 [ 6.54788224e-02  2.99302525e-02  1.62360255e-02]
 [ 5.89416735e-02  2.29329077e-02 -6.51245696e-02]
 [-1.06412307e-01 -5.34916025e-02 -1.17225596e-01]
 [-9.94325684e-03 -2.87021857e-02  3.86768996e-03]
 [-4.75520847e-02  4.24259399e-01  1.90910972e-01]
 [ 5.81503163e-02  1.24406922e-01 -8.40243747e-02]
 [-6.66630617e-02 -1.08500846e-01 -6.28021322e-03]
 [-7.51892085e-02 -3.22450200e-02 -3.57563618e-02]
 [-5.41083782e-02 -8.73894188e-02  9.05484959e-02]
 [ 1.57264024e-01  1.08961240e-01 -7.30636309e-02]
 [-6.91041483e-02 -8.73039390e-02 -1.19927314e-01]
 [-7.73588490e-02 -3.12655841e-02 -5.95038331e-02]
 [-7.90390527e-02  6.37285053e-02  8.77114141e-02]
 [ 5.37279244e-02  5.70822147e-02  4.53826343e-02]
 [ 1.11149462e-01 -3.12283942e-02  2.75554770e-02]
 [-3.60829559e-02 -2.10699693e-02 -8.45959793e-03]
 [ 9.92102975e-02 -6.31057059e-02  9.96278801e-02]
 [-7.95708666e-02  1.07144972e-01  3.22224299e-01]
 [ 3.44623182e-02 -2.12113769e-02 -7.18067666e-02]
 [ 9.11123079e-02  2.11739319e-02  1.08846200e-01]
 [ 8.44420178e-02 -1.07496875e-02  6.12390394e-02]
 [-1.88606721e-01  6.96833548e-02  7.57155758e-02]
 [-5.07806065e-02  7.36225950e-02  2.93687317e-02]
 [ 4.51805882e-02 -7.48699397e-02 -7.22144828e-02]
 [ 2.49278181e-02  8.98315447e-03 -1.21359783e-01]
 [ 1.80854491e-02  1.71544130e-01  1.13599603e-02]
 [ 2.64728960e-02 -8.67763017e-02 -7.86663930e-02]
 [ 1.75883243e-01 -7.97436290e-02  5.43340048e-02]
 [-4.25123588e-02 -7.81410110e-02  1.31036931e-02]
 [-1.81257196e-01  2.93441758e-03  1.40582214e-02]
 [ 2.01898411e-01 -2.32445982e-03 -1.51529227e-03]
 [ 2.62260940e-02  2.42958972e-02 -1.05269863e-01]
 [-1.48557125e-02  3.82850637e-02 -4.57165343e-02]
 [ 2.32118644e-01 -2.99791157e-01 -6.71580273e-02]
 [-6.14931104e-01  3.21061543e-01  3.61603642e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.26023247 -29.25593426 -29.27334937]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  8.31486419  -9.25153874 -83.50871763]
init_Out:  [2.49911038]
Stock Position:  8.31486419409362
Bond position:  [-828.98730903]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-2.91949785]
curr_Stock_Price:  99.36078591062692
curr_Factors:  [99.36078591 -0.99601674 -0.98945308]
mat_Sqrt:  [[13.64383421  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00217702  0.00666682 -0.24444024]
Stock Position:  0.0021770217757372985
Bond Position:  [-3.13580845]


portfolio before change:  [-2.9182815]
curr_Stock_Price:  100.09957356439578
curr_Factors:  [100.09957356  -0.95124595  -1.01015992]
mat_Sqrt:  [[14.08005927  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00380191 -0.0128615  -0.06944462]
Stock Position:  -0.0038019063229042696
Bond Position:  [-2.5377123]


portfolio before change:  [-2.92035485]
curr_Stock_Price:  100.56147797135591
curr_Factors:  [100.56147797  -0.83815593  -1.00682685]
mat_Sqrt:  [[15.89153347  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00589957 0.04618863 0.10735518]
Stock Position:  0.0058995687678789765
Bond Position:  [-3.5136242]


portfolio before change:  [-2.92793967]
curr_Stock_Price:  99.35027256318247
curr_Factors:  [99.35027256 -0.81211982 -1.00671763]
mat_Sqrt:  [[16.11602731  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00382648  0.00573644 -0.19623605]
Stock Position:  0.0038264827649082673
Bond Position:  [-3.30810177]


portfolio before change:  [-2.92435187]
curr_Stock_Price:  100.39596960816492
curr_Factors:  [100.39596961  -0.83284305  -1.02006885]
mat_Sqrt:  [[15.74007747  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00441966 0.00946478 0.04631686]
Stock Position:  0.0044196595043494375
Bond Position:  [-3.36806787]


portfolio before change:  [-2.92840176]
curr_Stock_Price:  99.5748977159947
curr_Factors:  [99.57489772 -0.7813426  -1.01756219]
mat_Sqrt:  [[16.47765658  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00280624  0.00725202 -0.18578227]
Stock Position:  0.0028062425784498167
Bond Position:  [-3.20783308]


portfolio before change:  [-2.92921867]
curr_Stock_Price:  99.4266905533178
curr_Factors:  [99.42669055 -0.68380768 -1.01963419]
mat_Sqrt:  [[18.10120889  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00727697 -0.01691553 -0.334412  ]
Stock Position:  -0.007276974113320267
Bond Position:  [-2.20569321]


portfolio before change:  [-2.93836756]
curr_Stock_Price:  100.64603868178155
curr_Factors:  [100.64603868  -0.81536519  -1.03367127]
mat_Sqrt:  [[15.84055359  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00062465 -0.00907643  0.01103344]
Stock Position:  -0.0006246533697702894
Bond Position:  [-2.87549867]


portfolio before change:  [-2.93927365]
curr_Stock_Price:  101.5211309517012
curr_Factors:  [101.52113095  -0.82243109  -1.04007552]
mat_Sqrt:  [[15.76449648  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [1.50451036e-04 1.34162602e-01 5.44615863e-01]
Stock Position:  0.00015045103565343562
Bond Position:  [-2.95454761]


portfolio before change:  [-2.93984934]
curr_Stock_Price:  100.14961259167728
curr_Factors:  [100.14961259  -0.630786    -1.0233084 ]
mat_Sqrt:  [[19.15513445  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00230805  0.03934092 -0.23969815]
Stock Position:  0.0023080540442010377
Bond Position:  [-3.17100006]


portfolio before change:  [-2.94249066]
curr_Stock_Price:  99.17696469056266
curr_Factors:  [99.17696469 -0.44814092 -0.98391511]
mat_Sqrt:  [[23.68518495  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00298695 -0.03431098 -0.0179157 ]
Stock Position:  -0.0029869509046250428
Bond Position:  [-2.64625394]


portfolio before change:  [-2.94706598]
curr_Stock_Price:  100.59798370183553
curr_Factors:  [100.5979837   -0.50869469  -0.99040948]
mat_Sqrt:  [[22.46656127  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00370865 -0.01019677 -0.10200295]
Stock Position:  -0.0037086453560006183
Bond Position:  [-2.57398373]


portfolio before change:  [-2.9453367]
curr_Stock_Price:  100.04493987699298
curr_Factors:  [100.04493988  -0.39529059  -0.99959374]
mat_Sqrt:  [[24.79730935  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00152765 -0.02763496  0.25830965]
Stock Position:  -0.0015276507803803066
Bond Position:  [-2.79250297]


portfolio before change:  [-2.9465958]
curr_Stock_Price:  100.64063028408815
curr_Factors:  [100.64063028  -0.55783333  -1.00193108]
mat_Sqrt:  [[21.15320957  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00686247  0.03445657 -0.2084302 ]
Stock Position:  0.006862473496147652
Bond Position:  [-3.63723945]


portfolio before change:  [-2.93406444]
curr_Stock_Price:  102.53295678410386
curr_Factors:  [102.53295678  -0.68827484  -0.98592068]
mat_Sqrt:  [[19.220718    0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0049862  -0.02760793 -0.34211925]
Stock Position:  -0.004986202222713618
Bond Position:  [-2.42281438]


portfolio before change:  [-2.93198291]
curr_Stock_Price:  102.05475817845625
curr_Factors:  [102.05475818  -0.62664629  -0.98558638]
mat_Sqrt:  [[20.35398766  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00443708 -0.00988705 -0.16974787]
Stock Position:  -0.0044370809997824
Bond Position:  [-2.47915769]


portfolio before change:  [-2.92181365]
curr_Stock_Price:  99.6930311371805
curr_Factors:  [99.69303114 -0.66536635 -0.97553684]
mat_Sqrt:  [[19.32099991  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00307901  0.02015272  0.25021625]
Stock Position:  -0.003079011055859469
Bond Position:  [-2.61485771]


portfolio before change:  [-2.92488729]
curr_Stock_Price:  100.58512217667706
curr_Factors:  [100.58512218  -0.59729124  -0.99594057]
mat_Sqrt:  [[20.44569897  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00315301 0.01805098 0.12946402]
Stock Position:  0.0031530089722299737
Bond Position:  [-3.24203308]


portfolio before change:  [-2.92858469]
curr_Stock_Price:  99.54100215724421
curr_Factors:  [99.54100216 -0.44962616 -1.02026002]
mat_Sqrt:  [[22.8896184   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0050664  -0.00987529  0.07860811]
Stock Position:  0.005066396666740231
Bond Position:  [-3.43289889]


portfolio before change:  [-2.93080468]
curr_Stock_Price:  99.18752600179886
curr_Factors:  [99.187526   -0.40370456 -1.04437695]
mat_Sqrt:  [[23.31112588  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0016453  -0.00666291 -0.02413288]
Stock Position:  -0.0016452996993890849
Bond Position:  [-2.76761147]


portfolio before change:  [-2.93206152]
curr_Stock_Price:  99.74114522026319
curr_Factors:  [99.74114522 -0.60491262 -1.05073792]
mat_Sqrt:  [[19.04734539  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00619075 -0.01995578  0.28421061]
Stock Position:  0.00619075092510591
Bond Position:  [-3.54953411]


portfolio before change:  [-2.92666867]
curr_Stock_Price:  100.68393446011822
curr_Factors:  [100.68393446  -0.51873274  -1.03175033]
mat_Sqrt:  [[21.35964049  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-5.16424220e-04  3.38822152e-02  9.19216235e-01]
Stock Position:  -0.00051642421950336
Bond Position:  [-2.87467304]


portfolio before change:  [-2.92674934]
curr_Stock_Price:  100.14428503573465
curr_Factors:  [100.14428504  -0.48660663  -1.01023137]
mat_Sqrt:  [[22.41597793  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00085908 -0.00670763 -0.20484472]
Stock Position:  0.0008590813212019998
Bond Position:  [-3.01278142]


portfolio before change:  [-2.92582001]
curr_Stock_Price:  101.66445472903588
curr_Factors:  [101.66445473  -0.22837212  -1.03002958]
mat_Sqrt:  [[28.88365966  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00394262 0.00669579 0.31050791]
Stock Position:  0.003942615146557691
Bond Position:  [-3.32664383]


portfolio before change:  [-2.92085516]
curr_Stock_Price:  103.02921100732839
curr_Factors:  [103.02921101  -0.17024102  -1.02258213]
mat_Sqrt:  [[31.25531389  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00309275 -0.00339935  0.17469793]
Stock Position:  0.0030927486125905687
Bond Position:  [-3.2394986]


portfolio before change:  [-2.92387713]
curr_Stock_Price:  102.1830343432136
curr_Factors:  [102.18303434  -0.3433984   -1.05737859]
mat_Sqrt:  [[25.17845501  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00680551  0.02203581  0.21599546]
Stock Position:  -0.006805506035419831
Bond Position:  [-2.22846987]


portfolio before change:  [-2.92115309]
curr_Stock_Price:  101.74183114470026
curr_Factors:  [101.74183114  -0.43103876  -1.03777851]
mat_Sqrt:  [[23.42072409  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00183106  0.02328151  0.08378082]
Stock Position:  -0.0018310626024010278
Bond Position:  [-2.73485743]


portfolio before change:  [-2.91950786]
curr_Stock_Price:  100.65660889976951
curr_Factors:  [100.6566089   -0.23166716  -1.02864834]
mat_Sqrt:  [[28.54264561  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00099874 -0.02367595 -0.20600782]
Stock Position:  0.0009987418651481574
Bond Position:  [-3.02003783]


portfolio before change:  [-2.92151869]
curr_Stock_Price:  99.02125083128601
curr_Factors:  [99.02125083 -0.46502438 -1.00664222]
mat_Sqrt:  [[22.7295964   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 1.70394719e-05  2.84072287e-03 -3.46205679e-01]
Stock Position:  1.7039471905647833e-05
Bond Position:  [-2.92320596]


portfolio before change:  [-2.92189236]
curr_Stock_Price:  98.53737254214403
curr_Factors:  [98.53737254 -0.24057271 -0.9955017 ]
mat_Sqrt:  [[28.62731938  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00086748 0.05424702 0.0324068 ]
Stock Position:  0.0008674770176470283
Bond Position:  [-3.00737127]


portfolio before change:  [-2.92288736]
curr_Stock_Price:  97.82375223632566
curr_Factors:  [97.82375224 -0.31202188 -1.02458676]
mat_Sqrt:  [[25.70174222  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00031806 -0.02744108 -0.22441332]
Stock Position:  0.0003180574770032788
Bond Position:  [-2.95400093]


portfolio before change:  [-2.92328629]
curr_Stock_Price:  97.73050475286348
curr_Factors:  [97.73050475 -0.16492805 -1.01435231]
mat_Sqrt:  [[30.05212514  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00615315 -0.02521715  0.15499979]
Stock Position:  0.006153147335815546
Bond Position:  [-3.52463648]


portfolio before change:  [-2.9334697]
curr_Stock_Price:  96.147119472165
curr_Factors:  [96.14711947 -0.43295428 -1.01870567]
mat_Sqrt:  [[22.51585138  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00185892 -0.02471036  0.03738119]
Stock Position:  -0.0018589201939101165
Bond Position:  [-2.75473987]


portfolio before change:  [-2.92907637]
curr_Stock_Price:  93.59849412876329
curr_Factors:  [93.59849413 -0.35526472 -1.0018432 ]
mat_Sqrt:  [[24.09263936  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00740109  0.00092794  0.04010419]
Stock Position:  -0.007401090633307188
Bond Position:  [-2.23634543]


portfolio before change:  [-2.9419402]
curr_Stock_Price:  95.29882066676988
curr_Factors:  [95.29882067 -0.19199906 -1.01596656]
mat_Sqrt:  [[28.47572079  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00707723 -0.00073506 -0.00432271]
Stock Position:  0.007077225118050085
Bond Position:  [-3.61639141]


portfolio before change:  [-2.94522856]
curr_Stock_Price:  94.8980585581456
curr_Factors:  [ 9.48980586e+01  3.48263684e-02 -1.01352202e+00]
mat_Sqrt:  [[35.66278108  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 1.50445097e-04  7.68303730e-03 -3.00305618e-01]
Stock Position:  0.00015044509720934965
Bond Position:  [-2.95950551]


portfolio before change:  [-2.94538229]
curr_Stock_Price:  96.33536266340792
curr_Factors:  [ 9.63353627e+01 -3.31358365e-02 -1.03031258e+00]
mat_Sqrt:  [[33.26105017  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00069748  0.0121068  -0.13041655]
Stock Position:  -0.0006974838383020761
Bond Position:  [-2.87818993]


portfolio before change:  [-2.94440677]
curr_Stock_Price:  94.42088926998136
curr_Factors:  [94.42088927 -0.14993157 -1.02357367]
mat_Sqrt:  [[29.20258087  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00721407 -0.09480229 -0.19158316]
Stock Position:  0.007214071106701747
Bond Position:  [-3.62556578]


portfolio before change:  [-2.94143142]
curr_Stock_Price:  94.89615121565986
curr_Factors:  [94.89615122 -0.36388667 -1.03619507]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-2.94143142]
Stock Price:  95.15932054132617
PL:  [-2.94143142]
Settle:  Tensor("sub_114:0", shape=(), dtype=float64)
PL:  Tensor("sub_115:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  58
output_Z_Vals[:, i, :]:  [[ 1.19260232e+02 -2.92559343e+01 -2.92733494e+01]
 [-2.16002415e-01  7.18559319e-01  1.37399900e-01]
 [ 1.66910149e-01  1.84498357e-02 -1.92817068e-01]
 [ 8.18055688e-02  1.41563619e-01  3.75724593e-02]
 [ 2.45859614e-01 -6.14464085e-03 -1.25186129e-02]
 [-5.24286435e-02  3.24897126e-02  1.69353473e-01]
 [-5.85573374e-02  3.23400382e-02 -2.10438588e-01]
 [ 3.93366395e-01  3.53814745e-03  2.09202834e-01]
 [ 5.15623921e-02  5.18377493e-02  3.45903598e-02]
 [-3.44127806e-02  2.77775472e-01  1.07229764e-01]
 [ 5.42665275e-02  1.87198138e-02 -7.41209749e-02]
 [-6.35608832e-02  5.77987648e-02  1.47329311e-02]
 [-4.80657782e-02 -9.05984221e-02 -5.58131367e-02]
 [ 2.55843422e-01  2.08392969e-01  2.96413151e-01]
 [ 1.07086290e-01  2.76596821e-02 -1.00501458e-01]
 [-5.99394258e-02 -8.25739673e-02 -1.26626148e-01]
 [-8.04708127e-02 -1.61362948e-02 -7.69399134e-02]
 [-6.36450397e-03 -1.58454095e-01 -3.93627371e-02]
 [ 2.60725775e-02  5.81074277e-02  1.78671481e-02]
 [ 2.93503384e-01 -1.00513277e-01 -6.33654116e-02]
 [ 8.49449722e-02  2.38219413e-02  1.41442398e-01]
 [ 1.82807845e-02 -1.80698560e-02  1.76699678e-02]
 [-9.16787138e-02  1.51888906e-01  3.22811364e-01]
 [ 1.50785424e-02 -1.22713542e-02 -7.25205079e-02]
 [ 7.10919147e-02  2.80997888e-02  1.03144601e-01]
 [ 5.77252021e-02 -4.08715920e-02  6.98150506e-02]
 [-1.24994601e-01  6.07078511e-02  2.37362503e-02]
 [-5.07806065e-02  7.36225950e-02  2.93687317e-02]
 [ 6.17373959e-02 -6.66486672e-02  6.00022969e-02]
 [ 1.25279865e-02 -2.94134442e-03 -1.00683364e-01]
 [ 2.74690371e-02  1.26548672e-01  2.93688480e-02]
 [ 1.51957384e-02 -6.71087715e-02 -9.06718006e-02]
 [ 1.97030595e-01 -1.57284087e-01 -6.14073779e-02]
 [-4.61233770e-02 -8.16663056e-02  3.16979131e-03]
 [-1.97008608e-01  1.26605273e-01  2.03272648e-02]
 [ 1.42677768e-01 -1.14535459e-01 -7.55584344e-02]
 [ 3.05555037e-03 -4.82608006e-02 -8.72666076e-02]
 [-2.53568153e-02  2.33573797e-02 -6.13595194e-02]
 [-3.34798849e-02  3.74026384e-02  8.17619823e-03]
 [-8.02490210e-01  3.99261534e-01  4.92060571e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.26023247 -29.25593426 -29.27334937]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  8.31486419  -9.25153874 -83.50871763]
init_Out:  [2.49911038]
Stock Position:  8.31486419409362
Bond position:  [-828.98730903]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [17.42947547]
curr_Stock_Price:  101.80808665459871
curr_Factors:  [101.80808665  -1.12458015  -1.00059382]
mat_Sqrt:  [[12.1571268   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01393443  0.22722841  0.39196367]
Stock Position:  -0.013934431929873899
Bond Position:  [18.84811333]


portfolio before change:  [17.43081769]
curr_Stock_Price:  101.88085216100197
curr_Factors:  [101.88085216  -0.88416712  -1.03545435]
mat_Sqrt:  [[14.94209716  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00856827  0.00583435 -0.55005343]
Stock Position:  0.008568268640187029
Bond Position:  [16.55787518]


portfolio before change:  [17.43422164]
curr_Stock_Price:  102.0365535641659
curr_Factors:  [102.03655356  -0.92760316  -1.06486882]
mat_Sqrt:  [[13.91349365  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00669351 0.04476635 0.10718377]
Stock Position:  0.0066935145299228315
Bond Position:  [16.75123849]


portfolio before change:  [17.44524501]
curr_Stock_Price:  103.37058060170261
curr_Factors:  [103.3705806   -0.96765844  -1.07360848]
mat_Sqrt:  [[13.42412528  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01811258 -0.00194311 -0.03571212]
Stock Position:  0.018112584917006746
Bond Position:  [15.57293659]


portfolio before change:  [17.45543538]
curr_Stock_Price:  103.82571345569492
curr_Factors:  [103.82571346  -1.09040901  -1.07262218]
mat_Sqrt:  [[11.93747331  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00142582  0.01027415  0.48311832]
Stock Position:  -0.00142581512142193
Bond Position:  [17.60347165]


portfolio before change:  [17.45753805]
curr_Stock_Price:  103.8943810687148
curr_Factors:  [103.89438107  -0.98722187  -1.06587099]
mat_Sqrt:  [[13.33353054  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00755073  0.01022682 -0.60032272]
Stock Position:  -0.0075507321755073934
Bond Position:  [18.24201669]


portfolio before change:  [17.46137899]
curr_Stock_Price:  103.68770585689643
curr_Factors:  [103.68770586  -0.63435888  -1.10254421]
mat_Sqrt:  [[18.25575655  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.0238917  0.00111886 0.59679745]
Stock Position:  0.023891702210838056
Bond Position:  [14.9841032]


portfolio before change:  [17.45276918]
curr_Stock_Price:  103.2489368098609
curr_Factors:  [103.24893681  -0.57033596  -1.08476567]
mat_Sqrt:  [[19.72804657  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00303941 0.01639254 0.09867667]
Stock Position:  0.003039407089089528
Bond Position:  [17.13895363]


portfolio before change:  [17.45197384]
curr_Stock_Price:  102.28235309997238
curr_Factors:  [102.2823531   -0.45286851  -1.07297246]
mat_Sqrt:  [[22.2400826   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-2.40667492e-04  8.78403169e-02  3.05896669e-01]
Stock Position:  -0.0002406674923601357
Bond Position:  [17.47658988]


portfolio before change:  [17.45421116]
curr_Stock_Price:  102.06377692298956
curr_Factors:  [102.06377692  -0.39766475  -1.07814915]
mat_Sqrt:  [[23.33102404  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00169817  0.00591972 -0.21144651]
Stock Position:  0.0016981676563382958
Bond Position:  [17.28088975]


portfolio before change:  [17.45623415]
curr_Stock_Price:  101.9829522056852
curr_Factors:  [101.98295221  -0.38295775  -1.05775303]
mat_Sqrt:  [[24.14542415  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00244606  0.01827757  0.04202895]
Stock Position:  -0.0024460609244866672
Bond Position:  [17.70569066]


portfolio before change:  [17.45871435]
curr_Stock_Price:  101.87385850880314
curr_Factors:  [101.87385851  -0.53180388  -1.0567117 ]
mat_Sqrt:  [[20.80555013  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00297026 -0.02864974 -0.15921934]
Stock Position:  -0.0029702568719589192
Bond Position:  [17.76130588]


portfolio before change:  [17.45766851]
curr_Stock_Price:  102.97347266706706
curr_Factors:  [102.97347267  -0.68633952  -1.03927297]
mat_Sqrt:  [[18.33586383  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01754644 0.06589964 0.84558421]
Stock Position:  0.017546442839292416
Bond Position:  [15.65085036]


portfolio before change:  [17.47602063]
curr_Stock_Price:  103.90788674568557
curr_Factors:  [103.90788675  -0.78197366  -1.03828024]
mat_Sqrt:  [[16.83147923  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00518586  0.00874676 -0.28670268]
Stock Position:  0.0051858594874994645
Bond Position:  [16.93716893]


portfolio before change:  [17.4792553]
curr_Stock_Price:  104.12335494349635
curr_Factors:  [104.12335494  -0.86680709  -1.04242075]
mat_Sqrt:  [[15.43053696  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00569772 -0.02611218 -0.36122915]
Stock Position:  -0.005697723343346642
Bond Position:  [18.07252137]


portfolio before change:  [17.49002234]
curr_Stock_Price:  102.63015625297868
curr_Factors:  [102.63015625  -0.72420023  -1.04652076]
mat_Sqrt:  [[17.46870211  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00552947 -0.00510274 -0.21948816]
Stock Position:  -0.005529474572104103
Bond Position:  [18.05751318]


portfolio before change:  [17.49195935]
curr_Stock_Price:  102.68808515546988
curr_Factors:  [102.68808516  -0.70822382  -1.04816497]
mat_Sqrt:  [[17.73087214  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00104285 -0.05010758 -0.11229093]
Stock Position:  -0.0010428509114758858
Bond Position:  [17.59904772]


portfolio before change:  [17.4939817]
curr_Stock_Price:  102.85845865742526
curr_Factors:  [102.85845866  -0.48063306  -1.02695117]
mat_Sqrt:  [[22.77741824  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00137066 0.01837518 0.05097   ]
Stock Position:  0.0013706567126691492
Bond Position:  [17.35299806]


portfolio before change:  [17.4952858]
curr_Stock_Price:  102.2272606249427
curr_Factors:  [102.22726062  -0.50661894  -1.0155551 ]
mat_Sqrt:  [[22.3097618   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01245974 -0.03178509 -0.18076388]
Stock Position:  0.012459735524469596
Bond Position:  [16.22156117]


portfolio before change:  [17.50207222]
curr_Stock_Price:  102.6091784826566
curr_Factors:  [102.60917848  -0.34903477  -1.01640481]
mat_Sqrt:  [[26.19288512  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00436881 0.00753316 0.40349579]
Stock Position:  0.004368814666530042
Bond Position:  [17.05379174]


portfolio before change:  [17.50160262]
curr_Stock_Price:  102.01371879892613
curr_Factors:  [102.0137188   -0.46176565  -1.02406652]
mat_Sqrt:  [[23.08712569  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00092784 -0.00571419  0.0504075 ]
Stock Position:  0.0009278370183769644
Bond Position:  [17.40695052]


portfolio before change:  [17.50343295]
curr_Stock_Price:  101.64114845355913
curr_Factors:  [101.64114845  -0.54102434  -1.03250503]
mat_Sqrt:  [[21.07145086  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00103758  0.04803149  0.92089097]
Stock Position:  -0.001037582344746417
Bond Position:  [17.60889401]


portfolio before change:  [17.50643195]
curr_Stock_Price:  100.87228437193384
curr_Factors:  [100.87228437  -0.73204827  -1.01806027]
mat_Sqrt:  [[17.52707224  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-2.36715485e-06 -3.88054292e-03 -2.06880823e-01]
Stock Position:  -2.367154852673293e-06
Bond Position:  [17.50667073]


portfolio before change:  [17.50861959]
curr_Stock_Price:  101.22485713577144
curr_Factors:  [101.22485714  -0.40636336  -0.99816134]
mat_Sqrt:  [[24.84905333  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00373744 0.00888593 0.29424284]
Stock Position:  0.003737436203369609
Bond Position:  [17.13029814]


portfolio before change:  [17.51205805]
curr_Stock_Price:  101.57189587535535
curr_Factors:  [101.57189588  -0.29733654  -0.99913077]
mat_Sqrt:  [[27.77953424  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00255299 -0.01292473  0.19916291]
Stock Position:  0.00255298879379538
Bond Position:  [17.25274613]


portfolio before change:  [17.51309124]
curr_Stock_Price:  101.13181001036739
curr_Factors:  [101.13181001  -0.72152361  -1.00416366]
mat_Sqrt:  [[18.00658353  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00658548  0.01919751  0.06771292]
Stock Position:  -0.006585479665305704
Bond Position:  [18.17909272]


portfolio before change:  [17.50311757]
curr_Stock_Price:  102.99138589411983
curr_Factors:  [102.99138589  -0.67866105  -1.01743626]
mat_Sqrt:  [[18.88840118  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00227043  0.02328151  0.08378082]
Stock Position:  -0.0022704310224814493
Bond Position:  [17.73695241]


portfolio before change:  [17.50520792]
curr_Stock_Price:  103.0472826789664
curr_Factors:  [103.04728268  -0.53460104  -1.00897119]
mat_Sqrt:  [[22.01261523  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00328287 -0.02107616  0.17116985]
Stock Position:  0.003282865370127848
Bond Position:  [17.16691756]


portfolio before change:  [17.50232909]
curr_Stock_Price:  101.516662022488
curr_Factors:  [101.51666202  -0.87079694  -1.00406349]
mat_Sqrt:  [[15.57025741  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00052021 -0.00093013 -0.28722161]
Stock Position:  -0.0005202138985422879
Bond Position:  [17.55513947]


portfolio before change:  [17.50490572]
curr_Stock_Price:  100.78215932301731
curr_Factors:  [100.78215932  -0.9513716   -0.99135713]
mat_Sqrt:  [[14.44332866  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00254314 0.0400182  0.08378115]
Stock Position:  0.0025431395755173133
Bond Position:  [17.24860263]


portfolio before change:  [17.50662197]
curr_Stock_Price:  100.60915808737924
curr_Factors:  [100.60915809  -0.8862756   -0.97384914]
mat_Sqrt:  [[15.66013875  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00032218 -0.02122166 -0.25866141]
Stock Position:  -0.0003221750789124208
Bond Position:  [17.53903573]


portfolio before change:  [17.50916681]
curr_Stock_Price:  99.51558149202032
curr_Factors:  [99.51558149 -0.84934627 -0.98668919]
mat_Sqrt:  [[15.86759167  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01137128 -0.0497376  -0.17517816]
Stock Position:  0.011371278787516504
Bond Position:  [16.37754739]


portfolio before change:  [17.49852378]
curr_Stock_Price:  98.39958177222071
curr_Factors:  [98.39958177 -0.6782518  -1.0017464 ]
mat_Sqrt:  [[18.33915429  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00259472 -0.02582515  0.00904253]
Stock Position:  -0.002594719486665693
Bond Position:  [17.7538431]


portfolio before change:  [17.49976722]
curr_Stock_Price:  98.77570611093157
curr_Factors:  [98.77570611 -0.54601902 -1.01317305]
mat_Sqrt:  [[20.77311537  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00912672  0.0400361   0.05798803]
Stock Position:  -0.009126719070545075
Bond Position:  [18.40126534]


portfolio before change:  [17.5124405]
curr_Stock_Price:  97.6391546839949
curr_Factors:  [97.63915468 -0.43118878 -0.96464046]
mat_Sqrt:  [[24.17815034  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00514089 -0.03621929 -0.21554718]
Stock Position:  0.0051408884587010656
Bond Position:  [17.0104885]


portfolio before change:  [17.51384402]
curr_Stock_Price:  97.49853093579463
curr_Factors:  [97.49853094 -0.45094618 -0.97923908]
mat_Sqrt:  [[23.32794641  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00068603 -0.01526141 -0.24894734]
Stock Position:  -0.000686033804664088
Bond Position:  [17.5807313]


portfolio before change:  [17.51568984]
curr_Stock_Price:  98.01148934285114
curr_Factors:  [98.01148934 -0.51051202 -0.96706239]
mat_Sqrt:  [[22.36529223  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00166681  0.00738625 -0.17504163]
Stock Position:  -0.0016668098676974254
Bond Position:  [17.67905636]


portfolio before change:  [17.5161005]
curr_Stock_Price:  99.09101075921279
curr_Factors:  [99.09101076 -0.78829264 -0.96655588]
mat_Sqrt:  [[17.13614906  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00180001  0.01182775  0.02332442]
Stock Position:  -0.0018000073015131623
Bond Position:  [17.69446504]


portfolio before change:  [17.51943585]
curr_Stock_Price:  98.46690028173724
curr_Factors:  [98.46690028 -0.69221543 -0.9507116 ]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [17.51943585]
Stock Price:  98.48687550477932
PL:  [17.51943585]
Settle:  Tensor("sub_116:0", shape=(), dtype=float64)
PL:  Tensor("sub_117:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  59
output_Z_Vals[:, i, :]:  [[ 1.19260232e+02 -2.92559343e+01 -2.92733494e+01]
 [ 4.03706775e-03 -1.27034308e-01 -3.91946428e-02]
 [-6.64032114e-02 -1.62814959e-02  9.24833414e-02]
 [-1.19242228e-01  2.06915415e-02  6.06223615e-03]
 [ 5.25926558e-02  2.56084595e-02 -6.98856387e-02]
 [ 6.45543598e-02  2.93551014e-02 -6.33292219e-03]
 [-1.48639717e-02  2.43131998e-02  7.12194006e-02]
 [-8.96100117e-02  7.48787885e-03 -9.49863950e-02]
 [ 1.06974394e-01 -3.77605655e-02 -5.04789188e-02]
 [-6.37267106e-02  4.31808200e-01  2.02519920e-01]
 [ 5.96327420e-02  9.10385761e-02 -8.42207081e-02]
 [-4.46128500e-02  2.06827961e-02  2.33211293e-03]
 [-1.52815741e-02 -1.24981059e-01 -1.09988989e-02]
 [-2.87720915e-02 -6.89120973e-02  1.05833554e-01]
 [ 1.66279121e-01  6.56297382e-02 -1.33966279e-01]
 [-6.69087421e-02 -5.14125743e-01 -4.73101600e-02]
 [-6.69837033e-02 -3.41283554e-02 -5.32342166e-02]
 [-2.05445905e-02  1.39136912e-01  3.39227921e-02]
 [ 1.25799187e-02  4.60482130e-02 -3.65203170e-02]
 [-4.11748918e-02 -1.37830209e-02  1.10145195e-01]
 [ 9.20986669e-02 -1.05797834e-01  6.18295843e-02]
 [ 1.26749659e-01 -6.81318181e-02  1.97819911e-01]
 [-4.77871937e-02 -5.42278972e-03  2.77972276e-01]
 [-7.01868025e-02 -5.27907557e-04 -8.15450081e-02]
 [-5.24810122e-01  1.55469133e-01  6.14288910e-02]
 [-1.32806621e-01 -2.54752713e-01  1.30868906e-01]
 [ 8.52524884e-02  6.09777535e-02 -6.26045534e-02]
 [ 2.28481513e-02 -6.47579043e-03  1.23478870e-03]
 [-1.27435152e-01 -1.78112772e-01 -8.55590674e-02]
 [ 1.94770892e-01  2.70433064e-01  1.87930641e-01]
 [ 9.65021572e-02 -1.25985985e-01  8.82522544e-02]
 [ 1.22733801e-01  1.51810816e-01  1.09374306e-01]
 [ 3.81021177e-01 -2.77021113e-01 -1.58169317e-01]
 [-3.95349518e-02 -7.52342862e-02  2.12945320e-02]
 [-1.83995375e-01  1.38944886e-02  1.41852016e-02]
 [ 2.82791127e-01  1.28885112e-01  6.14536390e-02]
 [ 1.36976766e-02 -7.33377446e-02 -1.00327066e-01]
 [-5.39194357e-03  6.81367582e-02 -1.27718778e-03]
 [ 2.84886389e-01 -3.73742712e-01 -8.12231054e-02]
 [-2.85319315e-01  1.81850170e-01  1.34849385e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.26023247 -29.25593426 -29.27334937]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  8.31486419  -9.25153874 -83.50871763]
init_Out:  [2.49911038]
Stock Position:  8.31486419409362
Bond position:  [-828.98730903]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [0.7686113]
curr_Stock_Price:  99.80434206112899
curr_Factors:  [99.80434206 -0.70628255 -0.97826476]
mat_Sqrt:  [[18.51653996  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00039119 -0.04017178 -0.11181141]
Stock Position:  -0.00039119171084906666
Bond Position:  [0.80765393]


portfolio before change:  [0.7691024]
curr_Stock_Price:  98.80703100153893
curr_Factors:  [98.807031   -0.53179417 -0.97609009]
mat_Sqrt:  [[21.87368934  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00219193 -0.00514866  0.26382923]
Stock Position:  -0.0021919262945015727
Bond Position:  [0.98568013]


portfolio before change:  [0.76787003]
curr_Stock_Price:  99.42547914848419
curr_Factors:  [99.42547915 -0.55960751 -1.00835097]
mat_Sqrt:  [[20.72726392  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00566744  0.00654324  0.01729387]
Stock Position:  -0.005667440078198615
Bond Position:  [1.33135797]


portfolio before change:  [0.76926242]
curr_Stock_Price:  99.20916195104132
curr_Factors:  [99.20916195 -0.61589801 -1.03513305]
mat_Sqrt:  [[19.03347576  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00204842  0.00809811 -0.19936427]
Stock Position:  0.0020484181468848842
Bond Position:  [0.56604058]


portfolio before change:  [0.76823607]
curr_Stock_Price:  98.67357136107735
curr_Factors:  [98.67357136 -0.57727813 -0.99576388]
mat_Sqrt:  [[20.46620783  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00312806  0.0092829  -0.01806606]
Stock Position:  0.003128063756722988
Bond Position:  [0.45957885]


portfolio before change:  [0.76450146]
curr_Stock_Price:  97.46129964245927
curr_Factors:  [97.46129964 -0.39066696 -0.9846378 ]
mat_Sqrt:  [[24.63456684  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [1.22345027e-05 7.68850885e-03 2.03169126e-01]
Stock Position:  1.223450266097805e-05
Bond Position:  [0.76330907]


portfolio before change:  [0.76460932]
curr_Stock_Price:  98.47828323392322
curr_Factors:  [98.47828323 -0.54343617 -0.98442514]
mat_Sqrt:  [[21.36971503  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00509158  0.00236788 -0.27096975]
Stock Position:  -0.005091583676241079
Bond Position:  [1.26601974]


portfolio before change:  [0.76192184]
curr_Stock_Price:  99.0371938807294
curr_Factors:  [99.03719388 -0.46340434 -1.01916823]
mat_Sqrt:  [[22.48667488  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00425565 -0.01194094 -0.1440023 ]
Stock Position:  0.0042556516346544835
Bond Position:  [0.34045404]


portfolio before change:  [0.76831518]
curr_Stock_Price:  100.52951011729336
curr_Factors:  [100.52951012  -0.40790054  -1.01989628]
mat_Sqrt:  [[24.11067044  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-4.66111681e-04  1.36549742e-01  5.77732962e-01]
Stock Position:  -0.00046611168119210664
Bond Position:  [0.81517316]


portfolio before change:  [0.76836634]
curr_Stock_Price:  100.63837932726516
curr_Factors:  [100.63837933  -0.33040143  -1.03556266]
mat_Sqrt:  [[25.67633109  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00174448  0.02878893 -0.24025824]
Stock Position:  0.0017444808488985425
Bond Position:  [0.59280461]


portfolio before change:  [0.76914787]
curr_Stock_Price:  101.0439014618015
curr_Factors:  [101.04390146  -0.3403179   -1.04920548]
mat_Sqrt:  [[25.17953872  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00173168  0.00654047  0.00665287]
Stock Position:  -0.001731675166177608
Bond Position:  [0.94412308]


portfolio before change:  [0.76827961]
curr_Stock_Price:  101.61345261065362
curr_Factors:  [101.61345261  -0.13336028  -1.06329503]
mat_Sqrt:  [[30.70792066  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00067584 -0.03952248 -0.0313768 ]
Stock Position:  -0.0006758423082377503
Bond Position:  [0.83695428]


portfolio before change:  [0.76940544]
curr_Stock_Price:  100.10244822388724
curr_Factors:  [ 1.00102448e+02 -2.27956970e-02 -1.03037744e+00]
mat_Sqrt:  [[34.91864787  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-2.56258788e-04 -2.17919186e-02  3.01913672e-01]
Stock Position:  -0.0002562587881349134
Bond Position:  [0.79505757]


portfolio before change:  [0.77021419]
curr_Stock_Price:  97.33427939518027
curr_Factors:  [ 9.73342794e+01  2.36415340e-02 -1.00926065e+00]
mat_Sqrt:  [[36.32594125  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00387128  0.02075395 -0.3821685 ]
Stock Position:  0.003871280872203323
Bond Position:  [0.39340586]


portfolio before change:  [0.77016843]
curr_Stock_Price:  97.30975413892769
curr_Factors:  [97.30975414 -0.16325658 -1.01182362]
mat_Sqrt:  [[30.04868888  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00298983 -0.16258084 -0.13496272]
Stock Position:  -0.002989832869389306
Bond Position:  [1.06110833]


portfolio before change:  [0.76824354]
curr_Stock_Price:  97.99793103989585
curr_Factors:  [97.99793104 -0.30140977 -0.99297251]
mat_Sqrt:  [[26.85800974  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00293139 -0.01079233 -0.1518624 ]
Stock Position:  -0.002931389307618822
Bond Position:  [1.05551363]


portfolio before change:  [0.76924392]
curr_Stock_Price:  97.701679357041
curr_Factors:  [97.70167936 -0.34073647 -1.00048991]
mat_Sqrt:  [[25.55140638  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00039245  0.04399895  0.09677228]
Stock Position:  -0.0003924492357240271
Bond Position:  [0.80758687]


portfolio before change:  [0.76965494]
curr_Stock_Price:  96.91159226227957
curr_Factors:  [96.91159226 -0.47980772 -0.99146329]
mat_Sqrt:  [[22.25414163  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00028373  0.01456172 -0.1041823 ]
Stock Position:  0.0002837314550556352
Bond Position:  [0.74215807]


portfolio before change:  [0.76969156]
curr_Stock_Price:  96.71366796214083
curr_Factors:  [96.71366796 -0.59577546 -1.01787325]
mat_Sqrt:  [[19.2614565   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00098889 -0.00435857  0.31421358]
Stock Position:  -0.000988890644262211
Bond Position:  [0.8653308]


portfolio before change:  [0.77038056]
curr_Stock_Price:  96.12631987778624
curr_Factors:  [96.12631988 -0.63278056 -1.00536205]
mat_Sqrt:  [[18.68125363  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00545937 -0.03345621  0.17638259]
Stock Position:  0.005459370749593594
Bond Position:  [0.24559134]


portfolio before change:  [0.77983427]
curr_Stock_Price:  97.85234453448855
curr_Factors:  [97.85234453 -0.71929841 -1.0266307 ]
mat_Sqrt:  [[17.07355103  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00968576 -0.02154517  0.56432514]
Stock Position:  0.009685760324612217
Bond Position:  [-0.16794009]


portfolio before change:  [0.76880297]
curr_Stock_Price:  96.71559363378216
curr_Factors:  [96.71559363 -0.65764848 -0.99599235]
mat_Sqrt:  [[18.50671827  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 4.76240230e-04 -1.71483668e-03  7.92977532e-01]
Stock Position:  0.00047624023031197507
Bond Position:  [0.72274312]


portfolio before change:  [0.76867614]
curr_Stock_Price:  96.259546489829
curr_Factors:  [96.25954649 -0.75263442 -1.01219167]
mat_Sqrt:  [[16.48122848  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-5.26937286e-03 -1.66939027e-04 -2.32625210e-01]
Stock Position:  -0.0052693728626789765
Bond Position:  [1.27590358]


portfolio before change:  [0.76885464]
curr_Stock_Price:  96.25593936924156
curr_Factors:  [96.25593937 -0.89018704 -1.01421867]
mat_Sqrt:  [[14.33357894  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.03545917  0.04916366  0.17523953]
Stock Position:  -0.03545916959832629
Bond Position:  [4.18201032]


portfolio before change:  [0.80657017]
curr_Stock_Price:  95.20705007088938
curr_Factors:  [95.20705007 -0.81173906 -0.97801453]
mat_Sqrt:  [[15.89970256  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00708635 -0.08055988  0.37333256]
Stock Position:  -0.007086346673709676
Bond Position:  [1.48124033]


portfolio before change:  [0.8063062]
curr_Stock_Price:  95.27042988380745
curr_Factors:  [95.27042988 -0.57567725 -0.95492926]
mat_Sqrt:  [[20.61693785  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0035916   0.01928286 -0.17859336]
Stock Position:  0.003591601569056739
Bond Position:  [0.46413278]


portfolio before change:  [0.80372494]
curr_Stock_Price:  94.53558155540061
curr_Factors:  [94.53558156 -0.5752146  -0.99466135]
mat_Sqrt:  [[19.67011216  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00116588 -0.00204782  0.00352251]
Stock Position:  0.0011658803516308828
Bond Position:  [0.69350776]


portfolio before change:  [0.80363205]
curr_Stock_Price:  94.38154690909975
curr_Factors:  [94.38154691 -0.81927872 -0.988306  ]
mat_Sqrt:  [[15.48328187  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00965549 -0.0563242  -0.2440762 ]
Stock Position:  -0.009655490138174147
Bond Position:  [1.71493214]


portfolio before change:  [0.81480036]
curr_Stock_Price:  93.24706978548777
curr_Factors:  [93.24706979 -0.40671323 -0.99295412]
mat_Sqrt:  [[23.00209477  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01043882 0.08551844 0.53611381]
Stock Position:  0.010438815594494723
Bond Position:  [-0.1585886]


portfolio before change:  [0.80849873]
curr_Stock_Price:  92.64529540883221
curr_Factors:  [92.64529541 -0.59764882 -1.0041737 ]
mat_Sqrt:  [[18.67070382  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00595926 -0.03984027  0.25175912]
Stock Position:  0.00595926270765097
Bond Position:  [0.25640107]


portfolio before change:  [0.80096658]
curr_Stock_Price:  91.37597694822695
curr_Factors:  [91.37597695 -0.42101341 -1.00218506]
mat_Sqrt:  [[22.01632318  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00676677 0.0480068  0.31201445]
Stock Position:  0.006766773698934352
Bond Position:  [0.18264602]


portfolio before change:  [0.80506376]
curr_Stock_Price:  91.97808878891628
curr_Factors:  [91.97808879 -0.45580033 -0.97193287]
mat_Sqrt:  [[22.06112882  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01548345 -0.08760177 -0.45121304]
Stock Position:  0.015483448225086035
Bond Position:  [-0.61907421]


portfolio before change:  [0.82639353]
curr_Stock_Price:  93.36067179312836
curr_Factors:  [93.36067179 -0.46400653 -0.99065989]
mat_Sqrt:  [[21.79768489  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00170343 -0.02379117  0.06074737]
Stock Position:  -0.0017034269814601875
Bond Position:  [0.98542661]


portfolio before change:  [0.82595038]
curr_Stock_Price:  93.6931374212727
curr_Factors:  [93.69313742 -0.32751206 -0.99901628]
mat_Sqrt:  [[24.86588075  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00726864  0.00439382  0.04046643]
Stock Position:  -0.007268637733390885
Bond Position:  [1.50697185]


portfolio before change:  [0.83235462]
curr_Stock_Price:  92.83797649753191
curr_Factors:  [92.8379765  -0.20918757 -0.98694668]
mat_Sqrt:  [[28.0705653   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01063973 0.04075705 0.17531013]
Stock Position:  0.01063972507211029
Bond Position:  [-0.15541593]


portfolio before change:  [0.8178774]
curr_Stock_Price:  91.47912667974404
curr_Factors:  [91.47912668 -0.29717835 -0.98383463]
mat_Sqrt:  [[25.40885771  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00034142 -0.02319143 -0.28620519]
Stock Position:  -0.00034141921653500806
Bond Position:  [0.84911013]


portfolio before change:  [0.81802127]
curr_Stock_Price:  91.36863385452408
curr_Factors:  [91.36863385 -0.54762203 -0.97115311]
mat_Sqrt:  [[20.00789822  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00019459  0.02154673 -0.00364346]
Stock Position:  -0.00019459139892103006
Bond Position:  [0.83580082]


portfolio before change:  [0.81798786]
curr_Stock_Price:  92.07725367287732
curr_Factors:  [92.07725367 -0.82267732 -0.97601611]
mat_Sqrt:  [[15.24016703  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01697204 -0.11818782 -0.23170691]
Stock Position:  0.016972044764261507
Bond Position:  [-0.74475141]


portfolio before change:  [0.7946502]
curr_Stock_Price:  90.70767402655464
curr_Factors:  [90.70767403 -1.01628731 -0.94126756]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [0.7946502]
Stock Price:  90.95728525435123
PL:  [0.7946502]
Settle:  Tensor("sub_118:0", shape=(), dtype=float64)
PL:  Tensor("sub_119:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  60
output_Z_Vals[:, i, :]:  [[ 1.19260232e+02 -2.92559343e+01 -2.92733494e+01]
 [ 1.72255667e-02 -2.58289306e-02 -3.76510507e-02]
 [-3.00297454e-02  3.92649356e-02  8.60044402e-02]
 [ 8.79514654e-02  1.97448438e-01  3.83190759e-02]
 [ 2.25634008e-01 -2.20708283e-02 -4.30180615e-02]
 [ 6.27848985e-02  3.20354634e-02  1.23201732e-02]
 [ 6.74039776e-02  1.79368391e-02 -6.04521106e-02]
 [-1.41748944e-01  5.04150682e-02 -8.68811841e-02]
 [ 2.62034415e-02 -2.73435488e-02 -1.90519349e-02]
 [-6.85263623e-02  2.01188704e-01  6.66675677e-02]
 [ 6.08973086e-02  1.39376499e-01 -8.81223601e-02]
 [-4.62504627e-02  4.63757638e-02  3.99456266e-03]
 [-8.55701555e-02 -2.16669599e-02 -5.57321352e-02]
 [ 1.54463911e-01  1.49382968e-01  2.39576650e-01]
 [ 1.83881075e-01  2.36191114e-01  3.70525405e-02]
 [-6.20087515e-02 -6.42410721e-02 -1.15047168e-01]
 [-8.67778233e-02  1.31109512e-02 -9.55437390e-02]
 [ 4.98938432e-02 -1.92293802e-01 -1.05405851e-01]
 [ 3.13006405e-02  6.08140254e-02  2.88746623e-02]
 [ 3.24497464e-01 -1.57738629e-01 -8.46220625e-02]
 [ 9.90502924e-02  2.01034147e-02  1.54254576e-01]
 [-6.39562310e-03 -1.02761348e-03 -6.36719719e-03]
 [-1.07045175e-01  2.02644166e-01  3.76261110e-01]
 [ 1.40116768e-01 -3.54440420e-02 -2.58089966e-02]
 [ 4.93947304e-02  2.79391525e-02  8.64538001e-02]
 [ 4.94999988e-02 -5.02194762e-02  7.24637719e-02]
 [-1.91752845e-01  6.84644456e-02  7.77504587e-02]
 [-5.07806065e-02  7.36225950e-02  2.93687317e-02]
 [ 6.20848838e-02 -6.23725319e-02  9.08311027e-02]
 [-9.21177300e-03 -3.42202887e-02 -9.71435724e-02]
 [-6.40815947e-02  3.97297480e-01  1.17593396e-02]
 [ 3.02778582e-02 -1.39346434e-02  7.90936471e-02]
 [-8.46313951e-02  2.56900041e-02  8.47866736e-02]
 [-2.53464431e-01 -3.21971122e-02  1.17580894e-02]
 [-1.57923625e-01  1.45822319e-01  3.45634464e-02]
 [ 1.22020429e-01 -1.49241045e-01 -1.19655783e-01]
 [-3.55263422e-01 -6.59739759e-01  2.08243681e-01]
 [-8.57235180e-02 -1.52391010e-01  2.37254750e-01]
 [-7.37790208e-03  1.72078723e-02 -4.38432690e-02]
 [ 3.15388814e-01 -2.11465047e-02 -3.20047802e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.26023247 -29.25593426 -29.27334937]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  8.31486419  -9.25153874 -83.50871763]
init_Out:  [2.49911038]
Stock Position:  8.31486419409362
Bond position:  [-828.98730903]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-0.19106212]
curr_Stock_Price:  99.68892545374732
curr_Factors:  [99.68892545 -1.0257185  -0.98098366]
mat_Sqrt:  [[13.40130959  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00066211 -0.00816783 -0.10740797]
Stock Position:  0.000662112757897769
Bond Position:  [-0.25706743]


portfolio before change:  [-0.19098365]
curr_Stock_Price:  99.85596545115041
curr_Factors:  [99.85596545 -1.09971533 -0.92374323]
mat_Sqrt:  [[13.20070509  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00086816  0.01241666  0.24534673]
Stock Position:  -0.0008681616766470771
Bond Position:  [-0.10429253]


portfolio before change:  [-0.19166248]
curr_Stock_Price:  100.62286279615508
curr_Factors:  [100.6228628   -1.3510251   -0.92258488]
mat_Sqrt:  [[10.35810715  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.0097384  0.06243868 0.10931366]
Stock Position:  0.009738401949880857
Bond Position:  [-1.17156836]


portfolio before change:  [-0.18534145]
curr_Stock_Price:  101.28698491071805
curr_Factors:  [101.28698491  -1.17182591  -0.93443404]
mat_Sqrt:  [[12.32584123  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01754713 -0.00697941 -0.12271856]
Stock Position:  0.017547128258480153
Bond Position:  [-1.96263716]


portfolio before change:  [-0.18906546]
curr_Stock_Price:  101.08873786059632
curr_Factors:  [101.08873786  -1.03851686  -0.94506213]
mat_Sqrt:  [[13.90738142  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00475481 0.0101305  0.03514602]
Stock Position:  0.004754805629725071
Bond Position:  [-0.66972276]


portfolio before change:  [-0.19409232]
curr_Stock_Price:  100.0491274800313
curr_Factors:  [100.04912748  -0.95151211  -0.93672959]
mat_Sqrt:  [[15.14120196  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0036673   0.00567213 -0.17245304]
Stock Position:  0.0036673026070378804
Bond Position:  [-0.56100275]


portfolio before change:  [-0.19441988]
curr_Stock_Price:  99.97893315856349
curr_Factors:  [99.97893316 -0.64954272 -0.93556949]
mat_Sqrt:  [[20.4881627   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00772064  0.01594264 -0.24784784]
Stock Position:  -0.007720642488523877
Bond Position:  [0.57748172]


portfolio before change:  [-0.19808743]
curr_Stock_Price:  100.46331506292167
curr_Factors:  [100.46331506  -0.80023408  -0.95038046]
mat_Sqrt:  [[17.44718121  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00123851 -0.00864679 -0.05434987]
Stock Position:  0.001238508036236195
Bond Position:  [-0.32251205]


portfolio before change:  [-0.19896697]
curr_Stock_Price:  99.78570204453032
curr_Factors:  [99.78570204 -0.70335633 -0.95113004]
mat_Sqrt:  [[19.07805137  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00260631  0.06362145  0.19018401]
Stock Position:  -0.0026063055931879004
Bond Position:  [0.06110506]


portfolio before change:  [-0.19688142]
curr_Stock_Price:  98.98843697392303
curr_Factors:  [98.98843697 -0.72341907 -0.93969983]
mat_Sqrt:  [[18.76294926  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00247872  0.04407472 -0.25138856]
Stock Position:  0.002478719752691046
Bond Position:  [-0.44224601]


portfolio before change:  [-0.19162281]
curr_Stock_Price:  101.13224383228375
curr_Factors:  [101.13224383  -0.77564629  -0.92875571]
mat_Sqrt:  [[18.39404572  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.002405    0.0146653   0.01139538]
Stock Position:  -0.002404998859605013
Bond Position:  [0.05160012]


portfolio before change:  [-0.19109088]
curr_Stock_Price:  100.91374949315018
curr_Factors:  [100.91374949  -0.7376771   -0.95069219]
mat_Sqrt:  [[18.65094644  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00522793 -0.00685169 -0.15898827]
Stock Position:  -0.0052279313950606456
Bond Position:  [0.33647928]


portfolio before change:  [-0.1974609]
curr_Stock_Price:  102.1402541379552
curr_Factors:  [102.14025414  -1.08776701  -0.9451005 ]
mat_Sqrt:  [[13.37623203  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01549198 0.04723904 0.6834455 ]
Stock Position:  0.015491981659110636
Bond Position:  [-1.77981584]


portfolio before change:  [-0.18672725]
curr_Stock_Price:  102.84746768204332
curr_Factors:  [102.84746768  -1.23303311  -0.94721231]
mat_Sqrt:  [[11.62318229  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01699559 0.07469019 0.10570058]
Stock Position:  0.016995588361919372
Bond Position:  [-1.93468047]


portfolio before change:  [-0.18278065]
curr_Stock_Price:  103.09391114929595
curr_Factors:  [103.09391115  -1.17342476  -0.97314297]
mat_Sqrt:  [[12.05009567  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00723242 -0.02031481 -0.32819755]
Stock Position:  -0.0072324200723644
Bond Position:  [0.56283782]


portfolio before change:  [-0.18923285]
curr_Stock_Price:  103.9957612746469
curr_Factors:  [103.99576127  -0.97320053  -0.99403   ]
mat_Sqrt:  [[14.54314299  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00728468  0.00414605 -0.27255969]
Stock Position:  -0.007284675955738517
Bond Position:  [0.56834257]


portfolio before change:  [-0.18627136]
curr_Stock_Price:  103.5989772764738
curr_Factors:  [103.59897728  -0.93319787  -0.96349967]
mat_Sqrt:  [[15.54641272  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.001506   -0.06080864 -0.30069355]
Stock Position:  0.001506003972562711
Bond Position:  [-0.34229183]


portfolio before change:  [-0.18649045]
curr_Stock_Price:  103.48190954517595
curr_Factors:  [103.48190955  -0.71691203  -1.00660985]
mat_Sqrt:  [[18.46496087  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00209937 0.01923108 0.08237137]
Stock Position:  0.002099374479463808
Bond Position:  [-0.40373773]


portfolio before change:  [-0.18695259]
curr_Stock_Price:  103.2858200261333
curr_Factors:  [103.28582003  -0.6825615   -1.01202782]
mat_Sqrt:  [[18.97098628  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01597973 -0.04988133 -0.24140319]
Stock Position:  0.01597973135045773
Bond Position:  [-1.83743224]


portfolio before change:  [-0.19228991]
curr_Stock_Price:  102.96618840055261
curr_Factors:  [102.9661884   -0.48966619  -0.99493971]
mat_Sqrt:  [[23.33127589  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.0056172  0.00635726 0.44004537]
Stock Position:  0.0056172000338964466
Bond Position:  [-0.77067158]


portfolio before change:  [-0.1909483]
curr_Stock_Price:  103.22217885903775
curr_Factors:  [103.22217886  -0.62266817  -0.97099519]
mat_Sqrt:  [[20.97267453  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00036819 -0.00032496 -0.01816384]
Stock Position:  -0.0003681864534963562
Bond Position:  [-0.15294329]


portfolio before change:  [-0.19039732]
curr_Stock_Price:  101.67377850114893
curr_Factors:  [101.6737785   -0.32962571  -0.98735613]
mat_Sqrt:  [[27.24275454  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-9.18003616e-04  6.40817120e-02  1.07336822e+00]
Stock Position:  -0.0009180036163962435
Bond Position:  [-0.09706042]


portfolio before change:  [-0.19040717]
curr_Stock_Price:  101.67129318484508
curr_Factors:  [ 1.01671293e+02 -8.04022747e-02 -9.77174151e-01]
mat_Sqrt:  [[35.31008325  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00379306 -0.01120839 -0.07362588]
Stock Position:  0.0037930629179925425
Bond Position:  [-0.57605278]


portfolio before change:  [-0.18709014]
curr_Stock_Price:  102.56477641552581
curr_Factors:  [ 1.02564776e+02 -2.22014228e-02 -9.87589204e-01]
mat_Sqrt:  [[37.36386037  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00181361 0.00883514 0.24662863]
Stock Position:  0.0018136087549164425
Bond Position:  [-0.37310252]


portfolio before change:  [-0.18993969]
curr_Stock_Price:  101.0192906153419
curr_Factors:  [101.01929062   0.2483942   -0.9665095 ]
mat_Sqrt:  [[49.26412838  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00127872 -0.01588079  0.20671897]
Stock Position:  0.0012787183099308356
Bond Position:  [-0.31911491]


portfolio before change:  [-0.18845323]
curr_Stock_Price:  102.21294488389371
curr_Factors:  [102.21294488   0.12251783  -0.94453538]
mat_Sqrt:  [[44.92708238  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00387549  0.02165036  0.22180042]
Stock Position:  -0.0038754876907189785
Bond Position:  [0.20767178]


portfolio before change:  [-0.19426852]
curr_Stock_Price:  103.72017417384936
curr_Factors:  [ 1.03720174e+02 -2.51979035e-02 -9.69312671e-01]
mat_Sqrt:  [[38.36655302  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00111777  0.02328151  0.08378082]
Stock Position:  -0.0011177655699670622
Bond Position:  [-0.07833368]


portfolio before change:  [-0.19327553]
curr_Stock_Price:  102.82303858666748
curr_Factors:  [102.82303859  -0.14366417  -1.02164479]
mat_Sqrt:  [[32.06292814  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00246438 -0.01972393  0.25911585]
Stock Position:  0.002464380445965822
Bond Position:  [-0.44667061]


portfolio before change:  [-0.18950703]
curr_Stock_Price:  104.37488177149422
curr_Factors:  [ 1.04374882e+02 -9.68146933e-02 -1.02374830e+00]
mat_Sqrt:  [[34.03624757  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0008792  -0.01082141 -0.27712357]
Stock Position:  -0.0008792004956230056
Bond Position:  [-0.09774058]


portfolio before change:  [-0.18817777]
curr_Stock_Price:  102.84909135449291
curr_Factors:  [ 1.02849091e+02 -5.60121388e-02 -1.01408758e+00]
mat_Sqrt:  [[35.27459648  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00145779  0.12563649  0.03354612]
Stock Position:  -0.0014577927989656472
Bond Position:  [-0.03824511]


portfolio before change:  [-0.19190013]
curr_Stock_Price:  105.39923073702742
curr_Factors:  [ 1.05399231e+02  7.95723674e-02 -1.04140887e+00]
mat_Sqrt:  [[40.28256861  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0011435  -0.00440652  0.22563216]
Stock Position:  0.0011434968504113478
Bond Position:  [-0.31242382]


portfolio before change:  [-0.1921345]
curr_Stock_Price:  105.22842921582162
curr_Factors:  [ 1.05228429e+02 -2.60835656e-02 -1.02958573e+00]
mat_Sqrt:  [[36.61522751  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00182058  0.00812389  0.24187278]
Stock Position:  -0.001820583382792603
Bond Position:  [-0.00055737]


portfolio before change:  [-0.19557287]
curr_Stock_Price:  107.11700090582896
curr_Factors:  [107.11700091   0.18482055  -1.01434213]
mat_Sqrt:  [[46.73064328  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00539037 -0.01018162  0.03354256]
Stock Position:  -0.005390374046110346
Bond Position:  [0.38182783]


portfolio before change:  [-0.20549931]
curr_Stock_Price:  108.96736800121829
curr_Factors:  [108.967368     0.22783587  -1.01946386]
mat_Sqrt:  [[49.37382732  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00297938  0.04611307  0.09859989]
Stock Position:  -0.002979377587138513
Bond Position:  [0.11915563]


portfolio before change:  [-0.21177453]
curr_Stock_Price:  111.0785855598157
curr_Factors:  [111.07858556   0.20243317  -1.05362498]
mat_Sqrt:  [[47.4200967   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00197685 -0.04719416 -0.34134464]
Stock Position:  0.0019768497689705133
Bond Position:  [-0.4313602]


portfolio before change:  [-0.20473934]
curr_Stock_Price:  114.6646472495414
curr_Factors:  [114.66464725   0.26842725  -1.05538015]
mat_Sqrt:  [[52.19876573  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00631797 -0.20862803  0.59406126]
Stock Position:  -0.006317970571453063
Bond Position:  [0.51970852]


portfolio before change:  [-0.19223562]
curr_Stock_Price:  112.69585748954738
curr_Factors:  [112.69585749   0.35578873  -1.02439174]
mat_Sqrt:  [[57.74805397  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00071394 -0.04819027  0.67682176]
Stock Position:  -0.0007139429142240834
Bond Position:  [-0.11177721]


portfolio before change:  [-0.1910218]
curr_Stock_Price:  110.97612710932269
curr_Factors:  [110.97612711   0.39514772  -1.04111866]
mat_Sqrt:  [[58.16851159  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00027305  0.00544161 -0.12507264]
Stock Position:  -0.00027305265502931223
Bond Position:  [-0.16071948]


portfolio before change:  [-0.19134808]
curr_Stock_Price:  112.097464843759
curr_Factors:  [112.09746484   0.67026189  -1.05771911]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-0.19134808]
Stock Price:  112.2404117362163
PL:  [-12.43175982]
Settle:  Tensor("sub_120:0", shape=(), dtype=float64)
PL:  Tensor("sub_121:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  61
output_Z_Vals[:, i, :]:  [[ 1.19260232e+02 -2.92559343e+01 -2.92733494e+01]
 [-1.86333370e-01  6.11836650e-01  1.15195265e-01]
 [ 2.18160461e-01 -2.10908782e-02 -3.09709959e-01]
 [ 8.22632127e-02  1.45724988e-01  3.76280549e-02]
 [ 1.54751467e-01 -8.49712977e-03 -6.33024683e-02]
 [ 6.55135392e-02  2.94345280e-02 -1.81453208e-02]
 [ 4.84898227e-02  3.10320256e-02 -5.10722607e-02]
 [-9.34450386e-02 -6.43033585e-03 -1.00062364e-01]
 [ 9.31966842e-02 -4.04059121e-02 -4.17127643e-02]
 [-6.97111278e-02  1.96958728e-01  6.46567528e-02]
 [ 6.24478339e-02  1.26581373e-01 -8.94025219e-02]
 [-9.18486789e-02 -1.05440550e-01  2.37781140e-03]
 [-6.61982263e-02 -2.04210800e-03  3.82726676e-02]
 [-1.17299792e-01 -1.22146735e-01  4.83293278e-02]
 [-7.35300876e-02  1.82995953e-01  3.11072663e-01]
 [ 4.18438460e-02 -7.63065089e-01  6.50372925e-02]
 [-6.79040104e-02 -2.96014297e-01 -1.71731344e-01]
 [ 4.35694790e-01  2.19167629e-02 -5.24222556e-01]
 [-2.08837070e-01 -2.30730010e-02 -3.77734310e-01]
 [-8.09674809e-02 -3.68937485e-02  1.67275490e-01]
 [ 4.24440112e-01 -3.09416725e-01  2.07831285e-01]
 [ 8.49210531e-02  7.24481130e-01  6.49037796e-01]
 [-2.18801227e-01  1.58284138e-01  2.13329077e-01]
 [-2.22560073e-01 -2.18927360e-01 -4.17177374e-02]
 [-1.40665668e+00  1.46909515e-01 -9.98590155e-02]
 [-3.94351682e-01 -5.50192824e-01  2.14887803e-01]
 [ 1.80596390e-01  6.90963322e-02  8.21211947e-02]
 [-3.56769807e-01 -2.90631242e-02 -1.39972903e-01]
 [-2.69878772e-01 -5.51339444e-01  3.13743359e-01]
 [ 4.44559341e-01  5.43402966e-01  8.23795309e-01]
 [ 1.08636781e-01 -1.71209453e-01  9.56677222e-02]
 [ 2.28406587e-01  8.52758022e-01  6.73354284e-01]
 [ 7.82297284e-01 -6.07155184e-01 -4.85044219e-01]
 [-1.04742024e-01 -5.52072819e-02  3.82215058e-02]
 [-1.05553644e-02 -5.26364013e-01 -2.76064028e-02]
 [ 6.37406219e-01  7.04205080e-01  3.37642332e-01]
 [ 1.97239325e-02 -1.27779566e-01 -8.53668585e-02]
 [ 2.31637046e-02  1.45567183e-01  1.09419699e-01]
 [ 7.91793699e-01 -9.16203117e-01 -2.47035002e-01]
 [-1.82980848e-01  3.60008561e-01  3.55181670e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.26023247 -29.25593426 -29.27334937]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  8.31486419  -9.25153874 -83.50871763]
init_Out:  [2.49911038]
Stock Position:  8.31486419409362
Bond position:  [-828.98730903]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [15.90458952]
curr_Stock_Price:  101.62469388786135
curr_Factors:  [101.62469389  -0.99322297  -0.98350369]
mat_Sqrt:  [[14.07724825  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01044392  0.19347974  0.32862003]
Stock Position:  -0.01044392185429092
Bond Position:  [16.96594989]


portfolio before change:  [15.89853497]
curr_Stock_Price:  102.4074875254348
curr_Factors:  [102.40748753  -0.97432734  -1.01573197]
mat_Sqrt:  [[13.99780483  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01103006 -0.00666952 -0.88351631]
Stock Position:  0.011030059210119523
Bond Position:  [14.76897431]


portfolio before change:  [15.89335216]
curr_Stock_Price:  101.7702248004176
curr_Factors:  [101.7702248   -0.92648073  -1.01884813]
mat_Sqrt:  [[14.54705723  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00644162 0.04608229 0.10734237]
Stock Position:  0.006441619684819864
Bond Position:  [15.23778707]


portfolio before change:  [15.88429823]
curr_Stock_Price:  100.0689798983131
curr_Factors:  [100.0689799   -0.81453511  -0.98949563]
mat_Sqrt:  [[16.47475158  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00859561 -0.00268703 -0.18058432]
Stock Position:  0.008595608209967442
Bond Position:  [15.02414448]


portfolio before change:  [15.87578004]
curr_Stock_Price:  98.85948810473215
curr_Factors:  [98.8594881  -0.55739746 -0.95997527]
mat_Sqrt:  [[21.67862605  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00288624  0.00930802 -0.05176355]
Stock Position:  0.002886236293777837
Bond Position:  [15.5904482]


portfolio before change:  [15.87864805]
curr_Stock_Price:  99.17792389948305
curr_Factors:  [99.1779239  -0.66918166 -0.96980248]
mat_Sqrt:  [[19.25809133  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00201816  0.00981319 -0.14569494]
Stock Position:  0.0020181638917175105
Bond Position:  [15.67849075]


portfolio before change:  [15.87953962]
curr_Stock_Price:  98.64854956195761
curr_Factors:  [98.64854956 -0.68167772 -0.99309513]
mat_Sqrt:  [[18.48187802  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00617016 -0.00203345 -0.28545007]
Stock Position:  -0.0061701637452636834
Bond Position:  [16.48821733]


portfolio before change:  [15.878311]
curr_Stock_Price:  99.1817251572022
curr_Factors:  [99.18172516 -0.57961797 -0.96523147]
mat_Sqrt:  [[21.15982506  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00395272 -0.01277747 -0.11899491]
Stock Position:  0.003952718203578343
Bond Position:  [15.48627359]


portfolio before change:  [15.88156269]
curr_Stock_Price:  99.5146060131938
curr_Factors:  [99.51460601 -0.54339821 -0.94628119]
mat_Sqrt:  [[22.43506261  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00229229  0.06228382  0.18444772]
Stock Position:  -0.0022922900544593496
Bond Position:  [16.10967903]


portfolio before change:  [15.8847872]
curr_Stock_Price:  98.98645372029384
curr_Factors:  [98.98645372 -0.52128594 -0.93404202]
mat_Sqrt:  [[23.09589852  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00205521  0.04002854 -0.25504051]
Stock Position:  0.002055210689157249
Bond Position:  [15.68134918]


portfolio before change:  [15.88668175]
curr_Stock_Price:  98.95446310156079
curr_Factors:  [98.9544631  -0.34047859 -0.9321923 ]
mat_Sqrt:  [[27.71541856  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00339471 -0.03334323  0.00678323]
Stock Position:  -0.003394708733278341
Bond Position:  [16.22260333]


portfolio before change:  [15.89138535]
curr_Stock_Price:  98.16627846294296
curr_Factors:  [98.16627846 -0.29846329 -0.93673281]
mat_Sqrt:  [[28.5445681   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00204727 -0.00064577  0.10918127]
Stock Position:  -0.0020472748979100926
Bond Position:  [16.09235871]


portfolio before change:  [15.89800023]
curr_Stock_Price:  95.91782382709494
curr_Factors:  [95.91782383 -0.402203   -0.92644454]
mat_Sqrt:  [[25.4024158   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00435346 -0.03862619  0.13787012]
Stock Position:  -0.00435346091086184
Bond Position:  [16.31557473]


portfolio before change:  [15.90568193]
curr_Stock_Price:  94.62181357416465
curr_Factors:  [94.62181357 -0.43366436 -0.87652608]
mat_Sqrt:  [[25.52600143  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-2.07933506e-04  5.78684015e-02  8.87403722e-01]
Stock Position:  -0.0002079335062461643
Bond Position:  [15.92535698]


portfolio before change:  [15.90818511]
curr_Stock_Price:  92.15766091652011
curr_Factors:  [92.15766092 -0.48916301 -0.86508003]
mat_Sqrt:  [[23.78982023  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00148876 -0.24130237  0.18553329]
Stock Position:  0.0014887574422621272
Bond Position:  [15.7709847]


portfolio before change:  [15.91120785]
curr_Stock_Price:  92.86378652086061
curr_Factors:  [92.86378652 -0.4805232  -0.85246046]
mat_Sqrt:  [[24.48718942  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00451671 -0.09360794 -0.48990172]
Stock Position:  -0.004516711921654104
Bond Position:  [16.33064683]


portfolio before change:  [15.91974236]
curr_Stock_Price:  91.42622605507931
curr_Factors:  [91.42622606 -0.53855663 -0.83371257]
mat_Sqrt:  [[23.17938196  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01420462  0.00693069 -1.49546104]
Stock Position:  0.014204615037801984
Bond Position:  [14.62106801]


portfolio before change:  [15.92800403]
curr_Stock_Price:  91.87917191127059
curr_Factors:  [91.87917191 -0.63038448 -0.805879  ]
mat_Sqrt:  [[21.85021771  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01311371 -0.00729632 -1.07757085]
Stock Position:  -0.013113713980032679
Bond Position:  [17.13288121]


portfolio before change:  [15.91280311]
curr_Stock_Price:  93.20165498523146
curr_Factors:  [93.20165499 -0.64010165 -0.78059679]
mat_Sqrt:  [[22.51241736  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00212217 -0.01166683  0.47719041]
Stock Position:  -0.0021221669030493866
Bond Position:  [16.11059258]


portfolio before change:  [15.92010036]
curr_Stock_Price:  90.71207556650641
curr_Factors:  [90.71207557 -0.77671633 -0.76457967]
mat_Sqrt:  [[19.42176768  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.02362681 -0.09784616  0.59288481]
Stock Position:  0.02362680869803046
Bond Position:  [13.7768635]


portfolio before change:  [15.86694038]
curr_Stock_Price:  88.38919743888223
curr_Factors:  [88.38919744 -0.61258232 -0.75558634]
mat_Sqrt:  [[22.5014803   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01049315 0.22910105 1.85152418]
Stock Position:  0.010493147904491946
Bond Position:  [14.93945946]


portfolio before change:  [15.88178162]
curr_Stock_Price:  89.62559436685498
curr_Factors:  [89.62559437 -0.53786547 -0.79256246]
mat_Sqrt:  [[23.69379032  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0072242   0.05005384  0.60856848]
Stock Position:  -0.007224202211363056
Bond Position:  [16.52925504]


portfolio before change:  [15.88966339]
curr_Stock_Price:  88.82059527560936
curr_Factors:  [88.82059528 -0.3720247  -0.78267388]
mat_Sqrt:  [[27.99203398  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00845699 -0.06923091 -0.11900909]
Stock Position:  -0.008456989966392875
Bond Position:  [16.64081827]


portfolio before change:  [15.91724651]
curr_Stock_Price:  85.80499630913461
curr_Factors:  [85.80499631 -0.18010446 -0.77688679]
mat_Sqrt:  [[32.95312124  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.04319006  0.04645687 -0.28486998]
Stock Position:  -0.04319005520025997
Bond Position:  [19.62316904]


portfolio before change:  [15.97215347]
curr_Stock_Price:  84.59050584391723
curr_Factors:  [ 8.45905058e+01 -4.52860219e-02 -7.92492607e-01]
mat_Sqrt:  [[36.59982311  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00996436 -0.17398625  0.61301509]
Stock Position:  -0.00996435990688625
Bond Position:  [16.81504371]


portfolio before change:  [15.97849813]
curr_Stock_Price:  84.16472333327015
curr_Factors:  [84.16472333 -0.43792539 -0.75931448]
mat_Sqrt:  [[25.41999326  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00783412 0.02185018 0.23426891]
Stock Position:  0.007834123569948118
Bond Position:  [15.31914129]


portfolio before change:  [15.97517598]
curr_Stock_Price:  83.49621712817235
curr_Factors:  [83.49621713 -0.276944   -0.76148798]
mat_Sqrt:  [[29.55844088  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01306199 -0.00919057 -0.39930373]
Stock Position:  -0.01306199013862046
Bond Position:  [17.06580275]


portfolio before change:  [16.00366135]
curr_Stock_Price:  81.47875980563457
curr_Factors:  [81.47875981 -0.22363714 -0.75496813]
mat_Sqrt:  [[30.62256355  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00718659 -0.17434884  0.89502247]
Stock Position:  -0.007186586445960968
Bond Position:  [16.5892155]


portfolio before change:  [16.00497473]
curr_Stock_Price:  81.58456842971783
curr_Factors:  [ 8.15845684e+01 -5.52646497e-02 -7.42247743e-01]
mat_Sqrt:  [[36.74961463  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.0170545  0.17183911 2.35005872]
Stock Position:  0.0170545042459493
Bond Position:  [14.61359036]


portfolio before change:  [16.00386768]
curr_Stock_Price:  81.41253998007801
curr_Factors:  [ 8.14125400e+01 -6.87251682e-02 -7.40423691e-01]
mat_Sqrt:  [[36.24786401  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00341384 -0.05414118  0.27291338]
Stock Position:  0.003413836035410409
Bond Position:  [15.72593862]


portfolio before change:  [16.00782272]
curr_Stock_Price:  81.995220120585
curr_Factors:  [81.99522012 -0.12136116 -0.73639605]
mat_Sqrt:  [[34.77517402  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01115372 0.26966576 1.92089235]
Stock Position:  0.01115372050940022
Bond Position:  [15.09327095]


portfolio before change:  [15.97097194]
curr_Stock_Price:  78.52215844742679
curr_Factors:  [78.52215845 -0.25952097 -0.71118349]
mat_Sqrt:  [[29.74545666  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.02244415 -0.19199933 -1.38369615]
Stock Position:  0.022444145851222057
Bond Position:  [14.20860916]


portfolio before change:  [16.00730075]
curr_Stock_Price:  80.06165214620499
curr_Factors:  [80.06165215 -0.17521697 -0.69518903]
mat_Sqrt:  [[33.52833806  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0029338  -0.01745808  0.10903532]
Stock Position:  -0.0029338029751764037
Bond Position:  [16.24218586]


portfolio before change:  [16.00799936]
curr_Stock_Price:  80.5155988084035
curr_Factors:  [ 8.05155988e+01 -7.89422423e-02 -6.98440098e-01]
mat_Sqrt:  [[37.00557583  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00080477 -0.16645092 -0.07875338]
Stock Position:  -0.0008047748880933275
Bond Position:  [16.07279629]


portfolio before change:  [16.00876093]
curr_Stock_Price:  82.06591066455302
curr_Factors:  [82.06591066 -0.27200563 -0.7328572 ]
mat_Sqrt:  [[30.04390715  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.02411503 0.2226892  0.96319959]
Stock Position:  0.024115028191058874
Bond Position:  [14.02973918]


portfolio before change:  [16.0084161]
curr_Stock_Price:  81.97888363283
curr_Factors:  [81.97888363 -0.2577308  -0.76589146]
mat_Sqrt:  [[29.45428608  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-3.39766761e-05 -4.04074468e-02 -2.43527886e-01]
Stock Position:  -3.3976676056280004e-05
Bond Position:  [16.01120147]


portfolio before change:  [16.01039048]
curr_Stock_Price:  82.77767797018984
curr_Factors:  [82.77767797 -0.12610039 -0.75641873]
mat_Sqrt:  [[34.24838172  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00143824 0.04603239 0.31214394]
Stock Position:  0.0014382412565202857
Bond Position:  [15.89133621]


portfolio before change:  [16.01147777]
curr_Stock_Price:  82.15243374221866
curr_Factors:  [82.15243374 -0.26730016 -0.75545493]
mat_Sqrt:  [[29.54224828  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.02429441 -0.28972886 -0.7047221 ]
Stock Position:  0.02429441457828576
Bond Position:  [14.01563249]


portfolio before change:  [16.01893269]
curr_Stock_Price:  82.38717315744942
curr_Factors:  [82.38717316 -0.38023356 -0.75351839]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [16.01893269]
Stock Price:  83.5669554932155
PL:  [16.01893269]
Settle:  Tensor("sub_122:0", shape=(), dtype=float64)
PL:  Tensor("sub_123:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  62
output_Z_Vals[:, i, :]:  [[ 1.19260232e+02 -2.92559343e+01 -2.92733494e+01]
 [ 4.03706775e-03 -1.27034308e-01 -3.91946428e-02]
 [-3.73518058e-02  5.78500775e-03  3.97873783e-02]
 [ 6.86145533e-02  1.20275445e-01  3.52297678e-02]
 [ 2.21230387e-01 -2.55383587e-02 -4.96585562e-02]
 [ 6.42209620e-02  2.92624518e-02  1.98652711e-02]
 [ 2.09778699e-02  5.25161845e-02 -1.41058435e-02]
 [-1.40500046e-01  5.65375053e-02 -8.38737767e-02]
 [ 1.38806149e-01 -3.06883656e-02 -9.48568482e-02]
 [-7.44539185e-02 -1.29633809e-01 -1.04354068e-01]
 [ 2.85763857e-01  1.19841485e-01  4.92221945e-01]
 [-2.72591674e-01 -1.24221415e-01  8.64916234e-02]
 [ 3.96729430e-02 -2.42689679e-01  9.01276740e-02]
 [-1.30328933e-01 -1.26431878e-01 -6.14598926e-03]
 [ 1.70688996e-01  3.69428568e-01  2.05799209e-01]
 [-2.38583296e-02 -5.48639194e-01 -1.65774140e-02]
 [-6.61993621e-02 -2.11737361e-02 -2.53604787e-02]
 [ 1.44462467e-02  9.81000650e-02 -6.58234579e-02]
 [-5.57828993e-02  4.67788765e-02 -1.20080375e-01]
 [-6.29660186e-02 -2.64388648e-02  1.41430757e-01]
 [ 2.12591342e-01 -1.66487958e-01  8.51247759e-02]
 [ 1.15088892e-01  1.72496854e-01  3.33949984e-01]
 [-1.93993131e-02 -9.83278178e-02  1.71715106e-01]
 [-6.39168125e-02 -6.77109726e-04 -8.33719121e-02]
 [-5.46631522e-01  1.59673493e-01  6.20909057e-02]
 [-7.81921783e-02 -1.93504573e-01  1.13375032e-01]
 [ 2.33905830e-01  4.07377784e-02 -1.36850920e-01]
 [-4.39069301e-02  6.82368389e-02  2.73409257e-02]
 [-7.80493957e-02 -7.36207240e-02 -2.02227624e-01]
 [ 8.01632929e-02  9.16031537e-02 -5.95428331e-02]
 [ 2.99760810e-02  1.40241011e-01  1.15177247e-02]
 [ 1.55694537e-02 -7.29909109e-02 -8.19220845e-02]
 [ 2.78930716e-01 -1.40898770e-01  1.28707029e-02]
 [-4.48610794e-02 -8.04339743e-02  6.64236880e-03]
 [-1.82892083e-01  7.60460093e-02  2.02157459e-02]
 [ 1.62759146e-01 -4.89193652e-02 -2.56410703e-02]
 [ 6.07969968e-03 -4.26833846e-02 -8.70017401e-02]
 [-2.22658043e-02  1.81489036e-02 -7.45219851e-02]
 [-4.20877313e-02  6.27662573e-02  3.05598333e-02]
 [-7.34410166e-01  3.67720948e-01  4.49141370e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.26023247 -29.25593426 -29.27334937]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  8.31486419  -9.25153874 -83.50871763]
init_Out:  [2.49911038]
Stock Position:  8.31486419409362
Bond position:  [-828.98730903]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-1.52035537]
curr_Stock_Price:  99.52905594519657
curr_Factors:  [99.52905595 -0.74956951 -1.01365602]
mat_Sqrt:  [[17.06831964  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00042438 -0.04017178 -0.11181141]
Stock Position:  -0.00042438371782675796
Bond Position:  [-1.47811686]


portfolio before change:  [-1.52070936]
curr_Stock_Price:  99.92777818188078
curr_Factors:  [99.92777818 -0.59450928 -0.99879243]
mat_Sqrt:  [[20.31066255  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0014318   0.00182938  0.11350232]
Stock Position:  -0.001431803263620741
Bond Position:  [-1.37763244]


portfolio before change:  [-1.52196751]
curr_Stock_Price:  100.68622284619954
curr_Factors:  [100.68622285  -0.58324306  -0.99315161]
mat_Sqrt:  [[20.81376008  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.0037913  0.03803444 0.10050072]
Stock Position:  0.0037913043028630854
Bond Position:  [-1.90369962]


portfolio before change:  [-1.52098918]
curr_Stock_Price:  101.0070383273155
curr_Factors:  [101.00703833  -0.67906337  -0.99173947]
mat_Sqrt:  [[18.99901929  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01107607 -0.00807594 -0.14166204]
Stock Position:  0.011076070594078747
Bond Position:  [-2.63975027]


portfolio before change:  [-1.53335445]
curr_Stock_Price:  99.92043662653795
curr_Factors:  [99.92043663 -0.56627557 -0.98480442]
mat_Sqrt:  [[21.18501837  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00325851 0.0092536  0.05667009]
Stock Position:  0.003258505400491262
Bond Position:  [-1.85894573]


portfolio before change:  [-1.53589546]
curr_Stock_Price:  99.2119426705986
curr_Factors:  [99.21194267 -0.44593489 -0.98001032]
mat_Sqrt:  [[23.83876856  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00081609  0.01660708 -0.04024005]
Stock Position:  0.0008160861422816366
Bond Position:  [-1.61686095]


portfolio before change:  [-1.53562771]
curr_Stock_Price:  99.78770757311013
curr_Factors:  [99.78770757 -0.2212826  -1.00902961]
mat_Sqrt:  [[29.15810138  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00535566  0.01787873 -0.23926854]
Stock Position:  -0.00535566135794496
Bond Position:  [-1.00119854]


portfolio before change:  [-1.53032952]
curr_Stock_Price:  98.77506953394825
curr_Factors:  [98.77506953 -0.23251546 -1.01237392]
mat_Sqrt:  [[28.44452955  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00417132 -0.00970451 -0.27060018]
Stock Position:  0.0041713189781233465
Bond Position:  [-1.94235184]


portfolio before change:  [-1.53770891]
curr_Stock_Price:  97.06419978541867
curr_Factors:  [97.06419979 -0.10825979 -1.01601533]
mat_Sqrt:  [[31.53498275  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00314261 -0.04099381 -0.29769311]
Stock Position:  -0.0031426125982748567
Bond Position:  [-1.23267374]


portfolio before change:  [-1.52669642]
curr_Stock_Price:  93.51091897927496
curr_Factors:  [ 9.35109190e+01 -1.80773589e-02 -1.04320183e+00]
mat_Sqrt:  [[32.35598526  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01203278 0.0378972  1.4041722 ]
Stock Position:  0.01203278255460975
Bond Position:  [-2.65189298]


portfolio before change:  [-1.52251293]
curr_Stock_Price:  93.88614380409713
curr_Factors:  [93.8861438  -0.3132159  -1.05082471]
mat_Sqrt:  [[23.99972081  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01075613 -0.03928226  0.24673653]
Stock Position:  -0.01075612631650286
Bond Position:  [-0.51266171]


portfolio before change:  [-1.52151392]
curr_Stock_Price:  93.78730726588314
curr_Factors:  [93.78730727 -0.51322227 -1.02302538]
mat_Sqrt:  [[20.18181353  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00256686 -0.07674521  0.25710917]
Stock Position:  0.002566863319393879
Bond Position:  [-1.76225312]


portfolio before change:  [-1.52038786]
curr_Stock_Price:  94.31182158139012
curr_Factors:  [94.31182158 -0.34956446 -1.05399708]
mat_Sqrt:  [[23.17432533  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00581885 -0.03998127 -0.0175328 ]
Stock Position:  -0.005818850492786444
Bond Position:  [-0.97160147]


portfolio before change:  [-1.53053057]
curr_Stock_Price:  96.03402690388054
curr_Factors:  [96.0340269  -0.81375411 -1.06539102]
mat_Sqrt:  [[14.66637486  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01515277 0.11682357 0.58708786]
Stock Position:  0.015152768831147391
Bond Position:  [-2.98571198]


portfolio before change:  [-1.52702175]
curr_Stock_Price:  96.29022158034384
curr_Factors:  [96.29022158 -0.95648065 -1.03232707]
mat_Sqrt:  [[13.17813557  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00314217 -0.17349495 -0.04729075]
Stock Position:  -0.0031421730998578666
Bond Position:  [-1.22446121]


portfolio before change:  [-1.52701903]
curr_Stock_Price:  96.24064272580918
curr_Factors:  [96.24064273 -0.87192806 -1.06197254]
mat_Sqrt:  [[13.91477404  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0051688  -0.00669572 -0.07234639]
Stock Position:  -0.00516880486080057
Bond Position:  [-1.02956993]


portfolio before change:  [-1.52769067]
curr_Stock_Price:  96.34568282716077
curr_Factors:  [96.34568283 -0.82033808 -1.0681742 ]
mat_Sqrt:  [[14.5767867   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00024306  0.03102196 -0.187776  ]
Stock Position:  0.00024305922050456595
Bond Position:  [-1.55110837]


portfolio before change:  [-1.5279867]
curr_Stock_Price:  95.92550888076548
curr_Factors:  [95.92550888 -0.90880839 -1.09093184]
mat_Sqrt:  [[12.98547871  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00609037  0.01479278 -0.34255589]
Stock Position:  -0.006090370600001569
Bond Position:  [-0.9437648]


portfolio before change:  [-1.52425264]
curr_Stock_Price:  95.29302994517161
curr_Factors:  [95.29302995 -0.94680728 -1.08881622]
mat_Sqrt:  [[12.44517715  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0027946  -0.0083607   0.40346258]
Stock Position:  -0.0027945954048688624
Bond Position:  [-1.25794718]


portfolio before change:  [-1.52372089]
curr_Stock_Price:  95.0464820404255
curr_Factors:  [95.04648204 -1.03404399 -1.09880359]
mat_Sqrt:  [[11.26294894  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.02003637 -0.05264812  0.24283729]
Stock Position:  0.020036374591799563
Bond Position:  [-3.42810781]


portfolio before change:  [-1.51788954]
curr_Stock_Price:  95.35890860474987
curr_Factors:  [95.3589086  -1.08155793 -1.06271916]
mat_Sqrt:  [[11.17155328  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.0168025  0.05454829 0.95266635]
Stock Position:  0.016802497597716452
Bond Position:  [-3.12015737]


portfolio before change:  [-1.51347836]
curr_Stock_Price:  95.64465296632395
curr_Factors:  [95.64465297 -1.04482247 -1.0799305 ]
mat_Sqrt:  [[11.4259471   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00114766 -0.03109399  0.4898554 ]
Stock Position:  0.0011476573981148276
Bond Position:  [-1.62324566]


portfolio before change:  [-1.5136525]
curr_Stock_Price:  95.66973611959706
curr_Factors:  [95.66973612 -0.81846028 -1.085019  ]
mat_Sqrt:  [[14.2594912   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-5.67709707e-03 -2.14120896e-04 -2.37836859e-01]
Stock Position:  -0.00567709706758155
Bond Position:  [-0.97052612]


portfolio before change:  [-1.51624]
curr_Stock_Price:  96.10414471352436
curr_Factors:  [96.10414471 -0.93702776 -1.06742032]
mat_Sqrt:  [[12.94855705  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.04091842  0.05049319  0.17712807]
Stock Position:  -0.04091842164119446
Bond Position:  [2.41618992]


portfolio before change:  [-1.5589247]
curr_Stock_Price:  97.15469210510057
curr_Factors:  [97.15469211 -1.06528375 -1.07799519]
mat_Sqrt:  [[11.39330082  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00527028 -0.06119152  0.32342741]
Stock Position:  -0.005270278061087428
Bond Position:  [-1.04689245]


portfolio before change:  [-1.56399317]
curr_Stock_Price:  98.09156898369717
curr_Factors:  [98.09156898 -0.90993282 -1.11835075]
mat_Sqrt:  [[12.90503895  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01604204  0.01288242 -0.39039758]
Stock Position:  0.016042035849474248
Bond Position:  [-3.13758163]


portfolio before change:  [-1.56806822]
curr_Stock_Price:  97.86199552216422
curr_Factors:  [97.86199552 -0.77420627 -1.13626751]
mat_Sqrt:  [[14.48457803  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00252435  0.02157838  0.07799605]
Stock Position:  -0.002524348261766492
Bond Position:  [-1.32103046]


portfolio before change:  [-1.5677535]
curr_Stock_Price:  97.67190524797022
curr_Factors:  [97.67190525 -0.74791339 -1.13004851]
mat_Sqrt:  [[14.93417282  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00811761 -0.02328092 -0.57689912]
Stock Position:  -0.0081176116655653
Bond Position:  [-0.7748909]


portfolio before change:  [-1.5649515]
curr_Stock_Price:  97.31479655730121
curr_Factors:  [97.31479656 -0.74759166 -1.11914542]
mat_Sqrt:  [[15.04753173  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0046768   0.02896746 -0.16985913]
Stock Position:  0.004676803311228029
Bond Position:  [-2.02007366]


portfolio before change:  [-1.55797372]
curr_Stock_Price:  98.86079007009084
curr_Factors:  [98.86079007 -0.64341392 -1.12673299]
mat_Sqrt:  [[16.8367801   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.0021351  0.0443481  0.03285686]
Stock Position:  0.0021350955377513535
Bond Position:  [-1.76905095]


portfolio before change:  [-1.55821098]
curr_Stock_Price:  98.85324315430687
curr_Factors:  [98.85324315 -0.5877753  -1.10558842]
mat_Sqrt:  [[18.17910107  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-1.67084116e-04 -2.30817527e-02 -2.33700904e-01]
Stock Position:  -0.00016708411587260433
Bond Position:  [-1.54169417]


portfolio before change:  [-1.55823349]
curr_Stock_Price:  97.83451660671166
curr_Factors:  [97.83451661 -0.53042993 -1.1126689 ]
mat_Sqrt:  [[18.91922531  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01468982 -0.0445561   0.03671653]
Stock Position:  0.014689816413873432
Bond Position:  [-2.99540457]


portfolio before change:  [-1.553439]
curr_Stock_Price:  98.18638865680948
curr_Factors:  [98.18638866 -0.49823535 -1.11952262]
mat_Sqrt:  [[19.47457237  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00234059 -0.02543546  0.01894883]
Stock Position:  -0.0023405909486045573
Bond Position:  [-1.32362483]


portfolio before change:  [-1.55082786]
curr_Stock_Price:  97.00010529316896
curr_Factors:  [97.00010529 -0.70694393 -1.11796836]
mat_Sqrt:  [[15.6395002   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01130484  0.02404786  0.0576699 ]
Stock Position:  -0.011304840905658368
Bond Position:  [-0.4542571]


portfolio before change:  [-1.5361857]
curr_Stock_Price:  95.69987052442046
curr_Factors:  [95.69987052 -0.68988442 -1.10850507]
mat_Sqrt:  [[15.84457942  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00986218 -0.01546966 -0.07314684]
Stock Position:  0.009862179841153071
Bond Position:  [-2.47999503]


portfolio before change:  [-1.52636148]
curr_Stock_Price:  96.72745676345934
curr_Factors:  [96.72745676 -0.76457878 -1.08415235]
mat_Sqrt:  [[15.2284619   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00083932 -0.01349767 -0.24819175]
Stock Position:  -0.0008393189337588704
Bond Position:  [-1.44517629]


portfolio before change:  [-1.52723268]
curr_Stock_Price:  97.55020074627997
curr_Factors:  [97.55020075 -1.0461794  -1.0788559 ]
mat_Sqrt:  [[11.65029877  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00317665  0.00573919 -0.21259048]
Stock Position:  -0.0031766514211500653
Bond Position:  [-1.21734969]


portfolio before change:  [-1.53129244]
curr_Stock_Price:  98.78029667438133
curr_Factors:  [98.78029667 -1.51285923 -1.06738267]
mat_Sqrt:  [[ 7.48316822  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00457415  0.01984843  0.0871787 ]
Stock Position:  -0.004574147294281898
Bond Position:  [-1.07945682]


portfolio before change:  [-1.52981063]
curr_Stock_Price:  98.42684274939235
curr_Factors:  [98.42684275 -1.51659416 -1.11042036]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-1.52981063]
Stock Price:  98.54999534579864
PL:  [-1.52981063]
Settle:  Tensor("sub_124:0", shape=(), dtype=float64)
PL:  Tensor("sub_125:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  63
output_Z_Vals[:, i, :]:  [[ 1.19260232e+02 -2.92559343e+01 -2.92733494e+01]
 [ 7.97097401e-03 -8.73471574e-02 -3.60004285e-02]
 [-3.18191599e-02  3.10828851e-02  7.47096030e-02]
 [-9.21532593e-02  4.81467877e-02  8.60680474e-03]
 [-5.44673031e-02  6.75846708e-02 -7.04924150e-02]
 [ 5.99753466e-02  2.87314266e-02  2.77904939e-02]
 [ 4.03084250e-02  3.81093817e-02 -4.01746204e-02]
 [-8.42605523e-02  2.69023256e-02 -8.79059513e-02]
 [ 9.57361313e-02 -3.73970399e-02 -4.13414599e-02]
 [-6.06999321e-02  1.42342975e-01  2.80336857e-02]
 [ 6.20379086e-02  1.30160626e-01 -8.90736287e-02]
 [-5.52309138e-02 -7.17697690e-02 -5.05882169e-03]
 [-7.69095681e-02  6.80505070e-03  1.56462194e-02]
 [-9.62623594e-02 -1.14884369e-01  6.32126881e-02]
 [ 1.55170801e-01  8.16553284e-02 -1.01380757e-01]
 [-8.16921533e-02 -1.07917246e-01 -1.18050859e-01]
 [-6.79365509e-02 -6.32693418e-02 -3.99695532e-02]
 [-9.84158711e-02 -2.07772350e-02  8.80259017e-02]
 [ 2.87667473e-02  5.12357982e-02  6.67692012e-03]
 [ 1.67188874e-01 -3.60492119e-02 -3.99061482e-03]
 [ 2.32757350e-02  2.73256424e-02  8.89057718e-02]
 [-7.28322549e-03 -4.14609545e-04 -7.23180623e-03]
 [-1.32508230e-01  2.95653873e-01  3.87001711e-01]
 [ 2.30036217e-01 -3.18691824e-02  3.59896817e-02]
 [-1.23245159e-01 -4.52500134e-02 -1.14273314e-01]
 [ 1.07435790e-01 -8.51336835e-03  5.65520338e-02]
 [-8.98676890e-02  8.51251123e-02  1.03037114e-01]
 [-3.86810145e-02  6.41421587e-02  2.57992262e-02]
 [ 4.34826777e-02  9.33903015e-03  1.06013199e-01]
 [-1.07416063e-01 -1.70271004e-01  1.30651733e-02]
 [-1.49961568e-01  6.84769093e-01 -1.92814328e-02]
 [ 4.16731762e-02  8.55303164e-02  1.95014101e-01]
 [-9.03437621e-02  2.66092956e-02  8.50899976e-02]
 [-8.07528424e-02 -7.68781083e-02 -1.02727253e-03]
 [-1.83541663e-01  2.08058848e-01  3.20691905e-02]
 [ 1.01529251e-01 -1.57904173e-01 -1.30131572e-01]
 [-2.29901701e-01 -4.00101490e-01  8.42618358e-02]
 [-5.39898778e-02 -5.83713757e-02  7.73606077e-02]
 [-2.10996549e-02  4.59839666e-02 -3.52334905e-02]
 [ 1.51479558e-02  2.63570179e-02 -2.74032319e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.26023247 -29.25593426 -29.27334937]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  8.31486419  -9.25153874 -83.50871763]
init_Out:  [2.49911038]
Stock Position:  8.31486419409362
Bond position:  [-828.98730903]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [1.39165992]
curr_Stock_Price:  99.87927396744143
curr_Factors:  [99.87927397 -1.09660347 -0.98731223]
mat_Sqrt:  [[12.42917457  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00013137 -0.0276216  -0.1026992 ]
Stock Position:  -0.000131374500325614
Bond Position:  [1.40478151]


portfolio before change:  [1.39185142]
curr_Stock_Price:  99.7583795505451
curr_Factors:  [99.75837955 -0.85831698 -1.0057318 ]
mat_Sqrt:  [[15.46690043  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00101937  0.00982927  0.2131257 ]
Stock Position:  -0.0010193748550612377
Bond Position:  [1.4935426]


portfolio before change:  [1.39294079]
curr_Stock_Price:  98.87287056136499
curr_Factors:  [98.87287056 -0.70387643 -0.98926027]
mat_Sqrt:  [[18.18683875  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00490208  0.01522535  0.02455282]
Stock Position:  -0.004902075570573943
Bond Position:  [1.87762307]


portfolio before change:  [1.39903663]
curr_Stock_Price:  97.677227754297
curr_Factors:  [97.67722775 -0.82537543 -0.98945151]
mat_Sqrt:  [[15.90830835  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00421864  0.02137215 -0.20109524]
Stock Position:  -0.004218643296991808
Bond Position:  [1.81110202]


portfolio before change:  [1.39792755]
curr_Stock_Price:  97.99379564488184
curr_Factors:  [97.99379564 -0.65302867 -1.00606275]
mat_Sqrt:  [[18.6493772   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.0035599  0.00908567 0.07927854]
Stock Position:  0.003559899020096059
Bond Position:  [1.04907953]


portfolio before change:  [1.3998004]
curr_Stock_Price:  98.48305419601334
curr_Factors:  [98.4830542  -0.56652706 -0.99942177]
mat_Sqrt:  [[20.57209752  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00160858  0.01205124 -0.11460701]
Stock Position:  0.001608576614907329
Bond Position:  [1.24138287]


portfolio before change:  [1.39939995]
curr_Stock_Price:  98.13763580175191
curr_Factors:  [98.1376358  -0.55926617 -0.99743493]
mat_Sqrt:  [[20.69040033  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00490612  0.00850726 -0.25077121]
Stock Position:  -0.004906123748440591
Bond Position:  [1.88087534]


portfolio before change:  [1.39380585]
curr_Stock_Price:  99.32578979736327
curr_Factors:  [99.3257898  -0.53033309 -0.99413581]
mat_Sqrt:  [[21.62686637  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00399188 -0.01182598 -0.11793568]
Stock Position:  0.003991875302139747
Bond Position:  [0.99730968]


portfolio before change:  [1.394427]
curr_Stock_Price:  99.45016186216208
curr_Factors:  [99.45016186 -0.50860269 -0.99446033]
mat_Sqrt:  [[22.1224651   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00231901  0.0450128   0.0799723 ]
Stock Position:  -0.0023190137231451835
Bond Position:  [1.62505329]


portfolio before change:  [1.39568836]
curr_Stock_Price:  98.99383727676941
curr_Factors:  [98.99383728 -0.60220917 -1.00988179]
mat_Sqrt:  [[19.7463101   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00239116  0.0411604  -0.25410227]
Stock Position:  0.0023911588015155943
Bond Position:  [1.15897838]


portfolio before change:  [1.396911]
curr_Stock_Price:  99.44456274146378
curr_Factors:  [99.44456274 -0.65519251 -1.00506148]
mat_Sqrt:  [[18.9034858   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00307439 -0.02269559 -0.01443141]
Stock Position:  -0.003074386891938597
Bond Position:  [1.70264206]


portfolio before change:  [1.40228049]
curr_Stock_Price:  97.7672706698677
curr_Factors:  [97.76727067 -0.47502136 -0.99432201]
mat_Sqrt:  [[22.49395243  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00326933  0.00215195  0.04463431]
Stock Position:  -0.00326932723434081
Bond Position:  [1.72191369]


portfolio before change:  [1.39943136]
curr_Stock_Price:  98.70458252241261
curr_Factors:  [98.70458252 -0.44928371 -0.98238599]
mat_Sqrt:  [[23.58148028  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00366073 -0.03632963  0.1803282 ]
Stock Position:  -0.003660729695799868
Bond Position:  [1.76076216]


portfolio before change:  [1.39622686]
curr_Stock_Price:  99.64008372266859
curr_Factors:  [99.64008372 -0.36031202 -0.97936245]
mat_Sqrt:  [[26.09881886  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00523337  0.02582168 -0.28921108]
Stock Position:  0.005233373698469537
Bond Position:  [0.87477306]


portfolio before change:  [1.40133289]
curr_Stock_Price:  100.59485540490644
curr_Factors:  [100.5948554   -0.32029305  -0.97452944]
mat_Sqrt:  [[27.55760752  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00393995 -0.03412643 -0.33676624]
Stock Position:  -0.003939949982454342
Bond Position:  [1.79767159]


portfolio before change:  [1.40410388]
curr_Stock_Price:  99.94858567042638
curr_Factors:  [ 9.99485857e+01 -9.35063702e-02 -9.45762019e-01]
mat_Sqrt:  [[35.35315085  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00219864 -0.02000752 -0.11402201]
Stock Position:  -0.002198641627268425
Bond Position:  [1.623855]


portfolio before change:  [1.40415406]
curr_Stock_Price:  100.01808995019842
curr_Factors:  [100.01808995  -0.10385786  -0.9118594 ]
mat_Sqrt:  [[36.22080984  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00223585 -0.00657034  0.2511134 ]
Stock Position:  -0.0022358452331605653
Bond Position:  [1.62777903]


portfolio before change:  [1.40328422]
curr_Stock_Price:  100.4981409700111
curr_Factors:  [100.49814097  -0.25669517  -0.91230106]
mat_Sqrt:  [[31.22262508  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00100736 0.01620218 0.01904739]
Stock Position:  0.001007364706901948
Bond Position:  [1.30204594]


portfolio before change:  [1.40291556]
curr_Stock_Price:  99.97060029421361
curr_Factors:  [ 9.99706003e+01 -5.66827673e-02 -9.10206255e-01]
mat_Sqrt:  [[38.01523966  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00435203 -0.01139976 -0.01138411]
Stock Position:  0.00435203113196601
Bond Position:  [0.9678404]


portfolio before change:  [1.41152449]
curr_Stock_Price:  101.92093961097821
curr_Factors:  [101.92093961  -0.25446949  -0.90976646]
mat_Sqrt:  [[31.81575047  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00132416 0.00864113 0.25362342]
Stock Position:  0.0013241584456052309
Bond Position:  [1.27656502]


portfolio before change:  [1.41242177]
curr_Stock_Price:  102.47805028022107
curr_Factors:  [102.47805028  -0.35421587  -0.88547127]
mat_Sqrt:  [[29.66480986  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00029564 -0.00013111 -0.02063033]
Stock Position:  -0.00029564042263383793
Bond Position:  [1.44271843]


portfolio before change:  [1.4123536]
curr_Stock_Price:  103.3186778147518
curr_Factors:  [103.31867781  -0.39494019  -0.86593323]
mat_Sqrt:  [[29.28117322  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00156681  0.09349396  1.10400816]
Stock Position:  -0.0015668117501078456
Bond Position:  [1.57423452]


portfolio before change:  [1.41043039]
curr_Stock_Price:  104.67174248190642
curr_Factors:  [104.67174248  -0.33672604  -0.88182062]
mat_Sqrt:  [[30.94720001  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00764398 -0.01007792  0.10266854]
Stock Position:  0.007643978180050077
Bond Position:  [0.61032188]


portfolio before change:  [1.4208733]
curr_Stock_Price:  106.02792264056852
curr_Factors:  [106.02792264  -0.30638874  -0.89921047]
mat_Sqrt:  [[31.7566853   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00465223 -0.01430931 -0.32598996]
Stock Position:  -0.0046522315097339
Bond Position:  [1.91413974]


portfolio before change:  [1.41614322]
curr_Stock_Price:  107.09609091947073
curr_Factors:  [ 1.07096091e+02 -3.43299995e-02 -9.18080770e-01]
mat_Sqrt:  [[41.31872174  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00287423 -0.00269216  0.16132721]
Stock Position:  0.002874232463347893
Bond Position:  [1.10832416]


portfolio before change:  [1.41507508]
curr_Stock_Price:  106.67626002404951
curr_Factors:  [ 1.06676260e+02  5.47515757e-02 -9.10279571e-01]
mat_Sqrt:  [[45.34367272  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00146961  0.02691892  0.29393621]
Stock Position:  -0.0014696075846247895
Bond Position:  [1.57184732]


portfolio before change:  [1.41006205]
curr_Stock_Price:  110.2210937210629
curr_Factors:  [ 1.10221094e+02  6.62136984e-02 -8.89978891e-01]
mat_Sqrt:  [[48.3624216   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00065668  0.02028353  0.07359801]
Stock Position:  -0.0006566798158024671
Bond Position:  [1.48244202]


portfolio before change:  [1.41150162]
curr_Stock_Price:  108.31111473237522
curr_Factors:  [ 1.08311115e+02  1.00984635e-02 -8.98730603e-01]
mat_Sqrt:  [[44.53946446  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00146754 0.00295326 0.30242615]
Stock Position:  0.001467544900890129
Bond Position:  [1.25255019]


portfolio before change:  [1.41187058]
curr_Stock_Price:  108.4558338602757
curr_Factors:  [ 1.08455834e+02  3.86301742e-02 -8.99341943e-01]
mat_Sqrt:  [[45.86174192  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00237988 -0.05384442  0.0372713 ]
Stock Position:  -0.0023798817753150204
Bond Position:  [1.66998264]


portfolio before change:  [1.41648271]
curr_Stock_Price:  106.60558653315087
curr_Factors:  [ 1.06605587e+02  6.15725849e-02 -8.72829628e-01]
mat_Sqrt:  [[47.36477805  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00287591  0.216543   -0.05500456]
Stock Position:  -0.002875907317605007
Bond Position:  [1.72307049]


portfolio before change:  [1.41520882]
curr_Stock_Price:  107.12343632170644
curr_Factors:  [107.12343632   0.27413924  -0.86867404]
mat_Sqrt:  [[59.11277025  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00141575 0.02704706 0.55632095]
Stock Position:  0.0014157456285022313
Bond Position:  [1.26354928]


portfolio before change:  [1.41670014]
curr_Stock_Price:  108.06524946415225
curr_Factors:  [108.06524946   0.21873499  -0.90905903]
mat_Sqrt:  [[54.18538195  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00133408  0.0084146   0.24273808]
Stock Position:  -0.0013340828736214015
Bond Position:  [1.56086814]


portfolio before change:  [1.42138988]
curr_Stock_Price:  104.69618069728911
curr_Factors:  [104.6961807    0.17015588  -0.94434024]
mat_Sqrt:  [[48.27328403  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00171829 -0.02431099 -0.00293052]
Stock Position:  -0.0017182903420845498
Bond Position:  [1.60128831]


portfolio before change:  [1.42214831]
curr_Stock_Price:  104.37128499450874
curr_Factors:  [ 1.04371285e+02 -5.77745471e-02 -9.08521947e-01]
mat_Sqrt:  [[39.7121861   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00432168  0.06579398  0.09148447]
Stock Position:  -0.004321683773214673
Bond Position:  [1.873208]


portfolio before change:  [1.41026785]
curr_Stock_Price:  107.17450455993578
curr_Factors:  [ 1.07174505e+02  5.80987968e-02 -8.91114769e-01]
mat_Sqrt:  [[46.59263201  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00152147 -0.04993368 -0.37122915]
Stock Position:  0.0015214677427856393
Bond Position:  [1.2472053]


portfolio before change:  [1.4116087]
curr_Stock_Price:  107.95331762649641
curr_Factors:  [ 1.07953318e+02  4.90412704e-02 -8.71512266e-01]
mat_Sqrt:  [[47.42871722  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00470248 -0.1265232   0.24037556]
Stock Position:  -0.004702475934362836
Bond Position:  [1.91925658]


portfolio before change:  [1.42728269]
curr_Stock_Price:  104.6712029481567
curr_Factors:  [ 1.04671203e+02  6.59397315e-02 -8.63002264e-01]
mat_Sqrt:  [[47.17016069  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00084176 -0.01845865  0.22068828]
Stock Position:  -0.0008417578356219515
Bond Position:  [1.51539049]


portfolio before change:  [1.42518354]
curr_Stock_Price:  107.3900198501052
curr_Factors:  [ 1.07390020e+02  7.82244933e-03 -8.63972338e-01]
mat_Sqrt:  [[45.61868376  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00059415  0.01454141 -0.10051134]
Stock Position:  -0.0005941504194911613
Bond Position:  [1.48898936]


portfolio before change:  [1.42675974]
curr_Stock_Price:  105.05042583273534
curr_Factors:  [105.05042583   0.11317332  -0.88574602]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [1.42675974]
Stock Price:  109.68884126406316
PL:  [-8.26208152]
Settle:  Tensor("sub_126:0", shape=(), dtype=float64)
PL:  Tensor("sub_127:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  64
output_Z_Vals[:, i, :]:  [[ 1.19260232e+02 -2.92559343e+01 -2.92733494e+01]
 [ 8.14093534e-04 -8.52978849e-02 -3.07961391e-02]
 [-5.82612689e-02 -1.03613966e-03  9.72088567e-02]
 [-5.55929345e-02  1.02876024e-01  1.17974163e-02]
 [ 1.56705726e-02  3.77835360e-02 -7.16733288e-02]
 [ 6.17566223e-02  2.90886895e-02  2.35682037e-02]
 [ 2.76507223e-02  4.72182186e-02 -2.30597598e-02]
 [-9.30917788e-02 -5.14827308e-03 -9.95947963e-02]
 [ 1.36535211e-01 -2.94421615e-02 -9.37577066e-02]
 [-8.46700809e-02 -1.35252651e-01 -1.03561112e-01]
 [ 2.47010173e-01  1.11229261e-01  3.80901498e-01]
 [-2.45344272e-01 -1.14348471e-01  7.00124205e-02]
 [ 3.31522052e-02 -1.60662905e-01  1.08203387e-01]
 [-1.34532503e-01 -1.28095667e-01  3.61376948e-02]
 [ 8.07400951e-02  1.76602666e-01  1.03463296e-01]
 [-6.83200110e-02 -4.98227066e-01 -5.06965448e-02]
 [-6.69112550e-02 -2.48201940e-02 -5.10616068e-02]
 [ 5.47080019e-02  7.77800778e-02 -1.14632293e-01]
 [ 4.93822241e-02  4.29899340e-02  7.02737264e-03]
 [-5.95694320e-02 -2.44661963e-02  1.36554271e-01]
 [ 1.59905929e-01 -1.47451967e-01  9.18663795e-02]
 [ 1.22569098e-01 -3.92733751e-02  2.09418629e-01]
 [-6.74748102e-02  6.08171082e-02  3.35861169e-01]
 [ 1.18783662e-02 -1.67761199e-02 -7.38456113e-02]
 [-1.21475002e-01  6.49728622e-02  9.81467075e-02]
 [-4.92558241e-02 -1.61287636e-01  1.04132887e-01]
 [ 2.19172619e-01  4.39201462e-02 -1.32690438e-01]
 [-5.07806065e-02  7.36225950e-02  2.93687317e-02]
 [-5.42393643e-02 -7.47957017e-02 -2.04396447e-01]
 [ 1.03482129e-01  1.19598123e-01 -3.71199427e-02]
 [ 1.57399573e-02  1.75664425e-01  1.32413557e-02]
 [ 2.20430633e-02 -7.90096855e-02 -8.11032003e-02]
 [ 2.28710332e-01 -1.70981296e-01 -6.57335186e-02]
 [-4.74393384e-02 -8.29510268e-02 -4.50415075e-04]
 [-1.77752363e-01  9.55366224e-02  2.36376323e-02]
 [ 6.09589228e-02 -1.45345069e-01 -1.27773197e-01]
 [-4.52957446e-02 -1.76048849e-01 -3.34916881e-02]
 [-2.23707405e-02  1.83257252e-02 -7.40751349e-02]
 [-3.62718016e-02  3.68994744e-02  2.04220774e-02]
 [-8.23530510e-01  4.09330803e-01  5.04873009e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.26023247 -29.25593426 -29.27334937]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  8.31486419  -9.25153874 -83.50871763]
init_Out:  [2.49911038]
Stock Position:  8.31486419409362
Bond position:  [-828.98730903]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [2.94453996]
curr_Stock_Price:  100.06603348616578
curr_Factors:  [100.06603349  -0.76625524  -1.01454425]
mat_Sqrt:  [[16.86146458  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00045515 -0.02697356 -0.08785281]
Stock Position:  -0.00045515168191326803
Bond Position:  [2.99008518]


portfolio before change:  [2.94546298]
curr_Stock_Price:  98.85932087255847
curr_Factors:  [98.85932087 -0.85548407 -1.02598598]
mat_Sqrt:  [[15.06279494  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00255234 -0.00032766  0.27730981]
Stock Position:  -0.0025523382140458855
Bond Position:  [3.1977854]


portfolio before change:  [2.94519351]
curr_Stock_Price:  99.12151971330617
curr_Factors:  [99.12151971 -0.76132882 -1.01217745]
mat_Sqrt:  [[16.82456958  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00300326  0.03253226  0.03365475]
Stock Position:  -0.003003259561360995
Bond Position:  [3.24288116]


portfolio before change:  [2.94695398]
curr_Stock_Price:  98.67031433678164
curr_Factors:  [98.67031434 -0.5009794  -1.00096797]
mat_Sqrt:  [[21.97349089  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 9.17415622e-05  1.19482032e-02 -2.04464057e-01]
Stock Position:  9.174156220198626e-05
Bond Position:  [2.93790181]


portfolio before change:  [2.94727754]
curr_Stock_Price:  98.19394014012312
curr_Factors:  [98.19394014 -0.4200922  -0.99612785]
mat_Sqrt:  [[23.82473805  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00282557 0.00919865 0.06723353]
Stock Position:  0.002825572661194693
Bond Position:  [2.66982343]


portfolio before change:  [2.94908302]
curr_Stock_Price:  98.71480004807164
curr_Factors:  [98.71480005 -0.46618566 -0.99844701]
mat_Sqrt:  [[22.81919828  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00105888  0.01493171 -0.06578308]
Stock Position:  0.0010588819728429432
Bond Position:  [2.84455569]


portfolio before change:  [2.94946959]
curr_Stock_Price:  98.7440580948651
curr_Factors:  [98.74405809 -0.40114263 -1.00094442]
mat_Sqrt:  [[24.2992185   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00467317 -0.00162803 -0.28411623]
Stock Position:  -0.004673171252106958
Bond Position:  [3.41091748]


portfolio before change:  [2.94928967]
curr_Stock_Price:  98.87380104756532
curr_Factors:  [98.87380105 -0.22766877 -1.01037851]
mat_Sqrt:  [[28.66844439  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00406847 -0.00931043 -0.26746464]
Stock Position:  0.004068473505005418
Bond Position:  [2.54702423]


portfolio before change:  [2.9419337]
curr_Stock_Price:  96.98749948175207
curr_Factors:  [96.98749948 -0.23997014 -1.02967348]
mat_Sqrt:  [[27.24686532  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00401153 -0.04277064 -0.29543103]
Stock Position:  -0.004011529822826711
Bond Position:  [3.33100194]


portfolio before change:  [2.95314032]
curr_Stock_Price:  94.29769725639937
curr_Factors:  [94.29769726 -0.21954963 -1.03949758]
mat_Sqrt:  [[26.77341881  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01223726 0.03517378 1.08660595]
Stock Position:  0.012237260233180395
Bond Position:  [1.79919486]


portfolio before change:  [2.95938268]
curr_Stock_Price:  94.78942901288725
curr_Factors:  [94.78942901 -0.13065283 -1.03654114]
mat_Sqrt:  [[29.50217308  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00793181 -0.03616016  0.19972595]
Stock Position:  -0.007931805935966972
Bond Position:  [3.71123404]


portfolio before change:  [2.96099178]
curr_Stock_Price:  94.64505355589606
curr_Factors:  [94.64505356 -0.21732822 -1.0368373 ]
mat_Sqrt:  [[27.00354332  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.001892   -0.05080607  0.30867415]
Stock Position:  0.0018920046942705912
Bond Position:  [2.78192289]


portfolio before change:  [2.96264196]
curr_Stock_Price:  95.33343621626862
curr_Factors:  [95.33343622 -0.25102549 -1.03690991]
mat_Sqrt:  [[26.29674593  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0049612  -0.04050741  0.10309078]
Stock Position:  -0.004961197234474056
Bond Position:  [3.43560994]


portfolio before change:  [2.96055751]
curr_Stock_Price:  95.84015357697753
curr_Factors:  [95.84015358 -0.12172883 -1.02931607]
mat_Sqrt:  [[30.31482417  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00351047 0.05584667 0.29515198]
Stock Position:  0.003510471067162174
Bond Position:  [2.62411343]


portfolio before change:  [2.96644679]
curr_Stock_Price:  97.42434152818436
curr_Factors:  [97.42434153 -0.18026252 -1.01668661]
mat_Sqrt:  [[29.43330838  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00310983 -0.15755323 -0.14462313]
Stock Position:  -0.0031098293892670398
Bond Position:  [3.26941988]


portfolio before change:  [2.96716835]
curr_Stock_Price:  97.32374173030715
curr_Factors:  [97.32374173 -0.40473729 -1.02108253]
mat_Sqrt:  [[23.38800171  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00333398 -0.00784883 -0.14566455]
Stock Position:  -0.0033339751507419145
Bond Position:  [3.29164328]


portfolio before change:  [2.9711338]
curr_Stock_Price:  96.25775557096382
curr_Factors:  [96.25775557 -0.43051495 -0.9996407 ]
mat_Sqrt:  [[23.03175437  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00144657  0.02459622 -0.32701402]
Stock Position:  0.0014465704873728538
Bond Position:  [2.83189017]


portfolio before change:  [2.97332484]
curr_Stock_Price:  97.52767766975411
curr_Factors:  [97.52767767 -0.38556429 -0.99655278]
mat_Sqrt:  [[24.48398279  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00212084 0.01359461 0.02004714]
Stock Position:  0.002120842688443614
Bond Position:  [2.76648398]


portfolio before change:  [2.9673151]
curr_Stock_Price:  94.5309592507987
curr_Factors:  [94.53095925 -0.4622182  -1.00630769]
mat_Sqrt:  [[21.76714022  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00148513 -0.00773689  0.38955133]
Stock Position:  -0.0014851341223663505
Bond Position:  [3.10770626]


portfolio before change:  [2.9673133]
curr_Stock_Price:  94.7937549939306
curr_Factors:  [94.79375499 -0.39820168 -0.98405778]
mat_Sqrt:  [[23.79425278  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00734845 -0.04662841  0.26206921]
Stock Position:  0.007348450217319077
Bond Position:  [2.27072611]


portfolio before change:  [2.98603489]
curr_Stock_Price:  97.30281884582506
curr_Factors:  [97.30281885 -0.41376566 -1.02248937]
mat_Sqrt:  [[23.1402362   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00710029 -0.01241933  0.59741306]
Stock Position:  0.007100293214283193
Bond Position:  [2.29515635]


portfolio before change:  [2.98831948]
curr_Stock_Price:  97.5841696279589
curr_Factors:  [97.58416963 -0.38964096 -1.00599121]
mat_Sqrt:  [[24.16929717  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [1.09761356e-04 1.92320583e-02 9.58118430e-01]
Stock Position:  0.00010976135563833202
Bond Position:  [2.97760851]


portfolio before change:  [2.98892338]
curr_Stock_Price:  99.69495439370294
curr_Factors:  [99.69495439 -0.35858838 -1.04239425]
mat_Sqrt:  [[24.56032738  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-1.47736780e-04 -5.30507492e-03 -2.10660975e-01]
Stock Position:  -0.00014773677956581211
Bond Position:  [3.003652]


portfolio before change:  [2.98935749]
curr_Stock_Price:  99.29811183704156
curr_Factors:  [99.29811184 -0.35491505 -1.05404713]
mat_Sqrt:  [[24.26813996  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00411088  0.02054622  0.27998524]
Stock Position:  -0.004110875286935575
Bond Position:  [3.39755965]


portfolio before change:  [2.99660649]
curr_Stock_Price:  97.63805784433436
curr_Factors:  [ 9.76380578e+01 -8.87198500e-02 -1.07394121e+00]
mat_Sqrt:  [[30.52683985  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00105364 -0.05100363  0.29706214]
Stock Position:  -0.0010536372783033802
Bond Position:  [3.09948159]


portfolio before change:  [2.99658511]
curr_Stock_Price:  98.02608805328721
curr_Factors:  [98.02608805 -0.1788664  -1.06929895]
mat_Sqrt:  [[28.13651798  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00686728  0.01388877 -0.37852889]
Stock Position:  0.006867278667364277
Bond Position:  [2.32341264]


portfolio before change:  [2.99501714]
curr_Stock_Price:  97.7554701017488
curr_Factors:  [97.7554701  -0.31124946 -1.06312259]
mat_Sqrt:  [[24.73197936  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00173398  0.02328151  0.08378082]
Stock Position:  -0.00173398220130615
Bond Position:  [3.16452339]


portfolio before change:  [2.99389689]
curr_Stock_Price:  98.62966694286006
curr_Factors:  [98.62966694 -0.40012249 -1.01505465]
mat_Sqrt:  [[23.95542841  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00408646 -0.02365248 -0.58308617]
Stock Position:  -0.004086457126044467
Bond Position:  [3.3969428]


portfolio before change:  [2.99981191]
curr_Stock_Price:  97.28611346200394
curr_Factors:  [97.28611346 -0.33455286 -1.01327879]
mat_Sqrt:  [[25.27522364  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0039166   0.03782025 -0.10589286]
Stock Position:  0.003916604799100658
Bond Position:  [2.61878065]


portfolio before change:  [3.00872805]
curr_Stock_Price:  99.47902702467212
curr_Factors:  [99.47902702 -0.51609493 -1.05655313]
mat_Sqrt:  [[20.64140009  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00111322 0.05554997 0.0377739 ]
Stock Position:  0.0011132226261036757
Bond Position:  [2.89798575]


portfolio before change:  [3.0079462]
curr_Stock_Price:  98.45126879392215
curr_Factors:  [98.45126879 -0.52117424 -1.04394217]
mat_Sqrt:  [[20.5825841   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 1.67516410e-04 -2.49850563e-02 -2.31364856e-01]
Stock Position:  0.00016751641028100246
Bond Position:  [2.991454]


portfolio before change:  [3.00838649]
curr_Stock_Price:  98.84725056193751
curr_Factors:  [98.84725056 -0.78661008 -1.04487538]
mat_Sqrt:  [[15.83290347  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01331896 -0.05406903 -0.18751943]
Stock Position:  0.01331896049459718
Bond Position:  [1.69184386]


portfolio before change:  [3.00451441]
curr_Stock_Price:  98.54065255500741
curr_Factors:  [98.54065256 -0.94899073 -1.03100613]
mat_Sqrt:  [[13.60547543  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00365096 -0.02623142 -0.00128491]
Stock Position:  -0.0036509613765114616
Bond Position:  [3.36428253]


portfolio before change:  [3.00392774]
curr_Stock_Price:  98.81653450523905
curr_Factors:  [98.81653451 -0.91204671 -1.04129012]
mat_Sqrt:  [[14.01219635  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01216516  0.03021133  0.06743159]
Stock Position:  -0.01216515968247706
Bond Position:  [4.20604666]


portfolio before change:  [2.99999753]
curr_Stock_Price:  99.18282632611954
curr_Factors:  [99.18282633 -1.19374687 -1.05455661]
mat_Sqrt:  [[10.47154303  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0029723  -0.04596215 -0.36450137]
Stock Position:  0.0029722968726225616
Bond Position:  [2.70519673]


portfolio before change:  [2.99910476]
curr_Stock_Price:  98.76868700855017
curr_Factors:  [98.76868701 -1.1237529  -1.02495591]
mat_Sqrt:  [[11.51985207  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00492001 -0.05567153 -0.09554246]
Stock Position:  -0.004920008366666235
Bond Position:  [3.48504752]


portfolio before change:  [3.00291771]
curr_Stock_Price:  98.08224537253857
curr_Factors:  [98.08224537 -1.05372541 -1.00738575]
mat_Sqrt:  [[12.48708863  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00296451  0.0057951  -0.21131574]
Stock Position:  -0.0029645097407716894
Bond Position:  [3.29368349]


portfolio before change:  [3.00133417]
curr_Stock_Price:  98.75530265964794
curr_Factors:  [98.75530266 -1.16462261 -1.0298674 ]
mat_Sqrt:  [[11.0028584   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00283112  0.01166864  0.0582585 ]
Stock Position:  -0.0028311208870177686
Bond Position:  [3.28092237]


portfolio before change:  [3.00348526]
curr_Stock_Price:  98.140369749077
curr_Factors:  [98.14036975 -1.06917592 -1.01703756]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [3.00348526]
Stock Price:  98.30377666130512
PL:  [3.00348526]
Settle:  Tensor("sub_128:0", shape=(), dtype=float64)
PL:  Tensor("sub_129:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  65
output_Z_Vals[:, i, :]:  [[ 1.19260232e+02 -2.92559343e+01 -2.92733494e+01]
 [ 6.70353351e-03 -1.00133711e-01 -3.70295523e-02]
 [-2.73613999e-02  5.14658749e-02  1.02847116e-01]
 [ 8.34370161e-02  1.56398418e-01  3.77706510e-02]
 [ 2.19981304e-01 -2.65219198e-02 -5.15421252e-02]
 [ 8.97463598e-03  3.13796960e-02  8.91500570e-02]
 [-3.21704867e-03  6.75219316e-02 -2.52670618e-02]
 [-1.23329244e-01  2.52301374e-01  1.15903250e-02]
 [ 4.12996803e-02  4.68295904e-02  1.38094649e-02]
 [-5.09467354e-02  4.23767707e-01  1.92105534e-01]
 [ 5.87837226e-02  9.12983029e-02 -8.31917138e-02]
 [-2.98434275e-02 -3.88791359e-02 -1.19422834e-02]
 [-6.25514841e-02 -6.21982016e-03  3.21604886e-02]
 [-9.62623594e-02 -1.14884369e-01  6.32126881e-02]
 [ 2.62242673e-01  2.94068620e-01  1.25558766e-03]
 [-7.84993662e-02 -3.20860741e-01 -7.86325401e-02]
 [-6.69097905e-02 -4.90328761e-02 -4.08313494e-02]
 [-7.62263779e-02  1.69626307e-01  1.23325069e-01]
 [ 6.01675659e-02  4.06880206e-02  1.89492321e-02]
 [ 4.78248491e-02 -1.47048868e-02  4.98723415e-02]
 [-6.50794217e-02  4.24852040e-03 -1.09404256e-02]
 [ 1.10477249e-01 -5.87748682e-02  1.50210127e-01]
 [-1.00598086e-01  1.70863069e-01  4.45480812e-01]
 [ 3.79867364e-02 -2.24752122e-02 -7.02244575e-02]
 [ 7.13482015e-02  2.55545884e-02  1.07281760e-01]
 [ 2.91466020e-02 -7.29622619e-02  7.89738696e-02]
 [-1.55380775e-01  7.16597319e-02  8.38184730e-02]
 [-5.07806065e-02  7.36225950e-02  2.93687317e-02]
 [ 6.20848838e-02 -6.23725319e-02  9.08311027e-02]
 [-1.66370249e-02 -4.26641140e-02 -8.84405297e-02]
 [-8.75218343e-02  4.83133929e-01  5.42475149e-04]
 [ 2.16389395e-02 -1.13690747e-01 -3.73926994e-02]
 [-5.35093976e-02  1.73841641e-02  8.22712309e-02]
 [-4.84777133e-02 -8.39647512e-02 -3.30698185e-03]
 [-2.20306877e-01  2.02419057e-01  1.98141857e-02]
 [ 1.09549830e-01 -1.54513285e-01 -1.26031178e-01]
 [-2.21783471e-02 -1.19427784e-01 -6.34082339e-02]
 [-2.61993198e-02  2.47770333e-02 -5.77718785e-02]
 [ 1.11151134e-02 -1.57797115e-02 -4.76484145e-03]
 [-7.94861587e-01  3.95610700e-01  4.87415140e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.26023247 -29.25593426 -29.27334937]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  8.31486419  -9.25153874 -83.50871763]
init_Out:  [2.49911038]
Stock Position:  8.31486419409362
Bond position:  [-828.98730903]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [1.33781419]
curr_Stock_Price:  99.87279812724897
curr_Factors:  [99.87279813 -1.08691467 -0.99058036]
mat_Sqrt:  [[12.50842388  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00027506 -0.03166506 -0.10563501]
Stock Position:  -0.00027505731694726275
Bond Position:  [1.36528494]


portfolio before change:  [1.33803772]
curr_Stock_Price:  99.68064610575473
curr_Factors:  [99.68064611 -1.01388797 -0.98514158]
mat_Sqrt:  [[13.5034066   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00037316  0.01627494  0.29339419]
Stock Position:  -0.00037316340009644564
Bond Position:  [1.37523489]


portfolio before change:  [1.33806225]
curr_Stock_Price:  100.07560776446735
curr_Factors:  [100.07560776  -0.92664601  -1.02345895]
mat_Sqrt:  [[14.23666985  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00668591 0.04945752 0.10774915]
Stock Position:  0.006685911015104893
Bond Position:  [0.66896564]


portfolio before change:  [1.34363619]
curr_Stock_Price:  100.89678419018985
curr_Factors:  [100.89678419  -0.83221173  -1.01467571]
mat_Sqrt:  [[15.91418125  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01311884 -0.00838697 -0.14703534]
Stock Position:  0.013118835070218366
Bond Position:  [0.01998791]


portfolio before change:  [1.35976267]
curr_Stock_Price:  102.12585553025839
curr_Factors:  [102.12585553  -0.93575528  -1.01170577]
mat_Sqrt:  [[14.56679876  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00192098 0.00992313 0.2543203 ]
Stock Position:  0.0019209804359060386
Bond Position:  [1.1635809]


portfolio before change:  [1.35958441]
curr_Stock_Price:  101.95733789387434
curr_Factors:  [101.95733789  -0.70877821  -1.00605116]
mat_Sqrt:  [[18.35175308  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00036134  0.02135231 -0.07207989]
Stock Position:  -0.0003613418977532278
Bond Position:  [1.39642586]


portfolio before change:  [1.36022334]
curr_Stock_Price:  100.67220972687026
curr_Factors:  [100.67220973  -0.32560922  -1.04929939]
mat_Sqrt:  [[25.4562472   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00449591  0.0797847   0.03306397]
Stock Position:  -0.004495909577449291
Bond Position:  [1.81283649]


portfolio before change:  [1.3506312]
curr_Stock_Price:  102.85614087496809
curr_Factors:  [102.85614087  -0.54338809  -1.05819396]
mat_Sqrt:  [[20.73346934  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00218621 0.01480882 0.03939456]
Stock Position:  0.002186207221306515
Bond Position:  [1.12576636]


portfolio before change:  [1.34656992]
curr_Stock_Price:  100.93408732545818
curr_Factors:  [100.93408733  -0.52551228  -1.05162674]
mat_Sqrt:  [[20.84947331  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-3.79732552e-05  1.34007115e-01  5.48023616e-01]
Stock Position:  -3.797325515678103e-05
Bond Position:  [1.35040272]


portfolio before change:  [1.34674948]
curr_Stock_Price:  100.65116280569531
curr_Factors:  [100.65116281  -0.54904272  -1.04139187]
mat_Sqrt:  [[20.51643179  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0021524   0.02887106 -0.2373228 ]
Stock Position:  0.00215240143170897
Bond Position:  [1.13010777]


portfolio before change:  [1.34520468]
curr_Stock_Price:  99.86781901194942
curr_Factors:  [99.86781901 -0.49781357 -1.01828912]
mat_Sqrt:  [[21.92757127  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00151795 -0.01229466 -0.03406801]
Stock Position:  -0.0015179515529058748
Bond Position:  [1.49679919]


portfolio before change:  [1.34928397]
curr_Stock_Price:  97.30371894858125
curr_Factors:  [97.30371895 -0.41817565 -0.99515818]
mat_Sqrt:  [[23.67698248  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00237139 -0.00196688  0.09174492]
Stock Position:  -0.002371389467390335
Bond Position:  [1.58002899]


portfolio before change:  [1.34943337]
curr_Stock_Price:  97.324008938605
curr_Factors:  [97.32400894 -0.4769659  -0.98676864]
mat_Sqrt:  [[22.51791399  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00383363 -0.03632963  0.1803282 ]
Stock Position:  -0.003833633309679933
Bond Position:  [1.72253794]


portfolio before change:  [1.3490026]
curr_Stock_Price:  97.49254375997317
curr_Factors:  [97.49254376 -0.63457942 -0.98740633]
mat_Sqrt:  [[19.2553731   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01402683 0.09299266 0.00358184]
Stock Position:  0.014026827051691632
Bond Position:  [-0.01850845]


portfolio before change:  [1.36410666]
curr_Stock_Price:  98.56950654576818
curr_Factors:  [98.56950655 -0.45472323 -0.98860035]
mat_Sqrt:  [[23.27636291  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00441799 -0.10146508 -0.22431675]
Stock Position:  -0.004417990702071404
Bond Position:  [1.79958582]


portfolio before change:  [1.36536808]
curr_Stock_Price:  98.33490798250487
curr_Factors:  [98.33490798 -0.55564585 -0.99204311]
mat_Sqrt:  [[20.91967523  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00365735 -0.01550556 -0.11648047]
Stock Position:  -0.0036573454127550495
Bond Position:  [1.7250128]


portfolio before change:  [1.36530393]
curr_Stock_Price:  98.41140906970897
curr_Factors:  [98.41140907 -0.50095028 -1.01170752]
mat_Sqrt:  [[21.68235821  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00215258  0.05364055  0.35181209]
Stock Position:  -0.0021525804876166383
Bond Position:  [1.5771424]


portfolio before change:  [1.36667746]
curr_Stock_Price:  97.8649113249488
curr_Factors:  [97.86491132 -0.30239559 -1.01109279]
mat_Sqrt:  [[26.3139625   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00247344 0.01286668 0.05405688]
Stock Position:  0.0024734443489260027
Bond Position:  [1.12461405]


portfolio before change:  [1.36852845]
curr_Stock_Price:  98.55641972897712
curr_Factors:  [98.55641973 -0.14970329 -0.99755257]
mat_Sqrt:  [[31.29233932  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00184152 -0.00465009  0.14227191]
Stock Position:  0.0018415152365288579
Bond Position:  [1.18703531]


portfolio before change:  [1.37062949]
curr_Stock_Price:  99.61677002120369
curr_Factors:  [ 9.96167700e+01 -6.27691593e-02 -9.87315480e-01]
mat_Sqrt:  [[34.85671789  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00192798  0.0013435  -0.03120999]
Stock Position:  -0.0019279764267760844
Bond Position:  [1.56268828]


portfolio before change:  [1.37335038]
curr_Stock_Price:  98.30682824791819
curr_Factors:  [ 9.83068282e+01 -1.68807353e-02 -1.00027551e+00]
mat_Sqrt:  [[35.54989638  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00392747 -0.01858625  0.42850768]
Stock Position:  0.003927471433760572
Bond Position:  [0.98725312]


portfolio before change:  [1.36692114]
curr_Stock_Price:  96.63841404737083
curr_Factors:  [96.63841405  0.13444657 -0.97311557]
mat_Sqrt:  [[41.77538642  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-1.25744621e-04  5.40316466e-02  1.27083276e+00]
Stock Position:  -0.0001257446207480317
Bond Position:  [1.37907291]


portfolio before change:  [1.36671669]
curr_Stock_Price:  99.6353708603371
curr_Factors:  [99.63537086 -0.2096276  -1.00817885]
mat_Sqrt:  [[29.47996218  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00078263 -0.00710729 -0.20033083]
Stock Position:  0.000782630637671455
Bond Position:  [1.28873899]


portfolio before change:  [1.3679521]
curr_Stock_Price:  101.00805941573888
curr_Factors:  [101.00805942  -0.25834568  -1.00215536]
mat_Sqrt:  [[28.63699099  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00327921 0.00808107 0.306045  ]
Stock Position:  0.0032792137895100567
Bond Position:  [1.03672508]


portfolio before change:  [1.36664598]
curr_Stock_Price:  100.57023576676865
curr_Factors:  [100.57023577  -0.26550409  -0.98365603]
mat_Sqrt:  [[28.83806532  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00150437 -0.02307269  0.22529047]
Stock Position:  0.0015043726968806093
Bond Position:  [1.21535086]


portfolio before change:  [1.37160725]
curr_Stock_Price:  103.76714674403645
curr_Factors:  [103.76714674  -0.47349844  -0.95857728]
mat_Sqrt:  [[24.78091242  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00550509  0.0226608   0.23911077]
Stock Position:  -0.0055050900413139104
Bond Position:  [1.94285474]


portfolio before change:  [1.37757902]
curr_Stock_Price:  102.72649261896981
curr_Factors:  [102.72649262  -0.35716836  -0.96959515]
mat_Sqrt:  [[27.25689546  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00157336  0.02328151  0.08378082]
Stock Position:  -0.00157335644001739
Bond Position:  [1.53920441]


portfolio before change:  [1.37549638]
curr_Stock_Price:  104.17247894937681
curr_Factors:  [104.17247895  -0.30396629  -0.97884424]
mat_Sqrt:  [[28.88254537  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00273574 -0.01972393  0.25911585]
Stock Position:  0.002735744102678169
Bond Position:  [1.09050714]


portfolio before change:  [1.37692488]
curr_Stock_Price:  104.6448097783317
curr_Factors:  [104.64480978  -0.29271146  -0.97738785]
mat_Sqrt:  [[29.38465318  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00121803 -0.01349158 -0.25229621]
Stock Position:  -0.001218032246796644
Bond Position:  [1.50438563]


portfolio before change:  [1.37721441]
curr_Stock_Price:  104.56150172753594
curr_Factors:  [104.56150173  -0.30410462  -0.97935372]
mat_Sqrt:  [[28.97163058  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00258655  0.15278036  0.00154753]
Stock Position:  -0.002586552298035155
Bond Position:  [1.6476682]


portfolio before change:  [1.38009668]
curr_Stock_Price:  103.52680587257936
curr_Factors:  [ 1.03526806e+02  2.46649891e-02 -9.89738069e-01]
mat_Sqrt:  [[39.43909145  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0002807  -0.03595217 -0.10667096]
Stock Position:  0.0002807038360978582
Bond Position:  [1.35103631]


portfolio before change:  [1.38003592]
curr_Stock_Price:  102.7086957504971
curr_Factors:  [102.70869575  -0.12626185  -0.9793459 ]
mat_Sqrt:  [[33.99756959  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00106675  0.00549736  0.23469692]
Stock Position:  -0.0010667525999193822
Bond Position:  [1.48960069]


portfolio before change:  [1.38197302]
curr_Stock_Price:  101.06737435282861
curr_Factors:  [ 1.01067374e+02 -7.12483941e-02 -9.77512042e-01]
mat_Sqrt:  [[35.4111567   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00144928 -0.02655199 -0.0094339 ]
Stock Position:  -0.0014492807784944922
Bond Position:  [1.52844802]


portfolio before change:  [1.38360601]
curr_Stock_Price:  100.07244922494611
curr_Factors:  [ 1.00072449e+02 -4.44444167e-02 -9.87325899e-01]
mat_Sqrt:  [[35.6633696   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00591744  0.06401053  0.05652436]
Stock Position:  -0.005917441007509288
Bond Position:  [1.97577883]


portfolio before change:  [1.37779351]
curr_Stock_Price:  101.09645346210918
curr_Factors:  [101.09645346  -0.21903917  -0.99153568]
mat_Sqrt:  [[30.12936259  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00264972 -0.04886139 -0.35953187]
Stock Position:  0.0026497177629915547
Bond Position:  [1.10991645]


portfolio before change:  [1.37265914]
curr_Stock_Price:  99.10638338964462
curr_Factors:  [99.10638339 -0.33840462 -0.98144657]
mat_Sqrt:  [[26.4787537   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00144286 -0.03776638 -0.18088604]
Stock Position:  -0.0014428591021891245
Bond Position:  [1.51565569]


portfolio before change:  [1.37391268]
curr_Stock_Price:  98.3689106260605
curr_Factors:  [98.36891063 -0.43740329 -0.97639116]
mat_Sqrt:  [[23.92515376  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00156121  0.00783519 -0.16480709]
Stock Position:  -0.0015612110707470075
Bond Position:  [1.52748731]


portfolio before change:  [1.37380243]
curr_Stock_Price:  98.5618319775396
curr_Factors:  [98.56183198 -0.54025709 -0.97171892]
mat_Sqrt:  [[21.73031029  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00044799 -0.00498998 -0.01359277]
Stock Position:  0.0004479946971517201
Bond Position:  [1.32964725]


portfolio before change:  [1.37389677]
curr_Stock_Price:  98.40137644949358
curr_Factors:  [98.40137645 -0.54765716 -0.98152875]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [1.37389677]
Stock Price:  97.45651717647137
PL:  [1.37389677]
Settle:  Tensor("sub_130:0", shape=(), dtype=float64)
PL:  Tensor("sub_131:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  66
output_Z_Vals[:, i, :]:  [[ 1.19260232e+02 -2.92559343e+01 -2.92733494e+01]
 [ 4.23884848e-03 -1.24998647e-01 -3.90308029e-02]
 [-4.65705393e-02 -3.63674080e-02 -1.84015404e-02]
 [ 8.30241883e-02  1.52644562e-01  3.77204998e-02]
 [ 2.19156125e-01 -2.71716887e-02 -5.27864653e-02]
 [ 9.85326291e-03  3.14292065e-02  8.77396292e-02]
 [ 2.12472539e-02  6.12037824e-02 -1.56993239e-02]
 [-1.28653734e-01  1.93943116e-01 -1.68743384e-02]
 [-2.81683430e-02 -3.44557167e-02  2.06866101e-02]
 [-7.55228617e-02  2.92117054e-01  1.24129400e-01]
 [ 5.85455487e-02  1.53244501e-01 -8.59113644e-02]
 [-2.62775642e-02  2.19403942e-02 -8.69113313e-03]
 [-1.14277451e-01  4.45200411e-02 -3.28438653e-02]
 [-6.21398501e-02 -8.33395086e-02  8.69269619e-02]
 [ 2.65420887e-01  3.60473746e-01  7.25981799e-02]
 [-7.23324523e-02 -7.00766149e-02 -1.04077277e-01]
 [-7.11490852e-02 -5.69242730e-02 -6.44117154e-02]
 [-7.92937049e-02  1.62650024e-01  1.26036520e-01]
 [ 1.20883380e-01  6.80721251e-02  1.38598150e-01]
 [-2.75673389e-02 -1.47260165e-02  1.01958910e-01]
 [-2.74528835e-03 -3.95013550e-02  1.68622765e-03]
 [ 1.23124078e-01 -6.67255295e-02  1.67320637e-01]
 [-5.84154026e-04 -1.62119094e-01  1.20645902e-01]
 [-6.29104393e-02 -7.01057620e-04 -8.36651418e-02]
 [-3.51839648e-01  1.27343775e-01  3.62662923e-02]
 [-5.06256455e-02 -1.62034937e-01  1.04481944e-01]
 [ 1.97185938e-01  4.50947545e-02 -1.15804703e-01]
 [ 5.32572579e-02 -1.35600411e-01 -5.80294646e-02]
 [-8.58873941e-02 -8.19607603e-02 -1.90990972e-01]
 [ 9.44474852e-03 -3.78648247e-03 -1.07833027e-01]
 [ 5.92340316e-02  1.30216935e-02  3.89526174e-02]
 [ 3.82637120e-02 -6.73469954e-02 -9.21150485e-02]
 [ 3.56168030e-01 -4.67529499e-01 -4.90688463e-01]
 [-4.30040195e-02 -8.17838819e-02 -7.82643243e-03]
 [-1.44529006e-01  8.31936543e-02  3.31187346e-02]
 [ 8.47165236e-02 -1.65012150e-01 -1.38726811e-01]
 [-1.10452353e-01 -2.31431431e-01  5.74426236e-03]
 [-2.95096783e-02 -1.41826377e-04 -3.97354281e-02]
 [-4.68301682e-02  9.65635666e-02 -9.31677345e-03]
 [-4.61423447e-01  2.38423854e-01  2.81015087e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.26023247 -29.25593426 -29.27334937]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  8.31486419  -9.25153874 -83.50871763]
init_Out:  [2.49911038]
Stock Position:  8.31486419409362
Bond position:  [-828.98730903]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-2.78950197]
curr_Stock_Price:  99.37642006717475
curr_Factors:  [99.37642007 -0.75995764 -0.98957207]
mat_Sqrt:  [[17.2771557   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0004026  -0.03952804 -0.11134402]
Stock Position:  -0.00040259705374022774
Bond Position:  [-2.74949331]


portfolio before change:  [-2.79015945]
curr_Stock_Price:  100.15579476858849
curr_Factors:  [100.15579477  -0.5510686   -0.99293509]
mat_Sqrt:  [[21.38571631  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0023972  -0.01150038 -0.05249447]
Stock Position:  -0.0023971953861888317
Bond Position:  [-2.55006644]


portfolio before change:  [-2.79047046]
curr_Stock_Price:  100.1525552124956
curr_Factors:  [100.15255521  -0.86451974  -0.97924701]
mat_Sqrt:  [[15.84616987  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00597401 0.04827045 0.10760609]
Stock Position:  0.005974006309604891
Bond Position:  [-3.38878246]


portfolio before change:  [-2.78709166]
curr_Stock_Price:  100.78905085284123
curr_Factors:  [100.78905085  -0.90518393  -0.99640748]
mat_Sqrt:  [[15.05090801  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01379847 -0.00859244 -0.15058509]
Stock Position:  0.01379847397268255
Bond Position:  [-4.17782675]


portfolio before change:  [-2.76933471]
curr_Stock_Price:  102.11377743426763
curr_Factors:  [102.11377743  -0.91427255  -0.99219941]
mat_Sqrt:  [[15.17448949  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00188306 0.00993879 0.25029674]
Stock Position:  0.001883064228541904
Bond Position:  [-2.96162151]


portfolio before change:  [-2.77088229]
curr_Stock_Price:  101.48854566410961
curr_Factors:  [101.48854566  -0.77396297  -1.0028704 ]
mat_Sqrt:  [[17.16912257  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00114292  0.01935434 -0.0447858 ]
Stock Position:  0.0011429190743240543
Bond Position:  [-2.88687548]


portfolio before change:  [-2.77213505]
curr_Stock_Price:  100.70819422977276
curr_Factors:  [100.70819423  -1.05144771  -1.00413546]
mat_Sqrt:  [[12.89247742  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00985773  0.0613302  -0.04813779]
Stock Position:  -0.009857733311792813
Bond Position:  [-1.77938053]


portfolio before change:  [-2.77232466]
curr_Stock_Price:  100.7048638749349
curr_Factors:  [100.70486387  -0.95838548  -0.97675938]
mat_Sqrt:  [[14.5421196   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00170782 -0.01089585  0.05901314]
Stock Position:  -0.0017078218214978001
Bond Position:  [-2.60033869]


portfolio before change:  [-2.77199994]
curr_Stock_Price:  100.324392202071
curr_Factors:  [100.3243922   -0.79372075  -0.99026687]
mat_Sqrt:  [[16.85118929  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00253054  0.09237552  0.35410663]
Stock Position:  -0.002530540922983142
Bond Position:  [-2.51812496]


portfolio before change:  [-2.77008496]
curr_Stock_Price:  99.44325121365605
curr_Factors:  [99.44325121 -0.70268477 -0.99446417]
mat_Sqrt:  [[18.21851166  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00246813  0.04846017 -0.24508121]
Stock Position:  0.002468133602450732
Bond Position:  [-3.01552419]


portfolio before change:  [-2.7681378]
curr_Stock_Price:  100.38490625442256
curr_Factors:  [100.38490625  -0.75231448  -1.01445823]
mat_Sqrt:  [[17.15413334  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00160225  0.00693816 -0.02479338]
Stock Position:  -0.0016022456664738008
Bond Position:  [-2.60729652]


portfolio before change:  [-2.76661849]
curr_Stock_Price:  99.23324947256117
curr_Factors:  [99.23324947 -0.74997041 -1.00482563]
mat_Sqrt:  [[17.16164745  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00698256  0.01407847 -0.09369441]
Stock Position:  -0.006982556607219503
Bond Position:  [-2.07371671]


portfolio before change:  [-2.77386198]
curr_Stock_Price:  100.23349281954829
curr_Factors:  [100.23349282  -0.83210866  -1.0211198 ]
mat_Sqrt:  [[15.70963042  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00296301 -0.02635427  0.24797843]
Stock Position:  -0.002963008927718851
Bond Position:  [-2.47686924]


portfolio before change:  [-2.7738035]
curr_Stock_Price:  100.10925935740168
curr_Factors:  [100.10925936  -1.16101062  -1.00856733]
mat_Sqrt:  [[11.43506173  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.02532101 0.11399181 0.2071024 ]
Stock Position:  0.02532101073480986
Bond Position:  [-5.30867113]


portfolio before change:  [-2.77513122]
curr_Stock_Price:  100.08303252374004
curr_Factors:  [100.08303252  -1.32413463  -0.98713677]
mat_Sqrt:  [[ 9.92174452  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00961388 -0.02216017 -0.2969035 ]
Stock Position:  -0.009613884718615703
Bond Position:  [-1.81294448]


portfolio before change:  [-2.77512813]
curr_Stock_Price:  100.05913811497452
curr_Factors:  [100.05913811  -1.4057243   -0.96660041]
mat_Sqrt:  [[ 9.33188182  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00919073 -0.01800104 -0.1837487 ]
Stock Position:  -0.009190734688865486
Bond Position:  [-1.85551114]


portfolio before change:  [-2.77292434]
curr_Stock_Price:  99.79411674623341
curr_Factors:  [99.79411675 -1.21884726 -0.94101101]
mat_Sqrt:  [[11.51039985  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0042889   0.05143445  0.35954711]
Stock Position:  -0.00428890422025148
Bond Position:  [-2.34491693]


portfolio before change:  [-2.77057675]
curr_Stock_Price:  99.17840524207641
curr_Factors:  [99.17840524 -1.18301489 -0.96113136]
mat_Sqrt:  [[11.62053801  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.0129884  0.0215263  0.39538194]
Stock Position:  0.012988402361504232
Bond Position:  [-4.05874578]


portfolio before change:  [-2.78014958]
curr_Stock_Price:  98.48043941178423
curr_Factors:  [98.48043941 -1.11675256 -0.97558862]
mat_Sqrt:  [[12.1522795   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00058716 -0.00465678  0.29086039]
Stock Position:  -0.0005871563155204696
Bond Position:  [-2.72232617]


portfolio before change:  [-2.78089771]
curr_Stock_Price:  99.17499657848387
curr_Factors:  [99.17499658 -1.32948862 -0.97920236]
mat_Sqrt:  [[ 9.85712897  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00034706 -0.01249143  0.00481034]
Stock Position:  -0.0003470593906060246
Bond Position:  [-2.7464781]


portfolio before change:  [-2.78107804]
curr_Stock_Price:  98.70532751939848
curr_Factors:  [98.70532752 -1.29841694 -0.92981976]
mat_Sqrt:  [[10.63236042  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01463037 -0.02110047  0.47731921]
Stock Position:  0.014630374418972303
Bond Position:  [-4.22517394]


portfolio before change:  [-2.78533536]
curr_Stock_Price:  98.45043699302258
curr_Factors:  [98.45043699 -1.5320633  -0.91279422]
mat_Sqrt:  [[ 8.5394425   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00232529 -0.05126656  0.34416918]
Stock Position:  0.002325291213863966
Bond Position:  [-3.0142613]


portfolio before change:  [-2.78428072]
curr_Stock_Price:  99.06603541998287
curr_Factors:  [99.06603542 -1.47414967 -0.90621981]
mat_Sqrt:  [[ 9.16523178  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-8.72936092e-03 -2.21693885e-04 -2.38673362e-01]
Stock Position:  -0.00872936092244775
Bond Position:  [-1.91949754]


portfolio before change:  [-2.78210807]
curr_Stock_Price:  98.78965692623315
curr_Factors:  [98.78965693 -1.30313421 -0.91731662]
mat_Sqrt:  [[10.7246205   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.03180987  0.04026964  0.10345764]
Stock Position:  -0.0318098734111535
Bond Position:  [0.36037841]


portfolio before change:  [-2.77387534]
curr_Stock_Price:  98.53226268158562
curr_Factors:  [98.53226268 -1.46863331 -0.88910015]
mat_Sqrt:  [[ 9.32454879  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00359075 -0.05123995  0.2980579 ]
Stock Position:  -0.0035907455442807075
Bond Position:  [-2.42007106]


portfolio before change:  [-2.77478853]
curr_Stock_Price:  98.70232855102087
curr_Factors:  [98.70232855 -1.62608966 -0.90133719]
mat_Sqrt:  [[ 7.88278833  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0221637   0.01426021 -0.33035858]
Stock Position:  0.0221636984057243
Bond Position:  [-4.96239717]


portfolio before change:  [-2.75003335]
curr_Stock_Price:  99.84724187306007
curr_Factors:  [99.84724187 -1.6739659  -0.895612  ]
mat_Sqrt:  [[ 7.6450894   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00495885 -0.04288061 -0.16554191]
Stock Position:  0.004958850510100052
Bond Position:  [-3.2451609]


portfolio before change:  [-2.74829207]
curr_Stock_Price:  100.28019495900257
curr_Factors:  [100.28019496  -1.84039519  -0.89362565]
mat_Sqrt:  [[ 6.51395872  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01949498 -0.02591827 -0.54484408]
Stock Position:  -0.01949497783253128
Bond Position:  [-0.7933319]


portfolio before change:  [-2.75491477]
curr_Stock_Price:  100.61482094931364
curr_Factors:  [100.61482095  -1.65125513  -0.91364908]
mat_Sqrt:  [[ 7.73995106  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00163623 -0.00119739 -0.30761761]
Stock Position:  -0.0016362303024355096
Bond Position:  [-2.59028576]


portfolio before change:  [-2.75507921]
curr_Stock_Price:  100.51741744612717
curr_Factors:  [100.51741745  -1.52084537  -0.92166347]
mat_Sqrt:  [[ 8.73923077  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00772624 0.00411782 0.11112098]
Stock Position:  0.007726242931740142
Bond Position:  [-3.53170119]


portfolio before change:  [-2.76125996]
curr_Stock_Price:  99.77459017980254
curr_Factors:  [99.77459018 -1.64756313 -0.9515495 ]
mat_Sqrt:  [[ 7.41719472  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0023893  -0.02129699 -0.26277859]
Stock Position:  0.0023893015008857833
Bond Position:  [-2.99965154]


portfolio before change:  [-2.76101951]
curr_Stock_Price:  100.03216691301871
curr_Factors:  [100.03216691  -1.71185097  -0.93553372]
mat_Sqrt:  [[ 7.08590154  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.03442542 -0.14784581 -1.3997976 ]
Stock Position:  0.034425415868446614
Bond Position:  [-6.20466846]


portfolio before change:  [-2.74582209]
curr_Stock_Price:  100.49615697695425
curr_Factors:  [100.49615698  -1.56570769  -0.91509544]
mat_Sqrt:  [[ 8.40911604  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00555507 -0.02586233 -0.02232663]
Stock Position:  -0.005555070690790577
Bond Position:  [-2.18755884]


portfolio before change:  [-2.74734049]
curr_Stock_Price:  100.72026505942426
curr_Factors:  [100.72026506  -1.34957512  -0.92463958]
mat_Sqrt:  [[10.36186581  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01308844  0.02630814  0.09447853]
Stock Position:  -0.013088436354877723
Bond Position:  [-1.42906971]


portfolio before change:  [-2.74947043]
curr_Stock_Price:  100.86935069280932
curr_Factors:  [100.86935069  -1.13670413  -0.9119407 ]
mat_Sqrt:  [[13.00301544  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00400972 -0.05218142 -0.39574898]
Stock Position:  0.0040097188769909605
Bond Position:  [-3.15392817]


portfolio before change:  [-2.75042801]
curr_Stock_Price:  100.72886301039945
curr_Factors:  [100.72886301  -1.13052872  -0.9059627 ]
mat_Sqrt:  [[13.14367902  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00876888 -0.07318504  0.01638678]
Stock Position:  -0.00876887997077902
Bond Position:  [-1.86714871]


portfolio before change:  [-2.75312734]
curr_Stock_Price:  101.01007533210785
curr_Factors:  [101.01007533  -1.12500762  -0.92235945]
mat_Sqrt:  [[13.03780476  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-2.88578493e-03 -4.48494384e-05 -1.13354116e-01]
Stock Position:  -0.0028857849338526182
Bond Position:  [-2.46163399]


portfolio before change:  [-2.75439976]
curr_Stock_Price:  101.34436646316452
curr_Factors:  [101.34436646  -0.99539308  -0.95070074]
mat_Sqrt:  [[14.47510774  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00319436  0.03053608 -0.02657816]
Stock Position:  -0.0031943586822239097
Bond Position:  [-2.4306695]


portfolio before change:  [-2.75381413]
curr_Stock_Price:  101.06591284189194
curr_Factors:  [101.06591284  -0.61994158  -0.96622324]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-2.75381413]
Stock Price:  101.65272545107581
PL:  [-4.40653958]
Settle:  Tensor("sub_132:0", shape=(), dtype=float64)
PL:  Tensor("sub_133:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  67
output_Z_Vals[:, i, :]:  [[ 1.19260232e+02 -2.92559343e+01 -2.92733494e+01]
 [-6.54240015e-03 -5.54460580e-02 -2.43521454e-02]
 [-3.72867082e-02  6.08266471e-03  4.01982762e-02]
 [ 8.50294612e-02  1.70878568e-01  3.79641046e-02]
 [ 2.20220840e-01 -2.63333027e-02 -5.11809140e-02]
 [ 7.44631468e-02  2.92082305e-02 -1.17050330e-01]
 [ 5.74127020e-02  2.72785104e-02 -4.92643228e-02]
 [-1.36293440e-01  1.10209285e-01 -5.77161215e-02]
 [-2.13277496e-01 -8.49475824e-02  1.87944434e-01]
 [-3.30417872e-02 -1.04600124e-01 -1.31817564e-01]
 [ 5.37338001e-02  1.58897658e-01 -8.02829134e-02]
 [-5.56418578e-02  7.52307938e-02  6.12040748e-03]
 [-1.05626410e-01  3.65593171e-02 -4.97960537e-02]
 [-9.46229646e-02 -6.46469688e-02  7.55971013e-02]
 [ 2.48315883e-01  3.36680728e-01  6.77706683e-02]
 [-7.98326653e-02 -1.14964287e-01 -1.03354315e-01]
 [-6.83627840e-02 -6.44119059e-02 -5.92271872e-02]
 [-7.76208845e-02  1.78696368e-01  1.29361715e-01]
 [ 1.12223570e-01  6.88342295e-02  1.27941832e-01]
 [ 2.27594078e-02 -2.53261713e-02  8.23729274e-02]
 [ 5.49603186e-03 -4.71832322e-02  1.12478602e-02]
 [ 1.24281340e-01 -6.73402833e-02  1.72460712e-01]
 [-3.95780636e-02 -3.19186174e-02  2.44009837e-01]
 [-6.86229316e-02 -5.65121801e-04 -8.20006774e-02]
 [-3.62077878e-01  1.24881141e-01  5.35594488e-02]
 [-7.41770691e-02 -1.88723758e-01  1.12057312e-01]
 [ 2.10869924e-01  5.53116198e-02 -1.41794201e-01]
 [-2.56841853e-02  5.45570145e-02  2.37644995e-02]
 [-9.96736747e-02 -9.84918288e-02 -1.69355671e-01]
 [ 3.48058484e-02  2.22566183e-02 -1.13055315e-01]
 [ 4.66703448e-02  7.31209153e-03  2.83206047e-02]
 [ 5.84381530e-02 -1.05004547e-01 -7.97442569e-02]
 [ 2.03303263e-01 -1.03691883e-01  3.06367431e-02]
 [-4.57352755e-02 -8.12874174e-02  4.23745747e-03]
 [-1.91930038e-01  1.40667982e-01  2.32337243e-02]
 [ 8.23304954e-02 -1.60861345e-01 -1.35935271e-01]
 [-1.16068115e-01 -2.10111911e-01 -1.85895806e-03]
 [-3.36971820e-02 -7.20764372e-03 -2.00793344e-02]
 [-4.80592598e-02  1.01676653e-01 -1.58755875e-02]
 [-4.56027226e-01  2.35639145e-01  2.78013233e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.26023247 -29.25593426 -29.27334937]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  8.31486419  -9.25153874 -83.50871763]
init_Out:  [2.49911038]
Stock Position:  8.31486419409362
Bond position:  [-828.98730903]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [4.57585222]
curr_Stock_Price:  100.26222577757216
curr_Factors:  [100.26222578  -0.90275376  -0.98892448]
mat_Sqrt:  [[15.12139717  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00085606 -0.01753358 -0.06946989]
Stock Position:  -0.0008560632273245502
Bond Position:  [4.66168302]


portfolio before change:  [4.57674044]
curr_Stock_Price:  99.9053918153303
curr_Factors:  [99.90539182 -1.05027435 -0.9846921 ]
mat_Sqrt:  [[13.05612292  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00221538  0.00192351  0.11467449]
Stock Position:  -0.002215375566086366
Bond Position:  [4.7980684]


portfolio before change:  [4.57641622]
curr_Stock_Price:  100.32248513559169
curr_Factors:  [100.32248514  -1.08678058  -0.99892682]
mat_Sqrt:  [[12.46198053  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00779899 0.05403655 0.10830102]
Stock Position:  0.007798994472750293
Bond Position:  [3.79400171]


portfolio before change:  [4.58123119]
curr_Stock_Price:  100.87905627759687
curr_Factors:  [100.87905628  -1.27898814  -1.03089535]
mat_Sqrt:  [[10.01454817  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.02087899 -0.00832732 -0.1460049 ]
Stock Position:  0.0208789906051666
Bond Position:  [2.47497832]


portfolio before change:  [4.56836927]
curr_Stock_Price:  100.24821565699423
curr_Factors:  [100.24821566  -1.46823885  -1.02635982]
mat_Sqrt:  [[ 8.27344176  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00620352  0.00923645 -0.33391201]
Stock Position:  0.006203524833611164
Bond Position:  [3.94647697]


portfolio before change:  [4.56884619]
curr_Stock_Price:  100.24556910114548
curr_Factors:  [100.2455691   -1.56209257  -1.03176694]
mat_Sqrt:  [[ 7.4914574   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00641544  0.00862622 -0.1405374 ]
Stock Position:  0.0064154395864757284
Bond Position:  [3.9257268]


portfolio before change:  [4.57061963]
curr_Stock_Price:  100.44550691909856
curr_Factors:  [100.44550692  -1.38389204  -1.01173302]
mat_Sqrt:  [[ 9.15216353  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01586828  0.03485124 -0.16464803]
Stock Position:  -0.015868280966275135
Bond Position:  [6.16451715]


portfolio before change:  [4.57181206]
curr_Stock_Price:  100.41892393327255
curr_Factors:  [100.41892393  -1.63313405  -1.01101095]
mat_Sqrt:  [[ 7.13638027  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02481746 -0.02686278  0.53615316]
Stock Position:  -0.024817460599748216
Bond Position:  [7.06395475]


portfolio before change:  [4.58776606]
curr_Stock_Price:  99.81165221727072
curr_Factors:  [99.81165222 -1.54974117 -0.9947623 ]
mat_Sqrt:  [[ 7.83641499  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00799469 -0.03307746 -0.37603882]
Stock Position:  -0.00799468869388103
Bond Position:  [5.38572914]


portfolio before change:  [4.58941105]
curr_Stock_Price:  99.69010503912729
curr_Factors:  [99.69010504 -1.66428355 -0.965517  ]
mat_Sqrt:  [[ 7.18694279  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00576724  0.05024785 -0.22902481]
Stock Position:  0.005767242082408547
Bond Position:  [4.01447408]


portfolio before change:  [4.59243006]
curr_Stock_Price:  100.12656632369367
curr_Factors:  [100.12656632  -1.45181946  -0.94411004]
mat_Sqrt:  [[ 9.12032601  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0057509   0.02379007  0.01745982]
Stock Position:  -0.005750900141184831
Bond Position:  [5.16824795]


portfolio before change:  [4.59363259]
curr_Stock_Price:  100.02980735255468
curr_Factors:  [100.02980735  -1.21450178  -0.96084713]
mat_Sqrt:  [[11.36023733  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01010956  0.01156107 -0.14205428]
Stock Position:  -0.010109562503827402
Bond Position:  [5.60489018]


portfolio before change:  [4.59297106]
curr_Stock_Price:  100.16454878032944
curr_Factors:  [100.16454878  -1.2492664   -0.96588857]
mat_Sqrt:  [[10.93161828  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00739698 -0.02044317  0.21565749]
Stock Position:  -0.007396978781593031
Bond Position:  [5.33388611]


portfolio before change:  [4.59524422]
curr_Stock_Price:  99.94738192719478
curr_Factors:  [99.94738193 -1.08921644 -0.96647997]
mat_Sqrt:  [[12.79363085  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.02117011 0.10646779 0.19333085]
Stock Position:  0.021170109942302107
Bond Position:  [2.47934716]


portfolio before change:  [4.59293967]
curr_Stock_Price:  99.8238827439208
curr_Factors:  [99.82388274 -1.02176012 -0.95689461]
mat_Sqrt:  [[13.80116109  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00752822 -0.0363549  -0.29484109]
Stock Position:  -0.007528217442631935
Bond Position:  [5.34443556]


portfolio before change:  [4.59658555]
curr_Stock_Price:  99.42833223677935
curr_Factors:  [99.42833224 -0.91808202 -0.97633787]
mat_Sqrt:  [[14.95457404  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.005491   -0.02036883 -0.16895868]
Stock Position:  -0.005491001684388667
Bond Position:  [5.14254669]


portfolio before change:  [4.59874894]
curr_Stock_Price:  99.15141933483777
curr_Factors:  [99.15141933 -1.04796163 -0.97084261]
mat_Sqrt:  [[13.16871487  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00353877  0.05650875  0.36903296]
Stock Position:  -0.0035387746741967563
Bond Position:  [4.94962347]


portfolio before change:  [4.60017031]
curr_Stock_Price:  98.92461143609972
curr_Factors:  [98.92461144 -1.15684348 -0.9552273 ]
mat_Sqrt:  [[11.9686087   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01170703 0.02176729 0.36498244]
Stock Position:  0.011707031547545347
Bond Position:  [3.44205676]


portfolio before change:  [4.60221801]
curr_Stock_Price:  99.06276974693935
curr_Factors:  [99.06276975 -1.32179878 -0.97921875]
mat_Sqrt:  [[ 9.92181781  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00392265 -0.00800884  0.23498703]
Stock Position:  0.003922647345250935
Bond Position:  [4.2136297]


portfolio before change:  [4.60130898]
curr_Stock_Price:  98.69674889259821
curr_Factors:  [98.69674889 -1.18096548 -0.97803735]
mat_Sqrt:  [[11.39357013  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00057697 -0.01492065  0.03208701]
Stock Position:  0.0005769680463072732
Bond Position:  [4.54436411]


portfolio before change:  [4.60176143]
curr_Stock_Price:  98.4963421565031
curr_Factors:  [98.49634216 -1.0934817  -0.95504256]
mat_Sqrt:  [[12.69864319  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01242227 -0.02129487  0.49198241]
Stock Position:  0.012422273328535306
Bond Position:  [3.37821295]


portfolio before change:  [4.5996777]
curr_Stock_Price:  98.29460480407784
curr_Factors:  [98.2946048  -0.90059292 -0.94788308]
mat_Sqrt:  [[15.4791375   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 6.07663098e-04 -1.00935531e-02  6.96092146e-01]
Stock Position:  0.0006076630979873973
Bond Position:  [4.53994769]


portfolio before change:  [4.59994685]
curr_Stock_Price:  97.8035863192558
curr_Factors:  [97.80358632 -0.77671636 -0.9393924 ]
mat_Sqrt:  [[17.58159271  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-4.85597878e-03 -1.78707205e-04 -2.33925108e-01]
Stock Position:  -0.004855978778915915
Bond Position:  [5.07487899]


portfolio before change:  [4.59935242]
curr_Stock_Price:  98.05664240992047
curr_Factors:  [98.05664241 -0.96079231 -0.91086891]
mat_Sqrt:  [[15.0877639   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02305979  0.03949088  0.1527902 ]
Stock Position:  -0.02305979114781065
Bond Position:  [6.86051811]


portfolio before change:  [4.61614975]
curr_Stock_Price:  97.36540816871101
curr_Factors:  [97.36540817 -0.88301678 -0.91153891]
mat_Sqrt:  [[16.18225554  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00347147 -0.05967969  0.31966832]
Stock Position:  -0.0034714748149920066
Bond Position:  [4.95415132]


portfolio before change:  [4.61732654]
curr_Stock_Price:  97.20481915735841
curr_Factors:  [97.20481916 -0.910606   -0.89064667]
mat_Sqrt:  [[16.04773347  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01142557  0.01749107 -0.40449939]
Stock Position:  0.011425566366565384
Bond Position:  [3.50670643]


portfolio before change:  [4.61537936]
curr_Stock_Price:  96.99602915893607
curr_Factors:  [96.99602916 -0.8530709  -0.89616753]
mat_Sqrt:  [[16.86822392  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00115155  0.01725244  0.0677935 ]
Stock Position:  -0.0011515510610026242
Bond Position:  [4.72707524]


portfolio before change:  [4.6149934]
curr_Stock_Price:  97.84435379856902
curr_Factors:  [97.8443538  -0.9611992  -0.91944049]
mat_Sqrt:  [[14.92053272  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00916766 -0.03114585 -0.48312459]
Stock Position:  -0.009167655534313975
Bond Position:  [5.51199673]


portfolio before change:  [4.61790164]
curr_Stock_Price:  97.60228475961162
curr_Factors:  [97.60228476 -0.93440983 -0.90102284]
mat_Sqrt:  [[15.57190346  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00079009  0.00703816 -0.32251534]
Stock Position:  0.0007900891730623993
Bond Position:  [4.54078714]


portfolio before change:  [4.61828446]
curr_Stock_Price:  97.36836742449518
curr_Factors:  [97.36836742 -0.88404367 -0.90199972]
mat_Sqrt:  [[16.32108759  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00322528 0.00231229 0.0807908 ]
Stock Position:  0.003225279021289047
Bond Position:  [4.30424431]


portfolio before change:  [4.61653916]
curr_Stock_Price:  96.66040760590063
curr_Factors:  [96.66040761 -0.6056559  -0.90978641]
mat_Sqrt:  [[21.23735319  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00185754 -0.03320535 -0.22748817]
Stock Position:  0.0018575393370603077
Bond Position:  [4.43698865]


portfolio before change:  [4.61946744]
curr_Stock_Price:  97.93823982918398
curr_Factors:  [97.93823983 -0.57416511 -0.92617383]
mat_Sqrt:  [[21.84556937  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0094701  -0.03279025  0.0873981 ]
Stock Position:  0.009470096460151437
Bond Position:  [3.69198286]


portfolio before change:  [4.62552061]
curr_Stock_Price:  98.52869252703425
curr_Factors:  [98.52869253 -0.52096308 -0.89656954]
mat_Sqrt:  [[23.87460101  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00196733 -0.02570534  0.01208829]
Stock Position:  -0.001967326708917316
Bond Position:  [4.81935874]


portfolio before change:  [4.62454379]
curr_Stock_Price:  99.33144505545035
curr_Factors:  [99.33144506 -0.66537045 -0.89876399]
mat_Sqrt:  [[20.78699925  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0088303   0.04448312  0.06627935]
Stock Position:  -0.00883030013436011
Bond Position:  [5.50167026]


portfolio before change:  [4.62111957]
curr_Stock_Price:  99.79711148833253
curr_Factors:  [99.79711149 -0.77486019 -0.8996535 ]
mat_Sqrt:  [[18.70190801  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00269648 -0.05086882 -0.38778549]
Stock Position:  0.0026964843508044253
Bond Position:  [4.35201822]


portfolio before change:  [4.62588047]
curr_Stock_Price:  101.36094772697102
curr_Factors:  [101.36094773  -0.68435658  -0.90612803]
mat_Sqrt:  [[20.66007861  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00589894 -0.06644322 -0.00530309]
Stock Position:  -0.005898943645413544
Bond Position:  [5.22380298]


portfolio before change:  [4.62792441]
curr_Stock_Price:  101.1251542181078
curr_Factors:  [101.12515422  -0.60113071  -0.9215757 ]
mat_Sqrt:  [[22.0574958   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00172195 -0.00227926 -0.05728075]
Stock Position:  -0.0017219524761542106
Bond Position:  [4.80205712]


portfolio before change:  [4.62847601]
curr_Stock_Price:  101.15343708954289
curr_Factors:  [101.15343709  -0.52710505  -0.93729143]
mat_Sqrt:  [[23.38844423  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00208114  0.03215298 -0.04528863]
Stock Position:  -0.0020811375980687697
Bond Position:  [4.83899023]


portfolio before change:  [4.62863517]
curr_Stock_Price:  101.36762324929215
curr_Factors:  [101.36762325  -0.42050249  -0.91237949]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [4.62863517]
Stock Price:  100.37280489948643
PL:  [4.25583027]
Settle:  Tensor("sub_134:0", shape=(), dtype=float64)
PL:  Tensor("sub_135:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  68
output_Z_Vals[:, i, :]:  [[ 1.19260232e+02 -2.92559343e+01 -2.92733494e+01]
 [-8.11389406e-03 -5.04888728e-02 -2.40754647e-02]
 [-4.78385161e-02 -4.21651984e-02 -2.64050474e-02]
 [-9.44399481e-03  1.44323401e-01  2.02411697e-02]
 [ 1.12096828e-01  5.80034994e-03 -6.62751142e-02]
 [ 7.36653881e-02  3.02706859e-02 -3.93491283e-02]
 [ 4.72991588e-02  3.21085381e-02 -4.94927328e-02]
 [-1.18228033e-01  2.69083378e-01  2.10765851e-02]
 [-2.71784411e-02 -3.75152417e-02  2.48300646e-02]
 [-3.13731437e-02 -1.03677682e-01 -1.31997525e-01]
 [ 5.62003063e-02  1.51603852e-01 -8.29543266e-02]
 [-5.43286110e-02  2.32062503e-02  4.67840712e-03]
 [-1.12795779e-01  4.53084746e-02 -2.32252794e-02]
 [-9.62623594e-02 -1.14884369e-01  6.32126881e-02]
 [ 2.07398461e-01  2.75733511e-01  5.16411492e-02]
 [-8.14210973e-02 -3.11948353e-01 -8.09109634e-02]
 [-6.67761207e-02 -4.54327319e-02 -4.12448079e-02]
 [-8.21857675e-02  1.34908234e-01  1.20287742e-01]
 [ 8.38324729e-02  4.54020132e-02  5.93481164e-02]
 [ 2.78639703e-01 -7.29708571e-02 -4.95286709e-02]
 [-5.91686954e-02  1.58087209e-03 -8.25455381e-03]
 [ 8.23776735e-02 -5.67845398e-02  8.72698178e-02]
 [-8.79824614e-02  1.37623806e-01  3.27926350e-01]
 [ 4.63788018e-02 -1.79711522e-02 -6.27644261e-02]
 [-2.97291762e-03  4.51659451e-02  9.10550138e-02]
 [ 2.27676954e-02 -8.00179635e-02  8.10059882e-02]
 [-1.15456721e-01  5.96004726e-02  1.58638078e-02]
 [-4.70634515e-02  7.07100794e-02  2.82721323e-02]
 [-3.69625893e-03 -6.32278204e-02 -2.33208854e-01]
 [ 1.16187318e-02 -4.80182158e-03 -1.05794357e-01]
 [-3.00708936e-02  2.99991173e-01  1.75549667e-02]
 [ 1.88451856e-02 -1.06009898e-01 -7.43608996e-02]
 [ 3.63778307e-02 -2.06752440e-02  7.13240627e-02]
 [-5.16402517e-02 -8.70522126e-02 -1.20071166e-02]
 [-1.50678755e-01  1.23266614e-01  3.48161353e-02]
 [ 8.84095769e-02 -1.63450824e-01 -1.36838796e-01]
 [-1.40364981e-01 -2.27802265e-01  1.13603023e-02]
 [-4.38155062e-02 -2.42808780e-02  2.74159624e-02]
 [-3.91035103e-02  8.37401228e-02 -2.39368867e-02]
 [ 5.10450048e-02  6.41525934e-03 -4.64982586e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.26023247 -29.25593426 -29.27334937]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  8.31486419  -9.25153874 -83.50871763]
init_Out:  [2.49911038]
Stock Position:  8.31486419409362
Bond position:  [-828.98730903]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [4.92194392]
curr_Stock_Price:  100.30384903176011
curr_Factors:  [100.30384903  -1.01394107  -0.98963396]
mat_Sqrt:  [[13.52620667  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00105956 -0.01596598 -0.0686806 ]
Stock Position:  -0.0010595649734609477
Bond Position:  [5.02822237]


portfolio before change:  [4.92275561]
curr_Stock_Price:  100.13102222178058
curr_Factors:  [100.13102222  -1.20913293  -0.98437505]
mat_Sqrt:  [[11.16709579  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00486403 -0.01333381 -0.07532625]
Stock Position:  -0.004864033192468446
Bond Position:  [5.40979623]


portfolio before change:  [4.9283143]
curr_Stock_Price:  99.12724183676124
curr_Factors:  [99.12724184 -1.05375591 -0.94805009]
mat_Sqrt:  [[13.391207    0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00011843  0.04563907  0.05774242]
Stock Position:  -0.00011842615594079208
Bond Position:  [4.94005356]


portfolio before change:  [4.9288765]
curr_Stock_Price:  99.59458191626814
curr_Factors:  [99.59458192 -0.9635207  -0.95490506]
mat_Sqrt:  [[14.62426307  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00675031  0.00183423 -0.18906445]
Stock Position:  0.006750305381379018
Bond Position:  [4.25658266]


portfolio before change:  [4.92981611]
curr_Stock_Price:  99.65494997980962
curr_Factors:  [99.65494998 -0.82038482 -0.95486963]
mat_Sqrt:  [[16.88556766  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00393323  0.00957243 -0.11225211]
Stock Position:  0.003933232689276653
Bond Position:  [4.53785]


portfolio before change:  [4.93190464]
curr_Stock_Price:  100.04172190563112
curr_Factors:  [100.04172191  -0.71858491  -0.98006039]
mat_Sqrt:  [[18.30074954  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00207781  0.01015361 -0.14118899]
Stock Position:  0.002077813032582191
Bond Position:  [4.72403665]


portfolio before change:  [4.93423101]
curr_Stock_Price:  100.87713079088454
curr_Factors:  [100.87713079  -0.50727855  -0.99086809]
mat_Sqrt:  [[22.55048581  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00474394  0.08509164  0.06012563]
Stock Position:  -0.00474393726770387
Bond Position:  [5.41278579]


portfolio before change:  [4.93641685]
curr_Stock_Price:  100.55899715512771
curr_Factors:  [100.55899716  -0.92979442  -0.99902237]
mat_Sqrt:  [[14.61323759  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0015793  -0.01186336  0.07083326]
Stock Position:  -0.0015792985359208685
Bond Position:  [5.09522953]


portfolio before change:  [4.93933483]
curr_Stock_Price:  99.11466400109663
curr_Factors:  [99.114664   -0.9184996  -0.99491668]
mat_Sqrt:  [[14.62688274  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00416999 -0.03278576 -0.3765522 ]
Stock Position:  -0.004169991174068128
Bond Position:  [5.3526421]


portfolio before change:  [4.93731902]
curr_Stock_Price:  99.75853449834143
curr_Factors:  [99.7585345  -1.05299821 -0.9761371 ]
mat_Sqrt:  [[13.11317295  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.003293    0.04794135 -0.2366456 ]
Stock Position:  0.003293003156404803
Bond Position:  [4.60881385]


portfolio before change:  [4.93845911]
curr_Stock_Price:  99.92979338195624
curr_Factors:  [99.92979338 -0.81993071 -0.93420261]
mat_Sqrt:  [[17.29356658  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00305168  0.00733846  0.01334619]
Stock Position:  -0.0030516812201106377
Bond Position:  [5.24341298]


portfolio before change:  [4.94246575]
curr_Stock_Price:  98.83165225087365
curr_Factors:  [98.83165225 -0.85960196 -0.9176291 ]
mat_Sqrt:  [[16.71300001  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00696265  0.0143278  -0.06625526]
Stock Position:  -0.006962649382912844
Bond Position:  [5.6305959]


portfolio before change:  [4.95505949]
curr_Stock_Price:  97.12398788493928
curr_Factors:  [97.12398788 -0.69261628 -0.93152598]
mat_Sqrt:  [[19.14125841  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00450991 -0.03632963  0.1803282 ]
Stock Position:  -0.004509913784902889
Bond Position:  [5.3930803]


portfolio before change:  [4.9578883]
curr_Stock_Price:  96.64623296993213
curr_Factors:  [96.64623297 -0.54271778 -0.9438332 ]
mat_Sqrt:  [[21.85667238  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01029704 0.08719459 0.14731782]
Stock Position:  0.01029704207701731
Bond Position:  [3.96271797]


portfolio before change:  [4.97913952]
curr_Stock_Price:  98.66194225204629
curr_Factors:  [98.66194225 -0.40930297 -0.97814683]
mat_Sqrt:  [[24.63700247  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00430212 -0.09864673 -0.23081646]
Stock Position:  -0.004302124437484616
Bond Position:  [5.40359547]


portfolio before change:  [4.98071488]
curr_Stock_Price:  98.45277223961484
curr_Factors:  [98.45277224 -0.31763949 -0.99470302]
mat_Sqrt:  [[26.50237775  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00288156 -0.01436709 -0.11765996]
Stock Position:  -0.0028815622026479915
Bond Position:  [5.26441267]


portfolio before change:  [4.97990768]
curr_Stock_Price:  98.96127888832571
curr_Factors:  [98.96127889 -0.35465639 -0.97850247]
mat_Sqrt:  [[26.09046155  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00207543  0.04266173  0.34314745]
Stock Position:  -0.002075425890492838
Bond Position:  [5.18529448]


portfolio before change:  [4.98110789]
curr_Stock_Price:  98.69530884166208
curr_Factors:  [98.69530884 -0.37465455 -0.97701313]
mat_Sqrt:  [[25.5431643   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00380216 0.01435738 0.16930366]
Stock Position:  0.0038021574084886947
Bond Position:  [4.60585279]


portfolio before change:  [4.99278775]
curr_Stock_Price:  101.61578250179377
curr_Factors:  [101.6157825   -0.44173346  -0.95472323]
mat_Sqrt:  [[25.14708974  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01060344 -0.02307541 -0.14129151]
Stock Position:  0.01060343797519017
Bond Position:  [3.91531111]


portfolio before change:  [4.97568546]
curr_Stock_Price:  99.95672258289318
curr_Factors:  [99.95672258 -0.23786086 -0.97451413]
mat_Sqrt:  [[29.73611587  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00204508  0.00049992 -0.02354794]
Stock Position:  -0.002045083206555503
Bond Position:  [5.18010527]


portfolio before change:  [4.9767256]
curr_Stock_Price:  99.7647585542881
curr_Factors:  [99.76475855 -0.33739114 -0.9956398 ]
mat_Sqrt:  [[26.30565815  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00375301 -0.01795685  0.2489565 ]
Stock Position:  0.0037530093102526147
Bond Position:  [4.60230753]


portfolio before change:  [4.98289653]
curr_Stock_Price:  101.25572460531586
curr_Factors:  [101.25572461  -0.52701214  -1.01671467]
mat_Sqrt:  [[21.62656536  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-8.08789739e-04  4.35204686e-02  9.35482598e-01]
Stock Position:  -0.0008087897390672857
Bond Position:  [5.06479112]


portfolio before change:  [4.98371764]
curr_Stock_Price:  101.02330877197183
curr_Factors:  [101.02330877  -0.56966793  -1.02222828]
mat_Sqrt:  [[20.56221297  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0016099  -0.00568298 -0.17904944]
Stock Position:  0.0016098974324588473
Bond Position:  [4.82108048]


portfolio before change:  [4.98401556]
curr_Stock_Price:  100.83400957632855
curr_Factors:  [100.83400958  -0.57860117  -1.00778453]
mat_Sqrt:  [[20.63709104  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00081309 0.01428273 0.25975461]
Stock Position:  0.0008130888643653942
Bond Position:  [4.90202855]


portfolio before change:  [4.98441549]
curr_Stock_Price:  100.5722127915554
curr_Factors:  [100.57221279  -0.70048463  -0.99578202]
mat_Sqrt:  [[18.44160695  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00201918 -0.0253039   0.23108754]
Stock Position:  0.00201917970652371
Bond Position:  [4.78134212]


portfolio before change:  [4.985818]
curr_Stock_Price:  100.97079016481086
curr_Factors:  [100.97079016  -0.83651307  -0.98831315]
mat_Sqrt:  [[16.28110209  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00679804  0.01884732  0.04525503]
Stock Position:  -0.00679804452837627
Bond Position:  [5.67222192]


portfolio before change:  [4.98342303]
curr_Stock_Price:  101.4273979539382
curr_Factors:  [101.42739795  -0.94552806  -0.99879432]
mat_Sqrt:  [[14.51265271  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00271947  0.02236049  0.08065252]
Stock Position:  -0.0027194683886311477
Bond Position:  [5.25925163]


portfolio before change:  [4.98452822]
curr_Stock_Price:  101.26275466143585
curr_Factors:  [101.26275466  -0.80734074  -0.98115887]
mat_Sqrt:  [[16.93223254  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00312613 -0.01999439 -0.66527995]
Stock Position:  -0.0031261295317988203
Bond Position:  [5.30108871]


portfolio before change:  [4.98373633]
curr_Stock_Price:  101.72804788951468
curr_Factors:  [101.72804789  -0.63366472  -1.00231249]
mat_Sqrt:  [[19.81275339  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00050979 -0.00151847 -0.30180185]
Stock Position:  -0.0005097945390303149
Bond Position:  [5.03559673]


portfolio before change:  [4.98377661]
curr_Stock_Price:  102.88383076342548
curr_Factors:  [102.88383076  -0.7043447   -1.0244794 ]
mat_Sqrt:  [[18.26116001  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00102632  0.09486554  0.05007943]
Stock Position:  -0.0010263182764618183
Bond Position:  [5.08936816]


portfolio before change:  [4.98469194]
curr_Stock_Price:  102.61186168357101
curr_Factors:  [102.61186168  -0.5742206   -1.01338363]
mat_Sqrt:  [[20.97537879  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 4.42979717e-05 -3.35232733e-02 -2.12130948e-01]
Stock Position:  4.4297971711599686e-05
Bond Position:  [4.98014645]


portfolio before change:  [4.98530679]
curr_Stock_Price:  102.4377245605458
curr_Factors:  [102.43772456  -0.44111139  -1.01349365]
mat_Sqrt:  [[23.91844714  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00210728 -0.00653809  0.2034677 ]
Stock Position:  0.002107284023422299
Bond Position:  [4.76944141]


portfolio before change:  [4.98623896]
curr_Stock_Price:  102.59715264388112
curr_Factors:  [102.59715264  -0.67477509  -1.00038133]
mat_Sqrt:  [[19.21428015  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00293214 -0.02752833 -0.03425296]
Stock Position:  -0.002932135480948027
Bond Position:  [5.28706772]


portfolio before change:  [4.9859119]
curr_Stock_Price:  102.93410426803295
curr_Factors:  [102.93410427  -0.85332066  -1.02168312]
mat_Sqrt:  [[15.78539651  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00889361  0.03898033  0.09932074]
Stock Position:  -0.008893613197687398
Bond Position:  [5.90136801]


portfolio before change:  [4.97716219]
curr_Stock_Price:  104.00087282054817
curr_Factors:  [104.00087282  -0.64767807  -1.05285696]
mat_Sqrt:  [[18.98908344  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00296261 -0.05168769 -0.390363  ]
Stock Position:  0.0029626070514278697
Bond Position:  [4.66904847]


portfolio before change:  [4.97146592]
curr_Stock_Price:  101.88113843095677
curr_Factors:  [101.88113843  -0.7314678   -1.04610772]
mat_Sqrt:  [[17.22275215  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00835685 -0.0720374   0.03240778]
Stock Position:  -0.00835684664365098
Bond Position:  [5.82287097]


portfolio before change:  [4.96352198]
curr_Stock_Price:  102.91883177437366
curr_Factors:  [102.91883177  -0.60480264  -1.06474813]
mat_Sqrt:  [[19.38287353  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00200415 -0.00767829  0.07821011]
Stock Position:  -0.0020041494779648597
Bond Position:  [5.1697867]


portfolio before change:  [4.96340138]
curr_Stock_Price:  103.30146704669622
curr_Factors:  [103.30146705  -0.42842416  -1.06702297]
mat_Sqrt:  [[23.15485426  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00180642  0.02648095 -0.06828527]
Stock Position:  -0.0018064223446624902
Bond Position:  [5.15000746]


portfolio before change:  [4.96222357]
curr_Stock_Price:  104.30987071268223
curr_Factors:  [104.30987071  -0.45425681  -1.09485054]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [4.96222357]
Stock Price:  104.07144875936497
PL:  [0.89077481]
Settle:  Tensor("sub_136:0", shape=(), dtype=float64)
PL:  Tensor("sub_137:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  69
output_Z_Vals[:, i, :]:  [[ 1.19260232e+02 -2.92559343e+01 -2.92733494e+01]
 [ 5.06888704e-02 -1.50819122e-02 -1.04542592e-01]
 [-3.45144450e-02  4.34285306e-02  1.10991315e-01]
 [ 6.35568521e-02  1.73502448e-01  3.38709367e-02]
 [ 8.87126885e-02  1.36153144e-02 -6.78140567e-02]
 [ 6.63493101e-02  2.93583779e-02 -3.47093681e-02]
 [ 7.75086721e-02  9.45753401e-03 -7.80653716e-02]
 [-8.96063514e-02  7.50116319e-03 -9.49815502e-02]
 [-8.68325733e-02 -6.89979884e-02  6.14309746e-02]
 [-1.09101871e-01 -1.46646857e-01 -1.23614569e-01]
 [ 6.40849550e-02  1.39946063e-01 -9.21225564e-02]
 [-2.10948406e-01 -1.01885321e-01  4.92098331e-02]
 [-8.26029781e-02 -2.13766420e-02 -2.15392356e-03]
 [-9.62623594e-02 -1.14884369e-01  6.32126881e-02]
 [ 3.60796365e-01  4.77300554e-01  8.15132427e-02]
 [-3.64075182e-02 -3.40634190e-01 -4.88422593e-02]
 [-6.73973568e-02 -5.92589036e-02 -4.17112296e-02]
 [-7.02673897e-02  2.49233952e-01  1.43978829e-01]
 [ 6.41612971e-02  7.59162393e-02  7.50904820e-02]
 [-4.84530939e-02 -2.31257759e-02  1.28114637e-01]
 [ 5.77260425e-02 -8.54495210e-02  4.83340493e-02]
 [ 1.25186279e-01  7.91744315e-03  2.44301726e-01]
 [-2.16363718e-02 -9.27132426e-02  1.95003559e-01]
 [-6.25736389e-02 -7.09072203e-04 -8.37632762e-02]
 [-4.49402447e-01  1.48247662e-01  3.11610432e-02]
 [-1.00425364e-01 -2.18184757e-01  1.20467842e-01]
 [ 1.67968390e-01  5.80944189e-02 -1.15116950e-01]
 [ 4.89100898e-02 -9.64690297e-02 -3.95221246e-02]
 [-1.32935302e-01 -1.84266911e-01 -7.73104567e-02]
 [ 1.15936298e-01  1.42769587e-01 -6.10321297e-03]
 [ 7.82438431e-02 -4.28116808e-02  5.91257525e-02]
 [ 8.68012775e-02 -6.35024744e-02 -5.07169533e-02]
 [ 3.70657787e-01 -3.51316771e-01 -2.88173591e-01]
 [-4.44841905e-02 -8.00660325e-02  7.67918913e-03]
 [-1.57420840e-01 -3.74573153e-02  1.79793257e-02]
 [ 2.00495190e-01 -8.76456412e-03 -7.42649944e-03]
 [ 2.30117101e-02  8.08568922e-03 -9.42921757e-02]
 [-1.17761449e-02  4.10730438e-02 -4.40704629e-02]
 [ 1.67280206e-01 -2.49917411e-01 -4.30324430e-02]
 [-6.05881222e-01  3.19958869e-01  3.51556627e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.26023247 -29.25593426 -29.27334937]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  8.31486419  -9.25153874 -83.50871763]
init_Out:  [2.49911038]
Stock Position:  8.31486419409362
Bond position:  [-828.98730903]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-2.250103]
curr_Stock_Price:  99.44129171814865
curr_Factors:  [99.44129172 -1.1113951  -1.00903786]
mat_Sqrt:  [[11.93093347  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00242729 -0.00476932 -0.29823092]
Stock Position:  0.002427286175827574
Bond Position:  [-2.49147547]


portfolio before change:  [-2.25063593]
curr_Stock_Price:  99.35004470357065
curr_Factors:  [99.3500447  -1.23969079 -1.03326386]
mat_Sqrt:  [[10.23378775  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00104918  0.01373331  0.31662733]
Stock Position:  -0.0010491831749325983
Bond Position:  [-2.14639954]


portfolio before change:  [-2.25086218]
curr_Stock_Price:  99.30994219663538
curr_Factors:  [99.3099422  -1.20720675 -1.0479339 ]
mat_Sqrt:  [[10.41352077  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00719743 0.05486629 0.09662435]
Stock Position:  0.0071974256968202095
Bond Position:  [-2.96563811]


portfolio before change:  [-2.24999376]
curr_Stock_Price:  99.48210651268883
curr_Factors:  [99.48210651 -0.9132135  -1.05557886]
mat_Sqrt:  [[13.89022613  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00541544  0.00430554 -0.19345463]
Stock Position:  0.005415444451596993
Bond Position:  [-2.78873359]


portfolio before change:  [-2.2532175]
curr_Stock_Price:  98.95119504086617
curr_Factors:  [98.95119504 -0.96079265 -1.07730942]
mat_Sqrt:  [[12.89093917  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00465616  0.00928393 -0.09901617]
Stock Position:  0.004656163469370499
Bond Position:  [-2.71395044]


portfolio before change:  [-2.25457837]
curr_Stock_Price:  98.73178501849355
curr_Factors:  [98.73178502 -1.26056343 -1.10875969]
mat_Sqrt:  [[ 9.23576837  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00669331  0.00299073 -0.22269878]
Stock Position:  0.006693307459670165
Bond Position:  [-2.91542057]


portfolio before change:  [-2.25899783]
curr_Stock_Price:  98.1259551647952
curr_Factors:  [98.12595516 -1.22466497 -1.09602494]
mat_Sqrt:  [[ 9.63653881  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01129043  0.00237208 -0.27095592]
Stock Position:  -0.011290433429140568
Bond Position:  [-1.15111326]


portfolio before change:  [-2.26114785]
curr_Stock_Price:  98.30363826002989
curr_Factors:  [98.30363826 -1.3551358  -1.08391693]
mat_Sqrt:  [[ 8.57634907  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00887027 -0.02181908  0.17524547]
Stock Position:  -0.008870271942348074
Bond Position:  [-1.38916784]


portfolio before change:  [-2.25651599]
curr_Stock_Price:  97.76188286383582
curr_Factors:  [97.76188286 -1.32472736 -1.07763319]
mat_Sqrt:  [[ 8.84784743  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01561069 -0.04637381 -0.35263796]
Stock Position:  -0.015610688974042037
Bond Position:  [-0.73038564]


portfolio before change:  [-2.26211954]
curr_Stock_Price:  98.11499050161756
curr_Factors:  [98.1149905  -1.31414496 -1.05834716]
mat_Sqrt:  [[ 9.14903168  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00534416  0.04425483 -0.26280001]
Stock Position:  0.00534416214134071
Bond Position:  [-2.78646196]


portfolio before change:  [-2.2685902]
curr_Stock_Price:  96.96938093289249
curr_Factors:  [96.96938093 -1.2430462  -1.03454747]
mat_Sqrt:  [[ 9.94233191  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02047147 -0.03221897  0.14038196]
Stock Position:  -0.020471470895130184
Bond Position:  [-0.28348434]


portfolio before change:  [-2.26230026]
curr_Stock_Price:  96.66039632077698
curr_Factors:  [96.66039632 -1.22912032 -1.00293558]
mat_Sqrt:  [[10.37239413  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00805933 -0.00675989 -0.00614454]
Stock Position:  -0.008059333975142743
Bond Position:  [-1.48328185]


portfolio before change:  [-2.26168102]
curr_Stock_Price:  96.56055304643931
curr_Factors:  [96.56055305 -1.15479681 -0.99757839]
mat_Sqrt:  [[11.2210907   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00769314 -0.03632963  0.1803282 ]
Stock Position:  -0.007693140307129415
Bond Position:  [-1.51882713]


portfolio before change:  [-2.26715074]
curr_Stock_Price:  97.24686040538793
curr_Factors:  [97.24686041 -1.25138367 -0.9917456 ]
mat_Sqrt:  [[10.32040937  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.03776585 0.15093569 0.23253459]
Stock Position:  0.03776585013879535
Bond Position:  [-5.9397611]


portfolio before change:  [-2.24815682]
curr_Stock_Price:  97.7694604797372
curr_Factors:  [97.76946048 -1.35183667 -0.98953837]
mat_Sqrt:  [[ 9.40496012  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00586632 -0.10771799 -0.13933337]
Stock Position:  -0.005866323607000278
Bond Position:  [-1.67460953]


portfolio before change:  [-2.24888195]
curr_Stock_Price:  97.85738379854314
curr_Factors:  [97.8573838  -1.36577802 -0.97790455]
mat_Sqrt:  [[ 9.39172128  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00824574 -0.01873931 -0.11899053]
Stock Position:  -0.008245739191291724
Bond Position:  [-1.44197548]


portfolio before change:  [-2.24853962]
curr_Stock_Price:  97.79400811200027
curr_Factors:  [97.79400811 -1.42777392 -0.95367777]
mat_Sqrt:  [[ 9.03776234  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00381097  0.0788147   0.41073152]
Stock Position:  -0.0038109700287776004
Bond Position:  [-1.87584959]


portfolio before change:  [-2.24911015]
curr_Stock_Price:  97.88218160694915
curr_Factors:  [97.88218161 -1.51588657 -0.94587454]
mat_Sqrt:  [[ 8.34784496  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00975692 0.02400682 0.21421224]
Stock Position:  0.009756916511578565
Bond Position:  [-3.20413842]


portfolio before change:  [-2.25217364]
curr_Stock_Price:  97.6092515742976
curr_Factors:  [97.60925157 -1.51648164 -0.93910945]
mat_Sqrt:  [[ 8.37608981  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00273384 -0.00731301  0.3654754 ]
Stock Position:  -0.002733842237424092
Bond Position:  [-1.98532535]


portfolio before change:  [-2.25165195]
curr_Stock_Price:  97.32764032875323
curr_Factors:  [97.32764033 -1.41478758 -0.92879285]
mat_Sqrt:  [[ 9.34183394  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00699926 -0.02702151  0.13788359]
Stock Position:  0.006999256495235825
Bond Position:  [-2.93287306]


portfolio before change:  [-2.25150966]
curr_Stock_Price:  97.40035056134664
curr_Factors:  [97.40035056 -1.28079697 -0.91807033]
mat_Sqrt:  [[10.80449777  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01622089 0.00250372 0.69692482]
Stock Position:  0.016220891603292736
Bond Position:  [-3.83143019]


portfolio before change:  [-2.24925866]
curr_Stock_Price:  97.56864933741868
curr_Factors:  [97.56864934 -1.15874292 -0.90965323]
mat_Sqrt:  [[12.33153845  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00127922 -0.0293185   0.55629087]
Stock Position:  0.001279217296753498
Bond Position:  [-2.37407017]


portfolio before change:  [-2.24973138]
curr_Stock_Price:  97.43111544386645
curr_Factors:  [97.43111544 -1.30654889 -0.90897277]
mat_Sqrt:  [[10.62940226  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-7.49713411e-03 -2.24228319e-04 -2.38953312e-01]
Stock Position:  -0.0074971341084127535
Bond Position:  [-1.51927724]


portfolio before change:  [-2.25384459]
curr_Stock_Price:  97.95442076576964
curr_Factors:  [97.95442077 -1.38237672 -0.92552586]
mat_Sqrt:  [[ 9.74349312  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.04507767  0.04688003  0.08889378]
Stock Position:  -0.045077672112292695
Bond Position:  [2.16171267]


portfolio before change:  [-2.1902585]
curr_Stock_Price:  96.54982610098973
curr_Factors:  [96.5498261  -1.10799371 -0.93109095]
mat_Sqrt:  [[12.56574612  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00648338 -0.06899608  0.34366122]
Stock Position:  -0.006483377443972803
Bond Position:  [-1.56428953]


portfolio before change:  [-2.18920927]
curr_Stock_Price:  96.35783101396345
curr_Factors:  [96.35783101 -1.23871917 -0.91260067]
mat_Sqrt:  [[11.20935652  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01302218  0.01837107 -0.32839661]
Stock Position:  0.013022177721120595
Bond Position:  [-3.44399807]


portfolio before change:  [-2.19177536]
curr_Stock_Price:  96.1938364990187
curr_Factors:  [96.1938365  -1.29367007 -0.90230507]
mat_Sqrt:  [[10.70156657  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00358376 -0.03050619 -0.11274562]
Stock Position:  0.0035837603735043165
Bond Position:  [-2.53651102]


portfolio before change:  [-2.19651515]
curr_Stock_Price:  94.95973973900865
curr_Factors:  [94.95973974 -1.12667657 -0.90305924]
mat_Sqrt:  [[12.47488222  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01230264 -0.05827031 -0.22054521]
Stock Position:  -0.012302639953741996
Bond Position:  [-1.02825967]


portfolio before change:  [-2.20084554]
curr_Stock_Price:  95.30127967888272
curr_Factors:  [95.30127968 -0.92342087 -0.88937767]
mat_Sqrt:  [[15.55286245  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00761125  0.04514771 -0.01741077]
Stock Position:  0.007611253555067663
Bond Position:  [-2.92620774]


portfolio before change:  [-2.20104602]
curr_Stock_Price:  95.32299994048809
curr_Factors:  [95.32299994 -0.69961043 -0.91951816]
mat_Sqrt:  [[18.88074342  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00472478 -0.01353824  0.16866931]
Stock Position:  0.00472478450062264
Bond Position:  [-2.65142665]


portfolio before change:  [-2.20100633]
curr_Stock_Price:  95.40155062651542
curr_Factors:  [95.40155063 -0.9135668  -0.90298793]
mat_Sqrt:  [[15.51085511  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00482302 -0.02008125 -0.14468135]
Stock Position:  0.004823015581931215
Bond Position:  [-2.6611295]


portfolio before change:  [-2.20275615]
curr_Stock_Price:  95.10771940981374
curr_Factors:  [95.10771941 -0.9747341  -0.90320465]
mat_Sqrt:  [[14.54244157  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.02081931 -0.11109612 -0.82207904]
Stock Position:  0.020819312701605537
Bond Position:  [-4.1828335]


portfolio before change:  [-2.19612539]
curr_Stock_Price:  95.45132528321452
curr_Factors:  [95.45132528 -0.96083435 -0.9007428 ]
mat_Sqrt:  [[14.83574224  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00303214 -0.0253191   0.02190659]
Stock Position:  -0.003032135361495755
Bond Position:  [-1.90670406]


portfolio before change:  [-2.1953516]
curr_Stock_Price:  95.11751771737116
curr_Factors:  [95.11751772 -0.99290839 -0.89687941]
mat_Sqrt:  [[14.37262505  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01076477 -0.01184504  0.05129001]
Stock Position:  -0.010764767671195732
Bond Position:  [-1.17143362]


portfolio before change:  [-2.19070201]
curr_Stock_Price:  94.67198761976115
curr_Factors:  [94.67198762 -0.82335807 -0.90687447]
mat_Sqrt:  [[16.77996506  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01184466 -0.0027716  -0.02118574]
Stock Position:  0.011844658885571811
Bond Position:  [-3.31205941]


portfolio before change:  [-2.18764918]
curr_Stock_Price:  94.96468134493182
curr_Factors:  [94.96468134 -0.99451374 -0.93061923]
mat_Sqrt:  [[13.85120279  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00028685  0.00255692 -0.26898933]
Stock Position:  0.0002868467118680965
Bond Position:  [-2.21488949]


portfolio before change:  [-2.18812569]
curr_Stock_Price:  94.26875713831306
curr_Factors:  [94.26875714 -0.99923792 -0.89768665]
mat_Sqrt:  [[14.14307707  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00139372  0.01298844 -0.12572076]
Stock Position:  -0.0013937199767312767
Bond Position:  [-2.05674144]


portfolio before change:  [-2.1885364]
curr_Stock_Price:  94.37897001862297
curr_Factors:  [94.37897002 -1.04346922 -0.91726186]
mat_Sqrt:  [[13.28435725  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0114453  -0.07903082 -0.12275958]
Stock Position:  0.011445296386519534
Bond Position:  [-3.26873168]


portfolio before change:  [-2.19037148]
curr_Stock_Price:  94.25433712933578
curr_Factors:  [94.25433713 -1.36821086 -0.92635988]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-2.19037148]
Stock Price:  94.90901897348037
PL:  [-2.19037148]
Settle:  Tensor("sub_138:0", shape=(), dtype=float64)
PL:  Tensor("sub_139:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  70
output_Z_Vals[:, i, :]:  [[ 1.19260232e+02 -2.92559343e+01 -2.92733494e+01]
 [ 1.19592578e-01 -6.31942301e-01 -4.26171482e-01]
 [-6.50693498e-02 -1.21360952e-02  1.02773896e-01]
 [-3.04672989e-02  1.53668877e-01  1.61828063e-02]
 [-2.11767969e-02  5.34397476e-02 -7.10529284e-02]
 [ 5.74839363e-02  2.91737176e-02  3.01247791e-03]
 [ 7.59925240e-02  1.49360105e-02 -6.70716703e-02]
 [-9.23899538e-02 -2.60118508e-03 -9.86658740e-02]
 [ 2.19427607e-02 -5.43388071e-02 -1.02200725e-02]
 [-4.96630936e-02 -1.13788539e-01 -1.30024974e-01]
 [ 8.78730916e-02  9.87745831e-02 -6.81892429e-02]
 [-1.35782181e-01 -1.03163479e-01  1.91322719e-02]
 [-1.14306613e-01  4.65474170e-02 -3.19886740e-02]
 [-9.32113245e-02 -1.12465324e-01  6.65463416e-02]
 [ 2.61639748e-01  3.37140066e-01  5.09896404e-02]
 [-6.31071891e-02 -1.73172737e-01 -8.59583319e-02]
 [-7.20034455e-02 -5.51890860e-02 -6.09861443e-02]
 [-8.25400236e-02  1.31510072e-01  1.19583559e-01]
 [ 9.72675584e-02  7.03963231e-02  1.17951362e-01]
 [ 2.09994950e-01 -5.75296305e-02 -1.81695440e-03]
 [-4.49619975e-02  1.00677500e-03 -4.99054046e-02]
 [ 6.26350233e-02 -4.87021794e-02  6.08752098e-02]
 [-1.78624449e-02 -9.26239893e-02  7.21580995e-02]
 [-3.45115797e-02 -9.38297123e-02 -2.70930279e-02]
 [-1.23581894e-01  8.19632555e-02  5.65322219e-02]
 [ 2.11524342e-02 -8.12715402e-02  8.14599370e-02]
 [-1.34489630e-01  6.90629338e-02  3.11001133e-02]
 [ 6.93859432e-02 -3.06741002e-01 -1.48360805e-01]
 [-8.34105550e-02 -7.92666529e-02 -1.94638440e-01]
 [ 4.32360560e-02  1.40434585e-02 -1.35095349e-02]
 [ 6.35814971e-02  2.13127159e-02  3.80753166e-02]
 [ 2.91730517e-02 -5.95270337e-02 -9.42806437e-02]
 [ 3.79773618e-01 -5.64239654e-01 -6.39323189e-01]
 [-4.26544682e-02 -8.06005666e-02 -1.65263099e-03]
 [ 5.66685308e-02  8.37825284e-02  6.85830188e-03]
 [ 8.47165236e-02 -1.65012150e-01 -1.38726811e-01]
 [-2.05831156e-01 -3.41940644e-01  7.53426830e-02]
 [-3.39559916e-02 -7.64434813e-03 -1.88644852e-02]
 [-4.51758029e-02  9.64744191e-02 -2.01267980e-02]
 [ 1.13240841e-02  1.65782479e-02 -1.30421740e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.26023247 -29.25593426 -29.27334937]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  8.31486419  -9.25153874 -83.50871763]
init_Out:  [2.49911038]
Stock Position:  8.31486419409362
Bond position:  [-828.98730903]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-10.90123429]
curr_Stock_Price:  98.40085003564329
curr_Factors:  [98.40085004 -1.35644342 -0.98573298]
mat_Sqrt:  [[ 9.45811438  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0017217  -0.1998377  -1.21574861]
Stock Position:  0.0017216971439986027
Bond Position:  [-11.07065075]


portfolio before change:  [-10.90275029]
curr_Stock_Price:  98.32413412493291
curr_Factors:  [98.32413412 -1.44418962 -0.98629112]
mat_Sqrt:  [[ 8.65198503  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00513224 -0.00383777  0.29318532]
Stock Position:  -0.00513224058946308
Bond Position:  [-10.39812718]


portfolio before change:  [-10.90505637]
curr_Stock_Price:  98.52019603357235
curr_Factors:  [98.52019603 -1.3582475  -1.00077782]
mat_Sqrt:  [[ 9.31137006  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00249118  0.04859437  0.04616504]
Stock Position:  -0.0024911784135606178
Bond Position:  [-10.65962499]


portfolio before change:  [-10.90586949]
curr_Stock_Price:  98.31169296601634
curr_Factors:  [98.31169297 -1.39036319 -0.99727452]
mat_Sqrt:  [[ 9.02957466  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0037987   0.01689913 -0.20269423]
Stock Position:  -0.0037986957376074455
Bond Position:  [-10.53241328]


portfolio before change:  [-10.90637647]
curr_Stock_Price:  98.09855243810871
curr_Factors:  [98.09855244 -1.43338689 -0.99354065]
mat_Sqrt:  [[ 8.66286124  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00679361 0.00922554 0.00859376]
Stock Position:  0.006793611982265982
Bond Position:  [-11.57281997]


portfolio before change:  [-10.90648848]
curr_Stock_Price:  98.29501430411754
curr_Factors:  [98.2950143  -1.27965776 -1.01925159]
mat_Sqrt:  [[ 9.86569869  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00635406  0.00472318 -0.19133681]
Stock Position:  0.006354058106345782
Bond Position:  [-11.53106071]


portfolio before change:  [-10.90717716]
curr_Stock_Price:  98.41348745312659
curr_Factors:  [98.41348745 -1.02878696 -1.03287722]
mat_Sqrt:  [[12.52233297  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00899171 -0.00082257 -0.28146628]
Stock Position:  -0.008991711335381247
Bond Position:  [-10.02227149]


portfolio before change:  [-10.90868797]
curr_Stock_Price:  98.44217435463182
curr_Factors:  [98.44217435 -0.83662369 -1.03129571]
mat_Sqrt:  [[15.20386859  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00121374 -0.01718344 -0.02915502]
Stock Position:  0.0012137420859711012
Bond Position:  [-11.02817138]


portfolio before change:  [-10.91001831]
curr_Stock_Price:  98.48194155659762
curr_Factors:  [98.48194156 -0.82622258 -0.98722561]
mat_Sqrt:  [[16.06149841  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00492746 -0.0359831  -0.37092506]
Stock Position:  -0.004927456686820335
Bond Position:  [-10.42475281]


portfolio before change:  [-10.90710321]
curr_Stock_Price:  97.6258661094182
curr_Factors:  [97.62586611 -0.88089861 -0.98448476]
mat_Sqrt:  [[15.11608042  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00506112  0.03123527 -0.19452493]
Stock Position:  0.00506112479381057
Bond Position:  [-11.4011999]


portfolio before change:  [-10.90461882]
curr_Stock_Price:  98.39834854590563
curr_Factors:  [98.39834855 -0.73242633 -1.01413227]
mat_Sqrt:  [[17.15801507  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00784126 -0.03262316  0.05457905]
Stock Position:  -0.007841262006280356
Bond Position:  [-10.13305159]


portfolio before change:  [-10.91184455]
curr_Stock_Price:  99.15830552763335
curr_Factors:  [99.15830553 -0.78045039 -1.01618535]
mat_Sqrt:  [[16.44599325  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00727438  0.01471959 -0.09125478]
Stock Position:  -0.007274381245448222
Bond Position:  [-10.19052923]


portfolio before change:  [-10.91620988]
curr_Stock_Price:  99.58328113805452
curr_Factors:  [99.58328114 -0.94991563 -0.99691963]
mat_Sqrt:  [[14.21302841  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00580675 -0.03556466  0.18983819]
Stock Position:  -0.005806746402182134
Bond Position:  [-10.33795502]


portfolio before change:  [-10.91596133]
curr_Stock_Price:  99.31792091244961
curr_Factors:  [99.31792091 -0.99702781 -0.99266416]
mat_Sqrt:  [[13.58048809  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.02067325 0.10661305 0.14545925]
Stock Position:  0.02067325430170356
Bond Position:  [-12.96918596]


portfolio before change:  [-10.92149661]
curr_Stock_Price:  99.12859284894527
curr_Factors:  [99.12859285 -1.22130429 -0.95878995]
mat_Sqrt:  [[11.20459196  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0075973  -0.05476203 -0.24521519]
Stock Position:  -0.0075973012920964615
Bond Position:  [-10.16838682]


portfolio before change:  [-10.93192035]
curr_Stock_Price:  100.33331199703218
curr_Factors:  [100.333312    -1.35889135  -0.95005208]
mat_Sqrt:  [[ 9.96973829  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00861378 -0.01745232 -0.17397649]
Stock Position:  -0.008613783393634347
Bond Position:  [-10.06767093]


portfolio before change:  [-10.93285615]
curr_Stock_Price:  100.29584446146639
curr_Factors:  [100.29584446  -1.27179664  -0.91691916]
mat_Sqrt:  [[11.23920896  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00486997  0.04158714  0.34113861]
Stock Position:  -0.004869965186690289
Bond Position:  [-10.44441888]


portfolio before change:  [-10.93591173]
curr_Stock_Price:  100.65517851337795
curr_Factors:  [100.65517851  -1.25116539  -0.90331775]
mat_Sqrt:  [[11.67228767  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01055165 0.02226127 0.3364824 ]
Stock Position:  0.010551650888858441
Bond Position:  [-11.99799003]


portfolio before change:  [-10.93557691]
curr_Stock_Price:  100.82905297643259
curr_Factors:  [100.82905298  -1.3166821   -0.90165362]
mat_Sqrt:  [[10.9691942   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01897484 -0.01819247 -0.00518327]
Stock Position:  0.01897483563416013
Bond Position:  [-12.84879161]


portfolio before change:  [-10.92049497]
curr_Stock_Price:  101.70854064642187
curr_Factors:  [101.70854065  -1.6011466   -0.90409313]
mat_Sqrt:  [[ 8.30511463  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00663722  0.00031837 -0.14236623]
Stock Position:  -0.006637223349951786
Bond Position:  [-10.24543267]


portfolio before change:  [-10.9223814]
curr_Stock_Price:  101.79979453559967
curr_Factors:  [101.79979454  -1.58132321  -0.94102536]
mat_Sqrt:  [[ 8.17155736  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00903177 -0.01540098  0.17366003]
Stock Position:  0.009031771468557744
Bond Position:  [-11.84181388]


portfolio before change:  [-10.92754089]
curr_Stock_Price:  101.39243645085818
curr_Factors:  [101.39243645  -1.78006245  -0.94741766]
mat_Sqrt:  [[ 6.62942705  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00083337 -0.02929028  0.20584697]
Stock Position:  -0.000833371513484752
Bond Position:  [-10.84304332]


portfolio before change:  [-10.92916675]
curr_Stock_Price:  101.71689930553518
curr_Factors:  [101.71689931  -1.9341549   -0.95667101]
mat_Sqrt:  [[ 5.64837305  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00751802 -0.02967156 -0.07728887]
Stock Position:  -0.007518022138642877
Bond Position:  [-10.16445685]


portfolio before change:  [-10.92854331]
curr_Stock_Price:  101.46496071078369
curr_Factors:  [101.46496071  -2.12214209  -0.96117606]
mat_Sqrt:  [[ 4.64780642  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02365116  0.02591906  0.16127069]
Stock Position:  -0.02365116149813229
Bond Position:  [-8.52877914]


portfolio before change:  [-10.92917553]
curr_Stock_Price:  101.44661312234594
curr_Factors:  [101.44661312  -2.36353713  -0.97356518]
mat_Sqrt:  [[ 3.60539155  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00989683 -0.02570032  0.23238253]
Stock Position:  0.009896831335494325
Bond Position:  [-11.93317555]


portfolio before change:  [-10.93227178]
curr_Stock_Price:  101.28448934977516
curr_Factors:  [101.28448935  -2.38215345  -0.95223466]
mat_Sqrt:  [[ 3.60941307  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.03500795  0.02183962  0.08871997]
Stock Position:  -0.03500794896116732
Bond Position:  [-7.38650955]


portfolio before change:  [-10.93484494]
curr_Stock_Price:  101.33161530602341
curr_Factors:  [101.33161531  -2.37032804  -0.91163246]
mat_Sqrt:  [[ 3.80546412  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00819398 -0.09700002 -0.42323208]
Stock Position:  0.008193981345324656
Bond Position:  [-11.7651543]


portfolio before change:  [-10.93564142]
curr_Stock_Price:  101.41390182872895
curr_Factors:  [101.41390183  -2.55661825  -0.89040148]
mat_Sqrt:  [[ 3.22905799  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.03876908 -0.02506632 -0.55524929]
Stock Position:  -0.038769082692929016
Bond Position:  [-7.00391747]


portfolio before change:  [-10.94025517]
curr_Stock_Price:  101.51032419428688
curr_Factors:  [101.51032419  -2.45355741  -0.88073089]
mat_Sqrt:  [[ 3.61782205  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01128885  0.00444093 -0.03853894]
Stock Position:  0.01128884552517156
Bond Position:  [-12.08618954]


portfolio before change:  [-10.93990501]
curr_Stock_Price:  101.67517968803968
curr_Factors:  [101.67517969  -2.18351347  -0.91499062]
mat_Sqrt:  [[ 4.58724274  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01567475 0.00673967 0.10861828]
Stock Position:  0.015674749434444236
Bond Position:  [-12.53363797]


portfolio before change:  [-10.9381355]
curr_Stock_Price:  101.88802618480295
curr_Factors:  [101.88802618  -2.02112095  -0.91804523]
mat_Sqrt:  [[ 5.39087793  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00155654 -0.0188241  -0.26895643]
Stock Position:  0.001556539511972234
Bond Position:  [-11.09672823]


portfolio before change:  [-10.93969987]
curr_Stock_Price:  101.77418483622166
curr_Factors:  [101.77418484  -2.1199477   -0.93326048]
mat_Sqrt:  [[ 4.80447755  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.04885104 -0.17842825 -1.8238111 ]
Stock Position:  0.04885103770689512
Bond Position:  [-15.91147441]


portfolio before change:  [-10.92360414]
curr_Stock_Price:  102.14438765444497
curr_Factors:  [102.14438765  -2.0048522   -0.93507708]
mat_Sqrt:  [[ 5.40031938  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00834634 -0.02548814 -0.0047145 ]
Stock Position:  -0.00834634114399214
Bond Position:  [-10.07107223]


portfolio before change:  [-10.92999922]
curr_Stock_Price:  102.75976079941056
curr_Factors:  [102.7597608   -2.30323563  -0.94010404]
mat_Sqrt:  [[ 4.01105452  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01501643 0.02649436 0.01956483]
Stock Position:  0.015016432984941869
Bond Position:  [-12.47308428]


portfolio before change:  [-10.93043786]
curr_Stock_Price:  102.8343852943967
curr_Factors:  [102.83438529  -2.09179912  -0.95145671]
mat_Sqrt:  [[ 4.90308182  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01063381 -0.05218142 -0.39574898]
Stock Position:  0.010633809172235423
Bond Position:  [-12.02395908]


portfolio before change:  [-10.93516447]
curr_Stock_Price:  102.5312461009453
curr_Factors:  [102.5312461   -1.87880013  -0.97868004]
mat_Sqrt:  [[ 5.88665203  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.03385299 -0.10813113  0.2149317 ]
Stock Position:  -0.033852988764267226
Bond Position:  [-7.46417535]


portfolio before change:  [-10.95351779]
curr_Stock_Price:  103.04583113259261
curr_Factors:  [103.04583113  -2.01742377  -0.9931028 ]
mat_Sqrt:  [[ 5.07662811  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00748608 -0.00241736 -0.05381513]
Stock Position:  -0.007486084045652593
Bond Position:  [-10.18210804]


portfolio before change:  [-10.95314761]
curr_Stock_Price:  102.82635481171175
curr_Factors:  [102.82635481  -1.85546412  -1.02259645]
mat_Sqrt:  [[ 5.78333855  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00809104  0.03050789 -0.05741615]
Stock Position:  -0.008091037578794024
Bond Position:  [-10.12117571]


portfolio before change:  [-10.95640954]
curr_Stock_Price:  103.07313443982514
curr_Factors:  [103.07313444  -1.85754409  -1.00688747]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-10.95640954]
Stock Price:  102.89283288716324
PL:  [-13.84924243]
Settle:  Tensor("sub_140:0", shape=(), dtype=float64)
PL:  Tensor("sub_141:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  71
output_Z_Vals[:, i, :]:  [[ 1.19260232e+02 -2.92559343e+01 -2.92733494e+01]
 [-1.20965453e-01  3.31746526e-01  5.25022258e-02]
 [-4.67214613e-02 -5.78199626e-02 -4.56498884e-02]
 [ 8.34306708e-02  1.56340720e-01  3.77698802e-02]
 [ 2.24565846e-01 -2.29119278e-02 -4.46288093e-02]
 [ 7.73557961e-02  3.11989198e-02 -4.46146928e-02]
 [ 7.10240933e-02  1.48990367e-02 -6.67622511e-02]
 [-1.09341277e-01 -6.41215265e-02 -1.21102326e-01]
 [-1.63452596e-02 -5.55173837e-02  3.78936204e-02]
 [-3.30392476e-02 -1.04598720e-01 -1.31817838e-01]
 [ 5.54917099e-02  1.73266314e-01 -8.31382224e-02]
 [-1.01125143e-01 -7.41144982e-03  2.11166698e-02]
 [-1.12810897e-01  4.74452070e-02 -4.25388702e-02]
 [-9.62623594e-02 -1.14884369e-01  6.32126881e-02]
 [ 4.22676864e-01  5.07227882e-01  3.51646459e-02]
 [-4.41709904e-02 -1.92475490e-01 -6.53486371e-02]
 [-6.83380085e-02 -5.83288501e-02 -6.00781877e-02]
 [-7.09710770e-02  2.42483910e-01  1.42580055e-01]
 [ 1.30623848e-01  8.10757951e-02  1.69525434e-01]
 [ 5.84848170e-02 -3.19362981e-02  6.91542799e-02]
 [-2.75799059e-02 -2.01993614e-02 -1.84457852e-02]
 [ 1.04818172e-01 -6.24622848e-02  1.09501113e-01]
 [-2.44155689e-02 -8.06081157e-02  1.79103780e-01]
 [-5.76254257e-02 -8.26821057e-04 -8.52050505e-02]
 [-2.90385656e-01  1.12019931e-01  4.77398922e-02]
 [-7.67069080e-02 -1.91361747e-01  1.12845013e-01]
 [ 2.28959213e-01  4.71749445e-02 -1.40104050e-01]
 [ 5.30158583e-02 -1.13068438e-01 -4.52816216e-02]
 [-1.21648125e-01 -1.48334806e-01 -1.14471368e-01]
 [ 4.93808782e-02  4.30218649e-02 -1.00348103e-01]
 [ 8.07017032e-02 -5.47296381e-02  6.36790449e-02]
 [ 1.07004615e-01  3.49917576e-02  1.39555832e-02]
 [ 3.72967615e-01 -3.33049377e-01 -2.56246783e-01]
 [-4.23210751e-02 -7.79542684e-02  1.36299139e-02]
 [-2.00016882e-01  8.93913310e-02  1.59667580e-02]
 [ 3.12208260e-01  1.75668120e-01  8.32739238e-02]
 [ 1.39983235e-02 -6.75381557e-02 -9.68674436e-02]
 [-5.55984011e-03  6.24707129e-02 -1.15693237e-02]
 [ 3.04542736e-01 -3.76840379e-01 -9.23132130e-02]
 [-3.48059095e-01  2.07751828e-01  1.78848880e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.26023247 -29.25593426 -29.27334937]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  8.31486419  -9.25153874 -83.50871763]
init_Out:  [2.49911038]
Stock Position:  8.31486419409362
Bond position:  [-828.98730903]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [10.71916793]
curr_Stock_Price:  101.00106114171423
curr_Factors:  [101.00106114  -1.00608512  -0.98058503]
mat_Sqrt:  [[13.85243285  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00734043  0.10490746  0.14977424]
Stock Position:  -0.007340430659982025
Bond Position:  [11.46055922]


portfolio before change:  [10.72283197]
curr_Stock_Price:  100.69707701325073
curr_Factors:  [100.69707701  -0.916465    -0.96357465]
mat_Sqrt:  [[15.36476838  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00374445 -0.01828428 -0.13022643]
Stock Position:  -0.0037444502472942756
Bond Position:  [11.09988716]


portfolio before change:  [10.72146549]
curr_Stock_Price:  101.43257873571034
curr_Factors:  [101.43257874  -0.98518192  -0.96381523]
mat_Sqrt:  [[14.44570562  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00658861 0.04943928 0.10774696]
Stock Position:  0.006588609645353836
Bond Position:  [10.05316582]


portfolio before change:  [10.72103897]
curr_Stock_Price:  101.17710098345064
curr_Factors:  [101.17710098  -1.36073151  -0.94714855]
mat_Sqrt:  [[10.06427872  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.02134921 -0.00724539 -0.12731357]
Stock Position:  0.02134921452386278
Bond Position:  [8.56098734]


portfolio before change:  [10.71207246]
curr_Stock_Price:  100.70698065241326
curr_Factors:  [100.70698065  -1.22554704  -0.9536819 ]
mat_Sqrt:  [[11.39285236  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0060612   0.00986596 -0.1272733 ]
Stock Position:  0.006061204913082857
Bond Position:  [10.10166682]


portfolio before change:  [10.70653606]
curr_Stock_Price:  99.5852247577796
curr_Factors:  [99.58522476 -1.00458807 -0.95357076]
mat_Sqrt:  [[14.05326807  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00411157  0.00471149 -0.19045412]
Stock Position:  0.004111570134984763
Bond Position:  [10.29708442]


portfolio before change:  [10.70757478]
curr_Stock_Price:  99.52478806947016
curr_Factors:  [99.52478807 -1.04450654 -0.94059226]
mat_Sqrt:  [[13.67142562  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00992704 -0.02027701 -0.34547123]
Stock Position:  -0.009927040586687759
Bond Position:  [11.69556139]


portfolio before change:  [10.70746817]
curr_Stock_Price:  99.68280599805297
curr_Factors:  [99.682806   -1.01294682 -0.94047388]
mat_Sqrt:  [[14.1338482   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00071061 -0.01755614  0.10809995]
Stock Position:  -0.0007106139307208614
Bond Position:  [10.77830416]


portfolio before change:  [10.70903746]
curr_Stock_Price:  99.37051323333814
curr_Factors:  [99.37051323 -1.25865185 -0.9370691 ]
mat_Sqrt:  [[11.05778239  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00566544 -0.03307702 -0.3760396 ]
Stock Position:  -0.005665437801609677
Bond Position:  [11.27201492]


portfolio before change:  [10.7101096]
curr_Stock_Price:  99.42998746696615
curr_Factors:  [99.42998747 -1.17053172 -0.93073781]
mat_Sqrt:  [[12.16039342  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00353565  0.05479162 -0.23717021]
Stock Position:  0.0035356510919005483
Bond Position:  [10.35855986]


portfolio before change:  [10.71083099]
curr_Stock_Price:  99.26777789394123
curr_Factors:  [99.26777789 -1.02669116 -0.930408  ]
mat_Sqrt:  [[14.02332288  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00691748 -0.00234371  0.06023998]
Stock Position:  -0.006917482023695901
Bond Position:  [11.39751406]


portfolio before change:  [10.71345033]
curr_Stock_Price:  99.09509093580296
curr_Factors:  [99.09509094 -1.34328788 -0.91758334]
mat_Sqrt:  [[10.33161569  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01164088  0.01500349 -0.12135156]
Stock Position:  -0.011640877962213034
Bond Position:  [11.86700419]


portfolio before change:  [10.72481628]
curr_Stock_Price:  98.24614416611801
curr_Factors:  [98.24614417 -1.2758086  -0.89775726]
mat_Sqrt:  [[11.17758176  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00772309 -0.03632963  0.1803282 ]
Stock Position:  -0.007723085992296872
Bond Position:  [11.4835797]


portfolio before change:  [10.72542459]
curr_Stock_Price:  98.35325506520988
curr_Factors:  [98.35325507 -1.50005847 -0.8838021 ]
mat_Sqrt:  [[ 9.06757687  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.04885003 0.16039954 0.10031495]
Stock Position:  0.04885002807990436
Bond Position:  [5.92086532]


portfolio before change:  [10.74169704]
curr_Stock_Price:  98.67121380395619
curr_Factors:  [98.6712138  -1.55568816 -0.88229101]
mat_Sqrt:  [[ 8.61766433  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00725022 -0.06086609 -0.18642147]
Stock Position:  -0.007250215187762471
Bond Position:  [11.45708457]


portfolio before change:  [10.74290281]
curr_Stock_Price:  98.70244839665253
curr_Factors:  [98.7024484  -1.45641115 -0.88702166]
mat_Sqrt:  [[ 9.4751913   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00866552 -0.0184452  -0.17138635]
Stock Position:  -0.008665520201875393
Bond Position:  [11.59821087]


portfolio before change:  [10.7379501]
curr_Stock_Price:  99.44130437378324
curr_Factors:  [99.44130437 -1.48254868 -0.87665927]
mat_Sqrt:  [[ 9.39670991  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00378921  0.07668015  0.40674121]
Stock Position:  -0.003789213232679597
Bond Position:  [11.11475441]


portfolio before change:  [10.73918458]
curr_Stock_Price:  99.48219776714625
curr_Factors:  [99.48219777 -1.69905656 -0.87235388]
mat_Sqrt:  [[ 7.60319288  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.02200673 0.02563842 0.48360888]
Stock Position:  0.022006734868716158
Bond Position:  [8.54990623]


portfolio before change:  [10.73702278]
curr_Stock_Price:  99.33539704093677
curr_Factors:  [99.33539704 -1.50690268 -0.8697847 ]
mat_Sqrt:  [[ 9.2240536   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00778143 -0.01009914  0.19727791]
Stock Position:  0.007781425258781602
Bond Position:  [9.96405181]


portfolio before change:  [10.74602662]
curr_Stock_Price:  100.33241913186437
curr_Factors:  [100.33241913  -1.47738523  -0.89839236]
mat_Sqrt:  [[ 9.32511473  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0034173  -0.0063876  -0.05262069]
Stock Position:  -0.0034172964339145634
Bond Position:  [11.08889223]


portfolio before change:  [10.74877434]
curr_Stock_Price:  99.93399570035916
curr_Factors:  [99.9339957  -1.38044401 -0.85176451]
mat_Sqrt:  [[10.72203969  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0117102  -0.01975231  0.3123762 ]
Stock Position:  0.0117101995261056
Bond Position:  [9.57852732]


portfolio before change:  [10.75034075]
curr_Stock_Price:  99.96550787445936
curr_Factors:  [99.96550787 -1.3372567  -0.85719305]
mat_Sqrt:  [[11.13814221  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00090343 -0.02549052  0.51093323]
Stock Position:  0.0009034311383076513
Bond Position:  [10.6600288]


portfolio before change:  [10.75171356]
curr_Stock_Price:  100.01003491643445
curr_Factors:  [100.01003492  -0.98347703  -0.88336258]
mat_Sqrt:  [[15.46270392  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00485291 -0.00026146 -0.24306629]
Stock Position:  -0.004852914641667309
Bond Position:  [11.23705373]


portfolio before change:  [10.75841962]
curr_Stock_Price:  98.91763133730373
curr_Factors:  [98.91763134 -1.02691542 -0.85722447]
mat_Sqrt:  [[15.03149405  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01847777  0.03542381  0.13618862]
Stock Position:  -0.01847776731561159
Bond Position:  [12.5861966]


portfolio before change:  [10.78626125]
curr_Stock_Price:  97.49601720282652
curr_Factors:  [97.4960172  -1.17636632 -0.85376   ]
mat_Sqrt:  [[12.80307284  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00457808 -0.0605139   0.32191541]
Stock Position:  -0.004578077153340776
Bond Position:  [11.23260554]


portfolio before change:  [10.78787741]
curr_Stock_Price:  97.44971020407888
curr_Factors:  [97.4497102  -1.27392257 -0.8626682 ]
mat_Sqrt:  [[11.50458537  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01752159  0.01491803 -0.39967786]
Stock Position:  0.01752159147336718
Bond Position:  [9.0804034]


portfolio before change:  [10.77921862]
curr_Stock_Price:  96.89074787794674
curr_Factors:  [96.89074788 -1.3915413  -0.84247198]
mat_Sqrt:  [[10.3767814   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.003937   -0.03575538 -0.12917586]
Stock Position:  0.003936998374693311
Bond Position:  [10.39775991]


portfolio before change:  [10.78029754]
curr_Stock_Price:  96.8346433686805
curr_Factors:  [96.83464337 -1.31258499 -0.83929033]
mat_Sqrt:  [[11.25856866  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01322055 -0.04690758 -0.32655495]
Stock Position:  -0.013220551229437029
Bond Position:  [12.06050491]


portfolio before change:  [10.78389779]
curr_Stock_Price:  96.67636024185684
curr_Factors:  [96.67636024 -1.21484675 -0.88729301]
mat_Sqrt:  [[11.81333703  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0025402   0.01360471 -0.28626521]
Stock Position:  0.002540199017548148
Bond Position:  [10.53832059]


portfolio before change:  [10.78329285]
curr_Stock_Price:  95.9196036861089
curr_Factors:  [95.91960369 -1.13344753 -0.85889789]
mat_Sqrt:  [[13.08105447  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00705501 -0.01730703  0.18165859]
Stock Position:  0.007055013864759274
Bond Position:  [10.10657872]


portfolio before change:  [10.77172212]
curr_Stock_Price:  94.10045383166279
curr_Factors:  [94.10045383 -0.99970621 -0.82713526]
mat_Sqrt:  [[15.14274288  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00731418 0.01106537 0.03981139]
Stock Position:  0.007314181473204601
Bond Position:  [10.08345433]


portfolio before change:  [10.77402983]
curr_Stock_Price:  94.2436271629836
curr_Factors:  [94.24362716 -0.89850853 -0.81114115]
mat_Sqrt:  [[17.05142074  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01830124 -0.10531946 -0.73100075]
Stock Position:  0.018301241046377703
Bond Position:  [9.04925449]


portfolio before change:  [10.78131213]
curr_Stock_Price:  94.57972871005113
curr_Factors:  [94.57972871 -0.65109448 -0.78426713]
mat_Sqrt:  [[22.51274412  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00184569 -0.0246513   0.03888235]
Stock Position:  -0.001845694639548863
Bond Position:  [10.95587743]


portfolio before change:  [10.78250327]
curr_Stock_Price:  94.67640688666783
curr_Factors:  [94.67640689 -0.35354671 -0.75888381]
mat_Sqrt:  [[31.12571455  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00624723  0.02826802  0.04554872]
Stock Position:  -0.006247233514512183
Bond Position:  [11.37396889]


portfolio before change:  [10.801985]
curr_Stock_Price:  91.78554282922398
curr_Factors:  [91.78554283 -0.36774081 -0.74257465]
mat_Sqrt:  [[30.23920762  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01103674 0.05555114 0.23755733]
Stock Position:  0.011036737945039572
Bond Position:  [9.78897202]


portfolio before change:  [10.80791643]
curr_Stock_Price:  92.21209349937514
curr_Factors:  [92.2120935  -0.5453055  -0.75957943]
mat_Sqrt:  [[25.00826474  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00030064 -0.02135744 -0.27633585]
Stock Position:  -0.00030064014415166047
Bond Position:  [10.83563909]


portfolio before change:  [10.80918762]
curr_Stock_Price:  92.48931628290912
curr_Factors:  [92.48931628 -0.24415144 -0.7559152 ]
mat_Sqrt:  [[34.02265055  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00018542  0.01975497 -0.03300406]
Stock Position:  -0.0001854185796343254
Bond Position:  [10.82633686]


portfolio before change:  [10.81037984]
curr_Stock_Price:  93.3584891782966
curr_Factors:  [ 9.33584892e+01 -6.67617071e-02 -7.65026339e-01]
mat_Sqrt:  [[40.63617822  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00679122 -0.11916739 -0.2633439 ]
Stock Position:  0.0067912243681935444
Bond Position:  [10.17636139]


portfolio before change:  [10.80439138]
curr_Stock_Price:  92.28937599563847
curr_Factors:  [92.289376   -0.26233046 -0.75291991]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [10.80439138]
Stock Price:  93.58923092033359
PL:  [10.80439138]
Settle:  Tensor("sub_142:0", shape=(), dtype=float64)
PL:  Tensor("sub_143:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  72
output_Z_Vals[:, i, :]:  [[ 1.19260232e+02 -2.92559343e+01 -2.92733494e+01]
 [-2.22649382e-02 -4.00521948e-03 -1.54589453e-02]
 [-5.19181111e-02 -6.08190387e-02 -5.21555716e-02]
 [ 8.56957098e-02  1.76936786e-01  3.80450419e-02]
 [ 1.47041008e-01 -6.64312809e-03 -6.09838754e-02]
 [ 7.21217210e-02  2.93376720e-02 -9.55707625e-02]
 [ 7.01181717e-02  1.56592364e-02 -6.51831599e-02]
 [-1.06164782e-01 -5.25932770e-02 -1.16897977e-01]
 [-1.06613935e-02 -3.77203952e-02  1.63687154e-02]
 [-3.59285375e-02  4.05852458e-01  1.74802489e-01]
 [ 1.54377226e-02 -1.52367545e-01 -1.81653685e-02]
 [-9.06876510e-02  1.08391299e-01  3.24196058e-02]
 [-4.82598744e-02 -8.97368891e-02 -5.48215141e-02]
 [ 2.50131091e-01  2.05067991e-01  2.93210641e-01]
 [ 1.01367375e-01 -2.26244660e-02 -1.50235071e-01]
 [-7.77923232e-02 -1.03299730e-01 -1.19549856e-01]
 [-6.69416271e-02 -5.31127632e-02 -4.56328979e-02]
 [-1.00757302e-01 -4.32371525e-02  8.33716571e-02]
 [ 8.44650419e-02  4.36148268e-02  5.83438270e-02]
 [ 5.27878082e-03 -1.04049189e-02  7.37338503e-02]
 [-3.41515833e-02 -2.58721115e-02  5.55710372e-04]
 [ 6.96976389e-02 -5.35798265e-02  6.77548683e-02]
 [-7.55627510e-02  9.59687131e-02  2.90257709e-01]
 [-1.63701030e-02 -7.47899480e-03 -8.30477189e-02]
 [-1.96775571e-01  9.03662828e-02  5.87519619e-02]
 [ 3.48032469e-02 -6.63371000e-02  7.71299499e-02]
 [-4.30034540e-02  5.33908922e-02 -2.59287006e-02]
 [-4.34779164e-02  6.79006923e-02  2.72143622e-02]
 [-4.09489343e-02 -5.06019710e-02 -2.43699123e-01]
 [ 9.16667329e-03 -3.95005382e-03 -1.08640624e-01]
 [ 6.17189857e-02  2.54445653e-02  3.87344337e-02]
 [ 1.62234422e-02 -5.99216296e-02 -8.92913981e-02]
 [ 2.22131396e-01 -2.41687482e-01 -1.87590260e-01]
 [-5.23501077e-02 -8.78496191e-02 -1.46061558e-02]
 [-1.68075190e-01  1.23031777e-01  2.92397084e-02]
 [ 9.04601408e-02 -1.57036137e-01 -1.31477302e-01]
 [-2.19395064e-02 -1.29320556e-01 -5.91439838e-02]
 [-2.44850579e-02  2.18884339e-02 -6.50717278e-02]
 [ 7.84155409e-02 -1.30225248e-01 -1.70930858e-02]
 [-7.86803703e-01  3.96369793e-01  4.76023298e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.26023247 -29.25593426 -29.27334937]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  8.31486419  -9.25153874 -83.50871763]
init_Out:  [2.49911038]
Stock Position:  8.31486419409362
Bond position:  [-828.98730903]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [5.73302266]
curr_Stock_Price:  100.40139467031972
curr_Factors:  [100.40139467  -1.14995307  -1.02098269]
mat_Sqrt:  [[11.45286985  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0022286  -0.00126656 -0.04410007]
Stock Position:  -0.002228602687498899
Bond Position:  [5.95677748]


portfolio before change:  [5.73438452]
curr_Stock_Price:  100.12444521980085
curr_Factors:  [100.12444522  -1.32457721  -1.02804232]
mat_Sqrt:  [[ 9.52380386  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00673414 -0.01923267 -0.14878533]
Stock Position:  -0.006734143655595433
Bond Position:  [6.40863691]


portfolio before change:  [5.73768452]
curr_Stock_Price:  99.7533699579286
curr_Factors:  [99.75336996 -1.13572178 -1.03689286]
mat_Sqrt:  [[11.3598612   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00862952 0.05595232 0.10853191]
Stock Position:  0.008629516501879222
Bond Position:  [4.87686117]


portfolio before change:  [5.73812214]
curr_Stock_Price:  99.73343580702202
curr_Factors:  [99.73343581 -1.2862686  -1.03543793]
mat_Sqrt:  [[ 9.78445059  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01373825 -0.00210074 -0.17397002]
Stock Position:  0.013738247245949128
Bond Position:  [4.36795954]


portfolio before change:  [5.73964366]
curr_Stock_Price:  99.80444127880335
curr_Factors:  [99.80444128 -1.22207013 -1.0273291 ]
mat_Sqrt:  [[10.52563229  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00507057  0.00927739 -0.27263678]
Stock Position:  0.005070566283290252
Bond Position:  [5.23357863]


portfolio before change:  [5.74034258]
curr_Stock_Price:  99.8132517249101
curr_Factors:  [99.81325172 -0.92005589 -1.00708796]
mat_Sqrt:  [[14.5291519   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00393808  0.00495189 -0.18594941]
Stock Position:  0.003938084961706549
Bond Position:  [5.34726951]


portfolio before change:  [5.73910961]
curr_Stock_Price:  99.33042433374543
curr_Factors:  [99.33042433 -0.8977427  -0.99788253]
mat_Sqrt:  [[14.92185151  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00880483 -0.01663145 -0.33347739]
Stock Position:  -0.00880483457980912
Bond Position:  [6.61369757]


portfolio before change:  [5.73062278]
curr_Stock_Price:  100.3882066707588
curr_Factors:  [100.38820667  -0.8896209   -0.98976502]
mat_Sqrt:  [[15.32765666  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00054112 -0.01192824  0.04669539]
Stock Position:  -0.0005411185835110714
Bond Position:  [5.7849447]


portfolio before change:  [5.73070179]
curr_Stock_Price:  101.57861226307391
curr_Factors:  [101.57861226  -0.71603086  -0.9906762 ]
mat_Sqrt:  [[18.4326941   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.0005551  0.12834182 0.49866284]
Stock Position:  0.0005550971765099774
Bond Position:  [5.67431579]


portfolio before change:  [5.73248897]
curr_Stock_Price:  103.52034434829966
curr_Factors:  [103.52034435  -0.66426274  -1.01171767]
mat_Sqrt:  [[19.37120612  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00040243 -0.04818285 -0.05182074]
Stock Position:  0.0004024333423206126
Bond Position:  [5.69082893]


portfolio before change:  [5.73307557]
curr_Stock_Price:  103.21022216740995
curr_Factors:  [103.21022217  -0.5594744   -1.01130536]
mat_Sqrt:  [[21.45565262  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00378788  0.03427634  0.09248411]
Stock Position:  -0.0037878771069833816
Bond Position:  [6.1240232]


portfolio before change:  [5.73889755]
curr_Stock_Price:  101.87532428548963
curr_Factors:  [101.87532429  -0.49534357  -0.99010654]
mat_Sqrt:  [[23.06461554  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00267801 -0.0283773  -0.15639052]
Stock Position:  -0.0026780097615982917
Bond Position:  [6.01172066]


portfolio before change:  [5.73694906]
curr_Stock_Price:  102.88353576281622
curr_Factors:  [102.88353576  -0.80421929  -0.9638497 ]
mat_Sqrt:  [[17.55833273  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01795599 0.06484819 0.83644834]
Stock Position:  0.017955992763966516
Bond Position:  [3.88957304]


portfolio before change:  [5.72737217]
curr_Stock_Price:  102.32310369892464
curr_Factors:  [102.3231037   -0.4609848   -0.98614508]
mat_Sqrt:  [[24.07094723  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00291291 -0.00715448 -0.42857884]
Stock Position:  0.002912914379991559
Bond Position:  [5.42931373]


portfolio before change:  [5.72541349]
curr_Stock_Price:  101.41769213654386
curr_Factors:  [101.41769214  -0.24948324  -0.94278052]
mat_Sqrt:  [[30.78365291  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00340644 -0.03266624 -0.34104246]
Stock Position:  -0.0034064353319728717
Bond Position:  [6.0708863]


portfolio before change:  [5.73401624]
curr_Stock_Price:  99.11503831452988
curr_Factors:  [99.11503831 -0.2061064  -0.94501116]
mat_Sqrt:  [[31.34841201  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00247629 -0.01679573 -0.13017796]
Stock Position:  -0.0024762903147584605
Bond Position:  [5.97945385]


portfolio before change:  [5.73180079]
curr_Stock_Price:  100.31155803226379
curr_Factors:  [100.31155803  -0.41927111  -0.95351844]
mat_Sqrt:  [[25.41885888  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00333829 -0.01367279  0.23783613]
Stock Position:  -0.003338289602978932
Bond Position:  [6.06666982]


portfolio before change:  [5.7375371]
curr_Stock_Price:  98.8203956249575
curr_Factors:  [98.82039562 -0.30424709 -0.97003012]
mat_Sqrt:  [[27.63344474  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00352835 0.01379222 0.1664387 ]
Stock Position:  0.0035283532902238434
Bond Position:  [5.38886383]


portfolio before change:  [5.73626397]
curr_Stock_Price:  98.26864074488107
curr_Factors:  [98.26864074 -0.38798829 -0.95605029]
mat_Sqrt:  [[25.62750983  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00078279 -0.00329032  0.21034215]
Stock Position:  0.0007827910817193287
Bond Position:  [5.65934015]


portfolio before change:  [5.73752362]
curr_Stock_Price:  98.97405360630434
curr_Factors:  [98.97405361 -0.3849756  -0.97505032]
mat_Sqrt:  [[25.40209899  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00136627 -0.00818148  0.00158529]
Stock Position:  -0.0013662715212863833
Bond Position:  [5.87274905]


portfolio before change:  [5.73564678]
curr_Stock_Price:  100.8850807094353
curr_Factors:  [100.88508071  -0.6874693   -0.97190808]
mat_Sqrt:  [[19.19413329  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00427967 -0.01694343  0.19328578]
Stock Position:  0.004279673225873249
Bond Position:  [5.3038916]


portfolio before change:  [5.73775741]
curr_Stock_Price:  101.22333100107508
curr_Factors:  [101.223331    -0.73863839  -0.97465004]
mat_Sqrt:  [[18.24773286  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-7.58244482e-04  3.03479717e-02  8.28024452e-01]
Stock Position:  -0.000758244482366131
Bond Position:  [5.81450944]


portfolio before change:  [5.73894304]
curr_Stock_Price:  100.61828661188021
curr_Factors:  [100.61828661  -0.90365897  -0.96608736]
mat_Sqrt:  [[15.51159309  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00216066 -0.00236507 -0.23691203]
Stock Position:  -0.002160658436543355
Bond Position:  [5.95634479]


portfolio before change:  [5.74170026]
curr_Stock_Price:  99.6867942075495
curr_Factors:  [99.68679421 -0.95238534 -0.94504524]
mat_Sqrt:  [[14.94837547  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01220531  0.02857633  0.16760299]
Stock Position:  -0.012205314909209973
Bond Position:  [6.95840898]


portfolio before change:  [5.72457946]
curr_Stock_Price:  101.16079588448319
curr_Factors:  [101.16079588  -0.92274907  -0.95064523]
mat_Sqrt:  [[15.53844066  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00314282 -0.02097763  0.22003028]
Stock Position:  0.0031428195738904584
Bond Position:  [5.40664933]


portfolio before change:  [5.72219716]
curr_Stock_Price:  100.18772652216944
curr_Factors:  [100.18772652  -0.9496797   -0.94029076]
mat_Sqrt:  [[15.13598815  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00309974  0.01688368 -0.07396737]
Stock Position:  -0.003099736898949469
Bond Position:  [6.03275275]


portfolio before change:  [5.72367702]
curr_Stock_Price:  99.95360176067513
curr_Factors:  [99.95360176 -0.93694823 -0.95935786]
mat_Sqrt:  [[15.00524794  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00241046  0.02147208  0.077635  ]
Stock Position:  -0.0024104646422644558
Bond Position:  [5.96461165]


portfolio before change:  [5.72265973]
curr_Stock_Price:  100.68496139923204
curr_Factors:  [100.6849614   -0.86236724  -0.99056305]
mat_Sqrt:  [[15.78509532  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0058283  -0.01600175 -0.69520577]
Stock Position:  -0.0058283047947516355
Bond Position:  [6.30948237]


portfolio before change:  [5.72201202]
curr_Stock_Price:  100.93142119234912
curr_Factors:  [100.93142119  -1.26754805  -0.9692745 ]
mat_Sqrt:  [[10.77920415  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00121637 -0.00124912 -0.30992146]
Stock Position:  -0.0012163691334529548
Bond Position:  [5.84478189]


portfolio before change:  [5.72250017]
curr_Stock_Price:  101.13077859430483
curr_Factors:  [101.13077859  -1.53306377  -0.98707582]
mat_Sqrt:  [[ 8.13580694  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00863868 0.00804628 0.11049856]
Stock Position:  0.008638675333500797
Bond Position:  [4.84886421]


portfolio before change:  [5.72591555]
curr_Stock_Price:  101.4559708771587
curr_Factors:  [101.45597088  -1.54824092  -0.98250819]
mat_Sqrt:  [[ 8.07583127  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00043962 -0.01894888 -0.2547235 ]
Stock Position:  -0.0004396151644780406
Bond Position:  [5.77051713]


portfolio before change:  [5.72676938]
curr_Stock_Price:  101.15463285753079
curr_Factors:  [101.15463286  -1.22337326  -0.98307124]
mat_Sqrt:  [[11.13625347  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01594785 -0.07642829 -0.5351428 ]
Stock Position:  0.015947854552340334
Bond Position:  [4.11357001]


portfolio before change:  [5.73206378]
curr_Stock_Price:  101.45437029233737
curr_Factors:  [101.45437029  -1.12019853  -0.97034472]
mat_Sqrt:  [[12.54178532  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00459264 -0.02778049 -0.0416673 ]
Stock Position:  -0.004592635159972796
Bond Position:  [6.19800669]


portfolio before change:  [5.73568743]
curr_Stock_Price:  100.83406124173848
curr_Factors:  [100.83406124  -0.8825989   -1.00861814]
mat_Sqrt:  [[15.21465596  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01044585  0.03890606  0.08341275]
Stock Position:  -0.010445848588946833
Bond Position:  [6.78898477]


portfolio before change:  [5.74882761]
curr_Stock_Price:  99.65737312253252
curr_Factors:  [99.65737312 -0.78721353 -0.97604546]
mat_Sqrt:  [[17.08975287  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00348559 -0.04965919 -0.37506815]
Stock Position:  0.0034855854122981932
Bond Position:  [5.40146333]


portfolio before change:  [5.74605957]
curr_Stock_Price:  98.66951531637474
curr_Factors:  [98.66951532 -0.61754149 -0.95929252]
mat_Sqrt:  [[20.3879088   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00183203 -0.04089475 -0.16872132]
Stock Position:  -0.0018320301637020592
Bond Position:  [5.9268251]


portfolio before change:  [5.74755634]
curr_Stock_Price:  98.2569334763049
curr_Factors:  [98.25693348 -0.69252409 -0.96335568]
mat_Sqrt:  [[18.75960809  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00198312  0.00692173 -0.18563153]
Stock Position:  -0.0019831230795073485
Bond Position:  [5.94241193]


portfolio before change:  [5.75098508]
curr_Stock_Price:  96.90255541968075
curr_Factors:  [96.90255542 -0.66386824 -0.96636973]
mat_Sqrt:  [[18.9815588   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00377019 -0.04118084 -0.04876182]
Stock Position:  0.003770187089776873
Bond Position:  [5.38564432]


portfolio before change:  [5.74964847]
curr_Stock_Price:  96.36946277620773
curr_Factors:  [96.36946278 -0.63579007 -0.96655954]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [5.74964847]
Stock Price:  95.70226972516187
PL:  [5.74964847]
Settle:  Tensor("sub_144:0", shape=(), dtype=float64)
PL:  Tensor("sub_145:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  73
output_Z_Vals[:, i, :]:  [[ 1.19260232e+02 -2.92559343e+01 -2.92733494e+01]
 [ 5.47218446e-03 -1.12556156e-01 -3.80293710e-02]
 [-6.13552751e-02 -1.02011797e-01 -1.05629491e-01]
 [ 8.39205485e-02  1.60795192e-01  3.78293915e-02]
 [ 2.17662457e-01 -2.83478425e-02 -5.50388588e-02]
 [ 7.69560210e-02  3.00002220e-02 -6.49793581e-02]
 [ 6.11356718e-02  2.36989413e-02 -5.27914870e-02]
 [-1.34823239e-01  1.26323197e-01 -4.98564441e-02]
 [-7.75944795e-02 -3.14388043e-02  5.03493249e-02]
 [-5.33916765e-02  3.05678472e-01  1.22536445e-01]
 [ 5.76096680e-02  3.63705295e-02 -7.90807050e-02]
 [-3.85151091e-02  8.03583302e-02  2.22828922e-04]
 [-1.00546705e-01  2.34933202e-02 -5.21645010e-02]
 [-9.45602497e-02 -1.14352018e-01  6.50298984e-02]
 [ 2.09816729e-01  2.56120599e-01  2.61310690e-02]
 [-7.69328831e-02 -1.02998552e-01 -1.20251930e-01]
 [-7.74764690e-02 -2.99531966e-02 -7.48750180e-02]
 [-3.54208107e-02 -1.57495676e-02  2.62269173e-02]
 [ 2.75423167e-02  5.55646249e-02  1.18057062e-02]
 [ 1.01534714e-01 -2.98635804e-02  3.23160185e-02]
 [-1.10826545e-03 -4.23650249e-02  6.60454501e-03]
 [ 1.20716772e-01 -6.51454900e-02  1.60256982e-01]
 [-5.99787565e-02  4.00913425e-02  2.74536016e-01]
 [-9.72801775e-03 -8.11750004e-03 -8.02235788e-02]
 [-5.96311971e-02  6.12408569e-02  7.68326231e-02]
 [ 3.72075978e-02 -6.38280021e-02  7.63810983e-02]
 [-1.56094480e-01  6.63966773e-02  4.95818002e-02]
 [-5.05138066e-02  7.34135483e-02  2.92900230e-02]
 [ 4.70632776e-02 -9.65816391e-02 -1.91966076e-01]
 [ 2.13379137e-02  2.86226497e-03 -7.39392916e-02]
 [ 1.88911009e-02  1.50205032e-01  2.96917359e-02]
 [ 1.72203095e-02 -9.31871888e-02 -7.62386821e-02]
 [ 9.90975166e-02 -9.44516687e-02 -1.42264563e-02]
 [-4.84828215e-02 -8.39689618e-02 -2.67588567e-03]
 [-1.51416701e-01  1.16146881e-01  3.39300287e-02]
 [ 8.47165236e-02 -1.65012150e-01 -1.38726811e-01]
 [-1.64536843e-01 -2.53680051e-01  2.61593111e-02]
 [-4.07425572e-02 -1.90957132e-02  1.29915754e-02]
 [-4.09083457e-02  8.75250704e-02 -2.28044341e-02]
 [-1.45259100e-01  9.02060100e-02  8.41471084e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.26023247 -29.25593426 -29.27334937]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  8.31486419  -9.25153874 -83.50871763]
init_Out:  [2.49911038]
Stock Position:  8.31486419409362
Bond position:  [-828.98730903]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [1.74579498]
curr_Stock_Price:  99.92186456793148
curr_Factors:  [99.92186457 -0.84935431 -0.99545715]
mat_Sqrt:  [[15.79316206  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00032905 -0.03559338 -0.10848721]
Stock Position:  -0.0003290484713344557
Bond Position:  [1.77867412]


portfolio before change:  [1.74581486]
curr_Stock_Price:  100.5372044881122
curr_Factors:  [100.53720449  -1.07558624  -0.97754959]
mat_Sqrt:  [[12.90212492  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00663075 -0.03225896 -0.30133154]
Stock Position:  -0.00663074791106745
Bond Position:  [2.41245171]


portfolio before change:  [1.74486418]
curr_Stock_Price:  100.72605982353664
curr_Factors:  [100.72605982  -0.99251291  -0.97769981]
mat_Sqrt:  [[14.04395202  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00682103 0.0508479  0.10791672]
Stock Position:  0.0068210254929625775
Bond Position:  [1.05780916]


portfolio before change:  [1.74422613]
curr_Stock_Price:  100.61313183917403
curr_Factors:  [100.61313184  -1.10310878  -0.98736795]
mat_Sqrt:  [[12.43861888  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01653686 -0.00896437 -0.15701054]
Stock Position:  0.016536864834540903
Bond Position:  [0.08040037]


portfolio before change:  [1.73940451]
curr_Stock_Price:  100.32095639035553
curr_Factors:  [100.32095639  -1.23774302  -1.00102441]
mat_Sqrt:  [[10.69319105  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00602877  0.0094869  -0.18536802]
Stock Position:  0.00602876795143871
Bond Position:  [1.13459275]


portfolio before change:  [1.73907479]
curr_Stock_Price:  100.24273842534669
curr_Factors:  [100.24273843  -1.30421974  -0.98036516]
mat_Sqrt:  [[10.20634638  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0049941   0.00749426 -0.15059942]
Stock Position:  0.004994104333880348
Bond Position:  [1.23845209]


portfolio before change:  [1.73999393]
curr_Stock_Price:  100.39578370838129
curr_Factors:  [100.39578371  -1.00285327  -0.99466349]
mat_Sqrt:  [[13.62087378  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01040598  0.0399469  -0.14222656]
Stock Position:  -0.010405976469323107
Bond Position:  [2.78471009]


portfolio before change:  [1.73111647]
curr_Stock_Price:  101.28234795694574
curr_Factors:  [101.28234796  -1.04344586  -1.03135688]
mat_Sqrt:  [[12.71915851  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00535639 -0.00994182  0.14363261]
Stock Position:  -0.005356385248975578
Bond Position:  [2.27362375]


portfolio before change:  [1.72929942]
curr_Stock_Price:  101.67464167449705
curr_Factors:  [101.67464167  -1.20229426  -1.0714798 ]
mat_Sqrt:  [[10.46466007  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00195768  0.09666402  0.34956237]
Stock Position:  -0.001957678988799033
Bond Position:  [1.92834573]


portfolio before change:  [1.72986067]
curr_Stock_Price:  101.51108099232938
curr_Factors:  [101.51108099  -0.91259494  -1.08982682]
mat_Sqrt:  [[13.70480086  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00309428  0.01150137 -0.22559524]
Stock Position:  0.003094278435896117
Bond Position:  [1.41575713]


portfolio before change:  [1.72933222]
curr_Stock_Price:  101.28310026375335
curr_Factors:  [101.28310026  -1.24176091  -1.07643716]
mat_Sqrt:  [[ 9.97140498  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00364992  0.02541154  0.00063567]
Stock Position:  -0.003649915059069787
Bond Position:  [2.09900693]


portfolio before change:  [1.73315973]
curr_Stock_Price:  100.30633171328861
curr_Factors:  [100.30633171  -1.09635316  -1.06929457]
mat_Sqrt:  [[11.50269193  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00961411  0.00742924 -0.1488108 ]
Stock Position:  -0.009614109926482017
Bond Position:  [2.69751583]


portfolio before change:  [1.73966429]
curr_Stock_Price:  99.66484232679286
curr_Factors:  [99.66484233 -0.90670621 -1.07726768]
mat_Sqrt:  [[13.70607394  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00614608 -0.03616128  0.1855122 ]
Stock Position:  -0.006146080493419632
Bond Position:  [2.35221244]


portfolio before change:  [1.73667537]
curr_Stock_Price:  100.1989982941087
curr_Factors:  [100.19899829  -0.82236321  -1.09334685]
mat_Sqrt:  [[14.75302487  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01503175 0.08099244 0.07454467]
Stock Position:  0.0150317455602794
Bond Position:  [0.23050953]


portfolio before change:  [1.75789371]
curr_Stock_Price:  101.60864940946624
curr_Factors:  [101.60864941  -0.70525772  -1.10876201]
mat_Sqrt:  [[16.56196727  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00628782 -0.032571   -0.34304529]
Stock Position:  -0.006287816843647313
Bond Position:  [2.39679028]


portfolio before change:  [1.75668793]
curr_Stock_Price:  101.84806297027467
curr_Factors:  [101.84806297  -0.77902203  -1.1176227 ]
mat_Sqrt:  [[15.2844718   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00611952 -0.00947203 -0.21359759]
Stock Position:  -0.006119521663056872
Bond Position:  [2.37994936]


portfolio before change:  [1.75784154]
curr_Stock_Price:  101.70816761385775
curr_Factors:  [101.70816761  -0.96448145  -1.10903208]
mat_Sqrt:  [[12.78911056  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0023828  -0.00498045  0.07481809]
Stock Position:  -0.0023828018019389093
Bond Position:  [2.00019194]


portfolio before change:  [1.7598466]
curr_Stock_Price:  100.971632228797
curr_Factors:  [100.97163223  -0.47179459  -1.07089107]
mat_Sqrt:  [[21.58835297  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00145388 0.01757108 0.03367839]
Stock Position:  0.0014538774183605575
Bond Position:  [1.61304622]


portfolio before change:  [1.75786656]
curr_Stock_Price:  99.47103928796508
curr_Factors:  [99.47103929 -0.52591095 -1.08466234]
mat_Sqrt:  [[19.8716332   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00540268 -0.00944369  0.09218861]
Stock Position:  0.005402682228115678
Bond Position:  [1.22045615]


portfolio before change:  [1.75287049]
curr_Stock_Price:  98.5180618608595
curr_Factors:  [98.51806186 -0.81340427 -1.07225798]
mat_Sqrt:  [[14.94800213  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-5.71299479e-05 -1.33969972e-02  1.88409285e-02]
Stock Position:  -5.7129947935108875e-05
Bond Position:  [1.75849883]


portfolio before change:  [1.75308988]
curr_Stock_Price:  98.52582720299401
curr_Factors:  [98.5258272  -0.75995578 -1.06037491]
mat_Sqrt:  [[15.95844303  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00950889 -0.02060081  0.45716856]
Stock Position:  0.009508887662246907
Bond Position:  [0.81621885]


portfolio before change:  [1.76875449]
curr_Stock_Price:  100.16246282867668
curr_Factors:  [100.16246283  -0.68116875  -1.07995714]
mat_Sqrt:  [[17.21304637  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-1.68719284e-04  1.26779957e-02  7.83174838e-01]
Stock Position:  -0.0001687192839121058
Bond Position:  [1.78565383]


portfolio before change:  [1.76888237]
curr_Stock_Price:  100.72759617842009
curr_Factors:  [100.72759618  -0.81849698  -1.0810989 ]
mat_Sqrt:  [[15.07177701  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00174586 -0.00256698 -0.22885554]
Stock Position:  -0.001745857846049625
Bond Position:  [1.94473843]


portfolio before change:  [1.76879987]
curr_Stock_Price:  100.914096087454
curr_Factors:  [100.91409609  -0.96289859  -1.06952957]
mat_Sqrt:  [[13.22146269  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00320438  0.01936606  0.21918209]
Stock Position:  -0.003204378550001224
Bond Position:  [2.09216684]


portfolio before change:  [1.76819222]
curr_Stock_Price:  101.1853467126826
curr_Factors:  [101.18534671  -1.02839132  -1.06564479]
mat_Sqrt:  [[12.46491426  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00410358 -0.02018419  0.21789401]
Stock Position:  0.004103581557577741
Bond Position:  [1.3529699]


portfolio before change:  [1.77035534]
curr_Stock_Price:  101.67126201142767
curr_Factors:  [101.67126201  -0.8503513   -1.05487636]
mat_Sqrt:  [[15.12754166  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0095362   0.02099647  0.14144307]
Stock Position:  -0.009536201305069943
Bond Position:  [2.73991297]


portfolio before change:  [1.76730676]
curr_Stock_Price:  102.02686433019066
curr_Factors:  [102.02686433  -0.90161307  -1.04252453]
mat_Sqrt:  [[14.60112463  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00292029  0.0232154   0.08355628]
Stock Position:  -0.0029202871074764285
Bond Position:  [2.0652545]


portfolio before change:  [1.76900882]
curr_Stock_Price:  101.53243080860125
curr_Factors:  [101.53243081  -0.90367961  -1.037021  ]
mat_Sqrt:  [[14.58039254  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 3.69306880e-04 -3.05417960e-02 -5.47625781e-01]
Stock Position:  0.0003693068796155705
Bond Position:  [1.73151219]


portfolio before change:  [1.76927849]
curr_Stock_Price:  101.67652454628968
curr_Factors:  [101.67652455  -1.15206695  -1.02413994]
mat_Sqrt:  [[11.53734945  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0005477   0.00090513 -0.21092822]
Stock Position:  0.000547701389978073
Bond Position:  [1.71359011]


portfolio before change:  [1.76972309]
curr_Stock_Price:  102.09717164713327
curr_Factors:  [102.09717165  -1.22341088  -1.04289831]
mat_Sqrt:  [[10.58688356  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.0027232  0.047499   0.08470226]
Stock Position:  0.0027231978361670576
Bond Position:  [1.49169229]


portfolio before change:  [1.77216118]
curr_Stock_Price:  102.92400184245174
curr_Factors:  [102.92400184  -1.11488376  -1.04540259]
mat_Sqrt:  [[11.86632454  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-6.30295590e-05 -2.94683765e-02 -2.17487739e-01]
Stock Position:  -6.302955904769447e-05
Bond Position:  [1.77864844]


portfolio before change:  [1.7723572]
curr_Stock_Price:  103.34175554799126
curr_Factors:  [103.34175555  -0.99448279  -1.04241616]
mat_Sqrt:  [[13.47912993  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00695555 -0.02986824 -0.04058412]
Stock Position:  0.006955554421189894
Bond Position:  [1.05355799]


portfolio before change:  [1.77350354]
curr_Stock_Price:  103.48763020267344
curr_Factors:  [103.4876302   -0.9236696   -1.06072025]
mat_Sqrt:  [[14.22587144  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00359887 -0.02655332 -0.00763356]
Stock Position:  -0.003598872928171333
Bond Position:  [2.14594237]


portfolio before change:  [1.77739889]
curr_Stock_Price:  102.47979073850635
curr_Factors:  [102.47979074  -0.9034761   -1.05840962]
mat_Sqrt:  [[14.40794649  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0098204   0.03672887  0.09679293]
Stock Position:  -0.009820404520714495
Bond Position:  [2.78379189]


portfolio before change:  [1.77408638]
curr_Stock_Price:  102.85253500369573
curr_Factors:  [102.852535    -0.86160749  -1.06996497]
mat_Sqrt:  [[14.90540354  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00349796 -0.05218142 -0.39574898]
Stock Position:  0.0034979553776685
Bond Position:  [1.4143128]


portfolio before change:  [1.77284626]
curr_Stock_Price:  102.44746466612457
curr_Factors:  [102.44746467  -0.87933674  -1.11692863]
mat_Sqrt:  [[13.91663314  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01191    -0.08022068  0.07462523]
Stock Position:  -0.011909998966358783
Bond Position:  [2.99299546]


portfolio before change:  [1.77058081]
curr_Stock_Price:  102.66909356773814
curr_Factors:  [102.66909357  -0.95327988  -1.12366861]
mat_Sqrt:  [[12.86567142  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00299897 -0.00603859  0.03706135]
Stock Position:  -0.0029989660784566306
Bond Position:  [2.07848194]


portfolio before change:  [1.76880442]
curr_Stock_Price:  103.34806709924413
curr_Factors:  [103.3480671   -1.10007183  -1.12259545]
mat_Sqrt:  [[11.19464246  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00386822  0.02767786 -0.0650547 ]
Stock Position:  -0.0038682248149509305
Bond Position:  [2.16857798]


portfolio before change:  [1.77224832]
curr_Stock_Price:  102.52784417343958
curr_Factors:  [102.52784417  -1.00020014  -1.0892384 ]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [1.77224832]
Stock Price:  100.53387244198946
PL:  [1.23837587]
Settle:  Tensor("sub_146:0", shape=(), dtype=float64)
PL:  Tensor("sub_147:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  74
output_Z_Vals[:, i, :]:  [[ 1.19260232e+02 -2.92559343e+01 -2.92733494e+01]
 [ 1.11743687e-03 -8.67277413e-02 -3.12159609e-02]
 [-3.38148498e-02  2.19576454e-02  6.21127488e-02]
 [ 8.05075860e-02  1.34534208e-01  3.73789650e-02]
 [ 2.37248229e-01 -1.29254777e-02 -2.55042559e-02]
 [ 2.66997568e-02  3.18495348e-02  6.28222437e-02]
 [ 6.06185180e-03  6.75530774e-02 -2.65041049e-02]
 [ 1.37700349e-01  1.32286820e-01  1.21286896e-01]
 [ 3.11314886e-02  3.62505838e-02 -3.96157492e-02]
 [-5.54647293e-02  4.32506061e-01  1.99314166e-01]
 [ 4.91370814e-02 -3.88153580e-03 -6.67290073e-02]
 [-7.89774219e-02  1.02099244e-01  2.51929762e-02]
 [-6.86125770e-02 -6.12062906e-02 -6.57374425e-02]
 [ 3.50871474e-01  2.63705973e-01  3.49688827e-01]
 [ 1.46138482e-01  1.52372690e-01 -9.33877743e-03]
 [-5.65260637e-02 -5.67351569e-02 -1.16628319e-01]
 [-9.02361868e-02  2.96506851e-02 -1.00695614e-01]
 [ 1.04083766e-01 -2.10423082e-01 -1.57939127e-01]
 [ 2.75258824e-02  6.35323550e-02  2.74437859e-02]
 [ 2.88045444e-01 -1.97591126e-01 -5.12504239e-02]
 [ 1.13392073e-01  2.54545225e-03  1.70348875e-01]
 [ 1.81437349e-02 -1.79752056e-02  1.75364685e-02]
 [-9.67847753e-02  1.84087820e-01  2.18662506e-01]
 [ 1.84983258e-01 -5.53272833e-02  4.89796222e-02]
 [ 6.38606158e-02  3.25034786e-02  8.26490034e-02]
 [ 9.85600615e-02  5.43935964e-03  5.66763006e-02]
 [-1.23128750e-01  7.52184683e-02  8.72290606e-02]
 [-5.06841276e-02  7.35470006e-02  2.93402695e-02]
 [ 6.16035614e-02 -6.82956141e-02  4.81286296e-02]
 [ 6.65536340e-03 -2.08940949e-02 -5.55276042e-02]
 [-5.83444007e-02  3.98789634e-01  5.56968810e-03]
 [ 3.14386368e-02 -1.17859272e-01 -4.55313884e-02]
 [-6.60716506e-02  2.27031835e-02  8.38011601e-02]
 [-7.50658256e-02 -7.04215212e-02  1.15695039e-02]
 [-1.49691712e-01  1.21269662e-01  3.49488703e-02]
 [ 8.58059703e-02 -1.64551560e-01 -1.38169849e-01]
 [-2.53424391e-01 -4.47111553e-01  1.06729136e-01]
 [-7.25456021e-02 -9.59317437e-02  1.65268436e-01]
 [-1.04107215e-02  2.35680435e-02 -4.19403121e-02]
 [ 3.54143428e-01 -2.41389294e-02 -3.61320288e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.26023247 -29.25593426 -29.27334937]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  8.31486419  -9.25153874 -83.50871763]
init_Out:  [2.49911038]
Stock Position:  8.31486419409362
Bond position:  [-828.98730903]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [2.87588248]
curr_Stock_Price:  100.05777628772516
curr_Factors:  [100.05777629  -0.90060255  -0.96397695]
mat_Sqrt:  [[15.50508889  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00048331 -0.02742572 -0.08905045]
Stock Position:  -0.0004833119748087808
Bond Position:  [2.9242416]


portfolio before change:  [2.87628809]
curr_Stock_Price:  99.97488573262245
curr_Factors:  [99.97488573 -0.65833824 -0.93151292]
mat_Sqrt:  [[20.39047438  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00100876  0.00694362  0.17719038]
Stock Position:  -0.0010087648641877057
Bond Position:  [2.97713924]


portfolio before change:  [2.87603347]
curr_Stock_Price:  100.59623113293574
curr_Factors:  [100.59623113  -0.67343253  -0.9356679 ]
mat_Sqrt:  [[20.12603717  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00455187 0.04254345 0.10663178]
Stock Position:  0.004551874411262113
Bond Position:  [2.41813206]


portfolio before change:  [2.88465302]
curr_Stock_Price:  102.42345020830288
curr_Factors:  [102.42345021  -0.89004986  -0.9476878 ]
mat_Sqrt:  [[16.30347119  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01421222 -0.00408739 -0.07275654]
Stock Position:  0.014212216377258786
Bond Position:  [1.42898879]


portfolio before change:  [2.87643653]
curr_Stock_Price:  101.83275193811663
curr_Factors:  [101.83275194  -0.89963766  -0.92045327]
mat_Sqrt:  [[16.49802771  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00244548 0.01007171 0.17921437]
Stock Position:  0.002445482922088937
Bond Position:  [2.62740627]


portfolio before change:  [2.87668193]
curr_Stock_Price:  101.79879566123397
curr_Factors:  [101.79879566  -0.80314292  -0.9294991 ]
mat_Sqrt:  [[17.99972099  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00013311  0.02136216 -0.07560883]
Stock Position:  0.00013310967396765056
Bond Position:  [2.86313153]


portfolio before change:  [2.87709757]
curr_Stock_Price:  102.23242073423508
curr_Factors:  [102.23242073  -1.03235436  -0.93523669]
mat_Sqrt:  [[14.29139783  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01160653 0.04183277 0.34599776]
Stock Position:  0.011606531850607903
Bond Position:  [1.69053372]


portfolio before change:  [2.87550471]
curr_Stock_Price:  102.07697472613438
curr_Factors:  [102.07697473  -0.8449015   -0.94246558]
mat_Sqrt:  [[17.08772047  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0014034   0.01146344 -0.11301271]
Stock Position:  0.00140340215408544
Bond Position:  [2.73224966]


portfolio before change:  [2.87493949]
curr_Stock_Price:  101.43085453625646
curr_Factors:  [101.43085454  -0.82417901  -0.95069611]
mat_Sqrt:  [[17.19299802  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-2.10122584e-04  1.36770425e-01  5.68587836e-01]
Stock Position:  -0.0002101225840502249
Bond Position:  [2.89625241]


portfolio before change:  [2.8751078]
curr_Stock_Price:  102.35294305576993
curr_Factors:  [102.35294306  -0.82412013  -0.98537196]
mat_Sqrt:  [[16.75899246  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00211325 -0.00122745 -0.19035928]
Stock Position:  0.002113245118979594
Bond Position:  [2.65881094]


portfolio before change:  [2.87602438]
curr_Stock_Price:  102.62939641289172
curr_Factors:  [102.62939641  -0.96222833  -0.94732562]
mat_Sqrt:  [[15.20418095  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00468284  0.03228662  0.07186855]
Stock Position:  -0.004682839292226963
Bond Position:  [3.35662135]


portfolio before change:  [2.87544798]
curr_Stock_Price:  102.84208914917087
curr_Factors:  [102.84208915  -1.02537039  -0.93881784]
mat_Sqrt:  [[14.42562967  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00579604 -0.01935513 -0.18753063]
Stock Position:  -0.005796039254485853
Bond Position:  [3.47152477]


portfolio before change:  [2.87159865]
curr_Stock_Price:  103.5810936406639
curr_Factors:  [103.58109364  -1.06054833  -0.95665133]
mat_Sqrt:  [[13.77913044  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.03113841 0.08339115 0.99756489]
Stock Position:  0.03113841379333767
Bond Position:  [-0.35375231]


portfolio before change:  [2.8915319]
curr_Stock_Price:  104.22266355777569
curr_Factors:  [104.22266356  -1.21117229  -0.94159776]
mat_Sqrt:  [[12.10670642  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01223838  0.04818448 -0.02664093]
Stock Position:  0.012238378714732077
Bond Position:  [1.61601547]


portfolio before change:  [2.88740312]
curr_Stock_Price:  103.86879358474133
curr_Factors:  [103.86879358  -1.18457058  -0.92825134]
mat_Sqrt:  [[12.55735549  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00651392 -0.01794123 -0.33270813]
Stock Position:  -0.006513920472886794
Bond Position:  [3.56399618]


portfolio before change:  [2.88160569]
curr_Stock_Price:  104.82719534060399
curr_Factors:  [104.82719534  -1.19099443  -0.91678693]
mat_Sqrt:  [[12.73726402  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00863804  0.00937637 -0.28725656]
Stock Position:  -0.008638041521958663
Bond Position:  [3.78710736]


portfolio before change:  [2.883619]
curr_Stock_Price:  104.64892655746024
curr_Factors:  [104.64892656  -1.20402907  -0.90713328]
mat_Sqrt:  [[12.6726844   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00524052 -0.06654162 -0.45055637]
Stock Position:  0.00524052159802559
Bond Position:  [2.33520404]


portfolio before change:  [2.88146271]
curr_Stock_Price:  104.18175739546372
curr_Factors:  [104.1817574   -1.3142882   -0.89585406]
mat_Sqrt:  [[11.42718068  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00304259 0.02009069 0.07828948]
Stock Position:  0.0030425895129105062
Bond Position:  [2.56448039]


portfolio before change:  [2.88221385]
curr_Stock_Price:  104.3232687772649
curr_Factors:  [104.32326878  -1.48756329  -0.91109881]
mat_Sqrt:  [[ 9.47666379  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.02875297 -0.0624838  -0.14620319]
Stock Position:  0.028752968379390863
Bond Position:  [-0.1173898]


portfolio before change:  [2.88876085]
curr_Stock_Price:  104.55147715985295
curr_Factors:  [104.55147716  -1.32048221  -0.88953309]
mat_Sqrt:  [[11.46918931  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.0129242  0.00080494 0.48595792]
Stock Position:  0.012924201623979708
Bond Position:  [1.53751647]


portfolio before change:  [2.87902748]
curr_Stock_Price:  103.78349432268067
curr_Factors:  [103.78349432  -1.37262585  -0.89507236]
mat_Sqrt:  [[10.74680749  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00197819 -0.00568426  0.05002666]
Stock Position:  0.00197819061707587
Bond Position:  [2.67372395]


portfolio before change:  [2.87945954]
curr_Stock_Price:  103.83294303357356
curr_Factors:  [103.83294303  -1.16804682  -0.88392189]
mat_Sqrt:  [[13.34063421  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00355286  0.05821368  0.62378327]
Stock Position:  -0.0035528559097300666
Bond Position:  [3.24836302]


portfolio before change:  [2.87723195]
curr_Stock_Price:  104.57422347811614
curr_Factors:  [104.57422348  -1.2303233   -0.88555744]
mat_Sqrt:  [[12.60402688  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01535641 -0.01749602  0.13972523]
Stock Position:  0.015356412591766965
Bond Position:  [1.27134702]


portfolio before change:  [2.86324229]
curr_Stock_Price:  103.65287650830871
curr_Factors:  [103.65287651  -1.12989989  -0.89611771]
mat_Sqrt:  [[13.66762628  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00596815 0.0102785  0.2357746 ]
Stock Position:  0.005968154789653447
Bond Position:  [2.24462588]


portfolio before change:  [2.8629808]
curr_Stock_Price:  103.56204732223652
curr_Factors:  [103.56204732  -1.00800276  -0.90537627]
mat_Sqrt:  [[15.28377642  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00721481 0.00172008 0.16168171]
Stock Position:  0.007214807618901934
Bond Position:  [2.11580055]


portfolio before change:  [2.87384206]
curr_Stock_Price:  105.03079928703576
curr_Factors:  [105.03079929  -1.26353359  -0.95081796]
mat_Sqrt:  [[11.47191736  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00901166  0.02378617  0.24884023]
Stock Position:  -0.009011663623730426
Bond Position:  [3.82034429]


portfolio before change:  [2.87279036]
curr_Stock_Price:  105.20049806433312
curr_Factors:  [105.20049806  -1.10977002  -0.94147775]
mat_Sqrt:  [[13.52608807  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00316397  0.0232576   0.08369962]
Stock Position:  -0.0031639668898904866
Bond Position:  [3.20564125]


portfolio before change:  [2.87338283]
curr_Stock_Price:  105.13989611383917
curr_Factors:  [105.13989611  -0.96281144  -0.9461934 ]
mat_Sqrt:  [[15.58465789  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00447006 -0.02159697  0.13729758]
Stock Position:  0.004470062298061398
Bond Position:  [2.40340095]


portfolio before change:  [2.86975961]
curr_Stock_Price:  104.26213019205439
curr_Factors:  [104.26213019  -0.68271774  -0.9601567 ]
mat_Sqrt:  [[20.16672103  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00025878 -0.00660729 -0.1584048 ]
Stock Position:  -0.000258775065943888
Bond Position:  [2.89674005]


portfolio before change:  [2.8700569]
curr_Stock_Price:  104.5126224556324
curr_Factors:  [104.51262246  -0.78889431  -0.93942507]
mat_Sqrt:  [[18.55962408  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00252757  0.12610835  0.01588877]
Stock Position:  -0.0025275721411870317
Bond Position:  [3.1342201]


portfolio before change:  [2.87041913]
curr_Stock_Price:  104.52432184764083
curr_Factors:  [104.52432185  -0.72228918  -0.93207782]
mat_Sqrt:  [[19.9864149   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00095572 -0.03727037 -0.12988838]
Stock Position:  0.0009557225687198486
Bond Position:  [2.77052288]


portfolio before change:  [2.87051962]
curr_Stock_Price:  104.267082941265
curr_Factors:  [104.26708294  -0.41389653  -0.91757032]
mat_Sqrt:  [[27.53585193  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00175697  0.00717938  0.23906138]
Stock Position:  -0.0017569682206058457
Bond Position:  [3.05371357]


portfolio before change:  [2.86960711]
curr_Stock_Price:  105.00372360871398
curr_Factors:  [105.00372361  -0.43806641  -0.92469623]
mat_Sqrt:  [[26.87598587  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00277283 -0.02226924  0.03300457]
Stock Position:  -0.002772828007692871
Bond Position:  [3.16076437]


portfolio before change:  [2.86543461]
curr_Stock_Price:  106.65100082120037
curr_Factors:  [106.65100082  -0.31351265  -0.93095394]
mat_Sqrt:  [[30.72557105  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0045378   0.03834883  0.0996994 ]
Stock Position:  -0.004537804504089464
Bond Position:  [3.349396]


portfolio before change:  [2.86108777]
curr_Stock_Price:  107.70118660482741
curr_Factors:  [107.7011866   -0.51293971  -0.95282739]
mat_Sqrt:  [[24.86829021  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00214544 -0.05203577 -0.39416012]
Stock Position:  0.0021454416290008936
Bond Position:  [2.63002116]


portfolio before change:  [2.86234957]
curr_Stock_Price:  108.13607369637091
curr_Factors:  [108.1360737   -0.45961346  -0.95248092]
mat_Sqrt:  [[26.34546077  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00923054 -0.14138909  0.30446852]
Stock Position:  -0.00923053767871703
Bond Position:  [3.86050367]


portfolio before change:  [2.84064869]
curr_Stock_Price:  110.539343490185
curr_Factors:  [110.53934349  -0.50599449  -0.97314246]
mat_Sqrt:  [[25.18464688  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00163938 -0.03033628  0.47146485]
Stock Position:  -0.0016393825587109102
Bond Position:  [3.02186496]


portfolio before change:  [2.84027989]
curr_Stock_Price:  110.99473270775349
curr_Factors:  [110.99473271  -0.45302925  -0.93446824]
mat_Sqrt:  [[27.71531803  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00066257  0.00745287 -0.11964404]
Stock Position:  -0.000662566006849123
Bond Position:  [2.91382123]


portfolio before change:  [2.83949607]
curr_Stock_Price:  112.72750268641325
curr_Factors:  [112.72750269  -0.48046499  -0.92958369]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [2.83949607]
Stock Price:  112.44628058941267
PL:  [-9.60678452]
Settle:  Tensor("sub_148:0", shape=(), dtype=float64)
PL:  Tensor("sub_149:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  75
output_Z_Vals[:, i, :]:  [[ 1.19260232e+02 -2.92559343e+01 -2.92733494e+01]
 [-9.40922376e-03 -4.64028314e-02 -2.38474062e-02]
 [-5.91609546e-02 -2.72075352e-03  9.66866867e-02]
 [-2.62913777e-02  1.19249735e-01  1.72332456e-02]
 [ 5.96850456e-02  2.32697402e-02 -6.95422400e-02]
 [ 6.78484783e-02  2.96981206e-02  1.30842057e-02]
 [ 8.29025072e-03  5.67921589e-02  6.23931698e-03]
 [-1.25027496e-01  2.33687949e-01  2.51149208e-03]
 [ 1.89001341e-02  3.49559059e-02 -3.13382251e-02]
 [-8.36162797e-02  3.88893362e-01  1.85570541e-01]
 [ 5.90345121e-02  1.03428654e-01 -8.40891795e-02]
 [-4.26420864e-02  4.10458415e-02  1.67867262e-03]
 [-1.14314754e-01  4.88322025e-02 -3.32893572e-02]
 [-1.00780585e-01 -1.07026470e-01  6.50585941e-02]
 [ 1.71407746e-01  1.45611829e-01 -4.97245687e-02]
 [-8.67192541e-02 -1.49595733e-01 -1.05206224e-01]
 [-7.13597745e-02 -5.53248856e-02 -5.10408897e-02]
 [-7.26400339e-02  1.97390812e-02  7.13053174e-02]
 [ 1.93796931e-02  6.47267643e-02  1.64528577e-02]
 [ 2.87414250e-01 -6.88345631e-02 -4.19292144e-02]
 [-5.08421271e-02  6.37072780e-03 -3.78204597e-02]
 [ 4.21594361e-02 -3.45611452e-02  4.09300428e-02]
 [-3.77469647e-02 -2.24787567e-02  1.02285517e-01]
 [ 2.77501875e-03 -8.36236364e-02 -1.65551806e-02]
 [ 2.55240215e-02  4.71845918e-02  8.15649065e-02]
 [ 5.15475880e-02 -4.73358079e-02  7.17410978e-02]
 [-1.80760877e-01  7.28442598e-02  7.03118686e-02]
 [-3.35371471e-02  6.01783425e-02  2.44819676e-02]
 [-6.19666903e-02 -5.59417321e-02 -2.26217320e-01]
 [ 2.37475790e-02  4.62682845e-03 -6.62941632e-02]
 [ 2.61855357e-02  1.28857174e-01  3.02839104e-02]
 [ 1.60673919e-02 -7.11675172e-02 -8.55450562e-02]
 [ 1.61974927e-01 -1.81728327e-01 -1.21961053e-01]
 [-4.89861715e-02 -8.52021890e-02 -9.29269244e-03]
 [-1.37879156e-01  8.60373082e-02  3.55019425e-02]
 [ 8.47165236e-02 -1.65012150e-01 -1.38726811e-01]
 [-1.49933508e-01 -2.64461698e-01  2.94808709e-02]
 [-2.99619037e-02 -9.04892510e-04 -3.76126872e-02]
 [-4.70709193e-02  9.60334716e-02 -6.17368683e-03]
 [-3.87556897e-01  2.04424148e-01  2.34136444e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.26023247 -29.25593426 -29.27334937]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  8.31486419  -9.25153874 -83.50871763]
init_Out:  [2.49911038]
Stock Position:  8.31486419409362
Bond position:  [-828.98730903]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [5.41949851]
curr_Stock_Price:  100.36368820295287
curr_Factors:  [100.3636882   -0.80370991  -0.99129736]
mat_Sqrt:  [[16.67304257  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00092816 -0.01467386 -0.06803001]
Stock Position:  -0.0009281551972858722
Bond Position:  [5.51265159]


portfolio before change:  [5.42151013]
curr_Stock_Price:  98.938818260749
curr_Factors:  [98.93881826 -0.795291   -0.9793402 ]
mat_Sqrt:  [[16.77467756  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00235445 -0.00086038  0.2758202 ]
Stock Position:  -0.0023544486492731846
Bond Position:  [5.6544565]


portfolio before change:  [5.4209313]
curr_Stock_Price:  99.48488443168961
curr_Factors:  [99.48488443 -0.7535795  -0.98513081]
mat_Sqrt:  [[17.48416136  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00112643  0.03771008  0.04916165]
Stock Position:  -0.0011264275608634687
Bond Position:  [5.53299381]


portfolio before change:  [5.42190238]
curr_Stock_Price:  99.2368340852222
curr_Factors:  [99.23683409 -0.61884287 -0.98576827]
mat_Sqrt:  [[19.94339706  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00231107  0.00735854 -0.19838465]
Stock Position:  0.0023110715414305476
Bond Position:  [5.19255895]


portfolio before change:  [5.42414924]
curr_Stock_Price:  99.92818336456213
curr_Factors:  [99.92818336 -0.66490292 -1.00952332]
mat_Sqrt:  [[18.7281083   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00380637 0.00939137 0.0373256 ]
Stock Position:  0.0038063685655840692
Bond Position:  [5.04378575]


portfolio before change:  [5.42407003]
curr_Stock_Price:  99.74172475992277
curr_Factors:  [99.74172476 -0.3934311  -1.01353595]
mat_Sqrt:  [[24.42524027  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00045159 0.01795926 0.01779903]
Stock Position:  0.00045159077566848255
Bond Position:  [5.37902758]


portfolio before change:  [5.42516124]
curr_Stock_Price:  100.66908896775077
curr_Factors:  [100.66908897  -0.41797636  -0.99301892]
mat_Sqrt:  [[24.55323234  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00482548  0.07389862  0.00716459]
Stock Position:  -0.004825476371233723
Bond Position:  [5.91093755]


portfolio before change:  [5.41963024]
curr_Stock_Price:  101.96842478746402
curr_Factors:  [101.96842479  -0.39893421  -0.98076263]
mat_Sqrt:  [[25.66084688  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00052242  0.01105403 -0.08939923]
Stock Position:  0.0005224224797898638
Bond Position:  [5.36635964]


portfolio before change:  [5.41925673]
curr_Stock_Price:  99.96938708282386
curr_Factors:  [99.96938708 -0.33943166 -0.98013821]
mat_Sqrt:  [[26.71684155  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00133607  0.12297888  0.5293811 ]
Stock Position:  -0.0013360736558097914
Bond Position:  [5.55282319]


portfolio before change:  [5.41930974]
curr_Stock_Price:  100.44925113768146
curr_Factors:  [100.44925114  -0.43780112  -0.98209704]
mat_Sqrt:  [[24.28246456  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00183426  0.03270701 -0.23988302]
Stock Position:  0.001834261776506848
Bond Position:  [5.23505952]


portfolio before change:  [5.42102013]
curr_Stock_Price:  101.0249384420797
curr_Factors:  [101.02493844  -0.72320167  -0.96964749]
mat_Sqrt:  [[18.58803766  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00221861  0.01297983  0.00478879]
Stock Position:  -0.0022186112609952897
Bond Position:  [5.64515519]


portfolio before change:  [5.42523821]
curr_Stock_Price:  99.44179008598333
curr_Factors:  [99.44179009 -0.89288412 -0.94889839]
mat_Sqrt:  [[15.76496304  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00760224  0.0154421  -0.09496527]
Stock Position:  -0.007602242599118582
Bond Position:  [6.18121882]


portfolio before change:  [5.42312779]
curr_Stock_Price:  99.82103577888303
curr_Factors:  [99.82103578 -0.95638666 -0.94819057]
mat_Sqrt:  [[14.86191218  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00607351 -0.03384474  0.18559406]
Stock Position:  -0.00607350962038014
Bond Position:  [6.02939181]


portfolio before change:  [5.42078609]
curr_Stock_Price:  100.33069587743636
curr_Factors:  [100.33069588  -0.6613983   -0.91898945]
mat_Sqrt:  [[20.65761334  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00798821  0.0460465  -0.14185035]
Stock Position:  0.007988214296950957
Bond Position:  [4.61932299]


portfolio before change:  [5.4164242]
curr_Stock_Price:  99.71236737826342
curr_Factors:  [99.71236738 -0.62562197 -0.91996983]
mat_Sqrt:  [[21.25724796  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00527147 -0.04730632 -0.30012407]
Stock Position:  -0.0052714692922475785
Bond Position:  [5.94205488]


portfolio before change:  [5.41297105]
curr_Stock_Price:  100.50833985291203
curr_Factors:  [100.50833985  -0.76241497  -0.95370074]
mat_Sqrt:  [[18.06768518  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00460529 -0.01749526 -0.14560545]
Stock Position:  -0.004605290275893813
Bond Position:  [5.87584113]


portfolio before change:  [5.41130772]
curr_Stock_Price:  101.02901433321085
curr_Factors:  [101.02901433  -0.98142641  -0.94604725]
mat_Sqrt:  [[14.70127288  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00391634  0.00624205  0.20341422]
Stock Position:  -0.003916343604716276
Bond Position:  [5.80697206]


portfolio before change:  [5.41014738]
curr_Stock_Price:  101.510653183393
curr_Factors:  [101.51065318  -0.77807205  -0.93507926]
mat_Sqrt:  [[18.30203854  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.0013337  0.0204684  0.04693542]
Stock Position:  0.0013336960503945506
Bond Position:  [5.27476302]


portfolio before change:  [5.4108193]
curr_Stock_Price:  101.52005523938698
curr_Factors:  [101.52005524  -0.93079848  -0.9104168 ]
mat_Sqrt:  [[16.10357178  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01720601 -0.0217674  -0.11961238]
Stock Position:  0.017206007947408467
Bond Position:  [3.66406443]


portfolio before change:  [5.41732946]
curr_Stock_Price:  101.87179957077936
curr_Factors:  [101.87179957  -1.28854802  -0.91047415]
mat_Sqrt:  [[11.29876     0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00516851  0.0020146  -0.10789124]
Stock Position:  -0.005168505624140932
Bond Position:  [5.94385442]


portfolio before change:  [5.41388666]
curr_Stock_Price:  102.68167000080875
curr_Factors:  [102.68167     -1.40946675  -0.90634907]
mat_Sqrt:  [[10.13320647  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00489696 -0.01092919  0.11676202]
Stock Position:  0.004896957476612156
Bond Position:  [4.91105889]


portfolio before change:  [5.41188937]
curr_Stock_Price:  102.14843824812165
curr_Factors:  [102.14843825  -1.6898341   -0.89394514]
mat_Sqrt:  [[ 7.71099937  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0022628  -0.00710841  0.29179211]
Stock Position:  -0.0022627961798152843
Bond Position:  [5.64303047]


portfolio before change:  [5.41272364]
curr_Stock_Price:  102.09149625597395
curr_Factors:  [102.09149626  -1.77797467  -0.90654747]
mat_Sqrt:  [[ 6.96813277  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00039658 -0.02644412 -0.04722732]
Stock Position:  -0.0003965834813869857
Bond Position:  [5.45321144]


portfolio before change:  [5.41338309]
curr_Stock_Price:  102.14758305227922
curr_Factors:  [102.14758305  -1.74901894  -0.90747573]
mat_Sqrt:  [[ 7.17013145  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00605173 0.01492108 0.23268198]
Stock Position:  0.00605172855381512
Bond Position:  [4.79521365]


portfolio before change:  [5.41279798]
curr_Stock_Price:  101.95184431062295
curr_Factors:  [101.95184431  -1.20302337  -0.89961733]
mat_Sqrt:  [[12.45173396  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0052177  -0.0149689   0.20465738]
Stock Position:  0.0052177048752788235
Bond Position:  [4.88084334]


portfolio before change:  [5.4143904]
curr_Stock_Price:  102.14010378179577
curr_Factors:  [102.14010378  -1.30595757  -0.88587115]
mat_Sqrt:  [[11.41030306  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01441922  0.02303538  0.20058019]
Stock Position:  -0.014419222270530918
Bond Position:  [6.88717126]


portfolio before change:  [5.41918345]
curr_Stock_Price:  101.86740564599808
curr_Factors:  [101.86740565  -1.13868753  -0.88377439]
mat_Sqrt:  [[13.48004031  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00200192  0.01903006  0.06984024]
Stock Position:  -0.002001921927823958
Bond Position:  [5.62311404]


portfolio before change:  [5.42083993]
curr_Stock_Price:  101.39108988847882
curr_Factors:  [101.39108989  -1.14011039  -0.89212463]
mat_Sqrt:  [[13.28652274  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00824802 -0.01769033 -0.64533505]
Stock Position:  -0.008248020861249298
Bond Position:  [6.25711575]


portfolio before change:  [5.41630752]
curr_Stock_Price:  102.0354371801257
curr_Factors:  [102.03543718  -1.28075256  -0.87116295]
mat_Sqrt:  [[11.86276687  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0008712   0.00146313 -0.18911879]
Stock Position:  0.0008711967352120388
Bond Position:  [5.32741459]


portfolio before change:  [5.41686803]
curr_Stock_Price:  101.91438412849224
curr_Factors:  [101.91438413  -1.21780786  -0.88697019]
mat_Sqrt:  [[12.42058334  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.0028738  0.04074822 0.08639157]
Stock Position:  0.0028738014927720936
Bond Position:  [5.12398632]


portfolio before change:  [5.41824649]
curr_Stock_Price:  102.17116032693126
curr_Factors:  [102.17116033  -1.31114531  -0.884206  ]
mat_Sqrt:  [[11.37363705  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00028416 -0.02250514 -0.24403623]
Stock Position:  -0.00028416213364615585
Bond Position:  [5.44727967]


portfolio before change:  [5.41885889]
curr_Stock_Price:  102.41241455941744
curr_Factors:  [102.41241456  -1.24995022  -0.86335106]
mat_Sqrt:  [[12.37535095  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01069768 -0.05746754 -0.34792094]
Stock Position:  0.010697678545433657
Bond Position:  [4.3232838]


portfolio before change:  [5.41318474]
curr_Stock_Price:  101.83148560533931
curr_Factors:  [101.83148561  -1.41184902  -0.8487491 ]
mat_Sqrt:  [[10.61981097  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00499848 -0.0269433  -0.02650946]
Stock Position:  -0.004998483077456232
Bond Position:  [5.9221877]


portfolio before change:  [5.41305019]
curr_Stock_Price:  102.0065140266719
curr_Factors:  [102.00651403  -1.28382909  -0.85233043]
mat_Sqrt:  [[12.04774068  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0106585   0.02720739  0.10127716]
Stock Position:  -0.010658502839014676
Bond Position:  [6.50028691]


portfolio before change:  [5.42246866]
curr_Stock_Price:  101.19909440293134
curr_Factors:  [101.1990944   -1.14631038  -0.85419053]
mat_Sqrt:  [[13.6889495   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0038088  -0.05218142 -0.39574898]
Stock Position:  0.0038087974880703407
Bond Position:  [5.0370218]


portfolio before change:  [5.42533403]
curr_Stock_Price:  101.7860774562388
curr_Factors:  [101.78607746  -1.1828665   -0.86246415]
mat_Sqrt:  [[13.16474839  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01145059 -0.08363013  0.08410072]
Stock Position:  -0.011450588899460159
Bond Position:  [6.59084455]


portfolio before change:  [5.43255803]
curr_Stock_Price:  101.22714610249831
curr_Factors:  [101.2271461   -1.13584233  -0.86659821]
mat_Sqrt:  [[13.66621082  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00275592 -0.00028615 -0.10729853]
Stock Position:  -0.002755915746810695
Bond Position:  [5.71153151]


portfolio before change:  [5.43350861]
curr_Stock_Price:  101.14129513914249
curr_Factors:  [101.14129514  -1.02394689  -0.90087858]
mat_Sqrt:  [[14.75663822  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00310718  0.03036845 -0.01761181]
Stock Position:  -0.0031071808886322964
Bond Position:  [5.74777291]


portfolio before change:  [5.4335811]
curr_Stock_Price:  101.3492093660573
curr_Factors:  [101.34920937  -0.93401745  -0.91510826]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [5.4335811]
Stock Price:  101.15771110646747
PL:  [4.27586999]
Settle:  Tensor("sub_150:0", shape=(), dtype=float64)
PL:  Tensor("sub_151:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  76
output_Z_Vals[:, i, :]:  [[ 1.19260232e+02 -2.92559343e+01 -2.92733494e+01]
 [-8.45616383e-03 -4.94092029e-02 -2.40152040e-02]
 [-4.18388384e-02 -1.47318305e-02  1.14650956e-02]
 [ 4.04358603e-03  1.35764101e-01  2.28640630e-02]
 [ 4.87901870e-02  2.68623256e-02 -7.00697463e-02]
 [ 4.90151769e-02  2.88126395e-02  4.30801830e-02]
 [ 6.71233565e-02  4.26016795e-02 -1.14613095e-02]
 [-1.16518053e-02 -2.23973607e-02 -3.37601922e-02]
 [ 9.31002835e-02 -4.44576234e-02 -1.54605506e-01]
 [-1.64294577e-01 -1.81769621e-01 -6.81183313e-02]
 [ 1.62572079e-01  9.24645996e-02  1.38352002e-01]
 [-2.40185752e-01 -1.12479310e-01  6.68925524e-02]
 [-6.24874532e-02 -6.20718629e-02  1.06059673e-02]
 [-9.62623594e-02 -1.14884369e-01  6.32126881e-02]
 [ 1.19788129e-01  4.00919120e-01  3.07691021e-01]
 [ 1.65516998e-02 -5.45480006e-01  1.28150808e-02]
 [-6.56975434e-02 -6.09380699e-02 -2.16332032e-02]
 [-5.41039695e-03  1.13030365e-01 -2.46891231e-02]
 [-6.31058367e-02  4.97615290e-02 -1.24296289e-01]
 [-6.09514897e-02 -2.52688673e-02  1.38538494e-01]
 [ 9.93038901e-02 -1.06229222e-01  5.60060095e-02]
 [ 1.19053330e-01  1.16720949e-01  3.03984919e-01]
 [-6.28286995e-03 -1.43303299e-01  1.40529181e-01]
 [-5.33136740e-02 -2.57106847e-03 -8.64886226e-02]
 [-6.14579018e-01  1.73441449e-01  6.15623019e-02]
 [-1.36516813e-01 -2.59056725e-01  1.32073621e-01]
 [ 3.18002084e-02  6.88140092e-02 -1.12357420e-02]
 [ 1.08362520e-03 -3.11686148e-02 -2.58158734e-02]
 [-1.33865449e-01 -1.97918458e-01 -6.49657641e-02]
 [ 1.89973216e-01  2.65644915e-01  1.85215567e-01]
 [ 9.69996103e-02 -1.27498451e-01  8.83851208e-02]
 [ 8.93640487e-02 -2.73248962e-02 -2.40791038e-02]
 [ 3.53314170e-01 -2.79726691e-01 -1.78188168e-01]
 [-4.30292546e-02 -7.86456360e-02  1.16817140e-02]
 [-1.58833094e-01 -2.05010975e-02  1.90775118e-02]
 [ 1.20679486e-01 -7.82509307e-02 -4.48348708e-02]
 [ 2.72138885e-02  3.99636814e-02 -9.68276548e-02]
 [-1.57607130e-02  2.41817823e-02 -7.07790066e-02]
 [ 6.53892476e-02 -1.25657863e-01 -1.11992304e-02]
 [-8.74563142e-01  4.33753518e-01  5.35949203e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.26023247 -29.25593426 -29.27334937]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  8.31486419  -9.25153874 -83.50871763]
init_Out:  [2.49911038]
Stock Position:  8.31486419409362
Bond position:  [-828.98730903]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [4.99485144]
curr_Stock_Price:  100.31261736671931
curr_Factors:  [100.31261737  -1.01991123  -0.99876994]
mat_Sqrt:  [[13.32457815  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00109827 -0.01562456 -0.06850869]
Stock Position:  -0.0010982701881364358
Bond Position:  [5.1050218]


portfolio before change:  [4.99584088]
curr_Stock_Price:  99.9927715477425
curr_Factors:  [99.99277155 -0.92098334 -1.00014623]
mat_Sqrt:  [[14.64308682  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0027234  -0.00465861  0.03270673]
Stock Position:  -0.0027233950264086483
Bond Position:  [5.2681607]


portfolio before change:  [4.99817231]
curr_Stock_Price:  99.37851549520008
curr_Factors:  [99.3785155  -0.90500803 -1.02277612]
mat_Sqrt:  [[14.45661065  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00084502 0.04293238 0.06522481]
Stock Position:  0.0008450187724037232
Bond Position:  [4.9141956]


portfolio before change:  [4.99855324]
curr_Stock_Price:  99.10232971678222
curr_Factors:  [99.10232972 -0.75794238 -1.01340471]
mat_Sqrt:  [[16.85767196  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00208693  0.00849461 -0.19988948]
Stock Position:  0.002086933610209345
Bond Position:  [4.79173325]


portfolio before change:  [4.99593453]
curr_Stock_Price:  97.56049019175434
curr_Factors:  [97.56049019 -0.86823905 -1.03025485]
mat_Sqrt:  [[14.61398124  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00400663 0.00911136 0.12289577]
Stock Position:  0.004006630403784481
Bond Position:  [4.6050457]


portfolio before change:  [4.99455724]
curr_Stock_Price:  97.07306131794839
curr_Factors:  [97.07306132 -1.00197724 -1.00798389]
mat_Sqrt:  [[13.00719632  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00506518  0.01347183 -0.03269593]
Stock Position:  0.005065180497114421
Bond Position:  [4.50286467]


portfolio before change:  [4.99303096]
curr_Stock_Price:  96.66060354228745
curr_Factors:  [96.66060354 -1.00252494 -1.01518427]
mat_Sqrt:  [[12.8519648   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00148782 -0.00708267 -0.09630843]
Stock Position:  -0.001487817098828334
Bond Position:  [5.13684426]


portfolio before change:  [4.99476496]
curr_Stock_Price:  95.92674348937145
curr_Factors:  [95.92674349 -0.96444499 -1.00606893]
mat_Sqrt:  [[13.3707688   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00451684 -0.01405873 -0.44104647]
Stock Position:  0.004516843931910485
Bond Position:  [4.56147883]


portfolio before change:  [4.99345917]
curr_Stock_Price:  95.51140792737476
curr_Factors:  [95.51140793 -0.96497094 -0.96893759]
mat_Sqrt:  [[13.80922929  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01324422 -0.0574806  -0.19432264]
Stock Position:  -0.013244218127906602
Bond Position:  [6.25843309]


portfolio before change:  [4.99243937]
curr_Stock_Price:  95.64747913906952
curr_Factors:  [95.64747914 -1.23635388 -0.93959491]
mat_Sqrt:  [[10.8560285   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01779661 0.02923987 0.39467975]
Stock Position:  0.01779660850150465
Bond Position:  [3.29023863]


portfolio before change:  [4.99838715]
curr_Stock_Price:  95.95857640227256
curr_Factors:  [95.9585764  -1.24458086 -0.95133259]
mat_Sqrt:  [[10.67605259  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02149067 -0.03556908  0.19082583]
Stock Position:  -0.02149067441355116
Bond Position:  [7.06060167]


portfolio before change:  [4.99720242]
curr_Stock_Price:  96.05477455806887
curr_Factors:  [96.05477456 -1.24007779 -0.96136033]
mat_Sqrt:  [[10.62787727  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00582668 -0.01962885  0.03025587]
Stock Position:  -0.005826676978277486
Bond Position:  [5.55688256]


portfolio before change:  [5.00305799]
curr_Stock_Price:  95.16903597405839
curr_Factors:  [95.16903597 -1.34599671 -0.960283  ]
mat_Sqrt:  [[ 9.48180718  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00910432 -0.03632963  0.1803282 ]
Stock Position:  -0.009104321941850468
Bond Position:  [5.86950753]


portfolio before change:  [5.00615958]
curr_Stock_Price:  94.90895477572583
curr_Factors:  [94.90895478 -1.41147009 -0.95344357]
mat_Sqrt:  [[ 8.91739979  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.02163713 0.12678176 0.87775684]
Stock Position:  0.02163713492582266
Bond Position:  [2.95260172]


portfolio before change:  [5.00462794]
curr_Stock_Price:  94.8211086634104
curr_Factors:  [94.82110866 -1.29360942 -0.97245294]
mat_Sqrt:  [[ 9.83482531  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00051687 -0.17249592  0.03655786]
Stock Position:  0.0005168708048984142
Bond Position:  [4.95561768]


portfolio before change:  [5.00567719]
curr_Stock_Price:  95.65256034736522
curr_Factors:  [95.65256035 -1.0929032  -0.97552882]
mat_Sqrt:  [[12.0889334   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00592995 -0.01927031 -0.06171351]
Stock Position:  -0.005929953810110511
Bond Position:  [5.57289245]


portfolio before change:  [5.00282136]
curr_Stock_Price:  96.2516346613901
curr_Factors:  [96.25163466 -1.06316796 -0.96695027]
mat_Sqrt:  [[12.63976417  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00059587  0.03574334 -0.0704312 ]
Stock Position:  -0.0005958664681455545
Bond Position:  [5.06017448]


portfolio before change:  [5.00363515]
curr_Stock_Price:  95.9474882518469
curr_Factors:  [95.94748825 -1.06928969 -0.96000794]
mat_Sqrt:  [[12.61016725  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00691449  0.01573598 -0.35458272]
Stock Position:  -0.006914489847622841
Bond Position:  [5.66706308]


portfolio before change:  [5.00101963]
curr_Stock_Price:  96.42821028526663
curr_Factors:  [96.42821029 -1.24149715 -0.9838457 ]
mat_Sqrt:  [[10.41717562  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00319903 -0.00799072  0.39521176]
Stock Position:  -0.0031990319320996516
Bond Position:  [5.30949655]


portfolio before change:  [5.00081377]
curr_Stock_Price:  96.70003915395803
curr_Factors:  [96.70003915 -1.24280329 -0.99864636]
mat_Sqrt:  [[10.2796289   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01050556 -0.03359263  0.15976956]
Stock Position:  0.01050555844304477
Bond Position:  [3.98492586]


portfolio before change:  [4.99591353]
curr_Stock_Price:  96.18617947415048
curr_Factors:  [96.18617947 -1.30858236 -1.00518591]
mat_Sqrt:  [[ 9.5116505   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01935707 0.0369104  0.86718436]
Stock Position:  0.019357073046083795
Bond Position:  [3.13403063]


portfolio before change:  [4.9991531]
curr_Stock_Price:  96.33329796092622
curr_Factors:  [96.33329796 -1.27922625 -1.02303259]
mat_Sqrt:  [[ 9.63647314  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0019408  -0.04531648  0.40089064]
Stock Position:  0.0019407986094313657
Bond Position:  [4.81218956]


portfolio before change:  [4.99874612]
curr_Stock_Price:  95.81364887995295
curr_Factors:  [95.81364888 -1.07841406 -0.98427809]
mat_Sqrt:  [[12.17899812  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00583254 -0.00081304 -0.24672797]
Stock Position:  -0.005832538449808809
Bond Position:  [5.55758291]


portfolio before change:  [5.00248133]
curr_Stock_Price:  95.29235519615301
curr_Factors:  [95.2923552  -0.85507498 -1.00929577]
mat_Sqrt:  [[14.76971561  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.04045673  0.054847    0.17562011]
Stock Position:  -0.040456732073196784
Bond Position:  [8.85769861]


portfolio before change:  [5.01707717]
curr_Stock_Price:  94.95894820255435
curr_Factors:  [94.9589482  -0.6870478  -1.02720958]
mat_Sqrt:  [[17.10186115  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00679728 -0.08192093  0.37676928]
Stock Position:  -0.006797284407153485
Bond Position:  [5.66254015]


portfolio before change:  [5.02421166]
curr_Stock_Price:  94.01347802606645
curr_Factors:  [94.01347803 -0.47802068 -1.03349416]
mat_Sqrt:  [[20.73707818  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00150858  0.0217609  -0.03205244]
Stock Position:  0.001508577627897574
Bond Position:  [4.88238503]


portfolio before change:  [5.02328434]
curr_Stock_Price:  92.99419995773931
curr_Factors:  [92.99419996 -0.62973933 -1.01514178]
mat_Sqrt:  [[17.95118289  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00027802 -0.00985638 -0.0736455 ]
Stock Position:  -0.00027802001076688594
Bond Position:  [5.04913858]


portfolio before change:  [5.02380217]
curr_Stock_Price:  93.40189219093479
curr_Factors:  [93.40189219 -0.73112017 -1.01669525]
mat_Sqrt:  [[16.26631142  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00935902 -0.06258731 -0.18532924]
Stock Position:  -0.009359021771225313
Bond Position:  [5.89795251]


portfolio before change:  [5.02613916]
curr_Stock_Price:  93.2309664753253
curr_Factors:  [93.23096648 -0.50455923 -1.02373551]
mat_Sqrt:  [[20.22228429  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.011603   0.0840043  0.52836846]
Stock Position:  0.011602997150099305
Bond Position:  [3.94438052]


portfolio before change:  [5.01527031]
curr_Stock_Price:  92.2517428189357
curr_Factors:  [92.25174282 -0.47028806 -1.05045299]
mat_Sqrt:  [[20.16160657  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00554267 -0.04031855  0.25213815]
Stock Position:  0.005542670984560857
Bond Position:  [4.50394925]


portfolio before change:  [5.02705786]
curr_Stock_Price:  94.27685347364772
curr_Factors:  [94.27685347 -0.59595043 -1.04310619]
mat_Sqrt:  [[18.3050885   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00457487 -0.00864089 -0.06869098]
Stock Position:  0.004574869792612072
Bond Position:  [4.59575353]


portfolio before change:  [5.02610466]
curr_Stock_Price:  93.94292031379403
curr_Factors:  [93.94292031 -0.61146062 -1.03671352]
mat_Sqrt:  [[18.074701    0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01713551 -0.08845735 -0.50832124]
Stock Position:  0.017135506189552903
Bond Position:  [3.41634517]


portfolio before change:  [5.05301331]
curr_Stock_Price:  95.48834135946157
curr_Factors:  [95.48834136 -0.70073996 -1.01251725]
mat_Sqrt:  [[17.2144123   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00247905 -0.02486993  0.03332468]
Stock Position:  -0.0024790481110276525
Bond Position:  [5.2897335]


portfolio before change:  [5.05318566]
curr_Stock_Price:  95.68555620534761
curr_Factors:  [95.68555621 -0.98602467 -1.00533267]
mat_Sqrt:  [[13.06203622  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0119023  -0.00648302  0.05442283]
Stock Position:  -0.0119022981372898
Bond Position:  [6.19206368]


portfolio before change:  [5.04657464]
curr_Stock_Price:  96.30603125861317
curr_Factors:  [96.30603126 -0.71242197 -0.98287743]
mat_Sqrt:  [[17.67642005  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0061951  -0.02474512 -0.12790141]
Stock Position:  0.00619509918671121
Bond Position:  [4.44994922]


portfolio before change:  [5.04501713]
curr_Stock_Price:  95.9648291502392
curr_Factors:  [95.96482915 -0.81487466 -0.98491516]
mat_Sqrt:  [[15.86621407  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00053452  0.01263763 -0.27622235]
Stock Position:  0.0005345247469416099
Bond Position:  [4.99372156]


portfolio before change:  [5.04585747]
curr_Stock_Price:  96.36908345977234
curr_Factors:  [96.36908346 -0.97336371 -1.01741293]
mat_Sqrt:  [[13.16298596  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00224752  0.00764695 -0.2019128 ]
Stock Position:  -0.0022475178813821054
Bond Position:  [5.26244871]


portfolio before change:  [5.04584627]
curr_Stock_Price:  96.66676544365492
curr_Factors:  [96.66676544 -0.92344429 -1.01051748]
mat_Sqrt:  [[13.97552925  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00428311 -0.03973651 -0.03194829]
Stock Position:  0.004283110939306442
Bond Position:  [4.63181179]


portfolio before change:  [5.04988224]
curr_Stock_Price:  97.47387969144374
curr_Factors:  [97.47387969 -1.07982032 -1.02073502]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [5.04988224]
Stock Price:  99.02893142280602
PL:  [5.04988224]
Settle:  Tensor("sub_152:0", shape=(), dtype=float64)
PL:  Tensor("sub_153:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  77
output_Z_Vals[:, i, :]:  [[ 1.19260232e+02 -2.92559343e+01 -2.92733494e+01]
 [ 4.82613608e-02  6.65036602e-03 -9.32114568e-02]
 [-3.23908034e-02  2.84690601e-02  7.11013721e-02]
 [-3.25762072e-02  1.27145571e-01  1.59817348e-02]
 [ 9.46532905e-02  1.17389430e-02 -6.78491507e-02]
 [ 6.33094750e-02  2.92046487e-02  7.56085443e-03]
 [-2.26173095e-03  4.30474457e-02  3.83537814e-02]
 [-9.17393785e-02 -2.40094281e-04 -9.78047848e-02]
 [ 7.73269983e-02  4.46588230e-04 -7.81178658e-02]
 [-7.22398152e-02  2.26107879e-01  8.32027860e-02]
 [ 6.12284052e-02  1.32474717e-01 -8.81929990e-02]
 [-3.78050991e-02 -1.08644151e-01 -1.80150694e-02]
 [-8.31073680e-02  4.13378765e-03  7.05146003e-03]
 [-8.74524911e-02 -1.11449758e-01  7.06808640e-02]
 [ 1.37848589e-01  3.95274013e-02 -1.26829775e-01]
 [-8.66966217e-02 -2.03214908e-01 -1.00971516e-01]
 [-6.72390876e-02 -5.90815174e-02 -4.48659167e-02]
 [-7.90504937e-02  1.61334600e-01  1.26257625e-01]
 [ 7.32304091e-02  4.37391164e-02  4.37048138e-02]
 [ 1.00694334e-01 -2.36793447e-02  2.53795350e-02]
 [-6.36024383e-02  6.91682327e-03  3.23204037e-03]
 [ 1.98923220e-02 -1.91828305e-02  1.92397585e-02]
 [-1.15380198e-01  2.26367785e-01  4.38522871e-01]
 [ 1.67627924e-01 -3.94270653e-02 -8.34356705e-03]
 [-1.28650794e-02  3.84151081e-02  1.16415564e-01]
 [ 8.10624914e-02 -1.42726049e-02  6.22911794e-02]
 [ 4.12916866e-02  4.71303462e-02 -5.48644097e-02]
 [-5.07806065e-02  7.36225950e-02  2.93687317e-02]
 [-1.04830553e-01 -1.10627315e-01 -1.56094868e-01]
 [ 1.21818428e-01  1.32984836e-01 -3.94713626e-02]
 [ 1.46504651e-02  1.80953690e-01  1.10069718e-02]
 [ 1.52963428e-02 -6.99973647e-02 -9.12237633e-02]
 [ 1.29763751e-01 -1.06039202e-01 -1.56563045e-02]
 [-4.99095265e-02 -8.53625739e-02 -7.24589610e-03]
 [-1.79270302e-01  1.45822636e-01  2.77471253e-02]
 [ 8.37574196e-02 -1.64218182e-01 -1.38284609e-01]
 [-5.09610799e-02 -1.63893013e-01 -3.73846469e-02]
 [-2.35279740e-02  2.02757096e-02 -6.91472822e-02]
 [ 1.84348353e-02 -5.65485704e-02 -6.30468379e-04]
 [-8.87985722e-01  4.40177170e-01  5.44122850e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.26023247 -29.25593426 -29.27334937]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  8.31486419  -9.25153874 -83.50871763]
init_Out:  [2.49911038]
Stock Position:  8.31486419409362
Bond position:  [-828.98730903]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-2.23335688]
curr_Stock_Price:  99.44330571613516
curr_Factors:  [99.44330572 -1.07717209 -1.00303924]
mat_Sqrt:  [[12.42084804  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0023675   0.00210303 -0.26590634]
Stock Position:  0.0023675004676801
Bond Position:  [-2.46878895]


portfolio before change:  [-2.23282039]
curr_Stock_Price:  99.80026785361753
curr_Factors:  [99.80026785 -1.1459331  -0.97595115]
mat_Sqrt:  [[11.95663815  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0014337   0.00900271  0.20283242]
Stock Position:  -0.0014336997082378602
Bond Position:  [-2.08973677]


portfolio before change:  [-2.23229646]
curr_Stock_Price:  99.25262115840516
curr_Factors:  [99.25262116 -0.89405848 -0.95573832]
mat_Sqrt:  [[15.60937237  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00166766  0.04020696  0.04559144]
Stock Position:  -0.0016676560784473226
Bond Position:  [-2.06677722]


portfolio before change:  [-2.23306798]
curr_Stock_Price:  99.56033407172731
curr_Factors:  [99.56033407 -0.65839989 -0.9600552 ]
mat_Sqrt:  [[19.73332322  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00411014  0.00371218 -0.19355474]
Stock Position:  0.004110140897263003
Bond Position:  [-2.64227498]


portfolio before change:  [-2.23774497]
curr_Stock_Price:  98.50278249320495
curr_Factors:  [98.50278249 -0.5923273  -0.96464089]
mat_Sqrt:  [[20.76183841  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00315997 0.00923532 0.02156901]
Stock Position:  0.003159974925035861
Bond Position:  [-2.5490113]


portfolio before change:  [-2.2407649]
curr_Stock_Price:  97.64794026047662
curr_Factors:  [97.64794026 -0.44395247 -0.97883309]
mat_Sqrt:  [[23.53722004  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00028375 0.0136128  0.10941266]
Stock Position:  0.000283749829582724
Bond Position:  [-2.26847249]


portfolio before change:  [-2.24077028]
curr_Stock_Price:  98.62838056091316
curr_Factors:  [98.62838056 -0.49316091 -0.98791338]
mat_Sqrt:  [[22.42742998  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-4.98094949e-03 -7.59244780e-05 -2.79009827e-01]
Stock Position:  -0.004980949486854798
Bond Position:  [-1.7495073]


portfolio before change:  [-2.25014184]
curr_Stock_Price:  100.46595376228846
curr_Factors:  [100.46595376  -0.60869787  -0.98965346]
mat_Sqrt:  [[20.31719489  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 3.02171569e-03  1.41223598e-04 -2.22848527e-01]
Stock Position:  0.0030217156874924175
Bond Position:  [-2.55372139]


portfolio before change:  [-2.25281511]
curr_Stock_Price:  99.68691264666904
curr_Factors:  [99.68691265 -0.50262473 -0.98919167]
mat_Sqrt:  [[22.42593266  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00220361  0.07150159  0.23735439]
Stock Position:  -0.0022036112402322177
Bond Position:  [-2.03314391]


portfolio before change:  [-2.25226377]
curr_Stock_Price:  99.32137297501976
curr_Factors:  [99.32137298 -0.42918886 -0.95087744]
mat_Sqrt:  [[24.98547095  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00186695  0.04189218 -0.25159008]
Stock Position:  0.001866947685817203
Bond Position:  [-2.43769157]


portfolio before change:  [-2.25220983]
curr_Stock_Price:  99.51348742995934
curr_Factors:  [99.51348743 -0.18646452 -0.97401775]
mat_Sqrt:  [[31.18106184  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00142034 -0.0343563  -0.05139198]
Stock Position:  -0.0014203361597576484
Bond Position:  [-2.11086722]


portfolio before change:  [-2.2523762]
curr_Stock_Price:  99.4448395109084
curr_Factors:  [99.44483951 -0.35407889 -0.97092863]
mat_Sqrt:  [[26.43253368  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00308564  0.00130722  0.02011585]
Stock Position:  -0.003085639152863469
Bond Position:  [-1.94552531]


portfolio before change:  [-2.25210481]
curr_Stock_Price:  99.27806895851461
curr_Factors:  [99.27806896 -0.33555985 -0.98412132]
mat_Sqrt:  [[26.52913404  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0028611  -0.03524351  0.20163283]
Stock Position:  -0.0028610975552239306
Bond Position:  [-1.96806057]


portfolio before change:  [-2.25470477]
curr_Stock_Price:  100.1008067501611
curr_Factors:  [100.10080675  -0.31461351  -0.98034551]
mat_Sqrt:  [[27.41852081  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00412058  0.01249966 -0.36181005]
Stock Position:  0.004120578339211545
Bond Position:  [-2.66717798]


portfolio before change:  [-2.25804087]
curr_Stock_Price:  99.3721022968548
curr_Factors:  [99.3721023  -0.62308284 -1.00788519]
mat_Sqrt:  [[19.45109536  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00578653 -0.0642622  -0.28804363]
Stock Position:  -0.0057865292617683955
Bond Position:  [-1.68302129]


portfolio before change:  [-2.25538313]
curr_Stock_Price:  98.87644594018094
curr_Factors:  [98.87644594 -0.58630295 -0.97798356]
mat_Sqrt:  [[20.68863548  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00376645 -0.01868322 -0.12798997]
Stock Position:  -0.0037664534601098754
Bond Position:  [-1.8829696]


portfolio before change:  [-2.25468871]
curr_Stock_Price:  98.62957923046872
curr_Factors:  [98.62957923 -0.30022374 -0.95977215]
mat_Sqrt:  [[27.97679238  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00175548  0.05101848  0.36017786]
Stock Position:  -0.0017554772461733637
Bond Position:  [-2.08154672]


portfolio before change:  [-2.25497036]
curr_Stock_Price:  98.64179541765276
curr_Factors:  [98.64179542 -0.30066443 -0.93475221]
mat_Sqrt:  [[28.6765129   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00290415 0.01383152 0.12467767]
Stock Position:  0.002904152128134273
Bond Position:  [-2.54144114]


portfolio before change:  [-2.2538728]
curr_Stock_Price:  99.12911905014218
curr_Factors:  [ 9.91291191e+01 -3.62512853e-02 -9.14514905e-01]
mat_Sqrt:  [[38.30793455  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00274783 -0.00748807  0.07240075]
Stock Position:  0.002747825304433706
Bond Position:  [-2.5262623]


portfolio before change:  [-2.25107959]
curr_Stock_Price:  100.26056239297716
curr_Factors:  [100.26056239  -0.21488702  -0.92235285]
mat_Sqrt:  [[32.1538612   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00195199  0.00218729  0.00922011]
Stock Position:  -0.0019519929128646613
Bond Position:  [-2.05537168]


portfolio before change:  [-2.25272546]
curr_Stock_Price:  100.97210904528959
curr_Factors:  [100.97210905  -0.11728968  -0.92034948]
mat_Sqrt:  [[35.77342034  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.000652   -0.00606614  0.05488568]
Stock Position:  0.0006520014707247122
Bond Position:  [-2.31855943]


portfolio before change:  [-2.25301125]
curr_Stock_Price:  100.9783241774798
curr_Factors:  [ 1.00978324e+02 -7.84588209e-02 -9.05980786e-01]
mat_Sqrt:  [[37.73040526  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-5.30667521e-04  7.15837790e-02  1.25098369e+00]
Stock Position:  -0.0005306675210493725
Bond Position:  [-2.19942533]


portfolio before change:  [-2.25390972]
curr_Stock_Price:  102.15331380395638
curr_Factors:  [ 1.02153314e+02  2.15097127e-02 -8.87075194e-01]
mat_Sqrt:  [[42.98749588  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00383616 -0.01246793 -0.02380187]
Stock Position:  0.0038361573483048513
Bond Position:  [-2.64578591]


portfolio before change:  [-2.26469158]
curr_Stock_Price:  99.42894252593786
curr_Factors:  [99.42894253  0.20196461 -0.86137503]
mat_Sqrt:  [[51.42028906  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [2.31232109e-04 1.21479238e-02 3.32101200e-01]
Stock Position:  0.00023123210879144016
Bond Position:  [-2.28768275]


portfolio before change:  [-2.26412029]
curr_Stock_Price:  103.13637580475465
curr_Factors:  [ 1.03136376e+02  4.68608678e-02 -8.78886857e-01]
mat_Sqrt:  [[44.88152142  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00208124 -0.00451339  0.1776994 ]
Stock Position:  0.0020812375596665628
Bond Position:  [-2.47877158]


portfolio before change:  [-2.27164024]
curr_Stock_Price:  99.67204704887511
curr_Factors:  [99.67204705  0.11816518 -0.8465671 ]
mat_Sqrt:  [[48.1096772   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00065079  0.01490392 -0.15651289]
Stock Position:  0.0006507928961922176
Bond Position:  [-2.3365061]


portfolio before change:  [-2.27277841]
curr_Stock_Price:  98.3719576113131
curr_Factors:  [98.37195761 -0.15219966 -0.81326346]
mat_Sqrt:  [[37.46071002  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00114479  0.02328151  0.08378082]
Stock Position:  -0.001144794425612363
Bond Position:  [-2.16016274]


portfolio before change:  [-2.2722475]
curr_Stock_Price:  97.67230951625734
curr_Factors:  [97.67230952 -0.43009879 -0.78330479]
mat_Sqrt:  [[29.02665405  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00480764 -0.03498343 -0.44529521]
Stock Position:  -0.004807638835260998
Bond Position:  [-1.80267431]


portfolio before change:  [-2.2688875]
curr_Stock_Price:  96.92654929195183
curr_Factors:  [96.92654929 -0.10723042 -0.78761882]
mat_Sqrt:  [[39.61089614  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00295866  0.0420535  -0.11260081]
Stock Position:  0.0029586562000109237
Bond Position:  [-2.55565984]


portfolio before change:  [-2.26335196]
curr_Stock_Price:  98.9054936950922
curr_Factors:  [98.9054937  -0.171739   -0.76208452]
mat_Sqrt:  [[38.87460719  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00055485 0.05722258 0.03139983]
Stock Position:  0.0005548469700117953
Bond Position:  [-2.31822937]


portfolio before change:  [-2.26289076]
curr_Stock_Price:  100.25902283315294
curr_Factors:  [100.25902283  -0.52514617  -0.79244593]
mat_Sqrt:  [[26.84729225  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-1.91153509e-04 -2.21351103e-02 -2.60236005e-01]
Stock Position:  -0.00019115350915922455
Bond Position:  [-2.24372589]


portfolio before change:  [-2.26328804]
curr_Stock_Price:  100.87007027261716
curr_Factors:  [100.87007027  -0.94971474  -0.77513121]
mat_Sqrt:  [[17.97509711  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00688898 -0.03353254 -0.04466308]
Stock Position:  0.00688897533152125
Bond Position:  [-2.95817947]


portfolio before change:  [-2.26766951]
curr_Stock_Price:  100.28773833325936
curr_Factors:  [100.28773833  -0.85392649  -0.80641844]
mat_Sqrt:  [[19.06203195  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00281149 -0.02699402 -0.02067052]
Stock Position:  -0.0028114862662013736
Bond Position:  [-1.98571191]


portfolio before change:  [-2.26821906]
curr_Stock_Price:  100.39491497512454
curr_Factors:  [100.39491498  -0.81225007  -0.78686515]
mat_Sqrt:  [[20.28732564  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00837179  0.04611317  0.07915483]
Stock Position:  -0.008371794395280463
Bond Position:  [-1.42773348]


portfolio before change:  [-2.26655379]
curr_Stock_Price:  100.17468063828996
curr_Factors:  [100.17468064  -0.75646417  -0.78294597]
mat_Sqrt:  [[21.48822971  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00238689 -0.05193035 -0.3944875 ]
Stock Position:  0.002386892610523014
Bond Position:  [-2.50565999]


portfolio before change:  [-2.26798278]
curr_Stock_Price:  99.70722630739368
curr_Factors:  [99.70722631 -0.67304845 -0.75994496]
mat_Sqrt:  [[23.78951047  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00264082 -0.05182752 -0.10664799]
Stock Position:  -0.002640823084951755
Bond Position:  [-2.00467363]


portfolio before change:  [-2.26788751]
curr_Stock_Price:  99.5762587978559
curr_Factors:  [99.5762588  -0.88154618 -0.74951063]
mat_Sqrt:  [[19.48932665  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00190459  0.00641174 -0.19725795]
Stock Position:  -0.0019045854171035512
Bond Position:  [-2.07823602]


portfolio before change:  [-2.2653349]
curr_Stock_Price:  98.09960917860205
curr_Factors:  [98.09960918 -0.92360009 -0.71359526]
mat_Sqrt:  [[19.08281203  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00088279 -0.01788223 -0.00179855]
Stock Position:  0.0008827872765749923
Bond Position:  [-2.35193599]


portfolio before change:  [-2.26535699]
curr_Stock_Price:  98.40763939069096
curr_Factors:  [98.40763939 -1.24639854 -0.7061658 ]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-2.26535699]
Stock Price:  98.41395419204892
PL:  [-2.26535699]
Settle:  Tensor("sub_154:0", shape=(), dtype=float64)
PL:  Tensor("sub_155:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  78
output_Z_Vals[:, i, :]:  [[ 1.19260232e+02 -2.92559343e+01 -2.92733494e+01]
 [-2.18209864e-02 -5.46998253e-03 -1.57507136e-02]
 [-2.83323138e-02  4.70263969e-02  9.67186787e-02]
 [-2.05827165e-01 -9.66538444e-02 -1.33595003e-02]
 [ 2.43313964e-02  3.19081352e-02 -7.88362917e-02]
 [ 7.02594060e-02  3.02331096e-02 -9.74416281e-03]
 [ 1.67607512e-02  5.57628109e-02 -8.43307434e-03]
 [-8.88120186e-02  1.03839837e-02 -9.39301863e-02]
 [ 1.53367831e-01 -5.25477497e-02 -1.31129800e-01]
 [-1.19993205e-01 -1.58455372e-01 -6.02627336e-02]
 [ 1.63884661e-01  9.27562943e-02  1.42122409e-01]
 [-2.57736069e-01 -1.18838569e-01  7.75069673e-02]
 [ 3.99794799e-02 -1.87712087e-01  1.09694660e-01]
 [-1.25196684e-01 -1.24872834e-01  4.27425103e-02]
 [ 1.70991637e-01  2.37071062e-01  5.49807579e-02]
 [-3.68932102e-02 -6.25933325e-01 -1.28279116e-02]
 [-6.65398514e-02 -1.88263473e-02 -3.51766728e-02]
 [-6.90030304e-02  1.60845952e-01  1.07047172e-01]
 [ 8.66714572e-02  5.84963157e-02  7.86211679e-02]
 [-5.85049746e-03 -1.50725263e-02  8.74076990e-02]
 [ 1.74406187e-02 -5.80574222e-02  2.45202681e-02]
 [ 1.24841657e-01 -4.18047744e-02  2.11867284e-01]
 [-4.37865492e-02 -1.86701140e-02  2.64347154e-01]
 [-6.90155342e-02 -5.55779336e-04 -8.18862837e-02]
 [-4.03951195e-01  1.25343508e-01  8.39509405e-02]
 [-8.49369110e-02 -2.01104261e-01  1.15539539e-01]
 [ 1.56256025e-01  5.82878212e-02 -1.09850240e-01]
 [-3.43709633e-02  6.10097223e-02  2.52634768e-02]
 [-8.18203172e-02 -7.75369193e-02 -1.96980272e-01]
 [ 4.27630930e-02  3.38098387e-02 -1.06034561e-01]
 [ 3.85158237e-02  1.10515932e-01  1.79414742e-02]
 [ 1.54255696e-02 -7.40467888e-02 -9.17709958e-02]
 [ 6.09126552e-02 -3.10636040e-02  6.83360203e-02]
 [-5.08023369e-02 -8.62341895e-02 -9.70201530e-03]
 [-1.93266736e-01  1.85901034e-01  2.69394454e-02]
 [ 1.00520981e-01 -1.58330443e-01 -1.30647033e-01]
 [-1.45828239e-01 -2.18765801e-01  3.34105484e-03]
 [-4.56843925e-02 -2.74343581e-02  3.61884932e-02]
 [-3.68212436e-02  7.89539469e-02 -2.53689057e-02]
 [ 7.93329003e-02 -2.91952592e-03 -6.86554344e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.26023247 -29.25593426 -29.27334937]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  8.31486419  -9.25153874 -83.50871763]
init_Out:  [2.49911038]
Stock Position:  8.31486419409362
Bond position:  [-828.98730903]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [5.98246641]
curr_Stock_Price:  100.43139440833464
curr_Factors:  [100.43139441  -0.85944618  -0.98400209]
mat_Sqrt:  [[15.89534947  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00158394 -0.00172976 -0.0449324 ]
Stock Position:  -0.0015839426319701495
Bond Position:  [6.14154398]


portfolio before change:  [5.98434481]
curr_Stock_Price:  99.73019572704226
curr_Factors:  [99.73019573 -0.55324094 -0.99633072]
mat_Sqrt:  [[21.17660093  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00034828  0.01487105  0.27591147]
Stock Position:  -0.00034828440229748306
Bond Position:  [6.01907928]


portfolio before change:  [5.98554622]
curr_Stock_Price:  98.44106875895798
curr_Factors:  [98.44106876 -0.46867858 -0.97180694]
mat_Sqrt:  [[23.31210044  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00905323 -0.03056463 -0.03811094]
Stock Position:  -0.00905322769580553
Bond Position:  [6.87675563]


portfolio before change:  [5.9860157]
curr_Stock_Price:  98.48416656605323
curr_Factors:  [98.48416657 -0.31309763 -0.94603042]
mat_Sqrt:  [[27.95979932  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00032414  0.01009024 -0.224898  ]
Stock Position:  0.00032413931715163144
Bond Position:  [5.95409311]


portfolio before change:  [5.9869464]
curr_Stock_Price:  99.05919821974487
curr_Factors:  [99.05919822 -0.1755754  -0.95692677]
mat_Sqrt:  [[31.91944764  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00216329  0.00956055 -0.02779738]
Stock Position:  0.0021632893963639387
Bond Position:  [5.77265268]


portfolio before change:  [5.98736529]
curr_Stock_Price:  98.91925928842207
curr_Factors:  [98.91925929 -0.39174282 -0.95024339]
mat_Sqrt:  [[25.85018473  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00063749  0.01763375 -0.02405721]
Stock Position:  0.0006374866109904114
Bond Position:  [5.92430559]


portfolio before change:  [5.98793503]
curr_Stock_Price:  98.65125030501837
curr_Factors:  [ 9.86512503e+01 -6.50539518e-02 -9.55254275e-01]
mat_Sqrt:  [[35.5621788   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00302899  0.0032837  -0.26795668]
Stock Position:  -0.0030289855096758585
Bond Position:  [6.28674823]


portfolio before change:  [5.99194166]
curr_Stock_Price:  97.58794468768423
curr_Factors:  [97.58794469 -0.25816114 -0.94579316]
mat_Sqrt:  [[29.27692503  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00427792 -0.01661706 -0.37407682]
Stock Position:  0.004277918373676347
Bond Position:  [5.5744684]


portfolio before change:  [5.9840579]
curr_Stock_Price:  95.58215306940465
curr_Factors:  [95.58215307 -0.17695924 -0.93549127]
mat_Sqrt:  [[31.42285887  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00434033 -0.05010799 -0.1719128 ]
Stock Position:  -0.004340330235839223
Bond Position:  [6.39891601]


portfolio before change:  [5.9819309]
curr_Stock_Price:  96.25650566920191
curr_Factors:  [96.25650567 -0.13998528 -0.95859418]
mat_Sqrt:  [[32.08655512  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00608636 0.02933212 0.40543567]
Stock Position:  0.006086357123799364
Bond Position:  [5.39607943]


portfolio before change:  [5.97274772]
curr_Stock_Price:  94.63686181895243
curr_Factors:  [94.63686182 -0.40498093 -0.96914851]
mat_Sqrt:  [[23.94878567  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01022947 -0.03758006  0.2211058 ]
Stock Position:  -0.01022947164615244
Bond Position:  [6.94083281]


portfolio before change:  [5.97600822]
curr_Stock_Price:  94.40294518064641
curr_Factors:  [94.40294518 -0.28724414 -0.98968564]
mat_Sqrt:  [[26.32824938  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00218488 -0.05935977  0.31292833]
Stock Position:  0.002184881435357592
Bond Position:  [5.76974898]


portfolio before change:  [5.97937317]
curr_Stock_Price:  95.61293482912319
curr_Factors:  [95.61293483 -0.34608121 -0.98825599]
mat_Sqrt:  [[25.17800812  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00475399 -0.03948826  0.12193248]
Stock Position:  -0.004753994360708028
Bond Position:  [6.43391652]


portfolio before change:  [5.97647451]
curr_Stock_Price:  96.39184739440526
curr_Factors:  [96.39184739 -0.36151973 -0.9984756 ]
mat_Sqrt:  [[24.74012189  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00761256 0.07496845 0.1568448 ]
Stock Position:  0.007612560936151626
Bond Position:  [5.2426857]


portfolio before change:  [5.97514308]
curr_Stock_Price:  96.1308566367727
curr_Factors:  [96.13085664 -0.47282722 -1.00758313]
mat_Sqrt:  [[21.87402816  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00254517 -0.1979375  -0.03659446]
Stock Position:  -0.002545174816057028
Bond Position:  [6.21981292]


portfolio before change:  [5.97459912]
curr_Stock_Price:  96.65007038637592
curr_Factors:  [96.65007039 -0.64618677 -0.98073581]
mat_Sqrt:  [[18.9949727   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00390663 -0.00595341 -0.10034926]
Stock Position:  -0.003906631249163703
Bond Position:  [6.3521753]


portfolio before change:  [5.97154878]
curr_Stock_Price:  97.63414248184543
curr_Factors:  [97.63414248 -0.92908639 -0.9711406 ]
mat_Sqrt:  [[14.59968947  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00294521  0.05086396  0.30537579]
Stock Position:  -0.002945206013365271
Bond Position:  [6.25910144]


portfolio before change:  [5.97049758]
curr_Stock_Price:  98.25672732981278
curr_Factors:  [98.25672733 -0.83385839 -0.9893607 ]
mat_Sqrt:  [[15.86895402  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00656819 0.01849816 0.22428431]
Stock Position:  0.006568189945530434
Bond Position:  [5.32512873]


portfolio before change:  [5.97292556]
curr_Stock_Price:  98.52503593600264
curr_Factors:  [98.52503594 -0.8675675  -0.98918894]
mat_Sqrt:  [[15.38748094  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00075401 -0.00476635  0.24934984]
Stock Position:  0.0007540125297282502
Bond Position:  [5.89863645]


portfolio before change:  [5.97331309]
curr_Stock_Price:  98.06105997761473
curr_Factors:  [98.06105998 -1.05800266 -0.98104205]
mat_Sqrt:  [[12.76293975  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00164122 -0.01835937  0.0699495 ]
Stock Position:  0.0016412175963726038
Bond Position:  [5.81237356]


portfolio before change:  [5.97318915]
curr_Stock_Price:  97.54282805521352
curr_Factors:  [97.54282806 -0.71467137 -0.9721783 ]
mat_Sqrt:  [[18.05534696  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00924986 -0.01321983  0.60439839]
Stock Position:  0.009249863250200056
Bond Position:  [5.07093133]


portfolio before change:  [5.9655143]
curr_Stock_Price:  96.64457041265938
curr_Factors:  [96.64457041 -0.71903363 -0.99721832]
mat_Sqrt:  [[17.37075552  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 5.57893253e-04 -5.90400846e-03  7.54108849e-01]
Stock Position:  0.0005578932529479534
Bond Position:  [5.91159695]


portfolio before change:  [5.966692]
curr_Stock_Price:  97.43092416747263
curr_Factors:  [97.43092417 -0.54316572 -0.98823316]
mat_Sqrt:  [[21.06777825  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-4.06995227e-03 -1.75752858e-04 -2.33598775e-01]
Stock Position:  -0.004069952274529999
Bond Position:  [6.36323121]


portfolio before change:  [5.97034592]
curr_Stock_Price:  96.72858917805408
curr_Factors:  [96.72858918 -0.4890918  -1.01002887]
mat_Sqrt:  [[21.60205256  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01775657  0.0396371   0.23948867]
Stock Position:  -0.017756573110313756
Bond Position:  [7.68791419]


portfolio before change:  [5.97170505]
curr_Stock_Price:  96.70617026073522
curr_Factors:  [96.70617026 -0.54084371 -1.00551541]
mat_Sqrt:  [[20.60055643  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00323025 -0.06359475  0.32960214]
Stock Position:  -0.003230252119765392
Bond Position:  [6.28409036]


portfolio before change:  [5.97291475]
curr_Stock_Price:  96.57486848077482
curr_Factors:  [96.57486848 -0.44445898 -0.99353787]
mat_Sqrt:  [[22.9271475   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00590296  0.01843223 -0.31337216]
Stock Position:  0.005902955139701947
Bond Position:  [5.40283764]


portfolio before change:  [5.97533081]
curr_Stock_Price:  96.8697490067847
curr_Factors:  [96.86974901 -0.52337405 -0.98536504]
mat_Sqrt:  [[21.42649411  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00128994  0.01929297  0.07206967]
Stock Position:  -0.0012899363434722905
Bond Position:  [6.10028662]


portfolio before change:  [5.97417261]
curr_Stock_Price:  98.35880216079457
curr_Factors:  [98.35880216 -0.73171761 -0.99139258]
mat_Sqrt:  [[17.55803794  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00706404 -0.02451933 -0.56192989]
Stock Position:  -0.007064043368235347
Bond Position:  [6.66898346]


portfolio before change:  [5.97617724]
curr_Stock_Price:  98.19303992070645
curr_Factors:  [98.19303992 -0.66444892 -0.99778486]
mat_Sqrt:  [[18.62866559  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00118054  0.01069161 -0.30248709]
Stock Position:  0.0011805378605961822
Bond Position:  [5.86025664]


portfolio before change:  [5.97812186]
curr_Stock_Price:  99.21972673998197
curr_Factors:  [99.21972674 -0.79444624 -1.01489078]
mat_Sqrt:  [[16.24848763  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00277143 0.03494821 0.05118203]
Stock Position:  0.0027714346016325165
Bond Position:  [5.70314088]


portfolio before change:  [5.98332216]
curr_Stock_Price:  100.83887539777822
curr_Factors:  [100.8388754   -0.63018483  -1.01374085]
mat_Sqrt:  [[19.48409054  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00026786 -0.02341565 -0.26179711]
Stock Position:  -0.00026785886369058606
Bond Position:  [6.01033275]


portfolio before change:  [5.98357102]
curr_Stock_Price:  102.71480841359794
curr_Factors:  [102.71480841  -0.5401337   -1.04948042]
mat_Sqrt:  [[20.95426446  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00353435 -0.00982317  0.19494364]
Stock Position:  0.003534346350191401
Bond Position:  [5.62054131]


portfolio before change:  [5.98458888]
curr_Stock_Price:  102.8040059999082
curr_Factors:  [102.804006    -0.31919624  -1.03756243]
mat_Sqrt:  [[26.47141963  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00207806 -0.02726965 -0.02767715]
Stock Position:  -0.0020780642099657715
Bond Position:  [6.19822221]


portfolio before change:  [5.98672409]
curr_Stock_Price:  102.14936975896444
curr_Factors:  [102.14936976  -0.20413118  -1.04592398]
mat_Sqrt:  [[29.26467012  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00625217  0.05878707  0.07685074]
Stock Position:  -0.006252173698237298
Bond Position:  [6.62537969]


portfolio before change:  [5.985066]
curr_Stock_Price:  102.54704078155945
curr_Factors:  [102.54704078  -0.3277073   -1.06024181]
mat_Sqrt:  [[25.59437298  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00272578 -0.05006848 -0.37269962]
Stock Position:  0.002725782461230899
Bond Position:  [5.70554508]


portfolio before change:  [5.98619635]
curr_Stock_Price:  102.70006373012187
curr_Factors:  [102.70006373  -0.33778852  -1.06922871]
mat_Sqrt:  [[25.14843115  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00599619 -0.06917982  0.0095311 ]
Stock Position:  -0.0059961894390953945
Bond Position:  [6.60200538]


portfolio before change:  [5.9857171]
curr_Stock_Price:  102.91762601857607
curr_Factors:  [102.91762602  -0.35101574  -1.07677124]
mat_Sqrt:  [[24.68367102  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00158023 -0.00867551  0.1032357 ]
Stock Position:  -0.0015802268361450591
Bond Position:  [6.1483503]


portfolio before change:  [5.98487552]
curr_Stock_Price:  103.93657787041677
curr_Factors:  [103.93657787  -0.57737399  -1.10461415]
mat_Sqrt:  [[19.33259907  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00206703  0.02496743 -0.07237043]
Stock Position:  -0.0020670302765200105
Bond Position:  [6.19971557]


portfolio before change:  [5.98467599]
curr_Stock_Price:  104.40804682165556
curr_Factors:  [104.40804682  -0.64096375  -1.11703885]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [5.98467599]
Stock Price:  103.95689498497079
PL:  [2.02778101]
Settle:  Tensor("sub_156:0", shape=(), dtype=float64)
PL:  Tensor("sub_157:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  79
output_Z_Vals[:, i, :]:  [[ 1.19260232e+02 -2.92559343e+01 -2.92733494e+01]
 [-1.23638072e-01  3.36065530e-01  5.28805264e-02]
 [-4.85469390e-02  1.71534287e-02  1.02846973e-01]
 [-1.70603940e-01 -5.83338097e-02 -1.36251205e-03]
 [ 4.89648305e-02  2.68047368e-02 -7.00612904e-02]
 [ 6.05490849e-02  2.87928511e-02  2.67704185e-02]
 [ 7.18001199e-02  1.35638619e-02 -7.47301315e-02]
 [-9.32824974e-02 -5.84043571e-03 -9.98472278e-02]
 [ 1.55330899e-01 -3.61134979e-02 -9.51779481e-02]
 [-1.05752846e-01  4.06552775e-01  2.05842240e-01]
 [ 9.44928561e-02  9.05693870e-02 -4.84950661e-02]
 [-3.25510882e-02 -9.14679815e-02 -1.41842555e-02]
 [-7.25966444e-02  4.51579508e-03  3.98453293e-02]
 [-9.62623594e-02 -1.14884369e-01  6.32126881e-02]
 [ 2.05987232e-01  2.05716399e-01 -2.61842637e-02]
 [-7.00971824e-02 -3.72359489e-01 -5.69893972e-02]
 [-6.71007017e-02 -6.00025666e-02 -4.88025657e-02]
 [-8.46210258e-02  1.11548289e-01  1.15446989e-01]
 [ 5.69164146e-02  3.87714468e-02  1.71586373e-02]
 [-3.24081508e-02 -8.69147580e-03  9.75587684e-02]
 [-2.93590153e-02 -3.77882961e-02  2.29265760e-02]
 [ 1.20369411e-01 -6.71661295e-02  1.70146789e-01]
 [-6.73046796e-02  6.00362050e-02  3.37183000e-01]
 [-6.90121363e-02 -5.55860193e-04 -8.18872738e-02]
 [-4.70574811e-01  1.46357579e-01  5.46601479e-02]
 [-1.00165686e-01 -2.17762819e-01  1.20369796e-01]
 [ 1.36065600e-01  5.94621432e-02 -9.45379504e-02]
 [ 1.99318696e-02  2.09134451e-02  1.83112404e-02]
 [-1.17813295e-01 -1.38721777e-01 -1.24843684e-01]
 [ 3.48158641e-02  1.97107165e-02 -1.14031323e-01]
 [ 4.66113351e-02 -6.48610311e-03  3.33126562e-02]
 [ 6.08480084e-02 -1.09543656e-01 -7.87215528e-02]
 [ 1.09963973e-01 -5.18325624e-02  6.23621680e-02]
 [-4.69240416e-02 -8.24479628e-02  9.67165183e-04]
 [-1.97370867e-01  1.49702958e-01  2.23218243e-02]
 [ 7.73170792e-02 -1.49403568e-01 -1.15830645e-01]
 [-2.56939657e-02 -1.38329768e-01 -5.42049631e-02]
 [-2.41143776e-02  2.12638229e-02 -6.66501974e-02]
 [-2.77378726e-02  4.74517058e-02 -1.08652296e-04]
 [-8.57795771e-01  4.25729148e-01  5.25738754e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.26023247 -29.25593426 -29.27334937]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  8.31486419  -9.25153874 -83.50871763]
init_Out:  [2.49911038]
Stock Position:  8.31486419409362
Bond position:  [-828.98730903]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [10.62689821]
curr_Stock_Price:  100.98996418095332
curr_Factors:  [100.98996418  -1.05773388  -0.9929817 ]
mat_Sqrt:  [[12.99163348  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00801798  0.10627325  0.15085342]
Stock Position:  -0.00801798368625587
Bond Position:  [11.4366341]


portfolio before change:  [10.64283344]
curr_Stock_Price:  99.18083568937156
curr_Factors:  [99.18083569 -0.88679983 -0.97561609]
mat_Sqrt:  [[15.40248535  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00176014  0.00542439  0.29339379]
Stock Position:  -0.0017601373010662684
Bond Position:  [10.81740533]


portfolio before change:  [10.64514433]
curr_Stock_Price:  98.63620272460041
curr_Factors:  [98.63620272 -0.54522101 -0.93607373]
mat_Sqrt:  [[22.42426474  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00768758 -0.01844677 -0.00388687]
Stock Position:  -0.007687575767380531
Bond Position:  [11.40341761]


portfolio before change:  [10.64269465]
curr_Stock_Price:  99.14028917656864
curr_Factors:  [99.14028918 -0.39996929 -0.91854705]
mat_Sqrt:  [[26.52319322  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00133301  0.0084764  -0.19986536]
Stock Position:  0.001333011621213993
Bond Position:  [10.51053949]


portfolio before change:  [10.64269401]
curr_Stock_Price:  98.15415029398032
curr_Factors:  [98.15415029 -0.58205576 -0.89333445]
mat_Sqrt:  [[22.4468208   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00297401 0.0091051  0.07636855]
Stock Position:  0.0029740069870918175
Bond Position:  [10.35078288]


portfolio before change:  [10.64701504]
curr_Stock_Price:  99.17200162867834
curr_Factors:  [99.17200163 -0.84823937 -0.87499791]
mat_Sqrt:  [[17.70095252  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0032143   0.00428927 -0.21318426]
Stock Position:  0.0032142966874541255
Bond Position:  [10.3282468]


portfolio before change:  [10.6467699]
curr_Stock_Price:  98.69406072040155
curr_Factors:  [98.69406072 -0.71374309 -0.85941016]
mat_Sqrt:  [[20.4681809   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00556056 -0.00184691 -0.28483635]
Stock Position:  -0.005560558966424489
Bond Position:  [11.19556405]


portfolio before change:  [10.64601303]
curr_Stock_Price:  99.0818642820921
curr_Factors:  [99.08186428 -0.42392059 -0.84431556]
mat_Sqrt:  [[27.8744438   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00484208 -0.01142009 -0.27151619]
Stock Position:  0.004842081748707872
Bond Position:  [10.16625055]


portfolio before change:  [10.64832189]
curr_Stock_Price:  99.29623345915788
curr_Factors:  [99.29623346 -0.20372608 -0.83658845]
mat_Sqrt:  [[35.08568157  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00151738  0.12856328  0.58721062]
Stock Position:  -0.001517380434780405
Bond Position:  [10.79899205]


portfolio before change:  [10.65190096]
curr_Stock_Price:  97.82717927205104
curr_Factors:  [97.82717927 -0.28818222 -0.8399969 ]
mat_Sqrt:  [[31.65902699  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00274589  0.02864055 -0.13834293]
Stock Position:  0.002745894046246658
Bond Position:  [10.38327789]


portfolio before change:  [10.65840613]
curr_Stock_Price:  99.72353009535361
curr_Factors:  [99.7235301  -0.40810651 -0.8710171 ]
mat_Sqrt:  [[27.75117126  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0013624  -0.02892472 -0.04046373]
Stock Position:  -0.0013623976462642819
Bond Position:  [10.79426923]


portfolio before change:  [10.66099241]
curr_Stock_Price:  98.81563534392829
curr_Factors:  [98.81563534 -0.30126289 -0.87511242]
mat_Sqrt:  [[30.4742035   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00211151  0.00142802  0.11366763]
Stock Position:  -0.002111512225729531
Bond Position:  [10.86964283]


portfolio before change:  [10.66396979]
curr_Stock_Price:  98.0490824000393
curr_Factors:  [98.0490824  -0.27414702 -0.87467515]
mat_Sqrt:  [[31.08253287  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0027773  -0.03632963  0.1803282 ]
Stock Position:  -0.0027772969954803998
Bond Position:  [10.93628121]


portfolio before change:  [10.66478516]
curr_Stock_Price:  98.24774715718593
curr_Factors:  [98.24774716 -0.57097659 -0.84609923]
mat_Sqrt:  [[23.81740229  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00864721  0.06505324 -0.07469642]
Stock Position:  0.008647205270965044
Bond Position:  [9.81521672]


portfolio before change:  [10.66456539]
curr_Stock_Price:  98.08043949366943
curr_Factors:  [98.08043949 -0.43207843 -0.86473423]
mat_Sqrt:  [[26.81537179  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00340642 -0.11775041 -0.16257489]
Stock Position:  -0.0034064183675698917
Bond Position:  [10.9986684]


portfolio before change:  [10.66153979]
curr_Stock_Price:  99.37227066295782
curr_Factors:  [99.37227066 -0.39899466 -0.87231135]
mat_Sqrt:  [[27.87045299  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00282061 -0.01897448 -0.13922014]
Stock Position:  -0.0028206123302926094
Bond Position:  [10.94183044]


portfolio before change:  [10.66371411]
curr_Stock_Price:  99.08633757211078
curr_Factors:  [99.08633757 -0.24917795 -0.88328906]
mat_Sqrt:  [[31.92931503  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.001822    0.03527467  0.32933813]
Stock Position:  -0.001822004116654677
Bond Position:  [10.84424983]


portfolio before change:  [10.66574632]
curr_Stock_Price:  98.71499529385795
curr_Factors:  [ 9.87149953e+01 -9.12851984e-02 -8.57605035e-01]
mat_Sqrt:  [[38.21952955  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00160703 0.01226061 0.04894882]
Stock Position:  0.0016070313264817276
Bond Position:  [10.50710823]


portfolio before change:  [10.6630687]
curr_Stock_Price:  96.23148239219238
curr_Factors:  [ 9.62314824e+01  4.73667080e-02 -8.49298591e-01]
mat_Sqrt:  [[43.1561391   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00029471 -0.00274849  0.27830801]
Stock Position:  -0.00029470809512807764
Bond Position:  [10.6914289]


portfolio before change:  [10.66380946]
curr_Stock_Price:  98.25298905800949
curr_Factors:  [98.25298906 -0.10402707 -0.84228475]
mat_Sqrt:  [[38.13886539  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00067267 -0.01194971  0.06540314]
Stock Position:  -0.0006726691243182781
Bond Position:  [10.72990121]


portfolio before change:  [10.66524281]
curr_Stock_Price:  98.11617719046141
curr_Factors:  [98.11617719 -0.38444747 -0.80634594]
mat_Sqrt:  [[29.82535412  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00514214 -0.0212398   0.48538143]
Stock Position:  0.005142143714615559
Bond Position:  [10.16071533]


portfolio before change:  [10.66749868]
curr_Stock_Price:  98.30786707306453
curr_Factors:  [98.30786707 -0.56084826 -0.82801808]
mat_Sqrt:  [[24.51383657  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [1.25343101e-04 1.89851150e-02 9.61889246e-01]
Stock Position:  0.0001253431012782788
Bond Position:  [10.65517647]


portfolio before change:  [10.66871836]
curr_Stock_Price:  97.41192636416062
curr_Factors:  [97.41192636 -0.67376381 -0.81750805]
mat_Sqrt:  [[21.92607994  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-3.91048735e-03 -1.75778427e-04 -2.33601599e-01]
Stock Position:  -0.00391048735225134
Bond Position:  [11.04964646]


portfolio before change:  [10.67296761]
curr_Stock_Price:  96.67852502619596
curr_Factors:  [96.67852503 -0.78429324 -0.81129919]
mat_Sqrt:  [[19.60527895  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0232406   0.04628233  0.15593019]
Stock Position:  -0.023240598609067256
Bond Position:  [12.9198344]


portfolio before change:  [10.67862159]
curr_Stock_Price:  96.50473840647707
curr_Factors:  [96.50473841 -0.79056872 -0.81422437]
mat_Sqrt:  [[19.39080564  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00418848 -0.06886265  0.34338152]
Stock Position:  -0.004188475565094759
Bond Position:  [11.08282933]


portfolio before change:  [10.68258387]
curr_Stock_Price:  95.88951802988217
curr_Factors:  [95.88951803 -0.7443475  -0.81795728]
mat_Sqrt:  [[20.10345902  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00588473  0.01880358 -0.26969046]
Stock Position:  0.005884729940876862
Bond Position:  [10.11829995]


portfolio before change:  [10.68325262]
curr_Stock_Price:  95.78821882026297
curr_Factors:  [95.78821882 -0.58848005 -0.82832764]
mat_Sqrt:  [[23.22738586  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00104229 0.00661341 0.05223687]
Stock Position:  0.0010422877068817567
Bond Position:  [10.58341373]


portfolio before change:  [10.68601856]
curr_Stock_Price:  97.17260597893281
curr_Factors:  [97.17260598 -1.08034517 -0.80257105]
mat_Sqrt:  [[14.78440067  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00993471 -0.04386768 -0.35614428]
Stock Position:  -0.009934706795418203
Bond Position:  [11.6513999]


portfolio before change:  [10.68726489]
curr_Stock_Price:  97.19376237761257
curr_Factors:  [97.19376238 -0.9914506  -0.78114166]
mat_Sqrt:  [[16.51244406  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00072965  0.00623308 -0.32529962]
Stock Position:  0.0007296464599007241
Bond Position:  [10.6163478]


portfolio before change:  [10.688251]
curr_Stock_Price:  96.72639346619412
curr_Factors:  [96.72639347 -0.64849537 -0.77451482]
mat_Sqrt:  [[23.30985228  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00228418 -0.00205109  0.09503174]
Stock Position:  0.0022841750135716974
Bond Position:  [10.46731099]


portfolio before change:  [10.68894768]
curr_Stock_Price:  96.4585454209212
curr_Factors:  [96.45854542 -0.41470489 -0.74736465]
mat_Sqrt:  [[30.17590633  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0013902  -0.03464075 -0.22457068]
Stock Position:  0.0013902029407557492
Bond Position:  [10.55485073]


portfolio before change:  [10.6923753]
curr_Stock_Price:  97.97499727739302
curr_Factors:  [97.97499728 -0.42888326 -0.76988836]
mat_Sqrt:  [[29.54577345  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00410737 -0.0163909   0.17790191]
Stock Position:  0.0041073653409969095
Bond Position:  [10.28995619]


portfolio before change:  [10.69716877]
curr_Stock_Price:  98.82886388074752
curr_Factors:  [98.82886388 -0.66635174 -0.77752062]
mat_Sqrt:  [[23.32480417  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00209457 -0.02607234  0.00275905]
Stock Position:  -0.0020945692270081025
Bond Position:  [10.90417266]


portfolio before change:  [10.69798298]
curr_Stock_Price:  99.09091736644189
curr_Factors:  [99.09091737 -0.6183635  -0.76472928]
mat_Sqrt:  [[24.85216829  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00760292  0.04734023  0.06367795]
Stock Position:  -0.007602923308837208
Bond Position:  [11.45136363]


portfolio before change:  [10.70106638]
curr_Stock_Price:  98.87364707745198
curr_Factors:  [98.87364708 -0.62967209 -0.75679916]
mat_Sqrt:  [[24.71403972  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00201568 -0.04724556 -0.33043259]
Stock Position:  0.002015682778583126
Bond Position:  [10.50176848]


portfolio before change:  [10.70265]
curr_Stock_Price:  99.00800104868665
curr_Factors:  [99.00800105 -0.61189293 -0.7734513 ]
mat_Sqrt:  [[24.77552909  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00162782 -0.04374371 -0.15463167]
Stock Position:  -0.0016278226212570132
Bond Position:  [10.86381747]


portfolio before change:  [10.70431352]
curr_Stock_Price:  98.820354157005
curr_Factors:  [98.82035416 -0.69352407 -0.78809008]
mat_Sqrt:  [[22.45895551  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00165503  0.00672421 -0.19013446]
Stock Position:  -0.0016550307773244089
Bond Position:  [10.86786425]


portfolio before change:  [10.70461803]
curr_Stock_Price:  99.4572377491505
curr_Factors:  [99.45723775 -0.65945822 -0.82427071]
mat_Sqrt:  [[22.55594903  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0011764   0.01500555 -0.00030995]
Stock Position:  -0.0011764015502126104
Bond Position:  [10.82161967]


portfolio before change:  [10.7074056]
curr_Stock_Price:  98.23759912317837
curr_Factors:  [98.23759912 -0.67595181 -0.80120481]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [10.7074056]
Stock Price:  97.94921498899662
PL:  [10.7074056]
Settle:  Tensor("sub_158:0", shape=(), dtype=float64)
PL:  Tensor("sub_159:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  80
output_Z_Vals[:, i, :]:  [[ 1.19260232e+02 -2.92559343e+01 -2.92733494e+01]
 [ 4.35463578e-02  4.88614263e-02 -7.12027548e-02]
 [-5.56493235e-02 -7.78799092e-02 -7.57070950e-02]
 [ 8.52604745e-02  1.72979178e-01  3.79921686e-02]
 [ 5.35347703e-02  2.52977968e-02 -6.98400235e-02]
 [ 6.59434389e-02  2.81340960e-02 -8.18875534e-02]
 [ 7.21679583e-02  1.39391680e-02 -6.87560960e-02]
 [-1.40690384e-01  6.20172444e-02 -8.12221385e-02]
 [-1.49281989e-01 -6.59148268e-02  1.33038157e-01]
 [-4.14982634e-02  7.94598576e-02 -1.80038811e-02]
 [ 5.45402786e-02  9.00276855e-02 -7.79238519e-02]
 [-2.62288077e-02  7.37567446e-02 -7.35930700e-03]
 [-1.05268475e-01  3.60169765e-02 -5.01576103e-02]
 [-1.36816000e-01 -9.03556060e-02  5.10008946e-02]
 [ 2.65869158e-01  3.65672025e-01  7.79239204e-02]
 [-7.69255337e-02 -6.96489301e-02 -1.02955334e-01]
 [-7.32901221e-02 -5.25754656e-02 -5.15074295e-02]
 [-9.54710627e-02 -3.76708262e-02  7.65864779e-02]
 [ 3.12616159e-02  5.64272239e-02  1.77255584e-02]
 [ 2.89283712e-01 -7.88827686e-02 -5.28430365e-02]
 [-5.36482641e-02  5.56420035e-03  1.91009898e-02]
 [ 4.90339070e-02 -3.93088541e-02  4.76264305e-02]
 [-1.04497893e-01  1.97300443e-01  3.40571616e-01]
 [ 1.36082321e-01 -2.40461007e-02 -4.62925194e-03]
 [ 7.04686472e-02  3.14804296e-02  8.61146454e-02]
 [ 1.02084001e-01  3.11743744e-03  5.62610251e-02]
 [-1.16871052e-01  7.37180253e-02  9.38410445e-02]
 [-5.07806065e-02  7.36225950e-02  2.93687317e-02]
 [ 6.14448711e-02 -7.02484335e-02  3.40497746e-02]
 [ 2.03770331e-02 -1.15672172e-03 -7.91103290e-02]
 [-5.81020236e-02  3.85143557e-01  1.00628619e-02]
 [ 1.71982774e-02 -9.01104745e-02 -8.45178878e-02]
 [-6.60716506e-02  2.27031835e-02  8.38011601e-02]
 [-1.18600180e-01 -5.72958750e-02  1.63374083e-02]
 [-1.68299392e-01  1.76769278e-01  3.40776457e-02]
 [ 8.47165236e-02 -1.65012150e-01 -1.38726811e-01]
 [-1.66527721e-01 -2.67477664e-01  2.09469874e-02]
 [-4.32014572e-02 -2.32447576e-02  2.45336237e-02]
 [-4.15177968e-02  8.88031593e-02 -2.24220312e-02]
 [-1.78478612e-01  1.05444958e-01  1.05301910e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.26023247 -29.25593426 -29.27334937]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  8.31486419  -9.25153874 -83.50871763]
init_Out:  [2.49911038]
Stock Position:  8.31486419409362
Bond position:  [-828.98730903]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [2.77377807]
curr_Stock_Price:  100.0454965429622
curr_Factors:  [100.04549654  -1.36082622  -1.0043349 ]
mat_Sqrt:  [[ 9.39769009  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0032214   0.01545134 -0.20312164]
Stock Position:  0.0032214036309710305
Bond Position:  [2.45149114]


portfolio before change:  [2.77480999]
curr_Stock_Price:  100.27069815430958
curr_Factors:  [100.27069815  -1.26381544  -1.00113202]
mat_Sqrt:  [[10.41165711  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0070223  -0.02462779 -0.21597127]
Stock Position:  -0.007022303888873929
Bond Position:  [3.4789413]


portfolio before change:  [2.77903608]
curr_Stock_Price:  99.73081890237566
curr_Factors:  [99.7308189  -1.04759442 -0.96480591]
mat_Sqrt:  [[13.33076354  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00731255 0.05470082 0.10838108]
Stock Position:  0.0073125516234869205
Bond Position:  [2.04974932]


portfolio before change:  [2.77380469]
curr_Stock_Price:  98.98037968554694
curr_Factors:  [98.98037969 -1.09854974 -0.95184323]
mat_Sqrt:  [[12.7372234   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00313506  0.00799987 -0.19923415]
Stock Position:  0.003135057011076114
Bond Position:  [2.46349555]


portfolio before change:  [2.7738187]
curr_Stock_Price:  98.88662056356947
curr_Factors:  [98.88662056 -1.3842098  -0.92635272]
mat_Sqrt:  [[ 9.81008974  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00509217  0.00889678 -0.2336024 ]
Stock Position:  0.005092168633017998
Bond Position:  [2.27027136]


portfolio before change:  [2.7757514]
curr_Stock_Price:  99.21043120194543
curr_Factors:  [99.2104312  -1.2750909  -0.94226951]
mat_Sqrt:  [[10.80363608  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0054142   0.00440795 -0.196142  ]
Stock Position:  0.00541420373049688
Bond Position:  [2.23860592]


portfolio before change:  [2.78134254]
curr_Stock_Price:  100.19142311217543
curr_Factors:  [100.19142311  -1.23997121  -0.99587237]
mat_Sqrt:  [[10.71065465  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01453399  0.01961157 -0.23170415]
Stock Position:  -0.014533986085186898
Bond Position:  [4.23752329]


portfolio before change:  [2.7757273]
curr_Stock_Price:  100.61422225768992
curr_Factors:  [100.61422226  -1.41398956  -0.99276786]
mat_Sqrt:  [[ 9.06604573  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01365839 -0.0208441   0.37952083]
Stock Position:  -0.013658391557126113
Bond Position:  [4.14995575]


portfolio before change:  [2.78076794]
curr_Stock_Price:  100.2831536976803
curr_Factors:  [100.2831537   -1.2608013   -0.96917409]
mat_Sqrt:  [[10.7835555   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00399883  0.02512741 -0.05136006]
Stock Position:  -0.003998833732707817
Bond Position:  [3.1817836]


portfolio before change:  [2.77953239]
curr_Stock_Price:  100.6915989624799
curr_Factors:  [100.69159896  -1.40831635  -0.96465076]
mat_Sqrt:  [[ 9.38483656  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00436434  0.02846925 -0.22229506]
Stock Position:  0.004364342794518134
Bond Position:  [2.34007973]


portfolio before change:  [2.77980976]
curr_Stock_Price:  100.68812662162898
curr_Factors:  [100.68812662  -1.43610405  -0.94728752]
mat_Sqrt:  [[ 9.2871927   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00278089  0.02332393 -0.02099405]
Stock Position:  -0.002780886525709053
Bond Position:  [3.05981202]


portfolio before change:  [2.78157281]
curr_Stock_Price:  100.19168601053143
curr_Factors:  [100.19168601  -1.22596678  -0.9385312 ]
mat_Sqrt:  [[11.50276255  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00996082  0.01138957 -0.1430857 ]
Stock Position:  -0.009960815897812647
Bond Position:  [3.77956375]


portfolio before change:  [2.78603638]
curr_Stock_Price:  99.7910062194756
curr_Factors:  [99.79100622 -1.3627089  -0.94983245]
mat_Sqrt:  [[ 9.8802391   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01302989 -0.02857295  0.14549136]
Stock Position:  -0.013029892896596595
Bond Position:  [4.0863025]


portfolio before change:  [2.78037362]
curr_Stock_Price:  100.26480745282542
curr_Factors:  [100.26480745  -1.24610002  -0.92881838]
mat_Sqrt:  [[11.3918292   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.02556367 0.11563565 0.22229525]
Stock Position:  0.025563666493140326
Bond Position:  [0.21723752]


portfolio before change:  [2.78489018]
curr_Stock_Price:  100.44042408620737
curr_Factors:  [100.44042409  -1.09430103  -0.93638876]
mat_Sqrt:  [[13.18229926  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00756617 -0.02202493 -0.29370291]
Stock Position:  -0.007566171036613215
Bond Position:  [3.54483961]


portfolio before change:  [2.78187882]
curr_Stock_Price:  100.89699556970938
curr_Factors:  [100.89699557  -1.02165044  -0.94732233]
mat_Sqrt:  [[14.08523905  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00604615 -0.01662582 -0.14693636]
Stock Position:  -0.006046154026308473
Bond Position:  [3.39191759]


portfolio before change:  [2.78375619]
curr_Stock_Price:  100.65661882751193
curr_Factors:  [100.65661883  -0.57826383  -0.93423801]
mat_Sqrt:  [[22.18048995  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00364332 -0.01191256  0.2184799 ]
Stock Position:  -0.003643317623850262
Bond Position:  [3.15048022]


portfolio before change:  [2.7837449]
curr_Stock_Price:  100.76781425378996
curr_Factors:  [100.76781425  -0.47045238  -0.89699605]
mat_Sqrt:  [[25.67122114  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00141547 0.01784385 0.05056608]
Stock Position:  0.0014154673376968732
Bond Position:  [2.64111135]


portfolio before change:  [2.78526975]
curr_Stock_Price:  101.61184169562033
curr_Factors:  [101.6118417   -0.47123442  -0.89276153]
mat_Sqrt:  [[25.97576877  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01064301 -0.02494492 -0.15074647]
Stock Position:  0.010643012353404337
Bond Position:  [1.70381367]


portfolio before change:  [2.78222822]
curr_Stock_Price:  101.30605224042887
curr_Factors:  [101.30605224  -0.59774202  -0.86513763]
mat_Sqrt:  [[23.4592883   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00211454  0.00175955  0.05448981]
Stock Position:  -0.0021145408688745546
Bond Position:  [2.99644401]


portfolio before change:  [2.78142298]
curr_Stock_Price:  101.86401087831965
curr_Factors:  [101.86401088  -0.82953352  -0.84830765]
mat_Sqrt:  [[19.02583     0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00303486 -0.01243055  0.13586495]
Stock Position:  0.0030348563592573112
Bond Position:  [2.47228033]


portfolio before change:  [2.78325453]
curr_Stock_Price:  102.3656805293576
curr_Factors:  [102.36568053  -0.6085662   -0.86150778]
mat_Sqrt:  [[23.53473754  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00126981  0.06239188  0.97155602]
Stock Position:  -0.0012698135126892234
Bond Position:  [2.91323985]


portfolio before change:  [2.78260579]
curr_Stock_Price:  103.16336890546006
curr_Factors:  [103.16336891  -0.6736234   -0.85451304]
mat_Sqrt:  [[22.38021698  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00601051 -0.00760404 -0.01320597]
Stock Position:  0.006010509693396966
Bond Position:  [2.16254136]


portfolio before change:  [2.78291233]
curr_Stock_Price:  103.16939299391943
curr_Factors:  [103.16939299  -0.73750108  -0.88927048]
mat_Sqrt:  [[20.2793002   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00438179 0.00995499 0.24566111]
Stock Position:  0.004381785659333425
Bond Position:  [2.33084616]


portfolio before change:  [2.79080726]
curr_Stock_Price:  104.90465834931062
curr_Factors:  [104.90465835  -0.818708    -0.89235737]
mat_Sqrt:  [[18.9534609   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.0059962  0.00098582 0.16049704]
Stock Position:  0.005996199168984178
Bond Position:  [2.16177804]


portfolio before change:  [2.79547488]
curr_Stock_Price:  105.6380195585803
curr_Factors:  [105.63801956  -0.54927729  -0.86676145]
mat_Sqrt:  [[25.63553825  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00373748  0.02331169  0.26770238]
Stock Position:  -0.003737484915200866
Bond Position:  [3.19029539]


portfolio before change:  [2.79701874]
curr_Stock_Price:  105.33165177440802
curr_Factors:  [105.33165177  -0.60088981  -0.8730424 ]
mat_Sqrt:  [[24.12338628  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00177773  0.02328151  0.08378082]
Stock Position:  -0.001777727700183141
Bond Position:  [2.98426974]


portfolio before change:  [2.79722026]
curr_Stock_Price:  105.42814462614152
curr_Factors:  [105.42814463  -0.72683561  -0.88242412]
mat_Sqrt:  [[21.08938632  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00315711 -0.02221451  0.09713453]
Stock Position:  0.003157106827564564
Bond Position:  [2.46437234]


portfolio before change:  [2.7918441]
curr_Stock_Price:  103.62769033999452
curr_Factors:  [103.62769034  -0.52241808  -0.87531074]
mat_Sqrt:  [[25.61237806  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 1.63937856e-04 -3.65787525e-04 -2.25679749e-01]
Stock Position:  0.00016393785613999203
Bond Position:  [2.7748556]


portfolio before change:  [2.7921321]
curr_Stock_Price:  103.26852504359718
curr_Factors:  [103.26852504  -0.2898623   -0.88009228]
mat_Sqrt:  [[32.05259229  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00143837  0.12179309  0.02870654]
Stock Position:  -0.0014383731024893735
Bond Position:  [2.94067077]


portfolio before change:  [2.79506215]
curr_Stock_Price:  101.48703639338024
curr_Factors:  [101.48703639  -0.41280217  -0.89846225]
mat_Sqrt:  [[27.34863579  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-8.70429755e-05 -2.84954341e-02 -2.41106009e-01]
Stock Position:  -8.704297551957334e-05
Bond Position:  [2.80389588]


portfolio before change:  [2.79508588]
curr_Stock_Price:  105.24122100204247
curr_Factors:  [105.241221    -0.41044469  -0.88308276]
mat_Sqrt:  [[28.86782374  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0016759   0.00717938  0.23906138]
Stock Position:  -0.0016759010726788734
Bond Position:  [2.97145976]


portfolio before change:  [2.79481764]
curr_Stock_Price:  105.6229265522325
curr_Factors:  [105.62292655  -0.39026479  -0.86647767]
mat_Sqrt:  [[30.05812462  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00388396 -0.01811855  0.04660608]
Stock Position:  -0.003883964662578138
Bond Position:  [3.20505335]


portfolio before change:  [2.7976547]
curr_Stock_Price:  104.99562710842591
curr_Factors:  [104.99562711  -0.24590349  -0.87595402]
mat_Sqrt:  [[34.19437599  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00458494  0.05589935  0.09721404]
Stock Position:  -0.004584939883392589
Bond Position:  [3.27905334]


portfolio before change:  [2.80477523]
curr_Stock_Price:  103.5320049119523
curr_Factors:  [103.53200491  -0.45492378  -0.87400984]
mat_Sqrt:  [[27.41107631  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00190209 -0.05218142 -0.39574898]
Stock Position:  0.0019020937332187358
Bond Position:  [2.60784765]


portfolio before change:  [2.80549189]
curr_Stock_Price:  103.73738691773272
curr_Factors:  [103.73738692  -0.44842772  -0.90495015]
mat_Sqrt:  [[26.80221957  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00631135 -0.08458386  0.05975592]
Stock Position:  -0.006311349633694482
Bond Position:  [3.46021481]


portfolio before change:  [2.80991836]
curr_Stock_Price:  103.10457088806851
curr_Factors:  [103.10457089  -0.5524895   -0.86799175]
mat_Sqrt:  [[24.9098294   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00155737 -0.00735064  0.0699876 ]
Stock Position:  -0.0015573663189784959
Bond Position:  [2.97048995]


portfolio before change:  [2.81074495]
curr_Stock_Price:  102.81224791103949
curr_Factors:  [102.81224791  -0.6711542   -0.86049773]
mat_Sqrt:  [[22.22577297  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00197077  0.02808202 -0.06396381]
Stock Position:  -0.0019707655190421697
Bond Position:  [3.01336379]


portfolio before change:  [2.81084801]
curr_Stock_Price:  102.95109680052813
curr_Factors:  [102.9510968   -0.85059056  -0.85129275]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [2.81084801]
Stock Price:  103.34423522441337
PL:  [-0.53338722]
Settle:  Tensor("sub_160:0", shape=(), dtype=float64)
PL:  Tensor("sub_161:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  81
output_Z_Vals[:, i, :]:  [[ 1.19260232e+02 -2.92559343e+01 -2.92733494e+01]
 [ 4.30803276e-02  5.30335616e-02 -6.90274178e-02]
 [-9.11189861e-02 -6.06613006e-02  8.91065443e-02]
 [-2.19189936e-01 -1.07516477e-01 -1.71216070e-02]
 [-3.81049411e-02  5.46371932e-02 -8.99297378e-02]
 [ 5.55434463e-02  2.88964322e-02  3.34794886e-02]
 [-1.02026137e-02  2.58410984e-02  6.40620306e-02]
 [-9.84989345e-02 -2.47721131e-02 -1.06751606e-01]
 [ 6.90076828e-02  8.95572527e-04 -7.09836296e-02]
 [-2.80833822e-02  3.50933599e-01  1.40537638e-01]
 [ 5.94934207e-02  1.35999752e-01 -8.62358162e-02]
 [-4.70727553e-02 -1.05508088e-01 -1.59134727e-02]
 [ 8.02622636e-03 -1.56221542e-01  7.87851395e-03]
 [-8.43159048e-02 -1.08506045e-01  7.40538310e-02]
 [ 6.72128502e-02 -1.32921817e-01 -2.31356657e-01]
 [-7.30048359e-02 -1.09584618e-01 -1.27592250e-01]
 [-7.93264939e-02 -1.95232948e-02 -5.34530516e-02]
 [ 1.76129728e-02 -2.25848649e-01 -7.42261529e-02]
 [ 4.44318682e-02  5.13577891e-02  3.38522432e-02]
 [ 1.10814705e-01 -2.76394318e-01 -7.08745931e-03]
 [ 4.36617572e-01 -4.84725776e-03  6.31361584e-01]
 [-1.34135270e-01  8.71930906e-02 -1.30797748e-01]
 [-2.65144024e-01  8.57551172e-01  3.75620024e-01]
 [ 4.71555123e-01 -5.55529872e-02  1.55771686e-01]
 [-2.71895531e-01 -1.18139360e-01 -2.81873858e-01]
 [ 1.10202453e-01 -1.45260349e-02  5.67024738e-02]
 [-1.28535062e-01  7.23302012e-02  9.28813566e-02]
 [-5.07806065e-02  7.36225950e-02  2.93687317e-02]
 [ 6.20848838e-02 -6.23725319e-02  9.08311027e-02]
 [-2.37397412e-02 -5.16490727e-02 -8.02978632e-02]
 [-1.15542217e-01  5.76983717e-01 -9.40461274e-03]
 [ 5.16124371e-02  5.04618894e-02  1.49942159e-01]
 [-6.60716506e-02  2.27031835e-02  8.38011601e-02]
 [-2.31356936e-01 -1.84121018e-02  3.32026994e-02]
 [-1.31856152e-01  6.80729824e-02  3.57839438e-02]
 [ 8.47165236e-02 -1.65012150e-01 -1.38726811e-01]
 [-1.97961213e-01 -3.32534144e-01  5.20131165e-02]
 [-5.54327327e-02 -5.11348767e-02  8.28839294e-02]
 [-2.92681798e-02  6.31143032e-02 -3.01081111e-02]
 [ 1.24298108e-01 -6.39149947e-03 -1.16542013e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.26023247 -29.25593426 -29.27334937]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  8.31486419  -9.25153874 -83.50871763]
init_Out:  [2.49911038]
Stock Position:  8.31486419409362
Bond position:  [-828.98730903]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-7.27504814]
curr_Stock_Price:  98.83695892064567
curr_Factors:  [98.83695892 -0.61565443 -0.99294764]
mat_Sqrt:  [[19.78392117  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00153455  0.01677068 -0.19691601]
Stock Position:  0.0015345535071484486
Bond Position:  [-7.42671874]


portfolio before change:  [-7.27767326]
curr_Stock_Price:  97.73127876077476
curr_Factors:  [97.73127876 -0.43358708 -1.00716616]
mat_Sqrt:  [[23.13781796  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00321968 -0.01918279  0.25419617]
Stock Position:  -0.003219683770158968
Bond Position:  [-6.96300945]


portfolio before change:  [-7.27988717]
curr_Stock_Price:  98.148549379954
curr_Factors:  [98.14854938 -0.47807859 -0.98862923]
mat_Sqrt:  [[22.64126954  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00995796 -0.0339997  -0.04884318]
Stock Position:  -0.009957963378519398
Bond Position:  [-6.30252751]


portfolio before change:  [-7.27290182]
curr_Stock_Price:  97.36794611603966
curr_Factors:  [97.36794612 -0.46492991 -0.99642525]
mat_Sqrt:  [[22.58174654  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00243786  0.0172778  -0.25654451]
Stock Position:  -0.00243785597421445
Bond Position:  [-7.03553279]


portfolio before change:  [-7.2745566]
curr_Stock_Price:  97.68596565403843
curr_Factors:  [97.68596565 -0.53113353 -0.98154838]
mat_Sqrt:  [[21.52200694  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00293298 0.00913785 0.09550766]
Stock Position:  0.0029329755904250955
Bond Position:  [-7.56106715]


portfolio before change:  [-7.2771023]
curr_Stock_Price:  97.14026967149141
curr_Factors:  [97.14026967 -0.47904044 -0.98223253]
mat_Sqrt:  [[22.53079497  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [1.57171899e-04 8.17167281e-03 1.82751142e-01]
Stock Position:  0.00015717189913392915
Bond Position:  [-7.29237003]


portfolio before change:  [-7.27771575]
curr_Stock_Price:  99.0372758856628
curr_Factors:  [99.03727589 -0.50488111 -0.98660391]
mat_Sqrt:  [[22.28717244  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00542595 -0.00783363 -0.30453262]
Stock Position:  -0.005425952004995976
Bond Position:  [-6.74034425]


portfolio before change:  [-7.2859945]
curr_Stock_Price:  100.40775479496347
curr_Factors:  [100.40775479  -0.60913884  -1.02871237]
mat_Sqrt:  [[19.51899769  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00279427  0.0002832  -0.20249654]
Stock Position:  0.002794269178619276
Bond Position:  [-7.56656079]


portfolio before change:  [-7.28369734]
curr_Stock_Price:  101.56835773897134
curr_Factors:  [101.56835774  -0.40476517  -1.03982318]
mat_Sqrt:  [[23.95420064  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00040347 0.11097495 0.40091476]
Stock Position:  0.0004034703397291504
Bond Position:  [-7.32467716]


portfolio before change:  [-7.28526672]
curr_Stock_Price:  99.94808142651938
curr_Factors:  [99.94808143 -0.26497675 -1.0350344 ]
mat_Sqrt:  [[27.23872589  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00166682  0.0430069  -0.24600678]
Stock Position:  0.0016668219758350815
Bond Position:  [-7.45186238]


portfolio before change:  [-7.28713462]
curr_Stock_Price:  99.38631604673463
curr_Factors:  [99.38631605 -0.14680118 -1.02323499]
mat_Sqrt:  [[30.84511134  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00171973 -0.03336459 -0.04539671]
Stock Position:  -0.0017197307482291816
Bond Position:  [-7.11621692]


portfolio before change:  [-7.29273595]
curr_Stock_Price:  102.12613224813038
curr_Factors:  [ 1.02126132e+02  8.35286319e-03 -1.00661878e+00]
mat_Sqrt:  [[37.63531063  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00014882 -0.04940159  0.02247521]
Stock Position:  0.00014881764829409235
Bond Position:  [-7.30793412]


portfolio before change:  [-7.29408949]
curr_Stock_Price:  99.16958482284917
curr_Factors:  [99.16958482  0.21905517 -0.97904674]
mat_Sqrt:  [[46.37867644  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00155247 -0.03431262  0.21125497]
Stock Position:  -0.0015524665519112211
Bond Position:  [-7.14013202]


portfolio before change:  [-7.29917645]
curr_Stock_Price:  101.87134317444635
curr_Factors:  [ 1.01871343e+02  8.16338056e-02 -9.94387213e-01]
mat_Sqrt:  [[40.8929333   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 4.04846084e-04 -4.20335691e-02 -6.59996144e-01]
Stock Position:  0.0004048460840574245
Bond Position:  [-7.34041866]


portfolio before change:  [-7.29981944]
curr_Stock_Price:  102.5496782274581
curr_Factors:  [102.54967823  -0.17013886  -0.99198328]
mat_Sqrt:  [[32.07975705  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0031758  -0.0346537  -0.36398517]
Stock Position:  -0.00317580203148851
Bond Position:  [-6.97414196]


portfolio before change:  [-7.30169181]
curr_Stock_Price:  102.86473291158457
curr_Factors:  [102.86473291  -0.12678156  -0.94785766]
mat_Sqrt:  [[35.12017091  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00258375 -0.00617381 -0.15248668]
Stock Position:  -0.002583747155844236
Bond Position:  [-7.03591535]


portfolio before change:  [-7.30466063]
curr_Stock_Price:  103.67335492557014
curr_Factors:  [103.67335493  -0.30461573  -0.94505767]
mat_Sqrt:  [[29.71261616  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-1.13411900e-04 -7.14196136e-02 -2.11746554e-01]
Stock Position:  -0.00011341189968606534
Bond Position:  [-7.29290284]


portfolio before change:  [-7.30568596]
curr_Stock_Price:  104.67553532456199
curr_Factors:  [104.67553532  -0.373218    -0.9433924 ]
mat_Sqrt:  [[28.0574733   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00187715 0.01624076 0.09657103]
Stock Position:  0.0018771462500784734
Bond Position:  [-7.50217725]


portfolio before change:  [-7.30269239]
curr_Stock_Price:  106.76988428225458
curr_Factors:  [106.76988428  -0.29241528  -0.93732652]
mat_Sqrt:  [[31.21610343  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00327496 -0.08740356 -0.02021855]
Stock Position:  0.0032749607230318054
Bond Position:  [-7.65235957]


portfolio before change:  [-7.29904945]
curr_Stock_Price:  108.17434137106949
curr_Factors:  [108.17434137  -0.396267    -0.93434708]
mat_Sqrt:  [[28.59209027  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 1.97736001e-02 -1.53283749e-03  1.80109886e+00]
Stock Position:  0.019773600128377308
Bond Position:  [-9.43804562]


portfolio before change:  [-7.26781485]
curr_Stock_Price:  109.81361970115974
curr_Factors:  [109.8136197   -0.39446183  -0.94071279]
mat_Sqrt:  [[28.89330603  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00548857  0.02757288 -0.37312957]
Stock Position:  -0.005488570011790864
Bond Position:  [-6.66509511]


portfolio before change:  [-7.26883581]
curr_Stock_Price:  109.84783173435629
curr_Factors:  [109.84783173  -0.44516764  -0.95737344]
mat_Sqrt:  [[27.01939598  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00615591  0.27118149  1.07153937]
Stock Position:  -0.006155912294231968
Bond Position:  [-6.59262219]


portfolio before change:  [-7.2628868]
curr_Stock_Price:  108.74756558371497
curr_Factors:  [108.74756558  -0.18802501  -0.93004984]
mat_Sqrt:  [[35.55050758  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01411843 -0.0175674   0.44437326]
Stock Position:  0.01411843451447753
Bond Position:  [-8.79823218]


portfolio before change:  [-7.27188478]
curr_Stock_Price:  108.18814567994293
curr_Factors:  [108.18814568  -0.36339105  -0.91006635]
mat_Sqrt:  [[30.27778884  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01098109 -0.03735895 -0.80410766]
Stock Position:  -0.010981090402603925
Bond Position:  [-6.08386097]


portfolio before change:  [-7.26817348]
curr_Stock_Price:  107.78091532095446
curr_Factors:  [ 1.07780915e+02 -8.90872197e-02 -9.31096686e-01]
mat_Sqrt:  [[38.85810581  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00312423 -0.00459354  0.16175637]
Stock Position:  0.003124231975662057
Bond Position:  [-7.60490606]


portfolio before change:  [-7.27722012]
curr_Stock_Price:  105.18956837265617
curr_Factors:  [105.18956837  -0.26243318  -0.93751437]
mat_Sqrt:  [[31.68415112  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00339943  0.02287282  0.26496466]
Stock Position:  -0.003399433886342785
Bond Position:  [-6.91963513]


portfolio before change:  [-7.27477118]
curr_Stock_Price:  104.21471535802443
curr_Factors:  [104.21471536  -0.28661491  -0.94067182]
mat_Sqrt:  [[30.54394964  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00140404  0.02328151  0.08378082]
Stock Position:  -0.0014040362334671419
Bond Position:  [-7.12844994]


portfolio before change:  [-7.27538317]
curr_Stock_Price:  104.01592031663448
curr_Factors:  [104.01592032  -0.30254697  -0.95552266]
mat_Sqrt:  [[29.56154425  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00267291 -0.01972393  0.25911585]
Stock Position:  0.0026729068177483188
Bond Position:  [-7.55340804]


portfolio before change:  [-7.27393011]
curr_Stock_Price:  104.9128072091993
curr_Factors:  [104.91280721  -0.34861443  -0.95494802]
mat_Sqrt:  [[28.49039877  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00145537 -0.01633287 -0.22906745]
Stock Position:  -0.0014553691409019977
Bond Position:  [-7.12124325]


portfolio before change:  [-7.27611656]
curr_Stock_Price:  105.80346478011431
curr_Factors:  [105.80346478  -0.28363835  -0.96526   ]
mat_Sqrt:  [[30.34661301  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00337976  0.18245827 -0.02682874]
Stock Position:  -0.003379760048896287
Bond Position:  [-6.91852624]


portfolio before change:  [-7.28390694]
curr_Stock_Price:  107.85257620387245
curr_Factors:  [107.8525762   -0.71934598  -0.9848477 ]
mat_Sqrt:  [[19.62043425  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.0042569  0.01595745 0.42774324]
Stock Position:  0.004256897240643377
Bond Position:  [-7.74302427]


portfolio before change:  [-7.28616482]
curr_Stock_Price:  107.5495523835054
curr_Factors:  [107.54955238  -0.85996262  -0.94935942]
mat_Sqrt:  [[17.61286607  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00274683  0.00717938  0.23906138]
Stock Position:  -0.0027468338532387034
Bond Position:  [-6.99074406]


portfolio before change:  [-7.28606457]
curr_Stock_Price:  107.19491123176618
curr_Factors:  [107.19491123  -0.71616107  -0.97585726]
mat_Sqrt:  [[19.73967255  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01140114 -0.00582242  0.09471806]
Stock Position:  -0.01140114462472036
Bond Position:  [-6.06391989]


portfolio before change:  [-7.27768382]
curr_Stock_Price:  106.39334379434153
curr_Factors:  [106.39334379  -0.66343743  -0.99963601]
mat_Sqrt:  [[20.16744298  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00608873  0.02152657  0.10208163]
Stock Position:  -0.006088731620779664
Bond Position:  [-6.62988331]


portfolio before change:  [-7.27338303]
curr_Stock_Price:  105.55087265202053
curr_Factors:  [105.55087265  -0.6601074   -0.98413639]
mat_Sqrt:  [[20.38805625  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0025573  -0.05218142 -0.39574898]
Stock Position:  0.0025573029536183627
Bond Position:  [-7.54330859]


portfolio before change:  [-7.27472047]
curr_Stock_Price:  105.39662318638517
curr_Factors:  [105.39662319  -0.4009456   -0.9641914 ]
mat_Sqrt:  [[26.91257359  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00728024 -0.10515653  0.14837894]
Stock Position:  -0.007280242985972581
Bond Position:  [-6.50740744]


portfolio before change:  [-7.27963104]
curr_Stock_Price:  105.95939257792625
curr_Factors:  [105.95939258  -0.47453984  -0.98021622]
mat_Sqrt:  [[24.73699431  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00161032 -0.01617027  0.23644478]
Stock Position:  -0.0016103176400799014
Bond Position:  [-7.10900276]


portfolio before change:  [-7.28059795]
curr_Stock_Price:  106.00797445305751
curr_Factors:  [106.00797445  -0.74167068  -0.98547521]
mat_Sqrt:  [[18.8472768   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00179253  0.0199585  -0.08589006]
Stock Position:  -0.0017925331225266729
Bond Position:  [-7.09057515]


portfolio before change:  [-7.28063204]
curr_Stock_Price:  105.53250859551362
curr_Factors:  [105.5325086   -0.73088972  -0.99563617]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-7.28063204]
Stock Price:  105.92805916626753
PL:  [-13.20869121]
Settle:  Tensor("sub_162:0", shape=(), dtype=float64)
PL:  Tensor("sub_163:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  82
output_Z_Vals[:, i, :]:  [[ 1.19260232e+02 -2.92559343e+01 -2.92733494e+01]
 [-7.16575738e-03 -5.34797143e-02 -2.42423957e-02]
 [-5.53262088e-02 -7.01932506e-02 -5.43472618e-02]
 [ 8.37652738e-02  1.59383274e-01  3.78105284e-02]
 [ 2.21493281e-01 -2.53313486e-02 -4.92621216e-02]
 [ 2.05397685e-02  3.01670962e-02  7.80767021e-02]
 [ 3.24754845e-02  4.97436141e-02 -3.04135405e-02]
 [ 1.24957317e-01  2.24756296e-01  1.29581882e-01]
 [ 5.64504579e-02  5.50662383e-02  4.43012670e-02]
 [-3.76677155e-02  2.40153422e-01  9.01009699e-02]
 [ 3.15475033e-02 -8.13846800e-02 -4.13809310e-02]
 [-8.85209014e-02  1.07227077e-01  3.10824589e-02]
 [-8.70849196e-02 -1.22116788e-02 -5.78861549e-02]
 [ 2.26711047e-01  1.91435879e-01  2.80080637e-01]
 [ 2.32086423e-01  3.85173466e-01  1.43945010e-01]
 [-5.92446062e-02 -4.74240758e-02 -1.09082049e-01]
 [-8.44046010e-02  4.67924219e-03 -9.94314053e-02]
 [ 3.96723449e-02 -3.70726766e-03 -2.72354460e-02]
 [ 1.94099565e-02  6.93769047e-02  2.43673274e-02]
 [ 3.57352424e-01 -1.34970684e-01 -8.01046949e-02]
 [ 8.46303088e-02  3.66402777e-03  1.35002406e-01]
 [ 1.33315282e-02 -1.46517562e-02  1.28489221e-02]
 [-7.51946363e-02  1.17221107e-01  1.30133628e-01]
 [ 1.14392034e-01 -4.36675684e-02  1.62594548e-02]
 [ 6.78367663e-02  3.20021761e-02  8.45429945e-02]
 [ 9.55142676e-02  1.60662993e-03  5.76993379e-02]
 [-1.54460383e-01  7.28791906e-02  8.08797418e-02]
 [-4.61816677e-02  7.00191722e-02  2.80119969e-02]
 [ 6.20848838e-02 -6.23725319e-02  9.08311027e-02]
 [ 3.92406482e-02  3.52010589e-03 -1.27778798e-02]
 [-2.42205388e-02  2.91157620e-01  1.63923613e-02]
 [ 2.81330681e-02 -1.30278795e-01 -6.42623369e-02]
 [ 1.38095242e-01 -1.23481987e-01 -3.96305970e-02]
 [-9.87864482e-02 -5.57626937e-02  2.15872617e-02]
 [-1.29763154e-01  6.18303695e-02  3.58819394e-02]
 [ 9.18475829e-02 -1.61997326e-01 -1.35081170e-01]
 [-2.33358550e-01 -4.03376248e-01  8.58691838e-02]
 [-5.18754436e-02 -4.46218702e-02  6.61200923e-02]
 [-3.28281624e-02  7.05799962e-02 -2.78743833e-02]
 [ 1.62103744e-01 -9.31064907e-03 -1.56803865e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.26023247 -29.25593426 -29.27334937]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  8.31486419  -9.25153874 -83.50871763]
init_Out:  [2.49911038]
Stock Position:  8.31486419409362
Bond position:  [-828.98730903]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [4.60410566]
curr_Stock_Price:  100.26562372157284
curr_Factors:  [100.26562372  -1.05317717  -1.00879201]
mat_Sqrt:  [[12.75411191  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00105809 -0.01691177 -0.06915681]
Stock Position:  -0.0010580945238852198
Bond Position:  [4.71019617]


portfolio before change:  [4.60436285]
curr_Stock_Price:  100.57904233725044
curr_Factors:  [100.57904234  -1.01479336  -1.022352  ]
mat_Sqrt:  [[13.11555008  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00520239 -0.02219705 -0.15503761]
Stock Position:  -0.00520238789859321
Bond Position:  [5.12761404]


portfolio before change:  [4.6023584]
curr_Stock_Price:  101.08754653439858
curr_Factors:  [101.08754653  -1.03544489  -1.03236131]
mat_Sqrt:  [[12.78382539  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00747809 0.05040142 0.10786291]
Stock Position:  0.0074780882198658225
Bond Position:  [3.84641681]


portfolio before change:  [4.60274148]
curr_Stock_Price:  101.0744744180768
curr_Factors:  [101.07447442  -0.84778929  -1.04810155]
mat_Sqrt:  [[15.17981792  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01388578 -0.00801048 -0.14053112]
Stock Position:  0.013885781842139509
Bond Position:  [3.19924338]


portfolio before change:  [4.60965061]
curr_Stock_Price:  101.54324163395206
curr_Factors:  [101.54324163  -0.83965828  -1.05854005]
mat_Sqrt:  [[15.21507034  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00244863 0.00953967 0.2227311 ]
Stock Position:  0.002448626187446664
Bond Position:  [4.36100917]


portfolio before change:  [4.60947527]
curr_Stock_Price:  101.24899507618444
curr_Factors:  [101.24899508  -0.79593234  -1.05423781]
mat_Sqrt:  [[15.91739652  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00173092  0.01573031 -0.08676137]
Stock Position:  0.0017309188183350348
Bond Position:  [4.43422148]


portfolio before change:  [4.61126546]
curr_Stock_Price:  101.96299692325765
curr_Factors:  [101.96299692  -0.71877201  -1.06090957]
mat_Sqrt:  [[17.20032697  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00914002 0.07107418 0.36966104]
Stock Position:  0.009140017573967978
Bond Position:  [3.67932188]


portfolio before change:  [4.62553259]
curr_Stock_Price:  103.47362694094916
curr_Factors:  [103.47362694  -0.64157568  -1.09947936]
mat_Sqrt:  [[18.14258121  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.0036883  0.01741347 0.12637918]
Stock Position:  0.0036882965817954484
Bond Position:  [4.24389117]


portfolio before change:  [4.62566007]
curr_Stock_Price:  103.3643522272637
curr_Factors:  [103.36435223  -0.88904754  -1.11241716]
mat_Sqrt:  [[13.96836939  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00093606  0.07594318  0.25703299]
Stock Position:  -0.0009360575333262687
Bond Position:  [4.72241505]


portfolio before change:  [4.62654406]
curr_Stock_Price:  103.05064849265561
curr_Factors:  [103.05064849  -1.36758317  -1.08139946]
mat_Sqrt:  [[ 8.9016617   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00235903 -0.0257361  -0.11804828]
Stock Position:  0.002359032890964578
Bond Position:  [4.38344419]


portfolio before change:  [4.62685322]
curr_Stock_Price:  102.9494211818033
curr_Factors:  [102.94942118  -1.40279005  -1.09264561]
mat_Sqrt:  [[ 8.48926263  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00935389  0.03390818  0.0886696 ]
Stock Position:  -0.009353890121676582
Bond Position:  [5.5898308]


portfolio before change:  [4.62878583]
curr_Stock_Price:  102.81751461106941
curr_Factors:  [102.81751461  -1.52746785  -1.05344969]
mat_Sqrt:  [[ 7.78374959  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01274658 -0.00386167 -0.16513309]
Stock Position:  -0.012746579844064701
Bond Position:  [5.93935749]


portfolio before change:  [4.63164642]
curr_Stock_Price:  102.651342736941
curr_Factors:  [102.65134274  -1.52432161  -1.04216393]
mat_Sqrt:  [[ 7.88413633  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.0366337  0.06053734 0.7989921 ]
Stock Position:  0.03663370450965595
Bond Position:  [0.87114747]


portfolio before change:  [4.64865769]
curr_Stock_Price:  103.11273113414732
curr_Factors:  [103.11273113  -1.59104437  -1.05547494]
mat_Sqrt:  [[ 7.31044068  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.03712693 0.12180254 0.41063505]
Stock Position:  0.03712692887277798
Bond Position:  [0.82039866]


portfolio before change:  [4.64713468]
curr_Stock_Price:  103.06894702782698
curr_Factors:  [103.06894703  -1.82722951  -1.06321138]
mat_Sqrt:  [[ 5.72565675  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01444994 -0.01499681 -0.31118072]
Stock Position:  -0.014449935495952136
Bond Position:  [6.13647431]


portfolio before change:  [4.6451184]
curr_Stock_Price:  103.26156935635666
curr_Factors:  [103.26156936  -1.69446534  -1.06489484]
mat_Sqrt:  [[ 6.53979025  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01599136  0.00147971 -0.28365012]
Stock Position:  -0.01599135906899205
Bond Position:  [6.29641124]


portfolio before change:  [4.64499667]
curr_Stock_Price:  103.31840215634338
curr_Factors:  [103.31840216  -1.68739812  -1.08003139]
mat_Sqrt:  [[ 6.49080134  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00524083 -0.00117234 -0.07769515]
Stock Position:  0.005240833872281355
Bond Position:  [4.10352209]


portfolio before change:  [4.64621359]
curr_Stock_Price:  103.45272218842128
curr_Factors:  [103.45272219  -1.46822114  -1.08633597]
mat_Sqrt:  [[ 8.04103347  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00325521 0.0219389  0.0695132 ]
Stock Position:  0.003255205996440152
Bond Position:  [4.30945367]


portfolio before change:  [4.64623476]
curr_Stock_Price:  103.29373217539224
curr_Factors:  [103.29373218  -1.6168602   -1.07296479]
mat_Sqrt:  [[ 7.01290281  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.04812789 -0.04268148 -0.2285164 ]
Stock Position:  0.04812788697359384
Bond Position:  [-0.32507431]


portfolio before change:  [4.68257865]
curr_Stock_Price:  104.04972882866339
curr_Factors:  [104.04972883  -1.27550761  -1.0754086 ]
mat_Sqrt:  [[ 9.91404789  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01132556 0.00115867 0.38512429]
Stock Position:  0.01132556201712991
Bond Position:  [3.50415699]


portfolio before change:  [4.68304064]
curr_Stock_Price:  104.05184281503779
curr_Factors:  [104.05184282  -1.45060843  -1.03836129]
mat_Sqrt:  [[ 8.63582758  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00180365 -0.00463329  0.0366544 ]
Stock Position:  0.0018036484214510372
Bond Position:  [4.49536769]


portfolio before change:  [4.6831246]
curr_Stock_Price:  103.7868275510798
curr_Factors:  [103.78682755  -1.44206082  -1.04934639]
mat_Sqrt:  [[ 8.5928619   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00530726  0.03706857  0.37123502]
Stock Position:  -0.005307263778446719
Bond Position:  [5.23394867]


portfolio before change:  [4.68377406]
curr_Stock_Price:  103.78773549693395
curr_Factors:  [103.7877355   -1.31951051  -1.09302071]
mat_Sqrt:  [[ 9.29816059  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01253834 -0.0138089   0.0463837 ]
Stock Position:  0.012538338986493773
Bond Position:  [3.38244825]


portfolio before change:  [4.68082761]
curr_Stock_Price:  103.51901678084857
curr_Factors:  [103.51901678  -1.27521108  -1.08865493]
mat_Sqrt:  [[ 9.73657411  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00882449 0.01011998 0.24117763]
Stock Position:  0.008824492512327111
Bond Position:  [3.76732482]


portfolio before change:  [4.67886735]
curr_Stock_Price:  103.24351048322637
curr_Factors:  [103.24351048  -1.18196247  -1.13040533]
mat_Sqrt:  [[10.2238434   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01049836 0.00050806 0.16460015]
Stock Position:  0.010498359019073669
Bond Position:  [3.59497991]


portfolio before change:  [4.68307936]
curr_Stock_Price:  103.60191021979072
curr_Factors:  [103.60191022  -1.0179954   -1.14714797]
mat_Sqrt:  [[11.88660807  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01144726  0.02304642  0.23072739]
Stock Position:  -0.011447264169569017
Bond Position:  [5.8690378]


portfolio before change:  [4.67760269]
curr_Stock_Price:  104.14442843581655
curr_Factors:  [104.14442844  -1.11529111  -1.16484839]
mat_Sqrt:  [[10.65084442  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00362937  0.02214201  0.07991043]
Stock Position:  -0.003629370030850535
Bond Position:  [5.05558135]


portfolio before change:  [4.68039566]
curr_Stock_Price:  103.5490117609067
curr_Factors:  [103.54901176  -1.0275358   -1.15362187]
mat_Sqrt:  [[11.69179566  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00675818 -0.01972393  0.25911585]
Stock Position:  0.006758179450449174
Bond Position:  [3.98059286]


portfolio before change:  [4.68151312]
curr_Stock_Price:  103.64073055888295
curr_Factors:  [103.64073056  -0.82405932  -1.14150922]
mat_Sqrt:  [[14.5176023   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00252957  0.00111316 -0.03645173]
Stock Position:  0.002529568062916235
Bond Position:  [4.41934684]


portfolio before change:  [4.68226436]
curr_Stock_Price:  103.71931452783245
curr_Factors:  [103.71931453  -1.12617275  -1.13714627]
mat_Sqrt:  [[10.78729796  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0012382   0.09207212  0.04676284]
Stock Position:  -0.0012381974303175283
Bond Position:  [4.81068934]


portfolio before change:  [4.68216738]
curr_Stock_Price:  104.28331559784665
curr_Factors:  [104.2833156   -0.88787229  -1.1484308 ]
mat_Sqrt:  [[13.61004725  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00085612 -0.04119777 -0.18332256]
Stock Position:  0.0008561167552835308
Bond Position:  [4.59288869]


portfolio before change:  [4.68291614]
curr_Stock_Price:  104.48726775800415
curr_Factors:  [104.48726776  -1.09089941  -1.18929265]
mat_Sqrt:  [[10.68534482  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01186835 -0.03904843 -0.11305506]
Stock Position:  0.01186834783725386
Bond Position:  [3.4428249]


portfolio before change:  [4.69350708]
curr_Stock_Price:  105.34337317357675
curr_Factors:  [105.34337317  -1.00501883  -1.18009976]
mat_Sqrt:  [[11.84737872  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00808784 -0.01763371  0.06158245]
Stock Position:  -0.00808784421399141
Bond Position:  [5.54550787]


portfolio before change:  [4.69752076]
curr_Stock_Price:  104.93282448218116
curr_Factors:  [104.93282448  -0.88447052  -1.16280079]
mat_Sqrt:  [[13.54542797  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00892126  0.01955248  0.10236119]
Stock Position:  -0.008921263409851441
Bond Position:  [5.63365413]


portfolio before change:  [4.69948985]
curr_Stock_Price:  104.79104610854064
curr_Factors:  [104.79104611  -0.76718839  -1.14145496]
mat_Sqrt:  [[15.53856463  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00386725 -0.05122805 -0.38534898]
Stock Position:  0.0038672491911854083
Bond Position:  [4.29423677]


portfolio before change:  [4.70380074]
curr_Stock_Price:  105.76695347258683
curr_Factors:  [105.76695347  -1.09053622  -1.15483527]
mat_Sqrt:  [[11.19947197  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02020146 -0.12755877  0.24496088]
Stock Position:  -0.02020146188193879
Bond Position:  [6.84044782]


portfolio before change:  [4.7003761]
curr_Stock_Price:  105.97880713054091
curr_Factors:  [105.97880713  -1.30403304  -1.17469795]
mat_Sqrt:  [[ 8.88627677  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00444853 -0.01411067  0.18862222]
Stock Position:  -0.004448529911793599
Bond Position:  [5.17182599]


portfolio before change:  [4.70197255]
curr_Stock_Price:  105.7652698420549
curr_Factors:  [105.76526984  -1.30626723  -1.16212186]
mat_Sqrt:  [[ 8.9605635   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00409524  0.02231935 -0.07951786]
Stock Position:  -0.0040952367987351235
Bond Position:  [5.13510637]


portfolio before change:  [4.70222433]
curr_Stock_Price:  105.86053763694393
curr_Factors:  [105.86053764  -1.27273951  -1.15738097]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [4.70222433]
Stock Price:  106.30513371052675
PL:  [-1.60290938]
Settle:  Tensor("sub_164:0", shape=(), dtype=float64)
PL:  Tensor("sub_165:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  83
output_Z_Vals[:, i, :]:  [[ 1.19260232e+02 -2.92559343e+01 -2.92733494e+01]
 [ 3.27746278e-03 -9.69093620e-02 -3.42053986e-02]
 [ 2.84342197e-02  2.56999138e-02 -1.66234764e-02]
 [ 7.96928583e-02  1.22352680e-01  3.73158028e-02]
 [ 2.41684002e-01 -9.43263035e-03 -1.88152779e-02]
 [-6.58176292e-03  2.90331073e-02  1.20029385e-01]
 [ 2.33505882e-02  5.18386977e-02 -1.74566229e-02]
 [-1.31071588e-01  1.67442598e-01 -2.98001581e-02]
 [ 7.48793931e-02 -2.69062464e-02 -3.71226968e-02]
 [-5.98602927e-02  3.28677424e-01  1.39131233e-01]
 [ 8.46915219e-02  8.45384350e-02 -7.28596288e-02]
 [-2.09286968e-01 -1.01283308e-01  4.82049969e-02]
 [-6.97967931e-02  3.52729100e-04  2.38271355e-02]
 [-9.62623594e-02 -1.14884369e-01  6.32126881e-02]
 [ 2.22689990e-01  2.44544179e-01 -3.68331587e-03]
 [-7.69307080e-02 -3.23570773e-01 -8.25026534e-02]
 [-6.71169914e-02 -5.20798497e-02 -3.97832290e-02]
 [ 3.21181828e-02  8.91728592e-02 -8.72755462e-02]
 [-7.31141957e-02  4.20252377e-02 -1.49160315e-01]
 [-4.26343100e-02 -1.46306214e-02  1.12240484e-01]
 [ 1.53465877e-01 -1.36819136e-01  7.39459073e-02]
 [ 1.23975661e-01 -7.28109271e-02  2.04586075e-01]
 [-7.66991701e-02  9.15252735e-02  3.65847410e-01]
 [-6.86061920e-03 -1.28181144e-02 -7.61517635e-02]
 [ 3.82525533e-02  2.72674630e-02  1.19060393e-01]
 [ 5.20161943e-03 -1.00079432e-01  8.66738207e-02]
 [-8.02165608e-02  5.21741536e-02 -9.74759853e-03]
 [-5.07806065e-02  7.36225950e-02  2.93687317e-02]
 [ 4.23412365e-02 -3.97574329e-02  1.27171218e-01]
 [ 1.43792900e-02 -5.23724827e-03 -1.01614449e-01]
 [-2.57110903e-02  2.87074551e-01  1.93473610e-02]
 [ 1.63613564e-02 -8.43736422e-02 -8.30178333e-02]
 [ 1.75890057e-01 -1.51357241e-01 -6.38227892e-02]
 [-5.27904979e-02 -8.81751525e-02 -1.51714409e-02]
 [-1.51559653e-01  1.00350530e-01  3.24412064e-02]
 [ 8.47165236e-02 -1.65012150e-01 -1.38726811e-01]
 [-1.99731111e-01 -3.28418832e-01  6.38681811e-02]
 [-3.68916966e-02 -1.25979333e-02 -5.08431955e-03]
 [-4.70076253e-02  1.00315961e-01 -1.89774124e-02]
 [-1.76335556e-01  1.05229904e-01  1.02858004e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.26023247 -29.25593426 -29.27334937]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  8.31486419  -9.25153874 -83.50871763]
init_Out:  [2.49911038]
Stock Position:  8.31486419409362
Bond position:  [-828.98730903]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [2.27246238]
curr_Stock_Price:  99.98520503709742
curr_Factors:  [99.98520504 -1.04661998 -1.00569171]
mat_Sqrt:  [[12.84186493  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00048333 -0.03064543 -0.09757848]
Stock Position:  -0.00048333119625404577
Bond Position:  [2.32078835]


portfolio before change:  [2.27232226]
curr_Stock_Price:  100.87536463340142
curr_Factors:  [100.87536463  -0.83005987  -1.02091785]
mat_Sqrt:  [[15.84585602  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00162216  0.00812703 -0.04742215]
Stock Position:  0.0016221613832746254
Bond Position:  [2.10868614]


portfolio before change:  [2.27371484]
curr_Stock_Price:  101.57133517580664
curr_Factors:  [101.57133518  -0.67101592  -1.04022763]
mat_Sqrt:  [[18.34794939  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00493074 0.03869131 0.1064516 ]
Stock Position:  0.004930744321175968
Bond Position:  [1.77289255]


portfolio before change:  [2.28081737]
curr_Stock_Price:  102.96684550626517
curr_Factors:  [102.96684551  -0.59042983  -1.02552137]
mat_Sqrt:  [[20.45967438  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01161308 -0.00298286 -0.05367475]
Stock Position:  0.011613078281456178
Bond Position:  [1.08505533]


portfolio before change:  [2.26762297]
curr_Stock_Price:  101.81899851664829
curr_Factors:  [101.81899852  -0.55496102  -1.02627366]
mat_Sqrt:  [[20.94630026  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00089127 0.00918107 0.34241043]
Stock Position:  0.0008912678687443015
Bond Position:  [2.17687497]


portfolio before change:  [2.26697488]
curr_Stock_Price:  100.78652167360993
curr_Factors:  [100.78652167  -0.59083163  -1.03777453]
mat_Sqrt:  [[19.77460384  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00106833  0.01639284 -0.04979889]
Stock Position:  0.0010683268084135389
Bond Position:  [2.15930194]


portfolio before change:  [2.26688685]
curr_Stock_Price:  100.45145251755687
curr_Factors:  [100.45145252  -0.79500904  -1.0592832 ]
mat_Sqrt:  [[15.72705243  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00844603  0.05295    -0.08501156]
Stock Position:  -0.008446030864155532
Bond Position:  [3.11530292]


portfolio before change:  [2.27575464]
curr_Stock_Price:  99.44762575572474
curr_Factors:  [99.44762576 -0.52627492 -1.08305874]
mat_Sqrt:  [[19.89159873  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0033485  -0.0085085  -0.10590072]
Stock Position:  0.0033485009882949657
Bond Position:  [1.94275417]


portfolio before change:  [2.27890579]
curr_Stock_Price:  100.31616150325478
curr_Factors:  [100.3161615   -0.45136571  -1.07693855]
mat_Sqrt:  [[21.75889324  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00105584  0.10393693  0.39690268]
Stock Position:  -0.0010558365160295811
Bond Position:  [2.38482326]


portfolio before change:  [2.28158704]
curr_Stock_Price:  98.05905831888813
curr_Factors:  [98.05905832 -0.38631321 -1.0670246 ]
mat_Sqrt:  [[22.92509398  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00314075  0.0267334  -0.20784824]
Stock Position:  0.003140745486907632
Bond Position:  [1.9736085]


portfolio before change:  [2.27652101]
curr_Stock_Price:  96.36750138642051
curr_Factors:  [96.36750139 -0.46780907 -1.0546975 ]
mat_Sqrt:  [[21.02395414  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00961105 -0.03202859  0.13751544]
Stock Position:  -0.009611050631565492
Bond Position:  [3.20271395]


portfolio before change:  [2.269139]
curr_Stock_Price:  97.17723285255721
curr_Factors:  [97.17723285 -0.48952821 -1.03951478]
mat_Sqrt:  [[21.06248441  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00308245  0.00011154  0.06797219]
Stock Position:  -0.003082447005975272
Bond Position:  [2.56868268]


portfolio before change:  [2.26872721]
curr_Stock_Price:  97.41499798064318
curr_Factors:  [97.41499798 -0.55972036 -1.02497096]
mat_Sqrt:  [[19.97115264  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00432251 -0.03632963  0.1803282 ]
Stock Position:  -0.004322505900526105
Bond Position:  [2.68980412]


portfolio before change:  [2.26732583]
curr_Stock_Price:  97.81699376302203
curr_Factors:  [97.81699376 -0.48645393 -1.04743634]
mat_Sqrt:  [[21.09862885  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01081834  0.07733166 -0.01050747]
Stock Position:  0.010818344712224374
Bond Position:  [1.20910787]


portfolio before change:  [2.27555726]
curr_Stock_Price:  98.56389987270215
curr_Factors:  [98.56389987 -0.51719575 -1.05778878]
mat_Sqrt:  [[20.4037874   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00500525 -0.10232206 -0.23535711]
Stock Position:  -0.005005249809566037
Bond Position:  [2.76889421]


portfolio before change:  [2.27664671]
curr_Stock_Price:  98.41539259589732
curr_Factors:  [98.4153926  -0.4913914  -1.08447111]
mat_Sqrt:  [[20.35516552  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00376231 -0.01646909 -0.11349048]
Stock Position:  -0.003762308140843459
Bond Position:  [2.64691575]


portfolio before change:  [2.28461101]
curr_Stock_Price:  96.38647492334825
curr_Factors:  [96.38647492 -0.64029889 -1.09463663]
mat_Sqrt:  [[17.00368973  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00097659  0.02819893 -0.24897284]
Stock Position:  0.000976586267055733
Bond Position:  [2.19048131]


portfolio before change:  [2.28423236]
curr_Stock_Price:  95.7183537250414
curr_Factors:  [95.71835373 -0.66901109 -1.07245807]
mat_Sqrt:  [[16.77585915  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00610856  0.01328955 -0.42551286]
Stock Position:  -0.006108559314268559
Bond Position:  [2.8689336]


portfolio before change:  [2.28424796]
curr_Stock_Price:  95.77451142726396
curr_Factors:  [95.77451143 -0.32269492 -1.07230862]
mat_Sqrt:  [[23.73600393  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00084686 -0.00462661  0.32019086]
Stock Position:  -0.0008468602441409415
Bond Position:  [2.36535558]


portfolio before change:  [2.2850001]
curr_Stock_Price:  95.23551842330107
curr_Factors:  [95.23551842 -0.4396025  -1.09576092]
mat_Sqrt:  [[20.51157869  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00804557 -0.04326601  0.21094709]
Stock Position:  0.00804557121962822
Bond Position:  [1.51877595]


portfolio before change:  [2.30227882]
curr_Stock_Price:  97.35952729740308
curr_Factors:  [97.3595273  -0.16894031 -1.11646187]
mat_Sqrt:  [[26.92373969  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00608595 -0.02302484  0.58362713]
Stock Position:  0.006085954277412271
Bond Position:  [1.70975319]


portfolio before change:  [2.29874015]
curr_Stock_Price:  96.74295896180897
curr_Factors:  [96.74295896 -0.12030455 -1.12203588]
mat_Sqrt:  [[27.93043971  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [1.22551650e-05 2.89428328e-02 1.04366083e+00]
Stock Position:  1.2255165049537855e-05
Bond Position:  [2.29755455]


portfolio before change:  [2.2990525]
curr_Stock_Price:  98.7939926276607
curr_Factors:  [ 9.87939926e+01  8.54464370e-02 -1.11681127e+00]
mat_Sqrt:  [[35.22203789  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0006455  -0.00405344 -0.21723978]
Stock Position:  -0.0006455048170440149
Bond Position:  [2.36282449]


portfolio before change:  [2.29831341]
curr_Stock_Price:  100.39654953089583
curr_Factors:  [ 1.00396550e+02 -9.18335124e-02 -1.14036062e+00]
mat_Sqrt:  [[29.28084974  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00216045 0.00862273 0.33964616]
Stock Position:  0.0021604460848898884
Bond Position:  [2.08141208]


portfolio before change:  [2.29706511]
curr_Stock_Price:  99.69831701259197
curr_Factors:  [99.69831701 -0.46484709 -1.12375379]
mat_Sqrt:  [[20.35950577  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00099756 -0.0316479   0.24725629]
Stock Position:  0.0009975585554624685
Bond Position:  [2.1976102]


portfolio before change:  [2.29818634]
curr_Stock_Price:  100.54690539234956
curr_Factors:  [100.54690539  -0.361247    -1.13793103]
mat_Sqrt:  [[22.45349583  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00360118  0.01649892 -0.02780719]
Stock Position:  -0.0036011831211407654
Bond Position:  [2.66027416]


portfolio before change:  [2.29996037]
curr_Stock_Price:  100.1466283014305
curr_Factors:  [100.1466283   -0.49126224  -1.14831384]
mat_Sqrt:  [[19.43468426  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00220661  0.02328151  0.08378082]
Stock Position:  -0.0022066122321855977
Bond Position:  [2.52094514]


portfolio before change:  [2.30000142]
curr_Stock_Price:  100.27084214120404
curr_Factors:  [100.27084214  -0.37003151  -1.16168844]
mat_Sqrt:  [[21.67490188  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00310375 -0.0125724   0.36278409]
Stock Position:  0.0031037473898515287
Bond Position:  [1.98878605]


portfolio before change:  [2.30491426]
curr_Stock_Price:  101.7736161914217
curr_Factors:  [101.77361619  -0.39845338  -1.15848284]
mat_Sqrt:  [[21.45193126  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00030291 -0.00165616 -0.28987774]
Stock Position:  -0.0003029050207329528
Bond Position:  [2.335742]


portfolio before change:  [2.30486626]
curr_Stock_Price:  102.89604200972447
curr_Factors:  [102.89604201  -0.84002946  -1.16604938]
mat_Sqrt:  [[13.84107116  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00103674  0.09078094  0.05519264]
Stock Position:  -0.001036740120620393
Bond Position:  [2.41154271]


portfolio before change:  [2.30580846]
curr_Stock_Price:  102.27800497725912
curr_Factors:  [102.27800498  -1.06585716  -1.16707394]
mat_Sqrt:  [[10.96560482  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00025198 -0.02668129 -0.23682677]
Stock Position:  -0.00025197934995654854
Bond Position:  [2.33158041]


portfolio before change:  [2.30615532]
curr_Stock_Price:  102.05817020773874
curr_Factors:  [102.05817021  -0.95850618  -1.15026667]
mat_Sqrt:  [[12.38851822  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01283077 -0.04786336 -0.18206865]
Stock Position:  0.012830772369932453
Bond Position:  [0.99667017]


portfolio before change:  [2.29758202]
curr_Stock_Price:  101.3802766353382
curr_Factors:  [101.38027664  -1.05761245  -1.13668928]
mat_Sqrt:  [[11.29744774  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00514842 -0.02788343 -0.0432799 ]
Stock Position:  -0.005148421951964612
Bond Position:  [2.81953046]


portfolio before change:  [2.29660573]
curr_Stock_Price:  101.6383657647669
curr_Factors:  [101.63836576  -1.0156797   -1.13664684]
mat_Sqrt:  [[11.81174698  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01205127  0.03173362  0.09254573]
Stock Position:  -0.012051272322069458
Bond Position:  [3.52147735]


portfolio before change:  [2.29623565]
curr_Stock_Price:  101.70560237846584
curr_Factors:  [101.70560238  -1.1854819   -1.15235705]
mat_Sqrt:  [[ 9.81825522  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00531036 -0.05218142 -0.39574898]
Stock Position:  0.0053103566058509575
Bond Position:  [1.75614264]


portfolio before change:  [2.30139244]
curr_Stock_Price:  102.635343978448
curr_Factors:  [102.63534398  -1.63927333  -1.17355553]
mat_Sqrt:  [[ 6.16170482  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.03167529 -0.10385515  0.18219814]
Stock Position:  -0.031675293795166884
Bond Position:  [5.55239712]


portfolio before change:  [2.30653727]
curr_Stock_Price:  102.49483281124549
curr_Factors:  [102.49483281  -1.47201354  -1.18607601]
mat_Sqrt:  [[ 7.18304104  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00532571 -0.00398382 -0.01450415]
Stock Position:  -0.005325711774599486
Bond Position:  [2.85239521]


portfolio before change:  [2.30902702]
curr_Stock_Price:  102.09429019103386
curr_Factors:  [102.09429019  -1.30873954  -1.18663209]
mat_Sqrt:  [[ 8.41928716  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00573579  0.03172269 -0.05413728]
Stock Position:  -0.005735785643706816
Bond Position:  [2.89461798]


portfolio before change:  [2.31102762]
curr_Stock_Price:  101.80858259733618
curr_Factors:  [101.8085826   -1.24785877  -1.2312032 ]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [2.31102762]
Stock Price:  101.6192912514462
PL:  [0.69173637]
Settle:  Tensor("sub_166:0", shape=(), dtype=float64)
PL:  Tensor("sub_167:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  84
output_Z_Vals[:, i, :]:  [[ 1.19260232e+02 -2.92559343e+01 -2.92733494e+01]
 [ 6.41295447e-04 -8.44833740e-02 -3.05569896e-02]
 [ 6.31174116e-03  5.86543628e-03 -1.60891162e-02]
 [ 8.25893139e-02  1.48690236e-01  3.76676703e-02]
 [ 1.74665424e-01 -1.53749522e-02 -6.11216441e-02]
 [ 7.20380709e-02  3.01124417e-02  5.82178793e-03]
 [ 6.92826013e-02  1.63604013e-02 -6.37266963e-02]
 [-1.33719387e-01  1.38421797e-01 -4.39552644e-02]
 [ 1.47845496e-02  3.15756037e-02 -3.93677213e-02]
 [-3.30978923e-02  2.92973562e-01  1.14149242e-01]
 [ 5.56386082e-02  2.47654713e-02 -7.60982597e-02]
 [-7.54635553e-02 -1.01877356e-01 -6.25123956e-03]
 [-2.01931258e-02 -7.93095689e-02  5.96944394e-02]
 [ 1.07649973e-01  2.69432883e-02  1.83884557e-01]
 [ 1.01853866e-01 -7.96269061e-02 -2.15633424e-01]
 [-7.51560761e-02 -1.26386759e-01 -1.34161786e-01]
 [-7.07837257e-02 -5.47816997e-02 -4.30368991e-02]
 [ 5.56213011e-02  1.78321593e-01  1.30647245e-01]
 [-2.95295407e-02  2.17564132e-02 -1.23572071e-01]
 [-7.88470763e-03  6.29956625e-03  6.14815641e-02]
 [-8.49328285e-02  1.18462336e-02 -2.40467902e-02]
 [-7.56104423e-02  4.67741474e-02 -7.37890059e-02]
 [-1.40295177e-01  3.10993286e-01  5.04809011e-01]
 [ 2.25957634e-01 -3.72908796e-02  2.47502273e-02]
 [-1.08485475e-01 -3.49192816e-02 -8.87638352e-02]
 [ 9.16609054e-02 -8.01008648e-02  6.77343602e-02]
 [ 3.00708734e-02  1.71332038e-01  1.19556209e-01]
 [-4.73183138e-02  6.11881932e-02  1.54595680e-02]
 [-2.30869938e-02  2.65965319e-01  1.60343698e-01]
 [-2.15144750e-01 -3.30684002e-01  1.31719840e-01]
 [-2.67486958e-01  1.07429300e+00 -5.79348070e-02]
 [ 4.26876091e-02  1.07458198e-01  2.19037040e-01]
 [-9.29949001e-02  2.70359433e-02  8.52307717e-02]
 [-4.89565862e-01  3.78442243e-02  2.53635042e-02]
 [-1.55009662e-01  1.37131080e-01  3.46998802e-02]
 [ 1.07691165e-01 -1.55299079e-01 -1.26981391e-01]
 [-2.35656844e-01 -4.12102645e-01  8.99916828e-02]
 [-6.81153905e-02 -8.32988706e-02  1.43806768e-01]
 [-2.73485231e-02  5.90885621e-02 -3.13126088e-02]
 [-1.45913437e-01  8.87579704e-02  8.70201980e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.26023247 -29.25593426 -29.27334937]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  8.31486419  -9.25153874 -83.50871763]
init_Out:  [2.49911038]
Stock Position:  8.31486419409362
Bond position:  [-828.98730903]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [3.00140604]
curr_Stock_Price:  100.07287257338162
curr_Factors:  [100.07287257  -0.77810584  -0.99647345]
mat_Sqrt:  [[16.96783268  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00045837 -0.02671599 -0.08717059]
Stock Position:  -0.00045836586384733586
Bond Position:  [3.04727603]


portfolio before change:  [3.0014564]
curr_Stock_Price:  100.79406812694684
curr_Factors:  [100.79406813  -0.79625258  -1.00747421]
mat_Sqrt:  [[16.5991704   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00019152  0.00185481 -0.04589777]
Stock Position:  0.00019151613580712588
Bond Position:  [2.98215271]


portfolio before change:  [3.00179347]
curr_Stock_Price:  100.60752343855007
curr_Factors:  [100.60752344  -0.86493086  -0.99841894]
mat_Sqrt:  [[15.60946159  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00602951 0.04701998 0.10745538]
Stock Position:  0.006029507148531287
Bond Position:  [2.39517969]


portfolio before change:  [2.99983673]
curr_Stock_Price:  100.23333721904997
curr_Factors:  [100.23333722  -0.856991    -1.02941891]
mat_Sqrt:  [[15.19689197  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01064639 -0.00486199 -0.17436304]
Stock Position:  0.01064639014628105
Bond Position:  [1.93271351]


portfolio before change:  [2.99819463]
curr_Stock_Price:  100.05640351968391
curr_Factors:  [100.05640352  -0.81113745  -1.03237578]
mat_Sqrt:  [[15.83497071  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00467345 0.00952239 0.01660794]
Stock Position:  0.004673449648172987
Bond Position:  [2.53058606]


portfolio before change:  [2.9982005]
curr_Stock_Price:  99.98997116163338
curr_Factors:  [99.98997116 -0.87387334 -1.04880971]
mat_Sqrt:  [[14.61994719  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00387805  0.00517361 -0.18179453]
Stock Position:  0.0038780487260159993
Bond Position:  [2.61043452]


portfolio before change:  [2.99953764]
curr_Stock_Price:  100.25062067613938
curr_Factors:  [100.25062068  -0.58247449  -1.05308627]
mat_Sqrt:  [[19.53313981  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00712214  0.04377282 -0.12539213]
Stock Position:  -0.007122136219975839
Bond Position:  [3.71353621]


portfolio before change:  [2.98991886]
curr_Stock_Price:  101.66634762867483
curr_Factors:  [101.66634763  -0.35415787  -1.05823302]
mat_Sqrt:  [[24.76188208  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00030547  0.00998508 -0.11230515]
Stock Position:  0.0003054665109515125
Bond Position:  [2.95886319]


portfolio before change:  [2.99035409]
curr_Stock_Price:  101.88028482051115
curr_Factors:  [101.88028482  -0.29518412  -1.04737953]
mat_Sqrt:  [[26.60860861  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-8.39100991e-05  9.26463751e-02  3.25636015e-01]
Stock Position:  -8.391009912290849e-05
Bond Position:  [2.99890287]


portfolio before change:  [2.99072323]
curr_Stock_Price:  101.94879956856937
curr_Factors:  [101.94879957  -0.131455    -1.02996954]
mat_Sqrt:  [[31.91404473  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0012767   0.00783153 -0.21708715]
Stock Position:  0.0012766967661370673
Bond Position:  [2.86056552]


portfolio before change:  [2.98744733]
curr_Stock_Price:  99.10279386522865
curr_Factors:  [ 9.91027939e+01 -9.54576411e-02 -1.00442887e+00]
mat_Sqrt:  [[32.99219831  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00240572 -0.03221645 -0.01783305]
Stock Position:  -0.0024057216642920805
Bond Position:  [3.22586107]


portfolio before change:  [2.98584389]
curr_Stock_Price:  99.93693229468691
curr_Factors:  [99.93693229  0.15609274 -1.03796321]
mat_Sqrt:  [[41.37466949  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00024304 -0.02507989  0.17029162]
Stock Position:  -0.00024304275555662365
Bond Position:  [3.01013283]


portfolio before change:  [2.98582025]
curr_Stock_Price:  101.58242914615029
curr_Factors:  [ 1.01582429e+02 -7.66957204e-02 -1.02856443e+00]
mat_Sqrt:  [[33.63645445  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00433699 0.00852022 0.52457146]
Stock Position:  0.004336988710535708
Bond Position:  [2.5452584]


portfolio before change:  [2.97749447]
curr_Stock_Price:  99.58935190697927
curr_Factors:  [ 9.95893519e+01  9.28484809e-02 -1.02097938e+00]
mat_Sqrt:  [[39.36686025  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00141698 -0.02518024 -0.61514214]
Stock Position:  0.0014169765916374332
Bond Position:  [2.83637869]


portfolio before change:  [2.98229448]
curr_Stock_Price:  102.72662097231016
curr_Factors:  [ 1.02726621e+02  5.58016495e-02 -1.05948566e+00]
mat_Sqrt:  [[37.65204562  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00281007 -0.039967   -0.38272623]
Stock Position:  -0.002810073830993151
Bond Position:  [3.27096387]


portfolio before change:  [2.98788911]
curr_Stock_Price:  100.88121249666449
curr_Factors:  [100.8812125    0.12103447  -1.02385027]
mat_Sqrt:  [[40.89991214  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00198003 -0.01732349 -0.12277229]
Stock Position:  -0.0019800300080626485
Bond Position:  [3.18763694]


portfolio before change:  [2.99316559]
curr_Stock_Price:  98.41761341373942
curr_Factors:  [98.41761341  0.23263266 -1.03792713]
mat_Sqrt:  [[43.98837156  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00197538 0.05639024 0.37270023]
Stock Position:  0.0019753811963275953
Bond Position:  [2.79875329]


portfolio before change:  [2.9898444]
curr_Stock_Price:  96.55920950283335
curr_Factors:  [96.5592095   0.51706446 -1.02432424]
mat_Sqrt:  [[58.14248308  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00093205  0.00687998 -0.35251672]
Stock Position:  -0.0009320523143765231
Bond Position:  [3.07984263]


portfolio before change:  [2.98999219]
curr_Stock_Price:  96.81371369688668
curr_Factors:  [96.8137137   0.69468782 -1.03508817]
mat_Sqrt:  [[68.88154594  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [7.00887026e-05 1.99209776e-03 1.75389789e-01]
Stock Position:  7.008870255163118e-05
Bond Position:  [2.98320665]


portfolio before change:  [2.99046945]
curr_Stock_Price:  98.3023103063956
curr_Factors:  [98.30231031  0.55490283 -1.0319776 ]
mat_Sqrt:  [[61.00603314  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00146765  0.00374611 -0.0685988 ]
Stock Position:  -0.0014676497706173513
Bond Position:  [3.13474281]


portfolio before change:  [2.98352487]
curr_Stock_Price:  103.30108142778732
curr_Factors:  [103.30108143   0.21804042  -1.03026938]
mat_Sqrt:  [[45.85200317  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00195117  0.01479128 -0.2104995 ]
Stock Position:  -0.0019511657194913074
Bond Position:  [3.1850824]


portfolio before change:  [2.9881186]
curr_Stock_Price:  101.15079194192774
curr_Factors:  [101.15079194   0.36590559  -1.05015794]
mat_Sqrt:  [[51.02726241  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-5.72667551e-04  9.83447122e-02  1.44007960e+00]
Stock Position:  -0.0005726675509064032
Bond Position:  [3.04604438]


portfolio before change:  [2.98693407]
curr_Stock_Price:  103.88415906280164
curr_Factors:  [103.88415906   0.22531733  -1.03064232]
mat_Sqrt:  [[46.43026173  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00495468 -0.01179241  0.07060551]
Stock Position:  0.0049546760700826895
Bond Position:  [2.47222172]


portfolio before change:  [2.99309906]
curr_Stock_Price:  105.0660610651824
curr_Factors:  [105.06606107   0.50838884  -0.9897712 ]
mat_Sqrt:  [[64.92332434  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00196395 -0.01104245 -0.25321851]
Stock Position:  -0.001963946396098262
Bond Position:  [3.19944317]


portfolio before change:  [2.9846845]
curr_Stock_Price:  109.5542292742189
curr_Factors:  [109.55422927   0.35287393  -0.99082976]
mat_Sqrt:  [[57.88532205  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00178662 -0.02533012  0.19322728]
Stock Position:  0.0017866174824322427
Bond Position:  [2.78895299]


portfolio before change:  [2.98385139]
curr_Stock_Price:  108.89278403186896
curr_Factors:  [108.89278403   0.44939316  -1.01223296]
mat_Sqrt:  [[62.02415844  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00094961 0.05417995 0.34106059]
Stock Position:  0.0009496131500102895
Bond Position:  [2.88044537]


portfolio before change:  [2.98905217]
curr_Stock_Price:  113.99033544437313
curr_Factors:  [113.99033544   0.37326222  -1.02134252]
mat_Sqrt:  [[59.62252063  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00071421  0.01934941  0.04410184]
Stock Position:  -0.000714206140282169
Bond Position:  [3.07046476]


portfolio before change:  [2.99094322]
curr_Stock_Price:  111.87998831797714
curr_Factors:  [111.87998832   0.28998377  -1.03711429]
mat_Sqrt:  [[53.00022938  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [3.11512264e-04 8.41056187e-02 4.57415938e-01]
Stock Position:  0.00031151226367245345
Bond Position:  [2.95609123]


portfolio before change:  [2.9917548]
curr_Stock_Price:  113.29900869105104
curr_Factors:  [113.29900869   0.28605016  -1.05536022]
mat_Sqrt:  [[52.49512772  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00374884 -0.10457146  0.37576004]
Stock Position:  -0.0037488388476427533
Bond Position:  [3.41649452]


portfolio before change:  [2.99886181]
curr_Stock_Price:  111.51714433668981
curr_Factors:  [111.51714434   0.18283688  -1.05585535]
mat_Sqrt:  [[46.5794693   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00540098  0.33972128 -0.16527188]
Stock Position:  -0.005400978782345223
Bond Position:  [3.60116354]


portfolio before change:  [3.0207544]
curr_Stock_Price:  107.5470465941919
curr_Factors:  [107.54704659   0.25324693  -1.03006803]
mat_Sqrt:  [[49.45718253  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00182325 0.03398127 0.62485171]
Stock Position:  0.0018232521922532698
Bond Position:  [2.82466901]


portfolio before change:  [3.02587744]
curr_Stock_Price:  110.1632140914745
curr_Factors:  [110.16321409  -0.15017351  -1.02823871]
mat_Sqrt:  [[33.90460373  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00220912  0.00854952  0.24313967]
Stock Position:  -0.0022091152331142113
Bond Position:  [3.26924067]


portfolio before change:  [3.02583859]
curr_Stock_Price:  110.3657937781611
curr_Factors:  [110.36579378  -0.19400678  -1.03069504]
mat_Sqrt:  [[32.43047024  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01490609  0.01196739  0.07235502]
Stock Position:  -0.014906087436681616
Bond Position:  [4.67096077]


portfolio before change:  [3.07834361]
curr_Stock_Price:  106.88257891582188
curr_Factors:  [106.88257892  -0.15241692  -1.02304995]
mat_Sqrt:  [[32.99196233  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0043764   0.04336465  0.0989891 ]
Stock Position:  -0.004376395315087255
Bond Position:  [3.54610402]


portfolio before change:  [3.07447018]
curr_Stock_Price:  107.8689426046807
curr_Factors:  [107.8689426   -0.11485752  -1.03452194]
mat_Sqrt:  [[34.17647455  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00227529 -0.04910988 -0.36224256]
Stock Position:  0.002275290025141335
Bond Position:  [2.82903705]


portfolio before change:  [3.07600324]
curr_Stock_Price:  108.38729905138845
curr_Factors:  [108.38729905   0.18673958  -1.04455467]
mat_Sqrt:  [[45.96571668  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00495865 -0.1303183   0.25672122]
Stock Position:  -0.004958648096768431
Bond Position:  [3.61345772]


portfolio before change:  [3.07511812]
curr_Stock_Price:  108.65689516668407
curr_Factors:  [ 1.08656895e+02  4.26595176e-02 -1.07113813e+00]
mat_Sqrt:  [[38.85032941  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00105306 -0.02634142  0.41024068]
Stock Position:  -0.0010530599136902392
Bond Position:  [3.18954034]


portfolio before change:  [3.07847276]
curr_Stock_Price:  105.84990810487011
curr_Factors:  [ 1.05849908e+02 -7.27088997e-02 -1.05683743e+00]
mat_Sqrt:  [[34.20855637  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00094171  0.01868544 -0.08932616]
Stock Position:  -0.0009417094978084274
Bond Position:  [3.17815263]


portfolio before change:  [3.08141154]
curr_Stock_Price:  103.15110859471085
curr_Factors:  [103.15110859  -0.46576526  -1.04742811]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [3.08141154]
Stock Price:  101.04559469212602
PL:  [2.03581685]
Settle:  Tensor("sub_168:0", shape=(), dtype=float64)
PL:  Tensor("sub_169:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  85
output_Z_Vals[:, i, :]:  [[ 1.19260232e+02 -2.92559343e+01 -2.92733494e+01]
 [-2.42231274e-03 -7.00425766e-02 -2.63170101e-02]
 [-3.14907673e-02  4.90902071e-02  1.12746232e-01]
 [-5.63510724e-02  1.12748541e-01  1.15795209e-02]
 [ 1.56705726e-02  3.77835360e-02 -7.16733288e-02]
 [ 6.72445279e-02  2.90161721e-02 -6.44602766e-02]
 [ 7.06567933e-02  1.52072547e-02 -6.61220190e-02]
 [-1.36342937e-01  1.09666781e-01 -5.79807319e-02]
 [-6.94173128e-02 -5.66805188e-02  7.65181501e-02]
 [-2.66656450e-02 -6.45298289e-02 -1.10643606e-01]
 [ 5.48709986e-02  1.56187413e-01 -8.15463159e-02]
 [-1.99099377e-02  6.21199653e-02 -1.14753229e-02]
 [-1.05268475e-01  3.60169765e-02 -5.01576103e-02]
 [-2.51054793e-02 -2.99178021e-02  1.13756436e-01]
 [ 1.85111778e-01  2.14375802e-01  1.06722138e-02]
 [-7.74823007e-02 -8.38402408e-02 -1.09762644e-01]
 [-7.26118501e-02 -5.40966811e-02 -5.29359050e-02]
 [-2.19978438e-02 -8.84552247e-02 -1.06493296e-02]
 [ 2.58424918e-02  6.11210109e-02  1.85177098e-02]
 [ 2.19822262e-01 -5.71361530e-02 -1.20681250e-02]
 [-3.88414917e-02 -1.42111785e-02 -2.13359584e-02]
 [ 7.22149186e-02 -5.53183328e-02  7.02069378e-02]
 [-8.03914104e-02  1.22791905e-01  2.12019861e-01]
 [ 1.14682145e-01 -2.09149127e-02 -5.94794868e-03]
 [ 6.85947898e-02  3.18383285e-02  8.50183853e-02]
 [ 9.99222544e-02  6.76685092e-03  5.62627317e-02]
 [-1.60187983e-01  7.29418930e-02  7.83873687e-02]
 [-5.07806065e-02  7.36225950e-02  2.93687317e-02]
 [ 5.81603889e-02 -9.89042573e-02 -1.62777876e-01]
 [ 5.41713547e-02  1.34107805e-02  1.76913158e-02]
 [ 1.64031597e-02  1.68716658e-01  2.46457854e-02]
 [ 2.45182641e-02 -8.53292546e-02 -8.19284713e-02]
 [ 2.11896437e-01 -2.67069453e-01 -2.35604325e-01]
 [-4.06953905e-02 -7.87849025e-02  4.66515821e-03]
 [-1.21554065e-01  4.39253143e-02  3.60012812e-02]
 [ 8.47165236e-02 -1.65012150e-01 -1.38726811e-01]
 [-1.67698225e-01 -2.81195050e-01  4.07042998e-02]
 [-3.16289629e-02 -3.71781787e-03 -2.97875310e-02]
 [-4.74620125e-02  9.55726740e-02 -2.22514034e-03]
 [-3.76582950e-01  1.99510405e-01  2.26978872e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.26023247 -29.25593426 -29.27334937]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  8.31486419  -9.25153874 -83.50871763]
init_Out:  [2.49911038]
Stock Position:  8.31486419409362
Bond position:  [-828.98730903]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [3.32105106]
curr_Stock_Price:  100.11131517548672
curr_Factors:  [100.11131518  -1.16124024  -1.00578874]
mat_Sqrt:  [[11.46448207  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00083761 -0.02214941 -0.0750751 ]
Stock Position:  -0.0008376079637765113
Bond Position:  [3.40490509]


portfolio before change:  [3.32196344]
curr_Stock_Price:  99.53020477660836
curr_Factors:  [99.53020478 -0.9334322  -0.99471047]
mat_Sqrt:  [[14.47348705  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00049809  0.01552369  0.32163362]
Stock Position:  -0.000498085588216789
Bond Position:  [3.371538]


portfolio before change:  [3.3228884]
curr_Stock_Price:  98.51935087877861
curr_Factors:  [98.51935088 -1.03787488 -1.03397806]
mat_Sqrt:  [[12.40872738  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00411616  0.03565422  0.03303315]
Stock Position:  -0.004116156007966076
Bond Position:  [3.72840942]


portfolio before change:  [3.32305574]
curr_Stock_Price:  98.59192866540572
curr_Factors:  [98.59192867 -1.0173582  -1.02920847]
mat_Sqrt:  [[12.735874    0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 1.58283788e-04  1.19482032e-02 -2.04464057e-01]
Stock Position:  0.00015828378804053338
Bond Position:  [3.30745023]


portfolio before change:  [3.32354703]
curr_Stock_Price:  99.08367305588598
curr_Factors:  [99.08367306 -1.0771069  -1.02458365]
mat_Sqrt:  [[12.11293794  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00452705  0.00917572 -0.18388723]
Stock Position:  0.004527045678231235
Bond Position:  [2.87499072]


portfolio before change:  [3.32671134]
curr_Stock_Price:  99.70326366186077
curr_Factors:  [99.70326366 -0.97522855 -1.00822067]
mat_Sqrt:  [[13.71855352  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00419522  0.00480896 -0.18862772]
Stock Position:  0.004195219436196695
Bond Position:  [2.90843427]


portfolio before change:  [3.32999473]
curr_Stock_Price:  100.39924776186234
curr_Factors:  [100.39924776  -1.21186645  -0.99066676]
mat_Sqrt:  [[11.09640862  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01309853  0.03467968 -0.16540289]
Stock Position:  -0.013098528085814893
Bond Position:  [4.64507709]


portfolio before change:  [3.33322738]
curr_Stock_Price:  100.1967835652127
curr_Factors:  [100.19678357  -1.14025832  -0.98394995]
mat_Sqrt:  [[11.97627747  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00461425 -0.01792395  0.21828498]
Stock Position:  -0.0046142547747137445
Bond Position:  [3.79556087]


portfolio before change:  [3.33574862]
curr_Stock_Price:  99.75320941797898
curr_Factors:  [99.75320942 -1.16854721 -0.98169224]
mat_Sqrt:  [[11.61688654  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.004383   -0.02040612 -0.31563541]
Stock Position:  -0.004383001364057272
Bond Position:  [3.77296707]


portfolio before change:  [3.33638177]
curr_Stock_Price:  99.71636132220098
curr_Factors:  [99.71636132 -1.39011849 -0.99772117]
mat_Sqrt:  [[ 9.15673904  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00461498  0.0493908  -0.23262894]
Stock Position:  0.0046149800757175966
Bond Position:  [2.87619275]


portfolio before change:  [3.34027692]
curr_Stock_Price:  100.48247415958718
curr_Factors:  [100.48247416  -1.31486485  -1.01757495]
mat_Sqrt:  [[ 9.75269366  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0021172   0.01964406 -0.0327359 ]
Stock Position:  -0.0021171994382983075
Bond Position:  [3.55301835]


portfolio before change:  [3.34126747]
curr_Stock_Price:  100.22439928388394
curr_Factors:  [100.22439928  -1.1983561   -1.00406818]
mat_Sqrt:  [[11.07829053  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01034247  0.01138957 -0.1430857 ]
Stock Position:  -0.010342471137263647
Bond Position:  [4.37783542]


portfolio before change:  [3.33684289]
curr_Stock_Price:  100.70512030877983
curr_Factors:  [100.70512031  -0.97464894  -1.01846638]
mat_Sqrt:  [[13.72311073  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-1.93652757e-04 -9.46083971e-03  3.24515450e-01]
Stock Position:  -0.00019365275707702693
Bond Position:  [3.35634471]


portfolio before change:  [3.33707338]
curr_Stock_Price:  101.68150587143563
curr_Factors:  [101.68150587  -0.96887231  -1.01746316]
mat_Sqrt:  [[13.9504248   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01382219 0.06779158 0.03044486]
Stock Position:  0.013822187956499542
Bond Position:  [1.93161249]


portfolio before change:  [3.32549749]
curr_Stock_Price:  100.82655063532259
curr_Factors:  [100.82655064  -0.86273679  -0.98359386]
mat_Sqrt:  [[15.91196073  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00641356 -0.02651261 -0.31312227]
Stock Position:  -0.006413556068548567
Bond Position:  [3.97215423]


portfolio before change:  [3.3266041]
curr_Stock_Price:  100.73142991201321
curr_Factors:  [100.73142991  -0.95958383  -0.97611513]
mat_Sqrt:  [[14.53789813  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.005834   -0.01710687 -0.1510114 ]
Stock Position:  -0.005834001313342426
Bond Position:  [3.9142714]


portfolio before change:  [3.31931578]
curr_Stock_Price:  102.06458650281779
curr_Factors:  [102.0645865   -0.84529904  -0.9470649 ]
mat_Sqrt:  [[17.00048489  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00155616 -0.027972   -0.03037957]
Stock Position:  -0.0015561634474561502
Bond Position:  [3.47814496]


portfolio before change:  [3.3210734]
curr_Stock_Price:  101.21453453462263
curr_Factors:  [101.21453453  -0.65970271  -0.95835503]
mat_Sqrt:  [[20.06916658  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00155465 0.01932816 0.05282587]
Stock Position:  0.0015546505681979133
Bond Position:  [3.16372016]


portfolio before change:  [3.3209743]
curr_Stock_Price:  100.89640335981458
curr_Factors:  [100.89640336  -0.89834211  -0.95775198]
mat_Sqrt:  [[15.76827774  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01369101 -0.01806804 -0.034427  ]
Stock Position:  0.01369100803997822
Bond Position:  [1.93960083]


portfolio before change:  [3.31175585]
curr_Stock_Price:  100.20537192167211
curr_Factors:  [100.20537192  -1.03106078  -0.94671578]
mat_Sqrt:  [[13.86607539  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00314174 -0.00449397 -0.06086555]
Stock Position:  -0.0031417402398931055
Bond Position:  [3.6265751]


portfolio before change:  [3.30939428]
curr_Stock_Price:  101.10134851367374
curr_Factors:  [101.10134851  -0.93417913  -0.95341352]
mat_Sqrt:  [[15.31037684  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00555947 -0.01749319  0.20028085]
Stock Position:  0.00555946711350931
Bond Position:  [2.74732465]


portfolio before change:  [3.31988516]
curr_Stock_Price:  102.92660322736832
curr_Factors:  [102.92660323  -1.12565757  -0.96303655]
mat_Sqrt:  [[12.74733241  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00266272  0.03883021  0.60483365]
Stock Position:  -0.002662719000073487
Bond Position:  [3.59394978]


portfolio before change:  [3.3196642]
curr_Stock_Price:  103.17831312489844
curr_Factors:  [103.17831312  -1.06557336  -0.98931815]
mat_Sqrt:  [[13.21783661  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00854361 -0.00661388 -0.01696784]
Stock Position:  0.00854360725799528
Bond Position:  [2.43814921]


portfolio before change:  [3.32194065]
curr_Stock_Price:  103.40909003528601
curr_Factors:  [103.40909004  -1.08312938  -1.00292613]
mat_Sqrt:  [[12.84092536  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00675739 0.01006816 0.24253379]
Stock Position:  0.006757391284188828
Bond Position:  [2.62316497]


portfolio before change:  [3.32280292]
curr_Stock_Price:  103.48816627518008
curr_Factors:  [103.48816628  -1.05723907  -1.01038767]
mat_Sqrt:  [[13.08976379  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00852434 0.00213987 0.16050191]
Stock Position:  0.008524336848628978
Bond Position:  [2.44063493]


portfolio before change:  [3.32135335]
curr_Stock_Price:  103.28232469349551
curr_Factors:  [103.28232469  -1.05888281  -1.00103433]
mat_Sqrt:  [[13.16483316  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01080939  0.02306625  0.22361734]
Stock Position:  -0.010809394638449798
Bond Position:  [4.43777276]


portfolio before change:  [3.32791387]
curr_Stock_Price:  102.72671870931421
curr_Factors:  [102.72671871  -0.92209414  -0.98377479]
mat_Sqrt:  [[15.27478331  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00280756  0.02328151  0.08378082]
Stock Position:  -0.0028075561618335436
Bond Position:  [3.6163249]


portfolio before change:  [3.32657331]
curr_Stock_Price:  103.36522106943625
curr_Factors:  [103.36522107  -1.224702    -0.9994557 ]
mat_Sqrt:  [[11.17982548  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0020018  -0.03127627 -0.46435997]
Stock Position:  0.002001802018353786
Bond Position:  [3.1196566]


portfolio before change:  [3.3267684]
curr_Stock_Price:  103.26786529997453
curr_Factors:  [103.2678653   -1.464395    -0.99091478]
mat_Sqrt:  [[ 8.86416245  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00655774 0.00424086 0.0504684 ]
Stock Position:  0.006557736790413926
Bond Position:  [2.64956492]


portfolio before change:  [3.32661011]
curr_Stock_Price:  103.1932187871002
curr_Factors:  [103.19321879  -1.5187226   -0.96701326]
mat_Sqrt:  [[ 8.59230714  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00300155 0.05335289 0.07030757]
Stock Position:  0.0030015459812854483
Bond Position:  [3.01687092]


portfolio before change:  [3.32739429]
curr_Stock_Price:  103.32883063899665
curr_Factors:  [103.32883064  -1.62736272  -0.9770113 ]
mat_Sqrt:  [[ 7.64110642  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00073176 -0.02698348 -0.23371912]
Stock Position:  0.0007317648475463653
Bond Position:  [3.25178188]


portfolio before change:  [3.32782719]
curr_Stock_Price:  103.36491864766514
curr_Factors:  [103.36491865  -1.48782645  -1.00390199]
mat_Sqrt:  [[ 8.55518207  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01834072 -0.08445478 -0.67211356]
Stock Position:  0.018340720365812056
Bond Position:  [1.43204012]


portfolio before change:  [3.32540593]
curr_Stock_Price:  103.22314250636133
curr_Factors:  [103.22314251  -1.43549454  -0.96593667]
mat_Sqrt:  [[ 9.35079963  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00446778 -0.02491397  0.0133084 ]
Stock Position:  -0.004467782237010128
Bond Position:  [3.78658445]


portfolio before change:  [3.33025282]
curr_Stock_Price:  102.24423623198427
curr_Factors:  [102.24423623  -1.44358015  -0.99102878]
mat_Sqrt:  [[ 8.95986791  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01261974  0.0138904   0.10270163]
Stock Position:  -0.012619738254797543
Bond Position:  [4.62054832]


portfolio before change:  [3.33259138]
curr_Stock_Price:  102.10469653107928
curr_Factors:  [102.10469653  -1.56873146  -1.00091538]
mat_Sqrt:  [[ 7.81739892  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00666954 -0.05218142 -0.39574898]
Stock Position:  0.006669537660651083
Bond Position:  [2.65160026]


portfolio before change:  [3.33252184]
curr_Stock_Price:  102.0445703583822
curr_Factors:  [102.04457036  -1.29909364  -1.01035145]
mat_Sqrt:  [[10.13469409  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01644351 -0.08892168  0.11611804]
Stock Position:  -0.016443507675458366
Bond Position:  [5.01049252]


portfolio before change:  [3.34406873]
curr_Stock_Price:  101.38044594911266
curr_Factors:  [101.38044595  -1.22022223  -1.02340629]
mat_Sqrt:  [[10.75371964  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00351556 -0.00117568 -0.08497553]
Stock Position:  -0.003515556669679086
Bond Position:  [3.70047743]


portfolio before change:  [3.34562786]
curr_Stock_Price:  101.06853255857249
curr_Factors:  [101.06853256  -1.26493055  -1.0339917 ]
mat_Sqrt:  [[10.14394095  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00448036  0.03022273 -0.00634771]
Stock Position:  -0.004480363381384301
Bond Position:  [3.79845162]


portfolio before change:  [3.34637566]
curr_Stock_Price:  101.00760858012579
curr_Factors:  [101.00760858  -1.19944443  -1.02281477]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [3.34637566]
Stock Price:  99.99951730687354
PL:  [3.34637566]
Settle:  Tensor("sub_170:0", shape=(), dtype=float64)
PL:  Tensor("sub_171:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  86
output_Z_Vals[:, i, :]:  [[ 1.19260232e+02 -2.92559343e+01 -2.92733494e+01]
 [ 1.76920159e-02 -2.39500716e-02 -3.80858584e-02]
 [-4.91924752e-02  1.59446963e-02  1.02472309e-01]
 [-2.45058210e-02  1.17769424e-01  1.75830829e-02]
 [ 9.28833940e-02  1.23225673e-02 -6.79348454e-02]
 [ 7.41747678e-02  3.06003748e-02  3.45353201e-04]
 [ 6.78822192e-03  5.54906279e-02  9.67453819e-03]
 [-1.01737232e-01 -3.65246568e-02 -1.11037755e-01]
 [ 1.27770245e-01 -2.15522427e-02 -8.30248705e-02]
 [-3.86074154e-02 -2.17404037e-02 -7.98099023e-02]
 [ 5.98624383e-02  1.17003717e-01 -8.57649499e-02]
 [-2.87928449e-02 -1.07152985e-01 -2.25084296e-02]
 [-9.02811569e-02  1.88557676e-02  1.32163301e-02]
 [-9.80668192e-02 -1.15507290e-01  6.19360862e-02]
 [ 1.89603623e-01  1.36178883e-01 -8.39920363e-02]
 [-4.94211566e-02 -7.28796755e-01 -1.05846469e-02]
 [-7.09901057e-02 -6.28158489e-02 -1.86030963e-01]
 [ 3.10557001e-01  4.24695909e-03 -2.88302685e-01]
 [-1.56963281e-01  1.90034314e-02 -2.89887731e-01]
 [ 1.60009333e-01 -2.94569151e-02 -7.19220297e-03]
 [ 1.68504060e-01  2.59460037e-02  2.31887961e-01]
 [-5.32617537e-02  3.13394951e-02 -5.20192603e-02]
 [-1.69115538e-01  4.15742889e-01  5.21540308e-01]
 [ 2.37325440e-01 -5.39499814e-02  1.02827968e-02]
 [ 3.02560441e-03  2.64307728e-02  1.38380471e-01]
 [-2.86866895e-02 -1.38303124e-01  9.75537094e-02]
 [-3.95837634e-03  7.41903025e-02  2.12739226e-02]
 [ 3.20219996e-02 -2.14593537e-02 -4.51888715e-03]
 [-7.82881171e-02 -4.03770562e-02  7.17222097e-02]
 [ 2.15130210e-01  3.05129781e-01  1.89524614e-01]
 [ 7.90212303e-02 -4.65811662e-02  6.05658960e-02]
 [ 8.12570684e-02 -9.04612684e-03  6.64931056e-03]
 [ 2.33296002e-01 -1.04052929e-01  4.73418309e-02]
 [-3.94687367e-02 -7.51696430e-02  2.14766894e-02]
 [-1.89571973e-01  1.32562988e-02  1.23461951e-02]
 [ 3.60788736e-01  2.56960928e-01  1.23976781e-01]
 [ 1.81303734e-02 -8.87038716e-02 -9.87245699e-02]
 [ 1.73957530e-02  1.03091815e-01  3.74080656e-02]
 [ 5.71510139e-01 -6.68228469e-01 -1.77269921e-01]
 [-2.96526906e-01  1.88094368e-01  1.40436929e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.26023247 -29.25593426 -29.27334937]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  8.31486419  -9.25153874 -83.50871763]
init_Out:  [2.49911038]
Stock Position:  8.31486419409362
Bond position:  [-828.98730903]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-2.78752838]
curr_Stock_Price:  99.37665742296855
curr_Factors:  [99.37665742 -0.8333529  -0.99082338]
mat_Sqrt:  [[16.03447292  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00057996 -0.00757368 -0.10864835]
Stock Position:  0.0005799619623357911
Bond Position:  [-2.84516307]


portfolio before change:  [-2.78801513]
curr_Stock_Price:  99.15064071024749
curr_Factors:  [99.15064071 -0.76601222 -0.9897392 ]
mat_Sqrt:  [[17.13098656  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00162651  0.00504216  0.29232497]
Stock Position:  -0.0016265095076148073
Bond Position:  [-2.62674567]


portfolio before change:  [-2.78896708]
curr_Stock_Price:  99.53402695704915
curr_Factors:  [99.53402696 -0.72512477 -0.99188521]
mat_Sqrt:  [[17.8765463   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00099996  0.03724196  0.05015964]
Stock Position:  -0.0009999636071931113
Bond Position:  [-2.68943667]


portfolio before change:  [-2.78928832]
curr_Stock_Price:  99.51906518247857
curr_Factors:  [99.51906518 -0.85041654 -1.00687389]
mat_Sqrt:  [[15.5344293   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00510701  0.00389674 -0.1937992 ]
Stock Position:  0.005107005703728657
Bond Position:  [-3.29753275]


portfolio before change:  [-2.78858834]
curr_Stock_Price:  99.73684431627737
curr_Factors:  [99.73684432 -0.71881458 -1.02017063]
mat_Sqrt:  [[17.52362478  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00428195 0.00967669 0.0009852 ]
Stock Position:  0.0042819543303250955
Bond Position:  [-3.21565695]


portfolio before change:  [-2.7897123]
curr_Stock_Price:  99.56823462656412
curr_Factors:  [99.56823463 -0.37532505 -1.04839072]
mat_Sqrt:  [[23.97777634  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00042522 0.01754768 0.02759876]
Stock Position:  0.00042521835494799173
Bond Position:  [-2.83205054]


portfolio before change:  [-2.79017415]
curr_Stock_Price:  99.31465667989005
curr_Factors:  [99.31465668 -0.23713569 -1.0565526 ]
mat_Sqrt:  [[27.23777699  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00460191 -0.01155011 -0.31675981]
Stock Position:  -0.004601909383867023
Bond Position:  [-2.3331371]


portfolio before change:  [-2.78899017]
curr_Stock_Price:  98.99399898118057
curr_Factors:  [98.99399898 -0.31859044 -1.05351876]
mat_Sqrt:  [[25.10206297  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00439272 -0.00681542 -0.23684685]
Stock Position:  0.004392722153050831
Bond Position:  [-3.22384331]


portfolio before change:  [-2.79055148]
curr_Stock_Price:  98.73031292066544
curr_Factors:  [98.73031292 -0.2238646  -1.0628593 ]
mat_Sqrt:  [[27.26675305  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00203397 -0.00687492 -0.22767544]
Stock Position:  -0.00203397442221898
Bond Position:  [-2.58973655]


portfolio before change:  [-2.79394604]
curr_Stock_Price:  100.24007950230623
curr_Factors:  [100.2400795   -0.22496603  -1.07028548]
mat_Sqrt:  [[27.44863932  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00165315  0.03699982 -0.24466353]
Stock Position:  0.0016531516778113499
Bond Position:  [-2.9596581]


portfolio before change:  [-2.79548323]
curr_Stock_Price:  99.53403179404877
curr_Factors:  [99.53403179 -0.22686309 -1.08126502]
mat_Sqrt:  [[26.90659692  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00134369 -0.03388475 -0.06421028]
Stock Position:  -0.0013436867233669084
Bond Position:  [-2.66174067]


portfolio before change:  [-2.79449351]
curr_Stock_Price:  98.54983063361149
curr_Factors:  [98.54983063 -0.32923022 -1.07890625]
mat_Sqrt:  [[24.10515813  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00361319  0.00596272  0.03770251]
Stock Position:  -0.003613190609268821
Bond Position:  [-2.43841419]


portfolio before change:  [-2.7900433]
curr_Stock_Price:  97.23381016997246
curr_Factors:  [97.23381017 -0.37394682 -1.06753205]
mat_Sqrt:  [[23.0033447   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0038432  -0.03652661  0.17668641]
Stock Position:  -0.0038432043294494775
Bond Position:  [-2.4163539]


portfolio before change:  [-2.79095206]
curr_Stock_Price:  97.39167308525413
curr_Factors:  [97.39167309 -0.13387093 -1.06446024]
mat_Sqrt:  [[29.38280235  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00598905  0.04306354 -0.2396059 ]
Stock Position:  0.005989045618362544
Bond Position:  [-3.37423523]


portfolio before change:  [-2.80065529]
curr_Stock_Price:  95.84193988881589
curr_Factors:  [ 9.58419399e+01  4.88874698e-02 -1.05149917e+00]
mat_Sqrt:  [[35.16631551  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00200189 -0.23046577 -0.03019505]
Stock Position:  -0.0020018926871226087
Bond Position:  [-2.60879001]


portfolio before change:  [-2.79855835]
curr_Stock_Price:  94.63155627587406
curr_Factors:  [94.63155628  0.21895148 -1.03812364]
mat_Sqrt:  [[41.71325025  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00265109 -0.01986412 -0.53069456]
Stock Position:  -0.0026510860354223603
Bond Position:  [-2.54768195]


portfolio before change:  [-2.79795022]
curr_Stock_Price:  94.28203475109419
curr_Factors:  [94.28203475  0.18505378 -1.06448199]
mat_Sqrt:  [[39.12894423  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00643557  0.00134301 -0.82244731]
Stock Position:  0.006435571473630546
Bond Position:  [-3.40470899]


portfolio before change:  [-2.79755616]
curr_Stock_Price:  94.40940126525413
curr_Factors:  [94.40940127  0.27531799 -1.07538578]
mat_Sqrt:  [[42.41800289  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00508382  0.00600941 -0.82696901]
Stock Position:  -0.005083824910138664
Bond Position:  [-2.31759529]


portfolio before change:  [-2.82502633]
curr_Stock_Price:  99.75585902243282
curr_Factors:  [99.75585902  0.11200031 -1.06309756]
mat_Sqrt:  [[38.53737495  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00409422 -0.00931509 -0.02051735]
Stock Position:  0.004094224295584544
Bond Position:  [-3.23344919]


portfolio before change:  [-2.81282515]
curr_Stock_Price:  102.8346800491631
curr_Factors:  [ 1.02834680e+02  5.17430591e-02 -1.04240463e+00]
mat_Sqrt:  [[38.18569905  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00566987 0.00820485 0.66151181]
Stock Position:  0.005669869089912966
Bond Position:  [-3.39588432]


portfolio before change:  [-2.81440496]
curr_Stock_Price:  102.63091943420672
curr_Factors:  [102.63091943   0.19277107  -1.02993092]
mat_Sqrt:  [[44.43286477  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00141947  0.00991042 -0.14839647]
Stock Position:  -0.0014194663975619676
Bond Position:  [-2.66872382]


portfolio before change:  [-2.81540712]
curr_Stock_Price:  103.10190804918581
curr_Factors:  [103.10190805   0.37268804  -1.02936501]
mat_Sqrt:  [[53.46573185  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-9.71129205e-04  1.31469445e-01  1.48780933e+00]
Stock Position:  -0.0009711292051997744
Bond Position:  [-2.71528185]


portfolio before change:  [-2.8149193]
curr_Stock_Price:  102.2500568284139
curr_Factors:  [102.25005683   0.47737825  -1.02543748]
mat_Sqrt:  [[59.10775428  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00402708 -0.01706048  0.02933396]
Stock Position:  0.004027076098821315
Bond Position:  [-3.22668806]


portfolio before change:  [-2.82887702]
curr_Stock_Price:  98.88424829812551
curr_Factors:  [98.8842483   0.66443891 -1.02411792]
mat_Sqrt:  [[69.01134731  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00046304 0.00835814 0.39476097]
Stock Position:  0.0004630374660229823
Bond Position:  [-2.87466414]


portfolio before change:  [-2.82965524]
curr_Stock_Price:  97.97965880045444
curr_Factors:  [97.9796588   0.72367657 -1.00970911]
mat_Sqrt:  [[ 7.36060590e+01  0.00000000e+00  0.00000000e+00]
 [-8.16496581e-02  3.16227766e+00  0.00000000e+00]
 [-7.15541753e-02  0.00000000e+00  3.50542437e-01]]
grads:  [-1.67711646e-04 -4.37352880e-02  2.78293579e-01]
Stock Position:  -0.00016771164587988876
Bond Position:  [-2.81322291]


portfolio before change:  [-2.82925201]
curr_Stock_Price:  93.47845864914484
curr_Factors:  [93.47845865  0.6865718  -0.98493991]
mat_Sqrt:  [[69.36364714  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [3.31546911e-05 2.34610336e-02 6.06885796e-02]
Stock Position:  3.31546911267288e-05
Bond Position:  [-2.83235126]


portfolio before change:  [-2.82958768]
curr_Stock_Price:  94.03334022895042
curr_Factors:  [94.03334023  0.54856661 -0.94378333]
mat_Sqrt:  [[63.33465685  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00048229 -0.00678604 -0.01289113]
Stock Position:  0.0004822874079687889
Bond Position:  [-2.87493878]


portfolio before change:  [-2.82804046]
curr_Stock_Price:  97.98660773972713
curr_Factors:  [97.98660774  0.50836154 -0.96115915]
mat_Sqrt:  [[62.3044715   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00103829 -0.01276835  0.2046035 ]
Stock Position:  -0.001038294874881178
Bond Position:  [-2.72630147]


portfolio before change:  [-2.82478536]
curr_Stock_Price:  94.52332713130671
curr_Factors:  [94.52332713  0.3981313  -0.94544054]
mat_Sqrt:  [[54.68215435  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00478575 0.09649051 0.54066097]
Stock Position:  0.0047857510329875974
Bond Position:  [-3.27715047]


portfolio before change:  [-2.82992221]
curr_Stock_Price:  93.53556531438986
curr_Factors:  [93.53556531  0.18733008 -0.93879237]
mat_Sqrt:  [[44.11851136  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00204407 -0.01473026  0.17277764]
Stock Position:  0.0020440733092471695
Bond Position:  [-3.02111576]


portfolio before change:  [-2.83037627]
curr_Stock_Price:  93.49818996756582
curr_Factors:  [93.49818997  0.19314317 -0.93233354]
mat_Sqrt:  [[44.64541901  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00184522 -0.00286064  0.01896863]
Stock Position:  0.0018452236553572806
Bond Position:  [-3.00290134]


portfolio before change:  [-2.83126555]
curr_Stock_Price:  93.21969132286466
curr_Factors:  [93.21969132  0.20738727 -0.89276637]
mat_Sqrt:  [[46.97332457  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00511509 -0.03290443  0.13505307]
Stock Position:  0.005115094160244441
Bond Position:  [-3.30809305]


portfolio before change:  [-2.82442502]
curr_Stock_Price:  94.63786085480436
curr_Factors:  [ 9.46378609e+01 -7.47208206e-02 -8.70917034e-01]
mat_Sqrt:  [[36.76034791  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00100722 -0.02377073  0.06126702]
Stock Position:  -0.0010072183696896502
Bond Position:  [-2.72910403]


portfolio before change:  [-2.82297235]
curr_Stock_Price:  92.8568842563885
curr_Factors:  [92.85688426 -0.2058254  -0.86246943]
mat_Sqrt:  [[31.90505937  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00585204  0.00419201  0.03522026]
Stock Position:  -0.005852035513615021
Bond Position:  [-2.27957056]


portfolio before change:  [-2.81070254]
curr_Stock_Price:  90.71151585349931
curr_Factors:  [ 9.07115159e+01  4.28369230e-03 -8.67133521e-01]
mat_Sqrt:  [[38.27643709  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01026036 0.08125818 0.35367125]
Stock Position:  0.01026036180115887
Bond Position:  [-3.74143551]


portfolio before change:  [-2.84638458]
curr_Stock_Price:  87.27944068210275
curr_Factors:  [87.27944068  0.22321945 -0.87981019]
mat_Sqrt:  [[45.26455142  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-9.52626062e-05 -2.80506272e-02 -2.81633718e-01]
Stock Position:  -9.526260616461435e-05
Bond Position:  [-2.83807011]


portfolio before change:  [-2.84685477]
curr_Stock_Price:  88.49092945509273
curr_Factors:  [88.49092946  0.10824843 -0.87694181]
mat_Sqrt:  [[41.02602724  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00067502 0.03260049 0.1067148 ]
Stock Position:  0.0006750217725087201
Bond Position:  [-2.90658807]


portfolio before change:  [-2.84795763]
curr_Stock_Price:  87.39538326696679
curr_Factors:  [ 8.73953833e+01  2.28493787e-03 -8.59734997e-01]
mat_Sqrt:  [[37.07683568  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01397292 -0.2113124  -0.50570174]
Stock Position:  0.01397291524891573
Bond Position:  [-4.06912592]


portfolio before change:  [-2.81885669]
curr_Stock_Price:  89.5144555430863
curr_Factors:  [89.51445554  0.2639366  -0.86504107]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-2.81885669]
Stock Price:  91.33275901727092
PL:  [-2.81885669]
Settle:  Tensor("sub_172:0", shape=(), dtype=float64)
PL:  Tensor("sub_173:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  87
output_Z_Vals[:, i, :]:  [[ 1.19260232e+02 -2.92559343e+01 -2.92733494e+01]
 [ 4.27165619e-02  5.62901735e-02 -6.73294315e-02]
 [-3.08189599e-02  5.03481308e-02  1.13136143e-01]
 [-9.10267698e-02  4.00668900e-02  8.83973653e-03]
 [ 1.56705726e-02  3.77835360e-02 -7.16733288e-02]
 [ 6.61637368e-02  2.90190897e-02 -4.65589985e-02]
 [ 7.76805572e-02  1.25363433e-02 -7.19659971e-02]
 [-9.18611886e-02 -6.82171774e-04 -9.79660103e-02]
 [ 4.12998984e-02 -4.51138852e-02 -5.53453215e-02]
 [-1.29050065e-01 -1.59586920e-01 -1.00917000e-01]
 [ 1.71874075e-01  9.45317804e-02  1.65072104e-01]
 [-2.42801475e-01 -1.13427103e-01  6.84745390e-02]
 [-7.35528204e-02 -1.21845434e-03  1.53473668e-02]
 [-9.62623594e-02 -1.14884369e-01  6.32126881e-02]
 [ 2.72560124e-01  3.09064685e-01  4.89995964e-03]
 [-2.90265807e-02 -5.91130138e-01 -1.76346679e-02]
 [-6.65990255e-02 -3.55482294e-02 -3.26425397e-02]
 [ 3.31019828e-02  8.86766969e-02 -8.84669487e-02]
 [-8.78978624e-02  4.26957904e-02 -1.66324248e-01]
 [-6.31342985e-02 -2.65365984e-02  1.41672356e-01]
 [ 1.46179230e-01 -1.30531395e-01  6.66299060e-02]
 [ 1.15623421e-01  1.49939843e-01  3.20253934e-01]
 [-2.40338496e-02 -8.26812197e-02  1.84874930e-01]
 [-6.67572139e-02 -6.09518859e-04 -8.25442966e-02]
 [-7.27757243e-01  1.97077712e-01  3.82433421e-02]
 [-1.53640545e-01 -2.78244004e-01  1.37556762e-01]
 [ 7.34349285e-02  6.23210170e-02 -5.14414691e-02]
 [ 2.82056500e-02 -4.93341808e-02 -2.49989186e-02]
 [-1.09379479e-01 -1.35908443e-01 -1.31741037e-01]
 [ 1.22080674e-01  1.59862554e-01  2.23129915e-02]
 [ 5.02588400e-02 -1.00690640e-02  3.60918544e-02]
 [ 8.06398264e-02 -7.14719332e-02 -5.35043934e-02]
 [ 3.37808678e-01 -3.26319434e-01 -2.64778473e-01]
 [-4.50887302e-02 -8.06562208e-02  6.01610198e-03]
 [-1.62337337e-01  1.66423038e-02  2.13520185e-02]
 [ 4.50753866e-02 -1.23762718e-01 -8.43268079e-02]
 [-2.09529180e-02 -1.35244298e-01 -5.66683786e-02]
 [-2.22580865e-02  1.81358988e-02 -7.45548499e-02]
 [-2.93413676e-02  6.50529815e-03  1.64829567e-02]
 [-7.33326342e-01  3.66291812e-01  4.49760646e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.26023247 -29.25593426 -29.27334937]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  8.31486419  -9.25153874 -83.50871763]
init_Out:  [2.49911038]
Stock Position:  8.31486419409362
Bond position:  [-828.98730903]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-3.78973741]
curr_Stock_Price:  99.2561252047937
curr_Factors:  [99.2561252  -0.88227626 -1.00055538]
mat_Sqrt:  [[15.10267669  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00201464  0.01780052 -0.19207213]
Stock Position:  0.00201463660555798
Bond Position:  [-3.98970243]


portfolio before change:  [-3.7896115]
curr_Stock_Price:  99.56618436616345
curr_Factors:  [99.56618437 -0.83996256 -0.98952652]
mat_Sqrt:  [[15.97992924  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00040208  0.01592148  0.32274593]
Stock Position:  -0.00040207676167538473
Bond Position:  [-3.74957825]


portfolio before change:  [-3.78958445]
curr_Stock_Price:  98.3331455105568
curr_Factors:  [98.33314551 -0.79062902 -0.9979797 ]
mat_Sqrt:  [[16.44057618  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00536404  0.01267026  0.02521731]
Stock Position:  -0.005364036062008325
Bond Position:  [-3.26212191]


portfolio before change:  [-3.79121205]
curr_Stock_Price:  98.56055109797927
curr_Factors:  [98.5605511  -0.92146346 -0.99712827]
mat_Sqrt:  [[14.47002647  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 1.39314353e-04  1.19482032e-02 -2.04464057e-01]
Stock Position:  0.00013931435337690836
Bond Position:  [-3.80494295]


portfolio before change:  [-3.79163535]
curr_Stock_Price:  98.93630155075516
curr_Factors:  [98.93630155 -1.02655385 -1.00916138]
mat_Sqrt:  [[12.9197997   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0044435   0.00917664 -0.13281986]
Stock Position:  0.004443504698728358
Bond Position:  [-4.23125927]


portfolio before change:  [-3.79476036]
curr_Stock_Price:  98.35206121332122
curr_Factors:  [98.35206121 -1.10696989 -1.01095911]
mat_Sqrt:  [[11.82983227  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00535208  0.00396434 -0.20529896]
Stock Position:  0.005352083202355108
Bond Position:  [-4.32114878]


portfolio before change:  [-3.79526247]
curr_Stock_Price:  98.35917435445599
curr_Factors:  [98.35917435 -1.09002047 -1.02426364]
mat_Sqrt:  [[11.87388817  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-9.42202156e-03 -2.15721656e-04 -2.79469759e-01]
Stock Position:  -0.00942202155972132
Bond Position:  [-2.86852021]


portfolio before change:  [-3.78890136]
curr_Stock_Price:  97.64598366371969
curr_Factors:  [97.64598366 -0.90612854 -1.03877693]
mat_Sqrt:  [[13.96344796  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00206523 -0.01426626 -0.1578848 ]
Stock Position:  0.002065231059120599
Bond Position:  [-3.99056288]


portfolio before change:  [-3.79148972]
curr_Stock_Price:  96.6342290805982
curr_Factors:  [96.63422908 -0.87784021 -1.04193702]
mat_Sqrt:  [[14.17040713  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0108515  -0.05046582 -0.28788811]
Stock Position:  -0.010851500330845714
Bond Position:  [-2.74286335]


portfolio before change:  [-3.78154221]
curr_Stock_Price:  95.68593724572506
curr_Factors:  [95.68593725 -0.85597679 -1.04671482]
mat_Sqrt:  [[14.27314412  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01457353 0.02989357 0.47090477]
Stock Position:  0.014573528855275986
Bond Position:  [-5.17602398]


portfolio before change:  [-3.78951155]
curr_Stock_Price:  95.1834993402105
curr_Factors:  [95.18349934 -0.54302657 -1.04583188]
mat_Sqrt:  [[19.43252397  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01192603 -0.0358688   0.1953388 ]
Stock Position:  -0.011926028938681988
Bond Position:  [-2.65435038]


portfolio before change:  [-3.8105941]
curr_Stock_Price:  96.92345282175162
curr_Factors:  [96.92345282 -0.68854942 -1.05535041]
mat_Sqrt:  [[16.9458283   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00415745 -0.00038531  0.04378177]
Stock Position:  -0.004157454646501334
Bond Position:  [-3.40763924]


portfolio before change:  [-3.81341189]
curr_Stock_Price:  97.49875956465654
curr_Factors:  [97.49875956 -0.64189387 -1.07144746]
mat_Sqrt:  [[17.57536719  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00491173 -0.03632963  0.1803282 ]
Stock Position:  -0.004911728114417556
Bond Position:  [-3.33452449]


portfolio before change:  [-3.81454901]
curr_Stock_Price:  97.6454040973012
curr_Factors:  [97.6454041  -0.65079272 -1.07146143]
mat_Sqrt:  [[17.44561705  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01613817 0.09773483 0.01397822]
Stock Position:  0.016138170357092307
Bond Position:  [-5.39036718]


portfolio before change:  [-3.83832489]
curr_Stock_Price:  96.21388855653822
curr_Factors:  [96.21388856 -0.77531936 -1.07713407]
mat_Sqrt:  [[15.09132817  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00317329 -0.18693176 -0.0503068 ]
Stock Position:  -0.0031732897343247505
Bond Position:  [-3.53301034]


portfolio before change:  [-3.84237428]
curr_Stock_Price:  97.35079464497761
curr_Factors:  [97.35079464 -0.57530728 -1.10563231]
mat_Sqrt:  [[18.12661515  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00409233 -0.01124134 -0.09312008]
Stock Position:  -0.004092325386105277
Bond Position:  [-3.44398315]


portfolio before change:  [-3.8384264]
curr_Stock_Price:  96.2808896269077
curr_Factors:  [96.28088963 -0.69964578 -1.08823776]
mat_Sqrt:  [[16.10913198  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.001076    0.02804203 -0.25237158]
Stock Position:  0.0010759962111805343
Bond Position:  [-3.94202427]


portfolio before change:  [-3.83972766]
curr_Stock_Price:  95.52951624543638
curr_Factors:  [95.52951625 -0.79099253 -1.06352943]
mat_Sqrt:  [[14.95302036  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00807504  0.01350159 -0.47447678]
Stock Position:  -0.008075041283248496
Bond Position:  [-3.06832287]


portfolio before change:  [-3.84210631]
curr_Stock_Price:  95.77658445592769
curr_Factors:  [95.77658446 -1.12136346 -1.05728535]
mat_Sqrt:  [[10.8413706   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00321922 -0.00839161  0.4041518 ]
Stock Position:  -0.0032192167581926345
Bond Position:  [-3.53378072]


portfolio before change:  [-3.84314769]
curr_Stock_Price:  95.96284990833438
curr_Factors:  [95.96284991 -1.06022539 -1.06147403]
mat_Sqrt:  [[11.49901883  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.013602   -0.04127765  0.19007658]
Stock Position:  0.013602003651205322
Bond Position:  [-5.14843472]


portfolio before change:  [-3.84956573]
curr_Stock_Price:  95.5383209555312
curr_Factors:  [95.53832096 -0.97289962 -1.05957486]
mat_Sqrt:  [[12.51656488  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01476974 0.04741514 0.91359533]
Stock Position:  0.014769740186885856
Bond Position:  [-5.26064191]


portfolio before change:  [-3.85149369]
curr_Stock_Price:  95.45231116271266
curr_Factors:  [95.45231116 -0.9943822  -1.05548233]
mat_Sqrt:  [[12.28970885  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00094134 -0.0261461   0.52739672]
Stock Position:  0.0009413378062435369
Bond Position:  [-3.94134656]


portfolio before change:  [-3.85141919]
curr_Stock_Price:  96.05485668785823
curr_Factors:  [96.05485669 -0.85854355 -1.05203197]
mat_Sqrt:  [[14.21565664  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-5.88240401e-03 -1.92746787e-04 -2.35475902e-01]
Stock Position:  -0.0058824040099289526
Bond Position:  [-3.28638572]


portfolio before change:  [-3.84488463]
curr_Stock_Price:  94.87415129383476
curr_Factors:  [94.87415129 -1.23766791 -1.06200394]
mat_Sqrt:  [[ 9.5150946   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.07512929  0.06232144  0.10909761]
Stock Position:  -0.0751292928076084
Bond Position:  [3.28294326]


portfolio before change:  [-3.81912696]
curr_Stock_Price:  94.53676921573715
curr_Factors:  [94.53676922 -1.0760879  -1.06195688]
mat_Sqrt:  [[11.14447742  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01191138 -0.08798848  0.39241115]
Stock Position:  -0.011911381076950452
Bond Position:  [-2.69306348]


portfolio before change:  [-3.82396672]
curr_Stock_Price:  94.91482000745253
curr_Factors:  [94.91482001 -1.00732697 -1.03367837]
mat_Sqrt:  [[12.32925036  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.005235    0.01970764 -0.14674819]
Stock Position:  0.005234998273715194
Bond Position:  [-4.32084564]


portfolio before change:  [-3.82714849]
curr_Stock_Price:  94.41021000633367
curr_Factors:  [94.41021001 -0.98530086 -1.02616793]
mat_Sqrt:  [[12.63133248  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00172816 -0.01560084 -0.07131496]
Stock Position:  0.0017281600403330174
Bond Position:  [-3.99030444]


portfolio before change:  [-3.82594442]
curr_Stock_Price:  95.3955877210081
curr_Factors:  [95.39558772 -0.47588168 -1.02130153]
mat_Sqrt:  [[21.34567451  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00654841 -0.04297802 -0.37582051]
Stock Position:  -0.006548406174371719
Bond Position:  [-3.20125537]


portfolio before change:  [-3.83028398]
curr_Stock_Price:  95.99716626819574
curr_Factors:  [95.99716627 -0.57723753 -1.05059806]
mat_Sqrt:  [[18.84943782  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00693723 0.05055298 0.06365275]
Stock Position:  0.006937232230807748
Bond Position:  [-4.49623862]


portfolio before change:  [-3.82676216]
curr_Stock_Price:  96.5858571454001
curr_Factors:  [96.58585715 -0.78438414 -1.04205165]
mat_Sqrt:  [[15.54900316  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00368937 -0.00318412  0.10296001]
Stock Position:  0.0036893732804388502
Bond Position:  [-4.18310344]


portfolio before change:  [-3.83256779]
curr_Stock_Price:  95.1539858188717
curr_Factors:  [95.15398582 -0.71534222 -1.04526652]
mat_Sqrt:  [[16.36079204  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00414851 -0.02260141 -0.15263314]
Stock Position:  0.004148508843194864
Bond Position:  [-4.22731494]


portfolio before change:  [-3.82733086]
curr_Stock_Price:  96.54373437892015
curr_Factors:  [96.54373438 -0.96918975 -1.04368233]
mat_Sqrt:  [[12.89866778  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.02134604 -0.10319127 -0.75533928]
Stock Position:  0.021346039110270214
Bond Position:  [-5.88815719]


portfolio before change:  [-3.83756391]
curr_Stock_Price:  96.09882799846072
curr_Factors:  [96.098828   -1.0002703  -1.03078979]
mat_Sqrt:  [[12.60781723  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00364403 -0.02550574  0.01716226]
Stock Position:  -0.003644027540711249
Bond Position:  [-3.48737713]


portfolio before change:  [-3.84060491]
curr_Stock_Price:  96.81371000421387
curr_Factors:  [96.81371    -1.07279352 -1.02875039]
mat_Sqrt:  [[11.83717143  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0133097   0.00526276  0.06091137]
Stock Position:  -0.013309697598567528
Bond Position:  [-2.55204371]


portfolio before change:  [-3.84909548]
curr_Stock_Price:  97.42766442380838
curr_Factors:  [97.42766442 -1.1336167  -1.03040778]
mat_Sqrt:  [[11.19072958  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00220421 -0.03913721 -0.24056091]
Stock Position:  0.0022042092290526466
Bond Position:  [-4.06384644]


portfolio before change:  [-3.84919022]
curr_Stock_Price:  97.6151556751644
curr_Factors:  [97.61515568 -1.1071673  -1.02366427]
mat_Sqrt:  [[11.59067843  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.003107   -0.042768   -0.16165911]
Stock Position:  -0.0031070049396019895
Bond Position:  [-3.54589945]


portfolio before change:  [-3.85086057]
curr_Stock_Price:  98.01009563718621
curr_Factors:  [98.01009564 -1.06549728 -1.01300171]
mat_Sqrt:  [[12.26281492  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00301793  0.00573507 -0.21268423]
Stock Position:  -0.0030179257248567825
Bond Position:  [-3.55507338]


portfolio before change:  [-3.85270151]
curr_Stock_Price:  98.47283900036717
curr_Factors:  [98.472839   -1.02347378 -1.03666193]
mat_Sqrt:  [[12.5490512   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00205664  0.00205716  0.04702129]
Stock Position:  -0.0020566361294966106
Bond Position:  [-3.65017871]


portfolio before change:  [-3.85420375]
curr_Stock_Price:  98.9814100683462
curr_Factors:  [98.98141007 -0.93328892 -1.06899507]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-3.85420375]
Stock Price:  99.68734915621474
PL:  [-3.85420375]
Settle:  Tensor("sub_174:0", shape=(), dtype=float64)
PL:  Tensor("sub_175:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  88
output_Z_Vals[:, i, :]:  [[ 1.19260232e+02 -2.92559343e+01 -2.92733494e+01]
 [ 6.08581467e-02 -1.06122350e-01 -1.52010764e-01]
 [-5.18660818e-02  1.09385096e-02  1.00920570e-01]
 [-6.90970293e-02  8.67561261e-02  1.05624669e-02]
 [ 8.34946266e-02  1.54185183e-02 -6.83894299e-02]
 [ 7.30394684e-02  3.03748720e-02 -3.00906892e-02]
 [ 5.30620716e-02  2.75008360e-02 -5.72211982e-02]
 [-1.36006397e-01  1.13355371e-01 -5.61815952e-02]
 [ 4.98616044e-02  1.95149364e-02 -6.61070162e-02]
 [-2.69052707e-02  3.72099834e-01  1.50654507e-01]
 [ 5.80117136e-02  9.22344522e-02 -8.22900879e-02]
 [-3.77974446e-02  1.74098384e-02 -1.86359727e-03]
 [-3.41538384e-02 -1.10892301e-01 -4.76920693e-02]
 [ 2.10556743e-01  1.82032939e-01  2.71024033e-01]
 [ 1.24614027e-01  8.70451001e-02 -5.57096967e-02]
 [-5.24812500e-02 -6.12439577e-02 -1.23007437e-01]
 [-9.01186767e-02  2.78768984e-02 -9.64500778e-02]
 [ 4.70902240e-02 -2.20469022e-01 -1.02793993e-01]
 [ 4.19680447e-02  5.31320708e-02  3.29182955e-02]
 [ 1.63567919e-01 -2.23951725e-01 -1.98649126e-02]
 [ 2.59819232e-01 -9.21157282e-05  3.79781785e-01]
 [-3.73442126e-02  2.03463798e-02 -3.65140633e-02]
 [-1.44592982e-01  3.87638330e-01  2.19657791e-01]
 [ 2.50643818e-01 -5.59495934e-02  7.69914555e-02]
 [-4.15156591e-02 -6.12845476e-03 -2.34070831e-02]
 [ 1.00547105e-01  6.45750551e-03  5.61774549e-02]
 [-1.82941752e-01  7.18842603e-02  7.20349207e-02]
 [-5.07806065e-02  7.36225950e-02  2.93687317e-02]
 [-6.93976374e-02 -6.40245219e-02 -2.15274284e-01]
 [ 7.55371587e-03 -5.99656216e-03 -1.15370639e-01]
 [ 2.29871070e-02  1.36832569e-01  3.06632592e-02]
 [ 1.59482830e-02 -7.99770561e-02 -8.67275435e-02]
 [ 1.86897634e-02 -1.31858889e-02  7.34782536e-02]
 [-5.14078102e-02 -8.68252891e-02 -1.13676706e-02]
 [-1.70446671e-01  1.39670654e-01  3.00026045e-02]
 [ 6.86865076e-02 -1.51742139e-01 -1.31336056e-01]
 [-6.65325956e-02 -1.84093930e-01 -2.50427549e-02]
 [-2.66873825e-02  4.62039675e-03 -5.29832520e-02]
 [-4.89551690e-02  9.46916434e-02  1.03110895e-02]
 [-4.05678444e-01  2.13547179e-01  2.44538391e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.26023247 -29.25593426 -29.27334937]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  8.31486419  -9.25153874 -83.50871763]
init_Out:  [2.49911038]
Stock Position:  8.31486419409362
Bond position:  [-828.98730903]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-4.16373231]
curr_Stock_Price:  99.2111461292059
curr_Factors:  [99.21114613 -1.08434303 -0.97748456]
mat_Sqrt:  [[12.6217659   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00214621 -0.03355883 -0.4336444 ]
Stock Position:  0.0021462141157967286
Bond Position:  [-4.37666068]


portfolio before change:  [-4.16443593]
curr_Stock_Price:  99.13822682111308
curr_Factors:  [99.13822682 -1.04725982 -0.95015505]
mat_Sqrt:  [[13.45162937  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00230331  0.00345906  0.2878983 ]
Stock Position:  -0.0023033139512105795
Bond Position:  [-3.93608947]


portfolio before change:  [-4.16514985]
curr_Stock_Price:  99.23455771284505
curr_Factors:  [99.23455771 -0.69416452 -0.93707926]
mat_Sqrt:  [[19.41881686  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00333187  0.0274347   0.03013178]
Stock Position:  -0.003331868346855773
Bond Position:  [-3.83451337]


portfolio before change:  [-4.16601296]
curr_Stock_Price:  99.34973795406339
curr_Factors:  [99.34973795 -0.82690062 -0.91711321]
mat_Sqrt:  [[17.36805324  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00402652  0.00487576 -0.19509601]
Stock Position:  0.004026519044134582
Bond Position:  [-4.56604658]


portfolio before change:  [-4.16598204]
curr_Stock_Price:  99.49917667902474
curr_Factors:  [99.49917668 -0.68187687 -0.92547748]
mat_Sqrt:  [[19.94134109  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00339403  0.00960538 -0.08584036]
Stock Position:  0.003394029904043058
Bond Position:  [-4.50368522]


portfolio before change:  [-4.16703679]
curr_Stock_Price:  99.35428859848122
curr_Factors:  [99.3542886  -0.71961729 -0.91417887]
mat_Sqrt:  [[19.3926859   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0021705   0.00869653 -0.16323615]
Stock Position:  0.0021705044969487514
Bond Position:  [-4.38268572]


portfolio before change:  [-4.16543687]
curr_Stock_Price:  100.34382400492119
curr_Factors:  [100.343824    -0.8341138   -0.91547337]
mat_Sqrt:  [[17.44434197  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00828622  0.03584612 -0.16027045]
Stock Position:  -0.008286216498828889
Bond Position:  [-3.33396622]


portfolio before change:  [-4.17697529]
curr_Stock_Price:  101.68601145595802
curr_Factors:  [101.68601146  -0.79350305  -0.88778334]
mat_Sqrt:  [[18.92726272  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00194806  0.00617116 -0.18858492]
Stock Position:  0.0019480598045954116
Bond Position:  [-4.37506573]


portfolio before change:  [-4.17680264]
curr_Stock_Price:  102.05538873714559
curr_Factors:  [102.05538874  -0.76804126  -0.89424724]
mat_Sqrt:  [[19.36035057  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00069495 0.1176683  0.42977538]
Stock Position:  0.0006949527145162875
Bond Position:  [-4.24772631]


portfolio before change:  [-4.17832617]
curr_Stock_Price:  100.6271898536352
curr_Factors:  [100.62718985  -0.69868111  -0.90442314]
mat_Sqrt:  [[20.25331011  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00215253  0.02916709 -0.23475072]
Stock Position:  0.002152527306214476
Bond Position:  [-4.39492895]


portfolio before change:  [-4.17894272]
curr_Stock_Price:  100.5959932916596
curr_Factors:  [100.59599329  -0.6425368   -0.90893319]
mat_Sqrt:  [[21.31993256  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00176963  0.00550547 -0.00531632]
Stock Position:  -0.0017696270643759043
Bond Position:  [-4.00092533]


portfolio before change:  [-4.18450783]
curr_Stock_Price:  103.45815244383864
curr_Factors:  [103.45815244  -0.77056271  -0.93378618]
mat_Sqrt:  [[18.81808396  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00248443 -0.03506722 -0.1360522 ]
Stock Position:  -0.002484427653447363
Bond Position:  [-3.92747353]


portfolio before change:  [-4.18278757]
curr_Stock_Price:  102.56812029894309
curr_Factors:  [102.5681203   -0.86383363  -0.9201284 ]
mat_Sqrt:  [[17.22850265  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01570533 0.05756387 0.77315613]
Stock Position:  0.015705332506457205
Bond Position:  [-5.793654]


portfolio before change:  [-4.1582407]
curr_Stock_Price:  104.17719958485073
curr_Factors:  [104.17719958  -1.04316157  -0.92784181]
mat_Sqrt:  [[14.51365476  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00795732  0.02752608 -0.15892426]
Stock Position:  0.007957322210771363
Bond Position:  [-4.98721224]


portfolio before change:  [-4.15399789]
curr_Stock_Price:  104.78874231814741
curr_Factors:  [104.78874232  -1.02708853  -0.92946108]
mat_Sqrt:  [[14.81139387  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0053453  -0.01936704 -0.35090598]
Stock Position:  -0.00534530043634791
Bond Position:  [-3.59387058]


portfolio before change:  [-4.15494419]
curr_Stock_Price:  104.88172693437853
curr_Factors:  [104.88172693  -0.82516497  -0.90259085]
mat_Sqrt:  [[18.63567008  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00585365  0.00881545 -0.27514523]
Stock Position:  -0.005853649880980104
Bond Position:  [-3.54100328]


portfolio before change:  [-4.14982763]
curr_Stock_Price:  103.93202741348337
curr_Factors:  [103.93202741  -0.72313528  -0.89843298]
mat_Sqrt:  [[20.53578233  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00099412 -0.06971843 -0.29324265]
Stock Position:  0.0009941185607507286
Bond Position:  [-4.25314839]


portfolio before change:  [-4.14849536]
curr_Stock_Price:  105.80700011759392
curr_Factors:  [105.80700012  -1.03452117  -0.9121315 ]
mat_Sqrt:  [[15.10406655  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00331429 0.01680184 0.09390673]
Stock Position:  0.0033142947037871
Bond Position:  [-4.49917094]


portfolio before change:  [-4.1471059]
curr_Stock_Price:  106.39593370580302
curr_Factors:  [106.39593371  -0.73920685  -0.92507608]
mat_Sqrt:  [[20.14355576  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00763175 -0.07081975 -0.05666907]
Stock Position:  0.0076317510052833284
Bond Position:  [-4.95909317]


portfolio before change:  [-4.15002734]
curr_Stock_Price:  106.09436236064589
curr_Factors:  [106.09436236  -0.84497778  -0.95342175]
mat_Sqrt:  [[17.56537052  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 1.92048033e-02 -2.91295509e-05  1.08341172e+00]
Stock Position:  0.019204803295550125
Bond Position:  [-6.1875487]


portfolio before change:  [-4.14065822]
curr_Stock_Price:  106.62249101911937
curr_Factors:  [106.62249102  -1.07067519  -0.95666568]
mat_Sqrt:  [[14.04060652  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00315316  0.00643409 -0.10416446]
Stock Position:  -0.0031531596052898326
Bond Position:  [-3.80446049]


portfolio before change:  [-4.13930078]
curr_Stock_Price:  106.04116042175656
curr_Factors:  [106.04116042  -1.12926975  -0.95588463]
mat_Sqrt:  [[13.1796364   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0068095   0.122582    0.62662254]
Stock Position:  -0.00680950081890445
Bond Position:  [-3.41721341]


portfolio before change:  [-4.13695238]
curr_Stock_Price:  105.6335558664281
curr_Factors:  [105.63355587  -1.12919448  -0.92358235]
mat_Sqrt:  [[13.56101668  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01953504 -0.01769281  0.21963519]
Stock Position:  0.019535041279379224
Bond Position:  [-6.20050825]


portfolio before change:  [-4.1422167]
curr_Stock_Price:  105.40375263540376
curr_Factors:  [105.40375264  -1.06749078  -0.90939778]
mat_Sqrt:  [[14.59836718  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00318199 -0.00193799 -0.06677389]
Stock Position:  -0.0031819891465592488
Bond Position:  [-3.80682311]


portfolio before change:  [-4.13777722]
curr_Stock_Price:  103.85900467604405
curr_Factors:  [103.85900468  -1.01582705  -0.91896625]
mat_Sqrt:  [[15.00286159  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00747731 0.00204204 0.16025864]
Stock Position:  0.007477307663336929
Bond Position:  [-4.91436295]


portfolio before change:  [-4.15103391]
curr_Stock_Price:  102.16824160643577
curr_Factors:  [102.16824161  -0.99298059  -0.90606994]
mat_Sqrt:  [[15.29567869  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01087769  0.0227318   0.20549558]
Stock Position:  -0.010877689372865679
Bond Position:  [-3.03967951]


portfolio before change:  [-4.15136054]
curr_Stock_Price:  102.16333680079524
curr_Factors:  [102.1633368   -0.81915369  -0.90722856]
mat_Sqrt:  [[18.17761     0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00235921  0.02328151  0.08378082]
Stock Position:  -0.0023592106998311805
Bond Position:  [-3.9103357]


portfolio before change:  [-4.1476667]
curr_Stock_Price:  100.39043058360015
curr_Factors:  [100.39043058  -0.75001404  -0.88104829]
mat_Sqrt:  [[19.64857013  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00585251 -0.02024633 -0.61411761]
Stock Position:  -0.0058525084467862965
Bond Position:  [-3.56013086]


portfolio before change:  [-4.14876346]
curr_Stock_Price:  100.50178777126641
curr_Factors:  [100.50178777  -0.8089776   -0.85543443]
mat_Sqrt:  [[19.0251824   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00084893 -0.00189628 -0.32912032]
Stock Position:  -0.0008489299857223097
Bond Position:  [-4.06344448]


portfolio before change:  [-4.14973334]
curr_Stock_Price:  101.04590020022708
curr_Factors:  [101.0459002   -0.84853987  -0.82359536]
mat_Sqrt:  [[18.98102219  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00172695 0.04327026 0.08747374]
Stock Position:  0.0017269470529940193
Bond Position:  [-4.32423426]


portfolio before change:  [-4.14949376]
curr_Stock_Price:  101.49764620553441
curr_Factors:  [101.49764621  -0.68478372  -0.80933817]
mat_Sqrt:  [[22.78070085  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-1.67681470e-04 -2.52909658e-02 -2.47409541e-01]
Stock Position:  -0.00016768147028839556
Bond Position:  [-4.13247448]


portfolio before change:  [-4.15021381]
curr_Stock_Price:  102.71099242696381
curr_Factors:  [102.71099243  -0.84327294  -0.77743267]
mat_Sqrt:  [[20.31203437  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00164178 -0.00416974  0.20961301]
Stock Position:  0.0016417848807167336
Bond Position:  [-4.31884316]


portfolio before change:  [-4.15153732]
curr_Stock_Price:  102.23369191155038
curr_Factors:  [102.23369191  -0.84078853  -0.78480657]
mat_Sqrt:  [[20.11903116  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00278195 -0.02745657 -0.0324288 ]
Stock Position:  -0.002781945368586954
Bond Position:  [-3.86712877]


portfolio before change:  [-4.14883017]
curr_Stock_Price:  101.08680506242744
curr_Factors:  [101.08680506  -0.85372436  -0.80850839]
mat_Sqrt:  [[19.17767524  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00838038  0.04416774  0.08558908]
Stock Position:  -0.008380376258625944
Bond Position:  [-3.3016847]


portfolio before change:  [-4.13745119]
curr_Stock_Price:  99.67974317369188
curr_Factors:  [99.67974317 -0.9671653  -0.80966861]
mat_Sqrt:  [[16.86311287  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00225105 -0.04798508 -0.37466521]
Stock Position:  0.002251048337505413
Bond Position:  [-4.36183511]


portfolio before change:  [-4.13748443]
curr_Stock_Price:  99.90720532118019
curr_Factors:  [99.90720532 -0.84266335 -0.81599491]
mat_Sqrt:  [[19.02175929  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00401633 -0.05821561 -0.07144001]
Stock Position:  -0.004016332569161853
Bond Position:  [-3.73622387]


portfolio before change:  [-4.14030284]
curr_Stock_Price:  100.49265230625204
curr_Factors:  [100.49265231  -1.02058973  -0.81633869]
mat_Sqrt:  [[16.00908211  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00233513  0.0014611  -0.15114647]
Stock Position:  -0.002335127345541846
Bond Position:  [-3.9056397]


portfolio before change:  [-4.13947835]
curr_Stock_Price:  99.93048961388527
curr_Factors:  [99.93048961 -1.01097936 -0.82252065]
mat_Sqrt:  [[15.97419854  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00277983  0.02994413  0.02941467]
Stock Position:  -0.002779826406306294
Bond Position:  [-3.86168894]


portfolio before change:  [-4.14324679]
curr_Stock_Price:  101.11246887811058
curr_Factors:  [101.11246888  -1.22225789  -0.85506738]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-4.14324679]
Stock Price:  101.3882088651773
PL:  [-5.53145565]
Settle:  Tensor("sub_176:0", shape=(), dtype=float64)
PL:  Tensor("sub_177:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  89
output_Z_Vals[:, i, :]:  [[ 1.19260232e+02 -2.92559343e+01 -2.92733494e+01]
 [ 4.03706775e-03 -1.27034308e-01 -3.91946428e-02]
 [-4.89620901e-02  1.63760802e-02  1.02606022e-01]
 [-8.38434194e-02  5.17782278e-02  1.07276720e-02]
 [ 9.51810808e-02  1.15649038e-02 -6.78235962e-02]
 [ 3.53162350e-02  2.78746454e-02  6.65181258e-02]
 [-8.20010835e-03  5.87339241e-02  3.46703634e-02]
 [-1.33567137e-01  1.40090508e-01 -4.31413385e-02]
 [ 8.58407937e-04 -3.72656042e-02  9.55490091e-03]
 [-6.69331718e-02  2.15904814e-01  7.47721045e-02]
 [ 5.65960624e-02  1.23836837e-01 -8.20898151e-02]
 [-8.89366545e-02  2.07729255e-02  1.83482758e-02]
 [-1.13474754e-01  4.84510785e-02 -4.18682963e-02]
 [-9.62623594e-02 -1.14884369e-01  6.32126881e-02]
 [ 3.02968613e-01  3.93050447e-01  6.08604329e-02]
 [-6.79115298e-02 -1.51078314e-01 -9.32697666e-02]
 [-6.75495561e-02 -6.33887935e-02 -4.55159740e-02]
 [-7.28342283e-02  2.24611837e-01  1.38876524e-01]
 [ 8.10596954e-02  6.99226092e-02  8.66864649e-02]
 [-4.59580829e-02 -1.65610012e-02  1.17012431e-01]
 [ 3.64514527e-02 -7.54220303e-02  4.57739867e-02]
 [ 1.26834737e-01 -4.12276876e-02  2.15870189e-01]
 [-1.68533044e-02 -1.08717553e-01  1.80165767e-01]
 [-6.26431411e-02 -1.27187492e-02 -8.39423689e-02]
 [-5.59720621e-01  1.70817576e-01  2.94736770e-02]
 [-1.06730908e-01 -2.24973345e-01  1.22455440e-01]
 [ 2.20213848e-01  5.45137271e-02 -1.45347948e-01]
 [ 5.72223529e-02 -1.67278119e-01 -7.42703265e-02]
 [-1.21334068e-01 -1.43587122e-01 -1.18759581e-01]
 [ 2.58806636e-02  1.13419583e-02 -1.20143918e-01]
 [ 6.29706136e-02 -3.07509050e-02  4.83921980e-02]
 [ 8.71507305e-02 -8.23156585e-02 -6.54443290e-02]
 [ 3.02413628e-01 -2.59306218e-01 -1.72184165e-01]
 [-4.42704244e-02 -7.98573411e-02  8.26725911e-03]
 [-1.56984731e-01 -2.87635177e-02  1.89128594e-02]
 [ 3.19688503e-02 -8.53702539e-02 -5.76253455e-02]
 [-1.32980184e-02 -1.22570121e-01 -6.50946277e-02]
 [-1.50868766e-02  2.70382893e-02 -6.62622841e-02]
 [ 1.39972461e-01 -2.23214132e-01 -3.40415117e-02]
 [-7.57935476e-01  3.85857226e-01  4.53803153e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.26023247 -29.25593426 -29.27334937]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  8.31486419  -9.25153874 -83.50871763]
init_Out:  [2.49911038]
Stock Position:  8.31486419409362
Bond position:  [-828.98730903]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [0.58576873]
curr_Stock_Price:  99.78235221665093
curr_Factors:  [99.78235222 -0.6678517  -0.98106688]
mat_Sqrt:  [[19.18392628  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00037758 -0.04017178 -0.11181141]
Stock Position:  -0.00037758260959062316
Bond Position:  [0.62344481]


portfolio before change:  [0.58606154]
curr_Stock_Price:  99.21326690647317
curr_Factors:  [99.21326691 -0.45694767 -0.97782171]
mat_Sqrt:  [[23.62965206  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00116781  0.00517857  0.29270642]
Stock Position:  -0.001167807924477032
Bond Position:  [0.70192358]


portfolio before change:  [0.58546274]
curr_Stock_Price:  99.80116073539087
curr_Factors:  [99.80116074 -0.54324586 -0.99224308]
mat_Sqrt:  [[21.49221709  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00373701  0.01637371  0.03060306]
Stock Position:  -0.0037370148486506184
Bond Position:  [0.95842116]


portfolio before change:  [0.58617566]
curr_Stock_Price:  99.64244891778395
curr_Factors:  [99.64244892 -0.5014299  -0.98616465]
mat_Sqrt:  [[22.51076675  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0036265   0.00365714 -0.19348184]
Stock Position:  0.0036264980521166653
Bond Position:  [0.22482251]


portfolio before change:  [0.58938316]
curr_Stock_Price:  100.5191601481587
curr_Factors:  [100.51916015  -0.40956342  -0.99829487]
mat_Sqrt:  [[24.59369409  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00201734 0.00881474 0.1897577 ]
Stock Position:  0.0020173427639227593
Bond Position:  [0.38660155]


portfolio before change:  [0.59171634]
curr_Stock_Price:  101.651765639785
curr_Factors:  [101.65176564  -0.47410346  -0.97169078]
mat_Sqrt:  [[23.94497925  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [1.64315590e-05 1.85732976e-02 9.89048964e-02]
Stock Position:  1.6431559042699766e-05
Bond Position:  [0.59004604]


portfolio before change:  [0.59176974]
curr_Stock_Price:  100.41314201335001
curr_Factors:  [100.41314201  -0.8213408   -0.97015305]
mat_Sqrt:  [[16.73996961  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00828892  0.04430051 -0.12307023]
Stock Position:  -0.008288916170701191
Bond Position:  [1.42408586]


portfolio before change:  [0.59291778]
curr_Stock_Price:  100.29611611402576
curr_Factors:  [100.29611611  -0.86822705  -0.97783117]
mat_Sqrt:  [[15.83256262  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00011663 -0.01178442  0.02725747]
Stock Position:  0.00011663305560766658
Bond Position:  [0.58121994]


portfolio before change:  [0.5929671]
curr_Stock_Price:  100.09596604891794
curr_Factors:  [100.09596605  -0.82655819  -0.9765601 ]
mat_Sqrt:  [[16.49423781  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00279466  0.0682751   0.213304  ]
Stock Position:  -0.002794657269951303
Bond Position:  [0.87270102]


portfolio before change:  [0.59284726]
curr_Stock_Price:  100.17788514571531
curr_Factors:  [100.17788515  -1.01182314  -0.96952799]
mat_Sqrt:  [[13.81280874  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00311573  0.03916065 -0.23417939]
Stock Position:  0.0031157314361951413
Bond Position:  [0.28071987]


portfolio before change:  [0.5907214]
curr_Stock_Price:  99.4843256170236
curr_Factors:  [99.48432562 -0.98430425 -0.98806533]
mat_Sqrt:  [[13.84093512  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00611628  0.00656898  0.05234252]
Stock Position:  -0.006116275599533548
Bond Position:  [1.19919496]


portfolio before change:  [0.59066118]
curr_Stock_Price:  99.51868250177293
curr_Factors:  [99.5186825  -1.05055554 -0.97627643]
mat_Sqrt:  [[13.11181092  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00921079  0.01532158 -0.1194386 ]
Stock Position:  -0.00921078583703063
Bond Position:  [1.50730645]


portfolio before change:  [0.59682802]
curr_Stock_Price:  98.86961474141212
curr_Factors:  [98.86961474 -1.023839   -0.98552233]
mat_Sqrt:  [[13.25587209  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00651224 -0.03632963  0.1803282 ]
Stock Position:  -0.006512240351941786
Bond Position:  [1.24069072]


portfolio before change:  [0.59224299]
curr_Stock_Price:  99.59749514325848
curr_Factors:  [99.59749514 -1.20975903 -0.99956938]
mat_Sqrt:  [[10.93325003  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.02977525 0.12429346 0.17361787]
Stock Position:  0.029775246561996253
Bond Position:  [-2.37329699]


portfolio before change:  [0.58426676]
curr_Stock_Price:  99.3395779485569
curr_Factors:  [99.33957795 -1.18554501 -0.97564316]
mat_Sqrt:  [[11.44274484  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00793961 -0.04777516 -0.26607268]
Stock Position:  -0.007939613074421682
Bond Position:  [1.37298457]


portfolio before change:  [0.59059486]
curr_Stock_Price:  98.56416698796467
curr_Factors:  [98.56416699 -1.03431219 -0.9847624 ]
mat_Sqrt:  [[13.08718091  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00599649 -0.0200453  -0.1298444 ]
Stock Position:  -0.005996490572711697
Bond Position:  [1.18163395]


portfolio before change:  [0.59028518]
curr_Stock_Price:  98.64044394028704
curr_Factors:  [98.64044394 -1.07633294 -0.98004963]
mat_Sqrt:  [[12.61767728  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00306607  0.0710285   0.39617607]
Stock Position:  -0.0030660733315167983
Bond Position:  [0.89272401]


portfolio before change:  [0.59221289]
curr_Stock_Price:  98.04811764218066
curr_Factors:  [98.04811764 -1.19519936 -0.94822085]
mat_Sqrt:  [[11.49644822  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00874704 0.02211147 0.24729236]
Stock Position:  0.00874703978280885
Bond Position:  [-0.2654179]


portfolio before change:  [0.58553358]
curr_Stock_Price:  97.2883032134741
curr_Factors:  [97.28830321 -0.9462567  -0.92280883]
mat_Sqrt:  [[15.00844789  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0014992  -0.00523705  0.3338039 ]
Stock Position:  -0.0014991972354456017
Bond Position:  [0.73138794]


portfolio before change:  [0.58577789]
curr_Stock_Price:  97.18633250601722
curr_Factors:  [97.18633251 -0.84801443 -0.91860645]
mat_Sqrt:  [[16.61007122  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00263982 -0.02385054  0.13058044]
Stock Position:  0.0026398225245397263
Bond Position:  [0.32922322]


portfolio before change:  [0.58728337]
curr_Stock_Price:  97.74104041932624
curr_Factors:  [97.74104042 -1.00726779 -0.91757582]
mat_Sqrt:  [[14.2602782   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01190962 -0.01303734  0.61581756]
Stock Position:  0.011909624615247992
Bond Position:  [-0.57677573]


portfolio before change:  [0.58511919]
curr_Stock_Price:  97.56537731906023
curr_Factors:  [97.56537732 -1.23648952 -0.90302449]
mat_Sqrt:  [[11.48461918  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00149032 -0.03437951  0.51396278]
Stock Position:  0.0014903240055598207
Bond Position:  [0.43971517]


portfolio before change:  [0.58444824]
curr_Stock_Price:  97.0782888559549
curr_Factors:  [97.07828886 -1.42969969 -0.88486771]
mat_Sqrt:  [[ 9.5922009   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00835118 -0.00402202 -0.23946421]
Stock Position:  -0.00835118060208224
Bond Position:  [1.39516656]


portfolio before change:  [0.58767054]
curr_Stock_Price:  96.7133224234211
curr_Factors:  [96.71332242 -1.29582346 -0.85585328]
mat_Sqrt:  [[11.24669624  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.04884046  0.05401726  0.0840802 ]
Stock Position:  -0.048840462100549244
Bond Position:  [5.3111939]


portfolio before change:  [0.59055099]
curr_Stock_Price:  96.66793985842885
curr_Factors:  [96.66793986 -1.58840018 -0.8561831 ]
mat_Sqrt:  [[ 8.38713111  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01043785 -0.07114282  0.34933129]
Stock Position:  -0.01043784602103551
Bond Position:  [1.59955606]


portfolio before change:  [0.58633736]
curr_Stock_Price:  97.0907850318876
curr_Factors:  [97.09078503 -1.51033897 -0.85485846]
mat_Sqrt:  [[ 9.11981058  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.02104785  0.01723875 -0.41463724]
Stock Position:  0.02104784516019246
Bond Position:  [-1.45721445]


portfolio before change:  [0.5831257]
curr_Stock_Price:  96.94685162082465
curr_Factors:  [96.94685162 -1.59657959 -0.85685747]
mat_Sqrt:  [[ 8.33718678  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00452705 -0.05289799 -0.21187257]
Stock Position:  0.004527052656861104
Bond Position:  [0.1442422]


portfolio before change:  [0.58497282]
curr_Stock_Price:  97.35088584516183
curr_Factors:  [97.35088585 -1.58734241 -0.82727218]
mat_Sqrt:  [[ 8.70334325  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01715239 -0.04540623 -0.33878803]
Stock Position:  -0.017152393692785414
Bond Position:  [2.25477354]


portfolio before change:  [0.59743126]
curr_Stock_Price:  96.64098032900478
curr_Factors:  [96.64098033 -1.43776038 -0.83284562]
mat_Sqrt:  [[ 9.97814173  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 1.65284987e-04  3.58664214e-03 -3.42737158e-01]
Stock Position:  0.00016528498728282643
Bond Position:  [0.58145796]


portfolio before change:  [0.59757083]
curr_Stock_Price:  97.04560005712321
curr_Factors:  [97.04560006 -1.30061895 -0.83432392]
mat_Sqrt:  [[11.47577275  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00627885 -0.00972429  0.13804947]
Stock Position:  0.0062788490390195024
Bond Position:  [-0.01176385]


portfolio before change:  [0.59139974]
curr_Stock_Price:  96.06299735214488
curr_Factors:  [96.06299735 -1.15878629 -0.81616602]
mat_Sqrt:  [[13.33046324  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00537615 -0.0260305  -0.18669445]
Stock Position:  0.0053761508758412135
Bond Position:  [0.07495058]


portfolio before change:  [0.59288451]
curr_Stock_Price:  96.33743061194244
curr_Factors:  [96.33743061 -0.91241897 -0.80667495]
mat_Sqrt:  [[17.26641033  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01509123 -0.08199983 -0.4911935 ]
Stock Position:  0.015091233209503029
Bond Position:  [-0.86096613]


portfolio before change:  [0.59358505]
curr_Stock_Price:  96.39098285184996
curr_Factors:  [96.39098285 -0.64494204 -0.82342144]
mat_Sqrt:  [[22.19904297  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00201111 -0.02525311  0.02358419]
Stock Position:  -0.002011113043937203
Bond Position:  [0.78743821]


portfolio before change:  [0.59540782]
curr_Stock_Price:  95.5335799574544
curr_Factors:  [95.53357996 -1.09868254 -0.82435539]
mat_Sqrt:  [[13.96340367  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01101929 -0.00909582  0.05395312]
Stock Position:  -0.011019292579598945
Bond Position:  [1.64812029]


portfolio before change:  [0.58461589]
curr_Stock_Price:  96.53164329812694
curr_Factors:  [96.5316433  -1.44588164 -0.86530468]
mat_Sqrt:  [[ 9.57049131  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00188098 -0.02699644 -0.16438907]
Stock Position:  0.0018809771460887932
Bond Position:  [0.40304208]


portfolio before change:  [0.5850974]
curr_Stock_Price:  96.7608449915476
curr_Factors:  [96.76084499 -1.31047513 -0.87770882]
mat_Sqrt:  [[10.84884337  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00274224 -0.03876008 -0.18569685]
Stock Position:  -0.002742241689673595
Bond Position:  [0.85043902]


portfolio before change:  [0.58796285]
curr_Stock_Price:  95.75468388209188
curr_Factors:  [95.75468388 -1.25165323 -0.8543077 ]
mat_Sqrt:  [[11.65608796  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00239484  0.00855026 -0.18902785]
Stock Position:  -0.002394841493615521
Bond Position:  [0.81728014]


portfolio before change:  [0.59030745]
curr_Stock_Price:  94.81832564789896
curr_Factors:  [94.81832565 -1.18309687 -0.85934275]
mat_Sqrt:  [[12.29906309  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01034716 -0.07058651 -0.09711096]
Stock Position:  0.010347162358818711
Bond Position:  [-0.39079316]


portfolio before change:  [0.6004551]
curr_Stock_Price:  95.80376576794121
curr_Factors:  [95.80376577 -1.09813809 -0.82906244]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [0.6004551]
Stock Price:  95.72181006692958
PL:  [0.6004551]
Settle:  Tensor("sub_178:0", shape=(), dtype=float64)
PL:  Tensor("sub_179:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  90
output_Z_Vals[:, i, :]:  [[ 1.19260232e+02 -2.92559343e+01 -2.92733494e+01]
 [ 4.57853641e-02  2.88167244e-02 -8.16539936e-02]
 [-2.72265068e-02  5.20826700e-02  1.03698565e-01]
 [ 7.10191868e-02  1.54877338e-01  3.54263276e-02]
 [ 1.48269153e-01 -6.46515496e-03 -6.32035775e-02]
 [ 7.78475589e-02  3.07373424e-02 -4.57147467e-03]
 [ 3.85162325e-02  3.89844359e-02 -3.76939522e-02]
 [-7.97263810e-02  2.51816117e-02 -8.18185432e-02]
 [ 2.63388082e-02 -5.19369472e-02  1.30759635e-02]
 [-3.88269688e-02  3.78219606e-02 -4.40832541e-02]
 [ 5.67286173e-02  1.39148396e-01 -8.29968963e-02]
 [-5.72976296e-02  4.41047020e-02  5.80320727e-03]
 [-1.02961777e-01  2.00510769e-02 -4.60710195e-02]
 [-1.04449006e-01 -1.05725507e-01  6.27501432e-02]
 [ 2.11462646e-01  2.70102286e-01  3.98875219e-02]
 [-7.09373922e-02 -7.58625765e-02 -1.12159888e-01]
 [-7.89560734e-02 -2.44826650e-02 -7.80606574e-02]
 [-8.35723028e-03 -6.78128387e-02 -1.49958248e-02]
 [ 2.05817382e-02  6.71189824e-02  2.28392996e-02]
 [ 3.17372864e-01 -1.04814503e-01 -6.55231497e-02]
 [-8.22386644e-03  7.91752740e-03  4.87778841e-02]
 [ 2.88755433e-02 -2.53869037e-02  2.79902694e-02]
 [-8.84243686e-02  1.54249761e-01  1.99439558e-01]
 [ 1.36622849e-01 -4.31594816e-02  2.54621793e-02]
 [ 6.72345992e-02  3.20790162e-02  8.42546183e-02]
 [ 6.81577537e-02 -2.90581602e-02  6.64604082e-02]
 [-1.67982442e-01  7.28748117e-02  7.54095243e-02]
 [-4.82680652e-02  7.16539346e-02  2.86275059e-02]
 [ 6.18529607e-02 -6.52265434e-02  7.02551014e-02]
 [ 4.42788577e-02  1.24052989e-02 -1.46767583e-02]
 [-1.61767911e-02  2.58265282e-01  2.09945683e-02]
 [ 1.85101443e-02 -1.02460419e-01 -7.73227227e-02]
 [ 7.64349205e-02 -3.76359307e-02  6.64455977e-02]
 [-5.11065068e-02 -8.65311385e-02 -1.05387857e-02]
 [-1.79711451e-01  1.73233291e-01  3.01105324e-02]
 [ 9.49880086e-02 -1.60669637e-01 -1.33475678e-01]
 [-1.88486657e-01 -3.13034560e-01  4.27003382e-02]
 [-4.76969966e-02 -3.08303415e-02  4.56356336e-02]
 [-3.21143589e-02  6.90830683e-02 -2.83222626e-02]
 [-1.34903194e-01  8.18527012e-02  8.26143995e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.26023247 -29.25593426 -29.27334937]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  8.31486419  -9.25153874 -83.50871763]
init_Out:  [2.49911038]
Stock Position:  8.31486419409362
Bond position:  [-828.98730903]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-4.91362166]
curr_Stock_Price:  99.120959527482
curr_Factors:  [99.12095953 -0.82781712 -0.98251028]
mat_Sqrt:  [[16.21624491  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00184148  0.00911265 -0.23293612]
Stock Position:  0.001841477928295281
Bond Position:  [-5.09615072]


portfolio before change:  [-4.91314458]
curr_Stock_Price:  99.72598531674521
curr_Factors:  [99.72598532 -0.57971017 -0.98437248]
mat_Sqrt:  [[20.87064515  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-2.25884590e-04  1.64699864e-02  2.95823142e-01]
Stock Position:  -0.00022588459043131398
Bond Position:  [-4.89061801]


portfolio before change:  [-4.91378795]
curr_Stock_Price:  99.86767515383971
curr_Factors:  [99.86767515 -0.89625496 -0.97736607]
mat_Sqrt:  [[15.33633787  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00536305 0.04897651 0.10106145]
Stock Position:  0.00536304507670191
Bond Position:  [-5.44938279]


portfolio before change:  [-4.91416947]
curr_Stock_Price:  99.92355654201509
curr_Factors:  [99.92355654 -0.94658067 -0.97521261]
mat_Sqrt:  [[14.62324196  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00924561 -0.00204446 -0.18030221]
Stock Position:  0.009245613792090438
Bond Position:  [-5.83802408]


portfolio before change:  [-4.91286248]
curr_Stock_Price:  100.14385398760265
curr_Factors:  [100.14385399  -0.88431369  -0.99510408]
mat_Sqrt:  [[15.28986085  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00508233  0.00972    -0.01304114]
Stock Position:  0.005082325209525428
Bond Position:  [-5.42182612]


portfolio before change:  [-4.91332731]
curr_Stock_Price:  100.18575269134638
curr_Factors:  [100.18575269  -0.65587772  -1.02097721]
mat_Sqrt:  [[18.7308342   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00169926  0.01232796 -0.10753035]
Stock Position:  0.001699260169897584
Bond Position:  [-5.08356897]


portfolio before change:  [-4.91781625]
curr_Stock_Price:  97.9180293500948
curr_Factors:  [97.91802935 -0.66888028 -1.0114132 ]
mat_Sqrt:  [[18.24401727  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00524979  0.00796312 -0.23340553]
Stock Position:  -0.005249794132016643
Bond Position:  [-4.40376675]


portfolio before change:  [-4.92605345]
curr_Stock_Price:  99.38221920206203
curr_Factors:  [99.3822192  -0.73531112 -1.03000116]
mat_Sqrt:  [[17.00761078  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00162674 -0.0164239   0.03730208]
Stock Position:  0.001626737713449379
Bond Position:  [-5.08772225]


portfolio before change:  [-4.92566527]
curr_Stock_Price:  100.01181431215537
curr_Factors:  [100.01181431  -1.02853621  -1.02800462]
mat_Sqrt:  [[12.7910728   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00366262  0.01196035 -0.12575725]
Stock Position:  -0.003662622147622848
Bond Position:  [-4.55935978]


portfolio before change:  [-4.92601856]
curr_Stock_Price:  99.95265887707134
curr_Factors:  [99.95265888 -0.96879939 -1.04502847]
mat_Sqrt:  [[13.34135754  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00325152  0.04400259 -0.23676704]
Stock Position:  0.003251523903476934
Bond Position:  [-5.25101702]


portfolio before change:  [-4.9268518]
curr_Stock_Price:  99.89827665466447
curr_Factors:  [99.89827665 -0.98903136 -1.0440172 ]
mat_Sqrt:  [[13.0802555   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00420284  0.01394713  0.01655494]
Stock Position:  -0.004202844233525248
Bond Position:  [-4.50699491]


portfolio before change:  [-4.92714133]
curr_Stock_Price:  99.83311168738139
curr_Factors:  [99.83311169 -0.78901667 -1.04348807]
mat_Sqrt:  [[15.9745234   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00700167  0.00634071 -0.13142779]
Stock Position:  -0.007001665436288284
Bond Position:  [-4.22814329]


portfolio before change:  [-4.92842378]
curr_Stock_Price:  99.94078583216839
curr_Factors:  [99.94078583 -0.98021791 -1.05014332]
mat_Sqrt:  [[13.12103458  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00719227 -0.03343334  0.17900869]
Stock Position:  -0.007192268785024733
Bond Position:  [-4.20962279]


portfolio before change:  [-4.93370712]
curr_Stock_Price:  100.60220446577686
curr_Factors:  [100.60220447  -0.94438706  -1.04669942]
mat_Sqrt:  [[13.73692822  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01649413 0.08541384 0.113788  ]
Stock Position:  0.016494128796513196
Bond Position:  [-6.59305284]


portfolio before change:  [-4.91453901]
curr_Stock_Price:  101.81429000909408
curr_Factors:  [101.81429001  -1.20298437  -1.05790518]
mat_Sqrt:  [[10.61492383  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00902415 -0.02398985 -0.31996094]
Stock Position:  -0.009024153010793538
Bond Position:  [-3.99575128]


portfolio before change:  [-4.91742944]
curr_Stock_Price:  102.07923763187684
curr_Factors:  [102.07923763  -1.15364566  -1.04688903]
mat_Sqrt:  [[11.30465576  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00844982 -0.0077421  -0.22268533]
Stock Position:  -0.008449817497081095
Bond Position:  [-4.05487851]


portfolio before change:  [-4.9196295]
curr_Stock_Price:  102.2796177292343
curr_Factors:  [102.27961773  -0.96471712  -1.05572352]
mat_Sqrt:  [[13.56197298  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00097104 -0.0214443  -0.04277891]
Stock Position:  -0.0009710357174769899
Bond Position:  [-4.82031234]


portfolio before change:  [-4.92035045]
curr_Stock_Price:  102.4015209866873
curr_Factors:  [102.40152099  -0.88505419  -1.05573227]
mat_Sqrt:  [[14.7039345   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00183467 0.02122489 0.06515416]
Stock Position:  0.0018346650940830815
Bond Position:  [-5.10822295]


portfolio before change:  [-4.92095513]
curr_Stock_Price:  102.41999262379777
curr_Factors:  [102.41999262  -0.91412693  -1.04225261]
mat_Sqrt:  [[14.47904439  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.02080881 -0.03314526 -0.18691931]
Stock Position:  0.020808811687990734
Bond Position:  [-7.05219347]


portfolio before change:  [-4.91903166]
curr_Stock_Price:  102.5547934371486
curr_Factors:  [102.55479344  -0.99158284  -1.06221099]
mat_Sqrt:  [[13.15238869  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.0001473  0.00250374 0.13914973]
Stock Position:  0.00014729698001677245
Bond Position:  [-4.93413768]


portfolio before change:  [-4.9195508]
curr_Stock_Price:  103.2178462087082
curr_Factors:  [103.21784621  -1.15068739  -1.10968344]
mat_Sqrt:  [[10.76683882  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00315167 -0.00802804  0.07984845]
Stock Position:  0.00315167215257793
Bond Position:  [-5.24485962]


portfolio before change:  [-4.91920503]
curr_Stock_Price:  103.53558881223519
curr_Factors:  [103.53558881  -1.07422563  -1.09865878]
mat_Sqrt:  [[11.78739802  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00371     0.04877806  0.56894554]
Stock Position:  -0.003709998383895897
Bond Position:  [-4.53508817]


portfolio before change:  [-4.92208833]
curr_Stock_Price:  104.15994902626856
curr_Factors:  [104.15994903  -1.28303404  -1.11769982]
mat_Sqrt:  [[ 9.44224551  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01490174 -0.01364823  0.07263651]
Stock Position:  0.014901743551218347
Bond Position:  [-6.47425318]


portfolio before change:  [-4.93307256]
curr_Stock_Price:  103.4771500151483
curr_Factors:  [103.47715002  -1.20181104  -1.0943027 ]
mat_Sqrt:  [[10.41489592  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00818647 0.01014428 0.24035497]
Stock Position:  0.008186474296187398
Bond Position:  [-5.78018559]


portfolio before change:  [-4.94329827]
curr_Stock_Price:  102.31631500538376
curr_Factors:  [102.31631501  -1.16120078  -1.08977592]
mat_Sqrt:  [[10.77353266  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00751598 -0.009189    0.18959305]
Stock Position:  0.007515979372078573
Bond Position:  [-5.71230558]


portfolio before change:  [-4.94008483]
curr_Stock_Price:  102.83887107279932
curr_Factors:  [102.83887107  -1.21557608  -1.09499356]
mat_Sqrt:  [[10.20210178  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01477224  0.02304504  0.21512238]
Stock Position:  -0.014772242089943375
Bond Position:  [-3.42092413]


portfolio before change:  [-4.93903417]
curr_Stock_Price:  102.73879759151669
curr_Factors:  [102.73879759  -0.99167117  -1.07725621]
mat_Sqrt:  [[12.97808849  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00312638  0.02265896  0.08166631]
Stock Position:  -0.0031263774663297175
Bond Position:  [-4.6178339]


portfolio before change:  [-4.9403209]
curr_Stock_Price:  102.96572826399868
curr_Factors:  [102.96572826  -1.00165796  -1.09683781]
mat_Sqrt:  [[12.62779604  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00590044 -0.02062644  0.20041825]
Stock Position:  0.005900442239212026
Bond Position:  [-5.54786423]


portfolio before change:  [-4.94036305]
curr_Stock_Price:  103.07612400652462
curr_Factors:  [103.07612401  -0.96840326  -1.08610091]
mat_Sqrt:  [[13.20986116  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00314941  0.0039229  -0.04186871]
Stock Position:  0.003149410875514738
Bond Position:  [-5.26499211]


portfolio before change:  [-4.94206308]
curr_Stock_Price:  102.74530931783669
curr_Factors:  [102.74530932  -0.90757475  -1.0767945 ]
mat_Sqrt:  [[14.12411969  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00036979  0.08167065  0.05989166]
Stock Position:  -0.0003697867176391256
Bond Position:  [-4.90406923]


portfolio before change:  [-4.9425221]
curr_Stock_Price:  102.32878414935041
curr_Factors:  [102.32878415  -0.54764884  -1.08058071]
mat_Sqrt:  [[20.08476254  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 4.04251688e-06 -3.24008296e-02 -2.20580205e-01]
Stock Position:  4.042516875498546e-06
Bond Position:  [-4.94293577]


portfolio before change:  [-4.94314255]
curr_Stock_Price:  101.70086471905005
curr_Factors:  [101.70086472  -0.41630417  -1.04616295]
mat_Sqrt:  [[23.56043174  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00377864 -0.01190153  0.1895508 ]
Stock Position:  0.0037786368569828785
Bond Position:  [-5.32743318]


portfolio before change:  [-4.94332183]
curr_Stock_Price:  101.82966462479632
curr_Factors:  [101.82966462  -0.32453277  -1.05174971]
mat_Sqrt:  [[25.7135728   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00215808 -0.02736355 -0.03006422]
Stock Position:  -0.002158080178641751
Bond Position:  [-4.72356525]


portfolio before change:  [-4.94622061]
curr_Stock_Price:  102.89927134283514
curr_Factors:  [102.89927134  -0.32807488  -1.04439922]
mat_Sqrt:  [[26.08280983  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0064829   0.05478118  0.08589697]
Stock Position:  -0.006482902004053803
Bond Position:  [-4.27913472]


portfolio before change:  [-4.95799147]
curr_Stock_Price:  104.6324359477444
curr_Factors:  [104.63243595  -0.47612654  -1.05322893]
mat_Sqrt:  [[22.67126191  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00280505 -0.0508082  -0.38076896]
Stock Position:  0.002805045788807638
Bond Position:  [-5.25149024]


portfolio before change:  [-4.95755235]
curr_Stock_Price:  105.02301578380579
curr_Factors:  [105.02301578  -0.30171082  -1.07223717]
mat_Sqrt:  [[26.58192672  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00706694 -0.09899022  0.12181218]
Stock Position:  -0.007066944646494368
Bond Position:  [-4.21536051]


portfolio before change:  [-4.94401678]
curr_Stock_Price:  103.0331141834002
curr_Factors:  [103.03311418  -0.12242807  -1.0624647 ]
mat_Sqrt:  [[31.50535936  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00124352 -0.00974941  0.13018576]
Stock Position:  -0.001243524870505171
Bond Position:  [-4.81589254]


portfolio before change:  [-4.9467019]
curr_Stock_Price:  104.70826619236345
curr_Factors:  [104.70826619  -0.10947247  -1.05997004]
mat_Sqrt:  [[32.5161065   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00111058  0.02184598 -0.08079553]
Stock Position:  -0.001110584977790211
Bond Position:  [-4.83041447]


portfolio before change:  [-4.94619058]
curr_Stock_Price:  103.70415100753614
curr_Factors:  [ 1.03704151e+02  3.84717868e-02 -1.06282080e+00]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-4.94619058]
Stock Price:  108.80698692546594
PL:  [-13.75317751]
Settle:  Tensor("sub_180:0", shape=(), dtype=float64)
PL:  Tensor("sub_181:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  91
output_Z_Vals[:, i, :]:  [[ 1.19260232e+02 -2.92559343e+01 -2.92733494e+01]
 [-1.24192186e-01  3.51548835e-01  5.74276409e-02]
 [ 1.27936696e-01  4.23680114e-02 -1.10014104e-01]
 [ 7.98777643e-02  1.24034036e-01  3.73382655e-02]
 [ 2.36072013e-01 -1.38516621e-02 -2.72779456e-02]
 [ 2.46058240e-02  2.87425455e-02  7.81949561e-02]
 [-2.49383538e-02  2.53105490e-02  8.31782931e-02]
 [-9.45596429e-02 -1.04754970e-02 -1.01537633e-01]
 [ 4.68452679e-02  6.59338748e-03 -8.46866012e-02]
 [-7.09620296e-02  4.40603751e-01  2.10954427e-01]
 [ 5.88339174e-02  1.19799482e-01 -8.46390371e-02]
 [-7.89311627e-02 -1.03594125e-01 -3.90570996e-03]
 [-8.56618347e-02  1.49654418e-02  8.19672780e-03]
 [-1.27501006e-01 -1.25668313e-01  4.11122710e-02]
 [-1.64372969e-01  8.05908682e-02  3.12661743e-01]
 [-8.40458343e-03 -8.26833038e-01  3.15796018e-02]
 [-7.12006944e-02 -2.46150279e-01 -2.58430064e-01]
 [ 4.63300824e-01  2.99622967e-02 -4.59463414e-01]
 [-1.75614956e-01  6.50043231e-03 -3.33128794e-01]
 [-5.33887790e-02 -2.08765985e-02  1.27680696e-01]
 [ 1.09229463e-01 -1.20539877e-01  7.89383527e-02]
 [ 1.17590464e-01  4.71198631e-02  2.57603127e-01]
 [-6.72190203e-02  6.00821960e-02  3.34010468e-01]
 [-6.01288229e-02 -7.67249623e-04 -8.44756289e-02]
 [-7.13066279e-01  1.62505190e-01  7.71337771e-02]
 [-2.34539465e-01 -3.69270026e-01  1.63504178e-01]
 [ 2.70056014e-02  7.56149734e-02  5.44867704e-02]
 [-4.95751768e-02 -3.55267382e-02 -4.66696470e-02]
 [-1.75888378e-01 -3.12024674e-01  5.63064471e-02]
 [ 3.93975216e-01  5.02576293e-01  7.08518665e-01]
 [ 1.08579241e-01 -1.69254703e-01  9.47603538e-02]
 [ 2.13713593e-01  7.57376965e-01  5.98440298e-01]
 [ 5.28838087e-01 -2.92389942e-01 -9.98575805e-02]
 [-3.33311273e-02 -6.55337240e-02  4.69093901e-02]
 [-6.72247037e-02 -4.22356979e-01 -1.16602494e-02]
 [ 4.45310920e-01  3.92967062e-01  1.88508978e-01]
 [ 1.72557691e-02 -9.77723970e-02 -9.44310624e-02]
 [ 1.44210906e-02  1.26525589e-01  8.41592832e-02]
 [ 6.74402341e-01 -7.85011723e-01 -2.09042174e-01]
 [-2.26660526e-01  2.87507196e-01  2.65224307e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.26023247 -29.25593426 -29.27334937]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  8.31486419  -9.25153874 -83.50871763]
init_Out:  [2.49911038]
Stock Position:  8.31486419409362
Bond position:  [-828.98730903]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [11.15418386]
curr_Stock_Price:  101.05337900502921
curr_Factors:  [101.05337901  -0.98364323  -1.00561256]
mat_Sqrt:  [[13.82381861  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00747933  0.1111695   0.16382507]
Stock Position:  -0.0074793274378914774
Bond Position:  [11.90999517]


portfolio before change:  [11.15129411]
curr_Stock_Price:  101.63880557397601
curr_Factors:  [101.63880557  -0.85975699  -0.99222366]
mat_Sqrt:  [[15.94977554  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00668186  0.01339794 -0.31383962]
Stock Position:  0.006681855673825402
Bond Position:  [10.47215828]


portfolio before change:  [11.15690266]
curr_Stock_Price:  102.28225727991668
curr_Factors:  [102.28225728  -0.70259448  -0.97959322]
mat_Sqrt:  [[19.02109292  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00476849 0.03922301 0.10651568]
Stock Position:  0.004768493129879129
Bond Position:  [10.66917042]


portfolio before change:  [11.15874701]
curr_Stock_Price:  102.38933944580343
curr_Factors:  [102.38933945  -0.5268419   -0.97179896]
mat_Sqrt:  [[22.87722197  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01006006 -0.00438028 -0.07781639]
Stock Position:  0.010060062250358782
Bond Position:  [10.12870388]


portfolio before change:  [11.14628961]
curr_Stock_Price:  101.02517607246247
curr_Factors:  [101.02517607  -0.48540768  -0.97366039]
mat_Sqrt:  [[23.48358539  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00175908 0.00908919 0.22306844]
Stock Position:  0.0017590768722216023
Bond Position:  [10.96857856]


portfolio before change:  [11.14302915]
curr_Stock_Price:  98.39219684360359
curr_Factors:  [98.39219684 -0.15946014 -0.97032527]
mat_Sqrt:  [[31.79077278  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-2.29819523e-04  8.00389837e-03  2.37284518e-01]
Stock Position:  -0.00022981952334153027
Bond Position:  [11.1656416]


portfolio before change:  [11.14431953]
curr_Stock_Price:  98.8508703224088
curr_Factors:  [98.85087032 -0.40847044 -0.96191446]
mat_Sqrt:  [[25.10902793  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00460219 -0.00331264 -0.28965861]
Stock Position:  -0.00460218539825695
Bond Position:  [11.59924957]


portfolio before change:  [11.13625056]
curr_Stock_Price:  100.91922945033502
curr_Factors:  [100.91922945  -0.57022034  -1.00442402]
mat_Sqrt:  [[20.89847389  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00142254  0.00208501 -0.2415873 ]
Stock Position:  0.0014225406362528053
Bond Position:  [10.99268885]


portfolio before change:  [11.13717037]
curr_Stock_Price:  100.5998263122347
curr_Factors:  [100.59982631  -0.50269692  -0.99279857]
mat_Sqrt:  [[22.54819555  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00073287  0.13933114  0.60179426]
Stock Position:  -0.0007328656333588272
Bond Position:  [11.21089652]


portfolio before change:  [11.13886319]
curr_Stock_Price:  100.20225026239827
curr_Factors:  [100.20225026  -0.45532517  -0.99085122]
mat_Sqrt:  [[23.59451452  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0018924   0.03788392 -0.24145161]
Stock Position:  0.0018923998453057765
Bond Position:  [10.94924046]


portfolio before change:  [11.13801733]
curr_Stock_Price:  99.03199354640479
curr_Factors:  [99.03199355 -0.2968054  -1.0276484 ]
mat_Sqrt:  [[26.33737837  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00312875 -0.03275934 -0.0111419 ]
Stock Position:  -0.00312875488278706
Bond Position:  [11.44786417]


portfolio before change:  [11.1423012]
curr_Stock_Price:  98.12019568503766
curr_Factors:  [98.12019569 -0.46257564 -1.00776977]
mat_Sqrt:  [[22.55254241  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.003707    0.00473249  0.02338298]
Stock Position:  -0.0037070001718367313
Bond Position:  [11.50603278]


portfolio before change:  [11.15258241]
curr_Stock_Price:  95.73474502765822
curr_Factors:  [95.73474503 -0.25941279 -0.99664391]
mat_Sqrt:  [[27.26283964  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00448793 -0.03973981  0.11728187]
Stock Position:  -0.00448793090270402
Bond Position:  [11.58223333]


portfolio before change:  [11.1618402]
curr_Stock_Price:  93.99453958110276
curr_Factors:  [ 9.39945396e+01  2.04386419e-02 -9.99247068e-01]
mat_Sqrt:  [[35.31925436  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00278801  0.02548507  0.89193693]
Stock Position:  -0.0027880064993442344
Bond Position:  [11.42389759]


portfolio before change:  [11.16430502]
curr_Stock_Price:  93.62268004310071
curr_Factors:  [93.62268004  0.11508083 -1.00238513]
mat_Sqrt:  [[38.55047288  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00060459 -0.26146756  0.09008781]
Stock Position:  -0.0006045882113096909
Bond Position:  [11.22090819]


portfolio before change:  [11.1662684]
curr_Stock_Price:  92.69530740647575
curr_Factors:  [92.69530741  0.27914201 -1.01765235]
mat_Sqrt:  [[44.29215228  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00294201 -0.07783955 -0.73722904]
Stock Position:  -0.0029420128940669693
Bond Position:  [11.43897919]


portfolio before change:  [11.16779602]
curr_Stock_Price:  92.6621142256402
curr_Factors:  [92.66211423  0.20552714 -1.01588629]
mat_Sqrt:  [[41.20668687  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00898609  0.00947491 -1.31072123]
Stock Position:  0.008986086938503954
Bond Position:  [10.33512621]


portfolio before change:  [11.1737104]
curr_Stock_Price:  93.17651079283768
curr_Factors:  [93.17651079  0.30101249 -1.00300354]
mat_Sqrt:  [[46.17805135  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00527191  0.00205562 -0.95032372]
Stock Position:  -0.005271914656207891
Bond Position:  [11.66492902]


portfolio before change:  [11.17519153]
curr_Stock_Price:  93.1721626969914
curr_Factors:  [93.1721627  0.3078744 -1.0109233]
mat_Sqrt:  [[46.12707522  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00060409 -0.00660176  0.36423749]
Stock Position:  -0.0006040941779582769
Bond Position:  [11.23147629]


portfolio before change:  [11.17547425]
curr_Stock_Price:  95.02833399503012
curr_Factors:  [95.028334    0.10403141 -1.00547137]
mat_Sqrt:  [[38.5800436   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00316823 -0.03811806  0.22518915]
Stock Position:  0.003168227643033604
Bond Position:  [10.87440286]


portfolio before change:  [11.18079583]
curr_Stock_Price:  96.27893714126266
curr_Factors:  [96.27893714 -0.39661782 -0.98952051]
mat_Sqrt:  [[24.07349005  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00711945 0.01490061 0.73487002]
Stock Position:  0.007119454287443185
Bond Position:  [10.49534234]


portfolio before change:  [11.1814608]
curr_Stock_Price:  96.1880543563146
curr_Factors:  [96.18805436 -0.38564867 -0.97014499]
mat_Sqrt:  [[24.79176441  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [1.01319803e-04 1.89996586e-02 9.52838895e-01]
Stock Position:  0.00010131980333315748
Bond Position:  [11.17171504]


portfolio before change:  [11.18270352]
curr_Stock_Price:  94.66976178274896
curr_Factors:  [94.66976178 -0.52555892 -0.97059964]
mat_Sqrt:  [[21.20498058  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00364972 -0.00024263 -0.24098546]
Stock Position:  -0.0036497156155435406
Bond Position:  [11.52822122]


portfolio before change:  [11.18900394]
curr_Stock_Price:  93.33834241292874
curr_Factors:  [93.33834241 -0.31344506 -0.93045865]
mat_Sqrt:  [[26.90540693  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02576157  0.05138865  0.2200412 ]
Stock Position:  -0.025761570837075823
Bond Position:  [13.59354626]


portfolio before change:  [11.24323367]
curr_Stock_Price:  91.29924197321436
curr_Factors:  [91.29924197 -0.27459407 -0.92080067]
mat_Sqrt:  [[27.6257343   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0076269  -0.11677344  0.46643191]
Stock Position:  -0.007626904058529336
Bond Position:  [11.93956423]


portfolio before change:  [11.25262189]
curr_Stock_Price:  90.26400031151684
curr_Factors:  [90.26400031 -0.25242605 -0.90185294]
mat_Sqrt:  [[28.45886511  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00140835 0.02391155 0.15543559]
Stock Position:  0.0014083498005318708
Bond Position:  [11.12549861]


portfolio before change:  [11.25400356]
curr_Stock_Price:  90.25753480344005
curr_Factors:  [90.2575348  -0.2369114  -0.93390193]
mat_Sqrt:  [[27.99018059  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00214428 -0.01123454 -0.13313551]
Stock Position:  -0.002144283237106325
Bond Position:  [11.44754128]


portfolio before change:  [11.25785715]
curr_Stock_Price:  89.12776166988407
curr_Factors:  [89.12776167 -0.13330612 -0.9314074 ]
mat_Sqrt:  [[30.73362532  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00561116 -0.09867087  0.16062662]
Stock Position:  -0.005611160843792723
Bond Position:  [11.75796735]


portfolio before change:  [11.28645516]
curr_Stock_Price:  84.29308086849285
curr_Factors:  [ 8.42930809e+01 -6.16195849e-02 -9.14499490e-01]
mat_Sqrt:  [[31.75914481  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01736752 0.15892858 2.02120654]
Stock Position:  0.017367515719854336
Bond Position:  [9.82249375]


portfolio before change:  [11.26335103]
curr_Stock_Price:  82.89207384453292
curr_Factors:  [ 8.28920738e+01 -4.06156629e-02 -9.03026029e-01]
mat_Sqrt:  [[32.26224802  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00382961 -0.05352304  0.27032491]
Stock Position:  0.003829614706793757
Bond Position:  [10.94590633]


portfolio before change:  [11.26447561]
curr_Stock_Price:  82.82842682563668
curr_Factors:  [ 8.28284268e+01 -2.87971531e-02 -9.05264104e-01]
mat_Sqrt:  [[32.54780933  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01092009 0.23950363 1.7071836 ]
Stock Position:  0.010920092754750723
Bond Position:  [10.35998151]


portfolio before change:  [11.29480316]
curr_Stock_Price:  85.48705543856131
curr_Factors:  [85.48705544  0.10848816 -0.91565021]
mat_Sqrt:  [[38.13768538  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01313413 -0.09246182 -0.28486588]
Stock Position:  0.013134128689338338
Bond Position:  [10.17200518]


portfolio before change:  [11.28809212]
curr_Stock_Price:  84.87927832743125
curr_Factors:  [84.87927833  0.23318453 -0.94559443]
mat_Sqrt:  [[41.62995992  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00061129 -0.02072358  0.13381943]
Stock Position:  -0.0006112872006643485
Bond Position:  [11.33997774]


portfolio before change:  [11.28995012]
curr_Stock_Price:  84.15880391931199
curr_Factors:  [ 8.41588039e+01 -3.57370962e-02 -9.28463137e-01]
mat_Sqrt:  [[32.08874364  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00250898 -0.133561   -0.03326345]
Stock Position:  -0.0025089811361756345
Bond Position:  [11.50110298]


portfolio before change:  [11.28182742]
curr_Stock_Price:  87.96928607155404
curr_Factors:  [87.96928607 -0.17288232 -0.92745455]
mat_Sqrt:  [[29.27256906  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.0168737  0.1242671  0.53776364]
Stock Position:  0.016873699022836305
Bond Position:  [9.79746017]


portfolio before change:  [11.26095516]
curr_Stock_Price:  86.65973182666488
curr_Factors:  [86.65973183 -0.14766682 -0.92971295]
mat_Sqrt:  [[29.50646947  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-1.54012436e-04 -3.09183467e-02 -2.69385537e-01]
Stock Position:  -0.00015401243579374303
Bond Position:  [11.27430184]


portfolio before change:  [11.26264064]
curr_Stock_Price:  84.86698229088574
curr_Factors:  [84.86698229 -0.14247457 -0.94275834]
mat_Sqrt:  [[28.6700267   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00121614 0.0400109  0.24008301]
Stock Position:  0.0012161449769277834
Bond Position:  [11.15943009]


portfolio before change:  [11.26386414]
curr_Stock_Price:  84.72594907990411
curr_Factors:  [84.72594908 -0.15659832 -0.91503235]
mat_Sqrt:  [[29.01437074  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.02107448 -0.2482425  -0.59633914]
Stock Position:  0.021074483268750735
Bond Position:  [9.47830854]


portfolio before change:  [11.27314656]
curr_Stock_Price:  85.1101841174538
curr_Factors:  [85.11018412 -0.36626629 -0.93878284]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [11.27314656]
Stock Price:  84.60195861693323
PL:  [11.27314656]
Settle:  Tensor("sub_182:0", shape=(), dtype=float64)
PL:  Tensor("sub_183:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  92
output_Z_Vals[:, i, :]:  [[ 1.19260232e+02 -2.92559343e+01 -2.92733494e+01]
 [ 8.50892362e-02 -3.23051160e-01 -2.65116701e-01]
 [-5.05852937e-02  1.33367175e-02  1.01663929e-01]
 [-5.54486927e-02  1.00997698e-01  1.18388727e-02]
 [ 1.56705726e-02  3.77835360e-02 -7.16733288e-02]
 [ 6.71048142e-02  2.87363708e-02 -7.44582000e-02]
 [ 7.14788240e-02  1.45174517e-02 -6.75548818e-02]
 [-9.89458664e-02 -2.63941341e-02 -1.07343156e-01]
 [ 2.52620047e-02 -4.62281807e-02 -4.46668527e-02]
 [-4.10341722e-02 -1.09018390e-01 -1.30955594e-01]
 [ 6.92745117e-02  1.10324633e-01 -9.43187992e-02]
 [-9.98642087e-02 -7.48745101e-02  1.25440491e-02]
 [-1.12097027e-01  4.41785352e-02 -2.28792121e-02]
 [-1.00951263e-01 -1.12140376e-01  6.17109147e-02]
 [ 2.67995682e-01  3.69900578e-01  7.99680915e-02]
 [-7.55484469e-02 -1.36949893e-01 -9.98253867e-02]
 [-7.06549982e-02 -5.76750545e-02 -5.97020536e-02]
 [-7.80745671e-02  1.73387221e-01  1.28093186e-01]
 [ 1.12984292e-01  6.53937266e-02  1.23799298e-01]
 [ 3.55387609e-02 -2.86116649e-02  7.91404394e-02]
 [ 1.49456688e-04 -4.18456301e-02  4.24591087e-03]
 [ 1.16148232e-01 -6.26191110e-02  1.41164028e-01]
 [-2.20779016e-02 -8.99387441e-02  1.85037189e-01]
 [-6.85449759e-02 -5.66976852e-04 -8.20233916e-02]
 [-3.17260762e-01  1.12942966e-01  6.48477206e-02]
 [-4.66146147e-02 -1.57837349e-01  1.03231338e-01]
 [ 2.36224730e-01  3.99513354e-02 -1.35405557e-01]
 [-4.13408008e-02  6.62261905e-02  2.65838908e-02]
 [-6.29703632e-02 -5.70334472e-02 -2.24739281e-01]
 [ 7.21706621e-03 -5.09686533e-03 -1.14302753e-01]
 [ 3.89285289e-02  9.85635179e-02  2.75055391e-02]
 [ 1.51518225e-02 -6.58436998e-02 -9.04328331e-02]
 [ 2.48783465e-01 -2.09287164e-01 -1.18593808e-01]
 [-4.68069684e-02 -8.23336689e-02  1.28923313e-03]
 [-1.70377010e-01  7.45625797e-02  2.40764892e-02]
 [ 7.30864567e-02 -1.35960246e-01 -1.07563392e-01]
 [-2.46442488e-02 -1.42684076e-01 -5.20270065e-02]
 [-2.04764858e-02  1.71635466e-02 -7.83859558e-02]
 [ 4.30532469e-03 -5.80634351e-02  9.21239252e-03]
 [-8.79236259e-01  4.35989934e-01  5.38794886e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.26023247 -29.25593426 -29.27334937]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  8.31486419  -9.25153874 -83.50871763]
init_Out:  [2.49911038]
Stock Position:  8.31486419409362
Bond position:  [-828.98730903]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-9.31995179]
curr_Stock_Price:  98.59102542037999
curr_Factors:  [98.59102542 -1.03515554 -1.02219422]
mat_Sqrt:  [[12.59916416  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00179626 -0.10215775 -0.75630415]
Stock Position:  0.001796259724002369
Bond Position:  [-9.49704688]


portfolio before change:  [-9.32032916]
curr_Stock_Price:  99.04187155290975
curr_Factors:  [99.04187155 -1.02131932 -1.01418996]
mat_Sqrt:  [[12.93624964  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00227955  0.00421744  0.29001889]
Stock Position:  -0.0022795539201236883
Bond Position:  [-9.09455787]


portfolio before change:  [-9.32047149]
curr_Stock_Price:  98.60557432868225
curr_Factors:  [98.60557433 -0.89685139 -1.00335255]
mat_Sqrt:  [[14.74529204  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00341969  0.03193828  0.03377301]
Stock Position:  -0.003419691071803574
Bond Position:  [-8.98327089]


portfolio before change:  [-9.32100696]
curr_Stock_Price:  98.43377394851667
curr_Factors:  [98.43377395 -0.88601171 -0.99670943]
mat_Sqrt:  [[14.97920405  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 1.34578738e-04  1.19482032e-02 -2.04464057e-01]
Stock Position:  0.0001345787382412011
Bond Position:  [-9.33425406]


portfolio before change:  [-9.32208828]
curr_Stock_Price:  99.06938431189806
curr_Factors:  [99.06938431 -1.14616715 -0.97602068]
mat_Sqrt:  [[11.86547145  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00443708  0.00908724 -0.21240852]
Stock Position:  0.004437081820503099
Bond Position:  [-9.76166724]


portfolio before change:  [-9.32216624]
curr_Stock_Price:  99.32683336397204
curr_Factors:  [99.32683336 -1.25860229 -0.9642653 ]
mat_Sqrt:  [[10.75690825  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00539784  0.00459082 -0.19271527]
Stock Position:  0.005397841009717967
Bond Position:  [-9.85831669]


portfolio before change:  [-9.32641139]
curr_Stock_Price:  98.7686876499563
curr_Factors:  [98.76868765 -1.23248099 -0.95116748]
mat_Sqrt:  [[11.12430282  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01092551 -0.00834656 -0.30622015]
Stock Position:  -0.010925510747611123
Bond Position:  [-8.24731303]


portfolio before change:  [-9.31744729]
curr_Stock_Price:  97.85384959141354
curr_Factors:  [97.85384959 -1.12556878 -0.94671867]
mat_Sqrt:  [[12.31955184  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00121358 -0.01461863 -0.1274221 ]
Stock Position:  0.0012135843305208264
Bond Position:  [-9.43620119]


portfolio before change:  [-9.3171874]
curr_Stock_Price:  99.04000017583876
curr_Factors:  [99.04000018 -1.13688357 -0.95533502]
mat_Sqrt:  [[12.22282639  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00577446 -0.03447464 -0.37357986]
Stock Position:  -0.005774459303104893
Bond Position:  [-8.74528495]


portfolio before change:  [-9.31342222]
curr_Stock_Price:  98.19863883143394
curr_Factors:  [98.19863883 -0.78639668 -0.97840303]
mat_Sqrt:  [[16.81367683  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00314448  0.03488771 -0.26906528]
Stock Position:  0.003144483963562301
Bond Position:  [-9.62220627]


portfolio before change:  [-9.31232651]
curr_Stock_Price:  98.92962107238725
curr_Factors:  [98.92962107 -0.98688893 -0.99756082]
mat_Sqrt:  [[13.5984926   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00729764 -0.0236774   0.03578468]
Stock Position:  -0.0072976409850237425
Bond Position:  [-8.59037365]


portfolio before change:  [-9.30854722]
curr_Stock_Price:  98.26459047277004
curr_Factors:  [98.26459047 -0.85487453 -1.01021893]
mat_Sqrt:  [[15.21939008  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00759732  0.01397048 -0.06526802]
Stock Position:  -0.007597317693143814
Bond Position:  [-8.56199991]


portfolio before change:  [-9.31752726]
curr_Stock_Price:  99.30571083953686
curr_Factors:  [99.30571084 -1.0954125  -1.00581323]
mat_Sqrt:  [[12.14572617  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00751293 -0.0354619   0.17604406]
Stock Position:  -0.007512933027783968
Bond Position:  [-8.5714501]


portfolio before change:  [-9.32662151]
curr_Stock_Price:  100.37356973711184
curr_Factors:  [100.37356974  -1.22476571  -1.00792656]
mat_Sqrt:  [[10.76399378  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.02730119 0.11697283 0.22812671]
Stock Position:  0.027301194907179333
Bond Position:  [-12.0669399]


portfolio before change:  [-9.35083058]
curr_Stock_Price:  99.54208210723729
curr_Factors:  [99.54208211 -1.05202374 -0.97224653]
mat_Sqrt:  [[13.14853347  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00756444 -0.04330736 -0.28477404]
Stock Position:  -0.007564436741753785
Bond Position:  [-8.59785079]


portfolio before change:  [-9.35634971]
curr_Stock_Price:  100.12961168800038
curr_Factors:  [100.12961169  -0.97203845  -0.9959881 ]
mat_Sqrt:  [[13.99134477  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00602735 -0.01823845 -0.17031334]
Stock Position:  -0.006027354319793449
Bond Position:  [-8.75283306]


portfolio before change:  [-9.35041963]
curr_Stock_Price:  98.96421602850072
curr_Factors:  [98.96421603 -0.94893029 -0.98824145]
mat_Sqrt:  [[14.2618278   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00332712  0.05482985  0.3654142 ]
Stock Position:  -0.003327120260904595
Bond Position:  [-9.02115378]


portfolio before change:  [-9.35113559]
curr_Stock_Price:  98.84046165903224
curr_Factors:  [98.84046166 -1.03808882 -0.99824045]
mat_Sqrt:  [[12.89936114  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01084885 0.02067931 0.35316494]
Stock Position:  0.01084884554143407
Bond Position:  [-10.4234405]


portfolio before change:  [-9.34831405]
curr_Stock_Price:  99.22064531676587
curr_Factors:  [99.22064532 -1.5077793  -0.97044004]
mat_Sqrt:  [[ 8.32386563  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00612149 -0.0090478   0.22576565]
Stock Position:  0.006121493025787101
Bond Position:  [-9.95569254]


portfolio before change:  [-9.35063345]
curr_Stock_Price:  99.04505849820771
curr_Factors:  [99.0450585  -1.40153784 -1.00301124]
mat_Sqrt:  [[ 8.94438361  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-7.18885852e-06 -1.32327501e-02  1.21124019e-02]
Stock Position:  -7.188858522980656e-06
Bond Position:  [-9.34992142]


portfolio before change:  [-9.35180286]
curr_Stock_Price:  99.12835009573404
curr_Factors:  [99.1283501  -1.20723355 -0.99331283]
mat_Sqrt:  [[10.97773462  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01305792 -0.0198019   0.40270168]
Stock Position:  0.013057921805763316
Bond Position:  [-10.6462131]


portfolio before change:  [-9.35973011]
curr_Stock_Price:  98.6231862648524
curr_Factors:  [98.62318626 -1.17739448 -0.96362455]
mat_Sqrt:  [[11.5916772   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00115345 -0.02844113  0.52785959]
Stock Position:  0.0011534524104123156
Bond Position:  [-9.47348726]


portfolio before change:  [-9.36179478]
curr_Stock_Price:  97.85990418976694
curr_Factors:  [97.85990419 -1.20651017 -0.96196423]
mat_Sqrt:  [[11.1904698   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-7.62278719e-03 -1.79293823e-04 -2.33989905e-01]
Stock Position:  -0.007622787193210083
Bond Position:  [-8.61582955]


portfolio before change:  [-9.36586272]
curr_Stock_Price:  98.25226635936873
curr_Factors:  [98.25226636 -0.83585619 -0.97389705]
mat_Sqrt:  [[16.08335807  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01872169  0.0357157   0.1849925 ]
Stock Position:  -0.018721687396878437
Bond Position:  [-7.5264145]


portfolio before change:  [-9.36807054]
curr_Stock_Price:  98.3199397251995
curr_Factors:  [98.31993973 -0.9694351  -0.96759076]
mat_Sqrt:  [[14.17104776  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00209003 -0.04991255  0.29449027]
Stock Position:  -0.002090032402187961
Bond Position:  [-9.16257868]


portfolio before change:  [-9.36854275]
curr_Stock_Price:  97.99784791884653
curr_Factors:  [97.99784792 -0.96526202 -0.9979483 ]
mat_Sqrt:  [[13.75957849  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01523424  0.01263372 -0.38627436]
Stock Position:  0.015234240351497142
Bond Position:  [-10.86146552]


portfolio before change:  [-9.35680833]
curr_Stock_Price:  98.85723991240086
curr_Factors:  [98.85723991 -0.9069114  -1.02690805]
mat_Sqrt:  [[14.2942497   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00239288  0.02094256  0.07583644]
Stock Position:  -0.0023928806791755994
Bond Position:  [-9.12025475]


portfolio before change:  [-9.36091335]
curr_Stock_Price:  100.09629750314372
curr_Factors:  [100.0962975   -1.01166243  -1.02278991]
mat_Sqrt:  [[13.08779822  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00842905 -0.01803556 -0.64111861]
Stock Position:  -0.008429047596663065
Bond Position:  [-8.5171969]


portfolio before change:  [-9.36705538]
curr_Stock_Price:  100.69865674618165
curr_Factors:  [100.69865675  -1.01667129  -1.02538515]
mat_Sqrt:  [[13.06681765  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00124334 -0.00161177 -0.32607394]
Stock Position:  -0.0012433391511947611
Bond Position:  [-9.2418528]


portfolio before change:  [-9.36762882]
curr_Stock_Price:  100.23066969054797
curr_Factors:  [100.23066969  -1.03523786  -1.03842819]
mat_Sqrt:  [[12.60140324  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00373672 0.03116852 0.07846565]
Stock Position:  0.003736724530060318
Bond Position:  [-9.74216322]


portfolio before change:  [-9.37000906]
curr_Stock_Price:  99.91959754986793
curr_Factors:  [99.91959755 -0.77994067 -1.04810323]
mat_Sqrt:  [[16.05984309  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00031182 -0.02082161 -0.2579797 ]
Stock Position:  -0.00031181993908261594
Bond Position:  [-9.33885213]


portfolio before change:  [-9.3706963]
curr_Stock_Price:  98.37965839764031
curr_Factors:  [98.3796584  -0.84609316 -1.04636344]
mat_Sqrt:  [[14.82592675  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01478301 -0.06618241 -0.33831513]
Stock Position:  0.014783010733320922
Bond Position:  [-10.82504385]


portfolio before change:  [-9.37579762]
curr_Stock_Price:  98.12611718292234
curr_Factors:  [98.12611718 -0.90044719 -1.03921366]
mat_Sqrt:  [[14.10589382  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00345031 -0.02603619  0.00367782]
Stock Position:  -0.003450306063665791
Bond Position:  [-9.03723248]


portfolio before change:  [-9.37830071]
curr_Stock_Price:  98.52415841009615
curr_Factors:  [98.52415841 -1.0631564  -1.00857881]
mat_Sqrt:  [[12.41079399  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01317702  0.02357876  0.06868352]
Stock Position:  -0.0131770151238721
Bond Position:  [-8.08004638]


portfolio before change:  [-9.37758472]
curr_Stock_Price:  98.3931682105421
curr_Factors:  [98.39316821 -1.04958838 -1.03905409]
mat_Sqrt:  [[12.18650155  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00390758 -0.0429944  -0.30684842]
Stock Position:  0.003907576973649452
Bond Position:  [-9.7620636]


portfolio before change:  [-9.38044905]
curr_Stock_Price:  97.97244780672663
curr_Factors:  [97.97244781 -1.05255561 -1.04963458]
mat_Sqrt:  [[11.97110824  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00325353 -0.04512067 -0.14841857]
Stock Position:  -0.0032535253411862175
Bond Position:  [-9.06169321]


portfolio before change:  [-9.37955109]
curr_Stock_Price:  97.34828156397283
curr_Factors:  [97.34828156 -1.15688757 -1.03264557]
mat_Sqrt:  [[10.89999072  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00330586  0.00542759 -0.22361331]
Stock Position:  -0.003305855214611849
Bond Position:  [-9.05773177]


portfolio before change:  [-9.38074286]
curr_Stock_Price:  97.36627375863353
curr_Factors:  [97.36627376 -1.24538217 -1.02080987]
mat_Sqrt:  [[10.09749978  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00046414 -0.01836127  0.02628039]
Stock Position:  0.0004641351912024712
Bond Position:  [-9.42593397]


portfolio before change:  [-9.3818557]
curr_Stock_Price:  97.50734631967399
curr_Factors:  [97.50734632 -1.19593006 -1.00751478]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-9.3818557]
Stock Price:  97.18755596386079
PL:  [-9.3818557]
Settle:  Tensor("sub_184:0", shape=(), dtype=float64)
PL:  Tensor("sub_185:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  93
output_Z_Vals[:, i, :]:  [[ 1.19260232e+02 -2.92559343e+01 -2.92733494e+01]
 [ 4.03706775e-03 -1.27034308e-01 -3.91946428e-02]
 [-7.21538462e-02 -2.70255257e-02  8.92827619e-02]
 [-2.17992716e-01 -1.09381772e-01 -1.48240915e-02]
 [-1.10004925e-01  9.11822509e-02 -6.95573263e-02]
 [ 3.84131609e-02  2.87623198e-02  5.82756210e-02]
 [ 6.38663556e-02  5.03450047e-02  4.16312193e-03]
 [-7.34745166e-02  3.53987892e-02 -7.75361612e-02]
 [ 9.66423819e-02 -3.96756651e-02 -1.42146776e-01]
 [-1.35754509e-01 -1.64202734e-01 -9.04227907e-02]
 [ 1.65106445e-01  9.30278112e-02  1.45632000e-01]
 [-2.56825637e-01 -1.18508680e-01  7.69563390e-02]
 [-3.10783341e-02 -1.17552366e-01  3.51034949e-02]
 [-9.62623594e-02 -1.14884369e-01  6.32126881e-02]
 [ 2.97125194e-01  4.19183618e-01  9.81495723e-02]
 [-1.89611596e-02 -4.66415415e-01 -2.00181126e-02]
 [-6.58547942e-02 -6.07899615e-02 -2.88015293e-02]
 [-3.80433135e-02  1.37567202e-01  4.29120958e-02]
 [-3.73613497e-02  5.29795730e-02 -7.05455252e-02]
 [-6.90628687e-02 -2.99797915e-02  1.50184016e-01]
 [ 1.49728801e-01 -1.30076261e-01  6.22542548e-02]
 [ 1.22359515e-01  1.23129851e-01  3.12464297e-01]
 [ 1.85074461e-02 -1.70336305e-01  5.53461448e-02]
 [-8.85933645e-02 -5.23840220e-02 -7.70497274e-02]
 [-5.77552679e-01  1.74660663e-01  2.84548899e-02]
 [-8.57664238e-02 -2.01783140e-01  1.15776656e-01]
 [ 2.16760885e-01  5.42457956e-02 -1.44926562e-01]
 [ 3.58149478e-02 -5.35477106e-02 -1.94700657e-02]
 [-1.07991344e-01 -1.21904436e-01 -1.44633665e-01]
 [ 4.63878460e-02  4.09620815e-02 -1.02109664e-01]
 [ 6.61601147e-02 -2.97980466e-02  4.96813163e-02]
 [ 7.21810312e-02 -1.08010228e-01 -8.23464542e-02]
 [ 3.68040967e-01 -3.57390428e-01 -2.99850599e-01]
 [-4.58619010e-02 -8.14110369e-02  3.88911118e-03]
 [-1.49684452e-01 -5.10400374e-02  1.92087480e-02]
 [ 1.12895192e-01 -6.20558028e-02 -3.67650188e-02]
 [ 1.44664527e-02 -1.64421046e-02 -8.90657911e-02]
 [-1.70493059e-02  1.87192181e-02 -7.94164394e-02]
 [ 4.49280060e-02 -1.12150757e-01 -3.65281218e-03]
 [-8.94483656e-01  4.44117022e-01  5.46913337e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.26023247 -29.25593426 -29.27334937]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  8.31486419  -9.25153874 -83.50871763]
init_Out:  [2.49911038]
Stock Position:  8.31486419409362
Bond position:  [-828.98730903]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-0.38390919]
curr_Stock_Price:  99.66573240233855
curr_Factors:  [99.6657324  -0.92387204 -0.98307202]
mat_Sqrt:  [[14.80371025  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0004893  -0.04017178 -0.11181141]
Stock Position:  -0.0004893041555674381
Bond Position:  [-0.33514233]


portfolio before change:  [-0.38346904]
curr_Stock_Price:  98.6805701710325
curr_Factors:  [98.68057017 -0.53220727 -0.97027108]
mat_Sqrt:  [[21.96410916  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0024871  -0.00854622  0.25469887]
Stock Position:  -0.00248709722101272
Bond Position:  [-0.13804087]


portfolio before change:  [-0.38102268]
curr_Stock_Price:  97.69001316647064
curr_Factors:  [97.69001317 -0.5573199  -0.96450674]
mat_Sqrt:  [[21.3269748   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01049576 -0.03458955 -0.04228901]
Stock Position:  -0.010495764085963371
Bond Position:  [0.64430865]


portfolio before change:  [-0.37638293]
curr_Stock_Price:  97.2556273154031
curr_Factors:  [97.25562732 -0.82386795 -0.95111162]
mat_Sqrt:  [[16.48355588  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00739215  0.02883436 -0.19842769]
Stock Position:  -0.0073921512787766454
Bond Position:  [0.34254538]


portfolio before change:  [-0.37695324]
curr_Stock_Price:  97.33857137304189
curr_Factors:  [97.33857137 -0.9594445  -0.97432566]
mat_Sqrt:  [[14.07535174  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.003627   0.00909544 0.16624413]
Stock Position:  0.003626997252558639
Bond Position:  [-0.72999998]


portfolio before change:  [-0.37915697]
curr_Stock_Price:  96.75614209012994
curr_Factors:  [96.75614209 -1.02914287 -0.93785052]
mat_Sqrt:  [[13.5339376   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00487782 0.01592049 0.01187623]
Stock Position:  0.004877815583978764
Bond Position:  [-0.85111559]


portfolio before change:  [-0.37514926]
curr_Stock_Price:  97.59957415906987
curr_Factors:  [97.59957416 -1.05612427 -0.93586528]
mat_Sqrt:  [[13.31489832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00663824  0.01119408 -0.22118909]
Stock Position:  -0.006638242692419995
Bond Position:  [0.2727404]


portfolio before change:  [-0.36800189]
curr_Stock_Price:  96.52801408649295
curr_Factors:  [96.52801409 -0.98644245 -0.93253491]
mat_Sqrt:  [[14.16615841  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00470151 -0.01254655 -0.40550519]
Stock Position:  0.004701512539826049
Bond Position:  [-0.82182956]


portfolio before change:  [-0.36960135]
curr_Stock_Price:  96.20966332944371
curr_Factors:  [96.20966333 -0.95903872 -0.90624704]
mat_Sqrt:  [[14.89825428  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01063559 -0.05192546 -0.25795105]
Stock Position:  -0.010635587032458036
Bond Position:  [0.65364489]


portfolio before change:  [-0.36506556]
curr_Stock_Price:  95.79087283787035
curr_Factors:  [95.79087284 -0.86625053 -0.90595619]
mat_Sqrt:  [[16.28037977  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01211492 0.02941798 0.41544756]
Stock Position:  0.012114915196707045
Bond Position:  [-1.52556386]


portfolio before change:  [-0.37313871]
curr_Stock_Price:  95.14023338000813
curr_Factors:  [95.14023338 -0.91043199 -0.91321568]
mat_Sqrt:  [[15.35904073  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01589792 -0.03747573  0.21953501]
Stock Position:  -0.015897924559120025
Bond Position:  [1.13939354]


portfolio before change:  [-0.37825698]
curr_Stock_Price:  95.47113856022885
curr_Factors:  [95.47113856 -0.90330244 -0.92951893]
mat_Sqrt:  [[15.27171795  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00176457 -0.03717332  0.1001405 ]
Stock Position:  -0.0017645724197927972
Bond Position:  [-0.20979124]


portfolio before change:  [-0.38049185]
curr_Stock_Price:  96.7227949160239
curr_Factors:  [96.72279492 -1.0094187  -0.95037642]
mat_Sqrt:  [[13.62701171  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00633488 -0.03632963  0.1803282 ]
Stock Position:  -0.00633487568643293
Bond Position:  [0.23223504]


portfolio before change:  [-0.38200765]
curr_Stock_Price:  96.96665749700044
curr_Factors:  [96.9666575  -1.06373559 -0.958188  ]
mat_Sqrt:  [[12.83843737  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.02554697 0.1325575  0.27999341]
Stock Position:  0.025546969375184816
Bond Position:  [-2.85921188]


portfolio before change:  [-0.39024053]
curr_Stock_Price:  96.65838389571242
curr_Factors:  [96.6583839  -1.29194357 -0.97620272]
mat_Sqrt:  [[10.00451662  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00350743 -0.1474935  -0.0571061 ]
Stock Position:  -0.003507429222294302
Bond Position:  [-0.05121809]


portfolio before change:  [-0.38739609]
curr_Stock_Price:  95.84558204648246
curr_Factors:  [95.84558205 -1.29929302 -0.99135194]
mat_Sqrt:  [[ 9.69968514  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0075573  -0.01922347 -0.08216275]
Stock Position:  -0.007557304257936486
Bond Position:  [0.33693813]


portfolio before change:  [-0.39057091]
curr_Stock_Price:  96.27125440689845
curr_Factors:  [96.27125441 -1.50075209 -0.99421509]
mat_Sqrt:  [[ 7.94229752  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00323986  0.04350257  0.12241626]
Stock Position:  -0.0032398621075852303
Bond Position:  [-0.07866532]


portfolio before change:  [-0.39140163]
curr_Stock_Price:  96.5246259954479
curr_Factors:  [96.524626   -1.58706574 -0.98876896]
mat_Sqrt:  [[ 7.34458619  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00686131  0.01675361 -0.20124675]
Stock Position:  -0.006861308009403575
Bond Position:  [0.27088356]


portfolio before change:  [-0.39053983]
curr_Stock_Price:  96.40395867874504
curr_Factors:  [96.40395868 -1.56830412 -1.00946687]
mat_Sqrt:  [[ 7.32121485  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00535167 -0.00948044  0.42843319]
Stock Position:  -0.005351674628940469
Bond Position:  [0.12538279]


portfolio before change:  [-0.39196852]
curr_Stock_Price:  96.67384857626668
curr_Factors:  [96.67384858 -1.83241784 -1.01633759]
mat_Sqrt:  [[ 5.59899713  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.02841185 -0.04113373  0.17759406]
Stock Position:  0.028411845789558333
Bond Position:  [-3.138651]


portfolio before change:  [-0.39312109]
curr_Stock_Price:  96.64709172151674
curr_Factors:  [96.64709172 -1.98036    -1.01158023]
mat_Sqrt:  [[ 4.8507139   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.03902935 0.03893708 0.89137367]
Stock Position:  0.03902935238795498
Bond Position:  [-4.16519449]


portfolio before change:  [-0.3915002]
curr_Stock_Price:  96.7019625409636
curr_Factors:  [96.70196254 -1.84106343 -1.00405253]
mat_Sqrt:  [[ 5.62104582  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00451995 -0.05386507  0.15788715]
Stock Position:  0.004519953553971532
Bond Position:  [-0.82858858]


portfolio before change:  [-0.39200475]
curr_Stock_Price:  96.61325194043879
curr_Factors:  [96.61325194 -1.6075456  -1.00616039]
mat_Sqrt:  [[ 7.07813127  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01492959 -0.01656528 -0.21980143]
Stock Position:  -0.014929593681804123
Bond Position:  [1.05039185]


portfolio before change:  [-0.39501035]
curr_Stock_Price:  96.82336540750009
curr_Factors:  [96.82336541 -1.47915712 -0.99223011]
mat_Sqrt:  [[ 8.17843747  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.06935734  0.05523255  0.08117388]
Stock Position:  -0.06935733537694999
Bond Position:  [6.32040028]


portfolio before change:  [-0.41206222]
curr_Stock_Price:  97.08061251949113
curr_Factors:  [97.08061252 -1.24823935 -0.98871884]
mat_Sqrt:  [[10.36654187  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00649625 -0.06380943  0.33027857]
Stock Position:  -0.006496248422101923
Bond Position:  [0.21859755]


portfolio before change:  [-0.41372239]
curr_Stock_Price:  97.34037716367794
curr_Factors:  [97.34037716 -1.24865833 -1.01487432]
mat_Sqrt:  [[10.12169586  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01863112  0.01715403 -0.41343514]
Stock Position:  0.018631116495971954
Bond Position:  [-2.2272823]


portfolio before change:  [-0.41902636]
curr_Stock_Price:  97.07063789777764
curr_Factors:  [97.0706379  -1.31178158 -1.01914162]
mat_Sqrt:  [[ 9.43584506  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00322791 -0.01693327 -0.05554268]
Stock Position:  0.003227908166533963
Bond Position:  [-0.73236147]


portfolio before change:  [-0.42003789]
curr_Stock_Price:  96.78562960873613
curr_Factors:  [96.78562961 -1.32183183 -1.01447746]
mat_Sqrt:  [[ 9.35760368  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01503185 -0.03854957 -0.41259959]
Stock Position:  -0.015031853378968231
Bond Position:  [1.0348295]


portfolio before change:  [-0.42612206]
curr_Stock_Price:  97.19898679986103
curr_Factors:  [97.1989868  -1.11568527 -0.99166792]
mat_Sqrt:  [[11.81543938  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0022515   0.01295335 -0.29129045]
Stock Position:  0.0022514976937393592
Bond Position:  [-0.64496535]


portfolio before change:  [-0.42786442]
curr_Stock_Price:  96.4609287295072
curr_Factors:  [96.46092873 -1.0556769  -0.95260271]
mat_Sqrt:  [[12.94692668  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00583396 -0.00942297  0.14172697]
Stock Position:  0.005833962800744938
Bond Position:  [-0.99061389]


portfolio before change:  [-0.42775808]
curr_Stock_Price:  96.5003826525876
curr_Factors:  [96.50038265 -0.99556669 -0.94490301]
mat_Sqrt:  [[13.86097415  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00379362 -0.03415583 -0.23491151]
Stock Position:  0.003793623662749175
Bond Position:  [-0.79384422]


portfolio before change:  [-0.43145322]
curr_Stock_Price:  95.552501417259
curr_Factors:  [95.55250142 -0.99470641 -0.97029454]
mat_Sqrt:  [[13.39223291  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.02222232 -0.11301678 -0.8553903 ]
Stock Position:  0.022222316536554185
Bond Position:  [-2.55485115]


portfolio before change:  [-0.42700388]
curr_Stock_Price:  95.76709293266204
curr_Factors:  [95.76709293 -1.20706173 -0.95693891]
mat_Sqrt:  [[11.00025537  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00428809 -0.02574443  0.01109455]
Stock Position:  -0.004288088032948031
Bond Position:  [-0.01634615]


portfolio before change:  [-0.42634414]
curr_Stock_Price:  95.61276306199385
curr_Factors:  [95.61276306 -1.15277934 -0.94458143]
mat_Sqrt:  [[11.73933946  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01252893 -0.01614028  0.05479721]
Stock Position:  -0.012528927351409095
Bond Position:  [0.77158122]


portfolio before change:  [-0.43072326]
curr_Stock_Price:  95.96998231717595
curr_Factors:  [95.96998232 -1.03474503 -0.93763898]
mat_Sqrt:  [[13.35180327  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00777335 -0.01962377 -0.10488037]
Stock Position:  0.007773353778662468
Bond Position:  [-1.17673189]


portfolio before change:  [-0.42990596]
curr_Stock_Price:  96.09404705041695
curr_Factors:  [96.09404705 -0.99321756 -0.91519512]
mat_Sqrt:  [[14.25224854  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00029038 -0.00519945 -0.25407991]
Stock Position:  -0.0002903793802926556
Bond Position:  [-0.40200223]


portfolio before change:  [-0.43016053]
curr_Stock_Price:  96.79766613971884
curr_Factors:  [96.79766614 -1.22588741 -0.94025859]
mat_Sqrt:  [[11.09480388  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00295425  0.00591954 -0.226553  ]
Stock Position:  -0.002954246957231396
Bond Position:  [-0.14419632]


portfolio before change:  [-0.42991653]
curr_Stock_Price:  96.70897173480434
curr_Factors:  [96.70897173 -1.21830338 -0.93330681]
mat_Sqrt:  [[11.24693878  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00367092 -0.03546518 -0.01042046]
Stock Position:  0.0036709241091741488
Bond Position:  [-0.78492783]


portfolio before change:  [-0.42835742]
curr_Stock_Price:  97.16042112814553
curr_Factors:  [97.16042113 -1.05789374 -0.9133857 ]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-0.42835742]
Stock Price:  97.1464132767121
PL:  [-0.42835742]
Settle:  Tensor("sub_186:0", shape=(), dtype=float64)
PL:  Tensor("sub_187:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  94
output_Z_Vals[:, i, :]:  [[ 1.19260232e+02 -2.92559343e+01 -2.92733494e+01]
 [-2.77269857e-03 -6.83909781e-02 -2.58320823e-02]
 [-3.99787611e-02 -6.22667607e-03  2.32059587e-02]
 [ 8.56833871e-02  1.76824735e-01  3.80435449e-02]
 [ 7.47910256e-02  1.80854500e-02 -6.80168416e-02]
 [ 6.65566082e-02  2.88331191e-02 -6.12140588e-02]
 [ 7.24024769e-02  2.25365680e-02 -5.17050257e-02]
 [-8.93248159e-02  8.52292165e-03 -9.46089151e-02]
 [ 8.27620496e-02 -3.48442096e-02 -9.89857386e-02]
 [-3.50779676e-02 -1.05725744e-01 -1.31597964e-01]
 [ 5.68003610e-02  1.40876385e-01 -8.31689310e-02]
 [-3.33246001e-02  4.25516753e-02 -3.90026697e-03]
 [-8.46740477e-02 -1.86060887e-02 -5.89108462e-02]
 [ 7.46298070e-03  1.40311361e-03  1.35686528e-01]
 [ 1.48476613e-01  1.17570676e-01 -5.19084252e-02]
 [-7.17405199e-02 -9.08515573e-02 -1.19135034e-01]
 [-8.10742644e-02 -1.29289446e-02 -7.54972031e-02]
 [ 2.54025187e-02 -2.17089374e-01 -8.36350712e-02]
 [ 1.88162983e-02  5.62847472e-02  5.28653394e-03]
 [ 3.30738181e-01 -1.56759957e-01 -8.68728083e-02]
 [-5.05171471e-02  2.62550749e-03  1.11701125e-02]
 [ 9.71566153e-02 -6.36273903e-02  9.38232263e-02]
 [-4.98091231e-02  4.33433711e-03  2.58099180e-01]
 [-6.42953964e-02 -6.68100853e-04 -8.32616031e-02]
 [-2.74839532e-01  1.05866706e-01  5.93599629e-02]
 [-3.72142137e-02 -1.47139670e-01  1.00202559e-01]
 [ 2.34458034e-01  4.05625824e-02 -1.31947152e-01]
 [ 4.48335562e-03  2.66069214e-02  1.57731151e-02]
 [-1.13794197e-01 -1.34607848e-01 -1.30538550e-01]
 [ 1.30107295e-01  1.60473499e-01  9.12445980e-03]
 [ 5.53516270e-02 -2.02280129e-02  4.18213781e-02]
 [ 4.65237523e-02 -1.00479290e-01 -7.85205235e-02]
 [ 1.44555882e-01 -6.64792216e-02  5.81492953e-02]
 [-4.57115325e-02 -8.12642381e-02  4.30277450e-03]
 [-1.81672418e-01  1.58093975e-01  2.81012151e-02]
 [ 8.47165236e-02 -1.65012150e-01 -1.38726811e-01]
 [-1.50899539e-01 -2.42224025e-01  1.98781090e-02]
 [-3.94725478e-02 -1.69527529e-02  7.03016605e-03]
 [-3.85758553e-02  8.26335696e-02 -2.42679663e-02]
 [-3.85586332e-01  2.03808970e-01  2.32475776e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.26023247 -29.25593426 -29.27334937]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  8.31486419  -9.25153874 -83.50871763]
init_Out:  [2.49911038]
Stock Position:  8.31486419409362
Bond position:  [-828.98730903]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [3.37018861]
curr_Stock_Price:  100.11722477907452
curr_Factors:  [100.11722478  -1.21943464  -0.99358241]
mat_Sqrt:  [[10.94983837  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00089604 -0.02162713 -0.07369174]
Stock Position:  -0.000896040418391016
Bond Position:  [3.45989769]


portfolio before change:  [3.37079579]
curr_Stock_Price:  99.92229540532817
curr_Factors:  [99.92229541 -0.99524366 -1.00998663]
mat_Sqrt:  [[13.45246746  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00263168 -0.00196905  0.06620014]
Stock Position:  -0.0026316835036567857
Bond Position:  [3.63375964]


portfolio before change:  [3.37121062]
curr_Stock_Price:  99.93727209231207
curr_Factors:  [99.93727209 -1.13857946 -1.02227422]
mat_Sqrt:  [[11.51544325  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00851158 0.05591689 0.10852764]
Stock Position:  0.008511577548215004
Bond Position:  [2.52058678]


portfolio before change:  [3.36545866]
curr_Stock_Price:  99.224471557055
curr_Factors:  [99.22447156 -1.11488156 -1.03125093]
mat_Sqrt:  [[11.60286648  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00528956  0.00571912 -0.19403312]
Stock Position:  0.005289564467755864
Bond Position:  [2.84060442]


portfolio before change:  [3.36452296]
curr_Stock_Price:  98.98044475856668
curr_Factors:  [98.98044476 -1.14156445 -1.00849964]
mat_Sqrt:  [[11.52891483  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00475377  0.00911783 -0.17462667]
Stock Position:  0.004753769929202241
Bond Position:  [2.8939927]


portfolio before change:  [3.36030212]
curr_Stock_Price:  98.0164504262618
curr_Factors:  [98.01645043 -1.43417273 -1.00789088]
mat_Sqrt:  [[ 8.52558562  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00732268  0.00712669 -0.14750005]
Stock Position:  0.007322678728222352
Bond Position:  [2.64255915]


portfolio before change:  [3.36150587]
curr_Stock_Price:  98.13572470907067
curr_Factors:  [98.13572471 -1.29319392 -0.9868704 ]
mat_Sqrt:  [[10.03708911  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01080161  0.00269518 -0.2698929 ]
Stock Position:  -0.010801609685461714
Bond Position:  [4.42152967]


portfolio before change:  [3.37034286]
curr_Stock_Price:  97.36877772380315
curr_Factors:  [97.36877772 -0.87136044 -0.99170362]
mat_Sqrt:  [[15.11128099  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0040802  -0.01101871 -0.28237876]
Stock Position:  0.004080196558328072
Bond Position:  [2.97305911]


portfolio before change:  [3.37682383]
curr_Stock_Price:  98.86608537455712
curr_Factors:  [98.86608537 -0.81357193 -0.98912053]
mat_Sqrt:  [[16.29851175  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00396785 -0.03343342 -0.37541236]
Stock Position:  -0.00396785408663949
Bond Position:  [3.76911003]


portfolio before change:  [3.37314508]
curr_Stock_Price:  99.91196920407894
curr_Factors:  [99.9119692  -0.92213679 -0.97202719]
mat_Sqrt:  [[15.031162    0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00289139  0.04454902 -0.23725781]
Stock Position:  0.002891392342456747
Bond Position:  [3.08426038]


portfolio before change:  [3.37604816]
curr_Stock_Price:  100.78266664169534
curr_Factors:  [100.78266664  -0.84812048  -1.01482897]
mat_Sqrt:  [[15.64289681  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00211099  0.01345602 -0.01112638]
Stock Position:  -0.002110993866322546
Bond Position:  [3.58879975]


portfolio before change:  [3.37547425]
curr_Stock_Price:  101.2670537330609
curr_Factors:  [101.26705373  -0.97100719  -1.00542571]
mat_Sqrt:  [[14.03182862  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00692565 -0.00588376 -0.16805625]
Stock Position:  -0.006925653356859408
Bond Position:  [4.07681476]


portfolio before change:  [3.3778874]
curr_Stock_Price:  100.99220424795794
curr_Factors:  [100.99220425  -0.93632127  -1.01961762]
mat_Sqrt:  [[14.28349163  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00246411 0.0004437  0.3870759 ]
Stock Position:  0.002464110758871355
Bond Position:  [3.12903142]


portfolio before change:  [3.38153266]
curr_Stock_Price:  102.31280679925463
curr_Factors:  [102.3128068   -0.77884849  -1.0599703 ]
mat_Sqrt:  [[16.26826149  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00866205  0.03717911 -0.14808029]
Stock Position:  0.008662051050231295
Bond Position:  [2.49529391]


portfolio before change:  [3.38058533]
curr_Stock_Price:  102.16743016214122
curr_Factors:  [102.16743016  -0.79422463  -1.04732651]
mat_Sqrt:  [[16.20081909  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00607405 -0.02872979 -0.33985909]
Stock Position:  -0.006074053021770621
Bond Position:  [4.00115572]


portfolio before change:  [3.37695517]
curr_Stock_Price:  102.84742726570845
curr_Factors:  [102.84742727  -0.62820067  -1.02844112]
mat_Sqrt:  [[19.62108616  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00493443 -0.00408849 -0.21537251]
Stock Position:  -0.004934430725151065
Bond Position:  [3.88444868]


portfolio before change:  [3.37447687]
curr_Stock_Price:  103.44808236014212
curr_Factors:  [103.44808236  -0.71455278  -1.03471983]
mat_Sqrt:  [[17.98966192  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 1.51495772e-04 -6.86496877e-02 -2.38587579e-01]
Stock Position:  0.00015149577224830943
Bond Position:  [3.35880492]


portfolio before change:  [3.37473105]
curr_Stock_Price:  102.35435303344177
curr_Factors:  [102.35435303  -0.40817457  -1.03574091]
mat_Sqrt:  [[24.15582054  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00088379 0.0177988  0.01508101]
Stock Position:  0.0008837900340134271
Bond Position:  [3.28427129]


portfolio before change:  [3.37596717]
curr_Stock_Price:  103.28847152200551
curr_Factors:  [103.28847152  -0.43607396  -0.99591942]
mat_Sqrt:  [[24.66862978  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01252432 -0.04957185 -0.24782394]
Stock Position:  0.012524320222198496
Bond Position:  [2.08234928]


portfolio before change:  [3.34890336]
curr_Stock_Price:  101.10678640853656
curr_Factors:  [101.10678641  -0.60825877  -0.93892941]
mat_Sqrt:  [[21.52013626  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00223833  0.00083026  0.03186522]
Stock Position:  -0.002238334671544775
Bond Position:  [3.57521419]


portfolio before change:  [3.35173174]
curr_Stock_Price:  100.04284604789409
curr_Factors:  [100.04284605  -0.87803355  -0.92370199]
mat_Sqrt:  [[16.5082955   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00694592 -0.02012075  0.26765155]
Stock Position:  0.006945922976502549
Bond Position:  [2.65684184]


portfolio before change:  [3.35173101]
curr_Stock_Price:  99.99492448679896
curr_Factors:  [99.99492449 -0.89296611 -0.9236257 ]
mat_Sqrt:  [[16.25706557  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [1.83739399e-04 1.37063774e-03 7.36285120e-01]
Stock Position:  0.0001837393993367017
Bond Position:  [3.333358]


portfolio before change:  [3.35200353]
curr_Stock_Price:  99.21024362259412
curr_Factors:  [99.21024362 -0.8033477  -0.91101027]
mat_Sqrt:  [[17.86571123  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-4.55108387e-03 -2.11272040e-04 -2.37522178e-01]
Stock Position:  -0.004551083871164894
Bond Position:  [3.80351767]


portfolio before change:  [3.35437295]
curr_Stock_Price:  98.79409018901951
curr_Factors:  [98.79409019 -0.88838044 -0.92136885]
mat_Sqrt:  [[16.17211556  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01607639  0.03347799  0.16933745]
Stock Position:  -0.01607639167250179
Bond Position:  [4.94262544]


portfolio before change:  [3.35595997]
curr_Stock_Price:  98.73380556646246
curr_Factors:  [98.73380557 -1.00713006 -0.90451329]
mat_Sqrt:  [[14.59653321  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00140852 -0.04652965  0.28585001]
Stock Position:  -0.0014085249965880694
Bond Position:  [3.49502901]


portfolio before change:  [3.35731552]
curr_Stock_Price:  98.08160720554784
curr_Factors:  [98.08160721 -0.88744899 -0.88822602]
mat_Sqrt:  [[16.61199195  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01255549  0.01282701 -0.3764085 ]
Stock Position:  0.012555493428485184
Bond Position:  [2.12585254]


portfolio before change:  [3.34946872]
curr_Stock_Price:  97.43547226024067
curr_Factors:  [97.43547226 -0.97172692 -0.88152601]
mat_Sqrt:  [[15.27072206  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00054942 0.00841385 0.04499631]
Stock Position:  0.0005494184864671104
Bond Position:  [3.29593587]


portfolio before change:  [3.34948138]
curr_Stock_Price:  96.7085870063666
curr_Factors:  [96.70858701 -0.79930677 -0.86003231]
mat_Sqrt:  [[18.40022905  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00782141 -0.04256674 -0.37239015]
Stock Position:  -0.007821414981122574
Bond Position:  [4.10587937]


portfolio before change:  [3.360015]
curr_Stock_Price:  95.4274427241971
curr_Factors:  [95.42744272 -0.61867773 -0.84678825]
mat_Sqrt:  [[22.04090887  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00617548 0.05074618 0.02602954]
Stock Position:  0.006175481540352991
Bond Position:  [2.77070459]


portfolio before change:  [3.36126255]
curr_Stock_Price:  95.57337193990536
curr_Factors:  [95.57337194 -0.32373674 -0.85090099]
mat_Sqrt:  [[29.52556544  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00214614 -0.00639666  0.11930475]
Stock Position:  0.0021461433177274282
Bond Position:  [3.15614839]


portfolio before change:  [3.36472101]
curr_Stock_Price:  97.00101337928218
curr_Factors:  [97.00101338 -0.34759142 -0.85245272]
mat_Sqrt:  [[29.21485418  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00095504 -0.03177434 -0.2239972 ]
Stock Position:  0.0009550433906987109
Bond Position:  [3.27208084]


portfolio before change:  [3.36525115]
curr_Stock_Price:  97.12781641783097
curr_Factors:  [97.12781642 -0.30321814 -0.82564836]
mat_Sqrt:  [[31.41109915  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0049253  -0.02102258  0.16588375]
Stock Position:  0.004925299508187558
Bond Position:  [2.88686757]


portfolio before change:  [3.37453976]
curr_Stock_Price:  98.94044299523172
curr_Factors:  [98.940443   -0.39685902 -0.81946104]
mat_Sqrt:  [[29.31789334  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00160078 -0.02569801  0.01227462]
Stock Position:  -0.0016007789300801478
Bond Position:  [3.53292154]


portfolio before change:  [3.37166533]
curr_Stock_Price:  101.01198396449281
curr_Factors:  [101.01198396  -0.66074422  -0.8166513 ]
mat_Sqrt:  [[23.0541004   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00745439  0.0499937   0.08016494]
Stock Position:  -0.007454392482965091
Bond Position:  [4.1246483]


portfolio before change:  [3.37710339]
curr_Stock_Price:  100.35164113045727
curr_Factors:  [100.35164113  -0.68164461  -0.80804335]
mat_Sqrt:  [[22.62357432  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00230461 -0.05218142 -0.39574898]
Stock Position:  0.002304606502198457
Bond Position:  [3.14583235]


portfolio before change:  [3.38198531]
curr_Stock_Price:  102.29933252433453
curr_Factors:  [102.29933252  -0.79314187  -0.83120483]
mat_Sqrt:  [[20.15709721  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00759515 -0.07659796  0.05670671]
Stock Position:  -0.007595147892408798
Bond Position:  [4.15896387]


portfolio before change:  [3.37895577]
curr_Stock_Price:  102.76666236603198
curr_Factors:  [102.76666237  -0.76484374  -0.80494692]
mat_Sqrt:  [[21.38458527  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0017992  -0.00536093  0.02005511]
Stock Position:  -0.0017992043750202156
Bond Position:  [3.563854]


portfolio before change:  [3.37800404]
curr_Stock_Price:  103.54325226362664
curr_Factors:  [103.54325226  -0.78269193  -0.8143012 ]
mat_Sqrt:  [[20.96797526  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00197425  0.02613103 -0.06922975]
Stock Position:  -0.001974246109429944
Bond Position:  [3.5824239]


portfolio before change:  [3.38227059]
curr_Stock_Price:  101.60898358298348
curr_Factors:  [101.60898358  -0.94810833  -0.7730762 ]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [3.38227059]
Stock Price:  101.01171112413664
PL:  [2.37055947]
Settle:  Tensor("sub_188:0", shape=(), dtype=float64)
PL:  Tensor("sub_189:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  95
output_Z_Vals[:, i, :]:  [[ 1.19260232e+02 -2.92559343e+01 -2.92733494e+01]
 [-4.09507240e-02  5.76461729e-02 -3.17851393e-03]
 [-4.57296769e-02 -5.64838347e-02 -4.48231506e-02]
 [ 8.53048198e-02  1.73382411e-01  3.79975558e-02]
 [ 2.33844521e-01 -1.56056489e-02 -3.06369184e-02]
 [ 6.61385619e-03  3.20806796e-02  8.95882177e-02]
 [ 5.10725880e-03  6.23569857e-02 -4.70821641e-02]
 [-1.09085812e-01  2.71687522e-01  2.55910911e-02]
 [ 3.54440359e-02  1.73351941e-02 -7.11919363e-02]
 [-5.01563657e-02  4.26973615e-01  1.93676707e-01]
 [ 3.33258201e-02 -7.35490659e-02 -4.39436366e-02]
 [-1.08457293e-01  1.17939153e-01  4.33856267e-02]
 [-3.00095046e-02 -1.16937800e-01 -4.52728226e-02]
 [ 2.13157573e-01  1.83546805e-01  2.72482139e-01]
 [ 1.34283039e-01  6.83130521e-02 -8.95076466e-02]
 [-7.16901234e-02 -7.87793622e-02 -1.12921533e-01]
 [-7.23001455e-02 -5.36740097e-02 -4.78377809e-02]
 [-7.31991342e-02  6.19826197e-03  6.57718744e-02]
 [ 3.71925761e-02  6.64732587e-02  4.03401099e-02]
 [ 3.16205207e-01 -9.04082775e-02 -5.80948831e-02]
 [-4.05704302e-02 -3.73990874e-03  1.52251663e-03]
 [ 1.08005273e-01 -6.16491778e-02  1.18536168e-01]
 [-5.68628345e-02  2.69069059e-02  2.88977122e-01]
 [-3.61479108e-02 -6.32288065e-03 -8.04398769e-02]
 [-1.21928681e-01  7.00787560e-02  7.89447187e-02]
 [ 3.94586754e-03 -1.01065720e-01  8.70280669e-02]
 [ 9.16144519e-02  4.58677715e-02 -7.33028700e-02]
 [-5.07806065e-02  7.36225950e-02  2.93687317e-02]
 [-7.19664785e-02 -6.68187018e-02 -2.11491331e-01]
 [ 5.13645157e-02  4.21274493e-02 -1.00049732e-01]
 [ 5.40173778e-02  3.40580134e-02  2.18071869e-02]
 [ 5.31407120e-02 -1.03331304e-01 -7.89636319e-02]
 [ 2.66292064e-01 -1.42400391e-01  3.10266981e-03]
 [-4.38007769e-02 -7.93988428e-02  9.55925830e-03]
 [-1.90370234e-01  9.67863401e-02  1.97227115e-02]
 [ 7.41214343e-02 -1.39571069e-01 -1.06902137e-01]
 [-1.81341541e-02 -1.20026894e-01 -6.43507089e-02]
 [-1.60310301e-02  2.84680098e-02 -6.25400810e-02]
 [ 1.60770572e-01 -2.24983461e-01 -4.43681141e-02]
 [-6.47259006e-01  3.35614412e-01  3.82579955e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.26023247 -29.25593426 -29.27334937]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  8.31486419  -9.25153874 -83.50871763]
init_Out:  [2.49911038]
Stock Position:  8.31486419409362
Bond position:  [-828.98730903]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [6.70863942]
curr_Stock_Price:  100.51872872813415
curr_Factors:  [100.51872873  -1.01662074  -1.00027948]
mat_Sqrt:  [[13.37575637  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00299879  0.01822932 -0.00906742]
Stock Position:  -0.0029987924809402604
Bond Position:  [7.01007423]


portfolio before change:  [6.70914764]
curr_Stock_Price:  100.64147476016456
curr_Factors:  [100.64147476  -1.10381337  -1.01622769]
mat_Sqrt:  [[12.07966409  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00466384 -0.01786176 -0.12786797]
Stock Position:  -0.004663835861145218
Bond Position:  [7.17852296]


portfolio before change:  [6.70680026]
curr_Stock_Price:  101.33720204471281
curr_Factors:  [101.33720204  -1.17718811  -0.98568883]
mat_Sqrt:  [[11.65315129  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00837008 0.05482833 0.10839645]
Stock Position:  0.008370075227310423
Bond Position:  [5.85860025]


portfolio before change:  [6.71421247]
curr_Stock_Price:  102.13526425525932
curr_Factors:  [102.13526426  -1.00645063  -0.98649881]
mat_Sqrt:  [[13.92030566  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01632061 -0.00493494 -0.0873986 ]
Stock Position:  0.01632060789492097
Bond Position:  [5.04730287]


portfolio before change:  [6.71860178]
curr_Stock_Price:  102.3655475259906
curr_Factors:  [102.36554753  -0.996203    -0.98243417]
mat_Sqrt:  [[14.15280768  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00181796 0.0101448  0.25557025]
Stock Position:  0.0018179639481460028
Bond Position:  [6.53250491]


portfolio before change:  [6.71854784]
curr_Stock_Price:  101.88668526864501
curr_Factors:  [101.88668527  -0.86696963  -0.96003547]
mat_Sqrt:  [[16.39302883  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0001765   0.01971901 -0.13431231]
Stock Position:  -0.00017649558807011535
Bond Position:  [6.73653039]


portfolio before change:  [6.71953423]
curr_Stock_Price:  101.06926350522085
curr_Factors:  [101.06926351  -0.84826468  -0.96781161]
mat_Sqrt:  [[16.44020344  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00589087  0.08591514  0.07300426]
Stock Position:  -0.005890870577074929
Bond Position:  [7.31492018]


portfolio before change:  [6.71776201]
curr_Stock_Price:  101.52533215613002
curr_Factors:  [101.52533216  -0.62614326  -0.95677973]
mat_Sqrt:  [[20.85065482  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00102441  0.00548187 -0.20309078]
Stock Position:  0.001024410779738716
Bond Position:  [6.61375837]


portfolio before change:  [6.71810745]
curr_Stock_Price:  101.05546907606795
curr_Factors:  [101.05546908  -0.56766389  -0.96806447]
mat_Sqrt:  [[21.75712304  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [1.84830430e-05 1.35020912e-01 5.52505735e-01]
Stock Position:  1.848304302388003e-05
Bond Position:  [6.71623964]


portfolio before change:  [6.71898151]
curr_Stock_Price:  102.92097441414087
curr_Factors:  [102.92097441  -0.82381397  -0.96525967]
mat_Sqrt:  [[17.19962909  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00130566 -0.02325826 -0.12535896]
Stock Position:  0.0013056580495118667
Bond Position:  [6.58460192]


portfolio before change:  [6.72086292]
curr_Stock_Price:  103.73150897579126
curr_Factors:  [103.73150898  -0.7838996   -0.9958922 ]
mat_Sqrt:  [[17.49673185  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00551852  0.03729563  0.12376712]
Stock Position:  -0.0055185198975093285
Bond Position:  [7.29330732]


portfolio before change:  [6.72535058]
curr_Stock_Price:  103.08352030349027
curr_Factors:  [103.0835203   -0.63828738  -0.98122649]
mat_Sqrt:  [[20.41001391  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00207105 -0.03697898 -0.12915076]
Stock Position:  -0.002071047180845409
Bond Position:  [6.93884142]


portfolio before change:  [6.72716913]
curr_Stock_Price:  102.6242660167558
curr_Factors:  [102.62426602  -0.79671902  -0.98543999]
mat_Sqrt:  [[17.26904178  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01583857 0.0580426  0.7773157 ]
Stock Position:  0.015838569287858817
Bond Position:  [5.10174758]


portfolio before change:  [6.71698536]
curr_Stock_Price:  101.9410270232385
curr_Factors:  [101.94102702  -0.66959918  -0.94540876]
mat_Sqrt:  [[20.27495826  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00580895  0.02160248 -0.2553404 ]
Stock Position:  0.005808949190745798
Bond Position:  [6.12481511]


portfolio before change:  [6.71658723]
curr_Stock_Price:  101.74068393739266
curr_Factors:  [101.74068394  -0.7799917   -0.92883881]
mat_Sqrt:  [[18.42294237  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00525292 -0.02491222 -0.3221337 ]
Stock Position:  -0.005252918191309841
Bond Position:  [7.25102271]


portfolio before change:  [6.72244057]
curr_Stock_Price:  100.79893829778767
curr_Factors:  [100.7989383   -0.75302211  -0.94816894]
mat_Sqrt:  [[18.39238583  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00453725 -0.01697321 -0.13646787]
Stock Position:  -0.004537249781627165
Bond Position:  [7.17979053]


portfolio before change:  [6.72243745]
curr_Stock_Price:  100.99743935234258
curr_Factors:  [100.99743935  -0.90006724  -0.9400483 ]
mat_Sqrt:  [[16.03830022  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00371694  0.00196006  0.18762885]
Stock Position:  -0.0037169442704275313
Bond Position:  [7.09783931]


portfolio before change:  [6.72192132]
curr_Stock_Price:  101.37501319210782
curr_Factors:  [101.37501319  -0.91207795  -0.95525557]
mat_Sqrt:  [[15.66600574  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00300927 0.02102069 0.11507911]
Stock Position:  0.0030092736792921345
Bond Position:  [6.41685616]


portfolio before change:  [6.72499674]
curr_Stock_Price:  102.13043135960012
curr_Factors:  [102.13043136  -1.06657361  -0.96352613]
mat_Sqrt:  [[13.41201572  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.02251804 -0.02858961 -0.16572853]
Stock Position:  0.022518040070001452
Bond Position:  [4.42521959]


portfolio before change:  [6.70871904]
curr_Stock_Price:  101.38299131278515
curr_Factors:  [101.38299131  -0.90123195  -0.95609326]
mat_Sqrt:  [[15.82482844  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00255018 -0.00118266  0.00434332]
Stock Position:  -0.0025501832144314016
Bond Position:  [6.96726424]


portfolio before change:  [6.71459357]
curr_Stock_Price:  99.42094607556587
curr_Factors:  [99.42094608 -0.84013947 -0.92857981]
mat_Sqrt:  [[16.9563694   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00770269 -0.01949518  0.33815069]
Stock Position:  0.007702686182364884
Bond Position:  [5.94878523]


portfolio before change:  [6.71698222]
curr_Stock_Price:  99.63450803189036
curr_Factors:  [99.63450803 -0.74022764 -0.91380766]
mat_Sqrt:  [[19.05773921  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [1.47924515e-04 8.50871073e-03 8.24371293e-01]
Stock Position:  0.0001479245145358999
Bond Position:  [6.70224383]


portfolio before change:  [6.71780998]
curr_Stock_Price:  99.56639662671078
curr_Factors:  [99.56639663 -0.60519903 -0.92190627]
mat_Sqrt:  [[21.62217535  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00243874 -0.00199947 -0.22947258]
Stock Position:  -0.0024387411115766957
Bond Position:  [6.96062664]


portfolio before change:  [6.7183199]
curr_Stock_Price:  99.7140990264738
curr_Factors:  [99.71409903 -0.5558268  -0.91945291]
mat_Sqrt:  [[22.80608452  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00456039  0.02216085  0.22520731]
Stock Position:  -0.004560394031319773
Bond Position:  [7.17305548]


portfolio before change:  [6.71819864]
curr_Stock_Price:  99.93731500505474
curr_Factors:  [99.93731501 -0.62602551 -0.93263119]
mat_Sqrt:  [[21.02866358  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00090833 -0.03195979  0.24826685]
Stock Position:  0.0009083264640535229
Bond Position:  [6.62742293]


portfolio before change:  [6.71852185]
curr_Stock_Price:  99.38105013657828
curr_Factors:  [99.38105014 -0.39293414 -0.92211279]
mat_Sqrt:  [[26.68000795  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00291739  0.01450466 -0.20911268]
Stock Position:  0.0029173854487488026
Bond Position:  [6.42858902]


portfolio before change:  [6.71963899]
curr_Stock_Price:  99.48851443588894
curr_Factors:  [99.48851444 -0.4648711  -0.90508372]
mat_Sqrt:  [[25.28186604  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00169627  0.02328151  0.08378082]
Stock Position:  -0.001696267670446612
Bond Position:  [6.88839814]


portfolio before change:  [6.72059599]
curr_Stock_Price:  99.43197566327896
curr_Factors:  [99.43197566 -0.38048805 -0.89688753]
mat_Sqrt:  [[27.71844747  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00421604 -0.02112993 -0.6033259 ]
Stock Position:  -0.00421604483110821
Bond Position:  [7.13980566]


portfolio before change:  [6.72700375]
curr_Stock_Price:  98.12382549778988
curr_Factors:  [98.1238255  -0.48229898 -0.90325407]
mat_Sqrt:  [[24.54914822  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00130472  0.01332187 -0.28541404]
Stock Position:  0.0013047163730400247
Bond Position:  [6.59897998]


portfolio before change:  [6.72648199]
curr_Stock_Price:  97.0916664343051
curr_Factors:  [97.09166643 -0.47291988 -0.90869729]
mat_Sqrt:  [[24.38671149  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00243363 0.01077009 0.06220983]
Stock Position:  0.0024336255974649213
Bond Position:  [6.49019723]


portfolio before change:  [6.72647729]
curr_Stock_Price:  96.75635145306012
curr_Factors:  [96.75635145 -0.48417827 -0.90703643]
mat_Sqrt:  [[24.07036183  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00142725 -0.03267623 -0.22526126]
Stock Position:  0.0014272459066818123
Bond Position:  [6.58838218]


portfolio before change:  [6.72535563]
curr_Stock_Price:  95.39340928151903
curr_Factors:  [95.39340928 -0.4713718  -0.89335647]
mat_Sqrt:  [[24.36825414  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01080293 -0.04503096  0.00885105]
Stock Position:  0.010802933598597927
Bond Position:  [5.69482697]


portfolio before change:  [6.73440634]
curr_Stock_Price:  96.16531187653139
curr_Factors:  [96.16531188 -0.63835938 -0.89611567]
mat_Sqrt:  [[20.73024319  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00211766 -0.02510812  0.0272699 ]
Stock Position:  -0.002117658260518154
Bond Position:  [6.93805161]


portfolio before change:  [6.73230274]
curr_Stock_Price:  97.56823508103331
curr_Factors:  [97.56823508 -0.72729691 -0.91894576]
mat_Sqrt:  [[18.80850776  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00977458  0.03060653  0.05626341]
Stock Position:  -0.00977458403001206
Bond Position:  [7.68599166]


portfolio before change:  [6.72477432]
curr_Stock_Price:  98.4367360452242
curr_Factors:  [98.43673605 -0.87247181 -0.92845878]
mat_Sqrt:  [[16.25634807  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00299553 -0.04413625 -0.30496204]
Stock Position:  0.0029955324060861304
Bond Position:  [6.42990388]


portfolio before change:  [6.72514785]
curr_Stock_Price:  98.29310496052696
curr_Factors:  [98.29310496 -0.65823866 -0.93560847]
mat_Sqrt:  [[19.96751595  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00172123 -0.03795584 -0.18357466]
Stock Position:  -0.001721234061557219
Bond Position:  [6.89433329]


portfolio before change:  [6.72931119]
curr_Stock_Price:  96.37500833957064
curr_Factors:  [96.37500834 -0.59586121 -0.92668173]
mat_Sqrt:  [[21.02482712  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0013347   0.00900238 -0.17840944]
Stock Position:  -0.0013347044264358007
Bond Position:  [6.85794334]


portfolio before change:  [6.73081359]
curr_Stock_Price:  95.89168128604398
curr_Factors:  [95.89168129 -0.30455674 -0.91434514]
mat_Sqrt:  [[28.34122207  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00514815 -0.07114602 -0.12656988]
Stock Position:  0.005148152069264378
Bond Position:  [6.23714863]


portfolio before change:  [6.72826481]
curr_Stock_Price:  95.2451436072675
curr_Factors:  [95.24514361 -0.18935998 -0.91471481]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [6.72826481]
Stock Price:  94.00186432758083
PL:  [6.72826481]
Settle:  Tensor("sub_190:0", shape=(), dtype=float64)
PL:  Tensor("sub_191:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  96
output_Z_Vals[:, i, :]:  [[ 1.19260232e+02 -2.92559343e+01 -2.92733494e+01]
 [ 2.06664877e-02 -1.19688877e-02 -4.08585578e-02]
 [-4.24645925e-02 -1.75930745e-02  7.51531746e-03]
 [ 8.85039731e-02  2.02472407e-01  3.83861957e-02]
 [ 1.26417565e-01  2.05043073e-04 -6.21684422e-02]
 [ 6.86484046e-02  2.82113651e-02 -1.24601400e-01]
 [ 6.35784483e-02  2.11698005e-02 -5.39321234e-02]
 [-1.13504331e-01 -5.38012006e-02 -1.18779890e-01]
 [-2.43183563e-01 -8.60132302e-02  2.02876939e-01]
 [-1.05079421e-02 -9.21432014e-02 -1.34247814e-01]
 [ 5.34098871e-02  9.17776542e-02 -7.66221114e-02]
 [-5.15335289e-02  8.50582557e-02  4.37899037e-03]
 [-1.05268475e-01  3.60169765e-02 -5.01576103e-02]
 [-5.74252917e-02 -4.58309738e-03  1.09009878e-01]
 [ 3.32087954e-01  4.37069020e-01  7.30720107e-02]
 [-7.03945293e-02 -8.32007199e-02 -1.01487021e-01]
 [-6.89752947e-02 -6.22809235e-02 -6.31903915e-02]
 [-7.69388268e-02  1.85238931e-01  1.30717494e-01]
 [ 9.57105499e-02  5.91744745e-02  9.32184715e-02]
 [ 1.36781878e-01 -4.29315336e-02  2.60797892e-02]
 [-3.64962145e-02 -1.90427349e-02 -1.26447300e-02]
 [ 8.16041877e-02 -6.16482853e-02  7.93412036e-02]
 [-5.49154966e-02  3.00931577e-02  1.98145770e-01]
 [ 1.09024440e-01 -2.11026537e-02 -8.11361526e-03]
 [ 5.05976730e-02  3.44155624e-02  7.59296598e-02]
 [ 1.02097432e-01  3.08824840e-03  5.62617554e-02]
 [-1.38598906e-01  7.34021369e-02  8.58900506e-02]
 [-5.07806065e-02  7.36225950e-02  2.93687317e-02]
 [ 6.20848838e-02 -6.23725319e-02  9.08311027e-02]
 [-6.27421030e-02 -1.16446890e-01 -3.60635954e-02]
 [-6.90129803e-02  4.49590109e-01 -4.02253528e-03]
 [ 4.37775340e-02 -5.98171304e-02  2.05862992e-02]
 [ 7.86322085e-02 -6.93756131e-02  1.53433595e-02]
 [-1.62889059e-01 -2.25220359e-02  4.57092393e-02]
 [-1.04244512e-01  1.21586338e-01  2.49960420e-02]
 [ 8.47165236e-02 -1.65012150e-01 -1.38726811e-01]
 [-2.70078727e-01 -4.80367705e-01  1.22623414e-01]
 [-5.64596449e-02 -6.01651247e-02  8.86470131e-02]
 [-1.93195969e-02  4.22509803e-02 -3.63503963e-02]
 [ 2.47185925e-01 -1.58802414e-02 -2.47413800e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.26023247 -29.25593426 -29.27334937]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  8.31486419  -9.25153874 -83.50871763]
init_Out:  [2.49911038]
Stock Position:  8.31486419409362
Bond position:  [-828.98730903]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [0.76933709]
curr_Stock_Price:  99.8044293495585
curr_Factors:  [99.80442935 -1.11897851 -0.99055784]
mat_Sqrt:  [[12.10569748  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00099269 -0.00378489 -0.11655809]
Stock Position:  0.0009926924239646172
Bond Position:  [0.67026199]


portfolio before change:  [0.76960879]
curr_Stock_Price:  99.9937213330013
curr_Factors:  [99.99372133 -1.32801729 -0.98494127]
mat_Sqrt:  [[ 9.89618007  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0041819  -0.00556342  0.02143911]
Stock Position:  -0.004181895001156277
Bond Position:  [1.18777203]


portfolio before change:  [0.76964463]
curr_Stock_Price:  100.02065508220682
curr_Factors:  [100.02065508  -1.38926823  -0.96532702]
mat_Sqrt:  [[ 9.49515298  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01069676 0.0640274  0.10950513]
Stock Position:  0.010696756306316495
Bond Position:  [-0.30025194]


portfolio before change:  [0.76273669]
curr_Stock_Price:  99.37836564968012
curr_Factors:  [99.37836565 -1.4949831  -0.94474889]
mat_Sqrt:  [[ 8.66422476  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 1.31267115e-02  6.48403129e-05 -1.77349261e-01]
Stock Position:  0.01312671153364767
Bond Position:  [-0.54177445]


portfolio before change:  [0.76192223]
curr_Stock_Price:  99.32147939613601
curr_Factors:  [99.3214794  -1.4299886  -0.91892312]
mat_Sqrt:  [[ 9.48252029  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00463407  0.00892122 -0.35545311]
Stock Position:  0.004634070192572948
Bond Position:  [0.30165952]


portfolio before change:  [0.76381876]
curr_Stock_Price:  99.72259972279276
curr_Factors:  [99.72259972 -1.86436519 -0.93132921]
mat_Sqrt:  [[ 6.09030359  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00872144  0.00669448 -0.15385334]
Stock Position:  0.008721437404528132
Bond Position:  [-0.10590565]


portfolio before change:  [0.76651303]
curr_Stock_Price:  100.03304198008016
curr_Factors:  [100.03304198  -1.73390197  -0.91142258]
mat_Sqrt:  [[ 7.10057663  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0195955  -0.01701343 -0.33884596]
Stock Position:  -0.01959549525488344
Bond Position:  [2.72671002]


portfolio before change:  [0.75403113]
curr_Stock_Price:  100.68741461447684
curr_Factors:  [100.68741461  -1.89833751  -0.90954563]
mat_Sqrt:  [[ 6.07473078  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.03358047 -0.02719977  0.57875144]
Stock Position:  -0.033580473038823694
Bond Position:  [4.13516214]


portfolio before change:  [0.76080769]
curr_Stock_Price:  100.5010075784185
curr_Factors:  [100.50100758  -1.94314484  -0.89632377]
mat_Sqrt:  [[ 5.87495935  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00685797 -0.02913824 -0.38297164]
Stock Position:  -0.0068579690643936625
Bond Position:  [1.45004049]


portfolio before change:  [0.75995287]
curr_Stock_Price:  100.65208636685841
curr_Factors:  [100.65208637  -1.55202474  -0.93925518]
mat_Sqrt:  [[ 8.33438688  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00481609  0.02902264 -0.21858156]
Stock Position:  0.0048160894741492485
Bond Position:  [0.27520341]


portfolio before change:  [0.75791798]
curr_Stock_Price:  100.22242492235381
curr_Factors:  [100.22242492  -1.59314095  -0.93327703]
mat_Sqrt:  [[ 8.01226894  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00604616  0.02689778  0.01249204]
Stock Position:  -0.006046162066769558
Bond Position:  [1.363879]


portfolio before change:  [0.75538764]
curr_Stock_Price:  100.66912678491462
curr_Factors:  [100.66912678  -1.41804947  -0.94553715]
mat_Sqrt:  [[ 9.47117091  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01209744  0.01138957 -0.1430857 ]
Stock Position:  -0.012097437702319427
Bond Position:  [1.97322613]


portfolio before change:  [0.7575716]
curr_Stock_Price:  100.50898636945665
curr_Factors:  [100.50898637  -1.41635957  -0.94097844]
mat_Sqrt:  [[ 9.51537714  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00370895 -0.0014493   0.31097484]
Stock Position:  -0.0037089521599007035
Bond Position:  [1.13035462]


portfolio before change:  [0.75975594]
curr_Stock_Price:  99.95814665806768
curr_Factors:  [99.95814666 -1.4315384  -0.94477259]
mat_Sqrt:  [[ 9.28537501  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.03858636 0.13821336 0.20845411]
Stock Position:  0.03858635638924143
Bond Position:  [-3.09726473]


portfolio before change:  [0.75163765]
curr_Stock_Price:  99.75778790110338
curr_Factors:  [99.7577879  -1.30343615 -0.94802296]
mat_Sqrt:  [[10.49906292  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00888258 -0.02631038 -0.28951422]
Stock Position:  -0.008882575023372962
Bond Position:  [1.63774368]


portfolio before change:  [0.75345723]
curr_Stock_Price:  99.57598752452284
curr_Factors:  [99.57598752 -1.02196603 -0.98375731]
mat_Sqrt:  [[13.39923621  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00623036 -0.01969496 -0.1802646 ]
Stock Position:  -0.006230360041009362
Bond Position:  [1.37385149]


portfolio before change:  [0.75595273]
curr_Stock_Price:  99.20301504064459
curr_Factors:  [99.20301504 -1.086953   -0.98301161]
mat_Sqrt:  [[12.51845301  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00363251  0.05857769  0.37290063]
Stock Position:  -0.003632508062862407
Bond Position:  [1.11630848]


portfolio before change:  [0.75791192]
curr_Stock_Price:  98.70208038170321
curr_Factors:  [98.70208038 -0.80742403 -0.96111457]
mat_Sqrt:  [[16.8368078   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.0069055  0.01871261 0.26592635]
Stock Position:  0.006905499577194846
Bond Position:  [0.07632475]


portfolio before change:  [0.76748597]
curr_Stock_Price:  100.08713692012437
curr_Factors:  [100.08713692  -0.95175751  -0.95878099]
mat_Sqrt:  [[14.81296311  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00951848 -0.01357614  0.07439838]
Stock Position:  0.009518480808742777
Bond Position:  [-0.18519152]


portfolio before change:  [0.76541615]
curr_Stock_Price:  99.87211621355395
curr_Factors:  [99.87211621 -1.08847804 -0.94763826]
mat_Sqrt:  [[13.0367753   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00303518 -0.00602184 -0.0360719 ]
Stock Position:  -0.0030351823662995276
Bond Position:  [1.06854624]


portfolio before change:  [0.76302493]
curr_Stock_Price:  100.70395885574347
curr_Factors:  [100.70395886  -1.01412234  -0.93021841]
mat_Sqrt:  [[14.40887535  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00667699 -0.0194949   0.22633837]
Stock Position:  0.0066769882354205555
Bond Position:  [0.09062579]


portfolio before change:  [0.76908246]
curr_Stock_Price:  101.6094864794373
curr_Factors:  [101.60948648  -1.20134065  -0.93942536]
mat_Sqrt:  [[11.9456942   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0011462   0.00951629  0.56525473]
Stock Position:  -0.0011462003392292309
Bond Position:  [0.88554729]


portfolio before change:  [0.76754949]
curr_Stock_Price:  103.04350747746857
curr_Factors:  [103.04350748  -1.10918991  -0.95895662]
mat_Sqrt:  [[13.02674776  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00820031 -0.00667325 -0.02314589]
Stock Position:  0.00820031129588931
Bond Position:  [-0.07743935]


portfolio before change:  [0.77492917]
curr_Stock_Price:  103.94461503239282
curr_Factors:  [103.94461503  -1.02977267  -0.92062781]
mat_Sqrt:  [[14.78270223  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00453133 0.01088316 0.21660618]
Stock Position:  0.004531333641550762
Bond Position:  [0.30392144]


portfolio before change:  [0.77831463]
curr_Stock_Price:  104.68335429215968
curr_Factors:  [104.68335429  -1.04138057  -0.92421744]
mat_Sqrt:  [[14.66321697  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00775147 0.00097659 0.16049913]
Stock Position:  0.0077514745341822735
Bond Position:  [-0.03313572]


portfolio before change:  [0.77649248]
curr_Stock_Price:  104.44881658360111
curr_Factors:  [104.44881658  -0.81219294  -0.89660059]
mat_Sqrt:  [[18.91402346  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00630069  0.02321179  0.24502041]
Stock Position:  -0.006300692105916317
Bond Position:  [1.43459231]


portfolio before change:  [0.7629367]
curr_Stock_Price:  106.62875389594967
curr_Factors:  [106.6287539   -1.01504006  -0.88999452]
mat_Sqrt:  [[15.86822417  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00270256  0.02328151  0.08378082]
Stock Position:  -0.002702558996779012
Bond Position:  [1.0511072]


portfolio before change:  [0.76071642]
curr_Stock_Price:  107.49892087101794
curr_Factors:  [107.49892087  -1.07556394  -0.89836135]
mat_Sqrt:  [[14.93273107  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00529141 -0.01972393  0.25911585]
Stock Position:  0.005291413390753991
Bond Position:  [0.19189519]


portfolio before change:  [0.75864768]
curr_Stock_Price:  107.10342641039628
curr_Factors:  [107.10342641  -1.08049473  -0.86881606]
mat_Sqrt:  [[15.24854639  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00479457 -0.03682374 -0.1028794 ]
Stock Position:  -0.004794568445201849
Bond Position:  [1.27216239]


portfolio before change:  [0.76185817]
curr_Stock_Price:  106.46698618107325
curr_Factors:  [106.46698618  -1.24647339  -0.87946028]
mat_Sqrt:  [[12.70380147  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00458333  0.14217288 -0.01147517]
Stock Position:  -0.004583329671743849
Bond Position:  [1.24983147]


portfolio before change:  [0.76359537]
curr_Stock_Price:  106.12204971638221
curr_Factors:  [106.12204972  -1.022716    -0.90143469]
mat_Sqrt:  [[15.49378768  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00299702 -0.01891584  0.05872698]
Stock Position:  0.002997022033631771
Bond Position:  [0.44554524]


portfolio before change:  [0.76496577]
curr_Stock_Price:  106.56071958800113
curr_Factors:  [106.56071959  -1.36084429  -0.85898126]
mat_Sqrt:  [[11.57548395  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00690882 -0.0219385   0.04377033]
Stock Position:  0.006908815942322899
Bond Position:  [0.02875737]


portfolio before change:  [0.76533343]
curr_Stock_Price:  106.61341562072501
curr_Factors:  [106.61341562  -1.35636986  -0.84696144]
mat_Sqrt:  [[11.77381562  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01309178 -0.00712209  0.13039574]
Stock Position:  -0.013091781003509082
Bond Position:  [2.16109292]


portfolio before change:  [0.75322019]
curr_Stock_Price:  107.5593060718505
curr_Factors:  [107.55930607  -1.32326719  -0.84308369]
mat_Sqrt:  [[12.32576151  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0077888   0.03844898  0.07130675]
Stock Position:  -0.007788798311422346
Bond Position:  [1.59097793]


portfolio before change:  [0.75449216]
curr_Stock_Price:  107.42153368267016
curr_Factors:  [107.42153368  -1.17788846  -0.82511567]
mat_Sqrt:  [[14.49431543  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00359716 -0.05218142 -0.39574898]
Stock Position:  0.0035971644692227344
Bond Position:  [0.36807923]


portfolio before change:  [0.75720824]
curr_Stock_Price:  108.16380473870204
curr_Factors:  [108.16380474  -0.94341114  -0.82160058]
mat_Sqrt:  [[18.51599709  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01390427 -0.15190561  0.34981047]
Stock Position:  -0.01390426705845798
Bond Position:  [2.26114667]


portfolio before change:  [0.76429323]
curr_Stock_Price:  107.67457889455602
curr_Factors:  [107.67457889  -0.79487814  -0.79515491]
mat_Sqrt:  [[21.95687872  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00181802 -0.01902588  0.25288525]
Stock Position:  -0.0018180227895193814
Bond Position:  [0.96004807]


portfolio before change:  [0.76232123]
curr_Stock_Price:  108.82528538930941
curr_Factors:  [108.82528539  -0.84629206  -0.81778573]
mat_Sqrt:  [[20.60772331  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00124461  0.01336093 -0.10369756]
Stock Position:  -0.0012446146763518142
Bond Position:  [0.89776678]


portfolio before change:  [0.76308167]
curr_Stock_Price:  108.30447313761817
curr_Factors:  [108.30447314  -0.88751277  -0.8273379 ]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [0.76308167]
Stock Price:  108.5819431406668
PL:  [-7.81886147]
Settle:  Tensor("sub_192:0", shape=(), dtype=float64)
PL:  Tensor("sub_193:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  97
output_Z_Vals[:, i, :]:  [[ 1.19260232e+02 -2.92559343e+01 -2.92733494e+01]
 [-1.29217727e-01  3.54389919e-01  5.65214838e-02]
 [ 8.65196840e-02  6.11887339e-02 -3.79156464e-02]
 [ 8.44492375e-02  1.65602576e-01  3.78936178e-02]
 [ 2.25082489e-01 -2.25051099e-02 -4.38497325e-02]
 [ 7.50584749e-02  3.01206712e-02 -5.31512275e-02]
 [ 7.06423660e-02  1.52193614e-02 -6.60968710e-02]
 [-1.06133169e-01 -5.24785452e-02 -1.16856134e-01]
 [ 7.28775192e-02  6.54837024e-04 -7.63565834e-02]
 [-7.20789208e-02  3.18230668e-01  1.38240325e-01]
 [ 5.96547343e-02  1.27007695e-01 -8.59965260e-02]
 [-1.01222815e-02 -1.09902956e-01 -2.86671219e-02]
 [-3.79100831e-02 -7.04502566e-02  1.69051986e-02]
 [ 2.62988925e-01  2.01278969e-01  2.96540067e-01]
 [ 1.28615706e-01  4.76822961e-02 -1.05614504e-01]
 [-7.58586514e-02 -1.01317498e-01 -1.20452555e-01]
 [-7.58516761e-02 -3.62876142e-02 -5.42450090e-02]
 [-8.53692084e-02  1.04371430e-01  1.13959768e-01]
 [ 8.22206000e-02  3.83580717e-02  4.64102742e-02]
 [-3.27472411e-02 -8.88841258e-03  9.80456010e-02]
 [ 1.83247111e-01 -1.60904212e-01  1.00205755e-01]
 [ 1.02255204e-01  3.07180011e-01  4.03291490e-01]
 [-8.68553447e-02  1.28249822e-01  3.73393203e-01]
 [-7.07527236e-02 -5.14440765e-04 -8.13801141e-02]
 [-4.81847170e-01  1.39131737e-01  9.09859002e-02]
 [-1.50504182e-01 -2.74828316e-01  1.36563693e-01]
 [ 6.03309305e-02  6.42425187e-02 -4.00193736e-02]
 [ 3.25617365e-02 -2.84492102e-02 -8.97346381e-03]
 [-1.34550766e-01 -2.03176920e-01 -6.00379596e-02]
 [ 2.11090933e-01  2.88473896e-01  2.21260134e-01]
 [ 5.37030437e-02 -1.84086446e-02  4.04935413e-02]
 [ 6.90860403e-02 -1.12024142e-01 -7.93427188e-02]
 [ 2.71910909e-01 -2.07838002e-01 -1.03207683e-01]
 [-4.36975608e-02 -7.92980770e-02  9.84320530e-03]
 [-1.91286867e-01  8.96937504e-02  1.87820269e-02]
 [ 1.26813519e-01 -7.53153673e-02 -4.25946837e-02]
 [ 8.15744904e-03 -3.02847233e-02 -8.90939660e-02]
 [-1.53899552e-02  2.87511911e-02 -6.27473019e-02]
 [ 1.09428022e-01 -1.78935189e-01 -2.56674085e-02]
 [-6.08013591e-01  3.19263066e-01  3.55266680e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.26023247 -29.25593426 -29.27334937]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  8.31486419  -9.25153874 -83.50871763]
init_Out:  [2.49911038]
Stock Position:  8.31486419409362
Bond position:  [-828.98730903]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [10.85124013]
curr_Stock_Price:  101.01694500816465
curr_Factors:  [101.01694501  -1.09172933  -0.9936129 ]
mat_Sqrt:  [[12.55282882  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00864586  0.11206793  0.16124006]
Stock Position:  -0.008645861494067698
Bond Position:  [11.72461864]


portfolio before change:  [10.85016385]
curr_Stock_Price:  101.31095200313811
curr_Factors:  [101.310952    -1.05058072  -0.99304738]
mat_Sqrt:  [[13.12562482  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00612238  0.01934958 -0.10816279]
Stock Position:  0.006122380648632261
Bond Position:  [10.22989964]


portfolio before change:  [10.85935108]
curr_Stock_Price:  102.60267380759188
curr_Factors:  [102.60267381  -1.18423312  -0.99069226]
mat_Sqrt:  [[11.65737023  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.0082746  0.05236813 0.10809994]
Stock Position:  0.008274600366503298
Bond Position:  [10.01035496]


portfolio before change:  [10.84996488]
curr_Stock_Price:  101.31710406600935
curr_Factors:  [101.31710407  -1.0808586   -0.99469776]
mat_Sqrt:  [[12.7139381   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01695388 -0.00711674 -0.12509108]
Stock Position:  0.016953883078682674
Bond Position:  [9.13224654]


portfolio before change:  [10.82801387]
curr_Stock_Price:  99.95502007272081
curr_Factors:  [99.95502007 -1.02972108 -0.98379336]
mat_Sqrt:  [[13.34585505  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00486943  0.00952499 -0.15162566]
Stock Position:  0.004869432361559594
Bond Position:  [10.34128966]


portfolio before change:  [10.82813707]
curr_Stock_Price:  99.7148405934755
curr_Factors:  [99.71484059 -0.93259966 -0.97941445]
mat_Sqrt:  [[14.73610202  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00390492  0.00481278 -0.18855598]
Stock Position:  0.003904924164993356
Bond Position:  [10.43875818]


portfolio before change:  [10.82839655]
curr_Stock_Price:  99.44711474918068
curr_Factors:  [99.44711475 -0.62055889 -1.000014  ]
mat_Sqrt:  [[19.66918317  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00667752 -0.01659517 -0.33335802]
Stock Position:  -0.006677517636789146
Bond Position:  [11.49245641]


portfolio before change:  [10.82403286]
curr_Stock_Price:  100.31575142699775
curr_Factors:  [100.31575143  -0.55448635  -1.03880072]
mat_Sqrt:  [[20.38981781  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 2.81062858e-03  2.07077649e-04 -2.17824079e-01]
Stock Position:  0.0028106285792025027
Bond Position:  [10.54208254]


portfolio before change:  [10.82444216]
curr_Stock_Price:  99.99249834978252
curr_Factors:  [99.99249835 -0.36978364 -1.0411561 ]
mat_Sqrt:  [[24.38956625  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00146145  0.10063337  0.39436117]
Stock Position:  -0.0014614467385241593
Bond Position:  [10.97057587]


portfolio before change:  [10.82568457]
curr_Stock_Price:  100.08076601840577
curr_Factors:  [100.08076602  -0.23835854  -1.01854744]
mat_Sqrt:  [[28.47628244  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00159361  0.04016336 -0.24532415]
Stock Position:  0.0015936101077196826
Bond Position:  [10.66619485]


portfolio before change:  [10.8265528]
curr_Stock_Price:  99.78890082926873
curr_Factors:  [99.78890083 -0.11324868 -1.01112665]
mat_Sqrt:  [[32.41695644  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0005803  -0.03475437 -0.08177932]
Stock Position:  -0.0005803017137993878
Bond Position:  [10.88446047]


portfolio before change:  [10.82749694]
curr_Stock_Price:  100.50664439020932
curr_Factors:  [100.50664439  -0.12415994  -1.00186754]
mat_Sqrt:  [[32.59622087  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00111296 -0.02227833  0.04822583]
Stock Position:  -0.0011129615865161666
Bond Position:  [10.93935697]


portfolio before change:  [10.82604203]
curr_Stock_Price:  103.04259037996552
curr_Factors:  [103.04259038  -0.21577499  -0.98827835]
mat_Sqrt:  [[30.91028767  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01063455 0.06365    0.84594627]
Stock Position:  0.01063454719124969
Bond Position:  [9.73023074]


portfolio before change:  [10.81395402]
curr_Stock_Price:  101.79153846955984
curr_Factors:  [101.79153847  -0.56644135  -0.99112474]
mat_Sqrt:  [[21.44219893  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00505025  0.01507847 -0.30128878]
Stock Position:  0.005050246354705973
Bond Position:  [10.29988167]


portfolio before change:  [10.81494082]
curr_Stock_Price:  101.7319838662517
curr_Factors:  [101.73198387  -0.45723791  -1.00717782]
mat_Sqrt:  [[23.5217615   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00438156 -0.03203941 -0.34361761]
Stock Position:  -0.004381556742216838
Bond Position:  [11.26068528]


portfolio before change:  [10.81581159]
curr_Stock_Price:  101.85452017673809
curr_Factors:  [101.85452018  -0.33676328  -1.0366751 ]
mat_Sqrt:  [[25.79310344  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00340639 -0.01147515 -0.15474591]
Stock Position:  -0.0034063886337704573
Bond Position:  [11.16276767]


portfolio before change:  [10.82624397]
curr_Stock_Price:  99.20157970283758
curr_Factors:  [99.2015797  -0.35693371 -1.04211139]
mat_Sqrt:  [[24.48617891  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00242637  0.03300514  0.3250955 ]
Stock Position:  -0.0024263650787538288
Bond Position:  [11.06694322]


portfolio before change:  [10.82932601]
curr_Stock_Price:  98.50152738469284
curr_Factors:  [98.50152738 -0.2008277  -1.04381044]
mat_Sqrt:  [[28.37288447  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00326666 0.01212989 0.13239559]
Stock Position:  0.0032666561917544506
Bond Position:  [10.50755538]


portfolio before change:  [10.82288294]
curr_Stock_Price:  96.12705089186001
curr_Factors:  [ 9.61270509e+01 -3.92356192e-02 -1.02420524e+00]
mat_Sqrt:  [[33.18937879  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00039058 -0.00281076  0.27969681]
Stock Position:  -0.00039058472732400785
Bond Position:  [10.86042869]


portfolio before change:  [10.82500559]
curr_Stock_Price:  94.16840258975414
curr_Factors:  [ 9.41684026e+01 -7.31966576e-02 -1.01902049e+00]
mat_Sqrt:  [[31.59085089  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00631661 -0.05088238  0.28585913]
Stock Position:  0.006316607186882213
Bond Position:  [10.23018078]


portfolio before change:  [10.81797883]
curr_Stock_Price:  92.85351625877536
curr_Factors:  [ 9.28535163e+01  5.13470496e-02 -1.01714057e+00]
mat_Sqrt:  [[35.34756957  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00544615 0.09713885 1.15047837]
Stock Position:  0.0054461477979721165
Bond Position:  [10.31228485]


portfolio before change:  [10.82780129]
curr_Stock_Price:  94.4203760480876
curr_Factors:  [ 9.44203760e+01 -8.43758389e-02 -1.00137656e+00]
mat_Sqrt:  [[31.88081753  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-2.29773909e-04  4.05561548e-02  1.06518688e+00]
Stock Position:  -0.00022977390940148476
Bond Position:  [10.84949663]


portfolio before change:  [10.82885746]
curr_Stock_Price:  95.72644212409293
curr_Factors:  [95.72644212 -0.22182085 -1.01202279]
mat_Sqrt:  [[27.8727894   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-3.13487292e-03 -1.62680454e-04 -2.32154814e-01]
Stock Position:  -0.0031348729182463864
Bond Position:  [11.12894769]


portfolio before change:  [10.83045304]
curr_Stock_Price:  95.66124939220772
curr_Factors:  [95.66124939 -0.3349386  -1.01292367]
mat_Sqrt:  [[24.85231799  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01849656  0.04399732  0.25955745]
Stock Position:  -0.0184965597465182
Bond Position:  [12.59985705]


portfolio before change:  [10.8569071]
curr_Stock_Price:  94.31618967417823
curr_Factors:  [94.31618967 -0.36287143 -1.00392035]
mat_Sqrt:  [[24.04341318  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00539542 -0.08690834  0.38957821]
Stock Position:  -0.0053954183144156185
Bond Position:  [11.3657824]


portfolio before change:  [10.85585531]
curr_Stock_Price:  94.77446733241364
curr_Factors:  [94.77446733 -0.40671614 -1.00146121]
mat_Sqrt:  [[23.18076161  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00232179  0.02031527 -0.11416413]
Stock Position:  0.0023217850073156978
Bond Position:  [10.63580937]


portfolio before change:  [10.85349205]
curr_Stock_Price:  93.18395653352096
curr_Factors:  [93.18395653 -0.13756398 -1.00755618]
mat_Sqrt:  [[29.64980069  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00101166 -0.00899643 -0.02559879]
Stock Position:  0.0010116587525750454
Bond Position:  [10.75922168]


portfolio before change:  [10.85460679]
curr_Stock_Price:  92.95636699534343
curr_Factors:  [92.956367   -0.25788043 -0.9799716 ]
mat_Sqrt:  [[26.95794821  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00564034 -0.06425018 -0.17127159]
Stock Position:  -0.0056403390807251465
Bond Position:  [11.37891222]


portfolio before change:  [10.85734756]
curr_Stock_Price:  92.72263753403807
curr_Factors:  [92.72263753 -0.29652612 -0.95778939]
mat_Sqrt:  [[26.45108402  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00996949 0.09122346 0.63119358]
Stock Position:  0.009969490569688445
Bond Position:  [9.93295009]


portfolio before change:  [10.88680081]
curr_Stock_Price:  95.55242659755733
curr_Factors:  [95.5524266  -0.33803094 -0.97496727]
mat_Sqrt:  [[25.70477722  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0023923  -0.00582132  0.1155168 ]
Stock Position:  0.0023922963231416414
Bond Position:  [10.65821109]


portfolio before change:  [10.88939874]
curr_Stock_Price:  96.08144528628034
curr_Factors:  [96.08144529 -0.69808017 -0.96796017]
mat_Sqrt:  [[18.15881061  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00275336 -0.03542514 -0.22634269]
Stock Position:  0.0027533645124206653
Bond Position:  [10.62485149]


portfolio before change:  [10.8925192]
curr_Stock_Price:  96.73238663621927
curr_Factors:  [96.73238664 -0.73649202 -0.95798186]
mat_Sqrt:  [[17.76933788  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01381466 -0.06572415 -0.29442279]
Stock Position:  0.013814660754088508
Bond Position:  [9.5561941]


portfolio before change:  [10.89558929]
curr_Stock_Price:  96.86814741123911
curr_Factors:  [96.86814741 -0.48826989 -0.97854548]
mat_Sqrt:  [[22.34349838  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00195743 -0.02507625  0.02807992]
Stock Position:  -0.0019574281421276345
Bond Position:  [11.08520173]


portfolio before change:  [10.89875181]
curr_Stock_Price:  95.96043325816846
curr_Factors:  [95.96043326 -0.53012485 -0.99072697]
mat_Sqrt:  [[20.96981734  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00882874  0.02836365  0.05357989]
Stock Position:  -0.008828742565078982
Bond Position:  [11.74596178]


portfolio before change:  [10.8977079]
curr_Stock_Price:  96.2449869921106
curr_Factors:  [96.24498699 -0.69383068 -0.99024059]
mat_Sqrt:  [[17.86468077  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00650301 -0.02381681 -0.12151078]
Stock Position:  0.006503014663394621
Bond Position:  [10.27182534]


portfolio before change:  [10.90463278]
curr_Stock_Price:  97.11240287220338
curr_Factors:  [97.11240287 -0.55940966 -0.9879986 ]
mat_Sqrt:  [[20.66540086  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00052313 -0.00957687 -0.25416029]
Stock Position:  -0.0005231318221359487
Bond Position:  [10.95543536]


portfolio before change:  [10.90646512]
curr_Stock_Price:  96.22766730610557
curr_Factors:  [96.22766731 -0.64099653 -0.97102583]
mat_Sqrt:  [[19.19585862  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0014303   0.00909192 -0.17900059]
Stock Position:  -0.0014303002845937574
Bond Position:  [11.04409958]


portfolio before change:  [10.90804127]
curr_Stock_Price:  96.09095340229494
curr_Factors:  [96.0909534  -0.78583236 -0.9455195 ]
mat_Sqrt:  [[17.0124141   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0058527  -0.05658428 -0.07322197]
Stock Position:  0.005852702466066791
Bond Position:  [10.34564951]


portfolio before change:  [10.90122428]
curr_Stock_Price:  94.70522186667027
curr_Factors:  [94.70522187 -0.51862012 -0.92035187]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [10.90122428]
Stock Price:  94.18699361170194
PL:  [10.90122428]
Settle:  Tensor("sub_194:0", shape=(), dtype=float64)
PL:  Tensor("sub_195:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  98
output_Z_Vals[:, i, :]:  [[ 1.19260232e+02 -2.92559343e+01 -2.92733494e+01]
 [-1.24614434e-01  3.38160226e-01  5.31770616e-02]
 [ 1.21809900e-01  5.14659631e-02 -9.17130970e-02]
 [ 8.63338556e-02  1.82739464e-01  3.81225652e-02]
 [ 2.23639673e-01 -2.36412216e-02 -4.60254435e-02]
 [ 4.97977301e-02  3.02125066e-02  3.75527611e-02]
 [ 6.93986966e-02  1.62629804e-02 -6.39290595e-02]
 [-1.41489964e-01  5.32535757e-02 -8.54966815e-02]
 [-1.64004040e-01 -7.50472461e-02  1.51073156e-01]
 [-3.28330011e-02  4.30364567e-02 -4.35925290e-02]
 [ 5.58762892e-02  1.21890489e-01 -8.11121264e-02]
 [-2.37729358e-02  7.24371734e-02 -8.87487744e-03]
 [-1.05268475e-01  3.60169765e-02 -5.01576103e-02]
 [-1.57070792e-01 -7.88757014e-02  4.39028406e-02]
 [ 3.49927331e-01  4.42097628e-01  5.56199170e-02]
 [-6.67348634e-02 -1.43461375e-01 -9.37245808e-02]
 [-6.97819686e-02 -5.97439281e-02 -6.99271378e-02]
 [-8.32024157e-02  1.25156149e-01  1.18266871e-01]
 [ 1.26346410e-01  6.74616005e-02  1.47925908e-01]
 [ 1.31914114e-01 -4.46238387e-02  3.35794457e-02]
 [-4.33037078e-02 -3.11637696e-03 -4.21647995e-02]
 [ 8.65239878e-02 -6.32167308e-02  8.39941907e-02]
 [-5.76043651e-02  4.58441456e-02  1.47461810e-01]
 [ 4.19132509e-02 -1.29969983e-02 -4.05828694e-02]
 [ 7.05143360e-02  3.15898829e-02  8.59435106e-02]
 [ 1.01393007e-01  4.61914376e-03  5.62234516e-02]
 [-1.47861022e-01  7.39115464e-02  8.07515220e-02]
 [-4.79119499e-02  7.13749063e-02  2.85224482e-02]
 [ 6.20848838e-02 -6.23725319e-02  9.08311027e-02]
 [ 3.50272084e-02  7.12085589e-03 -4.12520393e-02]
 [-3.72987841e-02  3.26439400e-01  1.39354679e-02]
 [ 2.16570266e-02 -1.12617018e-01 -6.93699517e-02]
 [ 7.09525870e-02 -3.53146402e-02  6.71132790e-02]
 [-5.87166002e-02 -5.92507771e-02  2.80421901e-02]
 [-1.14715512e-01  1.69489860e-02  3.65864806e-02]
 [ 8.47165236e-02 -1.65012150e-01 -1.38726811e-01]
 [-2.58270937e-01 -4.54203892e-01  1.10148905e-01]
 [-5.51207611e-02 -5.59706403e-02  8.21122836e-02]
 [-2.69171462e-02  5.81839152e-02 -3.15832782e-02]
 [ 1.85880185e-01 -1.11465390e-02 -1.82125051e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.26023247 -29.25593426 -29.27334937]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  8.31486419  -9.25153874 -83.50871763]
init_Out:  [2.49911038]
Stock Position:  8.31486419409362
Bond position:  [-828.98730903]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [10.59097273]
curr_Stock_Price:  100.98564354680204
curr_Factors:  [100.98564355  -1.07982633  -1.00786587]
mat_Sqrt:  [[12.51948423  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0083892   0.10693565  0.15169936]
Stock Position:  -0.008389199578432375
Bond Position:  [11.43816144]


portfolio before change:  [10.58812535]
curr_Stock_Price:  101.49549390037757
curr_Factors:  [101.4954939   -1.00345936  -1.03462983]
mat_Sqrt:  [[13.22257001  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00789694  0.01627497 -0.26163194]
Stock Position:  0.00789694349566559
Bond Position:  [9.78662117]


portfolio before change:  [10.58885502]
curr_Stock_Price:  101.43297160074293
curr_Factors:  [101.4329716   -1.32100943  -1.04415476]
mat_Sqrt:  [[ 9.52799223  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.010373   0.05778729 0.10875307]
Stock Position:  0.010373004288346224
Bond Position:  [9.53669037]


portfolio before change:  [10.58809354]
curr_Stock_Price:  101.24463260779059
curr_Factors:  [101.24463261  -1.12065285  -1.05307274]
mat_Sqrt:  [[11.51688363  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01854967 -0.00747601 -0.13129778]
Stock Position:  0.018549666911115235
Bond Position:  [8.71003933]


portfolio before change:  [10.58283022]
curr_Stock_Price:  100.90219315600102
curr_Factors:  [100.90219316  -0.89535713  -1.05330633]
mat_Sqrt:  [[14.37496577  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00405171 0.00955403 0.10712757]
Stock Position:  0.004051713224172633
Bond Position:  [10.17400347]


portfolio before change:  [10.58014674]
curr_Stock_Price:  99.92598477147054
curr_Factors:  [99.92598477 -0.9027077  -1.02017606]
mat_Sqrt:  [[14.60765925  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00388626  0.00514281 -0.18237181]
Stock Position:  0.003886258526976955
Bond Position:  [10.19180853]


portfolio before change:  [10.58203414]
curr_Stock_Price:  100.0838094067828
curr_Factors:  [100.08380941  -1.17304149  -1.04877201]
mat_Sqrt:  [[10.85031839  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01452187  0.01684026 -0.24389823]
Stock Position:  -0.01452186873416695
Bond Position:  [12.03543808]


portfolio before change:  [10.57957007]
curr_Stock_Price:  100.35709353326848
curr_Factors:  [100.35709353  -1.45385775  -1.01017309]
mat_Sqrt:  [[ 8.53951248  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01582105 -0.02373202  0.43096966]
Stock Position:  -0.015821052254156413
Bond Position:  [12.16732489]


portfolio before change:  [10.57978654]
curr_Stock_Price:  100.43954926407562
curr_Factors:  [100.43954926  -1.41563747  -0.98282106]
mat_Sqrt:  [[ 9.12572645  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00445116  0.01360932 -0.12435735]
Stock Position:  -0.004451162597466734
Bond Position:  [11.02685931]


portfolio before change:  [10.58214625]
curr_Stock_Price:  100.21909852061633
curr_Factors:  [100.21909852  -1.19627273  -0.95722394]
mat_Sqrt:  [[11.63318876  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00365046  0.03854516 -0.23139032]
Stock Position:  0.003650464671556001
Bond Position:  [10.21629997]


portfolio before change:  [10.5846894]
curr_Stock_Price:  100.56591310005182
curr_Factors:  [100.5659131   -1.60065095  -0.9607816 ]
mat_Sqrt:  [[ 7.76309286  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00305474  0.02290665 -0.02531756]
Stock Position:  -0.0030547351656637746
Bond Position:  [10.89189163]


portfolio before change:  [10.5882624]
curr_Stock_Price:  99.84197715932545
curr_Factors:  [99.84197716 -1.60010855 -0.96012711]
mat_Sqrt:  [[ 7.71643949  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01484842  0.01138957 -0.1430857 ]
Stock Position:  -0.01484841554226184
Bond Position:  [12.07075757]


portfolio before change:  [10.59091501]
curr_Stock_Price:  99.76495400348715
curr_Factors:  [99.764954   -1.61022892 -0.96936387]
mat_Sqrt:  [[ 7.56266897  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01985354 -0.02494269  0.12524258]
Stock Position:  -0.019853536429901654
Bond Position:  [12.57160216]


portfolio before change:  [10.60177339]
curr_Stock_Price:  99.29718687470198
curr_Factors:  [99.29718687 -1.34733643 -0.9759162 ]
mat_Sqrt:  [[ 9.72660199  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.03831714 0.13980355 0.15866814]
Stock Position:  0.03831714412795248
Bond Position:  [6.79698877]


portfolio before change:  [10.60519552]
curr_Stock_Price:  99.36432261168291
curr_Factors:  [99.36432261 -1.23592003 -0.9783906 ]
mat_Sqrt:  [[10.85344445  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00825272 -0.04536647 -0.26737014]
Stock Position:  -0.008252722952936864
Bond Position:  [11.42522175]


portfolio before change:  [10.60438025]
curr_Stock_Price:  99.63617411252815
curr_Factors:  [99.63617411 -1.32187804 -0.99799763]
mat_Sqrt:  [[ 9.79282153  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00874093 -0.01889269 -0.19948266]
Stock Position:  -0.00874092999310201
Bond Position:  [11.47529307]


portfolio before change:  [10.6010067]
curr_Stock_Price:  100.18623504184535
curr_Factors:  [100.18623504  -1.1709961   -0.97530433]
mat_Sqrt:  [[11.71336359  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00476633  0.03957785  0.33738246]
Stock Position:  -0.004766331498800875
Bond Position:  [11.07852751]


portfolio before change:  [10.60275255]
curr_Stock_Price:  100.11050671078381
curr_Factors:  [100.11050671  -1.24530837  -0.96985843]
mat_Sqrt:  [[10.92559102  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01448741 0.02133323 0.42199144]
Stock Position:  0.014487409449472468
Bond Position:  [9.15241065]


portfolio before change:  [10.6045032]
curr_Stock_Price:  100.15237249570384
curr_Factors:  [100.1523725   -1.3530809   -0.98090937]
mat_Sqrt:  [[ 9.7055945   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01417907 -0.0141113   0.09579281]
Stock Position:  0.014179070373084102
Bond Position:  [9.18443566]


portfolio before change:  [10.61730461]
curr_Stock_Price:  100.97423748764125
curr_Factors:  [100.97423749  -1.18764791  -1.00889744]
mat_Sqrt:  [[11.22698285  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0046309  -0.00098548 -0.12028444]
Stock Position:  -0.004630899210360718
Bond Position:  [11.08490613]


portfolio before change:  [10.6200155]
curr_Stock_Price:  100.68807494064191
curr_Factors:  [100.68807494  -1.22489361  -1.01263957]
mat_Sqrt:  [[10.74557669  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00949572 -0.01999089  0.23961205]
Stock Position:  0.009495719414629452
Bond Position:  [9.66390979]


portfolio before change:  [10.63891608]
curr_Stock_Price:  102.55128463398093
curr_Factors:  [102.55128463  -1.37487596  -1.02120904]
mat_Sqrt:  [[ 9.33973626  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00281808  0.01449719  0.4206675 ]
Stock Position:  -0.0028180836857346443
Bond Position:  [10.92791418]


portfolio before change:  [10.6416726]
curr_Stock_Price:  102.05788271050443
curr_Factors:  [102.05788271  -1.22820539  -1.0298216 ]
mat_Sqrt:  [[10.67082241  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00312007 -0.00411001 -0.11577163]
Stock Position:  0.0031200712594959923
Bond Position:  [10.32324474]


portfolio before change:  [10.64735739]
curr_Stock_Price:  103.46627998634374
curr_Factors:  [103.46627999  -1.24404173  -1.01634327]
mat_Sqrt:  [[10.79260055  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00823464 0.0099896  0.24517291]
Stock Position:  0.00823463525165077
Bond Position:  [9.79535031]


portfolio before change:  [10.65248625]
curr_Stock_Price:  103.94041923714714
curr_Factors:  [103.94041924  -1.31304519  -1.01122093]
mat_Sqrt:  [[10.17111387  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.0111088  0.0014607  0.16038986]
Stock Position:  0.01110879676512726
Bond Position:  [9.49783326]


portfolio before change:  [10.65236577]
curr_Stock_Price:  103.82269459591559
curr_Factors:  [103.8226946   -1.24036915  -1.04654763]
mat_Sqrt:  [[10.54622324  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01227637  0.02337288  0.23036162]
Stock Position:  -0.012276366238839152
Bond Position:  [11.9269312]


portfolio before change:  [10.65196242]
curr_Stock_Price:  103.977000253589
curr_Factors:  [103.97700025  -1.0817062   -1.04197045]
mat_Sqrt:  [[12.43472642  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00323666  0.02257073  0.08136661]
Stock Position:  -0.003236656446112066
Bond Position:  [10.98850025]


portfolio before change:  [10.65181411]
curr_Stock_Price:  104.4472248432706
curr_Factors:  [104.44722484  -1.03029619  -1.02652862]
mat_Sqrt:  [[13.35454945  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00591673 -0.01972393  0.25911585]
Stock Position:  0.0059167292364660454
Bond Position:  [10.03382816]


portfolio before change:  [10.64425633]
curr_Stock_Price:  102.95787284103086
curr_Factors:  [102.95787284  -0.78360027  -0.99373793]
mat_Sqrt:  [[17.40890228  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0015389   0.00225181 -0.11768059]
Stock Position:  0.001538898344018899
Bond Position:  [10.48581463]


portfolio before change:  [10.64625121]
curr_Stock_Price:  103.40239549822859
curr_Factors:  [103.4023955   -0.76513626  -0.98646415]
mat_Sqrt:  [[17.93990787  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00145071  0.1032292   0.03975401]
Stock Position:  -0.0014507092097281748
Bond Position:  [10.79625802]


portfolio before change:  [10.6475388]
curr_Stock_Price:  103.44514913420487
curr_Factors:  [103.44514913  -0.84297369  -0.97924787]
mat_Sqrt:  [[16.72358423  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00027441 -0.03561263 -0.19789316]
Stock Position:  0.0002744139961124262
Bond Position:  [10.61915201]


portfolio before change:  [10.64917449]
curr_Stock_Price:  104.56830914543421
curr_Factors:  [104.56830915  -0.94196586  -1.02672253]
mat_Sqrt:  [[14.60190706  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00573488 -0.01116747  0.1914555 ]
Stock Position:  0.005734881561221659
Bond Position:  [10.04948762]


portfolio before change:  [10.65304696]
curr_Stock_Price:  105.02450088657761
curr_Factors:  [105.02450089  -1.25252303  -1.01533034]
mat_Sqrt:  [[10.87362677  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00501418 -0.01873674  0.07999656]
Stock Position:  -0.005014183557804931
Bond Position:  [11.17965909]


portfolio before change:  [10.6492397]
curr_Stock_Price:  106.06251861998716
curr_Factors:  [106.06251862  -1.25456277  -1.02305916]
mat_Sqrt:  [[10.87434974  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00982217  0.00535974  0.10437105]
Stock Position:  -0.009822169508957057
Bond Position:  [11.69100373]


portfolio before change:  [10.65569832]
curr_Stock_Price:  105.5537552327374
curr_Factors:  [105.55375523  -1.31526679  -1.02345938]
mat_Sqrt:  [[10.18070411  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0051213  -0.05218142 -0.39574898]
Stock Position:  0.005121299656455318
Bond Position:  [10.11512591]


portfolio before change:  [10.66195051]
curr_Stock_Price:  106.52767137979914
curr_Factors:  [106.52767138  -1.41486168  -1.01400158]
mat_Sqrt:  [[ 9.38902557  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02636209 -0.14363188  0.31422417]
Stock Position:  -0.026362094599015264
Bond Position:  [13.47024306]


portfolio before change:  [10.64239751]
curr_Stock_Price:  107.33325559825494
curr_Factors:  [107.3332556   -1.17137407  -1.00888648]
mat_Sqrt:  [[12.12995467  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00328153 -0.01769947  0.23424349]
Stock Position:  -0.003281530575748212
Bond Position:  [10.99461487]


portfolio before change:  [10.64424207]
curr_Stock_Price:  107.18998438834136
curr_Factors:  [107.18998439  -1.17328735  -1.0231807 ]
mat_Sqrt:  [[11.91901195  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00267319  0.01839937 -0.0900983 ]
Stock Position:  -0.0026731874881935893
Bond Position:  [10.93078099]


portfolio before change:  [10.64703605]
curr_Stock_Price:  106.6559602676893
curr_Factors:  [106.65596027  -1.02780928  -1.0228519 ]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [10.64703605]
Stock Price:  106.84688911438715
PL:  [3.80014693]
Settle:  Tensor("sub_196:0", shape=(), dtype=float64)
PL:  Tensor("sub_197:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  99
output_Z_Vals[:, i, :]:  [[ 1.19260232e+02 -2.92559343e+01 -2.92733494e+01]
 [ 1.79469424e-02 -2.29232264e-02 -3.83234921e-02]
 [-4.85551918e-02  1.71379758e-02  1.02842183e-01]
 [-1.34934034e-01 -1.49842287e-02  4.86079232e-03]
 [ 1.56705726e-02  3.77835360e-02 -7.16733288e-02]
 [ 6.83375289e-02  3.00267634e-02  1.04404808e-02]
 [-3.90963639e-02 -5.55653579e-03  1.26327916e-01]
 [-1.30278223e-01  1.76138153e-01 -2.55588383e-02]
 [ 3.03435170e-02 -5.21071349e-03 -1.14098312e-01]
 [-3.90323650e-02  2.24380169e-01  8.29196281e-02]
 [ 5.81930846e-02  3.60209972e-02 -7.97794772e-02]
 [-1.39583985e-01 -9.46764765e-02  1.61098472e-02]
 [-9.89587793e-02  2.68156931e-02 -2.04902030e-04]
 [-9.62623594e-02 -1.14884369e-01  6.32126881e-02]
 [ 2.86631087e-01  3.49985446e-01  3.31334619e-02]
 [-4.35291565e-02 -5.72626928e-01 -2.63024313e-02]
 [-6.70489822e-02 -1.15610619e-02 -4.75818925e-02]
 [-3.98423917e-02  1.38919937e-01  4.66390037e-02]
 [-3.27440142e-02  4.64257056e-02 -9.22133563e-02]
 [-4.47434356e-02 -1.58555587e-02  1.15268560e-01]
 [ 5.19953121e-02 -8.08640318e-02  4.33918353e-02]
 [ 1.25479539e-01 -5.10750858e-02  2.06282688e-01]
 [-6.37131366e-02  4.92378070e-02  3.15387935e-01]
 [-6.91863877e-02 -5.51713664e-04 -8.18365017e-02]
 [-4.25504671e-01  1.32214609e-01  7.41962321e-02]
 [-7.13599611e-02 -1.85837871e-01  1.11186040e-01]
 [ 2.00401345e-01  5.64803383e-02 -1.38309473e-01]
 [ 9.69742067e-03  2.13631735e-02  1.42686732e-02]
 [-1.03919138e-01 -1.14639893e-01 -1.53092207e-01]
 [ 6.01314494e-02  6.29370548e-02 -8.92064012e-02]
 [ 6.09251953e-02 -2.56105527e-02  4.59965794e-02]
 [ 6.92309272e-02 -1.01139835e-01 -8.44298617e-02]
 [ 3.63040123e-01 -4.00580693e-01 -3.75012331e-01]
 [-4.75524675e-02 -8.30614702e-02 -7.61632813e-04]
 [-1.81445623e-01  7.69360078e-02  2.07589359e-02]
 [ 1.18726360e-01 -1.36521900e-01 -1.09549799e-01]
 [-3.11436834e-02 -1.48399719e-01 -4.86727422e-02]
 [-2.44998522e-02  2.19133628e-02 -6.50087292e-02]
 [-4.90995590e-02  9.63938379e-02  6.35617289e-03]
 [-3.72283957e-01  1.96399954e-01  2.25840688e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.26023247 -29.25593426 -29.27334937]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  8.31486419  -9.25153874 -83.50871763]
init_Out:  [2.49911038]
Stock Position:  8.31486419409362
Bond position:  [-828.98730903]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-2.48548069]
curr_Stock_Price:  99.41298365584184
curr_Factors:  [99.41298366 -0.86445768 -1.00422854]
mat_Sqrt:  [[15.34203584  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00062132 -0.00724896 -0.10932626]
Stock Position:  0.0006213202281516803
Bond Position:  [-2.54724799]


portfolio before change:  [-2.48596844]
curr_Stock_Price:  99.1404620863569
curr_Factors:  [99.14046209 -0.816067   -0.99941938]
mat_Sqrt:  [[16.13597537  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00168072  0.0054195   0.29338012]
Stock Position:  -0.0016807238403411047
Bond Position:  [-2.3193407]


portfolio before change:  [-2.48530492]
curr_Stock_Price:  98.57317162014759
curr_Factors:  [98.57317162 -0.65199832 -0.98068372]
mat_Sqrt:  [[19.26166959  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00697389 -0.00473843  0.01386649]
Stock Position:  -0.006973887657477337
Bond Position:  [-1.79786669]


portfolio before change:  [-2.48700973]
curr_Stock_Price:  98.78540068344671
curr_Factors:  [98.78540068 -0.43201465 -0.98265155]
mat_Sqrt:  [[24.00551586  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 8.39757993e-05  1.19482032e-02 -2.04464057e-01]
Stock Position:  8.39757992592088e-05
Bond Position:  [-2.49530531]


portfolio before change:  [-2.48727275]
curr_Stock_Price:  99.36776529952958
curr_Factors:  [99.3677653  -0.33254778 -0.99105056]
mat_Sqrt:  [[26.44929301  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00269361 0.0094953  0.02978379]
Stock Position:  0.0026936058642535975
Bond Position:  [-2.75493035]


portfolio before change:  [-2.48129795]
curr_Stock_Price:  101.71376105912843
curr_Factors:  [101.71376106  -0.1428217   -0.99663813]
mat_Sqrt:  [[32.54757208  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00041334 -0.00175713  0.36037838]
Stock Position:  -0.00041334127968903155
Bond Position:  [-2.43925546]


portfolio before change:  [-2.48103204]
curr_Stock_Price:  100.3327189389513
curr_Factors:  [100.33271894  -0.23420063  -1.00825173]
mat_Sqrt:  [[28.96358923  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00452111  0.05569977 -0.07291225]
Stock Position:  -0.00452110856502282
Bond Position:  [-2.02741692]


portfolio before change:  [-2.48324943]
curr_Stock_Price:  100.76711498056457
curr_Factors:  [100.76711498  -0.16476443  -1.00828622]
mat_Sqrt:  [[31.17951832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 2.21900687e-04 -1.64777229e-03 -3.25490725e-01]
Stock Position:  0.00022190068673950004
Bond Position:  [-2.50560973]


portfolio before change:  [-2.48328485]
curr_Stock_Price:  102.01905201448209
curr_Factors:  [ 1.02019052e+02 -3.12730724e-02 -1.03849445e+00]
mat_Sqrt:  [[35.00154007  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00046607  0.07095524  0.23654662]
Stock Position:  -0.00046606508494099954
Bond Position:  [-2.43573733]


portfolio before change:  [-2.48348682]
curr_Stock_Price:  101.7990846011304
curr_Factors:  [101.7990846   -0.26457131  -1.05395224]
mat_Sqrt:  [[27.23430946  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00157295  0.01139084 -0.22758864]
Stock Position:  0.0015729506640162715
Bond Position:  [-2.64361175]


portfolio before change:  [-2.48915333]
curr_Stock_Price:  98.40670906762514
curr_Factors:  [98.40670907 -0.17097867 -1.01922431]
mat_Sqrt:  [[29.93133748  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00463528 -0.02993933  0.04595691]
Stock Position:  -0.004635279410783459
Bond Position:  [-2.03301073]


portfolio before change:  [-2.49097176]
curr_Stock_Price:  98.74418430134423
curr_Factors:  [98.7441843  -0.45887631 -1.03044693]
mat_Sqrt:  [[22.26930501  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00441452  0.00847987 -0.00058453]
Stock Position:  -0.00441451704335404
Bond Position:  [-2.05506388]


portfolio before change:  [-2.49016309]
curr_Stock_Price:  98.50280465158515
curr_Factors:  [98.50280465 -0.55047903 -1.03457685]
mat_Sqrt:  [[20.18680428  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00427633 -0.03632963  0.1803282 ]
Stock Position:  -0.004276329425524339
Bond Position:  [-2.06893264]


portfolio before change:  [-2.48368648]
curr_Stock_Price:  96.92780040803571
curr_Factors:  [96.92780041 -0.75131253 -1.0301697 ]
mat_Sqrt:  [[16.32151455  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01852959 0.11067512 0.09452054]
Stock Position:  0.018529592384591228
Bond Position:  [-4.27971911]


portfolio before change:  [-2.49007809]
curr_Stock_Price:  96.61173241041301
curr_Factors:  [96.61173241 -0.53453271 -1.03646945]
mat_Sqrt:  [[20.07947245  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00317156 -0.18108053 -0.07503352]
Stock Position:  -0.0031715614905947287
Bond Position:  [-2.18366804]


portfolio before change:  [-2.48993711]
curr_Stock_Price:  96.48121216800878
curr_Factors:  [96.48121217 -0.53502961 -1.01608524]
mat_Sqrt:  [[20.45512471  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00376728 -0.00365593 -0.1357379 ]
Stock Position:  -0.0037672760137902866
Bond Position:  [-2.12646576]


portfolio before change:  [-2.49428906]
curr_Stock_Price:  97.5658484499447
curr_Factors:  [97.56584845 -0.63961992 -1.02589673]
mat_Sqrt:  [[18.44901288  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00144915  0.04393034  0.1330481 ]
Stock Position:  -0.0014491478611448894
Bond Position:  [-2.35290172]


portfolio before change:  [-2.49270752]
curr_Stock_Price:  96.27152193733336
curr_Factors:  [96.27152194 -0.73017268 -1.04883845]
mat_Sqrt:  [[16.25111351  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00309937  0.0146811  -0.26305904]
Stock Position:  -0.003099374091319085
Bond Position:  [-2.19432606]


portfolio before change:  [-2.4928706]
curr_Stock_Price:  96.23563524668428
curr_Factors:  [96.23563525 -0.5613079  -1.03515175]
mat_Sqrt:  [[19.49854943  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00110899 -0.00501397  0.32882912]
Stock Position:  -0.0011089916292480074
Bond Position:  [-2.38614609]


portfolio before change:  [-2.49384347]
curr_Stock_Price:  96.84391269149127
curr_Factors:  [96.84391269 -0.64556655 -1.05557582]
mat_Sqrt:  [[17.67158806  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00332538 -0.02557145  0.12378483]
Stock Position:  0.003325379298053842
Bond Position:  [-2.81588621]


portfolio before change:  [-2.49145305]
curr_Stock_Price:  97.66860632464198
curr_Factors:  [97.66860632 -0.71459097 -1.06168262]
mat_Sqrt:  [[16.53214363  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01005726 -0.01615136  0.58846709]
Stock Position:  0.010057259779239413
Bond Position:  [-3.4737316]


portfolio before change:  [-2.48613137]
curr_Stock_Price:  98.24092242542747
curr_Factors:  [98.24092243 -0.44011732 -1.07230073]
mat_Sqrt:  [[21.64998607  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [8.94444353e-05 1.55703617e-02 8.99713992e-01]
Stock Position:  8.944443530428293e-05
Bond Position:  [-2.49491847]


portfolio before change:  [-2.48653118]
curr_Stock_Price:  97.25786488681453
curr_Factors:  [97.25786489 -0.77087955 -1.08502489]
mat_Sqrt:  [[15.20252315  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-5.65073561e-03 -1.74467180e-04 -2.33456760e-01]
Stock Position:  -0.005650735605689132
Bond Position:  [-1.9369527]


portfolio before change:  [-2.48515397]
curr_Stock_Price:  96.97129305861995
curr_Factors:  [96.97129306 -0.75029064 -1.0750864 ]
mat_Sqrt:  [[15.62759016  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02604021  0.04180993  0.2116612 ]
Stock Position:  -0.026040205667128908
Bond Position:  [0.03999844]


portfolio before change:  [-2.49616997]
curr_Stock_Price:  97.3945231819296
curr_Factors:  [97.39452318 -1.08081012 -1.08557454]
mat_Sqrt:  [[11.16055094  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00479031 -0.05876709  0.31718282]
Stock Position:  -0.004790311808648482
Bond Position:  [-2.02961984]


portfolio before change:  [-2.49559981]
curr_Stock_Price:  97.22253467161636
curr_Factors:  [97.22253467 -1.0056225  -1.08667699]
mat_Sqrt:  [[11.99755682  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01447189  0.01786065 -0.39455843]
Stock Position:  0.014471892933586321
Bond Position:  [-3.90259392]


portfolio before change:  [-2.50905573]
curr_Stock_Price:  96.32644822213375
curr_Factors:  [96.32644822 -0.84014514 -1.08044369]
mat_Sqrt:  [[14.11381496  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00093253 0.00675563 0.04070455]
Stock Position:  0.000932532854331319
Bond Position:  [-2.59888331]


portfolio before change:  [-2.50903821]
curr_Stock_Price:  96.69362650929345
curr_Factors:  [96.69362651 -1.28536633 -1.06944346]
mat_Sqrt:  [[ 9.17734274  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01505108 -0.03625232 -0.43672946]
Stock Position:  -0.01505108256326053
Bond Position:  [-1.05369445]


portfolio before change:  [-2.50661778]
curr_Stock_Price:  96.52406076619181
curr_Factors:  [96.52406077 -1.39915674 -1.0745784 ]
mat_Sqrt:  [[ 8.13403551  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00535371  0.01990244 -0.25448103]
Stock Position:  0.005353713634570079
Bond Position:  [-3.02337996]


portfolio before change:  [-2.50638911]
curr_Stock_Price:  96.63736859447398
curr_Factors:  [96.63736859 -1.1230758  -1.09263976]
mat_Sqrt:  [[10.54076313  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00660796 -0.00809877  0.13121544]
Stock Position:  0.006607960473042112
Bond Position:  [-3.14496502]


portfolio before change:  [-2.50483958]
curr_Stock_Price:  96.9313579399289
curr_Factors:  [96.93135794 -1.26708231 -1.0839389 ]
mat_Sqrt:  [[ 9.23482687  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00534773 -0.03198322 -0.24085489]
Stock Position:  0.0053477271611998296
Bond Position:  [-3.02320204]


portfolio before change:  [-2.50224565]
curr_Stock_Price:  97.48708063662951
curr_Factors:  [97.48708064 -1.20762774 -1.11040829]
mat_Sqrt:  [[ 9.59923903  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.02876771 -0.12667474 -1.0698058 ]
Stock Position:  0.028767707665237622
Bond Position:  [-5.30672549]


portfolio before change:  [-2.47373883]
curr_Stock_Price:  98.50107212042255
curr_Factors:  [98.50107212 -1.03331613 -1.14904866]
mat_Sqrt:  [[11.10841174  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00448782 -0.02626634 -0.00217273]
Stock Position:  -0.004487821860734924
Bond Position:  [-2.03168356]


portfolio before change:  [-2.47218113]
curr_Stock_Price:  98.09738595114433
curr_Factors:  [98.09738595 -0.82831233 -1.13274019]
mat_Sqrt:  [[13.80330689  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01269419  0.0243293   0.05921947]
Stock Position:  -0.01269418594045988
Bond Position:  [-1.22691467]


portfolio before change:  [-2.47884431]
curr_Stock_Price:  98.61020340112123
curr_Factors:  [98.6102034  -0.90064007 -1.13821447]
mat_Sqrt:  [[12.83685319  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00723227 -0.04317202 -0.31251508]
Stock Position:  0.007232272566720837
Bond Position:  [-3.19202017]


portfolio before change:  [-2.48001749]
curr_Stock_Price:  98.5031610682077
curr_Factors:  [98.50316107 -0.88690278 -1.1676381 ]
mat_Sqrt:  [[12.62334346  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00355774 -0.04692811 -0.13884979]
Stock Position:  -0.0035577444076799417
Bond Position:  [-2.12956842]


portfolio before change:  [-2.48071582]
curr_Stock_Price:  98.62461809486771
curr_Factors:  [98.62461809 -0.94413662 -1.18478405]
mat_Sqrt:  [[11.73293959  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00317089  0.00692961 -0.18545181]
Stock Position:  -0.0031708935814603236
Bond Position:  [-2.16798765]


portfolio before change:  [-2.48581105]
curr_Stock_Price:  100.14602304111963
curr_Factors:  [100.14602304  -0.84407229  -1.21185466]
mat_Sqrt:  [[12.81610267  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00353565  0.03048241  0.01813239]
Stock Position:  -0.003535648360032861
Bond Position:  [-2.13172992]


portfolio before change:  [-2.48905593]
curr_Stock_Price:  100.98841483958583
curr_Factors:  [100.98841484  -0.81021243  -1.22526144]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-2.48905593]
Stock Price:  100.49191968961718
PL:  [-2.98097562]
Settle:  Tensor("sub_198:0", shape=(), dtype=float64)
PL:  Tensor("sub_199:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  100
output_Z_Vals[:, i, :]:  [[ 1.19260232e+02 -2.92559343e+01 -2.92733494e+01]
 [-8.16322308e-03 -5.03332673e-02 -2.40667798e-02]
 [-3.80943763e-02  2.38962348e-03  3.51002510e-02]
 [ 5.40858778e-02  1.73673419e-01  3.20729539e-02]
 [ 5.65586733e-02  2.42170450e-02 -6.93666922e-02]
 [ 6.93213425e-02  2.89549017e-02 -1.02521741e-01]
 [ 6.82086919e-02  1.72615671e-02 -6.18547896e-02]
 [-1.41423844e-01  5.39782666e-02 -8.51432083e-02]
 [-7.85210523e-02 -3.94996078e-02  5.51335567e-02]
 [-5.85124880e-02  1.68505609e-01  4.27249594e-02]
 [ 5.75813895e-02  7.11139087e-02 -8.07352520e-02]
 [-4.33304894e-02  6.71843931e-02  2.78044899e-03]
 [-7.40679499e-02 -4.67368816e-02 -6.34187489e-02]
 [ 2.71355148e-01  2.17421883e-01  3.05109506e-01]
 [ 1.65132912e-01  1.86462770e-01  4.81307250e-03]
 [-5.48443239e-02 -7.16870750e-02 -1.26065937e-01]
 [-9.29382207e-02  4.38489426e-02 -1.13703362e-01]
 [ 1.86378788e-01 -2.12499713e-01 -2.33362476e-01]
 [ 4.03614142e-02  5.42890592e-02  3.23092791e-02]
 [ 1.15753738e-01 -2.14147015e-01 -7.55627165e-03]
 [ 2.73746853e-01 -5.80556865e-03  4.07069022e-01]
 [-2.64951003e-02  1.28536682e-02 -2.59459973e-02]
 [-1.52499461e-01  4.26511794e-01  2.01169599e-01]
 [ 2.10214900e-01 -9.76684087e-02  9.46578706e-02]
 [-4.47141823e-02 -8.00583569e-03 -2.74288118e-02]
 [ 1.04723532e-01 -2.61893853e-03  5.64045522e-02]
 [-1.01377788e-01  7.69210203e-02  9.14234423e-02]
 [-2.61329993e-03  3.28638156e-02  1.74168141e-02]
 [ 6.02021186e-02 -8.55415625e-02 -7.62060699e-02]
 [ 3.03647186e-03 -5.48191163e-02  1.78213532e-02]
 [-4.87077619e-02  3.83804051e-01  2.78126745e-03]
 [ 4.25782208e-02 -8.84002678e-02 -1.32826452e-02]
 [-1.80430760e-03 -4.50843575e-03  7.59741815e-02]
 [-1.37611406e-01 -3.97101471e-02  3.17734717e-02]
 [-1.38657610e-01  8.83591395e-02  3.54654947e-02]
 [ 8.47165236e-02 -1.65012150e-01 -1.38726811e-01]
 [-2.10768407e-01 -3.58040064e-01  6.42040801e-02]
 [-4.74119354e-02 -3.42998774e-02  4.48079340e-02]
 [-3.26898007e-02  7.02898360e-02 -2.79611989e-02]
 [ 1.38847423e-01 -7.51491997e-03 -1.32036591e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.26023247 -29.25593426 -29.27334937]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  8.31486419  -9.25153874 -83.50871763]
init_Out:  [2.49911038]
Stock Position:  8.31486419409362
Bond position:  [-828.98730903]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [4.99125854]
curr_Stock_Price:  100.31218526135892
curr_Factors:  [100.31218526  -0.9643865   -0.97752206]
mat_Sqrt:  [[14.38777116  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00099914 -0.01591678 -0.06865582]
Stock Position:  -0.000999142476150761
Bond Position:  [5.09148471]


portfolio before change:  [4.992278]
curr_Stock_Price:  99.92887544962849
curr_Factors:  [99.92887545 -1.1815594  -0.97517173]
mat_Sqrt:  [[11.56204272  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00266976  0.00075567  0.10013125]
Stock Position:  -0.002669759015093242
Bond Position:  [5.25906401]


portfolio before change:  [4.99478837]
curr_Stock_Price:  99.23482340348463
curr_Factors:  [99.2348234  -1.21117419 -0.96375743]
mat_Sqrt:  [[11.27465591  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00577552 0.05492036 0.09149521]
Stock Position:  0.005775517319250103
Bond Position:  [4.42165593]


portfolio before change:  [4.99368752]
curr_Stock_Price:  98.94851277605333
curr_Factors:  [98.94851278 -1.24148427 -0.95425075]
mat_Sqrt:  [[11.01066797  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00390753  0.0076581  -0.19788386]
Stock Position:  0.003907532048992096
Bond Position:  [4.60704304]


portfolio before change:  [4.99617867]
curr_Stock_Price:  99.43865018542365
curr_Factors:  [99.43865019 -1.07405975 -0.96179316]
mat_Sqrt:  [[12.98361221  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00378491  0.00915634 -0.29246599]
Stock Position:  0.003784909107029401
Bond Position:  [4.61981241]


portfolio before change:  [4.99795373]
curr_Stock_Price:  99.75505171883208
curr_Factors:  [99.75505172 -1.20236884 -0.95149095]
mat_Sqrt:  [[11.57511935  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00484041  0.00545859 -0.1764545 ]
Stock Position:  0.004840410360347092
Bond Position:  [4.51509835]


portfolio before change:  [5.0004896]
curr_Stock_Price:  100.16234022063935
curr_Factors:  [100.16234022  -1.16698349  -0.95652189]
mat_Sqrt:  [[11.98057866  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01313876  0.01706943 -0.24288987]
Stock Position:  -0.013138757374818396
Bond Position:  [6.31649828]


portfolio before change:  [4.99019855]
curr_Stock_Price:  101.00569729097371
curr_Factors:  [101.00569729  -1.14843747  -0.96924079]
mat_Sqrt:  [[12.15205957  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00561936 -0.01249087  0.15728069]
Stock Position:  -0.0056193633041167175
Bond Position:  [5.55778625]


portfolio before change:  [4.99579006]
curr_Stock_Price:  100.13429163536269
curr_Factors:  [100.13429164  -0.94819793  -0.97876221]
mat_Sqrt:  [[14.57856155  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00311694  0.05328615  0.12188242]
Stock Position:  -0.003116939616007338
Bond Position:  [5.3079026]


portfolio before change:  [4.99381846]
curr_Stock_Price:  100.97971174330871
curr_Factors:  [100.97971174  -0.89282743  -1.01388267]
mat_Sqrt:  [[15.00238991  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00286205  0.02248819 -0.2303152 ]
Stock Position:  0.002862045894877274
Bond Position:  [4.70480989]


portfolio before change:  [4.99541057]
curr_Stock_Price:  101.33049847642437
curr_Factors:  [101.33049848  -0.91214234  -1.02902266]
mat_Sqrt:  [[14.54463842  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00282085  0.02124557  0.00793185]
Stock Position:  -0.002820849711870616
Bond Position:  [5.28124868]


portfolio before change:  [4.99276371]
curr_Stock_Price:  102.50286064880468
curr_Factors:  [102.50286065  -1.12589781  -1.05659339]
mat_Sqrt:  [[11.55825053  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00763264 -0.0147795  -0.18091604]
Stock Position:  -0.0076326420426718776
Bond Position:  [5.77513135]


portfolio before change:  [4.98942778]
curr_Stock_Price:  103.03450710819344
curr_Factors:  [103.03450711  -1.14059503  -1.0578825 ]
mat_Sqrt:  [[11.43394332  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.02967036 0.06875484 0.87039249]
Stock Position:  0.029670356444907942
Bond Position:  [1.93235723]


portfolio before change:  [4.99425339]
curr_Stock_Price:  103.18900656293191
curr_Factors:  [103.18900656  -1.10278359  -1.02541254]
mat_Sqrt:  [[12.28484254  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01391388 0.05896471 0.01373036]
Stock Position:  0.013913879965407805
Bond Position:  [3.55849394]


portfolio before change:  [5.01592133]
curr_Stock_Price:  104.71432532652581
curr_Factors:  [104.71432533  -1.01917067  -1.0154601 ]
mat_Sqrt:  [[13.689172    0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00602143 -0.02266944 -0.35963103]
Stock Position:  -0.006021429035034535
Bond Position:  [5.64645121]


portfolio before change:  [5.01216693]
curr_Stock_Price:  105.45505464863045
curr_Factors:  [105.45505465  -0.96173817  -0.99349073]
mat_Sqrt:  [[14.92527292  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0077061   0.01386625 -0.32436404]
Stock Position:  -0.007706100123504604
Bond Position:  [5.82481414]


portfolio before change:  [5.00769427]
curr_Stock_Price:  106.12995008404174
curr_Factors:  [106.12995008  -1.10674925  -0.99539805]
mat_Sqrt:  [[12.96841762  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01027551 -0.06719831 -0.66571819]
Stock Position:  0.010275513721110968
Bond Position:  [3.91715451]


portfolio before change:  [5.00343103]
curr_Stock_Price:  105.66740244362616
curr_Factors:  [105.66740244  -1.05703973  -0.97410912]
mat_Sqrt:  [[13.86194888  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00348856 0.01716771 0.09216938]
Stock Position:  0.0034885610981024457
Bond Position:  [4.63480384]


portfolio before change:  [5.0072961]
curr_Stock_Price:  106.60924658669933
curr_Factors:  [106.60924659  -1.190052    -0.98988584]
mat_Sqrt:  [[12.05202156  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00901775 -0.06771923 -0.02155594]
Stock Position:  0.009017745922516475
Bond Position:  [4.045921]


portfolio before change:  [5.0089545]
curr_Stock_Price:  106.73706459713233
curr_Factors:  [106.7370646   -1.03348879  -0.98683947]
mat_Sqrt:  [[14.15460777  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.02519954 -0.00183588  1.16125461]
Stock Position:  0.02519953752927511
Bond Position:  [2.31922983]


portfolio before change:  [5.00287193]
curr_Stock_Price:  106.48418321395312
curr_Factors:  [106.48418321  -1.19144661  -0.95864097]
mat_Sqrt:  [[12.40263406  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00253651  0.00406469 -0.07401671]
Stock Position:  -0.0025365115464497916
Bond Position:  [5.27297029]


portfolio before change:  [5.00313372]
curr_Stock_Price:  106.64084410570108
curr_Factors:  [106.64084411  -1.22133413  -0.95749672]
mat_Sqrt:  [[12.06894638  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00832081  0.13487487  0.57388087]
Stock Position:  -0.00832080926342088
Bond Position:  [5.89047184]


portfolio before change:  [5.01115693]
curr_Stock_Price:  105.76510561016137
curr_Factors:  [105.76510561  -1.48195985  -0.94605274]
mat_Sqrt:  [[ 9.32974852  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.02433239 -0.03088546  0.27003256]
Stock Position:  0.02433238886859755
Bond Position:  [2.43763925]


portfolio before change:  [5.00549734]
curr_Stock_Price:  105.51998739803518
curr_Factors:  [105.5199874   -1.22854052  -0.97398866]
mat_Sqrt:  [[11.66241428  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00433185 -0.00253167 -0.07824677]
Stock Position:  -0.0043318453320937205
Bond Position:  [5.4625936]


portfolio before change:  [5.00495998]
curr_Stock_Price:  105.80167408733752
curr_Factors:  [105.80167409  -1.34108811  -0.97906936]
mat_Sqrt:  [[10.39587272  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01117457 -0.00082818  0.16090649]
Stock Position:  0.011174573367473057
Bond Position:  [3.82267141]


portfolio before change:  [5.00758963]
curr_Stock_Price:  105.99423503271655
curr_Factors:  [105.99423503  -1.53946377  -0.95501857]
mat_Sqrt:  [[ 8.74867587  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00922768  0.02432456  0.26080563]
Stock Position:  -0.009227677959484436
Bond Position:  [5.9856703]


portfolio before change:  [5.01136978]
curr_Stock_Price:  105.66566966138586
curr_Factors:  [105.66566966  -1.47957124  -0.97626521]
mat_Sqrt:  [[ 9.0652063   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00019751 0.01039245 0.04968532]
Stock Position:  0.00019750597705659492
Bond Position:  [4.99050018]


portfolio before change:  [5.01191917]
curr_Stock_Price:  105.288664998805
curr_Factors:  [105.288665    -1.40239142  -0.95214599]
mat_Sqrt:  [[ 9.99583354  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00424556 -0.02705062 -0.21739471]
Stock Position:  0.0042455635072388845
Bond Position:  [4.56490946]


portfolio before change:  [5.01403287]
curr_Stock_Price:  105.65211402446084
curr_Factors:  [105.65211402  -1.31692482  -0.95360237]
mat_Sqrt:  [[10.90939731  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00048204 -0.01733533  0.05083936]
Stock Position:  0.0004820446725229917
Bond Position:  [4.96310383]


portfolio before change:  [5.0147277]
curr_Stock_Price:  105.80645722806027
curr_Factors:  [105.80645723  -1.36975536  -0.95486481]
mat_Sqrt:  [[10.35005026  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00369373  0.1213695   0.00793418]
Stock Position:  -0.0036937269944850412
Bond Position:  [5.40554786]


portfolio before change:  [5.01544463]
curr_Stock_Price:  105.79530411121699
curr_Factors:  [105.79530411  -1.19127773  -0.92755479]
mat_Sqrt:  [[12.71361685  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00295623 -0.02795462 -0.03789169]
Stock Position:  0.0029562340543248257
Bond Position:  [4.70268895]


portfolio before change:  [5.01616003]
curr_Stock_Price:  105.83844356150745
curr_Factors:  [105.83844356  -0.99762403  -0.92084398]
mat_Sqrt:  [[15.54044235  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00087433 -0.00142569  0.21673319]
Stock Position:  0.0008743283898846027
Bond Position:  [4.92362248]


portfolio before change:  [5.01697802]
curr_Stock_Price:  106.07005036596237
curr_Factors:  [106.07005037  -0.97454509  -0.91323267]
mat_Sqrt:  [[16.05984349  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00822866 -0.01255745  0.09064087]
Stock Position:  -0.008228659544512566
Bond Position:  [5.88979236]


portfolio before change:  [5.02024058]
curr_Stock_Price:  105.76303999467461
curr_Factors:  [105.76303999  -0.66208411  -0.91224784]
mat_Sqrt:  [[21.90837916  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0058944   0.02794161  0.10117318]
Stock Position:  -0.005894403307996935
Bond Position:  [5.64365059]


portfolio before change:  [5.02124097]
curr_Stock_Price:  105.71301029576894
curr_Factors:  [105.7130103   -0.72518908  -0.88650478]
mat_Sqrt:  [[21.09495922  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00247161 -0.05218142 -0.39574898]
Stock Position:  0.0024716064126625815
Bond Position:  [4.75996002]


portfolio before change:  [5.02103463]
curr_Stock_Price:  105.38877719795396
curr_Factors:  [105.3887772   -0.77619656  -0.89618072]
mat_Sqrt:  [[19.79202098  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01045408 -0.11322221  0.18315637]
Stock Position:  -0.010454079419294899
Bond Position:  [6.12277728]


portfolio before change:  [5.02475265]
curr_Stock_Price:  105.10633905673858
curr_Factors:  [105.10633906  -1.10183467  -0.87346068]
mat_Sqrt:  [[14.58038657  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00268519 -0.01084657  0.12782456]
Stock Position:  -0.002685194457629311
Bond Position:  [5.30698361]


portfolio before change:  [5.02339584]
curr_Stock_Price:  105.85869897612595
curr_Factors:  [105.85869898  -1.52205225  -0.90460274]
mat_Sqrt:  [[ 9.35069042  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00391228  0.0222276  -0.07976552]
Stock Position:  -0.003912275902081711
Bond Position:  [5.43754427]


portfolio before change:  [5.02395395]
curr_Stock_Price:  105.88978636680365
curr_Factors:  [105.88978637  -1.35737733  -0.89400958]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [5.02395395]
Stock Price:  105.17419279254737
PL:  [-0.15023884]
Settle:  Tensor("sub_200:0", shape=(), dtype=float64)
PL:  Tensor("sub_201:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  101
output_Z_Vals[:, i, :]:  [[ 1.19260232e+02 -2.92559343e+01 -2.92733494e+01]
 [ 4.03706775e-03 -1.27034308e-01 -3.91946428e-02]
 [-6.82888564e-02 -1.96124232e-02  9.25430538e-02]
 [-2.12135323e-01 -1.04372660e-01 -1.33460441e-02]
 [-2.89453728e-02  5.67405659e-02 -7.09221286e-02]
 [ 5.71647678e-02  2.87734987e-02  3.17592660e-02]
 [ 7.60695679e-02  1.95577708e-02 -5.79016378e-02]
 [-4.64257662e-02  4.37019596e-03 -5.82487431e-02]
 [ 1.09631299e-01 -4.65855831e-02 -1.47974265e-01]
 [-1.01904305e-01 -1.43334385e-01 -1.17231552e-01]
 [ 1.18356411e-01  8.26385602e-02  1.13419349e-02]
 [-1.86682107e-01 -1.02369183e-01  3.95381655e-02]
 [-1.11229265e-01  4.27752930e-02 -2.24494402e-02]
 [-9.62623594e-02 -1.14884369e-01  6.32126881e-02]
 [ 3.07490268e-01  3.65019289e-01  2.31307258e-02]
 [-6.78464057e-02 -2.35613265e-01 -8.01748653e-02]
 [-6.66923870e-02 -4.23464200e-02 -3.81104519e-02]
 [-6.16307396e-02  1.55302694e-01  9.17749902e-02]
 [ 2.15270723e-02  5.46124963e-02 -1.19849958e-02]
 [-3.99161852e-02 -1.30519897e-02  1.08338067e-01]
 [ 2.61374300e-02 -6.69238838e-02  3.63255329e-02]
 [ 1.16224823e-01 -6.25932856e-02  1.42305366e-01]
 [-4.06530855e-02 -2.77683467e-02  2.42510004e-01]
 [-6.60652375e-02 -6.25985294e-04 -8.27459197e-02]
 [-2.09440203e-01  8.82971755e-02  7.64019673e-02]
 [-5.62682976e-02 -1.68775284e-01  1.06336266e-01]
 [ 2.13947348e-01  5.38773575e-02 -1.42827446e-01]
 [-3.76703549e-02  6.33502730e-02  2.55010711e-02]
 [-8.05380293e-02 -7.61421491e-02 -1.98868608e-01]
 [ 8.26586393e-03 -7.89977914e-03 -1.17629645e-01]
 [ 4.43867258e-02  9.85353177e-02  1.49133897e-02]
 [ 3.02527725e-02 -7.45316745e-02 -8.57338670e-02]
 [ 2.53517237e-01 -2.37028393e-01 -1.62353295e-01]
 [-4.74928616e-02 -8.30032794e-02 -5.97657351e-04]
 [-1.67518237e-01  1.13106099e-01  2.85107300e-02]
 [ 1.07992812e-01 -1.53555223e-01 -1.25570545e-01]
 [-4.14287544e-02 -1.65809246e-01 -3.90989471e-02]
 [-2.61574878e-02  1.76751975e-02 -5.70416242e-02]
 [-2.81781696e-02  2.25791360e-02  9.95378392e-03]
 [-8.19724091e-01  4.07509162e-01  5.02555099e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.26023247 -29.25593426 -29.27334937]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  8.31486419  -9.25153874 -83.50871763]
init_Out:  [2.49911038]
Stock Position:  8.31486419409362
Bond position:  [-828.98730903]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-0.01762879]
curr_Stock_Price:  99.70978368112885
curr_Factors:  [99.70978368 -0.65425857 -0.99488301]
mat_Sqrt:  [[19.16570002  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00037794 -0.04017178 -0.11181141]
Stock Position:  -0.00037794168430340134
Bond Position:  [0.0200557]


portfolio before change:  [-0.0172372]
curr_Stock_Price:  98.68032170083248
curr_Factors:  [98.6803217  -0.72381536 -0.98340456]
mat_Sqrt:  [[17.89758228  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00278836 -0.00620199  0.26399957]
Stock Position:  -0.002788364063408075
Bond Position:  [0.25791946]


portfolio before change:  [-0.01476186]
curr_Stock_Price:  97.80414322473503
curr_Factors:  [97.80414322 -0.55798308 -0.98285449]
mat_Sqrt:  [[20.94980561  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01038456 -0.03300553 -0.03807255]
Stock Position:  -0.010384557605776121
Bond Position:  [1.0008909]


portfolio before change:  [-0.01567698]
curr_Stock_Price:  97.90431532792219
curr_Factors:  [97.90431533 -0.67202471 -0.97972905]
mat_Sqrt:  [[18.76956851  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00223539  0.01794294 -0.20232109]
Stock Position:  -0.002235387382192082
Bond Position:  [0.20317709]


portfolio before change:  [-0.01550756]
curr_Stock_Price:  97.83988486795567
curr_Factors:  [97.83988487 -0.79463126 -0.99528021]
mat_Sqrt:  [[16.33681007  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00394144 0.00909898 0.09060035]
Stock Position:  0.003941438329441304
Bond Position:  [-0.40113743]


portfolio before change:  [-0.01490473]
curr_Stock_Price:  98.00555202447222
curr_Factors:  [98.00555202 -0.89078699 -0.99104927]
mat_Sqrt:  [[14.92724209  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00433807  0.00618471 -0.16517726]
Stock Position:  0.004338070263887803
Bond Position:  [-0.44005971]


portfolio before change:  [-0.01762639]
curr_Stock_Price:  97.39084335816095
curr_Factors:  [97.39084336 -0.65730697 -0.95600303]
mat_Sqrt:  [[19.40289333  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0029997   0.00138198 -0.16616745]
Stock Position:  -0.002999702266111201
Bond Position:  [0.27451714]


portfolio before change:  [-0.01498329]
curr_Stock_Price:  96.52116191849518
curr_Factors:  [96.52116192 -0.7630191  -0.93761505]
mat_Sqrt:  [[17.62164775  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00443905 -0.01473165 -0.42212939]
Stock Position:  0.004439048238798824
Bond Position:  [-0.44344539]


portfolio before change:  [-0.01229141]
curr_Stock_Price:  97.14006071828685
curr_Factors:  [97.14006072 -0.83633663 -0.94115848]
mat_Sqrt:  [[16.4226052   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0078876  -0.04532631 -0.33442899]
Stock Position:  -0.007887601951716953
Bond Position:  [0.75391073]


portfolio before change:  [-0.01037582]
curr_Stock_Price:  96.90914896150896
curr_Factors:  [96.90914896 -0.82759225 -0.9207286 ]
mat_Sqrt:  [[16.86858615  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00728012 0.02613261 0.03235538]
Stock Position:  0.0072801176762606334
Bond Position:  [-0.71588583]


portfolio before change:  [-0.00324572]
curr_Stock_Price:  97.90083515582396
curr_Factors:  [97.90083516 -0.92915622 -0.9238463 ]
mat_Sqrt:  [[15.34749935  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01181004 -0.03237198  0.11279138]
Stock Position:  -0.01181003949590333
Bond Position:  [1.15296701]


portfolio before change:  [-0.00806013]
curr_Stock_Price:  98.32069335181306
curr_Factors:  [98.32069335 -0.9551142  -0.92952561]
mat_Sqrt:  [[14.93331635  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0076813   0.01352674 -0.064042  ]
Stock Position:  -0.007681300110049408
Bond Position:  [0.74717062]


portfolio before change:  [-0.01380327]
curr_Stock_Price:  99.0805307611103
curr_Factors:  [99.08053076 -1.02076636 -0.96053117]
mat_Sqrt:  [[13.66223467  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00631854 -0.03632963  0.1803282 ]
Stock Position:  -0.006318543578797923
Bond Position:  [0.61224138]


portfolio before change:  [-0.00803383]
curr_Stock_Price:  98.17954797567161
curr_Factors:  [98.17954798 -0.9772837  -0.94438342]
mat_Sqrt:  [[14.36982914  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.02238277 0.11542923 0.06598552]
Stock Position:  0.022382768905375938
Bond Position:  [-2.20556397]


portfolio before change:  [0.00676121]
curr_Stock_Price:  98.85286748087753
curr_Factors:  [98.85286748 -0.92706663 -0.95105406]
mat_Sqrt:  [[15.11234357  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00597495 -0.07450746 -0.22871657]
Stock Position:  -0.005974952824701554
Bond Position:  [0.59740243]


portfolio before change:  [0.01362081]
curr_Stock_Price:  97.71730672943497
curr_Factors:  [97.71730673 -0.78258451 -0.96435963]
mat_Sqrt:  [[17.0326918   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00443647 -0.01339111 -0.10871851]
Stock Position:  -0.0044364702401059886
Bond Position:  [0.44714073]


portfolio before change:  [0.01501994]
curr_Stock_Price:  97.41453536362145
curr_Factors:  [97.41453536 -0.97460331 -0.95649037]
mat_Sqrt:  [[14.12408858  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00275326  0.04911102  0.2618085 ]
Stock Position:  -0.002753264373451967
Bond Position:  [0.28322791]


portfolio before change:  [0.01588525]
curr_Stock_Price:  97.11311191698769
curr_Factors:  [97.11311192 -0.8363584  -0.94913596]
mat_Sqrt:  [[16.28724101  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00125809  0.01726999 -0.03418986]
Stock Position:  0.0012580850145778196
Bond Position:  [-0.1062913]


portfolio before change:  [0.01581738]
curr_Stock_Price:  97.06972967170346
curr_Factors:  [97.06972967 -0.6473043  -0.96006814]
mat_Sqrt:  [[19.45408635  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00093239 -0.0041274   0.30905835]
Stock Position:  -0.0009323887212127561
Bond Position:  [0.1063241]


portfolio before change:  [0.01558826]
curr_Stock_Price:  97.32972123827751
curr_Factors:  [97.32972124 -0.62862455 -0.99188801]
mat_Sqrt:  [[19.25155508  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00165308 -0.02116319  0.10362663]
Stock Position:  0.0016530810591768954
Bond Position:  [-0.14530566]


portfolio before change:  [0.01823732]
curr_Stock_Price:  98.94321049454258
curr_Factors:  [98.94321049 -0.90223227 -0.98450239]
mat_Sqrt:  [[14.99641819  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0095794  -0.01979373  0.4059576 ]
Stock Position:  0.00957939626458333
Bond Position:  [-0.9295789]


portfolio before change:  [0.01491305]
curr_Stock_Price:  98.60831839667198
curr_Factors:  [98.6083184  -0.86779886 -0.99791285]
mat_Sqrt:  [[15.26318789  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 5.32790811e-04 -8.78112223e-03  6.91813541e-01]
Stock Position:  0.0005327908105686999
Bond Position:  [-0.03762455]


portfolio before change:  [0.01497103]
curr_Stock_Price:  98.72596221557949
curr_Factors:  [98.72596222 -0.65941559 -0.98102394]
mat_Sqrt:  [[19.14245074  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-4.33444190e-03 -1.97953931e-04 -2.36051077e-01]
Stock Position:  -0.004334441898351312
Bond Position:  [0.44289298]


portfolio before change:  [0.01365984]
curr_Stock_Price:  99.04123967186419
curr_Factors:  [99.04123967 -0.68346953 -1.00391743]
mat_Sqrt:  [[18.32285817  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01045497  0.02792202  0.21795355]
Stock Position:  -0.010454967866151622
Bond Position:  [1.04913282]


portfolio before change:  [0.02521654]
curr_Stock_Price:  97.9484053549236
curr_Factors:  [97.94840535 -1.00495201 -1.0196759 ]
mat_Sqrt:  [[12.933398    0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00300928 -0.05337143  0.30334777]
Stock Position:  -0.0030092831978967517
Bond Position:  [0.31997103]


portfolio before change:  [0.02692744]
curr_Stock_Price:  97.39315699486814
curr_Factors:  [97.39315699 -0.9903056  -1.00848766]
mat_Sqrt:  [[13.1966458   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01410843  0.01703752 -0.40744695]
Stock Position:  0.014108427848844122
Bond Position:  [-1.34713689]


portfolio before change:  [0.04201848]
curr_Stock_Price:  98.47474020303996
curr_Factors:  [98.4747402  -0.96233905 -1.03982356]
mat_Sqrt:  [[13.29831674  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00231828  0.02003312  0.07274746]
Stock Position:  -0.00231828389942111
Bond Position:  [0.27031088]


portfolio before change:  [0.04265161]
curr_Stock_Price:  98.21620966355336
curr_Factors:  [98.21620966 -0.92218316 -1.0580061 ]
mat_Sqrt:  [[13.55807084  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00907931 -0.02407826 -0.56731678]
Stock Position:  -0.009079307605426069
Bond Position:  [0.93438679]


portfolio before change:  [0.03811303]
curr_Stock_Price:  98.72895646550144
curr_Factors:  [98.72895647 -1.10217854 -1.07881904]
mat_Sqrt:  [[11.14934445  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0014305  -0.00249813 -0.33556463]
Stock Position:  -0.001430501877248287
Bond Position:  [0.17934499]


portfolio before change:  [0.03813603]
curr_Stock_Price:  98.72855595224803
curr_Factors:  [98.72855595 -0.80753282 -1.06752102]
mat_Sqrt:  [[15.1396993   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00330093 0.0311596  0.04254375]
Stock Position:  0.0033009294779601933
Bond Position:  [-0.28775998]


portfolio before change:  [0.0386879]
curr_Stock_Price:  98.90664234463267
curr_Factors:  [98.90664234 -1.05588734 -1.075611  ]
mat_Sqrt:  [[11.73619968  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00092262 -0.02356898 -0.24457486]
Stock Position:  0.0009226172776313951
Bond Position:  [-0.05256507]


portfolio before change:  [0.03876658]
curr_Stock_Price:  98.99904264080149
curr_Factors:  [98.99904264 -0.98164205 -1.03262583]
mat_Sqrt:  [[13.2082588   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01622144 -0.07495496 -0.46314876]
Stock Position:  0.016221438895766216
Bond Position:  [-1.56714034]


portfolio before change:  [0.04095271]
curr_Stock_Price:  99.14588717351434
curr_Factors:  [99.14588717 -0.8323232  -1.02428311]
mat_Sqrt:  [[15.48676913  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00321294 -0.02624794 -0.00170495]
Stock Position:  -0.003212935698284475
Bond Position:  [0.35950207]


portfolio before change:  [0.03721224]
curr_Stock_Price:  100.32406317446264
curr_Factors:  [100.32406317  -0.96726375  -1.0377206 ]
mat_Sqrt:  [[13.5098795   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01175274  0.03576729  0.08133318]
Stock Position:  -0.011752741479015548
Bond Position:  [1.21629502]


portfolio before change:  [0.04642271]
curr_Stock_Price:  99.55331392446641
curr_Factors:  [99.55331392 -0.7388469  -1.05446344]
mat_Sqrt:  [[16.56650644  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0047322  -0.04855843 -0.35821781]
Stock Position:  0.004732201878540068
Bond Position:  [-0.42468367]


portfolio before change:  [0.04346303]
curr_Stock_Price:  98.93909926534751
curr_Factors:  [98.93909927 -0.92833114 -1.05159019]
mat_Sqrt:  [[13.66152068  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00393009 -0.05243349 -0.11153841]
Stock Position:  -0.003930087372330013
Bond Position:  [0.43230234]


portfolio before change:  [0.04136269]
curr_Stock_Price:  99.4872757632085
curr_Factors:  [99.48727576 -0.83885503 -1.05301438]
mat_Sqrt:  [[15.00165219  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00248937  0.00558939 -0.16272388]
Stock Position:  -0.0024893717338392764
Bond Position:  [0.2890235]


portfolio before change:  [0.04308345]
curr_Stock_Price:  98.8105477582821
curr_Factors:  [98.81054776 -0.80807976 -1.03793014]
mat_Sqrt:  [[15.59880728  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0016388   0.00714015  0.02839537]
Stock Position:  -0.0016388029394478032
Bond Position:  [0.20501446]


portfolio before change:  [0.04437888]
curr_Stock_Price:  98.03571237599192
curr_Factors:  [98.03571238 -0.76504541 -1.02373026]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [0.04437888]
Stock Price:  97.7453925780389
PL:  [0.04437888]
Settle:  Tensor("sub_202:0", shape=(), dtype=float64)
PL:  Tensor("sub_203:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  102
output_Z_Vals[:, i, :]:  [[ 1.19260232e+02 -2.92559343e+01 -2.92733494e+01]
 [-1.73958330e-01  5.28531626e-01  9.40509298e-02]
 [ 6.25179149e-02  5.40634173e-02 -2.17030445e-02]
 [ 8.60301356e-02  1.79977729e-01  3.80856687e-02]
 [ 2.20738289e-01 -2.59258497e-02 -5.04006210e-02]
 [ 5.33720315e-02  3.22810487e-02  2.43119272e-02]
 [-9.81355020e-04  6.02858659e-02 -6.09039540e-02]
 [ 1.39816854e-01  9.11164608e-02  1.16106637e-01]
 [-1.38307713e-01 -3.40510149e-02  1.19469613e-01]
 [-5.21043937e-02  2.61549607e-01  9.55739150e-02]
 [ 5.84039186e-02  1.56593518e-01 -8.59004359e-02]
 [-3.89805553e-02  5.11904917e-02 -3.32089547e-03]
 [-9.56210101e-02  1.04287871e-02 -5.42580660e-02]
 [-7.09826712e-02 -7.10887610e-02  8.39942304e-02]
 [ 2.38208099e-01  3.51552449e-01  9.77990030e-02]
 [-7.90346874e-02 -9.80029513e-02 -1.15560764e-01]
 [-7.96970282e-02 -1.99631039e-02 -8.52327550e-02]
 [-4.57564464e-02 -1.45453303e-02  3.40236854e-02]
 [ 3.30614128e-02  6.12373440e-02  2.71459617e-02]
 [ 2.31255558e-01 -5.45147294e-02 -2.43510540e-02]
 [-4.58308936e-02  1.27349739e-03 -1.28162558e-02]
 [ 6.02352523e-02 -4.70448279e-02  5.85376049e-02]
 [-6.54862277e-02  6.42935393e-02  2.41159796e-01]
 [ 6.31899996e-04 -6.02074278e-03 -6.35123796e-02]
 [ 9.42382081e-02  2.59660449e-02  1.01652085e-01]
 [ 5.38917360e-02 -4.53368085e-02  7.10618629e-02]
 [-8.35931565e-02  5.36078928e-02 -7.37283010e-03]
 [-5.07806065e-02  7.36225950e-02  2.93687317e-02]
 [ 5.69162287e-02 -9.11496373e-02 -1.33259061e-01]
 [ 7.26424045e-03 -5.22293857e-03 -1.14452394e-01]
 [ 2.96531128e-02  1.22488548e-01  2.79244914e-02]
 [ 1.50678244e-02 -6.32695335e-02 -9.00494627e-02]
 [ 1.99179526e-01 -1.92044183e-01 -1.17521119e-01]
 [-4.78376761e-02 -8.33399081e-02 -1.54624098e-03]
 [-1.92224743e-01  1.18073869e-01  2.10753924e-02]
 [ 1.26620396e-01 -1.30551218e-01 -9.10455503e-02]
 [ 1.31885992e-02 -1.18572827e-02 -9.11105767e-02]
 [-2.22011903e-02  2.47267250e-02 -6.24250316e-02]
 [ 2.10817216e-02 -7.55896536e-02  3.94802443e-03]
 [-8.25042455e-01  4.10054375e-01  5.05793704e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.26023247 -29.25593426 -29.27334937]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  8.31486419  -9.25153874 -83.50871763]
init_Out:  [2.49911038]
Stock Position:  8.31486419409362
Bond position:  [-828.98730903]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [13.65100057]
curr_Stock_Price:  101.35366252722228
curr_Factors:  [101.35366253  -1.21142922  -1.02588386]
mat_Sqrt:  [[10.81899004  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01304314  0.16713638  0.26830112]
Stock Position:  -0.013043143212029021
Bond Position:  [14.9729709]


portfolio before change:  [13.65619291]
curr_Stock_Price:  101.09907609975413
curr_Factors:  [101.0990761   -1.32411691  -1.03313733]
mat_Sqrt:  [[ 9.57204376  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00621432  0.01709635 -0.06191275]
Stock Position:  0.006214316646021323
Bond Position:  [13.02793124]


portfolio before change:  [13.65686678]
curr_Stock_Price:  100.94544230426511
curr_Factors:  [100.9454423   -1.25206014  -1.03634388]
mat_Sqrt:  [[10.23871549  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.0096156  0.05691396 0.10864781]
Stock Position:  0.00961559534978384
Bond Position:  [12.68621625]


portfolio before change:  [13.65882789]
curr_Stock_Price:  100.9844657721884
curr_Factors:  [100.98446577  -1.28030366  -1.08048144]
mat_Sqrt:  [[ 9.52749283  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.02201848 -0.00819847 -0.14377894]
Stock Position:  0.022018479217219947
Bond Position:  [11.43530353]


portfolio before change:  [13.66980712]
curr_Stock_Price:  101.41818000166711
curr_Factors:  [101.41818     -1.30635326  -1.10010109]
mat_Sqrt:  [[ 9.14125801  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00647265 0.01020816 0.06935516]
Stock Position:  0.006472651347769092
Bond Position:  [13.0133626]


portfolio before change:  [13.67385294]
curr_Stock_Price:  101.79191350002834
curr_Factors:  [101.7919135  -1.3377497  -1.1025801]
mat_Sqrt:  [[ 8.86934427  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00133682  0.01906406 -0.17374203]
Stock Position:  -0.0013368235400317912
Bond Position:  [13.80993076]


portfolio before change:  [13.67510277]
curr_Stock_Price:  102.14836406853195
curr_Factors:  [102.14836407  -1.18103658  -1.09647549]
mat_Sqrt:  [[10.47419097  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01583603 0.02881355 0.33121992]
Stock Position:  0.015836033519033215
Bond Position:  [12.05747786]


portfolio before change:  [13.66909351]
curr_Stock_Price:  101.673715713472
curr_Factors:  [101.67371571  -1.21881684  -1.08276858]
mat_Sqrt:  [[10.17754077  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01127977 -0.01076788  0.34081355]
Stock Position:  -0.01127976552347846
Bond Position:  [14.81594918]


portfolio before change:  [13.67829169]
curr_Stock_Price:  101.02245463121814
curr_Factors:  [101.02245463  -0.90653807  -1.10880535]
mat_Sqrt:  [[13.46372998  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0019194   0.08270925  0.27264578]
Stock Position:  -0.0019193988760917847
Bond Position:  [13.87219407]


portfolio before change:  [13.68332105]
curr_Stock_Price:  99.30565063327896
curr_Factors:  [99.30565063 -0.87776763 -1.10979043]
mat_Sqrt:  [[13.60781699  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00330051  0.04951922 -0.24505003]
Stock Position:  0.003300514165759737
Bond Position:  [13.35556135]


portfolio before change:  [13.68751867]
curr_Stock_Price:  100.07161351377609
curr_Factors:  [100.07161351  -1.07261444  -1.12187105]
mat_Sqrt:  [[11.14956608  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0034384   0.01618785 -0.00947359]
Stock Position:  -0.0034384026385110237
Bond Position:  [14.03160517]


portfolio before change:  [13.6872073]
curr_Stock_Price:  100.67230943580594
curr_Factors:  [100.67230944  -1.12760417  -1.12848316]
mat_Sqrt:  [[10.54638817  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01009133  0.00329787 -0.15478316]
Stock Position:  -0.010091333605716865
Bond Position:  [14.70312516]


portfolio before change:  [13.69233587]
curr_Stock_Price:  100.34623095449477
curr_Factors:  [100.34623095  -1.02542868  -1.14457166]
mat_Sqrt:  [[11.45728966  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00485917 -0.02248024  0.23961216]
Stock Position:  -0.004859170560899807
Bond Position:  [14.17993532]


portfolio before change:  [13.69021676]
curr_Stock_Price:  101.14713206949864
curr_Factors:  [101.14713207  -1.18544313  -1.12984666]
mat_Sqrt:  [[ 9.98702174  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.02675956 0.11117065 0.27899333]
Stock Position:  0.026759557492416465
Bond Position:  [10.98356426]


portfolio before change:  [13.68883166]
curr_Stock_Price:  101.0440613997897
curr_Factors:  [101.0440614   -0.89557681  -1.12256341]
mat_Sqrt:  [[13.42899884  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00783036 -0.03099125 -0.32966269]
Stock Position:  -0.00783035698036293
Bond Position:  [14.48004274]


portfolio before change:  [13.68120494]
curr_Stock_Price:  102.24922238755572
curr_Factors:  [102.24922239  -0.91733915  -1.12557645]
mat_Sqrt:  [[13.25662711  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00736315 -0.00631289 -0.24314533]
Stock Position:  -0.007363150206259327
Bond Position:  [14.43408133]


portfolio before change:  [13.68872738]
curr_Stock_Price:  101.47264372267206
curr_Factors:  [101.47264372  -0.87161868  -1.10909887]
mat_Sqrt:  [[14.00020103  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00279903 -0.00459964  0.0970601 ]
Stock Position:  -0.002799027633958816
Bond Position:  [13.97275211]


portfolio before change:  [13.69096744]
curr_Stock_Price:  101.2963847273198
curr_Factors:  [101.29638473  -0.73169722  -1.11635463]
mat_Sqrt:  [[15.958616    0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00251799 0.01936495 0.07743987]
Stock Position:  0.002517994072292485
Bond Position:  [13.43590374]


portfolio before change:  [13.69229789]
curr_Stock_Price:  101.15772674972963
curr_Factors:  [101.15772675  -0.63402894  -1.12107524]
mat_Sqrt:  [[17.48908147  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01285816 -0.01723907 -0.06946678]
Stock Position:  0.012858157029679254
Bond Position:  [12.39159596]


portfolio before change:  [13.69264289]
curr_Stock_Price:  101.06408636011955
curr_Factors:  [101.06408636  -0.79384316  -1.13073519]
mat_Sqrt:  [[14.74901774  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00328253  0.00040272 -0.03656121]
Stock Position:  -0.0032825317724167573
Bond Position:  [14.02438897]


portfolio before change:  [13.69509871]
curr_Stock_Price:  100.8500269964194
curr_Factors:  [100.850027    -0.51540186  -1.14061702]
mat_Sqrt:  [[19.25201358  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00368634 -0.01487688  0.16699149]
Stock Position:  0.0036863416070158903
Bond Position:  [13.32333106]


portfolio before change:  [13.69843995]
curr_Stock_Price:  101.30460153456166
curr_Factors:  [101.30460153  -0.82188107  -1.14798283]
mat_Sqrt:  [[14.12954418  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00103327  0.0203314   0.68796177]
Stock Position:  -0.0010332703043373552
Bond Position:  [13.80311498]


portfolio before change:  [13.6999434]
curr_Stock_Price:  101.51949690620877
curr_Factors:  [101.51949691  -1.02906572  -1.13384603]
mat_Sqrt:  [[11.67370787  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00106975 -0.00190393 -0.18118314]
Stock Position:  -0.0010697513801960132
Bond Position:  [13.80854402]


portfolio before change:  [13.70126417]
curr_Stock_Price:  101.8984724435745
curr_Factors:  [101.89847244  -0.76381276  -1.12605965]
mat_Sqrt:  [[15.3959508   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00751225 0.00821118 0.2899851 ]
Stock Position:  0.0075122540236574956
Bond Position:  [12.93577696]


portfolio before change:  [13.69963688]
curr_Stock_Price:  101.46659682294363
curr_Factors:  [101.46659682  -0.58641976  -1.12565554]
mat_Sqrt:  [[18.31379036  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00367082 -0.01433676  0.20271972]
Stock Position:  0.0036708177483068087
Bond Position:  [13.32717149]


portfolio before change:  [13.69808672]
curr_Stock_Price:  100.59045477354165
curr_Factors:  [100.59045477  -0.61426904  -1.12902923]
mat_Sqrt:  [[17.59753956  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00475714  0.0169523  -0.02103263]
Stock Position:  -0.004757141132878456
Bond Position:  [14.17660971]


portfolio before change:  [13.69548716]
curr_Stock_Price:  101.50944226319221
curr_Factors:  [101.50944226  -0.76363251  -1.12780515]
mat_Sqrt:  [[15.31318403  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00280052  0.02328151  0.08378082]
Stock Position:  -0.0028005156817131837
Bond Position:  [13.97976594]


portfolio before change:  [13.69901621]
curr_Stock_Price:  100.87331853695605
curr_Factors:  [100.87331854  -0.77900447  -1.09589135]
mat_Sqrt:  [[15.4710361   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00176855 -0.02882405 -0.38015101]
Stock Position:  0.0017685540347630827
Bond Position:  [13.5206163]


portfolio before change:  [13.70074247]
curr_Stock_Price:  100.89371758484683
curr_Factors:  [100.89371758  -0.90384772  -1.0876285 ]
mat_Sqrt:  [[13.77136508  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00117876 -0.00165164 -0.32650082]
Stock Position:  -0.001178758405674398
Bond Position:  [13.81967179]


portfolio before change:  [13.70282405]
curr_Stock_Price:  100.59339215607247
curr_Factors:  [100.59339216  -0.99999463  -1.08344136]
mat_Sqrt:  [[12.52404731  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00307535 0.03873428 0.0796608 ]
Stock Position:  0.003075349006475737
Bond Position:  [13.39346426]


portfolio before change:  [13.70295517]
curr_Stock_Price:  100.09160595876072
curr_Factors:  [100.09160596  -0.9656878   -1.06691554]
mat_Sqrt:  [[13.1114053   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00037731 -0.02000758 -0.25688605]
Stock Position:  -0.0003773094829355448
Bond Position:  [13.74072068]


portfolio before change:  [13.70432411]
curr_Stock_Price:  101.0159385906071
curr_Factors:  [101.01593859  -1.03312921  -1.07672497]
mat_Sqrt:  [[12.2487529   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01389791 -0.0607297  -0.33525504]
Stock Position:  0.013897910254874135
Bond Position:  [12.30041366]


portfolio before change:  [13.69015769]
curr_Stock_Price:  99.88597976088231
curr_Factors:  [99.88597976 -0.59528599 -1.08083618]
mat_Sqrt:  [[18.68847766  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00269177 -0.02635439 -0.004411  ]
Stock Position:  -0.002691772400424105
Bond Position:  [13.95902801]


portfolio before change:  [13.69466124]
curr_Stock_Price:  98.86116563952275
curr_Factors:  [98.86116564 -0.61339266 -1.07507221]
mat_Sqrt:  [[18.26984021  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01011909  0.03733824  0.06012223]
Stock Position:  -0.010119086431968441
Bond Position:  [14.69504592]


portfolio before change:  [13.7051385]
curr_Stock_Price:  98.00730722722702
curr_Factors:  [98.00730723 -0.67901938 -1.07301131]
mat_Sqrt:  [[16.99656647  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00615801 -0.04128392 -0.25972761]
Stock Position:  0.006158007421288139
Bond Position:  [13.10160878]


portfolio before change:  [13.69836595]
curr_Stock_Price:  96.64154852815108
curr_Factors:  [96.64154853 -0.68410281 -1.09834989]
mat_Sqrt:  [[16.25752805  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00035156 -0.0037496  -0.25991312]
Stock Position:  -0.00035155548030379183
Bond Position:  [13.73234082]


portfolio before change:  [13.69985965]
curr_Stock_Price:  97.27573630925342
curr_Factors:  [97.27573631 -0.64960792 -1.09073385]
mat_Sqrt:  [[17.06804196  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00200991  0.00781928 -0.17808124]
Stock Position:  -0.0020099086528473325
Bond Position:  [13.895375]


portfolio before change:  [13.70195132]
curr_Stock_Price:  97.09929142469387
curr_Factors:  [97.09929142 -1.12990044 -1.09722687]
mat_Sqrt:  [[10.47097104  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00190392 -0.02390355  0.01126261]
Stock Position:  0.0019039201025940957
Bond Position:  [13.51708203]


portfolio before change:  [13.70527876]
curr_Stock_Price:  97.95946179380982
curr_Factors:  [97.95946179 -1.40241927 -1.10998639]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [13.70527876]
Stock Price:  98.1517014637975
PL:  [13.70527876]
Settle:  Tensor("sub_204:0", shape=(), dtype=float64)
PL:  Tensor("sub_205:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  103
output_Z_Vals[:, i, :]:  [[ 1.19260232e+02 -2.92559343e+01 -2.92733494e+01]
 [ 2.83095754e-02  1.88174988e-02 -4.79831789e-02]
 [-3.85146636e-02  3.59383332e-02  1.08669621e-01]
 [ 8.59395557e-02  1.79154084e-01  3.80746648e-02]
 [ 1.75085743e-01 -1.56956109e-02 -6.03895043e-02]
 [ 7.06137674e-02  2.96709501e-02 -6.49405986e-02]
 [ 6.09332340e-02  2.14288936e-02 -6.78076150e-02]
 [-1.38545120e-01  8.55300912e-02 -6.97535771e-02]
 [-4.90044425e-02 -5.74450940e-02  6.68409678e-02]
 [-3.39901165e-02  5.92655732e-02 -3.33767858e-02]
 [ 5.66429457e-02  1.10592224e-01 -8.15033744e-02]
 [-4.38898311e-02  8.32462365e-02  3.53968331e-03]
 [-7.84735060e-02 -3.50519257e-02 -6.15462583e-02]
 [ 1.63189036e-01  1.54461604e-01  2.44468226e-01]
 [ 2.07037243e-01  2.96226505e-01  7.52984435e-02]
 [-6.92629788e-02 -9.04446245e-02 -1.21398277e-01]
 [-8.43940871e-02  4.63172760e-03 -1.04099735e-01]
 [ 2.47957986e-02 -9.45972643e-02 -5.28887284e-02]
 [ 3.31877149e-02  7.26117378e-02  4.47040256e-02]
 [ 2.87011193e-01 -7.33542532e-02 -3.61623498e-02]
 [-5.64591836e-02  1.55064373e-02 -5.23479991e-02]
 [ 7.07643962e-02 -5.43165600e-02  6.87939912e-02]
 [-3.91314423e-02 -2.00978300e-02  1.26257813e-01]
 [-3.66179120e-02 -2.66631837e-02 -6.67824604e-02]
 [-9.00398109e-02  7.37710508e-02  6.27705885e-02]
 [ 5.70619635e-02 -4.16498271e-02  7.00314128e-02]
 [-1.36970789e-01  6.55400262e-02  3.66765045e-02]
 [-2.83660172e-02  5.48278412e-02  2.30062713e-02]
 [ 6.17990838e-02 -6.58895444e-02  6.54751943e-02]
 [ 2.25330103e-02  1.50484047e-03 -7.43080052e-02]
 [-3.34621724e-02  3.07248649e-01  1.92020150e-02]
 [ 2.21268863e-02 -1.23462155e-01 -6.52389581e-02]
 [ 5.99555336e-02 -3.06583465e-02  6.84525860e-02]
 [-1.29532956e-01 -5.30173344e-02  1.69616132e-02]
 [-1.41832283e-01  9.78279800e-02  3.53168543e-02]
 [ 1.02812065e-01 -1.57361833e-01 -1.29475753e-01]
 [-2.01774779e-01 -3.38699293e-01  5.49765330e-02]
 [-5.12537636e-02 -3.68318804e-02  6.23310566e-02]
 [-3.91262584e-02  8.37878282e-02 -2.39226132e-02]
 [ 8.85956993e-02 -3.63474986e-03 -7.85200335e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.26023247 -29.25593426 -29.27334937]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  8.31486419  -9.25153874 -83.50871763]
init_Out:  [2.49911038]
Stock Position:  8.31486419409362
Bond position:  [-828.98730903]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-3.43961976]
curr_Stock_Price:  99.2982326456946
curr_Factors:  [99.29823265 -0.8336387  -1.00098387]
mat_Sqrt:  [[15.8553217   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00119839  0.00595062 -0.13688265]
Stock Position:  0.0011983935828559736
Bond Position:  [-3.55861812]


portfolio before change:  [-3.44002558]
curr_Stock_Price:  99.33080115343408
curr_Factors:  [99.33080115 -1.11805922 -1.00353011]
mat_Sqrt:  [[11.90390356  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00129408  0.0113647   0.31000418]
Stock Position:  -0.0012940835864048872
Bond Position:  [-3.31148322]


portfolio before change:  [-3.4417146]
curr_Stock_Price:  100.31610030982725
curr_Factors:  [100.31610031  -1.1950121   -1.02977046]
mat_Sqrt:  [[10.84325951  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00906898 0.0566535  0.10861642]
Stock Position:  0.009068975304587223
Bond Position:  [-4.35147884]


portfolio before change:  [-3.44350195]
curr_Stock_Price:  100.17899792142703
curr_Factors:  [100.17899792  -0.96267842  -1.04447036]
mat_Sqrt:  [[13.46117731  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01206087 -0.00496339 -0.17227445]
Stock Position:  0.01206087139225552
Bond Position:  [-4.65174796]


portfolio before change:  [-3.45323531]
curr_Stock_Price:  99.42019267845762
curr_Factors:  [99.42019268 -0.97384216 -1.039695  ]
mat_Sqrt:  [[13.27414394  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00437873  0.00938278 -0.18525745]
Stock Position:  0.004378732378311512
Bond Position:  [-3.88856972]


portfolio before change:  [-3.45167474]
curr_Stock_Price:  99.88760464044373
curr_Factors:  [99.88760464 -0.81883836 -1.03671685]
mat_Sqrt:  [[15.61903546  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00305047  0.00677641 -0.19343625]
Stock Position:  0.003050467123745306
Bond Position:  [-3.75637859]


portfolio before change:  [-3.45141712]
curr_Stock_Price:  100.1259918461757
curr_Factors:  [100.12599185  -0.84992045  -1.03316195]
mat_Sqrt:  [[15.23121452  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00988596  0.02704699 -0.19898754]
Stock Position:  -0.00988595698148987
Bond Position:  [-2.46157587]


portfolio before change:  [-3.44989629]
curr_Stock_Price:  99.94102800315662
curr_Factors:  [99.941028   -1.00775511 -1.02909083]
mat_Sqrt:  [[13.03625535  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00282626 -0.01816573  0.19067868]
Stock Position:  -0.002826257390374587
Bond Position:  [-3.16743722]


portfolio before change:  [-3.45191455]
curr_Stock_Price:  100.51504021198429
curr_Factors:  [100.51504021  -1.34873555  -1.02082506]
mat_Sqrt:  [[ 9.40034849  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00417781  0.01874142 -0.09521468]
Stock Position:  -0.004177812546012733
Bond Position:  [-3.03198156]


portfolio before change:  [-3.45178759]
curr_Stock_Price:  100.39392699103446
curr_Factors:  [100.39392699  -1.05416367  -1.04309818]
mat_Sqrt:  [[12.32759038  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00347689  0.03497233 -0.23250644]
Stock Position:  0.0034768853188197175
Bond Position:  [-3.80084576]


portfolio before change:  [-3.44860885]
curr_Stock_Price:  101.44483050087797
curr_Factors:  [101.4448305   -1.22262836  -1.04653526]
mat_Sqrt:  [[10.48925596  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00391047  0.02632477  0.01009773]
Stock Position:  -0.003910466849467055
Bond Position:  [-3.0519122]


portfolio before change:  [-3.45092281]
curr_Stock_Price:  101.93900369978024
curr_Factors:  [101.9390037   -1.06780234  -1.06962724]
mat_Sqrt:  [[12.02448576  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0076462  -0.01108439 -0.17557434]
Stock Position:  -0.007646199763516524
Bond Position:  [-2.67147683]


portfolio before change:  [-3.45364171]
curr_Stock_Price:  102.25091635295935
curr_Factors:  [102.25091635  -1.21122394  -1.09140528]
mat_Sqrt:  [[10.22464045  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.02123097 0.04884505 0.6973998 ]
Stock Position:  0.021230974924941477
Bond Position:  [-5.62452835]


portfolio before change:  [-3.44923082]
curr_Stock_Price:  102.49179088796015
curr_Factors:  [102.49179089  -1.23079771  -1.12201536]
mat_Sqrt:  [[ 9.74709835  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.02360251 0.09367505 0.2148055 ]
Stock Position:  0.023602512353589313
Bond Position:  [-5.86829458]


portfolio before change:  [-3.44623568]
curr_Stock_Price:  102.64977068792014
curr_Factors:  [102.64977069  -1.09356327  -1.16192413]
mat_Sqrt:  [[10.75999951  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00895712 -0.0286011  -0.34631549]
Stock Position:  -0.00895711643364123
Bond Position:  [-2.52678974]


portfolio before change:  [-3.45237099]
curr_Stock_Price:  103.29947070314684
curr_Factors:  [103.2994707   -1.05879631  -1.17049963]
mat_Sqrt:  [[11.11545307  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00949343  0.00146468 -0.29696757]
Stock Position:  -0.009493429112448616
Bond Position:  [-2.47170479]


portfolio before change:  [-3.44885711]
curr_Stock_Price:  102.8967850321433
curr_Factors:  [102.89678503  -0.98446298  -1.19525707]
mat_Sqrt:  [[11.63486682  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00099335 -0.02991428 -0.15087682]
Stock Position:  0.0009933453850678655
Bond Position:  [-3.55106915]


portfolio before change:  [-3.45005927]
curr_Stock_Price:  102.13345017012836
curr_Factors:  [102.13345017  -1.28345163  -1.16645467]
mat_Sqrt:  [[ 8.81428755  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00501319 0.02296185 0.12752814]
Stock Position:  0.005013191666687328
Bond Position:  [-3.96207383]


portfolio before change:  [-3.45171559]
curr_Stock_Price:  101.9018558541925
curr_Factors:  [101.90185585  -1.4152968   -1.16026419]
mat_Sqrt:  [[ 7.75586371  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.03580976 -0.02319665 -0.10316112]
Stock Position:  0.035809755816978324
Bond Position:  [-7.10079617]


portfolio before change:  [-3.45077434]
curr_Stock_Price:  101.95292858184206
curr_Factors:  [101.95292858  -1.31084525  -1.1318406 ]
mat_Sqrt:  [[ 8.86246882  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00753112  0.00490357 -0.14933427]
Stock Position:  -0.007531118146571951
Bond Position:  [-2.68295479]


portfolio before change:  [-3.44715281]
curr_Stock_Price:  101.42751932385465
curr_Factors:  [101.42751932  -1.54820491  -1.13703963]
mat_Sqrt:  [[ 6.91781462  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01205648 -0.0171764   0.19625011]
Stock Position:  0.012056475622242041
Bond Position:  [-4.67001123]


portfolio before change:  [-3.44466855]
curr_Stock_Price:  101.68199246047439
curr_Factors:  [101.68199246  -1.34517885  -1.1667926 ]
mat_Sqrt:  [[ 8.24724142  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00168276 -0.00635549  0.3601784 ]
Stock Position:  -0.0016827563473167796
Bond Position:  [-3.27356253]


portfolio before change:  [-3.44433063]
curr_Stock_Price:  101.23799026186268
curr_Factors:  [101.23799026  -1.50984282  -1.16656752]
mat_Sqrt:  [[ 6.96615725  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00731225 -0.00843164 -0.19051177]
Stock Position:  -0.007312247379508678
Bond Position:  [-2.7040534]


portfolio before change:  [-3.44583578]
curr_Stock_Price:  101.39760262316794
curr_Factors:  [101.39760262  -1.47543831  -1.14809121]
mat_Sqrt:  [[ 7.35602666  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0102395   0.02332845  0.17906702]
Stock Position:  -0.010239503100316039
Bond Position:  [-2.40757471]


portfolio before change:  [-3.45164214]
curr_Stock_Price:  101.93526506025138
curr_Factors:  [101.93526506  -1.34855044  -1.1830187 ]
mat_Sqrt:  [[ 8.10733177  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0086689  -0.01317083  0.19978013]
Stock Position:  0.008668902895841917
Bond Position:  [-4.33530906]


portfolio before change:  [-3.4559134]
curr_Stock_Price:  101.50507103141813
curr_Factors:  [101.50507103  -1.36867178  -1.18585448]
mat_Sqrt:  [[ 7.88989236  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01619692  0.02072558  0.10462786]
Stock Position:  -0.01619692470441321
Bond Position:  [-1.81184341]


portfolio before change:  [-3.45156497]
curr_Stock_Price:  101.22261496361929
curr_Factors:  [101.22261496  -1.22482084  -1.18977404]
mat_Sqrt:  [[ 9.0496612   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00245912  0.01733809  0.06563049]
Stock Position:  -0.002459123324074918
Bond Position:  [-3.20264608]


portfolio before change:  [-3.45176586]
curr_Stock_Price:  101.14149978703506
curr_Factors:  [101.14149979  -0.93357153  -1.1954593 ]
mat_Sqrt:  [[12.03103658  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00610611 -0.0208361   0.1867825 ]
Stock Position:  0.00610611485186328
Bond Position:  [-4.06934747]


portfolio before change:  [-3.44948007]
curr_Stock_Price:  101.59915314384136
curr_Factors:  [101.59915314  -0.89370789  -1.20384047]
mat_Sqrt:  [[12.47200879  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00059363  0.00047587 -0.21198006]
Stock Position:  0.0005936338881226717
Bond Position:  [-3.50979277]


portfolio before change:  [-3.44925024]
curr_Stock_Price:  102.72540552550868
curr_Factors:  [102.72540553  -0.64995427  -1.2309666 ]
mat_Sqrt:  [[15.66045269  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00137987  0.09716055  0.054778  ]
Stock Position:  -0.0013798740014469703
Bond Position:  [-3.30750213]


portfolio before change:  [-3.4511635]
curr_Stock_Price:  103.81231272769172
curr_Factors:  [103.81231273  -0.79079164  -1.26601528]
mat_Sqrt:  [[13.27360749  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00042357 -0.03904216 -0.18610859]
Stock Position:  0.0004235668902726798
Bond Position:  [-3.49513496]


portfolio before change:  [-3.45112716]
curr_Stock_Price:  104.92963542468851
curr_Factors:  [104.92963542  -0.47032431  -1.25602104]
mat_Sqrt:  [[18.670498    0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00391724 -0.00969502  0.19527617]
Stock Position:  0.003917236921395912
Bond Position:  [-3.8621614]


portfolio before change:  [-3.44892333]
curr_Stock_Price:  105.61548449419678
curr_Factors:  [105.61548449  -0.76810722  -1.24881378]
mat_Sqrt:  [[14.0536759   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00906806 -0.01676555  0.04838676]
Stock Position:  -0.009068060445137029
Bond Position:  [-2.49119573]


portfolio before change:  [-3.43975333]
curr_Stock_Price:  104.5699010596227
curr_Factors:  [104.56990106  -0.68684199  -1.27326015]
mat_Sqrt:  [[14.72804679  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0089691   0.03093592  0.10074916]
Stock Position:  -0.008969101913991528
Bond Position:  [-2.50185523]


portfolio before change:  [-3.44797709]
curr_Stock_Price:  105.4519294550312
curr_Factors:  [105.45192946  -0.78876395  -1.2755016 ]
mat_Sqrt:  [[13.38305899  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00540384 -0.04976218 -0.36935829]
Stock Position:  0.005403837233344975
Bond Position:  [-4.01782215]


portfolio before change:  [-3.45293477]
curr_Stock_Price:  104.627437177254
curr_Factors:  [104.62743718  -0.79012526  -1.28363221]
mat_Sqrt:  [[13.15298003  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0151523  -0.10710612  0.15683275]
Stock Position:  -0.015152301519797205
Bond Position:  [-1.86758829]


portfolio before change:  [-3.44474036]
curr_Stock_Price:  104.07122666592322
curr_Factors:  [104.07122667  -0.6844547   -1.31051424]
mat_Sqrt:  [[14.15554753  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00278912 -0.01164726  0.17781315]
Stock Position:  -0.002789117476164175
Bond Position:  [-3.15447348]


portfolio before change:  [-3.44418943]
curr_Stock_Price:  103.73231306373089
curr_Factors:  [103.73231306  -0.92640911  -1.32606402]
mat_Sqrt:  [[10.90629922  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00383687  0.02649604 -0.06824456]
Stock Position:  -0.0038368696935248254
Bond Position:  [-3.04618206]


portfolio before change:  [-3.4458906]
curr_Stock_Price:  104.07644186902458
curr_Factors:  [104.07644187  -0.97002308  -1.34533554]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-3.4458906]
Stock Price:  103.8126714846613
PL:  [-7.25856208]
Settle:  Tensor("sub_206:0", shape=(), dtype=float64)
PL:  Tensor("sub_207:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  104
output_Z_Vals[:, i, :]:  [[ 1.19260232e+02 -2.92559343e+01 -2.92733494e+01]
 [ 9.22673599e-03 -7.46784227e-02 -3.49807873e-02]
 [-4.26186086e-02  2.82539134e-02  1.06287726e-01]
 [ 3.91528351e-02  1.56124825e-01  2.93717320e-02]
 [ 4.16344000e-02  2.92219502e-02 -7.04162145e-02]
 [ 6.76882442e-02  2.89622844e-02 -7.41110032e-02]
 [ 7.11793301e-02  1.47687705e-02 -6.70328408e-02]
 [-1.36625571e-01  2.07054307e-02 -9.74970150e-02]
 [-8.68302668e-02 -6.82335993e-02  9.83917103e-02]
 [-1.72743789e-02 -9.58837517e-02 -1.33518061e-01]
 [ 5.25742203e-02  9.59940613e-02 -7.58018745e-02]
 [-1.73807946e-02  6.41262727e-02 -1.29477047e-02]
 [-9.47800857e-02  8.19838429e-03 -5.46154835e-02]
 [-9.66675714e-02 -1.12028321e-01  6.51218017e-02]
 [ 2.90988297e-01  3.58204439e-01  3.68159153e-02]
 [-5.85624249e-02 -3.57537933e-01 -6.51333428e-02]
 [-6.78668123e-02 -6.64245305e-02 -4.77233479e-02]
 [-7.48366119e-02  1.90282070e-01  1.29103145e-01]
 [ 1.21709805e-01  6.31929105e-02  1.31547219e-01]
 [ 1.25010969e-02 -1.53691821e-02  7.51162759e-02]
 [-2.92891073e-02 -2.28663749e-02 -1.08145818e-02]
 [ 1.08462181e-01 -6.15328706e-02  1.19829450e-01]
 [-3.00945869e-02 -6.17011481e-02  1.97553147e-01]
 [-6.78491196e-02 -5.83535615e-04 -8.22261451e-02]
 [-3.29664400e-01  1.15971576e-01  6.27781213e-02]
 [-5.74815341e-02 -1.70318267e-01  1.06745626e-01]
 [ 2.22820247e-01  4.87885552e-02 -1.42056009e-01]
 [-4.13001297e-02  6.61943233e-02  2.65718924e-02]
 [-7.67020748e-02 -7.19697047e-02 -2.04517550e-01]
 [ 3.60524754e-02  2.95314132e-02 -1.09853431e-01]
 [ 4.14530001e-02  1.01165166e-01  1.94140452e-02]
 [ 2.30652328e-02 -7.33022708e-02 -8.40260051e-02]
 [ 2.50360723e-01 -1.50252331e-01 -1.90425656e-02]
 [-4.56543528e-02 -8.12084158e-02  4.46007574e-03]
 [-1.87641174e-01  1.40748262e-01  2.46105646e-02]
 [ 1.43251942e-01 -1.40264923e-01 -1.08801509e-01]
 [-5.29309669e-02 -1.47499537e-01 -4.40578397e-02]
 [-2.74287991e-02  2.68487545e-02 -5.25363816e-02]
 [ 2.61092051e-02 -3.63948049e-02 -6.39501628e-03]
 [-7.65312419e-01  3.81469337e-01  4.69421247e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.26023247 -29.25593426 -29.27334937]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  8.31486419  -9.25153874 -83.50871763]
init_Out:  [2.49911038]
Stock Position:  8.31486419409362
Bond position:  [-828.98730903]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-0.44616647]
curr_Stock_Price:  99.65824493363435
curr_Factors:  [99.65824493 -0.97852654 -1.0043134 ]
mat_Sqrt:  [[13.72071641  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 1.15244776e-05 -2.36153908e-02 -9.97904495e-02]
Stock Position:  1.1524477622572508e-05
Bond Position:  [-0.44731498]


portfolio before change:  [-0.44622735]
curr_Stock_Price:  99.22768982973608
curr_Factors:  [99.22768983 -0.98091759 -1.01518578]
mat_Sqrt:  [[13.48143745  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00149785  0.00893467  0.3032093 ]
Stock Position:  -0.0014978524800405148
Bond Position:  [-0.29759891]


portfolio before change:  [-0.44645418]
curr_Stock_Price:  99.35428680747744
curr_Factors:  [99.35428681 -1.04435685 -1.00424528]
mat_Sqrt:  [[12.80825621  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00383967 0.049371   0.08378938]
Stock Position:  0.0038396671306912614
Bond Position:  [-0.82794157]


portfolio before change:  [-0.44835349]
curr_Stock_Price:  98.88658648915023
curr_Factors:  [98.88658649 -1.18752988 -1.0174023 ]
mat_Sqrt:  [[10.90303749  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00256949  0.00924079 -0.20087786]
Stock Position:  0.00256949110852057
Bond Position:  [-0.7024417]


portfolio before change:  [-0.44775687]
curr_Stock_Price:  99.15295388484702
curr_Factors:  [99.15295388 -1.08276519 -1.00681467]
mat_Sqrt:  [[12.26909859  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00434492  0.00915868 -0.21141806]
Stock Position:  0.004344915934330949
Bond Position:  [-0.87856812]


portfolio before change:  [-0.44727922]
curr_Stock_Price:  99.28816631934787
curr_Factors:  [99.28816632 -1.39484978 -1.00849011]
mat_Sqrt:  [[ 8.97718631  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00644719  0.0046703  -0.19122604]
Stock Position:  0.006447191222500039
Bond Position:  [-1.08740901]


portfolio before change:  [-0.44279332]
curr_Stock_Price:  100.0050414033836
curr_Factors:  [100.0050414   -1.2903845   -1.04936909]
mat_Sqrt:  [[ 9.63562346  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01618914  0.00654763 -0.27813185]
Stock Position:  -0.016189139633300317
Bond Position:  [1.17620226]


portfolio before change:  [-0.43990488]
curr_Stock_Price:  99.83570537077901
curr_Factors:  [99.83570537 -1.10748066 -1.05890734]
mat_Sqrt:  [[11.44025059  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00598832 -0.02157736  0.28068416]
Stock Position:  -0.0059883239835828205
Bond Position:  [0.15794367]


portfolio before change:  [-0.4426766]
curr_Stock_Price:  100.30185721857764
curr_Factors:  [100.30185722  -1.50956475  -1.07933237]
mat_Sqrt:  [[ 7.53295275  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00623983 -0.0303211  -0.38088986]
Stock Position:  -0.006239830301109344
Bond Position:  [0.18318996]


portfolio before change:  [-0.44460656]
curr_Stock_Price:  100.6148237463496
curr_Factors:  [100.61482375  -1.74839844  -1.07694734]
mat_Sqrt:  [[ 5.96526703  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00663504  0.03035599 -0.21624165]
Stock Position:  0.006635039670088162
Bond Position:  [-1.11218991]


portfolio before change:  [-0.44570013]
curr_Stock_Price:  100.47096031276716
curr_Factors:  [100.47096031  -1.3206098   -1.06051945]
mat_Sqrt:  [[ 9.28815077  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00197757  0.02027851 -0.0369362 ]
Stock Position:  -0.0019775734646129404
Bond Position:  [-0.24701143]


portfolio before change:  [-0.44624333]
curr_Stock_Price:  100.73002555344742
curr_Factors:  [100.73002555  -1.09053837  -1.07336856]
mat_Sqrt:  [[11.57140519  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00913603  0.00259256 -0.15580277]
Stock Position:  -0.009136033308710814
Bond Position:  [0.47402954]


portfolio before change:  [-0.43763856]
curr_Stock_Price:  99.79466202248759
curr_Factors:  [99.79466202 -0.91297632 -1.03495766]
mat_Sqrt:  [[14.22755693  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00606339 -0.03542647  0.18577437]
Stock Position:  -0.00606338801135135
Bond Position:  [0.16745519]


portfolio before change:  [-0.43133211]
curr_Stock_Price:  98.75802688742081
curr_Factors:  [98.75802689 -0.97161262 -1.03361282]
mat_Sqrt:  [[13.29578737  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.02314659 0.11327419 0.10502556]
Stock Position:  0.023146588037205425
Bond Position:  [-2.71724347]


portfolio before change:  [-0.44768677]
curr_Stock_Price:  98.06613302601437
curr_Factors:  [98.06613303 -0.82773011 -1.04480032]
mat_Sqrt:  [[15.07611409  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00537866 -0.11306342 -0.1858073 ]
Stock Position:  -0.005378660711731707
Bond Position:  [0.07977769]


portfolio before change:  [-0.45238116]
curr_Stock_Price:  98.94076795178712
curr_Factors:  [98.94076795 -0.85896969 -1.06104743]
mat_Sqrt:  [[14.50515699  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00546863 -0.02100528 -0.13614143]
Stock Position:  -0.005468632565440733
Bond Position:  [0.08868955]


portfolio before change:  [-0.4504069]
curr_Stock_Price:  98.58177987447935
curr_Factors:  [98.58177987 -0.7925359  -1.05478452]
mat_Sqrt:  [[15.54231078  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00280335  0.06017247  0.36829534]
Stock Position:  -0.0028033463938888815
Bond Position:  [-0.17404802]


portfolio before change:  [-0.45123631]
curr_Stock_Price:  98.86988298549633
curr_Factors:  [98.86988299 -1.00838761 -1.05645714]
mat_Sqrt:  [[12.54045632  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01197671 0.01998335 0.3752676 ]
Stock Position:  0.011976709547577588
Bond Position:  [-1.63537218]


portfolio before change:  [-0.45462348]
curr_Stock_Price:  98.6041393073547
curr_Factors:  [98.60413931 -0.72226162 -1.07582114]
mat_Sqrt:  [[16.33043402  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00168013 -0.00486016  0.21428583]
Stock Position:  0.0016801336612669
Bond Position:  [-0.62029161]


portfolio before change:  [-0.45337842]
curr_Stock_Price:  99.39133758265802
curr_Factors:  [99.39133758 -0.93826625 -1.07905614]
mat_Sqrt:  [[13.22015515  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00242713 -0.00723098 -0.03085099]
Stock Position:  -0.0024271297464430706
Bond Position:  [-0.21214275]


portfolio before change:  [-0.45355978]
curr_Stock_Price:  99.45513098335539
curr_Factors:  [99.45513098 -0.99918041 -1.09256371]
mat_Sqrt:  [[12.27988407  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01069501 -0.0194584   0.34184007]
Stock Position:  0.010695010801651538
Bond Position:  [-1.51723348]


portfolio before change:  [-0.45403366]
curr_Stock_Price:  99.42855653839779
curr_Factors:  [99.42855654 -1.00798298 -1.09871833]
mat_Sqrt:  [[12.09434577  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00071419 -0.01951162  0.56356414]
Stock Position:  0.0007141902246771039
Bond Position:  [-0.52504456]


portfolio before change:  [-0.45470476]
curr_Stock_Price:  98.5807832159163
curr_Factors:  [98.58078322 -0.91369033 -1.12468379]
mat_Sqrt:  [[12.83919018  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-6.59298030e-03 -1.84530164e-04 -2.34568305e-01]
Stock Position:  -0.0065929803022713035
Bond Position:  [0.1952364]


portfolio before change:  [-0.45396646]
curr_Stock_Price:  98.47250196046852
curr_Factors:  [98.47250196 -1.05095181 -1.11836369]
mat_Sqrt:  [[11.25105427  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02789565  0.03667343  0.17908851]
Stock Position:  -0.027895652177897873
Bond Position:  [2.2929882]


portfolio before change:  [-0.43670684]
curr_Stock_Price:  97.86405672717206
curr_Factors:  [97.86405673 -1.13949812 -1.13280668]
mat_Sqrt:  [[10.08727311  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00397429 -0.05385937  0.30451556]
Stock Position:  -0.0039742924319956545
Bond Position:  [-0.04776646]


portfolio before change:  [-0.43623637]
curr_Stock_Price:  97.74417600813373
curr_Factors:  [97.74417601 -1.06132629 -1.13265548]
mat_Sqrt:  [[10.89573951  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01790451  0.0154283  -0.40524625]
Stock Position:  0.017904512153343655
Bond Position:  [-2.18629816]


portfolio before change:  [-0.4289373]
curr_Stock_Price:  98.16710735925403
curr_Factors:  [98.16710736 -0.85275114 -1.12167554]
mat_Sqrt:  [[13.62960862  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00250682  0.02093248  0.07580221]
Stock Position:  -0.0025068243501527635
Bond Position:  [-0.1828496]


portfolio before change:  [-0.42867753]
curr_Stock_Price:  98.05436360580049
curr_Factors:  [98.05436361 -1.02152716 -1.13746236]
mat_Sqrt:  [[11.31956383  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01062826 -0.02275882 -0.58343164]
Stock Position:  -0.010628262394608887
Bond Position:  [0.61346998]


portfolio before change:  [-0.43057264]
curr_Stock_Price:  98.23988816897952
curr_Factors:  [98.23988817 -0.89903212 -1.14319025]
mat_Sqrt:  [[12.74564898  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00112911  0.00933865 -0.31338126]
Stock Position:  0.0011291096763266454
Bond Position:  [-0.54149625]


portfolio before change:  [-0.42941081]
curr_Stock_Price:  99.32881540580692
curr_Factors:  [99.32881541 -0.93812858 -1.13915584]
mat_Sqrt:  [[12.44291387  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00385986 0.03199123 0.05538287]
Stock Position:  0.0038598634761610076
Bond Position:  [-0.81280648]


portfolio before change:  [-0.4311876]
curr_Stock_Price:  98.89481471671311
curr_Factors:  [98.89481472 -0.85978977 -1.11593501]
mat_Sqrt:  [[13.71283187  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00029322 -0.02318021 -0.2397028 ]
Stock Position:  0.0002932173190470047
Bond Position:  [-0.46018528]


portfolio before change:  [-0.43120264]
curr_Stock_Price:  99.03972241238743
curr_Factors:  [99.03972241 -0.6729519  -1.12386591]
mat_Sqrt:  [[16.42333516  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01477131 -0.04751396 -0.05432314]
Stock Position:  0.01477131011292501
Bond Position:  [-1.89414909]


portfolio before change:  [-0.43150722]
curr_Stock_Price:  99.03513302119597
curr_Factors:  [99.03513302 -0.50243729 -1.13545706]
mat_Sqrt:  [[19.25133337  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00243312 -0.02568036  0.01272335]
Stock Position:  -0.002433116450096573
Bond Position:  [-0.1905432]


portfolio before change:  [-0.4339273]
curr_Stock_Price:  100.01998837158418
curr_Factors:  [100.01998837  -0.63088992  -1.1177873 ]
mat_Sqrt:  [[17.40387403  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01028412  0.04450851  0.07020709]
Stock Position:  -0.010284115980515146
Bond Position:  [0.59468986]


portfolio before change:  [-0.42224901]
curr_Stock_Price:  98.89165128157705
curr_Factors:  [98.89165128 -0.66255868 -1.13304864]
mat_Sqrt:  [[16.41864383  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00715171 -0.04435566 -0.31038042]
Stock Position:  0.00715170532026977
Bond Position:  [-1.12949296]


portfolio before change:  [-0.41690291]
curr_Stock_Price:  99.65892207826388
curr_Factors:  [99.65892208 -0.48464842 -1.14962979]
mat_Sqrt:  [[19.44277181  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00338083 -0.04664345 -0.12568475]
Stock Position:  -0.0033808274901136162
Bond Position:  [-0.07997329]


portfolio before change:  [-0.41329825]
curr_Stock_Price:  98.58975884459032
curr_Factors:  [98.58975884 -0.40533708 -1.13189912]
mat_Sqrt:  [[21.19427699  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00176744  0.00849032 -0.14987167]
Stock Position:  -0.001767435200808941
Bond Position:  [-0.23904724]


portfolio before change:  [-0.4126323]
curr_Stock_Price:  98.19605964102898
curr_Factors:  [98.19605964 -0.40950712 -1.13559864]
mat_Sqrt:  [[20.94417008  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00113942 -0.01150905 -0.0182432 ]
Stock Position:  0.0011394157863509056
Bond Position:  [-0.52451844]


portfolio before change:  [-0.41276589]
curr_Stock_Price:  98.13636481732163
curr_Factors:  [98.13636482 -0.17129698 -1.12848495]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-0.41276589]
Stock Price:  97.59435784252811
PL:  [-0.41276589]
Settle:  Tensor("sub_208:0", shape=(), dtype=float64)
PL:  Tensor("sub_209:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  105
output_Z_Vals[:, i, :]:  [[ 1.19260232e+02 -2.92559343e+01 -2.92733494e+01]
 [-1.37871388e-01  4.14730846e-01  7.19467078e-02]
 [ 2.05598059e-01  4.20789640e-02 -2.05705807e-01]
 [ 8.15609480e-02  1.39339274e-01  3.75427423e-02]
 [ 2.45295458e-01 -6.17261878e-03 -5.31342096e-03]
 [-4.30545923e-02  3.19707431e-02  1.58513843e-01]
 [-3.29222375e-02  4.75444684e-02 -1.39156095e-01]
 [ 3.35561914e-01 -6.83094510e-02  1.74452974e-01]
 [ 2.47352649e-02  4.91395080e-02  5.30953214e-02]
 [-4.08213517e-02  2.03702231e-01  7.35052513e-02]
 [-4.05087474e-03 -2.38238142e-01  9.91935596e-03]
 [-1.46490257e-01  1.38374747e-01  6.68565720e-02]
 [-1.15710846e-02 -1.43834628e-01 -3.45094314e-02]
 [ 5.18832111e-01  3.61470868e-01  4.43852774e-01]
 [ 9.10290569e-02  4.01331045e-03 -1.06588053e-01]
 [-5.68690036e-02 -7.93123381e-02 -1.28000315e-01]
 [-8.85880157e-02  2.29150386e-02 -1.05094028e-01]
 [ 1.63925128e-01 -2.20404820e-01 -2.10636605e-01]
 [ 4.88248006e-02  4.81942914e-02  3.55174475e-02]
 [ 1.54462263e-01 -2.19670276e-01 -1.74902435e-02]
 [ 3.03345403e-01 -3.90372558e-03  4.50256255e-01]
 [-6.91089063e-02  4.22839982e-02 -6.74558923e-02]
 [-1.63545194e-01  4.39840223e-01  3.22610870e-01]
 [ 2.46576100e-01 -2.96417003e-02  5.07762407e-02]
 [-1.42790552e-01 -5.55430282e-02 -1.37263743e-01]
 [ 1.06390249e-01 -6.24114029e-03  5.64951815e-02]
 [-6.42960217e-02  1.02070263e-01  1.01417894e-01]
 [-5.07806065e-02  7.36225950e-02  2.93687317e-02]
 [ 5.82261940e-02 -4.74972709e-02  9.39803527e-02]
 [-6.59054335e-02 -1.13097402e-01 -3.35868948e-02]
 [-1.41473756e-01  6.67483247e-01 -1.88118555e-02]
 [ 4.02575589e-02  7.94177809e-03  1.02583493e-01]
 [-3.46180807e-02  9.38533762e-03  7.99704988e-02]
 [-1.55487925e-01 -4.88844556e-02  1.56445081e-02]
 [-1.26411898e-01  5.18348476e-02  3.60388476e-02]
 [ 1.05423460e-01 -1.56257804e-01 -1.28140719e-01]
 [-2.13270883e-01 -3.63036227e-01  6.65919316e-02]
 [-5.80843561e-02 -5.59021921e-02  9.53684820e-02]
 [-3.51176299e-02  7.53812731e-02 -2.64378461e-02]
 [-2.23622452e-01  1.25199645e-01  1.35391319e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.26023247 -29.25593426 -29.27334937]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  8.31486419  -9.25153874 -83.50871763]
init_Out:  [2.49911038]
Stock Position:  8.31486419409362
Bond position:  [-828.98730903]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [12.4132084]
curr_Stock_Price:  101.20479753806907
curr_Factors:  [101.20479754  -0.95359611  -1.00809678]
mat_Sqrt:  [[14.23143528  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00790342  0.13114941  0.20524393]
Stock Position:  -0.00790342089952764
Bond Position:  [13.21307251]


portfolio before change:  [12.40762313]
curr_Stock_Price:  102.12047849576904
curr_Factors:  [102.1204785   -1.15076829  -0.97922184]
mat_Sqrt:  [[12.13584115  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01357096  0.01330654 -0.58682141]
Stock Position:  0.013570959718694438
Bond Position:  [11.02175023]


portfolio before change:  [12.40807281]
curr_Stock_Price:  102.05208855046644
curr_Factors:  [102.05208855  -0.84654358  -0.96878569]
mat_Sqrt:  [[16.61247783  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00558749 0.04406295 0.10709899]
Stock Position:  0.005587489940600577
Bond Position:  [11.8378578]


portfolio before change:  [12.41761077]
curr_Stock_Price:  103.49426250400718
curr_Factors:  [103.4942625   -1.10428347  -0.99553613]
mat_Sqrt:  [[12.67582428  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0192533  -0.00195195 -0.01515771]
Stock Position:  0.019253302894257817
Bond Position:  [10.42500439]


portfolio before change:  [12.41801854]
curr_Stock_Price:  103.44775435417431
curr_Factors:  [103.44775435  -0.91186746  -1.00101808]
mat_Sqrt:  [[15.2744447   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00064635  0.01011004  0.45219587]
Stock Position:  -0.0006463481076466601
Bond Position:  [12.4848818]


portfolio before change:  [12.42002117]
curr_Stock_Price:  102.76403186543801
curr_Factors:  [102.76403187  -0.98370479  -1.03182476]
mat_Sqrt:  [[13.69328901  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00438899  0.01503488 -0.39697361]
Stock Position:  -0.004388994023864028
Bond Position:  [12.87105189]


portfolio before change:  [12.41834225]
curr_Stock_Price:  103.51315626546511
curr_Factors:  [103.51315627  -1.11412211  -0.99803168]
mat_Sqrt:  [[12.52272416  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.02949903 -0.02160135  0.49766578]
Stock Position:  0.029499031627063858
Bond Position:  [9.36480438]


portfolio before change:  [12.43030757]
curr_Stock_Price:  103.87908855293679
curr_Factors:  [103.87908855  -1.24458817  -1.01516849]
mat_Sqrt:  [[10.84247139  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00339794 0.01553928 0.15146617]
Stock Position:  0.003397941053300245
Bond Position:  [12.07733255]


portfolio before change:  [12.43297541]
curr_Stock_Price:  104.21990638397426
curr_Factors:  [104.21990638  -1.17852323  -0.99932788]
mat_Sqrt:  [[11.80652142  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00174121  0.0644163   0.20969002]
Stock Position:  -0.001741206014545863
Bond Position:  [12.61444374]


portfolio before change:  [12.43289477]
curr_Stock_Price:  105.17185847666808
curr_Factors:  [105.17185848  -1.11717686  -1.00336481]
mat_Sqrt:  [[12.6171133   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00064812 -0.07533752  0.02829716]
Stock Position:  -0.0006481179074921004
Bond Position:  [12.50105854]


portfolio before change:  [12.43458572]
curr_Stock_Price:  104.97402521779726
curr_Factors:  [104.97402522  -0.93941852  -0.9920573 ]
mat_Sqrt:  [[15.21432042  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00849663  0.04375794  0.19072319]
Stock Position:  -0.008496626372742223
Bond Position:  [13.32651079]


portfolio before change:  [12.43367409]
curr_Stock_Price:  105.27738634738901
curr_Factors:  [105.27738635  -1.0991365   -1.00290215]
mat_Sqrt:  [[12.86563745  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00173556 -0.0454845  -0.0984458 ]
Stock Position:  -0.0017355600920077722
Bond Position:  [12.61638932]


portfolio before change:  [12.43545578]
curr_Stock_Price:  105.15953383075507
curr_Factors:  [105.15953383  -0.95254751  -1.00123654]
mat_Sqrt:  [[14.90496703  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.0415141  0.11430713 1.26618842]
Stock Position:  0.04151410166829254
Bond Position:  [8.0698522]


portfolio before change:  [12.43143606]
curr_Stock_Price:  105.0384060189126
curr_Factors:  [105.03840602  -0.90595123  -0.995004  ]
mat_Sqrt:  [[15.69544943  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0044201   0.00126912 -0.30406605]
Stock Position:  0.004420101836037415
Bond Position:  [11.96715561]


portfolio before change:  [12.43094137]
curr_Stock_Price:  104.58803684419078
curr_Factors:  [104.58803684  -0.83452488  -1.012155  ]
mat_Sqrt:  [[16.49981698  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00515429 -0.02508076 -0.36514927]
Stock Position:  -0.005154287127560434
Bond Position:  [12.97001815]


portfolio before change:  [12.43352774]
curr_Stock_Price:  104.40081083168126
curr_Factors:  [104.40081083  -0.89416438  -1.04929497]
mat_Sqrt:  [[14.95099853  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00732049  0.00724637 -0.29980401]
Stock Position:  -0.007320486343686719
Bond Position:  [13.19779245]


portfolio before change:  [12.42423237]
curr_Stock_Price:  105.89595752073947
curr_Factors:  [105.89595752  -0.94497749  -1.08223773]
mat_Sqrt:  [[13.94668519  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00826277 -0.06969812 -0.6008876 ]
Stock Position:  0.008262772243982973
Bond Position:  [11.54923819]


portfolio before change:  [12.43398302]
curr_Stock_Price:  106.90129831504929
curr_Factors:  [106.90129832  -0.97384994  -1.07978243]
mat_Sqrt:  [[13.71203062  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00418021 0.01524037 0.10132139]
Stock Position:  0.004180208030882044
Bond Position:  [11.98711335]


portfolio before change:  [12.43520046]
curr_Stock_Price:  106.83406682566998
curr_Factors:  [106.83406683  -0.96595648  -1.10005261]
mat_Sqrt:  [[13.53484891  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01072936 -0.06946584 -0.0498948 ]
Stock Position:  0.010729356584195925
Bond Position:  [11.28893966]


portfolio before change:  [12.43557578]
curr_Stock_Price:  106.7375202540417
curr_Factors:  [106.73752025  -0.76256642  -1.1137963 ]
mat_Sqrt:  [[16.34643805  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 2.41736323e-02 -1.23446642e-03  1.28445577e+00]
Stock Position:  0.024173632259303506
Bond Position:  [9.85534222]


portfolio before change:  [12.42011661]
curr_Stock_Price:  106.04705022595968
curr_Factors:  [106.04705023  -0.46008443  -1.13152268]
mat_Sqrt:  [[21.59098269  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00378799  0.01337137 -0.19243288]
Stock Position:  -0.0037879940731628124
Bond Position:  [12.82182221]


portfolio before change:  [12.42351716]
curr_Stock_Price:  105.57246502888724
curr_Factors:  [105.57246503  -0.49929445  -1.12745946]
mat_Sqrt:  [[20.75202198  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00416036  0.13908969  0.92031902]
Stock Position:  -0.004160360862969777
Bond Position:  [12.86273671]


portfolio before change:  [12.42556292]
curr_Stock_Price:  105.4672294524851
curr_Factors:  [105.46722945  -0.54102807  -1.1323608 ]
mat_Sqrt:  [[19.786728    0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01294683 -0.00937353  0.14485048]
Stock Position:  0.012946830362508556
Bond Position:  [11.06009659]


portfolio before change:  [12.43786578]
curr_Stock_Price:  106.31069893438537
curr_Factors:  [106.31069893  -0.54205355  -1.13285423]
mat_Sqrt:  [[19.91470004  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00864906 -0.01756425 -0.39157525]
Stock Position:  -0.008649063805483302
Bond Position:  [13.3573538]


portfolio before change:  [12.43320714]
curr_Stock_Price:  107.04238600906199
curr_Factors:  [107.04238601  -0.60370149  -1.14725918]
mat_Sqrt:  [[18.5833166   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00633693 -0.00197362  0.16116503]
Stock Position:  0.006336927717963672
Bond Position:  [11.75488728]


portfolio before change:  [12.43403286]
curr_Stock_Price:  106.94080070206367
curr_Factors:  [106.9408007   -0.81483765  -1.14322355]
mat_Sqrt:  [[15.09274588  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0027138   0.03227745  0.28931702]
Stock Position:  -0.002713802923809962
Bond Position:  [12.72424911]


portfolio before change:  [12.43454297]
curr_Stock_Price:  107.33895751930099
curr_Factors:  [107.33895752  -1.13528159  -1.14898244]
mat_Sqrt:  [[10.93236473  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00392274  0.02328151  0.08378082]
Stock Position:  -0.003922738864394196
Bond Position:  [12.85560567]


portfolio before change:  [12.43496322]
curr_Stock_Price:  107.64150127881939
curr_Factors:  [107.64150128  -0.8898479   -1.14710138]
mat_Sqrt:  [[14.03925018  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00542646 -0.01501996  0.26809979]
Stock Position:  0.00542646351998055
Bond Position:  [11.85085054]


portfolio before change:  [12.43113236]
curr_Stock_Price:  106.66253756961761
curr_Factors:  [106.66253757  -0.57155874  -1.1294849 ]
mat_Sqrt:  [[19.46516304  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00388805 -0.03576454 -0.09581406]
Stock Position:  -0.0038880481958686493
Bond Position:  [12.84584144]


portfolio before change:  [12.43003941]
curr_Stock_Price:  107.35665919629503
curr_Factors:  [107.3566592   -0.49390796  -1.13758778]
mat_Sqrt:  [[21.00290606  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00609817  0.21107674 -0.05366499]
Stock Position:  -0.006098173586498475
Bond Position:  [13.08471895]


portfolio before change:  [12.43628625]
curr_Stock_Price:  106.60050699513262
curr_Factors:  [106.600507    -0.45806055  -1.14248233]
mat_Sqrt:  [[21.51059032  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00285452 0.00251141 0.29264215]
Stock Position:  0.0028545187120357484
Bond Position:  [12.13199311]


portfolio before change:  [12.43631807]
curr_Stock_Price:  106.08036030509285
curr_Factors:  [106.08036031  -0.3795547   -1.16075105]
mat_Sqrt:  [[22.7346724   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00079402  0.0029679   0.22813357]
Stock Position:  -0.0007940225523542074
Bond Position:  [12.52054827]


portfolio before change:  [12.43800293]
curr_Stock_Price:  105.92961709454545
curr_Factors:  [105.92961709  -0.55106478  -1.19158255]
mat_Sqrt:  [[18.54365266  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00828082 -0.01545862  0.04462943]
Stock Position:  -0.008280822415497033
Bond Position:  [13.31518728]


portfolio before change:  [12.43592762]
curr_Stock_Price:  106.3812413099074
curr_Factors:  [106.38124131  -0.71316896  -1.18236112]
mat_Sqrt:  [[15.98257686  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00736534  0.01639162  0.1028088 ]
Stock Position:  -0.007365340994638203
Bond Position:  [13.21946173]


portfolio before change:  [12.439604]
curr_Stock_Price:  106.10646196043562
curr_Factors:  [106.10646196  -0.51932895  -1.18781277]
mat_Sqrt:  [[19.24596124  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00390899 -0.04941306 -0.3655498 ]
Stock Position:  0.003908990854646625
Bond Position:  [12.02483481]


portfolio before change:  [12.43884232]
curr_Stock_Price:  105.527059983436
curr_Factors:  [105.52705998  -0.66580618  -1.17834356]
mat_Sqrt:  [[16.69013247  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01252545 -0.11480214  0.18996825]
Stock Position:  -0.012525449842953394
Bond Position:  [13.76061621]


portfolio before change:  [12.43276103]
curr_Stock_Price:  106.14990964921233
curr_Factors:  [106.14990965  -0.48962229  -1.18475649]
mat_Sqrt:  [[19.89510169  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0020136  -0.01767783  0.27205973]
Stock Position:  -0.0020135978819899236
Bond Position:  [12.64650426]


portfolio before change:  [12.438384]
curr_Stock_Price:  104.14252714612473
curr_Factors:  [104.14252715  -0.23507019  -1.18427098]
mat_Sqrt:  [[25.18929871  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00153112  0.02383765 -0.07541982]
Stock Position:  -0.001531122283731601
Bond Position:  [12.59783895]


portfolio before change:  [12.44211602]
curr_Stock_Price:  102.73363470349847
curr_Factors:  [ 1.02733635e+02 -8.26922727e-02 -1.17045796e+00]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [12.44211602]
Stock Price:  105.4332129500514
PL:  [7.00890307]
Settle:  Tensor("sub_210:0", shape=(), dtype=float64)
PL:  Tensor("sub_211:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  106
output_Z_Vals[:, i, :]:  [[ 1.19260232e+02 -2.92559343e+01 -2.92733494e+01]
 [-2.46572879e-03 -6.98379283e-02 -2.62569231e-02]
 [-3.67247553e-02  8.65217952e-03  4.37453395e-02]
 [ 8.64775503e-02  1.84046084e-01  3.81400216e-02]
 [ 1.59581143e-01 -1.05905723e-02 -6.11104457e-02]
 [ 7.65716951e-02  3.26452777e-02 -1.24675129e-02]
 [-8.78603833e-03  6.06278038e-02 -7.30273596e-02]
 [-7.38139288e-02  2.05835107e-01  3.56367406e-02]
 [-5.58407917e-02 -4.54688262e-02  5.21949758e-02]
 [-4.74867083e-02  1.13557978e-01  5.01988388e-03]
 [ 5.64306925e-02  7.62622239e-02 -7.95738290e-02]
 [-7.12988755e-02  3.44784447e-02  1.29543961e-02]
 [-1.14342731e-01  4.85535078e-02 -3.04773112e-02]
 [-9.62623594e-02 -1.14884369e-01  6.32126881e-02]
 [ 2.68931267e-01  3.33164883e-01  3.70026632e-02]
 [-6.18955974e-02 -2.46381548e-01 -7.57990344e-02]
 [-6.73926023e-02 -6.31035287e-02 -4.60213486e-02]
 [-8.05827683e-02  1.50284826e-01  1.23474148e-01]
 [ 1.18177548e-01  6.99277034e-02  1.37124818e-01]
 [ 1.04922632e-01 -3.92398612e-02  4.42990597e-02]
 [-8.02318300e-03 -3.44380345e-02 -4.76152433e-03]
 [ 1.16514296e-01 -6.28352995e-02  1.42528185e-01]
 [-2.34404206e-02 -8.44414028e-02  1.81063724e-01]
 [-6.71321950e-02 -6.00595722e-04 -8.24350374e-02]
 [-1.49531537e-01  7.78827267e-02  7.02644384e-02]
 [-2.00030775e-02 -1.28165894e-01  9.47268489e-02]
 [-1.37667998e-02  5.00022798e-02 -3.53920083e-02]
 [-5.07806065e-02  7.36225950e-02  2.93687317e-02]
 [ 4.03984893e-02 -5.13700931e-02  4.68788483e-02]
 [ 2.37167289e-02  7.57429013e-03 -1.22293895e-01]
 [ 5.65993421e-02  5.99809824e-02  1.98691483e-02]
 [ 6.39167634e-02 -9.47368551e-02 -5.76624921e-02]
 [ 3.42088078e-01 -1.50116893e-01  3.40922829e-02]
 [-3.68228009e-02 -7.25865203e-02  2.87556520e-02]
 [-2.27149576e-01  1.77582185e-01  1.53600686e-02]
 [ 2.54070866e-01  3.75348542e-02  1.98361390e-02]
 [ 2.29624653e-02 -2.53929194e-03 -1.05597292e-01]
 [-3.68980642e-03  6.83349300e-02 -2.85189328e-03]
 [ 2.99347276e-01 -3.72875274e-01 -8.84739617e-02]
 [-6.23631471e-01  3.24605140e-01  3.67773069e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.26023247 -29.25593426 -29.27334937]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  8.31486419  -9.25153874 -83.50871763]
init_Out:  [2.49911038]
Stock Position:  8.31486419409362
Bond position:  [-828.98730903]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [3.54090536]
curr_Stock_Price:  100.13775629330635
curr_Factors:  [100.13775629  -0.84195189  -1.01466688]
mat_Sqrt:  [[15.64150615  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00061558 -0.02208469 -0.07490369]
Stock Position:  -0.0006155806365918182
Bond Position:  [3.60254822]


portfolio before change:  [3.54150069]
curr_Stock_Price:  99.90223084734038
curr_Factors:  [99.90223085 -0.81266539 -0.99261907]
mat_Sqrt:  [[16.42669171  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00167848  0.00273606  0.12479328]
Stock Position:  -0.0016784802095159404
Bond Position:  [3.70918461]


portfolio before change:  [3.5405065]
curr_Stock_Price:  100.77079356959207
curr_Factors:  [100.77079357  -1.23581249  -0.95625931]
mat_Sqrt:  [[11.25459812  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00879773 0.05820048 0.10880287]
Stock Position:  0.00879772853265776
Bond Position:  [2.65395242]


portfolio before change:  [3.53266927]
curr_Stock_Price:  99.84225812049861
curr_Factors:  [99.84225812 -1.19764117 -0.93769717]
mat_Sqrt:  [[11.8018132   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01244161 -0.00334903 -0.17433109]
Stock Position:  0.012441611770213249
Bond Position:  [2.29047065]


portfolio before change:  [3.5470285]
curr_Stock_Price:  100.97337405325827
curr_Factors:  [100.97337405  -1.21478048  -0.9690213 ]
mat_Sqrt:  [[11.3708729   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00658434  0.01032334 -0.03556634]
Stock Position:  0.006584338137569297
Bond Position:  [2.88218566]


portfolio before change:  [3.55244012]
curr_Stock_Price:  101.74054694399169
curr_Factors:  [101.74054694  -1.25451425  -0.94742061]
mat_Sqrt:  [[11.25138299  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00196663  0.01917219 -0.20832673]
Stock Position:  -0.0019666277949490466
Bond Position:  [3.75252591]


portfolio before change:  [3.55391972]
curr_Stock_Price:  101.22672063006269
curr_Factors:  [101.22672063  -1.22651704  -0.92941193]
mat_Sqrt:  [[11.72160578  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00522326  0.06509078  0.1016617 ]
Stock Position:  -0.00522325790421272
Bond Position:  [4.08265299]


portfolio before change:  [3.55800435]
curr_Stock_Price:  100.54242153372694
curr_Factors:  [100.54242153  -1.13165609  -0.94045264]
mat_Sqrt:  [[12.66029869  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00366188 -0.01437851  0.14889774]
Stock Position:  -0.003661883349084334
Bond Position:  [3.92617897]


portfolio before change:  [3.55947419]
curr_Stock_Price:  100.27506358898587
curr_Factors:  [100.27506359  -1.27650106  -0.92753183]
mat_Sqrt:  [[11.06607537  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00393364  0.03591019  0.01432033]
Stock Position:  -0.003933641599777966
Bond Position:  [3.95392035]


portfolio before change:  [3.55752771]
curr_Stock_Price:  100.8955442842924
curr_Factors:  [100.89554428  -1.09607664  -0.92706342]
mat_Sqrt:  [[13.34238367  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00315962  0.02411623 -0.22700198]
Stock Position:  0.0031596179407028407
Bond Position:  [3.23873634]


portfolio before change:  [3.55441101]
curr_Stock_Price:  99.78098923081446
curr_Factors:  [99.78098923 -0.90383629 -0.94262896]
mat_Sqrt:  [[15.74483578  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00430391  0.01090304  0.03695529]
Stock Position:  -0.0043039090301237
Bond Position:  [3.98385931]


portfolio before change:  [3.55755732]
curr_Stock_Price:  99.16566714741808
curr_Factors:  [99.16566715 -0.92294389 -0.94600391]
mat_Sqrt:  [[15.29986578  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00779812  0.01535397 -0.08694329]
Stock Position:  -0.007798123327484938
Bond Position:  [4.33086342]


portfolio before change:  [3.56256193]
curr_Stock_Price:  98.59332189210046
curr_Factors:  [98.59332189 -0.8486988  -0.95745653]
mat_Sqrt:  [[16.19735885  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0053296  -0.03632963  0.1803282 ]
Stock Position:  -0.005329598852880348
Bond Position:  [4.08802478]


portfolio before change:  [3.56212704]
curr_Stock_Price:  98.77080660026137
curr_Factors:  [98.7708066  -0.94166039 -0.95180889]
mat_Sqrt:  [[14.86980726  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01917218 0.10535599 0.1055583 ]
Stock Position:  0.019172184236979493
Bond Position:  [1.66847494]


portfolio before change:  [3.5609998]
curr_Stock_Price:  98.70113221748791
curr_Factors:  [98.70113222 -1.03646732 -0.96294334]
mat_Sqrt:  [[13.36562017  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00626455 -0.07791269 -0.21623355]
Stock Position:  -0.00626454692286129
Bond Position:  [4.17931768]


portfolio before change:  [3.56109856]
curr_Stock_Price:  98.7687646148693
curr_Factors:  [98.76876461 -0.88229723 -0.94555388]
mat_Sqrt:  [[15.87793313  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00493868 -0.01995509 -0.1312861 ]
Stock Position:  -0.00493867786348204
Bond Position:  [4.04888567]


portfolio before change:  [3.55852966]
curr_Stock_Price:  99.3914104609793
curr_Factors:  [99.39141046 -1.02088978 -0.94874111]
mat_Sqrt:  [[13.86593074  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00371402  0.04752423  0.35223738]
Stock Position:  -0.0037140222944320954
Bond Position:  [3.92767157]


portfolio before change:  [3.56038443]
curr_Stock_Price:  99.02421274938742
curr_Factors:  [99.02421275 -1.22964079 -0.96270794]
mat_Sqrt:  [[11.05646875  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01338344 0.02211308 0.39117894]
Stock Position:  0.013383437592689316
Bond Position:  [2.23510006]


portfolio before change:  [3.5718335]
curr_Stock_Price:  99.85880133969742
curr_Factors:  [99.85880134 -1.24461269 -0.97882408]
mat_Sqrt:  [[10.80836564  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01045042 -0.01240873  0.12637289]
Stock Position:  0.010450420922963478
Bond Position:  [2.52826699]


portfolio before change:  [3.56833979]
curr_Stock_Price:  99.49424578385555
curr_Factors:  [99.49424578 -1.47493421 -0.99087451]
mat_Sqrt:  [[ 8.45105331  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0011696  -0.01089026 -0.0135833 ]
Stock Position:  -0.001169595192018152
Bond Position:  [3.68470778]


portfolio before change:  [3.56923109]
curr_Stock_Price:  99.1260109332433
curr_Factors:  [99.12601093 -1.25475998 -1.01583307]
mat_Sqrt:  [[10.23485274  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01406814 -0.01987027  0.40659324]
Stock Position:  0.01406813984628786
Bond Position:  [2.17471251]


portfolio before change:  [3.57299341]
curr_Stock_Price:  99.37412217037671
curr_Factors:  [99.37412217 -1.17150223 -1.00648933]
mat_Sqrt:  [[11.25598724  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00100736 -0.02670272  0.51652441]
Stock Position:  0.0010073563028720198
Bond Position:  [3.47288827]


portfolio before change:  [3.57332365]
curr_Stock_Price:  99.27097762819969
curr_Factors:  [99.27097763 -1.12761329 -1.01629821]
mat_Sqrt:  [[11.63411535  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-7.21796899e-03 -1.89925043e-04 -2.35164216e-01]
Stock Position:  -0.007217968988392022
Bond Position:  [4.28985849]


portfolio before change:  [3.5688617]
curr_Stock_Price:  99.96344522774015
curr_Factors:  [99.96344523 -0.86462872 -1.04095186]
mat_Sqrt:  [[14.86818941  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00895724  0.02462868  0.20044489]
Stock Position:  -0.008957240298887162
Bond Position:  [4.4642583]


portfolio before change:  [3.57746944]
curr_Stock_Price:  99.06476758003446
curr_Factors:  [99.06476758 -0.79502835 -1.05696167]
mat_Sqrt:  [[15.54569627  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-2.55779448e-04 -4.05296143e-02  2.70229333e-01]
Stock Position:  -0.00025577944777117884
Bond Position:  [3.60280818]


portfolio before change:  [3.57765739]
curr_Stock_Price:  100.09076322450022
curr_Factors:  [100.09076322  -0.51902526  -1.07803383]
mat_Sqrt:  [[20.26749381  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00097201  0.01581211 -0.10096355]
Stock Position:  -0.0009720052266309246
Bond Position:  [3.67494614]


portfolio before change:  [3.57716274]
curr_Stock_Price:  101.07228929596378
curr_Factors:  [101.0722893   -0.32512593  -1.08182234]
mat_Sqrt:  [[24.75154045  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00173261  0.02328151  0.08378082]
Stock Position:  -0.0017326118386396013
Bond Position:  [3.75228179]


portfolio before change:  [3.57873067]
curr_Stock_Price:  100.4380668997663
curr_Factors:  [100.4380669   -0.20445325  -1.08116799]
mat_Sqrt:  [[27.76899345  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00175164 -0.01624465  0.13373231]
Stock Position:  0.0017516379964864369
Bond Position:  [3.40279953]


portfolio before change:  [3.57789819]
curr_Stock_Price:  99.71996714999239
curr_Factors:  [99.71996715 -0.20962911 -1.07325421]
mat_Sqrt:  [[27.64604292  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-3.80105237e-05  2.39520085e-03 -3.48870443e-01]
Stock Position:  -3.801052372007052e-05
Bond Position:  [3.5816886]


portfolio before change:  [3.57846858]
curr_Stock_Price:  96.49342152573487
curr_Factors:  [96.49342153 -0.14614587 -1.04951719]
mat_Sqrt:  [[29.18957955  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00213103 0.01896765 0.05668115]
Stock Position:  0.002131028203926689
Bond Position:  [3.37283837]


portfolio before change:  [3.57610019]
curr_Stock_Price:  95.18418475715903
curr_Factors:  [95.18418476 -0.12735431 -1.02453852]
mat_Sqrt:  [[30.0818191   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00165217 -0.02995842 -0.16449504]
Stock Position:  0.0016521727364401009
Bond Position:  [3.41883947]


portfolio before change:  [3.57222439]
curr_Stock_Price:  92.57962999148539
curr_Factors:  [92.57962999  0.15761414 -1.05487363]
mat_Sqrt:  [[37.74336315  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00914521 -0.04747113  0.09725579]
Stock Position:  0.009145214031131905
Bond Position:  [2.72556386]


portfolio before change:  [3.58852848]
curr_Stock_Price:  94.3251732231026
curr_Factors:  [94.32517322  0.32542381 -1.03644737]
mat_Sqrt:  [[46.32698139  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0007086  -0.02295387  0.08203187]
Stock Position:  -0.0007085990266684925
Bond Position:  [3.6553672]


portfolio before change:  [3.58826384]
curr_Stock_Price:  95.34350006123724
curr_Factors:  [95.34350006  0.26087173 -1.05359821]
mat_Sqrt:  [[43.15333404  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00508487  0.05615642  0.043818  ]
Stock Position:  -0.005084869281786709
Bond Position:  [4.07307308]


portfolio before change:  [3.58860591]
curr_Stock_Price:  95.37636111121878
curr_Factors:  [95.37636111  0.36363293 -1.04603211]
mat_Sqrt:  [[48.20349721  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.0053749  0.01186956 0.05658698]
Stock Position:  0.0053749014449469565
Bond Position:  [3.07596737]


portfolio before change:  [3.58062159]
curr_Stock_Price:  93.81933871568856
curr_Factors:  [ 9.38193387e+01  9.14993653e-02 -1.04545657e+00]
mat_Sqrt:  [[36.14048858  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 3.71313239e-05 -8.02994618e-04 -3.01239680e-01]
Stock Position:  3.7131323863145456e-05
Bond Position:  [3.57713795]


portfolio before change:  [3.58099582]
curr_Stock_Price:  91.8548868002583
curr_Factors:  [91.8548868  -0.12513129 -1.05830272]
mat_Sqrt:  [[28.1282949   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-8.91467614e-05  2.16094023e-02 -8.13565772e-03]
Stock Position:  -8.91467613660417e-05
Bond Position:  [3.58918438]


portfolio before change:  [3.58135038]
curr_Stock_Price:  92.91059609366974
curr_Factors:  [92.91059609 -0.11880114 -1.06957406]
mat_Sqrt:  [[28.31134198  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00959545 -0.11791352 -0.25239159]
Stock Position:  0.009595447857529313
Bond Position:  [2.6898316]


portfolio before change:  [3.6016975]
curr_Stock_Price:  94.99605010555196
curr_Factors:  [94.99605011 -0.34980062 -1.060635  ]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [3.6016975]
Stock Price:  95.10277150427483
PL:  [3.6016975]
Settle:  Tensor("sub_212:0", shape=(), dtype=float64)
PL:  Tensor("sub_213:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  107
output_Z_Vals[:, i, :]:  [[ 1.19260232e+02 -2.92559343e+01 -2.92733494e+01]
 [ 4.67835251e-03 -1.03512675e-01 -3.61442052e-02]
 [ 1.86308685e-02  1.20173059e-02 -2.58744524e-02]
 [ 8.61841528e-02  1.81378213e-01  3.81043790e-02]
 [ 2.23483029e-01 -2.37645678e-02 -4.62616577e-02]
 [ 4.40504480e-02  3.23908481e-02  3.67234781e-02]
 [ 1.44803057e-02  6.27448504e-02 -3.10319750e-02]
 [-1.24136020e-01  2.43458827e-01  7.27730856e-03]
 [-1.70251450e-02  2.29015128e-02  1.35790630e-02]
 [-7.82396581e-02  4.17384684e-01  2.00256257e-01]
 [ 5.43771371e-02  3.55792903e-02 -7.50763929e-02]
 [-5.41197983e-02  8.87429277e-02  9.85281203e-03]
 [-1.02063730e-01  2.75169576e-02 -5.15197212e-02]
 [ 9.22891939e-02  1.13192913e-01  2.04719573e-01]
 [ 2.35759959e-01  3.63850775e-01  1.14955438e-01]
 [-6.23005198e-02 -5.19761523e-02 -1.08391940e-01]
 [-8.32096890e-02 -3.27972747e-03 -8.88545770e-02]
 [ 7.06145472e-02 -1.85043714e-01 -1.22123299e-01]
 [ 3.51809081e-02  5.80197149e-02  3.03455336e-02]
 [ 2.99715294e-01 -1.94182865e-01 -5.41809486e-02]
 [ 7.04205758e-02 -4.67802303e-03  1.23552164e-01]
 [ 2.34063684e-03 -7.06112790e-03  2.14274987e-03]
 [-9.71493495e-02  2.05835153e-01  1.47419932e-01]
 [ 1.97561594e-01 -8.48651569e-02  8.03881760e-02]
 [-5.28374620e-02 -1.21044345e-02 -3.67428394e-02]
 [ 1.05741850e-01 -4.83200363e-03  5.64599242e-02]
 [-9.99359294e-02  7.58605199e-02  9.48881682e-02]
 [-5.07806065e-02  7.36225950e-02  2.93687317e-02]
 [ 6.20848838e-02 -6.23725319e-02  9.08311027e-02]
 [-5.88359714e-02 -1.15943762e-01 -2.63370510e-02]
 [-8.39253068e-02  4.88245120e-01 -4.09433640e-03]
 [ 3.98704096e-02 -6.60557328e-02  1.41723989e-02]
 [ 6.57393731e-02 -5.83350390e-02  2.61230245e-02]
 [-1.68625745e-01 -2.52580445e-02  4.02736201e-02]
 [-7.97486369e-02  8.95036921e-02  2.47940585e-02]
 [ 8.47165236e-02 -1.65012150e-01 -1.38726811e-01]
 [-2.57222488e-01 -4.52973867e-01  1.09550982e-01]
 [-4.94142212e-02 -4.12613851e-02  5.46695239e-02]
 [-3.15701226e-02  6.79417420e-02 -2.86637463e-02]
 [ 1.64093272e-01 -9.46426980e-03 -1.58922652e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.26023247 -29.25593426 -29.27334937]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  8.31486419  -9.25153874 -83.50871763]
init_Out:  [2.49911038]
Stock Position:  8.31486419409362
Bond position:  [-828.98730903]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [2.05461506]
curr_Stock_Price:  99.95900529150273
curr_Factors:  [99.95900529 -0.97740739 -0.9993966 ]
mat_Sqrt:  [[13.8454432   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00038801 -0.03273358 -0.10310936]
Stock Position:  -0.00038801490081695434
Bond Position:  [2.09340064]


portfolio before change:  [2.05446958]
curr_Stock_Price:  101.00837441281568
curr_Factors:  [101.00837441  -1.1909997   -0.96784321]
mat_Sqrt:  [[11.66228955  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00117126  0.00380021 -0.07381261]
Stock Position:  0.0011712583033366137
Bond Position:  [1.93616268]


portfolio before change:  [2.05454979]
curr_Stock_Price:  100.87021339547886
curr_Factors:  [100.8702134   -1.20498913  -0.94174378]
mat_Sqrt:  [[11.78823226  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00836812 0.05735683 0.10870119]
Stock Position:  0.00836811998419093
Bond Position:  [1.21045574]


portfolio before change:  [2.05656241]
curr_Stock_Price:  101.09264122389914
curr_Factors:  [101.09264122  -1.34328273  -0.9595367 ]
mat_Sqrt:  [[10.10689544  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0211169  -0.00751502 -0.13197163]
Stock Position:  0.021116900836992778
Bond Position:  [-0.07820087]


portfolio before change:  [2.06740959]
curr_Stock_Price:  101.6067768695919
curr_Factors:  [101.60677687  -1.06264754  -0.947505  ]
mat_Sqrt:  [[13.6120809   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00384827 0.01024289 0.10476186]
Stock Position:  0.0038482672189466462
Bond Position:  [1.67639956]


portfolio before change:  [2.06765193]
curr_Stock_Price:  101.61529482837228
curr_Factors:  [101.61529483  -1.08880659  -0.95035357]
mat_Sqrt:  [[13.22400715  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00073851  0.01984166 -0.08852559]
Stock Position:  0.0007385050002443435
Bond Position:  [1.99260852]


portfolio before change:  [2.0674104]
curr_Stock_Price:  100.95095001183871
curr_Factors:  [100.95095001  -0.96224519  -0.94126028]
mat_Sqrt:  [[15.04625746  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00773378  0.07698844  0.02076014]
Stock Position:  -0.007733781399851994
Bond Position:  [2.84814298]


portfolio before change:  [2.05815652]
curr_Stock_Price:  102.19354002375843
curr_Factors:  [102.19354002  -0.98091035  -0.97782854]
mat_Sqrt:  [[14.41298569  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0009479   0.00724209  0.03873729]
Stock Position:  -0.0009478963029964552
Bond Position:  [2.1550254]


portfolio before change:  [2.059102]
curr_Stock_Price:  101.48028834757643
curr_Factors:  [101.48028835  -1.12028483  -0.95772082]
mat_Sqrt:  [[12.70326352  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00209282  0.13198863  0.57127536]
Stock Position:  -0.002092823979725076
Bond Position:  [2.27148238]


portfolio before change:  [2.05941721]
curr_Stock_Price:  101.46535601657783
curr_Factors:  [101.46535602  -1.2694355   -0.94452788]
mat_Sqrt:  [[11.08678708  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00360527  0.01125116 -0.21417205]
Stock Position:  0.0036052722599561964
Bond Position:  [1.69360697]


portfolio before change:  [2.06037707]
curr_Stock_Price:  101.67287120883633
curr_Factors:  [101.67287121  -1.32924214  -0.950305  ]
mat_Sqrt:  [[10.40423954  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00478817  0.02806298  0.02810733]
Stock Position:  -0.0047881701267349745
Bond Position:  [2.54720407]


portfolio before change:  [2.0606794]
curr_Stock_Price:  101.67623039313905
curr_Factors:  [101.67623039  -1.46627025  -0.94100269]
mat_Sqrt:  [[ 9.15701826  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01221682  0.00870163 -0.14697142]
Stock Position:  -0.012216822193271026
Bond Position:  [3.30283983]


portfolio before change:  [2.06154713]
curr_Stock_Price:  101.63899970854149
curr_Factors:  [101.63899971  -1.52841113  -0.96927207]
mat_Sqrt:  [[ 8.36238871  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01638288 0.03579474 0.58400796]
Stock Position:  0.016382882326169915
Bond Position:  [0.39640735]


portfolio before change:  [2.06270477]
curr_Stock_Price:  101.70663677611273
curr_Factors:  [101.70663678  -1.38833767  -0.97706713]
mat_Sqrt:  [[ 9.55140021  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.0281236  0.11505972 0.32793587]
Stock Position:  0.028123596557254615
Bond Position:  [-0.79765165]


portfolio before change:  [2.08846311]
curr_Stock_Price:  102.62608010931177
curr_Factors:  [102.62608011  -1.5307958   -0.98636363]
mat_Sqrt:  [[ 8.28074273  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01035752 -0.0164363  -0.30921203]
Stock Position:  -0.010357519016981358
Bond Position:  [3.15141469]


portfolio before change:  [2.08422453]
curr_Stock_Price:  103.07334288789629
curr_Factors:  [103.07334289  -1.3694525   -1.00828358]
mat_Sqrt:  [[ 9.56111862  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01060877 -0.00103714 -0.25347738]
Stock Position:  -0.010608772863177419
Bond Position:  [3.17770621]


portfolio before change:  [2.07564486]
curr_Stock_Price:  103.91952094754451
curr_Factors:  [103.91952095  -1.05395125  -1.02179383]
mat_Sqrt:  [[13.03804581  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00313762 -0.05851596 -0.34838378]
Stock Position:  0.003137619362681493
Bond Position:  [1.74958496]


portfolio before change:  [2.07885828]
curr_Stock_Price:  104.87397404317835
curr_Factors:  [104.87397404  -1.03844927  -1.03893718]
mat_Sqrt:  [[13.13621515  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00326374 0.01834744 0.08656736]
Stock Position:  0.003263742739414219
Bond Position:  [1.73657661]


portfolio before change:  [2.07774232]
curr_Stock_Price:  104.46553411548128
curr_Factors:  [104.46553412  -1.66073842  -1.04564942]
mat_Sqrt:  [[ 6.97595586  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.04065993 -0.06140601 -0.15456317]
Stock Position:  0.04065992960092371
Bond Position:  [-2.16981894]


portfolio before change:  [2.08863306]
curr_Stock_Price:  104.74005466203444
curr_Factors:  [104.74005466  -1.73600853  -1.02919908]
mat_Sqrt:  [[ 6.59475077  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01448421 -0.00147932  0.35245993]
Stock Position:  0.014484212180527785
Bond Position:  [0.57155589]


portfolio before change:  [2.08924284]
curr_Stock_Price:  104.77722118324576
curr_Factors:  [104.77722118  -1.76062622  -1.03428047]
mat_Sqrt:  [[ 6.40404425  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00040532 -0.00223292  0.00611267]
Stock Position:  0.00040532297837532716
Bond Position:  [2.04677422]


portfolio before change:  [2.08944497]
curr_Stock_Price:  104.64466534204692
curr_Factors:  [104.64466534  -1.40928912  -1.00432737]
mat_Sqrt:  [[ 9.36476255  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00659309  0.06509079  0.42054803]
Stock Position:  -0.006593091994401329
Bond Position:  [2.77937688]


portfolio before change:  [2.08437916]
curr_Stock_Price:  105.46571568790407
curr_Factors:  [105.46571569  -1.42817381  -0.99074219]
mat_Sqrt:  [[ 9.38835343  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.02255769 -0.02683672  0.22932509]
Stock Position:  0.022557688589628724
Bond Position:  [-0.29468361]


portfolio before change:  [2.08934834]
curr_Stock_Price:  105.68763635306041
curr_Factors:  [105.68763635  -1.3115787   -0.98628337]
mat_Sqrt:  [[10.61879828  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00571158 -0.00382776 -0.10481709]
Stock Position:  -0.005711578295988818
Bond Position:  [2.69299155]


portfolio before change:  [2.08533624]
curr_Stock_Price:  106.4490264491347
curr_Factors:  [106.44902645  -1.19784289  -0.99651391]
mat_Sqrt:  [[11.86163747  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0098757  -0.00152801  0.16106445]
Stock Position:  0.009875695680981674
Bond Position:  [1.03407805]


portfolio before change:  [2.08342743]
curr_Stock_Price:  106.24265270190271
curr_Factors:  [106.2426527   -1.13783528  -0.99376208]
mat_Sqrt:  [[12.60543775  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00623606  0.0239892   0.27068953]
Stock Position:  -0.006236058957477977
Bond Position:  [2.74596287]


portfolio before change:  [2.07648804]
curr_Stock_Price:  107.41048291182564
curr_Factors:  [107.41048291  -1.12048848  -1.0133925 ]
mat_Sqrt:  [[12.71492882  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00337279  0.02328151  0.08378082]
Stock Position:  -0.0033727921405574414
Bond Position:  [2.43876127]


portfolio before change:  [2.07834307]
curr_Stock_Price:  106.95087182657
curr_Factors:  [106.95087183  -1.05363117  -1.04706909]
mat_Sqrt:  [[13.08765383  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00603739 -0.01972393  0.25911585]
Stock Position:  0.006037388688159883
Bond Position:  [1.43263909]


portfolio before change:  [2.07851669]
curr_Stock_Price:  106.94996488405664
curr_Factors:  [106.94996488  -1.02234464  -1.03974076]
mat_Sqrt:  [[13.60280079  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00494057 -0.03666464 -0.07513228]
Stock Position:  -0.004940574778715127
Bond Position:  [2.60691099]


portfolio before change:  [2.08317345]
curr_Stock_Price:  106.07337134853991
curr_Factors:  [106.07337135  -0.94769397  -1.04876021]
mat_Sqrt:  [[14.40646209  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00500849  0.15439666 -0.01168   ]
Stock Position:  -0.005008490250732102
Bond Position:  [2.61444089]


portfolio before change:  [2.08467009]
curr_Stock_Price:  105.83980539379147
curr_Factors:  [105.83980539  -0.93129439  -1.03762621]
mat_Sqrt:  [[14.77602718  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00277868 -0.02088866  0.04042991]
Stock Position:  0.002778675636047034
Bond Position:  [1.7905756]


portfolio before change:  [2.08550738]
curr_Stock_Price:  106.06057957355496
curr_Factors:  [106.06057957  -1.1802696   -1.03608889]
mat_Sqrt:  [[11.56116857  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00601717 -0.01844716  0.07452172]
Stock Position:  0.006017169327187467
Bond Position:  [1.44732292]


portfolio before change:  [2.08844796]
curr_Stock_Price:  106.51920967244068
curr_Factors:  [106.51920967  -1.33102753  -1.05256919]
mat_Sqrt:  [[ 9.8230201   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01639588 -0.00798729  0.11488943]
Stock Position:  -0.016395882863165564
Bond Position:  [3.83492445]


portfolio before change:  [2.09118124]
curr_Stock_Price:  106.38174362274789
curr_Factors:  [106.38174362  -1.39210448  -1.03849983]
mat_Sqrt:  [[ 9.35985378  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00773266  0.02830355  0.07073055]
Stock Position:  -0.007732663061699482
Bond Position:  [2.91379542]


portfolio before change:  [2.09250563]
curr_Stock_Price:  106.2575755796907
curr_Factors:  [106.25757558  -1.48029526  -1.0263275 ]
mat_Sqrt:  [[ 8.66457909  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00601742 -0.05218142 -0.39574898]
Stock Position:  0.0060174228835395
Bond Position:  [1.45310887]


portfolio before change:  [2.0918409]
curr_Stock_Price:  106.11691971514041
curr_Factors:  [106.11691972  -1.57577981  -1.05192532]
mat_Sqrt:  [[ 7.66631742  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.03216097 -0.14324291  0.31251846]
Stock Position:  -0.03216097231102464
Bond Position:  [5.50466421]


portfolio before change:  [2.09281076]
curr_Stock_Price:  106.10815937390237
curr_Factors:  [106.10815937  -1.51498031  -1.04260366]
mat_Sqrt:  [[ 8.22250551  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00478202 -0.013048    0.15595693]
Stock Position:  -0.0047820236437728985
Bond Position:  [2.60022249]


portfolio before change:  [2.09307766]
curr_Stock_Price:  106.12031961765376
curr_Factors:  [106.12031962  -1.38205162  -1.04326757]
mat_Sqrt:  [[ 9.38632973  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00379987  0.02148507 -0.08176969]
Stock Position:  -0.0037998704585621395
Bond Position:  [2.49632113]


portfolio before change:  [2.09380023]
curr_Stock_Price:  106.0122882113351
curr_Factors:  [106.01228821  -1.59272704  -1.06520352]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [2.09380023]
Stock Price:  106.27229287671962
PL:  [-4.17849265]
Settle:  Tensor("sub_214:0", shape=(), dtype=float64)
PL:  Tensor("sub_215:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  108
output_Z_Vals[:, i, :]:  [[ 1.19260232e+02 -2.92559343e+01 -2.92733494e+01]
 [-7.56376946e-02  1.72091456e-01  1.96180100e-02]
 [-2.99389038e-02 -3.52105687e-02 -3.16601789e-02]
 [ 2.61413913e-02  1.22942217e-01  2.71523487e-02]
 [ 1.56705726e-02  3.77835360e-02 -7.16733288e-02]
 [ 5.66471353e-02  2.88285358e-02  3.20897688e-02]
 [ 2.08630548e-02  4.87845077e-02  3.03405622e-03]
 [-8.08070743e-02  2.23516580e-02 -8.32540997e-02]
 [ 1.22244221e-01 -1.75064031e-02 -7.82147872e-02]
 [-7.43406818e-02  3.80430427e-01  1.76440261e-01]
 [ 9.70734559e-02  9.18972484e-02 -4.21371453e-02]
 [-1.87453509e-01 -9.33720760e-02  3.50001420e-02]
 [ 2.01166477e-02 -9.72482750e-02  1.13843997e-01]
 [-1.34500984e-01 -1.30033424e-01  1.16062258e-02]
 [ 1.92818262e-01  2.81259638e-01  7.68562493e-02]
 [-6.18968793e-02 -4.02913083e-01 -5.68123299e-02]
 [-6.82205592e-02  1.23171253e-02 -7.17944971e-02]
 [ 2.09846070e-02  9.47878841e-02 -7.37925516e-02]
 [-3.04502260e-02  4.93366814e-02 -8.46747407e-02]
 [-5.62412840e-02 -2.25332755e-02  1.31776042e-01]
 [ 1.62608579e-01 -1.48397869e-01  9.14514834e-02]
 [ 1.11887474e-01  1.93915590e-01  3.44008286e-01]
 [-4.67716916e-02 -5.35330830e-03  2.44519235e-01]
 [-5.83501037e-02 -8.09576447e-04 -8.49938991e-02]
 [-4.63592409e-01  1.39490796e-01  7.55900192e-02]
 [-1.01432744e-01 -2.19568018e-01  1.20819353e-01]
 [ 9.40388503e-02  6.07233408e-02 -6.90082465e-02]
 [ 3.09299597e-02 -7.31690274e-03  4.49397773e-03]
 [-1.25763270e-01 -1.78400468e-01 -8.61923229e-02]
 [ 1.39292022e-01  1.69588112e-01  1.35273620e-02]
 [ 1.68637692e-02  1.74098696e-01  1.19065990e-02]
 [ 1.57467561e-02 -7.68626560e-02 -9.12938101e-02]
 [ 8.25936128e-02 -4.02436002e-02  6.56955441e-02]
 [-5.17356882e-02 -8.71453834e-02 -1.22696622e-02]
 [-1.67785388e-01  1.56846804e-01  3.24216323e-02]
 [ 8.47165236e-02 -1.65012150e-01 -1.38726811e-01]
 [-1.86139950e-01 -3.09827446e-01  4.17385810e-02]
 [-4.50229253e-02 -2.63182262e-02  3.30835738e-02]
 [-3.65020225e-02  7.82845035e-02 -2.55692024e-02]
 [ 9.99534688e-02 -4.51173625e-03 -9.06157126e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.26023247 -29.25593426 -29.27334937]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  8.31486419  -9.25153874 -83.50871763]
init_Out:  [2.49911038]
Stock Position:  8.31486419409362
Bond position:  [-828.98730903]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [8.22705236]
curr_Stock_Price:  100.70134300911981
curr_Factors:  [100.70134301  -1.07753384  -1.00489585]
mat_Sqrt:  [[12.55011021  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00535372  0.0544201   0.05596472]
Stock Position:  -0.005353722130966399
Bond Position:  [8.76617937]


portfolio before change:  [8.22830746]
curr_Stock_Price:  100.67159708835902
curr_Factors:  [100.67159709  -1.0544255   -1.02692599]
mat_Sqrt:  [[12.55993779  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00297061 -0.01113456 -0.09031768]
Stock Position:  -0.0029706073661676866
Bond Position:  [8.52736324]


portfolio before change:  [8.23139202]
curr_Stock_Price:  99.99208216372409
curr_Factors:  [99.99208216 -0.68437591 -1.02822252]
mat_Sqrt:  [[18.03821528  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00193246 0.03887774 0.07745809]
Stock Position:  0.0019324636659202444
Bond Position:  [8.03816095]


portfolio before change:  [8.22958574]
curr_Stock_Price:  98.53740770948045
curr_Factors:  [98.53740771 -0.52234079 -1.00917366]
mat_Sqrt:  [[21.30457426  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 9.46220449e-05  1.19482032e-02 -2.04464057e-01]
Stock Position:  9.462204487410299e-05
Bond Position:  [8.22026193]


portfolio before change:  [8.23052951]
curr_Stock_Price:  97.65142582259811
curr_Factors:  [97.65142582 -0.36609345 -1.01005926]
mat_Sqrt:  [[24.66170289  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00259276 0.00911638 0.09154318]
Stock Position:  0.002592756135245077
Bond Position:  [7.97734317]


portfolio before change:  [8.22973346]
curr_Stock_Price:  96.95977687671162
curr_Factors:  [96.95977688 -0.68611506 -1.01324579]
mat_Sqrt:  [[17.72427857  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.0012831  0.01542702 0.00865532]
Stock Position:  0.001283098176178318
Bond Position:  [8.10532455]


portfolio before change:  [8.23213174]
curr_Stock_Price:  98.03923815543641
curr_Factors:  [98.03923816 -0.516671   -1.01887648]
mat_Sqrt:  [[21.11155064  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00460526  0.00706821 -0.23750077]
Stock Position:  -0.004605257595518933
Bond Position:  [8.68362769]


portfolio before change:  [8.22679222]
curr_Stock_Price:  99.434393343235
curr_Factors:  [99.43439334 -0.44729285 -1.00563754]
mat_Sqrt:  [[23.25610496  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00455049 -0.00553601 -0.22312502]
Stock Position:  0.0045504903240705386
Bond Position:  [7.77431697]


portfolio before change:  [8.22989077]
curr_Stock_Price:  99.9017503635971
curr_Factors:  [99.90175036 -0.22677307 -1.00991839]
mat_Sqrt:  [[29.00579816  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00098264  0.12030266  0.50333495]
Stock Position:  -0.0009826412230692846
Bond Position:  [8.32805835]


portfolio before change:  [8.23287503]
curr_Stock_Price:  97.92423314197042
curr_Factors:  [97.92423314 -0.11428128 -1.00112764]
mat_Sqrt:  [[32.09772433  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00283026  0.02906046 -0.12020555]
Stock Position:  0.0028302636951392894
Bond Position:  [7.95572363]


portfolio before change:  [8.2307965]
curr_Stock_Price:  96.83844694187306
curr_Factors:  [96.83844694  0.10936226 -0.99468207]
mat_Sqrt:  [[39.95381971  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00457328 -0.02952684  0.09984566]
Stock Position:  -0.004573279684469871
Bond Position:  [8.6736658]


portfolio before change:  [8.2377616]
curr_Stock_Price:  95.55253717245597
curr_Factors:  [ 9.55525372e+01 -6.23456457e-02 -9.78519933e-01]
mat_Sqrt:  [[33.74427066  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0012104  -0.0307526   0.32476523]
Stock Position:  0.0012103985568999664
Bond Position:  [8.12210495]


portfolio before change:  [8.23847748]
curr_Stock_Price:  95.30514580857182
curr_Factors:  [95.30514581 -0.12075092 -0.97233609]
mat_Sqrt:  [[31.94439692  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00424141 -0.04112018  0.03310933]
Stock Position:  -0.004241411169532043
Bond Position:  [8.64270579]


portfolio before change:  [8.23457879]
curr_Stock_Price:  96.47907047374474
curr_Factors:  [96.47907047 -0.5374418  -0.98254905]
mat_Sqrt:  [[21.10131258  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01022536 0.08894211 0.21924949]
Stock Position:  0.010225362509792675
Bond Position:  [7.24804532]


portfolio before change:  [8.24936762]
curr_Stock_Price:  97.8367498950903
curr_Factors:  [97.8367499  -0.5895073  -0.98578036]
mat_Sqrt:  [[20.24712101  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00414364 -0.1274123  -0.16206976]
Stock Position:  -0.004143641883245745
Bond Position:  [8.65476807]


portfolio before change:  [8.25895159]
curr_Stock_Price:  95.78491691843917
curr_Factors:  [95.78491692 -0.42680578 -0.94452828]
mat_Sqrt:  [[24.30716533  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00339643  0.00389502 -0.20480972]
Stock Position:  -0.0033964274181482587
Bond Position:  [8.58427811]


portfolio before change:  [8.25777439]
curr_Stock_Price:  96.44746653943825
curr_Factors:  [96.44746654 -0.59117855 -0.95608365]
mat_Sqrt:  [[20.52690094  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00040772  0.02997456 -0.21050961]
Stock Position:  0.0004077175685148801
Bond Position:  [8.21845107]


portfolio before change:  [8.25876865]
curr_Stock_Price:  96.36624935595628
curr_Factors:  [96.36624936 -0.86988312 -0.97662158]
mat_Sqrt:  [[15.20541071  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00305553  0.01560163 -0.24155347]
Stock Position:  -0.003055525323856961
Bond Position:  [8.55321817]


portfolio before change:  [8.26314793]
curr_Stock_Price:  95.28294541445841
curr_Factors:  [95.28294541 -0.62164679 -1.0024073 ]
mat_Sqrt:  [[18.7800803   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00159341 -0.00712565  0.37592037]
Stock Position:  -0.0015934127084424132
Bond Position:  [8.41497299]


portfolio before change:  [8.26467111]
curr_Stock_Price:  94.98720209606283
curr_Factors:  [94.9872021  -0.64284137 -0.96662764]
mat_Sqrt:  [[18.99684949  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00934073 -0.04692753  0.26088563]
Stock Position:  0.009340728770208702
Bond Position:  [7.37742142]


portfolio before change:  [8.26363707]
curr_Stock_Price:  94.77776737615397
curr_Factors:  [94.77776738 -0.69485607 -0.97555159]
mat_Sqrt:  [[17.83436466  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01049181 0.06132149 0.98135989]
Stock Position:  0.010491809136575853
Bond Position:  [7.26924683]


portfolio before change:  [8.25818022]
curr_Stock_Price:  94.17104992871006
curr_Factors:  [94.17104993 -0.7352146  -0.95725308]
mat_Sqrt:  [[17.33357086  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 1.73211075e-04 -1.69286473e-03  6.97545317e-01]
Stock Position:  0.00017321107524624383
Bond Position:  [8.24186875]


portfolio before change:  [8.25925171]
curr_Stock_Price:  94.40886405987374
curr_Factors:  [94.40886406 -0.47168562 -0.94988388]
mat_Sqrt:  [[22.78415789  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00332338 -0.00025601 -0.24246394]
Stock Position:  -0.003323375578701885
Bond Position:  [8.57300783]


portfolio before change:  [8.25404134]
curr_Stock_Price:  96.29913157518624
curr_Factors:  [96.29913158 -0.57069874 -0.96081541]
mat_Sqrt:  [[20.82064724  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02135193  0.04411086  0.21563728]
Stock Position:  -0.02135193102056919
Bond Position:  [10.31021375]


portfolio before change:  [8.26015804]
curr_Stock_Price:  96.0730234715286
curr_Factors:  [96.07302347 -0.29900568 -0.93082359]
mat_Sqrt:  [[28.08622661  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00293524 -0.0694335   0.34466398]
Stock Position:  -0.002935240108769048
Bond Position:  [8.54215543]


portfolio before change:  [8.26281622]
curr_Stock_Price:  95.5312133851331
curr_Factors:  [95.53121339 -0.17384652 -0.91929889]
mat_Sqrt:  [[32.01830015  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00254606  0.01920241 -0.19686132]
Stock Position:  0.002546058675992602
Bond Position:  [8.01958814]


portfolio before change:  [8.26108698]
curr_Stock_Price:  94.4582829777363
curr_Factors:  [ 9.44582830e+01 -8.11334031e-02 -8.99361924e-01]
mat_Sqrt:  [[35.43368638  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00089345 -0.00231381  0.01282007]
Stock Position:  0.0008934539607692095
Bond Position:  [8.17669286]


portfolio before change:  [8.26175578]
curr_Stock_Price:  94.06278985958517
curr_Factors:  [ 9.40627899e+01  3.60403282e-02 -8.96581139e-01]
mat_Sqrt:  [[39.7822855   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00371933 -0.05641518 -0.24588271]
Stock Position:  -0.003719330911305056
Bond Position:  [8.61160642]


portfolio before change:  [8.25174842]
curr_Stock_Price:  97.04286275773254
curr_Factors:  [97.04286276  0.19263039 -0.92435215]
mat_Sqrt:  [[46.68537772  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00313657 0.05362847 0.0385898 ]
Stock Position:  0.0031365715984660943
Bond Position:  [7.94736653]


portfolio before change:  [8.25692064]
curr_Stock_Price:  98.37512431976226
curr_Factors:  [98.37512432 -0.11888444 -0.93378359]
mat_Sqrt:  [[34.3334447   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00069289 0.05505484 0.03396621]
Stock Position:  0.0006928929712964664
Bond Position:  [8.18875721]


portfolio before change:  [8.25880288]
curr_Stock_Price:  99.6142529259384
curr_Factors:  [99.61425293 -0.11320621 -0.93270645]
mat_Sqrt:  [[35.00155874  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-1.39225232e-04 -2.43061060e-02 -2.60435829e-01]
Stock Position:  -0.00013922523175443735
Bond Position:  [8.2726717]


portfolio before change:  [8.25976646]
curr_Stock_Price:  100.12114785491885
curr_Factors:  [100.12114785  -0.39069661  -0.92494016]
mat_Sqrt:  [[26.86284661  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00353516 -0.01272614  0.1874111 ]
Stock Position:  0.0035351642240251725
Bond Position:  [7.90582176]


portfolio before change:  [8.2664122]
curr_Stock_Price:  101.7214840994629
curr_Factors:  [101.7214841   -0.53124632  -0.95204168]
mat_Sqrt:  [[23.07963273  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00244763 -0.02755779 -0.03500193]
Stock Position:  -0.0024476258911537026
Bond Position:  [8.51538834]


portfolio before change:  [8.26441251]
curr_Stock_Price:  102.97338228771864
curr_Factors:  [102.97338229  -0.5547603   -0.95996091]
mat_Sqrt:  [[22.64070358  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00693961  0.04959931  0.09248989]
Stock Position:  -0.006939606902234065
Bond Position:  [8.9790073]


portfolio before change:  [8.26814832]
curr_Stock_Price:  102.59679584884346
curr_Factors:  [102.59679585  -0.72197132  -0.94813333]
mat_Sqrt:  [[19.31152482  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00269986 -0.05218142 -0.39574898]
Stock Position:  0.0026998611955150564
Bond Position:  [7.99115121]


portfolio before change:  [8.27166625]
curr_Stock_Price:  103.52979812068074
curr_Factors:  [103.52979812  -1.02791851  -0.95462999]
mat_Sqrt:  [[14.2578977   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01301874 -0.09797604  0.11906855]
Stock Position:  -0.013018736156670476
Bond Position:  [9.61949338]


portfolio before change:  [8.26575757]
curr_Stock_Price:  104.07602586347521
curr_Factors:  [104.07602586  -1.05953537  -0.92915971]
mat_Sqrt:  [[14.24529347  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00273419 -0.00832255  0.09437823]
Stock Position:  -0.002734187459133836
Bond Position:  [8.55032093]


portfolio before change:  [8.26643365]
curr_Stock_Price:  104.2196773995108
curr_Factors:  [104.2196774   -0.97142927  -0.96117551]
mat_Sqrt:  [[15.08794651  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00263124  0.02475573 -0.07294182]
Stock Position:  -0.0026312405627780186
Bond Position:  [8.5406607]


portfolio before change:  [8.26551715]
curr_Stock_Price:  104.9737535435998
curr_Factors:  [104.97375354  -1.21104704  -0.97767062]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [8.26551715]
Stock Price:  105.71371651991308
PL:  [2.55180063]
Settle:  Tensor("sub_216:0", shape=(), dtype=float64)
PL:  Tensor("sub_217:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  109
output_Z_Vals[:, i, :]:  [[ 1.19260232e+02 -2.92559343e+01 -2.92733494e+01]
 [ 6.96734579e-02 -1.85041417e-01 -1.93158895e-01]
 [-5.04152296e-02  1.36551536e-02  1.01762632e-01]
 [ 1.56587266e-02  1.60411589e-01  2.48825972e-02]
 [ 6.00104254e-02  1.66431758e-02 -5.70016944e-02]
 [ 6.71791553e-02  2.84262615e-02 -8.93759487e-02]
 [ 7.26180275e-02  1.35614946e-02 -6.95406012e-02]
 [-1.09341277e-01 -6.41215265e-02 -1.21102326e-01]
 [-4.36833744e-02 -6.65645125e-02  6.19982308e-02]
 [-7.31048816e-02 -1.26747381e-01 -1.27496804e-01]
 [ 6.91687122e-02  1.16958899e-01 -9.77971992e-02]
 [-2.14905169e-01 -1.03319032e-01  5.16028794e-02]
 [-9.09837923e-02 -2.83670486e-03 -8.01301527e-03]
 [-9.62623594e-02 -1.14884369e-01  6.32126881e-02]
 [ 3.27556089e-01  3.86060247e-01  2.09854265e-02]
 [-5.30852914e-02 -2.82434480e-01 -6.62354609e-02]
 [-6.68999525e-02 -4.88369437e-02 -4.08249890e-02]
 [-6.81607841e-02  1.60212664e-01  1.05302404e-01]
 [ 6.93860890e-02  5.54269054e-02  5.09765750e-02]
 [-3.29645802e-02 -9.01463866e-03  9.83576350e-02]
 [-3.86443609e-02 -1.47013222e-02 -2.04157866e-02]
 [ 9.81211171e-02 -6.33400331e-02  9.68734282e-02]
 [-5.82810625e-02  3.29315237e-02  2.82197462e-01]
 [-5.81298966e-02 -1.53460943e-03 -8.34664039e-02]
 [-3.95275592e-02  5.05784606e-02  9.03209456e-02]
 [-3.38189657e-02 -1.43756577e-01  9.91632900e-02]
 [ 1.84747780e-01  5.71172645e-02 -1.29075277e-01]
 [ 4.23129655e-03  3.30235782e-02  2.06726622e-02]
 [-1.07129694e-01 -1.32535765e-01 -1.35857770e-01]
 [ 1.45935406e-01  1.98304082e-01  6.79600270e-02]
 [ 5.76026834e-02  8.22792309e-03  3.25389729e-02]
 [ 5.14840637e-02 -9.92673523e-02 -7.99724310e-02]
 [ 2.54492051e-01 -1.77440571e-01 -6.15194165e-02]
 [-4.54156770e-02 -8.09754060e-02  5.11667232e-03]
 [-1.78564665e-01  6.39979318e-02  2.04968345e-02]
 [ 7.97762211e-02 -8.95664306e-02 -5.53423421e-02]
 [ 2.56172214e-02  2.88376528e-02 -9.47736335e-02]
 [-2.08331488e-02  1.78417288e-02 -7.67243534e-02]
 [ 1.76662659e-02 -6.58940771e-02  3.89070049e-03]
 [-8.75903955e-01  4.34395192e-01  5.36765688e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.26023247 -29.25593426 -29.27334937]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  8.31486419  -9.25153874 -83.50871763]
init_Out:  [2.49911038]
Stock Position:  8.31486419409362
Bond position:  [-828.98730903]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-4.99746743]
curr_Stock_Price:  99.11087568612224
curr_Factors:  [99.11087569 -1.14132159 -0.98365476]
mat_Sqrt:  [[11.83738601  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00215143 -0.05851523 -0.55102856]
Stock Position:  0.002151430628687095
Bond Position:  [-5.2106976]


portfolio before change:  [-4.99813575]
curr_Stock_Price:  99.10300032809275
curr_Factors:  [99.10300033 -1.16640413 -0.97791385]
mat_Sqrt:  [[11.60970906  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00252293  0.00431814  0.29030046]
Stock Position:  -0.0025229266736106187
Bond Position:  [-4.74810615]


portfolio before change:  [-4.99828705]
curr_Stock_Price:  98.92770776348085
curr_Factors:  [98.92770776 -1.24052003 -1.00144373]
mat_Sqrt:  [[10.51103434  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00236701 0.0507266  0.07098312]
Stock Position:  0.002367005389078716
Bond Position:  [-5.23244947]


portfolio before change:  [-4.99907386]
curr_Stock_Price:  98.87163893398942
curr_Factors:  [98.87163893 -1.52639967 -0.99073291]
mat_Sqrt:  [[ 7.97801676  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0061174   0.00526303 -0.16260997]
Stock Position:  0.006117401055728026
Bond Position:  [-5.60391133]


portfolio before change:  [-4.99870491]
curr_Stock_Price:  99.04646661041546
curr_Factors:  [99.04646661 -1.37577136 -1.00016368]
mat_Sqrt:  [[ 9.20414615  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00539641  0.00898917 -0.2549647 ]
Stock Position:  0.005396408127011037
Bond Position:  [-5.53320006]


portfolio before change:  [-4.99826121]
curr_Stock_Price:  99.25686486421546
curr_Factors:  [99.25686486 -1.2154863  -0.99811659]
mat_Sqrt:  [[10.84938277  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0054172   0.00428852 -0.19837998]
Stock Position:  0.005417199227946639
Bond Position:  [-5.53595542]


portfolio before change:  [-4.99668319]
curr_Stock_Price:  99.6759102267329
curr_Factors:  [99.67591023 -1.32572313 -1.01146808]
mat_Sqrt:  [[ 9.62855167  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01409525 -0.02027701 -0.34547123]
Stock Position:  -0.01409524523912224
Bond Position:  [-3.59172679]


portfolio before change:  [-4.99319561]
curr_Stock_Price:  99.39662629664413
curr_Factors:  [99.3966263  -1.03412447 -0.99839392]
mat_Sqrt:  [[13.02147315  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00251483 -0.02104955  0.1768637 ]
Stock Position:  -0.0025148250511614046
Bond Position:  [-4.74323048]


portfolio before change:  [-4.99030568]
curr_Stock_Price:  98.01169305220087
curr_Factors:  [98.01169305 -0.82429442 -1.03112191]
mat_Sqrt:  [[15.32783505  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00668083 -0.04008104 -0.36371289]
Stock Position:  -0.006680830046016105
Bond Position:  [-4.33550622]


portfolio before change:  [-4.99029148]
curr_Stock_Price:  97.92844355267444
curr_Factors:  [97.92844355 -1.08779027 -1.01469654]
mat_Sqrt:  [[11.96218276  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00436591  0.03698565 -0.27898819]
Stock Position:  0.004365909578732269
Bond Position:  [-5.41783821]


portfolio before change:  [-4.99553712]
curr_Stock_Price:  96.88207061927028
curr_Factors:  [96.88207062 -1.25886806 -0.98317087]
mat_Sqrt:  [[10.29291244  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02011476 -0.03267235  0.14720865]
Stock Position:  -0.02011475975613806
Bond Position:  [-3.04677755]


portfolio before change:  [-4.99672757]
curr_Stock_Price:  96.92231860538944
curr_Factors:  [96.92231861 -1.1670362  -1.00022325]
mat_Sqrt:  [[11.09672886  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00835315 -0.00089704 -0.0228589 ]
Stock Position:  -0.008353154050074892
Bond Position:  [-4.18712051]


portfolio before change:  [-4.99838808]
curr_Stock_Price:  97.05844458436849
curr_Factors:  [97.05844458 -1.07785318 -0.97994482]
mat_Sqrt:  [[12.39775392  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00696299 -0.03632963  0.1803282 ]
Stock Position:  -0.006962989075906569
Bond Position:  [-4.32257119]


portfolio before change:  [-5.00597426]
curr_Stock_Price:  98.07034161979739
curr_Factors:  [98.07034162 -1.01882048 -0.96666793]
mat_Sqrt:  [[13.46638511  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.02538229 0.12208297 0.05986558]
Stock Position:  0.025382294599283643
Bond Position:  [-7.49522456]


portfolio before change:  [-4.99953139]
curr_Stock_Price:  98.36108895032031
curr_Factors:  [98.36108895 -1.13672956 -0.97496127]
mat_Sqrt:  [[11.90495208  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00620733 -0.08931362 -0.18895133]
Stock Position:  -0.006207330749671957
Bond Position:  [-4.38897158]


portfolio before change:  [-4.99851838]
curr_Stock_Price:  98.10950527350457
curr_Factors:  [98.10950527 -0.76860168 -0.95644794]
mat_Sqrt:  [[17.47960276  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0043762  -0.0154436  -0.11646233]
Stock Position:  -0.004376202596216411
Bond Position:  [-4.56917131]


portfolio before change:  [-4.99800326]
curr_Stock_Price:  97.86127532734947
curr_Factors:  [97.86127533 -0.7498377  -0.96113009]
mat_Sqrt:  [[17.68263571  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00240515  0.05066369  0.30039845]
Stock Position:  -0.002405147535481834
Bond Position:  [-4.76263245]


portfolio before change:  [-4.99865293]
curr_Stock_Price:  97.88385623344827
curr_Factors:  [97.88385623 -0.75181707 -0.97177848]
mat_Sqrt:  [[17.46477664  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00465066 0.01752753 0.14542198]
Stock Position:  0.004650660986163038
Bond Position:  [-5.45387757]


portfolio before change:  [-4.99813277]
curr_Stock_Price:  98.1423005088266
curr_Factors:  [98.14230051 -0.79804483 -0.97016326]
mat_Sqrt:  [[16.74685341  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00078344 -0.00285068  0.28058696]
Stock Position:  -0.0007834408421535719
Bond Position:  [-4.92124409]


portfolio before change:  [-5.00015678]
curr_Stock_Price:  99.94054026360752
curr_Factors:  [99.94054026 -0.8487261  -1.01117586]
mat_Sqrt:  [[15.55953216  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00277587 -0.00464897 -0.05824056]
Stock Position:  -0.0027758741059780694
Bond Position:  [-4.72273443]


portfolio before change:  [-5.00046857]
curr_Stock_Price:  99.84017893505559
curr_Factors:  [99.84017894 -0.65958436 -1.02059193]
mat_Sqrt:  [[18.60433106  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00624908 -0.02002988  0.27635293]
Stock Position:  0.006249076620273846
Bond Position:  [-5.6243775]


portfolio before change:  [-5.00060701]
curr_Stock_Price:  99.93053626792627
curr_Factors:  [99.93053627 -0.68341736 -1.02207742]
mat_Sqrt:  [[18.15562666  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [9.50347258e-06 1.04138622e-02 8.05030810e-01]
Stock Position:  9.503472583401035e-06
Bond Position:  [-5.0015567]


portfolio before change:  [-5.00123582]
curr_Stock_Price:  99.55441641688175
curr_Factors:  [99.55441642 -0.64666454 -1.03769702]
mat_Sqrt:  [[18.4736028   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00407105 -0.00048529 -0.23810642]
Stock Position:  -0.004071053664131171
Bond Position:  [-4.59594445]


portfolio before change:  [-5.00521571]
curr_Stock_Price:  100.39089772338838
curr_Factors:  [100.39089772  -0.49617762  -1.0275695 ]
mat_Sqrt:  [[21.87456222  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00090447  0.01599431  0.25766052]
Stock Position:  -0.0009044726439681958
Bond Position:  [-4.91441489]


portfolio before change:  [-5.00401967]
curr_Stock_Price:  98.38930670453958
curr_Factors:  [98.3893067  -0.38603568 -1.02620176]
mat_Sqrt:  [[23.96740274  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00072136 -0.04545982  0.28288526]
Stock Position:  -0.0007213598798435375
Bond Position:  [-4.93304557]


portfolio before change:  [-5.00373655]
curr_Stock_Price:  97.14195820265057
curr_Factors:  [97.1419582  -0.40531459 -1.04714479]
mat_Sqrt:  [[22.73064514  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00703346  0.01806206 -0.36821584]
Stock Position:  0.007033463422010939
Bond Position:  [-5.68698096]


portfolio before change:  [-5.01057469]
curr_Stock_Price:  96.27080417267825
curr_Factors:  [96.27080417 -0.25467518 -1.03902001]
mat_Sqrt:  [[26.40279594  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00035238 0.01044297 0.05897335]
Stock Position:  0.00035237749793469144
Bond Position:  [-5.04449836]


portfolio before change:  [-5.01155029]
curr_Stock_Price:  95.29175250863544
curr_Factors:  [95.29175251 -0.28105463 -1.02723367]
mat_Sqrt:  [[25.75567433  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00536905 -0.04191149 -0.3875644 ]
Stock Position:  -0.005369053926785621
Bond Position:  [-4.49992373]


portfolio before change:  [-5.01380199]
curr_Stock_Price:  95.60636585702902
curr_Factors:  [95.60636586 -0.33720001 -1.03814471]
mat_Sqrt:  [[24.16474342  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00682515 0.06270926 0.19387104]
Stock Position:  0.006825145015710209
Bond Position:  [-5.66632931]


portfolio before change:  [-5.01188758]
curr_Stock_Price:  95.99064299749939
curr_Factors:  [95.990643   -0.32537125 -1.07596918]
mat_Sqrt:  [[23.6392932   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00272669 0.0026019  0.09282463]
Stock Position:  0.0027266939383543765
Bond Position:  [-5.27362469]


portfolio before change:  [-5.01001111]
curr_Stock_Price:  96.92060415034734
curr_Factors:  [96.92060415 -0.6821516  -1.07228154]
mat_Sqrt:  [[16.76777673  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00194401 -0.03139109 -0.22813909]
Stock Position:  0.0019440077295824144
Bond Position:  [-5.19842551]


portfolio before change:  [-5.00832637]
curr_Stock_Price:  98.12151742753555
curr_Factors:  [98.12151743 -0.72375947 -1.05796967]
mat_Sqrt:  [[16.51844353  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01436897 -0.05611164 -0.17549777]
Stock Position:  0.014368966192821974
Bond Position:  [-6.41823113]


portfolio before change:  [-5.01195085]
curr_Stock_Price:  97.925110886919
curr_Factors:  [97.92511089 -0.62937175 -1.01841143]
mat_Sqrt:  [[18.84824554  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00246506 -0.02560667  0.01459644]
Stock Position:  -0.0024650578999655267
Bond Position:  [-4.77055979]


portfolio before change:  [-5.00999122]
curr_Stock_Price:  96.88822171973908
curr_Factors:  [96.88822172 -0.83473386 -1.00002363]
mat_Sqrt:  [[15.46841915  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01116652  0.02023792  0.05847176]
Stock Position:  -0.011166515766487134
Bond Position:  [-3.92808736]


portfolio before change:  [-5.00633251]
curr_Stock_Price:  96.51659677815212
curr_Factors:  [96.51659678 -0.97961902 -0.99863748]
mat_Sqrt:  [[13.34922703  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00495661 -0.02832339 -0.1578763 ]
Stock Position:  0.004956610397005036
Bond Position:  [-5.48472767]


portfolio before change:  [-5.01157963]
curr_Stock_Price:  95.59631150704729
curr_Factors:  [95.59631151 -1.02061368 -1.02164241]
mat_Sqrt:  [[12.40225297  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00056572  0.00911927 -0.2703628 ]
Stock Position:  0.0005657213655274094
Bond Position:  [-5.06566051]


portfolio before change:  [-5.01121908]
curr_Stock_Price:  97.35301227274807
curr_Factors:  [97.35301227 -1.11619874 -1.05793836]
mat_Sqrt:  [[11.06964393  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00325519  0.00564205 -0.21887322]
Stock Position:  -0.003255187846125968
Bond Position:  [-4.69431674]


portfolio before change:  [-5.01206357]
curr_Stock_Price:  97.43216652378068
curr_Factors:  [97.43216652 -1.03695065 -1.02731722]
mat_Sqrt:  [[12.36523042  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00135534 -0.02083754  0.01109909]
Stock Position:  0.0013553386003466096
Bond Position:  [-5.14411714]


portfolio before change:  [-5.01275393]
curr_Stock_Price:  97.39726129159135
curr_Factors:  [97.39726129 -0.83929036 -1.00708017]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-5.01275393]
Stock Price:  97.56450127202295
PL:  [-5.01275393]
Settle:  Tensor("sub_218:0", shape=(), dtype=float64)
PL:  Tensor("sub_219:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  110
output_Z_Vals[:, i, :]:  [[ 1.19260232e+02 -2.92559343e+01 -2.92733494e+01]
 [-4.68052718e-03 -6.13192269e-02 -2.46799508e-02]
 [-5.53406518e-02 -7.64685156e-02 -7.37587495e-02]
 [ 8.15268382e-02  1.39029113e-01  3.75385985e-02]
 [ 2.33126203e-01 -1.61712722e-02 -3.17201154e-02]
 [ 2.73742900e-03  3.16656851e-02  9.66007835e-02]
 [ 3.87446756e-02  4.44457304e-02 -3.87814608e-02]
 [-1.29645306e-01  1.83075147e-01 -2.21752693e-02]
 [-3.97879053e-02 -2.04291698e-02  1.63136564e-02]
 [-3.05418196e-02  3.85702786e-01  1.60386605e-01]
 [ 4.57315273e-02 -1.88870777e-02 -6.18213145e-02]
 [-8.87371746e-02  1.07343283e-01  3.12159256e-02]
 [-8.10087286e-02 -2.83276975e-02 -6.04687143e-02]
 [ 1.26345423e-01  1.33016032e-01  2.23812553e-01]
 [ 1.91671515e-01  2.54833274e-01  4.81521152e-02]
 [-5.98099843e-02 -7.34052908e-02 -1.21998123e-01]
 [-8.89340202e-02  2.42370069e-02 -1.03707803e-01]
 [ 1.28677062e-01 -2.28671330e-01 -1.76011245e-01]
 [ 3.74860915e-02  5.63596752e-02  3.12193466e-02]
 [ 3.31388904e-01 -2.15999949e-01 -6.62577696e-02]
 [ 3.28182016e-01  3.04272781e-03  4.72552718e-01]
 [-1.06489233e-01  6.80999354e-02 -1.03867881e-01]
 [-2.21157441e-01  6.61783047e-01  4.05687009e-01]
 [ 3.64557579e-01 -4.41527033e-02  1.07646291e-01]
 [-1.96323813e-01 -8.18236535e-02 -1.97663292e-01]
 [ 1.07715839e-01 -9.12198548e-03  5.65672617e-02]
 [-6.60635775e-02  1.00369907e-01  1.00784011e-01]
 [-5.07806065e-02  7.36225950e-02  2.93687317e-02]
 [ 6.20848838e-02 -6.23725319e-02  9.08311027e-02]
 [-4.05529169e-02 -7.47101254e-02 -6.13829263e-02]
 [-7.27551380e-02  4.37660856e-01  4.43295041e-03]
 [ 3.51788163e-02 -5.35567494e-02  3.03827375e-02]
 [ 2.99896018e-03 -6.54220108e-03  7.53892020e-02]
 [-4.93316545e-02 -8.47984203e-02 -5.65617182e-03]
 [-1.69214160e-01  1.65066080e-01  3.27163254e-02]
 [ 8.99127890e-02 -1.62815306e-01 -1.36070303e-01]
 [-1.85892272e-01 -3.07160409e-01  3.99009488e-02]
 [-5.12626026e-02 -3.68467949e-02  6.23725468e-02]
 [-3.30824628e-02  7.11132935e-02 -2.77148213e-02]
 [-1.91961393e-01  1.10965804e-01  1.14821225e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.26023247 -29.25593426 -29.27334937]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  8.31486419  -9.25153874 -83.50871763]
init_Out:  [2.49911038]
Stock Position:  8.31486419409362
Bond position:  [-828.98730903]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [4.11202071]
curr_Stock_Price:  100.20644236346207
curr_Factors:  [100.20644236  -0.82821925  -0.99578524]
mat_Sqrt:  [[16.17113716  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00069887 -0.01939084 -0.07040503]
Stock Position:  -0.0006988721049423291
Bond Position:  [4.18205219]


portfolio before change:  [4.11247553]
curr_Stock_Price:  100.30369576286496
curr_Factors:  [100.30369576  -0.9825535   -0.99630097]
mat_Sqrt:  [[13.86472822  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00521979 -0.02418147 -0.21041318]
Stock Position:  -0.005219792332360658
Bond Position:  [4.63603999]


portfolio before change:  [4.10424229]
curr_Stock_Price:  101.99203558502326
curr_Factors:  [101.99203559  -0.86183706  -1.00672991]
mat_Sqrt:  [[15.74192842  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00589376 0.04396487 0.10708717]
Stock Position:  0.005893756241252991
Bond Position:  [3.50312609]


portfolio before change:  [4.10547182]
curr_Stock_Price:  102.12635016405085
curr_Factors:  [102.12635016  -0.93608714  -1.02879967]
mat_Sqrt:  [[14.31522932  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01580372 -0.00511381 -0.09048866]
Stock Position:  0.015803716169053995
Bond Position:  [2.49149597]


portfolio before change:  [4.10929761]
curr_Stock_Price:  102.34872426115443
curr_Factors:  [102.34872426  -0.98684482  -1.02277994]
mat_Sqrt:  [[13.71871682  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00169648 0.01001357 0.27557515]
Stock Position:  0.0016964841647635826
Bond Position:  [3.93566462]


portfolio before change:  [4.10758971]
curr_Stock_Price:  101.05198532045034
curr_Factors:  [101.05198532  -0.82750814  -0.96560762]
mat_Sqrt:  [[16.81917036  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00190117  0.01405497 -0.11063271]
Stock Position:  0.0019011655277410189
Bond Position:  [3.91547316]


portfolio before change:  [4.10730698]
curr_Stock_Price:  100.64581849620319
curr_Factors:  [100.6458185   -0.84892672  -0.93417027]
mat_Sqrt:  [[16.9202414   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00765029  0.05789344 -0.06325987]
Stock Position:  -0.007650294722458203
Bond Position:  [4.87727716]


portfolio before change:  [4.10233099]
curr_Stock_Price:  101.37594513409726
curr_Factors:  [101.37594513  -0.98742988  -0.96898764]
mat_Sqrt:  [[14.3309038   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00258081 -0.00646027  0.04653832]
Stock Position:  -0.002580812317675851
Bond Position:  [4.36396328]


portfolio before change:  [4.09966659]
curr_Stock_Price:  102.61971581428939
curr_Factors:  [102.61971581  -1.18575383  -0.97814675]
mat_Sqrt:  [[11.78855906  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00103115 0.12196993 0.45753834]
Stock Position:  0.0010311491103992029
Bond Position:  [3.99385036]


portfolio before change:  [4.10010326]
curr_Stock_Price:  102.55901367369688
curr_Factors:  [102.55901367  -1.32583353  -0.99071079]
mat_Sqrt:  [[10.11373153  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00322578 -0.00597262 -0.176359  ]
Stock Position:  0.003225776949875993
Bond Position:  [3.76927075]


portfolio before change:  [4.1018199]
curr_Stock_Price:  102.94511000820297
curr_Factors:  [102.94511001  -1.1762815   -1.00237035]
mat_Sqrt:  [[11.65277195  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00683045  0.03394493  0.08905035]
Stock Position:  -0.0068304485113726224
Bond Position:  [4.80498118]


portfolio before change:  [4.10734428]
curr_Stock_Price:  102.22426218011414
curr_Factors:  [102.22426218  -1.16882291  -0.99741062]
mat_Sqrt:  [[11.71576681  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00803048 -0.008958   -0.17250041]
Stock Position:  -0.008030483428826755
Bond Position:  [4.92825452]


portfolio before change:  [4.11050625]
curr_Stock_Price:  101.90723267659499
curr_Factors:  [101.90723268  -1.34731219  -0.95983916]
mat_Sqrt:  [[10.14429594  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01729695 0.04206336 0.63847492]
Stock Position:  0.017296954816839783
Bond Position:  [2.34782145]


portfolio before change:  [4.12347977]
curr_Stock_Price:  102.64031111413621
curr_Factors:  [102.64031111  -1.23433459  -0.9764593 ]
mat_Sqrt:  [[11.25077322  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01849475 0.08058536 0.13736458]
Stock Position:  0.018494754752987744
Bond Position:  [2.22517239]


portfolio before change:  [4.14572155]
curr_Stock_Price:  103.82787029559202
curr_Factors:  [103.8278703   -0.99070952  -1.00168376]
mat_Sqrt:  [[14.15886818  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00611688 -0.02321279 -0.34802669]
Stock Position:  -0.006116877579609094
Bond Position:  [4.78082392]


portfolio before change:  [4.14224761]
curr_Stock_Price:  104.49350058547165
curr_Factors:  [104.49350059  -0.96010023  -1.01576251]
mat_Sqrt:  [[14.48715121  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00755687  0.00766441 -0.2958495 ]
Stock Position:  -0.007556868050026186
Bond Position:  [4.93189121]


portfolio before change:  [4.1353386]
curr_Stock_Price:  105.4893537588583
curr_Factors:  [105.48935376  -0.76516087  -1.01542214]
mat_Sqrt:  [[17.77916071  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00488463 -0.07231222 -0.50211109]
Stock Position:  0.004884631486531319
Bond Position:  [3.62006199]


portfolio before change:  [4.12898896]
curr_Stock_Price:  104.09678666901618
curr_Factors:  [104.09678667  -0.565386    -1.00630892]
mat_Sqrt:  [[21.62015943  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00209591 0.01782249 0.08906011]
Stock Position:  0.0020959102847227427
Bond Position:  [3.91081144]


portfolio before change:  [4.13029737]
curr_Stock_Price:  104.48779741751265
curr_Factors:  [104.48779742  -0.4040999   -0.97090079]
mat_Sqrt:  [[26.41863412  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01182071 -0.06830518 -0.18901497]
Stock Position:  0.01182070948969915
Bond Position:  [2.89517747]


portfolio before change:  [4.15325157]
curr_Stock_Price:  106.39904332442904
curr_Factors:  [106.39904332  -0.42111472  -0.98827268]
mat_Sqrt:  [[25.99253003  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [1.63400792e-02 9.62195019e-04 1.34806137e+00]
Stock Position:  0.01634007918658295
Bond Position:  [2.41468278]


portfolio before change:  [4.17708983]
curr_Stock_Price:  107.83945251241826
curr_Factors:  [107.83945251  -0.35097897  -1.00515635]
mat_Sqrt:  [[27.78533187  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00453235  0.02153509 -0.29630615]
Stock Position:  -0.0045323497645136405
Bond Position:  [4.66585594]


portfolio before change:  [4.17980374]
curr_Stock_Price:  107.3693547106711
curr_Factors:  [107.36935471  -0.24078712  -0.99867567]
mat_Sqrt:  [[31.08769311  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00390057  0.20927417  1.15731211]
Stock Position:  -0.0039005712605134626
Bond Position:  [4.59860556]


portfolio before change:  [4.18115394]
curr_Stock_Price:  107.17057985222432
curr_Factors:  [107.17057985  -0.44903255  -0.99973182]
mat_Sqrt:  [[25.17011559  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01531144 -0.01396231  0.3070849 ]
Stock Position:  0.01531144212341908
Bond Position:  [2.54021781]


portfolio before change:  [4.18333595]
curr_Stock_Price:  107.29234919567793
curr_Factors:  [107.2923492   -0.74760654  -1.04018274]
mat_Sqrt:  [[17.95319452  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01330038 -0.02587491 -0.56387835]
Stock Position:  -0.013300381776300305
Bond Position:  [5.61036516]


portfolio before change:  [4.17794303]
curr_Stock_Price:  107.75055082427255
curr_Factors:  [107.75055082  -0.80894729  -1.05705631]
mat_Sqrt:  [[16.6734101   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00713873 -0.00288463  0.16137065]
Stock Position:  0.007138734858947306
Bond Position:  [3.40874042]


portfolio before change:  [4.17241694]
curr_Stock_Price:  106.91675974868508
curr_Factors:  [106.91675975  -0.84425566  -1.04451817]
mat_Sqrt:  [[16.17192565  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00265272  0.03173975  0.28750873]
Stock Position:  -0.002652719808443665
Bond Position:  [4.45603715]


portfolio before change:  [4.17314228]
curr_Stock_Price:  106.85331531083465
curr_Factors:  [106.85331531  -0.69821849  -1.04392055]
mat_Sqrt:  [[18.71486209  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00229148  0.02328151  0.08378082]
Stock Position:  -0.0022914842655080013
Bond Position:  [4.41799497]


portfolio before change:  [4.17699895]
curr_Stock_Price:  105.4112838622985
curr_Factors:  [105.41128386  -0.6063164   -1.04125155]
mat_Sqrt:  [[20.29352237  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00389362 -0.01972393  0.25911585]
Stock Position:  0.0038936194384222383
Bond Position:  [3.76656753]


portfolio before change:  [4.17791683]
curr_Stock_Price:  105.52609371669749
curr_Factors:  [105.52609372  -0.56793941  -1.04180095]
mat_Sqrt:  [[21.09883648  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00260733 -0.02362542 -0.1751084 ]
Stock Position:  -0.0026073315192542625
Bond Position:  [4.45305834]


portfolio before change:  [4.18170759]
curr_Stock_Price:  104.2857090474835
curr_Factors:  [104.28570905  -0.47669203  -1.00979297]
mat_Sqrt:  [[23.58590622  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00256721  0.13840051  0.01264597]
Stock Position:  -0.002567207317161223
Bond Position:  [4.44943063]


portfolio before change:  [4.17915737]
curr_Stock_Price:  105.49575366260322
curr_Factors:  [105.49575366  -0.5232406   -1.01973937]
mat_Sqrt:  [[22.54900042  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00177382 -0.01693613  0.08667349]
Stock Position:  0.0017738186432348065
Bond Position:  [3.99202704]


portfolio before change:  [4.17754798]
curr_Stock_Price:  104.30711713846124
curr_Factors:  [104.30711714  -0.61904477  -1.00331051]
mat_Sqrt:  [[20.59368169  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00088468 -0.00206883  0.21506441]
Stock Position:  0.0008846789986967077
Bond Position:  [4.08526966]


portfolio before change:  [4.17757333]
curr_Stock_Price:  103.75851073943363
curr_Factors:  [103.75851074  -0.40140784  -1.02008049]
mat_Sqrt:  [[25.04258696  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00210344 -0.02681562 -0.01613548]
Stock Position:  -0.0021034448899315155
Bond Position:  [4.39582364]


portfolio before change:  [4.17850898]
curr_Stock_Price:  103.57493498718924
curr_Factors:  [103.57493499  -0.41003666  -1.03829021]
mat_Sqrt:  [[24.33628612  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00650362  0.05219848  0.09333057]
Stock Position:  -0.006503620939071595
Bond Position:  [4.8521211]


portfolio before change:  [4.17633885]
curr_Stock_Price:  104.00187962189466
curr_Factors:  [104.00187962  -0.62513151  -1.0605636 ]
mat_Sqrt:  [[19.27316801  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00300592 -0.05148672 -0.3881707 ]
Stock Position:  0.003005924171556278
Bond Position:  [3.86371709]


portfolio before change:  [4.17849125]
curr_Stock_Price:  104.5572498385512
curr_Factors:  [104.55724984  -0.4827079   -1.05699974]
mat_Sqrt:  [[22.42165261  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00828121 -0.09713265  0.1138263 ]
Stock Position:  -0.008281208154283454
Bond Position:  [5.0443516]


portfolio before change:  [4.18369352]
curr_Stock_Price:  104.00519356103894
curr_Factors:  [104.00519356  -0.29680511  -1.06461771]
mat_Sqrt:  [[26.65610001  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00148117 -0.01165198  0.17793151]
Stock Position:  -0.001481170911558516
Bond Position:  [4.33774299]


portfolio before change:  [4.18334738]
curr_Stock_Price:  104.60498724817693
curr_Factors:  [104.60498725  -0.27770538  -1.10631657]
mat_Sqrt:  [[26.21074076  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00140796  0.022488   -0.07906267]
Stock Position:  -0.0014079567605473394
Bond Position:  [4.33062668]


portfolio before change:  [4.18646862]
curr_Stock_Price:  102.77262731404342
curr_Factors:  [102.77262731  -0.44593311  -1.08358458]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [4.18646862]
Stock Price:  102.23924043473457
PL:  [1.94722819]
Settle:  Tensor("sub_220:0", shape=(), dtype=float64)
PL:  Tensor("sub_221:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  111
output_Z_Vals[:, i, :]:  [[ 1.19260232e+02 -2.92559343e+01 -2.92733494e+01]
 [-8.51195238e-03 -4.92332212e-02 -2.40053817e-02]
 [ 1.64502550e-01  2.28859049e-02 -1.84773237e-01]
 [ 8.15911683e-02  1.39614069e-01  3.75464135e-02]
 [ 1.94980539e-01 -2.07325155e-02 -5.84202487e-02]
 [-3.27800451e-02  2.98524934e-02  1.52859362e-01]
 [-4.78928118e-02  4.03753593e-02 -1.58102370e-01]
 [ 2.66281697e-01  9.64253889e-03  1.56973577e-01]
 [ 4.63035390e-02  5.40874091e-02  2.28741549e-02]
 [-4.45985663e-02  1.60043429e-01  5.36280087e-02]
 [ 3.96665983e-02 -4.56103490e-02 -5.30812366e-02]
 [-8.37269041e-02  1.04651201e-01  2.81239819e-02]
 [-5.60257931e-02 -7.89868438e-02 -6.04597796e-02]
 [ 3.46050987e-01  2.60900111e-01  3.46986312e-01]
 [ 1.47615614e-01  1.24760493e-01 -4.26247158e-02]
 [-7.17098554e-02 -9.78151935e-02 -1.22778844e-01]
 [-8.30575354e-02 -3.36369595e-03 -9.01140197e-02]
 [ 4.86426195e-02 -2.19735385e-01 -1.04412627e-01]
 [ 4.27141917e-02  5.25947454e-02  3.32011332e-02]
 [ 3.05250453e-01 -2.32825780e-01 -5.60817349e-02]
 [ 1.69641119e-01  3.50722283e-03  2.55468249e-01]
 [-2.45850236e-02  1.15345139e-02 -2.40854011e-02]
 [-1.35526326e-01  3.60968575e-01  1.78451606e-01]
 [ 2.48972181e-01 -2.96359994e-02  5.57718973e-02]
 [-2.14783113e-01 -9.10213038e-02 -2.18672506e-01]
 [ 1.07860545e-01 -9.43646918e-03  5.65751303e-02]
 [-1.33580855e-01  7.22579801e-02  9.10318348e-02]
 [-5.07806065e-02  7.36225950e-02  2.93687317e-02]
 [ 6.20848838e-02 -6.23725319e-02  9.08311027e-02]
 [-4.92312639e-02 -8.74064558e-02 -5.17789967e-02]
 [-1.30858437e-01  6.31570322e-01 -1.45459965e-02]
 [ 4.91808978e-02  7.37940987e-02  1.77157677e-01]
 [-5.74984143e-02  1.90731650e-02  8.27570444e-02]
 [-3.02661142e-01 -1.13185648e-03  3.49255279e-02]
 [-1.31049547e-01  6.56671881e-02  3.58217096e-02]
 [ 1.08923611e-01 -1.54778033e-01 -1.26351323e-01]
 [-2.62195799e-01 -4.65379055e-01  1.15451058e-01]
 [-6.89375115e-02 -8.65361971e-02  1.47904813e-01]
 [-1.11036159e-02  2.50211228e-02 -4.15055523e-02]
 [ 2.19325877e-01 -1.37290371e-02 -2.17743697e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.26023247 -29.25593426 -29.27334937]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  8.31486419  -9.25153874 -83.50871763]
init_Out:  [2.49911038]
Stock Position:  8.31486419409362
Bond position:  [-828.98730903]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [5.05056325]
curr_Stock_Price:  100.31931763325103
curr_Factors:  [100.31931763  -0.86732865  -1.03818919]
mat_Sqrt:  [[14.92205666  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00098399 -0.01556891 -0.06848067]
Stock Position:  -0.0009839948369278516
Bond Position:  [5.14927694]


portfolio before change:  [5.04976861]
curr_Stock_Price:  101.78104762627835
curr_Factors:  [101.78104763  -0.81158811  -1.06114923]
mat_Sqrt:  [[15.64398633  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00814222  0.00723716 -0.52710661]
Stock Position:  0.00814222024671909
Bond Position:  [4.2210449]


portfolio before change:  [5.04203623]
curr_Stock_Price:  100.76657742736867
curr_Factors:  [100.76657743  -0.80050861  -1.03693426]
mat_Sqrt:  [[16.04446391  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00578767 0.04414985 0.10710947]
Stock Position:  0.005787673438824441
Bond Position:  [4.45883219]


portfolio before change:  [5.04154552]
curr_Stock_Price:  100.58548572546094
curr_Factors:  [100.58548573  -0.56994724  -1.01105455]
mat_Sqrt:  [[20.69736064  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00881853 -0.0065562  -0.16665671]
Stock Position:  0.008818527542238849
Bond Position:  [4.15452965]


portfolio before change:  [5.06013071]
curr_Stock_Price:  102.63410838278045
curr_Factors:  [102.63410838  -0.64118373  -1.03039224]
mat_Sqrt:  [[19.29014511  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-4.18332995e-05  9.44018729e-03  4.36065212e-01]
Stock Position:  -4.1833299468926786e-05
Bond Position:  [5.06442423]


portfolio before change:  [5.06073576]
curr_Stock_Price:  103.30430604559429
curr_Factors:  [103.30430605  -0.73851925  -1.05452079]
mat_Sqrt:  [[17.19535039  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00460141  0.01276781 -0.45102205]
Stock Position:  -0.004601408743228946
Bond Position:  [5.5360811]


portfolio before change:  [5.06294965]
curr_Stock_Price:  102.97357308764343
curr_Factors:  [102.97357309  -1.05426696  -1.0750227 ]
mat_Sqrt:  [[12.24579632  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.02438165 0.00304924 0.44780192]
Stock Position:  0.02438165360695102
Bond Position:  [2.55228366]


portfolio before change:  [5.07081073]
curr_Stock_Price:  103.28290478102244
curr_Factors:  [103.28290478  -0.85445903  -1.05283448]
mat_Sqrt:  [[15.33562217  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00341488 0.01710394 0.0652536 ]
Stock Position:  0.003414875292301585
Bond Position:  [4.71811249]


portfolio before change:  [5.07214338]
curr_Stock_Price:  103.5004379692043
curr_Factors:  [103.50043797  -0.55865278  -1.05392142]
mat_Sqrt:  [[20.63526794  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00143054  0.05061018  0.15298578]
Stock Position:  -0.001430535884686784
Bond Position:  [5.22020447]


portfolio before change:  [5.0740264]
curr_Stock_Price:  102.64030254032355
curr_Factors:  [102.64030254  -0.65921186  -1.07997967]
mat_Sqrt:  [[18.03003781  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00153376 -0.01442326 -0.15142599]
Stock Position:  0.0015337617360789294
Bond Position:  [4.91660063]


portfolio before change:  [5.07501287]
curr_Stock_Price:  102.88275041231705
curr_Factors:  [102.88275041  -1.01479794  -1.06668594]
mat_Sqrt:  [[12.83410554  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00586594  0.03309362  0.08022989]
Stock Position:  -0.005865935705195298
Bond Position:  [5.67851647]


portfolio before change:  [5.07394397]
curr_Stock_Price:  103.18598578447809
curr_Factors:  [103.18598578  -1.02017846  -1.05315573]
mat_Sqrt:  [[12.97726337  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00542538 -0.02497783 -0.17247492]
Stock Position:  -0.005425375397957696
Bond Position:  [5.63376668]


portfolio before change:  [5.07239811]
curr_Stock_Price:  103.60072581010255
curr_Factors:  [103.60072581  -1.03387065  -1.07495512]
mat_Sqrt:  [[12.57509867  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.03368687 0.08250386 0.98985537]
Stock Position:  0.03368686753093301
Bond Position:  [1.58241419]


portfolio before change:  [5.04526263]
curr_Stock_Price:  102.78933267658999
curr_Factors:  [102.78933268  -0.84281427  -1.09476969]
mat_Sqrt:  [[14.80696411  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00959928  0.03945273 -0.12159645]
Stock Position:  0.009599279151523877
Bond Position:  [4.05855914]


portfolio before change:  [5.0421957]
curr_Stock_Price:  102.41698315448154
curr_Factors:  [102.41698315  -0.70682591  -1.08120929]
mat_Sqrt:  [[17.13318706  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00579563 -0.03093188 -0.35025387]
Stock Position:  -0.005795626874757835
Bond Position:  [5.63576632]


portfolio before change:  [5.03868312]
curr_Stock_Price:  103.14461742658425
curr_Factors:  [103.14461743  -0.75822769  -1.09198292]
mat_Sqrt:  [[16.21475206  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00626213 -0.00106369 -0.25707022]
Stock Position:  -0.006262126771609589
Bond Position:  [5.68458779]


portfolio before change:  [5.03475227]
curr_Stock_Price:  103.88581336973489
curr_Factors:  [103.88581337  -0.71814727  -1.11722831]
mat_Sqrt:  [[16.57535187  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00130651 -0.06948643 -0.29786016]
Stock Position:  0.0013065145303210767
Bond Position:  [4.89902395]


portfolio before change:  [5.03707103]
curr_Stock_Price:  105.19184033091143
curr_Factors:  [105.19184033  -0.63965767  -1.11184864]
mat_Sqrt:  [[18.2520869   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00278595 0.01663192 0.09471359]
Stock Position:  0.002785946362589673
Bond Position:  [4.74401221]


portfolio before change:  [5.03804281]
curr_Stock_Price:  105.32778731397482
curr_Factors:  [105.32778731  -0.76803523  -1.11293251]
mat_Sqrt:  [[16.05643232  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01792374 -0.07362598 -0.15998558]
Stock Position:  0.017923737677509204
Bond Position:  [3.15017518]


portfolio before change:  [5.02906189]
curr_Stock_Price:  104.80475382734919
curr_Factors:  [104.80475383  -0.92817857  -1.12788362]
mat_Sqrt:  [[13.41048594  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01654518 0.00110908 0.72877981]
Stock Position:  0.016545180709283524
Bond Position:  [3.2950483]


portfolio before change:  [5.04589269]
curr_Stock_Price:  105.79712088412856
curr_Factors:  [105.79712088  -1.01464641  -1.16000136]
mat_Sqrt:  [[12.02364991  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00242885  0.00364753 -0.06870895]
Stock Position:  -0.0024288478009641206
Bond Position:  [5.3028578]


portfolio before change:  [5.04612588]
curr_Stock_Price:  105.97404062134179
curr_Factors:  [105.97404062  -1.13422093  -1.17846413]
mat_Sqrt:  [[10.49090931  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00855787  0.11414829  0.50907276]
Stock Position:  -0.008557873563141482
Bond Position:  [5.95303832]


portfolio before change:  [5.04966797]
curr_Stock_Price:  105.64710072503476
curr_Factors:  [105.64710073  -0.69785176  -1.18111151]
mat_Sqrt:  [[16.13742379  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0160863  -0.00937173  0.1591017 ]
Stock Position:  0.016086295874723034
Bond Position:  [3.35019745]


portfolio before change:  [5.07851656]
curr_Stock_Price:  107.41443050741827
curr_Factors:  [107.41443051  -0.67641761  -1.1658968 ]
mat_Sqrt:  [[17.01984688  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01538026 -0.02878346 -0.62381179]
Stock Position:  -0.0153802565242743
Bond Position:  [6.73057805]


portfolio before change:  [5.07320638]
curr_Stock_Price:  107.81439473040098
curr_Factors:  [107.81439473  -0.63265644  -1.15603029]
mat_Sqrt:  [[18.02436489  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00661134 -0.00298407  0.1613931 ]
Stock Position:  0.006611342318820028
Bond Position:  [4.36040851]


portfolio before change:  [5.05441594]
curr_Stock_Price:  104.88979512271621
curr_Factors:  [104.88979512  -0.43601628  -1.15179389]
mat_Sqrt:  [[21.43660678  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00527758  0.02284998  0.25968849]
Stock Position:  -0.005277578082327241
Bond Position:  [5.60798002]


portfolio before change:  [5.05709395]
curr_Stock_Price:  104.51519576270118
curr_Factors:  [104.51519576  -0.27203697  -1.17574458]
mat_Sqrt:  [[24.57060785  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00174537  0.02328151  0.08378082]
Stock Position:  -0.0017453704146306122
Bond Position:  [5.23951168]


portfolio before change:  [5.05850271]
curr_Stock_Price:  104.0833217423165
curr_Factors:  [104.08332174  -0.30818835  -1.1507113 ]
mat_Sqrt:  [[24.1985353   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00326529 -0.01972393  0.25911585]
Stock Position:  0.003265290736649895
Bond Position:  [4.71864041]


portfolio before change:  [5.06449981]
curr_Stock_Price:  105.7392923976218
curr_Factors:  [105.7392924   -0.40869267  -1.1851902 ]
mat_Sqrt:  [[21.47938613  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00288916 -0.02764035 -0.14771107]
Stock Position:  -0.0028891622839309467
Bond Position:  [5.36999778]


portfolio before change:  [5.06189589]
curr_Stock_Price:  106.87291256065313
curr_Factors:  [106.87291256  -0.51659619  -1.20054311]
mat_Sqrt:  [[19.19214517  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00612337  0.19972007 -0.04149568]
Stock Position:  -0.006123367131055864
Bond Position:  [5.71631797]


portfolio before change:  [5.05552576]
curr_Stock_Price:  108.02990904829409
curr_Factors:  [108.02990905  -0.55701043  -1.20524973]
mat_Sqrt:  [[18.54403108  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00470493 0.02333574 0.50538154]
Stock Position:  0.004704932397408113
Bond Position:  [4.54725234]


portfolio before change:  [5.05854807]
curr_Stock_Price:  108.55146273735521
curr_Factors:  [108.55146274  -0.53977678  -1.21047563]
mat_Sqrt:  [[18.85865505  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00212705  0.00603146  0.23608281]
Stock Position:  -0.002127046503605108
Bond Position:  [5.28944208]


portfolio before change:  [5.06037141]
curr_Stock_Price:  108.00511320388948
curr_Factors:  [108.0051132   -0.69242858  -1.16545595]
mat_Sqrt:  [[16.84904602  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01754172 -0.00035792  0.09963281]
Stock Position:  -0.017541718519921822
Bond Position:  [6.9549667]


portfolio before change:  [5.06600895]
curr_Stock_Price:  107.73329694279059
curr_Factors:  [107.73329694  -0.42786525  -1.13830588]
mat_Sqrt:  [[22.49937575  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00542424  0.02076579  0.10218937]
Stock Position:  -0.005424237226229666
Bond Position:  [5.65037991]


portfolio before change:  [5.06470621]
curr_Stock_Price:  108.10368740805465
curr_Factors:  [108.10368741  -0.33794139  -1.14390261]
mat_Sqrt:  [[24.56313746  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00322173 -0.04894511 -0.36044515]
Stock Position:  0.0032217343527904036
Bond Position:  [4.71642485]


portfolio before change:  [5.06736029]
curr_Stock_Price:  108.74448929440852
curr_Factors:  [108.74448929  -0.30935913  -1.13116078]
mat_Sqrt:  [[25.75119624  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00973335 -0.14716578  0.32934973]
Stock Position:  -0.009733353108131079
Bond Position:  [6.12580881]


portfolio before change:  [5.06419205]
curr_Stock_Price:  109.14866837514725
curr_Factors:  [109.14866838  -0.1261243   -1.11716652]
mat_Sqrt:  [[31.48212958  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00130172 -0.02736515  0.42193126]
Stock Position:  -0.001301720168926477
Bond Position:  [5.20627307]


portfolio before change:  [5.06317642]
curr_Stock_Price:  110.42886183766896
curr_Factors:  [ 1.10428862e+02 -1.43319646e-03 -1.12550211e+00]
mat_Sqrt:  [[35.78168703  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00052904  0.00791237 -0.11840379]
Stock Position:  -0.0005290376230130706
Bond Position:  [5.12159744]


portfolio before change:  [5.06543308]
curr_Stock_Price:  107.37346363489317
curr_Factors:  [ 1.07373464e+02 -5.13849907e-02 -1.10795571e+00]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [5.06543308]
Stock Price:  102.31923130667401
PL:  [2.74620177]
Settle:  Tensor("sub_222:0", shape=(), dtype=float64)
PL:  Tensor("sub_223:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  112
output_Z_Vals[:, i, :]:  [[ 1.19260232e+02 -2.92559343e+01 -2.92733494e+01]
 [ 3.50049502e-02  4.57864941e-02 -5.42243748e-02]
 [-6.38983231e-02 -1.14780134e-02  9.45909727e-02]
 [-5.58697392e-02  1.06480592e-01  1.17178603e-02]
 [-1.02973436e-01  8.81946164e-02 -6.96757157e-02]
 [ 2.91911122e-02  2.87612985e-02  7.12956932e-02]
 [ 5.99415853e-02  5.14823122e-02  2.09944395e-02]
 [-6.64923375e-03 -1.64577417e-02 -3.04666256e-02]
 [ 8.88437322e-02 -5.16574816e-02 -1.72639873e-01]
 [-1.77444318e-01 -1.89971236e-01 -5.66842718e-02]
 [ 2.26331306e-01  1.06633800e-01  3.21501187e-01]
 [-2.97354401e-01 -1.33194051e-01  1.01468097e-01]
 [-5.16275652e-03 -1.80921078e-01  4.88859108e-02]
 [-1.13169740e-01 -1.20720993e-01  5.12512171e-02]
 [ 6.96698385e-02  3.44421927e-01  3.08567721e-01]
 [ 1.19080897e-02 -5.07180474e-01  8.47632817e-03]
 [-6.59785272e-02 -7.97961508e-02 -3.36056628e-02]
 [-6.45158237e-02  1.68794749e-01  1.02194942e-01]
 [-1.97257274e-02  5.75312550e-02 -4.71077240e-02]
 [-5.37955420e-02 -2.11128382e-02  1.28264686e-01]
 [ 4.98199356e-02 -7.74709681e-02  3.77866638e-02]
 [ 1.25296203e-01  2.21004998e-02  2.52967835e-01]
 [-9.42971509e-03 -1.33435171e-01  1.56070741e-01]
 [-6.88808869e-02 -5.58983433e-04 -8.19255162e-02]
 [-4.02761285e-01  1.34220362e-01  4.90475574e-02]
 [-6.83625830e-02 -1.82353700e-01  1.10211976e-01]
 [ 2.17219062e-01  5.36402472e-02 -1.44280276e-01]
 [ 3.16194258e-02 -7.27119557e-03  4.99016048e-03]
 [-1.06072129e-01 -1.17501925e-01 -1.49469984e-01]
 [ 5.00381644e-02  4.45867862e-02 -9.95333135e-02]
 [ 5.59201778e-02 -2.07314182e-02  4.22348286e-02]
 [ 7.29669579e-02 -1.06165878e-01 -8.35237562e-02]
 [ 3.51338860e-01 -3.60162428e-01 -3.13764933e-01]
 [-4.78879824e-02 -8.33890202e-02 -1.68463356e-03]
 [-1.32205869e-01 -7.16838943e-02  1.96606852e-02]
 [ 2.27959760e-02 -9.70369442e-02 -6.51831063e-02]
 [-1.38018547e-04 -8.10515678e-02 -8.02879823e-02]
 [-1.73425782e-02  1.77145875e-02 -8.09407705e-02]
 [-6.27302228e-04 -5.98532085e-02  1.14412767e-02]
 [-8.55238620e-01  4.27277870e-01  5.20285961e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.26023247 -29.25593426 -29.27334937]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  8.31486419  -9.25153874 -83.50871763]
init_Out:  [2.49911038]
Stock Position:  8.31486419409362
Bond position:  [-828.98730903]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-1.4619943]
curr_Stock_Price:  99.53607482960565
curr_Factors:  [99.53607483 -0.99736052 -0.96836582]
mat_Sqrt:  [[13.94043771  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00180186  0.01447896 -0.15468705]
Stock Position:  0.001801855062208508
Bond Position:  [-1.64134388]


portfolio before change:  [-1.46344829]
curr_Stock_Price:  98.84300497972876
curr_Factors:  [98.84300498 -0.96048158 -0.95035781]
mat_Sqrt:  [[14.62442966  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00306927 -0.00362967  0.26984172]
Stock Position:  -0.003069274064663892
Bond Position:  [-1.16007202]


portfolio before change:  [-1.46210845]
curr_Stock_Price:  98.35922485547393
curr_Factors:  [98.35922486 -1.00685227 -0.95431029]
mat_Sqrt:  [[13.83862757  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00366572  0.03367212  0.03342779]
Stock Position:  -0.003665719285497066
Bond Position:  [-1.10155115]


portfolio before change:  [-1.45885527]
curr_Stock_Price:  97.43419899965592
curr_Factors:  [97.434199   -0.81746705 -0.92647841]
mat_Sqrt:  [[17.03434844  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0067463   0.02788959 -0.19876542]
Stock Position:  -0.006746295994516438
Bond Position:  [-0.80153533]


portfolio before change:  [-1.45676829]
curr_Stock_Price:  97.10999419833988
curr_Factors:  [97.1099942  -0.93115907 -0.9159023 ]
mat_Sqrt:  [[15.3142372   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00290494 0.00909512 0.20338677]
Stock Position:  0.0029049372535099385
Bond Position:  [-1.73886673]


portfolio before change:  [-1.458688]
curr_Stock_Price:  96.52397693128019
curr_Factors:  [96.52397693 -1.00446161 -0.90491953]
mat_Sqrt:  [[14.30215603  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00458367 0.01628014 0.05989129]
Stock Position:  0.004583667301046103
Bond Position:  [-1.9011218]


portfolio before change:  [-1.45870138]
curr_Stock_Price:  96.5729070044704
curr_Factors:  [96.572907   -1.00926158 -0.91940659]
mat_Sqrt:  [[14.03606472  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00094707 -0.00520439 -0.0869128 ]
Stock Position:  -0.0009470706338573266
Bond Position:  [-1.36724002]


portfolio before change:  [-1.45757233]
curr_Stock_Price:  95.20028612715642
curr_Factors:  [95.20028613 -1.18454204 -0.91427589]
mat_Sqrt:  [[11.67167552  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00447836 -0.01633553 -0.4924935 ]
Stock Position:  0.004478360903061091
Bond Position:  [-1.88391357]


portfolio before change:  [-1.45831499]
curr_Stock_Price:  95.08703984334801
curr_Factors:  [95.08703984 -1.04424992 -0.91169183]
mat_Sqrt:  [[13.44827622  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01441969 -0.06007418 -0.16170445]
Stock Position:  -0.014419690617463144
Bond Position:  [-0.08718929]


portfolio before change:  [-1.44504734]
curr_Stock_Price:  94.16617798623732
curr_Factors:  [94.16617799 -1.19556939 -0.88902263]
mat_Sqrt:  [[11.71030292  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.02516679 0.03372057 0.9171534 ]
Stock Position:  0.025166789923138085
Bond Position:  [-3.81490776]


portfolio before change:  [-1.45064974]
curr_Stock_Price:  93.96251664020208
curr_Factors:  [93.96251664 -1.29655387 -0.88288358]
mat_Sqrt:  [[10.62764365  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02635404 -0.04211966  0.28946024]
Stock Position:  -0.02635404208492909
Bond Position:  [1.02564238]


portfolio before change:  [-1.45843247]
curr_Stock_Price:  94.26269632119615
curr_Factors:  [94.26269632 -1.17467058 -0.90614202]
mat_Sqrt:  [[11.76669308  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 1.22953917e-05 -5.72122682e-02  1.39457896e-01]
Stock Position:  1.2295391670491057e-05
Bond Position:  [-1.45959147]


portfolio before change:  [-1.45862065]
curr_Stock_Price:  93.7978096540815
curr_Factors:  [93.79780965 -1.18406091 -0.90568107]
mat_Sqrt:  [[11.60457625  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00911926 -0.03817533  0.14620546]
Stock Position:  -0.009119258605317813
Bond Position:  [-0.60325417]


portfolio before change:  [-1.46469526]
curr_Stock_Price:  94.4556701521326
curr_Factors:  [94.45567015 -1.33914569 -0.92584881]
mat_Sqrt:  [[ 9.80738945  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01443288 0.10891578 0.88025782]
Stock Position:  0.014432882204561515
Bond Position:  [-2.82796282]


portfolio before change:  [-1.45424129]
curr_Stock_Price:  95.20448003527427
curr_Factors:  [95.20448004 -1.35891946 -0.92487935]
mat_Sqrt:  [[ 9.70099237  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 5.59705035e-05 -1.60384548e-01  2.41806049e-02]
Stock Position:  5.597050347356096e-05
Bond Position:  [-1.45956994]


portfolio before change:  [-1.45438315]
curr_Stock_Price:  95.92995034082415
curr_Factors:  [95.92995034 -1.61041032 -0.96452201]
mat_Sqrt:  [[ 7.30592682  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01025176 -0.02523376 -0.0958676 ]
Stock Position:  -0.010251756414532484
Bond Position:  [-0.47093266]


portfolio before change:  [-1.4604047]
curr_Stock_Price:  96.51157587756111
curr_Factors:  [96.51157588 -1.65147927 -0.96678607]
mat_Sqrt:  [[ 7.0385179   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00558315  0.05337759  0.29153372]
Stock Position:  -0.005583150807473535
Bond Position:  [-0.92156602]


portfolio before change:  [-1.46175581]
curr_Stock_Price:  96.73293969497232
curr_Factors:  [96.73293969 -1.52175194 -0.96915651]
mat_Sqrt:  [[ 8.01284223  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00347643  0.01819298 -0.13438522]
Stock Position:  -0.003476431944231274
Bond Position:  [-1.12547033]


portfolio before change:  [-1.46243673]
curr_Stock_Price:  96.88833722046205
curr_Factors:  [96.88833722 -1.13975043 -0.9851395 ]
mat_Sqrt:  [[11.57293548  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00243316 -0.00667647  0.36590345]
Stock Position:  -0.0024331556839571155
Bond Position:  [-1.22669232]


portfolio before change:  [-1.46423668]
curr_Stock_Price:  97.56507342489623
curr_Factors:  [97.56507342 -1.37264451 -0.99214718]
mat_Sqrt:  [[ 9.16808001  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00605719 -0.02449847  0.10779483]
Stock Position:  0.006057191277242071
Bond Position:  [-2.055207]


portfolio before change:  [-1.46560158]
curr_Stock_Price:  97.38215331830202
curr_Factors:  [97.38215332 -1.44729627 -0.97541288]
mat_Sqrt:  [[ 8.63595083  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.02055404 0.00698879 0.72164682]
Stock Position:  0.02055403996449778
Bond Position:  [-3.46719825]


portfolio before change:  [-1.46745604]
curr_Stock_Price:  97.31301697751567
curr_Factors:  [97.31301698 -1.29281963 -0.96311767]
mat_Sqrt:  [[10.19599973  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00186179 -0.04219591  0.44522638]
Stock Position:  0.0018617899777940443
Bond Position:  [-1.64863244]


portfolio before change:  [-1.4672624]
curr_Stock_Price:  97.52771964341215
curr_Factors:  [97.52771964 -1.21795187 -0.98158806]
mat_Sqrt:  [[10.81135212  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-7.91929584e-03 -1.76766082e-04 -2.33710694e-01]
Stock Position:  -0.007919295835495905
Bond Position:  [-0.69491154]


portfolio before change:  [-1.47073147]
curr_Stock_Price:  97.95480353811513
curr_Factors:  [97.95480354 -1.14385762 -0.99847546]
mat_Sqrt:  [[11.49799998  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.03385667  0.04244421  0.13991903]
Stock Position:  -0.033856665509039256
Bond Position:  [1.84569154]


portfolio before change:  [-1.45629634]
curr_Stock_Price:  97.53525825071925
curr_Factors:  [97.53525825 -1.01654641 -1.01601015]
mat_Sqrt:  [[12.77713661  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00395816 -0.0576653   0.31440409]
Stock Position:  -0.0039581646080214415
Bond Position:  [-1.07023574]


portfolio before change:  [-1.45576059]
curr_Stock_Price:  97.36610450958949
curr_Factors:  [97.36610451 -1.20806622 -1.00924235]
mat_Sqrt:  [[10.60334558  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01783899  0.01696254 -0.41159147]
Stock Position:  0.01783898842154337
Bond Position:  [-3.1926734]


portfolio before change:  [-1.4629591]
curr_Stock_Price:  96.98495090132829
curr_Factors:  [96.9849509  -1.11828251 -0.99866198]
mat_Sqrt:  [[11.67688598  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00277902 -0.00229935  0.01423554]
Stock Position:  0.002779019730724216
Bond Position:  [-1.73248219]


portfolio before change:  [-1.46331986]
curr_Stock_Price:  96.93306576176985
curr_Factors:  [96.93306576 -1.03521936 -0.96850344]
mat_Sqrt:  [[13.06971718  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01068244 -0.03715737 -0.42639626]
Stock Position:  -0.010682438353630228
Bond Position:  [-0.42783836]


portfolio before change:  [-1.46573799]
curr_Stock_Price:  97.15442435583108
curr_Factors:  [97.15442436 -1.04821262 -0.95330484]
mat_Sqrt:  [[13.12848457  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00235155  0.01409958 -0.28394084]
Stock Position:  0.0023515461775599797
Bond Position:  [-1.69420111]


portfolio before change:  [-1.46703942]
curr_Stock_Price:  96.69105226971416
curr_Factors:  [96.69105227 -0.97585624 -0.95226421]
mat_Sqrt:  [[14.06093535  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00455205 -0.00655585  0.12048421]
Stock Position:  0.004552047323313469
Bond Position:  [-1.90718167]


portfolio before change:  [-1.46731505]
curr_Stock_Price:  96.6828770133268
curr_Factors:  [96.68287701 -1.10944352 -0.9371479 ]
mat_Sqrt:  [[12.48895801  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00425789 -0.0335726  -0.23827003]
Stock Position:  0.004257885354734728
Bond Position:  [-1.87897966]


portfolio before change:  [-1.46746207]
curr_Stock_Price:  96.70351295860672
curr_Factors:  [96.70351296 -1.12774805 -0.93795543]
mat_Sqrt:  [[12.25514995  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.02268373 -0.11389336 -0.89508402]
Stock Position:  0.022683729615858128
Bond Position:  [-3.66105841]


portfolio before change:  [-1.4635181]
curr_Stock_Price:  96.89755640878941
curr_Factors:  [96.89755641 -1.37014324 -0.97077122]
mat_Sqrt:  [[ 9.32538117  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00540299 -0.02636992 -0.00480579]
Stock Position:  -0.0054029911616886115
Bond Position:  [-0.93998146]


portfolio before change:  [-1.45979017]
curr_Stock_Price:  96.18583243241903
curr_Factors:  [96.18583243 -1.38690304 -0.93724541]
mat_Sqrt:  [[ 9.41339462  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01381473 -0.02266844  0.05608646]
Stock Position:  -0.013814731446158955
Bond Position:  [-0.13100873]


portfolio before change:  [-1.46705515]
curr_Stock_Price:  96.71053311484663
curr_Factors:  [96.71053311 -1.41656875 -0.93169501]
mat_Sqrt:  [[ 9.2392302   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00075602 -0.03068578 -0.18594926]
Stock Position:  0.0007560204520598086
Bond Position:  [-1.54017029]


portfolio before change:  [-1.4676981]
curr_Stock_Price:  96.11476152791344
curr_Factors:  [96.11476153 -1.227447   -0.92451152]
mat_Sqrt:  [[11.17394124  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00166633 -0.02563076 -0.22903927]
Stock Position:  -0.001666330293639732
Bond Position:  [-1.30753916]


portfolio before change:  [-1.46914449]
curr_Stock_Price:  96.88468395654813
curr_Factors:  [96.88468396 -1.26897655 -0.94602264]
mat_Sqrt:  [[10.5753124   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00315898  0.00560184 -0.23090149]
Stock Position:  -0.0031589757225462933
Bond Position:  [-1.16308813]


portfolio before change:  [-1.47049516]
curr_Stock_Price:  97.2662240502043
curr_Factors:  [97.26622405 -1.4195234  -0.96061983]
mat_Sqrt:  [[ 9.00075591  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 1.80801919e-05 -1.89272464e-02  3.26387777e-02]
Stock Position:  1.8080191857789285e-05
Bond Position:  [-1.47225376]


portfolio before change:  [-1.47068981]
curr_Stock_Price:  96.67989084498605
curr_Factors:  [96.67989084 -1.30372697 -0.96143629]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-1.47068981]
Stock Price:  95.91748341004434
PL:  [-1.47068981]
Settle:  Tensor("sub_224:0", shape=(), dtype=float64)
PL:  Tensor("sub_225:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  113
output_Z_Vals[:, i, :]:  [[ 1.19260232e+02 -2.92559343e+01 -2.92733494e+01]
 [ 1.43023634e-03 -8.82021706e-02 -3.16488699e-02]
 [-4.15914419e-02  3.01772287e-02  1.06883885e-01]
 [ 8.40059046e-02  1.61571337e-01  3.78397608e-02]
 [ 2.19611628e-01 -2.68130132e-02 -5.20995837e-02]
 [ 3.55063975e-02  3.18064513e-02  5.08526057e-02]
 [ 2.24724468e-02  6.29480791e-02 -1.77193930e-02]
 [ 1.18672184e-01  1.30021543e-01  1.12998343e-01]
 [-8.96974948e-02 -3.53097709e-03  8.95281138e-02]
 [-3.87666935e-02  4.15103150e-01  1.81580925e-01]
 [ 5.52834111e-02  2.79722515e-02 -7.58184002e-02]
 [-4.36501479e-02  6.92008872e-02  3.02617863e-03]
 [-7.61718429e-02 -4.11566788e-02 -6.25245327e-02]
 [ 3.02345959e-01  2.35460714e-01  3.22483917e-01]
 [ 1.84896084e-01  2.54875870e-01  5.69693621e-02]
 [-5.59160916e-02 -6.11301388e-02 -1.19517914e-01]
 [-8.94208706e-02  2.89417476e-02 -1.12546040e-01]
 [ 8.87146287e-02 -1.73848938e-01 -1.31054579e-01]
 [ 2.96287999e-02  6.20179737e-02  2.82409271e-02]
 [ 3.02182518e-01 -2.12620766e-01 -5.54324387e-02]
 [ 1.00707835e-01 -5.65373041e-04  1.62421018e-01]
 [ 2.40580334e-03 -7.10613377e-03  2.20622823e-03]
 [-1.15404543e-01  2.72852053e-01  1.86248366e-01]
 [ 1.93015186e-01 -5.92193955e-02  6.03108154e-02]
 [-1.19340022e-02  7.82625615e-03  9.20572734e-03]
 [ 1.03470019e-01  1.05266546e-04  5.63363912e-02]
 [-1.30481613e-01  7.46552523e-02  8.57776790e-02]
 [-7.83618109e-03  3.64116287e-02  1.80914074e-02]
 [ 6.20848838e-02 -6.23725319e-02  9.08311027e-02]
 [ 2.43600984e-02 -2.98351106e-02  2.49386322e-02]
 [-5.66456833e-02  4.00838425e-01  4.41188688e-03]
 [ 3.88321102e-02 -9.47995976e-02 -1.99320209e-02]
 [ 8.70073363e-02 -5.59314077e-02  4.23570240e-02]
 [-1.54654281e-01 -3.17407620e-02  3.60605636e-02]
 [-1.14715512e-01  1.69489860e-02  3.65864806e-02]
 [ 8.47165236e-02 -1.65012150e-01 -1.38726811e-01]
 [-2.20214180e-01 -3.76809427e-01  7.31756900e-02]
 [-5.13734399e-02 -4.18835096e-02  6.35193531e-02]
 [-3.47240255e-02  7.45558394e-02 -2.66848150e-02]
 [-4.84955448e-02  4.25532897e-02  2.71123749e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.26023247 -29.25593426 -29.27334937]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  8.31486419  -9.25153874 -83.50871763]
init_Out:  [2.49911038]
Stock Position:  8.31486419409362
Bond position:  [-828.98730903]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [2.62762989]
curr_Stock_Price:  100.02791980651556
curr_Factors:  [100.02791981  -1.06554454  -1.00432056]
mat_Sqrt:  [[12.6238042   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00057886 -0.02789198 -0.09028542]
Stock Position:  -0.0005788613563401382
Bond Position:  [2.68553219]


portfolio before change:  [2.62840367]
curr_Stock_Price:  99.27113988286047
curr_Factors:  [99.27113988 -1.01548795 -1.00347385]
mat_Sqrt:  [[13.18253824  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0014409   0.00954288  0.30490997]
Stock Position:  -0.0014408975915698873
Bond Position:  [2.77144322]


portfolio before change:  [2.6279278]
curr_Stock_Price:  99.84184271265705
curr_Factors:  [99.84184271 -0.96209058 -1.01603531]
mat_Sqrt:  [[13.81094606  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00694389 0.05109334 0.1079463 ]
Stock Position:  0.006943888344170903
Bond Position:  [1.93463719]


portfolio before change:  [2.63506806]
curr_Stock_Price:  100.83529453340425
curr_Factors:  [100.83529453  -0.9579087   -1.00564312]
mat_Sqrt:  [[14.1531416   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01471649 -0.00847902 -0.14862561]
Stock Position:  0.014716487802455432
Bond Position:  [1.15112668]


portfolio before change:  [2.64720443]
curr_Stock_Price:  101.65019428067315
curr_Factors:  [101.65019428  -1.03543466  -0.99927027]
mat_Sqrt:  [[13.28761665  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00351514 0.01005808 0.14506833]
Stock Position:  0.0035151436432340325
Bond Position:  [2.28988939]


portfolio before change:  [2.64754566]
curr_Stock_Price:  101.66583397522149
curr_Factors:  [101.66583398  -1.02254544  -1.02328842]
mat_Sqrt:  [[13.14258121  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00155835  0.01990593 -0.0505485 ]
Stock Position:  0.0015583547041465454
Bond Position:  [2.48911423]


portfolio before change:  [2.64846287]
curr_Stock_Price:  102.05474211866819
curr_Factors:  [102.05474212  -1.10612756  -1.01849853]
mat_Sqrt:  [[12.19325919  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01189961 0.04111642 0.32235282]
Stock Position:  0.011899608942122759
Bond Position:  [1.43405135]


portfolio before change:  [2.65159792]
curr_Stock_Price:  102.303135536779
curr_Factors:  [102.30313554  -1.15235086  -1.01297184]
mat_Sqrt:  [[11.73549043  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00609381 -0.00111659  0.25539879]
Stock Position:  -0.006093807070574801
Bond Position:  [3.27501349]


portfolio before change:  [2.65245548]
curr_Stock_Price:  102.22959236617598
curr_Factors:  [102.22959237  -1.15148303  -1.03326843]
mat_Sqrt:  [[11.5014111   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00078393 0.13126714 0.51799984]
Stock Position:  0.0007839277055009084
Bond Position:  [2.57231487]


portfolio before change:  [2.6522836]
curr_Stock_Price:  101.60014035683804
curr_Factors:  [101.60014036  -1.17182741  -1.03110889]
mat_Sqrt:  [[11.22460919  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00361075  0.0088456  -0.21628879]
Stock Position:  0.0036107524744985143
Bond Position:  [2.28543064]


portfolio before change:  [2.65170357]
curr_Stock_Price:  101.36037799119538
curr_Factors:  [101.36037799  -0.92467013  -1.03161212]
mat_Sqrt:  [[14.33064159  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00287815  0.02188324  0.00863285]
Stock Position:  -0.002878145566395908
Bond Position:  [2.94343349]


portfolio before change:  [2.64941831]
curr_Stock_Price:  102.28222492467944
curr_Factors:  [102.28222492  -1.0927192   -1.03072794]
mat_Sqrt:  [[12.23485396  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00735581 -0.01301488 -0.17836509]
Stock Position:  -0.007355810770795738
Bond Position:  [3.40178701]


portfolio before change:  [2.64295968]
curr_Stock_Price:  103.2180683429923
curr_Factors:  [103.21806834  -1.31364326  -1.01283087]
mat_Sqrt:  [[10.07815071  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.03713502 0.07445922 0.91995685]
Stock Position:  0.037135015491171826
Bond Position:  [-1.19004489]


portfolio before change:  [2.65787751]
curr_Stock_Price:  103.62379311950724
curr_Factors:  [103.62379312  -1.33885924  -1.03050687]
mat_Sqrt:  [[ 9.69296975  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.02095393 0.08059883 0.16251773]
Stock Position:  0.0209539261697094
Bond Position:  [0.4865522]


portfolio before change:  [2.66912251]
curr_Stock_Price:  104.15754429807699
curr_Factors:  [104.1575443   -1.35358469  -1.03333032]
mat_Sqrt:  [[ 9.57341118  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.008554   -0.01933105 -0.34095134]
Stock Position:  -0.008553999769000682
Bond Position:  [3.56008612]


portfolio before change:  [2.66667887]
curr_Stock_Price:  104.49524346779465
curr_Factors:  [104.49524347  -1.41857947  -1.06602457]
mat_Sqrt:  [[ 8.7105725   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01281741  0.00915218 -0.32106252]
Stock Position:  -0.012817408037478903
Bond Position:  [4.00603705]


portfolio before change:  [2.66956343]
curr_Stock_Price:  104.30926410509744
curr_Factors:  [104.30926411  -1.23351333  -1.08537788]
mat_Sqrt:  [[10.26221779  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00560059 -0.05497586 -0.37386224]
Stock Position:  0.005600589033683901
Bond Position:  [2.08537011]


portfolio before change:  [2.67106479]
curr_Stock_Price:  104.5307881277426
curr_Factors:  [104.53078813  -1.24122204  -1.09377001]
mat_Sqrt:  [[10.11975647  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.0036557  0.01961181 0.0805635 ]
Stock Position:  0.0036556959013478063
Bond Position:  [2.28893201]


portfolio before change:  [2.67147167]
curr_Stock_Price:  104.56381756095405
curr_Factors:  [104.56381756  -1.37966038  -1.07688286]
mat_Sqrt:  [[ 8.96433867  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.03183476 -0.06723659 -0.15813332]
Stock Position:  0.03183476047057271
Bond Position:  [-0.65729242]


portfolio before change:  [2.6724226]
curr_Stock_Price:  104.5962696674313
curr_Factors:  [104.59626967  -1.40707148  -1.07498352]
mat_Sqrt:  [[ 8.7412473   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 1.53121498e-02 -1.78786654e-04  4.63341955e-01]
Stock Position:  0.01531214981776176
Bond Position:  [1.07082885]


portfolio before change:  [2.67568809]
curr_Stock_Price:  104.80078839244906
curr_Factors:  [104.80078839  -1.27255909  -1.07885455]
mat_Sqrt:  [[ 9.98064439  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00026779 -0.00224716  0.00629376]
Stock Position:  0.000267785135190371
Bond Position:  [2.64762399]


portfolio before change:  [2.67607058]
curr_Stock_Price:  104.99316064320757
curr_Factors:  [104.99316064  -1.17634309  -1.07092642]
mat_Sqrt:  [[11.09645505  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00633912  0.0862834   0.53131475]
Stock Position:  -0.006339118597511007
Bond Position:  [3.34163467]


portfolio before change:  [2.67530101]
curr_Stock_Price:  105.18045799643342
curr_Factors:  [105.180458    -1.28527883  -1.0839329 ]
mat_Sqrt:  [[ 9.84009918  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.02071087 -0.01872682  0.17204997]
Stock Position:  0.020710872661955104
Bond Position:  [0.49692193]


portfolio before change:  [2.67077914]
curr_Stock_Price:  104.95912578354952
curr_Factors:  [104.95912578  -1.2214238   -1.09468423]
mat_Sqrt:  [[10.35493247  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00095151  0.00247488  0.02626138]
Stock Position:  -0.0009515096208106496
Bond Position:  [2.77064876]


portfolio before change:  [2.67094108]
curr_Stock_Price:  105.15293966659551
curr_Factors:  [105.15293967  -1.10457109  -1.07258949]
mat_Sqrt:  [[11.92044829  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [9.64496901e-03 3.32882048e-05 1.60712043e-01]
Stock Position:  0.00964496901028478
Bond Position:  [1.65674423]


portfolio before change:  [2.66667135]
curr_Stock_Price:  104.68877722626925
curr_Factors:  [104.68877723  -1.24355807  -1.07641916]
mat_Sqrt:  [[10.28837577  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01079322  0.02360806  0.24469984]
Stock Position:  -0.01079322235757728
Bond Position:  [3.7966006]


portfolio before change:  [2.66298831]
curr_Stock_Price:  105.07398615485177
curr_Factors:  [105.07398615  -1.49233957  -1.07724119]
mat_Sqrt:  [[ 8.04526705  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00039814  0.01151437  0.05160975]
Stock Position:  -0.0003981401485783229
Bond Position:  [2.70482248]


portfolio before change:  [2.66330919]
curr_Stock_Price:  105.11730103874227
curr_Factors:  [105.11730104  -1.66496081  -1.09818139]
mat_Sqrt:  [[ 6.63218748  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01191391 -0.01972393  0.25911585]
Stock Position:  0.011913905238208627
Bond Position:  [1.41095163]


portfolio before change:  [2.66019878]
curr_Stock_Price:  104.8414224834015
curr_Factors:  [104.84142248  -1.21369405  -1.09164894]
mat_Sqrt:  [[10.45526792  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00274315 -0.00943469  0.07114298]
Stock Position:  0.002743146930416385
Bond Position:  [2.37260335]


portfolio before change:  [2.66166226]
curr_Stock_Price:  105.266805105205
curr_Factors:  [105.26680511  -1.12389801  -1.10569845]
mat_Sqrt:  [[11.32374304  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00400888  0.12675624  0.01258589]
Stock Position:  -0.004008878236237149
Bond Position:  [3.08366406]


portfolio before change:  [2.66082171]
curr_Stock_Price:  105.57263493087953
curr_Factors:  [105.57263493  -1.14884853  -1.11184437]
mat_Sqrt:  [[11.00892489  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00293542 -0.02997826 -0.05686051]
Stock Position:  0.0029354172851540046
Bond Position:  [2.35092197]


portfolio before change:  [2.66188079]
curr_Stock_Price:  105.83331177498044
curr_Factors:  [105.83331177  -1.09203608  -1.10382842]
mat_Sqrt:  [[11.77526121  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00800061 -0.01768706  0.1208328 ]
Stock Position:  0.00800061104762696
Bond Position:  [1.81514962]


portfolio before change:  [2.66562866]
curr_Stock_Price:  106.27339828646396
curr_Factors:  [106.27339829  -1.25580033  -1.0865877 ]
mat_Sqrt:  [[10.21264826  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0145029  -0.01003731  0.10287075]
Stock Position:  -0.014502897645507499
Bond Position:  [4.20690087]


portfolio before change:  [2.66433571]
curr_Stock_Price:  106.39881031579613
curr_Factors:  [106.39881032  -1.08160402  -1.08077549]
mat_Sqrt:  [[12.24129273  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00872536  0.00535974  0.10437105]
Stock Position:  -0.008725361676674146
Bond Position:  [3.59270382]


portfolio before change:  [2.67224851]
curr_Stock_Price:  105.54340962972566
curr_Factors:  [105.54340963  -1.20541623  -1.10092298]
mat_Sqrt:  [[10.514793    0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00495858 -0.05218142 -0.39574898]
Stock Position:  0.00495857944796438
Bond Position:  [2.14890313]


portfolio before change:  [2.672179]
curr_Stock_Price:  105.47521784436209
curr_Factors:  [105.47521784  -0.90476584  -1.11341579]
mat_Sqrt:  [[14.0173296   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01533862 -0.1191576   0.20874988]
Stock Position:  -0.015338615707312916
Bond Position:  [4.29002284]


portfolio before change:  [2.67301764]
curr_Stock_Price:  105.45550623595034
curr_Factors:  [105.45550624  -1.02882834  -1.09917868]
mat_Sqrt:  [[12.55704794  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00314477 -0.01324473  0.18120303]
Stock Position:  -0.003144770487503964
Bond Position:  [3.004651]


portfolio before change:  [2.67582255]
curr_Stock_Price:  104.68301672301087
curr_Factors:  [104.68301672  -0.85308958  -1.11756302]
mat_Sqrt:  [[14.58924043  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00262152  0.02357663 -0.07612435]
Stock Position:  -0.0026215221601723284
Bond Position:  [2.9502514]


portfolio before change:  [2.67930449]
curr_Stock_Price:  103.49548560631709
curr_Factors:  [103.49548561  -0.69968268  -1.09482212]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [2.67930449]
Stock Price:  102.546120248561
PL:  [0.13318424]
Settle:  Tensor("sub_226:0", shape=(), dtype=float64)
PL:  Tensor("sub_227:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  114
output_Z_Vals[:, i, :]:  [[ 1.19260232e+02 -2.92559343e+01 -2.92733494e+01]
 [-8.70335007e-02  2.09690480e-01  2.71074149e-02]
 [ 2.76998750e-01  2.03684800e-01 -8.36457773e-02]
 [ 8.76620820e-02  1.94817067e-01  3.82839210e-02]
 [ 1.96220430e-01 -2.30524007e-02 -5.78507542e-02]
 [ 6.85422266e-02  2.87216004e-02 -9.95284626e-02]
 [ 7.09587270e-02  1.49538885e-02 -6.66483127e-02]
 [-1.01932198e-01 -3.72322331e-02 -1.11295808e-01]
 [-3.09033060e-02 -6.32615091e-02  5.32182704e-02]
 [-3.86484425e-02 -1.07699536e-01 -1.31212892e-01]
 [ 5.77377919e-02  9.92232175e-02 -8.22938234e-02]
 [-3.18737567e-02  6.09180569e-02 -4.29264515e-03]
 [-8.99756314e-02 -4.54457841e-03 -5.66575176e-02]
 [-8.29054189e-02 -8.71648103e-02  7.65462922e-02]
 [ 2.60715735e-01  3.38331035e-01  5.35431587e-02]
 [-7.46301291e-02 -9.30878827e-02 -1.09248142e-01]
 [-6.91046410e-02 -6.29520134e-02 -6.55279661e-02]
 [-7.64794442e-02  1.85520889e-01  1.30050558e-01]
 [ 1.24952206e-01  6.92806763e-02  1.43461373e-01]
 [ 9.47780327e-02 -3.76506649e-02  4.84249722e-02]
 [-4.04631497e-02 -1.01791071e-02 -2.89055733e-02]
 [ 9.15507372e-02 -6.36555722e-02  8.86596708e-02]
 [-2.51336729e-02 -7.13693304e-02  1.21589198e-01]
 [-3.72680335e-02 -2.51604197e-02 -7.76888746e-02]
 [-1.16452177e-01  7.63400907e-02  6.42526241e-02]
 [ 1.25441353e-02 -9.13877107e-02  8.42698837e-02]
 [-9.94400944e-02  5.93483229e-02  3.92784872e-03]
 [ 2.03861113e-02  9.80656352e-03  1.11225858e-02]
 [-3.10742738e-02 -4.92018088e-02 -2.51060291e-01]
 [ 7.21706621e-03 -5.09686533e-03 -1.14302753e-01]
 [ 6.40545469e-02  1.80638648e-02  3.97889419e-02]
 [ 2.20407612e-02 -5.77922462e-02 -9.17230156e-02]
 [ 2.88340323e-01 -3.50148066e-01 -3.32179581e-01]
 [-4.37538414e-02 -8.22705265e-02 -8.37035897e-03]
 [-1.49689430e-01  8.58694170e-02  3.17153862e-02]
 [ 8.47165236e-02 -1.65012150e-01 -1.38726811e-01]
 [-1.01207875e-01 -2.07140899e-01 -6.85767183e-03]
 [-3.60088281e-02 -1.11082180e-02 -9.22849435e-03]
 [-4.76202790e-02  9.73824998e-02 -6.39837523e-03]
 [-2.89628923e-01  1.57589989e-01  1.74459487e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.26023247 -29.25593426 -29.27334937]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  8.31486419  -9.25153874 -83.50871763]
init_Out:  [2.49911038]
Stock Position:  8.31486419409362
Bond position:  [-828.98730903]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [8.69776399]
curr_Stock_Price:  100.75795387124349
curr_Factors:  [100.75795387  -1.18635598  -0.98610005]
mat_Sqrt:  [[11.47608288  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00662997  0.06630995  0.07732991]
Stock Position:  -0.006629965877035981
Bond Position:  [9.36578579]


portfolio before change:  [8.69346518]
curr_Stock_Price:  101.58293681535645
curr_Factors:  [101.58293682  -1.47713443  -0.98429742]
mat_Sqrt:  [[ 8.66631548  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.03059936  0.06441079 -0.23861812]
Stock Position:  0.03059936445652174
Bond Position:  [5.58509188]


portfolio before change:  [8.66646959]
curr_Stock_Price:  100.67789274291997
curr_Factors:  [100.67789274  -1.37001772  -0.99518775]
mat_Sqrt:  [[ 9.45667434  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01062815 0.06160657 0.10921337]
Stock Position:  0.010628145377964348
Bond Position:  [7.59645031]


portfolio before change:  [8.6621609]
curr_Stock_Price:  100.18314011097652
curr_Factors:  [100.18314011  -1.18421286  -0.97664408]
mat_Sqrt:  [[11.54373626  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01592348 -0.00728981 -0.1650321 ]
Stock Position:  0.015923482651389882
Bond Position:  [7.06689641]


portfolio before change:  [8.64885925]
curr_Stock_Price:  99.29231333405343
curr_Factors:  [99.29231333 -1.20866075 -0.97654355]
mat_Sqrt:  [[11.16589291  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00438547  0.00908257 -0.283927  ]
Stock Position:  0.004385466810721195
Bond Position:  [8.21341611]


portfolio before change:  [8.65066129]
curr_Stock_Price:  99.46910123438694
curr_Factors:  [99.46910123 -1.18297078 -0.98232833]
mat_Sqrt:  [[11.41065933  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00506021  0.00472883 -0.19012908]
Stock Position:  0.0050602075866211255
Bond Position:  [8.14732699]


portfolio before change:  [8.64995983]
curr_Stock_Price:  99.12920646130972
curr_Factors:  [99.12920646 -0.77277133 -0.99097364]
mat_Sqrt:  [[16.99092098  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00739287 -0.01177387 -0.31749596]
Stock Position:  -0.007392871269667845
Bond Position:  [9.3828093]


portfolio before change:  [8.64885811]
curr_Stock_Price:  99.43688753618531
curr_Factors:  [99.43688754 -0.98104323 -1.00317025]
mat_Sqrt:  [[13.67144943  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00158532 -0.02000505  0.15181691]
Stock Position:  -0.0015853167071656314
Bond Position:  [8.80649707]


portfolio before change:  [8.65066141]
curr_Stock_Price:  98.99380886703187
curr_Factors:  [98.99380887 -0.92712764 -1.02304142]
mat_Sqrt:  [[14.08187131  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00484403 -0.03405758 -0.37431386]
Stock Position:  -0.004844026087297998
Bond Position:  [9.13019001]


portfolio before change:  [8.64426061]
curr_Stock_Price:  100.55080975025409
curr_Factors:  [100.55080975  -0.80339995  -1.05477179]
mat_Sqrt:  [[15.68165297  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00277404  0.03137714 -0.23476137]
Stock Position:  0.0027740422584638584
Bond Position:  [8.36532841]


portfolio before change:  [8.64633791]
curr_Stock_Price:  100.92267745494966
curr_Factors:  [100.92267745  -1.02740784  -1.04985501]
mat_Sqrt:  [[12.6428496   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00246599  0.01926398 -0.01224572]
Stock Position:  -0.002465986131321223
Bond Position:  [8.89521184]


portfolio before change:  [8.64741376]
curr_Stock_Price:  100.93732680681971
curr_Factors:  [100.93732681  -1.01352351  -1.03205213]
mat_Sqrt:  [[13.05177523  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00778884 -0.00143712 -0.16162813]
Stock Position:  -0.007788836189613165
Bond Position:  [9.43359806]


portfolio before change:  [8.65493455]
curr_Stock_Price:  100.12314605451772
curr_Factors:  [100.12314605  -0.97285336  -1.02571831]
mat_Sqrt:  [[13.56956229  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00512405 -0.02756393  0.21836527]
Stock Position:  -0.005124045764605809
Bond Position:  [9.16797014]


portfolio before change:  [8.65959167]
curr_Stock_Price:  99.43793526048725
curr_Factors:  [99.43793526 -0.98454048 -1.04346116]
mat_Sqrt:  [[13.08585719  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.02142625 0.10698967 0.15274373]
Stock Position:  0.0214262506483865
Bond Position:  [6.52900955]


portfolio before change:  [8.67208819]
curr_Stock_Price:  99.98307680440229
curr_Factors:  [99.9830768  -1.20488504 -1.06062826]
mat_Sqrt:  [[10.37591905  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0095735  -0.02943697 -0.31165454]
Stock Position:  -0.00957349716565334
Bond Position:  [9.62927589]


portfolio before change:  [8.68037595]
curr_Stock_Price:  99.2431144606999
curr_Factors:  [99.24311446 -1.3288     -1.04780555]
mat_Sqrt:  [[ 9.21623867  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00912584 -0.01990717 -0.18693305]
Stock Position:  -0.009125837349553308
Bond Position:  [9.58605247]


portfolio before change:  [8.69284857]
curr_Stock_Price:  98.00768903402982
curr_Factors:  [98.00768903 -1.00169111 -1.02541678]
mat_Sqrt:  [[12.90917172  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00349696  0.05866686  0.37099804]
Stock Position:  -0.0034969599470453575
Bond Position:  [9.03557754]


portfolio before change:  [8.69119851]
curr_Stock_Price:  98.80254688976363
curr_Factors:  [98.80254689 -1.23753458 -1.0470676 ]
mat_Sqrt:  [[10.05953762  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01551015 0.02190847 0.40925537]
Stock Position:  0.015510151827096542
Bond Position:  [7.158756]


portfolio before change:  [8.70763494]
curr_Stock_Price:  99.8045703770657
curr_Factors:  [99.80457038 -1.22376012 -1.02439947]
mat_Sqrt:  [[10.53870205  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00983903 -0.01190619  0.13814297]
Stock Position:  0.009839029726573145
Bond Position:  [7.72565481]


portfolio before change:  [8.71593394]
curr_Stock_Price:  100.54989120811183
curr_Factors:  [100.54989121  -1.49437368  -1.01623376]
mat_Sqrt:  [[ 8.16655046  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00570942 -0.00321892 -0.08245955]
Stock Position:  -0.005709423924422316
Bond Position:  [9.2900159]


portfolio before change:  [8.71658908]
curr_Stock_Price:  100.63854881474022
curr_Factors:  [100.63854881  -1.48746675  -1.00512107]
mat_Sqrt:  [[ 8.32237407  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01297764 -0.02012966  0.25292136]
Stock Position:  0.012977635471731619
Bond Position:  [7.41053868]


portfolio before change:  [8.72198143]
curr_Stock_Price:  100.98267662515477
curr_Factors:  [100.98267663  -1.47694374  -1.03062484]
mat_Sqrt:  [[ 8.2266625   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-2.62212027e-04 -2.25689639e-02  3.46860139e-01]
Stock Position:  -0.00026221202700487837
Bond Position:  [8.7484603]


portfolio before change:  [8.72312247]
curr_Stock_Price:  100.80183982464627
curr_Factors:  [100.80183982  -1.48921106  -1.03690688]
mat_Sqrt:  [[ 8.06100842  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00667111 -0.00795642 -0.22162473]
Stock Position:  -0.0066711067696497706
Bond Position:  [9.3955823]


portfolio before change:  [8.72484852]
curr_Stock_Price:  100.71916538866286
curr_Factors:  [100.71916539  -1.16820424  -1.03671179]
mat_Sqrt:  [[11.10527346  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0091277   0.02414086  0.18329485]
Stock Position:  -0.009127697094863956
Bond Position:  [9.64418255]


portfolio before change:  [8.72795543]
curr_Stock_Price:  100.51086382379222
curr_Factors:  [100.51086382  -1.31296671  -1.03313811]
mat_Sqrt:  [[ 9.6230475   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00284588 -0.02889933  0.24039852]
Stock Position:  0.002845879406779753
Bond Position:  [8.44191363]


portfolio before change:  [8.72975583]
curr_Stock_Price:  100.77267998305612
curr_Factors:  [100.77267998  -1.40150938  -1.02880401]
mat_Sqrt:  [[ 8.86892767  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01094901  0.01876759  0.01120506]
Stock Position:  -0.010949007831060623
Bond Position:  [9.8331167]


portfolio before change:  [8.73257679]
curr_Stock_Price:  100.6273027525666
curr_Factors:  [100.62730275  -1.28483712  -1.035214  ]
mat_Sqrt:  [[ 9.8885003   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.0023168  0.00310111 0.03172964]
Stock Position:  0.002316802676453067
Bond Position:  [8.49944318]


portfolio before change:  [8.73364682]
curr_Stock_Price:  100.63055492125619
curr_Factors:  [100.63055492  -1.12727256  -1.05323312]
mat_Sqrt:  [[11.36968108  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0073522  -0.01555898 -0.71620513]
Stock Position:  -0.007352196216729585
Bond Position:  [9.4735024]


portfolio before change:  [8.73562133]
curr_Stock_Price:  100.52306984310762
curr_Factors:  [100.52306984  -1.20199885  -1.05539422]
mat_Sqrt:  [[10.51701249  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00154478 -0.00161177 -0.32607394]
Stock Position:  -0.0015447814651326972
Bond Position:  [8.89090751]


portfolio before change:  [8.73643719]
curr_Stock_Price:  100.71440982523607
curr_Factors:  [100.71440983  -1.46621119  -1.02657682]
mat_Sqrt:  [[ 8.32698033  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00872379 0.0057123  0.11350678]
Stock Position:  0.00872379119525991
Bond Position:  [7.8578257]


portfolio before change:  [8.73462357]
curr_Stock_Price:  100.39391754526457
curr_Factors:  [100.39391755  -1.51230776  -1.00829482]
mat_Sqrt:  [[ 8.07278919  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 2.26153510e-04 -1.82755129e-02 -2.61660233e-01]
Stock Position:  0.00022615350994009155
Bond Position:  [8.71191913]


portfolio before change:  [8.73574887]
curr_Stock_Price:  100.55419109210831
curr_Factors:  [100.55419109  -1.42018104  -1.01813105]
mat_Sqrt:  [[ 8.77919493  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.02409033 -0.11072654 -0.94761588]
Stock Position:  0.0240903257424841
Bond Position:  [6.31336565]


portfolio before change:  [8.73488849]
curr_Stock_Price:  100.48571551437833
curr_Factors:  [100.48571551  -1.51806931  -0.99465391]
mat_Sqrt:  [[ 8.1440888   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00584309 -0.02601622 -0.0238783 ]
Stock Position:  -0.005843090719953409
Bond Position:  [9.32203565]


portfolio before change:  [8.73616979]
curr_Stock_Price:  100.46586805075216
curr_Factors:  [100.46586805  -1.2807114   -0.98588192]
mat_Sqrt:  [[10.41476724  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01353832  0.02715429  0.09047517]
Stock Position:  -0.013538316476901843
Bond Position:  [10.09630851]


portfolio before change:  [8.73926351]
curr_Stock_Price:  100.33057776328785
curr_Factors:  [100.33057776  -0.99333963  -0.99474558]
mat_Sqrt:  [[13.741017    0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00379437 -0.05218142 -0.39574898]
Stock Position:  0.003794365183699377
Bond Position:  [8.35857266]


portfolio before change:  [8.7416567]
curr_Stock_Price:  100.68592050917569
curr_Factors:  [100.68592051  -0.8585561   -1.01096436]
mat_Sqrt:  [[15.52552613  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00695345 -0.0655037  -0.01956303]
Stock Position:  -0.00695345494527068
Bond Position:  [9.44177171]


portfolio before change:  [8.73642371]
curr_Stock_Price:  101.60823699607064
curr_Factors:  [101.608237    -0.80186265  -1.0615252 ]
mat_Sqrt:  [[15.7641245   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00242192 -0.00351273 -0.02632633]
Stock Position:  -0.002421916900004866
Bond Position:  [8.98251041]


portfolio before change:  [8.73897367]
curr_Stock_Price:  101.01900053040704
curr_Factors:  [101.01900053  -0.87442462  -1.05929194]
mat_Sqrt:  [[14.60833222  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00317709  0.03079505 -0.01825278]
Stock Position:  -0.0031770865994819393
Bond Position:  [9.05991979]


portfolio before change:  [8.73716756]
curr_Stock_Price:  101.94396059259071
curr_Factors:  [101.94396059  -0.6461666   -1.06845739]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [8.73716756]
Stock Price:  101.32692126608522
PL:  [7.41024629]
Settle:  Tensor("sub_228:0", shape=(), dtype=float64)
PL:  Tensor("sub_229:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  115
output_Z_Vals[:, i, :]:  [[ 1.19260232e+02 -2.92559343e+01 -2.92733494e+01]
 [ 5.58822575e-03 -1.11385475e-01 -3.79351489e-02]
 [-2.93889761e-02  4.21948361e-02  9.00489946e-02]
 [ 5.60260456e-02  1.59492577e-01  3.25474123e-02]
 [ 1.17206385e-01  3.54448569e-03 -6.37953516e-02]
 [ 6.96383223e-02  2.87546431e-02 -1.17171509e-01]
 [ 6.73889322e-02  1.79494645e-02 -6.04258852e-02]
 [-1.29302881e-01  1.86828240e-01 -2.03446707e-02]
 [-9.02379814e-02 -3.44916935e-02  6.23354867e-02]
 [-5.51308876e-02  4.32158126e-01  1.98959627e-01]
 [ 5.05788634e-02  2.47123970e-03 -6.88067377e-02]
 [-4.78953448e-02  6.14014903e-02  5.38116509e-03]
 [-1.01403599e-01  2.23769903e-02 -5.00565026e-02]
 [-8.76222754e-02 -1.11553191e-01  7.06431616e-02]
 [ 1.86904294e-01  1.78098013e-01 -3.28681349e-02]
 [-8.49086616e-02 -1.36408986e-01 -1.07351439e-01]
 [-7.57360145e-02 -4.00351782e-02 -5.38743244e-02]
 [-4.63152824e-02 -9.78344082e-02  1.25945498e-02]
 [ 2.45543795e-02  6.54928230e-02  2.60671726e-02]
 [ 1.88676732e-01 -4.85313538e-02 -3.19546207e-03]
 [-5.38365744e-02  2.82946010e-03  7.56001527e-03]
 [ 1.68979761e-02 -1.71148485e-02  1.63229812e-02]
 [-8.11865134e-02  1.12086343e-01  3.31296941e-01]
 [-3.53966220e-02 -6.50318890e-03 -8.02996042e-02]
 [-1.31387931e-01  7.21653407e-02  7.82206178e-02]
 [-5.74476994e-02 -1.70000671e-01  1.06702985e-01]
 [ 1.75073757e-01  5.79400091e-02 -1.20815080e-01]
 [ 2.93046285e-02  1.37319311e-02  1.79082222e-02]
 [-1.21911866e-01 -1.63368699e-01 -1.01278392e-01]
 [ 1.71298316e-01  2.30580143e-01  9.65809242e-02]
 [ 6.05545070e-02 -2.48347385e-02  4.56049153e-02]
 [ 7.41538975e-02 -7.61646049e-02 -5.40158694e-02]
 [ 2.42979713e-01 -1.49744219e-01 -2.24618036e-02]
 [-4.32491893e-02 -7.88603496e-02  1.10766742e-02]
 [-1.65285090e-01 -2.91145789e-02  1.62303429e-02]
 [ 1.97337643e-01 -1.43039479e-02 -1.03678959e-02]
 [ 2.15767572e-02 -4.17390508e-03 -9.49455212e-02]
 [-1.27109896e-02  3.71100782e-02 -5.03367230e-02]
 [ 1.17914083e-01 -1.80143061e-01 -3.00732435e-02]
 [-8.81173373e-01  4.36916980e-01  5.39974487e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.26023247 -29.25593426 -29.27334937]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  8.31486419  -9.25153874 -83.50871763]
init_Out:  [2.49911038]
Stock Position:  8.31486419409362
Bond position:  [-828.98730903]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-1.12315318]
curr_Stock_Price:  99.57682608064827
curr_Factors:  [99.57682608 -0.90239528 -1.00148701]
mat_Sqrt:  [[14.83585927  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00033913 -0.03522318 -0.10821842]
Stock Position:  -0.00033912526461651085
Bond Position:  [-1.08938416]


portfolio before change:  [-1.12335138]
curr_Stock_Price:  99.75970625251952
curr_Factors:  [99.75970625 -0.83945772 -0.97832638]
mat_Sqrt:  [[16.19949809  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00061226  0.01334318  0.25688472]
Stock Position:  -0.0006122619390002521
Bond Position:  [-1.06227231]


portfolio before change:  [-1.1233805]
curr_Stock_Price:  99.59037679305929
curr_Factors:  [99.59037679 -0.96912933 -0.95886174]
mat_Sqrt:  [[14.48443278  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00461101 0.05043598 0.09284871]
Stock Position:  0.004611008240373894
Bond Position:  [-1.58259255]


portfolio before change:  [-1.12458379]
curr_Stock_Price:  99.37232066878911
curr_Factors:  [99.37232067 -1.36411991 -0.927054  ]
mat_Sqrt:  [[10.05127708  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01037438  0.00112086 -0.18199038]
Stock Position:  0.0103743764225935
Bond Position:  [-2.15550965]


portfolio before change:  [-1.12364539]
curr_Stock_Price:  99.48874770565313
curr_Factors:  [99.48874771 -1.20076489 -0.95261219]
mat_Sqrt:  [[11.5497925   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00402286  0.00909302 -0.3342577 ]
Stock Position:  0.0040228627326778866
Bond Position:  [-1.52387497]


portfolio before change:  [-1.12216012]
curr_Stock_Price:  99.90530771087256
curr_Factors:  [99.90530771 -1.15441675 -0.9643229 ]
mat_Sqrt:  [[12.00692025  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00462383  0.00567612 -0.17237823]
Stock Position:  0.004623833756370829
Bond Position:  [-1.58410566]


portfolio before change:  [-1.11832704]
curr_Stock_Price:  100.77711901779911
curr_Factors:  [100.77711902  -1.17262589  -0.93568059]
mat_Sqrt:  [[12.23872202  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01051023  0.05908028 -0.05803768]
Stock Position:  -0.010510234222396228
Bond Position:  [-0.05913591]


portfolio before change:  [-1.12408295]
curr_Stock_Price:  101.32406402512308
curr_Factors:  [101.32406403  -1.24604377  -0.9289547 ]
mat_Sqrt:  [[11.51125752  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0068111  -0.01090723  0.17782579]
Stock Position:  -0.006811104261917819
Bond Position:  [-0.43395419]


portfolio before change:  [-1.12952538]
curr_Stock_Price:  102.11515131933639
curr_Factors:  [102.11515132  -1.20864559  -0.92901693]
mat_Sqrt:  [[12.04245823  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-2.79025169e-04  1.36660399e-01  5.67576436e-01]
Stock Position:  -0.0002790251685928676
Bond Position:  [-1.10103268]


portfolio before change:  [-1.12972888]
curr_Stock_Price:  102.35120825118786
curr_Factors:  [102.35120825  -1.13540009  -0.9013997 ]
mat_Sqrt:  [[13.3512542   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00274113  0.00078147 -0.19628647]
Stock Position:  0.002741132294488459
Bond Position:  [-1.41028708]


portfolio before change:  [-1.13281062]
curr_Stock_Price:  101.29126570640224
curr_Factors:  [101.29126571  -0.92522116  -0.91978848]
mat_Sqrt:  [[16.00643041  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00282459  0.01941686  0.01535097]
Stock Position:  -0.0028245860081395676
Bond Position:  [-0.84670473]


portfolio before change:  [-1.13075405]
curr_Stock_Price:  100.52569838415376
curr_Factors:  [100.52569838  -1.01641411  -0.91639375]
mat_Sqrt:  [[14.55021165  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00763175  0.00707623 -0.14279727]
Stock Position:  -0.007631749325373215
Bond Position:  [-0.36356712]


portfolio before change:  [-1.12420607]
curr_Stock_Price:  99.66175064431276
curr_Factors:  [99.66175064 -0.76734758 -0.93038056]
mat_Sqrt:  [[18.24796966  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00416937 -0.03527622  0.20152528]
Stock Position:  -0.00416937296893073
Bond Position:  [-0.70867906]


portfolio before change:  [-1.12440439]
curr_Stock_Price:  99.68806824841856
curr_Factors:  [99.68806825 -0.63802887 -0.94762457]
mat_Sqrt:  [[20.41750363  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00905074  0.05631954 -0.09376364]
Stock Position:  0.009050743345060088
Bond Position:  [-2.02665551]


portfolio before change:  [-1.12315008]
curr_Stock_Price:  99.85464640859014
curr_Factors:  [99.85464641 -0.67883393 -0.94017591]
mat_Sqrt:  [[19.78068103  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00557836 -0.04313631 -0.30624378]
Stock Position:  -0.005578359363511155
Bond Position:  [-0.56612498]


portfolio before change:  [-1.13316937]
curr_Stock_Price:  101.63806026408871
curr_Factors:  [101.63806026  -0.74585463  -0.95854026]
mat_Sqrt:  [[18.48617552  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0047477  -0.01266023 -0.15368845]
Stock Position:  -0.004747697470018675
Bond Position:  [-0.65062261]


portfolio before change:  [-1.1339905]
curr_Stock_Price:  101.79388270408229
curr_Factors:  [101.7938827   -0.70562739  -0.95522152]
mat_Sqrt:  [[19.33856122  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00239265 -0.03093796  0.03592874]
Stock Position:  -0.002392654950509136
Bond Position:  [-0.89043287]


portfolio before change:  [-1.13593483]
curr_Stock_Price:  102.55998244491214
curr_Factors:  [102.55998244  -0.78614471  -0.95831161]
mat_Sqrt:  [[17.92132794  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00176138 0.02071065 0.07436239]
Stock Position:  0.0017613837717074866
Bond Position:  [-1.31658232]


portfolio before change:  [-1.13964824]
curr_Stock_Price:  100.54518428715434
curr_Factors:  [100.54518429  -0.5720166   -0.94518909]
mat_Sqrt:  [[22.05196097  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0084696  -0.01534696 -0.00911576]
Stock Position:  0.00846960443372543
Bond Position:  [-1.99122618]


portfolio before change:  [-1.13755977]
curr_Stock_Price:  100.8211590657443
curr_Factors:  [100.82115907  -0.50012965  -0.91842266]
mat_Sqrt:  [[24.40519285  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00213972  0.00089475  0.02156662]
Stock Position:  -0.0021397223397534855
Bond Position:  [-0.92183048]


portfolio before change:  [-1.140135]
curr_Stock_Price:  101.97083842661038
curr_Factors:  [101.97083843  -0.45326991  -0.92495813]
mat_Sqrt:  [[25.69917376  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00076999 -0.00541219  0.04656492]
Stock Position:  0.0007699853467490406
Bond Position:  [-1.21865105]


portfolio before change:  [-1.14119601]
curr_Stock_Price:  100.79071534651314
curr_Factors:  [100.79071535  -0.58414625  -0.91567062]
mat_Sqrt:  [[22.49356742  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-4.74213424e-04  3.54448138e-02  9.45097957e-01]
Stock Position:  -0.0004742134239987581
Bond Position:  [-1.0933997]


portfolio before change:  [-1.14069406]
curr_Stock_Price:  99.44399113245183
curr_Factors:  [99.44399113 -0.5523125  -0.88891754]
mat_Sqrt:  [[23.53207867  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00220786 -0.00205649 -0.22907242]
Stock Position:  -0.002207863674574307
Bond Position:  [-0.92113529]


portfolio before change:  [-1.14103442]
curr_Stock_Price:  99.54599147707526
curr_Factors:  [99.54599148 -0.50657227 -0.87078001]
mat_Sqrt:  [[25.11003294  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00452241  0.02282068  0.22314165]
Stock Position:  -0.004522411952507031
Bond Position:  [-0.69084643]


portfolio before change:  [-1.13301804]
curr_Stock_Price:  97.7543065782028
curr_Factors:  [97.75430658 -0.47182835 -0.88403238]
mat_Sqrt:  [[25.19376445  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00158993 -0.05375893  0.30439392]
Stock Position:  -0.001589934776309162
Bond Position:  [-0.97759507]


portfolio before change:  [-1.1314015]
curr_Stock_Price:  96.6607096826686
curr_Factors:  [96.66070968 -0.58781432 -0.85585138]
mat_Sqrt:  [[22.81780854  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00665745  0.01832224 -0.3446518 ]
Stock Position:  0.006657452929974051
Bond Position:  [-1.77491562]


portfolio before change:  [-1.13930614]
curr_Stock_Price:  95.50670099417587
curr_Factors:  [95.50670099 -0.40046337 -0.87168558]
mat_Sqrt:  [[26.76372602  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00124477 0.00434242 0.05108717]
Stock Position:  0.0012447701040045527
Bond Position:  [-1.25819002]


portfolio before change:  [-1.14006468]
curr_Stock_Price:  95.02367369873998
curr_Factors:  [95.0236737  -0.33405883 -0.88910819]
mat_Sqrt:  [[27.96514847  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00524951 -0.05166172 -0.28891906]
Stock Position:  -0.0052495123549830495
Bond Position:  [-0.64123673]


portfolio before change:  [-1.13963743]
curr_Stock_Price:  94.92701640097613
curr_Factors:  [94.9270164  -0.15075177 -0.88937683]
mat_Sqrt:  [[33.54808363  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00587117 0.07291584 0.27551849]
Stock Position:  0.00587116600211839
Bond Position:  [-1.6969697]


portfolio before change:  [-1.13863112]
curr_Stock_Price:  95.13454749932062
curr_Factors:  [95.1345475  -0.22439672 -0.91107492]
mat_Sqrt:  [[30.56392951  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00226484 -0.00785343  0.13009813]
Stock Position:  0.0022648377462119876
Bond Position:  [-1.35409543]


portfolio before change:  [-1.13823077]
curr_Stock_Price:  95.38605365758227
curr_Factors:  [95.38605366 -0.46650818 -0.88518189]
mat_Sqrt:  [[24.68614895  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00247756 -0.02408536 -0.15409224]
Stock Position:  0.0024775590892348875
Bond Position:  [-1.37455535]


portfolio before change:  [-1.13597736]
curr_Stock_Price:  96.36493623025024
curr_Factors:  [96.36493623 -0.61556295 -0.84586753]
mat_Sqrt:  [[22.34744339  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01049464 -0.04735328 -0.06407727]
Stock Position:  0.010494638398964255
Bond Position:  [-2.14729252]


portfolio before change:  [-1.14592818]
curr_Stock_Price:  95.44233237983259
curr_Factors:  [95.44233238 -0.67391888 -0.85176284]
mat_Sqrt:  [[20.75610652  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00207285 -0.02493783  0.03159867]
Stock Position:  -0.0020728520579971466
Bond Position:  [-0.94809035]


portfolio before change:  [-1.14383518]
curr_Stock_Price:  94.37543317395968
curr_Factors:  [94.37543317 -0.80267732 -0.83980372]
mat_Sqrt:  [[18.26158657  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00891072 -0.00920684  0.04630065]
Stock Position:  -0.008910716475845504
Bond Position:  [-0.30288245]


portfolio before change:  [-1.14675374]
curr_Stock_Price:  94.69871777574104
curr_Factors:  [94.69871778 -0.88912701 -0.83815506]
mat_Sqrt:  [[16.83429866  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0115747  -0.00452331 -0.02957672]
Stock Position:  0.011574701327328945
Bond Position:  [-2.24286311]


portfolio before change:  [-1.14794179]
curr_Stock_Price:  94.62029860576854
curr_Factors:  [94.62029861 -0.85993202 -0.82294674]
mat_Sqrt:  [[17.58406803  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 1.18761717e-04 -1.31990468e-03 -2.70853144e-01]
Stock Position:  0.00011876171736889847
Bond Position:  [-1.15917906]


portfolio before change:  [-1.1480349]
curr_Stock_Price:  95.05640969970693
curr_Factors:  [95.0564097  -0.72475022 -0.84669756]
mat_Sqrt:  [[19.74741741  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00111548  0.01173524 -0.14359666]
Stock Position:  -0.001115475081896175
Bond Position:  [-1.04200185]


portfolio before change:  [-1.1496416]
curr_Stock_Price:  96.38000039691052
curr_Factors:  [96.3800004  -0.58644328 -0.86115385]
mat_Sqrt:  [[22.66227371  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00472698 -0.05696624 -0.08579059]
Stock Position:  0.004726980877854315
Bond Position:  [-1.60522801]


portfolio before change:  [-1.14450052]
curr_Stock_Price:  97.51005484635941
curr_Factors:  [97.51005485 -0.39155459 -0.89313961]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-1.14450052]
Stock Price:  97.48809674541643
PL:  [-1.14450052]
Settle:  Tensor("sub_230:0", shape=(), dtype=float64)
PL:  Tensor("sub_231:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  116
output_Z_Vals[:, i, :]:  [[ 1.19260232e+02 -2.92559343e+01 -2.92733494e+01]
 [ 4.03706775e-03 -1.27034308e-01 -3.91946428e-02]
 [-4.78101995e-02  1.85329344e-02  1.03274570e-01]
 [-1.03337159e-01  4.57508827e-02  7.43303544e-03]
 [ 1.17797556e-01  4.10710922e-03 -6.67285538e-02]
 [ 2.88340561e-02  2.91927697e-02  7.05557426e-02]
 [-4.44241712e-02  8.65901580e-03  3.91817764e-02]
 [ 1.98986783e-01  2.65455872e-01  1.66526076e-01]
 [ 4.72577741e-02  8.26742223e-03 -8.53902881e-02]
 [-4.46414339e-02  4.21225881e-01  1.87819873e-01]
 [ 5.96899411e-02  4.61685552e-02 -8.21092801e-02]
 [-7.56771496e-02  7.56152571e-02  2.25071529e-02]
 [-8.66123341e-03 -1.48079340e-01 -3.28108115e-02]
 [ 3.27510723e-01  2.50108375e-01  3.36592065e-01]
 [ 8.60969942e-02 -5.26732037e-02 -1.64614677e-01]
 [-6.88354639e-02 -8.94670701e-02 -1.21318029e-01]
 [-7.38227257e-02 -4.92958779e-02 -4.05094029e-02]
 [-6.41869115e-02 -1.06525330e-01  2.83975116e-02]
 [ 2.77003948e-02  6.34066827e-02  2.75099374e-02]
 [ 3.16322074e-01 -1.57734146e-01 -8.18282573e-02]
 [ 1.62663970e-01  1.10280913e-02  2.29201361e-01]
 [-3.66549612e-02  1.98703627e-02 -3.58426669e-02]
 [-1.63957856e-01  4.55845737e-01  2.70381911e-01]
 [ 3.57766996e-01 -4.60844929e-02  1.08106984e-01]
 [-1.47140134e-01 -5.68990487e-02 -1.41123509e-01]
 [ 1.07618228e-01 -8.90985263e-03  5.65619541e-02]
 [-1.41705542e-01  7.20805387e-02  8.82198313e-02]
 [-5.07806065e-02  7.36225950e-02  2.93687317e-02]
 [ 6.20653230e-02 -6.26132440e-02  8.90956886e-02]
 [-2.73648660e-02 -5.56453276e-02 -7.60235654e-02]
 [-1.20785806e-01  5.97961061e-01 -1.29612546e-02]
 [ 4.92410034e-02  7.36402832e-02  1.76939688e-01]
 [-6.60716506e-02  2.27031835e-02  8.38011601e-02]
 [-2.14095901e-01 -2.57542802e-02  2.95081360e-02]
 [-1.30806672e-01  6.49427840e-02  3.58330812e-02]
 [ 8.47165236e-02 -1.65012150e-01 -1.38726811e-01]
 [-2.99252508e-01 -5.41784873e-01  1.51940028e-01]
 [-6.35585843e-02 -7.99589203e-02  1.22979026e-01]
 [-1.73831070e-02  3.81899381e-02 -3.75654560e-02]
 [ 2.80591036e-01 -1.84596059e-02 -2.82989227e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.26023247 -29.25593426 -29.27334937]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  8.31486419  -9.25153874 -83.50871763]
init_Out:  [2.49911038]
Stock Position:  8.31486419409362
Bond position:  [-828.98730903]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-0.78525776]
curr_Stock_Price:  99.61746359597012
curr_Factors:  [99.6174636  -0.66508511 -0.97308949]
mat_Sqrt:  [[19.35910571  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00037417 -0.04017178 -0.11181141]
Stock Position:  -0.00037416588629166813
Bond Position:  [-0.7479843]


portfolio before change:  [-0.78520157]
curr_Stock_Price:  99.21738068089851
curr_Factors:  [99.21738068 -0.58651779 -0.98201206]
mat_Sqrt:  [[20.67206695  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00126987  0.00586063  0.2946136 ]
Stock Position:  -0.0012698704935824692
Bond Position:  [-0.65920834]


portfolio before change:  [-0.7857653]
curr_Stock_Price:  99.59642068097854
curr_Factors:  [99.59642068 -0.56627508 -0.9828596 ]
mat_Sqrt:  [[21.15743848  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00475665  0.0144677   0.02120438]
Stock Position:  -0.0047566540069529945
Bond Position:  [-0.31201959]


portfolio before change:  [-0.78670106]
curr_Stock_Price:  99.78494549361984
curr_Factors:  [99.78494549 -0.71760548 -0.96718635]
mat_Sqrt:  [[18.50841503  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00563434  0.00129878 -0.19035799]
Stock Position:  0.005634339394856027
Bond Position:  [-1.3489233]


portfolio before change:  [-0.77971625]
curr_Stock_Price:  101.0545585102027
curr_Factors:  [101.05455851  -0.5522331   -0.9654361 ]
mat_Sqrt:  [[22.15340821  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.0019857  0.00923156 0.20127589]
Stock Position:  0.0019856963056530215
Bond Position:  [-0.98037991]


portfolio before change:  [-0.77767671]
curr_Stock_Price:  102.14339259434871
curr_Factors:  [102.14339259  -0.30590229  -0.97336227]
mat_Sqrt:  [[28.42056704  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00127382  0.00273822  0.1117747 ]
Stock Position:  -0.0012738186997978988
Bond Position:  [-0.64756455]


portfolio before change:  [-0.77810894]
curr_Stock_Price:  102.4191613222891
curr_Factors:  [102.41916132  -0.30526285  -0.97850636]
mat_Sqrt:  [[28.36921571  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00845398 0.08394452 0.47505254]
Stock Position:  0.00845398124633405
Bond Position:  [-1.64395861]


portfolio before change:  [-0.78761744]
curr_Stock_Price:  101.31873409436037
curr_Factors:  [101.31873409  -0.6148816   -0.92086507]
mat_Sqrt:  [[21.81340447  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00137718  0.00261439 -0.24359472]
Stock Position:  0.001377181563569394
Bond Position:  [-0.92715173]


portfolio before change:  [-0.78829619]
curr_Stock_Price:  100.91003895348749
curr_Factors:  [100.91003895  -0.436819    -0.96026084]
mat_Sqrt:  [[24.95688109  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [1.83241754e-04 1.33203319e-01 5.35797820e-01]
Stock Position:  0.00018324175438446706
Bond Position:  [-0.80678712]


portfolio before change:  [-0.78832248]
curr_Stock_Price:  101.31694088083584
curr_Factors:  [101.31694088  -0.39388984  -0.9681016 ]
mat_Sqrt:  [[25.95235069  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0017001   0.01459978 -0.23423492]
Stock Position:  0.001700097302575411
Bond Position:  [-0.96057114]


portfolio before change:  [-0.78657634]
curr_Stock_Price:  102.41465539798429
curr_Factors:  [102.4146554   -0.47932795  -0.97309611]
mat_Sqrt:  [[23.96527155  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00288461  0.02391164  0.06420664]
Stock Position:  -0.0028846123684981655
Bond Position:  [-0.49114976]


portfolio before change:  [-0.79022065]
curr_Stock_Price:  103.65673460584655
curr_Factors:  [103.65673461  -0.55038597  -0.96449425]
mat_Sqrt:  [[22.78732798  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00084179 -0.0468268  -0.09360011]
Stock Position:  -0.0008417882251818257
Bond Position:  [-0.70296364]


portfolio before change:  [-0.7902195]
curr_Stock_Price:  103.55097047085863
curr_Factors:  [103.55097047  -0.46025636  -0.92001836]
mat_Sqrt:  [[26.0440476   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01546131 0.07909121 0.96020347]
Stock Position:  0.015461308761611016
Bond Position:  [-2.39125303]


portfolio before change:  [-0.79853192]
curr_Stock_Price:  103.03267733743833
curr_Factors:  [103.03267734  -0.52046939  -0.92475777]
mat_Sqrt:  [[24.28403226  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00210571 -0.01665673 -0.46959985]
Stock Position:  0.0021057107447728595
Bond Position:  [-1.01548893]


portfolio before change:  [-0.79948145]
curr_Stock_Price:  102.64202961078982
curr_Factors:  [102.64202961  -0.44785767  -0.92006443]
mat_Sqrt:  [[26.13630644  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00366959 -0.02829197 -0.34608657]
Stock Position:  -0.0036695863200097182
Bond Position:  [-0.42282766]


portfolio before change:  [-0.79474081]
curr_Stock_Price:  101.3357510535454
curr_Factors:  [101.33575105  -0.63682789  -0.90201757]
mat_Sqrt:  [[21.74956623  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00383293 -0.01558873 -0.11556205]
Stock Position:  -0.0038329264180076545
Bond Position:  [-0.40632833]


portfolio before change:  [-0.79575342]
curr_Stock_Price:  101.58668661531715
curr_Factors:  [101.58668662  -0.62679149  -0.9017741 ]
mat_Sqrt:  [[22.02871641  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0027755  -0.03368627  0.0810102 ]
Stock Position:  -0.002775502882220408
Bond Position:  [-0.51379928]


portfolio before change:  [-0.79903051]
curr_Stock_Price:  102.74426576183639
curr_Factors:  [102.74426576  -0.69041242  -0.89104785]
mat_Sqrt:  [[21.13187931  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00165404 0.02005095 0.07847819]
Stock Position:  0.00165404081002683
Bond Position:  [-0.96897372]


portfolio before change:  [-0.79857181]
curr_Stock_Price:  103.09481719821592
curr_Factors:  [103.0948172   -0.54747495  -0.87601217]
mat_Sqrt:  [[24.83271643  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01190149 -0.04987992 -0.23343324]
Stock Position:  0.011901487865570265
Bond Position:  [-2.02555353]


portfolio before change:  [-0.7856986]
curr_Stock_Price:  104.19774028110305
curr_Factors:  [104.19774028  -0.74219305  -0.89513493]
mat_Sqrt:  [[20.26636188  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01034888 0.00348739 0.65384769]
Stock Position:  0.010348884871130178
Bond Position:  [-1.86402902]


portfolio before change:  [-0.76505907]
curr_Stock_Price:  106.21462908375422
curr_Factors:  [106.21462908  -1.01318217  -0.90248669]
mat_Sqrt:  [[15.63939408  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00277877  0.00628356 -0.10224915]
Stock Position:  -0.0027787690588830616
Bond Position:  [-0.46991314]


portfolio before change:  [-0.7655406]
curr_Stock_Price:  106.3667782573267
curr_Factors:  [106.36677826  -0.93304649  -0.91212125]
mat_Sqrt:  [[16.80582502  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0057716   0.14415108  0.77132433]
Stock Position:  -0.00577159962209663
Bond Position:  [-0.15163414]


portfolio before change:  [-0.76903262]
curr_Stock_Price:  106.96852948065084
curr_Factors:  [106.96852948  -0.66139399  -0.91146414]
mat_Sqrt:  [[22.19077241  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01706314 -0.0145732   0.30839914]
Stock Position:  0.01706314401616857
Bond Position:  [-2.59425204]


portfolio before change:  [-0.78021625]
curr_Stock_Price:  106.3321094799021
curr_Factors:  [106.33210948  -0.25669156  -0.90142899]
mat_Sqrt:  [[33.39635473  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00531244 -0.01799306 -0.40258609]
Stock Position:  -0.005312435381599985
Bond Position:  [-0.21533379]


portfolio before change:  [-0.78623642]
curr_Stock_Price:  107.4602659869249
curr_Factors:  [107.46026599  -0.44837513  -0.89843894]
mat_Sqrt:  [[27.94692259  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0042557  -0.00281754  0.16135551]
Stock Position:  0.004255704244462756
Bond Position:  [-1.24355553]


portfolio before change:  [-0.79907027]
curr_Stock_Price:  104.48111285919575
curr_Factors:  [104.48111286  -0.38549252  -0.92886528]
mat_Sqrt:  [[28.06851588  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00434069  0.02279387  0.25166662]
Stock Position:  -0.0043406866901947476
Bond Position:  [-0.3455505]


portfolio before change:  [-0.8022126]
curr_Stock_Price:  105.19508636192859
curr_Factors:  [105.19508636  -0.69626322  -0.91434057]
mat_Sqrt:  [[21.01450263  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00204072  0.02328151  0.08378082]
Stock Position:  -0.002040724577481772
Bond Position:  [-0.58753841]


portfolio before change:  [-0.80078713]
curr_Stock_Price:  104.46058196255375
curr_Factors:  [104.46058196  -0.4859738   -0.92754068]
mat_Sqrt:  [[25.4138758   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00309419 -0.01980005  0.2541652 ]
Stock Position:  0.0030941851580148904
Bond Position:  [-1.12400751]


portfolio before change:  [-0.79913078]
curr_Stock_Price:  105.04130299232094
curr_Factors:  [105.04130299  -0.4628106   -0.93114302]
mat_Sqrt:  [[26.05995968  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00170069 -0.0175966  -0.21687407]
Stock Position:  -0.0017006882595789056
Bond Position:  [-0.62048827]


portfolio before change:  [-0.801401]
curr_Stock_Price:  106.33057759408669
curr_Factors:  [106.33057759  -0.37628698  -0.89703892]
mat_Sqrt:  [[29.76183903  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00362855  0.18909189 -0.03697485]
Stock Position:  -0.0036285466995767297
Bond Position:  [-0.41557553]


portfolio before change:  [-0.80649834]
curr_Stock_Price:  107.72104792286557
curr_Factors:  [107.72104792  -0.30690153  -0.8786112 ]
mat_Sqrt:  [[32.91841627  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.0026508  0.0232871  0.50475968]
Stock Position:  0.002650797327801639
Bond Position:  [-1.092045]


portfolio before change:  [-0.81109661]
curr_Stock_Price:  106.03787235834739
curr_Factors:  [106.03787236  -0.42472195  -0.8565861 ]
mat_Sqrt:  [[29.44394447  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00164311  0.00717938  0.23906138]
Stock Position:  -0.0016431092250515302
Bond Position:  [-0.6368648]


portfolio before change:  [-0.81272658]
curr_Stock_Price:  106.98142602162277
curr_Factors:  [106.98142602  -0.50374104  -0.84524562]
mat_Sqrt:  [[27.76201092  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00751882 -0.00814422  0.0841785 ]
Stock Position:  -0.007518819559720369
Bond Position:  [-0.00835255]


portfolio before change:  [-0.81679321]
curr_Stock_Price:  107.52214741107156
curr_Factors:  [107.52214741  -0.55787653  -0.81790081]
mat_Sqrt:  [[27.16473186  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00448432  0.02053671  0.10222181]
Stock Position:  -0.004484324004517072
Bond Position:  [-0.33462907]


portfolio before change:  [-0.81883749]
curr_Stock_Price:  107.96869162778003
curr_Factors:  [107.96869163  -0.52091861  -0.81433542]
mat_Sqrt:  [[28.40562705  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0018355  -0.05218142 -0.39574898]
Stock Position:  0.0018354967618333423
Bond Position:  [-1.01701368]


portfolio before change:  [-0.81460284]
curr_Stock_Price:  110.34504432158256
curr_Factors:  [110.34504432  -0.58256442  -0.82006689]
mat_Sqrt:  [[27.13924695  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01039921 -0.17132742  0.43344261]
Stock Position:  -0.010399209145625601
Bond Position:  [0.33289835]


portfolio before change:  [-0.80713458]
curr_Stock_Price:  109.63088895421363
curr_Factors:  [109.63088895  -0.68951216  -0.83764905]
mat_Sqrt:  [[23.80648338  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00170206 -0.02528523  0.35082493]
Stock Position:  -0.0017020626469822866
Bond Position:  [-0.62053593]


portfolio before change:  [-0.80642771]
curr_Stock_Price:  109.17001673375175
curr_Factors:  [109.17001673  -0.63164497  -0.86895283]
mat_Sqrt:  [[24.3445657   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00098852  0.01207672 -0.10716379]
Stock Position:  -0.0009885189132554505
Bond Position:  [-0.69851109]


portfolio before change:  [-0.80663385]
curr_Stock_Price:  109.29021216616849
curr_Factors:  [109.29021217  -0.80355408  -0.87435142]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-0.80663385]
Stock Price:  109.26634770140015
PL:  [-10.07298155]
Settle:  Tensor("sub_232:0", shape=(), dtype=float64)
PL:  Tensor("sub_233:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  117
output_Z_Vals[:, i, :]:  [[ 1.19260232e+02 -2.92559343e+01 -2.92733494e+01]
 [-1.09782779e-01  2.84748854e-01  4.20584026e-02]
 [-5.05783476e-02 -5.46930053e-02 -4.36989445e-02]
 [ 8.86678951e-02  2.03962954e-01  3.84061093e-02]
 [ 2.16118782e-01 -2.83899560e-02 -5.52135712e-02]
 [ 6.86766428e-02  3.33718220e-02 -1.17368908e-03]
 [ 3.76207203e-03  6.14242929e-02 -5.10227535e-02]
 [-1.06951959e-01  2.40079409e-01  2.18613364e-02]
 [-9.14373851e-02 -3.96687666e-02  6.22533381e-02]
 [-5.27817195e-02  1.43245148e-01  2.51009071e-02]
 [ 5.36244481e-02  8.06994918e-02 -7.63467205e-02]
 [-5.70851938e-02  5.27043320e-02  6.48671155e-03]
 [-1.07456344e-01  3.93320225e-02 -4.79476029e-02]
 [ 1.69897264e-02  3.88432636e-02  1.52002476e-01]
 [ 2.33076397e-01  3.21098038e-01  6.98516052e-02]
 [-7.31000703e-02 -8.87714851e-02 -9.92184391e-02]
 [-6.84986025e-02 -6.10506621e-02 -6.13514931e-02]
 [-7.89304850e-02  1.66134171e-01  1.26758520e-01]
 [ 1.19946274e-01  6.87537402e-02  1.40734632e-01]
 [ 8.49262343e-02 -3.45286026e-02  5.27720985e-02]
 [-4.43250017e-03 -3.81186399e-02  1.57417445e-04]
 [ 1.17246370e-01 -6.33262912e-02  1.44549880e-01]
 [-1.18687324e-02 -1.24614301e-01  1.57870408e-01]
 [-6.79235875e-02 -5.81763559e-04 -8.22044472e-02]
 [-3.93816044e-01  1.33555110e-01  4.47241794e-02]
 [-4.06878537e-02 -1.51031680e-01  1.01314817e-01]
 [ 8.58491959e-02  4.82692735e-02 -7.22522255e-02]
 [-4.76010759e-02  7.11313261e-02  2.84307371e-02]
 [-8.23402331e-02 -7.81024423e-02 -1.96214628e-01]
 [ 7.99383056e-03 -7.17276946e-03 -1.16766727e-01]
 [ 5.50044989e-02  4.56901667e-02  3.65350834e-02]
 [ 2.21862736e-02 -6.62685188e-02 -8.79474467e-02]
 [ 2.91449476e-01 -2.99143831e-01 -2.45007619e-01]
 [-4.80944621e-02 -8.35905981e-02 -2.25265860e-03]
 [-1.76234628e-01  5.95016661e-02  2.08300692e-02]
 [ 5.56211217e-02 -1.16817979e-01 -7.37003623e-02]
 [ 2.59418168e-02  3.07905391e-02 -9.55328488e-02]
 [-1.83358329e-02  1.64252863e-02 -8.21934494e-02]
 [-1.75467079e-02 -3.40251235e-02  1.58897517e-02]
 [-9.18260541e-01  4.54665807e-01  5.62558625e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.26023247 -29.25593426 -29.27334937]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  8.31486419  -9.25153874 -83.50871763]
init_Out:  [2.49911038]
Stock Position:  8.31486419409362
Bond position:  [-828.98730903]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [9.85068472]
curr_Stock_Price:  100.89661166466487
curr_Factors:  [100.89661166  -1.06690456  -0.96348439]
mat_Sqrt:  [[13.24615605  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00708473  0.09004549  0.11998092]
Stock Position:  -0.007084731570700195
Bond Position:  [10.56551013]


portfolio before change:  [9.85631423]
curr_Stock_Price:  100.28843859015171
curr_Factors:  [100.28843859  -1.18615527  -0.93855309]
mat_Sqrt:  [[11.98123966  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00508382 -0.01729545 -0.12466093]
Stock Position:  -0.005083824903450654
Bond Position:  [10.36616309]


portfolio before change:  [9.85374239]
curr_Stock_Price:  101.04922207365219
curr_Factors:  [101.04922207  -1.47409957  -0.95952354]
mat_Sqrt:  [[ 8.86388043  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01148186 0.06449875 0.10956194]
Stock Position:  0.01148185728861047
Bond Position:  [8.69350965]


portfolio before change:  [9.84801159]
curr_Stock_Price:  100.4554537335378
curr_Factors:  [100.45545373  -1.30678128  -0.95239917]
mat_Sqrt:  [[10.49116982  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01945592 -0.00897769 -0.15750895]
Stock Position:  0.01945591743218644
Bond Position:  [7.89355857]


portfolio before change:  [9.8660807]
curr_Stock_Price:  101.33345694688037
curr_Factors:  [101.33345695  -1.2682554   -0.94846721]
mat_Sqrt:  [[11.0418657   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.006276    0.0105531  -0.00334821]
Stock Position:  0.0062759974782087054
Bond Position:  [9.23011218]


portfolio before change:  [9.86951649]
curr_Stock_Price:  101.69705749054168
curr_Factors:  [101.69705749  -1.21641036  -0.99761684]
mat_Sqrt:  [[11.11139506  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00045601  0.01942407 -0.14555371]
Stock Position:  -0.0004560125408874366
Bond Position:  [9.91589163]


portfolio before change:  [9.87104557]
curr_Stock_Price:  101.06218577199598
curr_Factors:  [101.06218577  -1.08906371  -0.98117976]
mat_Sqrt:  [[12.74950644  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0075525   0.07591978  0.06236431]
Stock Position:  -0.007552504778403105
Bond Position:  [10.63431821]


portfolio before change:  [9.87181987]
curr_Stock_Price:  101.1356801126207
curr_Factors:  [101.13568011  -1.21670621  -0.95226553]
mat_Sqrt:  [[11.55931072  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00689957 -0.01254437  0.17759145]
Stock Position:  -0.006899565272975072
Bond Position:  [10.5696121]


portfolio before change:  [9.8793003]
curr_Stock_Price:  100.24299406911834
curr_Factors:  [100.24299407  -1.15488115  -0.94394582]
mat_Sqrt:  [[12.28980692  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0035769   0.04529809  0.0716059 ]
Stock Position:  -0.003576902771619827
Bond Position:  [10.23785975]


portfolio before change:  [9.87854222]
curr_Stock_Price:  100.81273244328753
curr_Factors:  [100.81273244  -1.49344157  -0.94094134]
mat_Sqrt:  [[ 8.83641943  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00454074  0.02551942 -0.21779594]
Stock Position:  0.004540740878294039
Bond Position:  [9.42077772]


portfolio before change:  [9.8761309]
curr_Stock_Price:  100.0223352985316
curr_Factors:  [100.0223353   -1.17560315  -0.93542393]
mat_Sqrt:  [[12.11405602  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00449067  0.01666657  0.01850478]
Stock Position:  -0.004490674246490808
Bond Position:  [10.32529862]


portfolio before change:  [9.87657538]
curr_Stock_Price:  100.21078341223644
curr_Factors:  [100.21078341  -1.14829326  -0.92325482]
mat_Sqrt:  [[12.62561543  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00920573  0.01243788 -0.13678117]
Stock Position:  -0.009205734175158544
Bond Position:  [10.79908922]


portfolio before change:  [9.8700976]
curr_Stock_Price:  101.06109652006367
curr_Factors:  [101.06109652  -1.1350356   -0.92751827]
mat_Sqrt:  [[12.84778444  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00381545 0.01228332 0.43362076]
Stock Position:  0.00381544622924671
Bond Position:  [9.48450442]


portfolio before change:  [9.86734848]
curr_Stock_Price:  100.02982769414653
curr_Factors:  [100.02982769  -1.08051148  -0.91435053]
mat_Sqrt:  [[13.60729984  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01878591 0.10154012 0.19926719]
Stock Position:  0.01878591011962264
Bond Position:  [7.98819713]


portfolio before change:  [9.8628356]
curr_Stock_Price:  99.73644428809966
curr_Factors:  [99.73644429 -1.21202487 -0.90133107]
mat_Sqrt:  [[12.05133225  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00793647 -0.02807201 -0.28304259]
Stock Position:  -0.007936468538482856
Bond Position:  [10.65439075]


portfolio before change:  [9.86617419]
curr_Stock_Price:  99.48359666617532
curr_Factors:  [99.48359667 -0.99003835 -0.89761081]
mat_Sqrt:  [[15.06453958  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00548296 -0.01930591 -0.17501873]
Stock Position:  -0.005482958469471127
Bond Position:  [10.41163862]


portfolio before change:  [9.86593481]
curr_Stock_Price:  99.76463415366582
curr_Factors:  [99.76463415 -1.26178894 -0.87796016]
mat_Sqrt:  [[11.74073782  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00415361  0.05253624  0.36160677]
Stock Position:  -0.004153609873446744
Bond Position:  [10.28031818]


portfolio before change:  [9.86753211]
curr_Stock_Price:  99.68947539684652
curr_Factors:  [99.6894754  -1.21503448 -0.85475559]
mat_Sqrt:  [[12.5820355   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01195743 0.02174184 0.40147673]
Stock Position:  0.011957431238745781
Bond Position:  [8.67550207]


portfolio before change:  [9.86654822]
curr_Stock_Price:  99.51649509201893
curr_Factors:  [99.51649509 -1.17276412 -0.86367338]
mat_Sqrt:  [[12.9861825   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00730059 -0.0109189   0.15054411]
Stock Position:  0.007300588074668119
Bond Position:  [9.14001928]


portfolio before change:  [9.86742046]
curr_Stock_Price:  99.4794657925742
curr_Factors:  [99.47946579 -1.30252264 -0.86612302]
mat_Sqrt:  [[11.37372169  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00047342 -0.01205417  0.00044907]
Stock Position:  -0.0004734234465956796
Bond Position:  [9.91451637]


portfolio before change:  [9.86882864]
curr_Stock_Price:  99.12292539749356
curr_Factors:  [99.1229254  -1.27838091 -0.85702699]
mat_Sqrt:  [[11.71596981  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01238629 -0.02002553  0.41236057]
Stock Position:  0.012386291151509729
Bond Position:  [8.64106323]


portfolio before change:  [9.86180536]
curr_Stock_Price:  98.4686953721946
curr_Factors:  [98.46869537 -1.38537142 -0.87708255]
mat_Sqrt:  [[10.25007188  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00167208 -0.0394065   0.45036033]
Stock Position:  0.0016720762919350883
Bond Position:  [9.69715819]


portfolio before change:  [9.86301825]
curr_Stock_Price:  98.46909704592692
curr_Factors:  [98.46909705 -1.20673534 -0.8794899 ]
mat_Sqrt:  [[12.22542158  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-6.92970140e-03 -1.83969791e-04 -2.34506407e-01]
Stock Position:  -0.006929701400294038
Bond Position:  [10.54537969]


portfolio before change:  [9.86741653]
curr_Stock_Price:  98.02463093962885
curr_Factors:  [98.02463094 -1.11479916 -0.9060923 ]
mat_Sqrt:  [[12.99191608  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02934428  0.04223383  0.12758564]
Stock Position:  -0.0293442767722705
Bond Position:  [12.74387843]


portfolio before change:  [9.8508245]
curr_Stock_Price:  98.64434665601273
curr_Factors:  [98.64434666 -1.075797   -0.90981525]
mat_Sqrt:  [[13.54352641  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00176517 -0.04776041  0.28902297]
Stock Position:  -0.0017651735386804528
Bond Position:  [10.02494889]


portfolio before change:  [9.8507972]
curr_Stock_Price:  99.36977058550313
curr_Factors:  [99.36977059 -1.04611791 -0.8771043 ]
mat_Sqrt:  [[14.52143366  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00498209  0.01526408 -0.20611549]
Stock Position:  0.004982089312330912
Bond Position:  [9.35572813]


portfolio before change:  [9.85471798]
curr_Stock_Price:  99.92199811342074
curr_Factors:  [99.92199811 -0.85594921 -0.86166491]
mat_Sqrt:  [[17.93538799  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00222806  0.0224937   0.08110498]
Stock Position:  -0.0022280573486957193
Bond Position:  [10.07734993]


portfolio before change:  [9.8558779]
curr_Stock_Price:  99.96680496493046
curr_Factors:  [99.96680496 -0.91575632 -0.82536754]
mat_Sqrt:  [[17.52650531  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00709833 -0.02469816 -0.55974572]
Stock Position:  -0.007098333100974812
Bond Position:  [10.56547558]


portfolio before change:  [9.86101722]
curr_Stock_Price:  99.42885378767973
curr_Factors:  [99.42885379 -1.07449613 -0.83321309]
mat_Sqrt:  [[14.75723005  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00108599 -0.00226823 -0.33310297]
Stock Position:  -0.0010859949953655169
Bond Position:  [9.96899646]


portfolio before change:  [9.86098738]
curr_Stock_Price:  100.60385387385223
curr_Factors:  [100.60385387  -1.20739522  -0.84659444]
mat_Sqrt:  [[12.89965942  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00493361 0.0144485  0.10422442]
Stock Position:  0.0049336113831055
Bond Position:  [9.36464706]


portfolio before change:  [9.85806399]
curr_Stock_Price:  99.7740276385148
curr_Factors:  [99.77402764 -1.06436809 -0.88246621]
mat_Sqrt:  [[14.24026641  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 1.77175787e-04 -2.09559457e-02 -2.50889586e-01]
Stock Position:  0.00017717578671907428
Bond Position:  [9.84038645]


portfolio before change:  [9.85906608]
curr_Stock_Price:  98.48692202195579
curr_Factors:  [98.48692202 -1.17007725 -0.88718225]
mat_Sqrt:  [[12.58699666  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01856786 -0.09459759 -0.69893854]
Stock Position:  0.01856786418854933
Bond Position:  [8.03037428]


portfolio before change:  [9.85733825]
curr_Stock_Price:  98.33980321604743
curr_Factors:  [98.33980322 -1.06377558 -0.87074876]
mat_Sqrt:  [[14.2094114   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00356894 -0.02643367 -0.00642621]
Stock Position:  -0.0035689433305322376
Bond Position:  [10.20830744]


portfolio before change:  [9.86250892]
curr_Stock_Price:  97.24857069175509
curr_Factors:  [97.24857069 -0.98233709 -0.86949251]
mat_Sqrt:  [[15.26313878  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01116719  0.01881608  0.05942239]
Stock Position:  -0.011167190735966821
Bond Position:  [10.94850226]


portfolio before change:  [9.86465088]
curr_Stock_Price:  97.1793221457212
curr_Factors:  [97.17932215 -0.82375977 -0.84674561]
mat_Sqrt:  [[18.2844793   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00205425 -0.03694109 -0.21024662]
Stock Position:  0.0020542488724710536
Bond Position:  [9.66502037]


portfolio before change:  [9.86315613]
curr_Stock_Price:  95.86353439729018
curr_Factors:  [95.8635344  -0.86989916 -0.85874268]
mat_Sqrt:  [[17.01820776  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00042521  0.00973682 -0.27252863]
Stock Position:  0.00042520717441607336
Bond Position:  [9.82239426]


portfolio before change:  [9.86489571]
curr_Stock_Price:  97.06696423900874
curr_Factors:  [97.06696424 -1.36435892 -0.84539585]
mat_Sqrt:  [[10.65092053  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00325694  0.00519413 -0.23447503]
Stock Position:  -0.0032569392772988925
Bond Position:  [10.18103692]


portfolio before change:  [9.86376847]
curr_Stock_Price:  97.80383550217476
curr_Factors:  [97.8038355  -1.40806887 -0.8630362 ]
mat_Sqrt:  [[10.0931676   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00150416 -0.01075969  0.04532904]
Stock Position:  -0.001504161177890769
Bond Position:  [10.01088121]


portfolio before change:  [9.86531481]
curr_Stock_Price:  97.60778162871782
curr_Factors:  [97.60778163 -1.40759776 -0.85170316]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [9.86531481]
Stock Price:  97.68418476413505
PL:  [9.86531481]
Settle:  Tensor("sub_234:0", shape=(), dtype=float64)
PL:  Tensor("sub_235:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  118
output_Z_Vals[:, i, :]:  [[ 1.19260232e+02 -2.92559343e+01 -2.92733494e+01]
 [ 4.54664921e-03 -1.21893404e-01 -3.87808779e-02]
 [-4.07754406e-02 -9.86947228e-03  1.81772938e-02]
 [ 8.34715331e-02  1.56712281e-01  3.77748442e-02]
 [ 7.89714426e-02  1.69100406e-02 -6.86084330e-02]
 [ 6.40673590e-02  2.92556328e-02 -2.12978216e-03]
 [ 6.30325641e-02  1.96036031e-02 -7.06026466e-02]
 [-1.34712582e-01  1.27536033e-01 -4.92648746e-02]
 [ 8.85435524e-02 -7.78371689e-03 -8.16494400e-02]
 [-3.47474026e-02 -6.57225393e-02 -1.07812907e-01]
 [ 7.05531450e-02  9.42835697e-02 -9.52764025e-02]
 [-1.66358427e-01 -9.48958635e-02  2.71875403e-02]
 [-8.29111504e-02  7.21341026e-03  1.35958658e-02]
 [ 6.76169989e-02  1.21154232e-02  1.63393624e-01]
 [ 1.68998186e-01  1.25826142e-01 -6.90874719e-02]
 [-6.96604589e-02 -2.89940022e-01 -7.44531797e-02]
 [-6.64121828e-02 -2.77125741e-02 -3.63416616e-02]
 [-7.31696035e-02  1.63978817e-01  1.15678501e-01]
 [ 1.09345331e-01  5.93005231e-02  1.12701781e-01]
 [ 1.20759358e-01 -3.97881329e-02  3.21392051e-02]
 [-8.12223116e-04 -4.18804743e-02  5.23175572e-03]
 [ 1.10702748e-01 -6.11461018e-02  1.24766657e-01]
 [-5.49436391e-02  2.22792190e-02  2.67344978e-01]
 [-5.27391440e-02 -9.43096173e-04 -8.66287797e-02]
 [-5.31508813e-02  6.28565797e-02  7.27691931e-02]
 [ 6.31134746e-02 -3.45600467e-02  6.80585331e-02]
 [-1.82412643e-01  7.19142723e-02  7.21679232e-02]
 [-4.19234696e-02  6.66827311e-02  2.67557842e-02]
 [-5.21512981e-02 -4.89703717e-02 -2.37823558e-01]
 [ 1.91693236e-02  1.26929989e-03 -8.08287633e-02]
 [ 2.01014695e-02  1.45163411e-01  3.00344695e-02]
 [ 1.50303013e-02 -6.18355379e-02 -9.00137608e-02]
 [ 2.03897242e-01 -1.58925936e-01 -6.01554793e-02]
 [-4.94706450e-02 -8.49341112e-02 -6.03853421e-03]
 [-1.83557603e-01  1.45369988e-01  2.63367640e-02]
 [ 8.42235218e-02 -1.50657618e-01 -1.23392888e-01]
 [-6.80421780e-02 -1.73863192e-01 -2.89938845e-02]
 [-3.42653101e-02 -8.16627926e-03 -1.74125474e-02]
 [-4.85192136e-02  9.89755119e-02 -4.98973466e-03]
 [-4.86948703e-01  2.50720774e-01  2.96444417e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.26023247 -29.25593426 -29.27334937]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  8.31486419  -9.25153874 -83.50871763]
init_Out:  [2.49911038]
Stock Position:  8.31486419409362
Bond position:  [-828.98730903]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [1.2471678]
curr_Stock_Price:  99.86189639878776
curr_Factors:  [99.8618964  -0.86714913 -1.01060731]
mat_Sqrt:  [[15.27216297  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00042671 -0.03854608 -0.11063105]
Stock Position:  -0.0004267069768156807
Bond Position:  [1.28977957]


portfolio before change:  [1.24726619]
curr_Stock_Price:  100.00916913647619
curr_Factors:  [100.00916914  -0.89470919  -0.98125011]
mat_Sqrt:  [[15.32219715  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00243567 -0.003121    0.05185476]
Stock Position:  -0.0024356718813794524
Bond Position:  [1.49085571]


portfolio before change:  [1.24609002]
curr_Stock_Price:  100.56857811656697
curr_Factors:  [100.56857812  -0.93969384  -0.98211852]
mat_Sqrt:  [[14.71735647  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.0064705  0.04955677 0.10776112]
Stock Position:  0.006470495213730079
Bond Position:  [0.59536152]


portfolio before change:  [1.23885426]
curr_Stock_Price:  99.43880610590114
curr_Factors:  [99.43880611 -0.61539203 -0.9882619 ]
mat_Sqrt:  [[20.00312507  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00326966  0.00534742 -0.19572076]
Stock Position:  0.0032696601139475287
Bond Position:  [0.91372317]


portfolio before change:  [1.23632003]
curr_Stock_Price:  98.62879700052302
curr_Factors:  [98.628797   -0.7476104  -1.00047636]
mat_Sqrt:  [[17.17193768  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00374961  0.00925144 -0.00607568]
Stock Position:  0.003749605751328603
Bond Position:  [0.86650093]


portfolio before change:  [1.23693306]
curr_Stock_Price:  98.76339895777063
curr_Factors:  [98.76339896 -0.75956094 -0.99008133]
mat_Sqrt:  [[17.16864596  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00286144  0.0061992  -0.2014097 ]
Stock Position:  0.0028614383559196206
Bond Position:  [0.95432768]


portfolio before change:  [1.24136979]
curr_Stock_Price:  100.27223240564761
curr_Factors:  [100.27223241  -0.64143612  -0.99436106]
mat_Sqrt:  [[19.53273232  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00724301  0.04033043 -0.14053897]
Stock Position:  -0.007243009539287815
Bond Position:  [1.96764252]


portfolio before change:  [1.24311678]
curr_Stock_Price:  100.06499497818267
curr_Factors:  [100.06499498  -0.48179407  -1.00904021]
mat_Sqrt:  [[22.533107    0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00318092 -0.00246143 -0.23292313]
Stock Position:  0.0031809175497964776
Bond Position:  [0.92481828]


portfolio before change:  [1.23855497]
curr_Stock_Price:  98.59453244017662
curr_Factors:  [98.59453244 -0.3984645  -0.9863055 ]
mat_Sqrt:  [[24.68623531  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00236778 -0.02078329 -0.30756021]
Stock Position:  -0.002367779776108399
Bond Position:  [1.47200511]


portfolio before change:  [1.23899464]
curr_Stock_Price:  98.48655745003144
curr_Factors:  [98.48655745 -0.37158406 -0.99168109]
mat_Sqrt:  [[25.19523578  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00212498  0.02981508 -0.27179706]
Stock Position:  0.0021249780131767856
Bond Position:  [1.02971287]


portfolio before change:  [1.23837534]
curr_Stock_Price:  98.13454243001456
curr_Factors:  [98.13454243 -0.3352017  -0.97901917]
mat_Sqrt:  [[26.36714033  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00619176 -0.03000871  0.07755848]
Stock Position:  -0.006191759610589739
Bond Position:  [1.84600084]


portfolio before change:  [1.23128401]
curr_Stock_Price:  99.31709755530662
curr_Factors:  [99.31709756 -0.32587091 -0.96672994]
mat_Sqrt:  [[27.26808259  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00293199  0.00228108  0.03878522]
Stock Position:  -0.002931986737322989
Bond Position:  [1.52248042]


portfolio before change:  [1.2255168]
curr_Stock_Price:  101.34900602813413
curr_Factors:  [101.34900603  -0.44586119  -0.96865098]
mat_Sqrt:  [[24.63228302  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00411177 0.00383123 0.46611653]
Stock Position:  0.004111774838901999
Bond Position:  [0.80879251]


portfolio before change:  [1.21910803]
curr_Stock_Price:  99.7657767142262
curr_Factors:  [99.76577671 -0.49680583 -0.97327884]
mat_Sqrt:  [[22.93675239  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00689481  0.03978972 -0.19708733]
Stock Position:  0.006894811406860638
Bond Position:  [0.53124181]


portfolio before change:  [1.21100243]
curr_Stock_Price:  98.58053635807211
curr_Factors:  [98.58053636 -0.72878126 -0.95494392]
mat_Sqrt:  [[18.30453182  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00504489 -0.09168709 -0.2123942 ]
Stock Position:  -0.00504489110664087
Bond Position:  [1.7083305]


portfolio before change:  [1.21794283]
curr_Stock_Price:  97.24713859441232
curr_Factors:  [97.24713859 -0.58683669 -0.94002278]
mat_Sqrt:  [[21.12370967  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00352902 -0.00876349 -0.10367264]
Stock Position:  -0.0035290169289320153
Bond Position:  [1.56112963]


portfolio before change:  [1.21510505]
curr_Stock_Price:  98.10656383646213
curr_Factors:  [98.10656384 -0.6219076  -0.93577118]
mat_Sqrt:  [[20.66363712  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00219337  0.05185466  0.32999856]
Stock Position:  -0.002193365731434504
Bond Position:  [1.43028863]


portfolio before change:  [1.212903]
curr_Stock_Price:  99.19204433691787
curr_Factors:  [99.19204434 -0.81393135 -0.95171952]
mat_Sqrt:  [[16.96931881  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00788963 0.01875247 0.32150681]
Stock Position:  0.007889628342944177
Bond Position:  [0.43031463]


portfolio before change:  [1.21881057]
curr_Stock_Price:  99.93400300930179
curr_Factors:  [99.93400301 -0.87081222 -0.97977651]
mat_Sqrt:  [[15.70409125  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00804201 -0.01258211  0.09168421]
Stock Position:  0.008042007581843869
Bond Position:  [0.41514056]


portfolio before change:  [1.21065907]
curr_Stock_Price:  98.91393552774176
curr_Factors:  [98.91393553 -1.0885131  -0.97781319]
mat_Sqrt:  [[12.52747013  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-6.59067346e-05 -1.32437688e-02  1.49247428e-02]
Stock Position:  -6.59067345673299e-05
Bond Position:  [1.21717817]


portfolio before change:  [1.2107875]
curr_Stock_Price:  99.27396615933847
curr_Factors:  [99.27396616 -0.85386588 -0.95729189]
mat_Sqrt:  [[16.22779635  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00829391 -0.0193361   0.35592454]
Stock Position:  0.008293907955611593
Bond Position:  [0.38741836]


portfolio before change:  [1.21769422]
curr_Stock_Price:  100.10087288667204
curr_Factors:  [100.10087289  -0.80611085  -0.97626975]
mat_Sqrt:  [[16.84068705  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [1.20644172e-05 7.04530765e-03 7.62660809e-01]
Stock Position:  1.2064417246604628e-05
Bond Position:  [1.21648656]


portfolio before change:  [1.21784715]
curr_Stock_Price:  100.17258318685862
curr_Factors:  [100.17258319  -1.13158161  -0.96522268]
mat_Sqrt:  [[12.30604052  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00572455 -0.00029823 -0.2471278 ]
Stock Position:  -0.0057245480525954275
Bond Position:  [1.79128992]


portfolio before change:  [1.21300747]
curr_Stock_Price:  101.05712609399312
curr_Factors:  [101.05712609  -1.02659843  -0.97848589]
mat_Sqrt:  [[13.60723508  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00269518  0.019877    0.20759025]
Stock Position:  -0.0026951825127632203
Bond Position:  [1.48537487]


portfolio before change:  [1.21024139]
curr_Stock_Price:  102.15232784992013
curr_Factors:  [102.15232785  -0.96902096  -0.97457518]
mat_Sqrt:  [[14.62699749  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00520363 -0.01092885  0.19415205]
Stock Position:  0.005203633072253691
Bond Position:  [0.67867815]


portfolio before change:  [1.21050002]
curr_Stock_Price:  102.18572630097599
curr_Factors:  [102.1857263   -1.03267587  -0.9751032 ]
mat_Sqrt:  [[13.72217213  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01208443  0.02274129  0.205875  ]
Stock Position:  -0.012084428592833443
Bond Position:  [2.44535613]


portfolio before change:  [1.21041067]
curr_Stock_Price:  102.2184161126408
curr_Factors:  [102.21841611  -1.11834188  -0.92105058]
mat_Sqrt:  [[13.29940645  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00261216  0.02108693  0.0763268 ]
Stock Position:  -0.0026121637431368535
Bond Position:  [1.47742191]


portfolio before change:  [1.20944591]
curr_Stock_Price:  102.6584523601527
curr_Factors:  [102.65845236  -1.1564714   -0.88898215]
mat_Sqrt:  [[13.27594728  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00768015 -0.01548579 -0.67844441]
Stock Position:  -0.007680147861077522
Bond Position:  [1.99787801]


portfolio before change:  [1.21429093]
curr_Stock_Price:  102.06012130693122
curr_Factors:  [102.06012131  -1.0094059   -0.87662281]
mat_Sqrt:  [[15.4797599   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 1.74614760e-04  4.01387867e-04 -2.30581963e-01]
Stock Position:  0.000174614759527005
Bond Position:  [1.19646973]


portfolio before change:  [1.2143275]
curr_Stock_Price:  101.41297377247366
curr_Factors:  [101.41297377  -0.95002136  -0.87841921]
mat_Sqrt:  [[16.29340563  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00184003 0.0459047  0.08567998]
Stock Position:  0.0018400286456703992
Bond Position:  [1.02772472]


portfolio before change:  [1.21260557]
curr_Stock_Price:  100.40733576253956
curr_Factors:  [100.40733576  -0.98588249  -0.84408346]
mat_Sqrt:  [[16.10724736  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00030671 -0.01955411 -0.2567842 ]
Stock Position:  -0.0003067108435712887
Bond Position:  [1.24340159]


portfolio before change:  [1.2131992]
curr_Stock_Price:  98.97866548644973
curr_Factors:  [98.97866549 -0.8902928  -0.82921937]
mat_Sqrt:  [[17.73237663  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0105747  -0.05025679 -0.17160684]
Stock Position:  0.010574702453132087
Bond Position:  [0.16652926]


portfolio before change:  [1.22345564]
curr_Stock_Price:  99.94660037875346
curr_Factors:  [99.94660038 -0.93686114 -0.81656714]
mat_Sqrt:  [[17.30867394  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00305605 -0.02685852 -0.01722626]
Stock Position:  -0.003056054156759161
Bond Position:  [1.52889786]


portfolio before change:  [1.22367321]
curr_Stock_Price:  99.93794508206285
curr_Factors:  [99.93794508 -0.80133382 -0.81397408]
mat_Sqrt:  [[19.87060581  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0087782   0.04597003  0.07513146]
Stock Position:  -0.00877820223023227
Bond Position:  [2.1009487]


portfolio before change:  [1.23093681]
curr_Stock_Price:  99.14040559733232
curr_Factors:  [99.1404056  -0.71887773 -0.82502781]
mat_Sqrt:  [[21.17098358  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0026048  -0.04764212 -0.35200556]
Stock Position:  0.002604795895652126
Bond Position:  [0.97269629]


portfolio before change:  [1.23367645]
curr_Stock_Price:  100.14549399814068
curr_Factors:  [100.145494    -0.64851417  -0.830438  ]
mat_Sqrt:  [[22.82078858  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00343764 -0.05498037 -0.08271148]
Stock Position:  -0.0034376401127853414
Bond Position:  [1.57794062]


portfolio before change:  [1.22913012]
curr_Stock_Price:  101.52539140451081
curr_Factors:  [101.5253914   -0.68849539  -0.83979707]
mat_Sqrt:  [[22.0214388   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00172698 -0.0025824  -0.04967315]
Stock Position:  -0.0017269754378058933
Bond Position:  [1.40446198]


portfolio before change:  [1.23091697]
curr_Stock_Price:  100.592381945346
curr_Factors:  [100.59238195  -0.71220974  -0.81874563]
mat_Sqrt:  [[21.7610389   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00215901  0.03129881 -0.01423432]
Stock Position:  -0.002159005479078617
Bond Position:  [1.44809648]


portfolio before change:  [1.22993111]
curr_Stock_Price:  101.13285501591068
curr_Factors:  [101.13285502  -0.64436715  -0.83107989]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [1.22993111]
Stock Price:  102.4054837267488
PL:  [-1.17555262]
Settle:  Tensor("sub_236:0", shape=(), dtype=float64)
PL:  Tensor("sub_237:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  119
output_Z_Vals[:, i, :]:  [[ 1.19260232e+02 -2.92559343e+01 -2.92733494e+01]
 [-1.41098530e-03 -7.48096270e-02 -2.77166694e-02]
 [-5.42553290e-02  6.46477066e-03  9.95338708e-02]
 [-2.66933222e-01 -1.39359783e-01 -3.53751507e-02]
 [-2.04606726e-02  4.70438778e-02 -9.60510250e-02]
 [-5.04958933e-02  1.39717069e-02 -7.24221189e-02]
 [-7.91964154e-02 -9.07803855e-02  2.34393681e-01]
 [ 3.38882598e-01  2.93726871e-01  2.29175164e-01]
 [ 5.60871422e-02 -2.56500946e-02 -1.39860132e-01]
 [-8.58118362e-02  2.36094659e-01  9.51287913e-02]
 [ 1.15112603e-01  1.02347169e-01  2.62101625e-03]
 [-7.99588282e-02 -9.46843366e-02 -8.29173301e-03]
 [ 4.57423472e-02 -2.00856419e-01  4.97302396e-02]
 [ 2.78728991e-01  2.00661468e-01  3.01999396e-01]
 [ 7.11870079e-02 -1.31528177e-01 -2.34916546e-01]
 [-8.43419480e-02 -1.32279654e-01 -1.28045230e-01]
 [-8.04894223e-02 -1.34069541e-02 -6.43521707e-02]
 [ 4.51917319e-02 -2.28416553e-01 -9.90276298e-02]
 [ 3.72178195e-02  5.41367307e-02  2.77478917e-02]
 [ 2.31123293e-01 -4.62796430e-02 -3.42462657e-02]
 [ 5.17725864e-02  3.38029733e-02  1.13782680e-01]
 [-5.73319491e-02  3.41504901e-02 -5.59840172e-02]
 [-8.59991203e-02  1.23716868e-01  3.85314322e-01]
 [-2.44843124e-02 -8.95780118e-03 -7.86255439e-02]
 [-2.09578410e-01  8.72803056e-02  8.04017119e-02]
 [-2.48599967e-05 -1.05636232e-01  8.83133148e-02]
 [ 2.19450980e-01  4.08375670e-02 -1.23071125e-01]
 [-5.07806065e-02  7.36225950e-02  2.93687317e-02]
 [-8.47085278e-02 -8.06784838e-02 -1.92727006e-01]
 [ 2.00231759e-02  3.80403497e-03 -1.21467985e-01]
 [ 3.99479659e-02  2.23816417e-02  1.91402105e-02]
 [ 3.69292597e-02 -7.99630802e-02 -8.52402890e-02]
 [ 2.41265163e-01 -2.19315846e-01 -1.39539587e-01]
 [-5.04604969e-02 -8.59004646e-02 -8.76161434e-03]
 [-1.75766860e-01  1.28133903e-01  2.72497666e-02]
 [ 8.47165236e-02 -1.65012150e-01 -1.38726811e-01]
 [-1.38027978e-01 -2.49374808e-01  2.00609982e-02]
 [-3.13431609e-02 -3.23556767e-03 -3.11290821e-02]
 [-4.74348769e-02  9.71151897e-02 -6.86595098e-03]
 [-4.29051092e-01  2.23253192e-01  2.60849871e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.26023247 -29.25593426 -29.27334937]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  8.31486419  -9.25153874 -83.50871763]
init_Out:  [2.49911038]
Stock Position:  8.31486419409362
Bond position:  [-828.98730903]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [3.37001362]
curr_Stock_Price:  100.11720373344251
curr_Factors:  [100.11720373  -0.83156763  -0.99668505]
mat_Sqrt:  [[16.08824467  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00055943 -0.02365688 -0.07906794]
Stock Position:  -0.0005594272835545819
Bond Position:  [3.42602191]


portfolio before change:  [3.37104047]
curr_Stock_Price:  99.04722879197644
curr_Factors:  [99.04722879 -0.50365532 -0.9972844 ]
mat_Sqrt:  [[22.07966544  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00152951  0.00204434  0.28394243]
Stock Position:  -0.0015295133511250608
Bond Position:  [3.52253453]


portfolio before change:  [3.3720627]
curr_Stock_Price:  98.66678705017642
curr_Factors:  [98.66678705 -0.22740102 -0.97849305]
mat_Sqrt:  [[29.54322114  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00940156 -0.04406943 -0.10091546]
Stock Position:  -0.009401561080398158
Bond Position:  [4.29968453]


portfolio before change:  [3.3877371]
curr_Stock_Price:  97.05674607482293
curr_Factors:  [ 9.70567461e+01 -9.52110625e-02 -9.91509675e-01]
mat_Sqrt:  [[32.73926364  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00118672  0.01487658 -0.27400684]
Stock Position:  -0.0011867199796785869
Bond Position:  [3.50291628]


portfolio before change:  [3.38326447]
curr_Stock_Price:  101.19463393893172
curr_Factors:  [101.19463394   0.14462466  -1.02146428]
mat_Sqrt:  [[42.10666805  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00154176  0.00441824 -0.20660015]
Stock Position:  -0.0015417569582011634
Bond Position:  [3.53928201]


portfolio before change:  [3.38222214]
curr_Stock_Price:  102.15767382690872
curr_Factors:  [102.15767383   0.26463574  -1.03468011]
mat_Sqrt:  [[47.29823923  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00071239 -0.02870728  0.66865993]
Stock Position:  -0.0007123932243244436
Bond Position:  [3.45499857]


portfolio before change:  [3.38193534]
curr_Stock_Price:  103.16653431242928
curr_Factors:  [103.16653431   0.29180047  -1.01441066]
mat_Sqrt:  [[50.08563959  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00785149 0.09288459 0.65377295]
Stock Position:  0.007851487584303976
Bond Position:  [2.57192457]


portfolio before change:  [3.3574077]
curr_Stock_Price:  100.00163772640559
curr_Factors:  [100.00163773   0.17668916  -0.9823488 ]
mat_Sqrt:  [[44.68004234  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00060152 -0.00811127 -0.39898203]
Stock Position:  0.0006015220308813277
Bond Position:  [3.29725451]


portfolio before change:  [3.3570318]
curr_Stock_Price:  98.69148408407962
curr_Factors:  [98.69148408  0.14964263 -1.00292881]
mat_Sqrt:  [[42.04382313  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00143417  0.07465969  0.27137596]
Stock Position:  -0.0014341658460650642
Bond Position:  [3.49857175]


portfolio before change:  [3.35867326]
curr_Stock_Price:  97.85189034952731
curr_Factors:  [97.85189035  0.4366889  -1.01295283]
mat_Sqrt:  [[54.99218507  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00215104 0.03236502 0.00747703]
Stock Position:  0.0021510367075083126
Bond Position:  [3.14819025]


portfolio before change:  [3.36171664]
curr_Stock_Price:  99.08377739943899
curr_Factors:  [99.0837774  0.3409609 -1.0222476]
mat_Sqrt:  [[50.13297774  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00167746 -0.02994182 -0.02365401]
Stock Position:  -0.0016774609047858554
Bond Position:  [3.52792581]


portfolio before change:  [3.35677727]
curr_Stock_Price:  102.29123751793992
curr_Factors:  [102.29123752   0.34607035  -1.01940554]
mat_Sqrt:  [[52.16901962  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00097198 -0.06351638  0.14186653]
Stock Position:  0.0009719829839054554
Bond Position:  [3.25735193]


portfolio before change:  [3.35822947]
curr_Stock_Price:  103.36636091903567
curr_Factors:  [103.36636092   0.23875318  -1.01156834]
mat_Sqrt:  [[47.72543177  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00724049 0.06345473 0.86152022]
Stock Position:  0.007240488000130755
Bond Position:  [2.60980657]


portfolio before change:  [3.34415323]
curr_Stock_Price:  101.377201285199
curr_Factors:  [101.37720129   0.15488031  -0.99958929]
mat_Sqrt:  [[43.55999773  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 4.55436795e-04 -4.15928617e-02 -6.70151518e-01]
Stock Position:  0.0004554367953093312
Bond Position:  [3.29798232]


portfolio before change:  [3.34409942]
curr_Stock_Price:  100.35382181602075
curr_Factors:  [ 1.00353822e+02  6.12999228e-02 -1.00391285e+00]
mat_Sqrt:  [[39.09870065  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.002913  -0.0418305 -0.3652774]
Stock Position:  -0.002913000053562085
Bond Position:  [3.63643011]


portfolio before change:  [3.33676959]
curr_Stock_Price:  103.02612185000683
curr_Factors:  [103.02612185  -0.17653692  -1.01520389]
mat_Sqrt:  [[31.28822267  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00300341 -0.00423965 -0.18357883]
Stock Position:  -0.003003411895995709
Bond Position:  [3.64619947]


portfolio before change:  [3.3338371]
curr_Stock_Price:  104.15426989848697
curr_Factors:  [104.1542699   -0.37150121  -1.03692489]
mat_Sqrt:  [[25.4686187   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00074916 -0.07223166 -0.28249826]
Stock Position:  0.0007491616161544102
Bond Position:  [3.25580872]


portfolio before change:  [3.33391825]
curr_Stock_Price:  103.71931837142616
curr_Factors:  [103.71931837  -0.29888441  -1.02286049]
mat_Sqrt:  [[27.65878744  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00160092 0.01711954 0.07915701]
Stock Position:  0.0016009247942764947
Bond Position:  [3.16787143]


portfolio before change:  [3.32959045]
curr_Stock_Price:  100.76864053556166
curr_Factors:  [ 1.00768641e+02 -6.80670669e-02 -1.00561836e+00]
mat_Sqrt:  [[34.43735155  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00647372 -0.01463491 -0.09769506]
Stock Position:  0.006473722791292828
Bond Position:  [2.6772422]


portfolio before change:  [3.33659657]
curr_Stock_Price:  101.79918207509623
curr_Factors:  [ 1.01799182e+02 -1.50141194e-05 -9.84178710e-01]
mat_Sqrt:  [[38.04647146  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00199417 0.01068944 0.32459031]
Stock Position:  0.0019941709370378527
Bond Position:  [3.13359159]


portfolio before change:  [3.3400055]
curr_Stock_Price:  103.31219980141644
curr_Factors:  [ 1.03312200e+02 -1.96775171e-02 -9.99625999e-01]
mat_Sqrt:  [[37.27981227  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00182077  0.01079933 -0.15970682]
Stock Position:  -0.00182076766883345
Bond Position:  [3.52811302]


portfolio before change:  [3.34855605]
curr_Stock_Price:  98.85830567279196
curr_Factors:  [98.85830567 -0.20631154 -0.97194603]
mat_Sqrt:  [[30.43003152  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-1.36470704e-04  3.91227089e-02  1.09919451e+00]
Stock Position:  -0.00013647070389065304
Bond Position:  [3.36204732]


portfolio before change:  [3.3489693]
curr_Stock_Price:  98.90985410875899
curr_Factors:  [98.90985411 -0.1531301  -0.97110416]
mat_Sqrt:  [[32.13592653  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00126852 -0.00283271 -0.22429679]
Stock Position:  -0.001268517144631131
Bond Position:  [3.47443815]


portfolio before change:  [3.34946277]
curr_Stock_Price:  98.86323741880874
curr_Factors:  [98.86323742 -0.58431153 -0.98578154]
mat_Sqrt:  [[20.56610611  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00928289  0.02760046  0.2293637 ]
Stock Position:  -0.009282890519788254
Bond Position:  [4.26719938]


portfolio before change:  [3.3419041]
curr_Stock_Price:  99.73495910268929
curr_Factors:  [99.7349591  -0.60861516 -0.9854816 ]
mat_Sqrt:  [[20.25536107  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0007541  -0.03340511  0.25193331]
Stock Position:  0.0007540968564666317
Bond Position:  [3.26669428]


portfolio before change:  [3.34149381]
curr_Stock_Price:  98.64935172125625
curr_Factors:  [98.64935172 -0.6266448  -0.98164456]
mat_Sqrt:  [[19.75254403  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00989157  0.01291397 -0.35108766]
Stock Position:  0.009891567008799527
Bond Position:  [2.36569714]


portfolio before change:  [3.33814505]
curr_Stock_Price:  98.28090742270146
curr_Factors:  [98.28090742 -0.64548367 -1.02871551]
mat_Sqrt:  [[18.42356581  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00232772  0.02328151  0.08378082]
Stock Position:  -0.002327715082933748
Bond Position:  [3.566915]


portfolio before change:  [3.33967456]
curr_Stock_Price:  97.81537771930293
curr_Factors:  [97.81537772 -0.66461155 -1.02781051]
mat_Sqrt:  [[18.00518457  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00700531 -0.02551278 -0.5497965 ]
Stock Position:  -0.0070053085137412405
Bond Position:  [4.02490146]


portfolio before change:  [3.33569155]
curr_Stock_Price:  98.45577174267885
curr_Factors:  [98.45577174 -0.84806292 -1.026077  ]
mat_Sqrt:  [[15.1116734   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-3.09241256e-04  1.20294148e-03 -3.46514350e-01]
Stock Position:  -0.00030924125585107126
Bond Position:  [3.36613814]


portfolio before change:  [3.33630041]
curr_Stock_Price:  97.84762552193898
curr_Factors:  [97.84762552 -0.9971188  -1.03793787]
mat_Sqrt:  [[12.78605037  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.0034751  0.0070777  0.05460169]
Stock Position:  0.003475102567701748
Bond Position:  [2.99626987]


portfolio before change:  [3.33911378]
curr_Stock_Price:  98.54942229010311
curr_Factors:  [98.54942229 -1.02853942 -1.0231375 ]
mat_Sqrt:  [[12.66549352  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00137895 -0.02528655 -0.24316682]
Stock Position:  0.0013789451362101954
Bond Position:  [3.20321953]


portfolio before change:  [3.34039403]
curr_Stock_Price:  99.18746031762193
curr_Factors:  [99.18746032 -0.95993803 -1.02338693]
mat_Sqrt:  [[13.64927817  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01517436 -0.06935376 -0.3980676 ]
Stock Position:  0.015174359454407411
Bond Position:  [1.83528785]


portfolio before change:  [3.36142095]
curr_Stock_Price:  100.55802867026719
curr_Factors:  [100.55802867  -0.88352432  -1.06398099]
mat_Sqrt:  [[14.34253562  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00379758 -0.02716411 -0.02499445]
Stock Position:  -0.003797577770083745
Bond Position:  [3.74329788]


portfolio before change:  [3.36281542]
curr_Stock_Price:  100.31404869265043
curr_Factors:  [100.31404869  -0.82335652  -1.02484498]
mat_Sqrt:  [[15.80149019  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01056205  0.0405195   0.077736  ]
Stock Position:  -0.010562049513329343
Bond Position:  [4.42233737]


portfolio before change:  [3.35564548]
curr_Stock_Price:  101.04522999590486
curr_Factors:  [101.04523     -1.01315821  -1.02496853]
mat_Sqrt:  [[13.16341645  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00396086 -0.05218142 -0.39574898]
Stock Position:  0.003960858996198869
Bond Position:  [2.95541957]


portfolio before change:  [3.35736565]
curr_Stock_Price:  101.38624775582068
curr_Factors:  [101.38624776  -1.12766059  -1.03351434]
mat_Sqrt:  [[11.67865157  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01201953 -0.07885924  0.05722844]
Stock Position:  -0.012019527494352157
Bond Position:  [4.57598044]


portfolio before change:  [3.36070999]
curr_Stock_Price:  101.15559774570329
curr_Factors:  [101.15559775  -1.15769397  -1.06309929]
mat_Sqrt:  [[10.97770759  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0034416  -0.00102318 -0.08880261]
Stock Position:  -0.003441601978262667
Bond Position:  [3.70884729]


portfolio before change:  [3.36137109]
curr_Stock_Price:  101.09822199389374
curr_Factors:  [101.09822199  -0.9063605   -1.06454803]
mat_Sqrt:  [[14.08603669  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00328899  0.03071052 -0.01958665]
Stock Position:  -0.0032889932659087425
Bond Position:  [3.69388246]


portfolio before change:  [3.36184994]
curr_Stock_Price:  101.09302637669029
curr_Factors:  [101.09302638  -0.69893574  -1.02485179]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [3.36184994]
Stock Price:  102.2899445929949
PL:  [1.07190535]
Settle:  Tensor("sub_238:0", shape=(), dtype=float64)
PL:  Tensor("sub_239:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  120
output_Z_Vals[:, i, :]:  [[ 1.19260232e+02 -2.92559343e+01 -2.92733494e+01]
 [ 6.18089049e-02 -1.14634012e-01 -1.56448715e-01]
 [-3.57350012e-02  4.11431038e-02  1.10282914e-01]
 [-5.57735767e-02  1.05228357e-01  1.17454982e-02]
 [ 5.69038916e-02  2.41868272e-02 -6.96768977e-02]
 [ 1.63622246e-02  2.83254485e-02  9.12375147e-02]
 [-4.25079500e-03  6.45803345e-02  2.48902744e-02]
 [ 1.28222439e-01  2.58212827e-01  1.34901670e-01]
 [ 4.40301917e-02  1.60585578e-03 -9.13259102e-02]
 [-5.19604760e-02  4.28853882e-01  1.95592664e-01]
 [ 5.94643843e-02  1.14577038e-01 -8.51586097e-02]
 [-1.38483085e-02 -6.71433087e-02 -2.14134977e-02]
 [-7.22281246e-02 -4.23027905e-02 -4.49898843e-02]
 [ 6.62781411e-02  1.22365580e-02  1.62554393e-01]
 [ 1.46756369e-01  8.67429484e-02 -8.47099112e-02]
 [-7.88711188e-02 -8.19804458e-02 -1.07410614e-01]
 [-7.12728226e-02 -5.71224239e-02 -5.88175841e-02]
 [-8.31422450e-02  7.56479300e-02  9.91994242e-02]
 [ 1.09896844e-01  6.77437611e-02  1.28755498e-01]
 [ 2.32103453e-01 -6.07924430e-02 -1.52581153e-02]
 [-4.99507006e-02  2.48092120e-03 -4.84257363e-02]
 [ 6.87387786e-02 -5.29176097e-02  6.68208473e-02]
 [-6.44084558e-02  6.67706228e-02  1.84651734e-01]
 [ 5.77565831e-02 -1.45768021e-02 -3.49514014e-02]
 [ 9.45197091e-02  3.09859760e-02  9.33220615e-02]
 [ 4.52573471e-02 -5.46767526e-02  7.37885629e-02]
 [-1.53495535e-01  6.73051770e-02  4.73589937e-02]
 [-5.07806065e-02  7.36225950e-02  2.93687317e-02]
 [ 5.76316563e-02 -1.00723711e-01 -1.72003518e-01]
 [ 1.58903381e-02 -5.09917622e-03 -1.23834258e-01]
 [-6.66635457e-03  2.28105282e-01  1.88886578e-02]
 [ 1.69741843e-02 -8.81383453e-02 -8.53560414e-02]
 [-6.00501814e-03 -2.72980090e-03  7.64857768e-02]
 [-5.02493499e-02 -8.56943300e-02 -8.18074938e-03]
 [-1.57220856e-01  1.42680771e-01  3.45008361e-02]
 [ 8.52139997e-02 -1.64801830e-01 -1.38472484e-01]
 [-1.90426381e-01 -3.16072532e-01  4.41620142e-02]
 [-4.90817341e-02 -3.41841504e-02  5.22669962e-02]
 [-3.63156150e-02  7.78935857e-02 -2.56861647e-02]
 [ 7.90496379e-02 -2.89765391e-03 -6.83537686e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.26023247 -29.25593426 -29.27334937]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  8.31486419  -9.25153874 -83.50871763]
init_Out:  [2.49911038]
Stock Position:  8.31486419409362
Bond position:  [-828.98730903]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-3.93320985]
curr_Stock_Price:  99.23887026964776
curr_Factors:  [99.23887027 -1.13221184 -1.01175875]
mat_Sqrt:  [[11.62966518  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00231426 -0.03625046 -0.44630464]
Stock Position:  0.0023142632850990585
Bond Position:  [-4.16287473]


portfolio before change:  [-3.93326958]
curr_Stock_Price:  99.43792304558914
curr_Factors:  [99.43792305 -0.87805611 -0.99497255]
mat_Sqrt:  [[15.27939074  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00079593  0.01301059  0.31460646]
Stock Position:  -0.000795927366240153
Bond Position:  [-3.85412422]


portfolio before change:  [-3.93334371]
curr_Stock_Price:  98.92573051052436
curr_Factors:  [98.92573051 -0.83550693 -0.99082642]
mat_Sqrt:  [[15.92732225  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00318064  0.03327613  0.03350664]
Stock Position:  -0.003180638375952611
Bond Position:  [-3.61869674]


portfolio before change:  [-3.9346514]
curr_Stock_Price:  99.19464586733181
curr_Factors:  [99.19464587 -0.66621796 -0.98856072]
mat_Sqrt:  [[18.95950443  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00228411  0.00764855 -0.19876879]
Stock Position:  0.002284113267247158
Bond Position:  [-4.16122321]


portfolio before change:  [-3.93079397]
curr_Stock_Price:  101.11119229220158
curr_Factors:  [101.11119229  -0.49690795  -1.03263165]
mat_Sqrt:  [[21.90426189  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00163061 0.00895729 0.26027523]
Stock Position:  0.0016306125449570552
Bond Position:  [-4.09566715]


portfolio before change:  [-3.93046908]
curr_Stock_Price:  101.62442784295584
curr_Factors:  [101.62442784  -0.49835758  -1.02935232]
mat_Sqrt:  [[22.05576541  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00011323 0.02042209 0.07100502]
Stock Position:  0.00011322971590274102
Bond Position:  [-3.94197598]


portfolio before change:  [-3.93091812]
curr_Stock_Price:  102.01063512432586
curr_Factors:  [102.01063512  -0.54764585  -1.02808216]
mat_Sqrt:  [[21.10160423  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00769734 0.08165407 0.38483691]
Stock Position:  0.007697336740925904
Bond Position:  [-4.71612833]


portfolio before change:  [-3.94105193]
curr_Stock_Price:  100.77069349360167
curr_Factors:  [100.77069349  -0.44007282  -1.0224698 ]
mat_Sqrt:  [[23.34318195  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00108939  0.00050782 -0.2605274 ]
Stock Position:  0.0010893900997230583
Bond Position:  [-4.05083052]


portfolio before change:  [-3.94175139]
curr_Stock_Price:  100.59345600640333
curr_Factors:  [100.59345601  -0.32907326  -1.03272976]
mat_Sqrt:  [[25.77188549  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-3.73403427e-05  1.35615505e-01  5.57971428e-01]
Stock Position:  -3.7340342664789344e-05
Bond Position:  [-3.9379952]


portfolio before change:  [-3.94223198]
curr_Stock_Price:  100.2802149143425
curr_Factors:  [100.28021491  -0.32335816  -1.04362381]
mat_Sqrt:  [[25.55892182  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0017622   0.03623244 -0.24293381]
Stock Position:  0.0017621957067006796
Bond Position:  [-4.11894534]


portfolio before change:  [-3.94338529]
curr_Stock_Price:  99.91793288611628
curr_Factors:  [99.91793289 -0.35552701 -1.02661642]
mat_Sqrt:  [[25.08338673  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00079546 -0.02123258 -0.06108675]
Stock Position:  -0.0007954648790872696
Bond Position:  [-3.86390408]


portfolio before change:  [-3.94458653]
curr_Stock_Price:  100.82082897011331
curr_Factors:  [100.82082897  -0.52825051  -1.01135506]
mat_Sqrt:  [[21.62260736  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00381563 -0.01337732 -0.12834362]
Stock Position:  -0.0038156313999131697
Bond Position:  [-3.55989141]


portfolio before change:  [-3.94711641]
curr_Stock_Price:  101.3672317817184
curr_Factors:  [101.36723178  -0.46874104  -1.00667343]
mat_Sqrt:  [[23.18105646  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00430418 0.00386954 0.46372244]
Stock Position:  0.004304176747506953
Bond Position:  [-4.3834189]


portfolio before change:  [-3.9489333]
curr_Stock_Price:  101.07241997614786
curr_Factors:  [101.07241998  -0.56618455  -0.99287502]
mat_Sqrt:  [[21.25894442  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00619526  0.02743053 -0.2416538 ]
Stock Position:  0.006195261682962289
Bond Position:  [-4.57510339]


portfolio before change:  [-3.95334841]
curr_Stock_Price:  100.45207645236339
curr_Factors:  [100.45207645  -1.00247475  -1.00658897]
mat_Sqrt:  [[13.47204823  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.007639   -0.02592449 -0.30641258]
Stock Position:  -0.0076389976289316305
Bond Position:  [-3.18599524]


portfolio before change:  [-3.95260785]
curr_Stock_Price:  100.3029945843609
curr_Factors:  [100.30299458  -0.97927591  -1.01930293]
mat_Sqrt:  [[13.59383953  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00623472 -0.0180637  -0.1677902 ]
Stock Position:  -0.006234721702216268
Bond Position:  [-3.32724659]


portfolio before change:  [-3.95330037]
curr_Stock_Price:  100.34735716760753
curr_Factors:  [100.34735717  -0.96476445  -1.00122109]
mat_Sqrt:  [[14.05041874  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00433724  0.02392198  0.28298835]
Stock Position:  -0.004337239149169153
Bond Position:  [-3.51806988]


portfolio before change:  [-3.95408746]
curr_Stock_Price:  100.42743124952602
curr_Factors:  [100.42743125  -1.21565662  -1.01415848]
mat_Sqrt:  [[10.80080085  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01277017 0.02142246 0.3673036 ]
Stock Position:  0.01277017217574389
Bond Position:  [-5.23656305]


portfolio before change:  [-3.94587969]
curr_Stock_Price:  101.12142146482452
curr_Factors:  [101.12142146  -1.08823172  -1.01282513]
mat_Sqrt:  [[12.36988813  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01838491 -0.01922426 -0.04352716]
Stock Position:  0.018384907489342697
Bond Position:  [-5.80498767]


portfolio before change:  [-3.94626889]
curr_Stock_Price:  101.13972296722827
curr_Factors:  [101.13972297  -1.12934137  -0.9967357 ]
mat_Sqrt:  [[12.06641396  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00495354  0.00078454 -0.13814515]
Stock Position:  -0.004953543420121344
Bond Position:  [-3.44526888]


portfolio before change:  [-3.94759544]
curr_Stock_Price:  101.3205755933825
curr_Factors:  [101.32057559  -1.06915175  -1.0003071 ]
mat_Sqrt:  [[12.79213668  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00633297 -0.01673402  0.19062128]
Stock Position:  0.00633296861829151
Bond Position:  [-4.58925546]


portfolio before change:  [-3.94149321]
curr_Stock_Price:  102.37472843377881
curr_Factors:  [102.37472843  -1.21960603  -0.99846061]
mat_Sqrt:  [[11.14034549  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00224343  0.02111472  0.52676   ]
Stock Position:  -0.0022434284944996634
Bond Position:  [-3.71182283]


portfolio before change:  [-3.94168619]
curr_Stock_Price:  102.25391925245309
curr_Factors:  [102.25391925  -1.05467912  -1.00655475]
mat_Sqrt:  [[13.01659723  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00386013 -0.00460959 -0.09970662]
Stock Position:  0.0038601322471016743
Bond Position:  [-4.33639985]


portfolio before change:  [-3.94228067]
curr_Stock_Price:  102.24034690633418
curr_Factors:  [102.24034691  -1.11503534  -1.00109868]
mat_Sqrt:  [[12.3196107   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.0092835  0.00979863 0.26622187]
Stock Position:  0.009283495424566322
Bond Position:  [-4.89142846]


portfolio before change:  [-3.94932224]
curr_Stock_Price:  101.54770890284198
curr_Factors:  [101.5477089   -1.09411387  -1.02173419]
mat_Sqrt:  [[12.2396498   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00481285 -0.01729031  0.21049823]
Stock Position:  0.004812852303508346
Bond Position:  [-4.43805636]


portfolio before change:  [-3.94949934]
curr_Stock_Price:  101.62618406705103
curr_Factors:  [101.62618407  -1.17787351  -1.03933535]
mat_Sqrt:  [[11.06837959  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01283753  0.02128377  0.13510203]
Stock Position:  -0.01283752578236547
Bond Position:  [-2.64487058]


portfolio before change:  [-3.94484398]
curr_Stock_Price:  101.23779267115859
curr_Factors:  [101.23779267  -0.66670333  -1.02282277]
mat_Sqrt:  [[18.689204    0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00229463  0.02328151  0.08378082]
Stock Position:  -0.0022946302051308964
Bond Position:  [-3.71254069]


portfolio before change:  [-3.94527873]
curr_Stock_Price:  101.2250021441008
curr_Factors:  [101.22500214  -0.498134    -1.00512262]
mat_Sqrt:  [[22.51291544  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00088487 -0.03185163 -0.49067816]
Stock Position:  0.0008848658573160257
Bond Position:  [-4.03484928]


portfolio before change:  [-3.94754221]
curr_Stock_Price:  99.23702908435801
curr_Factors:  [99.23702908 -0.48236179 -1.00043459]
mat_Sqrt:  [[22.52700587  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00042255 -0.0016125  -0.35326467]
Stock Position:  -0.00042255434486672763
Bond Position:  [-3.90560917]


portfolio before change:  [-3.9486809]
curr_Stock_Price:  100.7763765632502
curr_Factors:  [100.77637656  -0.40883877  -0.9804197 ]
mat_Sqrt:  [[25.11952675  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00012257 0.07213322 0.05388408]
Stock Position:  0.00012257116359724193
Bond Position:  [-3.96103318]


portfolio before change:  [-3.9490848]
curr_Stock_Price:  101.52091178373685
curr_Factors:  [101.52091178  -0.51253998  -0.98849782]
mat_Sqrt:  [[22.62888068  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-1.20411036e-04 -2.78717920e-02 -2.43497027e-01]
Stock Position:  -0.00012041103617516663
Bond Position:  [-3.93686056]


portfolio before change:  [-3.94982467]
curr_Stock_Price:  103.57831991869561
curr_Factors:  [103.57831992  -0.4881307   -0.99193892]
mat_Sqrt:  [[23.57668796  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00040451 -0.00086324  0.21819263]
Stock Position:  0.00040451366737866384
Bond Position:  [-3.99172352]


portfolio before change:  [-3.95037357]
curr_Stock_Price:  103.45494906376582
curr_Factors:  [103.45494906  -0.53550259  -0.9910128 ]
mat_Sqrt:  [[22.47988383  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00240801 -0.02709893 -0.0233374 ]
Stock Position:  -0.0024080131758073254
Bond Position:  [-3.70125269]


portfolio before change:  [-3.95078945]
curr_Stock_Price:  103.43550933302308
curr_Factors:  [103.43550933  -0.65556953  -1.01561148]
mat_Sqrt:  [[19.44844867  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00753245  0.04511962  0.09842128]
Stock Position:  -0.007532446589249552
Bond Position:  [-3.171667]


portfolio before change:  [-3.9629281]
curr_Stock_Price:  104.9943882762885
curr_Factors:  [104.99438828  -0.68398912  -1.0282553 ]
mat_Sqrt:  [[18.94731972  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00278104 -0.05211491 -0.39502345]
Stock Position:  0.0027810401736491483
Bond Position:  [-4.25492172]


portfolio before change:  [-3.96490423]
curr_Stock_Price:  104.4750763818145
curr_Factors:  [104.47507638  -0.66054485  -1.02443492]
mat_Sqrt:  [[19.37471329  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00978455 -0.09995091  0.12598193]
Stock Position:  -0.009784547651396762
Bond Position:  [-2.94266287]


portfolio before change:  [-3.96489044]
curr_Stock_Price:  104.43607171813781
curr_Factors:  [104.43607172  -0.75427704  -0.99709796]
mat_Sqrt:  [[18.1233314   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00216822 -0.01080998  0.14910319]
Stock Position:  -0.002168222178978718
Bond Position:  [-3.73844984]


portfolio before change:  [-3.96466436]
curr_Stock_Price:  104.11626069920521
curr_Factors:  [104.1162607   -0.73435527  -0.99733745]
mat_Sqrt:  [[18.42697168  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00214618  0.02463211 -0.07327548]
Stock Position:  -0.0021461788937992303
Bond Position:  [-3.74121224]


portfolio before change:  [-3.96618466]
curr_Stock_Price:  104.60672249577928
curr_Factors:  [104.6067225   -0.7912884   -0.99620004]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-3.96618466]
Stock Price:  105.26858066691544
PL:  [-9.23476532]
Settle:  Tensor("sub_240:0", shape=(), dtype=float64)
PL:  Tensor("sub_241:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  121
output_Z_Vals[:, i, :]:  [[ 1.19260232e+02 -2.92559343e+01 -2.92733494e+01]
 [-9.37742802e-02  2.31930832e-01  3.15375031e-02]
 [ 7.08825593e-02  6.06926962e-02 -2.35925084e-02]
 [ 8.05539611e-02  1.30182713e-01  3.74204114e-02]
 [ 2.31741854e-01 -1.72613463e-02 -3.38076619e-02]
 [-1.01112482e-03  3.06377463e-02  1.05900176e-01]
 [-2.53805065e-02  5.20255169e-02 -1.18079349e-01]
 [-2.12595283e-02  2.33075581e-01  6.27803415e-02]
 [-3.51629922e-02  8.73235534e-03  2.27067254e-02]
 [-6.44671168e-02  3.69751692e-01  1.65722251e-01]
 [ 5.67082177e-02  3.65233401e-02 -7.79821873e-02]
 [-6.35533009e-02  9.38116683e-02  1.56744256e-02]
 [-7.68479218e-02 -3.93634993e-02 -6.22371793e-02]
 [ 1.04351890e-02 -1.14584571e-02  1.32937824e-01]
 [ 2.10542033e-01  2.73832064e-01  4.53169323e-02]
 [-7.83781297e-02 -8.15513790e-02 -1.07680347e-01]
 [-7.60700151e-02 -3.91003754e-02 -6.73189878e-02]
 [-1.04330860e-02  6.23782069e-02  3.61324074e-02]
 [ 1.03221248e-01  7.68369857e-02  1.34041840e-01]
 [ 2.63282784e-01 -7.07965078e-02 -1.86812711e-02]
 [-4.49305139e-02  9.28494543e-04 -4.97584447e-02]
 [ 7.21500281e-02 -5.52735176e-02  7.01437283e-02]
 [ 2.26512538e-03 -1.58407920e-01 -3.94570972e-03]
 [-4.46986130e-02 -8.04339927e-02 -3.71967463e-02]
 [-6.47490395e-02  6.82111310e-02  6.64579453e-02]
 [ 5.21097899e-02 -4.67657774e-02  7.15678913e-02]
 [-1.72309079e-01  7.23392768e-02  6.32712512e-02]
 [ 3.00248896e-02 -5.61231655e-03  5.35327805e-03]
 [-1.55799721e-02 -5.54190964e-02 -2.42864524e-01]
 [ 2.69179505e-02  6.49172653e-03 -5.70866410e-02]
 [ 4.99821652e-02  5.80291914e-02  3.72884126e-02]
 [ 1.51269260e-02 -6.51662879e-02 -9.02783799e-02]
 [ 1.92996087e-01 -2.00799523e-01 -1.35534030e-01]
 [-5.22162562e-02 -8.76145431e-02 -1.35917036e-02]
 [-1.42339684e-01  8.54053383e-02  3.40198839e-02]
 [ 8.47165236e-02 -1.65012150e-01 -1.38726811e-01]
 [-1.41492677e-01 -2.59622026e-01  2.52381736e-02]
 [-2.84134742e-02  1.70786237e-03 -4.48809977e-02]
 [-4.81727706e-02  9.40302749e-02  6.98878262e-03]
 [-4.64907561e-01  2.40954996e-01  2.81923083e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.26023247 -29.25593426 -29.27334937]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  8.31486419  -9.25153874 -83.50871763]
init_Out:  [2.49911038]
Stock Position:  8.31486419409362
Bond position:  [-828.98730903]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [9.08834179]
curr_Stock_Price:  100.80492731395732
curr_Factors:  [100.80492731  -0.99618164  -1.01484541]
mat_Sqrt:  [[13.4928537   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00602899  0.07334297  0.08996772]
Stock Position:  -0.006028990442786346
Bond Position:  [9.69609374]


portfolio before change:  [9.08794965]
curr_Stock_Price:  101.07101303797579
curr_Factors:  [101.07101304  -0.92896267  -1.03707899]
mat_Sqrt:  [[14.15094924  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00477946  0.01919272 -0.06730286]
Stock Position:  0.004779455865992756
Bond Position:  [8.6048852]


portfolio before change:  [9.09116708]
curr_Stock_Price:  101.51912846397848
curr_Factors:  [101.51912846  -0.75981049  -1.05220576]
mat_Sqrt:  [[16.58056102  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00552175 0.04116739 0.10675002]
Stock Position:  0.005521747648410285
Bond Position:  [8.53060407]


portfolio before change:  [9.09505102]
curr_Stock_Price:  102.02939340129605
curr_Factors:  [102.0293934   -0.78922168  -1.03998305]
mat_Sqrt:  [[16.37992025  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01369941 -0.00545852 -0.09644385]
Stock Position:  0.013699407811814899
Bond Position:  [7.69730875]


portfolio before change:  [9.0976889]
curr_Stock_Price:  102.15170941256069
curr_Factors:  [102.15170941  -0.85391322  -1.04669056]
mat_Sqrt:  [[15.26946804  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00140127 0.00968851 0.30210372]
Stock Position:  0.0014012748304415303
Bond Position:  [8.95454628]


portfolio before change:  [9.09908093]
curr_Stock_Price:  102.34627573246244
curr_Factors:  [102.34627573  -1.12593717  -1.0158193 ]
mat_Sqrt:  [[12.02040292  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00400486  0.01645191 -0.33684752]
Stock Position:  -0.0040048623892234335
Bond Position:  [9.50896368]


portfolio before change:  [9.10421049]
curr_Stock_Price:  101.36225604440263
curr_Factors:  [101.36225604  -0.9740215   -1.04825282]
mat_Sqrt:  [[13.41571099  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00018087  0.07370497  0.17909484]
Stock Position:  -0.00018087443734604214
Bond Position:  [9.12254433]


portfolio before change:  [9.10525884]
curr_Stock_Price:  101.87110215178362
curr_Factors:  [101.87110215  -0.96932146  -1.02517749]
mat_Sqrt:  [[13.86280501  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00218589  0.00276141  0.06477597]
Stock Position:  -0.0021858875508945575
Bond Position:  [9.32793762]


portfolio before change:  [9.1079559]
curr_Stock_Price:  101.17070445273193
curr_Factors:  [101.17070445  -0.90101384  -1.02567492]
mat_Sqrt:  [[14.73345081  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00143159  0.11692575  0.47275945]
Stock Position:  -0.001431589696895552
Bond Position:  [9.25279084]


portfolio before change:  [9.10865689]
curr_Stock_Price:  101.48900821215206
curr_Factors:  [101.48900821  -1.00348009  -1.03089532]
mat_Sqrt:  [[13.2709188   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00314471  0.01154969 -0.22246147]
Stock Position:  0.0031447105937563143
Bond Position:  [8.78950333]


portfolio before change:  [9.11165483]
curr_Stock_Price:  102.09293748883853
curr_Factors:  [102.09293749  -1.21037375  -1.01921149]
mat_Sqrt:  [[10.98244747  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00527492  0.02966585  0.04471477]
Stock Position:  -0.005274923055700679
Bond Position:  [9.65018722]


portfolio before change:  [9.11467121]
curr_Stock_Price:  101.7497985778978
curr_Factors:  [101.74979858  -0.95193253  -1.03760779]
mat_Sqrt:  [[13.91512702  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00650863 -0.01244783 -0.17754535]
Stock Position:  -0.006508628622701067
Bond Position:  [9.77692286]


portfolio before change:  [9.12082721]
curr_Stock_Price:  100.99175740875363
curr_Factors:  [100.99175741  -0.8038493   -1.04193251]
mat_Sqrt:  [[15.94678276  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00233747 -0.00362348  0.37923461]
Stock Position:  0.00233747164111293
Bond Position:  [8.88476184]


portfolio before change:  [9.12172106]
curr_Stock_Price:  100.8990003956803
curr_Factors:  [100.8990004   -1.00668007  -1.02913743]
mat_Sqrt:  [[13.17475527  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01721949 0.0865933  0.12927659]
Stock Position:  0.01721949454283394
Bond Position:  [7.38429127]


portfolio before change:  [9.11722242]
curr_Stock_Price:  100.58414043811948
curr_Factors:  [100.58414044  -0.99151875  -1.00527458]
mat_Sqrt:  [[13.65630419  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00750305 -0.02578881 -0.30718206]
Stock Position:  -0.007503050213991175
Bond Position:  [9.87191028]


portfolio before change:  [9.11238621]
curr_Stock_Price:  101.39318152903387
curr_Factors:  [101.39318153  -1.32270605  -1.00794135]
mat_Sqrt:  [[ 9.85874079  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00921223 -0.01236462 -0.19204233]
Stock Position:  -0.009212232597784106
Bond Position:  [10.04644378]


portfolio before change:  [9.10555207]
curr_Stock_Price:  102.27136403864458
curr_Factors:  [102.27136404  -1.64237637  -0.99170892]
mat_Sqrt:  [[ 7.34150912  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0001971   0.01972572  0.1030757 ]
Stock Position:  -0.00019709719908321194
Bond Position:  [9.12570947]


portfolio before change:  [9.1068774]
curr_Stock_Price:  101.33507075478121
curr_Factors:  [101.33507075  -1.87768076  -0.96783475]
mat_Sqrt:  [[ 5.88800393  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.02251465 0.02429799 0.38238406]
Stock Position:  0.022514649770069225
Bond Position:  [6.82535377]


portfolio before change:  [9.11326354]
curr_Stock_Price:  101.58081814311947
curr_Factors:  [101.58081814  -1.87469984  -0.99196959]
mat_Sqrt:  [[ 5.77873784  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.04458439 -0.02238782 -0.05329247]
Stock Position:  0.04458439445667541
Bond Position:  [4.58434427]


portfolio before change:  [9.11931103]
curr_Stock_Price:  101.70360582707063
curr_Factors:  [101.70360583  -2.10588053  -0.99679122]
mat_Sqrt:  [[ 4.56944161  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01205037  0.00029362 -0.14194699]
Stock Position:  -0.012050365226096637
Bond Position:  [10.34487663]


portfolio before change:  [9.12240078]
curr_Stock_Price:  101.55451844573365
curr_Factors:  [101.55451845  -2.06641623  -1.01432009]
mat_Sqrt:  [[ 4.66393475  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01823372 -0.01747902  0.20010053]
Stock Position:  0.018233724348198907
Bond Position:  [7.27068368]


portfolio before change:  [9.11951697]
curr_Stock_Price:  101.34651339783858
curr_Factors:  [101.3465134   -2.05491279  -1.04163472]
mat_Sqrt:  [[ 4.58136946  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00057414 -0.05009298 -0.01125601]
Stock Position:  -0.0005741436415250448
Bond Position:  [9.17770442]


portfolio before change:  [9.12052106]
curr_Stock_Price:  101.59590652124831
curr_Factors:  [101.59590652  -1.87608145  -1.04925705]
mat_Sqrt:  [[ 5.4502678   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00997532 -0.02543546 -0.10611196]
Stock Position:  -0.009975319715858461
Bond Position:  [10.13397271]


portfolio before change:  [9.12045513]
curr_Stock_Price:  101.72951183323414
curr_Factors:  [101.72951183  -1.8483516   -1.02792783]
mat_Sqrt:  [[ 5.73184815  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00862238  0.02157025  0.18958602]
Stock Position:  -0.008622378517572294
Bond Position:  [9.99760549]


portfolio before change:  [9.11755773]
curr_Stock_Price:  102.21049020299394
curr_Factors:  [102.2104902   -1.90875734  -1.04322794]
mat_Sqrt:  [[ 5.33905698  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01227015 -0.01478864  0.20416327]
Stock Position:  0.01227015139069559
Bond Position:  [7.86341955]


portfolio before change:  [9.11560398]
curr_Stock_Price:  101.97114990503032
curr_Factors:  [101.97114991  -1.63971579  -1.07768185]
mat_Sqrt:  [[ 6.73482812  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02338977  0.02287569  0.18049527]
Stock Position:  -0.023389772363578674
Bond Position:  [11.50068597]


portfolio before change:  [9.11817358]
curr_Stock_Price:  101.9227560840813
curr_Factors:  [101.92275608  -1.44700725  -1.06853162]
mat_Sqrt:  [[ 8.23733086  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00376004 -0.00177477  0.01527141]
Stock Position:  0.003760042422420222
Bond Position:  [8.73493969]


portfolio before change:  [9.11924663]
curr_Stock_Price:  101.91773429418352
curr_Factors:  [101.91773429  -1.7029734   -1.0773113 ]
mat_Sqrt:  [[ 6.32102423  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01053396 -0.01752506 -0.69282489]
Stock Position:  -0.010533957465326876
Bond Position:  [10.19284371]


portfolio before change:  [9.12489397]
curr_Stock_Price:  101.50258612489262
curr_Factors:  [101.50258612  -1.49885425  -1.06644639]
mat_Sqrt:  [[ 7.80514896  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00197726  0.00205286 -0.1628523 ]
Stock Position:  0.001977259420092808
Bond Position:  [8.92419702]


portfolio before change:  [9.12550888]
curr_Stock_Price:  101.24936386400014
curr_Factors:  [101.24936386  -1.42472231  -1.07111448]
mat_Sqrt:  [[ 8.34572665  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.0070805  0.01835044 0.10637346]
Stock Position:  0.007080502433708611
Bond Position:  [8.40861251]


portfolio before change:  [9.1268064]
curr_Stock_Price:  101.2841604784664
curr_Factors:  [101.28416048  -1.25753201  -1.08257433]
mat_Sqrt:  [[ 9.7554265   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00051086 -0.02060739 -0.25753909]
Stock Position:  -0.0005108600315681418
Bond Position:  [9.17854843]


portfolio before change:  [9.12772841]
curr_Stock_Price:  101.72533922483287
curr_Factors:  [101.72533922  -1.1315502   -1.05978036]
mat_Sqrt:  [[11.36963119  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01408539 -0.06349838 -0.38664086]
Stock Position:  0.014085390675038037
Bond Position:  [7.69488726]


portfolio before change:  [9.12965487]
curr_Stock_Price:  101.79381723188993
curr_Factors:  [101.79381723  -1.18450149  -1.05857195]
mat_Sqrt:  [[10.80356232  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00529944 -0.02770615 -0.03877335]
Stock Position:  -0.005299441723624786
Bond Position:  [9.66910527]


portfolio before change:  [9.13266125]
curr_Stock_Price:  101.45459921880106
curr_Factors:  [101.45459922  -1.2385888   -1.0399379 ]
mat_Sqrt:  [[10.39250314  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01281599  0.02700754  0.09704926]
Stock Position:  -0.012815993017380458
Bond Position:  [10.43290268]


portfolio before change:  [9.1370877]
curr_Stock_Price:  101.210977086249
curr_Factors:  [101.21097709  -1.27572651  -1.03297894]
mat_Sqrt:  [[10.05934208  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00518309 -0.05218142 -0.39574898]
Stock Position:  0.005183086134630275
Bond Position:  [8.61250249]


portfolio before change:  [9.13878401]
curr_Stock_Price:  101.3305348387556
curr_Factors:  [101.33053484  -1.26390637  -1.03897448]
mat_Sqrt:  [[10.130057    0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01412079 -0.08209969  0.07199748]
Stock Position:  -0.014120786143522126
Bond Position:  [10.56965082]


portfolio before change:  [9.14530191]
curr_Stock_Price:  100.96252328310236
curr_Factors:  [100.96252328  -1.43056791  -1.05333812]
mat_Sqrt:  [[ 8.42196656  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00445628  0.00054007 -0.12803299]
Stock Position:  -0.0044562837397009855
Bond Position:  [9.59521956]


portfolio before change:  [9.14821727]
curr_Stock_Price:  100.57747545226135
curr_Factors:  [100.57747545  -1.42426986  -1.04480489]
mat_Sqrt:  [[ 8.5152066   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00520461  0.02973498  0.01993705]
Stock Position:  -0.005204611251617112
Bond Position:  [9.67168393]


portfolio before change:  [9.15033184]
curr_Stock_Price:  100.40348956621756
curr_Factors:  [100.40348957  -1.23502895  -1.04544313]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [9.15033184]
Stock Price:  100.89197037775004
PL:  [8.25836146]
Settle:  Tensor("sub_242:0", shape=(), dtype=float64)
PL:  Tensor("sub_243:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  122
output_Z_Vals[:, i, :]:  [[ 1.19260232e+02 -2.92559343e+01 -2.92733494e+01]
 [ 4.58797589e-02  2.79716549e-02 -8.20946099e-02]
 [-5.37607527e-02  7.97804722e-03  1.03212141e-01]
 [-6.73321047e-03  1.62359257e-01  2.06201009e-02]
 [ 5.58630552e-02  2.41324061e-02 -6.81726579e-02]
 [ 6.90227571e-02  2.88160308e-02 -1.03625346e-01]
 [ 7.07101011e-02  1.51625217e-02 -6.62149386e-02]
 [-1.02019039e-01 -3.75473999e-02 -1.11410749e-01]
 [-3.45329351e-02 -5.84510884e-02  1.19332846e-02]
 [-7.03949440e-02 -1.25249302e-01 -1.27789067e-01]
 [ 5.79898865e-02  1.64244231e-01 -8.57644608e-02]
 [-1.17308491e-01 -9.60331365e-02  1.69726420e-02]
 [-1.02563875e-01  2.27314921e-02 -1.60919137e-02]
 [-9.62623594e-02 -1.14884369e-01  6.32126881e-02]
 [ 3.11060639e-01  3.63271541e-01  1.65077246e-02]
 [-6.95010468e-02 -2.38548234e-01 -8.15945381e-02]
 [-6.72222858e-02 -5.50142603e-02 -4.07681582e-02]
 [-7.51602582e-02  2.02299653e-01  1.34252893e-01]
 [ 5.59270719e-02  7.16926141e-02  5.80966140e-02]
 [-4.89350899e-02 -1.82899864e-02  1.21286526e-01]
 [ 1.02962745e-02 -5.17964076e-02  1.71303399e-02]
 [ 1.23484138e-01  2.21595786e-02  2.49688565e-01]
 [-2.40636529e-02 -8.38578103e-02  1.96121571e-01]
 [-6.22194053e-02 -7.17501629e-04 -8.38664902e-02]
 [-5.19103649e-01  1.61405022e-01  3.43173846e-02]
 [-7.11168168e-02 -1.85358339e-01  1.11084632e-01]
 [ 2.40421806e-01  4.25177166e-02 -1.41984826e-01]
 [ 4.67860232e-02 -1.68021626e-01 -7.98022144e-02]
 [-9.30740823e-02 -8.97778648e-02 -1.80407639e-01]
 [ 7.21706621e-03 -5.09686533e-03 -1.14302753e-01]
 [ 2.23938920e-02 -8.41221351e-03  2.51085266e-02]
 [ 4.50978703e-02 -7.65384960e-02 -8.95042675e-02]
 [ 3.29619511e-01 -3.88683627e-01 -3.73612276e-01]
 [-4.87411792e-02 -8.42219625e-02 -4.03177562e-03]
 [-9.62815214e-02 -4.02697760e-02  2.74704458e-02]
 [ 2.06022350e-03 -1.32176438e-01 -1.05915462e-01]
 [-3.11699579e-02 -1.57404922e-01 -4.38467475e-02]
 [-2.11053703e-02  1.61935262e-02 -7.94634665e-02]
 [-2.43756952e-02 -4.91586872e-03  2.19612170e-02]
 [-8.92295581e-01  4.42239742e-01  5.46747328e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.26023247 -29.25593426 -29.27334937]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  8.31486419  -9.25153874 -83.50871763]
init_Out:  [2.49911038]
Stock Position:  8.31486419409362
Bond position:  [-828.98730903]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [0.63998383]
curr_Stock_Price:  99.78887247916477
curr_Factors:  [99.78887248 -1.26395058 -0.99910612]
mat_Sqrt:  [[10.38123628  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00287485  0.00884541 -0.23419307]
Stock Position:  0.0028748494921377703
Bond Position:  [0.35310584]


portfolio before change:  [0.63720203]
curr_Stock_Price:  98.80588513612261
curr_Factors:  [98.80588514 -1.41232462 -1.00424671]
mat_Sqrt:  [[ 8.81615504  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0036849   0.00252288  0.29443551]
Stock Position:  -0.003684902353343197
Bond Position:  [1.00129207]


portfolio before change:  [0.63814233]
curr_Stock_Price:  98.58467548062669
curr_Factors:  [98.58467548 -1.38961886 -1.01208549]
mat_Sqrt:  [[ 8.92817028  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00018682 0.05134251 0.05882341]
Stock Position:  0.00018681856702562597
Bond Position:  [0.61972488]


portfolio before change:  [0.63827467]
curr_Stock_Price:  98.87836574733531
curr_Factors:  [98.87836575 -1.39396905 -1.01148753]
mat_Sqrt:  [[ 8.92123045  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00477182  0.00763134 -0.19447762]
Stock Position:  0.004771815492090741
Bond Position:  [0.16644535]


portfolio before change:  [0.64059859]
curr_Stock_Price:  99.3610157995174
curr_Factors:  [99.3610158  -1.22640859 -1.00434316]
mat_Sqrt:  [[10.6761053   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00455357  0.00911243 -0.29561427]
Stock Position:  0.004553565853663987
Bond Position:  [0.18815166]


portfolio before change:  [0.64072313]
curr_Stock_Price:  99.38319895153924
curr_Factors:  [99.38319895 -1.36854289 -1.02690741]
mat_Sqrt:  [[ 9.05695321  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00635816  0.00479481 -0.18889279]
Stock Position:  0.0063581567327233544
Bond Position:  [0.00882917]


portfolio before change:  [0.63733727]
curr_Stock_Price:  98.8505037781987
curr_Factors:  [98.85050378 -1.31577826 -1.08639243]
mat_Sqrt:  [[ 8.94807083  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01405109 -0.01187353 -0.31782386]
Stock Position:  -0.01405108820807705
Bond Position:  [2.02629442]


portfolio before change:  [0.64929765]
curr_Stock_Price:  98.01732449436544
curr_Factors:  [98.01732449 -1.20768962 -1.05429398]
mat_Sqrt:  [[10.20788687  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00329219 -0.01848386  0.03404234]
Stock Position:  -0.003292186190748807
Bond Position:  [0.97198893]


portfolio before change:  [0.64761811]
curr_Stock_Price:  98.564391624626
curr_Factors:  [98.56439162 -1.25810764 -1.02654699]
mat_Sqrt:  [[10.03476355  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00993683 -0.03960731 -0.36454664]
Stock Position:  -0.009936826183302041
Bond Position:  [1.62703534]


portfolio before change:  [0.64397132]
curr_Stock_Price:  98.95185765240544
curr_Factors:  [98.95185765 -1.17573656 -1.04625926]
mat_Sqrt:  [[10.72564531  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00416982  0.05193859 -0.24466213]
Stock Position:  0.004169824356193779
Bond Position:  [0.23135945]


portfolio before change:  [0.6426189]
curr_Stock_Price:  98.62058769046136
curr_Factors:  [98.62058769 -1.10949493 -1.01889489]
mat_Sqrt:  [[11.73869003  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00990941 -0.03036834  0.04841822]
Stock Position:  -0.009909413204364361
Bond Position:  [1.61989106]


portfolio before change:  [0.65617541]
curr_Stock_Price:  97.27297935932889
curr_Factors:  [97.27297936 -1.0862759  -1.00905424]
mat_Sqrt:  [[11.96745766  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00879566  0.00718833 -0.04590575]
Stock Position:  -0.008795660857897987
Bond Position:  [1.51175555]


portfolio before change:  [0.64678347]
curr_Stock_Price:  98.36225697301465
curr_Factors:  [98.36225697 -0.94672335 -0.99153016]
mat_Sqrt:  [[14.15975308  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00609653 -0.03632963  0.1803282 ]
Stock Position:  -0.006096534641060618
Bond Position:  [1.24645238]


portfolio before change:  [0.64947954]
curr_Stock_Price:  97.94558529634051
curr_Factors:  [97.9455853  -0.92245731 -0.97741576]
mat_Sqrt:  [[14.65144556  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.02210088 0.11487655 0.04709194]
Stock Position:  0.02210088374576632
Bond Position:  [-1.51520445]


portfolio before change:  [0.66968776]
curr_Stock_Price:  98.8685180671335
curr_Factors:  [98.86851807 -0.88584428 -0.9607799 ]
mat_Sqrt:  [[15.59837424  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00591829 -0.07543558 -0.23276651]
Stock Position:  -0.005918293128502715
Bond Position:  [1.25482063]


portfolio before change:  [0.67614606]
curr_Stock_Price:  97.8037795055027
curr_Factors:  [97.80377951 -1.2346409  -0.97361798]
mat_Sqrt:  [[10.74783503  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00716093 -0.01739704 -0.11630021]
Stock Position:  -0.007160931770498307
Bond Position:  [1.37651225]


portfolio before change:  [0.67720734]
curr_Stock_Price:  97.67960472791219
curr_Factors:  [97.67960473 -1.25264299 -0.96132481]
mat_Sqrt:  [[10.67308318  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00398504  0.06397277  0.38298614]
Stock Position:  -0.003985038427779603
Bond Position:  [1.06646432]


portfolio before change:  [0.67726629]
curr_Stock_Price:  97.69826568198513
curr_Factors:  [97.69826568 -1.4053424  -0.98181541]
mat_Sqrt:  [[ 8.97754089  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00775681 0.0226712  0.16573347]
Stock Position:  0.007756811111743348
Bond Position:  [-0.0805607]


portfolio before change:  [0.67768615]
curr_Stock_Price:  97.75369218379616
curr_Factors:  [97.75369218 -1.30732407 -1.01858249]
mat_Sqrt:  [[ 9.55003105  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00258113 -0.0057838   0.3459967 ]
Stock Position:  -0.0025811253158965846
Bond Position:  [0.93000068]


portfolio before change:  [0.67635879]
curr_Stock_Price:  98.31299114454907
curr_Factors:  [98.31299114 -1.04205661 -1.00776572]
mat_Sqrt:  [[12.65856234  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00098397 -0.01637946  0.04886809]
Stock Position:  0.0009839674246849566
Bond Position:  [0.57962201]


portfolio before change:  [0.67533643]
curr_Stock_Price:  97.2003310370349
curr_Factors:  [97.20033104 -1.18741213 -1.02613624]
mat_Sqrt:  [[10.62517034  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01647256 0.00700747 0.71229198]
Stock Position:  0.01647256047903283
Bond Position:  [-0.9258019]


portfolio before change:  [0.6826934]
curr_Stock_Price:  97.65397645282553
curr_Factors:  [97.65397645 -1.0350982  -1.03992256]
mat_Sqrt:  [[12.26082987  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00112589 -0.02651817  0.55948025]
Stock Position:  0.0011258859185802746
Bond Position:  [0.57274616]


portfolio before change:  [0.68259399]
curr_Stock_Price:  97.50209527480972
curr_Factors:  [97.50209527 -1.40943864 -1.04223935]
mat_Sqrt:  [[ 8.39969905  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-9.44761309e-03 -2.26893937e-04 -2.39247753e-01]
Stock Position:  -0.009447613091837129
Bond Position:  [1.60375606]


portfolio before change:  [0.68452359]
curr_Stock_Price:  97.31907334138218
curr_Factors:  [97.31907334 -1.43888199 -1.03645375]
mat_Sqrt:  [[ 8.18791481  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.06203425  0.05104075  0.09789795]
Stock Position:  -0.062034253422436444
Bond Position:  [6.72163965]


portfolio before change:  [0.66468278]
curr_Stock_Price:  97.65245484115336
curr_Factors:  [97.65245484 -1.4506006  -1.03903338]
mat_Sqrt:  [[ 8.09932569  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00657187 -0.05861545  0.31689354]
Stock Position:  -0.006571867210325635
Bond Position:  [1.30644175]


portfolio before change:  [0.66382661]
curr_Stock_Price:  97.80758408520389
curr_Factors:  [97.80758409 -1.60429452 -1.04507315]
mat_Sqrt:  [[ 6.9145954   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.03073746  0.01344528 -0.40504319]
Stock Position:  0.030737456794971914
Bond Position:  [-2.34252978]


portfolio before change:  [0.68488097]
curr_Stock_Price:  98.5020851225526
curr_Factors:  [98.50208512 -1.8028086  -1.03075175]
mat_Sqrt:  [[ 5.79223002  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00451608 -0.0531331  -0.22765351]
Stock Position:  0.004516078358840913
Bond Position:  [0.24003783]


portfolio before change:  [0.68508962]
curr_Stock_Price:  98.54164239797326
curr_Factors:  [98.5416424  -1.67792404 -1.01581795]
mat_Sqrt:  [[ 6.66411545  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01984025 -0.02839025 -0.51465278]
Stock Position:  -0.01984024629179661
Bond Position:  [2.64018007]


portfolio before change:  [0.68863824]
curr_Stock_Price:  98.37941764216895
curr_Factors:  [98.37941764 -1.72459455 -1.02131427]
mat_Sqrt:  [[ 6.31496869  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00257269 -0.00161177 -0.32607394]
Stock Position:  -0.002572694619677262
Bond Position:  [0.94173844]


portfolio before change:  [0.68813142]
curr_Stock_Price:  98.62217661679786
curr_Factors:  [98.62217662 -1.53549264 -1.03464301]
mat_Sqrt:  [[ 7.54707829  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00361755 -0.00266018  0.07162764]
Stock Position:  0.0036175517305380694
Bond Position:  [0.33136059]


portfolio before change:  [0.68943554]
curr_Stock_Price:  98.97122490306405
curr_Factors:  [98.9712249  -1.48896847 -0.99921376]
mat_Sqrt:  [[ 8.22063059  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00302309 -0.0242036  -0.25533076]
Stock Position:  0.003023085936209051
Bond Position:  [0.39023703]


portfolio before change:  [0.68995741]
curr_Stock_Price:  99.12771379137207
curr_Factors:  [99.12771379 -1.40609285 -0.97631075]
mat_Sqrt:  [[ 9.15230229  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.02658571 -0.12291256 -1.06581183]
Stock Position:  0.026585710219989553
Bond Position:  [-1.94542327]


portfolio before change:  [0.6732322]
curr_Stock_Price:  98.50775641288374
curr_Factors:  [98.50775641 -1.20349817 -0.94734515]
mat_Sqrt:  [[11.46492037  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00451279 -0.02663332 -0.01150153]
Stock Position:  -0.004512788748380604
Bond Position:  [1.1177769]


portfolio before change:  [0.67298936]
curr_Stock_Price:  98.59253176004486
curr_Factors:  [98.59253176 -1.66547118 -0.96426721]
mat_Sqrt:  [[ 7.10825741  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01290245 -0.01273442  0.07836554]
Stock Position:  -0.012902445147373197
Bond Position:  [1.9450741]


portfolio before change:  [0.67974035]
curr_Stock_Price:  98.08814413321778
curr_Factors:  [98.08814413 -1.43463001 -0.96995164]
mat_Sqrt:  [[ 8.8576798   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00259351 -0.04179786 -0.30214733]
Stock Position:  -0.002593507668316919
Bond Position:  [0.9341327]


portfolio before change:  [0.67994441]
curr_Stock_Price:  98.05448665649493
curr_Factors:  [98.05448666 -1.20205247 -1.00234102]
mat_Sqrt:  [[10.81711733  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00408467 -0.04977581 -0.12508257]
Stock Position:  -0.004084666366713679
Bond Position:  [1.08046427]


portfolio before change:  [0.67991318]
curr_Stock_Price:  98.09519870201103
curr_Factors:  [98.0951987  -1.28212725 -1.02562984]
mat_Sqrt:  [[ 9.75891613  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00378194  0.00512084 -0.22668715]
Stock Position:  -0.0037819432929885413
Bond Position:  [1.05090366]


portfolio before change:  [0.68091524]
curr_Stock_Price:  97.8649775276434
curr_Factors:  [97.86497753 -1.55384103 -1.00630217]
mat_Sqrt:  [[ 7.56434338  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0026466  -0.00155453  0.06264924]
Stock Position:  -0.0026466021930136785
Bond Position:  [0.9399249]


portfolio before change:  [0.68209039]
curr_Stock_Price:  97.46534876107273
curr_Factors:  [97.46534876 -1.59107592 -1.02107215]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [0.68209039]
Stock Price:  97.12557259565561
PL:  [0.68209039]
Settle:  Tensor("sub_244:0", shape=(), dtype=float64)
PL:  Tensor("sub_245:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  123
output_Z_Vals[:, i, :]:  [[ 1.19260232e+02 -2.92559343e+01 -2.92733494e+01]
 [ 4.03706775e-03 -1.27034308e-01 -3.91946428e-02]
 [-4.88226004e-02  1.66372673e-02  1.02686981e-01]
 [-5.62863106e-02  1.11905209e-01  1.15981340e-02]
 [ 6.12637025e-02  2.27491773e-02 -6.94658047e-02]
 [ 5.63344230e-02  2.91787265e-02  3.19254918e-02]
 [-4.63524996e-02  4.25447870e-02 -1.37162218e-01]
 [ 1.73459909e-01  2.23170978e-01  1.49625144e-01]
 [ 6.80192932e-02  5.63683228e-02  6.86897692e-02]
 [-5.24829230e-02  6.89123717e-02  1.21373106e-02]
 [ 1.59627931e-02 -1.50053981e-01 -1.89220397e-02]
 [-1.02922598e-01  1.14965291e-01  3.99700499e-02]
 [-5.48177481e-03 -1.52717338e-01 -3.09548088e-02]
 [ 2.70774922e-01  2.17084151e-01  3.04784213e-01]
 [ 5.70520267e-02 -1.36484967e-01 -2.22255003e-01]
 [-6.61739473e-02 -9.54961551e-02 -1.27104433e-01]
 [-7.98093905e-02 -1.87028047e-02 -6.07429316e-02]
 [-8.98782164e-02 -1.74055786e-01  3.48953939e-02]
 [ 1.16499727e-02  5.00562035e-02 -1.33144522e-02]
 [ 1.78075362e-01 -4.06611489e-02 -5.66316822e-03]
 [-6.39040238e-02 -3.99091180e-04 -1.93836656e-02]
 [-3.16948061e-04 -5.22572271e-03 -4.45990276e-04]
 [-1.57293523e-01  3.75244163e-01  4.93097822e-01]
 [ 3.33336856e-01 -4.04581644e-02  8.02349476e-02]
 [-3.01208215e-01 -1.31988073e-01 -3.14218214e-01]
 [ 8.32677830e-02 -1.52651558e-01  7.76031889e-02]
 [ 4.45655016e-01  4.63499808e-01  1.63273362e-01]
 [-5.12341356e-02  6.20946178e-02  1.37489726e-02]
 [-9.05903544e-02  5.32537835e-01  2.39017817e-01]
 [-2.56527532e-01 -4.01796956e-01  1.74506950e-01]
 [-2.94855058e-01  1.19620974e+00 -7.95047416e-02]
 [ 7.61730687e-02  5.02211669e-01  5.79672177e-01]
 [-6.60716506e-02  2.27031835e-02  8.38011601e-02]
 [-9.40095791e-01  1.56105935e-01  9.88946619e-03]
 [-6.98859734e-02  4.64933354e-01 -1.30357169e-02]
 [ 8.47165236e-02 -1.65012150e-01 -1.38726811e-01]
 [-4.60655008e-01 -8.74189011e-01  3.10689939e-01]
 [-1.42095763e-01 -2.04634952e-01  4.98660220e-01]
 [ 2.75596399e-02 -1.67901665e-02 -5.78822191e-02]
 [ 4.65734966e-01 -3.27554328e-02 -4.80161881e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.26023247 -29.25593426 -29.27334937]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  8.31486419  -9.25153874 -83.50871763]
init_Out:  [2.49911038]
Stock Position:  8.31486419409362
Bond position:  [-828.98730903]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [0.15941756]
curr_Stock_Price:  99.731076433698
curr_Factors:  [99.73107643 -0.88309408 -0.99160698]
mat_Sqrt:  [[15.2988287   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00047347 -0.04017178 -0.11181141]
Stock Position:  -0.0004734687267156743
Bond Position:  [0.2066371]


portfolio before change:  [0.15972979]
curr_Stock_Price:  99.12618137702985
curr_Factors:  [99.12618138 -0.81335754 -1.00360813]
mat_Sqrt:  [[16.10980249  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00170282  0.00526117  0.29293737]
Stock Position:  -0.0017028226031306332
Bond Position:  [0.32852409]


portfolio before change:  [0.15965226]
curr_Stock_Price:  99.19582842778463
curr_Factors:  [99.19582843 -0.8195047  -1.00731163]
mat_Sqrt:  [[15.96309711  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00319671  0.03538753  0.03308625]
Stock Position:  -0.0031967149578894594
Bond Position:  [0.47675305]


portfolio before change:  [0.15959696]
curr_Stock_Price:  99.23177199520688
curr_Factors:  [99.231772   -0.76320009 -1.01652684]
mat_Sqrt:  [[16.73883241  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00284795  0.00719392 -0.19816661]
Stock Position:  0.0028479546594396736
Bond Position:  [-0.12301063]


portfolio before change:  [0.16288644]
curr_Stock_Price:  100.39220540641352
curr_Factors:  [100.39220541  -0.68710545  -1.0151063 ]
mat_Sqrt:  [[18.29948312  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00347576 0.00922712 0.09107454]
Stock Position:  0.0034757581812968064
Bond Position:  [-0.18605259]


portfolio before change:  [0.17156027]
curr_Stock_Price:  102.89441880718383
curr_Factors:  [102.89441881  -0.65052534  -1.00442767]
mat_Sqrt:  [[19.66322978  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00372534  0.01345384 -0.39128563]
Stock Position:  -0.0037253350190491414
Bond Position:  [0.55487645]


portfolio before change:  [0.17384447]
curr_Stock_Price:  102.29988609449063
curr_Factors:  [102.29988609  -0.55682684  -0.99442418]
mat_Sqrt:  [[21.68579721  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00967289 0.07057286 0.42683889]
Stock Position:  0.00967288688629197
Bond Position:  [-0.81569076]


portfolio before change:  [0.18822491]
curr_Stock_Price:  103.79710341057624
curr_Factors:  [103.79710341  -0.24129986  -1.0094432 ]
mat_Sqrt:  [[29.7162788   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00280977 0.01782523 0.19595279]
Stock Position:  0.00280977164038871
Bond Position:  [-0.10342124]


portfolio before change:  [0.18879972]
curr_Stock_Price:  104.00627996447099
curr_Factors:  [104.00627996  -0.38547588  -1.00244731]
mat_Sqrt:  [[25.95925231  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00185776  0.02179201  0.03462437]
Stock Position:  -0.0018577613291226253
Bond Position:  [0.38201857]


portfolio before change:  [0.18987448]
curr_Stock_Price:  103.45346479756681
curr_Factors:  [103.4534648   -0.36742279  -1.00011341]
mat_Sqrt:  [[26.35309427  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00031214 -0.04745124 -0.05397931]
Stock Position:  0.00031214440120078704
Bond Position:  [0.15758206]


portfolio before change:  [0.18994914]
curr_Stock_Price:  103.62955147192922
curr_Factors:  [103.62955147  -0.50125905  -0.99477698]
mat_Sqrt:  [[23.21471891  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00395419  0.03635522  0.11402343]
Stock Position:  -0.003954187651330879
Bond Position:  [0.59971983]


portfolio before change:  [0.19062331]
curr_Stock_Price:  103.4780151637269
curr_Factors:  [103.47801516  -0.478797    -0.9961101 ]
mat_Sqrt:  [[23.67576792  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00066496 -0.04829346 -0.08830545]
Stock Position:  -0.0006649644248745039
Bond Position:  [0.25943251]


portfolio before change:  [0.19090015]
curr_Stock_Price:  103.11047677363273
curr_Factors:  [103.11047677  -0.31770779  -0.99152926]
mat_Sqrt:  [[27.8425089   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01216104 0.06864804 0.86946453]
Stock Position:  0.012161038685744007
Bond Position:  [-1.06303035]


portfolio before change:  [0.1916098]
curr_Stock_Price:  103.17975897819461
curr_Factors:  [103.17975898  -0.21331856  -0.98185765]
mat_Sqrt:  [[31.22741808  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 2.61321237e-04 -4.31603361e-02 -6.34031659e-01]
Stock Position:  0.00026132123711476734
Bond Position:  [0.16464674]


portfolio before change:  [0.19167843]
curr_Stock_Price:  103.36360809605709
curr_Factors:  [103.3636081   -0.41439725  -0.975122  ]
mat_Sqrt:  [[25.75770219  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0036721  -0.03019854 -0.36259357]
Stock Position:  -0.003672095070132296
Bond Position:  [0.57123942]


portfolio before change:  [0.1939002]
curr_Stock_Price:  102.77801299093578
curr_Factors:  [102.77801299  -0.41349408  -0.95470359]
mat_Sqrt:  [[26.16372155  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00354275 -0.00591435 -0.17328268]
Stock Position:  -0.0035427450037354047
Bond Position:  [0.55801649]


portfolio before change:  [0.19841624]
curr_Stock_Price:  101.52297322036455
curr_Factors:  [101.52297322  -0.19469458  -0.96837279]
mat_Sqrt:  [[31.72857638  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00274987 -0.05504127  0.09954685]
Stock Position:  -0.0027498657354312864
Bond Position:  [0.47759079]


portfolio before change:  [0.19768445]
curr_Stock_Price:  101.8108034695181
curr_Factors:  [101.81080347  -0.12800126  -0.98538354]
mat_Sqrt:  [[33.43928524  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00030577  0.01582916 -0.03798243]
Stock Position:  0.0003057666189127925
Bond Position:  [0.1665541]


portfolio before change:  [0.19722602]
curr_Stock_Price:  100.2434256509445
curr_Factors:  [100.24342565  -0.25883439  -0.96958414]
mat_Sqrt:  [[29.34678372  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0059928  -0.01285818 -0.01615544]
Stock Position:  0.005992803418916946
Bond Position:  [-0.40351313]


portfolio before change:  [0.19148506]
curr_Stock_Price:  99.29386700068743
curr_Factors:  [ 9.92938670e+01 -4.28626307e-02 -9.34387879e-01]
mat_Sqrt:  [[37.36869409  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00181625 -0.0001262  -0.0552962 ]
Stock Position:  -0.0018162529933510101
Bond Position:  [0.37182784]


portfolio before change:  [0.18836691]
curr_Stock_Price:  101.03625839134182
curr_Factors:  [101.03625839   0.10450342  -0.90439815]
mat_Sqrt:  [[45.40329677  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-1.19575684e-05 -1.65251862e-03 -1.27228612e-03]
Stock Position:  -1.1957568366383049e-05
Bond Position:  [0.18957506]


portfolio before change:  [0.18836658]
curr_Stock_Price:  103.04617503105067
curr_Factors:  [103.04617503   0.12588391  -0.89478526]
mat_Sqrt:  [[47.76417294  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-9.82987577e-04  1.18662623e-01  1.40667083e+00]
Stock Position:  -0.000982987577234757
Bond Position:  [0.28965969]


portfolio before change:  [0.18518654]
curr_Stock_Price:  106.31808253423753
curr_Factors:  [ 1.06318083e+02  5.15871262e-02 -9.08428385e-01]
mat_Sqrt:  [[45.13211693  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00772554 -0.01279399  0.22888797]
Stock Position:  0.007725543237804296
Bond Position:  [-0.6361784]


portfolio before change:  [0.20023628]
curr_Stock_Price:  108.27642555777417
curr_Factors:  [ 1.08276426e+02  8.50276441e-02 -9.17884902e-01]
mat_Sqrt:  [[47.07914846  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00783267 -0.04173829 -0.8963771 ]
Stock Position:  -0.007832674745748043
Bond Position:  [1.0483303]


portfolio before change:  [0.15121819]
curr_Stock_Price:  114.55131164612133
curr_Factors:  [114.55131165  -0.17630907  -0.95813528]
mat_Sqrt:  [[36.83978993  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00258327 -0.04827266  0.2213803 ]
Stock Position:  0.0025832672084759568
Bond Position:  [-0.14469846]


portfolio before change:  [0.15555256]
curr_Stock_Price:  116.23617718045304
curr_Factors:  [116.23617718  -0.27097826  -0.94578688]
mat_Sqrt:  [[34.4276147   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01426037 0.14657151 0.46577346]
Stock Position:  0.014260371193476494
Bond Position:  [-1.50201847]


portfolio before change:  [0.17888021]
curr_Stock_Price:  117.88518151092849
curr_Factors:  [117.88518151  -0.76624343  -0.97848437]
mat_Sqrt:  [[20.59366089  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00227373  0.01963604  0.03922199]
Stock Position:  -0.0022737269689494938
Bond Position:  [0.44691892]


portfolio before change:  [0.18079308]
curr_Stock_Price:  117.06845887429901
curr_Factors:  [117.06845887  -0.66050607  -0.96003244]
mat_Sqrt:  [[23.15522289  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00121143  0.16840325  0.6818513 ]
Stock Position:  -0.0012114320465025923
Bond Position:  [0.32261356]


portfolio before change:  [0.18215537]
curr_Stock_Price:  115.97722321980164
curr_Factors:  [115.97722322  -0.78940522  -0.95222209]
mat_Sqrt:  [[20.32326935  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0113801  -0.12705935  0.49781975]
Stock Position:  -0.011380098313628276
Bond Position:  [1.50198757]


portfolio before change:  [0.18640043]
curr_Stock_Price:  115.6206974264465
curr_Factors:  [115.62069743  -0.79155813  -0.92650356]
mat_Sqrt:  [[20.74392212  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01350747  0.37827473 -0.2268049 ]
Stock Position:  -0.013507469369910862
Bond Position:  [1.74814346]


portfolio before change:  [0.18984984]
curr_Stock_Price:  115.38150539521334
curr_Factors:  [115.3815054   -1.08381412  -0.93263926]
mat_Sqrt:  [[15.36036815  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01350653 0.15881327 1.65364337]
Stock Position:  0.013506525623397476
Bond Position:  [-1.36855342]


portfolio before change:  [0.19419672]
curr_Stock_Price:  115.71600758543578
curr_Factors:  [115.71600759  -1.04821269  -0.95785656]
mat_Sqrt:  [[15.5656992   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00310809  0.00717938  0.23906138]
Stock Position:  -0.003108091460603355
Bond Position:  [0.55385265]


portfolio before change:  [0.19183477]
curr_Stock_Price:  116.49821775773056
curr_Factors:  [116.49821776  -1.08413863  -0.95365514]
mat_Sqrt:  [[15.18157014  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.06152502  0.04936503  0.02821189]
Stock Position:  -0.061525024435287096
Bond Position:  [7.35939047]


portfolio before change:  [0.16723217]
curr_Stock_Price:  116.91305028954402
curr_Factors:  [116.91305029  -0.87675304  -0.935119  ]
mat_Sqrt:  [[19.09751946  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00317017  0.14702484 -0.03718727]
Stock Position:  -0.0031701682787909705
Bond Position:  [0.53786622]


portfolio before change:  [0.16834771]
curr_Stock_Price:  116.5823729281928
curr_Factors:  [116.58237293  -0.97360031  -0.93014171]
mat_Sqrt:  [[17.37193671  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0030013  -0.05218142 -0.39574898]
Stock Position:  0.003001302465803468
Bond Position:  [-0.18155125]


portfolio before change:  [0.17175694]
curr_Stock_Price:  117.725850327516
curr_Factors:  [117.72585033  -1.0082296   -0.93772485]
mat_Sqrt:  [[16.81723358  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02496291 -0.27644284  0.88631192]
Stock Position:  -0.02496291384277642
Bond Position:  [3.1105372]


portfolio before change:  [0.16497256]
curr_Stock_Price:  118.0132053295734
curr_Factors:  [118.01320533  -0.94760251  -0.94474474]
mat_Sqrt:  [[17.78666961  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0025632  -0.06471125  1.42253881]
Stock Position:  -0.002563201823714928
Bond Position:  [0.46746423]


portfolio before change:  [0.16698983]
curr_Stock_Price:  117.24899491204118
curr_Factors:  [117.24899491  -0.89520761  -0.96907388]
mat_Sqrt:  [[18.17447868  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00084244 -0.00530952 -0.16512186]
Stock Position:  0.0008424429341607982
Bond Position:  [0.06821424]


portfolio before change:  [0.1668867]
curr_Stock_Price:  117.11646342688718
curr_Factors:  [117.11646343  -0.89525495  -0.94261431]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [0.1668867]
Stock Price:  117.96852780879003
PL:  [-17.80164111]
Settle:  Tensor("sub_246:0", shape=(), dtype=float64)
PL:  Tensor("sub_247:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  124
output_Z_Vals[:, i, :]:  [[ 1.19260232e+02 -2.92559343e+01 -2.92733494e+01]
 [ 5.53932668e-02 -5.71980167e-02 -1.26501784e-01]
 [-5.32103543e-02  8.42143043e-03  1.00140365e-01]
 [-5.41115423e-02  8.35852456e-02  1.22231814e-02]
 [-3.98707708e-02  6.13826976e-02 -7.07381773e-02]
 [ 4.69624140e-02  2.89362434e-02  4.54062141e-02]
 [-6.77506143e-03  2.23577410e-02  6.25600187e-02]
 [-3.18005059e-02 -1.54587486e-02 -4.77485446e-02]
 [ 9.83740980e-02 -3.02585501e-02 -1.17579757e-01]
 [-1.39563895e-01 -1.64371587e-01 -1.10821315e-01]
 [ 1.11354635e-01  8.10825568e-02 -8.77075546e-03]
 [-2.16288823e-01 -1.03820391e-01  5.24397124e-02]
 [-1.12277514e-01  2.94866899e-02 -1.79646458e-02]
 [-9.62623594e-02 -1.14884369e-01  6.32126881e-02]
 [ 3.68895019e-01  4.24188018e-01  1.06330600e-02]
 [-4.29529387e-02 -4.58654597e-01 -4.30027160e-02]
 [-6.74346077e-02 -5.89050901e-02 -4.05356234e-02]
 [-7.52311097e-02  1.97375883e-01  1.32486184e-01]
 [ 1.12088204e-01  5.38924380e-02  1.05464382e-01]
 [-9.66569016e-03 -9.08391409e-03  8.23582815e-02]
 [-2.16292866e-02 -3.12680329e-02  9.19987285e-04]
 [ 1.14826848e-01 -6.16978017e-02  1.37937396e-01]
 [-4.78557175e-02 -1.21085697e-03  2.43378970e-01]
 [-6.30722690e-02 -6.97206683e-04 -8.36179890e-02]
 [-1.99140126e-01  8.30112941e-02  8.87303443e-02]
 [-3.82701682e-02 -1.48769065e-01  1.00591426e-01]
 [ 2.32695749e-01  3.90760158e-02 -1.32465878e-01]
 [-3.90566335e-02  6.44364688e-02  2.59100377e-02]
 [-9.04722098e-02 -8.69477560e-02 -1.84239235e-01]
 [ 1.85387391e-02  1.27919598e-03 -1.21795765e-01]
 [ 4.90899429e-02  5.41321551e-02  1.58497180e-02]
 [ 3.98018233e-02 -8.87505070e-02 -8.19069496e-02]
 [ 3.00512882e-01 -2.95748908e-01 -2.34360516e-01]
 [-4.81956028e-02 -8.36893378e-02 -2.53089642e-03]
 [-1.59659633e-01  3.27967610e-02  2.36829465e-02]
 [ 1.45410465e-02 -1.25509573e-01 -8.73347974e-02]
 [-2.14549676e-02 -1.40450102e-01 -5.42149139e-02]
 [-2.08720791e-02  1.58004213e-02 -8.04568915e-02]
 [-2.09803149e-02 -2.25880952e-02  1.71637972e-02]
 [-8.12681217e-01  4.04658437e-01  4.97536010e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.26023247 -29.25593426 -29.27334937]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  8.31486419  -9.25153874 -83.50871763]
init_Out:  [2.49911038]
Stock Position:  8.31486419409362
Bond position:  [-828.98730903]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-6.3010001]
curr_Stock_Price:  98.95410431402551
curr_Factors:  [98.95410431 -0.85634826 -0.99548582]
mat_Sqrt:  [[15.53075229  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00180895 -0.0180876  -0.36087438]
Stock Position:  0.0018089498292250853
Bond Position:  [-6.48000311]


portfolio before change:  [-6.30173518]
curr_Stock_Price:  98.9955486432002
curr_Factors:  [98.99554864 -0.8964569  -1.01387045]
mat_Sqrt:  [[14.65450122  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00222129  0.00266309  0.28567259]
Stock Position:  -0.002221286618057664
Bond Position:  [-6.08183769]


portfolio before change:  [-6.29989729]
curr_Stock_Price:  97.82587902998873
curr_Factors:  [97.82587903 -0.98072545 -1.03005892]
mat_Sqrt:  [[13.09728275  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00377623  0.02643198  0.03486933]
Stock Position:  -0.0037762286295835415
Bond Position:  [-5.9304844]


portfolio before change:  [-6.29983178]
curr_Stock_Price:  97.6122103499708
curr_Factors:  [97.61221035 -0.71981652 -1.02619709]
mat_Sqrt:  [[17.03021263  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00309598  0.01941091 -0.20179633]
Stock Position:  -0.0030959828582792955
Bond Position:  [-5.99762605]


portfolio before change:  [-6.2999026]
curr_Stock_Price:  97.39291708897517
curr_Factors:  [97.39291709 -0.61229398 -1.01875609]
mat_Sqrt:  [[19.06212565  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00298907 0.00915044 0.12953129]
Stock Position:  0.0029890711199581014
Bond Position:  [-6.59101696]


portfolio before change:  [-6.30293514]
curr_Stock_Price:  96.65402110253166
curr_Factors:  [96.6540211  -0.58713363 -1.01676933]
mat_Sqrt:  [[19.43809595  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00033811 0.00707014 0.17846632]
Stock Position:  0.00033811044669956864
Bond Position:  [-6.33561488]


portfolio before change:  [-6.30356717]
curr_Stock_Price:  97.12718044213487
curr_Factors:  [97.12718044 -0.72939731 -1.05126995]
mat_Sqrt:  [[16.36842223  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00256263 -0.00488849 -0.13621331]
Stock Position:  -0.0025626342802447595
Bond Position:  [-6.05466572]


portfolio before change:  [-6.30404007]
curr_Stock_Price:  97.0163652553447
curr_Factors:  [97.01636526 -0.78107387 -1.06272633]
mat_Sqrt:  [[15.34944752  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00479444 -0.00956859 -0.33542232]
Stock Position:  0.004794436939327148
Bond Position:  [-6.76917891]


portfolio before change:  [-6.30560405]
curr_Stock_Price:  96.86665298470832
curr_Factors:  [96.86665298 -1.13741508 -1.10505952]
mat_Sqrt:  [[10.28679178  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01617893 -0.05197886 -0.31614236]
Stock Position:  -0.016178927441023602
Bond Position:  [-4.7384055]


portfolio before change:  [-6.30414532]
curr_Stock_Price:  96.73987844185893
curr_Factors:  [96.73987844 -1.50018241 -1.08773677]
mat_Sqrt:  [[ 7.27254664  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01535334  0.02564056 -0.02502052]
Stock Position:  0.0153533363439466
Bond Position:  [-7.78942521]


portfolio before change:  [-6.30035574]
curr_Stock_Price:  97.0501244048393
curr_Factors:  [97.0501244  -1.55664161 -1.08044989]
mat_Sqrt:  [[ 6.94579257  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02998437 -0.03283089  0.1495959 ]
Stock Position:  -0.029984374055873782
Bond Position:  [-3.39036851]


portfolio before change:  [-6.3169039]
curr_Stock_Price:  97.5878822553163
curr_Factors:  [97.58788226 -1.5217072  -1.08565085]
mat_Sqrt:  [[ 7.19506433  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01600864  0.00932451 -0.05124813]
Stock Position:  -0.016008639138556158
Bond Position:  [-4.75465471]


portfolio before change:  [-6.30614183]
curr_Stock_Price:  96.87848815897568
curr_Factors:  [96.87848816 -1.25972247 -1.04480592]
mat_Sqrt:  [[ 9.66904066  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00892802 -0.03632963  0.1803282 ]
Stock Position:  -0.008928023801583633
Bond Position:  [-5.44120839]


portfolio before change:  [-6.31365039]
curr_Stock_Price:  97.64331193418153
curr_Factors:  [97.64331193 -1.04310237 -1.04408818]
mat_Sqrt:  [[12.11119968  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.03154254 0.13414003 0.03033316]
Stock Position:  0.03154253754467915
Bond Position:  [-9.39356822]


portfolio before change:  [-6.32711981]
curr_Stock_Price:  97.2535161117687
curr_Factors:  [97.25351611 -0.89459253 -1.06269683]
mat_Sqrt:  [[13.73616008  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00462817 -0.14503932 -0.12267478]
Stock Position:  -0.0046281669495194765
Bond Position:  [-5.8770143]


portfolio before change:  [-6.33264444]
curr_Stock_Price:  98.28847355612132
curr_Factors:  [98.28847356 -0.85711471 -1.09600325]
mat_Sqrt:  [[13.94036791  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00554001 -0.01862743 -0.11563685]
Stock Position:  -0.005540013764086042
Bond Position:  [-5.78812494]


portfolio before change:  [-6.3331037]
curr_Stock_Price:  98.24076562056831
curr_Factors:  [98.24076562 -1.00747554 -1.10607844]
mat_Sqrt:  [[11.86825609  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0036308   0.06241573  0.37794621]
Stock Position:  -0.0036307994073083616
Bond Position:  [-5.97641118]


portfolio before change:  [-6.33522885]
curr_Stock_Price:  98.6203116603037
curr_Factors:  [98.62031166 -0.72519377 -1.1024123 ]
mat_Sqrt:  [[15.85795344  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00851355 0.01704229 0.30086053]
Stock Position:  0.008513553059676533
Bond Position:  [-7.17483811]


portfolio before change:  [-6.33908352]
curr_Stock_Price:  98.27289395410756
curr_Factors:  [98.27289395 -0.6343899  -1.11518776]
mat_Sqrt:  [[17.08448226  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00040452 -0.00287259  0.23494525]
Stock Position:  0.00040452370091696965
Bond Position:  [-6.37883724]


portfolio before change:  [-6.33972712]
curr_Stock_Price:  98.65309681078722
curr_Factors:  [98.65309681 -0.58636818 -1.11474189]
mat_Sqrt:  [[18.00230049  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00123589 -0.00988782  0.00262447]
Stock Position:  -0.0012358882745837588
Bond Position:  [-6.21780292]


portfolio before change:  [-6.34085729]
curr_Stock_Price:  98.93863206299703
curr_Factors:  [98.93863206 -0.7803111  -1.12480823]
mat_Sqrt:  [[14.72255175  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00960365 -0.01951056  0.393497  ]
Stock Position:  0.009603645705938498
Bond Position:  [-7.29102886]


portfolio before change:  [-6.33293608]
curr_Stock_Price:  99.85834993448468
curr_Factors:  [99.85834993 -0.77896644 -1.12288595]
mat_Sqrt:  [[14.90803445  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 1.20240026e-04 -3.82906596e-04  6.94292457e-01]
Stock Position:  0.0001202400260702799
Bond Position:  [-6.34494305]


portfolio before change:  [-6.33378109]
curr_Stock_Price:  99.42721419470155
curr_Factors:  [99.42721419 -0.70213187 -1.08078122]
mat_Sqrt:  [[16.71844789  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-4.79462698e-03 -2.20476112e-04 -2.38538848e-01]
Stock Position:  -0.004794626979942082
Bond Position:  [-5.85706468]


portfolio before change:  [-6.3319687]
curr_Stock_Price:  98.89650234152305
curr_Factors:  [98.89650234 -0.56804463 -1.098897  ]
mat_Sqrt:  [[18.67400108  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00957935  0.02625048  0.25312297]
Stock Position:  -0.009579349211760187
Bond Position:  [-5.38460457]


portfolio before change:  [-6.32758494]
curr_Stock_Price:  98.36860902070647
curr_Factors:  [98.36860902 -0.75271117 -1.090127  ]
mat_Sqrt:  [[15.57837241  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00138514 -0.04704491  0.28695934]
Stock Position:  -0.001385140211031495
Bond Position:  [-6.19133063]


portfolio before change:  [-6.32825713]
curr_Stock_Price:  98.29512745918176
curr_Factors:  [98.29512746 -0.6105629  -1.08704115]
mat_Sqrt:  [[17.99997578  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01148142  0.01235692 -0.37788828]
Stock Position:  0.011481415641696092
Bond Position:  [-7.45682434]


portfolio before change:  [-6.32906228]
curr_Stock_Price:  98.30618914584177
curr_Factors:  [98.30618915 -0.9193456  -1.05430082]
mat_Sqrt:  [[13.65957267  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0023503   0.0203766   0.07391413]
Stock Position:  -0.002350295103974954
Bond Position:  [-6.09801373]


portfolio before change:  [-6.32808236]
curr_Stock_Price:  97.56491089265506
curr_Factors:  [97.56491089 -0.8235256  -1.03259718]
mat_Sqrt:  [[15.24718845  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00854747 -0.02749529 -0.52558325]
Stock Position:  -0.008547468798634996
Bond Position:  [-5.49414933]


portfolio before change:  [-6.33700847]
curr_Stock_Price:  98.52885704377809
curr_Factors:  [98.52885704 -0.83019472 -1.02301119]
mat_Sqrt:  [[15.44281062  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00040729  0.00040452 -0.34744942]
Stock Position:  -0.00040728911179585195
Bond Position:  [-6.29687874]


portfolio before change:  [-6.33767329]
curr_Stock_Price:  98.22848931392987
curr_Factors:  [98.22848931 -0.8300149  -1.00895501]
mat_Sqrt:  [[15.61647401  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00344015 0.01711809 0.04521483]
Stock Position:  0.0034401452765908157
Bond Position:  [-6.67559357]


portfolio before change:  [-6.33982854]
curr_Stock_Price:  97.84456798825616
curr_Factors:  [97.84456799 -0.70076525 -0.97565847]
mat_Sqrt:  [[18.30101391  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00113606 -0.02806537 -0.23365773]
Stock Position:  0.0011360632327686098
Bond Position:  [-6.45098616]


portfolio before change:  [-6.34060001]
curr_Stock_Price:  97.8753383863878
curr_Factors:  [97.87533839 -1.05210464 -0.98112586]
mat_Sqrt:  [[12.81304906  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0191241  -0.09352402 -0.66856532]
Stock Position:  0.01912410048661816
Bond Position:  [-8.21237781]


portfolio before change:  [-6.34056104]
curr_Stock_Price:  97.93105753343083
curr_Factors:  [97.93105753 -1.22468525 -0.99498869]
mat_Sqrt:  [[10.63967343  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00478145 -0.02646489 -0.00721994]
Stock Position:  -0.004781450258873752
Bond Position:  [-5.87230856]


portfolio before change:  [-6.34160716]
curr_Stock_Price:  97.99631803263429
curr_Factors:  [97.99631803 -1.22904279 -0.98039983]
mat_Sqrt:  [[10.75625325  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01431526  0.01037125  0.06756085]
Stock Position:  -0.014315260117915722
Bond Position:  [-4.93876438]


portfolio before change:  [-6.33413707]
curr_Stock_Price:  97.43136290060663
curr_Factors:  [97.4313629  -1.27063492 -0.9819448 ]
mat_Sqrt:  [[10.24273259  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00063721 -0.03968961 -0.24914187]
Stock Position:  -0.0006372066741885631
Bond Position:  [-6.27205315]


portfolio before change:  [-6.3348667]
curr_Stock_Price:  97.3459499689775
curr_Factors:  [97.34594997 -1.28337251 -0.98761034]
mat_Sqrt:  [[10.0471427   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00359783 -0.04441422 -0.15466006]
Stock Position:  -0.0035978334982098184
Bond Position:  [-5.98463218]


portfolio before change:  [-6.33706918]
curr_Stock_Price:  97.75017984506084
curr_Factors:  [97.75017985 -1.21482871 -0.96919635]
mat_Sqrt:  [[11.00544314  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00335173  0.00499653 -0.22952112]
Stock Position:  -0.0033517331079256684
Bond Position:  [-6.00943666]


portfolio before change:  [-6.33829513]
curr_Stock_Price:  97.89181626993431
curr_Factors:  [97.89181627 -1.30229492 -0.98584751]
mat_Sqrt:  [[ 9.93158942  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00181844 -0.00714298  0.04896354]
Stock Position:  -0.0018184392011998906
Bond Position:  [-6.16028481]


portfolio before change:  [-6.33964542]
curr_Stock_Price:  98.2108830130417
curr_Factors:  [98.21088301 -1.4874139  -0.97925169]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-6.33964542]
Stock Price:  97.43561022938286
PL:  [-6.33964542]
Settle:  Tensor("sub_248:0", shape=(), dtype=float64)
PL:  Tensor("sub_249:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  125
output_Z_Vals[:, i, :]:  [[ 1.19260232e+02 -2.92559343e+01 -2.92733494e+01]
 [ 5.63324987e-03 -1.10931250e-01 -3.78985907e-02]
 [ 9.08808587e-03  8.74559854e-03 -1.53981137e-02]
 [ 8.12833048e-02  1.36814657e-01  3.75090136e-02]
 [ 2.29755176e-01 -1.88257096e-02 -3.68034962e-02]
 [ 7.28506028e-03  2.99650250e-02  9.71645877e-02]
 [ 2.84197036e-02  5.25184530e-02 -2.49096925e-02]
 [ 7.01753523e-02  2.61512512e-01  1.08163975e-01]
 [ 2.98545250e-02  4.31902422e-02 -9.79710047e-03]
 [-3.08664122e-02  3.18766046e-01  1.25892200e-01]
 [ 3.39746605e-02 -7.06901476e-02 -4.48786707e-02]
 [-7.19896306e-02  9.83446153e-02  2.08806627e-02]
 [-6.98406438e-02 -5.79490612e-02 -6.52154780e-02]
 [ 3.23405486e-01  2.47718838e-01  3.34290542e-01]
 [ 1.82105494e-01  2.24455223e-01  2.60156737e-02]
 [-7.00095002e-02 -8.29582941e-02 -1.16768315e-01]
 [-8.08092972e-02 -1.49807020e-02 -8.54277044e-02]
 [ 5.45088786e-02 -1.55987963e-01 -9.88577109e-02]
 [ 3.37661348e-02  5.90385405e-02  2.98092435e-02]
 [ 3.10786134e-01 -1.92090685e-01 -6.76026985e-02]
 [ 1.31392493e-01 -5.61230723e-05  2.04535836e-01]
 [ 1.34172211e-03 -6.37124842e-03  1.16971203e-03]
 [-9.12782699e-02  1.95400423e-01  9.59620241e-02]
 [ 1.59530608e-01 -6.37759360e-02  5.00757419e-02]
 [-1.52408388e-03  1.30189894e-02  2.10614661e-02]
 [ 1.03460633e-01  1.25663936e-04  5.63358808e-02]
 [-1.28654530e-01  7.47429321e-02  8.62802886e-02]
 [-4.02161731e-02  6.53450069e-02  2.62521139e-02]
 [ 6.20848838e-02 -6.23725319e-02  9.08311027e-02]
 [ 4.10624905e-02 -2.62998726e-02  6.36673131e-02]
 [-3.82237241e-02  3.48523059e-01  7.32700726e-03]
 [ 4.19194256e-02 -6.34648539e-02  1.67216371e-02]
 [ 8.10360949e-02 -5.70763721e-02  3.70234505e-02]
 [-1.28698710e-01 -4.14838328e-02  3.11749214e-02]
 [-1.14715512e-01  1.69489860e-02  3.65864806e-02]
 [ 8.47165236e-02 -1.65012150e-01 -1.38726811e-01]
 [-2.42196487e-01 -4.22648916e-01  9.50613562e-02]
 [-4.76226083e-02 -3.43120126e-02  4.57524728e-02]
 [-3.40933493e-02  7.32332388e-02 -2.70805358e-02]
 [ 1.38836056e-01 -7.51404227e-03 -1.32024485e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.26023247 -29.25593426 -29.27334937]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  8.31486419  -9.25153874 -83.50871763]
init_Out:  [2.49911038]
Stock Position:  8.31486419409362
Bond position:  [-828.98730903]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [1.82554458]
curr_Stock_Price:  99.93145577681697
curr_Factors:  [99.93145578 -0.8214983  -1.00714688]
mat_Sqrt:  [[16.05209445  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00030943 -0.03507954 -0.10811413]
Stock Position:  -0.00030943003292497733
Bond Position:  [1.85646638]


portfolio before change:  [1.82552176]
curr_Stock_Price:  100.75522083682868
curr_Factors:  [100.75522084  -0.98730499  -1.05448131]
mat_Sqrt:  [[13.07768988  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00047185  0.0027656  -0.04392653]
Stock Position:  0.00047185470144910124
Bond Position:  [1.77797993]


portfolio before change:  [1.82588755]
curr_Stock_Price:  101.0593970599733
curr_Factors:  [101.05939706  -0.81597218  -1.07907224]
mat_Sqrt:  [[15.19040552  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00608755 0.04326459 0.10700278]
Stock Position:  0.006087549094401044
Bond Position:  [1.21068351]


portfolio before change:  [1.83113835]
curr_Stock_Price:  101.89708357577942
curr_Factors:  [101.89708358  -0.84477234  -1.0922983 ]
mat_Sqrt:  [[14.68597102  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01509989 -0.00595321 -0.10499013]
Stock Position:  0.015099894725566021
Bond Position:  [0.29250311]


portfolio before change:  [1.82965761]
curr_Stock_Price:  101.79659931216345
curr_Factors:  [101.79659931  -0.85297316  -1.10325654]
mat_Sqrt:  [[14.39307222  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.0019379  0.00947577 0.27718352]
Stock Position:  0.0019379040044483849
Bond Position:  [1.63238558]


portfolio before change:  [1.82887655]
curr_Stock_Price:  101.28825517080725
curr_Factors:  [101.28825517  -0.7569488   -1.09388509]
mat_Sqrt:  [[15.91300299  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00155163  0.01660779 -0.07106042]
Stock Position:  0.0015516275944147514
Bond Position:  [1.6717149]


portfolio before change:  [1.82975969]
curr_Stock_Price:  101.7227408356291
curr_Factors:  [101.72274084  -0.64093977  -1.09040947]
mat_Sqrt:  [[18.00954049  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00549744 0.08269752 0.30856171]
Stock Position:  0.005497444827848379
Bond Position:  [1.27054453]


portfolio before change:  [1.83403188]
curr_Stock_Price:  102.47097193492557
curr_Factors:  [102.47097193  -0.70725244  -1.08314755]
mat_Sqrt:  [[17.10172889  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00169397  0.01365795 -0.0279484 ]
Stock Position:  0.001693973027135607
Bond Position:  [1.66044881]


portfolio before change:  [1.8338579]
curr_Stock_Price:  102.24573710432824
curr_Factors:  [102.2457371   -0.63385685  -1.05760916]
mat_Sqrt:  [[18.83869672  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [1.62523418e-04 1.00802675e-01 3.59135404e-01]
Stock Position:  0.00016252341766166592
Bond Position:  [1.81724058]


portfolio before change:  [1.83418575]
curr_Stock_Price:  102.86520684215928
curr_Factors:  [102.86520684  -0.76809284  -1.06518649]
mat_Sqrt:  [[16.44695124  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00139774 -0.02235419 -0.12802636]
Stock Position:  0.0013977440617180307
Bond Position:  [1.69040652]


portfolio before change:  [1.83390724]
curr_Stock_Price:  102.51476950620774
curr_Factors:  [102.51476951  -0.91579316  -1.06753949]
mat_Sqrt:  [[14.10704376  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00462096  0.0310993   0.05956672]
Stock Position:  -0.004620963629621874
Bond Position:  [2.30762426]


portfolio before change:  [1.83321545]
curr_Stock_Price:  102.7269035003098
curr_Factors:  [102.7269035   -1.09421311  -1.05762148]
mat_Sqrt:  [[11.94412414  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00708708 -0.0183251  -0.18604161]
Stock Position:  -0.007087077701034766
Bond Position:  [2.561249]


portfolio before change:  [1.82863033]
curr_Stock_Price:  103.41905055379088
curr_Factors:  [103.41905055  -1.1211312   -1.06344103]
mat_Sqrt:  [[11.63731742  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.03420362 0.07833557 0.95363787]
Stock Position:  0.03420361547187606
Bond Position:  [-1.70867511]


portfolio before change:  [1.8005451]
curr_Stock_Price:  102.60417687254952
curr_Factors:  [102.60417687  -1.09307708  -1.06818612]
mat_Sqrt:  [[11.81790132  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01634904 0.07097897 0.07421548]
Stock Position:  0.01634903905807831
Bond Position:  [0.12306541]


portfolio before change:  [1.79450011]
curr_Stock_Price:  102.23348970505407
curr_Factors:  [102.23348971  -1.04322422  -1.07030897]
mat_Sqrt:  [[12.35086519  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00777166 -0.02623372 -0.3331075 ]
Stock Position:  -0.007771658510961502
Bond Position:  [2.58902388]


portfolio before change:  [1.79263733]
curr_Stock_Price:  102.51482316514037
curr_Factors:  [102.51482317  -1.05565764  -1.07656362]
mat_Sqrt:  [[12.15555354  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00811431 -0.00473731 -0.24370146]
Stock Position:  -0.00811431203845394
Bond Position:  [2.62447459]


portfolio before change:  [1.78447657]
curr_Stock_Price:  103.5609793858574
curr_Factors:  [103.56097939  -1.02083017  -1.07488511]
mat_Sqrt:  [[12.7361619   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00237921 -0.04932772 -0.28201353]
Stock Position:  0.0023792129202257883
Bond Position:  [1.53808295]


portfolio before change:  [1.78688515]
curr_Stock_Price:  104.49250924889527
curr_Factors:  [104.49250925  -0.9619079   -1.05922572]
mat_Sqrt:  [[13.84579767  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00298829 0.01866963 0.08503747]
Stock Position:  0.0029882922372299913
Bond Position:  [1.474631]


portfolio before change:  [1.78588728]
curr_Stock_Price:  104.0968938697187
curr_Factors:  [104.09689387  -1.08432196  -1.0756964 ]
mat_Sqrt:  [[12.00476639  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.02432592 -0.06074441 -0.19285168]
Stock Position:  0.024325923695379593
Bond Position:  [-0.74636582]


portfolio before change:  [1.80364253]
curr_Stock_Price:  104.830619687374
curr_Factors:  [104.83061969  -1.26780549  -1.07265346]
mat_Sqrt:  [[10.09345255  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 1.71538674e-02 -1.77476738e-05  5.83483807e-01]
Stock Position:  0.017153867417106245
Bond Position:  [0.00539198]


portfolio before change:  [1.80640295]
curr_Stock_Price:  104.99150103921589
curr_Factors:  [104.99150104  -1.3807903   -1.10079474]
mat_Sqrt:  [[ 8.7784018   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0001613  -0.00201477  0.00333686]
Stock Position:  0.00016130312570364995
Bond Position:  [1.78946749]


portfolio before change:  [1.80661868]
curr_Stock_Price:  104.94215846066326
curr_Factors:  [104.94215846  -1.58268534  -1.08822324]
mat_Sqrt:  [[ 7.26087793  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00917863  0.06179104  0.27375294]
Stock Position:  -0.009178626486783937
Bond Position:  [2.76984356]


portfolio before change:  [1.8088969]
curr_Stock_Price:  104.73167311048768
curr_Factors:  [104.73167311  -1.37055097  -1.0701806 ]
mat_Sqrt:  [[ 9.12182611  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01842894 -0.02016772  0.14285215]
Stock Position:  0.018428940219356038
Bond Position:  [-0.12119684]


portfolio before change:  [1.8095479]
curr_Stock_Price:  104.76782003025951
curr_Factors:  [104.76782003  -1.15449303  -1.08605497]
mat_Sqrt:  [[11.14731504  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.0002791  0.00411697 0.0600825 ]
Stock Position:  0.00027910027899185263
Bond Position:  [1.78030717]


portfolio before change:  [1.80982378]
curr_Stock_Price:  104.95890351771949
curr_Factors:  [104.95890352  -1.35768118  -1.06395443]
mat_Sqrt:  [[ 9.31786265  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [1.23379573e-02 3.97384256e-05 1.60710587e-01]
Stock Position:  0.01233795727202146
Bond Position:  [0.51484532]


portfolio before change:  [1.8076807]
curr_Stock_Price:  104.77998872578232
curr_Factors:  [104.77998873  -1.23937463  -1.06460504]
mat_Sqrt:  [[10.46339668  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01042805  0.02363579  0.24613365]
Stock Position:  -0.010428046387364059
Bond Position:  [2.90033128]


portfolio before change:  [1.80195363]
curr_Stock_Price:  105.3639554005428
curr_Factors:  [105.3639554   -1.33430243  -1.07870897]
mat_Sqrt:  [[ 9.4348398   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00351572  0.02066391  0.07488997]
Stock Position:  -0.0035157228592221025
Bond Position:  [2.1723841]


portfolio before change:  [1.80172139]
curr_Stock_Price:  105.50725567936733
curr_Factors:  [105.50725568  -1.46284853  -1.07261084]
mat_Sqrt:  [[ 8.35884582  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00945289 -0.01972393  0.25911585]
Stock Position:  0.009452890369266661
Bond Position:  [0.80437287]


portfolio before change:  [1.79719268]
curr_Stock_Price:  105.01753542103965
curr_Factors:  [105.01753542  -1.52547292  -1.07858299]
mat_Sqrt:  [[ 7.768456    0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00687131 -0.00831675  0.18162512]
Stock Position:  0.006871309637691671
Bond Position:  [1.07558467]


portfolio before change:  [1.79972669]
curr_Stock_Price:  105.36674904535975
curr_Factors:  [105.36674905  -1.43271637  -1.08168429]
mat_Sqrt:  [[ 8.52537023  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00325256  0.11021267  0.02090191]
Stock Position:  -0.0032525600136595746
Bond Position:  [2.14243836]


portfolio before change:  [1.79760494]
curr_Stock_Price:  106.10142183534093
curr_Factors:  [106.10142184  -1.08184717  -1.0907431 ]
mat_Sqrt:  [[12.08306841  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00361614 -0.02006935  0.04770218]
Stock Position:  0.003616139419865272
Bond Position:  [1.41392741]


portfolio before change:  [1.79773053]
curr_Stock_Price:  106.08727457825519
curr_Factors:  [106.08727458  -1.13249615  -1.09376392]
mat_Sqrt:  [[11.45014084  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00760862 -0.01804913  0.1056176 ]
Stock Position:  0.007608619902637198
Bond Position:  [0.99055279]


portfolio before change:  [1.79633831]
curr_Stock_Price:  105.8880204236426
curr_Factors:  [105.88802042  -1.16272601  -1.08236159]
mat_Sqrt:  [[11.21547497  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01100321 -0.01311834  0.08893337]
Stock Position:  -0.011003213351840867
Bond Position:  [2.96144679]


portfolio before change:  [1.80431757]
curr_Stock_Price:  105.19649002160037
curr_Factors:  [105.19649002  -1.27156389  -1.07362443]
mat_Sqrt:  [[10.08089064  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01059526  0.00535974  0.10437105]
Stock Position:  -0.010595264872883235
Bond Position:  [2.91890225]


portfolio before change:  [1.8064342]
curr_Stock_Price:  105.03115783640112
curr_Factors:  [105.03115784  -1.4357839   -1.09222753]
mat_Sqrt:  [[ 8.38333341  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0062193  -0.05218142 -0.39574898]
Stock Position:  0.006219296539083953
Bond Position:  [1.15321428]


portfolio before change:  [1.808685]
curr_Stock_Price:  105.36988499780662
curr_Factors:  [105.369885    -1.52240895  -1.14450825]
mat_Sqrt:  [[ 7.31962926  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.03192852 -0.13365332  0.27118359]
Stock Position:  -0.031928518264346575
Bond Position:  [5.1729893]


portfolio before change:  [1.81549889]
curr_Stock_Price:  105.17672774602742
curr_Factors:  [105.17672775  -1.48072877  -1.11717372]
mat_Sqrt:  [[ 7.82825455  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00500359 -0.01085041  0.13051907]
Stock Position:  -0.00500358745448359
Bond Position:  [2.34175985]


portfolio before change:  [1.81413666]
curr_Stock_Price:  105.50748417262936
curr_Factors:  [105.50748417  -1.42817077  -1.11256708]
mat_Sqrt:  [[ 8.31485804  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00453769  0.02315838 -0.07725323]
Stock Position:  -0.004537692190732928
Bond Position:  [2.29289715]


portfolio before change:  [1.81455617]
curr_Stock_Price:  105.47820026706972
curr_Factors:  [105.47820027  -1.25680463  -1.11500773]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [1.81455617]
Stock Price:  105.29748120757687
PL:  [-3.48292504]
Settle:  Tensor("sub_250:0", shape=(), dtype=float64)
PL:  Tensor("sub_251:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  126
output_Z_Vals[:, i, :]:  [[ 1.19260232e+02 -2.92559343e+01 -2.92733494e+01]
 [ 4.79748866e-02  9.21502628e-03 -9.18742517e-02]
 [ 1.19017534e-02  1.16644792e-02 -1.46978220e-02]
 [ 8.21611729e-02  1.44797138e-01  3.76156589e-02]
 [ 5.81478870e-02  2.37766191e-02 -6.96166660e-02]
 [ 6.46800942e-02  2.94372463e-02 -5.70500503e-03]
 [ 3.10881985e-02  4.46044966e-02 -2.76882956e-02]
 [-1.02290480e-01 -3.85325228e-02 -1.11770023e-01]
 [ 9.12911987e-03 -5.23577852e-02  2.76216675e-02]
 [-3.07230428e-02 -3.72896744e-02 -9.25691378e-02]
 [ 5.62293684e-02  1.45665532e-01 -8.27012575e-02]
 [-1.64378162e-02  3.82108837e-02 -1.41971289e-02]
 [-8.46100479e-02 -1.87758368e-02 -5.89380480e-02]
 [-1.42496642e-02 -6.04263981e-03  1.25300482e-01]
 [ 2.11691378e-01  2.85545819e-01  5.71391295e-02]
 [-7.88733083e-02 -8.34665690e-02 -1.08179524e-01]
 [-7.54109380e-02 -4.25100440e-02 -6.41450497e-02]
 [-4.14746806e-02  1.56397757e-03  3.96639645e-02]
 [ 7.91509282e-02  7.36882597e-02  1.01387775e-01]
 [ 2.38950560e-01 -6.29161815e-02 -1.65413278e-02]
 [-4.46472656e-02  2.24229234e-04 -4.84362912e-02]
 [ 7.95921771e-02 -6.04132814e-02  7.73930884e-02]
 [-3.05298804e-02 -5.41278844e-02  1.45446849e-01]
 [-5.13763828e-02 -9.75524762e-04 -8.70258511e-02]
 [-2.05273085e-01  9.51581409e-02  5.24694646e-02]
 [-2.15487328e-03 -1.07979909e-01  8.89904678e-02]
 [ 8.68380415e-02  4.69791593e-02 -7.20192626e-02]
 [-4.31335388e-02  6.76308609e-02  2.71127672e-02]
 [-5.50648585e-02 -5.83519926e-02 -2.28757189e-01]
 [ 8.75263349e-03 -9.20067168e-03 -1.19173727e-01]
 [ 4.62710281e-02  9.15558656e-02  1.66145844e-02]
 [ 4.15220242e-02 -9.35760052e-02 -7.98345245e-02]
 [ 2.66212836e-01 -2.12538562e-01 -1.14303953e-01]
 [-4.68409474e-02 -8.23668413e-02  1.19575694e-03]
 [-1.93689324e-01  1.04077627e-01  1.93290120e-02]
 [ 1.62672456e-01 -7.99603331e-02 -4.80039168e-02]
 [ 2.76002857e-02  3.76020048e-02 -1.02913089e-01]
 [-4.17958695e-03  5.82373515e-02 -2.09763720e-02]
 [ 4.09424246e-01 -4.91887401e-01 -1.24191929e-01]
 [-2.56533613e-01  1.65812502e-01  1.20498273e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.26023247 -29.25593426 -29.27334937]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  8.31486419  -9.25153874 -83.50871763]
init_Out:  [2.49911038]
Stock Position:  8.31486419409362
Bond position:  [-828.98730903]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-1.70451194]
curr_Stock_Price:  99.50690807049747
curr_Factors:  [99.50690807 -1.12095026 -1.01678602]
mat_Sqrt:  [[11.73400217  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00251057  0.00291405 -0.26209167]
Stock Position:  0.0025105726058099907
Bond Position:  [-1.95433126]


portfolio before change:  [-1.70144155]
curr_Stock_Price:  100.8272044846619
curr_Factors:  [100.82720448  -1.21132944  -1.03939287]
mat_Sqrt:  [[10.6194359   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00086659  0.00368863 -0.04192879]
Stock Position:  0.000866594861699422
Bond Position:  [-1.78881788]


portfolio before change:  [-1.70200329]
curr_Stock_Price:  100.43702953634704
curr_Factors:  [100.43702954  -0.84984896  -1.06350845]
mat_Sqrt:  [[14.82290393  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00631307 0.04578888 0.107307  ]
Stock Position:  0.0063130735765553085
Bond Position:  [-2.33606964]


portfolio before change:  [-1.70988337]
curr_Stock_Price:  99.2350701907689
curr_Factors:  [99.23507019 -0.7837886  -1.06367586]
mat_Sqrt:  [[15.64305448  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.002848    0.00751883 -0.19859697]
Stock Position:  0.002847995850721703
Bond Position:  [-1.99250444]


portfolio before change:  [-1.71191509]
curr_Stock_Price:  98.60914169682611
curr_Factors:  [98.6091417  -0.50969773 -1.06952511]
mat_Sqrt:  [[20.32681882  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00316211  0.00930887 -0.01627479]
Stock Position:  0.003162109719642236
Bond Position:  [-2.02372802]


portfolio before change:  [-1.71034134]
curr_Stock_Price:  99.1868370627539
curr_Factors:  [99.18683706 -0.52561694 -1.07273885]
mat_Sqrt:  [[20.05843034  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00132553  0.01410518 -0.078987  ]
Stock Position:  0.0013255290441434855
Bond Position:  [-1.84181637]


portfolio before change:  [-1.71063342]
curr_Stock_Price:  99.14018152765539
curr_Factors:  [99.14018153 -0.70515008 -1.0684054 ]
mat_Sqrt:  [[16.82690933  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00749397 -0.01218505 -0.31884877]
Stock Position:  -0.007493969524431234
Bond Position:  [-0.96767992]


portfolio before change:  [-1.71382312]
curr_Stock_Price:  99.54967456195484
curr_Factors:  [99.54967456 -0.75172362 -1.06302301]
mat_Sqrt:  [[16.2145686   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00082737 -0.01655699  0.07879693]
Stock Position:  0.0008273730418717348
Bond Position:  [-1.79618783]


portfolio before change:  [-1.71402648]
curr_Stock_Price:  99.57526733459336
curr_Factors:  [99.57526733 -0.81417137 -1.06317728]
mat_Sqrt:  [[15.2345392   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00332018 -0.01179203 -0.26407398]
Stock Position:  -0.003320182744732303
Bond Position:  [-1.3834184]


portfolio before change:  [-1.71517076]
curr_Stock_Price:  99.867823956422
curr_Factors:  [99.86782396 -1.09404884 -1.08122833]
mat_Sqrt:  [[11.34265478  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00380062  0.04606349 -0.23592367]
Stock Position:  0.0038006193100422934
Bond Position:  [-2.09473034]


portfolio before change:  [-1.71380808]
curr_Stock_Price:  100.29526326379116
curr_Factors:  [100.29526326  -0.98922256  -1.10114475]
mat_Sqrt:  [[12.40067817  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00147969  0.01208334 -0.04050046]
Stock Position:  -0.0014796926418183766
Bond Position:  [-1.56540192]


portfolio before change:  [-1.71594468]
curr_Stock_Price:  101.6069616290516
curr_Factors:  [101.60696163  -1.13183171  -1.10013335]
mat_Sqrt:  [[10.9041887   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00890717 -0.00593744 -0.16813385]
Stock Position:  -0.008907174963484839
Bond Position:  [-0.8109137]


portfolio before change:  [-1.70925097]
curr_Stock_Price:  100.84408425204734
curr_Factors:  [100.84408425  -1.07944679  -1.06226584]
mat_Sqrt:  [[11.8444923   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00094315 -0.00191085  0.3574474 ]
Stock Position:  0.0009431530695986029
Bond Position:  [-1.80436238]


portfolio before change:  [-1.70904678]
curr_Stock_Price:  101.29973013619502
curr_Factors:  [101.29973014  -1.07847188  -1.05319877]
mat_Sqrt:  [[12.01809101  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01919836 0.09029752 0.16300203]
Stock Position:  0.01919835814264656
Bond Position:  [-3.65383528]


portfolio before change:  [-1.72368466]
curr_Stock_Price:  100.56106690697251
curr_Factors:  [100.56106691  -1.01818297  -1.03100679]
mat_Sqrt:  [[12.95621255  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00795838 -0.02639445 -0.30860607]
Stock Position:  -0.007958379671026378
Bond Position:  [-0.92338151]


portfolio before change:  [-1.72968529]
curr_Stock_Price:  101.30056325601758
curr_Factors:  [101.30056326  -1.05046829  -1.02200811]
mat_Sqrt:  [[12.75107485  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00702702 -0.01344286 -0.18298797]
Stock Position:  -0.00702702298299617
Bond Position:  [-1.0178439]


portfolio before change:  [-1.73228949]
curr_Stock_Price:  101.65305470207045
curr_Factors:  [101.6530547   -1.08723384  -1.03224424]
mat_Sqrt:  [[12.2079517   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00273084  0.00049457  0.11315025]
Stock Position:  -0.0027308369817370297
Bond Position:  [-1.45469157]


portfolio before change:  [-1.73147719]
curr_Stock_Price:  101.28900955592393
curr_Factors:  [101.28900956  -1.36526262  -1.03404359]
mat_Sqrt:  [[ 9.19510894  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01106558 0.02330227 0.2892311 ]
Stock Position:  0.011065583282477942
Bond Position:  [-2.85229916]


portfolio before change:  [-1.73241753]
curr_Stock_Price:  101.23625290196435
curr_Factors:  [101.2362529   -1.22663039  -1.02755442]
mat_Sqrt:  [[10.62566299  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.02201741 -0.01989584 -0.0471878 ]
Stock Position:  0.022017410805504015
Bond Position:  [-3.9613777]


portfolio before change:  [-1.73349513]
curr_Stock_Price:  101.20980123815339
curr_Factors:  [101.20980124  -1.2765831   -1.03357999]
mat_Sqrt:  [[10.04457327  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-5.42865198e-03  7.09075099e-05 -1.38175257e-01]
Stock Position:  -0.005428651981559693
Bond Position:  [-1.18406235]


portfolio before change:  [-1.73181535]
curr_Stock_Price:  100.87310704086794
curr_Factors:  [100.87310704  -1.20277921  -1.05276064]
mat_Sqrt:  [[10.57321071  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00887433 -0.01910436  0.22078094]
Stock Position:  0.008874325262867206
Bond Position:  [-2.62699612]


portfolio before change:  [-1.731859]
curr_Stock_Price:  100.90519371337166
curr_Factors:  [100.90519371  -1.33856773  -1.06233798]
mat_Sqrt:  [[ 9.14562564  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-2.44733681e-04 -1.71167400e-02  4.14919376e-01]
Stock Position:  -0.0002447336811547558
Bond Position:  [-1.7071641]


portfolio before change:  [-1.73192719]
curr_Stock_Price:  100.31180244259902
curr_Factors:  [100.31180244  -1.07872303  -1.0543537 ]
mat_Sqrt:  [[11.88416246  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00581999 -0.00030849 -0.24826053]
Stock Position:  -0.005819985084427996
Bond Position:  [-1.14811399]


portfolio before change:  [-1.7306084]
curr_Stock_Price:  100.06054608369445
curr_Factors:  [100.06054608  -1.2478671   -1.02740492]
mat_Sqrt:  [[10.28311723  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01868167  0.03009165  0.14968078]
Stock Position:  -0.018681672474093792
Bond Position:  [0.13868995]


portfolio before change:  [-1.72667795]
curr_Stock_Price:  99.8510832980986
curr_Factors:  [99.8510833  -1.03777215 -1.02835237]
mat_Sqrt:  [[12.64871199  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00104534 -0.03414625  0.25386503]
Stock Position:  0.0010453396869030442
Bond Position:  [-1.83105625]


portfolio before change:  [-1.72733368]
curr_Stock_Price:  99.44276220877006
curr_Factors:  [99.44276221 -0.957579   -1.0388439 ]
mat_Sqrt:  [[13.50634159  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00543079  0.01485611 -0.20545091]
Stock Position:  0.005430794657810441
Bond Position:  [-2.2673869]


portfolio before change:  [-1.72822916]
curr_Stock_Price:  99.3300640812078
curr_Factors:  [99.33006408 -0.89446132 -1.04779305]
mat_Sqrt:  [[14.2419797   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00251741  0.02138676  0.07734518]
Stock Position:  -0.0025174131566286554
Bond Position:  [-1.47817435]


portfolio before change:  [-1.72907245]
curr_Stock_Price:  99.59164363790778
curr_Factors:  [99.59164364 -0.94211571 -1.05799458]
mat_Sqrt:  [[13.47677682  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00766254 -0.01845252 -0.65258059]
Stock Position:  -0.00766254184125416
Bond Position:  [-0.96594731]


portfolio before change:  [-1.72586612]
curr_Stock_Price:  99.15744316845549
curr_Factors:  [99.15744317 -0.84203687 -1.04670064]
mat_Sqrt:  [[14.99881817  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00105416 -0.00290951 -0.33996947]
Stock Position:  -0.0010541605194192862
Bond Position:  [-1.62133826]


portfolio before change:  [-1.72480531]
curr_Stock_Price:  97.95887149687593
curr_Factors:  [97.9588715  -0.56639499 -1.05315222]
mat_Sqrt:  [[19.3947131   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00268251 0.02895251 0.04739678]
Stock Position:  0.0026825056885047415
Bond Position:  [-1.98758054]


portfolio before change:  [-1.7266747]
curr_Stock_Price:  97.35461607281081
curr_Factors:  [97.35461607 -0.56494465 -1.04418514]
mat_Sqrt:  [[19.47692364  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00117112 -0.02959133 -0.22774568]
Stock Position:  0.0011711165759169407
Bond Position:  [-1.8406883]


portfolio before change:  [-1.72693223]
curr_Stock_Price:  97.33119165224755
curr_Factors:  [97.33119165 -0.76768349 -1.02472224]
mat_Sqrt:  [[16.21138517  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01464359 -0.06721059 -0.32607736]
Stock Position:  0.014643592435651087
Bond Position:  [-3.15221053]


portfolio before change:  [-1.70422856]
curr_Stock_Price:  98.90851789316616
curr_Factors:  [98.90851789 -0.7426415  -1.03212577]
mat_Sqrt:  [[16.76725848  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00290588 -0.02604668  0.00341116]
Stock Position:  -0.0029058755976418427
Bond Position:  [-1.41681271]


portfolio before change:  [-1.70079741]
curr_Stock_Price:  97.66680714915118
curr_Factors:  [97.66680715 -0.58479797 -1.05685494]
mat_Sqrt:  [[18.91412213  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00988978  0.03291224  0.05514029]
Stock Position:  -0.00988978141349135
Bond Position:  [-0.73489404]


portfolio before change:  [-1.68989777]
curr_Stock_Price:  96.55540622092126
curr_Factors:  [96.55540622 -0.55578352 -1.06783402]
mat_Sqrt:  [[19.0391895   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00792098 -0.02528568 -0.13694181]
Stock Position:  0.007920984815920197
Bond Position:  [-2.45471168]


portfolio before change:  [-1.69868547]
curr_Stock_Price:  95.48472568936504
curr_Factors:  [95.48472569 -0.23210358 -1.04024297]
mat_Sqrt:  [[26.75228089  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 2.82746694e-04  1.18907980e-02 -2.93582398e-01]
Stock Position:  0.0002827466935954354
Bond Position:  [-1.72568346]


portfolio before change:  [-1.69952658]
curr_Stock_Price:  93.27291310517626
curr_Factors:  [ 9.32729131e+01 -6.60130165e-02 -1.03128684e+00]
mat_Sqrt:  [[31.13180262  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00022349  0.01841627 -0.05983975]
Stock Position:  -0.00022349136288276854
Bond Position:  [-1.67868089]


portfolio before change:  [-1.69914996]
curr_Stock_Price:  90.64880272296926
curr_Factors:  [ 9.06488027e+01 -4.82231868e-02 -1.03096564e+00]
mat_Sqrt:  [[30.80890894  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01205408 -0.15554845 -0.35428501]
Stock Position:  0.012054084658289738
Bond Position:  [-2.7918383]


portfolio before change:  [-1.68892671]
curr_Stock_Price:  91.52587045815395
curr_Factors:  [91.52587046 -0.10707791 -1.04672629]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-1.68892671]
Stock Price:  93.01691449366353
PL:  [-1.68892671]
Settle:  Tensor("sub_252:0", shape=(), dtype=float64)
PL:  Tensor("sub_253:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  127
output_Z_Vals[:, i, :]:  [[ 1.19260232e+02 -2.92559343e+01 -2.92733494e+01]
 [ 5.26561055e-02 -3.26935822e-02 -1.13725256e-01]
 [-5.93514599e-02 -3.07746460e-03  9.65761190e-02]
 [-5.52700933e-02  9.86719664e-02  1.18902037e-02]
 [-2.82746636e-02  5.64555858e-02 -7.09334214e-02]
 [ 4.93458024e-02  2.86900212e-02  4.31801024e-02]
 [ 6.29743500e-02  3.28464156e-02 -4.91752253e-02]
 [-1.01493640e-01 -3.56406042e-02 -1.10715342e-01]
 [ 3.08722597e-03 -5.74666202e-02  4.71219110e-04]
 [-6.18936515e-02 -1.20549707e-01 -1.28705922e-01]
 [ 6.78641135e-02  1.09209925e-01 -9.33789944e-02]
 [-1.90582027e-01 -9.45056767e-02  3.68922662e-02]
 [-6.77159956e-02 -1.44806264e-03  2.72491190e-02]
 [-9.62623594e-02 -1.14884369e-01  6.32126881e-02]
 [ 2.12670656e-01  2.03249875e-01 -3.76366100e-02]
 [-5.75808944e-02 -5.05505442e-01 -4.07272196e-02]
 [-6.71534916e-02 -2.80374269e-02 -6.10031955e-02]
 [-9.27916008e-02  3.31729541e-02  9.92057014e-02]
 [ 7.08575228e-02  3.99275987e-02  3.89860704e-02]
 [-1.90680966e-02 -9.43843215e-04  7.84064275e-02]
 [ 1.91435964e-03 -5.31024942e-02  2.79850245e-02]
 [ 1.14740190e-01  7.49045067e-02  2.71231427e-01]
 [-9.68777416e-02  1.58454401e-01  4.33592510e-01]
 [-3.23206538e-02 -7.29069841e-03 -7.96163172e-02]
 [-2.44933159e-01  8.66250775e-02  1.10065716e-01]
 [ 2.38171395e-02 -7.88619813e-02  8.06722150e-02]
 [-3.28399513e-02  5.10669040e-02 -2.86792632e-02]
 [-5.07806065e-02  7.36225950e-02  2.93687317e-02]
 [ 6.09153051e-02 -7.67651952e-02 -1.29328324e-02]
 [-2.46665943e-02 -5.48302964e-02 -7.96387217e-02]
 [-1.21918656e-01  5.95741060e-01 -1.05761500e-02]
 [ 2.13555147e-02 -1.28183786e-01 -6.47392883e-02]
 [ 5.08407615e-02 -2.67990348e-02  6.95626541e-02]
 [-5.18078068e-02 -8.72157899e-02 -1.24680602e-02]
 [-1.52650178e-01  1.30093638e-01  3.48103529e-02]
 [ 8.47165236e-02 -1.65012150e-01 -1.38726811e-01]
 [-1.72088058e-01 -2.79006184e-01  2.64519193e-02]
 [-4.22926273e-02 -2.17112363e-02  2.02675865e-02]
 [-3.56723333e-02  7.65445498e-02 -2.60897948e-02]
 [ 1.32510871e-01 -7.02564526e-03 -1.25288356e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.26023247 -29.25593426 -29.27334937]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  8.31486419  -9.25153874 -83.50871763]
init_Out:  [2.49911038]
Stock Position:  8.31486419409362
Bond position:  [-828.98730903]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-3.0556228]
curr_Stock_Price:  99.34441463298947
curr_Factors:  [99.34441463 -1.06179247 -0.98144876]
mat_Sqrt:  [[12.87582501  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00222105 -0.01033862 -0.3244265 ]
Stock Position:  0.0022210530208031714
Bond Position:  [-3.27627202]


portfolio before change:  [-3.05706799]
curr_Stock_Price:  98.87813826603583
curr_Factors:  [98.87813827 -0.90435366 -1.00149707]
mat_Sqrt:  [[14.70279243  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00270135 -0.00097318  0.27550479]
Stock Position:  -0.0027013509291864695
Bond Position:  [-2.78996344]


portfolio before change:  [-3.05518605]
curr_Stock_Price:  98.05236589311754
curr_Factors:  [98.05236589 -1.04430354 -1.01163575]
mat_Sqrt:  [[12.54801386  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00400823  0.03120282  0.03391944]
Stock Position:  -0.004008229268840523
Bond Position:  [-2.66216969]


portfolio before change:  [-3.05590361]
curr_Stock_Price:  98.14836050136007
curr_Factors:  [98.1483605  -1.25535681 -1.00016486]
mat_Sqrt:  [[10.28779822  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0040141   0.01785282 -0.20235331]
Stock Position:  -0.004014096094833885
Bond Position:  [-2.66192666]


portfolio before change:  [-3.05444066]
curr_Stock_Price:  97.70100853251208
curr_Factors:  [97.70100853 -1.04085138 -0.99451615]
mat_Sqrt:  [[12.76292336  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00461498 0.00907258 0.12318081]
Stock Position:  0.004614983214788628
Bond Position:  [-3.50532918]


portfolio before change:  [-3.05475552]
curr_Stock_Price:  97.72773278612819
curr_Factors:  [97.72773279 -0.82205469 -1.02525027]
mat_Sqrt:  [[15.40790084  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00349071  0.01038695 -0.14028323]
Stock Position:  0.003490714964318002
Bond Position:  [-3.39589518]


portfolio before change:  [-3.05082554]
curr_Stock_Price:  98.97518382992784
curr_Factors:  [98.97518383 -1.00142576 -1.04584303]
mat_Sqrt:  [[12.77640819  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00978472 -0.01127055 -0.31584005]
Stock Position:  -0.009784717989141045
Bond Position:  [-2.08238128]


portfolio before change:  [-3.04520816]
curr_Stock_Price:  98.37448199782669
curr_Factors:  [98.374482   -0.90762349 -1.03958863]
mat_Sqrt:  [[14.03521219  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0001211  -0.01817254  0.00134426]
Stock Position:  0.00012109766428125176
Bond Position:  [-3.05712108]


portfolio before change:  [-3.04559599]
curr_Stock_Price:  98.3276750517997
curr_Factors:  [98.32767505 -0.86625479 -1.04144659]
mat_Sqrt:  [[14.59390743  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00625454 -0.03812116 -0.36716217]
Stock Position:  -0.006254542755279052
Bond Position:  [-2.43060134]


portfolio before change:  [-3.04684502]
curr_Stock_Price:  98.47879473230343
curr_Factors:  [98.47879473 -0.61888487 -1.04938366]
mat_Sqrt:  [[18.57047048  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00277984  0.03453521 -0.26638428]
Stock Position:  0.0027798430975285136
Bond Position:  [-3.32060062]


portfolio before change:  [-3.04985905]
curr_Stock_Price:  97.54387498303839
curr_Factors:  [97.54387498 -0.56994508 -1.02597092]
mat_Sqrt:  [[19.77436253  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00938041 -0.02988532  0.10524337]
Stock Position:  -0.009380406074943953
Bond Position:  [-2.13485789]


portfolio before change:  [-3.05148761]
curr_Stock_Price:  97.6890373150888
curr_Factors:  [97.68903732 -0.35415432 -0.99899409]
mat_Sqrt:  [[25.24532367  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00246347 -0.00045792  0.07773415]
Stock Position:  -0.0024634733190008933
Bond Position:  [-2.81083327]


portfolio before change:  [-3.05128143]
curr_Stock_Price:  97.46270947006465
curr_Factors:  [97.46270947 -0.44426843 -0.97848751]
mat_Sqrt:  [[23.49326761  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00367448 -0.03632963  0.1803282 ]
Stock Position:  -0.0036744750279170194
Bond Position:  [-2.69315714]


portfolio before change:  [-3.05087283]
curr_Stock_Price:  97.25988772084456
curr_Factors:  [97.25988772 -0.33524145 -0.991882  ]
mat_Sqrt:  [[25.79712888  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00814959  0.06427325 -0.10736677]
Stock Position:  0.008149589266683103
Bond Position:  [-3.84350097]


portfolio before change:  [-3.05189206]
curr_Stock_Price:  97.19377860777635
curr_Factors:  [97.19377861 -0.38883527 -0.98957383]
mat_Sqrt:  [[24.49080169  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00322351 -0.15985486 -0.11618342]
Stock Position:  -0.0032235121852866797
Bond Position:  [-2.73858673]


portfolio before change:  [-3.05417291]
curr_Stock_Price:  97.7951440970784
curr_Factors:  [97.7951441  -0.27588189 -0.98767333]
mat_Sqrt:  [[27.64153969  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00290612 -0.00886621 -0.17402514]
Stock Position:  -0.002906120315578592
Bond Position:  [-2.76996846]


portfolio before change:  [-3.05999775]
curr_Stock_Price:  99.68032760769759
curr_Factors:  [99.68032761 -0.2632922  -1.01436647]
mat_Sqrt:  [[27.77981457  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00258046  0.01049021  0.28300625]
Stock Position:  -0.002580463580575318
Bond Position:  [-2.8027763]


portfolio before change:  [-3.05962063]
curr_Stock_Price:  99.39840476413434
curr_Factors:  [ 9.93984048e+01 -5.57600224e-02 -1.02449869e+00]
mat_Sqrt:  [[33.74652161  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00236606 0.01262622 0.11121641]
Stock Position:  0.0023660645145364445
Bond Position:  [-3.29480367]


portfolio before change:  [-3.06405902]
curr_Stock_Price:  97.69662963295012
curr_Factors:  [97.69662963 -0.11222103 -1.02444832]
mat_Sqrt:  [[31.34948113  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-9.84967337e-05 -2.98469431e-04  2.23671713e-01]
Stock Position:  -9.849673371004763e-05
Bond Position:  [-3.05443622]


portfolio before change:  [-3.06441188]
curr_Stock_Price:  97.40252670537845
curr_Factors:  [ 9.74025267e+01 -6.99236560e-02 -1.04255831e+00]
mat_Sqrt:  [[32.02030336  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00019537 -0.01679248  0.07983349]
Stock Position:  0.00019536599225664008
Bond Position:  [-3.08344102]


portfolio before change:  [-3.06512215]
curr_Stock_Price:  95.73987983529105
curr_Factors:  [95.73987984 -0.11922707 -1.03557228]
mat_Sqrt:  [[30.16962391  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00570239 0.02368688 0.77374776]
Stock Position:  0.005702394558100147
Bond Position:  [-3.61106872]


portfolio before change:  [-3.05849401]
curr_Stock_Price:  96.98138569859597
curr_Factors:  [96.9813857  0.1063503 -1.0191939]
mat_Sqrt:  [[38.92650815  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-1.09944774e-04  5.01076814e-02  1.23691874e+00]
Stock Position:  -0.00010994477425614126
Bond Position:  [-3.04783141]


portfolio before change:  [-3.05905509]
curr_Stock_Price:  98.61926958822563
curr_Factors:  [ 9.86192696e+01 -1.19243951e-02 -1.00790955e+00]
mat_Sqrt:  [[35.56751517  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00137093 -0.00230552 -0.22712319]
Stock Position:  -0.0013709282554250585
Bond Position:  [-2.92385515]


portfolio before change:  [-3.05778492]
curr_Stock_Price:  97.42615835293284
curr_Factors:  [ 9.74261584e+01  2.71344729e-03 -9.79124001e-01]
mat_Sqrt:  [[36.6966029   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00600136  0.02739325  0.31398685]
Stock Position:  -0.006001357661153486
Bond Position:  [-2.4730957]


portfolio before change:  [-3.07641728]
curr_Stock_Price:  100.47933391594557
curr_Factors:  [100.47933392  -0.39446833  -0.95898538]
mat_Sqrt:  [[25.95848054  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00147343 -0.02493835  0.23013537]
Stock Position:  0.001473432882770556
Bond Position:  [-3.22446683]


portfolio before change:  [-3.07728336]
curr_Stock_Price:  100.16510672434173
curr_Factors:  [100.16510672  -0.37382249  -0.97649716]
mat_Sqrt:  [[25.95852936  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00143982  0.01614877 -0.08181396]
Stock Position:  -0.0014398172984983937
Bond Position:  [-2.9330639]


portfolio before change:  [-3.0775882]
curr_Stock_Price:  100.12217353575467
curr_Factors:  [100.12217354  -0.42251159  -0.98826587]
mat_Sqrt:  [[24.42515912  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00175576  0.02328151  0.08378082]
Stock Position:  -0.0017557638746043425
Bond Position:  [-2.9017973]


portfolio before change:  [-3.08121429]
curr_Stock_Price:  101.98081896066162
curr_Factors:  [101.98081896  -0.22899219  -0.98930277]
mat_Sqrt:  [[30.15919317  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00186654 -0.02427529 -0.03689377]
Stock Position:  0.0018665397515729722
Bond Position:  [-3.27156554]


portfolio before change:  [-3.07603007]
curr_Stock_Price:  104.9773702629016
curr_Factors:  [ 1.04977370e+02 -6.38221611e-02 -9.92787581e-01]
mat_Sqrt:  [[36.49353287  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00116016 -0.01733886 -0.22718711]
Stock Position:  -0.001160164258540795
Bond Position:  [-2.95423908]


portfolio before change:  [-3.07741264]
curr_Stock_Price:  105.8507506568845
curr_Factors:  [105.85075066  -0.18996725  -0.98047117]
mat_Sqrt:  [[32.83817355  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00331004  0.18838986 -0.03017081]
Stock Position:  -0.003310035980785358
Bond Position:  [-2.72704285]


portfolio before change:  [-3.06900182]
curr_Stock_Price:  103.20675344956162
curr_Factors:  [103.20675345  -0.23802598  -0.98336313]
mat_Sqrt:  [[30.42745055  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 1.58770178e-04 -4.05352721e-02 -1.84683170e-01]
Stock Position:  0.00015877017771109093
Bond Position:  [-3.08538797]


portfolio before change:  [-3.06979068]
curr_Stock_Price:  100.66743049240442
curr_Factors:  [100.66743049  -0.2359026   -0.97438772]
mat_Sqrt:  [[30.01004012  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00214422 -0.0084746   0.19844289]
Stock Position:  0.0021442234156969662
Bond Position:  [-3.28564415]


portfolio before change:  [-3.06748586]
curr_Stock_Price:  101.93388054945447
curr_Factors:  [101.93388055  -0.44121812  -0.97510943]
mat_Sqrt:  [[24.72949911  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00228896 -0.02758005 -0.03556791]
Stock Position:  -0.002288956223702596
Bond Position:  [-2.83416367]


portfolio before change:  [-3.07193405]
curr_Stock_Price:  103.72242315796255
curr_Factors:  [103.72242316  -0.69825428  -1.00272059]
mat_Sqrt:  [[18.92991446  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00751116  0.04113922  0.09930425]
Stock Position:  -0.007511156025244958
Bond Position:  [-2.29285875]


portfolio before change:  [-3.06565864]
curr_Stock_Price:  102.84878388823564
curr_Factors:  [102.84878389  -0.89209065  -0.97742136]
mat_Sqrt:  [[15.85916834  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00328759 -0.05218142 -0.39574898]
Stock Position:  0.003287589573234165
Bond Position:  [-3.40378323]


portfolio before change:  [-3.06408297]
curr_Stock_Price:  103.4574863749776
curr_Factors:  [103.45748637  -0.70612926  -0.98980123]
mat_Sqrt:  [[18.97704865  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00916331 -0.0882295   0.07545996]
Stock Position:  -0.009163305349130974
Bond Position:  [-2.11607043]


portfolio before change:  [-3.05677507]
curr_Stock_Price:  102.63110011337606
curr_Factors:  [102.63110011  -0.5126253   -0.98596572]
mat_Sqrt:  [[22.93238227  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00168827 -0.0068657   0.05781778]
Stock Position:  -0.0016882722771627678
Bond Position:  [-2.88350583]


portfolio before change:  [-3.05986565]
curr_Stock_Price:  104.2482086384301
curr_Factors:  [104.24820864  -0.70431423  -1.00277011]
mat_Sqrt:  [[18.90998972  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00206354  0.02420551 -0.07442692]
Stock Position:  -0.0020635399134617863
Bond Position:  [-2.84474531]


portfolio before change:  [-3.06292471]
curr_Stock_Price:  105.55830834150915
curr_Factors:  [105.55830834  -0.95913113  -1.04181893]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-3.06292471]
Stock Price:  104.96197280549252
PL:  [-8.02489751]
Settle:  Tensor("sub_254:0", shape=(), dtype=float64)
PL:  Tensor("sub_255:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  128
output_Z_Vals[:, i, :]:  [[ 1.19260232e+02 -2.92559343e+01 -2.92733494e+01]
 [ 4.03706775e-03 -1.27034308e-01 -3.91946428e-02]
 [-3.69248038e-02  7.73746287e-03  4.24826272e-02]
 [ 8.47494083e-02  1.68332038e-01  3.79300832e-02]
 [ 2.12310714e-01 -2.71428462e-02 -5.65527127e-02]
 [ 3.63990821e-02  3.00778975e-02  5.65680143e-02]
 [ 5.82997452e-02  2.40045957e-02 -5.97867882e-02]
 [-1.05816696e-01 -5.13299916e-02 -1.16437257e-01]
 [ 7.81018155e-02 -4.26623831e-02 -5.92094522e-02]
 [-4.94723813e-02  6.48526306e-02 -2.32449858e-02]
 [ 5.76469577e-02  1.32522932e-01 -8.38014320e-02]
 [-8.05692257e-02 -1.06935703e-01 -1.43249638e-03]
 [-9.87157086e-02  6.73559010e-03 -4.05847427e-02]
 [-7.98322134e-02 -1.05943197e-01  7.52707392e-02]
 [ 1.49355272e-01  1.01884631e-01 -7.08687844e-02]
 [-7.62310580e-02 -8.33453516e-02 -1.10755513e-01]
 [-7.39819210e-02 -4.92647201e-02 -5.62650538e-02]
 [-4.05314397e-02 -4.59863896e-02  1.85000666e-02]
 [ 5.88699907e-02  6.80175674e-02  6.84956763e-02]
 [ 2.47774135e-01 -6.48633867e-02 -1.92465533e-02]
 [-5.90001188e-02  1.42099129e-02 -6.62595420e-02]
 [ 3.90960639e-02 -3.24454915e-02  3.79460273e-02]
 [-7.36218827e-02  1.06710228e-01  1.43523383e-01]
 [ 8.34510792e-02 -5.10285928e-02  7.61015384e-03]
 [ 8.70205650e-02  2.95055363e-02  9.38115527e-02]
 [ 1.00407029e-01  6.76192643e-03  5.61698381e-02]
 [-1.53448911e-01  7.38204072e-02  7.87336026e-02]
 [-4.02078058e-02  6.53384509e-02  2.62496455e-02]
 [-3.33767496e-02 -4.66383535e-02 -2.51565486e-01]
 [ 7.21706621e-03 -5.09686533e-03 -1.14302753e-01]
 [ 4.39954723e-02  7.55826415e-02  3.57531039e-02]
 [ 1.51052254e-02 -6.43029512e-02 -9.02739664e-02]
 [ 1.99679547e-01 -2.01120993e-01 -1.32210354e-01]
 [-4.96113257e-02 -8.60721127e-02 -1.26194225e-02]
 [-1.49610515e-01  9.78582075e-02  3.28358966e-02]
 [ 8.47165236e-02 -1.65012150e-01 -1.38726811e-01]
 [-1.13511829e-01 -2.20095637e-01  1.69303676e-03]
 [-3.61352754e-02 -1.13215799e-02 -8.63495204e-03]
 [-4.59287632e-02  9.78726094e-02 -1.91315169e-02]
 [-3.91409223e-01  2.05993288e-01  2.36867964e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.26023247 -29.25593426 -29.27334937]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  8.31486419  -9.25153874 -83.50871763]
init_Out:  [2.49911038]
Stock Position:  8.31486419409362
Bond position:  [-828.98730903]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-0.21649547]
curr_Stock_Price:  99.68586667254046
curr_Factors:  [99.68586667 -0.9218279  -0.99732567]
mat_Sqrt:  [[14.62701766  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00049521 -0.04017178 -0.11181141]
Stock Position:  -0.0004952148903820311
Bond Position:  [-0.16712954]


portfolio before change:  [-0.2165904]
curr_Stock_Price:  99.8353754278883
curr_Factors:  [99.83537543 -1.23496039 -1.0054807 ]
mat_Sqrt:  [[10.62363768  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00264065  0.0024468   0.12119111]
Stock Position:  -0.0026406485503838654
Bond Position:  [0.04703974]


portfolio before change:  [-0.21735501]
curr_Stock_Price:  100.12715618508875
curr_Factors:  [100.12715619  -1.04229001  -0.99382252]
mat_Sqrt:  [[13.07011609  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00740913 0.05323126 0.10820397]
Stock Position:  0.0074091284249800235
Bond Position:  [-0.95920997]


portfolio before change:  [-0.21400263]
curr_Stock_Price:  100.59580535909463
curr_Factors:  [100.59580536  -0.77601489  -1.00071839]
mat_Sqrt:  [[17.0197984   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01175491 -0.00858332 -0.16132915]
Stock Position:  0.01175490506175139
Bond Position:  [-1.39649678]


portfolio before change:  [-0.20779571]
curr_Stock_Price:  101.13868500521154
curr_Factors:  [101.13868501  -0.72936205  -0.97889754]
mat_Sqrt:  [[18.32439274  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00265889 0.00951147 0.1613728 ]
Stock Position:  0.0026588923468450574
Bond Position:  [-0.47671258]


portfolio before change:  [-0.20981026]
curr_Stock_Price:  100.40343198911401
curr_Factors:  [100.40343199  -0.82607331  -0.97108374]
mat_Sqrt:  [[16.64382613  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00280678  0.00759092 -0.17055507]
Stock Position:  0.002806783356493999
Bond Position:  [-0.49162094]


portfolio before change:  [-0.21270529]
curr_Stock_Price:  99.39388870806505
curr_Factors:  [99.39388871 -0.74390477 -0.96258628]
mat_Sqrt:  [[18.04014546  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00725658 -0.01623197 -0.33216308]
Stock Position:  -0.007256575987799686
Bond Position:  [0.50855402]


portfolio before change:  [-0.20520146]
curr_Stock_Price:  98.36857643517561
curr_Factors:  [98.36857644 -0.75663373 -0.94156122]
mat_Sqrt:  [[18.00278488  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00360579 -0.01349103 -0.16890809]
Stock Position:  0.0036057864990702198
Bond Position:  [-0.55989754]


portfolio before change:  [-0.2013763]
curr_Stock_Price:  99.44882634130502
curr_Factors:  [99.44882634 -0.74941386 -0.95776471]
mat_Sqrt:  [[18.03771134  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00291294  0.0205082  -0.06631147]
Stock Position:  -0.0029129392013927235
Bond Position:  [0.08831209]


portfolio before change:  [-0.20304852]
curr_Stock_Price:  100.02668287206623
curr_Factors:  [100.02668287  -0.72753293  -0.98189985]
mat_Sqrt:  [[18.10167006  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00242866  0.04190743 -0.23906216]
Stock Position:  0.0024286593064849096
Bond Position:  [-0.44597925]


portfolio before change:  [-0.20550134]
curr_Stock_Price:  99.03968970300619
curr_Factors:  [99.0396897  -0.43084398 -0.97120067]
mat_Sqrt:  [[24.37300146  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00343096 -0.03381604 -0.00408651]
Stock Position:  -0.0034309562111637677
Bond Position:  [0.1342995]


portfolio before change:  [-0.2089189]
curr_Stock_Price:  100.04067784966098
curr_Factors:  [100.04067785  -0.6273288   -0.9737131 ]
mat_Sqrt:  [[20.17683127  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00529449  0.00212998 -0.11577697]
Stock Position:  -0.0052944945051843625
Bond Position:  [0.32074592]


portfolio before change:  [-0.20840328]
curr_Stock_Price:  99.95086429192864
curr_Factors:  [99.95086429 -0.72618326 -0.9544236 ]
mat_Sqrt:  [[18.61693862  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00360978 -0.03350218  0.21472647]
Stock Position:  -0.0036097814497538998
Bond Position:  [0.15239749]


portfolio before change:  [-0.21372129]
curr_Stock_Price:  101.42936307364268
curr_Factors:  [101.42936307  -0.64164597  -1.01551375]
mat_Sqrt:  [[19.34053032  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00711045  0.03221875 -0.20216892]
Stock Position:  0.007110450916668049
Bond Position:  [-0.9349298]


portfolio before change:  [-0.21651389]
curr_Stock_Price:  101.0530543648554
curr_Factors:  [101.05305436  -0.93415692  -1.00980143]
mat_Sqrt:  [[14.46435466  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00698205 -0.02635611 -0.31595465]
Stock Position:  -0.006982053636018447
Bond Position:  [0.48904396]


portfolio before change:  [-0.2163999]
curr_Stock_Price:  101.04548392546613
curr_Factors:  [101.04548393  -0.98307689  -0.99970534]
mat_Sqrt:  [[13.91251122  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0062346  -0.01557887 -0.16050854]
Stock Position:  -0.0062346031732029294
Bond Position:  [0.4135786]


portfolio before change:  [-0.21993343]
curr_Stock_Price:  101.62053760529902
curr_Factors:  [101.62053761  -0.84590298  -0.99491429]
mat_Sqrt:  [[16.12592756  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00235289 -0.01454217  0.05277554]
Stock Position:  -0.0023528874678892127
Bond Position:  [0.01916826]


portfolio before change:  [-0.21891342]
curr_Stock_Price:  101.18804355634789
curr_Factors:  [101.18804356  -1.0551251   -0.99228665]
mat_Sqrt:  [[13.06019234  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00571261 0.02150904 0.1953991 ]
Stock Position:  0.005712612507674996
Bond Position:  [-0.79696151]


portfolio before change:  [-0.21824781]
curr_Stock_Price:  101.32200027646702
curr_Factors:  [101.32200028  -1.31617748  -1.0083448 ]
mat_Sqrt:  [[ 9.91234832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.02443121 -0.0205116  -0.05490506]
Stock Position:  0.024431212002594665
Bond Position:  [-2.69366708]


portfolio before change:  [-0.20508773]
curr_Stock_Price:  101.87444130046416
curr_Factors:  [101.8744413   -1.4014462   -1.00335246]
mat_Sqrt:  [[ 9.19759859  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00784535  0.00449357 -0.18902003]
Stock Position:  -0.007845351380240896
Bond Position:  [0.59415306]


portfolio before change:  [-0.21260828]
curr_Stock_Price:  102.84250823533277
curr_Factors:  [102.84250824  -1.42637251  -1.02711366]
mat_Sqrt:  [[ 8.84376421  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00520186 -0.01026017  0.10824945]
Stock Position:  0.00520186023236224
Bond Position:  [-0.74758064]


portfolio before change:  [-0.20892807]
curr_Stock_Price:  103.56795384128868
curr_Factors:  [103.56795384  -1.40252719  -1.01885163]
mat_Sqrt:  [[ 9.19674063  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00452008  0.03374474  0.40943226]
Stock Position:  -0.004520084920603218
Bond Position:  [0.25920788]


portfolio before change:  [-0.20758185]
curr_Stock_Price:  103.2772922594163
curr_Factors:  [103.27729226  -1.40443766  -1.01158432]
mat_Sqrt:  [[ 9.22018908  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00907649 -0.01613666  0.02170965]
Stock Position:  0.00907648877967701
Bond Position:  [-1.14497704]


portfolio before change:  [-0.20970957]
curr_Stock_Price:  103.05864085133584
curr_Factors:  [103.05864085  -1.21951679  -1.01445257]
mat_Sqrt:  [[11.03783367  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00968773 0.00933047 0.26761825]
Stock Position:  0.009687734105233589
Bond Position:  [-1.20811428]


portfolio before change:  [-0.20366283]
curr_Stock_Price:  103.69839466679812
curr_Factors:  [103.69839467  -1.38944998  -1.00601358]
mat_Sqrt:  [[ 9.45007869  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01185675 0.00213831 0.16023691]
Stock Position:  0.011856752196042795
Bond Position:  [-1.433189]


portfolio before change:  [-0.20587891]
curr_Stock_Price:  103.52660079866313
curr_Factors:  [103.5266008   -1.26527874  -0.98210676]
mat_Sqrt:  [[10.94018922  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01238292  0.02334406  0.22460505]
Stock Position:  -0.012382916215213402
Bond Position:  [1.07608232]


portfolio before change:  [-0.19151769]
curr_Stock_Price:  102.37770354029695
curr_Factors:  [102.37770354  -1.16000234  -0.97166205]
mat_Sqrt:  [[12.14605657  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00273032  0.02066183  0.07488293]
Stock Position:  -0.0027303172550402254
Bond Position:  [0.08800592]


portfolio before change:  [-0.19013877]
curr_Stock_Price:  101.87669461529862
curr_Factors:  [101.87669462  -1.21525966  -0.97679156]
mat_Sqrt:  [[11.37834499  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0075522  -0.01474834 -0.71764631]
Stock Position:  -0.007552199959966626
Bond Position:  [0.57925439]


portfolio before change:  [-0.18234389]
curr_Stock_Price:  100.85414852077483
curr_Factors:  [100.85414852  -1.13169628  -0.96554402]
mat_Sqrt:  [[12.3843688   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00131185 -0.00161177 -0.32607394]
Stock Position:  -0.0013118541790381828
Bond Position:  [-0.05003795]


portfolio before change:  [-0.18249273]
curr_Stock_Price:  100.96284044383029
curr_Factors:  [100.96284044  -1.19503278  -0.96397277]
mat_Sqrt:  [[11.65513648  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00456838 0.02390133 0.10199365]
Stock Position:  0.004568378893763789
Bond Position:  [-0.64372924]


portfolio before change:  [-0.18257773]
curr_Stock_Price:  100.96185048955155
curr_Factors:  [100.96185049  -1.1230296   -0.96833089]
mat_Sqrt:  [[12.47070433  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00039951 -0.02033438 -0.2575265 ]
Stock Position:  -0.000399509583640721
Bond Position:  [-0.1422425]


portfolio before change:  [-0.18269613]
curr_Stock_Price:  101.21372177387914
curr_Factors:  [101.21372177  -1.14224378  -0.95542747]
mat_Sqrt:  [[12.42316761  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01348282 -0.06360004 -0.37715934]
Stock Position:  0.013482817371788745
Bond Position:  [-1.54734226]


portfolio before change:  [-0.18505733]
curr_Stock_Price:  101.05294160536435
curr_Factors:  [101.05294161  -1.07893503  -0.97994506]
mat_Sqrt:  [[12.89403059  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00421975 -0.02721839 -0.0359997 ]
Stock Position:  -0.004219753209541073
Bond Position:  [0.24136114]


portfolio before change:  [-0.18561145]
curr_Stock_Price:  101.19140634411646
curr_Factors:  [101.19140634  -1.17227194  -0.9581001 ]
mat_Sqrt:  [[12.0208398   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01167815  0.03094548  0.09367167]
Stock Position:  -0.01167815477748967
Bond Position:  [0.99611746]


portfolio before change:  [-0.18298652]
curr_Stock_Price:  100.97729691747546
curr_Factors:  [100.97729692  -1.16013869  -0.96114559]
mat_Sqrt:  [[12.10491329  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00430721 -0.05218142 -0.39574898]
Stock Position:  0.004307212719805552
Bond Position:  [-0.61791722]


portfolio before change:  [-0.18287842]
curr_Stock_Price:  101.02032771920464
curr_Factors:  [101.02032772  -0.90587206  -0.94848756]
mat_Sqrt:  [[15.81505193  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00751493 -0.06960035  0.00482976]
Stock Position:  -0.007514934822070615
Bond Position:  [0.57628275]


portfolio before change:  [-0.18855942]
curr_Stock_Price:  101.78587516259056
curr_Factors:  [101.78587516  -0.77139662  -0.96200188]
mat_Sqrt:  [[17.9838268   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00212359 -0.0035802  -0.02463311]
Stock Position:  -0.002123585818636824
Bond Position:  [0.02759162]


portfolio before change:  [-0.1889755]
curr_Stock_Price:  101.98343083064195
curr_Factors:  [101.98343083  -0.95724817  -0.9629208 ]
mat_Sqrt:  [[14.94895488  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00316456  0.03095004 -0.05457689]
Stock Position:  -0.0031645628906723272
Bond Position:  [0.13375748]


portfolio before change:  [-0.18661867]
curr_Stock_Price:  101.24395691510672
curr_Factors:  [101.24395692  -0.88083566  -0.98518539]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-0.18661867]
Stock Price:  101.54566116365619
PL:  [-1.73227983]
Settle:  Tensor("sub_256:0", shape=(), dtype=float64)
PL:  Tensor("sub_257:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  129
output_Z_Vals[:, i, :]:  [[ 1.19260232e+02 -2.92559343e+01 -2.92733494e+01]
 [-1.48861492e-01  4.20025254e-01  6.96836797e-02]
 [ 6.17874432e-03  5.72746621e-03 -1.61222177e-02]
 [ 2.27118567e-02  1.37122978e-01  2.63953492e-02]
 [ 1.49318294e-01 -6.97862014e-03 -6.24978677e-02]
 [ 6.63370030e-02  2.95084355e-02 -2.81128516e-02]
 [ 6.47661890e-02  1.82178725e-02 -7.29276101e-02]
 [-9.77516156e-02 -2.20599171e-02 -1.05762468e-01]
 [-2.85667723e-03 -6.08212384e-02  2.10464324e-02]
 [-4.15336725e-02 -1.09294518e-01 -1.30901723e-01]
 [ 7.68819136e-02  8.86594247e-02 -8.91714607e-02]
 [-1.55687905e-01 -9.58989946e-02  2.33610436e-02]
 [-1.02393088e-01  2.97624234e-02 -6.08952871e-03]
 [-8.73684919e-02 -1.11432266e-01  7.07955852e-02]
 [ 1.79484455e-01  1.45542700e-01 -6.02560936e-02]
 [-6.75617359e-02 -3.49465458e-01 -6.79069277e-02]
 [-6.72157820e-02 -5.83609600e-02 -4.45701079e-02]
 [-8.81805507e-02  7.48350401e-04  7.90057039e-02]
 [ 5.79456410e-02  4.87985208e-02  3.75279629e-02]
 [ 1.27199915e-01 -3.41616734e-02  2.04023914e-02]
 [-5.50747945e-02  6.28458318e-03  1.23200977e-02]
 [ 6.10061688e-02 -4.61576448e-02  6.77583475e-02]
 [-8.10234707e-02  1.07410579e-01  3.66886685e-01]
 [ 9.64097896e-02 -2.83240152e-02 -4.89769229e-02]
 [ 9.38752679e-02  2.56215179e-02  1.02132644e-01]
 [ 8.35145354e-02 -1.17482578e-02  6.15313994e-02]
 [-1.81559927e-01  7.06550952e-02  7.59333769e-02]
 [-5.07806065e-02  7.36225950e-02  2.93687317e-02]
 [ 5.95184582e-02 -9.39545869e-02 -1.36859787e-01]
 [ 9.62661740e-03 -1.15363952e-02 -1.21946092e-01]
 [-2.61042112e-02  2.79968122e-01  2.10297461e-02]
 [ 1.78294695e-02 -9.75921809e-02 -7.66782772e-02]
 [ 1.38012898e-01 -1.34595014e-01 -5.80143223e-02]
 [-5.18243333e-02 -8.72319241e-02 -1.25135246e-02]
 [-1.36861985e-01  8.30034758e-02  3.55495671e-02]
 [ 8.47165236e-02 -1.65012150e-01 -1.38726811e-01]
 [-1.84275829e-01 -3.06454978e-01  5.52385242e-02]
 [-3.27880003e-02 -5.67352887e-03 -2.43470226e-02]
 [-4.42992610e-02  9.46362098e-02 -2.06767884e-02]
 [-5.57082591e-02  4.87026532e-02  2.77141984e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.26023247 -29.25593426 -29.27334937]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  8.31486419  -9.25153874 -83.50871763]
init_Out:  [2.49911038]
Stock Position:  8.31486419409362
Bond position:  [-828.98730903]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [11.64380418]
curr_Stock_Price:  101.11226394940016
curr_Factors:  [101.11226395  -1.21623279  -1.0148186 ]
mat_Sqrt:  [[10.86101782  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01139786  0.13282365  0.19878814]
Stock Position:  -0.011397860408305586
Bond Position:  [12.79626765]


portfolio before change:  [11.64874454]
curr_Stock_Price:  100.819162681579
curr_Factors:  [100.81916268  -1.13971172  -1.02504563]
mat_Sqrt:  [[11.57179985  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00026234  0.00181118 -0.0459922 ]
Stock Position:  0.0002623354180931763
Bond Position:  [11.6222961]


portfolio before change:  [11.64986199]
curr_Stock_Price:  99.54053296867556
curr_Factors:  [99.54053297 -0.85169362 -1.04878938]
mat_Sqrt:  [[14.88095079  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00212623 0.04336209 0.07529858]
Stock Position:  0.002126227373351189
Bond Position:  [11.43821618]


portfolio before change:  [11.65218226]
curr_Stock_Price:  99.95930519650038
curr_Factors:  [99.9593052  -0.96684096 -1.0478596 ]
mat_Sqrt:  [[13.33060597  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01023065 -0.00220683 -0.17828902]
Stock Position:  0.010230651407076062
Bond Position:  [10.62953345]


portfolio before change:  [11.64322253]
curr_Stock_Price:  98.95365055566832
curr_Factors:  [98.95365056 -0.79905131 -1.06223269]
mat_Sqrt:  [[15.38460854  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00398843  0.00933139 -0.08019814]
Stock Position:  0.003988427493467812
Bond Position:  [11.24855307]


portfolio before change:  [11.64336031]
curr_Stock_Price:  98.63563706696509
curr_Factors:  [98.63563707 -0.76392419 -1.05909526]
mat_Sqrt:  [[15.93333051  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00316006  0.005761   -0.20804217]
Stock Position:  0.0031600603722697204
Bond Position:  [11.33166575]


portfolio before change:  [11.64519024]
curr_Stock_Price:  98.766451452798
curr_Factors:  [98.76645145 -0.93471695 -1.06274125]
mat_Sqrt:  [[13.40060398  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00894809 -0.00697596 -0.30171088]
Stock Position:  -0.008948094721125248
Bond Position:  [12.5289618]


portfolio before change:  [11.64652582]
curr_Stock_Price:  98.79222687111856
curr_Factors:  [98.79222687 -0.87914301 -1.03398298]
mat_Sqrt:  [[14.5835318   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-8.98203709e-06 -1.92333643e-02  6.00396136e-02]
Stock Position:  -8.982037090043076e-06
Bond Position:  [11.64741317]


portfolio before change:  [11.64798326]
curr_Stock_Price:  98.63365503073778
curr_Factors:  [98.63365503 -0.63706516 -1.06161314]
mat_Sqrt:  [[18.04257472  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00393934 -0.03456196 -0.37342618]
Stock Position:  -0.003939340601925563
Bond Position:  [12.03653482]


portfolio before change:  [11.6514335]
curr_Stock_Price:  98.13977126743058
curr_Factors:  [98.13977127 -0.50996739 -1.07406762]
mat_Sqrt:  [[20.13294825  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00302832  0.02803657 -0.25438136]
Stock Position:  0.0030283215919489175
Bond Position:  [11.35423471]


portfolio before change:  [11.65296712]
curr_Stock_Price:  98.17749954146488
curr_Factors:  [98.17749954 -0.49014875 -1.06297754]
mat_Sqrt:  [[20.77293149  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00738439 -0.03032592  0.06664255]
Stock Position:  -0.0073843912185835425
Bond Position:  [12.37794818]


portfolio before change:  [11.65038705]
curr_Stock_Price:  98.73643655349798
curr_Factors:  [98.73643655 -0.49480154 -1.03888066]
mat_Sqrt:  [[21.30137952  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00482915  0.0094117  -0.01737173]
Stock Position:  -0.004829154165377314
Bond Position:  [12.12720052]


portfolio before change:  [11.64825895]
curr_Stock_Price:  99.4910404518752
curr_Factors:  [99.49104045 -0.44821148 -1.03283189]
mat_Sqrt:  [[22.62429253  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00335014 -0.03523798  0.2019601 ]
Stock Position:  -0.0033501411034756235
Bond Position:  [11.98156797]


portfolio before change:  [11.65062977]
curr_Stock_Price:  99.23044555381298
curr_Factors:  [99.23044555 -0.45307283 -1.0053805 ]
mat_Sqrt:  [[23.08057951  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00740634  0.04602464 -0.17189386]
Stock Position:  0.007406340373669996
Bond Position:  [10.91569531]


portfolio before change:  [11.6445928]
curr_Stock_Price:  98.23109728274594
curr_Factors:  [98.23109728 -0.61992058 -0.99044661]
mat_Sqrt:  [[19.62797115  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00460803 -0.11051068 -0.19371956]
Stock Position:  -0.004608032998040554
Bond Position:  [12.09724494]


portfolio before change:  [11.64294742]
curr_Stock_Price:  98.91634132925358
curr_Factors:  [98.91634133 -0.50721291 -0.99117351]
mat_Sqrt:  [[22.10686143  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0035202  -0.01845536 -0.12714611]
Stock Position:  -0.0035201962488408058
Bond Position:  [11.99115236]


portfolio before change:  [11.63895003]
curr_Stock_Price:  100.47772680744278
curr_Factors:  [100.47772681  -0.63694322  -1.01103482]
mat_Sqrt:  [[19.33579505  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00372544  0.00023665  0.22538128]
Stock Position:  -0.0037254354640764834
Bond Position:  [12.01327331]


portfolio before change:  [11.64221916]
curr_Stock_Price:  100.00331803239258
curr_Factors:  [100.00331803  -0.2761135   -0.99626052]
mat_Sqrt:  [[28.01750073  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00238658 0.01543145 0.10705683]
Stock Position:  0.00238657892434967
Bond Position:  [11.40355335]


portfolio before change:  [11.64297067]
curr_Stock_Price:  99.72089580823585
curr_Factors:  [99.72089581 -0.41821319 -0.98066267]
mat_Sqrt:  [[24.61852929  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00530017 -0.01080287  0.05820234]
Stock Position:  0.005300173853547269
Bond Position:  [11.11443258]


portfolio before change:  [11.65106538]
curr_Stock_Price:  100.98600992373929
curr_Factors:  [100.98600992  -0.4917444   -0.97289   ]
mat_Sqrt:  [[23.34417752  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00224457  0.00198736  0.03514581]
Stock Position:  -0.002244572455489245
Bond Position:  [11.8777358]


portfolio before change:  [11.65514599]
curr_Stock_Price:  99.82953552156961
curr_Factors:  [99.82953552 -0.1743409  -0.99109791]
mat_Sqrt:  [[31.12543343  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00236609 -0.01459633  0.19329571]
Stock Position:  0.002366087477886802
Bond Position:  [11.41894057]


portfolio before change:  [11.65515879]
curr_Stock_Price:  99.23164989259448
curr_Factors:  [99.23164989 -0.31298262 -0.96055821]
mat_Sqrt:  [[27.76888608  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-1.20988308e-04  3.39662074e-02  1.04662559e+00]
Stock Position:  -0.00012098830833314077
Bond Position:  [11.66716466]


portfolio before change:  [11.65639165]
curr_Stock_Price:  101.0965584134631
curr_Factors:  [101.09655841  -0.34711334  -0.92277442]
mat_Sqrt:  [[28.39429746  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00301755 -0.00895684 -0.13971753]
Stock Position:  0.0030175458394761196
Bond Position:  [11.35132815]


portfolio before change:  [11.66099676]
curr_Stock_Price:  102.15241902469845
curr_Factors:  [102.15241902  -0.44304     -0.93926356]
mat_Sqrt:  [[25.64022585  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00450014 0.00810224 0.291356  ]
Stock Position:  0.004500137864044508
Bond Position:  [11.20129679]


portfolio before change:  [11.66487986]
curr_Stock_Price:  102.70414636871922
curr_Factors:  [102.70414637  -0.57147023  -0.97700801]
mat_Sqrt:  [[21.83194461  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00438675 -0.00371513  0.17553196]
Stock Position:  0.004386748075541396
Bond Position:  [11.21434264]


portfolio before change:  [11.66512692]
curr_Stock_Price:  102.44089563528098
curr_Factors:  [102.44089564  -0.52661736  -0.94038553]
mat_Sqrt:  [[23.62447167  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00695193  0.0223431   0.21661679]
Stock Position:  -0.006951934727986568
Bond Position:  [12.37728934]


portfolio before change:  [11.669335]
curr_Stock_Price:  102.05815075796673
curr_Factors:  [102.05815076  -0.49487882  -0.94283234]
mat_Sqrt:  [[24.23581723  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00176948  0.02328151  0.08378082]
Stock Position:  -0.001769480748071781
Bond Position:  [11.84992493]


portfolio before change:  [11.67009924]
curr_Stock_Price:  102.46340811700958
curr_Factors:  [102.46340812  -0.43165861  -0.93532295]
mat_Sqrt:  [[26.11537398  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00111644 -0.02971105 -0.39042288]
Stock Position:  0.0011164371715831833
Bond Position:  [11.55570528]


portfolio before change:  [11.66939583]
curr_Stock_Price:  100.53946724152848
curr_Factors:  [100.53946724  -0.22344818  -0.92525649]
mat_Sqrt:  [[31.87575493  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00048825 -0.00364813 -0.34787826]
Stock Position:  -0.00048825174012026
Bond Position:  [11.7184844]


portfolio before change:  [11.67012042]
curr_Stock_Price:  102.05573013205132
curr_Factors:  [102.05573013  -0.41661381  -0.95293193]
mat_Sqrt:  [[25.94485413  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00056207  0.08853369  0.05999201]
Stock Position:  -0.0005620685449929444
Bond Position:  [11.72748273]


portfolio before change:  [11.67129289]
curr_Stock_Price:  102.57799419321037
curr_Factors:  [102.57799419  -0.79001312  -0.98239683]
mat_Sqrt:  [[17.43035937  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-1.96345673e-05 -3.08613573e-02 -2.18741782e-01]
Stock Position:  -1.9634567283797037e-05
Bond Position:  [11.67330697]


portfolio before change:  [11.67276624]
curr_Stock_Price:  101.86011098014308
curr_Factors:  [101.86011098  -1.02662351  -0.94395789]
mat_Sqrt:  [[14.19683435  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00864246 -0.04256268 -0.16549871]
Stock Position:  0.00864245804682147
Bond Position:  [10.79244451]


portfolio before change:  [11.67484675]
curr_Stock_Price:  101.94473604600867
curr_Factors:  [101.94473605  -1.07290362  -0.93420053]
mat_Sqrt:  [[13.69905308  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00413393 -0.02758516 -0.0356976 ]
Stock Position:  -0.0041339327655398874
Bond Position:  [12.09627944]


portfolio before change:  [11.6719659]
curr_Stock_Price:  103.00740023619878
curr_Factors:  [103.00740024  -1.11722592  -0.94999943]
mat_Sqrt:  [[13.03418444  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00977908  0.026248    0.10141302]
Stock Position:  -0.009779079014935979
Bond Position:  [12.67928341]


portfolio before change:  [11.68316154]
curr_Stock_Price:  102.02462567046821
curr_Factors:  [102.02462567  -1.44370091  -0.95559712]
mat_Sqrt:  [[ 9.26196454  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00562931 -0.05218142 -0.39574898]
Stock Position:  0.005629306422671111
Bond Position:  [11.10883366]


portfolio before change:  [11.68606838]
curr_Stock_Price:  102.29431233175966
curr_Factors:  [102.29431233  -1.52909118  -0.9836245 ]
mat_Sqrt:  [[ 8.29073307  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0218211  -0.09690957  0.15758013]
Stock Position:  -0.021821103701068618
Bond Position:  [13.91824318]


portfolio before change:  [11.68688906]
curr_Stock_Price:  102.33643691080712
curr_Factors:  [102.33643691  -1.6404281   -0.96048519]
mat_Sqrt:  [[ 7.59395466  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00499138 -0.00179413 -0.06945528]
Stock Position:  -0.0049913789440327455
Bond Position:  [12.197689]


portfolio before change:  [11.68642629]
curr_Stock_Price:  102.73463924376895
curr_Factors:  [102.73463924  -1.47206004  -0.94387392]
mat_Sqrt:  [[ 9.1725505   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00502329  0.0299266  -0.05898512]
Stock Position:  -0.00502329164533595
Bond Position:  [12.20249235]


portfolio before change:  [11.68728697]
curr_Stock_Price:  102.86696798848818
curr_Factors:  [102.86696799  -1.59861173  -0.93972841]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [11.68728697]
Stock Price:  102.63485642472305
PL:  [9.05243055]
Settle:  Tensor("sub_258:0", shape=(), dtype=float64)
PL:  Tensor("sub_259:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  130
output_Z_Vals[:, i, :]:  [[ 1.19260232e+02 -2.92559343e+01 -2.92733494e+01]
 [ 4.23340364e-03 -1.01415339e-01 -3.55284039e-02]
 [-3.01098126e-02  3.88988305e-02  8.54990537e-02]
 [-3.28363367e-02  1.23792364e-01  1.59575454e-02]
 [ 1.94645174e-01 -2.24660309e-02 -5.81886921e-02]
 [ 7.32468190e-02  2.97621951e-02 -7.31796233e-02]
 [ 6.88295741e-02  1.67405568e-02 -6.29370351e-02]
 [-1.09341277e-01 -6.41215265e-02 -1.21102326e-01]
 [-4.75419676e-03 -4.05992224e-02  1.76241533e-02]
 [-7.68068549e-02  3.04384409e-01  1.32030849e-01]
 [ 5.64705989e-02  1.34202451e-01 -8.24398712e-02]
 [-5.06248450e-02  2.42267770e-02  2.72192245e-03]
 [-1.14235127e-01  4.80001396e-02 -3.98371603e-02]
 [-8.92142292e-02 -1.12286239e-01  6.96142877e-02]
 [ 2.05838563e-01  2.41670990e-01  1.48613661e-02]
 [-8.07550108e-02 -1.39775249e-01 -1.02957557e-01]
 [-6.81959564e-02 -6.52028253e-02 -5.53746113e-02]
 [-8.56401517e-02  9.73116819e-02  1.11712337e-01]
 [ 4.23861308e-02  5.91317922e-02  3.50345936e-02]
 [ 1.34365676e-01 -3.96824745e-02  2.23141904e-02]
 [-3.90764332e-02 -1.36270228e-02 -2.24326239e-02]
 [ 8.92586517e-02 -6.36670950e-02  8.65484386e-02]
 [-8.37822672e-02  1.26038190e-01  2.93324611e-01]
 [ 1.04648125e-02 -1.64059804e-02 -7.41778382e-02]
 [-1.07923858e-01  6.39644755e-02  9.15995064e-02]
 [-1.33107973e-03 -1.07420644e-01  8.87680566e-02]
 [-8.58937790e-02  5.23868657e-02 -5.15912336e-03]
 [-5.07806065e-02  7.36225950e-02  2.93687317e-02]
 [ 3.98660741e-02 -6.16245727e-02 -2.13476938e-02]
 [ 8.85556820e-03 -9.47576487e-03 -1.19500246e-01]
 [-4.87314478e-02  3.56746869e-01  1.37037038e-02]
 [ 1.97105033e-02 -1.12895567e-01 -7.31987877e-02]
 [ 7.12948396e-02 -3.54595544e-02  6.70715968e-02]
 [-4.86554154e-02 -8.41375031e-02 -3.18777164e-03]
 [-1.46281577e-01  1.11098528e-01  3.51085352e-02]
 [ 8.47165236e-02 -1.65012150e-01 -1.38726811e-01]
 [-1.58901332e-01 -2.41519696e-01  2.00501190e-02]
 [-3.83031775e-02 -1.49796067e-02  1.54115541e-03]
 [-4.63148742e-02  9.82854994e-02 -1.77420529e-02]
 [-1.78426844e-01  1.05946324e-01  1.04531109e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.26023247 -29.25593426 -29.27334937]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  8.31486419  -9.25153874 -83.50871763]
init_Out:  [2.49911038]
Stock Position:  8.31486419409362
Bond position:  [-828.98730903]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [2.06711665]
curr_Stock_Price:  99.9605088150701
curr_Factors:  [99.96050882 -0.99912873 -1.03453765]
mat_Sqrt:  [[13.08032003  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00043098 -0.03207035 -0.10135265]
Stock Position:  -0.000430978310117751
Bond Position:  [2.11019746]


portfolio before change:  [2.06751582]
curr_Stock_Price:  99.64639949946618
curr_Factors:  [99.6463995  -1.01518294 -1.03351178]
mat_Sqrt:  [[12.84472467  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00090722  0.01230089  0.243905  ]
Stock Position:  -0.0009072228584798437
Bond Position:  [2.15791731]


portfolio before change:  [2.06818653]
curr_Stock_Price:  99.20443646267009
curr_Factors:  [99.20443646 -0.89640384 -1.01860792]
mat_Sqrt:  [[14.61679147  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00180496  0.03914658  0.04552244]
Stock Position:  -0.0018049591332364285
Bond Position:  [2.24724649]


portfolio before change:  [2.06656472]
curr_Stock_Price:  100.25860783292123
curr_Factors:  [100.25860783  -1.08557162  -1.02659478]
mat_Sqrt:  [[12.12884532  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.015021   -0.00710438 -0.16599614]
Stock Position:  0.015021000047461004
Bond Position:  [0.56058017]


portfolio before change:  [2.05990746]
curr_Stock_Price:  99.81074603790528
curr_Factors:  [99.81074604 -1.09166479 -1.00326628]
mat_Sqrt:  [[12.28457959  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00480908  0.00941163 -0.2087611 ]
Stock Position:  0.004809081754788862
Bond Position:  [1.57990943]


portfolio before change:  [2.06041039]
curr_Stock_Price:  99.87425519254589
curr_Factors:  [99.87425519 -1.03310821 -1.00858262]
mat_Sqrt:  [[12.96458123  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00435146  0.00529383 -0.17954184]
Stock Position:  0.004351459098979333
Bond Position:  [1.62581165]


portfolio before change:  [2.05911376]
curr_Stock_Price:  99.52957517271446
curr_Factors:  [99.52957517 -1.10715742 -0.98240576]
mat_Sqrt:  [[12.31590665  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01101964 -0.02027701 -0.34547123]
Stock Position:  -0.011019635085349262
Bond Position:  [3.15589336]


portfolio before change:  [2.0518939]
curr_Stock_Price:  100.220557377413
curr_Factors:  [100.22055738  -0.91661436  -0.96344435]
mat_Sqrt:  [[15.29176769  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00014419 -0.0128386   0.0502768 ]
Stock Position:  -0.00014419189468113766
Bond Position:  [2.0663449]


portfolio before change:  [2.05212894]
curr_Stock_Price:  100.38192445517167
curr_Factors:  [100.38192446  -0.87561618  -0.95977721]
mat_Sqrt:  [[16.01600871  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00262219  0.0962548   0.37664726]
Stock Position:  -0.0026221888285643414
Bond Position:  [2.31534931]


portfolio before change:  [2.05337428]
curr_Stock_Price:  100.01738049832153
curr_Factors:  [100.0173805   -1.01469352  -0.95167072]
mat_Sqrt:  [[13.99891371  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00307936  0.04243854 -0.23517801]
Stock Position:  0.003079362012336645
Bond Position:  [1.74538456]


portfolio before change:  [2.0533824]
curr_Stock_Price:  99.94916306353903
curr_Factors:  [99.94916306 -0.81873579 -0.96766471]
mat_Sqrt:  [[16.7477042   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00295227  0.00766118  0.00776489]
Stock Position:  -0.002952267465082407
Bond Position:  [2.34845907]


portfolio before change:  [2.05453571]
curr_Stock_Price:  99.65795411211236
curr_Factors:  [99.65795411 -0.9166481  -0.96887722]
mat_Sqrt:  [[15.12302685  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00800947  0.01517898 -0.11364433]
Stock Position:  -0.008009474339610302
Bond Position:  [2.85274353]


portfolio before change:  [2.05379183]
curr_Stock_Price:  99.79535331714692
curr_Factors:  [99.79535332 -0.74594281 -0.97210827]
mat_Sqrt:  [[17.90483055  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00435098 -0.03550803  0.19859019]
Stock Position:  -0.004350976136818992
Bond Position:  [2.48799903]


portfolio before change:  [2.05311377]
curr_Stock_Price:  100.02267579496271
curr_Factors:  [100.02267579  -0.8337104   -0.97478768]
mat_Sqrt:  [[16.39372818  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01312161 0.07642308 0.04239534]
Stock Position:  0.013121606154234751
Bond Position:  [0.74065561]


portfolio before change:  [2.04782443]
curr_Stock_Price:  99.61251790334198
curr_Factors:  [99.6125179  -0.92658018 -0.97404292]
mat_Sqrt:  [[14.88962608  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00707742 -0.04420081 -0.29370925]
Stock Position:  -0.007077418527878612
Bond Position:  [2.75282391]


portfolio before change:  [2.05051013]
curr_Stock_Price:  99.28166644914164
curr_Factors:  [99.28166645 -0.88658161 -1.00589714]
mat_Sqrt:  [[14.961529    0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0054261  -0.02061894 -0.15796835]
Stock Position:  -0.005426101923710652
Bond Position:  [2.58922257]


portfolio before change:  [2.05141975]
curr_Stock_Price:  99.17367850041862
curr_Factors:  [99.1736785  -0.51617    -0.99288807]
mat_Sqrt:  [[21.92910119  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00275088  0.03077266  0.3186842 ]
Stock Position:  -0.0027508829007251447
Bond Position:  [2.32423493]


portfolio before change:  [2.0468611]
curr_Stock_Price:  100.93645711250878
curr_Factors:  [100.93645711  -0.65584567  -1.04085913]
mat_Sqrt:  [[18.50028946  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00276019 0.01869911 0.09994394]
Stock Position:  0.0027601899805634903
Bond Position:  [1.76825731]


portfolio before change:  [2.04450081]
curr_Stock_Price:  100.00125420882465
curr_Factors:  [100.00125421  -0.69656424  -1.02464532]
mat_Sqrt:  [[17.88519294  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00771006 -0.0125487   0.06365617]
Stock Position:  0.0077100618873966915
Bond Position:  [1.27348495]


portfolio before change:  [2.04348502]
curr_Stock_Price:  99.84885746621221
curr_Factors:  [99.84885747 -0.62511854 -1.04479128]
mat_Sqrt:  [[18.79794952  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00234107 -0.00430924 -0.06399403]
Stock Position:  -0.0023410703134217376
Bond Position:  [2.27723822]


portfolio before change:  [2.04283872]
curr_Stock_Price:  100.24652651763924
curr_Factors:  [100.24652652  -0.65013885  -1.06376395]
mat_Sqrt:  [[18.060543    0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00582936 -0.0201333   0.2468986 ]
Stock Position:  0.005829359640743543
Bond Position:  [1.45846567]


portfolio before change:  [2.05125298]
curr_Stock_Price:  101.65867873516775
curr_Factors:  [101.65867874  -0.65245864  -1.06390273]
mat_Sqrt:  [[18.26998488  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00113045  0.03985678  0.83677347]
Stock Position:  -0.0011304519336720134
Bond Position:  [2.16617323]


portfolio before change:  [2.05340329]
curr_Stock_Price:  99.99605122864737
curr_Factors:  [99.99605123 -0.50569225 -1.08783283]
mat_Sqrt:  [[20.31999991  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.000251   -0.00518803 -0.21160873]
Stock Position:  -0.0002509978324073514
Bond Position:  [2.07850209]


portfolio before change:  [2.05371617]
curr_Stock_Price:  99.78470850776904
curr_Factors:  [99.78470851 -0.55612014 -1.11193894]
mat_Sqrt:  [[18.82067247  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00465311  0.02022734  0.2613079 ]
Stock Position:  -0.00465310849852367
Bond Position:  [2.51802524]


portfolio before change:  [2.05556344]
curr_Stock_Price:  99.45536015284276
curr_Factors:  [99.45536015 -0.42886885 -1.11856424]
mat_Sqrt:  [[21.16345377  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00066223 -0.03396939  0.25323056]
Stock Position:  0.0006622281504851407
Bond Position:  [1.9897013]


portfolio before change:  [2.05659829]
curr_Stock_Price:  100.64245278803375
curr_Factors:  [100.64245279  -0.21893539  -1.15961711]
mat_Sqrt:  [[25.35615909  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00337568  0.01656618 -0.01471754]
Stock Position:  -0.0033756791512498455
Bond Position:  [2.39633492]


portfolio before change:  [2.05281304]
curr_Stock_Price:  101.85252332892625
curr_Factors:  [101.85252333  -0.45449614  -1.14691394]
mat_Sqrt:  [[20.53469382  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00208841  0.02328151  0.08378082]
Stock Position:  -0.0020884076663542504
Bond Position:  [2.26552263]


portfolio before change:  [2.05642029]
curr_Stock_Price:  100.26085966200743
curr_Factors:  [100.26085966  -0.43438264  -1.10715661]
mat_Sqrt:  [[21.46097446  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00158042 -0.0194874  -0.06089903]
Stock Position:  0.001580420070130036
Bond Position:  [1.89796602]


portfolio before change:  [2.05675728]
curr_Stock_Price:  100.32396371635292
curr_Factors:  [100.32396372  -0.38890281  -1.09666743]
mat_Sqrt:  [[22.7106584   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00069492 -0.0029965  -0.34090094]
Stock Position:  -0.0006949151496996776
Bond Position:  [2.12647392]


portfolio before change:  [2.05501701]
curr_Stock_Price:  103.2107815279607
curr_Factors:  [103.21078153  -0.52222375  -1.11291938]
mat_Sqrt:  [[20.11830678  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00182535  0.11281327  0.03909285]
Stock Position:  -0.0018253537331406632
Bond Position:  [2.2434132]


portfolio before change:  [2.05641929]
curr_Stock_Price:  102.5961995774804
curr_Factors:  [102.59619958  -0.39987895  -1.12680824]
mat_Sqrt:  [[22.2894552   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 8.31744112e-05 -3.57007129e-02 -2.08815767e-01]
Stock Position:  8.317441115884197e-05
Bond Position:  [2.04788591]


portfolio before change:  [2.05671636]
curr_Stock_Price:  103.08998336611364
curr_Factors:  [103.08998337  -0.50244309  -1.12462154]
mat_Sqrt:  [[20.25775331  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00415003 -0.0112133   0.1913366 ]
Stock Position:  0.00415002635894011
Bond Position:  [1.62889021]


portfolio before change:  [2.05910848]
curr_Stock_Price:  103.61732911807877
curr_Factors:  [103.61732912  -0.80837527  -1.11180211]
mat_Sqrt:  [[15.18832751  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00338935 -0.02660661 -0.00909383]
Stock Position:  -0.003389348663231014
Bond Position:  [2.41030374]


portfolio before change:  [2.0597101]
curr_Stock_Price:  103.52872554285685
curr_Factors:  [103.52872554  -0.81254841  -1.11962704]
mat_Sqrt:  [[14.9943531   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00908652  0.03513244  0.10015488]
Stock Position:  -0.009086522415672623
Bond Position:  [3.00042618]


portfolio before change:  [2.05457314]
curr_Stock_Price:  104.13534177733715
curr_Factors:  [104.13534178  -1.03164575  -1.14421301]
mat_Sqrt:  [[11.82046854  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00441086 -0.05218142 -0.39574898]
Stock Position:  0.0044108603894871855
Bond Position:  [1.59524669]


portfolio before change:  [2.04706035]
curr_Stock_Price:  102.38688238840486
curr_Factors:  [102.38688239  -0.7638277   -1.13650895]
mat_Sqrt:  [[15.30871005  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0105198  -0.07637523  0.05719741]
Stock Position:  -0.010519804091281752
Bond Position:  [3.1241503]


portfolio before change:  [2.05124425]
curr_Stock_Price:  102.02629052836372
curr_Factors:  [102.02629053  -0.83485158  -1.11147475]
mat_Sqrt:  [[14.56911969  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00263402 -0.00473697  0.00439649]
Stock Position:  -0.0026340206616092374
Bond Position:  [2.31998361]


portfolio before change:  [2.05189715]
curr_Stock_Price:  101.88852404715885
curr_Factors:  [101.88852405  -0.94077264  -1.11230895]
mat_Sqrt:  [[13.07625159  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0036248   0.0310806  -0.05061314]
Stock Position:  -0.0036247952681850854
Bond Position:  [2.42122219]


portfolio before change:  [2.05071103]
curr_Stock_Price:  102.29924707356335
curr_Factors:  [102.29924707  -0.98877562  -1.0955349 ]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [2.05071103]
Stock Price:  102.30897517686145
PL:  [-0.25826415]
Settle:  Tensor("sub_260:0", shape=(), dtype=float64)
PL:  Tensor("sub_261:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  131
output_Z_Vals[:, i, :]:  [[ 1.19260232e+02 -2.92559343e+01 -2.92733494e+01]
 [ 1.86211788e-02 -2.02073997e-02 -3.89519918e-02]
 [-3.56293239e-02  4.13409791e-02  1.10344248e-01]
 [ 8.54097462e-02  1.74336510e-01  3.80103024e-02]
 [ 2.19075254e-01 -2.72353682e-02 -5.29084146e-02]
 [ 7.64831955e-02  3.10075844e-02 -8.33156467e-02]
 [ 3.29560445e-02  5.14538172e-02 -3.03908638e-02]
 [-1.41185999e-01  5.65851396e-02 -8.38716871e-02]
 [-1.98915405e-01 -8.32720197e-02  1.75891240e-01]
 [-1.11785572e-02 -5.46810415e-02 -1.11543758e-01]
 [ 5.14138001e-02  6.08239268e-02 -7.26682194e-02]
 [-3.54807628e-02  7.87279374e-02 -1.64973027e-03]
 [-1.05268475e-01  3.60169765e-02 -5.01576103e-02]
 [ 8.05994947e-02  1.06388687e-01  1.98165965e-01]
 [ 3.13892379e-01  4.66635845e-01  1.30304685e-01]
 [-6.34179883e-02 -4.59379920e-02 -1.04142907e-01]
 [-8.07385826e-02 -1.40486719e-02 -8.62462094e-02]
 [-8.90034710e-03  5.46407821e-02  3.24901743e-02]
 [ 2.02963140e-02  7.33004214e-02  2.99438103e-02]
 [ 3.38459541e-01 -1.14153157e-01 -6.98113304e-02]
 [-5.19373064e-02  1.19500348e-02 -3.86060223e-02]
 [ 6.42955130e-02 -4.98489617e-02  6.24926845e-02]
 [-7.18275051e-02  9.29404687e-02  1.95908352e-01]
 [ 6.85841490e-02 -1.55409644e-02 -2.79333096e-02]
 [ 9.21229089e-02  2.90832611e-02  9.58719553e-02]
 [ 6.82949825e-02 -2.87817870e-02  6.64025230e-02]
 [-1.73351120e-01  7.32418658e-02  7.22360895e-02]
 [ 2.18471988e-02  8.47906124e-03  1.09249194e-02]
 [ 4.99457660e-02 -9.84757068e-02 -1.89624017e-01]
 [ 3.98033966e-02  1.16940131e-02 -2.40942460e-02]
 [ 2.02983021e-03  2.08102269e-01  2.33017535e-02]
 [ 1.55749410e-02 -7.80218811e-02 -8.42851009e-02]
 [ 1.78000594e-01 -1.73996034e-01 -9.99588210e-02]
 [-5.27006933e-02 -8.80874798e-02 -1.49243886e-02]
 [-1.67699991e-01  1.21440151e-01  2.92141025e-02]
 [ 8.47165236e-02 -1.65012150e-01 -1.38726811e-01]
 [-1.12604739e-01 -2.22684642e-01  2.54291459e-03]
 [-3.21419175e-02 -4.58335601e-03 -2.73797277e-02]
 [-4.70674673e-02  9.81712252e-02 -1.23768317e-02]
 [-3.37984012e-01  1.80907275e-01  2.03657951e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.26023247 -29.25593426 -29.27334937]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  8.31486419  -9.25153874 -83.50871763]
init_Out:  [2.49911038]
Stock Position:  8.31486419409362
Bond position:  [-828.98730903]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-2.39300486]
curr_Stock_Price:  99.42410540490562
curr_Factors:  [99.4241054  -0.87007966 -0.99569342]
mat_Sqrt:  [[15.38851598  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00065948 -0.00639014 -0.11111919]
Stock Position:  0.0006594777537028124
Bond Position:  [-2.45857284]


portfolio before change:  [-2.3933127]
curr_Stock_Price:  99.42335068177039
curr_Factors:  [99.42335068 -1.03860173 -0.99480706]
mat_Sqrt:  [[13.01338193  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00092505  0.01307317  0.31478143]
Stock Position:  -0.0009250461589441202
Bond Position:  [-2.30134151]


portfolio before change:  [-2.39400205]
curr_Stock_Price:  99.85755910617743
curr_Factors:  [99.85755911 -1.1054567  -1.02152847]
mat_Sqrt:  [[11.90263249  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00820574 0.05513005 0.10843281]
Stock Position:  0.008205740709690748
Bond Position:  [-3.21340728]


portfolio before change:  [-2.38685713]
curr_Stock_Price:  100.77723414081619
curr_Factors:  [100.77723414  -1.34432643  -1.04276092]
mat_Sqrt:  [[ 9.26112129  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.02241329 -0.00861258 -0.15093298]
Stock Position:  0.0224132854481875
Bond Position:  [-4.64560605]


portfolio before change:  [-2.38420581]
curr_Stock_Price:  100.92143714704855
curr_Factors:  [100.92143715  -1.56611776  -1.02293067]
mat_Sqrt:  [[ 7.57833818  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00795386  0.00980546 -0.23767635]
Stock Position:  0.00795386419458679
Bond Position:  [-3.18692121]


portfolio before change:  [-2.38543263]
curr_Stock_Price:  100.81728234957723
curr_Factors:  [100.81728235  -1.75096031  -1.02040356]
mat_Sqrt:  [[ 6.30880278  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00445109  0.01627113 -0.08669668]
Stock Position:  0.004451092889836693
Bond Position:  [-2.83417972]


portfolio before change:  [-2.38836245]
curr_Stock_Price:  100.23865416304454
curr_Factors:  [100.23865416  -1.45677898  -1.00296862]
mat_Sqrt:  [[ 8.56604629  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01831011  0.01789379 -0.23926258]
Stock Position:  -0.018310105702581497
Bond Position:  [-0.5529821]


portfolio before change:  [-2.3903466]
curr_Stock_Price:  100.34324223117618
curr_Factors:  [100.34324223  -1.61218604  -0.9883559 ]
mat_Sqrt:  [[ 7.4488137   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0221729  -0.02633292  0.50176875]
Stock Position:  -0.022172903859258963
Bond Position:  [-0.16544553]


portfolio before change:  [-2.40254246]
curr_Stock_Price:  100.89234396266137
curr_Factors:  [100.89234396  -1.88486071  -0.99580382]
mat_Sqrt:  [[ 5.65980545  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00624742 -0.01729166 -0.31820329]
Stock Position:  -0.006247421419204781
Bond Position:  [-1.77222547]


portfolio before change:  [-2.40401789]
curr_Stock_Price:  101.09304968744101
curr_Factors:  [101.09304969  -1.7687027   -1.00286175]
mat_Sqrt:  [[ 6.3247906   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00603197  0.01923421 -0.2073022 ]
Stock Position:  0.006031967117582386
Bond Position:  [-3.01380785]


portfolio before change:  [-2.40528443]
curr_Stock_Price:  100.94553702665479
curr_Factors:  [100.94553703  -1.78605789  -1.00341869]
mat_Sqrt:  [[ 6.20344364  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00544613  0.02489596 -0.00470622]
Stock Position:  -0.005446130877424375
Bond Position:  [-1.85552183]


portfolio before change:  [-2.40932951]
curr_Stock_Price:  101.64568985719197
curr_Factors:  [101.64568986  -1.89210436  -1.03744782]
mat_Sqrt:  [[ 5.43000991  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02110068  0.01138957 -0.1430857 ]
Stock Position:  -0.021100679732132366
Bond Position:  [-0.26453637]


portfolio before change:  [-2.40734522]
curr_Stock_Price:  101.55008339759489
curr_Factors:  [101.5500834   -1.74315518  -1.02641998]
mat_Sqrt:  [[ 6.36603576  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01944647 0.03364306 0.56531234]
Stock Position:  0.01944646587213327
Bond Position:  [-4.38213545]


portfolio before change:  [-2.39652389]
curr_Stock_Price:  102.1347206364905
curr_Factors:  [102.13472064  -1.74218276  -1.03318343]
mat_Sqrt:  [[ 6.36571487  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.05538093 0.14756321 0.371723  ]
Stock Position:  0.055380927968344144
Bond Position:  [-8.0528395]


portfolio before change:  [-2.39269844]
curr_Stock_Price:  102.22197315578838
curr_Factors:  [102.22197316  -1.84720141  -1.0400097 ]
mat_Sqrt:  [[ 5.69697621  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01507154 -0.01452687 -0.29709073]
Stock Position:  -0.015071536364635749
Bond Position:  [-0.85205625]


portfolio before change:  [-2.39558721]
curr_Stock_Price:  102.40657656278906
curr_Factors:  [102.40657656  -1.74384791  -1.03394624]
mat_Sqrt:  [[ 6.36718072  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01550235 -0.00444258 -0.24603643]
Stock Position:  -0.015502348043454437
Bond Position:  [-0.80804482]


portfolio before change:  [-2.394054]
curr_Stock_Price:  102.30115933818405
curr_Factors:  [102.30115934  -1.58963716  -1.04206677]
mat_Sqrt:  [[ 7.36115668  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00011649  0.01727893  0.09268542]
Stock Position:  -0.0001164897257025371
Bond Position:  [-2.38213697]


portfolio before change:  [-2.39436584]
curr_Stock_Price:  102.4217862835013
curr_Factors:  [102.42178628  -1.44545347  -1.05159986]
mat_Sqrt:  [[ 8.43210222  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00335636 0.02317963 0.08542136]
Stock Position:  0.0033563608075329035
Bond Position:  [-2.73813031]


portfolio before change:  [-2.39356039]
curr_Stock_Price:  102.76374457371453
curr_Factors:  [102.76374457  -1.37003381  -1.03148906]
mat_Sqrt:  [[ 9.3083304   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.03451338 -0.0360984  -0.19915229]
Stock Position:  0.034513379649638375
Bond Position:  [-5.94028453]


portfolio before change:  [-2.41402916]
curr_Stock_Price:  102.19219282155943
curr_Factors:  [102.19219282  -1.36576802  -1.03169859]
mat_Sqrt:  [[ 9.29418262  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00640284  0.00377893 -0.11013224]
Stock Position:  -0.006402841607071139
Bond Position:  [-1.75970873]


portfolio before change:  [-2.41013366]
curr_Stock_Price:  101.54943447558276
curr_Factors:  [101.54943448  -1.11851916  -1.02883278]
mat_Sqrt:  [[11.86026544  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00638811 -0.01576363  0.17827423]
Stock Position:  0.00638811032720306
Bond Position:  [-3.05884265]


portfolio before change:  [-2.40370295]
curr_Stock_Price:  102.61596044174802
curr_Factors:  [102.61596044  -1.12750775  -1.04746091]
mat_Sqrt:  [[11.65837519  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00252507  0.02939036  0.558872  ]
Stock Position:  -0.0025250660719677333
Bond Position:  [-2.14459087]


portfolio before change:  [-2.40366933]
curr_Stock_Price:  102.49647575084924
curr_Factors:  [102.49647575  -1.11665131  -1.02929982]
mat_Sqrt:  [[11.98765399  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00521211 -0.00491448 -0.07968596]
Stock Position:  0.005212114077795735
Bond Position:  [-2.93789266]


portfolio before change:  [-2.40158299]
curr_Stock_Price:  102.96722544801308
curr_Factors:  [102.96722545  -1.30367907  -1.04540314]
mat_Sqrt:  [[ 9.82891477  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01144008 0.00919693 0.273496  ]
Stock Position:  0.01144008459339837
Bond Position:  [-3.57953676]


portfolio before change:  [-2.40798035]
curr_Stock_Price:  102.44713465730676
curr_Factors:  [102.44713466  -1.32372906  -1.05324685]
mat_Sqrt:  [[ 9.51025784  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00852829 -0.0091016   0.18942792]
Stock Position:  0.008528285935942887
Bond Position:  [-3.2816788]


portfolio before change:  [-2.4080934]
curr_Stock_Price:  102.48198169113576
curr_Factors:  [102.48198169  -1.4065448   -1.02620279]
mat_Sqrt:  [[ 8.99743386  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01741773  0.02316111  0.20606946]
Stock Position:  -0.017417732104586203
Bond Position:  [-0.62308969]


portfolio before change:  [-2.41962146]
curr_Stock_Price:  103.13936784730087
curr_Factors:  [103.13936785  -1.43573205  -1.03775914]
mat_Sqrt:  [[ 8.69362478  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00279471 0.00268131 0.03116575]
Stock Position:  0.002794710797966987
Bond Position:  [-2.70786617]


portfolio before change:  [-2.42102292]
curr_Stock_Price:  102.75902471498028
curr_Factors:  [102.75902471  -1.20595412  -1.01525729]
mat_Sqrt:  [[11.1470543   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00078014 -0.03114075 -0.54094454]
Stock Position:  0.0007801427773877583
Bond Position:  [-2.50118963]


portfolio before change:  [-2.4213953]
curr_Stock_Price:  102.68247377697865
curr_Factors:  [102.68247378  -1.18374401  -1.04209166]
mat_Sqrt:  [[11.08736062  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00317362  0.00369797 -0.06873418]
Stock Position:  0.0031736243223112774
Bond Position:  [-2.7472709]


portfolio before change:  [-2.42074225]
curr_Stock_Price:  102.99646397236003
curr_Factors:  [102.99646397  -1.26214398  -1.05068989]
mat_Sqrt:  [[10.19462667  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00119273 0.06580772 0.06647342]
Stock Position:  0.0011927320738969313
Bond Position:  [-2.54358943]


portfolio before change:  [-2.4219494]
curr_Stock_Price:  102.25095913967232
curr_Factors:  [102.25095914  -1.2025619   -1.05559629]
mat_Sqrt:  [[10.68960727  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00034091 -0.02467269 -0.24044193]
Stock Position:  -0.000340910515711518
Bond Position:  [-2.38709098]


portfolio before change:  [-2.42197077]
curr_Stock_Price:  101.43832241753174
curr_Factors:  [101.43832242  -1.02764323  -1.06785159]
mat_Sqrt:  [[12.47786328  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01227005 -0.05502238 -0.28515469]
Stock Position:  0.012270051655576583
Bond Position:  [-3.66662423]


portfolio before change:  [-2.4233794]
curr_Stock_Price:  101.36087578682746
curr_Factors:  [101.36087579  -1.00858119  -1.06420039]
mat_Sqrt:  [[12.75477349  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00454901 -0.02785571 -0.04257513]
Stock Position:  -0.004549005148885285
Bond Position:  [-1.96228826]


portfolio before change:  [-2.42136266]
curr_Stock_Price:  100.86361450552043
curr_Factors:  [100.86361451  -0.87586272  -1.0404369 ]
mat_Sqrt:  [[14.84212813  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01068587  0.03840275  0.0833397 ]
Stock Position:  -0.01068587435637665
Bond Position:  [-1.34354675]


portfolio before change:  [-2.42076252]
curr_Stock_Price:  100.79173471335926
curr_Factors:  [100.79173471  -0.93407023  -0.99073625]
mat_Sqrt:  [[14.70591623  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00354541 -0.05218142 -0.39574898]
Stock Position:  0.003545405512761034
Bond Position:  [-2.77811009]


portfolio before change:  [-2.42071635]
curr_Stock_Price:  100.90271000835409
curr_Factors:  [100.90271001  -0.97193945  -0.97658117]
mat_Sqrt:  [[14.37709281  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00819605 -0.07041907  0.00725423]
Stock Position:  -0.008196049306267848
Bond Position:  [-1.59371276]


portfolio before change:  [-2.42275738]
curr_Stock_Price:  101.12742827441812
curr_Factors:  [101.12742827  -0.93018927  -0.99621193]
mat_Sqrt:  [[14.73138406  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00256928 -0.00144938 -0.07810674]
Stock Position:  -0.002569284910794933
Bond Position:  [-2.1629322]


portfolio before change:  [-2.42369161]
curr_Stock_Price:  101.38580744257587
curr_Factors:  [101.38580744  -0.85386348  -1.00084334]
mat_Sqrt:  [[15.86675913  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00296589  0.03104447 -0.03530766]
Stock Position:  -0.0029658928407527967
Bond Position:  [-2.12299217]


portfolio before change:  [-2.42452241]
curr_Stock_Price:  101.57644298629302
curr_Factors:  [101.57644299  -0.86721785  -0.98633958]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-2.42452241]
Stock Price:  101.72018072130756
PL:  [-4.14470313]
Settle:  Tensor("sub_262:0", shape=(), dtype=float64)
PL:  Tensor("sub_263:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  132
output_Z_Vals[:, i, :]:  [[ 1.19260232e+02 -2.92559343e+01 -2.92733494e+01]
 [ 2.46549715e-02 -8.09376804e-03 -4.80847698e-02]
 [-3.42029919e-02 -4.09551311e-02 -3.52146643e-02]
 [ 8.85063769e-02  2.02494265e-01  3.83864877e-02]
 [ 2.11880366e-01 -2.84245707e-02 -5.55446197e-02]
 [ 7.71028869e-02  2.98193558e-02 -8.01517773e-02]
 [ 6.48676704e-02  2.00651690e-02 -5.60311317e-02]
 [-1.33377415e-01  9.43531237e-03 -1.00878678e-01]
 [-1.42614327e-01 -7.35312051e-02  1.38689496e-01]
 [-1.85611044e-02 -9.65950657e-02 -1.33379289e-01]
 [ 5.50050529e-02  1.21476592e-01 -8.00231234e-02]
 [-3.26202471e-02  7.05089205e-02 -5.54668093e-03]
 [-1.07579044e-01  3.80321299e-02 -4.70591674e-02]
 [-9.62623594e-02 -1.14884369e-01  6.32126881e-02]
 [ 3.15659578e-01  4.13709555e-01  6.78585311e-02]
 [-6.49520294e-02 -7.06582966e-02 -1.02461102e-01]
 [-6.93770527e-02 -6.10603228e-02 -7.02288099e-02]
 [-7.45373601e-02  2.08274734e-01  1.35491076e-01]
 [ 1.18691157e-01  6.95111198e-02  1.37995162e-01]
 [ 4.32580198e-02 -2.95652008e-02  7.52498936e-02]
 [ 2.40238370e-03 -4.45154279e-02  8.14568616e-03]
 [ 1.21132695e-01 -6.54937796e-02  1.60570424e-01]
 [-3.43813055e-02 -4.93004821e-02  2.27830433e-01]
 [-6.55092496e-02 -6.39215715e-04 -8.29079194e-02]
 [-2.51248275e-01  1.01496633e-01  5.79730722e-02]
 [-5.13950597e-02 -1.63015354e-01  1.04741768e-01]
 [ 2.15224928e-01  4.23560829e-02 -1.21475506e-01]
 [-4.01017238e-02  6.52553321e-02  2.62183502e-02]
 [-1.07463098e-01 -1.18424913e-01 -1.47933885e-01]
 [ 3.19452762e-02  1.74413311e-02 -1.15833851e-01]
 [ 4.72096510e-02  5.24552396e-03  2.93506812e-02]
 [ 5.80190959e-02 -9.99599332e-02 -8.21845926e-02]
 [ 2.81937408e-01 -2.25191683e-01 -1.26590365e-01]
 [-4.35330176e-02 -7.91374400e-02  1.02958632e-02]
 [-1.78818254e-01  7.74486711e-02  2.16447365e-02]
 [ 7.01042349e-02 -1.52915766e-01 -1.31989710e-01]
 [-1.10870100e-01 -2.35109401e-01  7.39336832e-03]
 [-3.04380516e-02 -1.70832433e-03 -3.53776547e-02]
 [-4.79836940e-02  9.73557694e-02 -3.88984572e-03]
 [-5.61167194e-01  2.85581262e-01  3.42564553e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.26023247 -29.25593426 -29.27334937]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  8.31486419  -9.25153874 -83.50871763]
init_Out:  [2.49911038]
Stock Position:  8.31486419409362
Bond position:  [-828.98730903]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [2.96076672]
curr_Stock_Price:  100.06798502198141
curr_Factors:  [100.06798502  -1.27993215  -1.00626418]
mat_Sqrt:  [[10.17214876  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00143831 -0.00255947 -0.13717246]
Stock Position:  0.0014383125066218588
Bond Position:  [2.81683768]


portfolio before change:  [2.96208713]
curr_Stock_Price:  100.74119615907163
curr_Factors:  [100.74119616  -1.31941006  -1.00214916]
mat_Sqrt:  [[ 9.88477401  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00429434 -0.01295115 -0.10045764]
Stock Position:  -0.0042943432047225435
Bond Position:  [3.3947044]


portfolio before change:  [2.96282038]
curr_Stock_Price:  100.66926684187415
curr_Factors:  [100.66926684  -1.45300227  -0.99522262]
mat_Sqrt:  [[ 8.70254644  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01167134 0.06403431 0.10950596]
Stock Position:  0.011671338502818273
Bond Position:  [1.78787529]


portfolio before change:  [2.9581475]
curr_Stock_Price:  100.24974480406719
curr_Factors:  [100.2497448   -1.33675287  -0.98955034]
mat_Sqrt:  [[ 9.78999854  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.02040945 -0.00898864 -0.15845334]
Stock Position:  0.020409446254941527
Bond Position:  [0.91210572]


portfolio before change:  [2.96184187]
curr_Stock_Price:  100.42517104426372
curr_Factors:  [100.42517104  -1.35501085  -1.01220021]
mat_Sqrt:  [[ 9.41403652  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00653406  0.00942971 -0.22865071]
Stock Position:  0.006534062849543711
Bond Position:  [2.30565749]


portfolio before change:  [2.96045205]
curr_Stock_Price:  100.16835631375828
curr_Factors:  [100.16835631  -1.248756    -1.00837103]
mat_Sqrt:  [[10.48268981  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00514643  0.00634516 -0.15984122]
Stock Position:  0.005146431403343042
Bond Position:  [2.44494248]


portfolio before change:  [2.95950042]
curr_Stock_Price:  99.92405696748477
curr_Factors:  [99.92405697 -1.15715329 -1.04558699]
mat_Sqrt:  [[11.04160257  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0139224   0.00298371 -0.28777879]
Stock Position:  -0.013922396564256437
Bond Position:  [4.35068277]


portfolio before change:  [2.95630056]
curr_Stock_Price:  100.19295668632765
curr_Factors:  [100.19295669  -1.3148277   -1.05504229]
mat_Sqrt:  [[ 9.36732818  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01240514 -0.02325261  0.39564253]
Stock Position:  -0.012405140225405165
Bond Position:  [4.19920824]


portfolio before change:  [2.95785317]
curr_Stock_Price:  100.11011410476722
curr_Factors:  [100.1101141   -1.3838399   -1.05917929]
mat_Sqrt:  [[ 8.69937806  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00554995 -0.03054604 -0.38049399]
Stock Position:  -0.005549949817827348
Bond Position:  [3.51345928]


portfolio before change:  [2.95747218]
curr_Stock_Price:  100.25789895607905
curr_Factors:  [100.25789896  -1.45131981  -1.05035277]
mat_Sqrt:  [[ 8.21591621  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00508853  0.03841427 -0.2282837 ]
Stock Position:  0.0050885272329683285
Bond Position:  [2.44730713]


portfolio before change:  [2.95794551]
curr_Stock_Price:  100.29079516393341
curr_Factors:  [100.29079516  -1.39199405  -1.03712652]
mat_Sqrt:  [[ 8.83705209  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00361341  0.02229688 -0.01582314]
Stock Position:  -0.0036134138177448356
Bond Position:  [3.32033765]


portfolio before change:  [2.96007799]
curr_Stock_Price:  99.81550539691814
curr_Factors:  [99.8155054  -1.00930504 -1.03839117]
mat_Sqrt:  [[12.87937667  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00902241  0.01202682 -0.13424671]
Stock Position:  -0.009022406420829321
Bond Position:  [3.86065405]


portfolio before change:  [2.96585132]
curr_Stock_Price:  99.22910757299537
curr_Factors:  [99.22910757 -1.06366079 -1.03454592]
mat_Sqrt:  [[12.17305234  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00709152 -0.03632963  0.1803282 ]
Stock Position:  -0.0070915184377966164
Bond Position:  [3.66953637]


portfolio before change:  [2.96205638]
curr_Stock_Price:  99.82893170697928
curr_Factors:  [99.82893171 -1.304064   -1.00228404]
mat_Sqrt:  [[ 9.94539865  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.03420608 0.13082645 0.1935815 ]
Stock Position:  0.03420607757056865
Bond Position:  [-0.4526998]


portfolio before change:  [2.95932341]
curr_Stock_Price:  99.75068877185726
curr_Factors:  [99.75068877 -1.48708833 -0.98349516]
mat_Sqrt:  [[ 8.43247625  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01039922 -0.02234412 -0.292293  ]
Stock Position:  -0.010399223316901436
Bond Position:  [3.99665309]


portfolio before change:  [2.96246029]
curr_Stock_Price:  99.49708624290801
curr_Factors:  [99.49708624 -1.30542171 -0.98373386]
mat_Sqrt:  [[10.08422975  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00845766 -0.01930897 -0.20034325]
Stock Position:  -0.008457663238398309
Bond Position:  [3.80397314]


portfolio before change:  [2.96013808]
curr_Stock_Price:  99.82787943376333
curr_Factors:  [99.82787943 -1.41594254 -0.96257574]
mat_Sqrt:  [[ 9.25282788  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00448541  0.06586225  0.38651833]
Stock Position:  -0.004485410296282802
Bond Position:  [3.40790707]


portfolio before change:  [2.96337551]
curr_Stock_Price:  99.20108846940062
curr_Factors:  [99.20108847 -1.22232595 -0.93494358]
mat_Sqrt:  [[11.47165775  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01295838 0.02198135 0.39366179]
Stock Position:  0.012958377443812967
Bond Position:  [1.67789036]


portfolio before change:  [2.96435386]
curr_Stock_Price:  99.26040195284189
curr_Factors:  [99.26040195 -1.47021932 -0.94500241]
mat_Sqrt:  [[ 8.86867126  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00652352 -0.00934934  0.214667  ]
Stock Position:  0.006523521742555245
Bond Position:  [2.31682647]


portfolio before change:  [2.96275583]
curr_Stock_Price:  98.9710406260144
curr_Factors:  [98.97104063 -1.16580323 -0.91156848]
mat_Sqrt:  [[12.39701322  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0002352  -0.01407701  0.02323738]
Stock Position:  0.00023519629023851493
Bond Position:  [2.93947821]


portfolio before change:  [2.96305469]
curr_Stock_Price:  98.67937870243443
curr_Factors:  [98.6793787  -1.02604117 -0.94788752]
mat_Sqrt:  [[13.70755722  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01110467 -0.02071095  0.45806273]
Stock Position:  0.01110467394915144
Bond Position:  [1.86725236]


portfolio before change:  [2.95905856]
curr_Stock_Price:  98.2984987539575
curr_Factors:  [98.29849875 -0.98558769 -0.94057254]
mat_Sqrt:  [[14.3227406   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00075764 -0.01559018  0.64993681]
Stock Position:  0.0007576380960822424
Bond Position:  [2.88458387]


portfolio before change:  [2.96005888]
curr_Stock_Price:  99.14286178965233
curr_Factors:  [99.14286179 -0.87548022 -0.9530838 ]
mat_Sqrt:  [[15.92671434  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-5.17679042e-03 -2.02137757e-04 -2.36513217e-01]
Stock Position:  -0.005176790424161559
Bond Position:  [3.4733007]


portfolio before change:  [2.96060698]
curr_Stock_Price:  99.1208579901796
curr_Factors:  [99.12085799 -0.94003933 -0.93599691]
mat_Sqrt:  [[15.1849324   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01559401  0.03209605  0.16538104]
Stock Position:  -0.015594006807905956
Bond Position:  [4.50629831]


portfolio before change:  [2.97286603]
curr_Stock_Price:  98.37084334481851
curr_Factors:  [98.37084334 -1.27551911 -0.91756244]
mat_Sqrt:  [[10.97547129  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00311821 -0.05154998  0.29879911]
Stock Position:  -0.003118205436819317
Bond Position:  [3.27960653]


portfolio before change:  [2.9724826]
curr_Stock_Price:  98.62528914600337
curr_Factors:  [98.62528915 -0.97612809 -0.91539417]
mat_Sqrt:  [[14.87683723  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01287387  0.01339417 -0.34653581]
Stock Position:  0.012873870363444069
Bond Position:  [1.70279341]


portfolio before change:  [2.96377921]
curr_Stock_Price:  97.93270444164212
curr_Factors:  [97.93270444 -0.8916195  -0.90159844]
mat_Sqrt:  [[16.29832943  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00202874  0.02063555  0.07479366]
Stock Position:  -0.002028737986493041
Bond Position:  [3.16245901]


portfolio before change:  [2.96560432]
curr_Stock_Price:  97.22794508696758
curr_Factors:  [97.22794509 -0.81563296 -0.87538714]
mat_Sqrt:  [[17.9221625   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0078516  -0.03744925 -0.4220142 ]
Stock Position:  -0.007851602383822247
Bond Position:  [3.72899948]


portfolio before change:  [2.96265691]
curr_Stock_Price:  97.66270530024893
curr_Factors:  [97.6627053  -0.89715296 -0.86877402]
mat_Sqrt:  [[16.70307414  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00052392  0.00551543 -0.33044173]
Stock Position:  0.0005239229376125102
Bond Position:  [2.91148918]


portfolio before change:  [2.96281343]
curr_Stock_Price:  97.26677756189345
curr_Factors:  [97.26677756 -0.84967153 -0.88502551]
mat_Sqrt:  [[17.16307801  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00310762 0.00165878 0.08372932]
Stock Position:  0.0031076169744873577
Bond Position:  [2.66054554]


portfolio before change:  [2.96273207]
curr_Stock_Price:  97.13357319211511
curr_Factors:  [97.13357319 -0.81966092 -0.88699521]
mat_Sqrt:  [[17.62698472  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00219336 -0.03161011 -0.23444977]
Stock Position:  0.0021933576518103114
Bond Position:  [2.7496834]


portfolio before change:  [2.96189448]
curr_Stock_Price:  96.59498064526888
curr_Factors:  [96.59498065 -0.80694482 -0.88611023]
mat_Sqrt:  [[17.76929082  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01408513 -0.07121186 -0.36112708]
Stock Position:  0.014085133511187627
Bond Position:  [1.60134128]


portfolio before change:  [2.94810669]
curr_Stock_Price:  95.60187906031994
curr_Factors:  [95.60187906 -0.71907873 -0.89648104]
mat_Sqrt:  [[19.00368113  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0022877  -0.02502546  0.02937123]
Stock Position:  -0.0022876990498348787
Bond Position:  [3.16681502]


portfolio before change:  [2.94313402]
curr_Stock_Price:  97.94857887275917
curr_Factors:  [97.94857887 -0.96217042 -0.9163756 ]
mat_Sqrt:  [[14.96773105  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01151813  0.02449142  0.06174641]
Stock Position:  -0.01151813349224116
Bond Position:  [4.07131883]


portfolio before change:  [2.92347364]
curr_Stock_Price:  99.69967203785934
curr_Factors:  [99.69967204 -1.04878871 -0.93717426]
mat_Sqrt:  [[13.68361893  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00286574 -0.04835621 -0.3765299 ]
Stock Position:  0.0028657389834134024
Bond Position:  [2.63776041]


portfolio before change:  [2.92657415]
curr_Stock_Price:  100.66653048206207
curr_Factors:  [100.66653048  -1.19249133  -0.91528105]
mat_Sqrt:  [[12.23182302  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00943698 -0.07434812  0.02109122]
Stock Position:  -0.009436977112447849
Bond Position:  [3.87656189]


portfolio before change:  [2.92403953]
curr_Stock_Price:  100.98646535618143
curr_Factors:  [100.98646536  -0.95639084  -0.90928791]
mat_Sqrt:  [[15.63180708  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00241198 -0.00054022 -0.1009226 ]
Stock Position:  -0.0024119792211579434
Bond Position:  [3.16761679]


portfolio before change:  [2.92495671]
curr_Stock_Price:  100.77037476904259
curr_Factors:  [100.77037477  -0.86228959  -0.93055247]
mat_Sqrt:  [[16.77689012  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0027576   0.0307866  -0.01109665]
Stock Position:  -0.0027576022679899385
Bond Position:  [3.20284133]


portfolio before change:  [2.92627471]
curr_Stock_Price:  100.43761726813666
curr_Factors:  [100.43761727  -0.76916943  -0.91195883]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [2.92627471]
Stock Price:  100.13106139715815
PL:  [2.79521331]
Settle:  Tensor("sub_264:0", shape=(), dtype=float64)
PL:  Tensor("sub_265:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  133
output_Z_Vals[:, i, :]:  [[ 1.19260232e+02 -2.92559343e+01 -2.92733494e+01]
 [ 1.41216763e-02 -4.74111664e-02 -3.73707586e-02]
 [-2.73976749e-02  5.13000086e-02  1.02618147e-01]
 [-2.53035480e-03  1.34786650e-01  2.16242812e-02]
 [ 2.92888589e-02  3.32928989e-02 -7.10139598e-02]
 [ 3.46290090e-02  2.88057686e-02  6.34155587e-02]
 [ 7.18610073e-02  2.75146036e-02 -4.17799925e-02]
 [-9.69717870e-02 -1.92297356e-02 -1.04730302e-01]
 [-5.58612019e-02 -7.00216038e-02  5.40628071e-02]
 [-1.01371810e-01 -1.42373606e-01 -1.24448247e-01]
 [ 6.60916778e-02  1.30907161e-01 -9.20460162e-02]
 [-1.73049831e-01 -1.06691039e-01  3.62897527e-02]
 [-1.14314630e-01  4.88334382e-02 -3.33018257e-02]
 [-9.62623594e-02 -1.14884369e-01  6.32126881e-02]
 [ 3.71965887e-01  4.69497482e-01  5.81396601e-02]
 [-4.36259204e-02 -3.42716598e-01 -4.96786451e-02]
 [-6.84396859e-02 -5.94840861e-02 -5.98254811e-02]
 [-7.00797968e-02  2.51033416e-01  1.44351722e-01]
 [ 1.29205490e-01  6.89739629e-02  1.50270859e-01]
 [-3.18214358e-02 -1.39975740e-02  1.03961779e-01]
 [ 1.57550173e-02 -5.68785712e-02  2.34500114e-02]
 [ 1.20811148e-01 -6.52167820e-02  1.60421308e-01]
 [-4.21895209e-02 -2.34502065e-02  2.54467247e-01]
 [-6.50068118e-02 -6.51171844e-04 -8.30543160e-02]
 [-3.13546172e-01  1.12405145e-01  6.40539475e-02]
 [-3.07897698e-02 -1.40186404e-01  9.81733117e-02]
 [ 1.70037071e-01  4.48949772e-02 -1.06227726e-01]
 [ 3.78459152e-02 -9.20798644e-02 -4.05909566e-02]
 [-7.28087466e-02 -6.77348537e-02 -2.10250982e-01]
 [ 7.21706621e-03 -5.09686533e-03 -1.14302753e-01]
 [ 3.64253814e-02  1.64059903e-02  2.31230218e-02]
 [ 3.31453317e-02 -7.11843693e-02 -8.84432152e-02]
 [ 2.30002842e-01 -2.21741323e-01 -1.49878266e-01]
 [-4.68674535e-02 -8.23927181e-02  1.12283870e-03]
 [-1.81894379e-01  1.03223017e-01  2.30172564e-02]
 [ 1.10435309e-01 -1.40872445e-01 -1.14951682e-01]
 [-7.76895903e-02 -1.87459447e-01 -2.10171342e-02]
 [-3.20314305e-02 -4.39692476e-03 -2.78983527e-02]
 [-4.80239919e-02  9.18426861e-02 -3.96296947e-04]
 [-6.66836870e-01  3.34341838e-01  4.09454807e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.26023247 -29.25593426 -29.27334937]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  8.31486419  -9.25153874 -83.50871763]
init_Out:  [2.49911038]
Stock Position:  8.31486419409362
Bond position:  [-828.98730903]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [2.47104743]
curr_Stock_Price:  100.00908817483474
curr_Factors:  [100.00908817  -1.19780899  -0.99068006]
mat_Sqrt:  [[11.20961639  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00047007 -0.01499273 -0.10660837]
Stock Position:  0.0004700652418168509
Bond Position:  [2.42403663]


portfolio before change:  [2.4711801]
curr_Stock_Price:  99.64668161268239
curr_Factors:  [99.64668161 -0.99747519 -1.00334378]
mat_Sqrt:  [[13.47467202  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00038044  0.01622249  0.29274101]
Stock Position:  -0.0003804376649673866
Bond Position:  [2.50908945]


portfolio before change:  [2.47159253]
curr_Stock_Price:  99.38703857122596
curr_Factors:  [99.38703857 -0.89270833 -0.98898353]
mat_Sqrt:  [[15.13984268  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00035429 0.04262328 0.06168806]
Stock Position:  0.00035428766131668994
Bond Position:  [2.43638093]


portfolio before change:  [2.47168544]
curr_Stock_Price:  98.78960781679044
curr_Factors:  [98.78960782 -0.98271069 -0.97362894]
mat_Sqrt:  [[13.96637689  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00112075  0.01052814 -0.20258306]
Stock Position:  0.001120749792673926
Bond Position:  [2.360967]


portfolio before change:  [2.47018587]
curr_Stock_Price:  97.18826600950602
curr_Factors:  [97.18826601 -0.92799682 -0.9838272 ]
mat_Sqrt:  [[14.36544927  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00336345 0.00910918 0.18090694]
Stock Position:  0.00336344631752934
Bond Position:  [2.14329836]


portfolio before change:  [2.4722997]
curr_Stock_Price:  97.73707808321835
curr_Factors:  [97.73707808 -1.14581601 -0.97982758]
mat_Sqrt:  [[11.66551912  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00548995  0.00870088 -0.11918669]
Stock Position:  0.005489950801964136
Bond Position:  [1.93572795]


portfolio before change:  [2.47752763]
curr_Stock_Price:  98.64527333259223
curr_Factors:  [98.64527333 -1.20792365 -0.97687572]
mat_Sqrt:  [[11.09762305  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01070917 -0.00608098 -0.2987664 ]
Stock Position:  -0.01070916533310228
Bond Position:  [3.53393617]


portfolio before change:  [2.47598654]
curr_Stock_Price:  98.8304289008235
curr_Factors:  [98.8304289 -1.1460365 -0.9869324]
mat_Sqrt:  [[11.70992342  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0039824  -0.02214278  0.15422614]
Stock Position:  -0.003982402448741801
Bond Position:  [2.86956908]


portfolio before change:  [2.48064758]
curr_Stock_Price:  97.75009464756722
curr_Factors:  [97.75009465 -1.32955751 -0.97768833]
mat_Sqrt:  [[ 9.72955658  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01340768 -0.04502249 -0.35501621]
Stock Position:  -0.013407679116721862
Bond Position:  [3.79124948]


portfolio before change:  [2.47669433]
curr_Stock_Price:  98.08029282465094
curr_Factors:  [98.08029282 -1.15474421 -0.95241405]
mat_Sqrt:  [[11.92489458  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00425017  0.04139648 -0.26258166]
Stock Position:  0.004250173572362821
Bond Position:  [2.05983606]


portfolio before change:  [2.4767066]
curr_Stock_Price:  98.02259535344821
curr_Factors:  [98.02259535 -1.13118474 -0.92977941]
mat_Sqrt:  [[12.48132917  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01349191 -0.03373867  0.10352456]
Stock Position:  -0.013491909761791552
Bond Position:  [3.79921861]


portfolio before change:  [2.46875794]
curr_Stock_Price:  98.6469393328329
curr_Factors:  [98.64693933 -1.17981364 -0.94831623]
mat_Sqrt:  [[11.74487927  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01020457  0.01544249 -0.09500084]
Stock Position:  -0.01020457171044599
Bond Position:  [3.4754077]


portfolio before change:  [2.47516987]
curr_Stock_Price:  98.06117474594532
curr_Factors:  [98.06117475 -1.33358179 -0.93850415]
mat_Sqrt:  [[10.10980325  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00853878 -0.03632963  0.1803282 ]
Stock Position:  -0.008538783889431082
Bond Position:  [3.31249305]


portfolio before change:  [2.48125016]
curr_Stock_Price:  97.39758988033076
curr_Factors:  [97.39758988 -1.24988407 -0.9510748 ]
mat_Sqrt:  [[10.7816175   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.0367251  0.14846814 0.16585627]
Stock Position:  0.03672509877870225
Bond Position:  [-1.09568595]


portfolio before change:  [2.4978076]
curr_Stock_Price:  97.85216748682957
curr_Factors:  [97.85216749 -1.15839125 -0.94256775]
mat_Sqrt:  [[11.97114111  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00523053 -0.1083765  -0.14171935]
Stock Position:  -0.005230531932389539
Bond Position:  [3.00962649]


portfolio before change:  [2.4935466]
curr_Stock_Price:  98.73873689683715
curr_Factors:  [98.7387369  -1.46567101 -0.93971936]
mat_Sqrt:  [[ 8.90922245  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00922498 -0.01881052 -0.17066545]
Stock Position:  -0.009224978286718396
Bond Position:  [3.4044093]


portfolio before change:  [2.49052761]
curr_Stock_Price:  99.11213209929964
curr_Factors:  [99.1121321  -1.35315222 -0.96379262]
mat_Sqrt:  [[ 9.76990768  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00349363  0.07938374  0.41179528]
Stock Position:  -0.0034936328121202083
Bond Position:  [2.83678901]


portfolio before change:  [2.49040027]
curr_Stock_Price:  99.25008621961706
curr_Factors:  [99.25008622 -1.26105645 -0.98850564]
mat_Sqrt:  [[10.46546407  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01544703 0.02181148 0.42868093]
Stock Position:  0.015447026506671267
Bond Position:  [0.95728156]


portfolio before change:  [2.47801252]
curr_Stock_Price:  98.44038834217649
curr_Factors:  [98.44038834 -1.12824996 -0.97977407]
mat_Sqrt:  [[11.95831852  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00091666 -0.00442642  0.29657402]
Stock Position:  -0.0009166625095234296
Bond Position:  [2.56824913]


portfolio before change:  [2.4787394]
curr_Stock_Price:  97.99766073952259
curr_Factors:  [97.99766074 -0.94582734 -1.00705472]
mat_Sqrt:  [[13.90240091  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00137193 -0.01798658  0.06689636]
Stock Position:  0.0013719308348149066
Bond Position:  [2.34429339]


portfolio before change:  [2.47977468]
curr_Stock_Price:  98.5386722625321
curr_Factors:  [98.53867226 -0.7818847  -1.0306835 ]
mat_Sqrt:  [[16.08489903  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00944197 -0.02062336  0.45763734]
Stock Position:  0.009441969146208009
Bond Position:  [1.54937558]


portfolio before change:  [2.47278381]
curr_Stock_Price:  97.77775450508996
curr_Factors:  [97.77775451 -0.79505097 -0.99692444]
mat_Sqrt:  [[16.2927739   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 5.61470181e-04 -7.41560641e-03  7.25924227e-01]
Stock Position:  0.0005614701813611258
Bond Position:  [2.41788451]


portfolio before change:  [2.47380043]
curr_Stock_Price:  99.05007391762298
curr_Factors:  [99.05007392 -0.71344679 -1.03220953]
mat_Sqrt:  [[17.28724943  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-4.74205087e-03 -2.05918618e-04 -2.36930846e-01]
Stock Position:  -0.00474205087046776
Bond Position:  [2.94350092]


portfolio before change:  [2.47711551]
curr_Stock_Price:  98.42858817250983
curr_Factors:  [98.42858817 -0.92230269 -1.03047724]
mat_Sqrt:  [[13.9649604   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02130825  0.03554563  0.18272808]
Stock Position:  -0.021308254237060842
Bond Position:  [4.57445689]


portfolio before change:  [2.46781192]
curr_Stock_Price:  98.89204375842903
curr_Factors:  [98.89204376 -1.1932699  -1.06947353]
mat_Sqrt:  [[10.29116082  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00139633 -0.04433083  0.28006113]
Stock Position:  -0.0013963268231777124
Bond Position:  [2.60589753]


portfolio before change:  [2.46805147]
curr_Stock_Price:  98.95378359504642
curr_Factors:  [98.9537836  -1.43519351 -1.05734167]
mat_Sqrt:  [[ 8.18348195  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01827005  0.01419704 -0.30303814]
Stock Position:  0.018270048257647
Bond Position:  [0.66016107]


portfolio before change:  [2.48299675]
curr_Stock_Price:  99.76728720083891
curr_Factors:  [99.7672872  -1.63096314 -1.06712637]
mat_Sqrt:  [[ 6.71773359  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00404643 -0.02911821 -0.1157947 ]
Stock Position:  0.0040464285473263166
Bond Position:  [2.07929555]


portfolio before change:  [2.48296748]
curr_Stock_Price:  99.69581859661075
curr_Factors:  [99.6958186  -1.51597902 -1.05055783]
mat_Sqrt:  [[ 7.65674447  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01534268 -0.02141964 -0.59978753]
Stock Position:  -0.01534267669596356
Bond Position:  [4.01256819]


portfolio before change:  [2.48783183]
curr_Stock_Price:  99.41146519204898
curr_Factors:  [99.41146519 -1.49314214 -1.02846389]
mat_Sqrt:  [[ 7.98577172  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00203443 -0.00161177 -0.32607394]
Stock Position:  -0.002034429048808266
Bond Position:  [2.6900774]


portfolio before change:  [2.48848984]
curr_Stock_Price:  99.25332168899047
curr_Factors:  [99.25332169 -1.39279689 -1.02777391]
mat_Sqrt:  [[ 8.82072959  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00471264 0.00518803 0.06596355]
Stock Position:  0.004712642974027574
Bond Position:  [2.02074437]


portfolio before change:  [2.4889593]
curr_Stock_Price:  99.29933696476829
curr_Factors:  [99.29933696 -1.30086647 -1.02017788]
mat_Sqrt:  [[ 9.74831583  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00135962 -0.02251047 -0.25230388]
Stock Position:  0.001359615727098345
Bond Position:  [2.35395036]


portfolio before change:  [2.49022268]
curr_Stock_Price:  100.01212518949397
curr_Factors:  [100.01212519  -1.03939256  -1.03090343]
mat_Sqrt:  [[12.61637334  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01535178 -0.07012076 -0.42756097]
Stock Position:  0.015351775653714506
Bond Position:  [0.95485897]


portfolio before change:  [2.47925889]
curr_Stock_Price:  99.29017890170036
curr_Factors:  [99.2901789  -0.68133919 -1.05967317]
mat_Sqrt:  [[17.40981821  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00280104 -0.02605487  0.00320315]
Stock Position:  -0.0028010416475568864
Bond Position:  [2.75737481]


portfolio before change:  [2.48081738]
curr_Stock_Price:  98.85684144031487
curr_Factors:  [98.85684144 -0.82849174 -1.04274218]
mat_Sqrt:  [[15.21738979  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01146917  0.03264198  0.06566183]
Stock Position:  -0.011469167633050932
Bond Position:  [3.61462306]


portfolio before change:  [2.48175241]
curr_Stock_Price:  98.81471355634491
curr_Factors:  [98.81471356 -0.86171152 -1.06019395]
mat_Sqrt:  [[14.45934683  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0057633  -0.04454778 -0.32792515]
Stock Position:  0.005763302127749776
Bond Position:  [1.91225336]


portfolio before change:  [2.48896726]
curr_Stock_Price:  100.02509785479825
curr_Factors:  [100.02509785  -0.83612656  -1.06463065]
mat_Sqrt:  [[14.94929171  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00580762 -0.05927988 -0.05995603]
Stock Position:  -0.005807624775839519
Bond Position:  [3.0698755]


portfolio before change:  [2.48550557]
curr_Stock_Price:  100.68723623572043
curr_Factors:  [100.68723624  -0.80734167  -1.12047338]
mat_Sqrt:  [[14.6465379   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00258352 -0.00139043 -0.07958623]
Stock Position:  -0.0025835242582962978
Bond Position:  [2.74563349]


portfolio before change:  [2.48725833]
curr_Stock_Price:  100.14165073875077
curr_Factors:  [100.14165074  -0.56711607  -1.11853628]
mat_Sqrt:  [[18.55860082  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00246428  0.02904321 -0.00113052]
Stock Position:  -0.002464276168973801
Bond Position:  [2.73403501]


portfolio before change:  [2.48917814]
curr_Stock_Price:  99.50128417734234
curr_Factors:  [99.50128418 -0.42825937 -1.13394283]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [2.48917814]
Stock Price:  99.93413716439073
PL:  [2.48917814]
Settle:  Tensor("sub_266:0", shape=(), dtype=float64)
PL:  Tensor("sub_267:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  134
output_Z_Vals[:, i, :]:  [[ 1.19260232e+02 -2.92559343e+01 -2.92733494e+01]
 [ 5.75687809e-02 -7.66743049e-02 -1.36656654e-01]
 [-4.53101617e-02  2.32141229e-02  1.04725571e-01]
 [ 4.60491219e-04  1.21185807e-01  2.22937077e-02]
 [ 8.02562407e-02  1.64863778e-02 -6.85462258e-02]
 [ 5.98868851e-02  2.88033372e-02  2.74321613e-02]
 [ 9.27177760e-03  4.88913663e-02  1.37849620e-02]
 [-3.70701621e-02 -1.21515270e-01 -4.24897775e-02]
 [ 1.34560623e-01 -5.71999314e-02 -1.53579342e-01]
 [-6.55623228e-02 -1.23442869e-01 -1.19016626e-01]
 [ 5.88769926e-02  1.21156145e-01 -8.47578457e-02]
 [-4.57760807e-02 -2.81777957e-02 -3.57186245e-03]
 [-8.88172770e-02 -1.38527550e-02 -5.39413093e-02]
 [ 3.95776267e-02 -1.70540583e-03  1.48344223e-01]
 [ 1.26231133e-01  4.56728241e-02 -1.04811613e-01]
 [-7.08700009e-02 -8.73755417e-02 -1.18200863e-01]
 [-8.03978014e-02 -1.69974582e-02 -6.74546701e-02]
 [-2.38353890e-04 -1.61274614e-01 -4.75765951e-02]
 [ 6.72399969e-02  5.64021413e-02  6.04297396e-02]
 [ 1.85228220e-01 -5.11551843e-02  3.58536917e-03]
 [-4.27723201e-02 -4.43761311e-03 -3.96843750e-02]
 [ 9.10675969e-02 -6.36580010e-02  8.82146519e-02]
 [-2.51887411e-02 -7.66781460e-02  1.69766092e-01]
 [-8.68957649e-03 -7.38770751e-03 -8.26328536e-02]
 [-1.49239188e-01  8.73809836e-02  5.31583830e-02]
 [ 1.21616976e-02 -9.16459006e-02  8.43729717e-02]
 [-6.09481087e-02  5.56310604e-02 -2.01958125e-02]
 [ 4.66928674e-02 -8.02260149e-02 -2.94600985e-02]
 [-8.61252597e-02 -8.22194915e-02 -1.90640684e-01]
 [ 7.21706621e-03 -5.09686533e-03 -1.14302753e-01]
 [ 4.38850955e-02  1.85955146e-02  2.68635670e-02]
 [ 2.37930187e-02 -6.53686194e-02 -8.85988753e-02]
 [ 2.15301989e-01 -1.96430719e-01 -1.15682831e-01]
 [-4.60008987e-02 -8.33982671e-02 -7.95386263e-03]
 [-1.71463412e-01  1.18347484e-01  2.77298295e-02]
 [ 8.47165236e-02 -1.65012150e-01 -1.38726811e-01]
 [-4.14153606e-02 -1.56328191e-01 -4.30661556e-02]
 [-2.37428437e-02  2.06377736e-02 -6.82323015e-02]
 [-4.81876071e-02  8.92593605e-02  9.16548318e-03]
 [-6.30321960e-01  3.18234243e-01  3.85297866e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.26023247 -29.25593426 -29.27334937]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  8.31486419  -9.25153874 -83.50871763]
init_Out:  [2.49911038]
Stock Position:  8.31486419409362
Bond position:  [-828.98730903]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-6.1003844]
curr_Stock_Price:  98.9782316719813
curr_Factors:  [98.97823167 -0.90148648 -0.99676213]
mat_Sqrt:  [[14.82998772  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00186744 -0.02424654 -0.3898434 ]
Stock Position:  0.0018674416045516404
Bond Position:  [-6.28522046]


portfolio before change:  [-6.10077217]
curr_Stock_Price:  99.19131678780093
curr_Factors:  [99.19131679 -0.64211201 -1.02065206]
mat_Sqrt:  [[18.80807704  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00124062  0.00734095  0.2987529 ]
Stock Position:  -0.001240624325568502
Bond Position:  [-5.97771301]


portfolio before change:  [-6.10223391]
curr_Stock_Price:  99.76721965069518
curr_Factors:  [99.76721965 -0.68981374 -0.99662943]
mat_Sqrt:  [[18.47459422  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00044061 0.03832232 0.06359774]
Stock Position:  0.0004406147832558736
Bond Position:  [-6.14619282]


portfolio before change:  [-6.10310875]
curr_Stock_Price:  99.52548242469764
curr_Factors:  [99.52548242 -0.40499659 -0.99060919]
mat_Sqrt:  [[24.65076508  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00270539  0.00521345 -0.1955433 ]
Stock Position:  0.0027053917869542493
Bond Position:  [-6.37236417]


portfolio before change:  [-6.10827413]
curr_Stock_Price:  97.9106376297211
curr_Factors:  [97.91063763 -0.2643516  -1.00064682]
mat_Sqrt:  [[27.63427328  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00239667 0.00910841 0.07825632]
Stock Position:  0.0023966669912630543
Bond Position:  [-6.34293332]


portfolio before change:  [-6.10949522]
curr_Stock_Price:  97.73198215673345
curr_Factors:  [97.73198216 -0.48363663 -0.99884368]
mat_Sqrt:  [[22.19237025  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00060147 0.01546081 0.03932466]
Stock Position:  0.0006014675620233757
Bond Position:  [-6.16827784]


portfolio before change:  [-6.11146852]
curr_Stock_Price:  95.73317691199233
curr_Factors:  [95.73317691 -0.47972009 -1.00063953]
mat_Sqrt:  [[21.78464335  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00224382 -0.0384265  -0.12121151]
Stock Position:  -0.002243822016452968
Bond Position:  [-5.89666031]


portfolio before change:  [-6.1139767]
curr_Stock_Price:  96.52247693797092
curr_Factors:  [96.52247694 -0.31620169 -1.01252494]
mat_Sqrt:  [[25.56052762  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00398014 -0.01808821 -0.43811911]
Stock Position:  0.003980139870524682
Bond Position:  [-6.49814966]


portfolio before change:  [-6.11100034]
curr_Stock_Price:  97.47437284174227
curr_Factors:  [97.47437284 -0.23655857 -0.99502346]
mat_Sqrt:  [[28.44599755  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00327089 -0.03903606 -0.33952131]
Stock Position:  -0.003270891477865271
Bond Position:  [-5.79217225]


portfolio before change:  [-6.1205729]
curr_Stock_Price:  100.17959570011955
curr_Factors:  [100.1795957   -0.43943432  -0.98540321]
mat_Sqrt:  [[24.09795557  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0018551   0.03831294 -0.24179054]
Stock Position:  0.0018550996125076586
Bond Position:  [-6.30641603]


portfolio before change:  [-6.12209819]
curr_Stock_Price:  99.78234436103067
curr_Factors:  [99.78234436 -0.60183925 -0.95850114]
mat_Sqrt:  [[20.96073388  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00225339 -0.0089106  -0.01018953]
Stock Position:  -0.0022533911199778553
Bond Position:  [-5.89724954]


portfolio before change:  [-6.12503863]
curr_Stock_Price:  100.7600861632867
curr_Factors:  [100.76008616  -0.75464278  -0.95575722]
mat_Sqrt:  [[18.21676484  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00549964 -0.00438063 -0.15387954]
Stock Position:  -0.005499641571984391
Bond Position:  [-5.57089427]


portfolio before change:  [-6.12778266]
curr_Stock_Price:  101.1324069035825
curr_Factors:  [101.1324069   -0.58961468  -0.95873915]
mat_Sqrt:  [[21.50051277  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0032471  -0.0005393   0.42318478]
Stock Position:  0.003247096098189181
Bond Position:  [-6.45616931]


portfolio before change:  [-6.12571688]
curr_Stock_Price:  102.01715249568345
curr_Factors:  [102.0171525   -0.61351083  -0.95793746]
mat_Sqrt:  [[21.19346061  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00500229  0.01444302 -0.29899836]
Stock Position:  0.005002289225668373
Bond Position:  [-6.63603618]


portfolio before change:  [-6.12567056]
curr_Stock_Price:  102.19224877480181
curr_Factors:  [102.19224877  -0.60599249  -0.94975875]
mat_Sqrt:  [[21.5657108   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00450964 -0.02763057 -0.33719416]
Stock Position:  -0.004509643980018534
Bond Position:  [-5.6648199]


portfolio before change:  [-6.12891491]
curr_Stock_Price:  102.7546441975795
curr_Factors:  [102.7546442   -0.63650572  -0.96384873]
mat_Sqrt:  [[20.73845278  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00456185 -0.00537507 -0.1924294 ]
Stock Position:  -0.004561854338572926
Bond Position:  [-5.66016319]


portfolio before change:  [-6.12964162]
curr_Stock_Price:  102.75884236776503
curr_Factors:  [102.75884237  -0.77135203  -0.96118582]
mat_Sqrt:  [[18.17136595  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00077672 -0.05099951 -0.13572278]
Stock Position:  -0.0007767153204383439
Bond Position:  [-6.04982726]


portfolio before change:  [-6.1284889]
curr_Stock_Price:  100.30105506178528
curr_Factors:  [100.30105506  -0.60455708  -0.96328258]
mat_Sqrt:  [[20.91228016  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00387483 0.01783592 0.17238923]
Stock Position:  0.0038748267635242226
Bond Position:  [-6.51713811]


portfolio before change:  [-6.12829529]
curr_Stock_Price:  100.5612741095379
curr_Factors:  [100.56127411  -0.90419543  -0.96323089]
mat_Sqrt:  [[15.53881233  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01188246 -0.01617669  0.01022806]
Stock Position:  0.011882456374073239
Bond Position:  [-7.32321024]


portfolio before change:  [-6.12254057]
curr_Stock_Price:  101.12262076187524
curr_Factors:  [101.12262076  -1.28097414  -0.91866114]
mat_Sqrt:  [[11.20879307  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00454888 -0.0014033  -0.11320848]
Stock Position:  -0.0045488785100224315
Bond Position:  [-5.66254605]


portfolio before change:  [-6.12068233]
curr_Stock_Price:  100.55850409668695
curr_Factors:  [100.5585041   -1.28887612  -0.94109793]
mat_Sqrt:  [[10.81317864  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00993516 -0.02013043  0.25165185]
Stock Position:  0.00993516322745166
Bond Position:  [-7.11974748]


portfolio before change:  [-6.12574886]
curr_Stock_Price:  100.13812811037945
curr_Factors:  [100.13812811  -1.32728548  -0.92933194]
mat_Sqrt:  [[10.48486823  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00071387 -0.02424776  0.48429541]
Stock Position:  0.0007138664866473688
Bond Position:  [-6.19723411]


portfolio before change:  [-6.12611455]
curr_Stock_Price:  100.71108926000676
curr_Factors:  [100.71108926  -1.19204543  -0.92211567]
mat_Sqrt:  [[12.15930621  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00211753 -0.0023362  -0.23572853]
Stock Position:  -0.002117529276850029
Bond Position:  [-5.91285587]


portfolio before change:  [-6.12679783]
curr_Stock_Price:  100.6847034950524
curr_Factors:  [100.6847035   -1.34341554  -0.94841129]
mat_Sqrt:  [[10.17737442  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01337596  0.02763229  0.15164607]
Stock Position:  -0.013375955872364098
Bond Position:  [-4.78004367]


portfolio before change:  [-6.12629633]
curr_Stock_Price:  100.60253833718401
curr_Factors:  [100.60253834  -1.3540687   -0.95213545]
mat_Sqrt:  [[10.02391107  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00269535 -0.02898098  0.2406926 ]
Stock Position:  0.0026953522608314617
Bond Position:  [-6.39745561]


portfolio before change:  [-6.12799323]
curr_Stock_Price:  100.26968291753636
curr_Factors:  [100.26968292  -1.40788483  -0.91988568]
mat_Sqrt:  [[ 9.77758844  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00650817  0.01759209 -0.05761303]
Stock Position:  -0.00650816653097242
Bond Position:  [-5.47542143]


portfolio before change:  [-6.12444783]
curr_Stock_Price:  99.61975095756215
curr_Factors:  [99.61975096 -1.47804206 -0.91315183]
mat_Sqrt:  [[ 9.11723479  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00423461 -0.02536969 -0.08404146]
Stock Position:  0.004234608855190707
Bond Position:  [-6.54629851]


portfolio before change:  [-6.12623347]
curr_Stock_Price:  99.39132309755658
curr_Factors:  [99.3913231  -1.31857983 -0.91991993]
mat_Sqrt:  [[10.59693766  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01199993 -0.02600009 -0.54384481]
Stock Position:  -0.011999931359223259
Bond Position:  [-4.93354442]


portfolio before change:  [-6.12757314]
curr_Stock_Price:  99.45156803164147
curr_Factors:  [99.45156803 -1.29238982 -0.91393702]
mat_Sqrt:  [[10.95004904  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00148369 -0.00161177 -0.32607394]
Stock Position:  -0.0014836907038111066
Bond Position:  [-5.98001777]


portfolio before change:  [-6.12841818]
curr_Stock_Price:  99.51727850474366
curr_Factors:  [99.5172785  -1.35881179 -0.94883411]
mat_Sqrt:  [[ 9.90149134  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00503447 0.00588042 0.07663428]
Stock Position:  0.005034467086402087
Bond Position:  [-6.62943464]


portfolio before change:  [-6.12798566]
curr_Stock_Price:  99.76780286470152
curr_Factors:  [99.76780286 -1.20633137 -0.97694321]
mat_Sqrt:  [[11.2410351   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00035762 -0.02067137 -0.25274793]
Stock Position:  0.0003576217394989164
Bond Position:  [-6.16366479]


portfolio before change:  [-6.12865113]
curr_Stock_Price:  100.06151127325387
curr_Factors:  [100.06151127  -1.00781686  -0.9813485 ]
mat_Sqrt:  [[13.68937171  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01363222 -0.06211685 -0.33001092]
Stock Position:  0.013632218790309743
Bond Position:  [-7.49271154]


portfolio before change:  [-6.12855885]
curr_Stock_Price:  100.13698858652174
curr_Factors:  [100.13698859  -1.1730416   -1.00358568]
mat_Sqrt:  [[11.35788087  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00438267 -0.02637285 -0.02269016]
Stock Position:  -0.004382666864390289
Bond Position:  [-5.68969179]


portfolio before change:  [-6.12923153]
curr_Stock_Price:  100.1281857699775
curr_Factors:  [100.12818577  -0.9353159   -1.00992503]
mat_Sqrt:  [[14.3136023   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01137012  0.03742476  0.07910548]
Stock Position:  -0.011370119262356499
Bond Position:  [-4.99076211]


portfolio before change:  [-6.12939504]
curr_Stock_Price:  100.0876959255292
curr_Factors:  [100.08769593  -0.8218264   -0.98394962]
mat_Sqrt:  [[16.44909953  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00316968 -0.05218142 -0.39574898]
Stock Position:  0.003169683324216256
Bond Position:  [-6.44664134]


portfolio before change:  [-6.13292144]
curr_Stock_Price:  99.22939986327822
curr_Factors:  [99.22939986 -0.72862049 -0.96129991]
mat_Sqrt:  [[18.31121913  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00296226 -0.04943531 -0.12285575]
Stock Position:  -0.002962259310308943
Bond Position:  [-5.83897823]


portfolio before change:  [-6.13244822]
curr_Stock_Price:  98.82324192556845
curr_Factors:  [98.82324193 -0.90445688 -0.95815618]
mat_Sqrt:  [[15.34392695  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00242036  0.00652624 -0.19464776]
Stock Position:  -0.0024203607762972625
Bond Position:  [-5.89326032]


portfolio before change:  [-6.13544378]
curr_Stock_Price:  99.75651742026425
curr_Factors:  [99.75651742 -0.81970194 -0.9657128 ]
mat_Sqrt:  [[16.73190956  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00263043  0.02822629  0.02614657]
Stock Position:  -0.0026304256370752854
Bond Position:  [-5.87304168]


portfolio before change:  [-6.13621355]
curr_Stock_Price:  99.77004936042428
curr_Factors:  [99.77004936 -0.95798132 -0.96538407]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-6.13621355]
Stock Price:  99.67635675001274
PL:  [-6.13621355]
Settle:  Tensor("sub_268:0", shape=(), dtype=float64)
PL:  Tensor("sub_269:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  135
output_Z_Vals[:, i, :]:  [[ 1.19260232e+02 -2.92559343e+01 -2.92733494e+01]
 [ 4.59332221e-03 -1.21422544e-01 -3.87429808e-02]
 [-3.58242488e-02  1.27697216e-02  4.94293630e-02]
 [ 8.43738057e-02  1.64916673e-01  3.78844542e-02]
 [ 2.20060615e-01 -2.64594688e-02 -5.14225283e-02]
 [ 7.77743607e-02  3.14967167e-02 -1.90475853e-02]
 [ 5.22750180e-02  3.24478793e-02 -4.58900032e-02]
 [-1.42457677e-01  4.09410727e-02 -9.14251960e-02]
 [-9.93872601e-02 -6.90884890e-02  1.08005703e-01]
 [-4.37879071e-02  9.37204395e-02 -8.46906041e-03]
 [ 5.68970225e-02  9.59388949e-02 -8.11026372e-02]
 [-8.54217484e-02 -1.65245821e-02  1.16638541e-02]
 [-1.14372158e-01  4.82603727e-02 -2.75195595e-02]
 [-9.62623594e-02 -1.14884369e-01  6.32126881e-02]
 [ 2.91862933e-01  3.54259570e-01  3.11966902e-02]
 [-7.31781116e-02 -2.28036571e-01 -9.88432089e-02]
 [-6.86173457e-02 -6.77753436e-02 -5.61360882e-02]
 [-7.60781117e-02  1.86684013e-01  1.29819111e-01]
 [-6.51539574e-02  4.10583117e-02 -1.40898162e-01]
 [-4.62628424e-02 -1.67379993e-02  1.17449975e-01]
 [ 1.60980220e-01 -1.39857471e-01  7.37139746e-02]
 [ 1.13397079e-01  1.56345053e-01  3.20923465e-01]
 [-3.91005572e-02 -3.15408037e-02  2.25263317e-01]
 [-5.22613225e-02 -9.54466528e-04 -8.67680038e-02]
 [-7.39898452e-01  1.83972384e-01  5.57394076e-02]
 [-1.56623877e-01 -2.81765188e-01  1.38532328e-01]
 [ 2.79846746e-02  6.94506834e-02 -7.13094906e-03]
 [ 2.49995965e-02 -9.59490271e-03  1.51490777e-04]
 [-1.15798875e-01 -1.59266062e-01 -1.08069409e-01]
 [ 2.06876022e-01  2.88996641e-01  2.36224283e-01]
 [ 9.98143305e-02 -1.36056376e-01  8.91369140e-02]
 [ 1.29188524e-01  1.91871714e-01  1.39185017e-01]
 [ 4.69366862e-01 -4.13477624e-01 -3.37262661e-01]
 [-3.95641498e-02 -7.52627911e-02  2.12142082e-02]
 [-1.41530962e-01 -1.44123658e-01  1.24110865e-02]
 [ 2.71536554e-01  1.07207664e-01  4.87322820e-02]
 [ 2.41581469e-02  1.65203620e-02 -9.52738919e-02]
 [-1.22987996e-02  3.88574217e-02 -4.75738152e-02]
 [ 1.70876332e-01 -2.51644324e-01 -4.35579187e-02]
 [-5.21238859e-01  2.81337643e-01  2.97363698e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.26023247 -29.25593426 -29.27334937]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  8.31486419  -9.25153874 -83.50871763]
init_Out:  [2.49911038]
Stock Position:  8.31486419409362
Bond position:  [-828.98730903]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [0.56600065]
curr_Stock_Price:  99.77997477757748
curr_Factors:  [99.77997478 -1.01874122 -0.98746764]
mat_Sqrt:  [[13.42016806  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00048063 -0.03839718 -0.11052294]
Stock Position:  -0.0004806327471226604
Bond Position:  [0.61395817]


portfolio before change:  [0.56605288]
curr_Stock_Price:  99.83098402914123
curr_Factors:  [99.83098403 -0.93324926 -1.0113137 ]
mat_Sqrt:  [[14.28079514  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00177895  0.00403814  0.14100821]
Stock Position:  -0.0017789492329226188
Bond Position:  [0.74364713]


portfolio before change:  [0.56411254]
curr_Stock_Price:  100.9739617479159
curr_Factors:  [100.97396175  -1.07437939  -1.01024563]
mat_Sqrt:  [[12.55648999  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00767452 0.05215123 0.1080738 ]
Stock Position:  0.007674522722921749
Bond Position:  [-0.21081442]


portfolio before change:  [0.56314118]
curr_Stock_Price:  100.85082567173484
curr_Factors:  [100.85082567  -1.24729369  -1.01579194]
mat_Sqrt:  [[10.4914099   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0199097  -0.00836722 -0.14669416]
Stock Position:  0.019909702935209894
Bond Position:  [-1.4447688]


portfolio before change:  [0.55917972]
curr_Stock_Price:  100.66092581251327
curr_Factors:  [100.66092581  -1.21516931  -1.02979082]
mat_Sqrt:  [[10.66318941  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00700536  0.00996014 -0.05433746]
Stock Position:  0.007005364663876893
Bond Position:  [-0.14598677]


portfolio before change:  [0.55931382]
curr_Stock_Price:  100.68267349946208
curr_Factors:  [100.6826735   -1.18607825  -1.05403079]
mat_Sqrt:  [[10.71735816  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00408175  0.01026092 -0.13091141]
Stock Position:  0.004081748533312734
Bond Position:  [0.14835247]


portfolio before change:  [0.5568301]
curr_Stock_Price:  100.06963525890838
curr_Factors:  [100.06963526  -1.27581091  -1.0443216 ]
mat_Sqrt:  [[ 9.83289875  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01627828  0.0129467  -0.26081064]
Stock Position:  -0.016278279338712835
Bond Position:  [2.18579157]


portfolio before change:  [0.55934251]
curr_Stock_Price:  99.93207980317129
curr_Factors:  [99.9320798  -1.14183019 -1.06689782]
mat_Sqrt:  [[10.97656712  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0072085  -0.0218477   0.30811021]
Stock Position:  -0.007208496479921685
Bond Position:  [1.27970255]


portfolio before change:  [0.5572529]
curr_Stock_Price:  100.24415327160884
curr_Factors:  [100.24415327  -0.9589662   -1.07846799]
mat_Sqrt:  [[13.06810531  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00329786  0.02963701 -0.02415987]
Stock Position:  -0.0032978610498936266
Bond Position:  [0.88784419]


portfolio before change:  [0.55612299]
curr_Stock_Price:  100.62042540563452
curr_Factors:  [100.62042541  -1.03244226  -1.07422636]
mat_Sqrt:  [[12.23972298  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00349838  0.03033854 -0.23136325]
Stock Position:  0.0034983755529833654
Bond Position:  [0.20411496]


portfolio before change:  [0.55147608]
curr_Stock_Price:  99.28482725738648
curr_Factors:  [99.28482726 -0.96491732 -1.08036558]
mat_Sqrt:  [[12.84185633  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00649965 -0.00522553  0.03327373]
Stock Position:  -0.006499647310598642
Bond Position:  [1.19679244]


portfolio before change:  [0.55765321]
curr_Stock_Price:  98.35746667463036
curr_Factors:  [98.35746667 -0.82944611 -1.10349022]
mat_Sqrt:  [[14.23455036  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00834192  0.01526127 -0.07850564]
Stock Position:  -0.00834192049077344
Bond Position:  [1.37814338]


portfolio before change:  [0.56019318]
curr_Stock_Price:  98.07363671479706
curr_Factors:  [98.07363671 -0.84667219 -1.09055665]
mat_Sqrt:  [[14.13267869  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00610821 -0.03632963  0.1803282 ]
Stock Position:  -0.006108213949188021
Bond Position:  [1.15924793]


portfolio before change:  [0.55716466]
curr_Stock_Price:  98.59317232129712
curr_Factors:  [98.59317232 -0.8841742  -1.12198605]
mat_Sqrt:  [[13.26119054  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.02317875 0.11202671 0.08899547]
Stock Position:  0.023178754020372123
Bond Position:  [-1.72810223]


portfolio before change:  [0.56819224]
curr_Stock_Price:  99.07825507657002
curr_Factors:  [99.07825508 -0.9227686  -1.13859319]
mat_Sqrt:  [[12.61073217  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00786967 -0.0721115  -0.28197216]
Stock Position:  -0.007869668045547994
Bond Position:  [1.34790522]


portfolio before change:  [0.56614467]
curr_Stock_Price:  99.35985133767586
curr_Factors:  [99.35985134 -0.87926903 -1.12392895]
mat_Sqrt:  [[13.4039594   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00610462 -0.02143245 -0.16014063]
Stock Position:  -0.006104616266280291
Bond Position:  [1.17269844]


portfolio before change:  [0.57197259]
curr_Stock_Price:  98.42919149816994
curr_Factors:  [98.4291915  -0.78696188 -1.11479915]
mat_Sqrt:  [[14.69601532  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00304564  0.05903467  0.37033779]
Stock Position:  -0.003045637548660264
Bond Position:  [0.87175223]


portfolio before change:  [0.58004817]
curr_Stock_Price:  95.81345031400656
curr_Factors:  [95.81345031 -0.56699276 -1.0850611 ]
mat_Sqrt:  [[18.3632101   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00505655  0.01298378 -0.40194324]
Stock Position:  -0.005056553445558977
Bond Position:  [1.064534]


portfolio before change:  [0.58036883]
curr_Stock_Price:  95.7763519855079
curr_Factors:  [95.77635199 -0.49379336 -1.11440765]
mat_Sqrt:  [[19.17897826  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00118466 -0.00529302  0.33505209]
Stock Position:  -0.0011846637290274914
Bond Position:  [0.6938316]


portfolio before change:  [0.58116008]
curr_Stock_Price:  95.18165834862631
curr_Factors:  [95.18165835 -0.44100644 -1.11674636]
mat_Sqrt:  [[20.04609678  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00860097 -0.04422682  0.21028545]
Stock Position:  0.008600972029635709
Bond Position:  [-0.2374947]


portfolio before change:  [0.5811955]
curr_Stock_Price:  95.18922853358134
curr_Factors:  [95.18922853 -0.61226802 -1.12108106]
mat_Sqrt:  [[16.81914307  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01087702 0.04944065 0.91550532]
Stock Position:  0.010877017803223109
Bond Position:  [-0.45417943]


portfolio before change:  [0.57969873]
curr_Stock_Price:  95.05683991546896
curr_Factors:  [95.05683992 -0.71255839 -1.13081264]
mat_Sqrt:  [[15.04587698  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 4.03216434e-04 -9.97407791e-03  6.42613543e-01]
Stock Position:  0.00040321643411785334
Bond Position:  [0.54137025]


portfolio before change:  [0.57965943]
curr_Stock_Price:  94.79153525317653
curr_Factors:  [94.79153525 -0.8288279  -1.13586752]
mat_Sqrt:  [[13.28963886  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00526707 -0.00030183 -0.24752496]
Stock Position:  -0.005267066477714201
Bond Position:  [1.07893275]


portfolio before change:  [0.58368472]
curr_Stock_Price:  94.05290413852813
curr_Factors:  [94.05290414 -0.85485702 -1.12684974]
mat_Sqrt:  [[12.96366797  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.05583069  0.05817718  0.15900902]
Stock Position:  -0.055830691459368205
Bond Position:  [5.8347234]


portfolio before change:  [0.57235473]
curr_Stock_Price:  94.26890324444322
curr_Factors:  [94.26890324 -0.8796208  -1.11703454]
mat_Sqrt:  [[12.80065101  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01059487 -0.08910198  0.39519417]
Stock Position:  -0.010594869723696106
Bond Position:  [1.57112148]


portfolio before change:  [0.57599449]
curr_Stock_Price:  93.94390095779337
curr_Factors:  [93.94390096 -0.61073739 -1.11306134]
mat_Sqrt:  [[16.75839072  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00169004  0.02196223 -0.02034261]
Stock Position:  0.0016900360610416034
Bond Position:  [0.41722591]


portfolio before change:  [0.57672767]
curr_Stock_Price:  94.34686288070797
curr_Factors:  [94.34686288 -0.514702   -1.11011759]
mat_Sqrt:  [[18.58135072  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00133374 -0.00303417  0.00043216]
Stock Position:  0.0013337448089399513
Bond Position:  [0.45089303]


portfolio before change:  [0.576254]
curr_Stock_Price:  93.9494593282143
curr_Factors:  [93.94945933 -0.24796075 -1.08347108]
mat_Sqrt:  [[24.81194379  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00572187 -0.05036435 -0.30829194]
Stock Position:  -0.005721868620760442
Bond Position:  [1.11382046]


portfolio before change:  [0.58489209]
curr_Stock_Price:  92.46413044565578
curr_Factors:  [92.46413045 -0.49404526 -1.05615229]
mat_Sqrt:  [[19.6214478   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01338112 0.09138876 0.67388213]
Stock Position:  0.013381120775761361
Bond Position:  [-0.65238161]


portfolio before change:  [0.57728349]
curr_Stock_Price:  91.90161788335958
curr_Factors:  [91.90161788 -0.61071904 -1.05321252]
mat_Sqrt:  [[17.40551436  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00657817 -0.0430248   0.2542828 ]
Stock Position:  0.006578166205046923
Bond Position:  [-0.02726063]


portfolio before change:  [0.57334059]
curr_Stock_Price:  91.30274407128326
curr_Factors:  [91.30274407 -0.75503984 -1.02425349]
mat_Sqrt:  [[15.4080102   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01054994 0.06067516 0.39705611]
Stock Position:  0.010549944511676672
Bond Position:  [-0.38989829]


portfolio before change:  [0.56890313]
curr_Stock_Price:  90.8867499242013
curr_Factors:  [90.88674992 -0.67548791 -1.00943578]
mat_Sqrt:  [[16.85572794  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.02312849 -0.13075311 -0.9621165 ]
Stock Position:  0.023128485713509304
Bond Position:  [-1.53316976]


portfolio before change:  [0.5892193]
curr_Stock_Price:  91.77344125731545
curr_Factors:  [91.77344126 -0.87028477 -1.01419093]
mat_Sqrt:  [[13.94118269  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00266671 -0.02380018  0.06051823]
Stock Position:  -0.002666710240110689
Bond Position:  [0.83395248]


portfolio before change:  [0.58744228]
curr_Stock_Price:  92.47890867821445
curr_Factors:  [92.47890868 -0.76202196 -1.03889431]
mat_Sqrt:  [[15.27266047  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00934473 -0.0455759   0.03540538]
Stock Position:  -0.009344725307689232
Bond Position:  [1.45163228]


portfolio before change:  [0.58614859]
curr_Stock_Price:  92.63676820734797
curr_Factors:  [92.63676821 -0.71643154 -1.08339907]
mat_Sqrt:  [[15.3153488   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01855995 0.03390204 0.13901964]
Stock Position:  0.018559948127000445
Bond Position:  [-1.13318502]


portfolio before change:  [0.62936219]
curr_Stock_Price:  94.97272616737574
curr_Factors:  [94.97272617 -0.9968963  -1.11385367]
mat_Sqrt:  [[11.50566815  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00044648  0.0052242  -0.27178989]
Stock Position:  0.0004464755149174619
Bond Position:  [0.58695919]


portfolio before change:  [0.62918301]
curr_Stock_Price:  94.40706574246174
curr_Factors:  [94.40706574 -1.09270566 -1.10689502]
mat_Sqrt:  [[10.46477901  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00200735  0.0122878  -0.13571485]
Stock Position:  -0.002007349570167345
Bond Position:  [0.81869099]


portfolio before change:  [0.62964899]
curr_Stock_Price:  94.22591407093844
curr_Factors:  [94.22591407 -0.93947726 -1.08980288]
mat_Sqrt:  [[12.38412118  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01255541 -0.07957692 -0.12425862]
Stock Position:  0.012555406925641537
Bond Position:  [-0.55339571]


portfolio before change:  [0.62379956]
curr_Stock_Price:  93.76553471886395
curr_Factors:  [93.76553472 -0.84928844 -1.06260694]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [0.62379956]
Stock Price:  92.68130305598329
PL:  [0.62379956]
Settle:  Tensor("sub_270:0", shape=(), dtype=float64)
PL:  Tensor("sub_271:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  136
output_Z_Vals[:, i, :]:  [[ 1.19260232e+02 -2.92559343e+01 -2.92733494e+01]
 [-1.37964981e-01  3.77732473e-01  6.05799461e-02]
 [ 4.26460228e-02  3.71330381e-02 -1.95045674e-02]
 [ 8.61713355e-02  1.81261664e-01  3.81028219e-02]
 [ 2.27174121e-01 -2.08581025e-02 -4.06956306e-02]
 [ 2.37260131e-02  3.19771144e-02  6.64098171e-02]
 [ 2.27673204e-02  6.25560251e-02 -1.80932077e-02]
 [-1.29860023e-01  1.80721773e-01 -2.33231441e-02]
 [ 4.14778697e-02 -3.65264520e-02 -1.31516746e-02]
 [-2.83218044e-02  3.48177805e-01  1.39282963e-01]
 [ 5.80946354e-02  3.55872105e-02 -7.96376035e-02]
 [-3.01675912e-02 -4.51314059e-04 -6.93365932e-03]
 [-6.62508736e-02 -3.41768245e-02 -9.32089085e-03]
 [-4.58991489e-02 -8.06703751e-02  9.63572531e-02]
 [ 1.40724572e-01  4.94601543e-02 -1.19265869e-01]
 [-7.25775249e-02 -1.04689825e-01 -1.25479282e-01]
 [-7.28678805e-02 -5.11863130e-02 -3.30718379e-02]
 [-2.74029584e-03 -2.23953522e-01 -5.59225331e-02]
 [ 2.49143069e-02  5.34138292e-02  9.71864604e-03]
 [ 2.96080451e-01 -1.06714562e-01 -6.69291465e-02]
 [ 1.32718273e-01  2.55040177e-02  1.96618221e-01]
 [ 3.73238015e-02 -3.10431152e-02  4.17257707e-02]
 [-1.25270757e-01  2.61249713e-01  4.53580862e-01]
 [ 1.44011299e-01 -3.23967206e-02 -1.03509824e-02]
 [ 9.39853253e-02  2.14564556e-02  1.09135252e-01]
 [ 4.22961834e-02 -5.81030166e-02  7.47490601e-02]
 [-1.53451895e-01  7.04406287e-02  8.79113895e-02]
 [-5.07806065e-02  7.36225950e-02  2.93687317e-02]
 [ 4.80618452e-03 -7.41419312e-02 -1.16479482e-01]
 [ 9.45666580e-03 -1.10821993e-02 -1.21406988e-01]
 [-2.14297071e-02  2.84480453e-01  3.31787520e-03]
 [ 1.73468420e-02 -8.79096705e-02 -7.50812958e-02]
 [ 1.65524750e-01 -7.53577099e-02  5.55955429e-02]
 [-3.96379576e-02 -7.53348467e-02  2.10111633e-02]
 [-2.21893762e-01  1.66036358e-01  1.59834957e-02]
 [ 3.29118081e-01  2.07547704e-01  1.01588538e-01]
 [ 2.53580649e-02  1.58299761e-02 -1.06825909e-01]
 [-2.18748525e-03  4.65742748e-02 -4.20509764e-02]
 [ 1.40849308e-01 -1.62071910e-01 -4.47085273e-02]
 [-7.69997035e-01  3.83711257e-01  4.72273933e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.26023247 -29.25593426 -29.27334937]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  8.31486419  -9.25153874 -83.50871763]
init_Out:  [2.49911038]
Stock Position:  8.31486419409362
Bond position:  [-828.98730903]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [10.81269918]
curr_Stock_Price:  101.01230982155029
curr_Factors:  [101.01230982  -1.33458193  -1.03534369]
mat_Sqrt:  [[ 9.44340648  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01226741  0.1194495   0.17281772]
Stock Position:  -0.012267410166071425
Bond Position:  [12.05185862]


portfolio before change:  [10.81432176]
curr_Stock_Price:  101.00285388286738
curr_Factors:  [101.00285388  -1.18806936  -1.02165004]
mat_Sqrt:  [[11.08318809  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00357509  0.0117425  -0.0556411 ]
Stock Position:  0.003575094118630391
Bond Position:  [10.45322705]


portfolio before change:  [10.81919529]
curr_Stock_Price:  102.00053446398118
curr_Factors:  [102.00053446  -1.32352437  -1.00901795]
mat_Sqrt:  [[ 9.89901966  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00996353 0.05731997 0.10869675]
Stock Position:  0.009963531830660467
Bond Position:  [9.80290972]


portfolio before change:  [10.81491882]
curr_Stock_Price:  101.44832904708366
curr_Factors:  [101.44832905  -1.45751411  -0.98222138]
mat_Sqrt:  [[ 8.84466198  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.02468479 -0.00659591 -0.11609331]
Stock Position:  0.024684787996266618
Bond Position:  [8.31068832]


portfolio before change:  [10.8288452]
curr_Stock_Price:  101.97041092891523
curr_Factors:  [101.97041093  -1.08737224  -1.02916372]
mat_Sqrt:  [[12.28214674  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00310267 0.01011205 0.18944872]
Stock Position:  0.003102674688544995
Bond Position:  [10.51246418]


portfolio before change:  [10.82893898]
curr_Stock_Price:  101.5770868004948
curr_Factors:  [101.5770868   -1.14880609  -1.0297376 ]
mat_Sqrt:  [[11.49916346  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0017992   0.01978195 -0.05161489]
Stock Position:  0.001799196048458234
Bond Position:  [10.64618189]


portfolio before change:  [10.82846081]
curr_Stock_Price:  100.57162483538926
curr_Factors:  [100.57162484  -0.84563234  -1.00857883]
mat_Sqrt:  [[15.74714366  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00825258  0.05714924 -0.06653444]
Stock Position:  -0.008252583841977067
Bond Position:  [11.65843658]


portfolio before change:  [10.83541291]
curr_Stock_Price:  99.90580957304131
curr_Factors:  [99.90580957 -0.68837972 -1.00743239]
mat_Sqrt:  [[18.32773941  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00206519 -0.01155068 -0.03751807]
Stock Position:  0.0020651857594770747
Bond Position:  [10.62908885]


portfolio before change:  [10.8409391]
curr_Stock_Price:  101.93830114808388
curr_Factors:  [101.93830115  -0.59669539  -1.00376185]
mat_Sqrt:  [[20.5715796   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00044232 0.11010349 0.39733552]
Stock Position:  0.0004423152610773698
Bond Position:  [10.79585023]


portfolio before change:  [10.84218072]
curr_Stock_Price:  101.69425925960196
curr_Factors:  [101.69425926  -0.46223132  -0.97430088]
mat_Sqrt:  [[24.17789173  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00176846  0.01125366 -0.22718392]
Stock Position:  0.0017684559060391876
Bond Position:  [10.66233891]


portfolio before change:  [10.84102601]
curr_Stock_Price:  100.28761407704694
curr_Factors:  [100.28761408  -0.49201618  -0.97288494]
mat_Sqrt:  [[23.1765521   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00136321 -0.00014272 -0.0197798 ]
Stock Position:  -0.00136321275067517
Bond Position:  [10.97773936]


portfolio before change:  [10.84227908]
curr_Stock_Price:  100.37507249515313
curr_Factors:  [100.3750725   -0.36996834  -0.96329632]
mat_Sqrt:  [[26.46039904  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00260903 -0.01080766 -0.02658991]
Stock Position:  -0.002609028464035168
Bond Position:  [11.10416051]


portfolio before change:  [10.84471604]
curr_Stock_Price:  99.9730633563552
curr_Factors:  [99.97306336 -0.18867428 -0.93250859]
mat_Sqrt:  [[32.58062909  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00086902 -0.02551021  0.27488042]
Stock Position:  -0.0008690196554930363
Bond Position:  [10.9315946]


portfolio before change:  [10.84594139]
curr_Stock_Price:  100.13553436446432
curr_Factors:  [100.13553436  -0.38020435  -0.9243251 ]
mat_Sqrt:  [[27.16678716  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0043309   0.01564067 -0.34023233]
Stock Position:  0.004330898016583929
Bond Position:  [10.4122646]


portfolio before change:  [10.85727265]
curr_Stock_Price:  102.45137034117953
curr_Factors:  [102.45137034  -0.13092911  -0.93341111]
mat_Sqrt:  [[35.34115089  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00285486 -0.03310583 -0.35795747]
Stock Position:  -0.0028548576749305166
Bond Position:  [11.14975673]


portfolio before change:  [10.86177656]
curr_Stock_Price:  101.36196520164083
curr_Factors:  [101.3619652   -0.21975954  -0.934845  ]
mat_Sqrt:  [[31.94748267  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00253354 -0.01618653 -0.09434475]
Stock Position:  -0.002533541279090958
Bond Position:  [11.11858128]


portfolio before change:  [10.85834565]
curr_Stock_Price:  103.26476213297458
curr_Factors:  [103.26476213  -0.33469045  -0.92212402]
mat_Sqrt:  [[29.38492306  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00067851 -0.07082032 -0.15953142]
Stock Position:  -0.0006785074829686633
Bond Position:  [10.92841156]


portfolio before change:  [10.86014554]
curr_Stock_Price:  102.62548915824036
curr_Factors:  [102.62548916  -0.2439507   -0.90144133]
mat_Sqrt:  [[32.64508479  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.0008662  0.01689094 0.02772459]
Stock Position:  0.0008662025700056706
Bond Position:  [10.77125108]


portfolio before change:  [10.86103508]
curr_Stock_Price:  102.09795388807304
curr_Factors:  [102.09795389  -0.34769597  -0.87705267]
mat_Sqrt:  [[29.99959981  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00932223 -0.03374611 -0.19093023]
Stock Position:  0.00932223229805517
Bond Position:  [9.90925423]


portfolio before change:  [10.87007058]
curr_Stock_Price:  102.93431692802109
curr_Factors:  [102.93431693  -0.17868288  -0.8673317 ]
mat_Sqrt:  [[36.16444687  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00479784 0.00806508 0.56089706]
Stock Position:  0.0047978422174330335
Bond Position:  [10.37620797]


portfolio before change:  [10.85781949]
curr_Stock_Price:  100.11050682402673
curr_Factors:  [ 1.00110507e+02 -3.35183349e-02 -8.64011550e-01]
mat_Sqrt:  [[40.80255733  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00110384 -0.00981669  0.11903201]
Stock Position:  0.0011038403448672695
Bond Position:  [10.74731348]


portfolio before change:  [10.86069835]
curr_Stock_Price:  101.50143152069667
curr_Factors:  [ 1.01501432e+02 -7.32263608e-02 -8.60475886e-01]
mat_Sqrt:  [[39.89977383  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-6.50091736e-04  8.26144131e-02  1.29393995e+00]
Stock Position:  -0.0006500917359009653
Bond Position:  [10.92668359]


portfolio before change:  [10.86146663]
curr_Stock_Price:  102.4207532555385
curr_Factors:  [102.42075326  -0.13988087  -0.87209476]
mat_Sqrt:  [[37.22995695  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00378894 -0.01024474 -0.02952847]
Stock Position:  0.003788936269166798
Bond Position:  [10.47340092]


portfolio before change:  [10.85822032]
curr_Stock_Price:  101.2184198212593
curr_Factors:  [101.21841982  -0.102809    -0.88251726]
mat_Sqrt:  [[37.78659823  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00309148 0.00678513 0.3113325 ]
Stock Position:  0.0030914788338190324
Bond Position:  [10.54530572]


portfolio before change:  [10.85873906]
curr_Stock_Price:  100.9598047565453
curr_Factors:  [ 1.00959805e+02  3.24775656e-02 -8.93284989e-01]
mat_Sqrt:  [[42.68788008  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00131311 -0.01837379  0.21323826]
Stock Position:  0.001313114117081834
Bond Position:  [10.72616732]


portfolio before change:  [10.86417476]
curr_Stock_Price:  104.07822469898457
curr_Factors:  [ 1.04078225e+02  4.09099011e-02 -9.14052386e-01]
mat_Sqrt:  [[43.46692446  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00307563  0.02227528  0.25078672]
Stock Position:  -0.0030756325705731426
Bond Position:  [11.18428114]


portfolio before change:  [10.87503088]
curr_Stock_Price:  101.00308493054126
curr_Factors:  [ 1.01003085e+02  7.61836018e-03 -9.21890722e-01]
mat_Sqrt:  [[40.48286098  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00105933  0.02328151  0.08378082]
Stock Position:  -0.0010593325413994123
Bond Position:  [10.98202674]


portfolio before change:  [10.8773078]
curr_Stock_Price:  100.14963961574034
curr_Factors:  [ 1.00149640e+02  6.84501494e-02 -9.32303635e-01]
mat_Sqrt:  [[42.2165354   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0004947  -0.02344574 -0.33228354]
Stock Position:  -0.0004946977847620812
Bond Position:  [10.92685161]


portfolio before change:  [10.87827766]
curr_Stock_Price:  100.9503040859155
curr_Factors:  [100.95030409  -0.11107202  -0.95185816]
mat_Sqrt:  [[34.87248687  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00044768 -0.0035045  -0.34634034]
Stock Position:  -0.00044767593201433797
Bond Position:  [10.92347068]


portfolio before change:  [10.88030828]
curr_Stock_Price:  99.46462678191348
curr_Factors:  [99.46462678  0.14358521 -0.96518854]
mat_Sqrt:  [[43.73718888  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00030654  0.08996062  0.00946497]
Stock Position:  -0.00030653993229162697
Bond Position:  [10.91079816]


portfolio before change:  [10.88212984]
curr_Stock_Price:  97.97173720679133
curr_Factors:  [ 9.79717372e+01 -1.97239246e-03 -9.46122873e-01]
mat_Sqrt:  [[37.96192851  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-6.55607610e-06 -2.77994787e-02 -2.14186038e-01]
Stock Position:  -6.556076103564503e-06
Bond Position:  [10.88277215]


portfolio before change:  [10.88349895]
curr_Stock_Price:  96.64850382120945
curr_Factors:  [ 9.66485038e+01  2.29164991e-03 -9.66283302e-01]
mat_Sqrt:  [[36.85860382  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0047459  -0.0238302   0.15859861]
Stock Position:  0.004745904541051018
Bond Position:  [10.42481438]


portfolio before change:  [10.87965122]
curr_Stock_Price:  95.56316552150562
curr_Factors:  [ 9.55631655e+01  6.32909239e-02 -9.69130469e-01]
mat_Sqrt:  [[38.62686051  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0009655  -0.02382297  0.059939  ]
Stock Position:  -0.0009654993632658478
Bond Position:  [10.9719174]


portfolio before change:  [10.88042517]
curr_Stock_Price:  96.18214810390162
curr_Factors:  [ 9.61821481e+01  5.96440256e-02 -9.75852972e-01]
mat_Sqrt:  [[38.47600589  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00557085  0.05250531  0.04559646]
Stock Position:  -0.005570851212820578
Bond Position:  [11.41624161]


portfolio before change:  [10.90519746]
curr_Stock_Price:  91.99155423062624
curr_Factors:  [91.99155423  0.31060198 -0.98176027]
mat_Sqrt:  [[47.01837481  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00755478 0.06563235 0.28980382]
Stock Position:  0.007554782893295606
Bond Position:  [10.21022124]


portfolio before change:  [10.92570793]
curr_Stock_Price:  94.53750472760373
curr_Factors:  [94.53750473  0.21553349 -0.98556949]
mat_Sqrt:  [[43.77052453  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 9.04957358e-05  5.00587799e-03 -3.04744583e-01]
Stock Position:  9.049573582158584e-05
Bond Position:  [10.91715268]


portfolio before change:  [10.92727037]
curr_Stock_Price:  96.72232677848568
curr_Factors:  [96.72232678  0.34851322 -0.99249033]
mat_Sqrt:  [[50.7985166   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00018836  0.01472808 -0.11995973]
Stock Position:  -0.0001883630251141945
Bond Position:  [10.94548928]


portfolio before change:  [10.92855481]
curr_Stock_Price:  97.16740824595581
curr_Factors:  [97.16740825  0.26796478 -1.00002342]
mat_Sqrt:  [[46.72954945  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00272929 -0.05125164 -0.12754098]
Stock Position:  0.002729291010997961
Bond Position:  [10.66335667]


portfolio before change:  [10.93338575]
curr_Stock_Price:  98.44903933832857
curr_Factors:  [ 9.84490393e+01  3.00832716e-02 -9.88532001e-01]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [10.93338575]
Stock Price:  95.00590023047437
PL:  [10.93338575]
Settle:  Tensor("sub_272:0", shape=(), dtype=float64)
PL:  Tensor("sub_273:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  137
output_Z_Vals[:, i, :]:  [[ 1.19260232e+02 -2.92559343e+01 -2.92733494e+01]
 [-4.17625692e-02  6.03247538e-02 -2.64496347e-03]
 [-5.76119374e-02 -8.63801476e-02 -8.66210381e-02]
 [-1.50398161e-01 -1.54458244e-02  1.87724209e-03]
 [ 1.49664625e-01 -6.40107365e-03 -6.51856169e-02]
 [-1.81775978e-02  2.99231561e-02  1.32441257e-01]
 [ 6.09947989e-03  7.33470809e-02  4.61046352e-03]
 [ 2.46000783e-01  1.54586077e-01  1.69847606e-01]
 [ 3.95907322e-02  4.60229376e-02  1.03429743e-02]
 [-2.87295263e-02  3.78923683e-01  1.55536563e-01]
 [ 5.93291893e-02  8.34540985e-02 -8.34795324e-02]
 [-5.55465085e-02  3.69941282e-02  9.35367452e-03]
 [-7.23726701e-02 -5.12333106e-02 -6.41392925e-02]
 [ 9.47790488e-02  8.16350892e-02  1.94757806e-01]
 [ 1.48223518e-01  1.38413498e-01 -2.78983166e-02]
 [-5.82765020e-02 -5.17805622e-02 -1.12309347e-01]
 [-8.21029565e-02 -1.05963691e-02 -7.70953495e-02]
 [ 7.13796914e-03 -6.61000679e-03  2.54355375e-04]
 [ 1.43581087e-02  7.30149093e-02  2.24523517e-02]
 [ 3.29190351e-01 -8.83782803e-02 -5.67153908e-02]
 [-3.65908057e-02  1.15175600e-03  1.32329981e-02]
 [ 3.48828162e-02 -2.95357005e-02  3.38419238e-02]
 [-8.29973763e-02  1.33609835e-01  2.01766316e-01]
 [ 1.16203577e-01 -5.03901275e-02  1.68932479e-02]
 [ 9.44057280e-02  2.89533833e-02  9.66949253e-02]
 [ 8.72093249e-02 -7.26155973e-03  6.03088779e-02]
 [-1.43901538e-01  7.47391406e-02  8.01091473e-02]
 [ 2.79636691e-03  2.82217403e-02  1.62283710e-02]
 [ 3.88038301e-02 -9.11544005e-02 -1.98676983e-01]
 [ 5.00150927e-02 -1.05952705e-03  3.61550866e-02]
 [-1.49035378e-02  2.71643717e-01  1.39966732e-02]
 [ 3.68805065e-02 -1.21414813e-01 -7.02288407e-02]
 [ 1.85353841e-01 -2.13786994e-01 -1.61371343e-01]
 [-6.83947007e-02 -4.90429625e-02  3.76780983e-02]
 [-8.60196880e-02  2.88210442e-02  3.15426531e-02]
 [ 8.47165236e-02 -1.65012150e-01 -1.38726811e-01]
 [-2.42909962e-01 -4.27145361e-01  9.71746124e-02]
 [-4.77566954e-02 -3.72373229e-02  4.67305705e-02]
 [-2.94020588e-02  6.33950629e-02 -3.00241081e-02]
 [ 1.69485063e-01 -9.88059519e-03 -1.64664746e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.26023247 -29.25593426 -29.27334937]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  8.31486419  -9.25153874 -83.50871763]
init_Out:  [2.49911038]
Stock Position:  8.31486419409362
Bond position:  [-828.98730903]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [7.00941874]
curr_Stock_Price:  100.55490241842587
curr_Factors:  [100.55490242  -0.68495992  -0.98350652]
mat_Sqrt:  [[18.95821658  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00214919  0.01907636 -0.00754534]
Stock Position:  -0.0021491943339520324
Bond Position:  [7.22553077]


portfolio before change:  [7.0105856]
curr_Stock_Price:  100.43224666603128
curr_Factors:  [100.43224667  -0.57924201  -0.98130995]
mat_Sqrt:  [[21.09279228  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00367536 -0.0273158  -0.24710571]
Stock Position:  -0.003675364908864975
Bond Position:  [7.37971075]


portfolio before change:  [7.01438133]
curr_Stock_Price:  99.6504997290831
curr_Factors:  [99.65049973 -0.44427623 -0.96508593]
mat_Sqrt:  [[24.34452316  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00617855 -0.0048844   0.00535525]
Stock Position:  -0.006178546984606203
Bond Position:  [7.63007662]


portfolio before change:  [7.01222355]
curr_Stock_Price:  100.15411292824781
curr_Factors:  [100.15411293  -0.50856392  -0.93401726]
mat_Sqrt:  [[23.66811895  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0057543  -0.0020242  -0.18595642]
Stock Position:  0.005754297236715662
Bond Position:  [6.43590701]


portfolio before change:  [7.02533364]
curr_Stock_Price:  102.29261093823477
curr_Factors:  [102.29261094  -0.50621722  -0.92081081]
mat_Sqrt:  [[24.55239511  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.0003922  0.00946253 0.37781804]
Stock Position:  0.00039220097252122945
Bond Position:  [6.98521438]


portfolio before change:  [7.02593854]
curr_Stock_Price:  101.6085014902167
curr_Factors:  [101.60850149  -0.67357863  -0.92466083]
mat_Sqrt:  [[20.55055083  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00043475 0.02319438 0.01315237]
Stock Position:  0.00043475235166013287
Bond Position:  [6.981764]


portfolio before change:  [7.02734661]
curr_Stock_Price:  102.83977813864138
curr_Factors:  [102.83977814  -0.56907616  -0.92850193]
mat_Sqrt:  [[23.00229804  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01237538 0.04888441 0.48452794]
Stock Position:  0.01237537986655044
Bond Position:  [5.75466529]


portfolio before change:  [7.02836987]
curr_Stock_Price:  102.86433315662701
curr_Factors:  [102.86433316  -0.41454697  -0.94742485]
mat_Sqrt:  [[26.34923249  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00162776 0.01455373 0.02950563]
Stock Position:  0.0016277624087222724
Bond Position:  [6.86093117]


portfolio before change:  [7.02688152]
curr_Stock_Price:  101.42308122023684
curr_Factors:  [101.42308122  -0.45368217  -0.927232  ]
mat_Sqrt:  [[25.49255675  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00050223 0.11982619 0.44370252]
Stock Position:  0.000502225382271405
Bond Position:  [6.97594428]


portfolio before change:  [7.02741177]
curr_Stock_Price:  100.74250848024444
curr_Factors:  [100.74250848  -0.38985128  -0.9301945 ]
mat_Sqrt:  [[26.9106484   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00165153  0.0263905  -0.23814387]
Stock Position:  0.0016515312466741183
Bond Position:  [6.86103237]


portfolio before change:  [7.02930983]
curr_Stock_Price:  101.37245543414491
curr_Factors:  [101.37245543  -0.49864755  -0.92688694]
mat_Sqrt:  [[24.36790579  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00216194  0.01169857  0.02668343]
Stock Position:  -0.0021619425936714766
Bond Position:  [7.24847126]


portfolio before change:  [7.02967936]
curr_Stock_Price:  101.62064977557552
curr_Factors:  [101.62064978  -0.74156188  -0.93365365]
mat_Sqrt:  [[19.03027673  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00456052 -0.0162014  -0.18297155]
Stock Position:  -0.0045605162771787154
Bond Position:  [7.49312199]


portfolio before change:  [7.03039737]
curr_Stock_Price:  101.66860351247314
curr_Factors:  [101.66860351  -0.772298    -0.92139902]
mat_Sqrt:  [[18.69061477  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00731071 0.02581528 0.55558981]
Stock Position:  0.007310708074090748
Bond Position:  [6.28712789]


portfolio before change:  [7.04279836]
curr_Stock_Price:  103.25737630322588
curr_Factors:  [103.2573763   -1.05798054  -0.91161451]
mat_Sqrt:  [[14.40578158  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01014194  0.04377019 -0.07958613]
Stock Position:  0.01014194322576074
Bond Position:  [5.99556791]


portfolio before change:  [7.04466091]
curr_Stock_Price:  103.36712433793738
curr_Factors:  [103.36712434  -1.30908177  -0.9199409 ]
mat_Sqrt:  [[11.12577287  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00741868 -0.01637445 -0.32038731]
Stock Position:  -0.0074186773996520175
Bond Position:  [7.81150826]


portfolio before change:  [7.04926847]
curr_Stock_Price:  102.87767630269039
curr_Factors:  [102.8776763   -1.37070691  -0.90881889]
mat_Sqrt:  [[10.52775264  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00931952 -0.00335087 -0.21993157]
Stock Position:  -0.009319517593377727
Bond Position:  [8.00803878]


portfolio before change:  [7.0514206]
curr_Stock_Price:  102.75416577321774
curr_Factors:  [102.75416577  -1.57768785  -0.89533532]
mat_Sqrt:  [[ 8.66521056  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00081005 -0.00209027  0.00072561]
Stock Position:  0.0008100460480266356
Bond Position:  [6.96818499]


portfolio before change:  [7.05222207]
curr_Stock_Price:  102.66824422970222
curr_Factors:  [102.66824423  -1.54858241  -0.8986573 ]
mat_Sqrt:  [[ 8.88409989  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00234423 0.02308934 0.06405031]
Stock Position:  0.0023442344097918282
Bond Position:  [6.81154364]


portfolio before change:  [7.05188025]
curr_Stock_Price:  102.15919935340213
curr_Factors:  [102.15919935  -1.44324994  -0.8818914 ]
mat_Sqrt:  [[ 9.9880665   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.03157082 -0.02794767 -0.16179322]
Stock Position:  0.03157082036955163
Bond Position:  [3.82663052]


portfolio before change:  [7.06881678]
curr_Stock_Price:  102.68050889055074
curr_Factors:  [102.68050889  -1.34491859  -0.87213967]
mat_Sqrt:  [[11.18489331  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00302729  0.00036422  0.03775006]
Stock Position:  -0.00302728797489983
Bond Position:  [7.37966025]


portfolio before change:  [7.06890476]
curr_Stock_Price:  102.95617725746872
curr_Factors:  [102.95617726  -1.25621128  -0.86584924]
mat_Sqrt:  [[12.33256003  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00332682 -0.00934001  0.09654159]
Stock Position:  0.0033268162740725474
Bond Position:  [6.72638848]


portfolio before change:  [7.07086881]
curr_Stock_Price:  103.29379606286962
curr_Factors:  [103.29379606  -1.23443849  -0.89353308]
mat_Sqrt:  [[12.30007982  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00311886  0.04225114  0.57558314]
Stock Position:  -0.00311885849685721
Bond Position:  [7.39302754]


portfolio before change:  [7.07129308]
curr_Stock_Price:  103.45408344029094
curr_Factors:  [103.45408344  -1.31369196  -0.87344087]
mat_Sqrt:  [[11.61148911  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01019256 -0.01593476  0.04819173]
Stock Position:  0.010192562540218513
Bond Position:  [6.01683087]


portfolio before change:  [7.06614081]
curr_Stock_Price:  102.8747959304513
curr_Factors:  [102.87479593  -1.37307384  -0.92160074]
mat_Sqrt:  [[10.36918151  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01108005 0.00915586 0.27584371]
Stock Position:  0.011080051978805652
Bond Position:  [5.92628272]


portfolio before change:  [7.0717108]
curr_Stock_Price:  103.31063811202054
curr_Factors:  [103.31063811  -1.48557629  -0.94221146]
mat_Sqrt:  [[ 9.1152843   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01089734 -0.00229631  0.17204444]
Stock Position:  0.010897337600380344
Bond Position:  [5.9458999]


portfolio before change:  [7.07915758]
curr_Stock_Price:  103.9257881621231
curr_Factors:  [103.92578816  -1.43215199  -0.9494963 ]
mat_Sqrt:  [[ 9.60255084  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0130819   0.02363459  0.2285291 ]
Stock Position:  -0.013081895915694905
Bond Position:  [8.43870392]


portfolio before change:  [7.07521804]
curr_Stock_Price:  104.30757116091466
curr_Factors:  [104.30757116  -1.39026502  -0.93490764]
mat_Sqrt:  [[10.19779266  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.0006705  0.0089245  0.04629503]
Stock Position:  0.0006705030889191982
Bond Position:  [7.00527949]


portfolio before change:  [7.07614639]
curr_Stock_Price:  104.38607936996281
curr_Factors:  [104.38607937  -1.48613861  -0.94959205]
mat_Sqrt:  [[ 9.13730673  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-4.49206304e-04 -2.88255524e-02 -5.66770132e-01]
Stock Position:  -0.00044920630366405734
Bond Position:  [7.12303728]


portfolio before change:  [7.07707088]
curr_Stock_Price:  104.31026191831891
curr_Factors:  [104.31026192  -1.37073811  -0.93092945]
mat_Sqrt:  [[10.44060143  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00549469 -0.00033505  0.1031404 ]
Stock Position:  0.005494689399729685
Bond Position:  [6.50391839]


portfolio before change:  [7.07828208]
curr_Stock_Price:  104.38272307209053
curr_Factors:  [104.38272307  -1.40702257  -0.91147919]
mat_Sqrt:  [[10.27344503  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00048987  0.08590129  0.03992861]
Stock Position:  -0.0004898715273155784
Bond Position:  [7.1294162]


portfolio before change:  [7.07895249]
curr_Stock_Price:  104.83348689089945
curr_Factors:  [104.83348689  -1.51814592  -0.92427052]
mat_Sqrt:  [[ 9.11532271  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0021294  -0.03839473 -0.20034333]
Stock Position:  0.002129402108429224
Bond Position:  [6.85571984]


portfolio before change:  [7.07953715]
curr_Stock_Price:  104.70558192464667
curr_Factors:  [104.70558192  -1.5181236   -0.94943374]
mat_Sqrt:  [[ 8.87816679  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01654554 -0.06760538 -0.46034753]
Stock Position:  0.016545543695684804
Bond Position:  [5.34712637]


portfolio before change:  [7.09019395]
curr_Stock_Price:  105.30927108438141
curr_Factors:  [105.30927108  -1.54053204  -0.96215629]
mat_Sqrt:  [[ 8.62110382  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00718817 -0.01550875  0.10748513]
Stock Position:  -0.007188171748050254
Bond Position:  [7.84717508]


portfolio before change:  [7.09416886]
curr_Stock_Price:  104.89276019902735
curr_Factors:  [104.8927602   -1.48094263  -0.91582006]
mat_Sqrt:  [[ 9.54651151  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00825819  0.00911401  0.08998241]
Stock Position:  -0.008258190928801616
Bond Position:  [7.9603933]


portfolio before change:  [7.09166066]
curr_Stock_Price:  105.31698231306167
curr_Factors:  [105.31698231  -1.54290399  -0.92018999]
mat_Sqrt:  [[ 8.96995536  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00581256 -0.05218142 -0.39574898]
Stock Position:  0.005812563651871021
Bond Position:  [6.479499]


portfolio before change:  [7.09272158]
curr_Stock_Price:  105.36015192537198
curr_Factors:  [105.36015193  -1.60719082  -0.91490788]
mat_Sqrt:  [[ 8.45946386  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02767352 -0.13507522  0.27721212]
Stock Position:  -0.027673517717684185
Bond Position:  [10.00840761]


portfolio before change:  [7.08450394]
curr_Stock_Price:  105.7023117865225
curr_Factors:  [105.70231179  -1.32328387  -0.87893853]
mat_Sqrt:  [[11.68614981  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00335263 -0.01177548  0.13330931]
Stock Position:  -0.00335262869269976
Bond Position:  [7.43888454]


portfolio before change:  [7.0825168]
curr_Stock_Price:  106.57239360958239
curr_Factors:  [106.57239361  -1.35379979  -0.86498328]
mat_Sqrt:  [[11.58882696  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0029247   0.02004728 -0.08565042]
Stock Position:  -0.002924700733286375
Bond Position:  [7.39420915]


portfolio before change:  [7.08344058]
curr_Stock_Price:  106.57258229090245
curr_Factors:  [106.57258229  -1.37027819  -0.85915842]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [7.08344058]
Stock Price:  107.62661971056767
PL:  [-0.54317913]
Settle:  Tensor("sub_274:0", shape=(), dtype=float64)
PL:  Tensor("sub_275:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  138
output_Z_Vals[:, i, :]:  [[ 1.19260232e+02 -2.92559343e+01 -2.92733494e+01]
 [ 4.03706775e-03 -1.27034308e-01 -3.91946428e-02]
 [-4.51740030e-02 -2.99817825e-02 -9.58656181e-03]
 [-9.34536332e-02  4.30072252e-02  8.53733508e-03]
 [ 1.56705726e-02  3.77835360e-02 -7.16733288e-02]
 [ 6.43491692e-02  2.91703168e-02 -1.01419007e-02]
 [ 7.86785029e-02  8.76102071e-03 -7.95383555e-02]
 [-9.40377187e-02 -8.58131154e-03 -1.00846825e-01]
 [ 4.01081686e-02 -3.97379601e-02 -6.73843880e-02]
 [-1.25217813e-01 -1.56190053e-01 -1.15063785e-01]
 [ 1.19424873e-01  8.28760042e-02  1.44111042e-02]
 [-2.11484116e-01 -1.02079432e-01  4.95338303e-02]
 [-9.91072746e-02  1.45987500e-02 -1.35088757e-02]
 [-9.62623594e-02 -1.14884369e-01  6.32126881e-02]
 [ 3.51402020e-01  4.03832117e-01  1.02157307e-02]
 [-3.88272081e-02 -4.44468875e-01 -3.64738516e-02]
 [-6.63859673e-02 -3.21996078e-02 -3.34843211e-02]
 [-1.01405375e-02  1.16586979e-01 -1.48903280e-02]
 [-1.07375650e-01  4.45228781e-02 -1.87412178e-01]
 [-6.28785329e-02 -2.63880549e-02  1.41305153e-01]
 [ 4.17559698e-02 -7.86412035e-02  4.80348244e-02]
 [ 1.24608202e-01  5.98215051e-03  2.41980202e-01]
 [-3.50825915e-02 -4.74031203e-02  2.33931355e-01]
 [-6.96169475e-02 -5.41467962e-04 -8.17110483e-02]
 [-3.77756913e-01  1.20104804e-01  8.38907180e-02]
 [-2.48280352e-02 -1.33269721e-01  9.62374243e-02]
 [-2.50702864e-02  5.23263862e-02 -3.22103507e-02]
 [-5.07806065e-02  7.36225950e-02  2.93687317e-02]
 [-6.94228993e-02 -6.40519998e-02 -2.15237083e-01]
 [ 9.74427072e-03 -1.18508240e-02 -1.22319300e-01]
 [ 4.72301398e-02  8.29731147e-02  2.20320691e-02]
 [ 3.25798125e-02 -7.41171549e-02 -8.71754469e-02]
 [ 2.27861387e-01 -2.02383364e-01 -1.18555939e-01]
 [-4.80380727e-02 -8.35355475e-02 -2.09753170e-03]
 [-1.65823458e-01  4.31339560e-02  2.26591542e-02]
 [-7.63129104e-03 -1.31956084e-01 -1.02608632e-01]
 [-7.06655448e-02 -2.22719535e-01 -7.75801817e-03]
 [-2.07094812e-02  1.55264375e-02 -8.11492825e-02]
 [-4.31480247e-02  7.02036405e-02  2.59587344e-02]
 [-6.37749610e-01  3.23308812e-01  3.87685292e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.26023247 -29.25593426 -29.27334937]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  8.31486419  -9.25153874 -83.50871763]
init_Out:  [2.49911038]
Stock Position:  8.31486419409362
Bond position:  [-828.98730903]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-0.95445723]
curr_Stock_Price:  99.59711455960222
curr_Factors:  [99.59711456 -0.61624995 -0.99335939]
mat_Sqrt:  [[19.91600833  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0003637  -0.04017178 -0.11181141]
Stock Position:  -0.0003637032493739523
Bond Position:  [-0.91823344]


portfolio before change:  [-0.95474996]
curr_Stock_Price:  100.0863602142184
curr_Factors:  [100.08636021  -0.52355381  -1.01302273]
mat_Sqrt:  [[21.53020601  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00222501 -0.00948107 -0.02734779]
Stock Position:  -0.0022250125238207903
Bond Position:  [-0.73205655]


portfolio before change:  [-0.95177979]
curr_Stock_Price:  98.71033185203798
curr_Factors:  [98.71033185 -0.72931924 -1.01711795]
mat_Sqrt:  [[17.21450659  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00526303  0.01360008  0.02435464]
Stock Position:  -0.005263032934318318
Bond Position:  [-0.43226406]


portfolio before change:  [-0.94918952]
curr_Stock_Price:  98.2079016470858
curr_Factors:  [98.20790165 -0.94926054 -1.05968426]
mat_Sqrt:  [[13.17263893  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 1.53035576e-04  1.19482032e-02 -2.04464057e-01]
Stock Position:  0.00015303557564371552
Bond Position:  [-0.96421882]


portfolio before change:  [-0.9492427]
curr_Stock_Price:  98.64804145091199
curr_Factors:  [98.64804145 -1.04480328 -1.08223318]
mat_Sqrt:  [[11.75785966  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00536085  0.00922446 -0.02893202]
Stock Position:  0.005360851256156265
Bond Position:  [-1.47808018]


portfolio before change:  [-0.95001453]
curr_Stock_Price:  98.53853271657044
curr_Factors:  [98.53853272 -1.22206918 -1.05352411]
mat_Sqrt:  [[10.1234486   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00619048  0.00277048 -0.22690079]
Stock Position:  0.0061904806468768446
Bond Position:  [-1.56001541]


portfolio before change:  [-0.9507725]
curr_Stock_Price:  98.44759364072569
curr_Factors:  [98.44759364 -1.18515023 -1.03113672]
mat_Sqrt:  [[10.73208019  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01070105 -0.00271365 -0.28768792]
Stock Position:  -0.010701053014656348
Bond Position:  [0.10272042]


portfolio before change:  [-0.9396077]
curr_Stock_Price:  97.40545694448794
curr_Factors:  [97.40545694 -1.10435073 -1.01231835]
mat_Sqrt:  [[11.73074482  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00215906 -0.01256625 -0.1922289 ]
Stock Position:  0.002159057985184017
Bond Position:  [-1.14991173]


portfolio before change:  [-0.94068128]
curr_Stock_Price:  96.97478965221815
curr_Factors:  [96.97478965 -1.10648864 -0.99429794]
mat_Sqrt:  [[11.86584931  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01287206 -0.04939163 -0.32824495]
Stock Position:  -0.012872059631724853
Bond Position:  [0.30758399]


portfolio before change:  [-0.93718281]
curr_Stock_Price:  96.70598862912976
curr_Factors:  [96.70598863 -1.17858511 -0.99406416]
mat_Sqrt:  [[11.01244573  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01130597 0.02620769 0.04111087]
Stock Position:  0.011305969548811471
Bond Position:  [-2.03053777]


portfolio before change:  [-0.93159206]
curr_Stock_Price:  97.22293542802954
curr_Factors:  [97.22293543 -1.19219909 -0.98399626]
mat_Sqrt:  [[11.03212308  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01849225 -0.03228035  0.14130623]
Stock Position:  -0.01849224702904843
Bond Position:  [0.86627848]


portfolio before change:  [-0.93088601]
curr_Stock_Price:  97.19061062433218
curr_Factors:  [97.19061062 -1.12105686 -0.98508017]
mat_Sqrt:  [[11.82879822  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00857972  0.00461653 -0.03853706]
Stock Position:  -0.008579724018805898
Bond Position:  [-0.09701739]


portfolio before change:  [-0.93749846]
curr_Stock_Price:  97.95990377329787
curr_Factors:  [97.95990377 -1.03295918 -0.98695228]
mat_Sqrt:  [[12.99606722  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00664243 -0.03632963  0.1803282 ]
Stock Position:  -0.0066424267974363365
Bond Position:  [-0.28680697]


portfolio before change:  [-0.93544416]
curr_Stock_Price:  97.64523727086944
curr_Factors:  [97.64523727 -1.00085877 -1.00504288]
mat_Sqrt:  [[13.13708606  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.02770129 0.12770293 0.02914264]
Stock Position:  0.02770128749685051
Bond Position:  [-3.64034295]


portfolio before change:  [-0.94749294]
curr_Stock_Price:  97.22671144458224
curr_Factors:  [97.22671144 -0.99159691 -0.9870179 ]
mat_Sqrt:  [[13.44262562  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00429593 -0.1405534  -0.10404975]
Stock Position:  -0.004295927040867803
Bond Position:  [-0.52981408]


portfolio before change:  [-0.9460428]
curr_Stock_Price:  96.87373278767033
curr_Factors:  [96.87373279 -1.00214306 -0.96039097]
mat_Sqrt:  [[13.61094682  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00544064 -0.01018241 -0.09552145]
Stock Position:  -0.005440643993761402
Bond Position:  [-0.41898731]


portfolio before change:  [-0.94448722]
curr_Stock_Price:  96.57818825412677
curr_Factors:  [96.57818825 -0.87458476 -0.94183395]
mat_Sqrt:  [[15.70429455  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00064758  0.03686804 -0.04247796]
Stock Position:  -0.0006475776453612039
Bond Position:  [-0.88194535]


portfolio before change:  [-0.94382262]
curr_Stock_Price:  95.38165167006296
curr_Factors:  [95.38165167 -0.9467029  -0.94300748]
mat_Sqrt:  [[14.41365244  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01002393  0.01407937 -0.53463478]
Stock Position:  -0.010023928735403522
Bond Position:  [0.01227626]


portfolio before change:  [-0.94515797]
curr_Stock_Price:  95.5150203253879
curr_Factors:  [95.51502033 -0.92323868 -0.92511817]
mat_Sqrt:  [[15.04320899  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00230776 -0.00834464  0.40310427]
Stock Position:  -0.002307757337552639
Bond Position:  [-0.72473248]


portfolio before change:  [-0.94898286]
curr_Stock_Price:  97.1331711631221
curr_Factors:  [97.13317116 -1.02710301 -0.93357758]
mat_Sqrt:  [[13.67271643  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00362258 -0.02486853  0.13702998]
Stock Position:  0.0036225815360559077
Bond Position:  [-1.3008557]


portfolio before change:  [-0.94835929]
curr_Stock_Price:  97.35019627192918
curr_Factors:  [97.35019627 -1.17772784 -0.93906635]
mat_Sqrt:  [[11.72262297  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01485646 0.00189172 0.69030216]
Stock Position:  0.014856458518197608
Bond Position:  [-2.39463844]


portfolio before change:  [-0.93987941]
curr_Stock_Price:  97.94113278079467
curr_Factors:  [97.94113278 -0.96663489 -0.92170633]
mat_Sqrt:  [[14.820708    0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0007722  -0.01499018  0.66734104]
Stock Position:  0.0007721967803788717
Bond Position:  [-1.01550924]


portfolio before change:  [-0.94087101]
curr_Stock_Price:  96.8214034401396
curr_Factors:  [96.82140344 -0.65083333 -0.91110867]
mat_Sqrt:  [[20.30619641  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-4.25043294e-03 -1.71227204e-04 -2.33098877e-01]
Stock Position:  -0.004250432937785989
Bond Position:  [-0.52933813]


portfolio before change:  [-0.94085719]
curr_Stock_Price:  96.8025843301484
curr_Factors:  [96.80258433 -0.3658537  -0.90346359]
mat_Sqrt:  [[27.20379255  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01314272  0.03798047  0.23931687]
Stock Position:  -0.013142715234855294
Bond Position:  [0.33139161]


portfolio before change:  [-0.97076939]
curr_Stock_Price:  99.08168916550822
curr_Factors:  [99.08168917 -0.84840464 -0.90339698]
mat_Sqrt:  [[17.1868238   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00050182 -0.04214359  0.27453858]
Stock Position:  -0.0005018182931249733
Bond Position:  [-0.92104839]


portfolio before change:  [-0.97137651]
curr_Stock_Price:  100.06207817168305
curr_Factors:  [100.06207817  -0.74720352  -0.888288  ]
mat_Sqrt:  [[19.49775353  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00155372  0.01654706 -0.09188717]
Stock Position:  -0.0015537243891934078
Bond Position:  [-0.81590762]


portfolio before change:  [-0.97098838]
curr_Stock_Price:  99.74662649357971
curr_Factors:  [99.74662649 -0.75668521 -0.89029281]
mat_Sqrt:  [[19.21430814  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00223192  0.02328151  0.08378082]
Stock Position:  -0.002231920695940392
Bond Position:  [-0.74836182]


portfolio before change:  [-0.97205045]
curr_Stock_Price:  100.18056760893998
curr_Factors:  [100.18056761  -0.66529498  -0.8892936 ]
mat_Sqrt:  [[21.16577833  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00543386 -0.02025502 -0.61401149]
Stock Position:  -0.005433856413782598
Bond Position:  [-0.42768363]


portfolio before change:  [-0.96420406]
curr_Stock_Price:  98.72674626167456
curr_Factors:  [98.72674626 -0.82857102 -0.89344513]
mat_Sqrt:  [[17.64301122  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00088024 -0.00374756 -0.34894292]
Stock Position:  -0.0008802374274308701
Bond Position:  [-0.87730108]


portfolio before change:  [-0.96484204]
curr_Stock_Price:  99.32693304497614
curr_Factors:  [99.32693304 -0.89316902 -0.90590046]
mat_Sqrt:  [[16.43391668  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00327796 0.0262384  0.06285136]
Stock Position:  0.003277963174148717
Bond Position:  [-1.29043206]


portfolio before change:  [-0.96554694]
curr_Stock_Price:  99.16110180136891
curr_Factors:  [99.1611018  -1.0918751  -0.90155097]
mat_Sqrt:  [[13.50850849  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00095284 -0.0234379  -0.24868729]
Stock Position:  0.000952844067224809
Bond Position:  [-1.06003201]


portfolio before change:  [-0.96550696]
curr_Stock_Price:  99.34213364508942
curr_Factors:  [99.34213365 -1.01108334 -0.88022905]
mat_Sqrt:  [[14.98811272  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01323954 -0.06399924 -0.33820709]
Stock Position:  0.013239541590182381
Bond Position:  [-2.28075127]


portfolio before change:  [-0.98123756]
curr_Stock_Price:  98.17551564787884
curr_Factors:  [98.17551565 -1.08604342 -0.87196705]
mat_Sqrt:  [[13.85638841  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00365341 -0.02641626 -0.00598367]
Stock Position:  -0.0036534129014853104
Bond Position:  [-0.62256186]


portfolio before change:  [-0.97967141]
curr_Stock_Price:  97.72553258402479
curr_Factors:  [97.72553258 -1.1763189  -0.8709259 ]
mat_Sqrt:  [[12.61539705  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01268961  0.01364015  0.06464026]
Stock Position:  -0.012689609573276346
Bond Position:  [0.26042745]


portfolio before change:  [-0.98405787]
curr_Stock_Price:  98.07377168164275
curr_Factors:  [98.07377168 -1.38468038 -0.86595861]
mat_Sqrt:  [[10.33029643  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00309607 -0.04172818 -0.29271387]
Stock Position:  -0.0030960662159524007
Bond Position:  [-0.68041498]


portfolio before change:  [-0.98792004]
curr_Stock_Price:  99.29374212078443
curr_Factors:  [99.29374212 -1.48202421 -0.86787472]
mat_Sqrt:  [[ 9.47051814  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00823606 -0.0704301  -0.02213147]
Stock Position:  -0.008236058061973408
Bond Position:  [-0.17013101]


portfolio before change:  [-0.98746575]
curr_Stock_Price:  99.23600121159147
curr_Factors:  [99.23600121 -1.38799527 -0.85693208]
mat_Sqrt:  [[10.51258924  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00350752  0.00490989 -0.23149632]
Stock Position:  -0.003507520118352706
Bond Position:  [-0.63939348]


portfolio before change:  [-0.98710683]
curr_Stock_Price:  99.11088553204249
curr_Factors:  [99.11088553 -1.50284789 -0.87240116]
mat_Sqrt:  [[ 9.21645273  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00391003  0.02220034  0.07405304]
Stock Position:  -0.003910026026585121
Bond Position:  [-0.59958069]


portfolio before change:  [-0.98759601]
curr_Stock_Price:  99.21682527874682
curr_Factors:  [99.21682528 -1.77432402 -0.87850295]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-0.98759601]
Stock Price:  99.5220429084653
PL:  [-0.98759601]
Settle:  Tensor("sub_276:0", shape=(), dtype=float64)
PL:  Tensor("sub_277:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  139
output_Z_Vals[:, i, :]:  [[ 1.19260232e+02 -2.92559343e+01 -2.92733494e+01]
 [ 6.39037108e-02 -1.33387760e-01 -1.66226855e-01]
 [-3.08584018e-02  5.02742780e-02  1.13113252e-01]
 [ 8.73954240e-02  1.92392337e-01  3.82515268e-02]
 [ 1.14661565e-01  4.44312922e-03 -6.41511440e-02]
 [ 7.04786247e-02  2.89245152e-02 -1.14370663e-01]
 [ 6.63763210e-02  1.87991922e-02 -5.86608259e-02]
 [-1.38153425e-01  8.98231991e-02 -6.76595826e-02]
 [-1.21748903e-01 -6.42771704e-02  1.15912271e-01]
 [-3.78525502e-02  9.12576717e-02 -1.25451919e-02]
 [ 5.35945967e-02  9.65573295e-02 -7.70811133e-02]
 [-2.67208744e-02  7.40211382e-02 -7.05564227e-03]
 [-1.05268475e-01  3.60169765e-02 -5.01576103e-02]
 [-3.63309560e-02  3.96945824e-02  1.31525783e-01]
 [ 2.73345656e-01  4.05954087e-01  1.13995452e-01]
 [-6.94463655e-02 -5.28459117e-02 -1.01706484e-01]
 [-7.76660717e-02 -3.03316347e-02 -7.45866790e-02]
 [-5.47500580e-02  1.20933620e-01  9.22108028e-02]
 [ 6.51759757e-02  7.34190759e-02  8.42200583e-02]
 [ 3.04303698e-01 -7.44559721e-02 -4.62081691e-02]
 [-1.86182901e-02  3.27597043e-03  3.88427998e-02]
 [ 5.19221985e-02 -4.13035919e-02  5.04399008e-02]
 [-5.91208770e-02  4.50832110e-02  2.03162585e-01]
 [ 2.52767802e-03 -6.90890953e-03 -6.33559802e-02]
 [ 9.42870612e-02  2.68372297e-02  1.00206449e-01]
 [ 8.20905948e-02 -1.35277085e-02  6.20082710e-02]
 [-1.71287140e-01  7.16765213e-02  7.73241203e-02]
 [-5.07806065e-02  7.36225950e-02  2.93687317e-02]
 [ 6.20848838e-02 -6.23725319e-02  9.08311027e-02]
 [ 2.61335583e-02 -2.37800665e-02  1.73070509e-02]
 [-3.08237657e-02  3.18196118e-01  1.21168417e-02]
 [ 3.04571588e-02 -1.24411843e-01 -6.72284318e-02]
 [ 1.11246923e-01 -9.63395978e-02 -1.03333135e-02]
 [-6.52045772e-02 -6.62924970e-02  1.80207272e-02]
 [-1.22831717e-01  4.11565340e-02  3.62064741e-02]
 [ 8.59858470e-02 -1.64475513e-01 -1.38077890e-01]
 [-2.13684875e-01 -3.63270061e-01  6.67105892e-02]
 [-4.99664409e-02 -4.00661887e-02  5.69868488e-02]
 [-3.41701125e-02  7.33942199e-02 -2.70323704e-02]
 [ 8.99836034e-02 -3.74191642e-03 -7.99981092e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.26023247 -29.25593426 -29.27334937]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  8.31486419  -9.25153874 -83.50871763]
init_Out:  [2.49911038]
Stock Position:  8.31486419409362
Bond position:  [-828.98730903]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-6.12044141]
curr_Stock_Price:  98.97581948438234
curr_Factors:  [98.97581948 -0.97736316 -0.98248   ]
mat_Sqrt:  [[13.94376451  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00190255 -0.04218091 -0.47419895]
Stock Position:  0.0019025521303107878
Bond Position:  [-6.30874806]


portfolio before change:  [-6.12021356]
curr_Stock_Price:  99.51009808821085
curr_Factors:  [99.51009809 -1.18661621 -0.99835681]
mat_Sqrt:  [[11.19297226  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00057815  0.01589812  0.32268062]
Stock Position:  -0.0005781466732890437
Bond Position:  [-6.06268213]


portfolio before change:  [-6.12108804]
curr_Stock_Price:  99.71177090480172
curr_Factors:  [99.7117709  -1.2591819  -0.96746886]
mat_Sqrt:  [[10.7578205   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00931146 0.0608398  0.10912096]
Stock Position:  0.009311461650310696
Bond Position:  [-7.04955037]


portfolio before change:  [-6.12462224]
curr_Stock_Price:  99.42685824753416
curr_Factors:  [99.42685825 -1.28205553 -0.97272859]
mat_Sqrt:  [[10.42949818  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00974941  0.00140504 -0.18300536]
Stock Position:  0.009749413328657494
Bond Position:  [-7.09397578]


portfolio before change:  [-6.12308733]
curr_Stock_Price:  99.67525399251264
curr_Factors:  [99.67525399 -1.15089193 -0.95455349]
mat_Sqrt:  [[12.13959011  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00394409  0.00914673 -0.32626767]
Stock Position:  0.003944090221586176
Bond Position:  [-6.51621552]


portfolio before change:  [-6.12228769]
curr_Stock_Price:  100.08452848722284
curr_Factors:  [100.08452849  -1.09290671  -0.97097315]
mat_Sqrt:  [[12.70677424  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00431956  0.00594483 -0.16734301]
Stock Position:  0.004319556015464668
Bond Position:  [-6.55460842]


portfolio before change:  [-6.12198523]
curr_Stock_Price:  100.34424091720776
curr_Factors:  [100.34424092  -1.29590242  -0.98607371]
mat_Sqrt:  [[10.24336882  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01460898  0.02840459 -0.19301396]
Stock Position:  -0.014608978471367388
Bond Position:  [-4.65605837]


portfolio before change:  [-6.12345003]
curr_Stock_Price:  100.4046668782175
curr_Factors:  [100.40466688  -1.31764214  -0.99370347]
mat_Sqrt:  [[ 9.95289111  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01002202 -0.02032623  0.33066544]
Stock Position:  -0.010022016514844545
Bond Position:  [-5.1171928]


portfolio before change:  [-6.12667376]
curr_Stock_Price:  100.66250339189604
curr_Factors:  [100.66250339  -1.43804858  -0.99207885]
mat_Sqrt:  [[ 8.86087871  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00429495  0.02885821 -0.03578794]
Stock Position:  -0.004294953703043454
Bond Position:  [-5.69433297]


portfolio before change:  [-6.12708769]
curr_Stock_Price:  100.59314069684062
curr_Factors:  [100.5931407   -1.55979429  -0.97633049]
mat_Sqrt:  [[ 7.96422226  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00506686  0.03053411 -0.21989096]
Stock Position:  0.005066857573568011
Bond Position:  [-6.6367788]


portfolio before change:  [-6.12745147]
curr_Stock_Price:  100.68508498322068
curr_Factors:  [100.68508498  -1.61880146  -0.98783528]
mat_Sqrt:  [[ 7.42877472  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00353354  0.02340754 -0.02012778]
Stock Position:  -0.0035335415025278265
Bond Position:  [-5.77167654]


portfolio before change:  [-6.1264671]
curr_Stock_Price:  100.20231892218159
curr_Factors:  [100.20231892  -1.36769422  -0.99763808]
mat_Sqrt:  [[ 9.41081006  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01217503  0.01138957 -0.1430857 ]
Stock Position:  -0.012175030558997177
Bond Position:  [-4.9065008]


portfolio before change:  [-6.13353411]
curr_Stock_Price:  100.73239220542311
curr_Factors:  [100.73239221  -1.57275452  -0.98408879]
mat_Sqrt:  [[ 7.81171168  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00108279  0.01255253  0.37520645]
Stock Position:  -0.0010827919144228372
Bond Position:  [-6.02446189]


portfolio before change:  [-6.13523654]
curr_Stock_Price:  101.6091330120273
curr_Factors:  [101.60913301  -1.49442417  -1.00854518]
mat_Sqrt:  [[ 8.31585612  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.03692904 0.12837395 0.32519729]
Stock Position:  0.03692903839096487
Bond Position:  [-9.88756412]


portfolio before change:  [-6.1476355]
curr_Stock_Price:  101.30685228311724
curr_Factors:  [101.30685228  -1.65984072  -1.01316763]
mat_Sqrt:  [[ 6.9946509   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01309166 -0.01671134 -0.29014029]
Stock Position:  -0.013091659834287457
Bond Position:  [-4.82136065]


portfolio before change:  [-6.15378563]
curr_Stock_Price:  101.73058896501622
curr_Factors:  [101.73058897  -1.48989945  -1.02433195]
mat_Sqrt:  [[ 8.23255677  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0113785  -0.00959171 -0.21277503]
Stock Position:  -0.01137850316131102
Bond Position:  [-4.9962438]


portfolio before change:  [-6.14972715]
curr_Stock_Price:  101.31901980066208
curr_Factors:  [101.3190198   -1.53394688  -1.01305891]
mat_Sqrt:  [[ 7.93488097  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00413429  0.03824257  0.26305175]
Stock Position:  -0.0041342918965627355
Bond Position:  [-5.73084475]


portfolio before change:  [-6.1512837]
curr_Stock_Price:  101.52223411110046
curr_Factors:  [101.52223411  -1.35221871  -1.03539947]
mat_Sqrt:  [[ 9.32463339  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.0090366  0.02321715 0.24025638]
Stock Position:  0.00903660143728652
Bond Position:  [-7.06869967]


portfolio before change:  [-6.14868819]
curr_Stock_Price:  101.90724129834874
curr_Factors:  [101.9072413   -1.21766688  -1.05075504]
mat_Sqrt:  [[10.54488682  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.02778115 -0.02354505 -0.13181904]
Stock Position:  0.027781146882072578
Bond Position:  [-8.97978823]


portfolio before change:  [-6.12849946]
curr_Stock_Price:  102.67435401953966
curr_Factors:  [102.67435402  -1.15122644  -1.06330388]
mat_Sqrt:  [[11.21253159  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00094581  0.00103595  0.1108077 ]
Stock Position:  -0.0009458124147893081
Bond Position:  [-6.03138878]


portfolio before change:  [-6.12876243]
curr_Stock_Price:  102.15521978678332
curr_Factors:  [102.15521979  -1.1849613   -1.07047424]
mat_Sqrt:  [[10.70871479  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00571047 -0.01306134  0.143891  ]
Stock Position:  0.005710465466134352
Bond Position:  [-6.71211628]


portfolio before change:  [-6.13215026]
curr_Stock_Price:  101.70888786792722
curr_Factors:  [101.70888787  -1.06999327  -1.06839265]
mat_Sqrt:  [[11.98587382  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00137549  0.01425656  0.57956631]
Stock Position:  -0.0013754895725656205
Bond Position:  [-5.99225074]


portfolio before change:  [-6.13256922]
curr_Stock_Price:  101.46888972101766
curr_Factors:  [101.46888972  -1.11370993  -1.09883093]
mat_Sqrt:  [[11.10295608  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00095319 -0.00218479 -0.18073698]
Stock Position:  -0.0009531871045630431
Bond Position:  [-6.03585038]


portfolio before change:  [-6.13373897]
curr_Stock_Price:  101.9045067899615
curr_Factors:  [101.90450679  -0.76426719  -1.08672586]
mat_Sqrt:  [[16.00727202  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00721138 0.00848668 0.28586111]
Stock Position:  0.007211381878077057
Bond Position:  [-6.86861129]


portfolio before change:  [-6.12983909]
curr_Stock_Price:  102.56436761223443
curr_Factors:  [102.56436761  -0.70644497  -1.08108831]
mat_Sqrt:  [[17.1664568   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00549902 -0.00427784  0.17689234]
Stock Position:  0.005499020404919563
Bond Position:  [-6.69384265]


portfolio before change:  [-6.12913257]
curr_Stock_Price:  102.84501942142249
curr_Factors:  [102.84501942  -0.81470745  -1.08321016]
mat_Sqrt:  [[15.41445306  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0099681   0.02266611  0.22058419]
Stock Position:  -0.00996809548469803
Bond Position:  [-5.10396359]


portfolio before change:  [-6.14114398]
curr_Stock_Price:  103.98599732591187
curr_Factors:  [103.98599733  -0.91676855  -1.08801043]
mat_Sqrt:  [[14.00588045  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00306191  0.02328151  0.08378082]
Stock Position:  -0.0030619147551033143
Bond Position:  [-5.82274772]


portfolio before change:  [-6.14257182]
curr_Stock_Price:  104.21459613221687
curr_Factors:  [104.21459613  -1.02198694  -1.0967213 ]
mat_Sqrt:  [[12.52521686  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00630849 -0.01972393  0.25911585]
Stock Position:  0.006308493821825254
Bond Position:  [-6.80000895]


portfolio before change:  [-6.14093813]
curr_Stock_Price:  104.6083096020495
curr_Factors:  [104.6083096   -1.13110086  -1.1035108 ]
mat_Sqrt:  [[11.19661311  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00259474 -0.00751992  0.0493722 ]
Stock Position:  0.0025947441729061984
Bond Position:  [-6.41236994]


portfolio before change:  [-6.14203466]
curr_Stock_Price:  104.49464521454532
curr_Factors:  [104.49464521  -1.26992608  -1.11017309]
mat_Sqrt:  [[ 9.67008079  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00208216  0.10062245  0.03456598]
Stock Position:  -0.00208215813382244
Bond Position:  [-5.92446028]


portfolio before change:  [-6.14270252]
curr_Stock_Price:  104.45971018686865
curr_Factors:  [104.45971019  -1.19201179  -1.13700576]
mat_Sqrt:  [[10.17347554  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00132913 -0.03934248 -0.191784  ]
Stock Position:  0.0013291340419523397
Bond Position:  [-6.28154348]


portfolio before change:  [-6.1443011]
curr_Stock_Price:  103.84777955284743
curr_Factors:  [103.84777955  -1.01108851  -1.09584763]
mat_Sqrt:  [[12.62892768  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00844491 -0.03046526 -0.02947807]
Stock Position:  0.00844491066696271
Bond Position:  [-7.02128632]


portfolio before change:  [-6.13612669]
curr_Stock_Price:  104.91968257968958
curr_Factors:  [104.91968258  -0.90647123  -1.09046864]
mat_Sqrt:  [[14.24285328  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00443997 -0.02096353  0.05140812]
Stock Position:  -0.004439965459636023
Bond Position:  [-5.67028693]


portfolio before change:  [-6.13923407]
curr_Stock_Price:  105.45990024415676
curr_Factors:  [105.45990024  -0.94784292  -1.09961537]
mat_Sqrt:  [[13.6109212   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00840343  0.01301484  0.10328699]
Stock Position:  -0.008403431530650146
Bond Position:  [-5.25300902]


portfolio before change:  [-6.13637162]
curr_Stock_Price:  105.04112800788575
curr_Factors:  [105.04112801  -0.79315119  -1.08395297]
mat_Sqrt:  [[16.0747193   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00333157 -0.05201172 -0.39389779]
Stock Position:  0.0033315714777261154
Bond Position:  [-6.48632364]


portfolio before change:  [-6.13695844]
curr_Stock_Price:  105.10836827176142
curr_Factors:  [105.10836827  -0.93093001  -1.08873941]
mat_Sqrt:  [[13.9478096   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0150165  -0.11487608  0.19030674]
Stock Position:  -0.015016495890522247
Bond Position:  [-4.55859906]


portfolio before change:  [-6.14467128]
curr_Stock_Price:  105.58404344302784
curr_Factors:  [105.58404344  -1.24143584  -1.06738415]
mat_Sqrt:  [[10.49277865  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00375197 -0.01267004  0.16256762]
Stock Position:  -0.003751966472248583
Bond Position:  [-5.74852348]


portfolio before change:  [-6.14373128]
curr_Stock_Price:  105.14198024065219
curr_Factors:  [105.14198024  -1.15292947  -1.06769845]
mat_Sqrt:  [[11.41220851  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00331163  0.02320929 -0.07711583]
Stock Position:  -0.0033116325649321077
Bond Position:  [-5.79553967]


portfolio before change:  [-6.14267183]
curr_Stock_Price:  104.6032919896644
curr_Factors:  [104.60329199  -1.48227072  -1.03439522]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-6.14267183]
Stock Price:  103.90665565626796
PL:  [-10.04932749]
Settle:  Tensor("sub_278:0", shape=(), dtype=float64)
PL:  Tensor("sub_279:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  140
output_Z_Vals[:, i, :]:  [[ 1.19260232e+02 -2.92559343e+01 -2.92733494e+01]
 [-9.52350378e-02  2.36750417e-01  3.24975234e-02]
 [-1.51992875e-02 -1.64499674e-02 -2.14429814e-02]
 [ 8.50505280e-02  1.71070128e-01  3.79666639e-02]
 [ 2.28535668e-01 -1.97859830e-02 -3.86424680e-02]
 [ 7.59415741e-02  3.27014217e-02 -1.97844948e-02]
 [ 6.25963928e-02  2.22934365e-02 -5.41685688e-02]
 [-2.47910897e-03  1.70832310e-01  6.54891734e-02]
 [-8.59939374e-02 -2.69741053e-02  6.45440746e-02]
 [-6.96479321e-02  2.65216520e-01  1.05461032e-01]
 [ 5.50938873e-02  4.31373503e-02 -7.63232170e-02]
 [-5.30668503e-02  8.81771653e-02  9.20301553e-03]
 [-1.05268475e-01  3.60169765e-02 -5.01576103e-02]
 [ 7.88373349e-02  1.05774694e-01  1.97180275e-01]
 [ 2.66286330e-01  4.11630945e-01  1.29614861e-01]
 [-7.03542193e-02 -6.93415920e-02 -1.09358811e-01]
 [-7.49459440e-02 -4.42752245e-02 -6.58491701e-02]
 [-6.02937182e-02  1.08889663e-01  9.34522445e-02]
 [ 7.17684101e-02  6.83830371e-02  8.43734093e-02]
 [ 2.80546341e-01 -6.92215903e-02 -3.76745155e-02]
 [-4.39713192e-02  5.42948448e-03 -9.35046523e-03]
 [ 4.58333675e-02 -3.70984687e-02  4.45088010e-02]
 [-6.10802635e-02  5.05413598e-02  2.18836968e-01]
 [ 4.37888467e-02 -1.32868134e-02 -3.94977569e-02]
 [ 9.44604709e-02  2.99295985e-02  9.50750036e-02]
 [ 7.70938221e-02 -1.87849796e-02  6.35694189e-02]
 [-1.50352256e-01  7.44478016e-02  7.82851340e-02]
 [-2.59444568e-02  5.23987667e-02  2.22965341e-02]
 [ 6.20848838e-02 -6.23725319e-02  9.08311027e-02]
 [ 6.00242115e-02  1.24245708e-02  3.58632967e-02]
 [-3.89340384e-05  2.16291540e-01  2.26486018e-02]
 [ 1.67565985e-02 -8.83562524e-02 -8.01056985e-02]
 [ 1.89888825e-01 -2.11693707e-01 -1.55512964e-01]
 [-5.13086958e-02 -8.67285276e-02 -1.10950071e-02]
 [-1.56674815e-01  1.17504583e-01  3.23750666e-02]
 [ 8.47165236e-02 -1.65012150e-01 -1.38726811e-01]
 [-5.95838532e-02 -1.79793695e-01 -2.87509238e-02]
 [-2.37789340e-02  2.06985871e-02 -6.80786183e-02]
 [-2.14082801e-02  1.71133099e-02  7.85736349e-03]
 [-7.56701795e-01  3.77348546e-01  4.64177829e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.26023247 -29.25593426 -29.27334937]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  8.31486419  -9.25153874 -83.50871763]
init_Out:  [2.49911038]
Stock Position:  8.31486419409362
Bond position:  [-828.98730903]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [9.01002487]
curr_Stock_Price:  100.79550840805834
curr_Factors:  [100.79550841  -1.22566812  -1.0041421 ]
mat_Sqrt:  [[10.84043994  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00760934  0.07486706  0.09270639]
Stock Position:  -0.007609344234398334
Bond Position:  [9.77701259]


portfolio before change:  [9.01108807]
curr_Stock_Price:  100.8164034516498
curr_Factors:  [100.81640345  -1.23350565  -0.98971827]
mat_Sqrt:  [[10.91433609  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00183255 -0.00520194 -0.06117086]
Stock Position:  -0.0018325488514717584
Bond Position:  [9.19583906]


portfolio before change:  [9.01084534]
curr_Stock_Price:  101.57615731400358
curr_Factors:  [101.57615731  -1.16637357  -0.98171478]
mat_Sqrt:  [[11.85465345  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00820078 0.05409712 0.10830832]
Stock Position:  0.008200784012469674
Bond Position:  [8.17784121]


portfolio before change:  [9.01199304]
curr_Stock_Price:  101.5914492370936
curr_Factors:  [101.59144924  -1.26008183  -0.97360068]
mat_Sqrt:  [[10.88381537  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.02022608 -0.00625688 -0.11023621]
Stock Position:  0.020226081417829608
Bond Position:  [6.95719612]


portfolio before change:  [9.00176874]
curr_Stock_Price:  101.04294914935885
curr_Factors:  [101.04294915  -1.27602499  -0.97160316]
mat_Sqrt:  [[10.67513826  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00681466  0.0103411  -0.05643966]
Stock Position:  0.006814659098520294
Bond Position:  [8.31319548]


portfolio before change:  [8.99825424]
curr_Stock_Price:  100.37472615057612
curr_Factors:  [100.37472615  -1.08932051  -1.00111962]
mat_Sqrt:  [[12.40959941  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00419956  0.0070498  -0.15452785]
Stock Position:  0.00419956296084974
Bond Position:  [8.57672426]


portfolio before change:  [9.0037133]
curr_Stock_Price:  101.41933654908118
curr_Factors:  [101.41933655  -1.27864321  -1.01569122]
mat_Sqrt:  [[10.22595746  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00149616 0.05402192 0.18682238]
Stock Position:  0.0014961615016046363
Bond Position:  [8.8519736]


portfolio before change:  [9.00495752]
curr_Stock_Price:  101.51133773761825
curr_Factors:  [101.51133774  -1.09991081  -1.01959869]
mat_Sqrt:  [[12.1905492   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00603052 -0.00852996  0.18412628]
Stock Position:  -0.006030524186984602
Bond Position:  [9.61712409]


portfolio before change:  [9.00663042]
curr_Stock_Price:  101.43328714986113
curr_Factors:  [101.43328715  -1.32824837  -1.03492122]
mat_Sqrt:  [[ 9.54704536  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00432311  0.08386883  0.30085097]
Stock Position:  -0.004323110059848465
Bond Position:  [9.44513768]


portfolio before change:  [9.00803327]
curr_Stock_Price:  101.38190313469887
curr_Factors:  [101.38190313  -1.24005046  -1.03272091]
mat_Sqrt:  [[10.44499835  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00388974  0.01364123 -0.21772889]
Stock Position:  0.0038897351720692075
Bond Position:  [8.61368452]


portfolio before change:  [9.01024368]
curr_Stock_Price:  101.67334448691808
curr_Factors:  [101.67334449  -1.41661177  -1.02026783]
mat_Sqrt:  [[ 8.88963124  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00550209  0.02788407  0.02625364]
Stock Position:  -0.005502091888568366
Bond Position:  [9.56965977]


portfolio before change:  [9.01019409]
curr_Stock_Price:  101.8997816890949
curr_Factors:  [101.89978169  -1.79708967  -1.01626729]
mat_Sqrt:  [[ 6.11431558  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01873912  0.01138957 -0.1430857 ]
Stock Position:  -0.018739121089059087
Bond Position:  [10.91970643]


portfolio before change:  [9.01845841]
curr_Stock_Price:  101.53160676436788
curr_Factors:  [101.53160676  -1.78324     -1.01794561]
mat_Sqrt:  [[ 6.16682762  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.0197537  0.0334489  0.56250044]
Stock Position:  0.019753702924415823
Bond Position:  [7.01283321]


portfolio before change:  [9.03250469]
curr_Stock_Price:  102.19829814913172
curr_Factors:  [102.19829815  -1.58242122  -1.0137311 ]
mat_Sqrt:  [[ 7.61989582  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.03981316 0.13016913 0.36975512]
Stock Position:  0.039813158230115664
Bond Position:  [4.96366768]


portfolio before change:  [9.01320892]
curr_Stock_Price:  101.69805475802877
curr_Factors:  [101.69805476  -1.2953986   -1.03242858]
mat_Sqrt:  [[ 9.9163112   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00952646 -0.02192774 -0.31197025]
Stock Position:  -0.009526464361793448
Bond Position:  [9.98203181]


portfolio before change:  [9.02006831]
curr_Stock_Price:  101.10900520290436
curr_Factors:  [101.1090052   -1.35360309  -1.02736894]
mat_Sqrt:  [[ 9.34860528  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00957689 -0.01400106 -0.18784935]
Stock Position:  -0.00957688641234146
Bond Position:  [9.98837777]


portfolio before change:  [9.02016482]
curr_Stock_Price:  101.2293065281973
curr_Factors:  [101.22930653  -1.43485744  -1.03614164]
mat_Sqrt:  [[ 8.55391634  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00448991  0.03443393  0.26659324]
Stock Position:  -0.004489912937182337
Bond Position:  [9.4746756]


portfolio before change:  [9.02209979]
curr_Stock_Price:  101.06214007085075
curr_Factors:  [101.06214007  -1.12264794  -1.03155228]
mat_Sqrt:  [[11.72279636  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.0077419  0.02162462 0.24069385]
Stock Position:  0.007741898756565617
Bond Position:  [8.23968694]


portfolio before change:  [9.02745464]
curr_Stock_Price:  101.62076511673874
curr_Factors:  [101.62076512  -1.05194824  -1.03767082]
mat_Sqrt:  [[12.57397049  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.02155793 -0.02188979 -0.10747491]
Stock Position:  0.021557929435293256
Bond Position:  [6.83672135]


portfolio before change:  [9.03873737]
curr_Stock_Price:  102.10448928719597
curr_Factors:  [102.10448929  -1.19166794  -1.02703986]
mat_Sqrt:  [[11.10381677  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00411929  0.00171695 -0.02667427]
Stock Position:  -0.004119285030580332
Bond Position:  [9.45933487]


portfolio before change:  [9.03865344]
curr_Stock_Price:  102.41192751161245
curr_Factors:  [102.41192751  -1.12604142  -1.03462184]
mat_Sqrt:  [[11.80283695  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00457185 -0.01173157  0.12697122]
Stock Position:  0.004571850851251731
Bond Position:  [8.57044138]


portfolio before change:  [9.03601535]
curr_Stock_Price:  101.60055837420168
curr_Factors:  [101.60055837  -1.03523912  -1.02210692]
mat_Sqrt:  [[12.98380738  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0011634   0.01598258  0.62428096]
Stock Position:  -0.0011634015901385124
Bond Position:  [9.1542176]


portfolio before change:  [9.0365945]
curr_Stock_Price:  102.08637435325066
curr_Factors:  [102.08637435  -1.20528593  -1.02504137]
mat_Sqrt:  [[10.97359531  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00322441 -0.00420166 -0.11267611]
Stock Position:  0.003224406927749586
Bond Position:  [8.70742649]


portfolio before change:  [9.03950118]
curr_Stock_Price:  102.65025406627733
curr_Factors:  [102.65025407  -1.34696815  -1.03741033]
mat_Sqrt:  [[ 9.45883414  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01211992 0.00946457 0.27122252]
Stock Position:  0.012119924289986582
Bond Position:  [7.79538787]


portfolio before change:  [9.04407355]
curr_Stock_Price:  102.94711190980796
curr_Factors:  [102.94711191  -1.67424028  -1.05261133]
mat_Sqrt:  [[ 6.73530957  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01330078 -0.00594033  0.18134586]
Stock Position:  0.013300776801809836
Bond Position:  [7.674797]


portfolio before change:  [9.05356965]
curr_Stock_Price:  103.58893077296273
curr_Factors:  [103.58893077  -1.5106716   -1.09646282]
mat_Sqrt:  [[ 7.63922427  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01733817  0.02354246  0.2233257 ]
Stock Position:  -0.01733816563436561
Bond Position:  [10.84961169]


portfolio before change:  [9.05949331]
curr_Stock_Price:  103.3255021803037
curr_Factors:  [103.32550218  -1.38100849  -1.12570801]
mat_Sqrt:  [[ 8.42469874  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00237875  0.01656994  0.06360581]
Stock Position:  -0.0023787515883016814
Bond Position:  [9.30527901]


portfolio before change:  [9.06000781]
curr_Stock_Price:  103.59821960155195
curr_Factors:  [103.5982196   -1.25565041  -1.13482265]
mat_Sqrt:  [[ 9.48818254  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00832775 -0.01972393  0.25911585]
Stock Position:  0.008327754325580448
Bond Position:  [8.19726729]


portfolio before change:  [9.06080303]
curr_Stock_Price:  103.57066025376875
curr_Factors:  [103.57066025  -1.2675256   -1.13355328]
mat_Sqrt:  [[ 9.38558693  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00720952 0.00392899 0.102308  ]
Stock Position:  0.007209520075976102
Bond Position:  [8.31410827]


portfolio before change:  [9.05949451]
curr_Stock_Price:  103.24500131261861
curr_Factors:  [103.24500131  -1.34246353  -1.13455321]
mat_Sqrt:  [[ 8.67190141  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00117262 0.06839739 0.06461016]
Stock Position:  0.001172616650695712
Bond Position:  [8.93842771]


portfolio before change:  [9.05982467]
curr_Stock_Price:  102.57366995048379
curr_Factors:  [102.57366995  -1.0988064   -1.14349493]
mat_Sqrt:  [[10.8947382   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-1.72216839e-04 -2.79407003e-02 -2.28519261e-01]
Stock Position:  -0.0001722168393883933
Bond Position:  [9.07748959]


portfolio before change:  [9.06098967]
curr_Stock_Price:  102.3980829136682
curr_Factors:  [102.39808291  -1.17804388  -1.14004987]
mat_Sqrt:  [[10.08222763  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01514338 -0.06694343 -0.4436352 ]
Stock Position:  0.01514337623882777
Bond Position:  [7.51033697]


portfolio before change:  [9.06385104]
curr_Stock_Price:  102.52503757945288
curr_Factors:  [102.52503758  -1.10039151  -1.14414755]
mat_Sqrt:  [[10.86523212  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00513682 -0.02742597 -0.03165097]
Stock Position:  -0.005136823118793832
Bond Position:  [9.59050402]


portfolio before change:  [9.06723437]
curr_Stock_Price:  102.09978678150394
curr_Factors:  [102.09978678  -0.85574025  -1.11034658]
mat_Sqrt:  [[14.29434219  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01028605  0.03715821  0.09235705]
Stock Position:  -0.010286050559026238
Bond Position:  [10.11743794]


portfolio before change:  [9.0850557]
curr_Stock_Price:  100.49017227927628
curr_Factors:  [100.49017228  -0.97609335  -1.08899537]
mat_Sqrt:  [[12.74286115  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00409158 -0.05218142 -0.39574898]
Stock Position:  0.0040915800496567995
Bond Position:  [8.67389212]


portfolio before change:  [9.08164549]
curr_Stock_Price:  99.39169215831133
curr_Factors:  [99.39169216 -0.94542228 -1.09170688]
mat_Sqrt:  [[12.96092895  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00540817 -0.05685576 -0.08201838]
Stock Position:  -0.005408166687981698
Bond Position:  [9.61917233]


portfolio before change:  [9.08401163]
curr_Stock_Price:  99.17652211362216
curr_Factors:  [99.17652211 -1.07595638 -1.09472003]
mat_Sqrt:  [[11.31608202  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00328214  0.00654547 -0.19420935]
Stock Position:  -0.003282142040135398
Bond Position:  [9.40952307]


portfolio before change:  [9.08664075]
curr_Stock_Price:  98.73386735279225
curr_Factors:  [98.73386735 -0.7214926  -1.09159465]
mat_Sqrt:  [[16.10839836  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00120202  0.0054117   0.02241487]
Stock Position:  -0.0012020151426535867
Bond Position:  [9.20532036]


portfolio before change:  [9.08780993]
curr_Stock_Price:  98.71852334077107
curr_Factors:  [98.71852334 -0.77177333 -1.06441721]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [9.08780993]
Stock Price:  98.04159638589431
PL:  [9.08780993]
Settle:  Tensor("sub_280:0", shape=(), dtype=float64)
PL:  Tensor("sub_281:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  141
output_Z_Vals[:, i, :]:  [[ 1.19260232e+02 -2.92559343e+01 -2.92733494e+01]
 [ 1.63995481e-02 -2.91561365e-02 -3.68810649e-02]
 [-5.12111173e-02  1.21648960e-02  1.01300706e-01]
 [-2.59234395e-01 -1.33243243e-01 -3.31096753e-02]
 [ 2.24575052e-02  3.31793609e-02 -7.72864838e-02]
 [ 6.77769207e-02  2.92637474e-02 -7.54892220e-02]
 [ 5.28319613e-04  5.31722358e-02  2.22732432e-02]
 [ 2.78002575e-02  3.10679256e-01  9.31865890e-02]
 [ 2.48331773e-02  3.61810939e-02 -1.89542203e-02]
 [-4.01225893e-02  2.11778850e-01  7.71824235e-02]
 [ 3.18193927e-02 -8.01866818e-02 -4.17727467e-02]
 [-7.10441008e-02  6.89168322e-02  1.95374286e-02]
 [ 1.28267126e-02 -1.79424629e-01 -2.02672655e-02]
 [ 1.18802530e-01  3.46121044e-02  1.90069498e-01]
 [ 1.17878928e-01 -2.02697468e-02 -1.68928993e-01]
 [-9.15791255e-02 -3.60112501e-01 -8.89804988e-02]
 [-6.68426399e-02 -4.39049388e-02 -3.66376018e-02]
 [-7.50935606e-02  1.89378091e-01  1.29190299e-01]
 [ 1.24711499e-01  5.72436527e-02  1.26870022e-01]
 [ 8.70088032e-02 -3.29206122e-02  4.61874491e-02]
 [-6.28020233e-03 -3.68720928e-02 -9.12693888e-04]
 [ 1.20955270e-01 -6.53530643e-02  1.60342056e-01]
 [-2.41711713e-02 -8.30845278e-02  1.92841184e-01]
 [-6.83218583e-02 -5.72286212e-04 -8.20884019e-02]
 [-3.24910582e-01  1.13785940e-01  6.74956191e-02]
 [-2.90233227e-02 -1.38321414e-01  9.76206846e-02]
 [ 2.36201900e-01  4.02381343e-02 -1.34832877e-01]
 [-3.36262605e-02  6.02494712e-02  2.46214373e-02]
 [-8.64126290e-02 -8.25320688e-02 -1.90217496e-01]
 [ 5.99508993e-02  5.87255753e-02 -9.08847691e-02]
 [ 3.81123869e-02  1.08534247e-01  2.06381990e-02]
 [ 1.53815434e-02 -6.53732422e-02 -8.57903527e-02]
 [ 2.20984443e-01 -1.06630795e-01  3.59866990e-02]
 [-4.79139888e-02 -8.34144092e-02 -1.75617700e-03]
 [-1.89770613e-01  1.44162348e-01  2.42425148e-02]
 [ 1.31343250e-01 -1.45299603e-01 -1.14889639e-01]
 [-1.51707991e-01 -2.29239648e-01  1.03177135e-02]
 [-3.91633418e-02 -1.64310117e-02  5.57875673e-03]
 [-3.75825238e-02  8.05504392e-02 -2.48912368e-02]
 [-1.59990655e-01  9.61870653e-02  9.46199451e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.26023247 -29.25593426 -29.27334937]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  8.31486419  -9.25153874 -83.50871763]
init_Out:  [2.49911038]
Stock Position:  8.31486419409362
Bond position:  [-828.98730903]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-0.7955246]
curr_Stock_Price:  99.61622883785218
curr_Factors:  [99.61622884 -1.00373985 -1.03585215]
mat_Sqrt:  [[12.9582557   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00062651 -0.00921998 -0.10521141]
Stock Position:  0.0006265059347432702
Bond Position:  [-0.85793476]


portfolio before change:  [-0.79601347]
curr_Stock_Price:  99.00710652608161
curr_Factors:  [99.00710653 -0.8846258  -1.03166874]
mat_Sqrt:  [[14.56901625  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0020742   0.00384688  0.28898272]
Stock Position:  -0.002074203259983533
Bond Position:  [-0.59065261]


portfolio before change:  [-0.79488219]
curr_Stock_Price:  98.4261059531361
curr_Factors:  [98.42610595 -0.31607141 -1.09824777]
mat_Sqrt:  [[23.92650609  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01126087 -0.04213521 -0.09445269]
Stock Position:  -0.011260867075836945
Bond Position:  [0.3134811]


portfolio before change:  [-0.79313286]
curr_Stock_Price:  98.2742398682337
curr_Factors:  [98.27423987 -0.37749292 -1.0957715 ]
mat_Sqrt:  [[22.52211042  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0003347   0.01049224 -0.22047683]
Stock Position:  0.000334700213766588
Bond Position:  [-0.82602527]


portfolio before change:  [-0.79312277]
curr_Stock_Price:  98.61291216594284
curr_Factors:  [98.61291217 -0.22205771 -1.08166514]
mat_Sqrt:  [[26.77528753  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00198404  0.00925401 -0.21534974]
Stock Position:  0.0019840434758272504
Bond Position:  [-0.98877507]


portfolio before change:  [-0.79090101]
curr_Stock_Price:  99.79502519970124
curr_Factors:  [99.7950252  -0.35904526 -1.06889888]
mat_Sqrt:  [[23.93098823  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00026943 0.01681454 0.06353936]
Stock Position:  0.000269430058688018
Bond Position:  [-0.81778879]


portfolio before change:  [-0.79053827]
curr_Stock_Price:  101.52077362886334
curr_Factors:  [101.52077363  -0.24477684  -1.07970048]
mat_Sqrt:  [[26.99863019  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00203135 0.09824541 0.2658354 ]
Stock Position:  0.0020313472877029042
Bond Position:  [-0.99676222]


portfolio before change:  [-0.78957559]
curr_Stock_Price:  102.05602855722124
curr_Factors:  [102.05602856  -0.39821404  -1.08244594]
mat_Sqrt:  [[23.21647095  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00094322  0.01144147 -0.05407111]
Stock Position:  0.0009432249692207771
Bond Position:  [-0.88583738]


portfolio before change:  [-0.78900978]
curr_Stock_Price:  102.77329294677989
curr_Factors:  [102.77329295  -0.40322139  -1.06608084]
mat_Sqrt:  [[23.64669352  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00079925  0.06697035  0.22017997]
Stock Position:  -0.0007992528294037715
Bond Position:  [-0.70686794]


portfolio before change:  [-0.78919967]
curr_Stock_Price:  102.90031570248281
curr_Factors:  [102.9003157   -0.49053684  -1.03986522]
mat_Sqrt:  [[22.27263176  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00095284 -0.02535726 -0.11916602]
Stock Position:  0.000952835546954788
Bond Position:  [-0.88724675]


portfolio before change:  [-0.78984461]
curr_Stock_Price:  102.33985792684754
curr_Factors:  [102.33985793  -0.34587725  -1.07083201]
mat_Sqrt:  [[24.81851501  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00263016  0.02179342  0.05573485]
Stock Position:  -0.002630157965403255
Bond Position:  [-0.52067461]


portfolio before change:  [-0.79369575]
curr_Stock_Price:  103.77933681154428
curr_Factors:  [103.77933681  -0.40294419  -1.07269973]
mat_Sqrt:  [[23.72722114  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00017098 -0.05673905 -0.05781687]
Stock Position:  0.00017098295519778735
Bond Position:  [-0.81144025]


portfolio before change:  [-0.79415375]
curr_Stock_Price:  101.69396459019866
curr_Factors:  [ 1.01693965e+02 -3.24666340e-02 -1.06903582e+00]
mat_Sqrt:  [[33.80015898  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00468915 0.01094531 0.54221537]
Stock Position:  0.004689149092413928
Bond Position:  [-1.27101191]


portfolio before change:  [-0.80156585]
curr_Stock_Price:  100.14715643516885
curr_Factors:  [100.14715644  -0.10857248  -1.07162198]
mat_Sqrt:  [[30.76710828  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00269356 -0.00640986 -0.48190739]
Stock Position:  0.0026935608869223786
Bond Position:  [-1.07131831]


portfolio before change:  [-0.80583535]
curr_Stock_Price:  98.61179859168418
curr_Factors:  [ 9.86117986e+01 -9.01607632e-02 -1.08197550e+00]
mat_Sqrt:  [[30.5405299   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00389778 -0.11387757 -0.2538366 ]
Stock Position:  -0.0038977797363691975
Bond Position:  [-0.42146828]


portfolio before change:  [-0.80370749]
curr_Stock_Price:  98.05236495144366
curr_Factors:  [98.05236495 -0.40047746 -1.10102248]
mat_Sqrt:  [[21.84564813  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.003454   -0.01388396 -0.10451688]
Stock Position:  -0.003454000506906612
Bond Position:  [-0.46503457]


portfolio before change:  [-0.80542885]
curr_Stock_Price:  98.53389988481717
curr_Factors:  [98.53389988 -0.73356989 -1.11775278]
mat_Sqrt:  [[15.47271242  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00283292  0.05988661  0.36854396]
Stock Position:  -0.002832921510681084
Bond Position:  [-0.52629004]


portfolio before change:  [-0.80634589]
curr_Stock_Price:  98.83438511254141
curr_Factors:  [98.83438511 -0.82681709 -1.11852526]
mat_Sqrt:  [[14.12721704  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01076551 0.01810203 0.36192486]
Stock Position:  0.010765514405559114
Bond Position:  [-1.87034888]


portfolio before change:  [-0.79812766]
curr_Stock_Price:  99.61948796366703
curr_Factors:  [99.61948796 -0.92835102 -1.11079038]
mat_Sqrt:  [[12.96452014  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00737295 -0.01041041  0.13175994]
Stock Position:  0.007372950887671911
Bond Position:  [-1.53261725]


portfolio before change:  [-0.80312506]
curr_Stock_Price:  98.9676717964978
curr_Factors:  [98.9676718  -1.14562699 -1.08483194]
mat_Sqrt:  [[10.63695563  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00069743 -0.01165998 -0.00260366]
Stock Position:  -0.0006974306177976991
Bond Position:  [-0.73410197]


portfolio before change:  [-0.80301321]
curr_Stock_Price:  98.67571696755132
curr_Factors:  [98.67571697 -1.03837429 -1.05641966]
mat_Sqrt:  [[12.146547    0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01251364 -0.02066645  0.45741126]
Stock Position:  0.012513642452589095
Bond Position:  [-2.03780585]


portfolio before change:  [-0.81280577]
curr_Stock_Price:  97.9135233782232
curr_Factors:  [97.91352338 -1.02681814 -1.07153895]
mat_Sqrt:  [[12.00985529  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00108637 -0.02627363  0.55012222]
Stock Position:  0.0010863692274857475
Bond Position:  [-0.91917601]


portfolio before change:  [-0.81271178]
curr_Stock_Price:  98.10580914022391
curr_Factors:  [98.10580914 -0.97671726 -1.0971589 ]
mat_Sqrt:  [[12.33166592  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-6.90035394e-03 -1.80972790e-04 -2.34175362e-01]
Stock Position:  -0.006900353943097168
Bond Position:  [-0.13574697]


portfolio before change:  [-0.81432132]
curr_Stock_Price:  98.33660535686222
curr_Factors:  [98.33660536 -0.94964644 -1.10842562]
mat_Sqrt:  [[12.5575776   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02454256  0.03598227  0.19254621]
Stock Position:  -0.02454256429427049
Bond Position:  [1.59911114]


portfolio before change:  [-0.82510266]
curr_Stock_Price:  98.78404184867053
curr_Factors:  [98.78404185 -0.91348359 -1.08615458]
mat_Sqrt:  [[13.37380442  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00094723 -0.04374107  0.27848464]
Stock Position:  -0.0009472269070449399
Bond Position:  [-0.73153176]


portfolio before change:  [-0.82470226]
curr_Stock_Price:  98.26479513070397
curr_Factors:  [98.26479513 -1.01520698 -1.07346564]
mat_Sqrt:  [[12.17023491  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01723206  0.01272442 -0.38464067]
Stock Position:  0.01723205834012291
Bond Position:  [-2.51800695]


portfolio before change:  [-0.82909066]
curr_Stock_Price:  98.02839707919458
curr_Factors:  [98.02839708 -0.99521145 -1.07212426]
mat_Sqrt:  [[12.40279054  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00218054  0.01905256  0.07023811]
Stock Position:  -0.002180541219716004
Bond Position:  [-0.6153357]


portfolio before change:  [-0.82839479]
curr_Stock_Price:  97.6739920379285
curr_Factors:  [97.67399204 -0.8501532  -1.06299859]
mat_Sqrt:  [[14.41808803  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00883415 -0.02609893 -0.54263757]
Stock Position:  -0.008834152024919429
Bond Position:  [0.03447211]


portfolio before change:  [-0.82926697]
curr_Stock_Price:  97.77320815825628
curr_Factors:  [97.77320816 -0.74777059 -1.05516775]
mat_Sqrt:  [[16.1143835   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00266317  0.01857066 -0.25926895]
Stock Position:  0.002663174259462022
Bond Position:  [-1.08965406]


portfolio before change:  [-0.82471096]
curr_Stock_Price:  99.53509719199828
curr_Factors:  [99.53509719 -0.88383448 -1.05720936]
mat_Sqrt:  [[14.28866379  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00315827 0.03432154 0.05887504]
Stock Position:  0.003158271794715039
Bond Position:  [-1.13906985]


portfolio before change:  [-0.82468039]
curr_Stock_Price:  99.58986367307378
curr_Factors:  [99.58986367 -0.92127522 -1.055493  ]
mat_Sqrt:  [[13.79480636  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00027679 -0.02067283 -0.244736  ]
Stock Position:  -0.00027679031805908575
Bond Position:  [-0.79711488]


portfolio before change:  [-0.82459231]
curr_Stock_Price:  98.91164770826087
curr_Factors:  [98.91164771 -0.58169926 -1.04686266]
mat_Sqrt:  [[19.40760663  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01162312 -0.03371962  0.10266004]
Stock Position:  0.011623123160884161
Bond Position:  [-1.97425458]


portfolio before change:  [-0.813619]
curr_Stock_Price:  99.876973976505
curr_Factors:  [99.87697398 -0.61751287 -1.06562802]
mat_Sqrt:  [[18.55609435  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0027175  -0.02637795 -0.00500988]
Stock Position:  -0.002717501686365224
Bond Position:  [-0.54220316]


portfolio before change:  [-0.81375643]
curr_Stock_Price:  99.90260228404861
curr_Factors:  [99.90260228 -0.61913186 -1.07342812]
mat_Sqrt:  [[18.38685043  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00984942  0.04558814  0.06915715]
Stock Position:  -0.009849423370189068
Bond Position:  [0.1702266]


portfolio before change:  [-0.81324708]
curr_Stock_Price:  99.85304955229468
curr_Factors:  [99.85304955 -0.36363765 -1.06496113]
mat_Sqrt:  [[23.92923246  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00435199 -0.04594777 -0.32774816]
Stock Position:  0.00435199421452863
Bond Position:  [-1.24780698]


portfolio before change:  [-0.80126952]
curr_Stock_Price:  102.6410933371935
curr_Factors:  [102.64109334  -0.51560447  -1.04612995]
mat_Sqrt:  [[21.53121936  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00722304 -0.07249194  0.02943356]
Stock Position:  -0.007223039076145255
Bond Position:  [-0.05988889]


portfolio before change:  [-0.79482622]
curr_Stock_Price:  101.7480093198255
curr_Factors:  [101.74800932  -0.39243759  -1.02314391]
mat_Sqrt:  [[24.70282879  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00155645 -0.00519594  0.01591464]
Stock Position:  -0.0015564545302355827
Bond Position:  [-0.63646007]


portfolio before change:  [-0.79790672]
curr_Stock_Price:  103.67606764121744
curr_Factors:  [103.67606764  -0.49590049  -1.04170498]
mat_Sqrt:  [[22.27947462  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00182157  0.02547229 -0.07100777]
Stock Position:  -0.0018215700127286608
Bond Position:  [-0.6090535]


portfolio before change:  [-0.79658963]
curr_Stock_Price:  102.91121583657015
curr_Factors:  [102.91121584  -0.67881846  -1.01278753]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-0.79658963]
Stock Price:  103.72017700698626
PL:  [-4.51676663]
Settle:  Tensor("sub_282:0", shape=(), dtype=float64)
PL:  Tensor("sub_283:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  142
output_Z_Vals[:, i, :]:  [[ 1.19260232e+02 -2.92559343e+01 -2.92733494e+01]
 [ 7.18757021e-02 -2.04757006e-01 -2.03438535e-01]
 [-3.53245893e-02  1.50544015e-02  5.25832286e-02]
 [ 8.87334047e-02  2.04558636e-01  3.84140675e-02]
 [ 2.13569333e-01 -2.75690609e-02 -5.38682447e-02]
 [ 6.81453715e-02  2.83993139e-02 -1.07261802e-01]
 [ 7.01354085e-02  1.56447722e-02 -6.52132050e-02]
 [-9.83774381e-02 -2.43311740e-02 -1.06590795e-01]
 [-6.01431292e-02 -7.16592166e-02  6.32264238e-02]
 [-5.10013330e-02 -1.14528331e-01 -1.29880647e-01]
 [ 5.98961995e-02  1.52913518e-01 -8.75523226e-02]
 [-1.77199665e-01 -9.90851314e-02  3.38851185e-02]
 [-1.02686185e-01  3.01881919e-02 -1.40013290e-02]
 [-8.72634713e-02 -1.11239395e-01  7.13106717e-02]
 [ 1.93247036e-01  1.85192946e-01 -3.30154091e-02]
 [-7.87589921e-02 -2.60857634e-01 -8.09524706e-02]
 [-6.69464708e-02 -5.29785355e-02 -4.43753493e-02]
 [-7.62366660e-02  1.42063871e-01  1.12993198e-01]
 [ 1.02797907e-01  5.95971549e-02  1.05778364e-01]
 [ 8.72841591e-02 -3.17282552e-02  4.44674226e-02]
 [-3.38648382e-02 -2.58033145e-02  1.29948162e-04]
 [ 1.02928578e-01 -6.25768756e-02  1.06956437e-01]
 [-5.39588318e-02  1.72024776e-02  2.79859527e-01]
 [ 2.74288377e-02 -1.39071885e-02 -6.71619410e-02]
 [-7.78534517e-03  5.27844208e-02  7.95465086e-02]
 [ 5.96365042e-02 -3.84721991e-02  6.91737239e-02]
 [-1.48478322e-01  6.54614092e-02  4.18303083e-02]
 [-4.48665442e-02  6.89887288e-02  2.76240218e-02]
 [-5.74134399e-02 -5.09890705e-02 -2.32922574e-01]
 [ 7.21706621e-03 -5.09686533e-03 -1.14302753e-01]
 [ 2.30902357e-02  1.36732091e-01  3.05170319e-02]
 [ 2.09509649e-02 -1.11296952e-01 -6.96887220e-02]
 [ 5.44825704e-03 -7.57926485e-03  7.50909075e-02]
 [-5.13673982e-02 -6.91558504e-02  1.88672501e-02]
 [-1.43452689e-01  1.02661034e-01  3.52409858e-02]
 [ 8.47165236e-02 -1.65012150e-01 -1.38726811e-01]
 [-2.09965722e-01 -3.56886151e-01  6.36473596e-02]
 [-5.36905384e-02 -4.79232717e-02  7.46709626e-02]
 [-2.54224939e-02  5.50494573e-02 -3.25211048e-02]
 [ 2.61812666e-01 -1.70096403e-02 -2.62990835e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.26023247 -29.25593426 -29.27334937]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  8.31486419  -9.25153874 -83.50871763]
init_Out:  [2.49911038]
Stock Position:  8.31486419409362
Bond position:  [-828.98730903]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-6.00124906]
curr_Stock_Price:  98.99015433616987
curr_Factors:  [98.99015434 -1.08697113 -0.97046262]
mat_Sqrt:  [[12.64910721  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00198134 -0.06474985 -0.58035351]
Stock Position:  0.0019813399792143454
Bond Position:  [-6.19738221]


portfolio before change:  [-6.00032073]
curr_Stock_Price:  99.84969831730601
curr_Factors:  [99.84969832 -1.1759084  -0.98324741]
mat_Sqrt:  [[11.52490372  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00210001  0.00476062  0.15000531]
Stock Position:  -0.0021000071114204216
Bond Position:  [-5.79063566]


portfolio before change:  [-6.00204482]
curr_Stock_Price:  100.32598803231306
curr_Factors:  [100.32598803  -1.43719821  -0.97165571]
mat_Sqrt:  [[ 9.0211412   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01129085 0.06468712 0.10958464]
Stock Position:  0.011290846966576793
Bond Position:  [-7.1348102]


portfolio before change:  [-6.0026584]
curr_Stock_Price:  100.35063892525255
curr_Factors:  [100.35063893  -1.53145657  -0.98138165]
mat_Sqrt:  [[ 8.13220596  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0248225  -0.0087181  -0.15367111]
Stock Position:  0.024822501315997357
Bond Position:  [-8.49361226]


portfolio before change:  [-6.03243242]
curr_Stock_Price:  99.19393619941444
curr_Factors:  [99.1939362 -1.4633591 -1.0143494]
mat_Sqrt:  [[ 8.32587714  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00564312  0.00898065 -0.30598807]
Stock Position:  0.005643118930929665
Bond Position:  [-6.5921956]


portfolio before change:  [-6.0307745]
curr_Stock_Price:  99.63376390406872
curr_Factors:  [99.6337639  -1.16175915 -1.03558012]
mat_Sqrt:  [[11.06914861  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00517002  0.00494731 -0.18603512]
Stock Position:  0.005170024093550192
Bond Position:  [-6.54588346]


portfolio before change:  [-6.03612277]
curr_Stock_Price:  98.75756260633084
curr_Factors:  [98.75756261 -1.07709073 -1.03506643]
mat_Sqrt:  [[11.94736587  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01010795 -0.00769419 -0.30407387]
Stock Position:  -0.010107953720400775
Bond Position:  [-5.03788589]


portfolio before change:  [-6.03807335]
curr_Stock_Price:  98.88823315719543
curr_Factors:  [98.88823316 -1.09313221 -1.03011762]
mat_Sqrt:  [[11.83120376  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00414897 -0.02266063  0.18036739]
Stock Position:  -0.0041489711056397335
Bond Position:  [-5.62778893]


portfolio before change:  [-6.03828913]
curr_Stock_Price:  98.77067690606043
curr_Factors:  [98.77067691 -1.04274949 -1.00761039]
mat_Sqrt:  [[12.71065853  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00633092 -0.03621704 -0.37051333]
Stock Position:  -0.0063309243679137775
Bond Position:  [-5.41297945]


portfolio before change:  [-6.03776734]
curr_Stock_Price:  98.58137562558515
curr_Factors:  [98.58137563 -1.18093973 -0.97236824]
mat_Sqrt:  [[11.44524525  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00401677  0.0483555  -0.24976241]
Stock Position:  0.004016765526632109
Bond Position:  [-6.43374562]


portfolio before change:  [-6.04092956]
curr_Stock_Price:  97.99435054385808
curr_Factors:  [97.99435054 -0.70119636 -0.96611727]
mat_Sqrt:  [[18.49677141  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0093444  -0.03133347  0.09666481]
Stock Position:  -0.009344401652497612
Bond Position:  [-5.12523098]


portfolio before change:  [-6.04239175]
curr_Stock_Price:  98.08226425260509
curr_Factors:  [98.08226425 -0.86874305 -0.93816319]
mat_Sqrt:  [[16.1013049   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0065066   0.00954634 -0.03994189]
Stock Position:  -0.0065065992633791285
Bond Position:  [-5.40420976]


portfolio before change:  [-6.05419091]
curr_Stock_Price:  99.7918505494631
curr_Factors:  [99.79185055 -0.66165949 -0.93465618]
mat_Sqrt:  [[20.2219947   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00373749 -0.03517699  0.2034295 ]
Stock Position:  -0.0037374864014261427
Bond Position:  [-5.68122023]


portfolio before change:  [-6.05236362]
curr_Stock_Price:  99.11292197132201
curr_Factors:  [99.11292197 -0.59462561 -0.91734301]
mat_Sqrt:  [[21.85197273  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00875388  0.05856315 -0.09418377]
Stock Position:  0.008753875777308032
Bond Position:  [-6.91998583]


portfolio before change:  [-6.05534964]
curr_Stock_Price:  98.87063358425983
curr_Factors:  [98.87063358 -0.58610241 -0.91220864]
mat_Sqrt:  [[22.09831174  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00461658 -0.08249043 -0.23093487]
Stock Position:  -0.004616581676130388
Bond Position:  [-5.59890528]


portfolio before change:  [-6.05470797]
curr_Stock_Price:  98.58003523291438
curr_Factors:  [98.58003523 -0.6697356  -0.89710727]
mat_Sqrt:  [[20.57395369  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0037607  -0.01675328 -0.12659052]
Stock Position:  -0.003760699189088378
Bond Position:  [-5.68397811]


portfolio before change:  [-6.0563885]
curr_Stock_Price:  98.83796138510233
curr_Factors:  [98.83796139 -0.63344594 -0.91049727]
mat_Sqrt:  [[21.10560296  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00234554  0.04492454  0.32233814]
Stock Position:  -0.00234553605219063
Bond Position:  [-5.8245605]


portfolio before change:  [-6.05826981]
curr_Stock_Price:  99.32961838115892
curr_Factors:  [99.32961838 -0.79280453 -0.88685519]
mat_Sqrt:  [[18.51875643  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00680006 0.01884628 0.30175623]
Stock Position:  0.006800057990530167
Bond Position:  [-6.73371698]


portfolio before change:  [-6.05834914]
curr_Stock_Price:  99.44174043699813
curr_Factors:  [99.44174044 -0.66579738 -0.90171268]
mat_Sqrt:  [[20.73995202  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00460666 -0.01003336  0.12685318]
Stock Position:  0.0046066554829070775
Bond Position:  [-6.51644298]


portfolio before change:  [-6.06016966]
curr_Stock_Price:  99.2233807789631
curr_Factors:  [99.22338078 -0.70369941 -0.93288834]
mat_Sqrt:  [[19.31314463  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00178658 -0.00815972  0.00037071]
Stock Position:  -0.001786583800445369
Bond Position:  [-5.88289877]


portfolio before change:  [-6.06175643]
curr_Stock_Price:  99.69991514313283
curr_Factors:  [99.69991514 -0.83599386 -0.92389601]
mat_Sqrt:  [[17.15474739  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00717849 -0.01978855  0.30511694]
Stock Position:  0.0071784934123706725
Bond Position:  [-6.77745162]


portfolio before change:  [-6.06375874]
curr_Stock_Price:  99.5390079090357
curr_Factors:  [99.53900791 -0.76770312 -0.92985248]
mat_Sqrt:  [[18.22864054  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [1.98117950e-04 5.43990106e-03 7.98361331e-01]
Stock Position:  0.00019811794958346748
Bond Position:  [-6.0834792]


portfolio before change:  [-6.06422509]
curr_Stock_Price:  101.02365725139994
curr_Factors:  [101.02365725  -0.71703728  -0.94033277]
mat_Sqrt:  [[19.25911914  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00069372 -0.00439784 -0.19159432]
Stock Position:  0.0006937171814500525
Bond Position:  [-6.13430693]


portfolio before change:  [-6.06481361]
curr_Stock_Price:  101.28069336516016
curr_Factors:  [101.28069337  -0.91197172  -0.94638423]
mat_Sqrt:  [[15.79257452  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00062149 0.0166919  0.22692405]
Stock Position:  0.0006214886487321953
Bond Position:  [-6.12775841]


portfolio before change:  [-6.06512524]
curr_Stock_Price:  102.01181996766036
curr_Factors:  [102.01181997  -0.9273051   -0.97070661]
mat_Sqrt:  [[15.28813407  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00475945 -0.01216598  0.19733338]
Stock Position:  0.004759454830051734
Bond Position:  [-6.55064589]


portfolio before change:  [-6.06854897]
curr_Stock_Price:  101.46452013191833
curr_Factors:  [101.46452013  -0.95244582  -0.95586849]
mat_Sqrt:  [[15.05025396  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00918586  0.02070072  0.11933023]
Stock Position:  -0.00918586089830882
Bond Position:  [-5.13651001]


portfolio before change:  [-6.07369537]
curr_Stock_Price:  101.95487050259466
curr_Factors:  [101.9548705   -1.03320698  -0.95004705]
mat_Sqrt:  [[14.03109923  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00266882  0.02181615  0.07880365]
Stock Position:  -0.002668823906638554
Bond Position:  [-5.80159577]


portfolio before change:  [-6.07236826]
curr_Stock_Price:  101.18586169142586
curr_Factors:  [101.18586169  -1.03281969  -0.94361947]
mat_Sqrt:  [[14.02049074  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00757998 -0.01612416 -0.66446327]
Stock Position:  -0.007579983839250591
Bond Position:  [-5.30538107]


portfolio before change:  [-6.07212252]
curr_Stock_Price:  101.06594680967687
curr_Factors:  [101.06594681  -0.98558371  -0.92267453]
mat_Sqrt:  [[14.99197416  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00108368 -0.00161177 -0.32607394]
Stock Position:  -0.0010836788928533538
Bond Position:  [-5.96259949]


portfolio before change:  [-6.07281612]
curr_Stock_Price:  101.01816682307216
curr_Factors:  [101.01816682  -0.8931178   -0.9195522 ]
mat_Sqrt:  [[16.48795922  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00199236 0.04323848 0.0870566 ]
Stock Position:  0.0019923573128480024
Bond Position:  [-6.2740804]


portfolio before change:  [-6.06899826]
curr_Stock_Price:  103.32807783025704
curr_Factors:  [103.32807783  -0.79781969  -0.93113398]
mat_Sqrt:  [[18.33763457  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00021007 -0.03519519 -0.19880253]
Stock Position:  0.00021006739355401184
Bond Position:  [-6.09070412]


portfolio before change:  [-6.06963541]
curr_Stock_Price:  103.9194735807306
curr_Factors:  [103.91947358  -0.76798233  -0.90837609]
mat_Sqrt:  [[19.4385438   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00105874 -0.00239677  0.21421346]
Stock Position:  0.001058743329430569
Bond Position:  [-6.17965946]


portfolio before change:  [-6.0694373]
curr_Stock_Price:  104.83624060203988
curr_Factors:  [104.8362406   -0.80892788  -0.91029889]
mat_Sqrt:  [[18.78714296  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00262423 -0.021869    0.05382301]
Stock Position:  -0.0026242272892734644
Bond Position:  [-5.79432317]


portfolio before change:  [-6.06932666]
curr_Stock_Price:  104.51806353535038
curr_Factors:  [104.51806354  -0.76662767  -0.9209499 ]
mat_Sqrt:  [[19.33239814  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00691112  0.03246427  0.10053272]
Stock Position:  -0.006911116530341217
Bond Position:  [-5.34699015]


portfolio before change:  [-6.06789879]
curr_Stock_Price:  104.21474214720807
curr_Factors:  [104.21474215  -0.662942    -0.90373768]
mat_Sqrt:  [[21.75348382  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00239679 -0.05218142 -0.39574898]
Stock Position:  0.0023967855860083233
Bond Position:  [-6.31767918]


portfolio before change:  [-6.06518994]
curr_Stock_Price:  105.67444907797628
curr_Factors:  [105.67444908  -0.6028382   -0.89938472]
mat_Sqrt:  [[23.52680036  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00876398 -0.11285731  0.1815682 ]
Stock Position:  -0.00876398475729579
Bond Position:  [-5.13906068]


portfolio before change:  [-6.06738409]
curr_Stock_Price:  105.85150613275724
curr_Factors:  [105.85150613  -0.56146645  -0.9032575 ]
mat_Sqrt:  [[24.46670665  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00162203 -0.01515467  0.21301547]
Stock Position:  -0.0016220313645926832
Bond Position:  [-5.89568963]


portfolio before change:  [-6.06996142]
curr_Stock_Price:  106.98608244902171
curr_Factors:  [106.98608245  -0.68830352  -0.91380285]
mat_Sqrt:  [[21.55466754  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00142148  0.01740817 -0.09277366]
Stock Position:  -0.0014214770728086042
Bond Position:  [-5.91788315]


portfolio before change:  [-6.07301673]
curr_Stock_Price:  108.6150424513203
curr_Factors:  [108.61504245  -0.65274     -0.90160784]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-6.07301673]
Stock Price:  107.5078022383662
PL:  [-13.58081897]
Settle:  Tensor("sub_284:0", shape=(), dtype=float64)
PL:  Tensor("sub_285:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  143
output_Z_Vals[:, i, :]:  [[ 1.19260232e+02 -2.92559343e+01 -2.92733494e+01]
 [ 2.02586423e-02 -2.40902499e-02 -4.34939855e-02]
 [-3.25130805e-02  2.79099514e-02  7.03295555e-02]
 [-9.99809623e-02  4.04768409e-02  7.86788563e-03]
 [ 1.79128109e-02  3.70441567e-02 -7.15647643e-02]
 [ 6.08873841e-02  2.89764441e-02  2.52352109e-02]
 [-6.58291995e-02 -8.28514780e-02  2.23323231e-01]
 [-3.10988234e-02 -1.06767120e-01 -4.18090910e-02]
 [ 1.43224270e-01 -9.48333952e-02 -2.27058844e-01]
 [-1.73602031e-01 -1.90460912e-01 -2.90193027e-02]
 [ 3.47678398e-01  1.33600741e-01  6.70072247e-01]
 [-3.52184907e-01 -1.53061580e-01  1.34629536e-01]
 [ 1.25711214e-01 -4.40255339e-01  1.61396335e-01]
 [-1.15267413e-01 -1.13429939e-01 -7.02332429e-02]
 [-1.95384078e-01  4.56327600e-02  3.13204209e-01]
 [ 2.92674828e-02 -6.85105379e-01  4.37680244e-02]
 [-6.62101939e-02 -2.98679219e-01 -1.18957518e-01]
 [ 2.94506764e-01 -2.54763280e-02 -3.96498499e-01]
 [-2.10773578e-01 -2.69570460e-02 -3.70746413e-01]
 [-1.13642796e-01 -5.58709076e-02  2.14187500e-01]
 [ 5.20186926e-01 -3.54765745e-01  2.19849513e-01]
 [ 9.62187275e-02  5.33978952e-01  5.41213883e-01]
 [-2.47532404e-01 -6.18001363e-03 -1.00323163e-02]
 [-2.25989584e-01 -2.69933678e-01 -4.32900516e-02]
 [-1.20269261e+00  1.75847951e-01 -3.59147406e-02]
 [-2.64926330e-01 -4.03362342e-01  1.73239227e-01]
 [-1.61291686e-04  7.67679802e-02  4.95988376e-02]
 [-2.56664717e-02 -1.93154880e-01 -1.34801987e-01]
 [-1.70036665e-01 -2.83065663e-01  2.80710650e-02]
 [ 1.90343983e-01  2.38358049e-01  2.14637367e-01]
 [ 1.03356142e-01 -1.46824964e-01  9.00829086e-02]
 [ 1.27907268e-01  1.79442425e-01  1.25728155e-01]
 [ 5.61805020e-01 -6.12806186e-01 -6.19167764e-01]
 [-3.98663091e-02 -7.55577772e-02  2.03829689e-02]
 [-6.00891942e-02 -2.69649378e-01  2.75634267e-03]
 [ 3.11074658e-01  1.71257023e-01  7.94145877e-02]
 [ 1.24668631e-02 -7.92195814e-02 -9.60138013e-02]
 [-6.37199405e-03  6.39821577e-02 -7.84646211e-03]
 [ 2.89731069e-01 -3.81021464e-01 -8.22851462e-02]
 [-2.79435522e-01  1.78572073e-01  1.31916020e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.26023247 -29.25593426 -29.27334937]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  8.31486419  -9.25153874 -83.50871763]
init_Out:  [2.49911038]
Stock Position:  8.31486419409362
Bond position:  [-828.98730903]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [2.64994238]
curr_Stock_Price:  100.03060325271527
curr_Factors:  [100.03060325  -1.24716942  -1.01662373]
mat_Sqrt:  [[10.39872315  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00103459 -0.00761801 -0.12407623]
Stock Position:  0.001034594535891436
Bond Position:  [2.54645126]


portfolio before change:  [2.64993744]
curr_Stock_Price:  99.7181477908688
curr_Factors:  [99.71814779 -1.08392957 -1.02155551]
mat_Sqrt:  [[12.14433253  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00143577  0.0088259   0.20063065]
Stock Position:  -0.0014357716406150163
Bond Position:  [2.79310993]


portfolio before change:  [2.65121575]
curr_Stock_Price:  99.07100526777215
curr_Factors:  [99.07100527 -0.6588438  -1.01621807]
mat_Sqrt:  [[18.55566152  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00524529  0.0127999   0.02244489]
Stock Position:  -0.005245290191397598
Bond Position:  [3.17087192]


portfolio before change:  [2.65269283]
curr_Stock_Price:  98.8649734943145
curr_Factors:  [98.86497349 -0.53646334 -1.01946156]
mat_Sqrt:  [[20.85993056  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00020428  0.01171439 -0.20415435]
Stock Position:  0.00020427635265283695
Bond Position:  [2.63249706]


portfolio before change:  [2.65284988]
curr_Stock_Price:  98.02282884588236
curr_Factors:  [98.02282885 -0.35932864 -1.04623787]
mat_Sqrt:  [[24.03795143  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00277838 0.00916316 0.07198903]
Stock Position:  0.0027783843700909154
Bond Position:  [2.38050479]


portfolio before change:  [2.64721702]
curr_Stock_Price:  95.88833321332073
curr_Factors:  [95.88833321 -0.26971102 -1.03805979]
mat_Sqrt:  [[25.93033481  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00086319 -0.02619994  0.63707902]
Stock Position:  -0.0008631879170280602
Bond Position:  [2.72998667]


portfolio before change:  [2.64734058]
curr_Stock_Price:  96.14055043084372
curr_Factors:  [96.14055043 -0.37064887 -1.01096035]
mat_Sqrt:  [[24.14800979  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00175542 -0.03376273 -0.1192697 ]
Stock Position:  -0.0017554152049044404
Bond Position:  [2.81610716]


portfolio before change:  [2.65154049]
curr_Stock_Price:  93.9485425657196
curr_Factors:  [93.94854257 -0.17970421 -1.01433777]
mat_Sqrt:  [[28.46585316  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00331722 -0.02998895 -0.64773568]
Stock Position:  0.0033172197383561928
Bond Position:  [2.33989253]


portfolio before change:  [2.6536206]
curr_Stock_Price:  94.48742743702542
curr_Factors:  [94.48742744 -0.4318932  -0.9936561 ]
mat_Sqrt:  [[22.71254645  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00812076 -0.06022903 -0.08278399]
Stock Position:  -0.008120764926638916
Bond Position:  [3.42093079]


portfolio before change:  [2.67631832]
curr_Stock_Price:  91.74506576238296
curr_Factors:  [91.74506576 -0.54539272 -0.99428988]
mat_Sqrt:  [[19.67465204  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.0247987  0.04224826 1.91152961]
Stock Position:  0.024798704329905063
Bond Position:  [0.40115956]


portfolio before change:  [2.66161868]
curr_Stock_Price:  91.1502853934199
curr_Factors:  [91.15028539 -0.47389138 -0.97114788]
mat_Sqrt:  [[21.48747854  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01529522 -0.04840232  0.38406059]
Stock Position:  -0.015295224189124011
Bond Position:  [4.05578273]


portfolio before change:  [2.65321491]
curr_Stock_Price:  91.73287098202988
curr_Factors:  [91.73287098 -0.43794464 -0.96781983]
mat_Sqrt:  [[22.49102416  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00654878 -0.13922096  0.46041882]
Stock Position:  0.00654877952807394
Bond Position:  [2.05247656]


portfolio before change:  [2.65844228]
curr_Stock_Price:  92.49191218521162
curr_Factors:  [92.49191219 -0.56090562 -0.9569006 ]
mat_Sqrt:  [[20.2735075   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00653722 -0.0358697  -0.20035589]
Stock Position:  -0.006537224109153376
Bond Position:  [3.26308264]


portfolio before change:  [2.66038096]
curr_Stock_Price:  92.25774973341107
curr_Factors:  [92.25774973 -0.66166118 -0.93044933]
mat_Sqrt:  [[18.77405337  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00693901  0.01443035  0.89348443]
Stock Position:  -0.0069390078680275635
Bond Position:  [3.30055821]


portfolio before change:  [2.65396965]
curr_Stock_Price:  93.24116264527454
curr_Factors:  [93.24116265 -0.7487428  -0.90830865]
mat_Sqrt:  [[17.78113094  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0011536  -0.21664934  0.12485799]
Stock Position:  0.0011535963925328647
Bond Position:  [2.54640698]


portfolio before change:  [2.65473641]
curr_Stock_Price:  93.62989478027843
curr_Factors:  [93.62989478 -0.70956172 -0.92536256]
mat_Sqrt:  [[18.25475231  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00537965 -0.09445066 -0.33935269]
Stock Position:  -0.005379648989720571
Bond Position:  [3.15843238]


portfolio before change:  [2.66020013]
curr_Stock_Price:  92.68765955924738
curr_Factors:  [92.68765956 -0.70464441 -0.92989109]
mat_Sqrt:  [[18.07807437  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01177747 -0.00805632 -1.13109985]
Stock Position:  0.011777474020464772
Bond Position:  [1.56857363]


portfolio before change:  [2.65239083]
curr_Stock_Price:  92.00793908931988
curr_Factors:  [92.00793909 -1.0136452  -0.88605843]
mat_Sqrt:  [[13.7655795   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02085985 -0.00852457 -1.05763632]
Stock Position:  -0.020859848320510996
Bond Position:  [4.57166248]


portfolio before change:  [2.68676712]
curr_Stock_Price:  90.38737098123065
curr_Factors:  [90.38737098 -0.90743983 -0.89862899]
mat_Sqrt:  [[14.85053256  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00480552 -0.01766793  0.61101732]
Stock Position:  -0.004805520303937914
Bond Position:  [3.12112547]


portfolio before change:  [2.68949106]
curr_Stock_Price:  89.90172727689354
curr_Factors:  [89.90172728 -0.99952101 -0.89781367]
mat_Sqrt:  [[13.48236408  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0412319  -0.11218678  0.62716947]
Stock Position:  0.041231901527585726
Bond Position:  [-1.01732811]


portfolio before change:  [2.73178875]
curr_Stock_Price:  90.93066028790925
curr_Factors:  [90.93066029 -0.93483118 -0.89797601]
mat_Sqrt:  [[14.54562196  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01515788 0.16885897 1.54393256]
Stock Position:  0.015157882323703301
Bond Position:  [1.3534725]


portfolio before change:  [2.73129411]
curr_Stock_Price:  90.88686568242653
curr_Factors:  [90.88686568 -1.42576137 -0.87356562]
mat_Sqrt:  [[ 9.11834666  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02738872 -0.00195429 -0.02861941]
Stock Position:  -0.02738871619417845
Bond Position:  [5.22056868]


portfolio before change:  [2.73290251]
curr_Stock_Price:  90.85196874021749
curr_Factors:  [90.85196874 -1.28750626 -0.8695046 ]
mat_Sqrt:  [[10.50887989  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02300871 -0.08536052 -0.12349447]
Stock Position:  -0.023008711546500908
Bond Position:  [4.82328925]


portfolio before change:  [2.75123875]
curr_Stock_Price:  90.08124788630181
curr_Factors:  [90.08124789 -1.25845721 -0.87340458]
mat_Sqrt:  [[10.68509976  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.1128191   0.055608   -0.10245476]
Stock Position:  -0.11281909640743813
Bond Position:  [12.91412374]


portfolio before change:  [2.70447598]
curr_Stock_Price:  90.51005060405856
curr_Factors:  [90.5100506  -1.0339021  -0.90899442]
mat_Sqrt:  [[12.96903218  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01850399 -0.12755437  0.49420329]
Stock Position:  -0.018503986121316787
Bond Position:  [4.3792727]


portfolio before change:  [2.69221847]
curr_Stock_Price:  91.20206094066634
curr_Factors:  [91.20206094 -1.04434805 -0.89274182]
mat_Sqrt:  [[13.14429233  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00090877 0.02427617 0.14149168]
Stock Position:  0.00090877234589977
Bond Position:  [2.60933656]


portfolio before change:  [2.69265343]
curr_Stock_Price:  91.32174929193324
curr_Factors:  [91.32174929 -1.1549592  -0.89327524]
mat_Sqrt:  [[11.77707137  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00493926 -0.06108094 -0.38455255]
Stock Position:  -0.004939262720464387
Bond Position:  [3.14371554]


portfolio before change:  [2.69291132]
curr_Stock_Price:  91.34910039348368
curr_Factors:  [91.34910039 -1.11834601 -0.8997619 ]
mat_Sqrt:  [[12.1409073   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0141353  -0.08951322  0.08007894]
Stock Position:  -0.014135303265276468
Bond Position:  [3.98415856]


portfolio before change:  [2.69769103]
curr_Stock_Price:  91.04619516301644
curr_Factors:  [91.04619516 -1.18590024 -0.9231725 ]
mat_Sqrt:  [[11.04849571  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.02175057 0.07537543 0.61230067]
Stock Position:  0.02175056558264815
Bond Position:  [0.71738479]


portfolio before change:  [2.72079767]
curr_Stock_Price:  92.10441838178461
curr_Factors:  [92.10441838 -1.07163445 -0.9459441 ]
mat_Sqrt:  [[12.24777594  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00963058 -0.04643013  0.25698146]
Stock Position:  0.009630583985960901
Bond Position:  [1.83377833]


portfolio before change:  [2.72204261]
curr_Stock_Price:  92.20988506012743
curr_Factors:  [92.20988506 -1.14843463 -0.94431198]
mat_Sqrt:  [[11.37389408  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01390945 0.05674468 0.35866743]
Stock Position:  0.01390944934634595
Bond Position:  [1.43945388]


portfolio before change:  [2.71320365]
curr_Stock_Price:  91.56148383166136
curr_Factors:  [91.56148383 -1.27505509 -0.94597154]
mat_Sqrt:  [[ 9.93420714  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.04223743 -0.19378633 -1.76631329]
Stock Position:  0.04223742620896827
Bond Position:  [-1.15411777]


portfolio before change:  [2.67136545]
curr_Stock_Price:  90.57435156666932
curr_Factors:  [90.57435157 -1.20061084 -0.96325792]
mat_Sqrt:  [[10.405165    0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00361902 -0.02389347  0.05814694]
Stock Position:  -0.0036190244363979323
Bond Position:  [2.99915624]


portfolio before change:  [2.66932584]
curr_Stock_Price:  91.24152816280973
curr_Factors:  [91.24152816 -1.04754199 -0.96890694]
mat_Sqrt:  [[12.14674486  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0054738  -0.08527062  0.00786308]
Stock Position:  -0.005473801900783703
Bond Position:  [3.16876389]


portfolio before change:  [2.66875981]
curr_Stock_Price:  91.41730142698682
curr_Factors:  [91.41730143 -0.74222493 -0.97259572]
mat_Sqrt:  [[16.45474848  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.02015874 0.05415623 0.22654771]
Stock Position:  0.02015873597622098
Bond Position:  [0.82590257]


portfolio before change:  [2.67016198]
curr_Stock_Price:  91.4817364536878
curr_Factors:  [91.48173645 -0.72457364 -0.99228732]
mat_Sqrt:  [[16.43278441  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00055848 -0.02505143 -0.27390065]
Stock Position:  -0.0005584758245824466
Bond Position:  [2.72125232]


portfolio before change:  [2.67038829]
curr_Stock_Price:  91.68563481093432
curr_Factors:  [91.68563481 -0.7347405  -0.98813895]
mat_Sqrt:  [[16.37058736  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00038616  0.02023293 -0.02238377]
Stock Position:  -0.0003861580576492293
Bond Position:  [2.70579343]


portfolio before change:  [2.67068512]
curr_Stock_Price:  91.7928653009194
curr_Factors:  [91.7928653  -0.90334771 -0.9940094 ]
mat_Sqrt:  [[13.76566518  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01911253 -0.12048957 -0.23473662]
Stock Position:  0.01911253457148692
Bond Position:  [0.91629081]


portfolio before change:  [2.64716448]
curr_Stock_Price:  90.55623229669578
curr_Factors:  [90.5562323  -0.59461152 -1.00553735]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [2.64716448]
Stock Price:  90.77555844610598
PL:  [2.64716448]
Settle:  Tensor("sub_286:0", shape=(), dtype=float64)
PL:  Tensor("sub_287:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  144
output_Z_Vals[:, i, :]:  [[ 1.19260232e+02 -2.92559343e+01 -2.92733494e+01]
 [-1.13660892e-01  2.97544199e-01  4.46071260e-02]
 [ 1.38030034e-01  1.21060615e-01 -2.83189577e-02]
 [ 8.90172339e-02  2.07139502e-01  3.84485477e-02]
 [ 2.22687674e-01 -2.43908511e-02 -4.74610216e-02]
 [ 7.41558248e-02  3.21894046e-02 -7.31429617e-02]
 [ 2.65732536e-02  5.83711411e-02 -2.30391869e-02]
 [-6.03871232e-02  1.16589709e-01  1.52943301e-02]
 [-2.04117679e-01 -7.41394858e-02  1.74720986e-01]
 [-9.73425880e-03 -9.17155020e-02 -1.34331255e-01]
 [ 5.23899854e-02  1.01610836e-01 -7.58489357e-02]
 [-2.85654684e-02  7.47294833e-02 -6.62132742e-03]
 [-1.05268475e-01  3.60169765e-02 -5.01576103e-02]
 [-6.85830226e-02  3.30719790e-02  1.14602872e-01]
 [ 4.67064648e-01  6.12188531e-01  9.68090104e-02]
 [-5.34176331e-02  1.75505836e-02 -1.05787923e-01]
 [-7.22638774e-02 -5.54910473e-02 -6.05968035e-02]
 [-6.40169408e-02  3.09190690e-01  1.56403332e-01]
 [ 1.62540254e-01  8.05389868e-02  2.09853245e-01]
 [ 1.52879596e-01 -5.04300457e-02  2.95933935e-02]
 [-3.06640185e-02 -1.36651356e-02 -3.02825441e-02]
 [ 9.63640288e-02 -6.36313748e-02  9.30931775e-02]
 [-2.24687057e-02 -8.03489180e-02  1.13868409e-01]
 [-1.22123509e-02 -3.92528227e-02 -5.94605926e-02]
 [-8.85057366e-02  7.38606827e-02  6.22910682e-02]
 [ 2.21332403e-02 -8.03332555e-02  8.11641533e-02]
 [-1.19508506e-01  6.20788730e-02  1.74738459e-02]
 [-4.36495399e-02  6.80351650e-02  2.72649929e-02]
 [-2.59716903e-02 -4.85907542e-02 -2.51307929e-01]
 [ 8.25573660e-03 -7.87271382e-03 -1.17597520e-01]
 [-8.74222847e-04  2.04852267e-01  2.59668308e-02]
 [ 1.70391494e-02 -9.00174231e-02 -8.13958280e-02]
 [ 5.15463895e-02 -2.70978067e-02  6.94767172e-02]
 [-5.10602525e-02 -8.64859822e-02 -1.04115403e-02]
 [-1.47378284e-01  1.14369587e-01  3.50571866e-02]
 [ 8.47165236e-02 -1.65012150e-01 -1.38726811e-01]
 [-2.16595746e-01 -3.72793582e-01  7.12190211e-02]
 [-4.37519773e-02 -2.49525818e-02  2.72183855e-02]
 [-3.44697152e-02  7.40225215e-02 -2.68443832e-02]
 [ 1.12469950e-01 -5.47819218e-03 -1.03945384e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.26023247 -29.25593426 -29.27334937]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  8.31486419  -9.25153874 -83.50871763]
init_Out:  [2.49911038]
Stock Position:  8.31486419409362
Bond position:  [-828.98730903]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [9.84348718]
curr_Stock_Price:  100.89574604150089
curr_Factors:  [100.89574604  -1.28505306  -0.97976296]
mat_Sqrt:  [[10.4779363   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00924542  0.09409174  0.12725171]
Stock Position:  -0.009245421977776188
Bond Position:  [10.77631093]


portfolio before change:  [9.84255516]
curr_Stock_Price:  101.14226168358202
curr_Factors:  [101.14226168  -1.48816879  -0.98666517]
mat_Sqrt:  [[ 8.51384868  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01590059  0.03828273 -0.0807861 ]
Stock Position:  0.01590059059584756
Bond Position:  [8.23433346]


portfolio before change:  [9.84119162]
curr_Stock_Price:  100.99177056202174
curr_Factors:  [100.99177056  -1.52301133  -0.98997531]
mat_Sqrt:  [[ 8.18294727  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01249108 0.06550326 0.109683  ]
Stock Position:  0.012491077643467637
Bond Position:  [8.57969557]


portfolio before change:  [9.8425696]
curr_Stock_Price:  101.01622423181219
curr_Factors:  [101.01622423  -1.56501252  -0.98291995]
mat_Sqrt:  [[ 7.90383957  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.02686922 -0.00771306 -0.13539308]
Stock Position:  0.026869215005924124
Bond Position:  [7.12834295]


portfolio before change:  [9.84923533]
curr_Stock_Price:  101.23114034880409
curr_Factors:  [101.23114035  -1.56558066  -0.96927587]
mat_Sqrt:  [[ 8.02490542  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00748379  0.01017918 -0.20865651]
Stock Position:  0.00748379002077084
Bond Position:  [9.09164273]


portfolio before change:  [9.84997815]
curr_Stock_Price:  101.17853286638457
curr_Factors:  [101.17853287  -1.45815483  -0.98563877]
mat_Sqrt:  [[ 8.78541538  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00266095  0.01845858 -0.06572439]
Stock Position:  0.0026609482508412378
Bond Position:  [9.58074731]


portfolio before change:  [9.85086279]
curr_Stock_Price:  101.0608945587057
curr_Factors:  [101.06089456  -1.54219797  -0.9677201 ]
mat_Sqrt:  [[ 8.21371387  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0066054   0.0368689   0.04363047]
Stock Position:  -0.006605397831227619
Bond Position:  [10.5184102]


portfolio before change:  [9.85369234]
curr_Stock_Price:  100.83158713684831
curr_Factors:  [100.83158714  -1.63803414  -0.97777488]
mat_Sqrt:  [[ 7.37165803  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02311111 -0.02344496  0.49843034]
Stock Position:  -0.023111107461112255
Bond Position:  [12.18402198]


portfolio before change:  [9.86195439]
curr_Stock_Price:  100.53999781551282
curr_Factors:  [100.53999782  -1.80434435  -0.97269047]
mat_Sqrt:  [[ 6.2558737   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00631768 -0.02900299 -0.38320968]
Stock Position:  -0.006317677957968925
Bond Position:  [10.49713372]


portfolio before change:  [9.86344057]
curr_Stock_Price:  100.51246255613381
curr_Factors:  [100.51246256  -1.73891924  -0.98202133]
mat_Sqrt:  [[ 6.61500894  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00597595  0.03213217 -0.2163759 ]
Stock Position:  0.0059759506066595375
Bond Position:  [9.26278306]


portfolio before change:  [9.86454548]
curr_Stock_Price:  100.5035924036437
curr_Factors:  [100.5035924   -1.66497919  -0.9871959 ]
mat_Sqrt:  [[ 7.08527278  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0039501   0.02363154 -0.0188888 ]
Stock Position:  -0.003950099748011952
Bond Position:  [10.2615447]


portfolio before change:  [9.86566666]
curr_Stock_Price:  100.54450295019865
curr_Factors:  [100.54450295  -1.65880402  -1.0084503 ]
mat_Sqrt:  [[ 6.98207478  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01641015  0.01138957 -0.1430857 ]
Stock Position:  -0.01641015081564922
Bond Position:  [11.51561711]


portfolio before change:  [9.86748926]
curr_Stock_Price:  100.52115992640152
curr_Factors:  [100.52115993  -2.00141539  -0.98736848]
mat_Sqrt:  [[ 5.06110269  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00876013  0.01045828  0.32693009]
Stock Position:  -0.008760125457772158
Bond Position:  [10.74806723]


portfolio before change:  [9.86841274]
curr_Stock_Price:  100.56911751021929
curr_Factors:  [100.56911751  -2.05292172  -0.9864145 ]
mat_Sqrt:  [[ 4.81390691  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.10441256 0.19359101 0.27616916]
Stock Position:  0.10441255990730615
Bond Position:  [-0.63226627]


portfolio before change:  [9.8534765]
curr_Stock_Price:  100.42682432476289
curr_Factors:  [100.42682432  -1.94443472  -0.99021297]
mat_Sqrt:  [[ 5.33762958  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01396844  0.00554998 -0.3017835 ]
Stock Position:  -0.013968438064806781
Bond Position:  [11.25628238]


portfolio before change:  [9.8557658]
curr_Stock_Price:  100.36366985744303
curr_Factors:  [100.36366986  -2.01432181  -0.98234254]
mat_Sqrt:  [[ 5.01350835  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01716681 -0.01754781 -0.17286581]
Stock Position:  -0.017166805112058432
Bond Position:  [11.57868936]


portfolio before change:  [9.8612029]
curr_Stock_Price:  100.13126316131165
curr_Factors:  [100.13126316  -1.96604238  -0.95236052]
mat_Sqrt:  [[ 5.40908017  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00445695  0.09777468  0.44617517]
Stock Position:  -0.004456945391554586
Bond Position:  [10.30748248]


portfolio before change:  [9.86266437]
curr_Stock_Price:  100.09245881287404
curr_Factors:  [100.09245881  -1.94914076  -0.9438644 ]
mat_Sqrt:  [[ 5.54606791  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.03740594 0.02546866 0.59865289]
Stock Position:  0.03740593858730259
Bond Position:  [6.118612]


portfolio before change:  [9.8752892]
curr_Stock_Price:  100.4095197578136
curr_Factors:  [100.40951976  -1.7508409   -0.94646823]
mat_Sqrt:  [[ 6.76625591  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.02329475 -0.01594738  0.08442171]
Stock Position:  0.023294747657893813
Bond Position:  [7.53627478]


portfolio before change:  [9.88627504]
curr_Stock_Price:  100.84067876138535
curr_Factors:  [100.84067876  -1.78076765  -0.94383153]
mat_Sqrt:  [[ 6.61237341  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00562555 -0.0043213  -0.08638767]
Stock Position:  -0.005625551818205216
Bond Position:  [10.4535595]


portfolio before change:  [9.88939997]
curr_Stock_Price:  100.51748271640537
curr_Factors:  [100.51748272  -1.63754519  -0.92088626]
mat_Sqrt:  [[ 7.78267582  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01461241 -0.02012201  0.26556892]
Stock Position:  0.014612408596327198
Bond Position:  [8.42059744]


portfolio before change:  [9.8975586]
curr_Stock_Price:  101.00378106559349
curr_Factors:  [101.00378107  -1.59638216  -0.93170708]
mat_Sqrt:  [[ 8.06125065  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-1.61267055e-04 -2.54085588e-02  3.24834876e-01]
Stock Position:  -0.0001612670547206566
Bond Position:  [9.91384718]


portfolio before change:  [9.89877358]
curr_Stock_Price:  101.15466702106
curr_Factors:  [101.15466702  -1.51699601  -0.92606329]
mat_Sqrt:  [[ 8.7897951   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00288553 -0.01241283 -0.16962452]
Stock Position:  -0.002885527677972522
Bond Position:  [10.19065817]


portfolio before change:  [9.899956]
curr_Stock_Price:  101.18637237910347
curr_Factors:  [101.18637238  -1.47248451  -0.90552584]
mat_Sqrt:  [[ 9.38350861  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00787377  0.0233568   0.17769908]
Stock Position:  -0.007873765982042969
Bond Position:  [10.69667382]


portfolio before change:  [9.90271651]
curr_Stock_Price:  101.0056029639576
curr_Factors:  [101.00560296  -1.34788625  -0.89574915]
mat_Sqrt:  [[10.71388531  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00341861 -0.02540361  0.23153874]
Stock Position:  0.003418611170654488
Bond Position:  [9.55741762]


portfolio before change:  [9.90372696]
curr_Stock_Price:  100.95169137412165
curr_Factors:  [100.95169137  -1.30396407  -0.88150979]
mat_Sqrt:  [[11.34943818  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0100744   0.01963106  0.04984802]
Stock Position:  -0.010074401956245156
Bond Position:  [10.92075487]


portfolio before change:  [9.90801705]
curr_Stock_Price:  100.6613600314059
curr_Factors:  [100.66136003  -0.98758568  -0.87869134]
mat_Sqrt:  [[15.57216451  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00233284  0.02151461  0.07777944]
Stock Position:  -0.0023328443565503554
Bond Position:  [10.14284434]


portfolio before change:  [9.90468711]
curr_Stock_Price:  102.63229179832018
curr_Factors:  [102.6322918   -0.82904932  -0.87578936]
mat_Sqrt:  [[18.65872638  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00420845 -0.01536575 -0.71691157]
Stock Position:  -0.00420844985897414
Bond Position:  [10.33660996]


portfolio before change:  [9.9136856]
curr_Stock_Price:  100.80113447435532
curr_Factors:  [100.80113447  -0.52483651  -0.86028082]
mat_Sqrt:  [[25.2299625   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00063227 -0.00248957 -0.33547299]
Stock Position:  -0.000632265276149962
Bond Position:  [9.97741866]


portfolio before change:  [9.91462525]
curr_Stock_Price:  101.28763851444705
curr_Factors:  [101.28763851  -0.5411237   -0.85226745]
mat_Sqrt:  [[25.14284146  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00038641 0.06477997 0.07407614]
Stock Position:  0.00038641205623244024
Bond Position:  [9.87548649]


portfolio before change:  [9.91613332]
curr_Stock_Price:  101.99557561930419
curr_Factors:  [101.99557562  -0.6689719   -0.8570187 ]
mat_Sqrt:  [[22.17440814  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-8.56818479e-05 -2.84660086e-02 -2.32199641e-01]
Stock Position:  -8.568184791214823e-05
Bond Position:  [9.92487249]


portfolio before change:  [9.91744198]
curr_Stock_Price:  101.2022562485539
curr_Factors:  [101.20225625  -0.58221015  -0.86907775]
mat_Sqrt:  [[23.70848854  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00274284 -0.00856908  0.19819774]
Stock Position:  0.0027428405025953346
Bond Position:  [9.63986033]


portfolio before change:  [9.91792659]
curr_Stock_Price:  100.93958924016286
curr_Factors:  [100.93958924  -0.78642233  -0.85403985]
mat_Sqrt:  [[19.57121814  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00283164 -0.02734927 -0.02970123]
Stock Position:  -0.0028316355841627224
Bond Position:  [10.20375072]


portfolio before change:  [9.91412627]
curr_Stock_Price:  102.73214604887382
curr_Factors:  [102.73214605  -0.99615971  -0.84652254]
mat_Sqrt:  [[16.27195091  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00843594  0.03616684  0.1000084 ]
Stock Position:  -0.008435943317369379
Bond Position:  [10.78076883]


portfolio before change:  [9.9119993]
curr_Stock_Price:  103.14403253041472
curr_Factors:  [103.14403253  -0.96887954  -0.86398197]
mat_Sqrt:  [[16.49842431  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00316021 -0.05218142 -0.39574898]
Stock Position:  0.003160207029901589
Bond Position:  [9.5860428]


portfolio before change:  [9.91815935]
curr_Stock_Price:  104.7140942142614
curr_Factors:  [104.71409421  -1.2674717   -0.85751775]
mat_Sqrt:  [[12.50644707  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01692597 -0.11788768  0.20316804]
Stock Position:  -0.016925967249932342
Bond Position:  [11.69054668]


portfolio before change:  [9.92651443]
curr_Stock_Price:  104.30681027065796
curr_Factors:  [104.30681027  -1.2308415   -0.84018272]
mat_Sqrt:  [[13.14856246  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00295396 -0.0078907   0.07764648]
Stock Position:  -0.002953959462861705
Bond Position:  [10.23463252]


portfolio before change:  [9.92618438]
curr_Stock_Price:  104.85165721813311
curr_Factors:  [104.85165722  -1.1184951   -0.84141698]
mat_Sqrt:  [[14.77053733  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00257527  0.02340798 -0.07657955]
Stock Position:  -0.002575265062071032
Bond Position:  [10.19620519]


portfolio before change:  [9.92585815]
curr_Stock_Price:  105.47327884672545
curr_Factors:  [105.47327885  -1.3503487   -0.83611903]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [9.92585815]
Stock Price:  105.64390268888386
PL:  [4.28195546]
Settle:  Tensor("sub_288:0", shape=(), dtype=float64)
PL:  Tensor("sub_289:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  145
output_Z_Vals[:, i, :]:  [[ 1.19260232e+02 -2.92559343e+01 -2.92733494e+01]
 [ 3.01216118e-03 -9.56588213e-02 -3.38382259e-02]
 [ 1.03670319e-01  6.27943016e-02 -5.29797374e-02]
 [ 8.30036513e-02  1.52457818e-01  3.77180049e-02]
 [ 2.38372079e-01 -1.20405276e-02 -2.38095321e-02]
 [ 1.97968033e-02  3.02249198e-02  7.88687508e-02]
 [ 3.24319018e-02  4.37532806e-02 -2.95211776e-02]
 [-1.14248104e-01 -5.00287210e-02 -1.17770906e-01]
 [ 2.85765096e-02 -3.14335844e-02 -1.21355006e-02]
 [-5.85259276e-02  3.46199810e-01  1.49027997e-01]
 [ 5.49064152e-02  2.15392846e-02 -7.50431074e-02]
 [-4.05435165e-02  5.49364196e-02  7.78131316e-04]
 [-6.48766007e-02 -6.60758319e-02 -6.56264211e-02]
 [ 9.65477401e-02  9.74738443e-02  2.00845215e-01]
 [ 1.67072455e-01  1.79259635e-01 -5.88163419e-03]
 [-6.89817963e-02 -8.94120707e-02 -1.21143345e-01]
 [-7.73819173e-02 -3.19564059e-02 -7.28706644e-02]
 [-2.86086325e-03 -4.86852694e-02 -1.12086198e-02]
 [ 3.43286782e-02  6.83851793e-02  3.98096906e-02]
 [ 1.08719243e-01 -3.50849896e-02  3.39731271e-02]
 [-3.77108200e-02 -1.70224674e-02 -1.60581813e-02]
 [ 1.13204984e-01 -6.07840202e-02  1.31362810e-01]
 [-3.81896068e-02 -3.32195489e-02  2.10470352e-01]
 [-6.00423666e-02 -7.69306959e-04 -8.45008199e-02]
 [-2.75108465e-01  1.09686512e-01  4.49404983e-02]
 [-2.06656223e-02 -1.28654389e-01  9.49101267e-02]
 [ 2.06125433e-01  4.35522474e-02 -1.20824283e-01]
 [ 2.18485206e-02  7.47441402e-03  1.02543594e-02]
 [-4.39210693e-02 -5.11871166e-02 -2.41357659e-01]
 [ 7.21706621e-03 -5.09686533e-03 -1.14302753e-01]
 [ 6.18140899e-02  2.56270255e-02  3.83642908e-02]
 [ 2.45046150e-02 -6.47391953e-02 -8.89779006e-02]
 [ 2.92877082e-01 -3.36181398e-01 -3.06282285e-01]
 [-4.32755946e-02 -8.19601379e-02 -8.02343511e-03]
 [-1.47410345e-01  7.98142279e-02  3.18899260e-02]
 [ 8.47165236e-02 -1.65012150e-01 -1.38726811e-01]
 [-1.04939608e-01 -2.24144793e-01  1.23467861e-03]
 [-2.77084993e-02  2.89740729e-03 -4.81901416e-02]
 [-4.74196804e-02  9.44884550e-02  6.26034959e-04]
 [-2.60286625e-01  1.45006680e-01  1.54541462e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.26023247 -29.25593426 -29.27334937]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  8.31486419  -9.25153874 -83.50871763]
init_Out:  [2.49911038]
Stock Position:  8.31486419409362
Bond position:  [-828.98730903]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [2.23424489]
curr_Stock_Price:  99.9806087513266
curr_Factors:  [99.98060875 -1.13325918 -1.0228001 ]
mat_Sqrt:  [[11.57580297  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00054985 -0.03024998 -0.09653104]
Stock Position:  -0.0005498485000718644
Bond Position:  [2.28921908]


portfolio before change:  [2.23376351]
curr_Stock_Price:  101.3765370193673
curr_Factors:  [101.37653702  -0.98347671  -1.01641601]
mat_Sqrt:  [[13.72129427  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00688545  0.0198573  -0.15113644]
Stock Position:  0.0068854450006989336
Bond Position:  [1.53574094]


portfolio before change:  [2.23817333]
curr_Stock_Price:  101.9891102154275
curr_Factors:  [101.98911022  -1.01006825  -1.01048039]
mat_Sqrt:  [[13.52199214  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00699891 0.0482114  0.10759897]
Stock Position:  0.006998913312732528
Bond Position:  [1.52436039]


portfolio before change:  [2.24300729]
curr_Stock_Price:  102.65255706931852
curr_Factors:  [102.65255707  -0.83468049  -1.04889298]
mat_Sqrt:  [[15.60789037  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01494123 -0.00380755 -0.06792197]
Stock Position:  0.014941230908011997
Bond Position:  [0.70925174]


portfolio before change:  [2.22689098]
curr_Stock_Price:  101.5679756330153
curr_Factors:  [101.56797563  -0.80827035  -1.03396103]
mat_Sqrt:  [[16.09481068  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00227876 0.00955796 0.22499059]
Stock Position:  0.002278760807097589
Bond Position:  [1.99544185]


portfolio before change:  [2.2242774]
curr_Stock_Price:  100.31158184396601
curr_Factors:  [100.31158184  -0.61434352  -1.04177172]
mat_Sqrt:  [[19.14738061  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00143809  0.013836   -0.0842157 ]
Stock Position:  0.0014380881653406662
Bond Position:  [2.0800205]


portfolio before change:  [2.22347015]
curr_Stock_Price:  99.56943642496518
curr_Factors:  [99.56943642 -0.70357577 -1.03600834]
mat_Sqrt:  [[17.48373723  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0079834  -0.01582047 -0.33596761]
Stock Position:  -0.007983403314792486
Bond Position:  [3.01837312]


portfolio before change:  [2.21937015]
curr_Stock_Price:  100.13026471472351
curr_Factors:  [100.13026471  -0.70078602  -1.03193143]
mat_Sqrt:  [[17.70336143  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00142842 -0.00994017 -0.03461921]
Stock Position:  0.0014284151285064914
Bond Position:  [2.07634257]


portfolio before change:  [2.22153663]
curr_Stock_Price:  101.46525870314636
curr_Factors:  [101.4652587   -1.05506673  -1.04544511]
mat_Sqrt:  [[12.41871505  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00154339  0.10947799  0.42513539]
Stock Position:  -0.0015433862821130752
Bond Position:  [2.37813672]


portfolio before change:  [2.22104644]
curr_Stock_Price:  101.97548479551709
curr_Factors:  [101.9754848   -0.87738667  -1.04337944]
mat_Sqrt:  [[14.93886682  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00268725  0.00681132 -0.2140771 ]
Stock Position:  0.0026872484663894827
Bond Position:  [1.94701298]


portfolio before change:  [2.21915204]
curr_Stock_Price:  101.17995148081583
curr_Factors:  [101.17995148  -0.78677801  -1.05685492]
mat_Sqrt:  [[16.01086741  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00243374  0.01737242  0.00221979]
Stock Position:  -0.0024337362793327142
Bond Position:  [2.46539736]


portfolio before change:  [2.21761874]
curr_Stock_Price:  101.93660288093615
curr_Factors:  [101.93660288  -0.74131591  -1.04554217]
mat_Sqrt:  [[17.07290994  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00468453 -0.02089501 -0.18721391]
Stock Position:  -0.004684532907880615
Bond Position:  [2.69514412]


portfolio before change:  [2.2188055]
curr_Stock_Price:  101.7551879879815
curr_Factors:  [101.75518799  -0.9031185   -1.06112849]
mat_Sqrt:  [[14.27233167  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00981352 0.03082394 0.57295549]
Stock Position:  0.009813523467694239
Bond Position:  [1.22022858]


portfolio before change:  [2.2273299]
curr_Stock_Price:  102.60828188484776
curr_Factors:  [102.60828188  -0.96182323  -1.09084223]
mat_Sqrt:  [[13.1741054   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01294208  0.05668687 -0.01677867]
Stock Position:  0.012942080741430356
Bond Position:  [0.89936523]


portfolio before change:  [2.22795128]
curr_Stock_Price:  102.64760713190807
curr_Factors:  [102.64760713  -0.87199953  -1.07290932]
mat_Sqrt:  [[14.67863424  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00654139 -0.02827458 -0.34558824]
Stock Position:  -0.006541391137029727
Bond Position:  [2.89940942]


portfolio before change:  [2.23408156]
curr_Stock_Price:  101.76586326171156
curr_Factors:  [101.76586326  -0.94941639  -1.06680011]
mat_Sqrt:  [[13.55097118  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00686901 -0.0101055  -0.20787972]
Stock Position:  -0.006869005105069583
Bond Position:  [2.93311179]


portfolio before change:  [2.23005552]
curr_Stock_Price:  102.40535945926031
curr_Factors:  [102.40535946  -1.08730918  -1.10219277]
mat_Sqrt:  [[11.46658447  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00055865 -0.01539563 -0.03197507]
Stock Position:  -0.0005586547109709855
Bond Position:  [2.28726475]


portfolio before change:  [2.23075739]
curr_Stock_Price:  101.6608081940772
curr_Factors:  [101.66080819  -1.00951533  -1.06120591]
mat_Sqrt:  [[12.8188996   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00344963 0.02162529 0.11356597]
Stock Position:  0.0034496326786291162
Bond Position:  [1.88006494]


portfolio before change:  [2.22431002]
curr_Stock_Price:  99.72367694195094
curr_Factors:  [99.72367694 -0.74000993 -1.0570793 ]
mat_Sqrt:  [[16.53226458  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00694086 -0.01109485  0.09691588]
Stock Position:  0.006940857250076704
Bond Position:  [1.53214221]


portfolio before change:  [2.22407889]
curr_Stock_Price:  99.66278285346992
curr_Factors:  [99.66278285 -0.8757896  -1.05963032]
mat_Sqrt:  [[14.38768156  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00287942 -0.00538298 -0.04580952]
Stock Position:  -0.0028794215736276793
Bond Position:  [2.51105006]


portfolio before change:  [2.22604939]
curr_Stock_Price:  99.08746080363532
curr_Factors:  [99.0874608  -0.81770818 -1.06761915]
mat_Sqrt:  [[15.03943234  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00920579 -0.01922159  0.37474153]
Stock Position:  0.009205790852801278
Bond Position:  [1.31387095]


portfolio before change:  [2.23442867]
curr_Stock_Price:  99.97983787166166
curr_Factors:  [99.97983787 -1.00167939 -1.06112811]
mat_Sqrt:  [[12.70710199  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 3.08075662e-04 -1.05049437e-02  6.00413331e-01]
Stock Position:  0.0003080756620216469
Bond Position:  [2.20362731]


portfolio before change:  [2.23464524]
curr_Stock_Price:  99.78864112041208
curr_Factors:  [99.78864112 -1.27762811 -1.0734675 ]
mat_Sqrt:  [[ 9.50633814  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00813256 -0.00024328 -0.24105732]
Stock Position:  -0.008132562349630959
Bond Position:  [3.04618258]


portfolio before change:  [2.23681748]
curr_Stock_Price:  99.56835992199201
curr_Factors:  [99.56835992 -1.33620857 -1.0598156 ]
mat_Sqrt:  [[ 9.06862149  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02901245  0.03468592  0.12820273]
Stock Position:  -0.029012450399282703
Bond Position:  [5.12553959]


portfolio before change:  [2.24016876]
curr_Stock_Price:  99.47493299757424
curr_Factors:  [99.474933   -1.57645556 -1.05051131]
mat_Sqrt:  [[ 7.19178079  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00064157 -0.04068409  0.27075217]
Stock Position:  -0.0006415679290868048
Bond Position:  [2.30398869]


portfolio before change:  [2.24092907]
curr_Stock_Price:  98.73878182113508
curr_Factors:  [98.73878182 -1.44231917 -1.04309303]
mat_Sqrt:  [[ 8.22407314  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0222015   0.01377243 -0.34467805]
Stock Position:  0.02220150407585906
Bond Position:  [0.0487796]


portfolio before change:  [2.25502063]
curr_Stock_Price:  99.3732190163144
curr_Factors:  [99.37321902 -1.23384834 -1.05750768]
mat_Sqrt:  [[10.0495377   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00240157 0.00236362 0.02925283]
Stock Position:  0.002401570317001901
Bond Position:  [2.01636885]


portfolio before change:  [2.25808657]
curr_Stock_Price:  100.544903166643
curr_Factors:  [100.54490317  -1.27708666  -1.0645613 ]
mat_Sqrt:  [[ 9.66930529  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00977419 -0.01618679 -0.68852622]
Stock Position:  -0.009774191423088956
Bond Position:  [3.2408317]


portfolio before change:  [2.25644474]
curr_Stock_Price:  100.75432809125914
curr_Factors:  [100.75432809  -1.02882823  -1.0432839 ]
mat_Sqrt:  [[12.68693886  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00128057 -0.00161177 -0.32607394]
Stock Position:  -0.0012805678457350064
Bond Position:  [2.38546749]


portfolio before change:  [2.25686796]
curr_Stock_Price:  100.65670072276153
curr_Factors:  [100.65670072  -1.41685393  -1.03755992]
mat_Sqrt:  [[ 8.64777335  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00813005 0.00810398 0.10944264]
Stock Position:  0.008130052922477603
Bond Position:  [1.43852366]


portfolio before change:  [2.24989598]
curr_Stock_Price:  99.77702588397452
curr_Factors:  [99.77702588 -1.28339221 -1.02669419]
mat_Sqrt:  [[ 9.90313675  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00047162 -0.02047233 -0.25382918]
Stock Position:  0.00047162008763183594
Bond Position:  [2.20283913]


portfolio before change:  [2.25017204]
curr_Stock_Price:  99.77848379747348
curr_Factors:  [99.7784838  -1.3151423  -1.01273944]
mat_Sqrt:  [[ 9.72860803  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.02278613 -0.10630989 -0.87373811]
Stock Position:  0.022786127855649648
Bond Position:  [-0.02339325]


portfolio before change:  [2.26151271]
curr_Stock_Price:  100.27631255950945
curr_Factors:  [100.27631256  -1.29243707  -1.01606457]
mat_Sqrt:  [[ 9.96847749  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00471783 -0.02591807 -0.02288863]
Stock Position:  -0.004717829094512834
Bond Position:  [2.73459921]


portfolio before change:  [2.26118609]
curr_Stock_Price:  100.41800134325521
curr_Factors:  [100.41800134  -1.32141496  -1.01588746]
mat_Sqrt:  [[ 9.69915785  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01431465  0.02523947  0.09097308]
Stock Position:  -0.014314649648571418
Bond Position:  [3.6986346]


portfolio before change:  [2.25912744]
curr_Stock_Price:  100.59411548183344
curr_Factors:  [100.59411548  -1.49899056  -1.02138533]
mat_Sqrt:  [[ 8.0907212   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00644423 -0.05218142 -0.39574898]
Stock Position:  0.0064442260683350095
Bond Position:  [1.61087622]


portfolio before change:  [2.25880022]
curr_Stock_Price:  100.51209032337222
curr_Factors:  [100.51209032  -1.11028585  -1.01837048]
mat_Sqrt:  [[11.96064525  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00923654 -0.07088081  0.00352219]
Stock Position:  -0.009236539647613633
Bond Position:  [3.18718413]


portfolio before change:  [2.25634426]
curr_Stock_Price:  100.82112215445981
curr_Factors:  [100.82112215  -1.36783404  -1.00653683]
mat_Sqrt:  [[ 9.38372693  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00399313  0.00091624 -0.13747306]
Stock Position:  -0.003993131970871306
Bond Position:  [2.65893631]


portfolio before change:  [2.25623684]
curr_Stock_Price:  100.93126333992797
curr_Factors:  [100.93126334  -1.27888928  -1.00440642]
mat_Sqrt:  [[10.28970655  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00435894  0.02987987  0.0017859 ]
Stock Position:  -0.004358939679459696
Bond Position:  [2.69619013]


portfolio before change:  [2.2534526]
curr_Stock_Price:  101.64732919310539
curr_Factors:  [101.64732919  -1.24521822  -1.0380658 ]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [2.2534526]
Stock Price:  101.10149916137576
PL:  [1.15195343]
Settle:  Tensor("sub_290:0", shape=(), dtype=float64)
PL:  Tensor("sub_291:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  146
output_Z_Vals[:, i, :]:  [[ 1.19260232e+02 -2.92559343e+01 -2.92733494e+01]
 [-6.99495888e-03 -5.40184881e-02 -2.42724669e-02]
 [ 4.05909592e-02  3.34039291e-02 -2.31129982e-02]
 [ 8.14938757e-02  1.38729384e-01  3.75345942e-02]
 [ 2.25945338e-01 -2.18256787e-02 -4.25485876e-02]
 [-4.96184003e-04  2.99305605e-02  1.08032018e-01]
 [-9.17856526e-03  5.77436256e-02  3.67193790e-02]
 [ 1.29681993e-01  2.44322122e-01  1.34232865e-01]
 [ 4.57731232e-02  1.35871136e-02 -7.68443553e-02]
 [-7.58851280e-02  4.50806698e-01  2.19216837e-01]
 [ 3.97811907e-02 -4.51054321e-02 -5.32463740e-02]
 [-1.10304891e-01  1.18931891e-01  4.45258188e-02]
 [ 2.39902183e-02 -1.95709262e-01 -1.37505911e-02]
 [ 3.79681018e-01  2.80475153e-01  3.65840352e-01]
 [-3.15312086e-02 -1.22150541e-01 -9.10106527e-02]
 [-5.06647622e-02 -6.77342089e-02 -1.28189172e-01]
 [-8.93113836e-02  2.49676056e-02 -9.23716411e-02]
 [ 1.26242750e-02 -2.01902858e-01 -7.02981486e-02]
 [ 2.45814407e-02  6.56527460e-02  2.63276529e-02]
 [ 3.14965488e-01 -1.10819696e-01 -6.87506617e-02]
 [-1.27752886e-02  1.40404427e-02  5.80013028e-02]
 [ 8.51970358e-02 -5.81113794e-02  8.88314586e-02]
 [-8.61697795e-02  1.22934147e-01  3.97674689e-01]
 [-3.12384156e-02 -7.47784183e-03 -7.95747742e-02]
 [ 9.44122377e-02  2.90694687e-02  9.65022944e-02]
 [ 5.50823021e-02 -4.34088948e-02  7.06130967e-02]
 [-1.12336279e-01  5.88786961e-02  1.11837171e-02]
 [-4.86976684e-02  7.19905431e-02  2.87542433e-02]
 [-9.60173706e-02 -9.29793384e-02 -1.76073264e-01]
 [ 1.98283784e-02 -2.50975286e-03 -1.26152257e-01]
 [ 3.26753081e-02  1.30757370e-01  1.35673944e-02]
 [ 1.53873123e-02 -7.28223019e-02 -9.16212347e-02]
 [-3.71098981e-02  1.04404051e-02  8.02739718e-02]
 [-5.07060519e-02 -8.61401901e-02 -9.43713530e-03]
 [-1.84094658e-01  1.90158637e-01  3.02572231e-02]
 [ 8.47165236e-02 -1.65012150e-01 -1.38726811e-01]
 [-1.97487119e-01 -3.31434823e-01  5.14894890e-02]
 [-4.64578339e-02 -2.88692663e-02  3.98357916e-02]
 [-3.54303192e-02  7.60370185e-02 -2.62416477e-02]
 [-7.14408768e-02  5.27079484e-02  4.22459097e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.26023247 -29.25593426 -29.27334937]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  8.31486419  -9.25153874 -83.50871763]
init_Out:  [2.49911038]
Stock Position:  8.31486419409362
Bond position:  [-828.98730903]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [4.67984778]
curr_Stock_Price:  100.2747329639756
curr_Factors:  [100.27473296  -0.93686105  -0.985744  ]
mat_Sqrt:  [[14.66272702  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00091008 -0.01708215 -0.06924259]
Stock Position:  -0.0009100835598916643
Bond Position:  [4.77110616]


portfolio before change:  [4.67980443]
curr_Stock_Price:  100.97771810969442
curr_Factors:  [100.97771811  -0.85916422  -1.00626256]
mat_Sqrt:  [[15.63439181  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00234966  0.01056325 -0.06593495]
Stock Position:  0.002349661207906377
Bond Position:  [4.442541]


portfolio before change:  [4.681501]
curr_Stock_Price:  101.46341636888994
curr_Factors:  [101.46341637  -0.81066635  -0.98873552]
mat_Sqrt:  [[16.78182472  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00552607 0.04387008 0.10707575]
Stock Position:  0.0055260718957993275
Bond Position:  [4.12080687]


portfolio before change:  [4.68181551]
curr_Stock_Price:  101.42711098670074
curr_Factors:  [101.42711099  -0.85300344  -0.9942388 ]
mat_Sqrt:  [[15.99215327  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01355018 -0.00690189 -0.12137928]
Stock Position:  0.01355018326360045
Bond Position:  [3.30745957]


portfolio before change:  [4.68898693]
curr_Stock_Price:  101.92584653655467
curr_Factors:  [101.92584654  -0.66447303  -0.99786166]
mat_Sqrt:  [[19.33488266  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00115483 0.00946487 0.30818528]
Stock Position:  0.0011548331362573434
Bond Position:  [4.57127958]


portfolio before change:  [4.68947676]
curr_Stock_Price:  101.85517359204336
curr_Factors:  [101.85517359  -0.48457129  -0.99586523]
mat_Sqrt:  [[23.17595734  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-8.29822928e-06  1.82601377e-02  1.04750168e-01]
Stock Position:  -8.298229281870368e-06
Bond Position:  [4.69032198]


portfolio before change:  [4.69006142]
curr_Stock_Price:  102.0556913750257
curr_Factors:  [102.05569138  -0.62170261  -0.96933324]
mat_Sqrt:  [[20.79022259  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00785901 0.07726144 0.382929  ]
Stock Position:  0.007859008307548319
Bond Position:  [3.88800489]


portfolio before change:  [4.68378198]
curr_Stock_Price:  101.19483590830959
curr_Factors:  [101.19483591  -0.70916854  -0.97904161]
mat_Sqrt:  [[18.70587376  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0016272   0.00429662 -0.21921556]
Stock Position:  0.0016271975842521908
Bond Position:  [4.51911799]


portfolio before change:  [4.68354573]
curr_Stock_Price:  100.70247242471248
curr_Factors:  [100.70247242  -0.58996574  -0.97135423]
mat_Sqrt:  [[21.13330804  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00092261  0.1425576   0.62536462]
Stock Position:  -0.0009226146477362339
Bond Position:  [4.77645531]


portfolio before change:  [4.68237314]
curr_Stock_Price:  102.62059058319885
curr_Factors:  [102.62059058  -0.40920944  -0.9623238 ]
mat_Sqrt:  [[26.03665539  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00106572 -0.01426359 -0.15189708]
Stock Position:  0.001065716870430051
Bond Position:  [4.57300865]


portfolio before change:  [4.68427478]
curr_Stock_Price:  103.86854866834048
curr_Factors:  [103.86854867  -0.42227313  -0.95433044]
mat_Sqrt:  [[26.2200025   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00374315  0.03760957  0.12701977]
Stock Position:  -0.003743145648694964
Bond Position:  [5.07306988]


portfolio before change:  [4.68193714]
curr_Stock_Price:  104.66248266470282
curr_Factors:  [104.66248266  -0.46546709  -0.95558175]
mat_Sqrt:  [[25.27186906  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00063827 -0.0618887  -0.03922661]
Stock Position:  0.000638266969041083
Bond Position:  [4.61513453]


portfolio before change:  [4.6821051]
curr_Stock_Price:  104.02174197405097
curr_Factors:  [104.02174197  -0.52281218  -0.9294275 ]
mat_Sqrt:  [[24.345822    0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01896012 0.08869403 1.04364069]
Stock Position:  0.018960119920979294
Bond Position:  [2.7098404]


portfolio before change:  [4.73345392]
curr_Stock_Price:  106.71212916610553
curr_Factors:  [106.71212917  -0.73019828  -0.94931728]
mat_Sqrt:  [[19.8980009   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00267678 -0.03862739 -0.25962806]
Stock Position:  -0.0026767811483841184
Bond Position:  [5.01909893]


portfolio before change:  [4.73772401]
curr_Stock_Price:  105.35129179959473
curr_Factors:  [105.3512918   -0.81810709  -0.92181485]
mat_Sqrt:  [[18.49274447  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00424924 -0.02141944 -0.36568803]
Stock Position:  -0.004249242575575013
Bond Position:  [5.1853872]


portfolio before change:  [4.74077951]
curr_Stock_Price:  104.78477137079064
curr_Factors:  [104.78477137  -0.67710772  -0.91501619]
mat_Sqrt:  [[21.32296234  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00504255  0.00789545 -0.26351058]
Stock Position:  -0.00504254537200537
Bond Position:  [5.26916147]


portfolio before change:  [4.74978942]
curr_Stock_Price:  103.12861775446123
curr_Factors:  [103.12861775  -0.77554891  -0.87973786]
mat_Sqrt:  [[19.70140888  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00035218 -0.06384729 -0.20054105]
Stock Position:  -0.00035217704087670313
Bond Position:  [4.78610895]


portfolio before change:  [4.75050654]
curr_Stock_Price:  102.79124122651643
curr_Factors:  [102.79124123  -0.91418467  -0.9037795 ]
mat_Sqrt:  [[16.68876897  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00189653 0.02076122 0.07510547]
Stock Position:  0.0018965267579551118
Bond Position:  [4.5555602]


portfolio before change:  [4.7501509]
curr_Stock_Price:  102.30344388514419
curr_Factors:  [102.30344389  -0.74683032  -0.87427615]
mat_Sqrt:  [[20.22332967  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01473894 -0.03504426 -0.1961265 ]
Stock Position:  0.014738941140174076
Bond Position:  [3.24230646]


portfolio before change:  [4.7485155]
curr_Stock_Price:  102.16498655450793
curr_Factors:  [102.16498655  -0.67402503  -0.87671403]
mat_Sqrt:  [[21.66829144  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-2.64579950e-05  4.43997782e-03  1.65461573e-01]
Stock Position:  -2.645799497459381e-05
Bond Position:  [4.75121858]


portfolio before change:  [4.74917153]
curr_Stock_Price:  99.81829682260272
curr_Factors:  [99.81829682 -0.41598086 -0.84564344]
mat_Sqrt:  [[28.26790888  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00360229 -0.01837643  0.25341143]
Stock Position:  0.0036022916470484644
Bond Position:  [4.38959691]


portfolio before change:  [4.74393161]
curr_Stock_Price:  98.21136285294119
curr_Factors:  [98.21136285 -0.26392873 -0.83098028]
mat_Sqrt:  [[32.85858013  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-5.54079788e-05  3.88751908e-02  1.13445520e+00]
Stock Position:  -5.540797884368958e-05
Bond Position:  [4.74937331]


portfolio before change:  [4.74448446]
curr_Stock_Price:  98.94883382393078
curr_Factors:  [98.94883382 -0.28654047 -0.83628643]
mat_Sqrt:  [[32.19386762  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00148086 -0.0023647  -0.22700468]
Stock Position:  -0.0014808604549148303
Bond Position:  [4.89101388]


portfolio before change:  [4.74001052]
curr_Stock_Price:  102.38288999528936
curr_Factors:  [102.38289     -0.6839037   -0.83751034]
mat_Sqrt:  [[22.36071367  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00513674 0.00919257 0.27529418]
Stock Position:  0.00513674376597874
Bond Position:  [4.21409585]


portfolio before change:  [4.73806725]
curr_Stock_Price:  101.90202831542757
curr_Factors:  [101.90202832  -0.81187743  -0.86028268]
mat_Sqrt:  [[19.14136569  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00357212 -0.0137271   0.20143951]
Stock Position:  0.0035721237653903617
Bond Position:  [4.37406059]


portfolio before change:  [4.73469584]
curr_Stock_Price:  100.8051465290781
curr_Factors:  [100.80514653  -0.81912621  -0.86066758]
mat_Sqrt:  [[18.79133051  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0057757   0.01861908  0.03190403]
Stock Position:  -0.005775704430724782
Bond Position:  [5.31691658]


portfolio before change:  [4.74031986]
curr_Stock_Price:  99.9464876509404
curr_Factors:  [99.94648765 -0.83482599 -0.84905048]
mat_Sqrt:  [[18.55535535  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00220796  0.02276541  0.08202785]
Stock Position:  -0.0022079579942905028
Bond Position:  [4.96099751]


portfolio before change:  [4.74450184]
curr_Stock_Price:  98.33331720445648
curr_Factors:  [98.3333172  -0.72101046 -0.84866767]
mat_Sqrt:  [[20.4643586   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00656551 -0.02940265 -0.50228801]
Stock Position:  -0.006565507083445622
Bond Position:  [5.39010993]


portfolio before change:  [4.74475619]
curr_Stock_Price:  98.39720403061021
curr_Factors:  [98.39720403 -0.59047733 -0.80148754]
mat_Sqrt:  [[24.46020524  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-2.44770831e-04 -7.93653539e-04 -3.59877276e-01]
Stock Position:  -0.00024477083134648634
Bond Position:  [4.76884096]


portfolio before change:  [4.74523701]
curr_Stock_Price:  98.86835196330017
curr_Factors:  [98.86835196 -0.50634461 -0.81562253]
mat_Sqrt:  [[26.35932344  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00147276 0.04134911 0.038704  ]
Stock Position:  0.001472757134555633
Bond Position:  [4.59962794]


portfolio before change:  [4.74875376]
curr_Stock_Price:  100.86580004223364
curr_Factors:  [100.86580004  -0.58853143  -0.80381625]
mat_Sqrt:  [[25.06426769  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-2.07269479e-04 -2.30284339e-02 -2.61369880e-01]
Stock Position:  -0.00020726947914873273
Bond Position:  [4.76966016]


portfolio before change:  [4.74897709]
curr_Stock_Price:  102.66498660277682
curr_Factors:  [102.6649866   -0.59910104  -0.79736126]
mat_Sqrt:  [[25.40659623  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00080509  0.00330155  0.2289993 ]
Stock Position:  -0.0008050851018569992
Bond Position:  [4.83163114]


portfolio before change:  [4.74932859]
curr_Stock_Price:  102.97859945263713
curr_Factors:  [102.97859945  -0.5219606   -0.77781694]
mat_Sqrt:  [[28.07118623  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00195419 -0.02723992 -0.02692152]
Stock Position:  -0.001954193482565983
Bond Position:  [4.9505687]


portfolio before change:  [4.75041788]
curr_Stock_Price:  102.73787140806259
curr_Factors:  [102.73787141  -0.3487467   -0.77563954]
mat_Sqrt:  [[33.37458115  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00518384  0.06013344  0.08631544]
Stock Position:  -0.005183841935467816
Bond Position:  [5.28299477]


portfolio before change:  [4.74457384]
curr_Stock_Price:  103.99262722430608
curr_Factors:  [103.99262722  -0.39797025  -0.76418401]
mat_Sqrt:  [[32.53009764  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00160278 -0.05218142 -0.39574898]
Stock Position:  0.001602775283707519
Bond Position:  [4.57789703]


portfolio before change:  [4.74710043]
curr_Stock_Price:  105.21195832451016
curr_Factors:  [105.21195832  -0.55568302  -0.775589  ]
mat_Sqrt:  [[27.79079776  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00703594 -0.10480889  0.14688518]
Stock Position:  -0.007035943438794398
Bond Position:  [5.48736582]


portfolio before change:  [4.75572215]
curr_Stock_Price:  104.08406965819748
curr_Factors:  [104.08406966  -0.63678502  -0.77514702]
mat_Sqrt:  [[25.36237794  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00154054 -0.00912926  0.11364043]
Stock Position:  -0.0015405412026325452
Bond Position:  [4.91606795]


portfolio before change:  [4.7560124]
curr_Stock_Price:  104.29457824605421
curr_Factors:  [104.29457825  -0.82431316  -0.78706815]
mat_Sqrt:  [[20.81841787  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00186487  0.02404502 -0.07486012]
Stock Position:  -0.001864868214044664
Bond Position:  [4.95050805]


portfolio before change:  [4.75694161]
curr_Stock_Price:  104.12815470992784
curr_Factors:  [104.12815471  -0.53452329  -0.79937095]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [4.75694161]
Stock Price:  102.84643451600243
PL:  [1.9105071]
Settle:  Tensor("sub_292:0", shape=(), dtype=float64)
PL:  Tensor("sub_293:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  147
output_Z_Vals[:, i, :]:  [[ 1.19260232e+02 -2.92559343e+01 -2.92733494e+01]
 [ 4.03706775e-03 -1.27034308e-01 -3.91946428e-02]
 [-2.96618813e-02  5.25146992e-02  1.13807702e-01]
 [-1.10924202e-01  2.92257215e-02  6.84215035e-03]
 [ 2.14812773e-01 -2.87119115e-02 -5.70617150e-02]
 [ 4.33546098e-02  3.04288792e-02  4.55671613e-02]
 [ 6.57996618e-02  1.88941982e-02 -6.14169353e-02]
 [-1.02914412e-01  2.73445434e-01  2.86385804e-02]
 [-9.04768028e-03 -2.35887254e-02  1.02613386e-03]
 [-6.17689716e-02  2.16700773e-01  7.29835361e-02]
 [ 5.80830260e-02  1.55338598e-01 -8.54457329e-02]
 [-8.29892747e-02 -1.06952438e-01 -4.32891937e-04]
 [-1.02136123e-01  3.01356207e-02 -8.07763272e-03]
 [-9.62623594e-02 -1.14884369e-01  6.32126881e-02]
 [ 2.29343677e-01  2.45552792e-01 -1.11587008e-02]
 [-8.78089252e-02 -2.94336993e-01 -1.00603145e-01]
 [-7.01420222e-02 -6.38526138e-02 -5.53309167e-02]
 [-5.29052384e-02 -1.40808356e-01  1.25823753e-02]
 [ 9.34934987e-03  5.42940683e-02 -1.05866873e-02]
 [ 3.01096099e-01 -1.21754937e-01 -7.33227686e-02]
 [-2.10161325e-02  1.67621037e-02  4.08677137e-02]
 [ 1.49544536e-02 -1.57725954e-02  1.44298056e-02]
 [-9.32726527e-02  1.67700408e-01  2.36183697e-01]
 [ 1.99222915e-01 -2.48033175e-02  3.50041436e-02]
 [ 1.31614708e-02  1.99938517e-02  3.73152255e-02]
 [ 1.03076377e-01  9.60749646e-04  5.63149865e-02]
 [-1.33985392e-01  7.53935123e-02  8.23521687e-02]
 [-2.98631457e-02  5.63709022e-02  2.34659670e-02]
 [ 6.20848838e-02 -6.23725319e-02  9.08311027e-02]
 [ 5.00382146e-02 -5.66726603e-03  4.57461876e-02]
 [-3.81660801e-02  3.35563994e-01  1.26692292e-02]
 [ 3.22522662e-02 -1.01080442e-01 -2.56791095e-02]
 [ 9.12185765e-02 -4.38955207e-02  6.46451287e-02]
 [-4.51389319e-02 -8.14039856e-02  3.63442898e-03]
 [-1.57480079e-01  1.39400033e-01  3.41183293e-02]
 [ 1.14823241e-01 -1.52283826e-01 -1.23335231e-01]
 [-1.99431777e-01 -3.36105684e-01  5.37126894e-02]
 [-4.59723953e-02 -2.79203218e-02  3.75403747e-02]
 [-2.06482487e-02  8.62544654e-02 -2.43234428e-02]
 [-6.63736182e-01  3.32857940e-01  4.07566651e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.26023247 -29.25593426 -29.27334937]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  8.31486419  -9.25153874 -83.50871763]
init_Out:  [2.49911038]
Stock Position:  8.31486419409362
Bond position:  [-828.98730903]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [0.55480477]
curr_Stock_Price:  99.7786282883604
curr_Factors:  [99.77862829 -0.88700295 -1.01230084]
mat_Sqrt:  [[14.93414528  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00048503 -0.04017178 -0.11181141]
Stock Position:  -0.00048503056647625377
Bond Position:  [0.60320046]


portfolio before change:  [0.55499555]
curr_Stock_Price:  99.54076048674213
curr_Factors:  [99.54076049 -0.42594676 -1.03769866]
mat_Sqrt:  [[23.03285786  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-2.20339904e-04  1.66066060e-02  3.24661697e-01]
Stock Position:  -0.0002203399044168473
Bond Position:  [0.57692835]


portfolio before change:  [0.55511087]
curr_Stock_Price:  99.34470362384654
curr_Factors:  [99.34470362 -0.59936372 -1.07857878]
mat_Sqrt:  [[18.55340185  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0058627   0.00924198  0.01951875]
Stock Position:  -0.005862695699714652
Bond Position:  [1.13753864]


portfolio before change:  [0.54744827]
curr_Stock_Price:  100.67596774283207
curr_Factors:  [100.67596774  -0.76548672  -1.10629161]
mat_Sqrt:  [[15.48897986  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01306889 -0.0090795  -0.16278119]
Stock Position:  0.013068889129585908
Bond Position:  [-0.76827479]


portfolio before change:  [0.55325853]
curr_Stock_Price:  101.12790305580626
curr_Factors:  [101.12790306  -1.02148909  -1.11869754]
mat_Sqrt:  [[11.89596722  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00449242 0.00962246 0.12999043]
Stock Position:  0.0044924163714574255
Bond Position:  [0.09894988]


portfolio before change:  [0.54931779]
curr_Stock_Price:  100.2479525597328
curr_Factors:  [100.24795256  -0.86055445  -1.09890242]
mat_Sqrt:  [[14.1284398   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00380444  0.00597487 -0.17520542]
Stock Position:  0.0038044419107077774
Bond Position:  [0.16793028]


portfolio before change:  [0.55207926]
curr_Stock_Price:  100.96828925467985
curr_Factors:  [100.96828925  -0.7802823   -1.10000474]
mat_Sqrt:  [[15.40234017  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0058438   0.08647104  0.0816979 ]
Stock Position:  -0.005843803910167992
Bond Position:  [1.14211815]


portfolio before change:  [0.55478818]
curr_Stock_Price:  100.52916786209484
curr_Factors:  [100.52916786  -0.77571274  -1.08599338]
mat_Sqrt:  [[15.62296266  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0006047  -0.00745941  0.00292727]
Stock Position:  -0.0006047047581951994
Bond Position:  [0.61557864]


portfolio before change:  [0.55495752]
curr_Stock_Price:  100.37637886365428
curr_Factors:  [100.37637886  -0.80365766  -1.07299214]
mat_Sqrt:  [[15.36784142  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00268587  0.0685268   0.20820171]
Stock Position:  -0.002685873615205789
Bond Position:  [0.82455579]


portfolio before change:  [0.557126]
curr_Stock_Price:  99.60739143693826
curr_Factors:  [99.60739144 -0.67715296 -1.08697723]
mat_Sqrt:  [[17.06630712  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0026164   0.04912238 -0.24375289]
Stock Position:  0.002616401649881846
Bond Position:  [0.29651306]


portfolio before change:  [0.55529381]
curr_Stock_Price:  98.89295308712481
curr_Factors:  [98.89295309 -0.74428422 -1.10989889]
mat_Sqrt:  [[15.48473763  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00554347 -0.03382133 -0.00123492]
Stock Position:  -0.0055434674122379225
Bond Position:  [1.10350367]


portfolio before change:  [0.55964677]
curr_Stock_Price:  98.13259645622715
curr_Factors:  [98.13259646 -0.49284452 -1.12388025]
mat_Sqrt:  [[19.48402337  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00528673  0.00952972 -0.02304324]
Stock Position:  -0.005286734787477958
Bond Position:  [1.07844778]


portfolio before change:  [0.563427]
curr_Stock_Price:  97.44305647374141
curr_Factors:  [97.44305647 -0.47060617 -1.12473868]
mat_Sqrt:  [[19.76521007  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00436754 -0.03632963  0.1803282 ]
Stock Position:  -0.004367544025052569
Bond Position:  [0.98901384]


portfolio before change:  [0.56728362]
curr_Stock_Price:  96.58834459996014
curr_Factors:  [96.5883446  -0.28857873 -1.13377575]
mat_Sqrt:  [[23.29185206  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01002093  0.07765061 -0.03183267]
Stock Position:  0.01002093187678123
Bond Position:  [-0.4006216]


portfolio before change:  [0.59094116]
curr_Stock_Price:  98.95415474026464
curr_Factors:  [98.95415474 -0.40388004 -1.15265175]
mat_Sqrt:  [[20.86607979  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00555659 -0.09307753 -0.28699277]
Stock Position:  -0.00555658781717036
Bond Position:  [1.14078861]


portfolio before change:  [0.58420234]
curr_Stock_Price:  100.19258286599378
curr_Factors:  [100.19258287  -0.5777255   -1.19567826]
mat_Sqrt:  [[17.00811191  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00488503 -0.02019197 -0.1578437 ]
Stock Position:  -0.004885025809228946
Bond Position:  [1.07364569]


portfolio before change:  [0.57556589]
curr_Stock_Price:  101.98799954495591
curr_Factors:  [101.98799954  -0.42640505  -1.20237332]
mat_Sqrt:  [[20.00689157  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0026977  -0.04452751  0.03589401]
Stock Position:  -0.002697696826347913
Bond Position:  [0.8506986]


portfolio before change:  [0.57580835]
curr_Stock_Price:  101.93754370330107
curr_Factors:  [101.9375437   -0.37108388  -1.20328923]
mat_Sqrt:  [[21.11507416  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00040683  0.01716929 -0.03020087]
Stock Position:  0.00040682870118100326
Bond Position:  [0.53433723]


portfolio before change:  [0.5763045]
curr_Stock_Price:  102.99289313528621
curr_Factors:  [102.99289314  -0.59513615  -1.21365823]
mat_Sqrt:  [[16.87554639  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01676897 -0.03850229 -0.20916945]
Stock Position:  0.016768965324243126
Bond Position:  [-1.15077976]


portfolio before change:  [0.55269118]
curr_Stock_Price:  101.5933161041336
curr_Factors:  [101.5933161   -0.48790715  -1.21332934]
mat_Sqrt:  [[18.53649064  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00066039  0.00530064  0.11658421]
Stock Position:  -0.0006603865828121065
Bond Position:  [0.61978204]


portfolio before change:  [0.55228819]
curr_Stock_Price:  102.32087528070609
curr_Factors:  [102.32087528  -0.49273215  -1.19682056]
mat_Sqrt:  [[18.88864596  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00092609 -0.00498773  0.04116422]
Stock Position:  0.0009260948962480457
Bond Position:  [0.45752935]


portfolio before change:  [0.55314325]
curr_Stock_Price:  103.1824177146504
curr_Factors:  [103.18241771  -0.81749929  -1.19725454]
mat_Sqrt:  [[13.7597084   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00296023  0.05303153  0.67376635]
Stock Position:  -0.002960226368102099
Bond Position:  [0.85858657]


portfolio before change:  [0.5480859]
curr_Stock_Price:  104.92710870898759
curr_Factors:  [104.92710871  -0.89591559  -1.20673292]
mat_Sqrt:  [[12.81501321  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01605365 -0.0078435   0.09985708]
Stock Position:  0.016053646123803132
Bond Position:  [-1.13637677]


portfolio before change:  [0.54131967]
curr_Stock_Price:  104.51448141907022
curr_Factors:  [104.51448142  -1.18765173  -1.17972202]
mat_Sqrt:  [[ 9.79578198  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00217386 0.00632261 0.10644995]
Stock Position:  0.0021738589496022045
Bond Position:  [0.31411993]


portfolio before change:  [0.54142646]
curr_Stock_Price:  104.54554255073913
curr_Factors:  [104.54554255  -1.41996615  -1.15989924]
mat_Sqrt:  [[ 7.92290081  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01446395 0.00030382 0.16065098]
Stock Position:  0.01446394889998865
Bond Position:  [-0.97071492]


portfolio before change:  [0.53867407]
curr_Stock_Price:  104.36363897641142
curr_Factors:  [104.36363898  -1.61261504  -1.1371584 ]
mat_Sqrt:  [[ 6.67325598  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01726723  0.02384152  0.23492781]
Stock Position:  -0.01726723418186606
Bond Position:  [2.34074547]


portfolio before change:  [0.53662726]
curr_Stock_Price:  104.49912221556326
curr_Factors:  [104.49912222  -1.42151603  -1.16454236]
mat_Sqrt:  [[ 7.87048969  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00300079  0.01782604  0.06694187]
Stock Position:  -0.003000789748292691
Bond Position:  [0.85020716]


portfolio before change:  [0.53652887]
curr_Stock_Price:  104.56732819894734
curr_Factors:  [104.5673282  -1.3394794  -1.1652679]
mat_Sqrt:  [[ 8.54275757  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00924938 -0.01972393  0.25911585]
Stock Position:  0.009249384932081113
Bond Position:  [-0.4306546]


portfolio before change:  [0.53314152]
curr_Stock_Price:  104.20692347082712
curr_Factors:  [104.20692347  -1.26220807  -1.17773162]
mat_Sqrt:  [[ 9.08331201  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00652073 -0.00179215  0.13050114]
Stock Position:  0.00652072589938093
Bond Position:  [-0.14636327]


portfolio before change:  [0.53265017]
curr_Stock_Price:  104.13437766233191
curr_Factors:  [104.13437766  -1.0670415   -1.19100572]
mat_Sqrt:  [[10.88771337  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00247212  0.10611465  0.03614178]
Stock Position:  -0.002472122343512273
Bond Position:  [0.79008309]


portfolio before change:  [0.53064113]
curr_Stock_Price:  104.98700845068606
curr_Factors:  [104.98700845  -0.84281587  -1.18887454]
mat_Sqrt:  [[13.7652349   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00177263 -0.03196444 -0.07325535]
Stock Position:  0.0017726289677121357
Bond Position:  [0.34453812]


portfolio before change:  [0.52810385]
curr_Stock_Price:  103.53134939978828
curr_Factors:  [103.5313494   -0.57458715  -1.17668937]
mat_Sqrt:  [[17.96809965  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00574801 -0.01388098  0.18441456]
Stock Position:  0.005748010791831613
Bond Position:  [-0.06699546]


portfolio before change:  [0.53122879]
curr_Stock_Price:  104.07646186472871
curr_Factors:  [104.07646186  -0.80022779  -1.16184719]
mat_Sqrt:  [[14.62965839  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0031784  -0.0257422   0.01036801]
Stock Position:  -0.0031783995093220747
Bond Position:  [0.86202537]


portfolio before change:  [0.53281592]
curr_Stock_Price:  103.61101621153013
curr_Factors:  [103.61101621  -0.58182789  -1.1637096 ]
mat_Sqrt:  [[18.08542145  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00812347  0.04408216  0.0973301 ]
Stock Position:  -0.008123471805825407
Bond Position:  [1.37449709]


portfolio before change:  [0.53871296]
curr_Stock_Price:  102.90624208556801
curr_Factors:  [102.90624209  -0.15713582  -1.1513211 ]
mat_Sqrt:  [[27.80904673  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00308229 -0.04815637 -0.35184108]
Stock Position:  0.003082291580247506
Bond Position:  [0.22152592]


portfolio before change:  [0.54794994]
curr_Stock_Price:  105.89404670782318
curr_Factors:  [105.89404671  -0.11027567  -1.14762312]
mat_Sqrt:  [[30.10045381  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0065496  -0.10628595  0.15322735]
Stock Position:  -0.006549599980033671
Bond Position:  [1.24151358]


portfolio before change:  [0.56984202]
curr_Stock_Price:  102.57523634946035
curr_Factors:  [102.57523635  -0.14320967  -1.13122119]
mat_Sqrt:  [[28.67901553  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00136094 -0.00882918  0.10709224]
Stock Position:  -0.0013609392526540472
Bond Position:  [0.70944068]


portfolio before change:  [0.57228591]
curr_Stock_Price:  100.84466382641476
curr_Factors:  [ 1.00844664e+02 -7.42087476e-03 -1.12771985e+00]
mat_Sqrt:  [[32.40914459  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00072159  0.02727606 -0.06938801]
Stock Position:  -0.00072159170711821
Bond Position:  [0.64505458]


portfolio before change:  [0.57341625]
curr_Stock_Price:  99.38995766545634
curr_Factors:  [ 9.93899577e+01 -4.76954223e-02 -1.12982534e+00]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [0.57341625]
Stock Price:  97.66181787688978
PL:  [0.57341625]
Settle:  Tensor("sub_294:0", shape=(), dtype=float64)
PL:  Tensor("sub_295:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  148
output_Z_Vals[:, i, :]:  [[ 1.19260232e+02 -2.92559343e+01 -2.92733494e+01]
 [ 4.17138428e-02  6.52670155e-02 -6.26489369e-02]
 [-2.86358367e-02  5.44359135e-02  1.14403210e-01]
 [ 2.83923027e-02  1.70722962e-01  2.72208672e-02]
 [ 3.63215389e-02  3.09195757e-02 -7.04611829e-02]
 [ 7.05702271e-02  2.84246536e-02 -1.48466212e-01]
 [ 6.64695557e-02  1.87209547e-02 -5.88233412e-02]
 [-1.30379785e-01 -9.65554324e-04 -1.03999517e-01]
 [-1.20147103e-01 -5.84882719e-02  1.06226550e-01]
 [-4.55752099e-02  1.33509876e-01  1.61168923e-02]
 [ 5.26680363e-02  4.37069057e-02 -7.33747453e-02]
 [-4.84208426e-02  8.56808065e-02  6.33586616e-03]
 [-9.18637024e-02  4.63194986e-04 -5.58550320e-02]
 [-4.04492593e-02 -3.87817967e-02  1.05565051e-01]
 [ 2.02728960e-01  2.76268084e-01  5.81966239e-02]
 [-6.19852247e-02 -4.86135666e-02 -1.06962107e-01]
 [-7.98772830e-02 -1.97360072e-02 -7.76464903e-02]
 [ 1.68113071e-02  1.11435888e-01  2.70110057e-02]
 [ 3.62632315e-02  7.52544871e-02  5.14500558e-02]
 [ 3.54094090e-01 -1.23795048e-01 -7.44108067e-02]
 [-4.58952929e-02  1.28141245e-02 -1.83480177e-02]
 [ 4.70343237e-02 -3.79278839e-02  4.56786464e-02]
 [-6.80133740e-02  8.34443630e-02  1.55532579e-01]
 [ 1.03087306e-01 -7.10403146e-02  3.13693232e-02]
 [ 2.35103322e-03  1.46430905e-02  2.50594857e-02]
 [ 1.01177292e-01  5.08794864e-03  5.62117219e-02]
 [-1.39879332e-01  7.46038066e-02  8.21073770e-02]
 [-4.12410845e-02  6.61480595e-02  2.65544735e-02]
 [ 5.97974537e-02 -9.05213095e-02 -1.12107566e-01]
 [ 3.46617972e-02 -2.24299391e-02  3.80226346e-02]
 [-2.88250701e-02  3.21085725e-01  8.34582697e-03]
 [ 4.21229176e-02 -1.11126225e-01 -4.03449835e-02]
 [ 1.37945077e-01 -1.51060408e-01 -8.52209440e-02]
 [-7.49572926e-02 -5.14865597e-02  3.32958096e-02]
 [-1.14715512e-01  1.69489860e-02  3.65864806e-02]
 [ 8.47165236e-02 -1.65012150e-01 -1.38726811e-01]
 [-2.33067683e-01 -4.02917032e-01  8.56482932e-02]
 [-4.86814295e-02 -3.83759583e-02  5.10167788e-02]
 [-3.46864869e-02  7.44771166e-02 -2.67083688e-02]
 [ 1.45856829e-01 -8.05614891e-03 -1.39501395e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.26023247 -29.25593426 -29.27334937]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  8.31486419  -9.25153874 -83.50871763]
init_Out:  [2.49911038]
Stock Position:  8.31486419409362
Bond position:  [-828.98730903]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-3.42675062]
curr_Stock_Price:  99.299780372017
curr_Factors:  [99.29978037 -0.89411302 -0.99539437]
mat_Sqrt:  [[15.0087891   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00203953  0.02063924 -0.17871998]
Stock Position:  0.0020395295721082124
Bond Position:  [-3.62927546]


portfolio before change:  [-3.42671649]
curr_Stock_Price:  99.53896330373249
curr_Factors:  [99.5389633  -1.12047322 -1.01301977]
mat_Sqrt:  [[11.78769466  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00032897  0.01721415  0.32636051]
Stock Position:  -0.0003289744189229598
Bond Position:  [-3.39397072]


portfolio before change:  [-3.42692863]
curr_Stock_Price:  98.8941298907965
curr_Factors:  [98.89412989 -1.32693976 -0.99090397]
mat_Sqrt:  [[ 9.73965945  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00393821 0.05398734 0.07765356]
Stock Position:  0.003938206161616055
Bond Position:  [-3.8163941]


portfolio before change:  [-3.42796388]
curr_Stock_Price:  98.75239645408975
curr_Factors:  [98.75239645 -1.30820616 -0.98653308]
mat_Sqrt:  [[ 9.9530241   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00228444  0.00977763 -0.20100614]
Stock Position:  0.0022844363638824965
Bond Position:  [-3.65355745]


portfolio before change:  [-3.42604138]
curr_Stock_Price:  99.79389124451463
curr_Factors:  [99.79389124 -1.45918589 -0.98410002]
mat_Sqrt:  [[ 8.66958615  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00472902  0.00898866 -0.42353278]
Stock Position:  0.004729015815263054
Bond Position:  [-3.89796827]


portfolio before change:  [-3.42631954]
curr_Stock_Price:  99.8381114214945
curr_Factors:  [99.83811142 -1.4050133  -1.00096776]
mat_Sqrt:  [[ 9.00309969  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00610297  0.00592009 -0.16780662]
Stock Position:  0.006102971901530226
Bond Position:  [-4.03562873]


portfolio before change:  [-3.42565932]
curr_Stock_Price:  100.02895324644614
curr_Factors:  [100.02895325  -1.35296167  -0.96390441]
mat_Sqrt:  [[ 9.86105931  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.015377   -0.00030534 -0.29668167]
Stock Position:  -0.015377001943200262
Bond Position:  [-1.88751391]


portfolio before change:  [-3.43523889]
curr_Stock_Price:  100.63658897146762
curr_Factors:  [100.63658897  -1.32766727  -0.97350799]
mat_Sqrt:  [[10.07785692  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00992015 -0.01849562  0.30303478]
Stock Position:  -0.00992015074832164
Bond Position:  [-2.43690876]


portfolio before change:  [-3.43752964]
curr_Stock_Price:  100.83679929910367
curr_Factors:  [100.8367993   -1.47357815  -0.9727062 ]
mat_Sqrt:  [[ 8.7339612   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0044468   0.04221953  0.04597701]
Stock Position:  -0.004446797045814604
Bond Position:  [-2.98912886]


portfolio before change:  [-3.44017148]
curr_Stock_Price:  101.34686978527334
curr_Factors:  [101.34686979  -1.54975644  -0.99747366]
mat_Sqrt:  [[ 7.93528196  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00489195  0.01382134 -0.20931772]
Stock Position:  0.0048919479780065315
Bond Position:  [-3.9359551]


portfolio before change:  [-3.43989241]
curr_Stock_Price:  101.50449629688858
curr_Factors:  [101.5044963   -1.37484442  -0.9940979 ]
mat_Sqrt:  [[ 9.49875537  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00472854  0.02709465  0.01807446]
Stock Position:  -0.004728542709902279
Bond Position:  [-2.95992406]


portfolio before change:  [-3.4418969]
curr_Stock_Price:  101.85015775548985
curr_Factors:  [101.85015776  -1.29973736  -0.97672647]
mat_Sqrt:  [[10.45456639  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-9.87636403e-03  1.46475116e-04 -1.59338859e-01]
Stock Position:  -0.00987636403472233
Bond Position:  [-2.43598766]


portfolio before change:  [-3.42938981]
curr_Stock_Price:  100.5529592960142
curr_Factors:  [100.5529593   -1.03156458  -0.97108973]
mat_Sqrt:  [[13.5722903   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00146639 -0.01226388  0.30114771]
Stock Position:  -0.0014663866430545936
Bond Position:  [-3.28194029]


portfolio before change:  [-3.43203846]
curr_Stock_Price:  102.07942366721932
curr_Factors:  [102.07942367  -1.22473643  -0.95510631]
mat_Sqrt:  [[11.54102912  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01921332 0.08736364 0.16601877]
Stock Position:  0.019213321900263557
Bond Position:  [-5.39332329]


portfolio before change:  [-3.42334199]
curr_Stock_Price:  102.56714151738534
curr_Factors:  [102.56714152  -1.55716339  -0.96555825]
mat_Sqrt:  [[ 8.23008206  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01033695 -0.01537296 -0.30513312]
Stock Position:  -0.010336952837879249
Bond Position:  [-2.36311029]


portfolio before change:  [-3.42044763]
curr_Stock_Price:  102.25856253980537
curr_Factors:  [102.25856254  -1.67415793  -0.96862266]
mat_Sqrt:  [[ 7.27703825  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01322466 -0.00624107 -0.22150382]
Stock Position:  -0.01322466429754163
Bond Position:  [-2.06811247]


portfolio before change:  [-3.42662052]
curr_Stock_Price:  102.70578456867943
curr_Factors:  [102.70578457  -2.0267625   -0.97234733]
mat_Sqrt:  [[ 5.11797375  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00492425 0.03523912 0.07705488]
Stock Position:  0.004924247182176744
Bond Position:  [-3.93236919]


portfolio before change:  [-3.42860332]
curr_Stock_Price:  102.40295277769887
curr_Factors:  [102.40295278  -1.76179035  -0.9804563 ]
mat_Sqrt:  [[ 6.59735563  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00738303 0.02379756 0.14677269]
Stock Position:  0.007383032755340616
Bond Position:  [-4.18464767]


portfolio before change:  [-3.42455685]
curr_Stock_Price:  103.02188364270839
curr_Factors:  [103.02188364  -1.66756793  -0.99061864]
mat_Sqrt:  [[ 7.21927739  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0465017  -0.03914743 -0.21227332]
Stock Position:  0.04650170026608236
Bond Position:  [-8.2152496]


portfolio before change:  [-3.42340176]
curr_Stock_Price:  103.0688078164063
curr_Factors:  [103.06880782  -1.60489286  -0.97472917]
mat_Sqrt:  [[ 7.81288877  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00631133  0.00405218 -0.05234179]
Stock Position:  -0.006311328439351055
Bond Position:  [-2.77290066]


portfolio before change:  [-3.42008602]
curr_Stock_Price:  102.48852093142266
curr_Factors:  [102.48852093  -1.4713607   -1.00333663]
mat_Sqrt:  [[ 8.62835153  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00641828 -0.01199385  0.13030846]
Stock Position:  0.0064182763551337155
Bond Position:  [-4.07788567]


portfolio before change:  [-3.4167495]
curr_Stock_Price:  103.08779088814714
curr_Factors:  [103.08779089  -1.38640605  -0.9671655 ]
mat_Sqrt:  [[ 9.79634559  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.003482    0.02638742  0.44369116]
Stock Position:  -0.003482002014276753
Bond Position:  [-3.05779761]


portfolio before change:  [-3.4198644]
curr_Stock_Price:  103.87258378532196
curr_Factors:  [103.87258379  -1.50183107  -1.00221931]
mat_Sqrt:  [[ 8.49191569  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0126775  -0.02246492  0.08948795]
Stock Position:  0.012677503300159383
Bond Position:  [-4.73670943]


portfolio before change:  [-3.4054129]
curr_Stock_Price:  105.0592234812143
curr_Factors:  [105.05922348  -1.54094352  -0.99370963]
mat_Sqrt:  [[ 8.33006346  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00094169 0.00463055 0.07148774]
Stock Position:  0.0009416929798668151
Bond Position:  [-3.50434643]


portfolio before change:  [-3.40678406]
curr_Stock_Price:  104.06835822552259
curr_Factors:  [104.06835823  -1.15379693  -0.93601135]
mat_Sqrt:  [[12.87438524  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00876025 0.00160895 0.1603564 ]
Stock Position:  0.008760249867339483
Bond Position:  [-4.31844888]


portfolio before change:  [-3.40635107]
curr_Stock_Price:  104.17940865661855
curr_Factors:  [104.17940866  -1.29979019  -0.92381793]
mat_Sqrt:  [[11.27408106  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0107497   0.0235918   0.23422949]
Stock Position:  -0.0107496984520329
Bond Position:  [-2.28645384]


portfolio before change:  [-3.40706799]
curr_Stock_Price:  104.21951182595181
curr_Factors:  [104.21951183  -1.25577004  -0.94869935]
mat_Sqrt:  [[11.49635437  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00296727  0.02091785  0.07575252]
Stock Position:  -0.0029672658549896483
Bond Position:  [-3.09782099]


portfolio before change:  [-3.41077772]
curr_Stock_Price:  105.33922054355185
curr_Factors:  [105.33922054  -1.46913918  -0.94334205]
mat_Sqrt:  [[ 9.43762716  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00366367 -0.02862535 -0.31981168]
Stock Position:  0.003663669044459364
Bond Position:  [-3.79670576]


portfolio before change:  [-3.41284929]
curr_Stock_Price:  104.90333193797404
curr_Factors:  [104.90333194  -1.42136693  -0.94116642]
mat_Sqrt:  [[ 9.87993494  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00423525 -0.00709297  0.10846799]
Stock Position:  0.004235250203809903
Bond Position:  [-3.85714115]


portfolio before change:  [-3.41164771]
curr_Stock_Price:  105.3008873403277
curr_Factors:  [105.30088734  -1.50945813  -0.95260647]
mat_Sqrt:  [[ 8.9778214   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00209751  0.10153622  0.02380832]
Stock Position:  -0.002097511933274122
Bond Position:  [-3.19077785]


portfolio before change:  [-3.41271675]
curr_Stock_Price:  105.62039135447229
curr_Factors:  [105.62039135  -1.38850538  -0.98897373]
mat_Sqrt:  [[ 9.79990157  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00316516 -0.0351412  -0.11509301]
Stock Position:  0.003165160926620754
Bond Position:  [-3.74702229]


portfolio before change:  [-3.41337472]
curr_Stock_Price:  105.56050136478504
curr_Factors:  [105.56050136  -1.42444435  -0.96372918]
mat_Sqrt:  [[ 9.69015799  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01203789 -0.0477695  -0.24311163]
Stock Position:  0.012037890573067055
Bond Position:  [-4.68410048]


portfolio before change:  [-3.4168062]
curr_Stock_Price:  105.32408663978137
curr_Factors:  [105.32408664  -1.33166374  -0.95418901]
mat_Sqrt:  [[10.71012318  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00648827 -0.01628148  0.09498368]
Stock Position:  -0.006488271888546547
Bond Position:  [-2.73343489]


portfolio before change:  [-3.42052186]
curr_Stock_Price:  105.84409458147054
curr_Factors:  [105.84409458  -1.23304596  -0.97349183]
mat_Sqrt:  [[11.65143586  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00916709  0.00535974  0.10437105]
Stock Position:  -0.009167085310665183
Bond Position:  [-2.45024001]


portfolio before change:  [-3.41796346]
curr_Stock_Price:  105.53159721234033
curr_Factors:  [105.53159721  -1.22277804  -0.97011536]
mat_Sqrt:  [[11.77662937  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00442728 -0.05218142 -0.39574898]
Stock Position:  0.004427280067740209
Bond Position:  [-3.8851814]


portfolio before change:  [-3.41817281]
curr_Stock_Price:  105.59401264170776
curr_Factors:  [105.59401264  -1.237122    -0.97869411]
mat_Sqrt:  [[11.51655494  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01962289 -0.12741355  0.24433074]
Stock Position:  -0.019622888291641268
Bond Position:  [-1.3461133]


portfolio before change:  [-3.41943819]
curr_Stock_Price:  105.64992192916586
curr_Factors:  [105.64992193  -1.30809131  -0.97089401]
mat_Sqrt:  [[10.81728903  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00362924 -0.01213554  0.14553667]
Stock Position:  -0.003629239819662955
Bond Position:  [-3.03600928]


portfolio before change:  [-3.41894588]
curr_Stock_Price:  105.4096963745184
curr_Factors:  [105.40969637  -1.58169091  -0.97279248]
mat_Sqrt:  [[ 8.19374644  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00466396  0.02355173 -0.07619154]
Stock Position:  -0.004663961625111722
Bond Position:  [-2.9273191]


portfolio before change:  [-3.42150429]
curr_Stock_Price:  105.87978602155994
curr_Factors:  [105.87978602  -1.39331231  -0.96723692]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-3.42150429]
Stock Price:  104.87683798470843
PL:  [-8.29834228]
Settle:  Tensor("sub_296:0", shape=(), dtype=float64)
PL:  Tensor("sub_297:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  149
output_Z_Vals[:, i, :]:  [[ 1.19260232e+02 -2.92559343e+01 -2.92733494e+01]
 [ 4.41386876e-02  4.35585946e-02 -7.39676331e-02]
 [-6.83857056e-02 -1.98733911e-02  9.20270083e-02]
 [ 8.13050320e-02  1.37012223e-01  3.75116530e-02]
 [ 2.18329604e-01 -2.78225134e-02 -5.40328271e-02]
 [ 2.00752834e-02  2.89009412e-02  8.38052359e-02]
 [ 2.86800747e-02  4.87917151e-02 -2.47718816e-02]
 [-5.12989885e-02  2.87198793e-01  5.40345203e-02]
 [ 1.98909120e-02  3.73410086e-02 -3.89397944e-02]
 [-7.37615247e-02  2.82559747e-01  1.17639775e-01]
 [ 5.83283533e-02  1.34288806e-01 -8.47232622e-02]
 [-8.03516211e-02 -5.89473636e-02  5.74421929e-03]
 [-9.18470759e-02  4.19096100e-04 -5.58620987e-02]
 [ 2.56088204e-02  2.73274632e-02  1.51145741e-01]
 [ 2.12832755e-01  2.93104529e-01  6.42504897e-02]
 [-7.69271265e-02 -8.15986065e-02 -1.09154007e-01]
 [-7.22504205e-02 -5.59998951e-02 -5.62674807e-02]
 [-7.70534021e-02  1.84139880e-01  1.30489744e-01]
 [ 1.37497023e-01  6.13328202e-02  1.50691245e-01]
 [ 1.23003428e-01 -4.27082304e-02  3.54064176e-02]
 [-2.18682987e-02 -2.68789764e-02 -8.75958993e-03]
 [ 7.87400483e-02 -5.98247765e-02  7.65630339e-02]
 [-3.34138709e-02 -5.09648485e-02  2.11084858e-01]
 [-6.75437502e-02 -5.90802256e-04 -8.23151214e-02]
 [-3.02446337e-01  1.10608530e-01  6.24076606e-02]
 [-7.62713756e-02 -1.91167001e-01  1.12738905e-01]
 [ 2.09430868e-01  5.62061892e-02 -1.43361128e-01]
 [-3.75899992e-02  6.32873116e-02  2.54773653e-02]
 [-8.59154848e-02 -8.19913150e-02 -1.90949605e-01]
 [ 6.68454981e-02  6.75095441e-02 -8.52733127e-02]
 [ 4.52113458e-02  3.29620512e-02  1.78691673e-02]
 [ 3.93280641e-02 -8.69200267e-02 -8.25812817e-02]
 [ 2.62767303e-01 -2.04670735e-01 -1.03050414e-01]
 [-4.62299103e-02 -8.17703098e-02  2.87671858e-03]
 [-1.94290835e-01  1.05399009e-01  1.92576628e-02]
 [ 1.16820344e-01 -9.76292948e-02 -6.24969882e-02]
 [ 5.18344157e-03 -4.65780171e-02 -8.64641640e-02]
 [-1.36559416e-02  3.31042660e-02 -5.66707326e-02]
 [ 8.74517497e-02 -1.49615536e-01 -1.83908836e-02]
 [-8.72355655e-01  4.33606728e-01  5.33326817e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.26023247 -29.25593426 -29.27334937]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  8.31486419  -9.25153874 -83.50871763]
init_Out:  [2.49911038]
Stock Position:  8.31486419409362
Bond position:  [-828.98730903]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-4.10553244]
curr_Stock_Price:  99.21814562749461
curr_Factors:  [99.21814563 -0.86874769 -0.98427339]
mat_Sqrt:  [[15.55372005  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00193939  0.01377444 -0.21100907]
Stock Position:  0.0019393936425809084
Bond Position:  [-4.29795548]


portfolio before change:  [-4.1071633]
curr_Stock_Price:  98.65426463314095
curr_Factors:  [98.65426463 -0.60795991 -1.0109821 ]
mat_Sqrt:  [[19.54421744  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00256413 -0.00628452  0.26252744]
Stock Position:  -0.002564129267755862
Bond Position:  [-3.85420101]


portfolio before change:  [-4.11221491]
curr_Stock_Price:  100.436470383131
curr_Factors:  [100.43647038  -0.72760996  -1.00138512]
mat_Sqrt:  [[17.82372273  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.0051897  0.04332707 0.1070103 ]
Stock Position:  0.005189696221962051
Bond Position:  [-4.63344968]


portfolio before change:  [-4.11106272]
curr_Stock_Price:  100.77009535365362
curr_Factors:  [100.77009535  -0.71084592  -1.02462944]
mat_Sqrt:  [[17.76741701  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.011627   -0.00879825 -0.15414062]
Stock Position:  0.011627003793629366
Bond Position:  [-5.282717]


portfolio before change:  [-4.10693515]
curr_Stock_Price:  101.18189128080434
curr_Factors:  [101.18189128  -0.55685341  -1.00819077]
mat_Sqrt:  [[21.1549861   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00179287 0.00913928 0.23907301]
Stock Position:  0.0017928716413809945
Bond Position:  [-4.28834129]


portfolio before change:  [-4.10814445]
curr_Stock_Price:  100.80639102384762
curr_Factors:  [100.80639102  -0.65855952  -0.99530633]
mat_Sqrt:  [[19.28516039  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00129028  0.0154293  -0.07066728]
Stock Position:  0.0012902839107490577
Bond Position:  [-4.23821331]


portfolio before change:  [-4.10801507]
curr_Stock_Price:  101.31727604431529
curr_Factors:  [101.31727604  -0.73676604  -1.00461831]
mat_Sqrt:  [[17.75864768  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00185002  0.09082023  0.15414545]
Stock Position:  -0.001850016838788881
Bond Position:  [-3.9205764]


portfolio before change:  [-4.10970636]
curr_Stock_Price:  101.96656152946089
curr_Factors:  [101.96656153  -0.76175542  -1.00681034]
mat_Sqrt:  [[17.39319743  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00074204  0.01180826 -0.11108439]
Stock Position:  0.000742043002100669
Bond Position:  [-4.18536993]


portfolio before change:  [-4.1114514]
curr_Stock_Price:  100.31998437013071
curr_Factors:  [100.31998437  -0.71659229  -1.03235429]
mat_Sqrt:  [[17.45137336  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00243263  0.08935324  0.33559353]
Stock Position:  -0.002432630599391195
Bond Position:  [-3.86740993]


portfolio before change:  [-4.11113719]
curr_Stock_Price:  99.99208439734007
curr_Factors:  [99.9920844  -0.55929772 -1.01210129]
mat_Sqrt:  [[20.77378826  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0021422   0.04246585 -0.24169188]
Stock Position:  0.0021422001275039535
Bond Position:  [-4.32534025]


portfolio before change:  [-4.11340718]
curr_Stock_Price:  99.1848386836342
curr_Factors:  [99.18483868 -0.87313442 -1.04331543]
mat_Sqrt:  [[14.592903    0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00553016 -0.01864079  0.01638666]
Stock Position:  -0.005530160901904232
Bond Position:  [-3.56489906]


portfolio before change:  [-4.12238946]
curr_Stock_Price:  100.72848993421451
curr_Factors:  [100.72848993  -1.010784    -1.05773646]
mat_Sqrt:  [[12.72932275  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-8.11033392e-03  1.32529823e-04 -1.59359019e-01]
Stock Position:  -0.008110333921422271
Bond Position:  [-3.30544777]


portfolio before change:  [-4.1263707]
curr_Stock_Price:  101.16842688879329
curr_Factors:  [101.16842689  -0.98534504  -1.06296788]
mat_Sqrt:  [[13.0458986   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00438198 0.0086417  0.43117673]
Stock Position:  0.004381983138460396
Bond Position:  [-4.56968904]


portfolio before change:  [-4.12545379]
curr_Stock_Price:  101.50803561276395
curr_Factors:  [101.50803561  -1.10992621  -1.08129133]
mat_Sqrt:  [[11.3466259   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.02058019 0.09268779 0.18328876]
Stock Position:  0.02058019361321284
Bond Position:  [-6.21450881]


portfolio before change:  [-4.13923189]
curr_Stock_Price:  100.87630014957548
curr_Factors:  [100.87630015  -1.15938317  -1.07237246]
mat_Sqrt:  [[10.8280435   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00935672 -0.02580375 -0.311386  ]
Stock Position:  -0.009356719134106522
Bond Position:  [-3.19536068]


portfolio before change:  [-4.13709294]
curr_Stock_Price:  100.60500925829106
curr_Factors:  [100.60500926  -0.95709938  -1.04648716]
mat_Sqrt:  [[13.56666278  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00627876 -0.01770872 -0.16051546]
Stock Position:  -0.006278764669744864
Bond Position:  [-3.50541776]


portfolio before change:  [-4.13008198]
curr_Stock_Price:  99.41860267430636
curr_Factors:  [99.41860267 -1.10319111 -1.07206313]
mat_Sqrt:  [[11.29189259  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00404386  0.05823014  0.37225092]
Stock Position:  -0.004043859179112213
Bond Position:  [-3.72804715]


portfolio before change:  [-4.13051469]
curr_Stock_Price:  99.41036366924976
curr_Factors:  [99.41036367 -1.04158853 -1.05564166]
mat_Sqrt:  [[12.20720286  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01391313 0.01939514 0.42988018]
Stock Position:  0.013913125934317027
Bond Position:  [-5.5136236]


portfolio before change:  [-4.12141459]
curr_Stock_Price:  100.11396928543577
curr_Factors:  [100.11396929  -1.20991342  -1.05397721]
mat_Sqrt:  [[10.40637504  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01240855 -0.01350553  0.10100465]
Stock Position:  0.012408548641532027
Bond Position:  [-5.36368364]


portfolio before change:  [-4.13043095]
curr_Stock_Price:  99.44137929049324
curr_Factors:  [99.44137929 -1.04364691 -1.02435094]
mat_Sqrt:  [[12.57323639  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00193668 -0.00849988 -0.02498867]
Stock Position:  -0.001936681531950955
Bond Position:  [-3.93784467]


portfolio before change:  [-4.13353623]
curr_Stock_Price:  100.7906011255346
curr_Factors:  [100.79060113  -0.89292747  -1.04681947]
mat_Sqrt:  [[14.48767322  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00640708 -0.01891826  0.21841302]
Stock Position:  0.0064070842614625855
Bond Position:  [-4.7793101]


portfolio before change:  [-4.14294044]
curr_Stock_Price:  99.41606646333979
curr_Factors:  [99.41606646 -1.00179477 -1.03411416]
mat_Sqrt:  [[12.97993632  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0006439  -0.0161165   0.60216634]
Stock Position:  0.0006438967284757769
Bond Position:  [-4.20695412]


portfolio before change:  [-4.14381837]
curr_Stock_Price:  98.86935319483861
curr_Factors:  [98.86935319 -0.98097509 -1.00411953]
mat_Sqrt:  [[13.58144732  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-6.21152565e-03 -1.86828078e-04 -2.34822129e-01]
Stock Position:  -0.0062115256525626895
Bond Position:  [-3.52968884]


portfolio before change:  [-4.14193665]
curr_Stock_Price:  98.49537805962633
curr_Factors:  [98.49537806 -0.88699689 -0.97391674]
mat_Sqrt:  [[15.31903234  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01872517  0.03497749  0.17803168]
Stock Position:  -0.01872517273434414
Bond Position:  [-2.29759368]


portfolio before change:  [-4.11956383]
curr_Stock_Price:  97.28524024826258
curr_Factors:  [97.28524025 -0.98714788 -0.97405076]
mat_Sqrt:  [[13.68702963  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0042518  -0.06045231  0.32161271]
Stock Position:  -0.004251803009774969
Bond Position:  [-3.70592615]


portfolio before change:  [-4.12001599]
curr_Stock_Price:  97.28262767279212
curr_Factors:  [97.28262767 -0.93082241 -0.98936081]
mat_Sqrt:  [[14.25969762  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0127365   0.01777396 -0.40896939]
Stock Position:  0.012736499939276228
Bond Position:  [-5.35905617]


portfolio before change:  [-4.12180038]
curr_Stock_Price:  97.195125753684
curr_Factors:  [97.19512575 -0.80623796 -1.03429516]
mat_Sqrt:  [[15.42805264  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00199347  0.02001321  0.07267983]
Stock Position:  -0.001993471445784156
Bond Position:  [-3.92804467]


portfolio before change:  [-4.12334484]
curr_Stock_Price:  97.72356405074412
curr_Factors:  [97.72356405 -0.74485853 -1.04262077]
mat_Sqrt:  [[16.35712233  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00776481 -0.02592793 -0.54472607]
Stock Position:  -0.007764808122300479
Bond Position:  [-3.36454012]


portfolio before change:  [-4.12124216]
curr_Stock_Price:  97.39860089759895
curr_Factors:  [97.3986009  -0.81332594 -1.02032349]
mat_Sqrt:  [[15.56714206  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00328784  0.02134839 -0.24326103]
Stock Position:  0.0032878382428086763
Bond Position:  [-4.44147301]


portfolio before change:  [-4.12053678]
curr_Stock_Price:  97.78201491586252
curr_Factors:  [97.78201492 -0.85593989 -1.02038565]
mat_Sqrt:  [[14.97549381  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00331942 0.01042352 0.05097576]
Stock Position:  0.003319419809242023
Bond Position:  [-4.44511633]


portfolio before change:  [-4.12046348]
curr_Stock_Price:  97.9714975520944
curr_Factors:  [97.97149755 -0.78162998 -1.00479034]
mat_Sqrt:  [[16.41599672  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00123215 -0.02748653 -0.23558141]
Stock Position:  0.0012321496829152568
Bond Position:  [-4.24117903]


portfolio before change:  [-4.1218505]
curr_Stock_Price:  97.276094941976
curr_Factors:  [97.27609494 -0.74966429 -1.01217878]
mat_Sqrt:  [[16.70503556  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01415427 -0.06472257 -0.29397415]
Stock Position:  0.014154273925159734
Bond Position:  [-5.49872299]


portfolio before change:  [-4.11267607]
curr_Stock_Price:  97.9728325976475
curr_Factors:  [97.9728326  -0.80069787 -1.02644304]
mat_Sqrt:  [[15.76116984  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00302985 -0.02585804  0.00820648]
Stock Position:  -0.003029851422376628
Bond Position:  [-3.81583294]


portfolio before change:  [-4.11027993]
curr_Stock_Price:  97.02455470380936
curr_Factors:  [97.0245547  -0.56018251 -1.01573778]
mat_Sqrt:  [[20.0663403   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00935091  0.03333009  0.05493675]
Stock Position:  -0.009350907426742583
Bond Position:  [-3.20301231]


portfolio before change:  [-4.10962399]
curr_Stock_Price:  96.91158779923205
curr_Factors:  [96.9115878  -0.77055938 -1.04666354]
mat_Sqrt:  [[15.74583965  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00644884 -0.03087309 -0.17828651]
Stock Position:  0.006448841345850834
Bond Position:  [-4.73459145]


portfolio before change:  [-4.11069307]
curr_Stock_Price:  96.83758727991201
curr_Factors:  [96.83758728 -0.74345327 -1.01237069]
mat_Sqrt:  [[16.7301295   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00081701 -0.01472926 -0.24665819]
Stock Position:  -0.0008170063019415711
Bond Position:  [-4.03157615]


portfolio before change:  [-4.11010679]
curr_Stock_Price:  95.50312926722411
curr_Factors:  [95.50312927 -0.74232562 -1.0178371 ]
mat_Sqrt:  [[16.42814948  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00148337  0.01046849 -0.16166583]
Stock Position:  -0.001483372063476084
Bond Position:  [-3.96844012]


portfolio before change:  [-4.11189501]
curr_Stock_Price:  96.37421103296765
curr_Factors:  [96.37421103 -0.79485101 -1.04670049]
mat_Sqrt:  [[15.28217529  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00522404 -0.04731259 -0.05246407]
Stock Position:  0.00522403835122562
Bond Position:  [-4.61535759]


portfolio before change:  [-4.10915565]
curr_Stock_Price:  97.00903082622895
curr_Factors:  [97.00903083 -1.03280874 -1.0313033 ]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-4.10915565]
Stock Price:  96.88847123623049
PL:  [-4.10915565]
Settle:  Tensor("sub_298:0", shape=(), dtype=float64)
PL:  Tensor("sub_299:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  150
output_Z_Vals[:, i, :]:  [[ 1.19260232e+02 -2.92559343e+01 -2.92733494e+01]
 [-1.71829377e-01  5.28453636e-01  9.47795966e-02]
 [ 1.89432451e-01  9.20869107e-03 -2.32135368e-01]
 [ 8.41493271e-02  1.62875482e-01  3.78571841e-02]
 [ 2.42520652e-01 -8.77382967e-03 -1.75536415e-02]
 [ 1.09173171e-02  3.26214693e-02  8.14813360e-02]
 [ 3.64142025e-03  6.15982679e-02 -5.08952810e-02]
 [ 3.71929890e-02  2.11861403e-01  8.79670413e-02]
 [-1.75834663e-03  3.13660632e-02 -2.72451184e-03]
 [-3.12848390e-02  3.13929675e-01  1.23690267e-01]
 [ 5.74208626e-02  3.26184350e-02 -7.86666397e-02]
 [-6.26418478e-02  8.31552400e-02  1.48448674e-02]
 [-3.98397015e-02 -1.02598115e-01 -5.10111806e-02]
 [ 1.04908391e-02 -4.09256501e-02  1.26839317e-01]
 [ 1.55569810e-01  1.21971631e-01 -5.60879667e-02]
 [-7.83309547e-02 -9.73463343e-02 -1.15922905e-01]
 [-7.19655365e-02 -5.53366967e-02 -4.83366623e-02]
 [-6.93663511e-02 -8.06676713e-02  4.13804880e-02]
 [ 2.40963888e-02  6.60020480e-02  2.61437870e-02]
 [ 3.24739637e-01 -1.74664756e-01 -7.44609265e-02]
 [ 7.41336188e-02  1.99560732e-03  1.23805082e-01]
 [ 2.56407731e-03 -7.21544237e-03  2.36040211e-03]
 [-8.48190563e-02  1.64511313e-01  1.08316133e-01]
 [ 1.59036079e-01 -2.72817631e-02  2.19641002e-02]
 [ 1.54578587e-02  2.12590748e-02  4.00915210e-02]
 [ 1.02654168e-01  1.87831791e-03  5.62920285e-02]
 [-1.28646167e-01  7.42253856e-02  8.76892619e-02]
 [-4.70926623e-02  7.07329670e-02  2.82807498e-02]
 [ 6.20848838e-02 -6.23725319e-02  9.08311027e-02]
 [-4.16137345e-02 -9.16702566e-02 -2.90557434e-02]
 [-1.02024423e-01  5.36480687e-01 -5.19450245e-03]
 [ 3.15066222e-02 -5.78249755e-02  2.62627258e-02]
 [-1.19177213e-02 -2.26286392e-04  7.72058719e-02]
 [-5.03414207e-02 -8.24705281e-02  5.98421761e-04]
 [-1.65841424e-01  1.68262498e-01  3.40853251e-02]
 [ 1.16095474e-01 -1.51745959e-01 -1.22684822e-01]
 [-1.67492532e-01 -2.69605573e-01  2.19616462e-02]
 [-5.76511695e-02 -5.35395181e-02  9.31243037e-02]
 [-2.75503498e-02  5.95118160e-02 -3.11859716e-02]
 [ 1.62292735e-01 -9.32524193e-03 -1.57005135e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.26023247 -29.25593426 -29.27334937]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  8.31486419  -9.25153874 -83.50871763]
init_Out:  [2.49911038]
Stock Position:  8.31486419409362
Bond position:  [-828.98730903]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [13.88235507]
curr_Stock_Price:  101.38148673461099
curr_Factors:  [101.38148673  -1.14153063  -1.00354239]
mat_Sqrt:  [[11.86766498  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01169884  0.16711171  0.27037981]
Stock Position:  -0.011698843767638821
Bond Position:  [15.06840125]


portfolio before change:  [13.87528181]
curr_Stock_Price:  102.14711215130052
curr_Factors:  [102.14711215  -1.12403002  -1.00501688]
mat_Sqrt:  [[12.15046142  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01171032  0.00291204 -0.66221759]
Stock Position:  0.011710319454530145
Bond Position:  [12.6791065]


portfolio before change:  [13.88064825]
curr_Stock_Price:  102.47002813046052
curr_Factors:  [102.47002813  -1.15463189  -1.00625293]
mat_Sqrt:  [[11.80691673  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.0081378  0.05150575 0.10799601]
Stock Position:  0.008137799351543675
Bond Position:  [13.04676772]


portfolio before change:  [13.88611724]
curr_Stock_Price:  102.94166026777174
curr_Factors:  [102.94166027  -1.21007797  -1.00674426]
mat_Sqrt:  [[11.21598723  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0212831  -0.00277453 -0.05007565]
Stock Position:  0.021283101140716534
Bond Position:  [11.69519948]


portfolio before change:  [13.87692041]
curr_Stock_Price:  102.44084890099165
curr_Factors:  [102.4408489   -1.18556635  -1.04198097]
mat_Sqrt:  [[11.04235388  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00257118 0.01031581 0.23244357]
Stock Position:  0.002571182576258483
Bond Position:  [13.61352629]


portfolio before change:  [13.87715077]
curr_Stock_Price:  101.86856762389684
curr_Factors:  [101.86856762  -1.03056375  -1.02692744]
mat_Sqrt:  [[13.01616745  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00039621  0.01947908 -0.14519007]
Stock Position:  -0.0003962053400245643
Bond Position:  [13.91751164]


portfolio before change:  [13.87900623]
curr_Stock_Price:  101.57664126370176
curr_Factors:  [101.57664126  -0.97681307  -1.05875042]
mat_Sqrt:  [[13.26660688  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00456932 0.06699646 0.25094548]
Stock Position:  0.004569323905117848
Bond Position:  [13.41486966]


portfolio before change:  [13.88401639]
curr_Stock_Price:  102.30611232159444
curr_Factors:  [102.30611232  -0.94035949  -1.08499339]
mat_Sqrt:  [[13.49901258  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00011146  0.00991882 -0.00777227]
Stock Position:  -0.00011146126472735364
Bond Position:  [13.89541955]


portfolio before change:  [13.88570889]
curr_Stock_Price:  102.70560259624644
curr_Factors:  [102.7056026   -0.87683661  -1.0876421 ]
mat_Sqrt:  [[14.40230063  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [1.43654859e-04 9.92732797e-02 3.52853904e-01]
Stock Position:  0.00014365485898811876
Bond Position:  [13.87095474]


portfolio before change:  [13.88728225]
curr_Stock_Price:  101.58750657154563
curr_Factors:  [101.58750657  -0.89467664  -1.08408182]
mat_Sqrt:  [[14.04353441  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00300532  0.01031485 -0.22441403]
Stock Position:  0.0030053193975895253
Bond Position:  [13.58197935]


portfolio before change:  [13.89083791]
curr_Stock_Price:  102.20567988980085
curr_Factors:  [102.20567989  -0.6180096   -1.10077793]
mat_Sqrt:  [[18.32378082  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00313607  0.026296    0.04234827]
Stock Position:  -0.003136066374000675
Bond Position:  [14.21136171]


portfolio before change:  [13.89289353]
curr_Stock_Price:  102.116687582724
curr_Factors:  [102.11668758  -0.51688552  -1.06986371]
mat_Sqrt:  [[20.89201285  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00253213 -0.03244437 -0.1455207 ]
Stock Position:  -0.0025321345279532112
Bond Position:  [14.15146672]


portfolio before change:  [13.89783703]
curr_Stock_Price:  100.86301949767147
curr_Factors:  [100.8630195   -0.53411183  -1.09718069]
mat_Sqrt:  [[19.73652225  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00178983 -0.01294183  0.36183727]
Stock Position:  0.001789834608137257
Bond Position:  [13.71730891]


portfolio before change:  [13.90075807]
curr_Stock_Price:  101.53697611818943
curr_Factors:  [101.53697612  -0.65928456  -1.09557552]
mat_Sqrt:  [[17.55893508  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00838719  0.03857082 -0.16000336]
Stock Position:  0.008387194017384754
Bond Position:  [13.04914775]


portfolio before change:  [13.89908369]
curr_Stock_Price:  101.14284844101125
curr_Factors:  [101.14284844  -0.75658473  -1.0687208 ]
mat_Sqrt:  [[16.30103049  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00641107 -0.03078361 -0.33069578]
Stock Position:  -0.006411072605423899
Bond Position:  [14.54751784]


portfolio before change:  [13.9028906]
curr_Stock_Price:  100.83270472234729
curr_Factors:  [100.83270472  -0.4975997   -1.0771152 ]
mat_Sqrt:  [[20.87908318  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00398777 -0.017499   -0.13789104]
Stock Position:  -0.003987771065450742
Bond Position:  [14.30498834]


portfolio before change:  [13.90232306]
curr_Stock_Price:  101.42345337465505
curr_Factors:  [101.42345337  -0.58880832  -1.05853157]
mat_Sqrt:  [[19.53024852  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00322589 -0.02550936  0.11804701]
Stock Position:  -0.0032258895529479296
Bond Position:  [14.22950392]


portfolio before change:  [13.89804941]
curr_Stock_Price:  103.29966616337492
curr_Factors:  [103.29966616  -1.10109896  -1.056628  ]
mat_Sqrt:  [[11.94015621  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00260777 0.02087168 0.07458095]
Stock Position:  0.0026077659264042356
Bond Position:  [13.62866806]


portfolio before change:  [13.90113694]
curr_Stock_Price:  103.83032601242664
curr_Factors:  [103.83032601  -1.13507478  -1.09239818]
mat_Sqrt:  [[11.19296131  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.027252   -0.05523385 -0.2124163 ]
Stock Position:  0.027251996204978323
Bond Position:  [11.07155328]


portfolio before change:  [13.90930154]
curr_Stock_Price:  104.07913614160528
curr_Factors:  [104.07913614  -1.36669632  -1.1201306 ]
mat_Sqrt:  [[ 8.65662232  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01148909 0.00063107 0.35318144]
Stock Position:  0.011489094483230542
Bond Position:  [12.71352651]


portfolio before change:  [13.9192574]
curr_Stock_Price:  104.80735432915878
curr_Factors:  [104.80735433  -1.41393126  -1.12602107]
mat_Sqrt:  [[ 8.26617276  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00034594 -0.00228172  0.00673357]
Stock Position:  0.0003459388683125252
Bond Position:  [13.88300046]


portfolio before change:  [13.92086999]
curr_Stock_Price:  104.45212499255594
curr_Factors:  [104.45212499  -1.47567215  -1.14014863]
mat_Sqrt:  [[ 7.63626077  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00765577  0.05202305  0.30899578]
Stock Position:  -0.007655769767132869
Bond Position:  [14.72053141]


portfolio before change:  [13.92428641]
curr_Stock_Price:  104.24623674407113
curr_Factors:  [104.24623674  -1.13994335  -1.12446995]
mat_Sqrt:  [[10.83024256  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01503337 -0.00862725  0.06265746]
Stock Position:  0.015033372397910008
Bond Position:  [12.35711391]


portfolio before change:  [13.92908328]
curr_Stock_Price:  104.46256447134064
curr_Factors:  [104.46256447  -1.12583391  -1.14381352]
mat_Sqrt:  [[10.79606101  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00224067 0.00672271 0.11436995]
Stock Position:  0.0022406702860828034
Bond Position:  [13.69501711]


portfolio before change:  [13.93120241]
curr_Stock_Price:  104.644273184259
curr_Factors:  [104.64427318  -0.97515031  -1.17561498]
mat_Sqrt:  [[12.18007518  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00937541 0.00059398 0.16058549]
Stock Position:  0.009375412455018169
Bond Position:  [12.95011919]


portfolio before change:  [13.93479551]
curr_Stock_Price:  104.85484859350113
curr_Factors:  [104.85484859  -1.08760177  -1.14369494]
mat_Sqrt:  [[11.26026646  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00966497  0.02347213  0.25015306]
Stock Position:  -0.00966497378323288
Bond Position:  [14.94821487]


portfolio before change:  [13.93282482]
curr_Stock_Price:  105.25209032629776
curr_Factors:  [105.25209033  -1.16657597  -1.15034513]
mat_Sqrt:  [[10.375396    0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00380646  0.02236773  0.08067711]
Stock Position:  -0.0038064630087539433
Bond Position:  [14.33346301]


portfolio before change:  [13.93515338]
curr_Stock_Price:  105.11107762738814
curr_Factors:  [105.11107763  -0.94946321  -1.13606815]
mat_Sqrt:  [[13.05911435  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00605058 -0.01972393  0.25911585]
Stock Position:  0.006050582838460225
Bond Position:  [13.29917009]


portfolio before change:  [13.94294313]
curr_Stock_Price:  106.12374908072704
curr_Factors:  [106.12374908  -0.86220519  -1.15234452]
mat_Sqrt:  [[14.15483333  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00352612 -0.02898868 -0.08288795]
Stock Position:  -0.003526119165425282
Bond Position:  [14.31714811]


portfolio before change:  [13.94617449]
curr_Stock_Price:  105.71491251151659
curr_Factors:  [105.71491251  -0.56807869  -1.16316189]
mat_Sqrt:  [[18.71836986  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00476713  0.16965009 -0.01481847]
Stock Position:  -0.00476712849830956
Bond Position:  [14.45013106]


portfolio before change:  [13.95020441]
curr_Stock_Price:  105.24848160405567
curr_Factors:  [105.2484816   -0.42851969  -1.15247671]
mat_Sqrt:  [[21.65697653  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0016334  -0.01828586  0.07492025]
Stock Position:  0.0016333971723248818
Bond Position:  [13.77829183]


portfolio before change:  [13.94974156]
curr_Stock_Price:  103.9106334718437
curr_Factors:  [103.91063347  -0.22250627  -1.13120928]
mat_Sqrt:  [[26.83791662  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 1.42932803e-04 -7.15580401e-05  2.20246863e-01]
Stock Position:  0.00014293280340554502
Bond Position:  [13.93488932]


portfolio before change:  [13.9515549]
curr_Stock_Price:  104.40993432185782
curr_Factors:  [104.40993432  -0.26939346  -1.14317581]
mat_Sqrt:  [[25.42557508  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0020589  -0.02607947  0.00170713]
Stock Position:  -0.0020588973131885615
Bond Position:  [14.16652423]


portfolio before change:  [13.95332156]
curr_Stock_Price:  104.41200752303833
curr_Factors:  [104.41200752  -0.31356866  -1.11798446]
mat_Sqrt:  [[24.94794791  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00619447  0.05320927  0.09723594]
Stock Position:  -0.006194468101940269
Bond Position:  [14.60009841]


portfolio before change:  [13.96028068]
curr_Stock_Price:  103.5832041425285
curr_Factors:  [ 1.03583204e+02 -7.79358228e-02 -1.12981654e+00]
mat_Sqrt:  [[30.95773336  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00281463 -0.04798629 -0.34998565]
Stock Position:  0.0028146271180861586
Bond Position:  [13.66873258]


portfolio before change:  [13.96306548]
curr_Stock_Price:  103.96552970324231
curr_Factors:  [103.9655297   -0.27597744  -1.11518298]
mat_Sqrt:  [[25.86521422  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00657141 -0.08525677  0.06265046]
Stock Position:  -0.006571405665409796
Bond Position:  [14.64626515]


portfolio before change:  [13.95347697]
curr_Stock_Price:  105.70327254976343
curr_Factors:  [105.70327255  -0.26591901  -1.12705752]
mat_Sqrt:  [[26.24982499  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00152476 -0.01693068  0.26565772]
Stock Position:  -0.0015247581671494375
Bond Position:  [14.11464889]


portfolio before change:  [13.95464658]
curr_Stock_Price:  106.09338767564122
curr_Factors:  [106.09338768  -0.27316416  -1.1580447 ]
mat_Sqrt:  [[25.35842084  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00127688  0.01881929 -0.0889649 ]
Stock Position:  -0.001276876478617306
Bond Position:  [14.09011473]


portfolio before change:  [13.9565163]
curr_Stock_Price:  106.00852952827967
curr_Factors:  [106.00852953  -0.54290941  -1.16405359]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [13.9565163]
Stock Price:  105.81813857437433
PL:  [8.13837773]
Settle:  Tensor("sub_300:0", shape=(), dtype=float64)
PL:  Tensor("sub_301:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  151
output_Z_Vals[:, i, :]:  [[ 1.19260232e+02 -2.92559343e+01 -2.92733494e+01]
 [ 1.12132893e-02 -5.46371113e-02 -3.33677654e-02]
 [-4.90284829e-02 -4.76062902e-02 -3.39161531e-02]
 [ 9.22094248e-03  1.15092329e-01  2.40013359e-02]
 [ 6.31119094e-02  2.21397301e-02 -6.93763184e-02]
 [ 7.20049464e-02  3.06286591e-02 -8.00756512e-03]
 [ 6.14824959e-02  2.33194726e-02 -6.88666609e-02]
 [-8.72654205e-02  1.59969518e-02 -9.18831383e-02]
 [ 1.49147625e-02 -5.69699499e-02  1.96299444e-02]
 [-5.97530911e-02 -1.19366385e-01 -1.28936779e-01]
 [ 5.82791729e-02  1.58012804e-01 -8.58163977e-02]
 [-1.90242707e-01 -9.66162667e-02  3.78920004e-02]
 [-4.56862085e-02 -2.15190785e-02  5.15584598e-02]
 [-1.27757794e-01 -1.25756959e-01  4.09306010e-02]
 [-1.57639021e-02  2.48114442e-01  3.10062181e-01]
 [-9.90130879e-03 -6.51349206e-01  7.88551191e-03]
 [-6.67706819e-02 -9.72739078e-02 -6.45397503e-02]
 [ 1.54255466e-01  2.75750498e-02 -2.35186367e-01]
 [-9.33740868e-02  4.06970964e-02 -1.76315884e-01]
 [-7.30407105e-02 -3.22900412e-02  1.55895011e-01]
 [ 3.00791532e-01 -2.27877625e-01  1.40462091e-01]
 [ 1.00200204e-01  3.81334060e-01  4.48133440e-01]
 [-6.99874315e-02  7.19862064e-02  3.19519461e-01]
 [-6.45390209e-02 -6.62303508e-04 -8.31906176e-02]
 [-5.90230898e-01  1.54420911e-01  1.05662037e-01]
 [-1.22424590e-01 -2.43431249e-01  1.27579952e-01]
 [ 2.00415707e-01  5.65020588e-02 -1.39425229e-01]
 [ 2.94617053e-02  1.16977095e-02  1.66118299e-02]
 [-1.22707089e-01 -1.71457606e-01 -9.38349094e-02]
 [ 1.85765760e-01  2.58353886e-01  1.74595903e-01]
 [ 9.47631535e-02 -1.20698687e-01  8.77877780e-02]
 [ 9.78218927e-02 -1.53502351e-02 -1.92031171e-02]
 [ 3.72267696e-01 -3.02434185e-01 -2.05608377e-01]
 [-4.02225479e-02 -7.59055591e-02  1.94029569e-02]
 [-1.67586134e-01 -2.76721694e-02  1.56273617e-02]
 [ 1.90720190e-01 -2.35993768e-02 -1.38547004e-02]
 [ 2.70839281e-02  3.58661130e-02 -1.00189779e-01]
 [-1.35232553e-02  3.36667459e-02 -5.57813366e-02]
 [ 1.90999454e-01 -2.59133591e-01 -5.30074197e-02]
 [-5.88920136e-01  3.09444393e-01  3.44596787e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.26023247 -29.25593426 -29.27334937]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  8.31486419  -9.25153874 -83.50871763]
init_Out:  [2.49911038]
Stock Position:  8.31486419409362
Bond position:  [-828.98730903]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-3.31088994]
curr_Stock_Price:  99.31371453596326
curr_Factors:  [99.31371454 -0.76310861 -0.9888866 ]
mat_Sqrt:  [[17.22373647  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00017368 -0.01727777 -0.09518895]
Stock Position:  0.00017367883853901841
Bond Position:  [-3.32813863]


portfolio before change:  [-3.31116336]
curr_Stock_Price:  100.13493117119837
curr_Factors:  [100.13493117  -0.77825041  -1.01918367]
mat_Sqrt:  [[16.5947189   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00344572 -0.01505443 -0.09675334]
Stock Position:  -0.003445721386712451
Bond Position:  [-2.96612628]


portfolio before change:  [-3.3110111]
curr_Stock_Price:  99.98313663573943
curr_Factors:  [99.98313664 -0.63235171 -1.02266323]
mat_Sqrt:  [[19.10569778  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.0008946  0.03639539 0.06846913]
Stock Position:  0.000894595215276467
Bond Position:  [-3.40045554]


portfolio before change:  [-3.31203028]
curr_Stock_Price:  99.31904668410989
curr_Factors:  [99.31904668 -0.56900575 -1.01919832]
mat_Sqrt:  [[20.29010433  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00244071  0.0070012  -0.19791133]
Stock Position:  0.002440705689459525
Bond Position:  [-3.55443884]


portfolio before change:  [-3.3125853]
curr_Stock_Price:  99.27369749790448
curr_Factors:  [99.2736975  -0.62208447 -0.99771366]
mat_Sqrt:  [[19.65010203  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00362142  0.00968563 -0.02284335]
Stock Position:  0.0036214182225380713
Bond Position:  [-3.67209687]


portfolio before change:  [-3.31638226]
curr_Stock_Price:  98.35198094043778
curr_Factors:  [98.35198094 -0.75842269 -0.98629096]
mat_Sqrt:  [[17.18159982  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00279527  0.00737426 -0.19645741]
Stock Position:  0.0027952725208138887
Bond Position:  [-3.59130285]


portfolio before change:  [-3.31733889]
curr_Stock_Price:  98.1703553758406
curr_Factors:  [98.17035538 -0.89742143 -1.0069521 ]
mat_Sqrt:  [[14.61912729  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00722396  0.00505868 -0.26211702]
Stock Position:  -0.00722395708217447
Bond Position:  [-2.60816046]


portfolio before change:  [-3.32516053]
curr_Stock_Price:  99.20795784188874
curr_Factors:  [99.20795784 -0.79533608 -1.0164195 ]
mat_Sqrt:  [[16.2073145   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00107672 -0.01801548  0.05599877]
Stock Position:  0.001076720660121726
Bond Position:  [-3.43197979]


portfolio before change:  [-3.32656741]
curr_Stock_Price:  98.29977809781502
curr_Factors:  [98.2997781  -0.90905979 -0.98103935]
mat_Sqrt:  [[14.84885305  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00600412 -0.03774697 -0.36782074]
Stock Position:  -0.006004115430924389
Bond Position:  [-2.73636419]


portfolio before change:  [-3.33253328]
curr_Stock_Price:  99.23643673500968
curr_Factors:  [99.23643674 -0.89101291 -0.98225919]
mat_Sqrt:  [[15.24471895  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00294147  0.04996804 -0.2448103 ]
Stock Position:  0.002941467614601329
Bond Position:  [-3.62443405]


portfolio before change:  [-3.33703419]
curr_Stock_Price:  97.86031193089853
curr_Factors:  [97.86031193 -0.64270027 -0.96805309]
mat_Sqrt:  [[19.54633331  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00946483 -0.03055275  0.10809533]
Stock Position:  -0.009464826640986565
Bond Position:  [-2.4108033]


portfolio before change:  [-3.33002777]
curr_Stock_Price:  97.08821191188737
curr_Factors:  [97.08821191 -0.25397497 -0.98544368]
mat_Sqrt:  [[28.11213446  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00127054 -0.00680493  0.14708193]
Stock Position:  -0.0012705368278317435
Bond Position:  [-3.20667362]


portfolio before change:  [-3.32762909]
curr_Stock_Price:  94.88478698842428
curr_Factors:  [94.88478699 -0.53074313 -0.95258231]
mat_Sqrt:  [[21.52764539  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00569732 -0.03976784  0.11676361]
Stock Position:  -0.005697320749714517
Bond Position:  [-2.78704003]


portfolio before change:  [-3.32710149]
curr_Stock_Price:  94.73103007252087
curr_Factors:  [94.73103007 -0.60037895 -0.98382693]
mat_Sqrt:  [[19.43033958  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00277574 0.07846068 0.8845211 ]
Stock Position:  0.002775739594683729
Bond Position:  [-3.59005016]


portfolio before change:  [-3.32683292]
curr_Stock_Price:  94.98946718435774
curr_Factors:  [94.98946718 -0.61800116 -1.00106142]
mat_Sqrt:  [[18.81592206  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00133448 -0.2059747   0.02249517]
Stock Position:  -0.001334478825909774
Bond Position:  [-3.20007149]


portfolio before change:  [-3.32730058]
curr_Stock_Price:  95.04014129606256
curr_Factors:  [95.0401413  -0.63865085 -1.03025704]
mat_Sqrt:  [[17.91057732  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00460378 -0.03076071 -0.18411394]
Stock Position:  -0.004603782629769641
Bond Position:  [-2.88975643]


portfolio before change:  [-3.32610645]
curr_Stock_Price:  94.70229527109126
curr_Factors:  [94.70229527 -0.55813356 -1.00957095]
mat_Sqrt:  [[19.7476348   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00541636  0.00872    -0.67092124]
Stock Position:  0.0054163567153183885
Bond Position:  [-3.83904787]


portfolio before change:  [-3.32226968]
curr_Stock_Price:  95.49926663695882
curr_Factors:  [95.49926664 -0.65785438 -1.02082246]
mat_Sqrt:  [[17.82214413  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00719967  0.01286955 -0.50298014]
Stock Position:  -0.007199673652931673
Bond Position:  [-2.63470613]


portfolio before change:  [-3.3102035]
curr_Stock_Price:  93.77758571606276
curr_Factors:  [93.77758572 -0.6986882  -1.00533542]
mat_Sqrt:  [[17.0628271   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00246457 -0.01021101  0.44472507]
Stock Position:  -0.002464568136980305
Bond Position:  [-3.07908225]


portfolio before change:  [-3.30810798]
curr_Stock_Price:  92.77114758261622
curr_Factors:  [92.77114758 -0.46949673 -0.97951822]
mat_Sqrt:  [[21.78280155  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01485481 -0.07206123  0.40069925]
Stock Position:  0.014854813795644881
Bond Position:  [-4.6862061]


portfolio before change:  [-3.31694689]
curr_Stock_Price:  92.21556351374748
curr_Factors:  [92.21556351 -0.25384842 -0.99791576]
mat_Sqrt:  [[26.37363241  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00764101 0.12058842 1.27839997]
Stock Position:  0.007641005206982186
Bond Position:  [-4.02156649]


portfolio before change:  [-3.30057732]
curr_Stock_Price:  94.42368767811593
curr_Factors:  [94.42368768 -0.33531549 -1.01183259]
mat_Sqrt:  [[24.54833141  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-1.18424296e-04  2.27640372e-02  9.11500084e-01]
Stock Position:  -0.00011842429569160627
Bond Position:  [-3.28939527]


portfolio before change:  [-3.30099263]
curr_Stock_Price:  94.45833390408444
curr_Factors:  [94.4583339  -0.38734968 -1.01884819]
mat_Sqrt:  [[23.14921696  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-3.52225025e-03 -2.09438759e-04 -2.37319676e-01]
Stock Position:  -0.0035222502477594507
Bond Position:  [-2.96828674]


portfolio before change:  [-3.29943842]
curr_Stock_Price:  93.91173222637856
curr_Factors:  [ 9.39117322e+01  3.23412561e-02 -1.00864867e+00]
mat_Sqrt:  [[35.37650532  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01596188  0.04883218  0.30142438]
Stock Position:  -0.015961881732339585
Bond Position:  [-1.80043046]


portfolio before change:  [-3.31880136]
curr_Stock_Price:  95.11070578682886
curr_Factors:  [ 9.51107058e+01 -8.09665371e-02 -1.03737480e+00]
mat_Sqrt:  [[31.08421708  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00330289 -0.07697972  0.36395009]
Stock Position:  -0.003302891914556048
Bond Position:  [-3.00466098]


portfolio before change:  [-3.32686174]
curr_Stock_Price:  97.43738506989517
curr_Factors:  [97.43738507 -0.29671868 -1.03647568]
mat_Sqrt:  [[25.68778556  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00675086  0.01786752 -0.39774137]
Stock Position:  0.006750855493423388
Bond Position:  [-3.98464744]


portfolio before change:  [-3.34030306]
curr_Stock_Price:  95.52011553893746
curr_Factors:  [95.52011554 -0.26290595 -1.01999031]
mat_Sqrt:  [[26.48134695  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.001252   0.00369914 0.04738893]
Stock Position:  0.001251998795587466
Bond Position:  [-3.45989413]


portfolio before change:  [-3.34249965]
curr_Stock_Price:  94.11110663018896
curr_Factors:  [94.11110663 -0.37208622 -1.00060624]
mat_Sqrt:  [[23.84998548  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00613368 -0.05421966 -0.26768488]
Stock Position:  -0.006133675684192897
Bond Position:  [-2.76525264]


portfolio before change:  [-3.33781338]
curr_Stock_Price:  93.29072584625555
curr_Factors:  [93.29072585 -0.54929614 -1.01167756]
mat_Sqrt:  [[19.58466786  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01164562 0.08169867 0.49807351]
Stock Position:  0.011645623470625048
Bond Position:  [-4.42424205]


portfolio before change:  [-3.34243338]
curr_Stock_Price:  92.94150171385944
curr_Factors:  [92.94150171 -0.56092966 -1.01815085]
mat_Sqrt:  [[19.16124535  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00571812 -0.03816828  0.2504341 ]
Stock Position:  0.005718121652680281
Bond Position:  [-3.87388419]


portfolio before change:  [-3.33557238]
curr_Stock_Price:  94.22605983480378
curr_Factors:  [94.22605983 -0.85275957 -1.03948428]
mat_Sqrt:  [[14.20299611  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00658352 -0.00485417 -0.05478115]
Stock Position:  0.006583521581626996
Bond Position:  [-3.95591168]


portfolio before change:  [-3.34105575]
curr_Stock_Price:  93.46828154535815
curr_Factors:  [93.46828155 -0.62903529 -1.0274752 ]
mat_Sqrt:  [[17.83408742  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01808274 -0.09563809 -0.58654347]
Stock Position:  0.0180827444405517
Bond Position:  [-5.0312188]


portfolio before change:  [-3.33823341]
curr_Stock_Price:  93.65914237332846
curr_Factors:  [93.65914237 -0.5400727  -0.99520158]
mat_Sqrt:  [[20.17386123  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00189462 -0.02400345  0.05535124]
Stock Position:  -0.0018946203970179158
Bond Position:  [-3.16078488]


portfolio before change:  [-3.33959161]
curr_Stock_Price:  94.16746880382928
curr_Factors:  [94.1674688  -0.63890862 -1.01180813]
mat_Sqrt:  [[18.07189616  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00913632 -0.00875071  0.04458051]
Stock Position:  -0.009136324319995774
Bond Position:  [-2.47924708]


portfolio before change:  [-3.34876446]
curr_Stock_Price:  95.13754379621942
curr_Factors:  [95.1375438  -0.66062275 -1.04986867]
mat_Sqrt:  [[17.19867357  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01088937 -0.00746278 -0.0395236 ]
Stock Position:  0.010889373336519435
Bond Position:  [-4.38475269]


portfolio before change:  [-3.34513275]
curr_Stock_Price:  95.5213891716407
curr_Factors:  [95.52138917 -0.51313188 -1.06629064]
mat_Sqrt:  [[19.68639282  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00038396  0.01134186 -0.28581355]
Stock Position:  0.00038396237310936123
Bond Position:  [-3.38180937]


portfolio before change:  [-3.34549921]
curr_Stock_Price:  95.66800098737647
curr_Factors:  [95.66800099 -0.50940784 -1.06297713]
mat_Sqrt:  [[19.8558546   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00121074  0.01064636 -0.15912863]
Stock Position:  -0.001210741203922667
Bond Position:  [-3.22967002]


portfolio before change:  [-3.34503911]
curr_Stock_Price:  94.95452253568838
curr_Factors:  [94.95452254 -0.3338114  -1.05138968]
mat_Sqrt:  [[23.76459779  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00730029 -0.08194524 -0.15121541]
Stock Position:  0.007300294355034428
Bond Position:  [-4.03823507]


portfolio before change:  [-3.34714869]
curr_Stock_Price:  94.7347000533452
curr_Factors:  [94.73470005 -0.19995108 -1.04409114]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-3.34714869]
Stock Price:  95.5305734363067
PL:  [-3.34714869]
Settle:  Tensor("sub_302:0", shape=(), dtype=float64)
PL:  Tensor("sub_303:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  152
output_Z_Vals[:, i, :]:  [[ 1.19260232e+02 -2.92559343e+01 -2.92733494e+01]
 [-2.76353696e-03 -6.84341628e-02 -2.58447618e-02]
 [-5.86596679e-02 -8.77856638e-02 -8.27011075e-02]
 [ 8.28635837e-02  1.51184180e-01  3.77009892e-02]
 [ 2.22304971e-01 -2.46922023e-02 -4.80381242e-02]
 [ 5.67548792e-02  3.13162696e-02  2.35245916e-02]
 [ 6.16629808e-02  2.32374815e-02 -5.35872402e-02]
 [-1.32066127e-01  1.56542103e-01 -3.51169535e-02]
 [ 1.16135240e-03 -1.72473346e-02 -1.81724805e-02]
 [-6.43782020e-02  3.95394754e-01  1.81023006e-01]
 [ 5.84517350e-02  1.04415454e-01 -8.34221761e-02]
 [-2.93498853e-02 -1.05719296e-02 -7.69261143e-03]
 [-5.50971459e-02 -6.22405114e-02 -2.53389640e-02]
 [-5.13925386e-02 -8.48419440e-02  9.28498185e-02]
 [ 1.86970991e-01  1.32458620e-01 -8.48119810e-02]
 [-8.62265312e-02 -3.28569831e-01 -8.71194239e-02]
 [-6.79694160e-02 -2.58299212e-03 -7.25244173e-02]
 [ 1.22752623e-01  5.20790619e-02 -1.75896275e-01]
 [-1.35179581e-01  2.68038536e-02 -2.50385069e-01]
 [-3.04374912e-02 -7.54695675e-03  9.47294887e-02]
 [ 1.28015514e-01 -1.25511535e-01  7.24361965e-02]
 [ 1.19039404e-01  1.08390754e-02  2.35947363e-01]
 [-8.14543720e-02  1.08840236e-01  3.68329618e-01]
 [-7.11831171e-02 -5.04199019e-04 -8.12547092e-02]
 [-7.71101267e-01  1.42187160e-01  7.79272503e-02]
 [-1.46964131e-01 -2.70895165e-01  1.35433954e-01]
 [ 9.08256105e-02  6.07224264e-02 -6.67967082e-02]
 [ 3.01475403e-02  2.81581061e-03  1.09514706e-02]
 [-1.02155473e-01 -1.15669777e-01 -1.53129512e-01]
 [ 1.23311007e-01  1.59449013e-01  1.91165463e-02]
 [ 6.37578181e-02 -2.76710090e-02  4.79343649e-02]
 [ 6.63623794e-02 -1.00834249e-01 -6.86865511e-02]
 [ 2.88799212e-01 -2.43264339e-01 -1.53114685e-01]
 [-4.62345867e-02 -8.17748752e-02  2.86385384e-03]
 [-1.66173960e-01  8.87108255e-02  2.67111956e-02]
 [ 7.88833050e-02 -1.54786616e-01 -1.31841662e-01]
 [-6.10146580e-02 -1.75642338e-01 -3.01175455e-02]
 [-2.76550636e-02  1.47665356e-02 -4.99627064e-02]
 [-4.80426052e-02  8.70309757e-02  1.27787319e-02]
 [-7.01701967e-01  3.51386278e-01  4.30181350e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.26023247 -29.25593426 -29.27334937]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  8.31486419  -9.25153874 -83.50871763]
init_Out:  [2.49911038]
Stock Position:  8.31486419409362
Bond position:  [-828.98730903]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [3.53997775]
curr_Stock_Price:  100.13764473331138
curr_Factors:  [100.13764473  -1.01364046  -0.97864899]
mat_Sqrt:  [[13.65705507  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00071802 -0.02164078 -0.07372791]
Stock Position:  -0.0007180200495680137
Bond Position:  [3.61187859]


portfolio before change:  [3.54014808]
curr_Stock_Price:  100.52925844536831
curr_Factors:  [100.52925845  -0.86693029  -0.99603756]
mat_Sqrt:  [[15.60327718  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00498662 -0.02776026 -0.23592324]
Stock Position:  -0.004986617620000182
Bond Position:  [4.04144905]


portfolio before change:  [3.5335565]
curr_Stock_Price:  101.9524253273326
curr_Factors:  [101.95242533  -0.97151132  -0.97379363]
mat_Sqrt:  [[14.57344935  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00648184 0.04780864 0.10755043]
Stock Position:  0.006481843959820659
Bond Position:  [2.87271679]


portfolio before change:  [3.52815039]
curr_Stock_Price:  101.0629834005568
curr_Factors:  [101.0629834   -0.93636249  -0.98266934]
mat_Sqrt:  [[14.83088891  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01428516 -0.00780836 -0.1370394 ]
Stock Position:  0.014285163969352066
Bond Position:  [2.0844491]


portfolio before change:  [3.52804011]
curr_Stock_Price:  101.03702250611776
curr_Factors:  [101.03702251  -0.98845872  -0.99290192]
mat_Sqrt:  [[13.93113656  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00447669 0.00990307 0.06710911]
Stock Position:  0.004476691377992959
Bond Position:  [3.07572854]


portfolio before change:  [3.52543833]
curr_Stock_Price:  100.36995272043903
curr_Factors:  [100.36995272  -1.08639442  -0.97599164]
mat_Sqrt:  [[12.76206163  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00402165  0.00734834 -0.15286948]
Stock Position:  0.00402164805621374
Bond Position:  [3.12178571]


portfolio before change:  [3.52633823]
curr_Stock_Price:  100.49667805284716
curr_Factors:  [100.49667805  -0.93212596  -1.00564137]
mat_Sqrt:  [[14.47404922  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00934033  0.04950296 -0.10017889]
Stock Position:  -0.009340333397308383
Bond Position:  [4.46501071]


portfolio before change:  [3.52264375]
curr_Stock_Price:  100.95197620941644
curr_Factors:  [100.95197621  -0.82333444  -0.99307069]
mat_Sqrt:  [[16.41572623  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00018235 -0.00545409 -0.05184103]
Stock Position:  -0.00018235038050252818
Bond Position:  [3.54105238]


portfolio before change:  [3.52307235]
curr_Stock_Price:  101.02910356366189
curr_Factors:  [101.02910356  -0.76935611  -1.0195437 ]
mat_Sqrt:  [[16.8864043   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00101964  0.1250348   0.51640825]
Stock Position:  -0.0010196360739568495
Bond Position:  [3.62608526]


portfolio before change:  [3.52411591]
curr_Stock_Price:  100.45019720460442
curr_Factors:  [100.4501972   -0.5949465   -1.01264475]
mat_Sqrt:  [[20.12717318  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00219202  0.03301907 -0.23798025]
Stock Position:  0.0021920241679422503
Bond Position:  [3.30392665]


portfolio before change:  [3.52404364]
curr_Stock_Price:  100.2288113285876
curr_Factors:  [100.22881133  -0.34367163  -1.00705629]
mat_Sqrt:  [[25.96443628  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00120138 -0.00334314 -0.02194488]
Stock Position:  -0.001201377867202854
Bond Position:  [3.64445632]


portfolio before change:  [3.52371699]
curr_Stock_Price:  100.87993130157095
curr_Factors:  [100.8799313   -0.37177349  -1.01746548]
mat_Sqrt:  [[25.14582924  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00246071 -0.01968218 -0.07228501]
Stock Position:  -0.0024607056218567754
Bond Position:  [3.7719528]


portfolio before change:  [3.52663041]
curr_Stock_Price:  99.88757425008215
curr_Factors:  [ 9.98875743e+01 -7.71649399e-02 -1.01454225e+00]
mat_Sqrt:  [[33.52656485  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00103292 -0.02682938  0.26487469]
Stock Position:  -0.0010329199687168157
Bond Position:  [3.62980628]


portfolio before change:  [3.52947478]
curr_Stock_Price:  97.57315036330822
curr_Factors:  [97.57315036 -0.16851364 -1.03412785]
mat_Sqrt:  [[29.31094126  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00590492  0.04188709 -0.24194497]
Stock Position:  0.005904924130275423
Bond Position:  [2.95331273]


portfolio before change:  [3.53639937]
curr_Stock_Price:  98.68330944532222
curr_Factors:  [98.68330945 -0.28684169 -1.04804768]
mat_Sqrt:  [[25.9721929   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0043313  -0.1039029  -0.24852747]
Stock Position:  -0.004331299483116729
Bond Position:  [3.96382634]


portfolio before change:  [3.54621626]
curr_Stock_Price:  96.53121208542083
curr_Factors:  [96.53121209 -0.28946878 -1.04023427]
mat_Sqrt:  [[25.53789306  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00324381 -0.00081681 -0.20689198]
Stock Position:  -0.003243810799685641
Bond Position:  [3.85934525]


portfolio before change:  [3.54959946]
curr_Stock_Price:  95.6369708010468
curr_Factors:  [95.6369708  -0.29983529 -1.03540264]
mat_Sqrt:  [[25.16166326  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00350504  0.01646885 -0.50178311]
Stock Position:  0.0035050394115541165
Bond Position:  [3.2143881]


portfolio before change:  [3.54760856]
curr_Stock_Price:  94.95431905010952
curr_Factors:  [ 9.49543191e+01  5.32862571e-02 -1.02761661e+00]
mat_Sqrt:  [[35.84003538  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00517849  0.00847612 -0.71427891]
Stock Position:  -0.005178486692399194
Bond Position:  [4.03932824]


portfolio before change:  [3.54188975]
curr_Stock_Price:  96.15616702747207
curr_Factors:  [ 9.61561670e+01  3.03439484e-02 -1.03966359e+00]
mat_Sqrt:  [[35.04573673  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00032232 -0.00238656  0.27023686]
Stock Position:  -0.00032231529311757247
Bond Position:  [3.57288235]


portfolio before change:  [3.54259402]
curr_Stock_Price:  95.35684578232586
curr_Factors:  [95.35684578 -0.30860704 -1.05590801]
mat_Sqrt:  [[24.36410812  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00572813 -0.03969023  0.20664031]
Stock Position:  0.005728130742550809
Bond Position:  [2.99637754]


portfolio before change:  [3.55044784]
curr_Stock_Price:  96.66254952349188
curr_Factors:  [96.66254952 -0.32493284 -1.04132775]
mat_Sqrt:  [[24.6546482   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00679311 0.00342762 0.67309215]
Stock Position:  0.006793113404935578
Bond Position:  [2.89380817]


portfolio before change:  [3.54253211]
curr_Stock_Price:  95.44403942058689
curr_Factors:  [95.44403942 -0.1406472  -1.01916783]
mat_Sqrt:  [[29.92592227  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-1.15590782e-04  3.44183048e-02  1.05074188e+00]
Stock Position:  -0.00011559078220895723
Bond Position:  [3.55356456]


portfolio before change:  [3.54299261]
curr_Stock_Price:  95.30323594386617
curr_Factors:  [95.30323594 -0.15576208 -1.01582265]
mat_Sqrt:  [[29.53213637  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-2.97242917e-03 -1.59441729e-04 -2.31797068e-01]
Stock Position:  -0.0029724291675553077
Bond Position:  [3.82627472]


portfolio before change:  [3.55286697]
curr_Stock_Price:  92.14216860508171
curr_Factors:  [ 9.21421686e+01 -3.02043883e-02 -9.85655014e-01]
mat_Sqrt:  [[33.3638605   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02252507  0.04496353  0.22230475]
Stock Position:  -0.022525066509018508
Bond Position:  [5.62837545]


portfolio before change:  [3.50400858]
curr_Stock_Price:  94.34247185869049
curr_Factors:  [94.34247186 -0.16903825 -0.99581588]
mat_Sqrt:  [[29.43184794  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00429172 -0.08566457  0.38635537]
Stock Position:  -0.00429172080818224
Bond Position:  [3.90890013]


portfolio before change:  [3.49971961]
curr_Stock_Price:  95.45568803471028
curr_Factors:  [95.45568803 -0.4033998  -0.97300851]
mat_Sqrt:  [[24.10101204  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00326786  0.01920212 -0.19055242]
Stock Position:  0.0032678559598093068
Bond Position:  [3.18778417]


portfolio before change:  [3.49869721]
curr_Stock_Price:  95.02087554075781
curr_Factors:  [95.02087554 -0.20398664 -1.00817669]
mat_Sqrt:  [[28.27373478  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00114791 0.00089044 0.0312415 ]
Stock Position:  0.0011479100336050413
Bond Position:  [3.38962179]


portfolio before change:  [3.50050765]
curr_Stock_Price:  96.22890806864876
curr_Factors:  [96.22890807 -0.51889945 -1.01296519]
mat_Sqrt:  [[20.7981735   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00655824 -0.036578   -0.43683587]
Stock Position:  -0.006558243409471177
Bond Position:  [4.13160025]


portfolio before change:  [3.50476532]
curr_Stock_Price:  95.65845246105907
curr_Factors:  [95.65845246 -0.68054089 -0.99045648]
mat_Sqrt:  [[17.98947187  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00730039 0.05042221 0.05453419]
Stock Position:  0.00730038728497869
Bond Position:  [2.80642157]


portfolio before change:  [3.50560995]
curr_Stock_Price:  95.72609431341347
curr_Factors:  [95.72609431 -0.64520318 -1.00193073]
mat_Sqrt:  [[18.43695388  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00395011 -0.00875034  0.1367434 ]
Stock Position:  0.003950105720693899
Bond Position:  [3.12748176]


portfolio before change:  [3.50525072]
curr_Stock_Price:  95.53617596669696
curr_Factors:  [95.53617597 -0.39125204 -1.01849985]
mat_Sqrt:  [[23.33030331  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00213192 -0.03188659 -0.19594361]
Stock Position:  0.002131916852203611
Bond Position:  [3.30157553]


portfolio before change:  [3.50855503]
curr_Stock_Price:  96.89251108764473
curr_Factors:  [96.89251109 -0.80843744 -1.01612769]
mat_Sqrt:  [[15.62757693  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01607823 -0.07692694 -0.43679358]
Stock Position:  0.016078228290235946
Bond Position:  [1.95069512]


portfolio before change:  [3.51392284]
curr_Stock_Price:  97.21120020186478
curr_Factors:  [97.2112002  -0.97020306 -1.02578566]
mat_Sqrt:  [[13.20898411  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00361583 -0.02585949  0.00816978]
Stock Position:  -0.003615828647227589
Bond Position:  [3.86542188]


portfolio before change:  [3.50708462]
curr_Stock_Price:  99.23602727053019
curr_Factors:  [99.23602727 -1.11930711 -1.04877141]
mat_Sqrt:  [[11.35232541  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01395582  0.02805283  0.07619961]
Stock Position:  -0.013955824073883256
Bond Position:  [4.89200516]


portfolio before change:  [3.50295535]
curr_Stock_Price:  99.57572831820711
curr_Factors:  [99.57572832 -0.96897222 -1.04849432]
mat_Sqrt:  [[13.24277206  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00362271 -0.04894783 -0.37610756]
Stock Position:  0.003622705655851955
Bond Position:  [3.1422218]


portfolio before change:  [3.50337393]
curr_Stock_Price:  99.5828441693971
curr_Factors:  [99.58284417 -0.83878983 -1.04351295]
mat_Sqrt:  [[15.16040542  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00472926 -0.05554298 -0.08591697]
Stock Position:  -0.0047292562406475586
Bond Position:  [3.97432672]


portfolio before change:  [3.50355681]
curr_Stock_Price:  99.64922663761288
curr_Factors:  [99.64922664 -0.71772688 -1.04181511]
mat_Sqrt:  [[17.15199159  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00218473  0.00466959 -0.14252969]
Stock Position:  -0.002184725184939792
Bond Position:  [3.72126299]


portfolio before change:  [3.50416293]
curr_Stock_Price:  99.58471894841514
curr_Factors:  [99.58471895 -0.87472644 -1.0170508 ]
mat_Sqrt:  [[15.01772979  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00287574  0.02752161  0.03645417]
Stock Position:  -0.002875736076294719
Bond Position:  [3.7905423]


portfolio before change:  [3.5051253]
curr_Stock_Price:  99.41484429852125
curr_Factors:  [99.4148443  -0.80098747 -0.99371439]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [3.5051253]
Stock Price:  100.97885959742372
PL:  [2.5262657]
Settle:  Tensor("sub_304:0", shape=(), dtype=float64)
PL:  Tensor("sub_305:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  153
output_Z_Vals[:, i, :]:  [[ 1.19260232e+02 -2.92559343e+01 -2.92733494e+01]
 [-1.13090556e-01  3.14693836e-01  5.00621654e-02]
 [ 1.35685012e-01  3.99719800e-02 -1.24140843e-01]
 [ 8.61020037e-02  1.80631228e-01  3.80943994e-02]
 [ 2.20866035e-01 -2.58252592e-02 -5.02079852e-02]
 [ 7.73959144e-02  3.04759544e-02 -6.77103981e-02]
 [ 4.08375179e-02  4.38874436e-02 -3.79327616e-02]
 [-9.21743672e-02  2.65660597e-01  3.28888474e-02]
 [ 3.40989947e-02  5.10646246e-02 -2.48891921e-03]
 [-3.94041664e-02  2.20082716e-01  8.09630578e-02]
 [ 1.70819976e-02 -1.45122546e-01 -2.05349084e-02]
 [-1.35327551e-01  1.32376884e-01  5.99678306e-02]
 [ 1.61028786e-02 -1.84203698e-01 -1.83548100e-02]
 [ 5.01134561e-01  3.51169651e-01  4.33930978e-01]
 [ 5.90611851e-02 -7.92040246e-02 -1.59770104e-01]
 [-5.04292681e-02 -6.51368629e-02 -1.27076695e-01]
 [-9.49300619e-02  5.25864418e-02 -1.13761906e-01]
 [ 8.71110795e-02 -2.13330733e-01 -1.41538194e-01]
 [ 4.35202446e-02  5.20142797e-02  3.35066792e-02]
 [ 8.81716225e-02 -2.12727068e-01 -5.09647291e-04]
 [ 2.29122662e-01 -9.70270532e-03  3.46810484e-01]
 [-1.30709118e-02  3.58253445e-03 -1.28695625e-02]
 [-1.57656511e-01  4.49551366e-01  1.96958133e-01]
 [ 3.63330661e-01 -5.22554872e-02  1.19134960e-01]
 [-2.08035711e-01 -8.77463524e-02 -2.11110075e-01]
 [ 1.11203885e-01 -1.67024029e-02  5.67569276e-02]
 [ 1.13142996e-01  2.25169369e-01  1.17367491e-01]
 [-2.29923731e-02  5.24350074e-02  2.29316433e-02]
 [ 2.76704205e-02  7.02953304e-02  1.18918292e-01]
 [-1.15263059e-01 -2.03334493e-01  1.37407879e-02]
 [-1.38974066e-01  6.87560085e-01 -2.97056838e-02]
 [ 5.51076274e-02  6.87829800e-02  1.57608416e-01]
 [-6.60716506e-02  2.27031835e-02  8.38011601e-02]
 [-2.80091840e-01  5.43405609e-03  4.54602882e-02]
 [-1.00165198e-01  1.62351171e-01  2.04806151e-02]
 [ 8.47165236e-02 -1.65012150e-01 -1.38726811e-01]
 [-2.68405398e-01 -4.75596567e-01  1.20359761e-01]
 [-5.09463416e-02 -4.69169514e-02  6.22579388e-02]
 [-2.75435931e-02  5.94976464e-02 -3.11902112e-02]
 [ 2.11975865e-01 -1.31615083e-02 -2.09916157e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.26023247 -29.25593426 -29.27334937]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  8.31486419  -9.25153874 -83.50871763]
init_Out:  [2.49911038]
Stock Position:  8.31486419409362
Bond position:  [-828.98730903]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [10.63510813]
curr_Stock_Price:  100.99095155968429
curr_Factors:  [100.99095156  -0.93501447  -1.03090964]
mat_Sqrt:  [[14.14140202  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00669992  0.09951493  0.14281342]
Stock Position:  -0.00669992259248063
Bond Position:  [11.31173969]


portfolio before change:  [10.63188533]
curr_Stock_Price:  101.68302770599507
curr_Factors:  [101.68302771  -1.17554025  -1.02080284]
mat_Sqrt:  [[11.30807779  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00984933  0.01264025 -0.35413927]
Stock Position:  0.009849325681854334
Bond Position:  [9.63037607]


portfolio before change:  [10.62995628]
curr_Stock_Price:  101.3649425062173
curr_Factors:  [101.36494251  -1.26593913  -0.99879234]
mat_Sqrt:  [[10.52755202  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00936038 0.05712061 0.10867272]
Stock Position:  0.00936037822186177
Bond Position:  [9.68114208]


portfolio before change:  [10.62641747]
curr_Stock_Price:  100.85758813681842
curr_Factors:  [100.85758814  -1.25833719  -0.9578307 ]
mat_Sqrt:  [[10.9961104   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01909317 -0.00816666 -0.14322941]
Stock Position:  0.019093166561582577
Bond Position:  [8.70072674]


portfolio before change:  [10.62297113]
curr_Stock_Price:  100.62012103304352
curr_Factors:  [100.62012103  -1.27378417  -0.94338305]
mat_Sqrt:  [[10.95926301  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00587279  0.00963734 -0.19315892]
Stock Position:  0.005872792081862242
Bond Position:  [10.03205008]


portfolio before change:  [10.62613777]
curr_Stock_Price:  100.94578451517539
curr_Factors:  [100.94578452  -1.0705982   -0.94311775]
mat_Sqrt:  [[13.47542468  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00254001  0.01387843 -0.10821161]
Stock Position:  0.002540008577286778
Bond Position:  [10.36973461]


portfolio before change:  [10.62807747]
curr_Stock_Price:  101.19909219289696
curr_Factors:  [101.19909219  -0.93484462  -0.92698008]
mat_Sqrt:  [[15.7252089   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00499845  0.08400926  0.09382273]
Stock Position:  -0.0049984475700488125
Bond Position:  [11.13391582]


portfolio before change:  [10.62044]
curr_Stock_Price:  103.00551273441128
curr_Factors:  [103.00551273  -0.9228276   -0.94178224]
mat_Sqrt:  [[15.96138983  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00218712  0.01614805 -0.00710019]
Stock Position:  0.002187117129330142
Bond Position:  [10.39515487]


portfolio before change:  [10.62243873]
curr_Stock_Price:  103.32522769911215
curr_Factors:  [103.3252277   -0.73742683  -0.92053803]
mat_Sqrt:  [[19.68617678  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00087346  0.06959627  0.23096507]
Stock Position:  -0.0008734626493087686
Bond Position:  [10.71268945]


portfolio before change:  [10.62362754]
curr_Stock_Price:  103.49735979829254
curr_Factors:  [103.4973598   -0.74807143  -0.91978735]
mat_Sqrt:  [[19.52483666  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00046829 -0.04589178 -0.05858038]
Stock Position:  0.0004682896522855743
Bond Position:  [10.5751608]


portfolio before change:  [10.62547391]
curr_Stock_Price:  104.61715748276009
curr_Factors:  [104.61715748  -0.67900868  -0.92844932]
mat_Sqrt:  [[20.96489902  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00570805  0.04186125  0.17107153]
Stock Position:  -0.00570805099798857
Bond Position:  [11.22263398]


portfolio before change:  [10.62426327]
curr_Stock_Price:  105.07503051412112
curr_Factors:  [105.07503051  -0.66784013  -0.93145393]
mat_Sqrt:  [[21.22926412  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.000358   -0.05825032 -0.05236116]
Stock Position:  0.0003580010885460786
Bond Position:  [10.58664629]


portfolio before change:  [10.62558878]
curr_Stock_Price:  105.08090091412201
curr_Factors:  [105.08090091  -0.74390156  -0.93948635]
mat_Sqrt:  [[19.51810757  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.03067805 0.11104959 1.2378843 ]
Stock Position:  0.030678051687121517
Bond Position:  [7.40191147]


portfolio before change:  [10.64243994]
curr_Stock_Price:  105.60002980977895
curr_Factors:  [105.60002981  -0.80698383  -0.93229492]
mat_Sqrt:  [[18.54833272  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00131566 -0.02504651 -0.45577963]
Stock Position:  0.0013156551862737234
Bond Position:  [10.50350671]


portfolio before change:  [10.6433716]
curr_Stock_Price:  105.31016262955433
curr_Factors:  [105.31016263  -0.90944389  -0.93147055]
mat_Sqrt:  [[16.70980191  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00467094 -0.02059808 -0.36251444]
Stock Position:  -0.004670942056273018
Bond Position:  [11.13526926]


portfolio before change:  [10.64168013]
curr_Stock_Price:  105.97029964654196
curr_Factors:  [105.97029965  -0.97465451  -0.9238379 ]
mat_Sqrt:  [[15.87374446  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00735767  0.01662929 -0.32453105]
Stock Position:  -0.00735767404949749
Bond Position:  [11.42137505]


portfolio before change:  [10.65419542]
curr_Stock_Price:  104.4633662051714
curr_Factors:  [104.46336621  -0.90265899  -0.89779723]
mat_Sqrt:  [[17.25980224  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00305401 -0.0674611  -0.40376907]
Stock Position:  0.0030540060655650644
Bond Position:  [10.33516366]


portfolio before change:  [10.65973684]
curr_Stock_Price:  105.85479960020483
curr_Factors:  [105.8547996   -0.96137594  -0.88679024]
mat_Sqrt:  [[16.67485931  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00310064 0.01644836 0.09558523]
Stock Position:  0.003100642035886658
Bond Position:  [10.331519]


portfolio before change:  [10.66354579]
curr_Stock_Price:  106.6667073937918
curr_Factors:  [106.66670739  -1.16056514  -0.903482  ]
mat_Sqrt:  [[13.54018531  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00609851 -0.06727021 -0.00145388]
Stock Position:  0.006098513429453936
Bond Position:  [10.01303745]


portfolio before change:  [10.66533122]
curr_Stock_Price:  106.75422369342093
curr_Factors:  [106.75422369  -1.42688167  -0.90628674]
mat_Sqrt:  [[10.35387467  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.02894226 -0.00306826  0.98935378]
Stock Position:  0.028942260057655378
Bond Position:  [7.57562272]


portfolio before change:  [10.68001526]
curr_Stock_Price:  107.22885935538005
curr_Factors:  [107.22885936  -1.62024836  -0.90136529]
mat_Sqrt:  [[ 8.61368111  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0018117   0.0011329  -0.03671328]
Stock Position:  -0.0018116992538641749
Bond Position:  [10.87428171]


portfolio before change:  [10.68183264]
curr_Stock_Price:  106.97605221142089
curr_Factors:  [106.97605221  -1.29698666  -0.89544989]
mat_Sqrt:  [[11.94327613  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00886233  0.14216062  0.56186673]
Stock Position:  -0.008862328306520888
Bond Position:  [11.62988954]


portfolio before change:  [10.68136041]
curr_Stock_Price:  107.19338374837605
curr_Factors:  [107.19338375  -0.90564245  -0.90441235]
mat_Sqrt:  [[17.54167943  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.02202182 -0.01652464  0.33985888]
Stock Position:  0.022021822561951312
Bond Position:  [8.32076673]


portfolio before change:  [10.69720761]
curr_Stock_Price:  107.86576410695133
curr_Factors:  [107.86576411  -1.15662248  -0.88849926]
mat_Sqrt:  [[13.95399415  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01815924 -0.02774783 -0.60223828]
Stock Position:  -0.01815924336876512
Bond Position:  [12.65596827]


portfolio before change:  [10.67882]
curr_Stock_Price:  108.9654634872211
curr_Factors:  [108.96546349  -1.29234829  -0.89681952]
mat_Sqrt:  [[12.20521327  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01002507 -0.00528176  0.16191172]
Stock Position:  0.010025067800777498
Bond Position:  [9.58643384]


portfolio before change:  [10.69072862]
curr_Stock_Price:  110.03381030527814
curr_Factors:  [110.03381031  -1.49119245  -0.91319974]
mat_Sqrt:  [[ 9.93829515  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01438017 0.07120481 0.33481678]
Stock Position:  0.014380170946827142
Bond Position:  [9.10842362]


portfolio before change:  [10.69512401]
curr_Stock_Price:  110.26028624524083
curr_Factors:  [110.26028625  -1.67128962  -0.93240122]
mat_Sqrt:  [[ 8.15925585  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00207833  0.01658141  0.0654176 ]
Stock Position:  -0.00207832738896041
Bond Position:  [10.92428098]


portfolio before change:  [10.69631717]
curr_Stock_Price:  110.34326730442056
curr_Factors:  [110.3432673   -1.53459181  -0.93246999]
mat_Sqrt:  [[ 9.36083336  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00574303 0.02222934 0.33924079]
Stock Position:  0.005743028504745262
Bond Position:  [10.06261264]


portfolio before change:  [10.69427109]
curr_Stock_Price:  109.76796301425128
curr_Factors:  [109.76796301  -1.38615671  -0.90624898]
mat_Sqrt:  [[11.08910417  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01061477 -0.06430001  0.03919864]
Stock Position:  -0.01061477145474834
Bond Position:  [11.85943293]


portfolio before change:  [10.69356238]
curr_Stock_Price:  109.97439468308134
curr_Factors:  [109.97439468  -1.33401961  -0.91356069]
mat_Sqrt:  [[11.61929713  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01095462  0.21742559 -0.08474205]
Stock Position:  -0.010954620338583175
Bond Position:  [11.89829012]


portfolio before change:  [10.70896586]
curr_Stock_Price:  108.70405384740813
curr_Factors:  [108.70405385  -1.33199874  -0.89681965]
mat_Sqrt:  [[11.70259594  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00760987 0.02175109 0.44961294]
Stock Position:  0.007609873900451566
Bond Position:  [9.88174172]


portfolio before change:  [10.70827976]
curr_Stock_Price:  108.45156569707936
curr_Factors:  [108.4515657   -1.03063552  -0.87277296]
mat_Sqrt:  [[16.16575623  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00299272  0.00717938  0.23906138]
Stock Position:  -0.0029927221527594767
Bond Position:  [11.03284516]


portfolio before change:  [10.71074005]
curr_Stock_Price:  108.09032027945364
curr_Factors:  [108.09032028  -1.2107956   -0.87559306]
mat_Sqrt:  [[13.41775081  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02017268  0.0017184   0.12968555]
Stock Position:  -0.020172679784155077
Bond Position:  [12.89121147]


portfolio before change:  [10.71529112]
curr_Stock_Price:  107.94460035113876
curr_Factors:  [107.94460035  -1.33721532  -0.90139145]
mat_Sqrt:  [[11.50764241  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00797667  0.05133995  0.05842549]
Stock Position:  -0.007976674795280421
Bond Position:  [11.57633009]


portfolio before change:  [10.7264381]
curr_Stock_Price:  106.72857373053084
curr_Factors:  [106.72857373  -1.26598071  -0.89129536]
mat_Sqrt:  [[12.34205883  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00422445 -0.05218142 -0.39574898]
Stock Position:  0.0042244521106265505
Bond Position:  [10.27556835]


portfolio before change:  [10.72832032]
curr_Stock_Price:  106.87005734735858
curr_Factors:  [106.87005735  -1.55152695  -0.88334096]
mat_Sqrt:  [[ 9.36281289  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0273547  -0.15039684  0.3433529 ]
Stock Position:  -0.027354697552531955
Bond Position:  [13.65171841]


portfolio before change:  [10.73282907]
curr_Stock_Price:  106.76761858160351
curr_Factors:  [106.76761858  -1.32938714  -0.8794613 ]
mat_Sqrt:  [[11.72597237  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00336427 -0.01483644  0.17760457]
Stock Position:  -0.003364273959698133
Bond Position:  [11.09202459]


portfolio before change:  [10.73259053]
curr_Stock_Price:  107.25067220023955
curr_Factors:  [107.2506722   -1.47300266  -0.88732927]
mat_Sqrt:  [[10.12327164  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00319798  0.01881481 -0.08897699]
Stock Position:  -0.0031979825101114885
Bond Position:  [11.07557631]


portfolio before change:  [10.73362553]
curr_Stock_Price:  107.35997035164445
curr_Factors:  [107.35997035  -1.16982134  -0.9162725 ]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [10.73362553]
Stock Price:  107.17428356687265
PL:  [3.55934197]
Settle:  Tensor("sub_306:0", shape=(), dtype=float64)
PL:  Tensor("sub_307:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  154
output_Z_Vals[:, i, :]:  [[ 1.19260232e+02 -2.92559343e+01 -2.92733494e+01]
 [-1.60519876e-02 -2.45040661e-02 -1.95421406e-02]
 [-2.93006714e-02  4.25986072e-02  9.06063767e-02]
 [ 8.61326306e-02  1.80909720e-01  3.80981200e-02]
 [ 2.00674634e-01 -2.42704078e-02 -5.86155170e-02]
 [ 7.47419711e-02  3.00008027e-02 -6.28102937e-02]
 [ 4.39030269e-02  3.48038196e-02 -4.49355061e-02]
 [-1.03422483e-01 -4.26408280e-02 -1.13268321e-01]
 [ 6.25337287e-02 -2.04539640e-02 -4.51246575e-02]
 [-7.84771559e-02  3.65008103e-01  1.69028599e-01]
 [ 5.78549005e-02  3.45308915e-02 -7.92921252e-02]
 [-4.51574087e-02  4.59622306e-02  3.32458112e-03]
 [-9.72906462e-02  6.87943611e-03 -4.94436065e-02]
 [-2.69658210e-02 -4.20440643e-02  1.10498081e-01]
 [ 1.92449067e-01  2.10022763e-01 -3.76991509e-03]
 [-7.79995707e-02 -9.39342465e-02 -1.14483455e-01]
 [-6.97911462e-02 -6.07512706e-02 -5.72805858e-02]
 [-7.80510354e-02  9.89777742e-02  9.95482166e-02]
 [ 1.28984004e-01  5.46381859e-02  1.31024766e-01]
 [ 1.35263281e-01 -4.33941303e-02  2.63053527e-02]
 [-4.81687659e-02 -8.55064423e-04 -4.25882665e-02]
 [ 8.38650199e-02 -6.30915483e-02  8.15344689e-02]
 [-6.52047428e-02  6.36688108e-02  2.37515072e-01]
 [ 2.68152042e-03 -1.19052661e-02 -7.91062381e-02]
 [-1.54736770e-01  7.86274501e-02  7.14109104e-02]
 [ 1.62142099e-02 -8.76204634e-02  8.31339462e-02]
 [-1.20642664e-01  6.10536149e-02  2.31572982e-02]
 [-4.82163695e-02  7.16134293e-02  2.86122551e-02]
 [ 6.20848838e-02 -6.23725319e-02  9.08311027e-02]
 [ 2.95796368e-02  6.98276824e-03 -5.13590348e-02]
 [ 8.76892641e-03  1.82810288e-01  2.72163338e-02]
 [ 1.50440632e-02 -7.24360429e-02 -8.52195601e-02]
 [ 2.39055757e-01 -3.21043742e-01 -3.11074768e-01]
 [-4.75998831e-02 -8.35174663e-02 -3.35856759e-03]
 [-1.19273683e-01  3.05442731e-02  3.63730638e-02]
 [ 8.47165236e-02 -1.65012150e-01 -1.38726811e-01]
 [-2.07730673e-01 -3.52726525e-01  6.16557976e-02]
 [-4.58862732e-02 -2.77750031e-02  3.71361189e-02]
 [-3.75603170e-02  8.05038689e-02 -2.49051706e-02]
 [ 1.00060049e-01 -4.51996580e-03 -9.07292172e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.26023247 -29.25593426 -29.27334937]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  8.31486419  -9.25153874 -83.50871763]
init_Out:  [2.49911038]
Stock Position:  8.31486419409362
Bond position:  [-828.98730903]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [5.48474829]
curr_Stock_Price:  100.37153556852122
curr_Factors:  [100.37153557  -1.13440838  -1.00826384]
mat_Sqrt:  [[11.77768257  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00175533 -0.00774887 -0.05574829]
Stock Position:  -0.0017553285633109222
Bond Position:  [5.66093331]


portfolio before change:  [5.48662476]
curr_Stock_Price:  99.70566888820763
curr_Factors:  [99.70566889 -1.0173983  -0.99464934]
mat_Sqrt:  [[13.33210318  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.000728    0.01347086  0.25847477]
Stock Position:  -0.0007280044840391177
Bond Position:  [5.55921094]


portfolio before change:  [5.48697429]
curr_Stock_Price:  100.18013852081442
curr_Factors:  [100.18013852  -1.17869424  -0.98682192]
mat_Sqrt:  [[11.48973233  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00857987 0.05720868 0.10868333]
Stock Position:  0.00857987312980659
Bond Position:  [4.62744141]


portfolio before change:  [5.48913331]
curr_Stock_Price:  100.36435536672957
curr_Factors:  [100.36435537  -0.96584171  -0.98915597]
mat_Sqrt:  [[14.20806036  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01323778 -0.00767498 -0.16721375]
Stock Position:  0.013237776837680052
Bond Position:  [4.16053237]


portfolio before change:  [5.48416388]
curr_Stock_Price:  99.94966872497146
curr_Factors:  [99.94966872 -1.04723301 -0.96991004]
mat_Sqrt:  [[13.29680388  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00471508  0.00948709 -0.17918028]
Stock Position:  0.004715079775490876
Bond Position:  [5.01289322]


portfolio before change:  [5.48641866]
curr_Stock_Price:  100.29497049431339
curr_Factors:  [100.29497049  -0.70817488  -0.97837812]
mat_Sqrt:  [[18.57028161  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00191862  0.01100593 -0.12818849]
Stock Position:  0.0019186158113084063
Bond Position:  [5.29399114]


portfolio before change:  [5.48505434]
curr_Stock_Price:  99.23894107578361
curr_Factors:  [99.23894108 -0.72045963 -0.9986459 ]
mat_Sqrt:  [[17.78623699  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00717657 -0.01348421 -0.32312299]
Stock Position:  -0.0071765749882603015
Bond Position:  [6.19725004]


portfolio before change:  [5.47920392]
curr_Stock_Price:  100.16209955762693
curr_Factors:  [100.16209956  -0.64266928  -0.98902944]
mat_Sqrt:  [[19.5914089   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00269478 -0.00646811 -0.12872809]
Stock Position:  0.002694782073103212
Bond Position:  [5.20928889]


portfolio before change:  [5.48095634]
curr_Stock_Price:  100.57074499599807
curr_Factors:  [100.570745    -0.71007371  -1.00006057]
mat_Sqrt:  [[18.18736507  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00189966  0.1154257   0.48219154]
Stock Position:  -0.001899663243324441
Bond Position:  [5.67200688]


portfolio before change:  [5.47960553]
curr_Stock_Price:  101.65507044950508
curr_Factors:  [101.65507045  -0.68566593  -1.03343236]
mat_Sqrt:  [[18.21940306  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00233603  0.01091963 -0.22619836]
Stock Position:  0.0023360286209054104
Bond Position:  [5.24213637]


portfolio before change:  [5.47925365]
curr_Stock_Price:  101.22391649145588
curr_Factors:  [101.22391649  -0.64728871  -1.025182  ]
mat_Sqrt:  [[19.00808369  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00227756  0.01453453  0.0094841 ]
Stock Position:  -0.002277559504862867
Bond Position:  [5.70979714]


portfolio before change:  [5.48257029]
curr_Stock_Price:  100.08108063223732
curr_Factors:  [100.08108063  -0.76814954  -1.04264274]
mat_Sqrt:  [[16.3657115   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00655063  0.00217547 -0.14104885]
Stock Position:  -0.0065506259118360095
Bond Position:  [6.13816401]


portfolio before change:  [5.47970575]
curr_Stock_Price:  100.63550976549278
curr_Factors:  [100.63550977  -0.87961091  -1.02902578]
mat_Sqrt:  [[14.92247521  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00036831 -0.0132955   0.31522027]
Stock Position:  -0.0003683080540779861
Bond Position:  [5.51677062]


portfolio before change:  [5.48046017]
curr_Stock_Price:  100.45962495432848
curr_Factors:  [100.45962495  -0.76358159  -1.05358345]
mat_Sqrt:  [[16.3232564   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01207494  0.06641503 -0.01075452]
Stock Position:  0.012074937471577046
Bond Position:  [4.26741648]


portfolio before change:  [5.48862362]
curr_Stock_Price:  101.09151092607993
curr_Factors:  [101.09151093  -0.85859792  -1.07496857]
mat_Sqrt:  [[14.62101198  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00709895 -0.02970462 -0.32658943]
Stock Position:  -0.00709894637382616
Bond Position:  [6.20626683]


portfolio before change:  [5.49690195]
curr_Stock_Price:  100.03466348592225
curr_Factors:  [100.03466349  -0.714297    -1.06730202]
mat_Sqrt:  [[16.84270689  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00493104 -0.01921124 -0.16340557]
Stock Position:  -0.004931041573192318
Bond Position:  [5.99017704]


portfolio before change:  [5.49922333]
curr_Stock_Price:  99.71575366502832
curr_Factors:  [99.71575367 -0.78393665 -1.08014713]
mat_Sqrt:  [[15.45975037  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00356896  0.03129952  0.28398335]
Stock Position:  -0.00356896096944069
Bond Position:  [5.85510496]


portfolio before change:  [5.50102927]
curr_Stock_Price:  99.4148242495438
curr_Factors:  [99.41482425 -0.77050831 -1.09646171]
mat_Sqrt:  [[15.36867298  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.0102247  0.01727811 0.37377719]
Stock Position:  0.010224700270917651
Bond Position:  [4.48454249]


portfolio before change:  [5.50986283]
curr_Stock_Price:  100.22393899291458
curr_Factors:  [100.22393899  -0.99435223  -1.12306286]
mat_Sqrt:  [[12.06117939  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01156706 -0.01372243  0.07504185]
Stock Position:  0.011567061781686953
Bond Position:  [4.35056633]


portfolio before change:  [5.51333296]
curr_Stock_Price:  100.47692258445355
curr_Factors:  [100.47692258  -0.83681021  -1.13034232]
mat_Sqrt:  [[14.05215201  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00404807 -0.0002704  -0.12149247]
Stock Position:  -0.004048072990212162
Bond Position:  [5.92007088]


portfolio before change:  [5.51376527]
curr_Stock_Price:  100.55294499005738
curr_Factors:  [100.55294499  -0.828894    -1.12624395]
mat_Sqrt:  [[14.23276139  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00694729 -0.0199513   0.23259515]
Stock Position:  0.0069472925291401465
Bond Position:  [4.81519455]


portfolio before change:  [5.52029206]
curr_Stock_Price:  101.40577366214046
curr_Factors:  [101.40577366  -0.8605982   -1.12354138]
mat_Sqrt:  [[13.94317932  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00108141  0.02013385  0.67756439]
Stock Position:  -0.001081407603285957
Bond Position:  [5.62995303]


portfolio before change:  [5.52188368]
curr_Stock_Price:  100.58476995841772
curr_Factors:  [100.58476996  -0.70997056  -1.12354739]
mat_Sqrt:  [[16.07849885  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00085663 -0.00376478 -0.22566808]
Stock Position:  -0.0008566325499504707
Bond Position:  [5.60804787]


portfolio before change:  [5.52301619]
curr_Stock_Price:  100.08110141842127
curr_Factors:  [100.08110142  -0.97847903  -1.15174343]
mat_Sqrt:  [[11.89072174  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01161661  0.02486418  0.20371545]
Stock Position:  -0.011616614231924685
Bond Position:  [6.68561974]


portfolio before change:  [5.52060837]
curr_Stock_Price:  100.36032003263946
curr_Factors:  [100.36032003  -1.06969057  -1.17640364]
mat_Sqrt:  [[10.61929576  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00291182 -0.02770802  0.23715801]
Stock Position:  0.0029118225626939566
Bond Position:  [5.22837693]


portfolio before change:  [5.52376778]
curr_Stock_Price:  101.22088823615192
curr_Factors:  [101.22088824  -0.93472987  -1.17041699]
mat_Sqrt:  [[12.33151634  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00927212  0.01930685  0.06606133]
Stock Position:  -0.00927212030925021
Bond Position:  [6.46230004]


portfolio before change:  [5.51747329]
curr_Stock_Price:  101.98687654718313
curr_Factors:  [101.98687655  -0.93360114  -1.17421267]
mat_Sqrt:  [[12.39174264  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00327047  0.02264615  0.0816228 ]
Stock Position:  -0.0032704735520836764
Bond Position:  [5.85101867]


portfolio before change:  [5.51745968]
curr_Stock_Price:  102.21468191683918
curr_Factors:  [102.21468192  -0.97309146  -1.165394  ]
mat_Sqrt:  [[12.04428011  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0065604  -0.01972393  0.25911585]
Stock Position:  0.006560396507317889
Bond Position:  [4.84689083]


portfolio before change:  [5.51536125]
curr_Stock_Price:  101.80246197760029
curr_Factors:  [101.80246198  -1.22991206  -1.13756259]
mat_Sqrt:  [[ 9.54063116  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00202044  0.00220815 -0.14651303]
Stock Position:  0.002020444105038675
Bond Position:  [5.30967507]


portfolio before change:  [5.51734639]
curr_Stock_Price:  102.45646911292978
curr_Factors:  [102.45646911  -1.22035687  -1.1392705 ]
mat_Sqrt:  [[ 9.67756816  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00196791 0.05780969 0.07764062]
Stock Position:  0.0019679095308189746
Bond Position:  [5.31572132]


portfolio before change:  [5.51784342]
curr_Stock_Price:  102.37136711441792
curr_Factors:  [102.37136711  -1.46080966  -1.16061902]
mat_Sqrt:  [[ 7.44228839  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00056724 -0.02290629 -0.24310768]
Stock Position:  -0.0005672445133953123
Bond Position:  [5.57591302]


portfolio before change:  [5.51822473]
curr_Stock_Price:  102.9279565434592
curr_Factors:  [102.92795654  -1.48969278  -1.16360705]
mat_Sqrt:  [[ 7.24802817  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0230778  -0.10152295 -0.88740973]
Stock Position:  0.023077803843009656
Bond Position:  [3.14287354]


portfolio before change:  [5.5229012]
curr_Stock_Price:  103.11357149262103
curr_Factors:  [103.11357149  -1.30639039  -1.18970079]
mat_Sqrt:  [[ 8.49722667  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00593627 -0.02641054 -0.00958106]
Stock Position:  -0.00593627327251196
Bond Position:  [6.13501154]


portfolio before change:  [5.51942083]
curr_Stock_Price:  103.82905221467323
curr_Factors:  [103.82905221  -1.23839604  -1.20825009]
mat_Sqrt:  [[ 8.9898817   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01235393  0.00965895  0.10376223]
Stock Position:  -0.012353934788766105
Bond Position:  [6.80211817]


portfolio before change:  [5.51611925]
curr_Stock_Price:  104.16513118147277
curr_Factors:  [104.16513118  -1.25185103  -1.20488661]
mat_Sqrt:  [[ 8.92842313  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0058396  -0.05218142 -0.39574898]
Stock Position:  0.005839601880484348
Bond Position:  [4.90783636]


portfolio before change:  [5.51591306]
curr_Stock_Price:  104.02475909405685
curr_Factors:  [104.02475909  -1.27022125  -1.20822331]
mat_Sqrt:  [[ 8.72492945  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02341023 -0.11154192  0.17588683]
Stock Position:  -0.023410228970539362
Bond Position:  [7.95115648]


portfolio before change:  [5.51840911]
curr_Stock_Price:  103.96059508423923
curr_Factors:  [103.96059508  -1.22743592  -1.19969352]
mat_Sqrt:  [[ 9.17867164  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00425149 -0.00878323  0.10593901]
Stock Position:  -0.004251491254476255
Bond Position:  [5.96039667]


portfolio before change:  [5.51720527]
curr_Stock_Price:  104.41900748846848
curr_Factors:  [104.41900749  -1.267546    -1.21653997]
mat_Sqrt:  [[ 8.7087281   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00465802  0.02545756 -0.07104752]
Stock Position:  -0.004658023790009757
Bond Position:  [6.00359149]


portfolio before change:  [5.51744042]
curr_Stock_Price:  104.52964184577887
curr_Factors:  [104.52964185  -1.34218707  -1.19100028]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [5.51744042]
Stock Price:  103.9869809398285
PL:  [1.53045948]
Settle:  Tensor("sub_308:0", shape=(), dtype=float64)
PL:  Tensor("sub_309:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  155
output_Z_Vals[:, i, :]:  [[ 1.19260232e+02 -2.92559343e+01 -2.92733494e+01]
 [ 5.62811110e-03 -1.10983093e-01 -3.79027632e-02]
 [-3.29175882e-02  2.60603506e-02  6.77762909e-02]
 [-1.78722314e-01 -7.19144743e-02 -3.85500207e-03]
 [-5.87814087e-02  6.70241313e-02 -7.80700937e-02]
 [ 3.48329878e-02  2.87897728e-02  6.32015834e-02]
 [ 6.73638872e-02  4.00788826e-02 -1.64885633e-02]
 [-1.60472465e-02 -6.20955154e-02 -3.39042729e-02]
 [ 9.18700928e-02 -4.55492786e-02 -1.57733132e-01]
 [-1.56485734e-01 -1.75929295e-01 -8.53277590e-02]
 [ 1.21486914e-01  8.33342511e-02  2.03343432e-02]
 [-2.02971682e-01 -9.89949993e-02  4.43855181e-02]
 [-6.39177727e-02 -5.05405428e-02  1.25391250e-02]
 [-9.62623594e-02 -1.14884369e-01  6.32126881e-02]
 [ 2.24831203e-01  3.76491920e-01  1.43514861e-01]
 [-4.67235930e-02 -4.21764988e-01 -4.78104225e-02]
 [-6.65914007e-02 -3.58021673e-02 -3.30819157e-02]
 [-7.77675388e-02  1.77289603e-01  1.29070199e-01]
 [ 1.12901644e-01  6.21003002e-02  1.17490454e-01]
 [ 6.38660725e-02 -2.83173636e-02  5.62615236e-02]
 [-3.07450183e-02 -2.54642541e-02 -3.57834197e-03]
 [ 1.10294905e-01 -6.11144709e-02  1.24648729e-01]
 [-2.37194665e-02 -8.29732476e-02  1.77258537e-01]
 [-6.69973255e-02 -6.03805107e-04 -8.24743346e-02]
 [-2.70959139e-01  1.04830350e-01  6.03477269e-02]
 [-2.63466471e-02 -1.35361672e-01  9.67680855e-02]
 [ 1.50523140e-01  4.42681623e-02 -9.79780376e-02]
 [ 2.80111804e-02 -4.31493387e-02 -1.73196236e-02]
 [-4.78928098e-02 -5.02108085e-02 -2.39580337e-01]
 [ 1.19054886e-02 -2.33900875e-03 -1.00686445e-01]
 [ 3.43796447e-02 -5.56768171e-03  3.14120758e-02]
 [ 3.11987948e-02 -6.33938589e-02 -9.13953359e-02]
 [ 3.54100587e-01 -4.57097740e-01 -4.74524799e-01]
 [-4.15988696e-02 -8.08719207e-02 -6.80712606e-03]
 [-1.20142206e-01  3.21199929e-02  3.20916797e-02]
 [ 8.21590737e-02 -1.62895035e-01 -1.37547680e-01]
 [-1.22239597e-01 -2.65057171e-01  2.27223241e-02]
 [-2.61437647e-02  5.53767453e-03 -5.55349876e-02]
 [-4.90622745e-02  9.77133485e-02  2.29215431e-03]
 [-3.06649696e-01  1.67131349e-01  1.82863127e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.26023247 -29.25593426 -29.27334937]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  8.31486419  -9.25153874 -83.50871763]
init_Out:  [2.49911038]
Stock Position:  8.31486419409362
Bond position:  [-828.98730903]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [1.65186151]
curr_Stock_Price:  99.91056751348401
curr_Factors:  [99.91056751 -1.09757193 -0.99275432]
mat_Sqrt:  [[12.35362098  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00040266 -0.03509594 -0.10812603]
Stock Position:  -0.0004026616307432022
Bond Position:  [1.69209166]


portfolio before change:  [1.65211585]
curr_Stock_Price:  99.80424872269833
curr_Factors:  [99.80424872 -0.99920063 -0.98787443]
mat_Sqrt:  [[13.68274689  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00134549  0.00824101  0.19334689]
Stock Position:  -0.0013454853432577569
Bond Position:  [1.786401]


portfolio before change:  [1.6541898]
curr_Stock_Price:  98.42880593748868
curr_Factors:  [98.42880594 -0.55735306 -0.97889439]
mat_Sqrt:  [[21.18060825  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00856283 -0.02274135 -0.01099725]
Stock Position:  -0.008562834214185355
Bond Position:  [2.49701934]


portfolio before change:  [1.6633966]
curr_Stock_Price:  97.39005472947555
curr_Factors:  [97.39005473 -0.61295946 -0.99463181]
mat_Sqrt:  [[19.51401314  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00374023  0.02119489 -0.22271225]
Stock Position:  -0.0037402272745829758
Bond Position:  [2.02765754]


portfolio before change:  [1.66433214]
curr_Stock_Price:  97.20769491760335
curr_Factors:  [97.20769492 -0.96418004 -0.98649203]
mat_Sqrt:  [[13.8208428   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00350755 0.00910413 0.18029653]
Stock Position:  0.003507550620915138
Bond Position:  [1.32337123]


portfolio before change:  [1.66449826]
curr_Stock_Price:  97.20789245882254
curr_Factors:  [97.20789246 -1.12308851 -0.98298082]
mat_Sqrt:  [[11.83170247  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0054965   0.01267406 -0.04703728]
Stock Position:  0.005496504472611297
Bond Position:  [1.13019465]


portfolio before change:  [1.65805818]
curr_Stock_Price:  96.01051913661586
curr_Factors:  [96.01051914 -1.0622308  -0.94488386]
mat_Sqrt:  [[12.90149383  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00190453 -0.01963633 -0.09671945]
Stock Position:  -0.001904525694902255
Bond Position:  [1.84091268]


portfolio before change:  [1.65844003]
curr_Stock_Price:  95.93085591943048
curr_Factors:  [95.93085592 -1.04740924 -0.95206191]
mat_Sqrt:  [[12.98969731  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00450333 -0.01440395 -0.44996872]
Stock Position:  0.004503328540461637
Bond Position:  [1.22643187]


portfolio before change:  [1.65888973]
curr_Stock_Price:  95.99667227948217
curr_Factors:  [95.99667228 -1.12879626 -0.96940739]
mat_Sqrt:  [[11.77654539  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01515263 -0.05563373 -0.24341635]
Stock Position:  -0.015152632521251878
Bond Position:  [3.11349203]


portfolio before change:  [1.64705221]
curr_Stock_Price:  96.80357762427411
curr_Factors:  [96.80357762 -0.93393857 -1.00720349]
mat_Sqrt:  [[13.89517834  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00919667 0.0263526  0.05800822]
Stock Position:  0.009196666786247785
Bond Position:  [0.75678196]


portfolio before change:  [1.64872119]
curr_Stock_Price:  96.97476765390039
curr_Factors:  [96.97476765 -0.86926177 -1.0115067 ]
mat_Sqrt:  [[14.78602312  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01328738 -0.03130497  0.12661953]
Stock Position:  -0.013287383930905517
Bond Position:  [2.93726216]


portfolio before change:  [1.65718181]
curr_Stock_Price:  96.36566006187698
curr_Factors:  [96.36566006 -0.88686959 -0.99688027]
mat_Sqrt:  [[14.64940992  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00427752 -0.01598232  0.03577063]
Stock Position:  -0.004277522857739736
Bond Position:  [2.06938813]


portfolio before change:  [1.65268855]
curr_Stock_Price:  97.4765732439682
curr_Factors:  [97.47657324 -0.93982638 -1.03893872]
mat_Sqrt:  [[13.47514631  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00640627 -0.03632963  0.1803282 ]
Stock Position:  -0.006406269971453028
Bond Position:  [2.27714979]


portfolio before change:  [1.65950975]
curr_Stock_Price:  96.45623848080695
curr_Factors:  [96.45623848 -0.86428666 -1.02315142]
mat_Sqrt:  [[14.60919813  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01806034 0.1190572  0.40940795]
Stock Position:  0.01806033627979689
Bond Position:  [-0.08252236]


portfolio before change:  [1.67843776]
curr_Stock_Price:  97.50485279587835
curr_Factors:  [97.5048528  -0.90040948 -1.02950773]
mat_Sqrt:  [[14.15382547  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00476004 -0.1333738  -0.13638983]
Stock Position:  -0.004760040311202086
Bond Position:  [2.14256479]


portfolio before change:  [1.68111027]
curr_Stock_Price:  96.99967372924213
curr_Factors:  [96.99967373 -0.95332978 -1.0340413 ]
mat_Sqrt:  [[13.29431546  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00558649 -0.01132164 -0.0943735 ]
Stock Position:  -0.005586494969657886
Bond Position:  [2.22299846]


portfolio before change:  [1.67529565]
curr_Stock_Price:  98.09025301744644
curr_Factors:  [98.09025302 -0.89177952 -1.05220411]
mat_Sqrt:  [[14.0399154   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00333646  0.0560639   0.36820135]
Stock Position:  -0.0033364586378526245
Bond Position:  [2.00256972]


portfolio before change:  [1.67403728]
curr_Stock_Price:  98.54244060781767
curr_Factors:  [98.54244061 -0.97610029 -1.07063985]
mat_Sqrt:  [[12.72727315  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01088118 0.01963784 0.33516756]
Stock Position:  0.010881176459422026
Bond Position:  [0.60177959]


portfolio before change:  [1.68273556]
curr_Stock_Price:  99.33491553965989
curr_Factors:  [99.33491554 -0.89741056 -1.07396643]
mat_Sqrt:  [[13.83387281  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00539395 -0.00895474  0.16049847]
Stock Position:  0.005393952782773064
Bond Position:  [1.14692772]


portfolio before change:  [1.68129487]
curr_Stock_Price:  99.04124013008426
curr_Factors:  [99.04124013 -0.68939937 -1.06449251]
mat_Sqrt:  [[17.14393471  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0018743  -0.0080525  -0.01020801]
Stock Position:  -0.0018743030124066383
Bond Position:  [1.86692816]


portfolio before change:  [1.68121152]
curr_Stock_Price:  99.21022640347547
curr_Factors:  [99.2102264  -0.75607297 -1.08976508]
mat_Sqrt:  [[15.66459466  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00856458 -0.01932609  0.35558813]
Stock Position:  0.008564584946680633
Bond Position:  [0.83151711]


portfolio before change:  [1.68372096]
curr_Stock_Price:  99.49109144297431
curr_Factors:  [99.49109144 -1.11639597 -1.08878937]
mat_Sqrt:  [[10.96691227  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0009411  -0.02623844  0.50566927]
Stock Position:  0.0009410963273860689
Bond Position:  [1.59009025]


portfolio before change:  [1.68384621]
curr_Stock_Price:  99.4129659657358
curr_Factors:  [99.41296597 -1.15748659 -1.1247448 ]
mat_Sqrt:  [[10.14571197  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-8.26437011e-03 -1.90939940e-04 -2.35276320e-01]
Stock Position:  -0.008264370113613867
Bond Position:  [2.50543175]


portfolio before change:  [1.68613938]
curr_Stock_Price:  99.17338604062984
curr_Factors:  [99.17338604 -1.11093342 -1.11523139]
mat_Sqrt:  [[10.70493535  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02390804  0.03315027  0.17215527]
Stock Position:  -0.023908038138478145
Bond Position:  [4.05718048]


portfolio before change:  [1.69365087]
curr_Stock_Price:  98.88041725781974
curr_Factors:  [98.88041726 -0.98529247 -1.12195243]
mat_Sqrt:  [[12.02113457  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00083927 -0.04280512  0.27605241]
Stock Position:  -0.0008392691738562242
Bond Position:  [1.77663816]


portfolio before change:  [1.693679]
curr_Stock_Price:  99.11152744217542
curr_Factors:  [99.11152744 -1.06278968 -1.1187786 ]
mat_Sqrt:  [[11.18616198  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01177048  0.01399882 -0.27950407]
Stock Position:  0.011770476440559932
Bond Position:  [0.5270891]


portfolio before change:  [1.7055219]
curr_Stock_Price:  100.11208214759502
curr_Factors:  [100.11208215  -1.53284292  -1.14895862]
mat_Sqrt:  [[ 6.85164546  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00340965 -0.01364502 -0.04940807]
Stock Position:  0.00340965043717637
Bond Position:  [1.36417469]


portfolio before change:  [1.70774515]
curr_Stock_Price:  100.71411570736292
curr_Factors:  [100.71411571  -1.77573546  -1.12557079]
mat_Sqrt:  [[ 5.5343809   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01772436 -0.01587805 -0.68345602]
Stock Position:  -0.01772436352090527
Bond Position:  [3.49283875]


portfolio before change:  [1.71854603]
curr_Stock_Price:  100.12936980663059
curr_Factors:  [100.12936981  -1.77731188  -1.11778682]
mat_Sqrt:  [[ 5.53651003  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00157273 -0.00073966 -0.2872304 ]
Stock Position:  -0.0015727306301885943
Bond Position:  [1.87602256]


portfolio before change:  [1.71896153]
curr_Stock_Price:  100.01429857276378
curr_Factors:  [100.01429857  -1.75479892  -1.11375956]
mat_Sqrt:  [[ 5.67888375  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00715772 -0.00176066  0.08960991]
Stock Position:  0.007157718431359048
Bond Position:  [1.00308734]


portfolio before change:  [1.71800079]
curr_Stock_Price:  99.86255621416471
curr_Factors:  [99.86255621 -1.6393899  -1.12400369]
mat_Sqrt:  [[ 6.29906501  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00173136 -0.0200469  -0.26072545]
Stock Position:  0.0017313645099884761
Bond Position:  [1.54510231]


portfolio before change:  [1.71838115]
curr_Stock_Price:  99.9706827746607
curr_Factors:  [99.97068277 -1.59345911 -1.09174878]
mat_Sqrt:  [[ 6.81870167  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0359946  -0.144547   -1.35368717]
Stock Position:  0.035994595009652054
Bond Position:  [-1.88002309]


portfolio before change:  [1.72551304]
curr_Stock_Price:  100.17534991613377
curr_Factors:  [100.17534992  -1.72392306  -1.11674104]
mat_Sqrt:  [[ 5.84892593  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00770679 -0.02557395 -0.01941884]
Stock Position:  -0.007706794877641897
Bond Position:  [2.49754391]


portfolio before change:  [1.72495757]
curr_Stock_Price:  100.28793724947192
curr_Factors:  [100.28793725  -1.47603406  -1.10866865]
mat_Sqrt:  [[ 7.56356554  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0149086   0.01015723  0.09154863]
Stock Position:  -0.0149086015625677
Bond Position:  [3.22011046]


portfolio before change:  [1.72636965]
curr_Stock_Price:  100.2202214840072
curr_Factors:  [100.22022148  -1.57631026  -1.13273811]
mat_Sqrt:  [[ 6.67468228  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00747247 -0.05151193 -0.39238525]
Stock Position:  0.0074724664439121775
Bond Position:  [0.97747741]


portfolio before change:  [1.72753529]
curr_Stock_Price:  100.35985993653212
curr_Factors:  [100.35985994  -1.62995249  -1.10503823]
mat_Sqrt:  [[ 6.51281393  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01910774 -0.08381844  0.06482047]
Stock Position:  -0.019107742091763243
Bond Position:  [3.64518561]


portfolio before change:  [1.71770397]
curr_Stock_Price:  100.89822765547872
curr_Factors:  [100.89822766  -1.77440928  -1.09808293]
mat_Sqrt:  [[ 5.70658148  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00654276  0.00175117 -0.15842586]
Stock Position:  -0.006542763756262919
Bond Position:  [2.37785724]


portfolio before change:  [1.71889513]
curr_Stock_Price:  100.7616023478964
curr_Factors:  [100.76160235  -1.57002367  -1.11236851]
mat_Sqrt:  [[ 6.89202655  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00668475  0.03089967  0.00653888]
Stock Position:  -0.0066847453821699465
Bond Position:  [2.39246079]


portfolio before change:  [1.71799045]
curr_Stock_Price:  100.94167805176266
curr_Factors:  [100.94167805  -1.5716246   -1.12747776]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [1.71799045]
Stock Price:  101.40676933194307
PL:  [0.31122112]
Settle:  Tensor("sub_310:0", shape=(), dtype=float64)
PL:  Tensor("sub_311:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  156
output_Z_Vals[:, i, :]:  [[ 1.19260232e+02 -2.92559343e+01 -2.92733494e+01]
 [ 4.03706775e-03 -1.27034308e-01 -3.91946428e-02]
 [-3.03416571e-02  5.12418551e-02  1.13413166e-01]
 [-5.64572329e-02  1.14130970e-01  1.15490094e-02]
 [ 6.47494374e-02  2.15997544e-02 -6.92970328e-02]
 [ 5.90307081e-02  2.86486154e-02  2.96367392e-02]
 [ 7.86729158e-02  8.48056459e-03 -8.00947381e-02]
 [-8.57548030e-02  2.14793383e-02 -8.98837134e-02]
 [ 3.65169064e-02 -5.28787065e-02  3.97790570e-03]
 [-5.99264145e-02  1.69451889e-01  4.39110910e-02]
 [ 5.58065978e-02  1.07304771e-01 -8.03174604e-02]
 [-2.41734092e-02  6.25334284e-02 -8.89356311e-03]
 [-1.03674964e-01  3.17904722e-02 -5.08348991e-02]
 [ 1.69995547e-02  6.93690522e-02  1.62509864e-01]
 [ 2.29119388e-01  3.21392006e-01  7.53136269e-02]
 [-7.46338811e-02 -7.93828447e-02 -1.10294651e-01]
 [-7.99739425e-02 -1.94944006e-02 -7.90370342e-02]
 [-1.38650337e-02  1.62448477e-02  2.53719646e-02]
 [ 8.40873439e-02  7.51880069e-02  1.09065622e-01]
 [ 2.32011374e-01 -6.14936862e-02 -1.28947125e-02]
 [-4.73487855e-02  1.71464807e-03 -2.32130138e-02]
 [ 6.55611075e-02 -5.07230180e-02  6.37254938e-02]
 [-5.71000260e-02  4.01812128e-02  1.80639764e-01]
 [-1.02497993e-02 -3.43360782e-02 -6.29951926e-02]
 [-9.13380512e-02  7.45149458e-02  6.18260553e-02]
 [ 3.23496776e-02 -6.89543585e-02  7.79005903e-02]
 [-1.69053375e-01  6.87331317e-02  5.69064909e-02]
 [-4.54313129e-02  6.94312440e-02  2.77906345e-02]
 [-6.57890357e-02 -6.00993736e-02 -2.20588419e-01]
 [ 1.79084047e-02  5.72407329e-05 -8.53672736e-02]
 [ 1.70210047e-02  1.57357303e-01  2.78425460e-02]
 [ 1.49826339e-02 -6.73771645e-02 -8.64548537e-02]
 [ 2.13983989e-01 -2.53500679e-01 -2.11839207e-01]
 [-4.51504764e-02 -8.19477315e-02 -1.49008005e-03]
 [-1.28149253e-01  5.70167181e-02  3.59575033e-02]
 [ 8.47165236e-02 -1.65012150e-01 -1.38726811e-01]
 [-1.39429259e-01 -2.51346113e-01  2.12949545e-02]
 [-3.76523690e-02 -1.38814598e-02 -1.51373227e-03]
 [-4.30306411e-02  9.19757680e-02 -2.14727899e-02]
 [-2.08838799e-01  1.20119463e-01  1.23585915e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.26023247 -29.25593426 -29.27334937]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  8.31486419  -9.25153874 -83.50871763]
init_Out:  [2.49911038]
Stock Position:  8.31486419409362
Bond position:  [-828.98730903]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-0.96324127]
curr_Stock_Price:  99.59605813356546
curr_Factors:  [99.59605813 -0.74997627 -0.9946448 ]
mat_Sqrt:  [[17.40054479  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00041628 -0.04017178 -0.11181141]
Stock Position:  -0.00041628104364509444
Bond Position:  [-0.92178132]


portfolio before change:  [-0.96334286]
curr_Stock_Price:  99.56328415769684
curr_Factors:  [99.56328416 -0.80311429 -0.99842166]
mat_Sqrt:  [[16.4324413   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00035711  0.0162041   0.32353619]
Stock Position:  -0.0003571126408133339
Bond Position:  [-0.92778755]


portfolio before change:  [-0.96329267]
curr_Stock_Price:  99.09797309092001
curr_Factors:  [99.09797309 -0.86298107 -0.98550191]
mat_Sqrt:  [[15.60554038  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00327787  0.03609138  0.03294611]
Stock Position:  -0.0032778712561986134
Bond Position:  [-0.63846227]


portfolio before change:  [-0.96361991]
curr_Stock_Price:  99.1734563818604
curr_Factors:  [99.17345638 -0.93663247 -0.97712717]
mat_Sqrt:  [[14.63053459  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00349693  0.00683044 -0.19768515]
Stock Position:  0.0034969291633267533
Bond Position:  [-1.31042246]


portfolio before change:  [-0.96803794]
curr_Stock_Price:  97.95689900900787
curr_Factors:  [97.95689901 -0.8688026  -0.99399427]
mat_Sqrt:  [[15.20661774  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00432838 0.00905949 0.08454537]
Stock Position:  0.004328377775931754
Bond Position:  [-1.3920324]


portfolio before change:  [-0.96503464]
curr_Stock_Price:  98.6909643983638
curr_Factors:  [98.6909644  -1.0139252  -0.98861363]
mat_Sqrt:  [[13.32250309  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00469451  0.00268179 -0.22848799]
Stock Position:  0.004694509180533578
Bond Position:  [-1.42834028]


portfolio before change:  [-0.96767932]
curr_Stock_Price:  98.16564261214262
curr_Factors:  [98.16564261 -0.69644762 -1.00533801]
mat_Sqrt:  [[17.90125198  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00578438  0.00679236 -0.25641322]
Stock Position:  -0.00578438006121038
Bond Position:  [-0.39985193]


portfolio before change:  [-0.97356576]
curr_Stock_Price:  99.17464493366803
curr_Factors:  [99.17464493 -0.71105383 -1.02037247]
mat_Sqrt:  [[17.55705893  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00204838 -0.01672172  0.01134786]
Stock Position:  0.002048382409478187
Bond Position:  [-1.17671336]


portfolio before change:  [-0.97190875]
curr_Stock_Price:  100.05539034158032
curr_Factors:  [100.05539034  -0.87121727  -0.98778948]
mat_Sqrt:  [[15.59136422  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00298806  0.05358539  0.12526612]
Stock Position:  -0.0029880561410064945
Bond Position:  [-0.67293763]


portfolio before change:  [-0.97318068]
curr_Stock_Price:  100.45290688688915
curr_Factors:  [100.45290689  -1.26174177  -1.00176054]
mat_Sqrt:  [[10.44566147  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00403828  0.03393275 -0.22912336]
Stock Position:  0.004038275816062638
Bond Position:  [-1.37883722]


portfolio before change:  [-0.97258647]
curr_Stock_Price:  100.64273334648934
curr_Factors:  [100.64273335  -1.22517182  -1.026821  ]
mat_Sqrt:  [[10.58654784  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00230237  0.01977481 -0.02537086]
Stock Position:  -0.0023023741427799383
Bond Position:  [-0.74086924]


portfolio before change:  [-0.97255488]
curr_Stock_Price:  100.58878736586149
curr_Factors:  [100.58878737  -1.21870854  -1.01003306]
mat_Sqrt:  [[10.82977407  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01045551  0.01005303 -0.14501782]
Stock Position:  -0.01045550604594963
Bond Position:  [0.07915179]


portfolio before change:  [-0.97806605]
curr_Stock_Price:  101.11684103625242
curr_Factors:  [101.11684104  -1.38886159  -0.98863474]
mat_Sqrt:  [[ 9.38188188  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00553864 0.02193642 0.46359541]
Stock Position:  0.005538637535815619
Bond Position:  [-1.53811559]


portfolio before change:  [-0.98157616]
curr_Stock_Price:  100.5178080337829
curr_Factors:  [100.51780803  -1.07650535  -1.03006136]
mat_Sqrt:  [[12.22848657  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.02067231 0.10163308 0.21484881]
Stock Position:  0.02067230660349171
Bond Position:  [-3.0595111]


portfolio before change:  [-0.96741915]
curr_Stock_Price:  101.22113885348956
curr_Factors:  [101.22113885  -1.01361222  -1.00768327]
mat_Sqrt:  [[13.4101533   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00739718 -0.02510306 -0.31463994]
Stock Position:  -0.0073971815528999325
Bond Position:  [-0.21866801]


portfolio before change:  [-0.97549997]
curr_Stock_Price:  102.30986211427103
curr_Factors:  [102.30986211  -1.36862665  -1.00583703]
mat_Sqrt:  [[ 9.52140465  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01014668 -0.00616467 -0.22547066]
Stock Position:  -0.010146680697011665
Bond Position:  [0.06260553]


portfolio before change:  [-0.97525129]
curr_Stock_Price:  102.28612476915328
curr_Factors:  [102.28612477  -1.44082614  -1.00267272]
mat_Sqrt:  [[ 8.88420663  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00093048  0.00513707  0.07237915]
Stock Position:  -0.0009304784701458006
Bond Position:  [-0.88007625]


portfolio before change:  [-0.97456356]
curr_Stock_Price:  101.4287710305519
curr_Factors:  [101.42877103  -1.62662647  -0.98648608]
mat_Sqrt:  [[ 7.43533949  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01456445 0.02377654 0.31113386]
Stock Position:  0.014564448181499929
Bond Position:  [-2.45181763]


portfolio before change:  [-0.97944033]
curr_Stock_Price:  101.11497394551319
curr_Factors:  [101.11497395  -1.25103044  -0.97557795]
mat_Sqrt:  [[10.90967305  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.02087977 -0.01944601 -0.03678503]
Stock Position:  0.02087977256290627
Bond Position:  [-3.09069799]


portfolio before change:  [-0.97324078]
curr_Stock_Price:  101.43039484344285
curr_Factors:  [101.43039484  -1.03685581  -0.96526246]
mat_Sqrt:  [[13.69806427  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00379928  0.00054222 -0.06622027]
Stock Position:  -0.003799284993996982
Bond Position:  [-0.5878778]


portfolio before change:  [-0.97366897]
curr_Stock_Price:  101.52375526674685
curr_Factors:  [101.52375527  -1.2256552   -0.93747762]
mat_Sqrt:  [[11.67161696  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00661942 -0.01604003  0.1817911 ]
Stock Position:  0.006619421888448172
Bond Position:  [-1.64569754]


portfolio before change:  [-0.97050676]
curr_Stock_Price:  102.0325512009206
curr_Factors:  [102.0325512   -1.29202509  -0.93195428]
mat_Sqrt:  [[11.03765405  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00173856  0.01270642  0.51531497]
Stock Position:  -0.0017385591127173875
Bond Position:  [-0.79311714]


portfolio before change:  [-0.96894603]
curr_Stock_Price:  101.07780867937807
curr_Factors:  [101.07780868  -1.47875444  -0.91508482]
mat_Sqrt:  [[ 9.22623772  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00260076 -0.01085802 -0.17970775]
Stock Position:  -0.0026007559731925853
Bond Position:  [-0.70606731]


portfolio before change:  [-0.968888]
curr_Stock_Price:  101.02155978534326
curr_Factors:  [101.02155979  -1.25227293  -0.91927235]
mat_Sqrt:  [[11.5165908   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00666811  0.02356369  0.17637253]
Stock Position:  -0.006668109883151386
Bond Position:  [-0.29526514]


portfolio before change:  [-0.97006719]
curr_Stock_Price:  101.19286349729828
curr_Factors:  [101.1928635   -1.04062654  -0.89813907]
mat_Sqrt:  [[14.55977564  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00319172 -0.02180528  0.2222287 ]
Stock Position:  0.0031917164310071087
Bond Position:  [-1.29304611]


portfolio before change:  [-0.96857035]
curr_Stock_Price:  101.71248294648642
curr_Factors:  [101.71248295  -0.94912779  -0.87252122]
mat_Sqrt:  [[16.45288797  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00946112  0.02173532  0.16233838]
Stock Position:  -0.009461117360790123
Bond Position:  [-0.00625661]


portfolio before change:  [-0.96901789]
curr_Stock_Price:  101.75970358186993
curr_Factors:  [101.75970358  -1.01778029  -0.87452053]
mat_Sqrt:  [[15.33769252  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00247533  0.02195609  0.07927894]
Stock Position:  -0.002475331042540141
Bond Position:  [-0.71712894]


portfolio before change:  [-0.9674843]
curr_Stock_Price:  101.10393788065232
curr_Factors:  [101.10393788  -1.0972752   -0.87943073]
mat_Sqrt:  [[14.00540248  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00802321 -0.01900509 -0.62927736]
Stock Position:  -0.008023205154569373
Bond Position:  [-0.15630667]


portfolio before change:  [-0.97537335]
curr_Stock_Price:  102.0847814119399
curr_Factors:  [102.08478141  -0.9087439   -0.88159343]
mat_Sqrt:  [[17.03834384  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 2.84276987e-05  1.81011091e-05 -2.43529070e-01]
Stock Position:  2.8427698702041337e-05
Bond Position:  [-0.97827538]


portfolio before change:  [-0.97549182]
curr_Stock_Price:  102.21916605952386
curr_Factors:  [102.21916606  -1.18494776  -0.9054226 ]
mat_Sqrt:  [[12.63851427  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00211791 0.04976075 0.07942703]
Stock Position:  0.0021179141877668587
Bond Position:  [-1.19198324]


portfolio before change:  [-0.97637162]
curr_Stock_Price:  101.87411468124495
curr_Factors:  [101.87411468  -1.34197311  -0.92122426]
mat_Sqrt:  [[10.59667758  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00041565 -0.02130653 -0.24663163]
Stock Position:  -0.00041565482337745584
Bond Position:  [-0.93402715]


portfolio before change:  [-0.97655157]
curr_Stock_Price:  102.02614434185514
curr_Factors:  [102.02614434  -1.36844486  -0.9225689 ]
mat_Sqrt:  [[10.32135791  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01590848 -0.08016395 -0.60431829]
Stock Position:  0.0159084815776899
Bond Position:  [-2.59963261]


portfolio before change:  [-0.96383926]
curr_Stock_Price:  102.84566226476738
curr_Factors:  [102.84566226  -1.45296106  -0.94511146]
mat_Sqrt:  [[ 9.34794855  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00508887 -0.02591415 -0.00425078]
Stock Position:  -0.005088872579366233
Bond Position:  [-0.44047079]


portfolio before change:  [-0.96199047]
curr_Stock_Price:  102.47154211677379
curr_Factors:  [102.47154212  -1.36418615  -0.94325261]
mat_Sqrt:  [[10.19753854  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01170256  0.01803027  0.10257675]
Stock Position:  -0.011702558707303821
Bond Position:  [0.23718877]


portfolio before change:  [-0.95753161]
curr_Stock_Price:  102.09305984445128
curr_Factors:  [102.09305984  -1.29070273  -0.94480401]
mat_Sqrt:  [[10.91762018  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00477562 -0.05218142 -0.39574898]
Stock Position:  0.004775622858216032
Bond Position:  [-1.44508956]


portfolio before change:  [-0.96051662]
curr_Stock_Price:  101.5058350210702
curr_Factors:  [101.50583502  -1.11594617  -0.94552258]
mat_Sqrt:  [[12.91833389  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01095901 -0.07948262  0.06074858]
Stock Position:  -0.010959011811256086
Bond Position:  [0.15188702]


portfolio before change:  [-0.97161428]
curr_Stock_Price:  102.52021910625628
curr_Factors:  [102.52021911  -1.0706619   -0.96207101]
mat_Sqrt:  [[13.42779929  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00285376 -0.0043897  -0.00431826]
Stock Position:  -0.0028537644352412917
Bond Position:  [-0.67904573]


portfolio before change:  [-0.97154949]
curr_Stock_Price:  102.46777021930644
curr_Factors:  [102.46777022  -0.62820746  -0.92398979]
mat_Sqrt:  [[21.70084216  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00207545  0.02908529 -0.06125589]
Stock Position:  -0.0020754471906403627
Bond Position:  [-0.75888304]


portfolio before change:  [-0.97189455]
curr_Stock_Price:  102.5883187818584
curr_Factors:  [102.58831878  -0.82263671  -0.93562166]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-0.97189455]
Stock Price:  103.34876623893678
PL:  [-4.32066079]
Settle:  Tensor("sub_312:0", shape=(), dtype=float64)
PL:  Tensor("sub_313:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  157
output_Z_Vals[:, i, :]:  [[ 1.19260232e+02 -2.92559343e+01 -2.92733494e+01]
 [-7.19500879e-03 -5.33874424e-02 -2.42372457e-02]
 [ 1.44301889e-01  3.31055592e-02 -1.44010526e-01]
 [ 8.20403420e-02  1.43698418e-01  3.76009801e-02]
 [ 1.44769876e-01 -4.78702747e-03 -6.54226105e-02]
 [ 5.35400883e-02  2.74284029e-02 -9.21065814e-03]
 [ 1.65676574e-02  5.61197223e-02 -8.20215265e-03]
 [-1.22991589e-01  2.56002189e-01  1.33954240e-02]
 [ 4.63813388e-02 -2.31897858e-03 -9.72206985e-02]
 [-2.64122990e-02  3.70248756e-01  1.49331559e-01]
 [ 5.63892377e-02  2.80728929e-02 -7.71799807e-02]
 [-3.23299792e-02  1.76887473e-02 -5.15318356e-03]
 [-1.05565191e-01  2.03714950e-02 -4.15764664e-02]
 [ 3.50722946e-02  6.75075605e-03  1.47654073e-01]
 [ 1.71912402e-01  1.48179752e-01 -4.74599113e-02]
 [-8.37194070e-02 -1.26011730e-01 -1.13157630e-01]
 [-6.69059771e-02 -5.26164968e-02 -4.48357794e-02]
 [-7.80839930e-02  1.74254051e-01  1.28441158e-01]
 [ 8.22771087e-02  5.78549134e-02  7.57358250e-02]
 [ 1.26498677e-01 -3.85232763e-02  2.72163155e-02]
 [-3.37108315e-02 -2.69679917e-02  2.61306245e-03]
 [ 1.10700516e-01 -5.86953470e-02  1.44027292e-01]
 [-8.49131975e-02  1.19406944e-01  3.87856843e-01]
 [-2.88032306e-02 -8.07059891e-03 -7.91017130e-02]
 [-2.33429950e-02  4.12204888e-03 -1.11658129e-03]
 [ 9.89719208e-02  6.16471910e-03  5.65144119e-02]
 [-1.96028522e-01  6.74686709e-02  7.71136936e-02]
 [-5.07806065e-02  7.36225950e-02  2.93687317e-02]
 [ 6.11185666e-02 -7.42638897e-02  5.10033509e-03]
 [ 1.02541863e-02 -1.32135743e-02 -1.23936804e-01]
 [-3.85573171e-02  3.18429157e-01  1.30574806e-02]
 [ 2.20430515e-02 -1.33649079e-01 -6.38321490e-02]
 [-7.27972509e-02  2.37855346e-02  8.41582862e-02]
 [-1.33733336e-01 -6.50581844e-02  6.50575887e-03]
 [-1.49340075e-01  1.20220861e-01  3.49653342e-02]
 [ 8.89546806e-02 -1.63220369e-01 -1.36560121e-01]
 [-1.92621510e-01 -3.23001037e-01  4.74437660e-02]
 [-5.97827970e-02 -6.90644391e-02  1.04671144e-01]
 [-2.87045324e-02  6.19322697e-02 -3.04617743e-02]
 [-2.19325659e-01  1.22672244e-01  1.33436712e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.26023247 -29.25593426 -29.27334937]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  8.31486419  -9.25153874 -83.50871763]
init_Out:  [2.49911038]
Stock Position:  8.31486419409362
Bond position:  [-828.98730903]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [4.74720957]
curr_Stock_Price:  100.28283433428
curr_Factors:  [100.28283433  -0.91896212  -0.9855032 ]
mat_Sqrt:  [[14.93233828  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00090548 -0.01688259 -0.06914212]
Stock Position:  -0.0009054759828953144
Bond Position:  [4.83801327]


portfolio before change:  [4.74650195]
curr_Stock_Price:  101.7322417401434
curr_Factors:  [101.73224174  -0.93309566  -1.01727736]
mat_Sqrt:  [[14.46846224  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00800089  0.0104689  -0.41082195]
Stock Position:  0.008000894894176347
Bond Position:  [3.93255298]


portfolio before change:  [4.73933978]
curr_Stock_Price:  100.77562660345512
curr_Factors:  [100.7756266   -0.82664769  -1.00549956]
mat_Sqrt:  [[16.13110303  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00579166 0.04544143 0.10726513]
Stock Position:  0.005791661419779706
Bond Position:  [4.15568147]


portfolio before change:  [4.73654981]
curr_Stock_Price:  100.20420866211097
curr_Factors:  [100.20420866  -0.40379125  -1.00632866]
mat_Sqrt:  [[24.46125121  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00536734 -0.00151379 -0.1866325 ]
Stock Position:  0.005367343617119606
Bond Position:  [4.19871939]


portfolio before change:  [4.73308124]
curr_Stock_Price:  99.46018291488824
curr_Factors:  [99.46018291 -0.19863462 -1.02628746]
mat_Sqrt:  [[29.21947124  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00179224  0.00867362 -0.02627544]
Stock Position:  0.0017922353375289242
Bond Position:  [4.55482519]


portfolio before change:  [4.7349662]
curr_Stock_Price:  100.19422249123322
curr_Factors:  [100.19422249  -0.47636737  -1.03724594]
mat_Sqrt:  [[22.05407104  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00074102  0.01774661 -0.02339846]
Stock Position:  0.0007410153426079934
Bond Position:  [4.66072075]


portfolio before change:  [4.73591129]
curr_Stock_Price:  100.68336038964856
curr_Factors:  [100.68336039  -0.25680708  -1.02646448]
mat_Sqrt:  [[27.9022964   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00407305  0.080955    0.03821342]
Stock Position:  -0.00407304510694989
Bond Position:  [5.14599916]


portfolio before change:  [4.73700871]
curr_Stock_Price:  100.57186265626633
curr_Factors:  [100.57186266  -0.34072341  -1.03446384]
mat_Sqrt:  [[25.42378823  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0010414  -0.00073333 -0.27734359]
Stock Position:  0.00104140149439522
Bond Position:  [4.63227302]


portfolio before change:  [4.7383002]
curr_Stock_Price:  101.25595701350177
curr_Factors:  [101.25595701  -0.32036919  -1.02466555]
mat_Sqrt:  [[26.38028104  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00051666 0.11708294 0.42600137]
Stock Position:  0.0005166608939366712
Bond Position:  [4.68598521]


portfolio before change:  [4.73926919]
curr_Stock_Price:  101.99764462733532
curr_Factors:  [101.99764463  -0.38199788  -1.02259571]
mat_Sqrt:  [[25.03703515  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00165194  0.00887743 -0.220173  ]
Stock Position:  0.0016519439659764398
Bond Position:  [4.57077479]


portfolio before change:  [4.7374842]
curr_Stock_Price:  100.57122171795797
curr_Factors:  [100.57122172  -0.57550025  -1.02467794]
mat_Sqrt:  [[20.30136162  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00162182  0.00559367 -0.0147006 ]
Stock Position:  -0.001621819634221067
Bond Position:  [4.90059258]


portfolio before change:  [4.73946343]
curr_Stock_Price:  99.72857725164168
curr_Factors:  [99.72857725 -0.65994073 -1.00853896]
mat_Sqrt:  [[18.8021755   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00603792  0.00644203 -0.11860609]
Stock Position:  -0.00603791630376572
Bond Position:  [5.34161623]


portfolio before change:  [4.73131956]
curr_Stock_Price:  101.1879568941728
curr_Factors:  [101.18795689  -0.7256472   -1.00642427]
mat_Sqrt:  [[17.90192544  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00365248 0.00213478 0.42121597]
Stock Position:  0.0036524763811704663
Bond Position:  [4.36173294]


portfolio before change:  [4.72904409]
curr_Stock_Price:  100.41568013031038
curr_Factors:  [100.41568013  -0.63462377  -0.99197364]
mat_Sqrt:  [[19.74145931  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00841127  0.04685855 -0.13538992]
Stock Position:  0.008411266392257687
Bond Position:  [3.88442105]


portfolio before change:  [4.72623483]
curr_Stock_Price:  100.02396252233858
curr_Factors:  [100.02396252  -0.52174329  -0.96108133]
mat_Sqrt:  [[22.70499996  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00484788 -0.03984841 -0.32280722]
Stock Position:  -0.004847884630704467
Bond Position:  [5.21113946]


portfolio before change:  [4.73258971]
curr_Stock_Price:  98.84748155944399
curr_Factors:  [98.84748156 -0.4312776  -0.91172224]
mat_Sqrt:  [[25.80525691  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00300003 -0.0166388  -0.127904  ]
Stock Position:  -0.0030000319162559646
Bond Position:  [5.02913531]


portfolio before change:  [4.73400086]
curr_Stock_Price:  98.58666130302082
curr_Factors:  [98.5866613  -0.50865354 -0.89813247]
mat_Sqrt:  [[24.14675391  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00196162  0.05510397  0.36640687]
Stock Position:  -0.001961623138496918
Bond Position:  [4.92739073]


portfolio before change:  [4.73410044]
curr_Stock_Price:  98.84990026539734
curr_Factors:  [98.84990027 -0.69933393 -0.8656829 ]
mat_Sqrt:  [[20.66798124  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00480117 0.01829533 0.21605323]
Stock Position:  0.004801166867522405
Bond Position:  [4.25950558]


portfolio before change:  [4.73910231]
curr_Stock_Price:  99.78079781579306
curr_Factors:  [99.78079782 -0.65686933 -0.83387304]
mat_Sqrt:  [[22.47117523  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00583234 -0.01218213  0.07764057]
Stock Position:  0.005832339277763951
Bond Position:  [4.15714684]


portfolio before change:  [4.73658215]
curr_Stock_Price:  99.25959381559274
curr_Factors:  [99.25959382 -0.45570863 -0.82889701]
mat_Sqrt:  [[27.4710559   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00123307 -0.00852803  0.00745434]
Stock Position:  -0.0012330706543394918
Bond Position:  [4.85897624]


portfolio before change:  [4.73807748]
curr_Stock_Price:  98.53950573973262
curr_Factors:  [98.53950574 -0.16748987 -0.80102842]
mat_Sqrt:  [[37.41004491  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00370447 -0.0185611   0.41086978]
Stock Position:  0.0037044717927678618
Bond Position:  [4.37304066]


portfolio before change:  [4.74049539]
curr_Stock_Price:  99.04463824529857
curr_Factors:  [99.04463825 -0.35250285 -0.80358972]
mat_Sqrt:  [[31.17068492  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-8.53101835e-05  3.77597913e-02  1.10644762e+00]
Stock Position:  -8.53101835059669e-05
Bond Position:  [4.74894491]


portfolio before change:  [4.74113533]
curr_Stock_Price:  98.5020327642499
curr_Factors:  [ 9.85020328e+01 -4.08169680e-02 -8.11161890e-01]
mat_Sqrt:  [[42.01800964  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00107473 -0.00255215 -0.22565517]
Stock Position:  -0.0010747339649799512
Bond Position:  [4.84699881]


portfolio before change:  [4.73529071]
curr_Stock_Price:  104.50401777821986
curr_Factors:  [ 1.04504018e+02 -8.13643514e-02 -8.03664906e-01]
mat_Sqrt:  [[43.12902743  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00054405  0.00130351 -0.0031853 ]
Stock Position:  -0.000544053199310333
Bond Position:  [4.79214645]


portfolio before change:  [4.73590558]
curr_Stock_Price:  104.47494857636592
curr_Factors:  [ 1.04474949e+02 -1.63350986e-02 -8.25835113e-01]
mat_Sqrt:  [[45.00515794  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00245899 0.00194946 0.16121989]
Stock Position:  0.0024589859094016247
Bond Position:  [4.47900315]


portfolio before change:  [4.73049672]
curr_Stock_Price:  102.04762004311971
curr_Factors:  [102.04762004   0.41576858  -0.81977005]
mat_Sqrt:  [[68.13139317  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00262061  0.02133547  0.2199839 ]
Stock Position:  -0.0026206087048511358
Bond Position:  [4.99792361]


portfolio before change:  [4.72721153]
curr_Stock_Price:  103.53963091205911
curr_Factors:  [103.53963091   0.36513113  -0.81670588]
mat_Sqrt:  [[65.91590102  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0006506   0.02328151  0.08378082]
Stock Position:  -0.0006505988895825069
Bond Position:  [4.7945743]


portfolio before change:  [4.72781149]
curr_Stock_Price:  103.53870902405427
curr_Factors:  [103.53870902   0.13775768  -0.84063287]
mat_Sqrt:  [[51.26818334  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00117504 -0.0234843   0.01454984]
Stock Position:  0.0011750403228693957
Bond Position:  [4.60614933]


portfolio before change:  [4.72609308]
curr_Stock_Price:  101.58625579196264
curr_Factors:  [101.58625579   0.23302493  -0.827933  ]
mat_Sqrt:  [[56.03632698  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-2.74562622e-04 -4.17849907e-03 -3.53557204e-01]
Stock Position:  -0.000274562621551658
Bond Position:  [4.75398487]


portfolio before change:  [4.72681009]
curr_Stock_Price:  101.13928876046599
curr_Factors:  [ 1.01139289e+02  9.96593265e-02 -8.35350132e-01]
mat_Sqrt:  [[48.46335076  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00057095  0.10069614  0.03724936]
Stock Position:  -0.0005709502983462393
Bond Position:  [4.78455559]


portfolio before change:  [4.72637357]
curr_Stock_Price:  102.95140043875917
curr_Factors:  [ 1.02951400e+02  9.75731182e-02 -8.22667497e-01]
mat_Sqrt:  [[49.85718695  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 1.11569957e-04 -4.22635498e-02 -1.82095354e-01]
Stock Position:  0.0001115699570209849
Bond Position:  [4.71488728]


portfolio before change:  [4.72710293]
curr_Stock_Price:  104.20586984569624
curr_Factors:  [104.20586985  -0.11977738  -0.80962374]
mat_Sqrt:  [[41.13944283  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00133702  0.00752165  0.24008017]
Stock Position:  -0.001337022793358114
Bond Position:  [4.86642855]


portfolio before change:  [4.7258295]
curr_Stock_Price:  105.61329738623277
curr_Factors:  [ 1.05613297e+02  5.48243736e-02 -8.07455005e-01]
mat_Sqrt:  [[49.75712426  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00269479 -0.0205732   0.01855912]
Stock Position:  -0.002694792972030318
Bond Position:  [5.01043548]


portfolio before change:  [4.71878505]
curr_Stock_Price:  108.45982194583543
curr_Factors:  [ 1.08459822e+02 -6.70372250e-02 -8.22799096e-01]
mat_Sqrt:  [[44.54694064  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00312252  0.03801717  0.09974637]
Stock Position:  -0.003122520074815085
Bond Position:  [5.05745302]


portfolio before change:  [4.72493908]
curr_Stock_Price:  106.69144118079058
curr_Factors:  [ 1.06691441e+02 -1.02322627e-01 -8.16072606e-01]
mat_Sqrt:  [[42.586858    0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00133527 -0.05161481 -0.38956801]
Stock Position:  0.001335274155796848
Bond Position:  [4.58247675]


portfolio before change:  [4.72462729]
curr_Stock_Price:  106.02892980637928
curr_Factors:  [ 1.0602893e+02  2.1522760e-02 -8.1707791e-01]
mat_Sqrt:  [[47.85410148  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00399709 -0.1021419   0.13534386]
Stock Position:  -0.003997085663274294
Bond Position:  [5.14843401]


portfolio before change:  [4.72202456]
curr_Stock_Price:  106.84110219154427
curr_Factors:  [ 1.06841102e+02  4.43621923e-03 -8.29581968e-01]
mat_Sqrt:  [[46.81468591  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00085871 -0.02184009  0.29859764]
Stock Position:  -0.0008587075735691056
Bond Position:  [4.81376983]


portfolio before change:  [4.72390839]
curr_Stock_Price:  105.3480803575847
curr_Factors:  [ 1.05348080e+02 -4.32437100e-02 -7.96761287e-01]
mat_Sqrt:  [[45.47964766  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00073271  0.0195847  -0.08689896]
Stock Position:  -0.0007327108590299887
Bond Position:  [4.80109807]


portfolio before change:  [4.72580297]
curr_Stock_Price:  103.58148544701046
curr_Factors:  [103.58148545  -0.10485337  -0.77417851]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [4.72580297]
Stock Price:  104.24679803487713
PL:  [0.47900493]
Settle:  Tensor("sub_314:0", shape=(), dtype=float64)
PL:  Tensor("sub_315:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  158
output_Z_Vals[:, i, :]:  [[ 1.19260232e+02 -2.92559343e+01 -2.92733494e+01]
 [-7.53017376e-03 -5.23301842e-02 -2.41782358e-02]
 [-2.71625102e-02  5.23752927e-02  1.04102513e-01]
 [-5.72931187e-02  1.25015925e-01  1.13087686e-02]
 [-3.93749897e-02  6.11720434e-02 -7.07465248e-02]
 [ 5.95696543e-02  2.86425997e-02  2.87993947e-02]
 [ 2.51585118e-02  4.38309859e-02  3.30354184e-02]
 [-2.92082217e-02 -1.06807709e-01 -3.99632942e-02]
 [ 1.08560488e-01 -4.45543471e-02 -1.44413859e-01]
 [-9.14946203e-02 -1.36972405e-01 -1.24879625e-01]
 [ 5.66099495e-02  1.20757928e-01 -8.19571544e-02]
 [-4.56105741e-02  5.64044496e-02  3.87216183e-03]
 [-1.01327636e-01  2.55645991e-02 -5.18325827e-02]
 [ 3.23301665e-03  2.57207298e-02  1.42529923e-01]
 [ 2.06234296e-01  2.69354817e-01  4.58048105e-02]
 [-6.07181661e-02 -4.77560712e-02 -1.07782627e-01]
 [-7.65939526e-02 -3.94720874e-02 -5.26414898e-02]
 [ 2.43022552e-02 -1.12423875e-01 -5.41709173e-02]
 [ 2.04100918e-02  6.86566738e-02  2.47464431e-02]
 [ 3.35482535e-01 -9.56781329e-02 -6.03393486e-02]
 [-4.46330685e-02  1.88929646e-04 -4.83700215e-02]
 [ 6.00398999e-02 -4.69099119e-02  5.83473131e-02]
 [-1.76240858e-02 -9.50793837e-02  8.59071328e-02]
 [-3.45094522e-02 -5.03981373e-02 -6.48692979e-02]
 [-1.82400959e-01  9.55504267e-02  4.68752360e-02]
 [ 9.35434164e-03 -9.47197206e-02  8.52637366e-02]
 [-1.34606385e-01  6.44072051e-02  3.04948252e-02]
 [ 1.21691840e-03  2.91899588e-02  1.63793847e-02]
 [-1.77928341e-02 -5.39650366e-02 -2.44662503e-01]
 [ 5.29759401e-02  1.36122085e-02  1.39797865e-02]
 [ 1.84628706e-04  2.13965791e-01  2.20432149e-02]
 [ 1.65639532e-02 -8.74212956e-02 -7.86641199e-02]
 [ 1.30843250e-01 -1.41269098e-01 -7.31620894e-02]
 [-4.68898781e-02 -8.29641721e-02 -1.78975324e-03]
 [-1.39977245e-01  9.22951080e-02  3.54037085e-02]
 [ 8.47165236e-02 -1.65012150e-01 -1.38726811e-01]
 [-1.64104147e-01 -2.57876702e-01  2.17790875e-02]
 [-4.31414508e-02 -2.31435053e-02  2.42519542e-02]
 [-3.60661412e-02  7.73704103e-02 -2.58426982e-02]
 [ 4.79924035e-02  7.67857253e-03 -4.43924978e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.26023247 -29.25593426 -29.27334937]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  8.31486419  -9.25153874 -83.50871763]
init_Out:  [2.49911038]
Stock Position:  8.31486419409362
Bond position:  [-828.98730903]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [4.59594289]
curr_Stock_Price:  100.26464201352306
curr_Factors:  [100.26464201  -1.23808718  -0.99470634]
mat_Sqrt:  [[10.75122385  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00128513 -0.01654826 -0.06897378]
Stock Position:  -0.0012851276489018362
Bond Position:  [4.72479576]


portfolio before change:  [4.59730947]
curr_Stock_Price:  99.66085800639786
curr_Factors:  [99.66085801 -1.22292725 -0.98148235]
mat_Sqrt:  [[10.994151    0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0004148   0.01656252  0.29697549]
Stock Position:  -0.00041479778271250126
Bond Position:  [4.63864857]


portfolio before change:  [4.59820224]
curr_Stock_Price:  98.90649426093822
curr_Factors:  [98.90649426 -1.01597916 -0.97398013]
mat_Sqrt:  [[13.52061578  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00382799  0.03953351  0.03226077]
Stock Position:  -0.003827993450304038
Bond Position:  [4.97681566]


portfolio before change:  [4.60257003]
curr_Stock_Price:  97.92800644763312
curr_Factors:  [97.92800645 -0.84552364 -0.97123218]
mat_Sqrt:  [[15.91841742  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00328152  0.0193443  -0.20182014]
Stock Position:  -0.003281520196942321
Bond Position:  [4.92392276]


portfolio before change:  [4.60305033]
curr_Stock_Price:  97.96921684594446
curr_Factors:  [97.96921685 -0.67195387 -0.97643834]
mat_Sqrt:  [[18.84525398  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00351218 0.00905759 0.08215666]
Stock Position:  0.0035121763272524835
Bond Position:  [4.25896516]


portfolio before change:  [4.59884098]
curr_Stock_Price:  96.61912745097626
curr_Factors:  [96.61912745 -0.73918696 -0.94104408]
mat_Sqrt:  [[18.00313112  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00183488 0.01386057 0.09424085]
Stock Position:  0.0018348780138424782
Bond Position:  [4.42155667]


portfolio before change:  [4.5978741]
curr_Stock_Price:  95.79094902260968
curr_Factors:  [95.79094902 -0.5942734  -0.89647272]
mat_Sqrt:  [[21.57255901  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00185993 -0.03377556 -0.11400415]
Stock Position:  -0.00185993039459453
Bond Position:  [4.7760386]


portfolio before change:  [4.59674623]
curr_Stock_Price:  96.71835538187608
curr_Factors:  [96.71835538 -0.8329328  -0.89159488]
mat_Sqrt:  [[17.24074576  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00452021 -0.01408932 -0.41197254]
Stock Position:  0.004520207265597927
Bond Position:  [4.15955922]


portfolio before change:  [4.60017155]
curr_Stock_Price:  97.36109936698344
curr_Factors:  [97.36109937 -0.85392812 -0.89324046]
mat_Sqrt:  [[16.96679434  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00710341 -0.04331448 -0.35624681]
Stock Position:  -0.007103414880898726
Bond Position:  [5.29176783]


portfolio before change:  [4.58057371]
curr_Stock_Price:  100.21315715462802
curr_Factors:  [100.21315715  -0.99232566  -0.90122307]
mat_Sqrt:  [[15.08575258  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00285027  0.03818701 -0.23380095]
Stock Position:  0.0028502702413766242
Bond Position:  [4.29493913]


portfolio before change:  [4.58359921]
curr_Stock_Price:  101.08626727740427
curr_Factors:  [101.08626728  -1.01034887  -0.85459509]
mat_Sqrt:  [[15.65875719  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0027693   0.01783665  0.0110462 ]
Stock Position:  -0.002769301243538243
Bond Position:  [4.86353753]


portfolio before change:  [4.58461745]
curr_Stock_Price:  100.93812138336882
curr_Factors:  [100.93812138  -1.16396469  -0.84306695]
mat_Sqrt:  [[13.56477052  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00820123  0.00808424 -0.14786393]
Stock Position:  -0.008201232897984866
Bond Position:  [5.41243449]


portfolio before change:  [4.58561471]
curr_Stock_Price:  100.89902230354438
curr_Factors:  [100.8990223   -1.13744543  -0.80999475]
mat_Sqrt:  [[14.39210873  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00229229 0.00813361 0.4065982 ]
Stock Position:  0.002292292426426505
Bond Position:  [4.35432464]


portfolio before change:  [4.58685471]
curr_Stock_Price:  101.20250781324464
curr_Factors:  [101.20250781  -1.15742165  -0.83649806]
mat_Sqrt:  [[13.77980111  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01614964 0.08517747 0.13066837]
Stock Position:  0.016149643479323426
Bond Position:  [2.95247029]


portfolio before change:  [4.61220098]
curr_Stock_Price:  102.74911686203839
curr_Factors:  [102.74911686  -1.21601634  -0.83867967]
mat_Sqrt:  [[13.16542729  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00637672 -0.0151018  -0.30747383]
Stock Position:  -0.0063767211873951265
Bond Position:  [5.26740345]


portfolio before change:  [4.61959103]
curr_Stock_Price:  101.69346596584919
curr_Factors:  [101.69346597  -1.13503298  -0.84120176]
mat_Sqrt:  [[14.09370597  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00626936 -0.01248217 -0.15017152]
Stock Position:  -0.006269360010693171
Bond Position:  [5.25714398]


portfolio before change:  [4.61148312]
curr_Stock_Price:  103.09155143635162
curr_Factors:  [103.09155144  -1.20344459  -0.8628871 ]
mat_Sqrt:  [[13.05649552  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00079209 -0.03555155 -0.15453455]
Stock Position:  0.000792087818588378
Bond Position:  [4.52982555]


portfolio before change:  [4.61190638]
curr_Stock_Price:  102.91101303861076
curr_Factors:  [102.91101304  -1.25247912  -0.88505972]
mat_Sqrt:  [[12.13781551  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00224374 0.02171115 0.07059471]
Stock Position:  0.002243743612445316
Bond Position:  [4.38100045]


portfolio before change:  [4.61112787]
curr_Stock_Price:  102.31996188855666
curr_Factors:  [102.31996189  -1.51812557  -0.8754893 ]
mat_Sqrt:  [[ 9.34171565  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.03432939 -0.03025608 -0.17213137]
Stock Position:  0.03432939199427163
Bond Position:  [1.09854579]


portfolio before change:  [4.58988158]
curr_Stock_Price:  101.69706647558003
curr_Factors:  [101.69706648  -1.6978495   -0.8999882 ]
mat_Sqrt:  [[ 7.56975543  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-7.19992609e-03  5.97447998e-05 -1.37986208e-01]
Stock Position:  -0.0071999260925416034
Bond Position:  [5.32209294]


portfolio before change:  [4.58930028]
curr_Stock_Price:  101.87020707431851
curr_Factors:  [101.87020707  -1.45664802  -0.92643824]
mat_Sqrt:  [[ 9.39909358  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00752613 -0.01483422  0.16644864]
Stock Position:  0.007526128554988551
Bond Position:  [3.822612]


portfolio before change:  [4.58461817]
curr_Stock_Price:  101.1846007999457
curr_Factors:  [101.1846008   -1.75854961  -0.89526793]
mat_Sqrt:  [[ 7.12157593  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00035713 -0.03006674  0.24506914]
Stock Position:  -0.0003571266950707894
Bond Position:  [4.6207539]


portfolio before change:  [4.58530522]
curr_Stock_Price:  100.87823102605832
curr_Factors:  [100.87823103  -1.64002149  -0.91256666]
mat_Sqrt:  [[ 7.85638058  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0062436  -0.01593729 -0.18505405]
Stock Position:  -0.0062436023880846235
Bond Position:  [5.21514878]


portfolio before change:  [4.58739412]
curr_Stock_Price:  100.64808057011207
curr_Factors:  [100.64808057  -1.65994755  -0.89537732]
mat_Sqrt:  [[ 7.8170341   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02179413  0.0302157   0.133722  ]
Stock Position:  -0.021794134250578336
Bond Position:  [6.7809319]


portfolio before change:  [4.59056665]
curr_Stock_Price:  100.54140694730516
curr_Factors:  [100.54140695  -1.34153968  -0.90904075]
mat_Sqrt:  [[10.59083733  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00229567 -0.02995301  0.24323371]
Stock Position:  0.0022956708298016546
Bond Position:  [4.35975667]


portfolio before change:  [4.59271026]
curr_Stock_Price:  101.2377656359559
curr_Factors:  [101.23776564  -1.25352703  -0.93652161]
mat_Sqrt:  [[11.32965045  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01118469  0.02036735  0.08699325]
Stock Position:  -0.011184693539088013
Bond Position:  [5.72502365]


portfolio before change:  [4.58123756]
curr_Stock_Price:  102.32750288321925
curr_Factors:  [102.32750288  -1.28774548  -0.95891956]
mat_Sqrt:  [[10.82126784  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00049107 0.00923068 0.04672583]
Stock Position:  0.0004910725699520394
Bond Position:  [4.53098733]


portfolio before change:  [4.58205647]
curr_Stock_Price:  102.84168507771852
curr_Factors:  [102.84168508  -1.27279192  -0.94612925]
mat_Sqrt:  [[11.18160036  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00618228 -0.01706524 -0.69795402]
Stock Position:  -0.00618227511791649
Bond Position:  [5.21785206]


portfolio before change:  [4.57946192]
curr_Stock_Price:  103.36686779457135
curr_Factors:  [103.36686779  -1.43748733  -0.93282359]
mat_Sqrt:  [[ 9.65980603  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00581596 0.00430456 0.03988044]
Stock Position:  0.0058159571356127685
Bond Position:  [3.97828464]


portfolio before change:  [4.57785929]
curr_Stock_Price:  103.00580141527982
curr_Factors:  [103.00580142  -1.19521869  -0.93608475]
mat_Sqrt:  [[12.22498579  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00083507 0.06766192 0.06288316]
Stock Position:  0.0008350728798287066
Bond Position:  [4.49184193]


portfolio before change:  [4.57815647]
curr_Stock_Price:  102.68926166542403
curr_Factors:  [102.68926167  -1.13314521  -0.95577284]
mat_Sqrt:  [[12.71509025  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-1.37671156e-04 -2.76450410e-02 -2.24406838e-01]
Stock Position:  -0.00013767115635761508
Bond Position:  [4.59229382]


portfolio before change:  [4.57874208]
curr_Stock_Price:  102.60547623673973
curr_Factors:  [102.60547624  -1.09489353  -0.97795357]
mat_Sqrt:  [[12.91054235  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00869534 -0.04467321 -0.20871108]
Stock Position:  0.008695339449415546
Bond Position:  [3.68655263]


portfolio before change:  [4.5842175]
curr_Stock_Price:  103.1821728212223
curr_Factors:  [103.18217282  -1.18339998  -0.98717327]
mat_Sqrt:  [[11.77434307  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00419534 -0.02623557 -0.00510567]
Stock Position:  -0.004195336870282965
Bond Position:  [5.01710147]


portfolio before change:  [4.58609634]
curr_Stock_Price:  102.88382491472218
curr_Factors:  [102.88382491  -1.05849116  -1.02159732]
mat_Sqrt:  [[12.85216084  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01014362  0.02918628  0.10099693]
Stock Position:  -0.010143620600355209
Bond Position:  [5.62971083]


portfolio before change:  [4.59266847]
curr_Stock_Price:  102.30529697157176
curr_Factors:  [102.30529697  -0.81509231  -1.00755578]
mat_Sqrt:  [[16.53225564  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00315374 -0.05218142 -0.39574898]
Stock Position:  0.003153740035560722
Bond Position:  [4.27002416]


portfolio before change:  [4.59513527]
curr_Stock_Price:  102.91822638971053
curr_Factors:  [102.91822639  -0.71181328  -1.03537233]
mat_Sqrt:  [[17.93491096  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00927336 -0.08154777  0.06212967]
Stock Position:  -0.009273358381475966
Bond Position:  [5.54953287]


portfolio before change:  [4.5964669]
curr_Stock_Price:  102.84943865624982
curr_Factors:  [102.84943866  -0.5976171   -1.02461596]
mat_Sqrt:  [[20.30836947  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00190998 -0.00731862  0.06918408]
Stock Position:  -0.0019099812113864897
Bond Position:  [4.7929074]


portfolio before change:  [4.59484922]
curr_Stock_Price:  104.0100985975462
curr_Factors:  [104.0100986   -0.46254281  -1.04828141]
mat_Sqrt:  [[22.95793852  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00171372  0.02446667 -0.07372202]
Stock Position:  -0.0017137237479149265
Bond Position:  [4.77309379]


portfolio before change:  [4.59484454]
curr_Stock_Price:  104.36099774313583
curr_Factors:  [104.36099774  -0.4408786   -1.06730172]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [4.59484454]
Stock Price:  106.40906736687553
PL:  [-1.81422282]
Settle:  Tensor("sub_316:0", shape=(), dtype=float64)
PL:  Tensor("sub_317:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  159
output_Z_Vals[:, i, :]:  [[ 1.19260232e+02 -2.92559343e+01 -2.92733494e+01]
 [ 1.24958666e-01 -6.79982200e-01 -4.51219321e-01]
 [-8.34225431e-02 -4.57863043e-02  9.62520956e-02]
 [-3.08237799e-01 -1.77394423e-01 -4.39249004e-02]
 [-1.29114805e-01  9.00372927e-02 -1.04368718e-01]
 [ 5.12575841e-02  2.90073365e-02  3.90158360e-02]
 [-5.65659215e-03  4.26928414e-02  4.33775506e-02]
 [-6.20343721e-02  3.26475619e-03 -6.89332950e-02]
 [ 1.20292290e-01 -1.91421792e-02 -8.29743382e-02]
 [-4.24913130e-02 -1.09823911e-01 -1.30798443e-01]
 [ 1.14932428e-01  1.03117829e-01  1.17222486e-03]
 [-1.90459416e-01 -9.44612494e-02  3.68181114e-02]
 [-3.19225213e-02 -4.15130197e-02  6.11156075e-02]
 [-9.62623594e-02 -1.14884369e-01  6.32126881e-02]
 [ 2.56783504e-01  2.99375355e-01  1.43763000e-02]
 [-5.79058677e-02 -4.17674996e-01 -5.43106026e-02]
 [-6.65565072e-02 -2.18847142e-02 -3.75774157e-02]
 [ 8.58529333e-03  1.02506942e-01 -5.36821100e-02]
 [-6.10108118e-02  4.55361253e-02 -1.28543090e-01]
 [-4.64007645e-02 -1.68181017e-02  1.17647990e-01]
 [ 4.10949679e-02 -7.78298195e-02  4.68272870e-02]
 [ 1.17916630e-01  8.74708977e-02  2.83532177e-01]
 [-4.48768996e-02 -1.29534838e-02  2.49654105e-01]
 [-6.40331310e-02 -2.06830624e-02 -8.36700909e-02]
 [-7.06534856e-01  1.84382989e-01  5.83699653e-02]
 [-1.51104262e-01 -2.75492574e-01  1.36754918e-01]
 [ 1.37130588e-02  7.18438587e-02  8.34130318e-03]
 [-1.13856391e-02 -1.07263374e-01 -7.97954632e-02]
 [-1.40763821e-01 -2.15848643e-01 -4.57536986e-02]
 [ 1.61561442e-01  2.25257144e-01  1.47450442e-01]
 [ 9.72599045e-02 -1.28289854e-01  8.84546437e-02]
 [ 1.06046335e-01  3.26465410e-02  1.30447567e-02]
 [ 4.58374185e-01 -4.68861162e-01 -4.36118916e-01]
 [-4.16287999e-02 -7.72784274e-02  1.55343611e-02]
 [-1.24662978e-01 -1.57459155e-01  1.17853203e-02]
 [ 2.48557668e-01  6.89855328e-02  2.97456211e-02]
 [ 1.61849424e-02 -4.80538385e-02 -9.49841860e-02]
 [-1.06008766e-02  4.60552058e-02 -3.61926443e-02]
 [ 2.34056697e-01 -3.24278652e-01 -6.32620061e-02]
 [-3.91260532e-01  2.25864804e-01  2.08756083e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.26023247 -29.25593426 -29.27334937]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  8.31486419  -9.25153874 -83.50871763]
init_Out:  [2.49911038]
Stock Position:  8.31486419409362
Bond position:  [-828.98730903]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-13.85267972]
curr_Stock_Price:  98.04588988755721
curr_Factors:  [98.04588989 -1.20199459 -0.98657831]
mat_Sqrt:  [[10.98864803  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00139206 -0.21502925 -1.28720313]
Stock Position:  0.0013920586979935417
Bond Position:  [-13.98916535]


portfolio before change:  [-13.85483801]
curr_Stock_Price:  97.75168938400007
curr_Factors:  [97.75168938 -0.95131759 -1.0021115 ]
mat_Sqrt:  [[13.85992245  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0046867  -0.0144789   0.27458044]
Stock Position:  -0.004686704693488669
Bond Position:  [-13.39670471]


portfolio before change:  [-13.85276687]
curr_Stock_Price:  96.95244276382655
curr_Factors:  [96.95244276 -0.40214264 -0.98395562]
mat_Sqrt:  [[24.24286437  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01327336 -0.05609704 -0.12530551]
Stock Position:  -0.013273358737764253
Bond Position:  [-12.56588232]


portfolio before change:  [-13.84077867]
curr_Stock_Price:  95.93092014213507
curr_Factors:  [95.93092014 -0.28289546 -0.97935589]
mat_Sqrt:  [[27.14999872  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00545467  0.02847229 -0.2977349 ]
Stock Position:  -0.0054546679541217
Bond Position:  [-13.31750736]


portfolio before change:  [-13.85080046]
curr_Stock_Price:  97.46300179719329
curr_Factors:  [97.4630018  -0.34668472 -0.98131794]
mat_Sqrt:  [[25.82828417  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.0023219  0.00917293 0.11130132]
Stock Position:  0.002321897347145953
Bond Position:  [-14.07709955]


portfolio before change:  [-13.8516195]
curr_Stock_Price:  97.868148455207
curr_Factors:  [97.86814846 -0.38582766 -1.00696295]
mat_Sqrt:  [[24.30860824  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.0001769  0.01350066 0.12374408]
Stock Position:  0.00017689773437323995
Bond Position:  [-13.86893215]


portfolio before change:  [-13.8533701]
curr_Stock_Price:  97.77276695353879
curr_Factors:  [97.77276695 -0.41381408 -1.04158656]
mat_Sqrt:  [[22.81105853  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00333264  0.00103241 -0.1966475 ]
Stock Position:  -0.003332639137077171
Bond Position:  [-13.52752875]


portfolio before change:  [-13.86031219]
curr_Stock_Price:  99.34841048993454
curr_Factors:  [99.34841049 -0.37731313 -1.0165942 ]
mat_Sqrt:  [[24.64873667  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00417307 -0.00605329 -0.23670269]
Stock Position:  0.00417307292168667
Bond Position:  [-14.27490036]


portfolio before change:  [-13.86629048]
curr_Stock_Price:  98.34344208835506
curr_Factors:  [98.34344209 -0.49230305 -1.00843669]
mat_Sqrt:  [[21.92716143  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00328479 -0.03472937 -0.37313155]
Stock Position:  -0.0032847878999713964
Bond Position:  [-13.54325313]


portfolio before change:  [-13.86508454]
curr_Stock_Price:  97.46090439559015
curr_Factors:  [97.4609044  -0.23716896 -0.98634574]
mat_Sqrt:  [[28.67244663  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00410967 0.03260872 0.00334403]
Stock Position:  0.004109666657015634
Bond Position:  [-14.26561637]


portfolio before change:  [-13.86808703]
curr_Stock_Price:  97.1642432237898
curr_Factors:  [97.16424322 -0.45081781 -1.00350284]
mat_Sqrt:  [[22.6935814   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00816896 -0.02987127  0.10503182]
Stock Position:  -0.008168958707159805
Bond Position:  [-13.07435634]


portfolio before change:  [-13.86387447]
curr_Stock_Price:  96.44848963091367
curr_Factors:  [96.44848963 -0.33729456 -1.01403704]
mat_Sqrt:  [[24.97005929  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00082175 -0.01312757  0.17434582]
Stock Position:  -0.0008217526224955272
Bond Position:  [-13.78461767]


portfolio before change:  [-13.86583346]
curr_Stock_Price:  96.73544756101928
curr_Factors:  [96.73544756 -0.62594406 -1.02425548]
mat_Sqrt:  [[18.5743272   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00464757 -0.03632963  0.1803282 ]
Stock Position:  -0.00464756673121388
Bond Position:  [-13.41624901]


portfolio before change:  [-13.87337093]
curr_Stock_Price:  97.99639399091089
curr_Factors:  [97.99639399 -0.69879187 -1.01223781]
mat_Sqrt:  [[17.70595468  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01510497 0.0946708  0.04101158]
Stock Position:  0.015104968782964367
Bond Position:  [-15.3536034]


portfolio before change:  [-13.87973084]
curr_Stock_Price:  97.70241194464217
curr_Factors:  [97.70241194 -0.65030237 -1.01263383]
mat_Sqrt:  [[18.52257098  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00430698 -0.13208043 -0.15493303]
Stock Position:  -0.004306977423600686
Bond Position:  [-13.45892876]


portfolio before change:  [-13.87780794]
curr_Stock_Price:  96.86531228955826
curr_Factors:  [96.86531229 -0.59300797 -0.99472205]
mat_Sqrt:  [[19.79820858  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00377772 -0.00692055 -0.10719791]
Stock Position:  -0.0037777168408308585
Bond Position:  [-13.51187822]


portfolio before change:  [-13.87754894]
curr_Stock_Price:  96.34963185707883
curr_Factors:  [96.34963186 -0.81198186 -0.96893176]
mat_Sqrt:  [[16.23338548  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 1.68908930e-05  3.24155413e-02 -1.53140118e-01]
Stock Position:  1.6890893026864892e-05
Bond Position:  [-13.87917637]


portfolio before change:  [-13.87929045]
curr_Stock_Price:  95.96409619652023
curr_Factors:  [95.9640962  -0.78069257 -0.97742069]
mat_Sqrt:  [[16.54130956  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00520357  0.01439979 -0.36669766]
Stock Position:  -0.005203567598475989
Bond Position:  [-13.37993479]


portfolio before change:  [-13.88106876]
curr_Stock_Price:  95.98441113279767
curr_Factors:  [95.98441113 -0.50697454 -1.00182362]
mat_Sqrt:  [[21.22941313  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00107493 -0.00531835  0.33561697]
Stock Position:  -0.0010749336534213233
Bond Position:  [-13.77789189]


portfolio before change:  [-13.8836732]
curr_Stock_Price:  96.80501532652335
curr_Factors:  [96.80501533 -0.57947554 -1.00817756]
mat_Sqrt:  [[19.78740651  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00245833 -0.02461195  0.13358522]
Stock Position:  0.002458330782998944
Bond Position:  [-14.12165195]


portfolio before change:  [-13.88704129]
curr_Stock_Price:  96.15303742939663
curr_Factors:  [96.15303743 -0.82457913 -1.0344696 ]
mat_Sqrt:  [[14.98264196  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01188381 0.02766073 0.80883838]
Stock Position:  0.011883810812950061
Bond Position:  [-15.0297058]


portfolio before change:  [-13.89894236]
curr_Stock_Price:  95.30968552379319
curr_Factors:  [95.30968552 -0.68450723 -1.0447306 ]
mat_Sqrt:  [[16.90980463  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 3.39984638e-04 -4.09625125e-03  7.12193673e-01]
Stock Position:  0.00033998463751705454
Bond Position:  [-13.93134619]


portfolio before change:  [-13.90078327]
curr_Stock_Price:  95.017373375652
curr_Factors:  [95.01737338 -1.00426073 -1.04669524]
mat_Sqrt:  [[12.22036446  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00668116 -0.00654056 -0.23868748]
Stock Position:  -0.006681163350131303
Bond Position:  [-13.26595667]


portfolio before change:  [-13.89781901]
curr_Stock_Price:  94.32548714715338
curr_Factors:  [94.32548715 -0.8189908  -1.078157  ]
mat_Sqrt:  [[14.14842957  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.04875873  0.05830702  0.16651326]
Stock Position:  -0.048758725086390696
Bond Position:  [-9.29862851]


portfolio before change:  [-13.90905037]
curr_Stock_Price:  94.53199296555334
curr_Factors:  [94.53199297 -0.96585412 -1.09463402]
mat_Sqrt:  [[12.04259794  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01082013 -0.0871184   0.39012372]
Stock Position:  -0.010820129484623619
Bond Position:  [-12.88620197]


portfolio before change:  [-13.89784451]
curr_Stock_Price:  93.34746560148203
curr_Factors:  [93.3474656  -0.97604922 -1.05645499]
mat_Sqrt:  [[12.22917525  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00141226 0.02271902 0.02379542]
Stock Position:  0.0014122555514972767
Bond Position:  [-14.02967498]


portfolio before change:  [-13.90123886]
curr_Stock_Price:  92.18582253778247
curr_Factors:  [92.18582254 -1.02821753 -1.05849702]
mat_Sqrt:  [[11.4397233   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0026612  -0.03391966 -0.22763425]
Stock Position:  -0.0026611962010903226
Bond Position:  [-13.6559143]


portfolio before change:  [-13.90440227]
curr_Stock_Price:  92.73305965623344
curr_Factors:  [92.73305966 -1.01483418 -1.06653056]
mat_Sqrt:  [[11.56936086  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01345592 -0.06825733 -0.13052257]
Stock Position:  -0.013455924280863662
Bond Position:  [-12.65659324]


portfolio before change:  [-13.9114078]
curr_Stock_Price:  93.13610617528
curr_Factors:  [93.13610618 -1.03065897 -1.07936578]
mat_Sqrt:  [[11.29135264  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01748911 0.07123256 0.42063507]
Stock Position:  0.01748911381956844
Bond Position:  [-15.54027576]


portfolio before change:  [-13.91528177]
curr_Stock_Price:  93.02567672971396
curr_Factors:  [93.02567673 -0.93448787 -1.10152821]
mat_Sqrt:  [[12.14429451  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0092227  -0.04056881  0.25233648]
Stock Position:  0.009222701504075205
Bond Position:  [-14.77322982]


portfolio before change:  [-13.91197597]
curr_Stock_Price:  93.58435970816592
curr_Factors:  [93.58435971 -0.94724234 -1.089732  ]
mat_Sqrt:  [[12.20552763  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00897561 0.01032374 0.03721306]
Stock Position:  0.008975606610517701
Bond Position:  [-14.75195237]


portfolio before change:  [-13.91388154]
curr_Stock_Price:  93.57751246053606
curr_Factors:  [93.57751246 -1.01682062 -1.10129865]
mat_Sqrt:  [[11.25340594  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.03174557 -0.14826692 -1.24412588]
Stock Position:  0.03174557485892532
Bond Position:  [-16.88455347]


portfolio before change:  [-13.94703646]
curr_Stock_Price:  92.59960564618261
curr_Factors:  [92.59960565 -1.13873288 -1.07123722]
mat_Sqrt:  [[10.15854052  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00398218 -0.02443758  0.04431521]
Stock Position:  -0.003982184458682091
Bond Position:  [-13.57828775]


portfolio before change:  [-13.9496913]
curr_Stock_Price:  92.84003973622143
curr_Factors:  [92.84003974 -0.88046869 -1.06659769]
mat_Sqrt:  [[13.24753683  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00953558 -0.04979296  0.03362024]
Stock Position:  -0.009535575513078652
Bond Position:  [-13.06440809]


portfolio before change:  [-13.9545965]
curr_Stock_Price:  93.18318083778311
curr_Factors:  [93.18318084 -0.8554968  -1.06950802]
mat_Sqrt:  [[13.5931016   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01886329 0.02181514 0.08485598]
Stock Position:  0.018863293592408372
Bond Position:  [-15.7123382]


portfolio before change:  [-13.96759568]
curr_Stock_Price:  92.5981813288532
curr_Factors:  [92.59818133 -0.91202589 -1.07422339]
mat_Sqrt:  [[12.70531254  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0003498  -0.01519596 -0.27096344]
Stock Position:  -0.00034980392434391113
Bond Position:  [-13.93520448]


portfolio before change:  [-13.96958078]
curr_Stock_Price:  93.29309478783705
curr_Factors:  [93.29309479 -1.30927921 -1.07975191]
mat_Sqrt:  [[ 8.5567032   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00196332  0.01456393 -0.10324754]
Stock Position:  -0.0019633179394571887
Bond Position:  [-13.78641677]


portfolio before change:  [-13.96994745]
curr_Stock_Price:  92.60205389236071
curr_Factors:  [92.60205389 -1.07965066 -1.06257427]
mat_Sqrt:  [[10.87086629  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01957255 -0.10254591 -0.18046889]
Stock Position:  0.019572548246775793
Bond Position:  [-15.78240562]


portfolio before change:  [-13.97655268]
curr_Stock_Price:  92.36538058628165
curr_Factors:  [92.36538059 -1.15635298 -1.0531672 ]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-13.97655268]
Stock Price:  92.8157629504075
PL:  [-13.97655268]
Settle:  Tensor("sub_318:0", shape=(), dtype=float64)
PL:  Tensor("sub_319:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  160
output_Z_Vals[:, i, :]:  [[ 1.19260232e+02 -2.92559343e+01 -2.92733494e+01]
 [ 1.84537088e-03 -9.01589723e-02 -3.22234088e-02]
 [-5.46171928e-02  5.78719993e-03  9.93238481e-02]
 [-9.44459344e-02  2.50901323e-02  8.67724116e-03]
 [-1.05222133e-01  8.91500735e-02 -6.96378543e-02]
 [ 3.03969524e-02  2.89373772e-02  6.87803074e-02]
 [-5.69505293e-05 -1.16669719e-02  1.42817240e-01]
 [-6.38866615e-03 -2.32093609e-02 -3.01296642e-02]
 [ 1.06811577e-01 -4.15962336e-02 -1.39356201e-01]
 [-9.39848708e-02 -1.38891999e-01 -1.18778024e-01]
 [ 1.82137939e-01  9.68127168e-02  1.94555182e-01]
 [-2.22567136e-01 -1.06095303e-01  5.62368299e-02]
 [-3.84061881e-02 -3.68413214e-02  5.35721475e-02]
 [-1.35334971e-01 -1.28570225e-01  3.32483503e-02]
 [-4.16445726e-02  2.18939759e-01  3.10514902e-01]
 [-2.28164922e-02 -6.15993117e-01  2.76140156e-03]
 [-6.78203859e-02 -4.79296187e-02 -8.01489107e-02]
 [ 1.09399317e-01  5.01974664e-02 -1.80864626e-01]
 [-9.21869209e-02  4.15870481e-02 -1.73411382e-01]
 [-5.66160922e-02 -2.27509565e-02  1.32314155e-01]
 [ 2.20542229e-01 -1.85113852e-01  1.19658423e-01]
 [ 1.13098788e-01  1.46930187e-01  3.15883331e-01]
 [-5.46967342e-02  1.91228734e-02  2.86943479e-01]
 [-7.00235621e-02 -5.31792065e-04 -8.15925719e-02]
 [-3.07946667e-01  1.11100716e-01  6.47477569e-02]
 [-9.01458755e-02 -2.06593504e-01  1.17167974e-01]
 [ 1.49576602e-01  5.87589413e-02 -1.03507145e-01]
 [ 1.47792103e-02  1.12220760e-02  9.34055719e-03]
 [-1.08689106e-01 -1.21317004e-01 -1.44775178e-01]
 [ 6.85272516e-02  6.95071336e-02 -8.39603300e-02]
 [ 8.07583636e-02 -5.50043797e-02  6.37840108e-02]
 [ 6.93042129e-02 -1.02424841e-01 -8.42866700e-02]
 [ 3.01550342e-01 -2.65561711e-01 -1.83218340e-01]
 [-4.53145481e-02 -8.08766778e-02  5.39487765e-03]
 [-1.94688886e-01  1.06273437e-01  1.92104473e-02]
 [ 1.14955854e-01 -8.56794188e-02 -4.93114459e-02]
 [-2.35970803e-02 -1.36042341e-01 -5.54717905e-02]
 [-2.39212740e-02  2.09384356e-02 -6.74724913e-02]
 [-4.72400915e-02  8.61575175e-02  4.06076191e-03]
 [-6.10080251e-01  3.08550449e-01  3.72967102e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.26023247 -29.25593426 -29.27334937]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  8.31486419  -9.25153874 -83.50871763]
init_Out:  [2.49911038]
Stock Position:  8.31486419409362
Bond position:  [-828.98730903]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [2.70278886]
curr_Stock_Price:  100.03695891676384
curr_Factors:  [100.03695892  -0.91328058  -0.97550124]
mat_Sqrt:  [[15.13118561  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00046659 -0.02851077 -0.09192442]
Stock Position:  -0.00046659262045087855
Bond Position:  [2.74946537]


portfolio before change:  [2.70358855]
curr_Stock_Price:  99.05970756463192
curr_Factors:  [99.05970756 -0.88143569 -0.96661813]
mat_Sqrt:  [[15.60621071  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00219101  0.00183007  0.28334329]
Stock Position:  -0.0021910105529159662
Bond Position:  [2.92062941]


portfolio before change:  [2.70725665]
curr_Stock_Price:  97.55218190150744
curr_Factors:  [97.5521819  -0.90857164 -0.93844233]
mat_Sqrt:  [[15.38469922  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00598171  0.0079342   0.02475375]
Stock Position:  -0.005981714315213923
Bond Position:  [3.29078594]


portfolio before change:  [2.7086522]
curr_Stock_Price:  97.3876510757838
curr_Factors:  [97.38765108 -0.75184736 -0.92328109]
mat_Sqrt:  [[18.23916061  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00642217  0.02819173 -0.19865741]
Stock Position:  -0.006422173590585625
Bond Position:  [3.3340926]


portfolio before change:  [2.71169105]
curr_Stock_Price:  96.97936965290205
curr_Factors:  [96.97936965 -0.55622206 -0.91419336]
mat_Sqrt:  [[22.28876761  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.0020272  0.0091508  0.19621107]
Stock Position:  0.002027201973522678
Bond Position:  [2.51509428]


portfolio before change:  [2.70914562]
curr_Stock_Price:  95.56864275974188
curr_Factors:  [95.56864276 -0.71182411 -0.93097379]
mat_Sqrt:  [[18.48661322  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00155757 -0.00368942  0.40741783]
Stock Position:  0.00155757337834179
Bond Position:  [2.56029045]


portfolio before change:  [2.71110344]
curr_Stock_Price:  96.62012362984406
curr_Factors:  [96.62012363 -0.91923678 -0.96669465]
mat_Sqrt:  [[14.65608498  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00089643 -0.00733944 -0.08595155]
Stock Position:  -0.0008964277454299433
Bond Position:  [2.7977164]


portfolio before change:  [2.71133279]
curr_Stock_Price:  96.75441238235562
curr_Factors:  [96.75441238 -0.81150229 -0.93532796]
mat_Sqrt:  [[16.86677454  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00458248 -0.01315388 -0.39754445]
Stock Position:  0.004582476724621351
Bond Position:  [2.26795795]


portfolio before change:  [2.713763]
curr_Stock_Price:  97.22286904850803
curr_Factors:  [97.22286905 -0.7498512  -0.93049024]
mat_Sqrt:  [[18.11362685  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00672513 -0.04392151 -0.33884064]
Stock Position:  -0.006725130780862424
Bond Position:  [3.36759951]


portfolio before change:  [2.72544392]
curr_Stock_Price:  95.54856052778656
curr_Factors:  [95.54856053 -0.61774642 -0.9406662 ]
mat_Sqrt:  [[20.11009621  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01115614 0.03061487 0.55501178]
Stock Position:  0.011156139703832576
Bond Position:  [1.65949083]


portfolio before change:  [2.73239478]
curr_Stock_Price:  96.15301837480892
curr_Factors:  [96.15301837 -0.63319005 -0.95195655]
mat_Sqrt:  [[19.70346027  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01085227 -0.03355028  0.16042802]
Stock Position:  -0.010852266907259427
Bond Position:  [3.775873]


portfolio before change:  [2.72952234]
curr_Stock_Price:  96.46119867147812
curr_Factors:  [96.46119867 -0.5515601  -0.94819247]
mat_Sqrt:  [[21.52872886  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00132019 -0.01165025  0.15282643]
Stock Position:  -0.001320192117656813
Bond Position:  [2.85686966]


portfolio before change:  [2.73220538]
curr_Stock_Price:  94.69940811455406
curr_Factors:  [94.69940811 -0.42137707 -0.91882605]
mat_Sqrt:  [[24.79159365  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00531905 -0.04065747  0.09484829]
Stock Position:  -0.005319054951403187
Bond Position:  [3.23591673]


portfolio before change:  [2.73095898]
curr_Stock_Price:  95.00978573240138
curr_Factors:  [95.00978573 -0.40903346 -0.91298232]
mat_Sqrt:  [[25.32935791  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00108143 0.06923483 0.88581258]
Stock Position:  0.001081433518020708
Bond Position:  [2.62821221]


portfolio before change:  [2.7318879]
curr_Stock_Price:  95.5649574699912
curr_Factors:  [95.56495747 -0.53068769 -0.89982703]
mat_Sqrt:  [[22.85777864  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00166935 -0.19479413  0.00787751]
Stock Position:  -0.0016693528261930895
Bond Position:  [2.89141954]


portfolio before change:  [2.73292555]
curr_Stock_Price:  95.15989531044976
curr_Factors:  [95.15989531 -0.54656473 -0.9011139 ]
mat_Sqrt:  [[22.37356125  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00381782 -0.01515668 -0.22864253]
Stock Position:  -0.0038178209665892583
Bond Position:  [3.09622899]


portfolio before change:  [2.73373955]
curr_Stock_Price:  95.04806351449359
curr_Factors:  [95.04806351 -0.6593918  -0.8955221 ]
mat_Sqrt:  [[20.07487036  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00367507  0.01587383 -0.51595644]
Stock Position:  0.003675070943673029
Bond Position:  [2.38443118]


portfolio before change:  [2.73614416]
curr_Stock_Price:  95.62126025607155
curr_Factors:  [95.62126026 -0.6390627  -0.90649814]
mat_Sqrt:  [[20.38571373  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00620585  0.01315098 -0.4946944 ]
Stock Position:  -0.006205845907891747
Bond Position:  [3.32955497]


portfolio before change:  [2.73888183]
curr_Stock_Price:  95.24718611630104
curr_Factors:  [95.24718612 -0.55762224 -0.90285689]
mat_Sqrt:  [[22.10925597  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00136572 -0.00719448  0.37745546]
Stock Position:  -0.001365717849431843
Bond Position:  [2.86896261]


portfolio before change:  [2.74117796]
curr_Stock_Price:  93.82852585033078
curr_Factors:  [93.82852585 -0.47833318 -0.92550921]
mat_Sqrt:  [[23.04909553  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0104207  -0.05853814  0.34135217]
Stock Position:  0.010420703161704242
Bond Position:  [1.76341875]


portfolio before change:  [2.75528094]
curr_Stock_Price:  95.16073298723909
curr_Factors:  [95.16073299 -0.4907665  -0.9317344 ]
mat_Sqrt:  [[22.94423008  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.0079049  0.0464634  0.90112722]
Stock Position:  0.007904903486121367
Bond Position:  [2.00304453]


portfolio before change:  [2.75794568]
curr_Stock_Price:  95.46615653904935
curr_Factors:  [95.46615654 -0.62315894 -0.92162168]
mat_Sqrt:  [[20.36853251  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [2.14502873e-04 6.04718353e-03 8.18569876e-01]
Stock Position:  0.0002145028725219398
Bond Position:  [2.73746791]


portfolio before change:  [2.75849288]
curr_Stock_Price:  96.42183607145171
curr_Factors:  [96.42183607 -0.60359101 -0.92660439]
mat_Sqrt:  [[20.87468726  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-4.15298710e-03 -1.68167417e-04 -2.32760897e-01]
Stock Position:  -0.004152987099695059
Bond Position:  [3.15893152]


portfolio before change:  [2.7513616]
curr_Stock_Price:  98.23406768849395
curr_Factors:  [98.23406769 -0.76308851 -0.91144119]
mat_Sqrt:  [[18.40869998  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01585454  0.03513313  0.18470733]
Stock Position:  -0.015854540424806895
Bond Position:  [4.30881759]


portfolio before change:  [2.77242951]
curr_Stock_Price:  96.93921617193418
curr_Factors:  [96.93921617 -1.12948658 -0.91350027]
mat_Sqrt:  [[12.56728858  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00569441 -0.0653306   0.33424762]
Stock Position:  -0.005694409258314394
Bond Position:  [3.32444108]


portfolio before change:  [2.77746283]
curr_Stock_Price:  96.12829092841851
curr_Factors:  [96.12829093 -1.02376522 -0.9109192 ]
mat_Sqrt:  [[13.8876401   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00935835  0.01858121 -0.29527707]
Stock Position:  0.009358353381337682
Bond Position:  [1.87786031]


portfolio before change:  [2.77379397]
curr_Stock_Price:  95.71116593005607
curr_Factors:  [95.71116593 -0.77911365 -0.91938626]
mat_Sqrt:  [[17.51110163  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00096942 0.00354873 0.02664601]
Stock Position:  0.0009694190966805273
Bond Position:  [2.68100974]


portfolio before change:  [2.77547934]
curr_Stock_Price:  97.10397896434134
curr_Factors:  [97.10397896 -1.09019197 -0.92476874]
mat_Sqrt:  [[12.94645026  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01091987 -0.03836381 -0.41300328]
Stock Position:  -0.010919874093650934
Bond Position:  [3.83584256]


portfolio before change:  [2.78141268]
curr_Stock_Price:  96.60453778907737
curr_Factors:  [96.60453779 -1.10023911 -0.94479054]
mat_Sqrt:  [[12.49834287  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00425525  0.02198009 -0.23951545]
Stock Position:  0.004255251123680086
Bond Position:  [2.37033612]


portfolio before change:  [2.77767581]
curr_Stock_Price:  95.65672352250728
curr_Factors:  [95.65672352 -1.03993037 -0.9423991 ]
mat_Sqrt:  [[13.17652076  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00700929 -0.01739391  0.18195803]
Stock Position:  0.007009286823788801
Bond Position:  [2.1071904]


portfolio before change:  [2.78727868]
curr_Stock_Price:  96.98916412070179
curr_Factors:  [96.98916412 -1.14493195 -0.92787346]
mat_Sqrt:  [[12.20436719  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00405221 -0.03238958 -0.24044641]
Stock Position:  0.004052210955175605
Bond Position:  [2.39425813]


portfolio before change:  [2.78644159]
curr_Stock_Price:  96.70872779225535
curr_Factors:  [96.70872779 -0.90693884 -0.90812559]
mat_Sqrt:  [[15.74683241  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01633943 -0.08397799 -0.52267092]
Stock Position:  0.016339430968793377
Bond Position:  [1.20627601]


portfolio before change:  [2.79182977]
curr_Stock_Price:  97.02926428071639
curr_Factors:  [97.02926428 -0.74233352 -0.88156348]
mat_Sqrt:  [[19.12728078  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00242071 -0.02557545  0.01539008]
Stock Position:  -0.00242070739909256
Bond Position:  [3.02670923]


portfolio before change:  [2.79143267]
curr_Stock_Price:  97.34961051122984
curr_Factors:  [97.34961051 -0.64393457 -0.87959229]
mat_Sqrt:  [[21.21655705  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00886212  0.03360661  0.05480206]
Stock Position:  -0.008862116571679339
Bond Position:  [3.65415627]


portfolio before change:  [2.79932257]
curr_Stock_Price:  96.51086090083136
curr_Factors:  [96.5108609  -0.61912317 -0.88204954]
mat_Sqrt:  [[21.5092449   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00477367 -0.02709421 -0.14067183]
Stock Position:  0.004773666599464638
Bond Position:  [2.33861189]


portfolio before change:  [2.80932741]
curr_Stock_Price:  98.5454601668723
curr_Factors:  [98.54546017 -0.75575596 -0.91558799]
mat_Sqrt:  [[18.52597893  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00207454 -0.04302037 -0.15824558]
Stock Position:  -0.0020745360005636005
Bond Position:  [3.01376351]


portfolio before change:  [2.80957352]
curr_Stock_Price:  98.60843176454449
curr_Factors:  [98.60843176 -0.8030567  -0.91650088]
mat_Sqrt:  [[17.66524565  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00210319  0.00662131 -0.19248024]
Stock Position:  -0.0021031924055870204
Bond Position:  [3.01696602]


portfolio before change:  [2.80725954]
curr_Stock_Price:  99.88796999216073
curr_Factors:  [99.88796999 -0.69495447 -0.91739367]
mat_Sqrt:  [[19.91953907  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00221825  0.0272454   0.01158422]
Stock Position:  -0.0022182548639654146
Bond Position:  [3.02883652]


portfolio before change:  [2.80722563]
curr_Stock_Price:  100.0739451650719
curr_Factors:  [100.07394517  -0.80819493  -0.93200413]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [2.80722563]
Stock Price:  98.90399367336335
PL:  [2.80722563]
Settle:  Tensor("sub_320:0", shape=(), dtype=float64)
PL:  Tensor("sub_321:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  161
output_Z_Vals[:, i, :]:  [[ 1.19260232e+02 -2.92559343e+01 -2.92733494e+01]
 [ 4.75658038e-02  1.28773394e-02 -8.99647343e-02]
 [-3.74901080e-02  5.15262446e-03  3.89144106e-02]
 [ 8.65691000e-02  1.84878549e-01  3.81511432e-02]
 [ 2.13666142e-01 -2.87652815e-02 -5.60570656e-02]
 [ 7.62858730e-02  3.02608661e-02 -4.26753757e-02]
 [ 4.58714242e-02  3.88643639e-02 -4.15112500e-02]
 [-6.11956693e-02  1.96633190e-01  4.06248852e-02]
 [-1.68970129e-01 -4.07236771e-02  1.52859843e-01]
 [-5.44173494e-02  1.81886978e-01  4.89338435e-02]
 [ 5.16100994e-02  1.28515531e-02 -5.67198269e-02]
 [-6.37700262e-02  9.39281176e-02  1.58081714e-02]
 [-1.05268475e-01  3.60169765e-02 -5.01576103e-02]
 [ 4.84208039e-02  9.09581430e-02  1.80143474e-01]
 [ 3.75978916e-01  5.20798967e-01  1.11232701e-01]
 [-7.24862074e-02 -5.92364211e-02 -1.01986323e-01]
 [-7.43030340e-02 -4.68011323e-02 -6.53911926e-02]
 [-7.31633180e-02  2.21455081e-01  1.38222367e-01]
 [ 1.47467686e-01  7.64675761e-02  1.86993532e-01]
 [ 1.33563485e-01 -4.58482920e-02  3.49944174e-02]
 [-2.05934784e-02 -2.29631915e-02 -1.87991942e-02]
 [ 9.76383448e-02 -6.36249686e-02  9.42669457e-02]
 [-1.38254969e-02 -1.13791263e-01  1.26574188e-01]
 [-4.33646043e-02 -2.03041370e-02 -8.48349027e-02]
 [-2.08691904e-01  1.01549133e-01  4.26814571e-02]
 [-1.02580107e-02 -1.16803495e-01  9.15560317e-02]
 [ 5.81545785e-02  5.01120046e-02 -6.26448470e-02]
 [ 3.31563746e-02 -1.06948198e-02  3.82357596e-03]
 [-8.56724652e-02 -8.17269777e-02 -1.91307483e-01]
 [ 2.89521247e-02  1.70450548e-02 -1.16955601e-01]
 [ 4.85506270e-02  1.24902867e-02  2.71470565e-02]
 [ 6.00244526e-02 -1.05488903e-01 -7.97687581e-02]
 [ 2.73975398e-01 -2.08478631e-01 -1.03169898e-01]
 [-4.22751256e-02 -7.79094096e-02  1.37563211e-02]
 [-1.99418703e-01  1.16663768e-01  1.86494122e-02]
 [ 1.47521445e-01 -1.03805552e-01 -6.73908959e-02]
 [ 2.21750050e-02  3.18365724e-02 -9.75653097e-02]
 [-2.95944602e-02  1.44576760e-02 -4.12420714e-02]
 [-3.53772217e-02  7.17194391e-02 -5.18628469e-04]
 [-5.92253673e-01  2.99750807e-01  3.62488732e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.26023247 -29.25593426 -29.27334937]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  8.31486419  -9.25153874 -83.50871763]
init_Out:  [2.49911038]
Stock Position:  8.31486419409362
Bond position:  [-828.98730903]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-0.33780398]
curr_Stock_Price:  99.67127731677256
curr_Factors:  [99.67127732 -1.20337282 -0.98331838]
mat_Sqrt:  [[11.19185576  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00263891  0.00407217 -0.25664435]
Stock Position:  0.0026389118494476753
Bond Position:  [-0.60082769]


portfolio before change:  [-0.33738653]
curr_Stock_Price:  99.85792986662766
curr_Factors:  [99.85792987 -1.31934759 -0.9961754 ]
mat_Sqrt:  [[ 9.85743002  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00298391  0.0016294   0.11101198]
Stock Position:  -0.0029839113215647272
Bond Position:  [-0.03941932]


portfolio before change:  [-0.33711349]
curr_Stock_Price:  99.7647740534341
curr_Factors:  [99.76477405 -1.19806534 -0.99559129]
mat_Sqrt:  [[11.12459611  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.0089109  0.05846373 0.10883459]
Stock Position:  0.008910904457947537
Bond Position:  [-1.22610786]


portfolio before change:  [-0.33190862]
curr_Stock_Price:  100.36607543087734
curr_Factors:  [100.36607543  -1.2015318   -0.99965236]
mat_Sqrt:  [[11.10771708  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01813882 -0.00909638 -0.1599152 ]
Stock Position:  0.018138815029705296
Bond Position:  [-2.1524303]


portfolio before change:  [-0.33708666]
curr_Stock_Price:  100.09544215186179
curr_Factors:  [100.09544215  -1.03668682  -0.98307641]
mat_Sqrt:  [[13.28135171  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00514678  0.00956933 -0.12174097]
Stock Position:  0.005146775129619332
Bond Position:  [-0.85225539]


portfolio before change:  [-0.33363131]
curr_Stock_Price:  100.78750417950255
curr_Factors:  [100.78750418  -1.14001755  -0.96997367]
mat_Sqrt:  [[12.21937932  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00314267  0.01228999 -0.11842004]
Stock Position:  0.0031426677475919224
Bond Position:  [-0.65037295]


portfolio before change:  [-0.33243327]
curr_Stock_Price:  101.19459221879073
curr_Factors:  [101.19459222  -1.25104246  -1.02030161]
mat_Sqrt:  [[10.4405916   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00458078  0.06218087  0.11589149]
Stock Position:  -0.004580784698654755
Bond Position:  [0.13111737]


portfolio before change:  [-0.3354803]
curr_Stock_Price:  101.8633470651629
curr_Factors:  [101.86334707  -1.46337377  -1.01335246]
mat_Sqrt:  [[ 8.55833749  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01622035 -0.01287796  0.43606658]
Stock Position:  -0.016220349541308843
Bond Position:  [1.3167788]


portfolio before change:  [-0.33623325]
curr_Stock_Price:  101.91991543040943
curr_Factors:  [101.91991543  -1.82489465  -1.01083096]
mat_Sqrt:  [[ 5.98024632  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00664395  0.05751771  0.13959463]
Stock Position:  -0.006643951889185584
Bond Position:  [0.34091776]


portfolio before change:  [-0.33535617]
curr_Stock_Price:  101.7943175468726
curr_Factors:  [101.79431755  -2.01378907  -1.00505062]
mat_Sqrt:  [[ 4.97345409  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0081159   0.00406402 -0.16180588]
Stock Position:  0.008115896548327148
Bond Position:  [-1.16150832]


portfolio before change:  [-0.33514071]
curr_Stock_Price:  101.83875570758319
curr_Factors:  [101.83875571  -2.10488669  -1.03573285]
mat_Sqrt:  [[ 4.40513628  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01319323  0.02970268  0.04509631]
Stock Position:  -0.013193231613138947
Bond Position:  [1.00844158]


portfolio before change:  [-0.33050569]
curr_Stock_Price:  101.49699302175424
curr_Factors:  [101.49699302  -1.83450564  -1.02932191]
mat_Sqrt:  [[ 5.79040143  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01978738  0.01138957 -0.1430857 ]
Stock Position:  -0.019787384606718528
Bond Position:  [1.67785435]


portfolio before change:  [-0.32696918]
curr_Stock_Price:  101.32886755050599
curr_Factors:  [101.32886755  -1.83165579  -1.02247409]
mat_Sqrt:  [[ 5.83714299  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01499723 0.02876349 0.51389919]
Stock Position:  0.014997228231960896
Bond Position:  [-1.84662134]


portfolio before change:  [-0.32765462]
curr_Stock_Price:  101.2985558542464
curr_Factors:  [101.29855585  -1.82788906  -1.01359302]
mat_Sqrt:  [[ 5.90967048  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.06973843 0.16469109 0.31731593]
Stock Position:  0.06973843451770942
Bond Position:  [-7.39205732]


portfolio before change:  [-0.35306945]
curr_Stock_Price:  100.947375558873
curr_Factors:  [100.94737556  -1.53168082  -1.01474501]
mat_Sqrt:  [[ 7.91036177  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01198852 -0.0187322  -0.29093859]
Stock Position:  -0.011988523282296269
Bond Position:  [0.85714052]


portfolio before change:  [-0.35258483]
curr_Stock_Price:  100.91588953834426
curr_Factors:  [100.91588954  -1.59871276  -1.02489802]
mat_Sqrt:  [[ 7.32048527  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01213845 -0.01479982 -0.18654287]
Stock Position:  -0.012138451500158489
Bond Position:  [0.87237781]


portfolio before change:  [-0.34713906]
curr_Stock_Price:  100.47623593782755
curr_Factors:  [100.47623594  -1.6641301   -1.01859431]
mat_Sqrt:  [[ 6.87022483  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00571027  0.07003025  0.39430994]
Stock Position:  -0.005710271631019384
Bond Position:  [0.22660754]


portfolio before change:  [-0.34680007]
curr_Stock_Price:  100.4218322033831
curr_Factors:  [100.4218322   -1.69499323  -1.02525376]
mat_Sqrt:  [[ 6.61362985  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.02836747 0.02418117 0.5334405 ]
Stock Position:  0.028367472898228073
Bond Position:  [-3.19551367]


portfolio before change:  [-0.3534631]
curr_Stock_Price:  100.20103113622525
curr_Factors:  [100.20103114  -1.5131465   -0.97815464]
mat_Sqrt:  [[ 8.29686174  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01681635 -0.0144985   0.09982933]
Stock Position:  0.016816345448464373
Bond Position:  [-2.03847826]


portfolio before change:  [-0.35312954]
curr_Stock_Price:  100.23602034682271
curr_Factors:  [100.23602035  -1.61806605  -0.95913785]
mat_Sqrt:  [[ 7.61655153  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00328544 -0.0072616  -0.05362887]
Stock Position:  -0.0032854441865063947
Bond Position:  [-0.02380969]


portfolio before change:  [-0.35380922]
curr_Stock_Price:  100.44199198890306
curr_Factors:  [100.44199199  -1.63053984  -0.98738581]
mat_Sqrt:  [[ 7.32764887  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01572642 -0.02011998  0.26891736]
Stock Position:  0.015726424245897246
Bond Position:  [-1.9334026]


portfolio before change:  [-0.35842366]
curr_Stock_Price:  100.16394117934976
curr_Factors:  [100.16394118  -1.48329034  -0.98810963]
mat_Sqrt:  [[ 8.46050009  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00107243 -0.03598396  0.36108093]
Stock Position:  0.0010724275318912042
Bond Position:  [-0.46584223]


portfolio before change:  [-0.3580615]
curr_Stock_Price:  100.55593726855025
curr_Factors:  [100.55593727  -1.47234158  -0.99734625]
mat_Sqrt:  [[ 8.50816536  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00719376 -0.00642073 -0.24201036]
Stock Position:  -0.007193760849117733
Bond Position:  [0.36531386]


portfolio before change:  [-0.35738676]
curr_Stock_Price:  100.46849010304427
curr_Factors:  [100.4684901   -1.54578233  -0.98465908]
mat_Sqrt:  [[ 7.99968958  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02467066  0.03211266  0.12175832]
Stock Position:  -0.02467065736221191
Bond Position:  [2.12123693]


portfolio before change:  [-0.34391453]
curr_Stock_Price:  99.9331553858622
curr_Factors:  [99.93315539 -1.60872832 -0.97559636]
mat_Sqrt:  [[ 7.53965806  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00071819 -0.03693651  0.26118387]
Stock Position:  0.0007181934111959892
Bond Position:  [-0.41568587]


portfolio before change:  [-0.3442253]
curr_Stock_Price:  99.57279648040681
curr_Factors:  [99.57279648 -1.4937608  -0.98785244]
mat_Sqrt:  [[ 8.32510596  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00560487  0.01584681 -0.17870831]
Stock Position:  0.005604870298490777
Bond Position:  [-0.90231791]


portfolio before change:  [-0.34645115]
curr_Stock_Price:  99.19579344479267
curr_Factors:  [99.19579344 -1.27763195 -1.01502809]
mat_Sqrt:  [[10.01852185  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00335985 -0.003382    0.0109076 ]
Stock Position:  0.003359848909489892
Bond Position:  [-0.67973403]


portfolio before change:  [-0.34905676]
curr_Stock_Price:  98.44557226158628
curr_Factors:  [98.44557226 -1.00283033 -0.9870986 ]
mat_Sqrt:  [[13.45801578  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00942436 -0.02584434 -0.545747  ]
Stock Position:  -0.00942435535672037
Bond Position:  [0.5787293]


portfolio before change:  [-0.34406209]
curr_Stock_Price:  97.92327467465645
curr_Factors:  [97.92327467 -0.96869239 -1.00431732]
mat_Sqrt:  [[13.61503297  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00040534  0.00539012 -0.33364177]
Stock Position:  0.00040534342605270924
Bond Position:  [-0.38375465]


portfolio before change:  [-0.34435757]
curr_Stock_Price:  97.31267329417894
curr_Factors:  [97.31267329 -0.86000938 -1.00131334]
mat_Sqrt:  [[15.1288952   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00359673 0.00394978 0.077443  ]
Stock Position:  0.0035967262502586634
Bond Position:  [-0.69436461]


portfolio before change:  [-0.34717445]
curr_Stock_Price:  96.55362782784195
curr_Factors:  [96.55362783 -0.67237056 -0.98266706]
mat_Sqrt:  [[18.44993703  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00222321 -0.03335852 -0.22755806]
Stock Position:  0.002223206032340385
Bond Position:  [-0.56183305]


portfolio before change:  [-0.3469933]
curr_Stock_Price:  96.66670061344156
curr_Factors:  [96.66670061 -0.70608503 -1.00471257]
mat_Sqrt:  [[17.46976001  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01416923 -0.06592673 -0.294315  ]
Stock Position:  0.01416922928719218
Bond Position:  [-1.71668594]


portfolio before change:  [-0.35983913]
curr_Stock_Price:  95.77524550824788
curr_Factors:  [95.77524551 -0.48415644 -1.03943155]
mat_Sqrt:  [[20.87216101  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00198728 -0.02463712  0.03924295]
Stock Position:  -0.001987275805828092
Bond Position:  [-0.1695073]


portfolio before change:  [-0.36240498]
curr_Stock_Price:  97.05572453890491
curr_Factors:  [97.05572454 -0.43775037 -1.03972082]
mat_Sqrt:  [[22.14948203  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00869545  0.03689232  0.05320158]
Stock Position:  -0.008695447676107988
Bond Position:  [0.48153799]


portfolio before change:  [-0.36389236]
curr_Stock_Price:  97.23369954409434
curr_Factors:  [97.23369954 -0.55330197 -1.03542117]
mat_Sqrt:  [[19.85377597  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00660253 -0.0328262  -0.19224747]
Stock Position:  0.006602526808167542
Bond Position:  [-1.00588047]


portfolio before change:  [-0.3655416]
curr_Stock_Price:  97.002954186672
curr_Factors:  [97.00295419 -0.36125167 -1.04775156]
mat_Sqrt:  [[23.70623753  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 1.29990528e-04  1.00676082e-02 -2.78326672e-01]
Stock Position:  0.00012999052824159586
Bond Position:  [-0.37815107]


portfolio before change:  [-0.36524701]
curr_Stock_Price:  99.6328534341122
curr_Factors:  [99.63285343 -0.48138174 -1.0597036 ]
mat_Sqrt:  [[21.3362313   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00176412  0.00457192 -0.11765215]
Stock Position:  -0.0017641197598005517
Bond Position:  [-0.18948273]


portfolio before change:  [-0.36536969]
curr_Stock_Price:  99.6889659220984
curr_Factors:  [99.68896592 -0.45593557 -1.04470605]
mat_Sqrt:  [[22.22934754  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00151292  0.02267968 -0.0014795 ]
Stock Position:  -0.0015129233204522108
Bond Position:  [-0.21454793]


portfolio before change:  [-0.36611192]
curr_Stock_Price:  100.1618298042347
curr_Factors:  [100.1618298   -0.65329106  -1.01372295]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-0.36611192]
Stock Price:  100.37747743323597
PL:  [-0.74358935]
Settle:  Tensor("sub_322:0", shape=(), dtype=float64)
PL:  Tensor("sub_323:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  162
output_Z_Vals[:, i, :]:  [[ 1.19260232e+02 -2.92559343e+01 -2.92733494e+01]
 [ 5.28082468e-02 -3.40556275e-02 -1.14435422e-01]
 [-2.72551067e-02  5.62236062e-02  1.13348013e-01]
 [ 8.68366457e-02  1.87311350e-01  3.81836452e-02]
 [ 1.56705726e-02  3.77835360e-02 -7.16733288e-02]
 [ 6.50285370e-02  2.91088341e-02 -2.39741456e-02]
 [ 7.38494445e-02  1.25281570e-02 -7.16870560e-02]
 [-1.05696606e-01 -5.08941566e-02 -1.16278308e-01]
 [-5.46885476e-02 -6.72711650e-02  4.26334853e-02]
 [-5.81328327e-02 -1.18470691e-01 -1.29111522e-01]
 [ 8.71503439e-02  9.82520183e-02 -7.19310240e-02]
 [-1.92439824e-01 -9.80475940e-02  3.95635011e-02]
 [-1.08569406e-01  3.78190328e-02 -2.03232736e-02]
 [-9.62623594e-02 -1.14884369e-01  6.32126881e-02]
 [ 2.24689639e-01  2.49911679e-01 -1.72491034e-04]
 [-9.10066946e-02 -1.97278459e-01 -1.04645293e-01]
 [-6.73895124e-02 -6.21235956e-02 -4.50137921e-02]
 [-7.66241132e-02  1.46143246e-01  1.15209552e-01]
 [ 9.77402036e-02  6.10945136e-02  9.78681985e-02]
 [ 1.79803814e-04 -1.58835539e-02  8.42842970e-02]
 [ 1.27512067e-02 -5.40226194e-02  1.98384841e-02]
 [ 1.18152183e-01 -6.37735210e-02  1.48982071e-01]
 [-4.33483767e-02 -1.78857338e-02  2.43319728e-01]
 [-6.53485733e-02 -6.43039205e-04 -8.29547361e-02]
 [-3.57670232e-01  1.23138890e-01  5.68451156e-02]
 [-4.66838290e-02 -1.57900806e-01  1.03251897e-01]
 [ 2.33942198e-01  4.11214380e-02 -1.30217265e-01]
 [-4.48776290e-02  6.89974141e-02  2.76272920e-02]
 [-9.15654551e-02 -8.81369008e-02 -1.82629289e-01]
 [ 9.26471059e-03 -1.05691987e-02 -1.20798087e-01]
 [ 4.38317750e-02  8.96037590e-02  2.40631718e-02]
 [ 1.49188035e-02 -6.49456619e-02 -8.63903707e-02]
 [ 1.79795941e-01 -1.32846988e-01 -3.10282767e-02]
 [-4.79436940e-02 -8.34434092e-02 -1.83789608e-03]
 [-1.83405070e-01  1.38380132e-01  2.57468677e-02]
 [ 1.10547136e-01 -1.52264158e-01 -1.24100516e-01]
 [-7.01614311e-03 -9.41406629e-02 -7.98418977e-02]
 [-2.47000338e-02  2.22506769e-02 -6.41562947e-02]
 [-4.80353453e-02  9.01692139e-02  5.62014007e-03]
 [-3.56645387e-01  1.89785200e-01  2.15096023e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.26023247 -29.25593426 -29.27334937]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  8.31486419  -9.25153874 -83.50871763]
init_Out:  [2.49911038]
Stock Position:  8.31486419409362
Bond position:  [-828.98730903]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-3.80707416]
curr_Stock_Price:  99.25404017326626
curr_Factors:  [99.25404017 -1.01935452 -1.00741471]
mat_Sqrt:  [[13.07776411  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00218462 -0.01076934 -0.32645241]
Stock Position:  0.0021846166757282463
Bond Position:  [-4.02390619]


portfolio before change:  [-3.80687203]
curr_Stock_Price:  99.57682009839097
curr_Factors:  [99.5768201  -1.021815   -1.01799101]
mat_Sqrt:  [[12.95035759  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-2.05890319e-04  1.77794654e-02  3.23350330e-01]
Stock Position:  -0.00020589031948525482
Bond Position:  [-3.78637013]


portfolio before change:  [-3.80736232]
curr_Stock_Price:  99.65922514458671
curr_Factors:  [99.65922514 -1.23283301 -1.02160435]
mat_Sqrt:  [[10.45749831  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00951157 0.05923305 0.10892731]
Stock Position:  0.009511568154889563
Bond Position:  [-4.75527784]


portfolio before change:  [-3.81799776]
curr_Stock_Price:  98.60356420330196
curr_Factors:  [98.6035642  -1.13740032 -1.00199846]
mat_Sqrt:  [[11.60816386  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 1.73660745e-04  1.19482032e-02 -2.04464057e-01]
Stock Position:  0.00017366074471553256
Bond Position:  [-3.83512133]


portfolio before change:  [-3.81844914]
curr_Stock_Price:  98.76502702307789
curr_Factors:  [98.76502702 -1.00589095 -1.03658873]
mat_Sqrt:  [[12.81048383  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00475286  0.00920502 -0.06839156]
Stock Position:  0.004752858887408715
Bond Position:  [-4.28786538]


portfolio before change:  [-3.81637034]
curr_Stock_Price:  99.31518365418343
curr_Factors:  [99.31518365 -1.02790783 -1.05188024]
mat_Sqrt:  [[12.41009678  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0047977   0.00396175 -0.20450322]
Stock Position:  0.004797695148215025
Bond Position:  [-4.29285432]


portfolio before change:  [-3.81779738]
curr_Stock_Price:  99.12959570867422
curr_Factors:  [99.12959571 -1.26068082 -1.02765821]
mat_Sqrt:  [[10.05519086  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01300283 -0.01609415 -0.33170965]
Stock Position:  -0.01300282606010961
Bond Position:  [-2.52883249]


portfolio before change:  [-3.81061301]
curr_Stock_Price:  98.55276025624991
curr_Factors:  [98.55276026 -1.20141097 -0.99668162]
mat_Sqrt:  [[10.94080585  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00436192 -0.02127301  0.12162147]
Stock Position:  -0.004361923472998888
Bond Position:  [-3.38073341]


portfolio before change:  [-3.81164981]
curr_Stock_Price:  98.69356472630956
curr_Factors:  [98.69356473 -1.19074913 -0.97621737]
mat_Sqrt:  [[11.30283122  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00774554 -0.03746372 -0.36831924]
Stock Position:  -0.007745538283450183
Bond Position:  [-3.04721502]


portfolio before change:  [-3.80307448]
curr_Stock_Price:  97.53725334503868
curr_Factors:  [97.53725335 -1.01698915 -0.99738839]
mat_Sqrt:  [[13.01180284  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00576433  0.03107002 -0.20519919]
Stock Position:  0.005764331218668203
Bond Position:  [-4.36531151]


portfolio before change:  [-3.80206466]
curr_Stock_Price:  97.80710516787819
curr_Factors:  [97.80710517 -0.80964206 -0.98984599]
mat_Sqrt:  [[16.17568481  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0115541  -0.03100537  0.11286366]
Stock Position:  -0.011554103492722135
Bond Position:  [-2.67199125]


portfolio before change:  [-3.80408206]
curr_Stock_Price:  97.95280039745043
curr_Factors:  [97.9528004  -0.94359799 -0.9707505 ]
mat_Sqrt:  [[14.44195107  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00773728  0.01195943 -0.05797664]
Stock Position:  -0.007737278201586966
Bond Position:  [-3.04619399]


portfolio before change:  [-3.80652837]
curr_Stock_Price:  98.21975684755753
curr_Factors:  [98.21975685 -0.84433368 -0.98094833]
mat_Sqrt:  [[15.83029281  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00545318 -0.03632963  0.1803282 ]
Stock Position:  -0.005453179305064264
Bond Position:  [-3.27091843]


portfolio before change:  [-3.80437638]
curr_Stock_Price:  97.75014367793167
curr_Factors:  [97.75014368 -0.53918579 -0.97004711]
mat_Sqrt:  [[21.61055313  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01069418  0.07902901 -0.00049207]
Stock Position:  0.010694178891763264
Bond Position:  [-4.8497339]


portfolio before change:  [-3.78666476]
curr_Stock_Price:  99.46302633297014
curr_Factors:  [99.46302633 -0.50510641 -0.99718671]
mat_Sqrt:  [[22.14236766  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00530481 -0.06238493 -0.29852389]
Stock Position:  -0.005304809099731759
Bond Position:  [-3.25903239]


portfolio before change:  [-3.78385939]
curr_Stock_Price:  98.85739145112869
curr_Factors:  [98.85739145 -0.70010065 -0.99780121]
mat_Sqrt:  [[18.09754805  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00432003 -0.01964521 -0.12841182]
Stock Position:  -0.004320029341503741
Bond Position:  [-3.35679256]


portfolio before change:  [-3.78490699]
curr_Stock_Price:  99.00275462857248
curr_Factors:  [99.00275463 -0.81559483 -0.99259001]
mat_Sqrt:  [[16.23164661  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00303935  0.04621455  0.32866078]
Stock Position:  -0.0030393502629929656
Bond Position:  [-3.48400294]


portfolio before change:  [-3.78415041]
curr_Stock_Price:  98.61053209148815
curr_Factors:  [98.61053209 -0.8848267  -0.97698181]
mat_Sqrt:  [[15.32322352  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00778524 0.01931978 0.27919073]
Stock Position:  0.007785236530430484
Bond Position:  [-4.55185673]


portfolio before change:  [-3.7849568]
curr_Stock_Price:  98.58004196339247
curr_Factors:  [98.58004196 -0.85253448 -1.00148041]
mat_Sqrt:  [[15.43833858  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00109948 -0.00502282  0.24043964]
Stock Position:  0.001099480504616508
Bond Position:  [-3.89334364]


portfolio before change:  [-3.78578638]
curr_Stock_Price:  98.26818439033492
curr_Factors:  [98.26818439 -1.02332217 -0.9714528 ]
mat_Sqrt:  [[13.36882287  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00115237 -0.01708345  0.05659367]
Stock Position:  0.001152372386499618
Bond Position:  [-3.89902792]


portfolio before change:  [-3.78549953]
curr_Stock_Price:  98.9400699667365
curr_Factors:  [98.94006997 -1.1189882  -0.96860437]
mat_Sqrt:  [[12.26711057  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01197645 -0.02016696  0.42500438]
Stock Position:  0.01197644669676214
Bond Position:  [-4.97045]


portfolio before change:  [-3.77665736]
curr_Stock_Price:  99.73024685051807
curr_Factors:  [99.73024685 -0.92172005 -0.95835759]
mat_Sqrt:  [[15.21666747  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 3.84923122e-04 -5.65596565e-03  6.94123457e-01]
Stock Position:  0.00038492312237230637
Bond Position:  [-3.81504584]


portfolio before change:  [-3.77720803]
curr_Stock_Price:  99.53861738366145
curr_Factors:  [99.53861738 -1.11608664 -0.9379043 ]
mat_Sqrt:  [[12.76305594  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-6.44816112e-03 -2.03346851e-04 -2.36646772e-01]
Stock Position:  -0.006448161123383396
Bond Position:  [-3.13536699]


portfolio before change:  [-3.76812532]
curr_Stock_Price:  98.06925889681686
curr_Factors:  [98.0692589  -0.95216113 -0.95363862]
mat_Sqrt:  [[14.58325857  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0235124   0.03893994  0.16216329]
Stock Position:  -0.023512395180285216
Bond Position:  [-1.46228215]


portfolio before change:  [-3.77406225]
curr_Stock_Price:  98.31398656507213
curr_Factors:  [98.31398657 -0.94084632 -0.95574334]
mat_Sqrt:  [[14.75492083  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00201184 -0.04993262  0.29454892]
Stock Position:  -0.002011844416516427
Bond Position:  [-3.57626981]


portfolio before change:  [-3.77468858]
curr_Stock_Price:  98.4030905690514
curr_Factors:  [98.40309057 -0.92855945 -0.93380292]
mat_Sqrt:  [[15.28252237  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01363803  0.01300374 -0.37147361]
Stock Position:  0.0136380275256897
Bond Position:  [-5.11671263]


portfolio before change:  [-3.77793559]
curr_Stock_Price:  98.21190537088759
curr_Factors:  [98.21190537 -0.79818123 -0.94630876]
mat_Sqrt:  [[17.16096723  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00218267  0.0218189   0.07881297]
Stock Position:  -0.002182669868198212
Bond Position:  [-3.56357143]


portfolio before change:  [-3.77842201]
curr_Stock_Price:  98.23066339790357
curr_Factors:  [98.2306634  -0.85705026 -0.93235007]
mat_Sqrt:  [[16.41044616  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00799004 -0.02787134 -0.52099053]
Stock Position:  -0.007990044043800203
Bond Position:  [-2.99355468]


portfolio before change:  [-3.78429852]
curr_Stock_Price:  98.91930676721941
curr_Factors:  [98.91930677 -0.8604304  -0.9348677 ]
mat_Sqrt:  [[16.42831439  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0009536  -0.00334227 -0.34460332]
Stock Position:  -0.0009535969927417029
Bond Position:  [-3.68996937]


portfolio before change:  [-3.78546416]
curr_Stock_Price:  99.65794527347788
curr_Factors:  [99.65794527 -0.92179192 -0.91942274]
mat_Sqrt:  [[15.80820521  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00322979 0.0283352  0.06864553]
Stock Position:  0.003229791601824023
Bond Position:  [-4.10733855]


portfolio before change:  [-3.78548395]
curr_Stock_Price:  99.8107906458218
curr_Factors:  [99.81079065 -0.85436638 -0.88668579]
mat_Sqrt:  [[17.50040692  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00025099 -0.02053762 -0.24644768]
Stock Position:  -0.00025099112705744014
Bond Position:  [-3.76043233]


portfolio before change:  [-3.78583028]
curr_Stock_Price:  99.31775684075572
curr_Factors:  [99.31775684 -0.81675611 -0.89090051]
mat_Sqrt:  [[18.00532877  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00944344 -0.04200991 -0.08851504]
Stock Position:  0.009443439124620201
Bond Position:  [-4.72373148]


portfolio before change:  [-3.78450661]
curr_Stock_Price:  99.52045615356738
curr_Factors:  [99.52045615 -0.8042972  -0.92121146]
mat_Sqrt:  [[17.72284629  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00284793 -0.02638712 -0.00524301]
Stock Position:  -0.0028479258757994784
Bond Position:  [-3.50107973]


portfolio before change:  [-3.78556418]
curr_Stock_Price:  99.73812521310371
curr_Factors:  [99.73812521 -0.81284063 -0.90000837]
mat_Sqrt:  [[17.98789439  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00970522  0.04375964  0.07344865]
Stock Position:  -0.00970522449822322
Bond Position:  [-2.81758328]


portfolio before change:  [-3.78269378]
curr_Stock_Price:  99.40607555969397
curr_Factors:  [99.40607556 -0.60660959 -0.90103027]
mat_Sqrt:  [[22.01168333  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00369276 -0.04815015 -0.35402423]
Stock Position:  0.0036927562265785968
Bond Position:  [-4.14977618]


portfolio before change:  [-3.79040445]
curr_Stock_Price:  97.45850046134903
curr_Factors:  [97.45850046 -0.67748833 -0.90549656]
mat_Sqrt:  [[20.01419463  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00128631 -0.02976989 -0.22776671]
Stock Position:  -0.0012863122488739962
Bond Position:  [-3.66504239]


portfolio before change:  [-3.79218503]
curr_Stock_Price:  98.48656534468215
curr_Factors:  [98.48656534 -0.63973115 -0.90066277]
mat_Sqrt:  [[21.1053428   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0017636   0.00703628 -0.18302005]
Stock Position:  -0.0017635995299988933
Bond Position:  [-3.61849417]


portfolio before change:  [-3.79514622]
curr_Stock_Price:  99.90913946374468
curr_Factors:  [99.90913946 -0.77056072 -0.89771715]
mat_Sqrt:  [[18.84001933  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00236518  0.02851401  0.0160327 ]
Stock Position:  -0.0023651769742776365
Bond Position:  [-3.55884342]


portfolio before change:  [-3.79976411]
curr_Stock_Price:  101.67349342306908
curr_Factors:  [101.67349342  -0.83683274  -0.88955997]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-3.79976411]
Stock Price:  100.84341666165236
PL:  [-4.64318077]
Settle:  Tensor("sub_324:0", shape=(), dtype=float64)
PL:  Tensor("sub_325:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  163
output_Z_Vals[:, i, :]:  [[ 1.19260232e+02 -2.92559343e+01 -2.92733494e+01]
 [-4.93312191e-03 -6.05224316e-02 -2.46354784e-02]
 [-2.99882377e-02  5.19036143e-02  1.13618288e-01]
 [ 3.52807483e-02  1.53716915e-01  2.86552404e-02]
 [ 3.02551182e-02  3.29742744e-02 -7.09671756e-02]
 [ 6.72825172e-02  2.92460463e-02 -5.49433323e-02]
 [ 7.83517387e-02  8.75007879e-03 -7.95349017e-02]
 [-1.08979377e-01 -6.28081027e-02 -1.20623321e-01]
 [ 8.81775557e-02 -3.19453680e-02 -4.24259668e-02]
 [-6.56836479e-02 -1.22644853e-01 -1.28297175e-01]
 [ 9.45009936e-02  9.05711546e-02 -5.03549321e-02]
 [-6.80847520e-02 -6.76838466e-02  5.71353742e-05]
 [-1.13160281e-01  4.58979048e-02 -2.34058046e-02]
 [-9.62623594e-02 -1.14884369e-01  6.32126881e-02]
 [ 3.27383536e-01  3.87071346e-01  2.23586350e-02]
 [-3.92137259e-02 -4.47567096e-01 -3.96374236e-02]
 [-6.67014731e-02 -3.86822782e-02 -3.39062915e-02]
 [-7.48809218e-02  1.91078847e-01  1.29483128e-01]
 [ 1.11231467e-01  6.49706507e-02  1.19483056e-01]
 [-2.44097952e-02 -1.25098882e-02  9.69351088e-02]
 [ 2.47938322e-02 -6.18756776e-02  2.62004340e-02]
 [ 1.23054036e-01  1.60283397e-02  2.44925497e-01]
 [-2.85976010e-02 -6.81426015e-02  2.05428310e-01]
 [-6.84552414e-02 -5.69112197e-04 -8.20495378e-02]
 [-3.42302768e-01  1.18337108e-01  6.34277367e-02]
 [-5.87122586e-02 -1.71629428e-01  1.07131994e-01]
 [ 2.03295770e-01  5.63576898e-02 -1.39843823e-01]
 [-2.92908958e-03  3.00626124e-02  1.55140460e-02]
 [-9.53009360e-02 -9.75687228e-02 -1.72466787e-01]
 [ 7.89729487e-02  8.88652041e-02 -6.37194852e-02]
 [ 5.00607033e-02  4.56172891e-03  3.07639158e-02]
 [ 5.11373353e-02 -9.47761562e-02 -8.22107100e-02]
 [ 3.47745328e-01 -3.54108932e-01 -3.05700590e-01]
 [-4.57410449e-02 -8.12930499e-02  4.22158584e-03]
 [-1.64471999e-01  2.21508386e-02  2.11736524e-02]
 [ 7.00728465e-02 -9.46005701e-02 -5.91150744e-02]
 [ 1.51714942e-02 -1.30613782e-02 -8.95738812e-02]
 [-1.48751578e-02  2.79358013e-02 -6.48431338e-02]
 [ 8.92701777e-02 -1.57990691e-01 -1.86316827e-02]
 [-7.74238768e-01  3.91238185e-01  4.67133180e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.26023247 -29.25593426 -29.27334937]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  8.31486419  -9.25153874 -83.50871763]
init_Out:  [2.49911038]
Stock Position:  8.31486419409362
Bond position:  [-828.98730903]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [3.95366043]
curr_Stock_Price:  100.18739691985965
curr_Factors:  [100.18739692  -1.11985678  -1.00743511]
mat_Sqrt:  [[11.93828552  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00096534 -0.01913887 -0.07027816]
Stock Position:  -0.0009653396482029705
Bond Position:  [4.0503753]


portfolio before change:  [3.95478798]
curr_Stock_Price:  99.54387337749101
curr_Factors:  [99.54387338 -1.03386484 -0.99973025]
mat_Sqrt:  [[13.02673     0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00041882  0.01641336  0.32412135]
Stock Position:  -0.00041882009111949615
Bond Position:  [3.99647895]


portfolio before change:  [3.95533568]
curr_Stock_Price:  99.42900858562868
curr_Factors:  [99.42900859 -0.99695852 -0.97440997]
mat_Sqrt:  [[13.84709443  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00325692 0.04860956 0.08174542]
Stock Position:  0.0032569235855185053
Bond Position:  [3.63150299]


portfolio before change:  [3.95373284]
curr_Stock_Price:  98.79749329966243
curr_Factors:  [98.7974933  -0.98601681 -0.97258089]
mat_Sqrt:  [[13.93598764  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00119262  0.01042738 -0.2024496 ]
Stock Position:  0.0011926242072710974
Bond Position:  [3.83590456]


portfolio before change:  [3.95458221]
curr_Stock_Price:  99.10760244421583
curr_Factors:  [99.10760244 -0.93257313 -1.01924708]
mat_Sqrt:  [[14.07479976  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00403717  0.00924841 -0.15673803]
Stock Position:  0.0040371718986815
Bond Position:  [3.55446778]


portfolio before change:  [3.95383787]
curr_Stock_Price:  98.81317005737384
curr_Factors:  [98.81317006 -0.95476552 -1.02625328]
mat_Sqrt:  [[13.62916655  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00457421  0.00276702 -0.22689094]
Stock Position:  0.0045742100752819495
Bond Position:  [3.50184567]


portfolio before change:  [3.95751903]
curr_Stock_Price:  99.52223222825695
curr_Factors:  [99.52223223 -0.84009925 -1.0078658 ]
mat_Sqrt:  [[15.68047038  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00862367 -0.01986167 -0.34410476]
Stock Position:  -0.00862367032234968
Bond Position:  [4.81576595]


portfolio before change:  [3.95844385]
curr_Stock_Price:  99.48479850725482
curr_Factors:  [99.48479851 -0.53861687 -1.01365662]
mat_Sqrt:  [[21.06749583  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00373526 -0.01010201 -0.12102947]
Stock Position:  0.0037352595820095806
Bond Position:  [3.5868423]


portfolio before change:  [3.95293929]
curr_Stock_Price:  97.89108322169976
curr_Factors:  [97.89108322 -0.55223572 -1.01388966]
mat_Sqrt:  [[20.44483097  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00464855 -0.03878371 -0.36599613]
Stock Position:  -0.0046485527694791725
Bond Position:  [4.40799116]


portfolio before change:  [3.95446859]
curr_Stock_Price:  97.6806389625974
curr_Factors:  [97.68063896 -0.64134299 -1.01819848]
mat_Sqrt:  [[18.58141527  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00465847  0.02864111 -0.14364861]
Stock Position:  0.004658465032170569
Bond Position:  [3.49942675]


portfolio before change:  [3.96241459]
curr_Stock_Price:  99.29244514385628
curr_Factors:  [99.29244514 -0.76897699 -1.03488441]
mat_Sqrt:  [[16.34967614  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00427046 -0.02140351  0.00016299]
Stock Position:  -0.004270462489307434
Bond Position:  [4.38643925]


portfolio before change:  [3.96817319]
curr_Stock_Price:  98.07237374429013
curr_Factors:  [98.07237374 -0.93041825 -1.02960817]
mat_Sqrt:  [[13.81395465  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00845181  0.01451419 -0.06677025]
Stock Position:  -0.008451807970880538
Bond Position:  [4.79706206]


portfolio before change:  [3.96432522]
curr_Stock_Price:  98.59860960750596
curr_Factors:  [98.59860961 -0.95023174 -1.01034741]
mat_Sqrt:  [[13.88040325  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00621923 -0.03632963  0.1803282 ]
Stock Position:  -0.006219230346416625
Bond Position:  [4.57753269]


portfolio before change:  [3.96771565]
curr_Stock_Price:  98.14546558087454
curr_Factors:  [98.14546558 -1.00034846 -1.01724029]
mat_Sqrt:  [[13.05096351  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.02620049 0.12240271 0.06378296]
Stock Position:  0.02620048797684752
Bond Position:  [1.39625656]


portfolio before change:  [3.9441157]
curr_Stock_Price:  97.2380589122514
curr_Factors:  [97.23805891 -0.99583494 -1.03086615]
mat_Sqrt:  [[12.81301046  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00459383 -0.14153314 -0.11307454]
Stock Position:  -0.004593831717903384
Bond Position:  [4.39081098]


portfolio before change:  [3.94489359]
curr_Stock_Price:  97.18820881227666
curr_Factors:  [97.18820881 -0.9071275  -1.05101216]
mat_Sqrt:  [[13.71526902  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00544075 -0.01223241 -0.09672521]
Stock Position:  -0.005440749130621326
Bond Position:  [4.47367025]


portfolio before change:  [3.93828859]
curr_Stock_Price:  98.50498460824583
curr_Factors:  [98.50498461 -0.88835185 -1.05838131]
mat_Sqrt:  [[14.06056396  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00309494  0.06042444  0.36937932]
Stock Position:  -0.003094943746043022
Bond Position:  [4.24315597]


portfolio before change:  [3.93868716]
curr_Stock_Price:  98.54758894175839
curr_Factors:  [98.54758894 -1.05175141 -1.0426053 ]
mat_Sqrt:  [[12.13608026  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01131324 0.02054552 0.3408519 ]
Stock Position:  0.011313239176265205
Bond Position:  [2.82379471]


portfolio before change:  [3.93762547]
curr_Stock_Price:  98.42254224608395
curr_Factors:  [98.42254225 -1.02042311 -1.07958489]
mat_Sqrt:  [[12.05237651  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00041038 -0.00395597  0.27652888]
Stock Position:  -0.0004103757338570161
Bond Position:  [3.97801569]


portfolio before change:  [3.93837079]
curr_Stock_Price:  97.81811814867676
curr_Factors:  [97.81811815 -1.12800683 -1.06645065]
mat_Sqrt:  [[10.89879612  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00261904 -0.01956681  0.07474255]
Stock Position:  0.002619036995682561
Bond Position:  [3.68218152]


portfolio before change:  [3.93716232]
curr_Stock_Price:  97.18094751734357
curr_Factors:  [97.18094752 -1.06217966 -1.0501796 ]
mat_Sqrt:  [[11.75425647  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01475747 0.00506861 0.69870427]
Stock Position:  0.014757470582472659
Bond Position:  [2.50301735]


portfolio before change:  [3.95050195]
curr_Stock_Price:  98.06366874363886
curr_Factors:  [98.06366874 -0.96531955 -1.07538072]
mat_Sqrt:  [[12.74216635  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00090847 -0.02154858  0.58602979]
Stock Position:  0.0009084674021108098
Bond Position:  [3.8614143]


portfolio before change:  [3.95089735]
curr_Stock_Price:  97.96756504289758
curr_Factors:  [97.96756504 -1.04016321 -1.0696162 ]
mat_Sqrt:  [[11.88000875  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-7.17324619e-03 -1.79969079e-04 -2.34064493e-01]
Stock Position:  -0.007173246193591298
Bond Position:  [4.65364281]


portfolio before change:  [3.94934551]
curr_Stock_Price:  98.26500141312978
curr_Factors:  [98.26500141 -1.00204565 -1.0919581 ]
mat_Sqrt:  [[12.10555189  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02695459  0.03742148  0.18094168]
Stock Position:  -0.026954589748347243
Bond Position:  [6.59803831]


portfolio before change:  [3.96096097]
curr_Stock_Price:  97.86467415751817
curr_Factors:  [97.86467416 -1.15609029 -1.09885747]
mat_Sqrt:  [[10.2639514   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0040214  -0.05427399  0.30561776]
Stock Position:  -0.0040214029801523155
Bond Position:  [4.35451426]


portfolio before change:  [3.96414946]
curr_Stock_Price:  97.20715743935195
curr_Factors:  [97.20715744 -1.20640812 -1.09783754]
mat_Sqrt:  [[ 9.70458728  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01815692  0.01782187 -0.3989355 ]
Stock Position:  0.018156920336776662
Bond Position:  [2.19916684]


portfolio before change:  [3.95621664]
curr_Stock_Price:  96.75511312977592
curr_Factors:  [96.75511313 -0.98579974 -1.08737676]
mat_Sqrt:  [[12.1703988   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [8.33099324e-05 9.50663276e-03 4.42572548e-02]
Stock Position:  8.330993243751388e-05
Bond Position:  [3.94815598]


portfolio before change:  [3.95671445]
curr_Stock_Price:  96.80630814347317
curr_Factors:  [96.80630814 -0.8552972  -1.08441152]
mat_Sqrt:  [[13.91550164  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00955947 -0.03085394 -0.49199974]
Stock Position:  -0.009559467464399158
Bond Position:  [4.88213121]


portfolio before change:  [3.95538063]
curr_Stock_Price:  97.0096806468244
curr_Factors:  [97.00968065 -0.88408946 -1.08029652]
mat_Sqrt:  [[13.60482893  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00501739  0.02810164 -0.18177396]
Stock Position:  0.005017391492558264
Bond Position:  [3.46864508]


portfolio before change:  [3.95612567]
curr_Stock_Price:  97.07175261410434
curr_Factors:  [97.07175261 -0.85089914 -1.0265092 ]
mat_Sqrt:  [[14.85062681  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00380173 0.00144255 0.08776089]
Stock Position:  0.0038017347929735243
Bond Position:  [3.58708461]


portfolio before change:  [3.95768214]
curr_Stock_Price:  97.36321318683468
curr_Factors:  [97.36321319 -0.86584731 -1.03290689]
mat_Sqrt:  [[14.58063465  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00218845 -0.02997085 -0.23452427]
Stock Position:  0.002188453062406022
Bond Position:  [3.74460732]


portfolio before change:  [3.95692368]
curr_Stock_Price:  96.80274105954491
curr_Factors:  [96.80274106 -1.08335434 -1.00758019]
mat_Sqrt:  [[11.96206958  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.02308977 -0.11197908 -0.87207869]
Stock Position:  0.02308976728075448
Bond Position:  [1.72177092]


portfolio before change:  [3.95524666]
curr_Stock_Price:  96.72078878694565
curr_Factors:  [96.72078879 -0.97642071 -1.00997853]
mat_Sqrt:  [[13.26898182  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00354046 -0.02570712  0.01204301]
Stock Position:  -0.0035404596605728518
Bond Position:  [4.29768271]


portfolio before change:  [3.95568003]
curr_Stock_Price:  96.75012628207736
curr_Factors:  [96.75012628 -1.04509085 -1.00454481]
mat_Sqrt:  [[12.45965683  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01280758  0.00700471  0.06040254]
Stock Position:  -0.012807576880746031
Bond Position:  [5.19481471]


portfolio before change:  [3.95803513]
curr_Stock_Price:  96.61694716596074
curr_Factors:  [96.61694717 -1.00670327 -0.99258181]
mat_Sqrt:  [[13.08503332  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00424634 -0.02991533 -0.16863885]
Stock Position:  0.004246336623079011
Bond Position:  [3.54776705]


portfolio before change:  [3.95600841]
curr_Stock_Price:  96.03521879508078
curr_Factors:  [96.0352188  -0.99618046 -0.96966875]
mat_Sqrt:  [[13.44847576  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00025653 -0.00413037 -0.25552935]
Stock Position:  -0.0002565302641413243
Bond Position:  [3.98064435]


portfolio before change:  [3.95655787]
curr_Stock_Price:  95.83308856225779
curr_Factors:  [95.83308856 -1.0487605  -0.97215484]
mat_Sqrt:  [[12.70115168  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00215649  0.00883408 -0.18497941]
Stock Position:  -0.002156490095500903
Bond Position:  [4.16322098]


portfolio before change:  [3.95618207]
curr_Stock_Price:  96.24869070106126
curr_Factors:  [96.2486907  -0.91728334 -0.96911279]
mat_Sqrt:  [[14.59296031  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00557719 -0.04996104 -0.053151  ]
Stock Position:  0.005577189110827072
Bond Position:  [3.41938492]


portfolio before change:  [3.95599993]
curr_Stock_Price:  96.1393904211111
curr_Factors:  [96.13939042 -0.86828971 -0.98733849]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [3.95599993]
Stock Price:  95.61934170066715
PL:  [3.95599993]
Settle:  Tensor("sub_326:0", shape=(), dtype=float64)
PL:  Tensor("sub_327:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  164
output_Z_Vals[:, i, :]:  [[ 1.19260232e+02 -2.92559343e+01 -2.92733494e+01]
 [-5.83588204e-03 -5.76747279e-02 -2.44765365e-02]
 [-5.61319198e-02 -7.44454108e-02 -6.12005055e-02]
 [ 7.91723755e-02  1.17619914e-01  3.72525734e-02]
 [ 2.24992005e-01 -2.25763590e-02 -4.39861781e-02]
 [ 5.33736370e-02  3.07981511e-02  3.02687946e-02]
 [ 1.17852381e-02  6.89284672e-02 -3.03216503e-03]
 [-1.37314308e-01  9.90202133e-02 -6.31736723e-02]
 [ 1.09200055e-02 -5.30186468e-02  1.99695246e-02]
 [-3.17101773e-02 -5.17537634e-02 -1.00788695e-01]
 [ 5.90605322e-02  1.56809070e-01 -8.67164849e-02]
 [-9.28610554e-02  4.68940406e-02  2.33573863e-02]
 [-1.05268475e-01  3.60169765e-02 -5.01576103e-02]
 [-1.10476691e-01 -1.06566000e-01  5.86600877e-02]
 [ 3.77457217e-01  4.51866973e-01  3.09711074e-02]
 [-4.37295215e-02 -3.25596721e-01 -5.44325159e-02]
 [-6.73113536e-02 -5.55417285e-02 -3.94610527e-02]
 [-7.17107325e-02  2.35388846e-01  1.41109784e-01]
 [-7.20868211e-03  5.98615639e-02 -3.89669242e-02]
 [-6.99244351e-02 -3.04801718e-02  1.51420968e-01]
 [ 1.25378312e-01 -1.21455998e-01  6.57716481e-02]
 [ 1.17392348e-01  1.57031207e-01  3.27754522e-01]
 [-5.18618322e-04 -1.62437566e-01  1.21309438e-01]
 [-8.13321423e-02 -4.23592184e-02 -7.89962071e-02]
 [-6.46004484e-01  1.86169886e-01  3.69623140e-02]
 [-1.04791258e-01 -2.23308827e-01  1.21892222e-01]
 [ 9.51527336e-02  6.04704883e-02 -6.91063605e-02]
 [ 2.33035434e-02  9.95727471e-03  1.25237384e-02]
 [-8.13873663e-02 -7.70659900e-02 -1.97617849e-01]
 [ 2.24745124e-02  5.52706396e-03 -1.22824633e-01]
 [ 2.04060080e-02  1.67085872e-01  9.98716482e-03]
 [ 1.49438562e-02 -7.72232483e-02 -8.10125541e-02]
 [ 1.64647118e-01 -7.49861090e-02  5.57024279e-02]
 [-4.34786416e-02 -7.90843548e-02  1.04454517e-02]
 [-2.10476172e-01  1.40954511e-01  1.73378121e-02]
 [ 1.99536265e-01 -6.32211501e-02 -3.63315171e-02]
 [-8.24889160e-03 -9.32446140e-02 -7.97659431e-02]
 [-2.22436558e-02  2.48901323e-02 -6.20742524e-02]
 [ 3.71638268e-02 -7.92238343e-02 -3.43996332e-03]
 [-8.66150246e-01  4.29937588e-01  5.30530793e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.26023247 -29.25593426 -29.27334937]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  8.31486419  -9.25153874 -83.50871763]
init_Out:  [2.49911038]
Stock Position:  8.31486419409362
Bond position:  [-828.98730903]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [4.36402957]
curr_Stock_Price:  100.23675059861384
curr_Factors:  [100.2367506   -0.88756018  -1.00698628]
mat_Sqrt:  [[15.07425668  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00081737 -0.01823835 -0.06982475]
Stock Position:  -0.0008173729201471831
Bond Position:  [4.44596037]


portfolio before change:  [4.36434226]
curr_Stock_Price:  100.53414649724368
curr_Factors:  [100.5341465   -0.65756562  -1.00480076]
mat_Sqrt:  [[19.07027926  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0036993  -0.02354171 -0.17458801]
Stock Position:  -0.003699295223646521
Bond Position:  [4.73624775]


portfolio before change:  [4.36197176]
curr_Stock_Price:  101.33499461630117
curr_Factors:  [101.33499462  -0.59172286  -1.02164071]
mat_Sqrt:  [[20.18759367  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00444894 0.03719468 0.10627122]
Stock Position:  0.004448943238468789
Bond Position:  [3.91113812]


portfolio before change:  [4.36266543]
curr_Stock_Price:  101.38101726397015
curr_Factors:  [101.38101726  -0.72412003  -1.01667522]
mat_Sqrt:  [[17.78029133  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01211625 -0.00713927 -0.12548032]
Stock Position:  0.012116249446211678
Bond Position:  [3.13430774]


portfolio before change:  [4.35816218]
curr_Stock_Price:  100.97700906390234
curr_Factors:  [100.97700906  -0.94795356  -1.02340442]
mat_Sqrt:  [[14.06282622  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00429127 0.00973923 0.08634845]
Stock Position:  0.004291273513332963
Bond Position:  [3.92484222]


portfolio before change:  [4.36147713]
curr_Stock_Price:  101.63516268808824
curr_Factors:  [101.63516269  -0.71213914  -1.05012608]
mat_Sqrt:  [[17.4462433   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00074205  0.0217971  -0.00864992]
Stock Position:  0.0007420523222706853
Bond Position:  [4.28605852]


portfolio before change:  [4.36095448]
curr_Stock_Price:  100.20878518126806
curr_Factors:  [100.20878518  -0.87969588  -1.01922563]
mat_Sqrt:  [[15.00426274  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00984073  0.03131294 -0.1802169 ]
Stock Position:  -0.009840729374615605
Bond Position:  [5.34708201]


portfolio before change:  [4.3685729]
curr_Stock_Price:  99.50253723363814
curr_Factors:  [99.50253723 -0.87635807 -0.96799332]
mat_Sqrt:  [[15.7341223   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0008661  -0.01676597  0.0569675 ]
Stock Position:  0.0008661005572360695
Bond Position:  [4.2823937]


portfolio before change:  [4.36901948]
curr_Stock_Price:  99.40006694309196
curr_Factors:  [99.40006694 -0.95486562 -0.95994906]
mat_Sqrt:  [[14.6485023   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00366043 -0.01636598 -0.28752209]
Stock Position:  -0.003660432919239651
Bond Position:  [4.73286676]


portfolio before change:  [4.37176666]
curr_Stock_Price:  98.81119256539858
curr_Factors:  [98.81119257 -1.10147981 -0.94733368]
mat_Sqrt:  [[12.73555122  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00356548  0.04958738 -0.24737799]
Stock Position:  0.0035654834100853844
Bond Position:  [4.01945699]


portfolio before change:  [4.37505842]
curr_Stock_Price:  99.59349595034725
curr_Factors:  [99.59349595 -1.01642567 -0.94065799]
mat_Sqrt:  [[14.06955433  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00617521  0.0148292   0.06663212]
Stock Position:  -0.006175209815801794
Bond Position:  [4.99006915]


portfolio before change:  [4.37322868]
curr_Stock_Price:  99.9908155460087
curr_Factors:  [99.99081555 -1.33083164 -0.95049711]
mat_Sqrt:  [[10.21390047  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01121774  0.01138957 -0.1430857 ]
Stock Position:  -0.01121774198038591
Bond Position:  [5.49489985]


portfolio before change:  [4.38754994]
curr_Stock_Price:  98.77538755803096
curr_Factors:  [98.77538756 -1.37704849 -0.92859921]
mat_Sqrt:  [[ 9.84733408  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0102824  -0.03369913  0.1673409 ]
Stock Position:  -0.010282404551193097
Bond Position:  [5.40319844]


portfolio before change:  [4.39276046]
curr_Stock_Price:  98.33433572311317
curr_Factors:  [98.33433572 -1.26459015 -0.96924291]
mat_Sqrt:  [[10.5332845   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.03754255 0.14289288 0.08835195]
Stock Position:  0.03754254646150536
Bond Position:  [0.70103909]


portfolio before change:  [4.37901833]
curr_Stock_Price:  97.96596001660191
curr_Factors:  [97.96596002 -1.2222613  -0.97450698]
mat_Sqrt:  [[10.89007468  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0058078  -0.10296272 -0.15528082]
Stock Position:  -0.005807800711139963
Bond Position:  [4.94798511]


portfolio before change:  [4.38203264]
curr_Stock_Price:  97.55345135407521
curr_Factors:  [97.55345135 -1.40339196 -1.00394992]
mat_Sqrt:  [[ 8.78511278  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00874211 -0.01756384 -0.1125714 ]
Stock Position:  -0.008742106148138378
Bond Position:  [5.23485527]


portfolio before change:  [4.38306094]
curr_Stock_Price:  97.51068106525827
curr_Factors:  [97.51068107 -1.45877723 -0.98206324]
mat_Sqrt:  [[ 8.49197375  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00433693  0.07443649  0.40254694]
Stock Position:  -0.004336931052790804
Bond Position:  [4.80595804]


portfolio before change:  [4.38711227]
curr_Stock_Price:  96.71506084439508
curr_Factors:  [96.71506084 -1.29290774 -1.00214156]
mat_Sqrt:  [[ 9.74466387  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0013974   0.01892989 -0.11116179]
Stock Position:  -0.0013973958913715335
Bond Position:  [4.5222615]


portfolio before change:  [4.38822478]
curr_Stock_Price:  96.32347875435124
curr_Factors:  [96.32347875 -1.55519748 -0.98539386]
mat_Sqrt:  [[ 7.5921951   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00524259 -0.00963868  0.43196187]
Stock Position:  -0.005242588418371392
Bond Position:  [4.89320914]


portfolio before change:  [4.38819023]
curr_Stock_Price:  96.44674673395428
curr_Factors:  [96.44674673 -1.4174126  -0.97393706]
mat_Sqrt:  [[ 8.82546555  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01537232 -0.03840776  0.1876282 ]
Stock Position:  0.015372323718417643
Bond Position:  [2.90557962]


portfolio before change:  [4.37794544]
curr_Stock_Price:  95.75667479922981
curr_Factors:  [95.7566748  -1.37540842 -0.97812657]
mat_Sqrt:  [[ 9.10000851  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.02069773 0.04965763 0.93499242]
Stock Position:  0.02069772654077154
Bond Position:  [2.39599997]


portfolio before change:  [4.38733567]
curr_Stock_Price:  96.19588771723905
curr_Factors:  [96.19588772 -1.38667478 -0.99980024]
mat_Sqrt:  [[ 8.84552424  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00226662 -0.05136727  0.34606206]
Stock Position:  0.0022666205677097035
Bond Position:  [4.16929609]


portfolio before change:  [4.38824865]
curr_Stock_Price:  96.36874014271325
curr_Factors:  [96.36874014 -1.47626783 -0.99810954]
mat_Sqrt:  [[ 8.1157329   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01214319 -0.01339516 -0.22535419]
Stock Position:  -0.012143189913572426
Bond Position:  [5.55847257]


portfolio before change:  [4.39601336]
curr_Stock_Price:  95.78653299124866
curr_Factors:  [95.78653299 -1.28847675 -0.98617271]
mat_Sqrt:  [[ 9.85001162  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.06433015  0.05887209  0.10544319]
Stock Position:  -0.06433014719248663
Bond Position:  [10.55797513]


portfolio before change:  [4.36948088]
curr_Stock_Price:  96.21949183664898
curr_Factors:  [96.21949184 -0.94182983 -1.01621057]
mat_Sqrt:  [[13.57991078  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00630902 -0.07061645  0.34772458]
Stock Position:  -0.006309019466793844
Bond Position:  [4.97653153]


portfolio before change:  [4.37506259]
curr_Stock_Price:  95.43337901374817
curr_Factors:  [95.43337901 -0.80156735 -1.0201532 ]
mat_Sqrt:  [[15.43608344  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0053516   0.01912245 -0.19714121]
Stock Position:  0.005351603498380578
Bond Position:  [3.86434098]


portfolio before change:  [4.37567392]
curr_Stock_Price:  95.45734519745359
curr_Factors:  [95.4573452  -0.59574298 -1.0461044 ]
mat_Sqrt:  [[18.48264381  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00141306 0.00314877 0.03572674]
Stock Position:  0.001413057396735061
Bond Position:  [4.24078721]


portfolio before change:  [4.37939424]
curr_Stock_Price:  97.71499730401305
curr_Factors:  [97.7149973  -0.41865903 -1.03303039]
mat_Sqrt:  [[22.8823445   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0054066  -0.02437041 -0.56374872]
Stock Position:  -0.005406604031192062
Bond Position:  [4.90770054]


portfolio before change:  [4.37075159]
curr_Stock_Price:  99.42700624070487
curr_Factors:  [99.42700624 -0.33208268 -1.03873097]
mat_Sqrt:  [[25.24454564  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-9.72191275e-05  1.74781109e-03 -3.50384492e-01]
Stock Position:  -9.721912752648318e-05
Bond Position:  [4.3804178]


portfolio before change:  [4.37134375]
curr_Stock_Price:  98.96845808133519
curr_Factors:  [98.96845808 -0.46244912 -1.03610985]
mat_Sqrt:  [[22.11469285  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00121    0.05283719 0.0284906 ]
Stock Position:  0.001209999538916966
Bond Position:  [4.25159197]


portfolio before change:  [4.37143237]
curr_Stock_Price:  98.60245570339625
curr_Factors:  [98.6024557  -0.30915277 -1.04949274]
mat_Sqrt:  [[25.34168494  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-1.41531940e-04 -2.44201353e-02 -2.31106267e-01]
Stock Position:  -0.00014153194038370916
Bond Position:  [4.38538777]


portfolio before change:  [4.37204273]
curr_Stock_Price:  98.16331772545095
curr_Factors:  [98.16331773 -0.13611158 -1.04234444]
mat_Sqrt:  [[30.21010811  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00576235 -0.02371269  0.15890352]
Stock Position:  0.005762349294125884
Bond Position:  [3.80639141]


portfolio before change:  [4.37773341]
curr_Stock_Price:  99.06830462359976
curr_Factors:  [ 9.90683046e+01  6.60500367e-02 -1.03369533e+00]
mat_Sqrt:  [[37.64364948  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00115261 -0.02500867  0.02979797]
Stock Position:  -0.00115260933862189
Bond Position:  [4.49192047]


portfolio before change:  [4.37969368]
curr_Stock_Price:  97.85476460236673
curr_Factors:  [97.8547646  -0.23452159 -1.05199264]
mat_Sqrt:  [[27.0306163   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00752102  0.04457373  0.04945995]
Stock Position:  -0.007521015201638285
Bond Position:  [5.11566085]


portfolio before change:  [4.39083874]
curr_Stock_Price:  96.45793654852469
curr_Factors:  [96.45793655 -0.32032509 -1.08574747]
mat_Sqrt:  [[23.64222855  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0080571  -0.01999228 -0.10364371]
Stock Position:  0.008057098431494871
Bond Position:  [3.61366765]


portfolio before change:  [4.40054768]
curr_Stock_Price:  97.60688643386807
curr_Factors:  [97.60688643 -0.58397279 -1.10358111]
mat_Sqrt:  [[18.05448546  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00149207 -0.02948654 -0.22755003]
Stock Position:  -0.0014920731030392876
Bond Position:  [4.54618429]


portfolio before change:  [4.40158332]
curr_Stock_Price:  97.29367215406388
curr_Factors:  [97.29367215 -0.62402221 -1.07202516]
mat_Sqrt:  [[17.84434377  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0019206   0.00787095 -0.17708056]
Stock Position:  -0.0019206001363661197
Bond Position:  [4.58844556]


portfolio before change:  [4.40190959]
curr_Stock_Price:  97.42244764914905
curr_Factors:  [97.42244765 -0.76778284 -1.06774588]
mat_Sqrt:  [[15.54171862  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00221443 -0.02505278 -0.00981326]
Stock Position:  0.002214433132581682
Bond Position:  [4.18617409]


portfolio before change:  [4.40183796]
curr_Stock_Price:  97.15378633979438
curr_Factors:  [97.15378634 -0.65872771 -1.06480145]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [4.40183796]
Stock Price:  96.65023785472032
PL:  [4.40183796]
Settle:  Tensor("sub_328:0", shape=(), dtype=float64)
PL:  Tensor("sub_329:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  165
output_Z_Vals[:, i, :]:  [[ 1.19260232e+02 -2.92559343e+01 -2.92733494e+01]
 [-4.17908388e-02  6.04180257e-02 -2.62638451e-03]
 [-5.75966951e-02 -8.21757985e-02 -7.36596387e-02]
 [ 8.76596624e-02  1.94795065e-01  3.82836270e-02]
 [ 2.14780753e-01 -2.85899067e-02 -5.56649166e-02]
 [ 7.67101932e-02  3.03818187e-02 -3.30294868e-02]
 [ 6.61832334e-02  1.89612207e-02 -5.83242593e-02]
 [-1.06419906e-01 -5.35191816e-02 -1.17235654e-01]
 [-3.30846429e-02 -6.48454176e-02  3.09940406e-02]
 [-5.27843100e-02 -1.15513977e-01 -1.29688355e-01]
 [ 5.72321169e-02  1.66866898e-01 -8.49623039e-02]
 [-9.38902852e-02 -1.08574608e-01  4.90425044e-03]
 [-7.79516902e-02 -6.81090606e-03  6.97863414e-03]
 [-9.98588165e-02 -1.16125908e-01  6.06683012e-02]
 [ 3.31024534e-01  5.09021285e-01  1.56227381e-01]
 [-2.19773148e-02 -4.64678191e-01 -2.39342965e-02]
 [-6.63362499e-02 -2.79756645e-02 -2.99114856e-02]
 [ 1.92465899e-02  9.56644227e-02 -7.16877763e-02]
 [ 7.00396756e-02  6.85736175e-02  7.06077064e-02]
 [-5.00782215e-02 -1.89538940e-02  1.22927722e-01]
 [ 7.98271714e-02 -9.85465796e-02  5.70416696e-02]
 [ 1.18416171e-01  7.11831876e-02  2.74094122e-01]
 [-3.58208606e-02 -4.39254211e-02  2.27417307e-01]
 [-5.17900528e-02 -2.88473969e-03 -8.69371683e-02]
 [-8.14322602e-01  1.90236356e-01  3.61913311e-02]
 [-2.01943428e-01 -3.32349970e-01  1.53021666e-01]
 [ 1.84637769e-03  7.38178837e-02  2.10461081e-02]
 [-4.50351262e-04 -1.66004886e-01 -1.06203665e-01]
 [-1.50176873e-01 -2.33148100e-01 -2.57610764e-02]
 [ 1.64477775e-01  2.17771665e-01  1.33713506e-01]
 [ 9.57161250e-02 -1.23596119e-01  8.80423104e-02]
 [ 1.14031438e-01  9.07278090e-02  5.72736870e-02]
 [ 4.90240033e-01 -4.81745835e-01 -4.39795930e-01]
 [-4.19167373e-02 -7.75595293e-02  1.47422462e-02]
 [-5.63406970e-02 -2.51328216e-01  4.19794728e-03]
 [ 2.96071821e-01  1.43800033e-01  6.41229161e-02]
 [ 1.10270684e-02 -9.18610836e-02 -9.07091992e-02]
 [-9.32780279e-03  5.14519821e-02 -2.76592359e-02]
 [ 2.04958021e-01 -3.02046569e-01 -5.31658635e-02]
 [-4.58996463e-01  2.56888849e-01  2.51960131e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.26023247 -29.25593426 -29.27334937]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  8.31486419  -9.25153874 -83.50871763]
init_Out:  [2.49911038]
Stock Position:  8.31486419409362
Bond position:  [-828.98730903]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [6.67595302]
curr_Stock_Price:  100.51479764756776
curr_Factors:  [100.51479765  -1.11216097  -1.00198702]
mat_Sqrt:  [[12.13576616  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00335924  0.01910586 -0.00749234]
Stock Position:  -0.0033592407765398887
Bond Position:  [7.01360642]


portfolio before change:  [6.67655378]
curr_Stock_Price:  100.59695743953634
curr_Factors:  [100.59695744  -1.12715396  -0.99414202]
mat_Sqrt:  [[12.05917801  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00619894 -0.02598627 -0.21013045]
Stock Position:  -0.006198944557339537
Bond Position:  [7.30014874]


portfolio before change:  [6.67663581]
curr_Stock_Price:  100.73093888143869
curr_Factors:  [100.73093888  -1.38487888  -1.01406397]
mat_Sqrt:  [[ 9.14777001  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01098671 0.06159961 0.10921253]
Stock Position:  0.010986706256574073
Bond Position:  [5.56993457]


portfolio before change:  [6.67450714]
curr_Stock_Price:  100.47381402154306
curr_Factors:  [100.47381402  -1.18758939  -1.02904745]
mat_Sqrt:  [[10.94913327  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01851106 -0.00904092 -0.15879651]
Stock Position:  0.018511055277902252
Bond Position:  [4.81463081]


portfolio before change:  [6.66881789]
curr_Stock_Price:  100.13395655992268
curr_Factors:  [100.13395656  -1.10358354  -1.04598381]
mat_Sqrt:  [[11.66906715  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00606326  0.00960757 -0.09422393]
Stock Position:  0.006063255251355486
Bond Position:  [6.06168015]


portfolio before change:  [6.67005014]
curr_Stock_Price:  100.21221368809798
curr_Factors:  [100.21221369  -1.05133622  -1.04812687]
mat_Sqrt:  [[12.27822032  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00446053  0.00599606 -0.16638288]
Stock Position:  0.004460534097838708
Bond Position:  [6.22305014]


portfolio before change:  [6.66676335]
curr_Stock_Price:  99.3009509506184
curr_Factors:  [99.30095095 -0.94330663 -1.04686324]
mat_Sqrt:  [[13.57168022  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00970642 -0.01692425 -0.33444069]
Stock Position:  -0.009706417386588785
Bond Position:  [7.63061983]


portfolio before change:  [6.67511542]
curr_Stock_Price:  98.53875597416904
curr_Factors:  [98.53875597 -1.03342692 -1.03330965]
mat_Sqrt:  [[12.47483426  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00227917 -0.02050592  0.08841737]
Stock Position:  -0.0022791735542718157
Bond Position:  [6.89970234]


portfolio before change:  [6.67490406]
curr_Stock_Price:  99.00992561995167
curr_Factors:  [99.00992562 -1.13658951 -1.0793829 ]
mat_Sqrt:  [[10.79677736  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00761703 -0.03652873 -0.36996478]
Stock Position:  -0.007617031444967754
Bond Position:  [7.42906577]


portfolio before change:  [6.67400953]
curr_Stock_Price:  99.24928648329163
curr_Factors:  [99.24928648 -1.06020549 -1.08036906]
mat_Sqrt:  [[11.67045202  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00378715  0.05276795 -0.2423738 ]
Stock Position:  0.003787149280402307
Bond Position:  [6.29813767]


portfolio before change:  [6.67293821]
curr_Stock_Price:  98.75851302030448
curr_Factors:  [98.75851302 -0.95348563 -1.10926225]
mat_Sqrt:  [[12.55262405  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00762331 -0.03433431  0.01399046]
Stock Position:  -0.007623313917043065
Bond Position:  [7.42580536]


portfolio before change:  [6.68850564]
curr_Stock_Price:  96.83820112183427
curr_Factors:  [96.83820112 -0.81484516 -1.04645705]
mat_Sqrt:  [[15.05543933  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00509471 -0.0021538   0.0199081 ]
Stock Position:  -0.005094706150877347
Bond Position:  [7.18186782]


portfolio before change:  [6.69628759]
curr_Stock_Price:  95.48696222640272
curr_Factors:  [95.48696223 -0.91047237 -1.03476174]
mat_Sqrt:  [[13.65021967  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00662797 -0.03672224  0.17306978]
Stock Position:  -0.006627974616318491
Bond Position:  [7.32917275]


portfolio before change:  [6.68756989]
curr_Stock_Price:  96.94048343499516
curr_Factors:  [96.94048343 -1.35616947 -1.01785028]
mat_Sqrt:  [[ 9.02571264  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.0416651  0.16096666 0.44567323]
Stock Position:  0.04166509647797132
Bond Position:  [2.6485353]


portfolio before change:  [6.68246374]
curr_Stock_Price:  96.80998470792777
curr_Factors:  [96.80998471 -1.29713405 -1.0002572 ]
mat_Sqrt:  [[ 9.73141082  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00399334 -0.14694415 -0.06827789]
Stock Position:  -0.0039933389545144015
Bond Position:  [7.06905882]


portfolio before change:  [6.68521316]
curr_Stock_Price:  96.34277241252029
curr_Factors:  [96.34277241 -1.15585126 -1.01089591]
mat_Sqrt:  [[11.03602809  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00662958 -0.00884668 -0.08532914]
Stock Position:  -0.006629580348364958
Bond Position:  [7.32392532]


portfolio before change:  [6.68698026]
curr_Stock_Price:  96.21432562684444
curr_Factors:  [96.21432563 -0.80398304 -0.99417337]
mat_Sqrt:  [[15.93346878  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00044456  0.03025175 -0.20450527]
Stock Position:  0.00044456287209423175
Bond Position:  [6.64420694]


portfolio before change:  [6.68852835]
curr_Stock_Price:  97.82828889050452
curr_Factors:  [97.82828889 -1.21648987 -1.01480076]
mat_Sqrt:  [[10.50575448  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00820721 0.02168488 0.20142413]
Stock Position:  0.00820721412086821
Bond Position:  [5.88563063]


portfolio before change:  [6.68238155]
curr_Stock_Price:  96.98969154757
curr_Factors:  [96.98969155 -1.03674103 -0.99118786]
mat_Sqrt:  [[12.76460123  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00199576 -0.00599375  0.35067857]
Stock Position:  -0.001995760955062742
Bond Position:  [6.87594979]


portfolio before change:  [6.68401089]
curr_Stock_Price:  96.60397780274933
curr_Factors:  [96.6039778  -0.97040792 -0.97123383]
mat_Sqrt:  [[13.85960058  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00641622 -0.03116316  0.16272401]
Stock Position:  0.006416223264259528
Bond Position:  [6.0641782]


portfolio before change:  [6.68277775]
curr_Stock_Price:  96.29363851907728
curr_Factors:  [96.29363852 -0.77167281 -0.99122739]
mat_Sqrt:  [[16.51884856  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01066681 0.0225101  0.78191424]
Stock Position:  0.01066680530750821
Bond Position:  [5.65563226]


portfolio before change:  [6.67749436]
curr_Stock_Price:  95.7320470026978
curr_Factors:  [95.732047   -0.84601735 -1.00682697]
mat_Sqrt:  [[15.00988206  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 6.30674730e-04 -1.38904378e-02  6.48758276e-01]
Stock Position:  0.0006306747304602929
Bond Position:  [6.61711858]


portfolio before change:  [6.6778073]
curr_Stock_Price:  94.91663649753968
curr_Factors:  [94.9166365  -0.84284522 -0.99728649]
mat_Sqrt:  [[15.07243054  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0046184  -0.00091223 -0.24800754]
Stock Position:  -0.00461839989503771
Bond Position:  [7.11617028]


portfolio before change:  [6.68457486]
curr_Stock_Price:  93.64390430630114
curr_Factors:  [93.64390431 -1.01667712 -0.99264723]
mat_Sqrt:  [[12.55570295  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0638772   0.06015802  0.10324379]
Stock Position:  -0.06387720378388129
Bond Position:  [12.66628562]


portfolio before change:  [6.73210254]
curr_Stock_Price:  92.92464459887157
curr_Factors:  [92.9246446  -1.05266604 -0.9727862 ]
mat_Sqrt:  [[12.2599352   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.014624   -0.10509829  0.43652822]
Stock Position:  -0.01462399660564936
Bond Position:  [8.09103223]


portfolio before change:  [6.73412678]
curr_Stock_Price:  92.85538914769982
curr_Factors:  [92.85538915 -1.21544648 -0.98882235]
mat_Sqrt:  [[10.2448434   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.0007856  0.02334326 0.06003869]
Stock Position:  0.0007856016694920362
Bond Position:  [6.66117943]


portfolio before change:  [6.73503441]
curr_Stock_Price:  92.95078022383964
curr_Factors:  [92.95078022 -1.2761411  -0.98441604]
mat_Sqrt:  [[ 9.69405658  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0027249  -0.05249535 -0.3029695 ]
Stock Position:  -0.0027248975873930903
Bond Position:  [6.98831577]


portfolio before change:  [6.73620173]
curr_Stock_Price:  92.84298951355127
curr_Factors:  [92.84298951 -1.25761866 -0.98056675]
mat_Sqrt:  [[ 9.90187744  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01630551 -0.0737279  -0.07348918]
Stock Position:  -0.016305512761035847
Bond Position:  [8.25005428]


portfolio before change:  [6.73379801]
curr_Stock_Price:  93.0536566532642
curr_Factors:  [93.05365665 -0.95947832 -0.95939844]
mat_Sqrt:  [[13.65764602  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01445306 0.06886545 0.38144741]
Stock Position:  0.014453059461009955
Bond Position:  [5.38888798]


portfolio before change:  [6.74183128]
curr_Stock_Price:  93.56286469039686
curr_Factors:  [93.56286469 -0.96566259 -0.9522566 ]
mat_Sqrt:  [[13.74553949  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00803871 -0.03908452  0.25116021]
Stock Position:  0.008038713095383825
Bond Position:  [5.98970625]


portfolio before change:  [6.73663093]
curr_Stock_Price:  92.82280661140138
curr_Factors:  [92.82280661 -0.78389519 -0.95929294]
mat_Sqrt:  [[16.24043698  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00788556 0.02869065 0.16338589]
Stock Position:  0.007885561339766372
Bond Position:  [6.00467099]


portfolio before change:  [6.72924891]
curr_Stock_Price:  91.79147311816455
curr_Factors:  [91.79147312 -0.9605639  -0.95802386]
mat_Sqrt:  [[13.47628727  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.02879342 -0.15234141 -1.25461537]
Stock Position:  0.028793423083329033
Bond Position:  [4.08625819]


portfolio before change:  [6.748487]
curr_Stock_Price:  92.4418741301157
curr_Factors:  [92.44187413 -1.17742649 -0.95540791]
mat_Sqrt:  [[10.95444889  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00373456 -0.02452648  0.04205552]
Stock Position:  -0.0037345618875214517
Bond Position:  [7.0937169]


portfolio before change:  [6.75050301]
curr_Stock_Price:  92.13949933387185
curr_Factors:  [92.13949933 -1.21744708 -0.93810466]
mat_Sqrt:  [[10.67337134  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00580632 -0.07947696  0.01197558]
Stock Position:  -0.005806324846666866
Bond Position:  [7.28549487]


portfolio before change:  [6.75586799]
curr_Stock_Price:  91.37236307753416
curr_Factors:  [91.37236308 -1.21171445 -0.91351017]
mat_Sqrt:  [[10.9104216   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.0286766  0.04547356 0.18292483]
Stock Position:  0.02867659643265996
Bond Position:  [4.13561961]


portfolio before change:  [6.74591887]
curr_Stock_Price:  91.00739287237595
curr_Factors:  [91.00739287 -1.11787004 -0.88712425]
mat_Sqrt:  [[12.25515244  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00080462 -0.02904903 -0.2587681 ]
Stock Position:  -0.0008046176805738224
Bond Position:  [6.81914503]


portfolio before change:  [6.74560874]
curr_Stock_Price:  92.45227510808444
curr_Factors:  [92.45227511 -1.50705282 -0.89136556]
mat_Sqrt:  [[ 8.40035683  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00162436  0.01627055 -0.0789041 ]
Stock Position:  -0.0016243638783039335
Bond Position:  [6.89578488]


portfolio before change:  [6.74598963]
curr_Stock_Price:  92.74847771699679
curr_Factors:  [92.74847772 -1.4952829  -0.8896541 ]
mat_Sqrt:  [[ 8.54165075  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.02181157 -0.09551551 -0.15166741]
Stock Position:  0.021811565561114847
Bond Position:  [4.72300013]


portfolio before change:  [6.74676982]
curr_Stock_Price:  92.75717874452717
curr_Factors:  [92.75717874 -1.55517275 -0.92464224]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [6.74676982]
Stock Price:  92.49480418102063
PL:  [6.74676982]
Settle:  Tensor("sub_330:0", shape=(), dtype=float64)
PL:  Tensor("sub_331:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  166
output_Z_Vals[:, i, :]:  [[ 1.19260232e+02 -2.92559343e+01 -2.92733494e+01]
 [ 7.36405270e-02 -2.20556599e-01 -2.11676389e-01]
 [-4.56067434e-02  2.26587893e-02  1.04553438e-01]
 [ 8.53522589e-02  1.73813777e-01  3.80033188e-02]
 [ 1.71278769e-01 -1.44893229e-02 -6.03820065e-02]
 [ 6.78612310e-02  2.91365510e-02 -6.92938611e-02]
 [ 7.02402917e-02  1.55567600e-02 -6.53960246e-02]
 [-1.38643932e-01  2.77085348e-02 -9.53956940e-02]
 [-6.71668971e-02 -6.50966884e-02  7.90283708e-02]
 [-4.07057910e-02  1.04007830e-01 -3.66675037e-03]
 [ 5.48188143e-02  9.75582819e-02 -7.86317156e-02]
 [-1.96797149e-02  6.94787032e-02 -1.14208329e-02]
 [-1.05268475e-01  3.60169765e-02 -5.01576103e-02]
 [-5.26702574e-02 -2.43291636e-02  1.04502518e-01]
 [ 2.84729889e-01  3.86469943e-01  7.70673973e-02]
 [-7.94835929e-02 -8.76115775e-02 -1.09720714e-01]
 [-7.18540394e-02 -5.66302645e-02 -6.00722392e-02]
 [-6.19234770e-02  2.72918365e-02  6.53442403e-02]
 [ 1.74813770e-02  6.99616519e-02  2.22499368e-02]
 [ 3.30519542e-01 -1.17345271e-01 -7.16730521e-02]
 [ 7.04877794e-03  1.18304891e-02  6.20544644e-02]
 [ 3.32698423e-02 -2.84217340e-02  3.22707341e-02]
 [-7.39481083e-02  9.54923589e-02  2.42196080e-01]
 [ 2.64655544e-02 -1.04964204e-02 -5.80645684e-02]
 [ 4.60017129e-02  3.69598247e-02  9.39777090e-02]
 [ 1.45098923e-02 -8.93802257e-02  8.36626290e-02]
 [-1.60066476e-01  6.62095388e-02  5.21155407e-02]
 [-5.07806065e-02  7.36225950e-02  2.93687317e-02]
 [ 5.39203338e-02 -1.01087374e-01 -1.86394629e-01]
 [ 2.72254673e-02  4.40572655e-03 -6.04178686e-02]
 [ 4.35844745e-02  8.91217225e-02  2.50821754e-02]
 [ 1.50438859e-02 -6.24967432e-02 -8.99589028e-02]
 [ 1.92056653e-01 -1.79568062e-01 -1.01044531e-01]
 [-4.92885363e-02 -8.47563257e-02 -5.53755375e-03]
 [-1.92969705e-01  1.41857458e-01  2.30104134e-02]
 [ 1.07166213e-01 -1.55521015e-01 -1.27249765e-01]
 [-5.67021722e-02 -1.83232677e-01 -2.79894066e-02]
 [-2.34258605e-02  2.01036442e-02 -6.95821129e-02]
 [-3.51299055e-03 -3.17774926e-02  9.68798511e-03]
 [-8.74019144e-01  4.33493177e-01  5.35617937e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.26023247 -29.25593426 -29.27334937]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  8.31486419  -9.25153874 -83.50871763]
init_Out:  [2.49911038]
Stock Position:  8.31486419409362
Bond position:  [-828.98730903]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-2.31648096]
curr_Stock_Price:  99.43330866944653
curr_Factors:  [99.43330867 -1.39041794 -0.96443207]
mat_Sqrt:  [[ 9.43699067  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00262134 -0.06974612 -0.60385382]
Stock Position:  0.0026213354406593014
Bond Position:  [-2.57712902]


portfolio before change:  [-2.31730668]
curr_Stock_Price:  99.2412101833995
curr_Factors:  [99.24121018 -1.32301853 -0.9558168 ]
mat_Sqrt:  [[10.16263771  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00233009  0.00716534  0.29826186]
Stock Position:  -0.0023300855157216004
Bond Position:  [-2.08606617]


portfolio before change:  [-2.31997353]
curr_Stock_Price:  100.27382440826939
curr_Factors:  [100.27382441  -1.10349685  -0.97931926]
mat_Sqrt:  [[12.49200167  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.0078128  0.05496474 0.10841289]
Stock Position:  0.007812799652262134
Bond Position:  [-3.10339283]


portfolio before change:  [-2.32200977]
curr_Stock_Price:  100.06285138733016
curr_Factors:  [100.06285139  -1.06538478  -1.00848347]
mat_Sqrt:  [[12.57776095  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01260791 -0.00458193 -0.17225306]
Stock Position:  0.012607906258238084
Bond Position:  [-3.58359282]


portfolio before change:  [-2.33364171]
curr_Stock_Price:  99.17579238757115
curr_Factors:  [99.17579239 -1.03545334 -1.03400364]
mat_Sqrt:  [[12.52137245  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00435008  0.00921379 -0.1976761 ]
Stock Position:  0.004350080914263928
Bond Position:  [-2.76506443]


portfolio before change:  [-2.33139774]
curr_Stock_Price:  99.77109575125029
curr_Factors:  [99.77109575 -0.97460733 -1.02742812]
mat_Sqrt:  [[13.47509372  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00425177  0.00491948 -0.18655666]
Stock Position:  0.0042517743551886665
Bond Position:  [-2.75560193]


portfolio before change:  [-2.33061634]
curr_Stock_Price:  100.03589748729102
curr_Factors:  [100.03589749  -1.22441677  -1.011547  ]
mat_Sqrt:  [[10.69274344  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01472036  0.00876221 -0.27213736]
Stock Position:  -0.014720363063251963
Bond Position:  [-0.85805161]


portfolio before change:  [-2.32688245]
curr_Stock_Price:  99.77495626783062
curr_Factors:  [99.77495627 -1.13279871 -0.98842786]
mat_Sqrt:  [[11.96146994  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00440716 -0.02058538  0.22544594]
Stock Position:  -0.004407157983313055
Bond Position:  [-1.88715846]


portfolio before change:  [-2.33062177]
curr_Stock_Price:  100.56989312772768
curr_Factors:  [100.56989313  -1.39734062  -0.9739759 ]
mat_Sqrt:  [[ 9.38897773  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00412918  0.03289016 -0.01046022]
Stock Position:  -0.004129181449764547
Bond Position:  [-1.91535044]


portfolio before change:  [-2.33097496]
curr_Stock_Price:  100.59744142854593
curr_Factors:  [100.59744143  -1.41935551  -1.01756829]
mat_Sqrt:  [[ 8.79517283  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00469429  0.03085064 -0.2243144 ]
Stock Position:  0.004694293943544683
Bond Position:  [-2.80320892]


portfolio before change:  [-2.33167645]
curr_Stock_Price:  100.52265468281077
curr_Factors:  [100.52265468  -1.41051995  -1.01127515]
mat_Sqrt:  [[ 8.92260572  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00226582  0.0219711  -0.03258046]
Stock Position:  -0.002265823563711284
Bond Position:  [-2.10390985]


portfolio before change:  [-2.33129718]
curr_Stock_Price:  100.2391922636784
curr_Factors:  [100.23919226  -1.30314542  -0.98450501]
mat_Sqrt:  [[10.1747466   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01126091  0.01138957 -0.1430857 ]
Stock Position:  -0.011260909445138778
Bond Position:  [-1.20251271]


portfolio before change:  [-2.33484247]
curr_Stock_Price:  100.54067489100935
curr_Factors:  [100.54067489  -1.24854516  -1.01352481]
mat_Sqrt:  [[10.46977366  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00305326 -0.00769356  0.2981166 ]
Stock Position:  -0.003053260514704862
Bond Position:  [-2.0278656]


portfolio before change:  [-2.33417747]
curr_Stock_Price:  100.23984977457873
curr_Factors:  [100.23984977  -1.25340497  -1.02251864]
mat_Sqrt:  [[10.29483392  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.03015491 0.12221253 0.21985183]
Stock Position:  0.03015491251355115
Bond Position:  [-5.35690138]


portfolio before change:  [-2.33239821]
curr_Stock_Price:  100.32106097681482
curr_Factors:  [100.32106098  -0.96615524  -1.02527256]
mat_Sqrt:  [[13.69386412  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00760504 -0.02770521 -0.31300266]
Stock Position:  -0.007605038300560546
Bond Position:  [-1.5694527]


portfolio before change:  [-2.33317505]
curr_Stock_Price:  100.3974105572957
curr_Factors:  [100.39741056  -1.08199999  -1.03269324]
mat_Sqrt:  [[12.11498585  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00706385 -0.01790806 -0.17136938]
Stock Position:  -0.007063848207402988
Bond Position:  [-1.62398298]


portfolio before change:  [-2.33919407]
curr_Stock_Price:  101.22075892697855
curr_Factors:  [101.22075893  -1.03640156  -1.04075505]
mat_Sqrt:  [[12.68153824  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0037756   0.00863044  0.18640893]
Stock Position:  -0.0037756040872531527
Bond Position:  [-1.95702456]


portfolio before change:  [-2.34226793]
curr_Stock_Price:  101.9701012744201
curr_Factors:  [101.97010127  -1.00825678  -1.02392991]
mat_Sqrt:  [[13.36304369  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00178324 0.02212382 0.06347288]
Stock Position:  0.001783241080560494
Bond Position:  [-2.5241052]


portfolio before change:  [-2.34118794]
curr_Stock_Price:  102.75267997396581
curr_Factors:  [102.75267997  -1.11112347  -1.06187315]
mat_Sqrt:  [[11.69695233  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0267471  -0.03710783 -0.20446327]
Stock Position:  0.026747095385215552
Bond Position:  [-5.08952367]


portfolio before change:  [-2.34609132]
curr_Stock_Price:  102.5931428438308
curr_Factors:  [102.59314284  -0.89663525  -1.04180371]
mat_Sqrt:  [[14.7660724   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00135588 0.00374113 0.17702411]
Stock Position:  0.0013558821745413127
Bond Position:  [-2.48519554]


portfolio before change:  [-2.34591451]
curr_Stock_Price:  102.95267534259528
curr_Factors:  [102.95267534  -1.01677957  -1.02511451]
mat_Sqrt:  [[13.36147193  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00292806 -0.00898774  0.09205942]
Stock Position:  0.002928063055844529
Bond Position:  [-2.64736643]


portfolio before change:  [-2.34900571]
curr_Stock_Price:  102.00998256166497
curr_Factors:  [102.00998256  -0.93414972  -1.01619432]
mat_Sqrt:  [[14.50838331  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00151943  0.03019734  0.690918  ]
Stock Position:  -0.0015194276242997153
Bond Position:  [-2.19400893]


portfolio before change:  [-2.3486133]
curr_Stock_Price:  101.57121328260897
curr_Factors:  [101.57121328  -0.70538108  -1.0266192 ]
mat_Sqrt:  [[17.97100961  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00079807 -0.00331926 -0.16564205]
Stock Position:  0.0007980718907305011
Bond Position:  [-2.42967443]


portfolio before change:  [-2.3490061]
curr_Stock_Price:  101.4596049256099
curr_Factors:  [101.45960493  -0.72145513  -1.04762639]
mat_Sqrt:  [[17.29779811  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00382356 0.01168772 0.26809225]
Stock Position:  0.0038235578067589314
Bond Position:  [-2.73694277]


portfolio before change:  [-2.35417652]
curr_Stock_Price:  100.1968333580956
curr_Factors:  [100.19683336  -0.58898796  -1.02080484]
mat_Sqrt:  [[20.03225618  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00146163 -0.02826451  0.23866619]
Stock Position:  0.0014616260465973388
Bond Position:  [-2.50062682]


portfolio before change:  [-2.35229632]
curr_Stock_Price:  101.6970814027361
curr_Factors:  [101.6970814   -0.65598818  -1.02099878]
mat_Sqrt:  [[19.01088368  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00777023  0.02093729  0.14867113]
Stock Position:  -0.007770228651316135
Bond Position:  [-1.56208674]


portfolio before change:  [-2.35139954]
curr_Stock_Price:  101.5565388359361
curr_Factors:  [101.55653884  -0.83732396  -1.01757852]
mat_Sqrt:  [[15.89036888  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00269879  0.02328151  0.08378082]
Stock Position:  -0.0026987927296912317
Bond Position:  [-2.07731949]


portfolio before change:  [-2.35227938]
curr_Stock_Price:  101.78633062123197
curr_Factors:  [101.78633062  -0.80428196  -1.01240469]
mat_Sqrt:  [[16.5467411   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00080152 -0.03196663 -0.53173199]
Stock Position:  0.0008015248809682973
Bond Position:  [-2.43386366]


portfolio before change:  [-2.35220131]
curr_Stock_Price:  102.26332736306217
curr_Factors:  [102.26332736  -0.94799272  -1.01705938]
mat_Sqrt:  [[14.3320605   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00104706  0.00139321 -0.17235536]
Stock Position:  0.0010470564835449055
Bond Position:  [-2.45927679]


portfolio before change:  [-2.35507868]
curr_Stock_Price:  99.80888108187465
curr_Factors:  [99.80888108 -1.00399416 -1.00869513]
mat_Sqrt:  [[13.33734349  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00382426 0.02818276 0.07155246]
Stock Position:  0.003824259688675374
Bond Position:  [-2.73677376]


portfolio before change:  [-2.35434888]
curr_Stock_Price:  100.08917619043126
curr_Factors:  [100.08917619  -0.98371733  -1.04022781]
mat_Sqrt:  [[13.22509827  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00037297 -0.01976321 -0.25662771]
Stock Position:  -0.0003729694218247692
Bond Position:  [-2.31701868]


portfolio before change:  [-2.35490893]
curr_Stock_Price:  100.81417776872046
curr_Factors:  [100.81417777  -1.00909949  -1.02436552]
mat_Sqrt:  [[13.19468358  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01264105 -0.05678441 -0.28825192]
Stock Position:  0.012641045631045629
Bond Position:  [-3.62930555]


portfolio before change:  [-2.36349283]
curr_Stock_Price:  100.1710180636565
curr_Factors:  [100.17101806  -0.79982531  -1.04571696]
mat_Sqrt:  [[15.8209757   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00332516 -0.0268023  -0.0157971 ]
Stock Position:  -0.003325160512949659
Bond Position:  [-2.03040812]


portfolio before change:  [-2.36191302]
curr_Stock_Price:  99.6195774130567
curr_Factors:  [99.61957741 -0.57296438 -1.0601158 ]
mat_Sqrt:  [[19.45839369  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00948742  0.04485927  0.0656423 ]
Stock Position:  -0.009487421386697078
Bond Position:  [-1.41678011]


portfolio before change:  [-2.3641779]
curr_Stock_Price:  99.83963402280601
curr_Factors:  [99.83963402 -0.69037517 -1.07826358]
mat_Sqrt:  [[17.02914838  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00453199 -0.04918006 -0.36300816]
Stock Position:  0.004531989863234669
Bond Position:  [-2.81665011]


portfolio before change:  [-2.3671954]
curr_Stock_Price:  99.25150411998222
curr_Factors:  [99.25150412 -1.03073516 -1.05312746]
mat_Sqrt:  [[12.35170927  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00543621 -0.05794326 -0.07984599]
Stock Position:  -0.005436213871541731
Bond Position:  [-1.827643]


portfolio before change:  [-2.36374546]
curr_Stock_Price:  98.5748553998687
curr_Factors:  [98.5748554  -0.99141685 -1.04406052]
mat_Sqrt:  [[12.87566179  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0028822   0.00635733 -0.1984984 ]
Stock Position:  -0.0028821956118512356
Bond Position:  [-2.07963345]


portfolio before change:  [-2.36235597]
curr_Stock_Price:  98.00256202438482
curr_Factors:  [98.00256202 -0.93612394 -1.05035624]
mat_Sqrt:  [[13.4437382   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00017524 -0.01004893  0.02763712]
Stock Position:  -0.0001752436837342694
Bond Position:  [-2.34518164]


portfolio before change:  [-2.36251854]
curr_Stock_Price:  97.25729956481703
curr_Factors:  [97.25729956 -0.9071802  -1.06596317]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-2.36251854]
Stock Price:  97.26695642906888
PL:  [-2.36251854]
Settle:  Tensor("sub_332:0", shape=(), dtype=float64)
PL:  Tensor("sub_333:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  167
output_Z_Vals[:, i, :]:  [[ 1.19260232e+02 -2.92559343e+01 -2.92733494e+01]
 [ 6.56006858e-02 -1.48579927e-01 -1.74147999e-01]
 [-4.88934836e-02 -4.69890092e-02 -3.30640332e-02]
 [ 8.77921806e-02  1.96000057e-01  3.82997256e-02]
 [ 2.20535511e-01 -2.60855229e-02 -5.07064031e-02]
 [ 7.62574068e-02  2.98888855e-02 -7.35633134e-02]
 [ 6.87483802e-02  1.68086903e-02 -6.27955079e-02]
 [-1.23796266e-01 -2.38083724e-02 -1.10853634e-01]
 [ 6.05026516e-02 -2.44147104e-02 -4.17427790e-02]
 [-8.29399486e-02  3.37939783e-01  1.54793376e-01]
 [ 5.73527627e-02  9.63137449e-02 -8.16799891e-02]
 [-4.13132555e-02  3.59691866e-02  7.44015140e-04]
 [-8.48235809e-02 -1.82094786e-02 -5.88472902e-02]
 [ 6.35569310e-03  1.52323116e-02  1.40046117e-01]
 [ 1.62407493e-01  1.44188654e-01 -3.96934045e-02]
 [-7.56343269e-02 -7.39213735e-02 -1.06461715e-01]
 [-7.13166403e-02 -5.33582721e-02 -4.15157703e-02]
 [-8.96186121e-02  6.36094961e-02  1.05512898e-01]
 [ 6.67829474e-02  4.86407285e-02  4.79017582e-02]
 [ 2.00662756e-01 -4.81733578e-02 -1.16267342e-02]
 [-3.38152817e-02 -2.67082878e-02  2.12550701e-03]
 [ 5.54831574e-02 -4.13796942e-02  6.86398193e-02]
 [-9.76451094e-02  1.62354342e-01  4.24329519e-01]
 [ 1.03328254e-01 -3.48011879e-02 -5.74685804e-02]
 [ 7.13717944e-02  3.13313528e-02  8.66038001e-02]
 [ 9.54457570e-02  1.91828304e-03  5.76771025e-02]
 [-1.42622161e-01  7.28125621e-02  8.58601445e-02]
 [-5.07806065e-02  7.36225950e-02  2.93687317e-02]
 [ 5.23320006e-02 -2.47751369e-02  9.87908688e-02]
 [-1.31599921e-01 -2.10938634e-01  3.87665746e-02]
 [-1.84596535e-01  8.18041542e-01 -3.78415521e-02]
 [ 5.43629013e-02  1.04554167e-01  2.05696831e-01]
 [-9.49642008e-02  2.73528630e-02  8.53353407e-02]
 [-1.46403820e-01 -5.75056729e-02  9.34616630e-03]
 [-1.96895082e-01  2.09826615e-01  2.79667264e-02]
 [ 1.27897748e-01 -1.46756270e-01 -1.16651097e-01]
 [-8.95823370e-02 -1.68537106e-01 -2.59332144e-02]
 [-2.18262820e-02  2.96283076e-02 -5.37834545e-02]
 [ 1.37657928e-01 -1.79496609e-01 -3.96112373e-02]
 [-7.43294973e-01  3.77098771e-01  4.47349497e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.26023247 -29.25593426 -29.27334937]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  8.31486419  -9.25153874 -83.50871763]
init_Out:  [2.49911038]
Stock Position:  8.31486419409362
Bond position:  [-828.98730903]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-5.28224143]
curr_Stock_Price:  99.07662690077474
curr_Factors:  [99.0766269  -1.07233142 -0.99803381]
mat_Sqrt:  [[12.49749641  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00209774 -0.0469851  -0.49679577]
Stock Position:  0.0020977447176168257
Bond Position:  [-5.4900789]


portfolio before change:  [-5.28069503]
curr_Stock_Price:  100.14096320938509
curr_Factors:  [100.14096321  -1.36091947  -0.98331817]
mat_Sqrt:  [[ 9.60555125  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00591907 -0.01485923 -0.09432248]
Stock Position:  -0.005919067069313203
Bond Position:  [-4.68795395]


portfolio before change:  [-5.28274114]
curr_Stock_Price:  100.38763793866988
curr_Factors:  [100.38763794  -1.3467426   -0.96897704]
mat_Sqrt:  [[ 9.90777133  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01016079 0.06198066 0.10925846]
Stock Position:  0.010160789513065299
Bond Position:  [-6.3027588]


portfolio before change:  [-5.2792286]
curr_Stock_Price:  100.81087592248406
curr_Factors:  [100.81087592  -1.38105292  -0.95808649]
mat_Sqrt:  [[ 9.7192342   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.02155639 -0.00824897 -0.14465125]
Stock Position:  0.0215563880724863
Bond Position:  [-7.45234697]


portfolio before change:  [-5.29251941]
curr_Stock_Price:  100.23753273232425
curr_Factors:  [100.23753273  -1.16746029  -0.94993765]
mat_Sqrt:  [[12.0630222   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00514076  0.0094517  -0.20985566]
Stock Position:  0.005140758675867227
Bond Position:  [-5.80781638]


portfolio before change:  [-5.2949409]
curr_Stock_Price:  99.90772424868854
curr_Factors:  [99.90772425 -0.92304373 -0.93232674]
mat_Sqrt:  [[15.62506783  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0036073   0.00531537 -0.1791381 ]
Stock Position:  0.003607299499089532
Bond Position:  [-5.65533799]


portfolio before change:  [-5.29591749]
curr_Stock_Price:  99.83297861520637
curr_Factors:  [99.83297862 -0.95740239 -0.94069095]
mat_Sqrt:  [[14.96037803  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00982856 -0.00752887 -0.31623456]
Stock Position:  -0.009828555039294433
Bond Position:  [-4.31470357]


portfolio before change:  [-5.30050161]
curr_Stock_Price:  100.2445088341904
curr_Factors:  [100.24450883  -0.69746527  -0.93842367]
mat_Sqrt:  [[19.52554     0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00262997 -0.00772061 -0.11908053]
Stock Position:  0.0026299686149926535
Bond Position:  [-5.56414153]


portfolio before change:  [-5.30080452]
curr_Stock_Price:  100.3938103136696
curr_Factors:  [100.39381031  -0.85514486  -0.9375747 ]
mat_Sqrt:  [[16.71624501  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00254946  0.10686594  0.44158241]
Stock Position:  -0.0025494550634325335
Bond Position:  [-5.04485501]


portfolio before change:  [-5.30191792]
curr_Stock_Price:  100.58316809958265
curr_Factors:  [100.5831681   -0.87081406  -0.94224568]
mat_Sqrt:  [[16.41056262  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00263042  0.03045708 -0.23301027]
Stock Position:  0.0026304226125669246
Bond Position:  [-5.56649416]


portfolio before change:  [-5.30185368]
curr_Stock_Price:  100.87213354249344
curr_Factors:  [100.87213354  -0.76704857  -0.91938536]
mat_Sqrt:  [[18.67937141  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00215386  0.01137446  0.00212247]
Stock Position:  -0.002153855331296873
Bond Position:  [-5.08458969]


portfolio before change:  [-5.30388013]
curr_Stock_Price:  101.51787879326706
curr_Factors:  [101.51787879  -0.97419866  -0.88400604]
mat_Sqrt:  [[15.83195282  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00614617 -0.00575834 -0.16787494]
Stock Position:  -0.006146171701098718
Bond Position:  [-4.67993382]


portfolio before change:  [-5.30087563]
curr_Stock_Price:  100.93385211653039
curr_Factors:  [100.93385212  -1.03368997  -0.86457234]
mat_Sqrt:  [[15.12279272  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00233659 0.00481688 0.39951259]
Stock Position:  0.0023365911530640444
Bond Position:  [-5.53671678]


portfolio before change:  [-5.30021582]
curr_Stock_Price:  101.51244726864213
curr_Factors:  [101.51244727  -0.84964509  -0.87702332]
mat_Sqrt:  [[18.05663154  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0087518   0.04559646 -0.11323423]
Stock Position:  0.008751800997906928
Bond Position:  [-6.18863256]


portfolio before change:  [-5.3070371]
curr_Stock_Price:  100.82142910389332
curr_Factors:  [100.8214291   -0.8670208   -0.89917219]
mat_Sqrt:  [[17.23871855  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0057588  -0.02337599 -0.30370564]
Stock Position:  -0.005758802484744292
Bond Position:  [-4.72642641]


portfolio before change:  [-5.3070984]
curr_Stock_Price:  100.7294755214414
curr_Factors:  [100.72947552  -0.4765897   -0.87502444]
mat_Sqrt:  [[26.07101931  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00311337 -0.01687337 -0.11843294]
Stock Position:  -0.0031133694904327508
Bond Position:  [-4.99349033]


portfolio before change:  [-5.30351423]
curr_Stock_Price:  99.37775701130805
curr_Factors:  [99.37775701 -0.30284328 -0.87076085]
mat_Sqrt:  [[30.73260626  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00216182  0.02011509  0.30099893]
Stock Position:  -0.0021618241978727704
Bond Position:  [-5.08867699]


portfolio before change:  [-5.30489588]
curr_Stock_Price:  99.72261839965498
curr_Factors:  [99.7226184  -0.26545828 -0.87762256]
mat_Sqrt:  [[31.79508363  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00244745 0.01538155 0.13665038]
Stock Position:  0.0024474460255092018
Bond Position:  [-5.54896161]


portfolio before change:  [-5.30351772]
curr_Stock_Price:  100.56914220445518
curr_Factors:  [100.5691422   -0.36909934  -0.87414551]
mat_Sqrt:  [[29.0088405   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00679261 -0.01523375 -0.03316784]
Stock Position:  0.006792606141242753
Bond Position:  [-5.9866443]


portfolio before change:  [-5.31448217]
curr_Stock_Price:  99.06514385348255
curr_Factors:  [99.06514385 -0.36681704 -0.90490674]
mat_Sqrt:  [[27.77270964  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00122678 -0.0084459   0.00606348]
Stock Position:  -0.0012267805296091697
Bond Position:  [-5.19295098]


portfolio before change:  [-5.31584464]
curr_Stock_Price:  99.64659386753472
curr_Factors:  [ 9.96465939e+01 -5.72013184e-02 -9.01810379e-01]
mat_Sqrt:  [[38.19169822  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00179164 -0.01308541  0.1958103 ]
Stock Position:  0.0017916402242035224
Bond Position:  [-5.49437549]


portfolio before change:  [-5.31781229]
curr_Stock_Price:  98.93171537750048
curr_Factors:  [ 9.89317154e+01 -7.48023377e-02 -9.11475041e-01]
mat_Sqrt:  [[36.89782071  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-1.85301948e-04  5.13409508e-02  1.21049401e+00]
Stock Position:  -0.0001853019477190902
Bond Position:  [-5.29948005]


portfolio before change:  [-5.31874417]
curr_Stock_Price:  100.38557797091268
curr_Factors:  [100.38557797  -0.25472611  -0.89211371]
mat_Sqrt:  [[31.88637277  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00284444 -0.0110051  -0.16394186]
Stock Position:  0.0028444428999674066
Bond Position:  [-5.60428521]


portfolio before change:  [-5.31192467]
curr_Stock_Price:  103.02935665363928
curr_Factors:  [103.02935665  -0.60038226  -0.90450183]
mat_Sqrt:  [[22.87695037  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00392791 0.00990784 0.24705654]
Stock Position:  0.003927913980028125
Bond Position:  [-5.71661512]


portfolio before change:  [-5.31082387]
curr_Stock_Price:  103.49154026842261
curr_Factors:  [103.49154027  -0.80199961  -0.90771088]
mat_Sqrt:  [[18.72349931  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00572909 0.00060661 0.16453672]
Stock Position:  0.005729088046872421
Bond Position:  [-5.90373602]


portfolio before change:  [-5.30684768]
curr_Stock_Price:  104.3143948358704
curr_Factors:  [104.31439484  -0.66006245  -0.89965009]
mat_Sqrt:  [[21.92651932  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0056195   0.02302535  0.24493509]
Stock Position:  -0.005619497492990056
Bond Position:  [-4.7206532]


portfolio before change:  [-5.32211178]
curr_Stock_Price:  106.92565753795111
curr_Factors:  [106.92565754  -0.81783857  -0.88729617]
mat_Sqrt:  [[19.43351314  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00220675  0.02328151  0.08378082]
Stock Position:  -0.0022067452081075043
Bond Position:  [-5.0861541]


portfolio before change:  [-5.32603128]
curr_Stock_Price:  108.41367994083559
curr_Factors:  [108.41367994  -0.78498045  -0.86958173]
mat_Sqrt:  [[20.72606526  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00346703 -0.00783459  0.28182285]
Stock Position:  0.0034670310073555534
Bond Position:  [-5.70190487]


portfolio before change:  [-5.32112904]
curr_Stock_Price:  110.03322811710551
curr_Factors:  [110.03322812  -0.69742805  -0.87722289]
mat_Sqrt:  [[22.78566155  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0056673  -0.06670465  0.11059025]
Stock Position:  -0.0056672982293520715
Bond Position:  [-4.69753792]


portfolio before change:  [-5.32030909]
curr_Stock_Price:  109.78493154257772
curr_Factors:  [109.78493154  -0.55502618  -0.88099102]
mat_Sqrt:  [[26.11490134  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00655561  0.25868745 -0.10795141]
Stock Position:  -0.006555612262514986
Bond Position:  [-4.60060165]


portfolio before change:  [-5.31197966]
curr_Stock_Price:  108.42662318860307
curr_Factors:  [108.42662319  -0.40250938  -0.88554083]
mat_Sqrt:  [[29.90493305  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00331217 0.03306293 0.5867958 ]
Stock Position:  0.00331216819120485
Bond Position:  [-5.67110687]


portfolio before change:  [-5.32171532]
curr_Stock_Price:  105.70130133110764
curr_Factors:  [ 1.05701301e+02 -8.36072546e-02 -8.57075434e-01]
mat_Sqrt:  [[41.26169202  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00186223  0.00864973  0.24343797]
Stock Position:  -0.0018622345744017685
Bond Position:  [-5.1248747]


portfolio before change:  [-5.32263776]
curr_Stock_Price:  105.85261804145595
curr_Factors:  [ 1.05852618e+02  6.87883438e-03 -8.59901645e-01]
mat_Sqrt:  [[45.10643502  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00323636 -0.01818489  0.02666201]
Stock Position:  -0.0032363637577708148
Bond Position:  [-4.98006018]


portfolio before change:  [-5.31312383]
curr_Stock_Price:  102.72056315129517
curr_Factors:  [ 1.02720563e+02 -1.02635362e-01 -8.39767440e-01]
mat_Sqrt:  [[40.02921329  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00464083  0.066353    0.07978129]
Stock Position:  -0.0046408281123790675
Bond Position:  [-4.83641536]


portfolio before change:  [-5.29941826]
curr_Stock_Price:  99.6370268944444
curr_Factors:  [99.63702689 -0.27597903 -0.84740286]
mat_Sqrt:  [[32.39979051  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00309561 -0.04640841 -0.33277311]
Stock Position:  0.0030956129666424147
Bond Position:  [-5.60785593]


portfolio before change:  [-5.29562708]
curr_Stock_Price:  101.08818030888581
curr_Factors:  [101.08818031  -0.28886409  -0.87150602]
mat_Sqrt:  [[31.67802122  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00313238 -0.05329611 -0.07398024]
Stock Position:  -0.003132378151197807
Bond Position:  [-4.97898067]


portfolio before change:  [-5.2847757]
curr_Stock_Price:  97.42521472300018
curr_Factors:  [97.42521472 -0.15957451 -0.83500453]
mat_Sqrt:  [[36.03555229  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00088912  0.00936929 -0.15342923]
Stock Position:  -0.0008891159424172971
Bond Position:  [-5.19815338]


portfolio before change:  [-5.28495896]
curr_Stock_Price:  96.900487836365
curr_Factors:  [ 9.69004878e+01 -3.82775266e-02 -8.58229991e-01]
mat_Sqrt:  [[39.53463156  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00316021 -0.05676181 -0.11299983]
Stock Position:  0.0031602099283911346
Bond Position:  [-5.59118485]


portfolio before change:  [-5.28754821]
curr_Stock_Price:  96.30232988948126
curr_Factors:  [96.30232989  0.15650966 -0.82625956]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-5.28754821]
Stock Price:  98.24492175372373
PL:  [-5.28754821]
Settle:  Tensor("sub_334:0", shape=(), dtype=float64)
PL:  Tensor("sub_335:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  168
output_Z_Vals[:, i, :]:  [[ 1.19260232e+02 -2.92559343e+01 -2.92733494e+01]
 [ 4.52841733e-02  3.33036344e-02 -7.93145341e-02]
 [-6.17628923e-02 -7.59274408e-03  9.51765438e-02]
 [-2.81396580e-02  1.21263681e-01  1.68675055e-02]
 [-6.02276511e-02  6.91676983e-02 -7.31585558e-02]
 [ 5.57993221e-02  2.87765088e-02  3.36724528e-02]
 [ 5.46433930e-02  3.85353601e-02 -5.08901084e-02]
 [-1.97746354e-02 -1.21882186e-02 -3.95731443e-02]
 [ 8.19419924e-02 -3.50510935e-02 -9.80530517e-02]
 [-5.07445433e-02 -1.14386375e-01 -1.29908341e-01]
 [ 7.50244618e-02  9.81823304e-02 -9.02280529e-02]
 [-1.96909418e-01 -9.67983716e-02  4.07190664e-02]
 [-5.88876486e-02 -2.47365167e-02  2.87932681e-02]
 [-1.04978688e-01 -1.17893347e-01  5.70461440e-02]
 [ 2.07473983e-01  1.84696364e-01 -5.19923416e-02]
 [-7.08384668e-02 -4.80277061e-01 -5.32069971e-02]
 [-6.87458722e-02 -6.26831275e-02 -4.88592473e-02]
 [-9.89413366e-02 -2.58177048e-02  8.69813930e-02]
 [ 6.17014108e-02  5.32211288e-02  4.89082812e-02]
 [ 1.86031723e-01 -4.91099394e-02 -7.29245463e-04]
 [-5.67545096e-02  9.79706772e-03  2.10255462e-02]
 [ 3.02680592e-02 -2.63486155e-02  2.93467122e-02]
 [-1.13638904e-01  2.30663101e-01  3.44663365e-01]
 [ 1.37902441e-01 -2.11218791e-02 -6.63975425e-03]
 [ 6.71301815e-02  2.92770343e-02  8.89181798e-02]
 [ 6.24139166e-02 -3.54784602e-02  6.82978386e-02]
 [-1.82049156e-01  6.86534662e-02  6.85384804e-02]
 [-5.07806065e-02  7.36225950e-02  2.93687317e-02]
 [ 1.15917791e-02 -7.39497447e-02 -2.20996854e-01]
 [ 8.22458058e-03 -7.78944931e-03 -1.17498690e-01]
 [ 1.27582969e-03  2.17084230e-01  1.01709886e-02]
 [ 3.08462028e-02 -9.28047522e-02 -7.72627371e-02]
 [ 2.91624176e-01 -1.28749828e-01  4.02381707e-02]
 [-4.09109872e-02 -7.65776552e-02  1.75090622e-02]
 [-2.08593788e-01  1.21857729e-01  1.61941817e-02]
 [ 1.78073119e-01 -6.51579954e-02 -3.42114405e-02]
 [ 2.80994777e-02  4.11588357e-02 -1.03468674e-01]
 [-1.39957716e-02  3.58347418e-02 -5.12310620e-02]
 [ 2.73766667e-01 -3.45530618e-01 -8.09247067e-02]
 [-2.95145619e-01  1.83350875e-01  1.45332022e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.26023247 -29.25593426 -29.27334937]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  8.31486419  -9.25153874 -83.50871763]
init_Out:  [2.49911038]
Stock Position:  8.31486419409362
Bond position:  [-828.98730903]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-1.28108491]
curr_Stock_Price:  99.5578321769869
curr_Factors:  [99.55783218 -1.09988576 -0.98222528]
mat_Sqrt:  [[12.41155214  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0024134   0.01053153 -0.22626229]
Stock Position:  0.0024134014549642116
Bond Position:  [-1.52135793]


portfolio before change:  [-1.28296896]
curr_Stock_Price:  98.85597042306439
curr_Factors:  [98.85597042 -0.89422332 -0.98543578]
mat_Sqrt:  [[15.08958614  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00281857 -0.00240104  0.27151219]
Stock Position:  -0.002818573359535434
Bond Position:  [-1.00433616]


portfolio before change:  [-1.28448367]
curr_Stock_Price:  99.34882940182783
curr_Factors:  [99.3488294  -0.82248886 -1.01221523]
mat_Sqrt:  [[15.86210754  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00135957  0.03834694  0.0481183 ]
Stock Position:  -0.0013595657426705764
Bond Position:  [-1.14941241]


portfolio before change:  [-1.28193434]
curr_Stock_Price:  97.3680344735824
curr_Factors:  [97.36803447 -0.68203656 -1.01962392]
mat_Sqrt:  [[17.75802423  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00413194  0.02187275 -0.208701  ]
Stock Position:  -0.0041319448334863566
Bond Position:  [-0.87961499]


portfolio before change:  [-1.28381656]
curr_Stock_Price:  97.7969509904376
curr_Factors:  [97.79695099 -0.81169925 -0.99993608]
mat_Sqrt:  [[15.97872361  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00396876 0.00909993 0.09605814]
Stock Position:  0.003968758115481237
Bond Position:  [-1.671949]


portfolio before change:  [-1.28443512]
curr_Stock_Price:  97.69375622222529
curr_Factors:  [97.69375622 -0.77968249 -1.00053441]
mat_Sqrt:  [[16.47132102  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00274723  0.01218595 -0.14517531]
Stock Position:  0.002747227847410407
Bond Position:  [-1.55282213]


portfolio before change:  [-1.28704472]
curr_Stock_Price:  96.81451170721485
curr_Factors:  [96.81451171 -0.94922513 -0.96766222]
mat_Sqrt:  [[14.23793014  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00197832 -0.00385425 -0.11289117]
Stock Position:  -0.0019783190235772683
Bond Position:  [-1.09551473]


portfolio before change:  [-1.28834389]
curr_Stock_Price:  97.40199046135203
curr_Factors:  [97.40199046 -0.88492574 -0.98090709]
mat_Sqrt:  [[15.07463924  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00404799 -0.01108413 -0.27971806]
Stock Position:  0.004047989522499485
Bond Position:  [-1.68262612]


portfolio before change:  [-1.28451642]
curr_Stock_Price:  98.39947637586046
curr_Factors:  [98.39947638 -0.76505453 -0.99807162]
mat_Sqrt:  [[16.87628418  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00475314 -0.03617215 -0.37059234]
Stock Position:  -0.004753144415248715
Bond Position:  [-0.81680949]


portfolio before change:  [-1.28280804]
curr_Stock_Price:  98.0185737747516
curr_Factors:  [98.01857377 -0.70063109 -0.98648037]
mat_Sqrt:  [[18.13865918  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00326054  0.03104798 -0.25739552]
Stock Position:  0.0032605383839369967
Bond Position:  [-1.60240136]


portfolio before change:  [-1.28575423]
curr_Stock_Price:  97.1764174710472
curr_Factors:  [97.17641747 -0.65922503 -0.989477  ]
mat_Sqrt:  [[18.68696143  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01022622 -0.03061033  0.11616016]
Stock Position:  -0.01022622094776553
Bond Position:  [-0.29200672]


portfolio before change:  [-1.28044292]
curr_Stock_Price:  96.65346581846615
curr_Factors:  [96.65346582 -0.71590954 -0.97851426]
mat_Sqrt:  [[17.75572966  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0030215  -0.00782237  0.08213918]
Stock Position:  -0.003021500242817953
Bond Position:  [-0.98840445]


portfolio before change:  [-1.27841638]
curr_Stock_Price:  95.94186814727236
curr_Factors:  [95.94186815 -0.64930625 -0.9584854 ]
mat_Sqrt:  [[19.21998866  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00501448 -0.03728115  0.16273677]
Stock Position:  -0.005014476706441585
Bond Position:  [-0.79731812]


portfolio before change:  [-1.2843849]
curr_Stock_Price:  97.11224864677828
curr_Factors:  [97.11224865 -0.27570129 -0.97658415]
mat_Sqrt:  [[27.75960967  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00726343  0.05840612 -0.14831968]
Stock Position:  0.007263428145520969
Bond Position:  [-1.98975274]


portfolio before change:  [-1.28141034]
curr_Stock_Price:  97.55601857200598
curr_Factors:  [97.55601857 -0.16578489 -0.99695589]
mat_Sqrt:  [[30.49875844  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00308537 -0.15187694 -0.15178475]
Stock Position:  -0.0030853714969667537
Bond Position:  [-0.98041378]


portfolio before change:  [-1.28889444]
curr_Stock_Price:  99.94196594070196
curr_Factors:  [99.94196594 -0.41801639 -1.00763597]
mat_Sqrt:  [[24.02121315  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00334445 -0.01982215 -0.13938183]
Stock Position:  -0.0033444478925323587
Bond Position:  [-0.95464374]


portfolio before change:  [-1.28933352]
curr_Stock_Price:  100.03757018512238
curr_Factors:  [100.03757019  -0.31898317  -0.99189978]
mat_Sqrt:  [[26.96832073  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00303515 -0.00816428  0.2481337 ]
Stock Position:  -0.0030351516940185885
Bond Position:  [-0.98570432]


portfolio before change:  [-1.28986343]
curr_Stock_Price:  100.17156453614427
curr_Factors:  [100.17156454  -0.4546676   -0.95140115]
mat_Sqrt:  [[24.55254734  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00297562 0.01683    0.13952171]
Stock Position:  0.002975615299950721
Bond Position:  [-1.58793547]


portfolio before change:  [-1.2889643]
curr_Stock_Price:  100.54044161365637
curr_Factors:  [100.54044161  -0.64719316  -0.96529652]
mat_Sqrt:  [[20.04681663  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00920919 -0.01552993 -0.00208033]
Stock Position:  0.009209185516353066
Bond Position:  [-2.21485988]


portfolio before change:  [-1.28238009]
curr_Stock_Price:  101.28546787594766
curr_Factors:  [101.28546788  -0.5141945   -0.953217  ]
mat_Sqrt:  [[23.34846972  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00223611  0.0030981   0.05998003]
Stock Position:  -0.002236109236198382
Bond Position:  [-1.05589472]


portfolio before change:  [-1.28367764]
curr_Stock_Price:  101.80670885779537
curr_Factors:  [101.80670886  -0.54641056  -0.96769152]
mat_Sqrt:  [[22.39805032  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00158845 -0.00833216  0.083718  ]
Stock Position:  0.0015884468924229136
Bond Position:  [-1.44539219]


portfolio before change:  [-1.28228587]
curr_Stock_Price:  102.79664034981538
curr_Factors:  [102.79664035  -0.50499527  -0.96525957]
mat_Sqrt:  [[23.62954497  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00157976  0.07294208  0.98322865]
Stock Position:  -0.001579763544163311
Bond Position:  [-1.11989148]


portfolio before change:  [-1.28330148]
curr_Stock_Price:  103.35091019873438
curr_Factors:  [103.3509102   -0.49466244  -0.97472265]
mat_Sqrt:  [[23.77762485  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00571974 -0.00667932 -0.01894137]
Stock Position:  0.0057197362409005005
Bond Position:  [-1.87444143]


portfolio before change:  [-1.28744769]
curr_Stock_Price:  102.66698208908726
curr_Factors:  [102.66698209  -0.3306436   -0.95618862]
mat_Sqrt:  [[28.35088804  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.0030347  0.00925821 0.25365882]
Stock Position:  0.003034700661577134
Bond Position:  [-1.59901125]


portfolio before change:  [-1.29007579]
curr_Stock_Price:  101.86683295830763
curr_Factors:  [101.86683296  -0.46884714  -0.96265982]
mat_Sqrt:  [[24.34093359  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00309927 -0.01121927  0.19483472]
Stock Position:  0.003099269153842481
Bond Position:  [-1.60578852]


portfolio before change:  [-1.2899374]
curr_Stock_Price:  101.97625363867557
curr_Factors:  [101.97625364  -0.39123261  -0.95635401]
mat_Sqrt:  [[26.50022856  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0062749   0.02171013  0.19552121]
Stock Position:  -0.006274895792068499
Bond Position:  [-0.65004704]


portfolio before change:  [-1.28445496]
curr_Stock_Price:  101.08959265918999
curr_Factors:  [101.08959266  -0.20082168  -0.92990004]
mat_Sqrt:  [[32.6317406   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00131421  0.02328151  0.08378082]
Stock Position:  -0.001314205470570024
Bond Position:  [-1.15160246]


portfolio before change:  [-1.28459859]
curr_Stock_Price:  101.08934349127318
curr_Factors:  [101.08934349  -0.25630791  -0.92196056]
mat_Sqrt:  [[31.11643815  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00113857 -0.02338496 -0.63044251]
Stock Position:  -0.0011385746943307663
Bond Position:  [-1.16950082]


portfolio before change:  [-1.28534292]
curr_Stock_Price:  101.61468278844231
curr_Factors:  [101.61468279  -0.23471104  -0.89582168]
mat_Sqrt:  [[32.80744001  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0004865  -0.00246324 -0.33519106]
Stock Position:  -0.00048650128583969325
Bond Position:  [-1.23590725]


portfolio before change:  [-1.28449428]
curr_Stock_Price:  99.55274128106296
curr_Factors:  [99.55274128 -0.19669611 -0.87375655]
mat_Sqrt:  [[34.13198468  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00026242 0.06864806 0.029015  ]
Stock Position:  0.0002624243758598002
Bond Position:  [-1.31061935]


portfolio before change:  [-1.28517524]
curr_Stock_Price:  97.58218373894032
curr_Factors:  [97.58218374 -0.17809148 -0.88434247]
mat_Sqrt:  [[33.72572784  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00037594 -0.02934744 -0.22040908]
Stock Position:  0.00037593863783185887
Bond Position:  [-1.32186016]


portfolio before change:  [-1.28671949]
curr_Stock_Price:  93.91403790302489
curr_Factors:  [93.9140379  -0.20093877 -0.90346954]
mat_Sqrt:  [[31.12376144  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00952692 -0.04071427  0.1147883 ]
Stock Position:  0.00952691572248505
Bond Position:  [-2.18143061]


portfolio before change:  [-1.28049308]
curr_Stock_Price:  94.59622064391384
curr_Factors:  [94.59622064 -0.40766762 -0.90000901]
mat_Sqrt:  [[25.58332817  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00153671 -0.02421598  0.04994848]
Stock Position:  -0.0015367113736622978
Bond Position:  [-1.135126]


portfolio before change:  [-1.28123594]
curr_Stock_Price:  94.98728730650201
curr_Factors:  [94.98728731 -0.16274108 -0.90645983]
mat_Sqrt:  [[32.60749463  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00619924  0.0385348   0.04619749]
Stock Position:  -0.006199243869922972
Bond Position:  [-0.69238658]


portfolio before change:  [-1.28978921]
curr_Stock_Price:  96.35305319020198
curr_Factors:  [96.35305319 -0.25230083 -0.94389938]
mat_Sqrt:  [[29.13146523  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00581527 -0.02060477 -0.09759572]
Stock Position:  0.005815271019756543
Bond Position:  [-1.85010833]


portfolio before change:  [-1.29387522]
curr_Stock_Price:  95.69018998511993
curr_Factors:  [95.69018999 -0.14868076 -0.97062883]
mat_Sqrt:  [[31.2433387   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 2.57390533e-04  1.30155667e-02 -2.95167328e-01]
Stock Position:  0.0002573905326436823
Bond Position:  [-1.31850497]


portfolio before change:  [-1.29401804]
curr_Stock_Price:  95.77565353902885
curr_Factors:  [95.77565354 -0.26073201 -0.95719145]
mat_Sqrt:  [[28.33463919  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00083036  0.01133194 -0.14614796]
Stock Position:  -0.0008303624083234583
Bond Position:  [-1.21448954]


portfolio before change:  [-1.29236401]
curr_Stock_Price:  93.60087182584817
curr_Factors:  [93.60087183 -0.15713048 -0.94493205]
mat_Sqrt:  [[31.09282782  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00798661 -0.10926638 -0.23085566]
Stock Position:  0.007986614129176077
Bond Position:  [-2.03991805]


portfolio before change:  [-1.3060085]
curr_Stock_Price:  91.9243804247149
curr_Factors:  [91.92438042 -0.11641221 -0.91732925]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-1.3060085]
Stock Price:  90.10754782779783
PL:  [-1.3060085]
Settle:  Tensor("sub_336:0", shape=(), dtype=float64)
PL:  Tensor("sub_337:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  169
output_Z_Vals[:, i, :]:  [[ 1.19260232e+02 -2.92559343e+01 -2.92733494e+01]
 [-4.52905196e-02  7.19647811e-02 -3.26369341e-04]
 [ 3.32274047e-02  2.37570884e-02 -2.88390692e-02]
 [ 8.36726712e-02  1.58541236e-01  3.77992789e-02]
 [ 2.24162924e-01 -2.32291996e-02 -4.52364007e-02]
 [ 7.60223171e-02  3.26122368e-02 -2.28323181e-02]
 [ 2.96652403e-02  5.52252374e-02 -2.70925084e-02]
 [ 5.75703508e-02  1.47613385e-01  9.00459178e-02]
 [-1.06702045e-01 -1.37321034e-02  1.01684865e-01]
 [-6.58747754e-02  4.29170974e-01  2.01884339e-01]
 [ 3.35526897e-02 -7.77329132e-02 -3.73972528e-02]
 [-7.17287245e-02  9.82044271e-02  2.07196520e-02]
 [-7.81241694e-02 -3.59784790e-02 -6.16947366e-02]
 [ 1.57486802e-01  1.51142504e-01  2.41271377e-01]
 [ 2.16069487e-01  3.02883987e-01  7.11733303e-02]
 [-7.34293580e-02 -6.09490839e-02 -1.01933014e-01]
 [-7.30999720e-02 -5.26128678e-02 -5.63143854e-02]
 [-8.06267784e-02  1.49862664e-01  1.23386666e-01]
 [ 1.35306672e-01  7.14026052e-02  1.62869511e-01]
 [ 1.23807379e-01 -4.23331944e-02  3.67532639e-02]
 [-4.01961650e-02 -1.08429349e-02 -2.76593354e-02]
 [ 8.03012183e-02 -6.09029658e-02  7.80837619e-02]
 [-5.92456750e-02  4.00186605e-02  2.51460123e-01]
 [-6.02544009e-02 -7.64261340e-04 -8.44390389e-02]
 [-1.71353295e-01  8.27609842e-02  6.83463791e-02]
 [-3.61451978e-02 -1.45923806e-01  9.98582030e-02]
 [ 2.32599476e-01  3.98456841e-02 -1.30883411e-01]
 [ 1.33492789e-02  2.14459658e-02  1.59077625e-02]
 [-1.00682670e-01 -9.80538778e-02 -1.69203004e-01]
 [ 9.85052068e-03 -1.21347772e-02 -1.22656336e-01]
 [ 3.82590995e-02  3.04063001e-02  1.57235404e-02]
 [ 3.95525478e-02 -8.18725270e-02 -8.56933676e-02]
 [ 2.39807862e-01 -2.01765411e-01 -1.10844763e-01]
 [-4.71976745e-02 -8.27150998e-02  2.14401630e-04]
 [-1.88282067e-01  9.93724533e-02  2.06257685e-02]
 [ 8.38579616e-02 -1.52834971e-01 -1.29416239e-01]
 [-7.42340731e-02 -1.86487901e-01 -2.21353654e-02]
 [-2.74316133e-02  7.35277642e-03 -5.00050767e-02]
 [-4.24425683e-02  6.92330103e-02  3.26501792e-03]
 [-7.32366970e-01  3.65711123e-01  4.49347244e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.26023247 -29.25593426 -29.27334937]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  8.31486419  -9.25153874 -83.50871763]
init_Out:  [2.49911038]
Stock Position:  8.31486419409362
Bond position:  [-828.98730903]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [6.98503848]
curr_Stock_Price:  100.55197028855292
curr_Factors:  [100.55197029  -0.97185255  -0.97215119]
mat_Sqrt:  [[14.39197804  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00302245  0.02275726 -0.00093104]
Stock Position:  -0.0030224488058945643
Bond Position:  [7.28895166]


portfolio before change:  [6.98451299]
curr_Stock_Price:  101.02730113818754
curr_Factors:  [101.02730114  -0.91259228  -0.97320174]
mat_Sqrt:  [[15.32670565  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00182388  0.00751265 -0.08226984]
Stock Position:  0.00182387920803653
Bond Position:  [6.8002514]


portfolio before change:  [6.98617042]
curr_Stock_Price:  101.46995272065055
curr_Factors:  [101.46995272  -1.02449147  -0.98493761]
mat_Sqrt:  [[13.60358886  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00701888 0.05013514 0.10783082]
Stock Position:  0.007018878243057813
Bond Position:  [6.27396518]


portfolio before change:  [6.98517981]
curr_Stock_Price:  101.21707650844519
curr_Factors:  [101.21707651  -1.20061367  -0.99605719]
mat_Sqrt:  [[11.25257087  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01904714 -0.00734572 -0.12904686]
Stock Position:  0.01904714129218463
Bond Position:  [5.05728385]


portfolio before change:  [6.98214597]
curr_Stock_Price:  101.02460495758314
curr_Factors:  [101.02460496  -1.24180629  -0.94464589]
mat_Sqrt:  [[11.34652944  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00636351  0.01031289 -0.06513425]
Stock Position:  0.006363508283111516
Bond Position:  [6.33927506]


portfolio before change:  [6.98396844]
curr_Stock_Price:  101.18646627451226
curr_Factors:  [101.18646627  -1.2267466   -0.94753388]
mat_Sqrt:  [[11.50388185  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00222194  0.01746375 -0.07728739]
Stock Position:  0.0022219382152149857
Bond Position:  [6.75913836]


portfolio before change:  [6.98604669]
curr_Stock_Price:  101.74152548399385
curr_Factors:  [101.74152548  -1.25238461  -0.95274668]
mat_Sqrt:  [[11.21558403  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00711173 0.04667945 0.25687594]
Stock Position:  0.007111734690447575
Bond Position:  [6.26248795]


portfolio before change:  [6.98979265]
curr_Stock_Price:  102.15817458309978
curr_Factors:  [102.15817458  -1.25876068  -0.9786922 ]
mat_Sqrt:  [[10.90334331  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00791503 -0.00434247  0.29007862]
Stock Position:  -0.007915028266845942
Bond Position:  [7.79837749]


portfolio before change:  [6.98704271]
curr_Stock_Price:  102.62877269992144
curr_Factors:  [102.6287727   -1.62479221  -0.9618976 ]
mat_Sqrt:  [[ 7.7247428   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00175853  0.13571578  0.57591983]
Stock Position:  -0.00175852590687929
Bond Position:  [7.16751806]


portfolio before change:  [6.98715315]
curr_Stock_Price:  103.07548655881814
curr_Factors:  [103.07548656  -1.49530146  -0.98372854]
mat_Sqrt:  [[ 8.64025068  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00276751 -0.02458131 -0.10668395]
Stock Position:  0.0027675067673136084
Bond Position:  [6.70189104]


portfolio before change:  [6.98590394]
curr_Stock_Price:  102.3213798756856
curr_Factors:  [102.32137988  -1.21684808  -0.96647137]
mat_Sqrt:  [[11.5282345   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00563518  0.03105497  0.0591074 ]
Stock Position:  -0.005635183409413335
Bond Position:  [7.56250368]


portfolio before change:  [6.98648271]
curr_Stock_Price:  102.38643501999945
curr_Factors:  [102.38643502  -1.11417275  -0.94104058]
mat_Sqrt:  [[13.11217132  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00698942 -0.01137739 -0.17599791]
Stock Position:  -0.006989423253862755
Bond Position:  [7.70210484]


portfolio before change:  [6.98913596]
curr_Stock_Price:  102.14458094856712
curr_Factors:  [102.14458095  -1.26247211  -0.95759663]
mat_Sqrt:  [[11.09306929  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01898831 0.04779546 0.68828008]
Stock Position:  0.01898830639786859
Bond Position:  [5.04958336]


portfolio before change:  [6.97656091]
curr_Stock_Price:  101.44908501976288
curr_Factors:  [101.44908502  -1.2077264   -0.95170047]
mat_Sqrt:  [[11.70633535  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.02036659 0.09578033 0.2030377 ]
Stock Position:  0.020366588352970318
Bond Position:  [4.91038915]


portfolio before change:  [6.96422438]
curr_Stock_Price:  100.81322183746742
curr_Factors:  [100.81322184  -1.33768894  -0.9567184 ]
mat_Sqrt:  [[10.16410275  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00942632 -0.01927379 -0.29078652]
Stock Position:  -0.009426316149985164
Bond Position:  [7.91452168]


portfolio before change:  [6.96644177]
curr_Stock_Price:  100.68294659237577
curr_Factors:  [100.68294659  -1.27458257  -0.90915831]
mat_Sqrt:  [[11.33885765  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00758044 -0.01663765 -0.16064927]
Stock Position:  -0.007580442299958403
Bond Position:  [7.72966304]


portfolio before change:  [6.97314015]
curr_Stock_Price:  99.92677508933342
curr_Factors:  [99.92677509 -1.20646972 -0.94554931]
mat_Sqrt:  [[11.61640869  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00443951  0.04739074  0.35198781]
Stock Position:  -0.0044395083501484744
Bond Position:  [7.41676591]


portfolio before change:  [6.97525704]
curr_Stock_Price:  99.65878835282767
curr_Factors:  [99.65878835 -1.38941231 -0.92955013]
mat_Sqrt:  [[ 9.80399348  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01738025 0.02257949 0.46462138]
Stock Position:  0.01738025220618666
Bond Position:  [5.24316216]


portfolio before change:  [6.98136369]
curr_Stock_Price:  99.97243245874246
curr_Factors:  [99.97243246 -1.29590969 -0.90287541]
mat_Sqrt:  [[11.09072715  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01174103 -0.01338693  0.10484683]
Stock Position:  0.011741030817823243
Bond Position:  [5.80758428]


portfolio before change:  [6.99046062]
curr_Stock_Price:  100.68539734492887
curr_Factors:  [100.68539734  -1.16040984  -0.87432188]
mat_Sqrt:  [[13.16114666  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00350441 -0.00342884 -0.07890438]
Stock Position:  -0.003504410955922212
Bond Position:  [7.34330363]


portfolio before change:  [6.99121415]
curr_Stock_Price:  100.7323208791257
curr_Factors:  [100.73232088  -0.96832744  -0.88930819]
mat_Sqrt:  [[15.71838543  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00602272 -0.01925921  0.22275124]
Stock Position:  0.006022723648552558
Bond Position:  [6.38453122]


portfolio before change:  [6.99350215]
curr_Stock_Price:  100.97969735110712
curr_Factors:  [100.97969735  -0.99106586  -0.88849468]
mat_Sqrt:  [[15.41527563  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-4.46525584e-04  1.26550116e-02  7.17345738e-01]
Stock Position:  -0.0004465255839329902
Bond Position:  [7.03859217]


portfolio before change:  [6.99487257]
curr_Stock_Price:  99.88111871685452
curr_Factors:  [99.88111872 -0.94809764 -0.87647868]
mat_Sqrt:  [[16.10942241  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00481148 -0.00024168 -0.24088107]
Stock Position:  -0.004811481049115564
Bond Position:  [7.47544868]


portfolio before change:  [6.99779922]
curr_Stock_Price:  99.46707660919854
curr_Factors:  [99.46707661 -0.68019762 -0.8677268 ]
mat_Sqrt:  [[21.1555499   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00733922  0.02617132  0.1949732 ]
Stock Position:  -0.007339221626462273
Bond Position:  [7.72781014]


portfolio before change:  [7.00430937]
curr_Stock_Price:  98.71166804313687
curr_Factors:  [98.71166804 -0.83216463 -0.8692033 ]
mat_Sqrt:  [[18.00834423  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00108447 -0.04614516  0.28486766]
Stock Position:  -0.0010844674928178035
Bond Position:  [7.11135896]


portfolio before change:  [7.00602101]
curr_Stock_Price:  97.95307275863296
curr_Factors:  [97.95307276 -0.65034288 -0.84741289]
mat_Sqrt:  [[21.90539033  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0094457   0.01260031 -0.37337394]
Stock Position:  0.009445703527853018
Bond Position:  [6.08078533]


portfolio before change:  [6.99414869]
curr_Stock_Price:  96.61569531540287
curr_Factors:  [96.61569532 -0.84019565 -0.83628713]
mat_Sqrt:  [[18.07009617  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00094909 0.00678181 0.04538042]
Stock Position:  0.0009490912286203333
Bond Position:  [6.90245158]


portfolio before change:  [6.99658679]
curr_Stock_Price:  98.27542937652069
curr_Factors:  [98.27542938 -0.86127545 -0.83390945]
mat_Sqrt:  [[18.0399572   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00763598 -0.03100736 -0.48268907]
Stock Position:  -0.0076359842328106355
Bond Position:  [7.74701642]


portfolio before change:  [6.99683959]
curr_Stock_Price:  98.36914782463352
curr_Factors:  [98.36914782 -0.9718957  -0.81333209]
mat_Sqrt:  [[16.50229443  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00093926 -0.00383735 -0.34990438]
Stock Position:  -0.0009392583351229146
Bond Position:  [7.08923364]


portfolio before change:  [6.99792258]
curr_Stock_Price:  98.15964849919254
curr_Factors:  [98.1596485  -0.9390503  -0.83116761]
mat_Sqrt:  [[16.71618322  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00252771 0.00961532 0.04485488]
Stock Position:  0.0025277146352858356
Bond Position:  [6.749803]


portfolio before change:  [6.99994294]
curr_Stock_Price:  98.62512191458706
curr_Factors:  [98.62512191 -0.95567436 -0.82505949]
mat_Sqrt:  [[16.61975701  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00120017 -0.02589037 -0.24445933]
Stock Position:  0.0012001693397136104
Bond Position:  [6.88157609]


portfolio before change:  [7.00067294]
curr_Stock_Price:  98.51659842240406
curr_Factors:  [98.51659842 -0.94573178 -0.85527884]
mat_Sqrt:  [[16.26823488  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01302982 -0.06380383 -0.31620925]
Stock Position:  0.013029822232608306
Bond Position:  [5.71701918]


portfolio before change:  [6.99277412]
curr_Stock_Price:  97.85553872341966
curr_Factors:  [97.85553872 -0.96098763 -0.85375137]
mat_Sqrt:  [[15.93875081  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00309244 -0.02615681  0.00061163]
Stock Position:  -0.0030924383764151593
Bond Position:  [7.29538635]


portfolio before change:  [6.99326706]
curr_Stock_Price:  97.99104583514361
curr_Factors:  [97.99104584 -0.81323062 -0.84294745]
mat_Sqrt:  [[18.70326359  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00970451  0.03142433  0.05883958]
Stock Position:  -0.009704512976373902
Bond Position:  [7.94422243]


portfolio before change:  [6.98078996]
curr_Stock_Price:  99.37907882828655
curr_Factors:  [99.37907883 -0.76770644 -0.84539653]
mat_Sqrt:  [[19.80310299  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00270133 -0.04833066 -0.36918851]
Stock Position:  0.0027013342564840017
Bond Position:  [6.71233385]


portfolio before change:  [6.98374739]
curr_Stock_Price:  100.16325873610235
curr_Factors:  [100.16325874  -0.78941536  -0.83088852]
mat_Sqrt:  [[19.81615606  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00421714 -0.05897265 -0.06314604]
Stock Position:  -0.004217141419397628
Bond Position:  [7.40615002]


portfolio before change:  [6.98428773]
curr_Stock_Price:  100.25466847250242
curr_Factors:  [100.25466847  -0.82678041  -0.84582772]
mat_Sqrt:  [[18.82348899  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00198948  0.00232515 -0.14265057]
Stock Position:  -0.001989482875160549
Bond Position:  [7.18374267]


portfolio before change:  [6.98631702]
curr_Stock_Price:  99.68604193515904
curr_Factors:  [99.68604194 -0.68751629 -0.85146446]
mat_Sqrt:  [[21.39259685  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00186927  0.0218934   0.00931419]
Stock Position:  -0.0018692686530728576
Bond Position:  [7.17265702]


portfolio before change:  [6.98724682]
curr_Stock_Price:  99.6683027036217
curr_Factors:  [99.6683027  -0.58728944 -0.84506248]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [6.98724682]
Stock Price:  98.85693243218076
PL:  [6.98724682]
Settle:  Tensor("sub_338:0", shape=(), dtype=float64)
PL:  Tensor("sub_339:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  170
output_Z_Vals[:, i, :]:  [[ 1.19260232e+02 -2.92559343e+01 -2.92733494e+01]
 [-1.11868644e-01  2.91630901e-01  4.34292477e-02]
 [ 1.12735863e-01  5.74989470e-02 -7.19748828e-02]
 [ 8.60318595e-02  1.79993405e-01  3.80858781e-02]
 [ 2.40010636e-01 -1.07502837e-02 -2.13386502e-02]
 [ 6.17034423e-02  3.59110990e-02 -3.29384520e-03]
 [-4.05698088e-02  4.29244069e-02 -1.61538335e-01]
 [ 1.56589841e-01 -4.94785747e-02  1.02406705e-01]
 [-1.33400194e-01 -3.73953151e-02  1.10469931e-01]
 [-5.93090018e-02  2.08650180e-01  6.70888522e-02]
 [ 5.60908064e-02  7.53340365e-02 -7.91117096e-02]
 [-3.64994712e-02  5.22526902e-02 -4.09817765e-03]
 [-1.05268475e-01  3.60169765e-02 -5.01576103e-02]
 [-5.47027355e-02 -2.93147748e-02  1.01838165e-01]
 [ 2.40147506e-01  3.43557641e-01  8.61942205e-02]
 [-7.42388479e-02 -8.88985584e-02 -1.15626547e-01]
 [-7.53042860e-02 -4.23459970e-02 -6.94539877e-02]
 [-4.84975828e-02  1.40764373e-02  4.93715014e-02]
 [ 6.32184731e-02  7.26168705e-02  8.07691776e-02]
 [ 2.63196317e-01 -6.68473106e-02 -2.79775852e-02]
 [-5.27410209e-02  3.62261030e-03 -4.83167779e-02]
 [ 7.97397161e-02 -6.05151761e-02  7.75368053e-02]
 [-5.36594409e-02  2.43069307e-02  2.08087406e-01]
 [ 1.46892338e-02 -8.68742944e-03 -5.99504947e-02]
 [ 9.31920965e-02  2.88909396e-02  9.64775556e-02]
 [ 4.66913212e-02 -5.31637052e-02  7.33400538e-02]
 [-1.21696591e-01  6.23166885e-02  2.26036493e-02]
 [-3.85486686e-02  6.40384613e-02  2.57601828e-02]
 [ 4.02886653e-02 -9.30591978e-02 -1.97758694e-01]
 [ 7.21706621e-03 -5.09686533e-03 -1.14302753e-01]
 [ 3.39001734e-02  1.16970691e-01  2.29683677e-02]
 [ 1.49951877e-02 -6.10929275e-02 -8.96943816e-02]
 [ 2.25552948e-01 -1.44782466e-01 -2.43273685e-02]
 [-4.85397228e-02 -8.40252886e-02 -3.47756974e-03]
 [-1.70513987e-01  6.88484278e-02  2.35106980e-02]
 [ 1.11333548e-01 -1.24055223e-01 -8.55229032e-02]
 [ 8.07149947e-03 -3.19981412e-02 -8.86952221e-02]
 [-2.37772620e-02  2.41919886e-02 -6.16168406e-02]
 [ 1.12566717e-01 -1.72235789e-01 -2.75469947e-02]
 [-7.81065064e-01  3.93128804e-01  4.73223791e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.26023247 -29.25593426 -29.27334937]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  8.31486419  -9.25153874 -83.50871763]
init_Out:  [2.49911038]
Stock Position:  8.31486419409362
Bond position:  [-828.98730903]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [9.70476654]
curr_Stock_Price:  100.87906258979619
curr_Factors:  [100.87906259  -1.28583823  -1.01301532]
mat_Sqrt:  [[10.12562003  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00942893  0.09222179  0.12389156]
Stock Position:  -0.009428934530220836
Bond Position:  [10.65594862]


portfolio before change:  [9.70068817]
curr_Stock_Price:  101.45287564725835
curr_Factors:  [101.45287565  -1.14257459  -1.0278977 ]
mat_Sqrt:  [[11.57817796  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00859623  0.01818276 -0.20532431]
Stock Position:  0.008596228861919956
Bond Position:  [8.82857604]


portfolio before change:  [9.71016353]
curr_Stock_Price:  102.4267574109665
curr_Factors:  [102.42675741  -1.36145334  -1.04526258]
mat_Sqrt:  [[ 9.22975089  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01066697 0.05691891 0.10864841]
Stock Position:  0.010666974405486845
Bond Position:  [8.61757993]


portfolio before change:  [9.71447452]
curr_Stock_Price:  102.72991092603742
curr_Factors:  [102.72991093  -1.59736931  -1.06330664]
mat_Sqrt:  [[ 7.18091898  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.03277816 -0.00339954 -0.06087323]
Stock Position:  0.03277816280812569
Bond Position:  [6.34717678]


portfolio before change:  [9.69918553]
curr_Stock_Price:  102.2392659712402
curr_Factors:  [102.23926597  -1.82708657  -1.05206143]
mat_Sqrt:  [[ 5.74406878  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01078648  0.01135609 -0.00939642]
Stock Position:  0.010786484618615791
Bond Position:  [8.59638326]


portfolio before change:  [9.7031379]
curr_Stock_Price:  102.50605899408791
curr_Factors:  [102.50605899  -1.78799244  -1.08307323]
mat_Sqrt:  [[ 5.80579314  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0124764   0.01357389 -0.46082391]
Stock Position:  -0.012476396973977573
Bond Position:  [10.98204419]


portfolio before change:  [9.70572373]
curr_Stock_Price:  102.40883650989825
curr_Factors:  [102.40883651  -1.66445512  -1.06419749]
mat_Sqrt:  [[ 6.68803692  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.02634794 -0.0156465   0.29213782]
Stock Position:  0.026347939292847282
Bond Position:  [7.00746192]


portfolio before change:  [9.68357857]
curr_Stock_Price:  101.53510023041862
curr_Factors:  [101.53510023  -1.25900411  -1.04001296]
mat_Sqrt:  [[10.18980267  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01097334 -0.01182544  0.31513996]
Stock Position:  -0.010973338767604507
Bond Position:  [10.79775762]


portfolio before change:  [9.68743865]
curr_Stock_Price:  101.30633814058875
curr_Factors:  [101.30633814  -1.38127915  -1.04075832]
mat_Sqrt:  [[ 8.98998797  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00447467  0.06598098  0.19138582]
Stock Position:  -0.004474669248363434
Bond Position:  [10.14075101]


portfolio before change:  [9.6903855]
curr_Stock_Price:  100.93107692724008
curr_Factors:  [100.93107693  -1.19987396  -1.04259526]
mat_Sqrt:  [[10.71847252  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00390796  0.02382271 -0.22568369]
Stock Position:  0.0039079554169738
Bond Position:  [9.29595135]


portfolio before change:  [9.6885201]
curr_Stock_Price:  100.15638487651378
curr_Factors:  [100.15638488  -1.14195306  -1.05506556]
mat_Sqrt:  [[11.1307794   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00323309  0.01652375 -0.01169096]
Stock Position:  -0.003233093413158458
Bond Position:  [10.01233505]


portfolio before change:  [9.68931024]
curr_Stock_Price:  100.29912303538883
curr_Factors:  [100.29912304  -1.2981035   -1.07158957]
mat_Sqrt:  [[ 9.37891316  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01221644  0.01138957 -0.1430857 ]
Stock Position:  -0.012216436824805684
Bond Position:  [10.91460814]


portfolio before change:  [9.68759446]
curr_Stock_Price:  100.55125751801569
curr_Factors:  [100.55125752  -1.22800191  -1.07497391]
mat_Sqrt:  [[10.05119771  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00344954 -0.00927015  0.29051594]
Stock Position:  -0.0034495402791683764
Bond Position:  [10.03445007]


portfolio before change:  [9.68831568]
curr_Stock_Price:  100.7058181575816
curr_Factors:  [100.70581816  -1.12048714  -1.1044952 ]
mat_Sqrt:  [[10.88321009  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.02449759 0.10864247 0.24588812]
Stock Position:  0.02449759265817141
Bond Position:  [7.22126557]


portfolio before change:  [9.71206807]
curr_Stock_Price:  101.63854928670872
curr_Factors:  [101.63854929  -1.00338997  -1.09501373]
mat_Sqrt:  [[12.46617756  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00803264 -0.02811219 -0.32985035]
Stock Position:  -0.00803264420165881
Bond Position:  [10.52849437]


portfolio before change:  [9.71686702]
curr_Stock_Price:  101.20496770030022
curr_Factors:  [101.2049677   -1.09744959  -1.07751669]
mat_Sqrt:  [[11.49809724  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00787738 -0.01339098 -0.19813289]
Stock Position:  -0.00787738083622687
Bond Position:  [10.51409709]


portfolio before change:  [9.71599344]
curr_Stock_Price:  101.48271546976035
curr_Factors:  [101.48271547  -1.05257781  -1.07469961]
mat_Sqrt:  [[12.09281005  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00314701  0.00445136  0.14084315]
Stock Position:  -0.0031470117446945178
Bond Position:  [10.03536073]


portfolio before change:  [9.71728408]
curr_Stock_Price:  101.47123014554548
curr_Factors:  [101.47123015  -1.26974146  -1.0446447 ]
mat_Sqrt:  [[10.02807991  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00813519 0.02296347 0.23041198]
Stock Position:  0.008135193648898267
Bond Position:  [8.89179597]


portfolio before change:  [9.71827128]
curr_Stock_Price:  101.4559452748767
curr_Factors:  [101.45594527  -1.18611242  -1.01731723]
mat_Sqrt:  [[11.20315034  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.02282924 -0.02113898 -0.07981226]
Stock Position:  0.02282924161036746
Bond Position:  [7.40210899]


portfolio before change:  [9.70896559]
curr_Stock_Price:  101.00779150568533
curr_Factors:  [101.00779151  -1.02484941  -1.01138887]
mat_Sqrt:  [[13.18341202  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00474157  0.00114557 -0.13783432]
Stock Position:  -0.00474157269953034
Bond Position:  [10.18790137]


portfolio before change:  [9.71093904]
curr_Stock_Price:  100.86018521058375
curr_Factors:  [100.86018521  -1.19571691  -1.01877202]
mat_Sqrt:  [[11.01487154  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00853431 -0.01913658  0.22119092]
Stock Position:  0.00853431242425728
Bond Position:  [8.85016671]


portfolio before change:  [9.71597055]
curr_Stock_Price:  101.32011280145919
curr_Factors:  [101.3201128   -1.08055885  -1.02551945]
mat_Sqrt:  [[12.33211247  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00085599  0.00768653  0.59361545]
Stock Position:  -0.000855990791555595
Bond Position:  [9.80269963]


portfolio before change:  [9.71700273]
curr_Stock_Price:  101.54584744292262
curr_Factors:  [101.54584744  -0.89714498  -1.04225444]
mat_Sqrt:  [[14.60130599  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 1.52560450e-04 -2.74720640e-03 -1.71022074e-01]
Stock Position:  0.00015256045037536313
Bond Position:  [9.70151085]


portfolio before change:  [9.71839198]
curr_Stock_Price:  102.7026446081755
curr_Factors:  [102.70264461  -0.91169924  -1.06409968]
mat_Sqrt:  [[14.23977269  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00797986 0.00913612 0.27522361]
Stock Position:  0.007979864452951806
Bond Position:  [8.8988388]


portfolio before change:  [9.71013936]
curr_Stock_Price:  101.52906013108576
curr_Factors:  [101.52906013  -1.04794882  -1.06450112]
mat_Sqrt:  [[12.27905693  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00490991 -0.01681184  0.20921876]
Stock Position:  0.004909914203032656
Bond Position:  [9.21164038]


portfolio before change:  [9.70950645]
curr_Stock_Price:  101.1656251230318
curr_Factors:  [101.16562512  -1.22212075  -1.08175289]
mat_Sqrt:  [[10.10353527  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01142903  0.01970627  0.06448192]
Stock Position:  -0.011429032287486053
Bond Position:  [10.86573165]


portfolio before change:  [9.70769864]
curr_Stock_Price:  101.44264884671051
curr_Factors:  [101.44264885  -1.12334834  -1.0894927 ]
mat_Sqrt:  [[11.09675327  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00285101  0.02025074  0.07348663]
Stock Position:  -0.0028510075521975377
Bond Position:  [9.9969124]


portfolio before change:  [9.71087513]
curr_Stock_Price:  100.76681665983091
curr_Factors:  [100.76681666  -0.99297346  -1.09870675]
mat_Sqrt:  [[12.44263514  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-1.99430196e-04 -2.94279022e-02 -5.64150507e-01]
Stock Position:  -0.00019943019568330282
Bond Position:  [9.73097108]


portfolio before change:  [9.71218224]
curr_Stock_Price:  100.3122136866873
curr_Factors:  [100.31221369  -0.95572739  -1.09905096]
mat_Sqrt:  [[12.85212422  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00126411 -0.00161177 -0.32607394]
Stock Position:  -0.0012641090054338778
Bond Position:  [9.83898782]


portfolio before change:  [9.71388891]
curr_Stock_Price:  99.93509918601643
curr_Factors:  [99.93509919 -0.93125739 -1.09840871]
mat_Sqrt:  [[13.12941145  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00316912 0.03698938 0.06552236]
Stock Position:  0.003169124698754442
Bond Position:  [9.39718212]


portfolio before change:  [9.71535074]
curr_Stock_Price:  100.02569688262872
curr_Factors:  [100.02569688  -1.08338536  -1.12306117]
mat_Sqrt:  [[11.01194494  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00044416 -0.01931928 -0.2558731 ]
Stock Position:  -0.00044415531767118667
Bond Position:  [9.75977769]


portfolio before change:  [9.71667596]
curr_Stock_Price:  99.78892624601102
curr_Factors:  [99.78892625 -0.73796257 -1.11490697]
mat_Sqrt:  [[15.64556793  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01386008 -0.04578424 -0.06939921]
Stock Position:  0.013860083482509443
Bond Position:  [8.33359311]


portfolio before change:  [9.70678998]
curr_Stock_Price:  99.00049367218904
curr_Factors:  [99.00049367 -1.12314034 -1.09818236]
mat_Sqrt:  [[10.73814265  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00478845 -0.02657113 -0.00992054]
Stock Position:  -0.004788454024175221
Bond Position:  [10.18084929]


portfolio before change:  [9.71060825]
curr_Stock_Price:  98.46888558700593
curr_Factors:  [98.46888559 -1.03281378 -1.07187175]
mat_Sqrt:  [[12.00178137  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01365941  0.02177178  0.06706948]
Stock Position:  -0.013659407859416712
Bond Position:  [11.05563491]


portfolio before change:  [9.72200674]
curr_Stock_Price:  97.73558475649024
curr_Factors:  [97.73558476 -0.78397899 -1.07128834]
mat_Sqrt:  [[15.28693256  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00593142 -0.03922971 -0.24397304]
Stock Position:  0.005931416661074958
Bond Position:  [9.14229627]


portfolio before change:  [9.71837582]
curr_Stock_Price:  96.93075445903173
curr_Factors:  [96.93075446 -0.6387154  -1.04183945]
mat_Sqrt:  [[18.05534927  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00060146 -0.0101187  -0.25302278]
Stock Position:  -0.0006014575085099632
Bond Position:  [9.77667555]


portfolio before change:  [9.71920174]
curr_Stock_Price:  97.58954274906789
curr_Factors:  [97.58954275 -0.56135418 -1.02708295]
mat_Sqrt:  [[19.93213422  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00179259  0.00765018 -0.1757757 ]
Stock Position:  -0.001792588394206906
Bond Position:  [9.89413963]


portfolio before change:  [9.72278902]
curr_Stock_Price:  96.27834578708877
curr_Factors:  [96.27834579 -0.56159094 -1.02799511]
mat_Sqrt:  [[19.64174963  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0052183  -0.05446574 -0.07858391]
Stock Position:  0.00521830298961433
Bond Position:  [9.22037944]


portfolio before change:  [9.72455357]
curr_Stock_Price:  96.39561105973469
curr_Factors:  [96.39561106 -0.53457158 -1.04023376]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [9.72455357]
Stock Price:  96.3104930226148
PL:  [9.72455357]
Settle:  Tensor("sub_340:0", shape=(), dtype=float64)
PL:  Tensor("sub_341:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  171
output_Z_Vals[:, i, :]:  [[ 1.19260232e+02 -2.92559343e+01 -2.92733494e+01]
 [-1.53951892e-01  4.33399950e-01  7.19813475e-02]
 [ 5.57901083e-02  4.80999692e-02 -2.14076388e-02]
 [ 8.65665187e-02  1.84855077e-01  3.81508296e-02]
 [ 2.26000553e-01 -2.17822010e-02 -4.24653258e-02]
 [ 2.39393635e-02  3.34497853e-02  6.01976602e-02]
 [-4.20293833e-02  4.20510468e-02 -1.65698674e-01]
 [ 2.48489756e-01 -1.25223404e-01  1.29998086e-01]
 [-1.74938213e-01 -4.45030753e-02  1.62652560e-01]
 [-6.12869194e-02  3.09931234e-01  1.28542846e-01]
 [ 5.70767705e-02 -3.13444537e-02  4.63396432e-03]
 [-8.94620498e-02  1.07732768e-01  3.16632614e-02]
 [-1.02068622e-01  2.75299336e-02 -5.15176418e-02]
 [ 3.32405769e-01  2.52040385e-01  3.33348412e-01]
 [ 2.24869390e-01  3.63628575e-01  1.28805112e-01]
 [-6.64223342e-02 -7.58000977e-02 -1.16636777e-01]
 [-8.17083599e-02 -9.60390771e-03 -9.04902569e-02]
 [ 4.07285538e-02 -7.47809545e-02 -5.34925537e-02]
 [ 2.07244289e-02  6.84303092e-02  2.48655971e-02]
 [ 3.38632822e-01 -1.57088747e-01 -8.28215158e-02]
 [ 9.13594618e-02  4.65873224e-03  1.44755529e-01]
 [ 3.72461000e-02 -3.11678528e-02  3.61439868e-02]
 [-7.26300275e-02  9.28351712e-02  2.22785702e-01]
 [ 3.12076574e-02 -8.54049754e-03 -5.28794840e-02]
 [ 5.27451091e-02  3.55065937e-02  9.49127264e-02]
 [ 8.48130373e-02 -1.04977699e-02  6.11388659e-02]
 [-1.47218361e-01  6.53718488e-02  4.31864521e-02]
 [-4.38898146e-02  6.82234283e-02  2.73358764e-02]
 [ 6.14074868e-02 -7.07084791e-02  3.07330751e-02]
 [ 3.76645313e-02  9.64690361e-03 -3.17762670e-02]
 [-8.36077691e-03  2.35626978e-01  2.24171785e-02]
 [ 2.44322311e-02 -1.12912405e-01 -7.00409952e-02]
 [ 1.35970939e-01 -1.11495994e-01 -2.10793674e-02]
 [-4.24291755e-02 -7.96948025e-02  5.34406114e-03]
 [-1.07982039e-01  1.22160277e-02  3.62834545e-02]
 [ 8.47165236e-02 -1.65012150e-01 -1.38726811e-01]
 [-1.97650821e-01 -3.23027242e-01  6.39158664e-02]
 [-3.60520051e-02 -1.11810731e-02 -9.02582188e-03]
 [-4.38556409e-02  9.37058874e-02 -2.09551399e-02]
 [-2.55207049e-02  3.25289332e-02  1.17579423e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.26023247 -29.25593426 -29.27334937]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  8.31486419  -9.25153874 -83.50871763]
init_Out:  [2.49911038]
Stock Position:  8.31486419409362
Bond position:  [-828.98730903]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [11.7353242]
curr_Stock_Price:  101.12327074645002
curr_Factors:  [101.12327075  -1.26319703  -1.00749838]
mat_Sqrt:  [[10.44000299  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01226709  0.1370531   0.20534275]
Stock Position:  -0.012267086729068857
Bond Position:  [12.97581213]


portfolio before change:  [11.73734249]
curr_Stock_Price:  101.09097156043659
curr_Factors:  [101.09097156  -1.39254422  -1.02650191]
mat_Sqrt:  [[ 8.99775135  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00585282  0.01521055 -0.06107003]
Stock Position:  0.005852821016612649
Bond Position:  [11.14567513]


portfolio before change:  [11.7401178]
curr_Stock_Price:  101.32709823276042
curr_Factors:  [101.32709823  -1.32536781  -1.0254998 ]
mat_Sqrt:  [[ 9.65509994  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.0102668  0.05845631 0.1088337 ]
Stock Position:  0.010266798111678726
Bond Position:  [10.69981294]


portfolio before change:  [11.74223045]
curr_Stock_Price:  101.40259348573667
curr_Factors:  [101.40259349  -1.01775743  -0.98733192]
mat_Sqrt:  [[13.6536832   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0158763  -0.00688814 -0.12114175]
Stock Position:  0.015876297825446053
Bond Position:  [10.13233268]


portfolio before change:  [11.75894426]
curr_Stock_Price:  102.37556496017768
curr_Factors:  [102.37556496  -1.30657343  -1.0192444 ]
mat_Sqrt:  [[10.0024517   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00370817 0.01057775 0.17172717]
Stock Position:  0.003708173788890706
Bond Position:  [11.37931787]


portfolio before change:  [11.76149416]
curr_Stock_Price:  102.6795943655123
curr_Factors:  [102.67959437  -1.43297317  -1.01762335]
mat_Sqrt:  [[ 8.85530653  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00844316  0.01329771 -0.47269219]
Stock Position:  -0.00844315550396998
Bond Position:  [12.62843394]


portfolio before change:  [11.76001924]
curr_Stock_Price:  103.041256214456
curr_Factors:  [103.04125621  -1.74332196  -1.04310202]
mat_Sqrt:  [[ 6.35159188  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0427912  -0.03959912  0.37084835]
Stock Position:  0.04279120176617483
Bond Position:  [7.35076006]


portfolio before change:  [11.72157813]
curr_Stock_Price:  102.12144071315191
curr_Factors:  [102.12144071  -1.73001997  -1.03314561]
mat_Sqrt:  [[ 6.44301834  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02217687 -0.01407311  0.46400248]
Stock Position:  -0.022176867278931263
Bond Position:  [13.98631177]


portfolio before change:  [11.71443201]
curr_Stock_Price:  102.52251284646775
curr_Factors:  [102.52251285  -1.75348584  -1.02469365]
mat_Sqrt:  [[ 6.37193327  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00424453  0.09800886  0.36669696]
Stock Position:  -0.004244525108936405
Bond Position:  [12.14959139]


portfolio before change:  [11.71451152]
curr_Stock_Price:  102.86160448402886
curr_Factors:  [102.86160448  -1.89398767  -1.05523025]
mat_Sqrt:  [[ 5.3879583   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01061875 -0.00991199  0.01321941]
Stock Position:  0.010618746652416453
Bond Position:  [10.6222502]


portfolio before change:  [11.71440119]
curr_Stock_Price:  102.72616532282878
curr_Factors:  [102.72616532  -2.13219584  -1.0597018 ]
mat_Sqrt:  [[ 4.22141012  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01900246  0.03406809  0.09032647]
Stock Position:  -0.01900245730777381
Bond Position:  [13.66645076]


portfolio before change:  [11.7115319]
curr_Stock_Price:  102.9670656565749
curr_Factors:  [102.96706566  -1.93693595  -1.06826116]
mat_Sqrt:  [[ 5.09985484  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02193666  0.00870573 -0.14696549]
Stock Position:  -0.02193666295485323
Bond Position:  [13.97028572]


portfolio before change:  [11.7038975]
curr_Stock_Price:  103.39469663041685
curr_Factors:  [103.39469663  -1.78923951  -1.08743308]
mat_Sqrt:  [[ 5.82338132  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.06988343 0.07970217 0.95095023]
Stock Position:  0.06988343390341265
Bond Position:  [4.47832105]


portfolio before change:  [11.68664716]
curr_Stock_Price:  103.13984130064583
curr_Factors:  [103.1398413   -1.50887041  -1.10347354]
mat_Sqrt:  [[ 7.56658471  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.03443436 0.11498945 0.36744513]
Stock Position:  0.0344343561847637
Bond Position:  [8.13509313]


portfolio before change:  [11.67168487]
curr_Stock_Price:  102.67579185475859
curr_Factors:  [102.67579185  -1.24590654  -1.09072088]
mat_Sqrt:  [[ 9.92392946  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00928945 -0.0239701  -0.33273226]
Stock Position:  -0.00928945202107174
Bond Position:  [12.62548671]


portfolio before change:  [11.67323229]
curr_Stock_Price:  102.67911474872373
curr_Factors:  [102.67911475  -1.29987239  -1.08523401]
mat_Sqrt:  [[ 9.45460887  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01062208 -0.00303702 -0.25814352]
Stock Position:  -0.010622076432338633
Bond Position:  [12.76389769]


portfolio before change:  [11.66757449]
curr_Stock_Price:  103.36197422045458
curr_Factors:  [103.36197422  -1.35038708  -1.1033088 ]
mat_Sqrt:  [[ 8.88657103  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00313716 -0.02364781 -0.15259937]
Stock Position:  0.0031371600968383715
Bond Position:  [11.34331143]


portfolio before change:  [11.66970725]
curr_Stock_Price:  103.58981235555025
curr_Factors:  [103.58981236  -1.42869521  -1.11077886]
mat_Sqrt:  [[ 8.17405337  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.0033725  0.02163956 0.07093463]
Stock Position:  0.0033724957918304403
Bond Position:  [11.32035105]


portfolio before change:  [11.6710351]
curr_Stock_Price:  103.56392930085742
curr_Factors:  [103.5639293   -1.13309729  -1.13057718]
mat_Sqrt:  [[10.76730929  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.02950328 -0.04967582 -0.23626673]
Stock Position:  0.02950327965546465
Bond Position:  [8.61555953]


portfolio before change:  [11.68449507]
curr_Stock_Price:  103.98364389826264
curr_Factors:  [103.9836439   -1.17802357  -1.12260341]
mat_Sqrt:  [[10.41874544  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01161636 0.00147322 0.41294723]
Stock Position:  0.01161635525995517
Bond Position:  [10.47658412]


portfolio before change:  [11.67268201]
curr_Stock_Price:  102.85396815386488
curr_Factors:  [102.85396815  -1.21856837  -1.09873139]
mat_Sqrt:  [[10.13515867  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00432349 -0.00985614  0.10310873]
Stock Position:  0.004323485340260259
Bond Position:  [11.22799438]


portfolio before change:  [11.67124775]
curr_Stock_Price:  102.19758896454807
curr_Factors:  [102.19758896  -0.95710429  -1.09777827]
mat_Sqrt:  [[13.09231643  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00189096  0.02935706  0.6355456 ]
Stock Position:  -0.0018909635142105078
Bond Position:  [11.86449966]


portfolio before change:  [11.67323526]
curr_Stock_Price:  101.93087019209975
curr_Factors:  [101.93087019  -0.80864209  -1.11899068]
mat_Sqrt:  [[14.83014698  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00136163 -0.00270074 -0.15085045]
Stock Position:  0.0013616293395016747
Bond Position:  [11.53444319]


portfolio before change:  [11.67427798]
curr_Stock_Price:  101.63771278580079
curr_Factors:  [101.63771279  -0.82191471  -1.11768659]
mat_Sqrt:  [[14.61156528  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.0049985  0.01122817 0.27075959]
Stock Position:  0.0049984969529603815
Bond Position:  [11.16624218]


portfolio before change:  [11.6808742]
curr_Stock_Price:  102.6780955349609
curr_Factors:  [102.67809553  -0.79382415  -1.10977978]
mat_Sqrt:  [[15.30217347  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0063404  -0.00331969  0.17441217]
Stock Position:  0.0063404002691901445
Bond Position:  [11.02985397]


portfolio before change:  [11.67523365]
curr_Stock_Price:  101.57100935552727
curr_Factors:  [101.57100936  -0.94433031  -1.0951326 ]
mat_Sqrt:  [[13.21424278  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01034604  0.02067239  0.12319893]
Stock Position:  -0.010346038841376404
Bond Position:  [12.72609125]


portfolio before change:  [11.67497679]
curr_Stock_Price:  101.74960073150287
curr_Factors:  [101.74960073  -1.02564887  -1.08166425]
mat_Sqrt:  [[12.3691043   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00295481  0.02157414  0.07798165]
Stock Position:  -0.0029548122434151954
Bond Position:  [11.97562776]


portfolio before change:  [11.6737413]
curr_Stock_Price:  102.6743762981749
curr_Factors:  [102.6743763   -0.99588998  -1.09525556]
mat_Sqrt:  [[12.68496008  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00519159 -0.02235998  0.08767291]
Stock Position:  0.005191594141811765
Bond Position:  [11.14069761]


portfolio before change:  [11.67499137]
curr_Stock_Price:  102.64690738914433
curr_Factors:  [102.64690739  -1.02338286  -1.07800825]
mat_Sqrt:  [[12.55229993  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00250371  0.00305062 -0.09064885]
Stock Position:  0.0025037092934898073
Bond Position:  [11.41799335]


portfolio before change:  [11.67666483]
curr_Stock_Price:  102.7452104200352
curr_Factors:  [102.74521042  -1.02604771  -1.07062685]
mat_Sqrt:  [[12.62372122  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00018212 0.07451179 0.06394997]
Stock Position:  0.00018211531043394838
Bond Position:  [11.65795335]


portfolio before change:  [11.67831361]
curr_Stock_Price:  103.79641523544944
curr_Factors:  [103.79641524  -1.08782384  -1.07785743]
mat_Sqrt:  [[11.90252032  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00060658 -0.03570604 -0.19980746]
Stock Position:  0.0006065763299266951
Bond Position:  [11.61535316]


portfolio before change:  [11.67899286]
curr_Stock_Price:  102.52244431524265
curr_Factors:  [102.52244432  -0.92652751  -1.08847532]
mat_Sqrt:  [[13.66829497  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00942249 -0.03525813 -0.06013357]
Stock Position:  0.009422485923136168
Bond Position:  [10.71297657]


portfolio before change:  [11.69239058]
curr_Stock_Price:  103.80220397041087
curr_Factors:  [103.80220397  -1.04471077  -1.06370577]
mat_Sqrt:  [[12.60471135  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00344284 -0.02520171  0.01524512]
Stock Position:  -0.003442842391153946
Bond Position:  [12.04976521]


portfolio before change:  [11.69504053]
curr_Stock_Price:  103.47002572352143
curr_Factors:  [103.47002572  -1.39236856  -1.07253976]
mat_Sqrt:  [[ 8.79667351  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01139752  0.00386305  0.1035066 ]
Stock Position:  -0.011397523490725626
Bond Position:  [12.87434258]


portfolio before change:  [11.703165]
curr_Stock_Price:  102.8984041018333
curr_Factors:  [102.8984041   -1.55886676  -1.06290469]
mat_Sqrt:  [[ 7.47803965  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00697221 -0.05218142 -0.39574898]
Stock Position:  0.0069722064784933325
Bond Position:  [10.98573608]


portfolio before change:  [11.70261765]
curr_Stock_Price:  102.62293261698578
curr_Factors:  [102.62293262  -1.62295314  -1.00630631]
mat_Sqrt:  [[ 7.40238297  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0260652  -0.10215018  0.18233418]
Stock Position:  -0.02606519785575118
Bond Position:  [14.3775047]


portfolio before change:  [11.70214477]
curr_Stock_Price:  102.71002904759737
curr_Factors:  [102.71002905  -1.46908866  -0.98647248]
mat_Sqrt:  [[ 8.81406399  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00433206 -0.00353577 -0.02574816]
Stock Position:  -0.004332063777257795
Bond Position:  [12.14709116]


portfolio before change:  [11.70328863]
curr_Stock_Price:  102.79650511848425
curr_Factors:  [102.79650512  -1.37501264  -1.00173105]
mat_Sqrt:  [[ 9.54490649  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00478932  0.0296324  -0.05977918]
Stock Position:  -0.004789320394869396
Bond Position:  [12.19561403]


portfolio before change:  [11.70165492]
curr_Stock_Price:  103.45594155762544
curr_Factors:  [103.45594156  -1.0653647   -1.0151959 ]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [11.70165492]
Stock Price:  102.40504325934873
PL:  [9.29661167]
Settle:  Tensor("sub_342:0", shape=(), dtype=float64)
PL:  Tensor("sub_343:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  172
output_Z_Vals[:, i, :]:  [[ 1.19260232e+02 -2.92559343e+01 -2.92733494e+01]
 [-1.62286972e-03 -7.38108766e-02 -2.74234251e-02]
 [-6.07341186e-02 -1.01130000e-01 -1.07802472e-01]
 [ 8.19110839e-02  1.42523071e-01  3.75852775e-02]
 [ 1.30359997e-01 -4.67064398e-04 -6.44324906e-02]
 [ 6.33892680e-02  2.92533521e-02  7.85536520e-03]
 [ 4.87761258e-02  3.07739276e-02 -5.14521736e-02]
 [-5.82723391e-02 -2.46691567e-03 -6.62175610e-02]
 [ 3.36320336e-02 -4.95856878e-02 -3.72885226e-02]
 [-9.72600467e-02 -1.40190279e-01 -1.23928105e-01]
 [ 5.68852848e-02  1.63194187e-01 -8.43582228e-02]
 [-1.74410127e-02  2.59569416e-02 -1.39141093e-02]
 [-6.92255477e-02 -5.95804945e-02 -6.54769119e-02]
 [-9.16928202e-02 -1.13344233e-01  6.77747084e-02]
 [ 2.24129908e-01  2.80114211e-01  3.48693909e-02]
 [-6.95962336e-02 -3.13565685e-01 -7.92571932e-02]
 [-6.70516902e-02 -5.09835479e-02 -3.99646228e-02]
 [-9.21787302e-02  1.00673735e-02  8.93203844e-02]
 [ 3.24572070e-02  5.88728489e-02  2.27932571e-02]
 [ 2.49027874e-01 -5.95679228e-02 -3.00830050e-02]
 [ 3.37078498e-02  2.03697199e-02  8.43606264e-02]
 [ 4.31324594e-02 -3.52331433e-02  4.18778599e-02]
 [-5.98278992e-02  4.02690834e-02  2.68103281e-01]
 [-6.25847875e-02 -7.08806907e-04 -8.37600278e-02]
 [-8.52252300e-02  6.38587900e-02  7.80570852e-02]
 [ 6.05158057e-02 -3.78376697e-02  6.89320526e-02]
 [-1.35083251e-01  6.14591711e-02  3.30748168e-02]
 [-5.07806065e-02  7.36225950e-02  2.93687317e-02]
 [ 2.32629271e-02 -6.61155053e-02 -6.74640967e-02]
 [ 5.66950979e-02  5.47935452e-02 -9.34515648e-02]
 [ 3.60288977e-02  1.20408514e-01  1.48864656e-02]
 [ 2.82382536e-02 -8.38339470e-02 -8.02448961e-02]
 [ 3.33318801e-01 -1.95140113e-01 -4.52533491e-02]
 [-4.36590921e-02 -7.92605215e-02  9.94903262e-03]
 [-1.86067434e-01  8.53083989e-02  2.00480274e-02]
 [ 2.14851961e-01 -7.50736307e-02 -5.03558157e-02]
 [-5.21162718e-03 -8.24226381e-02 -8.30066025e-02]
 [-2.29749891e-02  2.47442460e-02 -6.15100565e-02]
 [ 5.86089495e-02 -1.00169362e-01 -1.00711353e-02]
 [-7.99759919e-01  3.97954897e-01  4.90397967e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.26023247 -29.25593426 -29.27334937]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  8.31486419  -9.25153874 -83.50871763]
init_Out:  [2.49911038]
Stock Position:  8.31486419409362
Bond position:  [-828.98730903]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [3.16659317]
curr_Stock_Price:  100.09273905895668
curr_Factors:  [100.09273906  -1.10414155  -1.0270334 ]
mat_Sqrt:  [[11.8807827   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00076817 -0.02334105 -0.0782314 ]
Stock Position:  -0.0007681683774895568
Bond Position:  [3.24348125]


portfolio before change:  [3.16676279]
curr_Stock_Price:  100.39975969441441
curr_Factors:  [100.39975969  -0.96805954  -1.01087193]
mat_Sqrt:  [[13.8769383   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00615052 -0.03198011 -0.30753045]
Stock Position:  -0.006150518909418743
Bond Position:  [3.78427341]


portfolio before change:  [3.16674715]
curr_Stock_Price:  100.47921706126225
curr_Factors:  [100.47921706  -0.81766188  -1.04627606]
mat_Sqrt:  [[15.58038853  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00598593 0.04506975 0.10722034]
Stock Position:  0.00598592751632947
Bond Position:  [2.56528584]


portfolio before change:  [3.16333638]
curr_Stock_Price:  99.85584655229265
curr_Factors:  [99.85584655 -0.88703693 -1.06204101]
mat_Sqrt:  [[14.22000349  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 8.24160913e-03 -1.47698731e-04 -1.83807961e-01]
Stock Position:  0.008241609127560862
Bond Position:  [2.34036352]


portfolio before change:  [3.15190096]
curr_Stock_Price:  98.43282631062529
curr_Factors:  [98.43282631 -0.70315041 -1.08002506]
mat_Sqrt:  [[16.54690171  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00397344 0.00925072 0.02240917]
Stock Position:  0.003973436064150744
Bond Position:  [2.76078442]


portfolio before change:  [3.15489037]
curr_Stock_Price:  99.09831779989499
curr_Factors:  [99.0983178  -0.66388581 -1.11035515]
mat_Sqrt:  [[16.80827816  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00232434  0.00973157 -0.14677873]
Stock Position:  0.0023243352984415673
Bond Position:  [2.92455265]


portfolio before change:  [3.15171998]
curr_Stock_Price:  97.57703008601153
curr_Factors:  [97.57703009 -0.67438557 -1.11805008]
mat_Sqrt:  [[16.25184545  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0044212  -0.00078011 -0.18890027]
Stock Position:  -0.004421198682165869
Bond Position:  [3.58312742]


portfolio before change:  [3.1513164]
curr_Stock_Price:  97.76962513252867
curr_Factors:  [97.76962513 -0.75708891 -1.12288979]
mat_Sqrt:  [[14.91899518  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00165831 -0.01568037 -0.10637378]
Stock Position:  0.0016583053019188691
Bond Position:  [2.98918451]


portfolio before change:  [3.15121517]
curr_Stock_Price:  97.48324994940121
curr_Factors:  [97.48324995 -0.68783589 -1.10948949]
mat_Sqrt:  [[16.15702896  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00780939 -0.04433206 -0.35353239]
Stock Position:  -0.007809385184168145
Bond Position:  [3.91249942]


portfolio before change:  [3.13525114]
curr_Stock_Price:  99.59009033219206
curr_Factors:  [99.59009033 -0.89556951 -1.10727619]
mat_Sqrt:  [[13.43975307  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0032649   0.05160653 -0.24065053]
Stock Position:  0.003264895588607383
Bond Position:  [2.81009989]


portfolio before change:  [3.13777156]
curr_Stock_Price:  100.25447228388008
curr_Factors:  [100.25447228  -0.81263362  -1.11537942]
mat_Sqrt:  [[14.5806985   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.001345    0.00820831 -0.03969308]
Stock Position:  -0.0013449981859901628
Bond Position:  [3.27261364]


portfolio before change:  [3.13670388]
curr_Stock_Price:  101.35245692282717
curr_Factors:  [101.35245692  -0.70201166  -1.11860452]
mat_Sqrt:  [[16.41159244  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00512621 -0.01884101 -0.1867874 ]
Stock Position:  -0.005126213585774658
Bond Position:  [3.65625822]


portfolio before change:  [3.14519176]
curr_Stock_Price:  99.78583729907751
curr_Factors:  [99.7858373  -0.54497873 -1.10268369]
mat_Sqrt:  [[19.2087104   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00420564 -0.03584259  0.19334238]
Stock Position:  -0.004205638986238085
Bond Position:  [3.56485497]


portfolio before change:  [3.14763312]
curr_Stock_Price:  99.3113019551122
curr_Factors:  [99.31130196 -0.75833392 -1.09648313]
mat_Sqrt:  [[15.54038824  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01534583 0.08857989 0.09947267]
Stock Position:  0.015345827057746819
Bond Position:  [1.62361906]


portfolio before change:  [3.1353995]
curr_Stock_Price:  98.5008808427031
curr_Factors:  [98.50088084 -0.71400658 -1.06013124]
mat_Sqrt:  [[16.70866868  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00561809 -0.09915818 -0.22609871]
Stock Position:  -0.005618088034031176
Bond Position:  [3.68878612]


portfolio before change:  [3.13681293]
curr_Stock_Price:  98.33137484507483
curr_Factors:  [98.33137485 -0.55463336 -1.0523336 ]
mat_Sqrt:  [[19.71492929  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00388162 -0.01612241 -0.11400794]
Stock Position:  -0.003881617990134184
Bond Position:  [3.51849777]


portfolio before change:  [3.13069904]
curr_Stock_Price:  100.01977791006642
curr_Factors:  [100.01977791  -0.50972231  -1.03931448]
mat_Sqrt:  [[21.24945299  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00346768  0.00318358  0.25480619]
Stock Position:  -0.003467681953698279
Bond Position:  [3.47753581]


portfolio before change:  [3.12737084]
curr_Stock_Price:  101.10491572055798
curr_Factors:  [101.10491572  -0.62155752  -1.07107878]
mat_Sqrt:  [[18.60671328  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00207613 0.01861723 0.06502282]
Stock Position:  0.0020761297781387196
Bond Position:  [2.91746392]


portfolio before change:  [3.12826986]
curr_Stock_Price:  101.36227740242234
curr_Factors:  [101.3622774   -0.696202    -1.07717549]
mat_Sqrt:  [[17.20712442  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01402612 -0.01883703 -0.08581844]
Stock Position:  0.014026118654302094
Bond Position:  [1.70655053]


portfolio before change:  [3.14455139]
curr_Stock_Price:  102.50786805211273
curr_Factors:  [102.50786805  -0.64811208  -1.05704308]
mat_Sqrt:  [[18.63020883  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00276185 0.00644147 0.24065739]
Stock Position:  0.0027618495837670493
Bond Position:  [2.86144007]


portfolio before change:  [3.14301778]
curr_Stock_Price:  101.82307103075998
curr_Factors:  [101.82307103  -0.68840267  -1.06071452]
mat_Sqrt:  [[17.70982417  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00286683 -0.0111417   0.11946588]
Stock Position:  0.0028668283446244935
Bond Position:  [2.85110852]


portfolio before change:  [3.13923756]
curr_Stock_Price:  100.38014188807371
curr_Factors:  [100.38014189  -0.76117967  -1.03861894]
mat_Sqrt:  [[16.59606774  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-2.44744895e-04  1.27342023e-02  7.64824036e-01]
Stock Position:  -0.00024474489541810785
Bond Position:  [3.16380509]


portfolio before change:  [3.13979525]
curr_Stock_Price:  99.71748365526061
curr_Factors:  [99.71748366 -0.85462626 -1.03790018]
mat_Sqrt:  [[15.02648916  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-5.30400229e-03 -2.24144425e-04 -2.38944045e-01]
Stock Position:  -0.005304002290093624
Bond Position:  [3.66869701]


portfolio before change:  [3.13635763]
curr_Stock_Price:  100.45206632826623
curr_Factors:  [100.45206633  -0.80270798  -1.0578042 ]
mat_Sqrt:  [[15.62963015  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00432787  0.02019392  0.22267514]
Stock Position:  -0.004327873835482838
Bond Position:  [3.5711015]


portfolio before change:  [3.13140516]
curr_Stock_Price:  101.69953485580989
curr_Factors:  [101.69953486  -0.51310498  -1.08527558]
mat_Sqrt:  [[20.56606055  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00357918 -0.01196532  0.19664396]
Stock Position:  0.0035791753773755414
Bond Position:  [2.76740469]


portfolio before change:  [3.13051791]
curr_Stock_Price:  101.35498608934607
curr_Factors:  [101.35498609  -0.48184661  -1.08303649]
mat_Sqrt:  [[21.19459019  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00598006  0.0194351   0.09435325]
Stock Position:  -0.005980064341506171
Bond Position:  [3.73662725]


portfolio before change:  [3.1385973]
curr_Stock_Price:  100.08204213895677
curr_Factors:  [100.08204214  -0.55330168  -1.08770829]
mat_Sqrt:  [[19.39432127  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0022112   0.02328151  0.08378082]
Stock Position:  -0.002211204579917696
Bond Position:  [3.35989917]


portfolio before change:  [3.13948501]
curr_Stock_Price:  99.87053372764234
curr_Factors:  [99.87053373 -0.53589551 -1.11126633]
mat_Sqrt:  [[19.23464051  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00040473 -0.02090756 -0.19245629]
Stock Position:  0.0004047271366845132
Bond Position:  [3.09906469]


portfolio before change:  [3.13924843]
curr_Stock_Price:  98.32879906003666
curr_Factors:  [98.32879906 -0.57639756 -1.11225436]
mat_Sqrt:  [[18.16805872  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0021485   0.01732724 -0.2665913 ]
Stock Position:  0.002148503642805733
Bond Position:  [2.92798865]


portfolio before change:  [3.1387195]
curr_Stock_Price:  97.91225002076304
curr_Factors:  [97.91225002 -0.42733409 -1.15184171]
mat_Sqrt:  [[20.18411426  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00208959 0.03807652 0.04246694]
Stock Position:  0.0020895897998288054
Bond Position:  [2.93412306]


portfolio before change:  [3.13917287]
curr_Stock_Price:  97.95368506865553
curr_Factors:  [97.95368507 -0.57490563 -1.16324567]
mat_Sqrt:  [[17.22468386  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00056278 -0.02651062 -0.22891635]
Stock Position:  0.000562782438365624
Bond Position:  [3.08404625]


portfolio before change:  [3.13925368]
curr_Stock_Price:  97.41224285523454
curr_Factors:  [97.41224286 -0.58174456 -1.21278378]
mat_Sqrt:  [[16.19048242  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01970559 -0.06170872 -0.12909521]
Stock Position:  0.019705589704698104
Bond Position:  [1.21968799]


portfolio before change:  [3.13440497]
curr_Stock_Price:  97.15844773531293
curr_Factors:  [97.15844774 -0.54322762 -1.23226335]
mat_Sqrt:  [[16.4586663   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0026536  -0.02506438  0.02838182]
Stock Position:  -0.002653602146672711
Bond Position:  [3.39222484]


portfolio before change:  [3.13476278]
curr_Stock_Price:  97.18341183497466
curr_Factors:  [97.18341183 -0.61523952 -1.21803556]
mat_Sqrt:  [[15.53856432  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01156944  0.02697688  0.05719144]
Stock Position:  -0.011569440426574852
Bond Position:  [4.25912047]


portfolio before change:  [3.13735242]
curr_Stock_Price:  97.00559728848839
curr_Factors:  [97.00559729 -0.38677594 -1.22604676]
mat_Sqrt:  [[19.33556189  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0104799  -0.02374037 -0.14365113]
Stock Position:  0.01047989871726067
Bond Position:  [2.12074358]


portfolio before change:  [3.14145828]
curr_Stock_Price:  97.37208464202645
curr_Factors:  [97.37208464 -0.59022538 -1.21424786]
mat_Sqrt:  [[16.02365924  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00151547 -0.02606433 -0.23679473]
Stock Position:  -0.0015154729616886034
Bond Position:  [3.28902304]


portfolio before change:  [3.14201165]
curr_Stock_Price:  97.2782389946738
curr_Factors:  [97.27823899 -0.69753492 -1.21019577]
mat_Sqrt:  [[14.43772576  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00241671  0.00782482 -0.17547107]
Stock Position:  -0.0024167090924518907
Bond Position:  [3.37710486]


portfolio before change:  [3.14295301]
curr_Stock_Price:  97.06340548750795
curr_Factors:  [97.06340549 -0.5874043  -1.2133954 ]
mat_Sqrt:  [[16.03164739  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00336627 -0.03167633 -0.02873015]
Stock Position:  0.0033662682604950565
Bond Position:  [2.81621155]


portfolio before change:  [3.14522199]
curr_Stock_Price:  97.63286096632753
curr_Factors:  [97.63286097 -0.62717356 -1.20637818]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [3.14522199]
Stock Price:  98.17326748195343
PL:  [3.14522199]
Settle:  Tensor("sub_344:0", shape=(), dtype=float64)
PL:  Tensor("sub_345:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  173
output_Z_Vals[:, i, :]:  [[ 1.19260232e+02 -2.92559343e+01 -2.92733494e+01]
 [-1.50541135e-01  4.83377275e-01  8.84965138e-02]
 [ 7.88503934e-02  5.85560678e-02 -3.55657083e-02]
 [ 8.44545629e-02  1.65651000e-01  3.78942647e-02]
 [ 2.33236741e-01 -1.60842312e-02 -3.15534275e-02]
 [-4.42447756e-03  3.09097452e-02  1.09513536e-01]
 [-2.30355518e-03  6.67390596e-02 -4.02968195e-02]
 [-1.19172064e-01  2.68814473e-01  2.06104144e-02]
 [ 1.02283813e-01 -9.67934404e-03 -7.94066393e-02]
 [-4.34447525e-02  1.58364374e-02 -5.52099653e-02]
 [ 5.69735569e-02  1.37381504e-01 -8.32114941e-02]
 [-3.44954715e-02  2.97958962e-02 -5.10087645e-03]
 [-8.50982677e-02 -1.81778407e-02 -5.83719525e-02]
 [ 9.99466316e-02  1.10332789e-01  2.06494709e-01]
 [ 1.67600656e-01  1.63159442e-01 -2.48589992e-02]
 [-7.02975622e-02 -6.97530120e-02 -1.09628867e-01]
 [-7.98543749e-02 -2.12996091e-02 -7.38020064e-02]
 [-3.08794545e-02 -2.51309936e-03  3.12930228e-02]
 [ 1.72784014e-02  7.09119088e-02  2.35593307e-02]
 [ 3.14538729e-01 -7.88568397e-02 -5.21423874e-02]
 [-4.08178016e-02  1.95945189e-03  5.30459860e-04]
 [ 4.51251179e-02 -3.66093310e-02  4.38188986e-02]
 [-9.89352800e-02  1.83999678e-01  2.76892570e-01]
 [ 1.63760268e-01 -2.56977285e-02  1.92626964e-02]
 [ 1.53350309e-02  2.13673805e-02  4.01796186e-02]
 [ 1.03256651e-01  5.68969711e-04  5.63247891e-02]
 [-1.21979941e-01  7.54877316e-02  8.69635299e-02]
 [-2.09113681e-02  4.85793838e-02  2.14437106e-02]
 [ 6.20848838e-02 -6.23725319e-02  9.08311027e-02]
 [-3.20901514e-03 -6.83809666e-02  2.86479804e-02]
 [-6.97247119e-02  4.50670504e-01 -2.71389919e-03]
 [ 4.53447017e-02 -7.17213361e-02  5.92600267e-03]
 [ 7.06090733e-02 -5.70510233e-02  3.10506237e-02]
 [-1.52404580e-01 -3.50312052e-02  3.29046502e-02]
 [-1.14715512e-01  1.69489860e-02  3.65864806e-02]
 [ 8.47165236e-02 -1.65012150e-01 -1.38726811e-01]
 [-2.56105108e-01 -4.50563404e-01  1.08401024e-01]
 [-5.50650455e-02 -5.30207117e-02  8.14817960e-02]
 [-2.80070775e-02  6.04696267e-02 -3.08993956e-02]
 [ 1.98844787e-01 -1.21475965e-02 -1.95931958e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.26023247 -29.25593426 -29.27334937]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  8.31486419  -9.25153874 -83.50871763]
init_Out:  [2.49911038]
Stock Position:  8.31486419409362
Bond position:  [-828.98730903]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [14.01013528]
curr_Stock_Price:  101.39685441831784
curr_Factors:  [101.39685442  -0.85203605  -0.99352295]
mat_Sqrt:  [[16.01431588  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00749305  0.15285732  0.25245592]
Stock Position:  -0.007493052678289749
Bond Position:  [14.76990725]


portfolio before change:  [14.01303471]
curr_Stock_Price:  101.25631371641995
curr_Factors:  [101.25631372  -1.07799545  -0.99395974]
mat_Sqrt:  [[12.7521498   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00573256  0.01851705 -0.10145907]
Stock Position:  0.005732561638969524
Bond Position:  [13.43257665]


portfolio before change:  [14.01300567]
curr_Stock_Price:  100.95832791631442
curr_Factors:  [100.95832792  -1.06528795  -0.98372927]
mat_Sqrt:  [[13.00964     0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00741502 0.05238345 0.10810179]
Stock Position:  0.007415023609123821
Bond Position:  [13.26439728]


portfolio before change:  [14.02292044]
curr_Stock_Price:  102.07182758330671
curr_Factors:  [102.07182758  -1.02130108  -0.98238533]
mat_Sqrt:  [[13.76308955  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01644839 -0.00508628 -0.09001315]
Stock Position:  0.016448387631034074
Bond Position:  [12.34400346]


portfolio before change:  [14.02794625]
curr_Stock_Price:  102.28356312895589
curr_Factors:  [102.28356313  -0.79071938  -0.9839852 ]
mat_Sqrt:  [[17.34049303  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00108001 0.00977452 0.31241164]
Stock Position:  0.0010800134420394744
Bond Position:  [13.91747863]


portfolio before change:  [14.02933863]
curr_Stock_Price:  101.9618870576749
curr_Factors:  [101.96188706  -0.79715842  -0.99258688]
mat_Sqrt:  [[17.02791042  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00051715  0.02110474 -0.11495561]
Stock Position:  -0.0005171458920390429
Bond Position:  [14.0820678]


portfolio before change:  [14.0316285]
curr_Stock_Price:  100.93798912621084
curr_Factors:  [100.93798913  -0.67138746  -0.98202497]
mat_Sqrt:  [[19.31909404  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00559158  0.0850066   0.05879578]
Stock Position:  -0.005591578005773874
Bond Position:  [14.59603114]


portfolio before change:  [14.03879079]
curr_Stock_Price:  99.9833974403961
curr_Factors:  [99.98339744 -0.53490676 -0.97814269]
mat_Sqrt:  [[22.02007854  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00389758 -0.00306088 -0.22652504]
Stock Position:  0.0038975828913142144
Bond Position:  [13.64909721]


portfolio before change:  [14.03730781]
curr_Stock_Price:  99.16514078095915
curr_Factors:  [99.16514078 -0.63455681 -0.97101065]
mat_Sqrt:  [[19.90993958  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00272756  0.00500792 -0.15749866]
Stock Position:  -0.002727559477515392
Bond Position:  [14.30778663]


portfolio before change:  [14.03692238]
curr_Stock_Price:  99.962196236058
curr_Factors:  [99.96219624 -0.88487487 -0.96968901]
mat_Sqrt:  [[15.64620192  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00278248  0.04344385 -0.23737923]
Stock Position:  0.002782480835530676
Bond Position:  [13.75877949]


portfolio before change:  [14.03910549]
curr_Stock_Price:  100.12864966402785
curr_Factors:  [100.12864966  -0.91172446  -0.9985017 ]
mat_Sqrt:  [[14.82373622  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00234538  0.00942229 -0.01455138]
Stock Position:  -0.002345384205784652
Bond Position:  [14.27394565]


portfolio before change:  [14.03903548]
curr_Stock_Price:  100.9192948992364
curr_Factors:  [100.9192949  -0.8458907  -0.9808881]
mat_Sqrt:  [[16.2410556   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00600224 -0.00574834 -0.16651893]
Stock Position:  -0.0060022417745254925
Bond Position:  [14.64477749]


portfolio before change:  [14.03586173]
curr_Stock_Price:  101.75305948878693
curr_Factors:  [101.75305949  -0.96070896  -0.96492402]
mat_Sqrt:  [[14.83391211  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00977126 0.03489029 0.58907193]
Stock Position:  0.009771257026775426
Bond Position:  [13.04160644]


portfolio before change:  [14.03707268]
curr_Stock_Price:  101.710142099145
curr_Factors:  [101.7101421   -0.87883287  -0.95416772]
mat_Sqrt:  [[16.26680337  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01025027  0.05159555 -0.07091581]
Stock Position:  0.01025026789885175
Bond Position:  [12.99451648]


portfolio before change:  [14.0386839]
curr_Stock_Price:  101.7088549203668
curr_Factors:  [101.70885492  -1.11797876  -0.97212756]
mat_Sqrt:  [[12.57873945  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00751081 -0.02205784 -0.31274064]
Stock Position:  -0.007510806334545527
Bond Position:  [14.80259941]


portfolio before change:  [14.03548493]
curr_Stock_Price:  102.38114194806917
curr_Factors:  [102.38114195  -0.98768741  -0.98381421]
mat_Sqrt:  [[14.25632844  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00669661 -0.00673553 -0.21053658]
Stock Position:  -0.006696611987060003
Bond Position:  [14.72109171]


portfolio before change:  [14.04039367]
curr_Stock_Price:  101.92292580150031
curr_Factors:  [101.9229258   -1.21188899  -0.98541114]
mat_Sqrt:  [[11.32391396  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00216857 -0.00079471  0.08927028]
Stock Position:  -0.0021685683023549784
Bond Position:  [14.2614205]


portfolio before change:  [14.04068254]
curr_Stock_Price:  102.61182438997419
curr_Factors:  [102.61182439  -1.29437691  -0.98256598]
mat_Sqrt:  [[10.52770422  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00227195 0.02242431 0.06720821]
Stock Position:  0.0022719452169276794
Bond Position:  [13.80755409]


portfolio before change:  [14.04090697]
curr_Stock_Price:  101.95088256026024
curr_Factors:  [101.95088256  -1.17559692  -0.95938199]
mat_Sqrt:  [[12.05539453  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.02503934 -0.02493672 -0.14874772]
Stock Position:  0.02503934099282753
Bond Position:  [11.48812405]


portfolio before change:  [14.04641877]
curr_Stock_Price:  102.11365420795379
curr_Factors:  [102.11365421  -1.16835888  -0.96522314]
mat_Sqrt:  [[12.0915206   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0033626   0.00061963  0.00151325]
Stock Position:  -0.0033625985084634207
Bond Position:  [14.38978599]


portfolio before change:  [14.04729292]
curr_Stock_Price:  102.38864490984982
curr_Factors:  [102.38864491  -0.999501    -0.96652859]
mat_Sqrt:  [[14.33560387  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00370576 -0.01157689  0.12500312]
Stock Position:  0.003705763964460876
Bond Position:  [13.66786477]


portfolio before change:  [14.05120423]
curr_Stock_Price:  102.98304930792541
curr_Factors:  [102.98304931  -0.79493898  -0.99732977]
mat_Sqrt:  [[17.15510254  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0021955   0.05818581  0.78989743]
Stock Position:  -0.002195496620021254
Bond Position:  [14.27730317]


portfolio before change:  [14.05067638]
curr_Stock_Price:  104.03640043241876
curr_Factors:  [104.03640043  -1.07197114  -1.00895321]
mat_Sqrt:  [[12.98528104  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01286293 -0.00812634  0.05495111]
Stock Position:  0.012862928116706572
Bond Position:  [12.71246364]


portfolio before change:  [14.05952006]
curr_Stock_Price:  104.60038783643859
curr_Factors:  [104.60038784  -1.18825472  -1.01750777]
mat_Sqrt:  [[11.52345784  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00209038 0.00675696 0.11462127]
Stock Position:  0.002090376421419129
Bond Position:  [13.84086588]


portfolio before change:  [14.06153308]
curr_Stock_Price:  104.73567270376915
curr_Factors:  [104.7356727   -1.53617682  -1.04385067]
mat_Sqrt:  [[ 7.93602316  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01446173 0.00017992 0.16067895]
Stock Position:  0.014461725796806067
Bond Position:  [12.5468745]


portfolio before change:  [14.06752942]
curr_Stock_Price:  105.04185218645812
curr_Factors:  [105.04185219  -1.39791894  -1.04805834]
mat_Sqrt:  [[ 9.10097522  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0112383   0.02387132  0.24808274]
Stock Position:  -0.01123830108332339
Bond Position:  [15.24802138]


portfolio before change:  [14.06746936]
curr_Stock_Price:  105.21680547841348
curr_Factors:  [105.21680548  -1.46930259  -1.07256691]
mat_Sqrt:  [[ 8.28257186  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00184482  0.01536215  0.06117294]
Stock Position:  -0.0018448224740644286
Bond Position:  [14.26157569]


portfolio before change:  [14.06872111]
curr_Stock_Price:  105.50467279960449
curr_Factors:  [105.5046728   -1.45776165  -1.06579844]
mat_Sqrt:  [[ 8.45869708  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0093413  -0.01972393  0.25911585]
Stock Position:  0.009341303091797952
Bond Position:  [13.08316998]


portfolio before change:  [14.07461261]
curr_Stock_Price:  105.96028458126426
curr_Factors:  [105.96028458  -1.33859837  -1.0709313 ]
mat_Sqrt:  [[ 9.52133127  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 9.17036060e-05 -2.16239603e-02  8.17247141e-02]
Stock Position:  9.170360598463722e-05
Bond Position:  [14.06489567]


portfolio before change:  [14.07641407]
curr_Stock_Price:  106.4317791505108
curr_Factors:  [106.43177915  -1.28601459  -1.05106685]
mat_Sqrt:  [[10.28228759  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00570325  0.14251453 -0.007742  ]
Stock Position:  -0.00570324661446624
Bond Position:  [14.68342076]


portfolio before change:  [14.07896681]
curr_Stock_Price:  106.30602766548414
curr_Factors:  [106.30602767  -1.32901148  -1.04753975]
mat_Sqrt:  [[ 9.87267422  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0045279  -0.02268028  0.01690524]
Stock Position:  0.004527902365884714
Bond Position:  [13.59762349]


portfolio before change:  [14.07952929]
curr_Stock_Price:  106.05484640756973
curr_Factors:  [106.05484641  -1.15689223  -1.06087838]
mat_Sqrt:  [[11.54423035  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00653783 -0.01804112  0.08857879]
Stock Position:  0.0065378290199691515
Bond Position:  [13.38616084]


portfolio before change:  [14.08219067]
curr_Stock_Price:  106.205967366034
curr_Factors:  [106.20596737  -1.11820154  -1.06596243]
mat_Sqrt:  [[11.95579774  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0122612  -0.01107784  0.09386781]
Stock Position:  -0.01226120171817018
Bond Position:  [15.38440346]


portfolio before change:  [14.09230942]
curr_Stock_Price:  105.53755132417156
curr_Factors:  [105.53755132  -1.15815718  -1.05927221]
mat_Sqrt:  [[11.49184242  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00929439  0.00535974  0.10437105]
Stock Position:  -0.009294393586155539
Bond Position:  [15.07321696]


portfolio before change:  [14.07895422]
curr_Stock_Price:  107.17719320713293
curr_Factors:  [107.17719321  -1.1390564   -1.07531924]
mat_Sqrt:  [[11.70607387  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00445396 -0.05218142 -0.39574898]
Stock Position:  0.004453964415904966
Bond Position:  [13.60159081]


portfolio before change:  [14.0798041]
curr_Stock_Price:  106.98625645086092
curr_Factors:  [106.98625645  -1.08962501  -1.08158927]
mat_Sqrt:  [[12.20061184  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02013107 -0.14248066  0.30923795]
Stock Position:  -0.02013106733424594
Bond Position:  [16.23355163]


portfolio before change:  [14.08840712]
curr_Stock_Price:  106.65971139603346
curr_Factors:  [106.6597114   -0.99411657  -1.08106284]
mat_Sqrt:  [[13.38940995  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00297262 -0.01676662  0.23244488]
Stock Position:  -0.0029726203457781986
Bond Position:  [14.40546594]


portfolio before change:  [14.08923049]
curr_Stock_Price:  106.9885212979998
curr_Factors:  [106.9885213   -1.22787926  -1.08590225]
mat_Sqrt:  [[10.57973137  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00309583  0.01912217 -0.08814738]
Stock Position:  -0.003095832028262507
Bond Position:  [14.42044898]


portfolio before change:  [14.09165824]
curr_Stock_Price:  106.78660775252968
curr_Factors:  [106.78660775  -1.24161472  -1.06597403]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [14.09165824]
Stock Price:  106.26671374187849
PL:  [7.8249445]
Settle:  Tensor("sub_346:0", shape=(), dtype=float64)
PL:  Tensor("sub_347:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  174
output_Z_Vals[:, i, :]:  [[ 1.19260232e+02 -2.92559343e+01 -2.92733494e+01]
 [-5.17465499e-03 -5.97605297e-02 -2.45929536e-02]
 [-8.41381374e-03 -9.41076029e-03 -1.97541495e-02]
 [ 8.28539682e-02  1.51096746e-01  3.76998211e-02]
 [ 2.18547176e-01 -2.76511909e-02 -5.37047360e-02]
 [ 4.10123762e-02  3.08150269e-02  4.72449299e-02]
 [ 3.41479368e-02  5.03538290e-02 -3.18192184e-02]
 [ 1.06409398e-01  7.85595679e-02  1.00290607e-01]
 [-1.68787501e-01 -4.08155030e-02  1.53676592e-01]
 [-3.40502745e-02  1.97774326e-01  4.95059009e-02]
 [ 5.68303502e-02  3.57294141e-02 -7.80934249e-02]
 [-5.45396562e-02  8.89685226e-02  1.01119151e-02]
 [-7.72933493e-02 -3.81820819e-02 -6.20478595e-02]
 [ 4.77718393e-02  5.25283188e-02  1.67803561e-01]
 [ 1.38831887e-01  9.37056208e-02 -6.65426468e-02]
 [-7.64181116e-02 -1.05321332e-01 -1.21971255e-01]
 [-7.74159627e-02 -2.86515288e-02 -7.74586853e-02]
 [ 1.99940028e-02 -1.40541118e-01 -6.04649790e-02]
 [ 2.02337106e-02  6.11028518e-02  1.39671871e-02]
 [ 2.85374439e-01 -1.06674563e-01 -6.58547392e-02]
 [ 8.43785640e-03  1.83015475e-02  5.93919544e-02]
 [ 2.77850323e-02 -2.46337652e-02  2.69280081e-02]
 [-1.14172093e-01  2.35564465e-01  3.19074189e-01]
 [ 4.68222399e-02 -1.05811305e-02 -4.91445058e-02]
 [ 6.77705934e-02  2.24247622e-02  1.00560565e-01]
 [ 7.97008121e-02 -1.66864135e-02  6.28281907e-02]
 [-1.86285457e-01  6.92715021e-02  7.77751954e-02]
 [-5.07806065e-02  7.36225950e-02  2.93687317e-02]
 [ 5.63514941e-02 -5.50566876e-02  9.08867126e-02]
 [ 8.03822819e-03 -7.29142221e-03 -1.16907561e-01]
 [ 8.14215370e-03  1.83731083e-01  2.37927481e-02]
 [ 1.59325696e-02 -7.95458437e-02 -8.76192018e-02]
 [ 2.30985734e-01 -1.08305918e-01  3.89918637e-02]
 [-4.99346340e-02 -8.53870853e-02 -7.31496674e-03]
 [-1.47462456e-01  8.05863319e-02  3.19438266e-02]
 [ 9.02221912e-02 -1.62684499e-01 -1.35912126e-01]
 [-1.49086769e-01 -2.43846922e-01  2.02349870e-02]
 [-4.00458511e-02 -1.79201206e-02  9.72124487e-03]
 [-4.65557016e-02  9.93682254e-02 -1.92609741e-02]
 [-1.10033600e-01  7.41359546e-02  6.15896498e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.26023247 -29.25593426 -29.27334937]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  8.31486419  -9.25153874 -83.50871763]
init_Out:  [2.49911038]
Stock Position:  8.31486419409362
Bond position:  [-828.98730903]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [4.13654954]
curr_Stock_Price:  100.20939236112089
curr_Factors:  [100.20939236  -0.85290877  -1.04937097]
mat_Sqrt:  [[14.9540502   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00078492 -0.01889794 -0.07015685]
Stock Position:  -0.0007849165073982509
Bond Position:  [4.21520554]


portfolio before change:  [4.13670883]
curr_Stock_Price:  100.67776716779353
curr_Factors:  [100.67776717  -0.96788573  -1.06072531]
mat_Sqrt:  [[13.24094542  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00095832 -0.00297594 -0.05635309]
Stock Position:  -0.0009583226117261325
Bond Position:  [4.23319062]


portfolio before change:  [4.13759811]
curr_Stock_Price:  100.30201078223321
curr_Factors:  [100.30201078  -0.89964709  -1.04806936]
mat_Sqrt:  [[14.30299979  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00660356 0.04778099 0.1075471 ]
Stock Position:  0.006603559715613598
Bond Position:  [3.47524779]


portfolio before change:  [4.14156836]
curr_Stock_Price:  100.83745182316497
curr_Factors:  [100.83745182  -0.98849329  -1.09699791]
mat_Sqrt:  [[12.52865766  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01651181 -0.00874407 -0.15320466]
Stock Position:  0.016511808209110062
Bond Position:  [2.4765597]


portfolio before change:  [4.14936775]
curr_Stock_Price:  101.29105427705468
curr_Factors:  [101.29105428  -1.09118407  -1.12668886]
mat_Sqrt:  [[11.02455628  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00466702 0.00974457 0.13477663]
Stock Position:  0.004667022093817588
Bond Position:  [3.67664016]


portfolio before change:  [4.15023245]
curr_Stock_Price:  101.37785246446427
curr_Factors:  [101.37785246  -1.11039101  -1.13722606]
mat_Sqrt:  [[10.71063932  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0027032   0.01592328 -0.09077137]
Stock Position:  0.002703199637047491
Bond Position:  [3.87618787]


portfolio before change:  [4.15218458]
curr_Stock_Price:  101.92075820618575
curr_Factors:  [101.92075821  -1.34497786  -1.15271916]
mat_Sqrt:  [[ 8.3854546   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01537299 0.02484272 0.28610119]
Stock Position:  0.015372992583998196
Bond Position:  [2.58535752]


portfolio before change:  [4.15118407]
curr_Stock_Price:  101.83465256120091
curr_Factors:  [101.83465256  -1.227797    -1.17560298]
mat_Sqrt:  [[ 9.20687484  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01504009 -0.012907    0.43839654]
Stock Position:  -0.015040092561535021
Bond Position:  [5.68278667]


portfolio before change:  [4.15903656]
curr_Stock_Price:  101.35978180737077
curr_Factors:  [101.35978181  -1.04308479  -1.17981296]
mat_Sqrt:  [[10.97674162  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00171621  0.06254173  0.14122656]
Stock Position:  -0.0017162118164435317
Bond Position:  [4.33299142]


portfolio before change:  [4.15927489]
curr_Stock_Price:  101.53652662291111
curr_Factors:  [101.53652662  -1.07030912  -1.19384019]
mat_Sqrt:  [[10.55151327  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00396267  0.01129863 -0.2227788 ]
Stock Position:  0.003962666305588442
Bond Position:  [3.75691952]


portfolio before change:  [4.16161275]
curr_Stock_Price:  102.00798200945192
curr_Factors:  [102.00798201  -0.93218166  -1.16922159]
mat_Sqrt:  [[12.4740167   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00402263  0.02813432  0.02884648]
Stock Position:  -0.004022634727431164
Bond Position:  [4.57195361]


portfolio before change:  [4.16582105]
curr_Stock_Price:  101.10390629836687
curr_Factors:  [101.1039063   -0.84595064  -1.16328074]
mat_Sqrt:  [[13.55719471  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00670822 -0.01207423 -0.17700527]
Stock Position:  -0.006708222065361341
Bond Position:  [4.84404851]


portfolio before change:  [4.16444092]
curr_Stock_Price:  101.39991266444744
curr_Factors:  [101.39991266  -1.00181447  -1.17085653]
mat_Sqrt:  [[11.54671783  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00722118 0.01661091 0.47869685]
Stock Position:  0.007221175266220464
Bond Position:  [3.43221438]


portfolio before change:  [4.17356659]
curr_Stock_Price:  102.6042340147832
curr_Factors:  [102.60423401  -0.68764894  -1.17240832]
mat_Sqrt:  [[15.97175634  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00799338  0.02963232 -0.18982765]
Stock Position:  0.007993384821620255
Bond Position:  [3.35341146]


portfolio before change:  [4.16754997]
curr_Stock_Price:  101.79909011356939
curr_Factors:  [101.79909011  -0.80870739  -1.17018298]
mat_Sqrt:  [[14.07092755  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0073936  -0.03330553 -0.34795004]
Stock Position:  -0.0073935975044532665
Bond Position:  [4.92021146]


portfolio before change:  [4.16758249]
curr_Stock_Price:  101.8778793673231
curr_Factors:  [101.87787937  -0.62104085  -1.17767439]
mat_Sqrt:  [[16.86194992  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00557272 -0.00906041 -0.22096807]
Stock Position:  -0.005572720259859714
Bond Position:  [4.73531942]


portfolio before change:  [4.16198288]
curr_Stock_Price:  102.98892811135993
curr_Factors:  [102.98892811  -0.8004791   -1.20315018]
mat_Sqrt:  [[13.88754245  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00028968 -0.044443   -0.17248975]
Stock Position:  0.0002896757693979798
Bond Position:  [4.13214949]


portfolio before change:  [4.16242185]
curr_Stock_Price:  102.72109537380885
curr_Factors:  [102.72109537  -0.66929941  -1.23509626]
mat_Sqrt:  [[15.29646618  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.0016123  0.01932242 0.0398445 ]
Stock Position:  0.0016122952389139684
Bond Position:  [3.99680512]


portfolio before change:  [4.16282291]
curr_Stock_Price:  102.65995723749471
curr_Factors:  [102.65995724  -0.59320383  -1.24924707]
mat_Sqrt:  [[16.26427907  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01655023 -0.03373346 -0.18786524]
Stock Position:  0.016550230754622208
Bond Position:  [2.46377693]


portfolio before change:  [4.15286632]
curr_Stock_Price:  102.03974984077223
curr_Factors:  [102.03974984  -0.59143696  -1.24036831]
mat_Sqrt:  [[16.33903719  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00128733 0.00578746 0.16942871]
Stock Position:  0.0012873299694712524
Bond Position:  [4.0215075]


portfolio before change:  [4.15277319]
curr_Stock_Price:  101.57689374994068
curr_Factors:  [101.57689375  -0.35694686  -1.25979704]
mat_Sqrt:  [[20.16749575  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00161873 -0.00778988  0.07681811]
Stock Position:  0.0016187259091961779
Bond Position:  [3.98834805]


portfolio before change:  [4.15568929]
curr_Stock_Price:  103.07036598742289
curr_Factors:  [103.07036599  -0.37455986  -1.26378192]
mat_Sqrt:  [[20.02677508  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00214508  0.07449202  0.91022985]
Stock Position:  -0.002145083210166738
Bond Position:  [4.3767838]


portfolio before change:  [4.15844325]
curr_Stock_Price:  102.0415810672896
curr_Factors:  [102.04158107  -0.53486617  -1.2526831 ]
mat_Sqrt:  [[17.07868365  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00213819 -0.00334605 -0.1401956 ]
Stock Position:  0.00213818914868722
Bond Position:  [3.94025905]


portfolio before change:  [4.15897101]
curr_Stock_Price:  102.05803927871074
curr_Factors:  [102.05803928  -0.33325185  -1.27223494]
mat_Sqrt:  [[20.49241618  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00433704 0.00709133 0.2868713 ]
Stock Position:  0.0043370404360978335
Bond Position:  [3.71634116]


portfolio before change:  [4.16020607]
curr_Stock_Price:  102.23569299751891
curr_Factors:  [102.235693    -0.3002961   -1.28742425]
mat_Sqrt:  [[20.89605764  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00440728 -0.00527671  0.17923134]
Stock Position:  0.004407277345638241
Bond Position:  [3.70962502]


portfolio before change:  [4.16120459]
curr_Stock_Price:  102.35703451376898
curr_Factors:  [102.35703451  -0.26654012  -1.27355918]
mat_Sqrt:  [[21.94123499  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00768512  0.02190557  0.22187098]
Stock Position:  -0.0076851225258656045
Bond Position:  [4.94783094]


portfolio before change:  [4.16937537]
curr_Stock_Price:  101.37432199600275
curr_Factors:  [101.374322    -0.32963506  -1.25277369]
mat_Sqrt:  [[20.83035029  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00205877  0.02328151  0.08378082]
Stock Position:  -0.0020587657626067474
Bond Position:  [4.37808135]


portfolio before change:  [4.17177143]
curr_Stock_Price:  100.47632794019316
curr_Factors:  [100.47632794  -0.51785403  -1.28205043]
mat_Sqrt:  [[16.61021228  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00442391 -0.01741045  0.25927449]
Stock Position:  0.004423911494433441
Bond Position:  [3.72727304]


portfolio before change:  [4.17373126]
curr_Stock_Price:  100.8140146533778
curr_Factors:  [100.81401465  -0.51644864  -1.26325924]
mat_Sqrt:  [[17.00605581  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00094165 -0.00230575 -0.33350473]
Stock Position:  -0.0009416464170209534
Bond Position:  [4.26866242]


portfolio before change:  [4.17415899]
curr_Stock_Price:  100.92646535784344
curr_Factors:  [100.92646536  -0.84490318  -1.26732257]
mat_Sqrt:  [[12.20891509  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00145326 0.05810087 0.06787409]
Stock Position:  0.0014532613360167784
Bond Position:  [4.02748646]


portfolio before change:  [4.17590569]
curr_Stock_Price:  101.78194698244623
curr_Factors:  [101.78194698  -0.96852096  -1.24673874]
mat_Sqrt:  [[11.10697233  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00036072 -0.0251546  -0.24995319]
Stock Position:  -0.0003607184560793224
Bond Position:  [4.21262032]


portfolio before change:  [4.1766777]
curr_Stock_Price:  101.10165471403715
curr_Factors:  [101.10165471  -0.6482364   -1.239148  ]
mat_Sqrt:  [[15.31361179  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01542082 -0.03424934  0.11123293]
Stock Position:  0.015420821128832802
Bond Position:  [2.61760716]


portfolio before change:  [4.16731658]
curr_Stock_Price:  100.47339140047855
curr_Factors:  [100.4733914   -0.82110577  -1.21411872]
mat_Sqrt:  [[13.12696402  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00408567 -0.02700177 -0.02086756]
Stock Position:  -0.00408567284002859
Bond Position:  [4.57781799]


portfolio before change:  [4.16538107]
curr_Stock_Price:  101.08718786127214
curr_Factors:  [101.08718786  -1.15226502  -1.23398788]
mat_Sqrt:  [[ 9.29736001  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01493555  0.02548364  0.09112685]
Stock Position:  -0.014935553646514608
Bond Position:  [5.67517419]


portfolio before change:  [4.16668829]
curr_Stock_Price:  101.04716444047406
curr_Factors:  [101.04716444  -1.04451144  -1.25395368]
mat_Sqrt:  [[10.14643347  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00574377 -0.05144536 -0.38771946]
Stock Position:  0.0057437669219567245
Bond Position:  [3.58629693]


portfolio before change:  [4.17080297]
curr_Stock_Price:  101.68548604124574
curr_Factors:  [101.68548604  -0.96634692  -1.26903546]
mat_Sqrt:  [[10.87538739  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01390777 -0.07711117  0.05772479]
Stock Position:  -0.013907773089654324
Bond Position:  [5.58502164]


portfolio before change:  [4.16120678]
curr_Stock_Price:  102.4256737690989
curr_Factors:  [102.42567377  -1.085851    -1.2711388 ]
mat_Sqrt:  [[ 9.70021061  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00397148 -0.00566684  0.02773201]
Stock Position:  -0.003971481375577406
Bond Position:  [4.56798844]


portfolio before change:  [4.16274164]
curr_Stock_Price:  102.1829883453427
curr_Factors:  [102.18298835  -1.23948404  -1.25815841]
mat_Sqrt:  [[ 8.40748818  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00569988  0.03142299 -0.0549462 ]
Stock Position:  -0.005699877763095127
Bond Position:  [4.74517218]


portfolio before change:  [4.16344923]
curr_Stock_Price:  102.16291550220598
curr_Factors:  [102.1629155   -1.27719389  -1.24730787]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [4.16344923]
Stock Price:  101.89305431223488
PL:  [2.27039492]
Settle:  Tensor("sub_348:0", shape=(), dtype=float64)
PL:  Tensor("sub_349:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  175
output_Z_Vals[:, i, :]:  [[ 1.19260232e+02 -2.92559343e+01 -2.92733494e+01]
 [ 1.04699858e-03 -8.63957194e-02 -3.11184756e-02]
 [-8.00029874e-02 -4.03468040e-02  9.26727789e-02]
 [-1.66015761e-01 -7.06995148e-02  2.27493973e-03]
 [-6.68034654e-02  7.28262273e-02 -7.02847107e-02]
 [ 6.02661310e-02  2.87630953e-02  2.72700910e-02]
 [ 2.20527568e-02  5.15201385e-02 -7.30036047e-03]
 [-1.50646817e-02 -5.44110374e-02 -3.41078242e-02]
 [ 1.22215973e-01 -3.60771409e-02 -7.89016577e-02]
 [-4.51555197e-02 -1.11296710e-01 -1.30511111e-01]
 [ 1.07014108e-01  8.01179624e-02 -2.12389740e-02]
 [-2.39561828e-01 -1.12253234e-01  6.65152035e-02]
 [-3.62325561e-02 -1.06675307e-01  3.29684027e-02]
 [-1.02706335e-01 -1.17108904e-01  5.86537665e-02]
 [ 2.07870870e-01  4.05381762e-01  1.98373987e-01]
 [-2.38498140e-02 -4.48563137e-01 -2.58589376e-02]
 [-6.67285238e-02 -4.07344181e-02 -3.55808181e-02]
 [-2.43864152e-02  1.27298518e-01  1.46209387e-02]
 [ 2.40144174e-02  6.68597791e-02  1.08900605e-02]
 [-3.72661826e-02 -2.00172185e-02  1.17034771e-01]
 [ 2.27280403e-02 -6.17994464e-02  2.79771828e-02]
 [ 1.22872601e-01 -6.65747817e-02  1.66410380e-01]
 [-3.03355235e-02 -6.26499514e-02  2.13638047e-01]
 [-6.73000272e-02 -5.96601947e-04 -8.23861356e-02]
 [-3.25685742e-01  1.19320234e-01  4.69002099e-02]
 [-3.19845686e-02 -1.41251852e-01  9.85248100e-02]
 [ 1.83741064e-01  4.42867520e-02 -1.09122107e-01]
 [ 4.50600354e-03  2.64871214e-02  1.57173308e-02]
 [-9.63237188e-02 -9.33125594e-02 -1.75622127e-01]
 [ 2.56925184e-02  1.15477972e-02 -1.20125675e-01]
 [ 4.72239788e-02 -1.57903213e-02  3.66634787e-02]
 [ 7.37101348e-02 -1.06548945e-01 -8.36112877e-02]
 [ 3.31669723e-01 -3.21517292e-01 -2.60060465e-01]
 [-4.69015593e-02 -8.24260143e-02  1.02901382e-03]
 [-1.66714744e-01  2.73822223e-02  2.09354524e-02]
 [ 3.25377467e-02 -1.27447266e-01 -8.49135283e-02]
 [ 8.41429909e-03 -3.44085875e-02 -8.78067361e-02]
 [-2.41890641e-02  2.13896726e-02 -6.63321593e-02]
 [ 1.09291703e-01 -1.66323109e-01 -2.72801314e-02]
 [-7.60808033e-01  3.79313671e-01  4.66678313e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.26023247 -29.25593426 -29.27334937]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  8.31486419  -9.25153874 -83.50871763]
init_Out:  [2.49911038]
Stock Position:  8.31486419409362
Bond position:  [-828.98730903]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [2.81957046]
curr_Stock_Price:  100.05100383643035
curr_Factors:  [100.05100384  -0.88114609  -1.01296898]
mat_Sqrt:  [[15.05281505  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00050062 -0.02732073 -0.08877235]
Stock Position:  -0.0005006214124872904
Bond Position:  [2.86965814]


portfolio before change:  [2.82091243]
curr_Stock_Price:  98.08696147948065
curr_Factors:  [98.08696148 -0.68793011 -1.0034159 ]
mat_Sqrt:  [[18.07461447  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00343731 -0.01275878  0.26436964]
Stock Position:  -0.0034373062683150514
Bond Position:  [3.15806736]


portfolio before change:  [2.82321181]
curr_Stock_Price:  97.53286836165022
curr_Factors:  [97.53286836 -0.7415109  -0.9725495 ]
mat_Sqrt:  [[17.56887789  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00952689 -0.02235715  0.00648977]
Stock Position:  -0.009526894398839476
Bond Position:  [3.75239714]


portfolio before change:  [2.82300157]
curr_Stock_Price:  97.60417367305442
curr_Factors:  [97.60417367 -0.78510733 -0.97111369]
mat_Sqrt:  [[16.85587469  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00470281  0.02302968 -0.20050272]
Stock Position:  -0.004702805890292625
Bond Position:  [3.28201505]


portfolio before change:  [2.82129303]
curr_Stock_Price:  98.05471706289933
curr_Factors:  [98.05471706 -0.70468427 -0.99212452]
mat_Sqrt:  [[17.97023675  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00370475 0.00909569 0.07779398]
Stock Position:  0.003704752244023624
Bond Position:  [2.45802459]


portfolio before change:  [2.81827412]
curr_Stock_Price:  97.15690184032705
curr_Factors:  [97.15690184 -0.65607109 -0.966348  ]
mat_Sqrt:  [[19.18076826  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00114139  0.0162921  -0.0208259 ]
Stock Position:  0.0011413943877169681
Bond Position:  [2.70737977]


portfolio before change:  [2.8179156]
curr_Stock_Price:  96.5462769840204
curr_Factors:  [96.54627698 -0.49559395 -0.93630918]
mat_Sqrt:  [[23.06045671  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0010161  -0.01720628 -0.09730013]
Stock Position:  -0.0010161029922940653
Bond Position:  [2.91601656]


portfolio before change:  [2.81618773]
curr_Stock_Price:  98.60550221100753
curr_Factors:  [98.60550221 -0.54631532 -0.94543071]
mat_Sqrt:  [[22.18421588  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00474115 -0.01140859 -0.22508447]
Stock Position:  0.004741151636601232
Bond Position:  [2.3486841]


portfolio before change:  [2.8157011]
curr_Stock_Price:  98.44093543101917
curr_Factors:  [98.44093543 -0.74528407 -0.96165461]
mat_Sqrt:  [[17.85918689  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00418102 -0.03519511 -0.37231187]
Stock Position:  -0.004181022229023939
Bond Position:  [3.22728484]


portfolio before change:  [2.82162228]
curr_Stock_Price:  97.12122485429303
curr_Factors:  [97.12122485 -0.93414339 -0.94743082]
mat_Sqrt:  [[14.79642701  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00707923  0.02533552 -0.06058888]
Stock Position:  0.007079233214197395
Bond Position:  [2.13407848]


portfolio before change:  [2.81250573]
curr_Stock_Price:  95.79575265723811
curr_Factors:  [95.79575266 -0.94511734 -0.9244053 ]
mat_Sqrt:  [[14.77144187  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01549496 -0.03549759  0.18974936]
Stock Position:  -0.015494955505726046
Bond Position:  [4.29685665]


portfolio before change:  [2.81441747]
curr_Stock_Price:  95.70704002582316
curr_Factors:  [95.70704003 -0.86660559 -0.93308782]
mat_Sqrt:  [[15.8251185   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00203836 -0.03373369  0.09404968]
Stock Position:  -0.002038357793404819
Bond Position:  [3.00950266]


portfolio before change:  [2.81564512]
curr_Stock_Price:  95.28932960968667
curr_Factors:  [95.28932961 -0.90964308 -0.94211843]
mat_Sqrt:  [[14.95665462  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00626861 -0.03703309  0.16732287]
Stock Position:  -0.0062686092512504
Bond Position:  [3.41297669]


portfolio before change:  [2.8093459]
curr_Stock_Price:  96.3622733474688
curr_Factors:  [96.36227335 -1.01673946 -0.96629395]
mat_Sqrt:  [[13.26436818  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01951323 0.12819297 0.56590577]
Stock Position:  0.019513232713608077
Bond Position:  [0.92900644]


portfolio before change:  [2.82104326]
curr_Stock_Price:  96.95577934491564
curr_Factors:  [96.95577934 -1.31674442 -0.98202019]
mat_Sqrt:  [[ 9.73269059  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00418282 -0.14184812 -0.07376835]
Stock Position:  -0.004182820525413859
Bond Position:  [3.22659188]


portfolio before change:  [2.82117801]
curr_Stock_Price:  97.01999431452951
curr_Factors:  [97.01999431 -1.24210997 -0.96517469]
mat_Sqrt:  [[10.67209543  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00703172 -0.01288135 -0.10150217]
Stock Position:  -0.007031719915063105
Bond Position:  [3.50339543]


portfolio before change:  [2.82413016]
curr_Stock_Price:  96.66244294188105
curr_Factors:  [96.66244294 -1.00841453 -0.94901628]
mat_Sqrt:  [[13.65074549  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00132704  0.04025533  0.04170947]
Stock Position:  -0.0013270407121420572
Bond Position:  [2.95240516]


portfolio before change:  [2.82372702]
curr_Stock_Price:  97.24434652475142
curr_Factors:  [97.24434652 -1.37527042 -0.95813366]
mat_Sqrt:  [[ 9.42930848  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00296561 0.02114292 0.03106631]
Stock Position:  0.0029656102416387806
Bond Position:  [2.53533819]


portfolio before change:  [2.82663898]
curr_Stock_Price:  98.11938183188356
curr_Factors:  [98.11938183 -1.5000843  -0.94341967]
mat_Sqrt:  [[ 8.52225474  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00163025 -0.00633     0.33386763]
Stock Position:  -0.0016302495901606962
Bond Position:  [2.98659806]


portfolio before change:  [2.82693948]
curr_Stock_Price:  98.16406392260443
curr_Factors:  [98.16406392 -1.39063987 -0.93669504]
mat_Sqrt:  [[ 9.57643403  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00280305 -0.0195427   0.07981112]
Stock Position:  0.002803047968757406
Bond Position:  [2.5517809]


portfolio before change:  [2.82878755]
curr_Stock_Price:  98.70957046342572
curr_Factors:  [98.70957046 -1.27441078 -0.92595086]
mat_Sqrt:  [[10.93337757  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01418793 -0.02105279  0.4747225 ]
Stock Position:  0.014187932619853611
Bond Position:  [1.42830282]


portfolio before change:  [2.8267064]
curr_Stock_Price:  98.55030080653042
curr_Factors:  [98.55030081 -1.07472811 -0.92346833]
mat_Sqrt:  [[13.36140926  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00087233 -0.01981165  0.60944988]
Stock Position:  0.0008723290564053348
Bond Position:  [2.74073811]


portfolio before change:  [2.82752057]
curr_Stock_Price:  99.0908717928725
curr_Factors:  [99.09087179 -1.25926324 -0.94412043]
mat_Sqrt:  [[10.94249297  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-7.68859812e-03 -1.88662101e-04 -2.35024713e-01]
Stock Position:  -0.007688598124400399
Bond Position:  [3.58939046]


portfolio before change:  [2.83027555]
curr_Stock_Price:  98.79091015257772
curr_Factors:  [98.79091015 -1.17225343 -0.96987282]
mat_Sqrt:  [[11.59854133  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02698886  0.03773237  0.13379324]
Stock Position:  -0.02698886288311076
Bond Position:  [5.49652988]


portfolio before change:  [2.82473868]
curr_Stock_Price:  99.02152324366627
curr_Factors:  [99.02152324 -1.26382997 -0.93930256]
mat_Sqrt:  [[10.93758149  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.001419   -0.04466776  0.28106386]
Stock Position:  -0.0014189958813890726
Bond Position:  [2.96524981]


portfolio before change:  [2.82543067]
curr_Stock_Price:  98.79508562113159
curr_Factors:  [98.79508562 -1.19183924 -0.90785246]
mat_Sqrt:  [[12.10182368  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01343682  0.0140047  -0.311295  ]
Stock Position:  0.013436824953915018
Bond Position:  [1.4979384]


portfolio before change:  [2.83011011]
curr_Stock_Price:  99.12940465432663
curr_Factors:  [99.12940465 -1.0811546  -0.90394055]
mat_Sqrt:  [[13.61716274  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00061674 0.00837596 0.04483717]
Stock Position:  0.0006167352881749375
Bond Position:  [2.76897351]


portfolio before change:  [2.83002535]
curr_Stock_Price:  98.43071765167971
curr_Factors:  [98.43071765 -1.13624696 -0.9040843 ]
mat_Sqrt:  [[12.79458023  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01051865 -0.02950802 -0.50100104]
Stock Position:  -0.01051865342947776
Bond Position:  [3.86538395]


portfolio before change:  [2.84308575]
curr_Stock_Price:  97.23501328178638
curr_Factors:  [97.23501328 -1.22406457 -0.90011839]
mat_Sqrt:  [[11.62255848  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 1.26489394e-04  3.65173412e-03 -3.42685115e-01]
Stock Position:  0.0001264893938226469
Bond Position:  [2.83078655]


portfolio before change:  [2.84343072]
curr_Stock_Price:  97.16462793486855
curr_Factors:  [97.16462793 -1.08272005 -0.92265598]
mat_Sqrt:  [[13.07929836  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00415161 -0.00499334  0.1045907 ]
Stock Position:  0.004151612278327708
Bond Position:  [2.44004086]


portfolio before change:  [2.84170278]
curr_Stock_Price:  96.67494878066488
curr_Factors:  [96.67494878 -1.11245679 -0.9204698 ]
mat_Sqrt:  [[12.65975055  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00425695 -0.03369373 -0.23851973]
Stock Position:  0.004256953565154893
Bond Position:  [2.43016202]


portfolio before change:  [2.84194151]
curr_Stock_Price:  96.6596657169344
curr_Factors:  [96.65966572 -1.0344709  -0.92351516]
mat_Sqrt:  [[13.64277591  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01981148 -0.1016727  -0.74188012]
Stock Position:  0.019811478539914783
Bond Position:  [0.92697062]


portfolio before change:  [2.8506154]
curr_Stock_Price:  97.09163795307573
curr_Factors:  [97.09163795 -1.0693482  -0.88746938]
mat_Sqrt:  [[13.71976743  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00355835 -0.02606539  0.00293549]
Stock Position:  -0.0035583506441939803
Bond Position:  [3.19610149]


portfolio before change:  [2.85262869]
curr_Stock_Price:  96.63812814074556
curr_Factors:  [96.63812814 -1.05398636 -0.90286107]
mat_Sqrt:  [[13.65527558  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01184409  0.00865902  0.05972302]
Stock Position:  -0.011844089571204235
Bond Position:  [3.99721933]


portfolio before change:  [2.84349485]
curr_Stock_Price:  97.45148887169309
curr_Factors:  [97.45148887 -1.06268712 -0.93119162]
mat_Sqrt:  [[13.26960351  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00089785 -0.04030236 -0.24223466]
Stock Position:  0.000897854341431478
Bond Position:  [2.75599761]


portfolio before change:  [2.84326429]
curr_Stock_Price:  96.81097417580699
curr_Factors:  [96.81097418 -0.73118342 -0.90864384]
mat_Sqrt:  [[18.78264113  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00055358 -0.01088095 -0.25048818]
Stock Position:  -0.0005535750637478612
Bond Position:  [2.89685643]


portfolio before change:  [2.84288466]
curr_Stock_Price:  98.15091187377006
curr_Factors:  [98.15091187 -0.69248711 -0.92698511]
mat_Sqrt:  [[19.43419191  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00191296  0.00676401 -0.18922719]
Stock Position:  -0.0019129573610491976
Bond Position:  [3.03064317]


portfolio before change:  [2.84639711]
curr_Stock_Price:  96.51282379972781
curr_Factors:  [96.5128238  -0.54093521 -0.94089043]
mat_Sqrt:  [[21.92988356  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00453394 -0.05259599 -0.07782262]
Stock Position:  0.004533937694762387
Bond Position:  [2.40881398]


portfolio before change:  [2.85726959]
curr_Stock_Price:  98.84443231520304
curr_Factors:  [98.84443232 -0.40311793 -0.96147145]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [2.85726959]
Stock Price:  97.31477522825868
PL:  [2.85726959]
Settle:  Tensor("sub_350:0", shape=(), dtype=float64)
PL:  Tensor("sub_351:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  176
output_Z_Vals[:, i, :]:  [[ 1.19260232e+02 -2.92559343e+01 -2.92733494e+01]
 [ 7.10790950e-02 -1.97625381e-01 -1.99720131e-01]
 [-3.36014935e-02  2.29332114e-02  6.34594601e-02]
 [ 8.89760157e-02  2.06764705e-01  3.84435404e-02]
 [ 1.29758815e-01 -9.87013452e-04 -6.16537090e-02]
 [ 6.76108970e-02  2.81916436e-02 -1.07375597e-01]
 [ 6.63794023e-02  1.87966066e-02 -5.86661968e-02]
 [-1.09341277e-01 -6.41215265e-02 -1.21102326e-01]
 [-2.66570782e-02 -6.40220780e-02  2.91137773e-02]
 [-2.70627846e-02 -1.01294875e-01 -1.32462392e-01]
 [ 5.86316835e-02  1.61053873e-01 -8.63967349e-02]
 [-1.23278301e-01 -1.08905961e-01  1.71121370e-02]
 [-1.14266072e-01  4.93171517e-02 -3.81825237e-02]
 [-9.62623594e-02 -1.14884369e-01  6.32126881e-02]
 [ 3.33643446e-01  3.93649198e-01  2.17049730e-02]
 [-5.77695134e-02 -3.20767097e-01 -6.30016611e-02]
 [-6.70406400e-02 -5.09916952e-02 -4.02073601e-02]
 [-7.49578980e-02  1.87379335e-01  1.28195748e-01]
 [ 8.28611708e-02  5.85246176e-02  8.22649518e-02]
 [ 1.62273115e-01 -4.28538458e-02  7.53857214e-03]
 [-4.44375830e-02 -5.89471470e-03 -1.04012949e-02]
 [ 5.14754631e-02 -4.09950635e-02  5.00047381e-02]
 [-6.33964499e-02  5.18514472e-02  2.82303302e-01]
 [-1.95313555e-02 -9.90672031e-03 -7.82310067e-02]
 [ 8.71396970e-02  2.81628860e-02  9.95689728e-02]
 [ 3.92377209e-02 -6.15324227e-02  7.57286717e-02]
 [-1.51078520e-01  6.64090355e-02  4.47848709e-02]
 [-4.23442521e-02  6.70124283e-02  2.68799194e-02]
 [ 2.17600702e-02 -7.99550375e-02 -2.12525258e-01]
 [ 1.65690921e-02  3.69972549e-04 -8.72060908e-02]
 [ 2.66374595e-02  1.25739079e-01  3.19332663e-02]
 [ 1.53732964e-02 -7.25660877e-02 -9.14745669e-02]
 [ 8.57402966e-02 -6.11114518e-02  3.30792062e-02]
 [-5.25206842e-02 -8.79117440e-02 -1.44291840e-02]
 [-1.70329197e-01  1.44968644e-01  3.05241472e-02]
 [ 8.47165236e-02 -1.65012150e-01 -1.38726811e-01]
 [-1.29991391e-01 -2.15154672e-01  3.68785662e-03]
 [-3.87009425e-02 -1.56507785e-02  3.40825949e-03]
 [-1.85251039e-02  5.87408953e-02 -7.43501774e-03]
 [-1.21488796e-01  7.76014653e-02  7.13987879e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.26023247 -29.25593426 -29.27334937]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  8.31486419  -9.25153874 -83.50871763]
init_Out:  [2.49911038]
Stock Position:  8.31486419409362
Bond position:  [-828.98730903]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-4.20301357]
curr_Stock_Price:  99.20642190866326
curr_Factors:  [99.20642191 -1.22822562 -0.99761755]
mat_Sqrt:  [[10.7119461   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00235333 -0.06249463 -0.56974594]
Stock Position:  0.002353328553488601
Bond Position:  [-4.43647887]


portfolio before change:  [-4.20216653]
curr_Stock_Price:  99.8020182193983
curr_Factors:  [99.80201822 -1.35869519 -0.97747214]
mat_Sqrt:  [[ 9.65060958  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00207819  0.00725212  0.18103218]
Stock Position:  -0.002078185048103037
Bond Position:  [-3.99475947]


portfolio before change:  [-4.20299127]
curr_Stock_Price:  99.9585788510317
curr_Factors:  [99.95857885 -1.42921322 -0.96130364]
mat_Sqrt:  [[ 9.1544402   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01115982 0.06538474 0.10966872]
Stock Position:  0.011159820817489462
Bond Position:  [-5.31851109]


portfolio before change:  [-4.20966242]
curr_Stock_Price:  99.42037177360767
curr_Factors:  [99.42037177 -1.49950157 -0.97498642]
mat_Sqrt:  [[ 8.37180115  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0139932  -0.00031212 -0.17588087]
Stock Position:  0.013993203773294872
Bond Position:  [-5.60087194]


portfolio before change:  [-4.21454881]
curr_Stock_Price:  99.12120934201357
curr_Factors:  [99.12120934 -1.48216324 -0.96925972]
mat_Sqrt:  [[ 8.54136197  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00543483  0.00891498 -0.30631269]
Stock Position:  0.0054348299923328985
Bond Position:  [-4.75325573]


portfolio before change:  [-4.21163581]
curr_Stock_Price:  99.76652659622621
curr_Factors:  [99.7665266  -1.47399504 -0.97386992]
mat_Sqrt:  [[ 8.627612    0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00636208  0.00594401 -0.16735833]
Stock Position:  0.0063620780925993554
Bond Position:  [-4.84635825]


portfolio before change:  [-4.21432826]
curr_Stock_Price:  99.43855028464189
curr_Factors:  [99.43855028 -1.30147213 -0.96675551]
mat_Sqrt:  [[10.29143738  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01318735 -0.02027701 -0.34547123]
Stock Position:  -0.013187351000495806
Bond Position:  [-2.90299719]


portfolio before change:  [-4.2060645]
curr_Stock_Price:  98.7843890072541
curr_Factors:  [98.78438901 -1.09233148 -0.94958061]
mat_Sqrt:  [[12.82026972  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00174468 -0.02024556  0.0830535 ]
Stock Position:  -0.0017446821915923726
Bond Position:  [-4.03371714]


portfolio before change:  [-4.20732828]
curr_Stock_Price:  99.21973005360306
curr_Factors:  [99.21973005 -0.96200132 -0.96588449]
mat_Sqrt:  [[14.43204502  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00392993 -0.03203225 -0.37787834]
Stock Position:  -0.003929933667000404
Bond Position:  [-3.81740132]


portfolio before change:  [-4.20602988]
curr_Stock_Price:  98.76791424874548
curr_Factors:  [98.76791425 -1.20863625 -0.9886654 ]
mat_Sqrt:  [[10.97336689  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00411491  0.05092971 -0.24646584]
Stock Position:  0.004114909985895316
Bond Position:  [-4.61245095]


portfolio before change:  [-4.20756965]
curr_Stock_Price:  98.5338444039611
curr_Factors:  [98.5338444  -0.9575559  -0.97813744]
mat_Sqrt:  [[14.22081506  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00862097 -0.03443909  0.04881616]
Stock Position:  -0.008620971413914076
Bond Position:  [-3.35811219]


portfolio before change:  [-4.21436757]
curr_Stock_Price:  99.27368355640681
curr_Factors:  [99.27368356 -0.99675434 -0.99354796]
mat_Sqrt:  [[13.56615681  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00890353  0.01559545 -0.10892411]
Stock Position:  -0.008903529932051946
Bond Position:  [-3.33048136]


portfolio before change:  [-4.20286983]
curr_Stock_Price:  97.93555375516233
curr_Factors:  [97.93555376 -0.98058768 -0.96869995]
mat_Sqrt:  [[13.94361942  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00619103 -0.03632963  0.1803282 ]
Stock Position:  -0.00619103422968293
Bond Position:  [-3.59654746]


portfolio before change:  [-4.2042434]
curr_Stock_Price:  98.08479814097775
curr_Factors:  [98.08479814 -1.04452926 -0.96804419]
mat_Sqrt:  [[13.10847457  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.02656586 0.12448281 0.06191825]
Stock Position:  0.026565862528683898
Bond Position:  [-6.80995066]


portfolio before change:  [-4.2016275]
curr_Stock_Price:  98.2153113048468
curr_Factors:  [98.2153113  -0.91031995 -0.95923471]
mat_Sqrt:  [[15.1440462   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00521075 -0.10143546 -0.1797262 ]
Stock Position:  -0.005210750379248221
Bond Position:  [-3.68985203]


portfolio before change:  [-4.2008932]
curr_Stock_Price:  97.98586919038856
curr_Factors:  [97.98586919 -0.90691317 -0.98864387]
mat_Sqrt:  [[14.72087023  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00520109 -0.01612499 -0.11470041]
Stock Position:  -0.0052010874180329425
Bond Position:  [-3.69126012]


portfolio before change:  [-4.2043587]
curr_Stock_Price:  98.56345412771934
curr_Factors:  [98.56345413 -0.7750457  -0.98645664]
mat_Sqrt:  [[16.93187945  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00259581  0.05925455  0.36570679]
Stock Position:  -0.002595809704092771
Bond Position:  [-3.94850673]


portfolio before change:  [-4.20925528]
curr_Stock_Price:  100.25964189617714
curr_Factors:  [100.2596419   -0.75566875  -1.01591722]
mat_Sqrt:  [[17.05046137  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00593324 0.01850711 0.23467901]
Stock Position:  0.005933243139117478
Bond Position:  [-4.80412011]


portfolio before change:  [-4.20981623]
curr_Stock_Price:  100.26631622594721
curr_Factors:  [100.26631623  -0.57728261  -1.00758956]
mat_Sqrt:  [[20.55198715  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00791677 -0.01355158  0.02150545]
Stock Position:  0.007916774017442708
Bond Position:  [-5.003602]


portfolio before change:  [-4.208482]
curr_Stock_Price:  100.51385590060576
curr_Factors:  [100.5138559   -0.61970539  -1.02468811]
mat_Sqrt:  [[19.412207    0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00240637 -0.00186407 -0.029672  ]
Stock Position:  -0.0024063693177336504
Bond Position:  [-3.96660854]


portfolio before change:  [-4.21107474]
curr_Stock_Price:  101.38524431046508
curr_Factors:  [101.38524431  -0.63065824  -1.04805738]
mat_Sqrt:  [[18.9198558   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00320426 -0.01296378  0.1426496 ]
Stock Position:  0.003204260656923733
Bond Position:  [-4.53593949]


portfolio before change:  [-4.21493561]
curr_Stock_Price:  100.35728762788185
curr_Factors:  [100.35728763  -0.70840595  -1.01871282]
mat_Sqrt:  [[17.84311864  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-2.48428049e-04  1.63968673e-02  8.05332741e-01]
Stock Position:  -0.000248428049129903
Bond Position:  [-4.19000405]


portfolio before change:  [-4.21533424]
curr_Stock_Price:  99.85349486293728
curr_Factors:  [99.85349486 -0.62009648 -1.02349879]
mat_Sqrt:  [[19.30007121  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00185263 -0.00313278 -0.22317129]
Stock Position:  -0.0018526347867684142
Bond Position:  [-4.03034218]


portfolio before change:  [-4.21928833]
curr_Stock_Price:  101.71585446006215
curr_Factors:  [101.71585446  -0.67316132  -1.03181865]
mat_Sqrt:  [[18.48950387  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.0058515  0.00890589 0.28404256]
Stock Position:  0.005851497793608146
Bond Position:  [-4.81447843]


portfolio before change:  [-4.22305825]
curr_Stock_Price:  101.17444267174754
curr_Factors:  [101.17444267  -0.79536738  -1.02120634]
mat_Sqrt:  [[16.44912796  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00322856 -0.01945826  0.21603282]
Stock Position:  0.0032285608767326714
Bond Position:  [-4.5497061]


portfolio before change:  [-4.22240468]
curr_Stock_Price:  101.55304003705496
curr_Factors:  [101.55304004  -1.06596169  -1.00444833]
mat_Sqrt:  [[12.80929658  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01094691  0.02100038  0.12775877]
Stock Position:  -0.010946906517081119
Bond Position:  [-3.11071304]


portfolio before change:  [-4.21699915]
curr_Stock_Price:  101.02372205275347
curr_Factors:  [101.02372205  -1.02439834  -0.99863229]
mat_Sqrt:  [[13.36079577  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00262912  0.02119119  0.07668093]
Stock Position:  -0.0026291216982939443
Bond Position:  [-3.95139549]


portfolio before change:  [-4.21999951]
curr_Stock_Price:  101.97704948421513
curr_Factors:  [101.97704948  -1.07382373  -1.0099991 ]
mat_Sqrt:  [[12.6914045   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00186629 -0.025284   -0.60627541]
Stock Position:  -0.0018662943628035954
Bond Position:  [-4.02968032]


portfolio before change:  [-4.2196852]
curr_Stock_Price:  101.53871998377224
curr_Factors:  [101.53871998  -1.09913901  -0.98916951]
mat_Sqrt:  [[12.58029483  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-9.71538404e-05  1.16995593e-04 -2.48774704e-01]
Stock Position:  -9.715384042568046e-05
Bond Position:  [-4.20982033]


portfolio before change:  [-4.22019289]
curr_Stock_Price:  101.34748990430974
curr_Factors:  [101.3474899   -1.05404682  -0.9482693 ]
mat_Sqrt:  [[13.68416036  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00266018 0.03976219 0.09109672]
Stock Position:  0.002660183619419571
Bond Position:  [-4.48979582]


portfolio before change:  [-4.22175038]
curr_Stock_Price:  100.97299121132835
curr_Factors:  [100.97299121  -0.72755992  -0.94844064]
mat_Sqrt:  [[18.8941529   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00027376 -0.02294741 -0.26095148]
Stock Position:  -0.00027376298755004845
Bond Position:  [-4.19410771]


portfolio before change:  [-4.22267568]
curr_Stock_Price:  102.4377590800553
curr_Factors:  [102.43775908  -0.86010616  -0.96018453]
mat_Sqrt:  [[16.59273088  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00547919 -0.01932514  0.09436577]
Stock Position:  0.0054791866989788674
Bond Position:  [-4.78395128]


portfolio before change:  [-4.22664978]
curr_Stock_Price:  101.82159668826719
curr_Factors:  [101.82159669  -0.77825272  -0.94007009]
mat_Sqrt:  [[18.26340657  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00316129 -0.02780013 -0.04116245]
Stock Position:  -0.0031612886824495734
Bond Position:  [-3.90476231]


portfolio before change:  [-4.22725506]
curr_Stock_Price:  101.85865656509193
curr_Factors:  [101.85865657  -0.69188963  -0.95052952]
mat_Sqrt:  [[19.71080539  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00813541  0.04584311  0.0870769 ]
Stock Position:  -0.008135406158129837
Bond Position:  [-3.39859352]


portfolio before change:  [-4.22622394]
curr_Stock_Price:  101.6796895242224
curr_Factors:  [101.67968952  -0.77422682  -0.96596502]
mat_Sqrt:  [[17.84343647  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.002922   -0.05218142 -0.39574898]
Stock Position:  0.0029219952427228897
Bond Position:  [-4.52333151]


portfolio before change:  [-4.22646413]
curr_Stock_Price:  101.79100333760853
curr_Factors:  [101.79100334  -0.60612473  -0.9503531 ]
mat_Sqrt:  [[21.46543356  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00627958 -0.06803788  0.01052043]
Stock Position:  -0.006279578736194617
Bond Position:  [-3.58725951]


portfolio before change:  [-4.22593961]
curr_Stock_Price:  101.63606363550107
curr_Factors:  [101.63606364  -0.30456796  -0.96843609]
mat_Sqrt:  [[28.45700592  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00134973 -0.00494921  0.00972282]
Stock Position:  -0.0013497321498781884
Bond Position:  [-4.08875815]


portfolio before change:  [-4.22374361]
curr_Stock_Price:  99.63038291645269
curr_Factors:  [99.63038292 -0.32490744 -0.97998186]
mat_Sqrt:  [[27.02001457  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00068564  0.0185755  -0.02121004]
Stock Position:  -0.0006856431223361488
Bond Position:  [-4.15543272]


portfolio before change:  [-4.22671986]
curr_Stock_Price:  103.21357468684263
curr_Factors:  [103.21357469  -0.68532166  -0.99400227]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-4.22671986]
Stock Price:  104.55193601879355
PL:  [-8.77865588]
Settle:  Tensor("sub_352:0", shape=(), dtype=float64)
PL:  Tensor("sub_353:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  177
output_Z_Vals[:, i, :]:  [[ 1.19260232e+02 -2.92559343e+01 -2.92733494e+01]
 [ 4.90594072e-02 -4.94143521e-04 -9.69365796e-02]
 [-3.91372336e-02  3.47726038e-02  1.08308287e-01]
 [ 8.32555590e-02  1.54748422e-01  3.77486072e-02]
 [ 2.21464759e-01 -2.53538078e-02 -4.93051320e-02]
 [ 4.36587991e-03  3.32066570e-02  8.81629883e-02]
 [-3.95333646e-02  4.35674690e-02 -1.58280489e-01]
 [ 2.39446743e-01 -3.94667533e-02  1.38520447e-01]
 [-9.35464852e-02 -8.65395223e-03  1.05648610e-01]
 [-3.52661388e-02  4.03374675e-01  1.73029783e-01]
 [ 4.97094744e-02 -1.35945948e-03 -6.75538743e-02]
 [-6.36578622e-02  9.38678505e-02  1.57389526e-02]
 [-8.46079750e-02 -1.87813349e-02 -5.89389290e-02]
 [ 2.46479516e-01  2.02942518e-01  2.91163455e-01]
 [ 2.46975113e-01  3.97149753e-01  1.38235422e-01]
 [-6.02687367e-02 -5.64409700e-02 -1.12737770e-01]
 [-8.49714747e-02  9.48055631e-03 -1.09146124e-01]
 [ 4.81251510e-02  7.52590560e-02 -1.10639711e-02]
 [ 1.40237597e-02  7.32556852e-02  2.23256119e-02]
 [ 3.63463621e-01 -1.28856546e-01 -7.67485233e-02]
 [-5.75256199e-02  3.14626459e-02 -6.53560284e-02]
 [ 3.09006798e-02 -2.67855217e-02  2.99629447e-02]
 [-2.93758451e-02 -3.28359067e-02  1.20921306e-03]
 [-1.09020972e-03 -1.35238305e-01  4.37781457e-02]
 [ 8.35291845e-02  3.06572214e-02  9.09572351e-02]
 [ 9.79331840e-02  4.34539858e-03  5.69215591e-02]
 [-1.51647426e-01  7.48309364e-02  7.67195066e-02]
 [ 2.62310726e-02 -7.36438323e-02 -3.56918143e-02]
 [ 6.20848838e-02 -6.23725319e-02  9.08311027e-02]
 [ 7.38431676e-02  1.00960691e-02  7.87684640e-02]
 [ 4.43226326e-02  9.08004644e-02  3.02388505e-02]
 [ 3.42698145e-02 -7.61488352e-02 -8.96718565e-02]
 [ 3.80200787e-01 -5.88290489e-01 -6.79289469e-01]
 [-1.63486432e-02 -6.21962752e-02  3.14785304e-02]
 [ 8.52622801e-02  6.10752304e-02  5.18952481e-03]
 [ 8.47165236e-02 -1.65012150e-01 -1.38726811e-01]
 [-2.46649210e-01 -4.38551010e-01  1.05876791e-01]
 [-3.62240734e-02 -1.14714140e-02 -8.21813518e-03]
 [-4.47913146e-02  9.56681028e-02 -2.03680471e-02]
 [ 3.47297383e-02  3.53802021e-03 -2.47110623e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.26023247 -29.25593426 -29.27334937]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  8.31486419  -9.25153874 -83.50871763]
init_Out:  [2.49911038]
Stock Position:  8.31486419409362
Bond position:  [-828.98730903]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-2.46901466]
curr_Stock_Price:  99.41496396828849
curr_Factors:  [99.41496397 -1.07821539 -1.01966492]
mat_Sqrt:  [[12.19983386  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 2.39835659e-03 -1.56261902e-04 -2.76533080e-01]
Stock Position:  0.0023983565937272557
Bond Position:  [-2.7074472]


portfolio before change:  [-2.46956759]
curr_Stock_Price:  99.32553977878881
curr_Factors:  [99.32553978 -1.0238359  -1.00407798]
mat_Sqrt:  [[13.07221343  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.001234    0.01099606  0.3089734 ]
Stock Position:  -0.0012339970168417777
Bond Position:  [-2.34700017]


portfolio before change:  [-2.47148463]
curr_Stock_Price:  100.64130243827424
curr_Factors:  [100.64130244  -0.94757139  -1.02218037]
mat_Sqrt:  [[14.03860418  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00676396 0.04893575 0.10768627]
Stock Position:  0.006763959366973071
Bond Position:  [-3.15221831]


portfolio before change:  [-2.46929029]
curr_Stock_Price:  101.02397536804214
curr_Factors:  [101.02397537  -1.10874872  -1.0364347 ]
mat_Sqrt:  [[11.82450942  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01782279 -0.00801758 -0.14065382]
Stock Position:  0.017822790868495243
Bond Position:  [-4.26981948]


portfolio before change:  [-2.43897812]
curr_Stock_Price:  102.75467718279766
curr_Factors:  [102.75467718  -1.28378644  -1.05310519]
mat_Sqrt:  [[ 9.92893015  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00233857 0.01050087 0.25150447]
Stock Position:  0.0023385668340630216
Bond Position:  [-2.6792768]


portfolio before change:  [-2.43946931]
curr_Stock_Price:  102.68785843429403
curr_Factors:  [102.68785843  -1.44619023  -1.05601851]
mat_Sqrt:  [[ 8.41053553  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00840818  0.01377724 -0.45153018]
Stock Position:  -0.00840818361056113
Bond Position:  [-1.57605094]


portfolio before change:  [-2.44120604]
curr_Stock_Price:  102.87097860713683
curr_Factors:  [102.87097861  -1.33698869  -1.07014136]
mat_Sqrt:  [[ 9.2659419   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.02878316 -0.01248048  0.39516028]
Stock Position:  0.02878315950299727
Bond Position:  [-5.40215782]


portfolio before change:  [-2.4425704]
curr_Stock_Price:  102.84703910039957
curr_Factors:  [102.8470391   -1.2537203   -1.05875915]
mat_Sqrt:  [[10.18344511  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00709038 -0.00273662  0.30138608]
Stock Position:  -0.0070903801519665785
Bond Position:  [-1.7133458]


portfolio before change:  [-2.44019655]
curr_Stock_Price:  102.48203341299974
curr_Factors:  [102.48203341  -1.24226642  -1.07965263]
mat_Sqrt:  [[10.05196822  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00104144 0.12755827 0.49360581]
Stock Position:  0.0010414385466833256
Bond Position:  [-2.54692529]


portfolio before change:  [-2.44059957]
curr_Stock_Price:  102.40076767646711
curr_Factors:  [102.40076768  -1.37534177  -1.09873712]
mat_Sqrt:  [[ 8.62629693  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00415995 -0.0004299  -0.1927124 ]
Stock Position:  0.004159953776428965
Bond Position:  [-2.86658203]


portfolio before change:  [-2.44227173]
curr_Stock_Price:  102.08494308592319
curr_Factors:  [102.08494309  -1.43719019  -1.08392845]
mat_Sqrt:  [[ 8.20453135  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00707189  0.02968362  0.04489885]
Stock Position:  -0.0070718852818773496
Bond Position:  [-1.72033873]


portfolio before change:  [-2.44425659]
curr_Stock_Price:  102.33520181909154
curr_Factors:  [102.33520182  -1.34309486  -1.08569827]
mat_Sqrt:  [[ 9.02014664  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01076743 -0.00593918 -0.16813636]
Stock Position:  -0.010767426448103995
Bond Position:  [-1.34236983]


portfolio before change:  [-2.44995179]
curr_Stock_Price:  102.84854535823848
curr_Factors:  [102.84854536  -1.37408416  -1.11870062]
mat_Sqrt:  [[ 8.50345628  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.03659135 0.06417606 0.83060829]
Stock Position:  0.03659135188293456
Bond Position:  [-6.2133191]


portfolio before change:  [-2.46004402]
curr_Stock_Price:  102.59396271653883
curr_Factors:  [102.59396272  -1.53313119  -1.0965285 ]
mat_Sqrt:  [[ 7.39733202  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.03858779 0.12558978 0.39434718]
Stock Position:  0.038587785725911865
Bond Position:  [-6.41891787]


portfolio before change:  [-2.43763006]
curr_Stock_Price:  103.1956136873603
curr_Factors:  [103.19561369  -1.78831833  -1.12983605]
mat_Sqrt:  [[ 5.57600165  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01519701 -0.0178482  -0.32160948]
Stock Position:  -0.015197007228269135
Bond Position:  [-0.86936557]


portfolio before change:  [-2.4394996]
curr_Stock_Price:  103.31148277378743
curr_Factors:  [103.31148277  -1.87070924  -1.14507197]
mat_Sqrt:  [[ 5.06304112  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02113474  0.00299802 -0.31136351]
Stock Position:  -0.021134737907650598
Bond Position:  [-0.25603849]


portfolio before change:  [-2.43969127]
curr_Stock_Price:  103.31903735304118
curr_Factors:  [103.31903735  -1.98936824  -1.14924094]
mat_Sqrt:  [[ 4.478161    0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01067624  0.023799   -0.03156243]
Stock Position:  0.010676236926153392
Bond Position:  [-3.54274979]


portfolio before change:  [-2.44035434]
curr_Stock_Price:  103.29841254218515
curr_Factors:  [103.29841254  -1.74449494  -1.13163084]
mat_Sqrt:  [[ 5.82114066  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00351691 0.02316548 0.06368876]
Stock Position:  0.0035169069047766813
Bond Position:  [-2.80364524]


portfolio before change:  [-2.4405398]
curr_Stock_Price:  103.34533218936315
curr_Factors:  [103.34533219  -1.87609919  -1.14011507]
mat_Sqrt:  [[ 5.06250724  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.06804343 -0.04074802 -0.21894217]
Stock Position:  0.06804342512106737
Bond Position:  [-9.47251018]


portfolio before change:  [-2.41638484]
curr_Stock_Price:  103.71772823705025
curr_Factors:  [103.71772824  -2.01265323  -1.15444184]
mat_Sqrt:  [[ 4.36919156  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01603363  0.00994936 -0.18644256]
Stock Position:  -0.01603363011065683
Bond Position:  [-0.75341315]


portfolio before change:  [-2.41337635]
curr_Stock_Price:  103.52421826330036
curr_Factors:  [103.52421826  -2.15885602  -1.1615452 ]
mat_Sqrt:  [[ 3.7411923   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00970954 -0.00847033  0.08547594]
Stock Position:  0.009709535949428926
Bond Position:  [-3.41854847]


portfolio before change:  [-2.41166174]
curr_Stock_Price:  103.74482141331589
curr_Factors:  [103.74482141  -2.21727705  -1.17616102]
mat_Sqrt:  [[ 3.48509801  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00860143 -0.01038363  0.00344955]
Stock Position:  -0.00860143242928253
Bond Position:  [-1.51930767]


portfolio before change:  [-2.41213158]
curr_Stock_Price:  103.77736364328459
curr_Factors:  [103.77736364  -2.15910713  -1.20584146]
mat_Sqrt:  [[ 3.58693933  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00121388 -0.04276611  0.12488686]
Stock Position:  0.0012138841550378497
Bond Position:  [-2.53810528]


portfolio before change:  [-2.41283541]
curr_Stock_Price:  103.45892819882617
curr_Factors:  [103.4589282   -1.93823339  -1.20997471]
mat_Sqrt:  [[ 4.44138647  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.02316559 0.00969466 0.25947567]
Stock Position:  0.023165585556034266
Bond Position:  [-4.80952206]


portfolio before change:  [-2.40964043]
curr_Stock_Price:  103.62280078377772
curr_Factors:  [103.62280078  -1.92081727  -1.23716374]
mat_Sqrt:  [[ 4.40515911  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.02489455 0.00137414 0.16238136]
Stock Position:  0.02489454829030707
Bond Position:  [-4.98928325]


portfolio before change:  [-2.41492794]
curr_Stock_Price:  103.43545824799658
curr_Factors:  [103.43545825  -1.76285609  -1.25645326]
mat_Sqrt:  [[ 5.05126386  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0265389   0.02366362  0.2188594 ]
Stock Position:  -0.026538901927713285
Bond Position:  [0.33013555]


portfolio before change:  [-2.42060084]
curr_Stock_Price:  103.6507713246101
curr_Factors:  [103.65077132  -1.90691187  -1.2505971 ]
mat_Sqrt:  [[ 4.40842867  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00386624 -0.02328822 -0.10181881]
Stock Position:  0.0038662383427232835
Bond Position:  [-2.82133943]


portfolio before change:  [-2.42157874]
curr_Stock_Price:  103.48906074308425
curr_Factors:  [103.48906074  -2.01932609  -1.24576837]
mat_Sqrt:  [[ 3.95259158  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01999075 -0.01972393  0.25911585]
Stock Position:  0.019990745724017704
Bond Position:  [-4.49040224]


portfolio before change:  [-2.4255633]
curr_Stock_Price:  103.31782025775111
curr_Factors:  [103.31782026  -1.92368196  -1.20728853]
mat_Sqrt:  [[ 4.51244612  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01998526 0.00319266 0.2247045 ]
Stock Position:  0.019985256336471306
Bond Position:  [-4.49039642]


portfolio before change:  [-2.42093818]
curr_Stock_Price:  103.57733426082561
curr_Factors:  [103.57733426  -2.15911145  -1.19486943]
mat_Sqrt:  [[ 3.61950635  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01459856 0.02871363 0.08626302]
Stock Position:  0.014598557076002674
Bond Position:  [-3.93301781]


portfolio before change:  [-2.41946691]
curr_Stock_Price:  103.71179505155582
curr_Factors:  [103.71179505  -2.34305787  -1.17733927]
mat_Sqrt:  [[ 3.06859164  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00456218 -0.02408038 -0.25580885]
Stock Position:  0.0045621805047442185
Bond Position:  [-2.89261884]


portfolio before change:  [-2.41959593]
curr_Stock_Price:  103.76277522554685
curr_Factors:  [103.76277523  -2.2388684   -1.1770724 ]
mat_Sqrt:  [[ 3.40813932  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.06641507 -0.18603379 -1.93782378]
Stock Position:  0.06641506938241433
Bond Position:  [-9.31100784]


portfolio before change:  [-2.41485145]
curr_Stock_Price:  103.85173726249185
curr_Factors:  [103.85173726  -2.28267997  -1.15207435]
mat_Sqrt:  [[ 3.34748714  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00344408 -0.01966819  0.08979949]
Stock Position:  -0.0034440807606570287
Bond Position:  [-2.05717768]


portfolio before change:  [-2.41555736]
curr_Stock_Price:  103.98203044843606
curr_Factors:  [103.98203045  -2.19177963  -1.1512491 ]
mat_Sqrt:  [[ 3.67366342  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.02392667 0.01931368 0.01480427]
Stock Position:  0.023926672957726748
Bond Position:  [-4.90350139]


portfolio before change:  [-2.41869196]
curr_Stock_Price:  103.87664055166209
curr_Factors:  [103.87664055  -2.2252964   -1.11964718]
mat_Sqrt:  [[ 3.66291936  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01423412 -0.05218142 -0.39574898]
Stock Position:  0.014234120765185012
Bond Position:  [-3.89728461]


portfolio before change:  [-2.41965156]
curr_Stock_Price:  103.84345202346769
curr_Factors:  [103.84345202  -2.32800937  -1.10950438]
mat_Sqrt:  [[ 3.33799639  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.07080911 -0.13868201  0.30203702]
Stock Position:  -0.07080910578851377
Bond Position:  [4.93341042]


portfolio before change:  [-2.41176605]
curr_Stock_Price:  103.74079850908217
curr_Factors:  [103.74079851  -2.33428389  -1.10438732]
mat_Sqrt:  [[ 3.33083914  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01146792 -0.00362758 -0.02344405]
Stock Position:  -0.011467916136494968
Bond Position:  [-1.22207527]


portfolio before change:  [-2.40971936]
curr_Stock_Price:  103.54900604819233
curr_Factors:  [103.54900605  -2.40702036  -1.07403867]
mat_Sqrt:  [[ 3.1867002   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01458524  0.03025291 -0.05810437]
Stock Position:  -0.0145852393059086
Bond Position:  [-0.89943232]


portfolio before change:  [-2.40648095]
curr_Stock_Price:  103.31926428453224
curr_Factors:  [103.31926428  -2.17373283  -1.09469382]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-2.40648095]
Stock Price:  103.2559671345192
PL:  [-5.66244809]
Settle:  Tensor("sub_354:0", shape=(), dtype=float64)
PL:  Tensor("sub_355:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  178
output_Z_Vals[:, i, :]:  [[ 1.19260232e+02 -2.92559343e+01 -2.92733494e+01]
 [ 5.76688210e-02 -7.75699142e-02 -1.37123622e-01]
 [-2.99622875e-02  5.19522045e-02  1.13633349e-01]
 [-4.16516581e-02  1.26239411e-01  1.42668667e-02]
 [ 2.14321899e-01 -2.86860306e-02 -5.58702567e-02]
 [ 7.74359946e-02  3.01217106e-02 -5.53422341e-02]
 [ 6.80238540e-02  1.74166729e-02 -6.15326028e-02]
 [-1.25009574e-01  2.33884375e-01  2.60730037e-03]
 [-5.03640416e-02 -5.56172716e-02  6.47736854e-02]
 [-3.91278474e-02  4.57210671e-02 -3.92260400e-02]
 [ 5.60245216e-02  9.75399647e-02 -8.01100513e-02]
 [-4.63282158e-02  6.38872544e-02  1.26286264e-03]
 [-1.05268475e-01  3.60169765e-02 -5.01576103e-02]
 [-5.76961483e-02  3.43867044e-02  1.20679175e-01]
 [ 3.53182682e-01  4.79035947e-01  9.33730595e-02]
 [-5.95313281e-02 -4.21380503e-03 -1.03829716e-01]
 [-7.25004560e-02 -5.45873935e-02 -5.93147197e-02]
 [-7.14525070e-02  2.37865845e-01  1.41623079e-01]
 [ 1.07936393e-01  7.55804827e-02  1.38286449e-01]
 [ 1.83244146e-01 -5.54403561e-02  1.56636177e-02]
 [-2.48170032e-02 -1.86648211e-02 -2.45152865e-02]
 [ 9.15720490e-02 -6.36554651e-02  8.86793011e-02]
 [-1.08747129e-02 -1.22477738e-01  1.07047196e-01]
 [-5.50100833e-02 -6.20825910e-02 -7.16379033e-02]
 [-2.68937206e-01  1.15540251e-01  3.26676096e-02]
 [-9.87802913e-03 -1.16163413e-01  9.14099865e-02]
 [-2.75737578e-02  5.39027824e-02 -3.20051559e-02]
 [-4.62283562e-02  7.00557541e-02  2.80257705e-02]
 [-6.20723687e-02 -5.60566806e-02 -2.26061695e-01]
 [ 7.87726510e-03 -6.86124807e-03 -1.16396970e-01]
 [-2.50752598e-02  2.90621955e-01  1.53876047e-02]
 [ 2.97417066e-02 -1.26548081e-01 -6.61855320e-02]
 [ 4.89703170e-02 -3.43137977e-02  5.60845431e-02]
 [-3.28773037e-02 -7.30396371e-02  1.74569379e-02]
 [-1.34817844e-01  7.69065807e-02  3.56452753e-02]
 [ 8.47165236e-02 -1.65012150e-01 -1.38726811e-01]
 [-1.91802148e-01 -3.23179555e-01  4.77138575e-02]
 [-4.18794278e-02 -2.10140207e-02  1.83280326e-02]
 [-3.79617940e-02  8.13458124e-02 -2.46532619e-02]
 [-4.41587947e-02  4.08319719e-02  2.39739454e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.26023247 -29.25593426 -29.27334937]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  8.31486419  -9.25153874 -83.50871763]
init_Out:  [2.49911038]
Stock Position:  8.31486419409362
Bond position:  [-828.98730903]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-2.41282828]
curr_Stock_Price:  99.42172131026402
curr_Factors:  [99.42172131 -1.18096417 -0.986949  ]
mat_Sqrt:  [[11.37544906  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00243294 -0.02452976 -0.39117553]
Stock Position:  0.0024329353651078435
Bond Position:  [-2.6547149]


portfolio before change:  [-2.41273858]
curr_Stock_Price:  99.59499232227793
curr_Factors:  [99.59499232 -0.91159963 -0.98115589]
mat_Sqrt:  [[15.00459312  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00036159  0.01642873  0.32416432]
Stock Position:  -0.00036159442060177
Bond Position:  [-2.37672559]


portfolio before change:  [-2.41285824]
curr_Stock_Price:  99.10423706821513
curr_Factors:  [99.10423707 -0.94872432 -0.97892001]
mat_Sqrt:  [[14.41872724  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00246069  0.03992041  0.0406994 ]
Stock Position:  -0.002460685880995005
Bond Position:  [-2.16899384]


portfolio before change:  [-2.41634311]
curr_Stock_Price:  100.41026515578105
curr_Factors:  [100.41026516  -1.20498283  -1.00260479]
mat_Sqrt:  [[11.04167584  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01831033 -0.00907132 -0.15938229]
Stock Position:  0.018310332910058513
Bond Position:  [-4.25488849]


portfolio before change:  [-2.41807759]
curr_Stock_Price:  100.34458716311349
curr_Factors:  [100.34458716  -1.19245056  -0.99145767]
mat_Sqrt:  [[11.29886081  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00592246  0.00952532 -0.15787599]
Stock Position:  0.005922459684059737
Bond Position:  [-3.01236436]


portfolio before change:  [-2.42100143]
curr_Stock_Price:  99.91448269883297
curr_Factors:  [99.9144827  -1.06112241 -0.97206244]
mat_Sqrt:  [[13.08059456  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00427452  0.00550764 -0.17553539]
Stock Position:  0.004274519812659773
Bond Position:  [-2.84808787]


portfolio before change:  [-2.41711764]
curr_Stock_Price:  100.90636669948837
curr_Factors:  [100.9063667   -1.06407653  -0.9866372 ]
mat_Sqrt:  [[12.98090323  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00912406  0.07396073  0.0074379 ]
Stock Position:  -0.009124056342188266
Bond Position:  [-1.49644226]


portfolio before change:  [-2.40943996]
curr_Stock_Price:  100.04438828009819
curr_Factors:  [100.04438828  -1.05773427  -0.99537428]
mat_Sqrt:  [[12.83923117  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00300471 -0.01758773  0.18478129]
Stock Position:  -0.003004712643837881
Bond Position:  [-2.10883533]


portfolio before change:  [-2.40981739]
curr_Stock_Price:  100.08226526435344
curr_Factors:  [100.08226526  -1.12458951  -0.99950529]
mat_Sqrt:  [[11.96394691  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00384107  0.01445827 -0.11190097]
Stock Position:  -0.0038410665600428474
Bond Position:  [-2.02539475]


portfolio before change:  [-2.41203657]
curr_Stock_Price:  100.59409805443971
curr_Factors:  [100.59409805  -1.2178639   -0.97180391]
mat_Sqrt:  [[11.2619048   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00374631  0.03084485 -0.22853168]
Stock Position:  0.003746310919326962
Bond Position:  [-2.78889334]


portfolio before change:  [-2.41402656]
curr_Stock_Price:  100.15597039436118
curr_Factors:  [100.15597039  -1.31356612  -0.97828644]
mat_Sqrt:  [[10.1236687   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00438782  0.02020292  0.0036026 ]
Stock Position:  -0.004387823681723929
Bond Position:  [-1.97455983]


portfolio before change:  [-2.41651762]
curr_Stock_Price:  100.66743688817348
curr_Factors:  [100.66743689  -1.54063407  -0.98699077]
mat_Sqrt:  [[ 8.03813857  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01425416  0.01138957 -0.1430857 ]
Stock Position:  -0.014254158365949404
Bond Position:  [-0.98158804]


portfolio before change:  [-2.41553759]
curr_Stock_Price:  100.59007442350952
curr_Factors:  [100.59007442  -1.73754254  -0.97692335]
mat_Sqrt:  [[ 6.66311907  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00482878  0.01087403  0.3442641 ]
Stock Position:  -0.004828782679348045
Bond Position:  [-1.92980998]


portfolio before change:  [-2.41620196]
curr_Stock_Price:  100.67770020865807
curr_Factors:  [100.67770021  -1.63247565  -0.98514033]
mat_Sqrt:  [[ 7.34711959  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.05234855 0.15148447 0.26636735]
Stock Position:  0.052348546700431854
Bond Position:  [-7.68653325]


portfolio before change:  [-2.42927048]
curr_Stock_Price:  100.44641118429149
curr_Factors:  [100.44641118  -1.79315229  -0.97860534]
mat_Sqrt:  [[ 6.2831204   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01286531 -0.00133252 -0.29619728]
Stock Position:  -0.012865308169373275
Bond Position:  [-1.13699645]


portfolio before change:  [-2.42943145]
curr_Stock_Price:  100.44787484862033
curr_Factors:  [100.44787485  -1.85692746  -0.95571545]
mat_Sqrt:  [[ 6.03150173  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01426137 -0.01726205 -0.16920839]
Stock Position:  -0.014261367541047254
Bond Position:  [-0.99690738]


portfolio before change:  [-2.43250917]
curr_Stock_Price:  100.65494530867902
curr_Factors:  [100.65494531  -1.84213899  -0.94439051]
mat_Sqrt:  [[ 6.20384201  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00586768  0.07521978  0.40401122]
Stock Position:  -0.005867678015378334
Bond Position:  [-1.84189836]


portfolio before change:  [-2.43462085]
curr_Stock_Price:  100.97558758566912
curr_Factors:  [100.97558759  -1.63830034  -0.93604689]
mat_Sqrt:  [[ 7.69469827  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01794943 0.02390065 0.39449275]
Stock Position:  0.017949433557242024
Bond Position:  [-4.24707545]


portfolio before change:  [-2.44047616]
curr_Stock_Price:  100.67895487072937
curr_Factors:  [100.67895487  -1.72651563  -0.92329774]
mat_Sqrt:  [[ 7.11441795  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.02600494 -0.01753178  0.04468394]
Stock Position:  0.026004938960669608
Bond Position:  [-5.05862623]


portfolio before change:  [-2.4405518]
curr_Stock_Price:  100.70036339275211
curr_Factors:  [100.70036339  -1.82844471  -0.90474228]
mat_Sqrt:  [[ 6.54670858  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00462875 -0.00590233 -0.06993529]
Stock Position:  -0.004628751730781014
Bond Position:  [-1.97443482]


portfolio before change:  [-2.44110947]
curr_Stock_Price:  100.76752048501639
curr_Factors:  [100.76752049  -1.68026294  -0.9033485 ]
mat_Sqrt:  [[ 7.60803292  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01419947 -0.02012963  0.25297736]
Stock Position:  0.014199473055382078
Bond Position:  [-3.87195516]


portfolio before change:  [-2.44638081]
curr_Stock_Price:  100.43037338015
curr_Factors:  [100.43037338  -1.65876436  -0.89080792]
mat_Sqrt:  [[ 7.8451256   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00099601 -0.03873086  0.30537585]
Stock Position:  0.000996012462307739
Bond Position:  [-2.54641071]


portfolio before change:  [-2.44709274]
curr_Stock_Price:  100.03519198392885
curr_Factors:  [100.03519198  -1.86667563  -0.84888789]
mat_Sqrt:  [[ 6.61909415  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01076221 -0.01963224 -0.204363  ]
Stock Position:  -0.010762209013876693
Bond Position:  [-1.37049309]


portfolio before change:  [-2.44741622]
curr_Stock_Price:  100.04933066283593
curr_Factors:  [100.04933066  -1.74824888  -0.84558144]
mat_Sqrt:  [[ 7.47701048  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.03467773  0.03653704  0.0931916 ]
Stock Position:  -0.03467772609937048
Bond Position:  [1.02206706]


portfolio before change:  [-2.44708206]
curr_Stock_Price:  100.04337877318682
curr_Factors:  [100.04337877  -1.57227334  -0.86103285]
mat_Sqrt:  [[ 8.778431    0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00065862 -0.0367341   0.26076725]
Stock Position:  0.0006586176747952284
Bond Position:  [-2.51297239]


portfolio before change:  [-2.44739571]
curr_Stock_Price:  100.04411894446172
curr_Factors:  [100.04411894  -1.18505418  -0.85360406]
mat_Sqrt:  [[13.02607394  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0025115   0.01704556 -0.0913018 ]
Stock Position:  -0.0025115026350129655
Bond Position:  [-2.19613464]


portfolio before change:  [-2.44660756]
curr_Stock_Price:  99.62099254538201
curr_Factors:  [99.62099255 -0.86789369 -0.85723138]
mat_Sqrt:  [[17.74755646  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00218051  0.02215357  0.07994972]
Stock Position:  -0.002180513583343255
Bond Position:  [-2.22938263]


portfolio before change:  [-2.45003107]
curr_Stock_Price:  101.06322819146027
curr_Factors:  [101.06322819  -0.70269933  -0.86257467]
mat_Sqrt:  [[21.12532044  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00519114 -0.01772668 -0.64489109]
Stock Position:  -0.005191135280991103
Bond Position:  [-1.92539818]


portfolio before change:  [-2.44583221]
curr_Stock_Price:  100.20801098700915
curr_Factors:  [100.20801099  -0.83639531  -0.83851316]
mat_Sqrt:  [[18.77149832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00085552 -0.00216972 -0.33204816]
Stock Position:  -0.0008555163421355247
Bond Position:  [-2.36010262]


portfolio before change:  [-2.44877932]
curr_Stock_Price:  103.30799219066283
curr_Factors:  [103.30799219  -0.86656315  -0.83102351]
mat_Sqrt:  [[18.91826935  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00076278  0.09190273  0.04389655]
Stock Position:  -0.0007627786267148396
Bond Position:  [-2.36997819]


portfolio before change:  [-2.44967785]
curr_Stock_Price:  104.09755310257624
curr_Factors:  [104.0975531   -0.83692415  -0.81770705]
mat_Sqrt:  [[19.89955311  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00065148 -0.04001802 -0.1888089 ]
Stock Position:  0.0006514811669460145
Bond Position:  [-2.51749544]


portfolio before change:  [-2.44981818]
curr_Stock_Price:  104.36521408293366
curr_Factors:  [104.36521408  -1.05399341  -0.84203294]
mat_Sqrt:  [[15.67191217  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00379868 -0.01085098  0.15999359]
Stock Position:  0.00379867800263114
Bond Position:  [-2.84626802]


portfolio before change:  [-2.45073559]
curr_Stock_Price:  104.21737186301927
curr_Factors:  [104.21737186  -1.10065311  -0.83144468]
mat_Sqrt:  [[15.09526378  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00206686 -0.02309716  0.04979978]
Stock Position:  -0.002066859971413849
Bond Position:  [-2.23533288]


portfolio before change:  [-2.44990622]
curr_Stock_Price:  103.68090327173842
curr_Factors:  [103.68090327  -1.09251067  -0.7996183 ]
mat_Sqrt:  [[15.62995055  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00803304  0.02432     0.10168605]
Stock Position:  -0.008033042867461124
Bond Position:  [-1.61703308]


portfolio before change:  [-2.44628664]
curr_Stock_Price:  103.20515281022811
curr_Factors:  [103.20515281  -1.24038714  -0.81127961]
mat_Sqrt:  [[13.26397925  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00393083 -0.05218142 -0.39574898]
Stock Position:  0.003930829164575133
Bond Position:  [-2.85196846]


portfolio before change:  [-2.44455471]
curr_Stock_Price:  103.7364526220266
curr_Factors:  [103.73645262  -1.10820613  -0.83440614]
mat_Sqrt:  [[14.86844683  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01280612 -0.10219835  0.13611435]
Stock Position:  -0.012806116222940308
Bond Position:  [-1.11609364]


portfolio before change:  [-2.44425793]
curr_Stock_Price:  103.70238296350773
curr_Factors:  [103.70238296  -1.12546532  -0.83949581]
mat_Sqrt:  [[14.53506442  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00266121 -0.00664522  0.05228478]
Stock Position:  -0.00266120688006888
Bond Position:  [-2.16828443]


portfolio before change:  [-2.44479256]
curr_Stock_Price:  103.8014292389497
curr_Factors:  [103.80142924  -0.94070752  -0.8295664 ]
mat_Sqrt:  [[17.67596529  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00231352  0.0257238  -0.07032889]
Stock Position:  -0.0023135245806380875
Bond Position:  [-2.2046454]


portfolio before change:  [-2.44512633]
curr_Stock_Price:  103.82657216831628
curr_Factors:  [103.82657217  -0.91762645  -0.84924673]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-2.44512633]
Stock Price:  103.94688161176235
PL:  [-6.39200794]
Settle:  Tensor("sub_356:0", shape=(), dtype=float64)
PL:  Tensor("sub_357:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  179
output_Z_Vals[:, i, :]:  [[ 1.19260232e+02 -2.92559343e+01 -2.92733494e+01]
 [ 6.14355724e-02 -1.11291753e-01 -1.54706073e-01]
 [-4.79212788e-02  1.83249443e-02  1.03210101e-01]
 [-5.46300112e-02  1.06646245e-01  1.19518011e-02]
 [ 1.56705726e-02  3.77835360e-02 -7.16733288e-02]
 [ 7.13219359e-02  3.04726762e-02 -1.44765525e-02]
 [ 7.24077744e-02  1.37379274e-02 -6.91741140e-02]
 [-1.41400196e-01  5.42374630e-02 -8.50167833e-02]
 [-7.32003578e-02 -4.35096978e-02  5.84270540e-02]
 [-6.65405416e-02  2.51292193e-01  9.57687448e-02]
 [ 5.67579268e-02  1.00037599e-01 -8.11312682e-02]
 [-2.32269999e-02  5.91799531e-02 -9.55234993e-03]
 [-8.39962678e-02 -2.04037797e-02 -5.91989225e-02]
 [-4.42993539e-02 -5.73776026e-02  9.96194907e-02]
 [ 2.05311193e-01  2.67226674e-01  4.45814106e-02]
 [-7.78611525e-02 -9.26839473e-02 -1.13972961e-01]
 [-7.69503765e-02 -3.20366367e-02 -6.44821301e-02]
 [-7.97089623e-02 -6.33759048e-02  5.52763357e-02]
 [ 1.28822946e-02  6.36344732e-02  7.32786252e-03]
 [ 3.02678258e-01 -1.23145696e-01 -7.46826767e-02]
 [ 4.49366381e-02  1.57976475e-02  9.15214445e-02]
 [ 4.02504706e-02 -3.32427582e-02  3.90705291e-02]
 [-7.45215802e-02  1.03197332e-01  1.93408021e-01]
 [ 8.40086848e-02 -2.99650011e-02 -8.13118865e-03]
 [ 9.44624888e-02  2.99655825e-02  9.50152921e-02]
 [ 8.23532287e-02 -1.29136930e-02  6.18878122e-02]
 [-1.57191351e-01  7.39241879e-02  7.69344899e-02]
 [-2.55863212e-02  5.29744931e-02  2.26648857e-02]
 [ 2.77335930e-03 -6.74789718e-02 -2.27952206e-01]
 [ 3.75860436e-02  1.24780012e-02 -2.66424522e-02]
 [ 2.21088233e-02  1.47658127e-01  2.77198317e-02]
 [ 2.28311438e-02 -7.05572519e-02 -8.78612705e-02]
 [ 3.40472125e-01 -5.11697016e-01 -5.73339593e-01]
 [-2.47501360e-02 -6.81253471e-02  2.02457202e-02]
 [ 7.35229107e-02  1.20109419e-01  1.04254682e-03]
 [ 8.47165236e-02 -1.65012150e-01 -1.38726811e-01]
 [-2.32909187e-01 -4.06853260e-01  9.35880961e-02]
 [-3.81201057e-02 -1.46706989e-02  6.81818201e-04]
 [-4.22495405e-02  9.03377101e-02 -2.19628952e-02]
 [ 8.03270152e-02 -2.99628617e-03 -6.97141365e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.26023247 -29.25593426 -29.27334937]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  8.31486419  -9.25153874 -83.50871763]
init_Out:  [2.49911038]
Stock Position:  8.31486419409362
Bond position:  [-828.98730903]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-7.53755434]
curr_Stock_Price:  98.80538820661303
curr_Factors:  [98.80538821 -0.8549999  -1.02064957]
mat_Sqrt:  [[15.1424593   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00178193 -0.03519354 -0.44133336]
Stock Position:  0.0017819289605543055
Bond Position:  [-7.71361852]


portfolio before change:  [-7.53797031]
curr_Stock_Price:  99.11308021216215
curr_Factors:  [99.11308021 -0.68395375 -1.02741608]
mat_Sqrt:  [[17.9016268   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00147363  0.00579486  0.29442969]
Stock Position:  -0.0014736346312382844
Bond Position:  [-7.39191385]


portfolio before change:  [-7.53926167]
curr_Stock_Price:  99.36233139082444
curr_Factors:  [99.36233139 -0.72349117 -1.01914691]
mat_Sqrt:  [[17.39416844  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00284215  0.0337245   0.03409516]
Stock Position:  -0.0028421459737228323
Bond Position:  [-7.25685942]


portfolio before change:  [-7.53764899]
curr_Stock_Price:  98.47573204828258
curr_Factors:  [98.47573205 -0.80993696 -1.02286212]
mat_Sqrt:  [[15.75268867  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 1.27970686e-04  1.19482032e-02 -2.04464057e-01]
Stock Position:  0.00012797068636551473
Bond Position:  [-7.55025099]


portfolio before change:  [-7.5384941]
curr_Stock_Price:  99.24720102550927
curr_Factors:  [99.24720103 -0.70591801 -1.0388585 ]
mat_Sqrt:  [[17.3369005   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00398882  0.00963631 -0.04129757]
Stock Position:  0.003988816979790423
Bond Position:  [-7.93437302]


portfolio before change:  [-7.53817186]
curr_Stock_Price:  99.576646157648
curr_Factors:  [99.57664616 -0.91793118 -1.0474608 ]
mat_Sqrt:  [[13.95078366  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00420352  0.00434431 -0.19733449]
Stock Position:  0.0042035186497964
Bond Position:  [-7.95674415]


portfolio before change:  [-7.53745952]
curr_Stock_Price:  99.98273400461011
curr_Factors:  [99.982734   -0.88749619 -1.05279248]
mat_Sqrt:  [[14.36376686  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01095491  0.01715139 -0.24252922]
Stock Position:  -0.010954909695321364
Bond Position:  [-6.4421577]


portfolio before change:  [-7.54662785]
curr_Stock_Price:  100.74613664201024
curr_Factors:  [100.74613664  -0.9978835   -1.06553091]
mat_Sqrt:  [[12.79672715  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00487604 -0.01375897  0.16667612]
Stock Position:  -0.004876043710029933
Bond Position:  [-7.05538528]


portfolio before change:  [-7.5489636]
curr_Stock_Price:  101.0442836860549
curr_Factors:  [101.04428369  -1.0832529   -1.06848404]
mat_Sqrt:  [[11.74963211  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00344721  0.07946557  0.27320157]
Stock Position:  -0.003447213626107537
Bond Position:  [-7.20064237]


portfolio before change:  [-7.54819003]
curr_Stock_Price:  100.55875718100069
curr_Factors:  [100.55875718  -1.05673756  -1.06794209]
mat_Sqrt:  [[12.0138789   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00356088  0.03163467 -0.23144493]
Stock Position:  0.003560884549497511
Bond Position:  [-7.90626815]


portfolio before change:  [-7.54884638]
curr_Stock_Price:  100.65199133909633
curr_Factors:  [100.65199134  -1.13224562  -1.07588944]
mat_Sqrt:  [[11.0621999   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00213781  0.01871434 -0.0272502 ]
Stock Position:  -0.00213780672569777
Bond Position:  [-7.33367187]


portfolio before change:  [-7.5514715]
curr_Stock_Price:  101.45110908889727
curr_Factors:  [101.45110909  -1.0444408   -1.05922868]
mat_Sqrt:  [[12.37783682  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00780484 -0.00645224 -0.16887805]
Stock Position:  -0.007804838762084985
Bond Position:  [-6.75966195]


portfolio before change:  [-7.54478789]
curr_Stock_Price:  100.48649905512332
curr_Factors:  [100.48649906  -0.91161245  -1.05884626]
mat_Sqrt:  [[14.0071046   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00181666 -0.01814439  0.28418668]
Stock Position:  -0.0018166562297253642
Bond Position:  [-7.36223846]


portfolio before change:  [-7.54726725]
curr_Stock_Price:  101.34468131534575
curr_Factors:  [101.34468132  -1.02769112  -1.06825845]
mat_Sqrt:  [[12.46067675  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01776076 0.08450449 0.12717836]
Stock Position:  0.01776076070381439
Bond Position:  [-9.34722588]


portfolio before change:  [-7.55328414]
curr_Stock_Price:  101.07169653909612
curr_Factors:  [101.07169654  -0.84524226  -1.05891048]
mat_Sqrt:  [[15.05450667  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00687627 -0.02930924 -0.32513313]
Stock Position:  -0.006876271484506565
Bond Position:  [-6.85828771]


portfolio before change:  [-7.55995416]
curr_Stock_Price:  101.91702069077675
curr_Factors:  [101.91702069  -0.57850208  -1.06245211]
mat_Sqrt:  [[19.75101276  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00460432 -0.01013087 -0.18394957]
Stock Position:  -0.004604316738233571
Bond Position:  [-7.09069591]


portfolio before change:  [-7.55747279]
curr_Stock_Price:  101.18558577382669
curr_Factors:  [101.18558577  -0.58815096  -1.0423302 ]
mat_Sqrt:  [[19.8157119   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00353568 -0.02004122  0.157688  ]
Stock Position:  -0.0035356835354414078
Bond Position:  [-7.19971258]


portfolio before change:  [-7.56077927]
curr_Stock_Price:  101.86620735274346
curr_Factors:  [101.86620735  -0.73770765  -1.05431277]
mat_Sqrt:  [[16.97327154  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.0009439  0.02012299 0.02090435]
Stock Position:  0.0009439030792875246
Bond Position:  [-7.6569311]


portfolio before change:  [-7.56091735]
curr_Stock_Price:  102.73398870666368
curr_Factors:  [102.73398871  -0.52246089  -1.06717246]
mat_Sqrt:  [[20.95777431  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01356318 -0.03894209 -0.21304889]
Stock Position:  0.013563182252601278
Bond Position:  [-8.95431716]


portfolio before change:  [-7.56013425]
curr_Stock_Price:  102.87425501427306
curr_Factors:  [102.87425501  -0.83671469  -1.08507332]
mat_Sqrt:  [[15.05513914  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00425278 0.00499565 0.26108521]
Stock Position:  0.00425278488874496
Bond Position:  [-7.99763633]


portfolio before change:  [-7.56194438]
curr_Stock_Price:  102.68370618663698
curr_Factors:  [102.68370619  -1.14799757  -1.06989166]
mat_Sqrt:  [[11.17595079  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00423833 -0.01051228  0.11145734]
Stock Position:  0.004238331529329633
Bond Position:  [-7.99715197]


portfolio before change:  [-7.56236812]
curr_Stock_Price:  102.81960002999625
curr_Factors:  [102.81960003  -1.13802882  -1.05042068]
mat_Sqrt:  [[11.52509114  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00280933  0.03263386  0.55173925]
Stock Position:  -0.0028093304496197707
Bond Position:  [-7.27351389]


portfolio before change:  [-7.56384534]
curr_Stock_Price:  103.02177318320341
curr_Factors:  [103.02177318  -1.27111588  -1.04863805]
mat_Sqrt:  [[10.12681069  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00805537 -0.00947577 -0.02319602]
Stock Position:  0.008055371264780425
Bond Position:  [-8.39372397]


portfolio before change:  [-7.56824649]
curr_Stock_Price:  102.60566959458326
curr_Factors:  [102.60566959  -1.28075732  -1.04421271]
mat_Sqrt:  [[10.03343651  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01142491 0.00947595 0.27105218]
Stock Position:  0.011424910291823598
Bond Position:  [-8.74050706]


portfolio before change:  [-7.56464716]
curr_Stock_Price:  103.01634793555719
curr_Factors:  [103.01634794  -1.42711481  -1.03284487]
mat_Sqrt:  [[ 8.80155159  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01075408 -0.00408367  0.1765487 ]
Stock Position:  0.01075408061914396
Bond Position:  [-8.67249327]


portfolio before change:  [-7.56281181]
curr_Stock_Price:  103.28782437045187
curr_Factors:  [103.28782437  -1.41055785  -1.06230279]
mat_Sqrt:  [[ 8.71162949  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01602208  0.02337688  0.21947269]
Stock Position:  -0.016022082836045906
Bond Position:  [-5.90792573]


portfolio before change:  [-7.56674269]
curr_Stock_Price:  103.48707110399491
curr_Factors:  [103.4870711   -1.34888332  -1.05222569]
mat_Sqrt:  [[ 9.37772953  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00208921  0.01675201  0.06465661]
Stock Position:  -0.00208921308510641
Bond Position:  [-7.35053615]


portfolio before change:  [-7.56544355]
curr_Stock_Price:  102.42542068743488
curr_Factors:  [102.42542069  -1.50912828  -1.03406363]
mat_Sqrt:  [[ 8.0521812   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00565058 -0.02133872 -0.65028419]
Stock Position:  -0.005650579417506277
Bond Position:  [-6.98668058]


portfolio before change:  [-7.56508465]
curr_Stock_Price:  102.2073377953542
curr_Factors:  [102.2073378   -1.5201239   -1.02675771]
mat_Sqrt:  [[ 8.00544444  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00405597  0.00394589 -0.0760035 ]
Stock Position:  0.004055971735528132
Bond Position:  [-7.97963472]


portfolio before change:  [-7.56382067]
curr_Stock_Price:  102.76491003852951
curr_Factors:  [102.76491004  -1.48648075  -1.02439021]
mat_Sqrt:  [[ 8.34425259  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.0037846  0.0466936  0.07907696]
Stock Position:  0.0037845962079655297
Bond Position:  [-7.95274436]


portfolio before change:  [-7.56544251]
curr_Stock_Price:  102.5990576484655
curr_Factors:  [102.59905765  -1.75619098  -1.02465555]
mat_Sqrt:  [[ 6.35970642  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00048347 -0.02231216 -0.25064375]
Stock Position:  0.0004834746294603452
Bond Position:  [-7.61504655]


portfolio before change:  [-7.56621624]
curr_Stock_Price:  102.9676638249579
curr_Factors:  [102.96766382  -2.04054607  -1.04451351]
mat_Sqrt:  [[ 4.70843425  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.04464918 -0.1618128  -1.63557827]
Stock Position:  0.04464917626970056
Bond Position:  [-12.16363761]


portfolio before change:  [-7.55786069]
curr_Stock_Price:  103.18885713329446
curr_Factors:  [103.18885713  -2.25374005  -1.05714181]
mat_Sqrt:  [[ 3.76474079  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0059437  -0.02154313  0.0577554 ]
Stock Position:  -0.00594369861832013
Bond Position:  [-6.94453722]


portfolio before change:  [-7.55928919]
curr_Stock_Price:  103.283138856192
curr_Factors:  [103.28313886  -2.39007442  -1.05452138]
mat_Sqrt:  [[ 3.29655616  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.02330824 0.03798193 0.0029741 ]
Stock Position:  0.023308242885396756
Bond Position:  [-9.96663768]


portfolio before change:  [-7.56268833]
curr_Stock_Price:  103.19075833695689
curr_Factors:  [103.19075834  -2.31924825  -1.05968227]
mat_Sqrt:  [[ 3.51714219  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01482409 -0.05218142 -0.39574898]
Stock Position:  0.014824091172219405
Bond Position:  [-9.09239754]


portfolio before change:  [-7.55825719]
curr_Stock_Price:  103.56634691635276
curr_Factors:  [103.56634692  -2.1087296   -1.06817794]
mat_Sqrt:  [[ 4.32021385  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.05192116 -0.1286583   0.26698079]
Stock Position:  -0.05192115728276865
Bond Position:  [-2.1809726]


portfolio before change:  [-7.56683227]
curr_Stock_Price:  103.72625169859366
curr_Factors:  [103.7262517   -2.05051279  -1.10435532]
mat_Sqrt:  [[ 4.4233049   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00867219 -0.00463928  0.00194504]
Stock Position:  -0.008672186705962969
Bond Position:  [-6.66729885]


portfolio before change:  [-7.56935523]
curr_Stock_Price:  103.9210692931489
curr_Factors:  [103.92106929  -2.07740758  -1.10534305]
mat_Sqrt:  [[ 4.30975488  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01030225  0.02856729 -0.06265403]
Stock Position:  -0.010302253684181632
Bond Position:  [-6.49873401]


portfolio before change:  [-7.57216787]
curr_Stock_Price:  104.11522613489906
curr_Factors:  [104.11522613  -2.03962952  -1.12289551]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-7.57216787]
Stock Price:  103.98619974345975
PL:  [-11.55836762]
Settle:  Tensor("sub_358:0", shape=(), dtype=float64)
PL:  Tensor("sub_359:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  180
output_Z_Vals[:, i, :]:  [[ 1.19260232e+02 -2.92559343e+01 -2.92733494e+01]
 [ 5.60984589e-02 -6.35112489e-02 -1.29793482e-01]
 [-3.90819503e-02  3.48761189e-02  1.08340373e-01]
 [-1.20360348e-01 -2.47383804e-03  6.26091141e-03]
 [ 4.87522462e-02  2.68748366e-02 -7.00715833e-02]
 [ 7.25030818e-02  3.07458123e-02  1.25185411e-03]
 [ 3.40107905e-02  4.73435800e-02 -3.23102137e-02]
 [-1.08248975e-01 -5.28370046e-02 -1.17401798e-01]
 [ 4.23812034e-02  1.28208996e-02 -7.49159419e-02]
 [-6.06300659e-02  4.21324913e-01  1.94890785e-01]
 [ 5.85186724e-02  8.98531880e-02 -8.27962739e-02]
 [-2.83548339e-02  3.30442277e-02 -7.14682743e-03]
 [-8.31875310e-02 -2.70842531e-02 -5.72090289e-02]
 [ 3.66322130e-02  3.14608385e-03  1.47267253e-01]
 [ 1.52105233e-01  1.23254492e-01 -5.01464237e-02]
 [-7.74230646e-02 -9.93137550e-02 -1.17850463e-01]
 [-7.22020784e-02 -5.36957916e-02 -4.04768762e-02]
 [-1.11165066e-01 -1.43072473e-01  6.26833349e-02]
 [ 2.62817054e-02  3.41923312e-02 -3.50643835e-02]
 [-1.81600672e-02 -4.16478219e-04  7.71027680e-02]
 [ 9.75124811e-03 -5.95735595e-02  3.51956686e-02]
 [ 1.22753115e-01 -4.75593119e-02  2.60501323e-01]
 [-1.00845082e-01  1.74171435e-01  4.24556702e-01]
 [-7.03540172e-02 -5.23928477e-04 -8.14962863e-02]
 [-4.46312692e-01  1.23758511e-01  1.22556744e-01]
 [-7.27110127e-02 -1.87826204e-01  1.11672615e-01]
 [ 1.11649537e-01  5.95237491e-02 -8.31918562e-02]
 [-5.02998379e-02  7.32458967e-02  2.92269000e-02]
 [ 4.33006190e-03 -5.86528273e-03  2.02371912e-01]
 [ 4.57808658e-02  3.86532955e-02 -1.03194281e-01]
 [ 4.23131018e-03  2.10653443e-01  8.95328589e-03]
 [ 1.71313077e-02 -8.80928774e-02 -8.88292939e-02]
 [ 1.21717613e-01 -5.68092047e-02  6.09307180e-02]
 [-4.37714626e-02 -7.93702244e-02  9.63990184e-03]
 [-2.19378507e-01  1.60510914e-01  1.62818469e-02]
 [ 2.09322072e-01 -1.92106641e-02 -1.03870565e-02]
 [ 2.96170781e-02  5.60882291e-02 -1.00606469e-01]
 [-1.70051035e-02  3.36601976e-02 -5.18222277e-02]
 [ 1.09392255e-01 -1.56468240e-01 -2.73835379e-02]
 [-5.98731361e-01  3.13161784e-01  3.51945453e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.26023247 -29.25593426 -29.27334937]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  8.31486419  -9.25153874 -83.50871763]
init_Out:  [2.49911038]
Stock Position:  8.31486419409362
Bond position:  [-828.98730903]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-3.50290674]
curr_Stock_Price:  99.29062133869537
curr_Factors:  [99.29062134 -1.10412962 -1.04164093]
mat_Sqrt:  [[11.61480488  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00240767 -0.02008402 -0.37026468]
Stock Position:  0.00240767040243433
Bond Position:  [-3.74196583]


portfolio before change:  [-3.50355819]
curr_Stock_Price:  99.21433345828481
curr_Factors:  [99.21433346 -1.06726829 -1.05772911]
mat_Sqrt:  [[11.84949309  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00135589  0.0110288   0.30906493]
Stock Position:  -0.0013558864175593928
Bond Position:  [-3.36903482]


portfolio before change:  [-3.50267985]
curr_Stock_Price:  98.25592338549193
curr_Factors:  [98.25592339 -0.74473925 -1.070593  ]
mat_Sqrt:  [[15.99447405  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00744921 -0.0007823   0.01786064]
Stock Position:  -0.007449211429847198
Bond Position:  [-2.7707507]


portfolio before change:  [-3.50880607]
curr_Stock_Price:  99.03182427633834
curr_Factors:  [99.03182428 -1.05216809 -1.04640842]
mat_Sqrt:  [[12.14435855  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00289376  0.00849857 -0.19989472]
Stock Position:  0.002893759213547592
Bond Position:  [-3.79538032]


portfolio before change:  [-3.50877282]
curr_Stock_Price:  99.20726927308328
curr_Factors:  [99.20726927 -0.59406449 -1.06859667]
mat_Sqrt:  [[18.81303786  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00390965 0.00972268 0.00357119]
Stock Position:  0.003909654010817029
Bond Position:  [-3.89663892]


portfolio before change:  [-3.51330287]
curr_Stock_Price:  98.17317787309959
curr_Factors:  [98.17317787 -0.56049329 -1.04583405]
mat_Sqrt:  [[19.69580572  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00145401  0.01497135 -0.09217205]
Stock Position:  0.0014540101632722325
Bond Position:  [-3.65604767]


portfolio before change:  [-3.51185033]
curr_Stock_Price:  99.48649468062168
curr_Factors:  [99.48649468 -0.60106724 -1.04848827]
mat_Sqrt:  [[19.1148667   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00698816 -0.01670853 -0.33491465]
Stock Position:  -0.006988160827758857
Bond Position:  [-2.81662271]


portfolio before change:  [-3.52203303]
curr_Stock_Price:  100.89324478337106
curr_Factors:  [100.89324478  -0.63906487  -1.05466929]
mat_Sqrt:  [[18.54738497  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00147838  0.00405432 -0.21371433]
Stock Position:  0.0014783801075086184
Bond Position:  [-3.67119159]


portfolio before change:  [-3.52254267]
curr_Stock_Price:  100.8589430702777
curr_Factors:  [100.85894307  -0.5844032   -1.02510575]
mat_Sqrt:  [[20.17035564  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-4.94269348e-04  1.33234636e-01  5.55969163e-01]
Stock Position:  -0.0004942693483811682
Bond Position:  [-3.47269118]


portfolio before change:  [-3.52288753]
curr_Stock_Price:  100.6783693933364
curr_Factors:  [100.67836939  -0.62014675  -1.04148609]
mat_Sqrt:  [[19.11165059  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00229901  0.02841407 -0.23619472]
Stock Position:  0.0022990140452431116
Bond Position:  [-3.75434851]


portfolio before change:  [-3.52353614]
curr_Stock_Price:  100.6003851669942
curr_Factors:  [100.60038517  -0.77129945  -1.0581138 ]
mat_Sqrt:  [[16.14713825  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00179354  0.0104495  -0.02038791]
Stock Position:  -0.0017935361165978187
Bond Position:  [-3.34310571]


portfolio before change:  [-3.52395389]
curr_Stock_Price:  100.60029274855505
curr_Factors:  [100.60029275  -0.67302299  -1.05872362]
mat_Sqrt:  [[17.80374018  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00536767 -0.00856479 -0.16320144]
Stock Position:  -0.005367669187431072
Bond Position:  [-2.9839648]


portfolio before change:  [-3.52759361]
curr_Stock_Price:  101.20888145909072
curr_Factors:  [101.20888146  -0.6875917   -1.05970016]
mat_Sqrt:  [[17.63516026  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00378643 0.00099488 0.42011248]
Stock Position:  0.0037864269808971446
Bond Position:  [-3.91081365]


portfolio before change:  [-3.52483288]
curr_Stock_Price:  102.0671088130211
curr_Factors:  [102.06710881  -0.76109694  -1.05687636]
mat_Sqrt:  [[16.5710505   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00875331  0.03897649 -0.14305379]
Stock Position:  0.008753310734890635
Bond Position:  [-4.41825799]


portfolio before change:  [-3.53142]
curr_Stock_Price:  101.37767684912157
curr_Factors:  [101.37767685  -0.64823562  -1.05148101]
mat_Sqrt:  [[18.52528002  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0056163  -0.03140577 -0.33619457]
Stock Position:  -0.0056162961992641345
Bond Position:  [-2.96205294]


portfolio before change:  [-3.53009545]
curr_Stock_Price:  101.0759054578953
curr_Factors:  [101.07590546  -0.2900439   -1.0240874 ]
mat_Sqrt:  [[27.15986886  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00301367 -0.0169801  -0.11546926]
Stock Position:  -0.0030136671838825258
Bond Position:  [-3.22548631]


portfolio before change:  [-3.53006688]
curr_Stock_Price:  100.93263248755737
curr_Factors:  [ 1.00932632e+02 -2.89333715e-02 -1.05103525e+00]
mat_Sqrt:  [[34.27734592  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00297759 -0.04524349  0.17881811]
Stock Position:  -0.0029775934031302013
Bond Position:  [-3.22953054]


portfolio before change:  [-3.5192878]
curr_Stock_Price:  97.17698414617337
curr_Factors:  [ 9.71769841e+01 -4.12159291e-02 -1.04915722e+00]
mat_Sqrt:  [[32.66031552  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00061258  0.01081256 -0.10002893]
Stock Position:  0.0006125801295857898
Bond Position:  [-3.57881649]


portfolio before change:  [-3.52007431]
curr_Stock_Price:  96.62338715184163
curr_Factors:  [96.62338715  0.3144847  -1.06646077]
mat_Sqrt:  [[45.55155438  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-5.33962902e-05 -1.31701977e-04  2.19952736e-01]
Stock Position:  -5.3396290231210445e-05
Bond Position:  [-3.51491498]


portfolio before change:  [-3.52052889]
curr_Stock_Price:  96.90796849964518
curr_Factors:  [96.9079685   0.12425154 -1.07878174]
mat_Sqrt:  [[37.30888678  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0004127  -0.01883881  0.10040345]
Stock Position:  0.000412699292961662
Bond Position:  [-3.56052274]


portfolio before change:  [-3.52124318]
curr_Stock_Price:  96.25568476311066
curr_Factors:  [96.25568476  0.28820567 -1.11159349]
mat_Sqrt:  [[42.25067008  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00413484 -0.01503957  0.74313777]
Stock Position:  0.0041348397239466626
Bond Position:  [-3.91924501]


portfolio before change:  [-3.52566979]
curr_Stock_Price:  95.30361177332024
curr_Factors:  [95.30361177  0.23389538 -1.12558314]
mat_Sqrt:  [[39.07097828  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-2.47900649e-04  5.50778439e-02  1.21114210e+00]
Stock Position:  -0.0002479006491435193
Bond Position:  [-3.50204396]


portfolio before change:  [-3.52631778]
curr_Stock_Price:  96.15156731053494
curr_Factors:  [96.15156731  0.14446611 -1.12110434]
mat_Sqrt:  [[36.20826995  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-2.40284622e-03 -1.65680732e-04 -2.32486221e-01]
Stock Position:  -0.0024028462244259927
Bond Position:  [-3.29528035]


portfolio before change:  [-3.5243475]
curr_Stock_Price:  95.16015272236882
curr_Factors:  [95.16015272  0.10431109 -1.13808669]
mat_Sqrt:  [[33.84481119  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01235346  0.03913588  0.34962028]
Stock Position:  -0.012353458502927088
Bond Position:  [-2.3487905]


portfolio before change:  [-3.54262465]
curr_Stock_Price:  96.61590129563209
curr_Factors:  [96.6159013   0.18601517 -1.12428206]
mat_Sqrt:  [[37.80632623  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00144858 -0.05939586  0.31857089]
Stock Position:  -0.00144858262613986
Bond Position:  [-3.40266853]


portfolio before change:  [-3.54254571]
curr_Stock_Price:  96.26777267917743
curr_Factors:  [96.26777268  0.21146678 -1.14269825]
mat_Sqrt:  [[37.93606091  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00253598  0.01882306 -0.23732321]
Stock Position:  0.0025359767167252
Bond Position:  [-3.78667854]


portfolio before change:  [-3.53884427]
curr_Stock_Price:  97.91400514896267
curr_Factors:  [ 9.79140051e+01  2.41807424e-02 -1.13709427e+00]
mat_Sqrt:  [[32.17455956  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00131914  0.02316239  0.08337621]
Stock Position:  -0.001319139144366604
Bond Position:  [-3.40968207]


portfolio before change:  [-3.54133109]
curr_Stock_Price:  99.4760704255158
curr_Factors:  [99.47607043 -0.10544047 -1.13920357]
mat_Sqrt:  [[28.65342779  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00158751 -0.00185477  0.57731073]
Stock Position:  0.0015875103941032328
Bond Position:  [-3.69925038]


portfolio before change:  [-3.54151893]
curr_Stock_Price:  99.64904139091911
curr_Factors:  [ 9.96490414e+01 -9.55039321e-02 -1.15879572e+00]
mat_Sqrt:  [[28.42743724  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00090456  0.01222325 -0.29438456]
Stock Position:  0.0009045643112135588
Bond Position:  [-3.6316579]


portfolio before change:  [-3.54307041]
curr_Stock_Price:  98.43575589973787
curr_Factors:  [ 9.84357559e+01 -5.96445325e-02 -1.16394628e+00]
mat_Sqrt:  [[28.95703839  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00039707 0.06661447 0.02554123]
Stock Position:  0.00039706893909917417
Bond Position:  [-3.58215619]


portfolio before change:  [-3.54273249]
curr_Stock_Price:  100.41455413302094
curr_Factors:  [100.41455413  -0.12642798  -1.1601094 ]
mat_Sqrt:  [[27.73706984  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-1.18089053e-04 -2.78574138e-02 -2.53405250e-01]
Stock Position:  -0.00011808905329464653
Bond Position:  [-3.53087463]


portfolio before change:  [-3.54320825]
curr_Stock_Price:  100.70559686585217
curr_Factors:  [100.70559687  -0.16532938  -1.16879655]
mat_Sqrt:  [[26.52467538  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00500245 -0.01796465  0.17381838]
Stock Position:  0.005002445239141293
Bond Position:  [-4.04698248]


portfolio before change:  [-3.55395355]
curr_Stock_Price:  98.65871851953918
curr_Factors:  [98.65871852 -0.16922889 -1.13488658]
mat_Sqrt:  [[26.77720966  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0016377  -0.02509907  0.02749996]
Stock Position:  -0.001637700745218247
Bond Position:  [-3.39238009]


portfolio before change:  [-3.55122968]
curr_Stock_Price:  96.73654873437994
curr_Factors:  [ 9.67365487e+01  6.42044606e-02 -1.13651483e+00]
mat_Sqrt:  [[33.10488734  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00640119  0.05075801  0.04644758]
Stock Position:  -0.006401188206419622
Bond Position:  [-2.93200083]


portfolio before change:  [-3.54386853]
curr_Stock_Price:  95.52932393988173
curr_Factors:  [95.52932394 -0.34550708 -1.15759658]
mat_Sqrt:  [[21.2494198   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0097276  -0.00607495 -0.02963138]
Stock Position:  0.009727597610842326
Bond Position:  [-4.47313936]


portfolio before change:  [-3.53853345]
curr_Stock_Price:  96.13525579321077
curr_Factors:  [96.13525579 -0.54524247 -1.1580247 ]
mat_Sqrt:  [[17.50504178  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00060149  0.01773666 -0.28700225]
Stock Position:  0.0006014873079159476
Bond Position:  [-3.59635758]


portfolio before change:  [-3.53898148]
curr_Stock_Price:  96.13781048763738
curr_Factors:  [96.13781049 -0.37750848 -1.1329913 ]
mat_Sqrt:  [[21.22719011  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00125849  0.01064429 -0.14783439]
Stock Position:  -0.0012584882302007052
Bond Position:  [-3.41799318]


portfolio before change:  [-3.53994013]
curr_Stock_Price:  96.56003971523043
curr_Factors:  [96.56003972 -0.32668737 -1.14570293]
mat_Sqrt:  [[22.14860877  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00450424 -0.0494796  -0.07811761]
Stock Position:  0.004504238736592861
Bond Position:  [-3.9748696]


portfolio before change:  [-3.5483107]
curr_Stock_Price:  94.8119805714911
curr_Factors:  [94.81198057 -0.30630902 -1.13930806]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-3.5483107]
Stock Price:  94.31895981945868
PL:  [-3.5483107]
Settle:  Tensor("sub_360:0", shape=(), dtype=float64)
PL:  Tensor("sub_361:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  181
output_Z_Vals[:, i, :]:  [[ 1.19260232e+02 -2.92559343e+01 -2.92733494e+01]
 [-3.58538488e-03 -6.47737889e-02 -2.48727639e-02]
 [ 2.02144850e-01 -5.23862855e-03 -2.69720615e-01]
 [ 8.47689944e-02  1.68510135e-01  3.79324626e-02]
 [ 2.37311781e-01 -1.28754354e-02 -2.54084224e-02]
 [ 2.98285699e-02  3.45261532e-02  4.77520799e-02]
 [-3.91983633e-02  4.37326313e-02 -1.57793695e-01]
 [ 2.54840244e-01 -1.19513175e-01  1.33163627e-01]
 [-1.17365952e-01 -1.76439885e-02  1.29665727e-01]
 [-3.14777962e-02  3.89203920e-01  1.62891457e-01]
 [ 2.67719687e-02 -1.02426626e-01 -3.44989800e-02]
 [-1.03703131e-01  1.15384681e-01  4.04517331e-02]
 [-6.73405831e-02 -6.36425830e-02 -6.60754084e-02]
 [ 3.39516057e-01  2.57096323e-01  3.43322628e-01]
 [ 1.92222036e-01  2.75522500e-01  7.09476518e-02]
 [-6.00207444e-02 -5.52835006e-02 -1.12384877e-01]
 [-8.66349613e-02  1.43164963e-02 -1.01049734e-01]
 [ 5.59884865e-02 -1.44193265e-01 -9.38809036e-02]
 [ 2.82366959e-02  6.30204744e-02  2.77132300e-02]
 [ 2.92297832e-01 -2.10687174e-01 -5.25001969e-02]
 [ 6.98092467e-02 -3.87401476e-03  1.22424147e-01]
 [ 1.22130841e-02 -1.38793262e-02  1.17594513e-02]
 [-5.75770236e-02  7.17412829e-02  2.97767372e-02]
 [ 4.32787402e-02 -1.51301591e-01  7.20469390e-02]
 [ 5.69551622e-02  3.37381477e-02  7.87501619e-02]
 [ 1.03406417e-01  2.43489119e-04  5.63329328e-02]
 [-1.15825172e-01  7.84361650e-02  8.14512699e-02]
 [ 4.98811946e-02 -1.78825651e-01 -8.44887884e-02]
 [ 5.74139019e-02 -1.01473039e-01 -1.75803026e-01]
 [ 7.76539807e-02 -7.11615440e-03  1.24862097e-01]
 [-6.06303666e-03  2.55379660e-01  1.34639862e-02]
 [ 4.09358992e-02 -1.21056370e-01 -7.15200941e-02]
 [ 3.04230715e-01 -4.35085921e-01 -4.64848796e-01]
 [-5.34225249e-02 -4.77648380e-02  4.21143999e-02]
 [ 1.10315491e-01  1.03477607e-01 -2.32816811e-03]
 [ 8.47165236e-02 -1.65012150e-01 -1.38726811e-01]
 [-2.75696005e-01 -4.96244682e-01  1.30157337e-01]
 [-4.64157368e-02 -3.40686738e-02  4.03190830e-02]
 [-3.54283302e-02  7.60328473e-02 -2.62428957e-02]
 [ 1.45830496e-01 -8.05411562e-03 -1.39473351e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.26023247 -29.25593426 -29.27334937]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  8.31486419  -9.25153874 -83.50871763]
init_Out:  [2.49911038]
Stock Position:  8.31486419409362
Bond position:  [-828.98730903]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [3.68026367]
curr_Stock_Price:  100.15451643628859
curr_Factors:  [100.15451644  -0.96836501  -1.01638425]
mat_Sqrt:  [[13.76273936  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00075094 -0.02048327 -0.07095507]
Stock Position:  -0.0007509383355174305
Bond Position:  [3.75547354]


portfolio before change:  [3.67920672]
curr_Stock_Price:  102.18720214052102
curr_Factors:  [102.18720214  -1.11901495  -1.05357196]
mat_Sqrt:  [[11.63734742  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01262771 -0.0016566  -0.76943784]
Stock Position:  0.012627714368589678
Bond Position:  [2.38881591]


portfolio before change:  [3.68130023]
curr_Stock_Price:  102.329341178477
curr_Factors:  [102.32934118  -1.24683159  -1.07379706]
mat_Sqrt:  [[10.04995132  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00963814 0.05328758 0.10821076]
Stock Position:  0.009638140100661498
Bond Position:  [2.6950357]


portfolio before change:  [3.68339416]
curr_Stock_Price:  102.5116415879923
curr_Factors:  [102.51164159  -1.39372777  -1.07629537]
mat_Sqrt:  [[ 8.67073209  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.02673279 -0.00407157 -0.07248316]
Stock Position:  0.026732790675381757
Bond Position:  [0.94297191]


portfolio before change:  [3.68484775]
curr_Stock_Price:  102.5616067990544
curr_Factors:  [102.5616068   -1.5640204   -1.06604235]
mat_Sqrt:  [[ 7.39201903  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00547447 0.01091813 0.13622339]
Stock Position:  0.005474469653858527
Bond Position:  [3.12337735]


portfolio before change:  [3.68459568]
curr_Stock_Price:  102.44424003988831
curr_Factors:  [102.44424004  -1.74463836  -1.06839348]
mat_Sqrt:  [[ 6.14898363  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01142932  0.01382947 -0.45014149]
Stock Position:  -0.0114293188848041
Bond Position:  [4.85546357]


portfolio before change:  [3.67847112]
curr_Stock_Price:  103.03321042122413
curr_Factors:  [103.03321042  -1.59148959  -1.07507812]
mat_Sqrt:  [[ 7.15981156  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.03895861 -0.03779338  0.37987876]
Stock Position:  0.038958614505608946
Bond Position:  [-0.33556001]


portfolio before change:  [3.67483971]
curr_Stock_Price:  102.94107521381422
curr_Factors:  [102.94107521  -1.58173136  -1.07496655]
mat_Sqrt:  [[ 7.22436132  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01264522 -0.00557952  0.36990023]
Stock Position:  -0.012645216418560385
Bond Position:  [4.97655189]


portfolio before change:  [3.674407]
curr_Stock_Price:  103.02449202170455
curr_Factors:  [103.02449202  -1.45233922  -1.07137757]
mat_Sqrt:  [[ 8.25855763  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00143142 0.12307709 0.46468399]
Stock Position:  0.0014314224958121469
Bond Position:  [3.52693542]


portfolio before change:  [3.67515812]
curr_Stock_Price:  103.2412217654704
curr_Factors:  [103.24122177  -1.48122069  -1.07737661]
mat_Sqrt:  [[ 7.99223871  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00213773 -0.03239014 -0.09841599]
Stock Position:  0.002137730172059221
Bond Position:  [3.45445625]


portfolio before change:  [3.67600018]
curr_Stock_Price:  103.43311994582021
curr_Factors:  [103.43311995  -1.48750037  -1.08525598]
mat_Sqrt:  [[ 7.89452017  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01171277  0.03648784  0.11539753]
Stock Position:  -0.011712774643188173
Bond Position:  [4.88748901]


portfolio before change:  [3.67466659]
curr_Stock_Price:  103.5991413281089
curr_Factors:  [103.59914133  -1.29957647  -1.05798206]
mat_Sqrt:  [[ 9.80576541  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0084105  -0.02012555 -0.18849475]
Stock Position:  -0.008410502428583847
Bond Position:  [4.54598742]


portfolio before change:  [3.6760278]
curr_Stock_Price:  103.50486318320544
curr_Factors:  [103.50486318  -1.24373374  -1.02781052]
mat_Sqrt:  [[10.67681257  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.03898492 0.081301   0.97940389]
Stock Position:  0.038984920946840224
Bond Position:  [-0.35910111]


portfolio before change:  [3.67812871]
curr_Stock_Price:  103.5599051157878
curr_Factors:  [103.55990512  -1.38674216  -1.02558246]
mat_Sqrt:  [[ 9.27966661  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.02304157 0.08712786 0.2023939 ]
Stock Position:  0.023041573988308466
Bond Position:  [1.2919455]


portfolio before change:  [3.66951064]
curr_Stock_Price:  103.17887327872566
curr_Factors:  [103.17887328  -1.52186032  -1.02322146]
mat_Sqrt:  [[ 8.09609892  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01042337 -0.01748218 -0.32060277]
Stock Position:  -0.010423368832714363
Bond Position:  [4.74498209]


portfolio before change:  [3.66296831]
curr_Stock_Price:  103.86343990139201
curr_Factors:  [103.8634399   -1.40342917  -1.02937882]
mat_Sqrt:  [[ 9.11816855  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01172297  0.00452727 -0.28826677]
Stock Position:  -0.011722968378668236
Bond Position:  [4.88055613]


portfolio before change:  [3.66615997]
curr_Stock_Price:  103.64322658981581
curr_Factors:  [103.64322659  -1.14610941  -1.03520972]
mat_Sqrt:  [[11.70054429  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00282911 -0.04559791 -0.26781609]
Stock Position:  0.0028291054146299707
Bond Position:  [3.37294236]


portfolio before change:  [3.66737047]
curr_Stock_Price:  103.92205995823191
curr_Factors:  [103.92205996  -1.09112665  -1.05306158]
mat_Sqrt:  [[12.17583155  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00291732 0.01992882 0.07905813]
Stock Position:  0.002917321642484515
Bond Position:  [3.36419639]


portfolio before change:  [3.66993656]
curr_Stock_Price:  104.65750967519254
curr_Factors:  [104.65750968  -1.47021065  -1.07285964]
mat_Sqrt:  [[ 8.2286578   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.03355849 -0.06662513 -0.14976845]
Stock Position:  0.03355849293822237
Bond Position:  [0.15778826]


portfolio before change:  [3.66949619]
curr_Stock_Price:  104.6437994695165
curr_Factors:  [104.64379947  -1.69013639  -1.04985722]
mat_Sqrt:  [[ 6.75692959  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01401509 -0.00122507  0.34924202]
Stock Position:  0.014015085284618466
Bond Position:  [2.20290442]


portfolio before change:  [3.66385448]
curr_Stock_Price:  104.22160487608288
curr_Factors:  [104.22160488  -1.74256052  -1.0711454 ]
mat_Sqrt:  [[ 6.25145057  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00228029 -0.00438903  0.03354644]
Stock Position:  0.0022802882660551004
Bond Position:  [3.42619918]


portfolio before change:  [3.66440575]
curr_Stock_Price:  104.2755321211605
curr_Factors:  [104.27553212  -1.95385266  -1.05900287]
mat_Sqrt:  [[ 5.12525977  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00968663  0.02268659  0.08494474]
Stock Position:  -0.009686634990664258
Bond Position:  [4.67448477]


portfolio before change:  [3.66387974]
curr_Stock_Price:  104.39015990756828
curr_Factors:  [104.39015991  -2.15290685  -1.05233494]
mat_Sqrt:  [[ 4.23292663  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01277572 -0.04784576  0.20552986]
Stock Position:  0.012775716295909656
Bond Position:  [2.33022067]


portfolio before change:  [3.66686736]
curr_Stock_Price:  104.60121099708832
curr_Factors:  [104.601211    -2.27772785  -1.07525712]
mat_Sqrt:  [[ 3.6589278   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.02019747 0.01066894 0.22465229]
Stock Position:  0.020197470660466586
Bond Position:  [1.55418747]


portfolio before change:  [3.67250799]
curr_Stock_Price:  104.8708657266092
curr_Factors:  [104.87086573  -2.26587151  -1.08461793]
mat_Sqrt:  [[ 3.67752622  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [3.12469875e-02 7.69980203e-05 1.60702177e-01]
Stock Position:  0.03124698747238307
Bond Position:  [0.39560936]


portfolio before change:  [3.67385269]
curr_Stock_Price:  104.91231755691079
curr_Factors:  [104.91231756  -2.42663764  -1.09393077]
mat_Sqrt:  [[ 3.10358074  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.03131022  0.02480369  0.2323578 ]
Stock Position:  -0.031310217404563405
Bond Position:  [6.95868016]


portfolio before change:  [3.68796712]
curr_Stock_Price:  104.4893074695657
curr_Factors:  [104.48930747  -2.18980943  -1.04958566]
mat_Sqrt:  [[ 4.09468444  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00684246 -0.05654964 -0.241023  ]
Stock Position:  0.006842464880313149
Bond Position:  [2.9730027]


portfolio before change:  [3.68775077]
curr_Stock_Price:  104.40337414501491
curr_Factors:  [104.40337415  -2.05709257  -1.06814067]
mat_Sqrt:  [[ 4.58609431  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00412295 -0.03208859 -0.5015171 ]
Stock Position:  0.004122949877543744
Bond Position:  [3.25730089]


portfolio before change:  [3.69018923]
curr_Stock_Price:  104.89604901772141
curr_Factors:  [104.89604902  -1.97539209  -1.07678247]
mat_Sqrt:  [[ 4.95697308  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.02077026 -0.00225033  0.35619681]
Stock Position:  0.020770258307149417
Bond Position:  [1.5114712]


portfolio before change:  [3.70050238]
curr_Stock_Price:  105.38348647949502
curr_Factors:  [105.38348648  -1.94220451  -1.10147359]
mat_Sqrt:  [[ 5.02250015  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00065289 0.08075814 0.038409  ]
Stock Position:  0.0006528944510178097
Bond Position:  [3.63169809]


portfolio before change:  [3.70095725]
curr_Stock_Price:  105.38483449162983
curr_Factors:  [105.38483449  -1.93216204  -1.11180195]
mat_Sqrt:  [[ 5.02112869  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00462272 -0.03828139 -0.20402692]
Stock Position:  0.004622717428407158
Bond Position:  [3.21379294]


portfolio before change:  [3.69961583]
curr_Stock_Price:  105.00774660235133
curr_Factors:  [105.0077466   -2.0238807   -1.10005544]
mat_Sqrt:  [[ 4.61862938  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.04289367 -0.13758625 -1.32608423]
Stock Position:  0.042893673800356
Bond Position:  [-0.8045522]


portfolio before change:  [3.70498133]
curr_Stock_Price:  105.13517972280755
curr_Factors:  [105.13517972  -1.94351682  -1.1220026 ]
mat_Sqrt:  [[ 4.90241299  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00939522 -0.01510457  0.12014066]
Stock Position:  -0.009395218628188725
Bond Position:  [4.69274933]


portfolio before change:  [3.70737442]
curr_Stock_Price:  104.94290502045924
curr_Factors:  [104.94290502  -1.88342479  -1.10674104]
mat_Sqrt:  [[ 5.27643464  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0213235   0.03272249 -0.00664162]
Stock Position:  0.02132349649983226
Bond Position:  [1.46962476]


portfolio before change:  [3.7181102]
curr_Stock_Price:  105.43776126806777
curr_Factors:  [105.43776127  -2.1562596   -1.1229395 ]
mat_Sqrt:  [[ 3.97061796  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01313106 -0.05218142 -0.39574898]
Stock Position:  0.013131063483586686
Bond Position:  [2.33360027]


portfolio before change:  [3.72103722]
curr_Stock_Price:  105.63845325448793
curr_Factors:  [105.63845325  -2.23489259  -1.12951628]
mat_Sqrt:  [[ 3.65323682  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.071701   -0.15692635  0.37130265]
Stock Position:  -0.07170099973147623
Bond Position:  [11.29541993]


portfolio before change:  [3.7228833]
curr_Stock_Price:  105.63239945385271
curr_Factors:  [105.63239945  -1.8477193   -1.1105439 ]
mat_Sqrt:  [[ 5.48327162  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00712445 -0.01077346  0.11501912]
Stock Position:  -0.007124448793557793
Bond Position:  [4.47545592]


portfolio before change:  [3.72542998]
curr_Stock_Price:  105.35347014613083
curr_Factors:  [105.35347015  -1.62717384  -1.11268094]
mat_Sqrt:  [[ 6.80369808  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00570601  0.0240437  -0.07486368]
Stock Position:  -0.005706011454092825
Bond Position:  [4.32657809]


portfolio before change:  [3.72497296]
curr_Stock_Price:  105.52835216109153
curr_Factors:  [105.52835216  -1.68885426  -1.1138223 ]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [3.72497296]
Stock Price:  105.83472532530078
PL:  [-2.10975236]
Settle:  Tensor("sub_362:0", shape=(), dtype=float64)
PL:  Tensor("sub_363:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  182
output_Z_Vals[:, i, :]:  [[ 1.19260232e+02 -2.92559343e+01 -2.92733494e+01]
 [-1.02204678e-01  2.59745866e-01  3.70780207e-02]
 [-5.52459525e-02 -7.60355056e-02 -7.31610048e-02]
 [ 8.83658508e-02  2.01216457e-01  3.83694163e-02]
 [ 2.12566150e-01 -2.74111075e-02 -5.31865877e-02]
 [ 7.57917109e-02  2.87546673e-02 -1.68064428e-01]
 [ 3.69304262e-02  4.75216287e-02 -3.34349888e-02]
 [-7.09881227e-02  8.36215425e-02 -7.83223247e-03]
 [-1.97924404e-01 -5.52267833e-02  1.75822821e-01]
 [-4.66851276e-02  3.50914095e-01  1.46655419e-01]
 [ 5.21562472e-02  9.42150290e-03 -7.10798816e-02]
 [-4.87229066e-02  8.58431093e-02  6.52227619e-03]
 [-7.11675043e-02 -5.44297992e-02 -6.46515234e-02]
 [ 6.23273034e-02  6.85927571e-02  1.78576241e-01]
 [ 1.52938779e-01  1.28138609e-01 -4.56756563e-02]
 [-7.84859042e-02 -9.82255296e-02 -1.16224336e-01]
 [-7.49074772e-02 -4.33264589e-02 -6.70414206e-02]
 [-4.77699263e-02  8.02572256e-03  4.61767845e-02]
 [ 4.58640174e-02  6.48629082e-02  4.80568196e-02]
 [ 1.00220890e-01 -3.29614967e-02  3.71167593e-02]
 [-3.98892798e-02 -1.16059706e-02 -2.62268492e-02]
 [ 1.00593645e-01 -6.29578712e-02  1.01980117e-01]
 [-3.85562036e-02 -3.36496400e-02  2.26086436e-01]
 [-6.40070342e-02 -6.74962789e-04 -8.33456240e-02]
 [-1.55028337e-01  8.19488322e-02  6.33589344e-02]
 [ 1.32217509e-02 -9.06491891e-02  8.40552664e-02]
 [ 1.06243886e-03  5.09096404e-02 -4.14274204e-02]
 [-5.07806065e-02  7.36225950e-02  2.93687317e-02]
 [ 6.17231568e-02 -6.68238913e-02  5.87390186e-02]
 [-1.01344260e-02 -4.45132811e-02 -3.97921466e-02]
 [-4.41024528e-02  3.46424383e-01  1.28115026e-02]
 [ 1.92276193e-02 -1.10278477e-01 -7.03630678e-02]
 [ 8.80100104e-02 -5.56417478e-02  4.34133314e-02]
 [-5.07756774e-02 -8.62081628e-02 -9.62867510e-03]
 [-1.30744029e-01  6.47559435e-02  3.58360142e-02]
 [ 8.47165236e-02 -1.65012150e-01 -1.38726811e-01]
 [-2.38226896e-01 -4.14698553e-01  9.12618758e-02]
 [-5.48781117e-02 -5.06144958e-02  8.03342192e-02]
 [-3.07338297e-02  6.61879396e-02 -2.91884822e-02]
 [ 2.02086933e-01 -1.23979377e-02 -1.99384746e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.26023247 -29.25593426 -29.27334937]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  8.31486419  -9.25153874 -83.50871763]
init_Out:  [2.49911038]
Stock Position:  8.31486419409362
Bond position:  [-828.98730903]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [9.42850203]
curr_Stock_Price:  100.84583721132387
curr_Factors:  [100.84583721  -1.11628406  -0.98927216]
mat_Sqrt:  [[12.28079631  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00715992  0.08213885  0.10577327]
Stock Position:  -0.007159922473553378
Bond Position:  [10.15055041]


portfolio before change:  [9.43347209]
curr_Stock_Price:  100.32891052917662
curr_Factors:  [100.32891053  -1.18511851  -0.97178002]
mat_Sqrt:  [[11.60638493  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00621581 -0.02404454 -0.20870798]
Stock Position:  -0.006215812137514547
Bond Position:  [10.05709775]


portfolio before change:  [9.4353767]
curr_Stock_Price:  100.22475698777677
curr_Factors:  [100.22475699  -1.40063072  -0.98311478]
mat_Sqrt:  [[ 9.24118143  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.0109719  0.06363023 0.10945726]
Stock Position:  0.010971904677087465
Bond Position:  [8.33572022]


portfolio before change:  [9.43725868]
curr_Stock_Price:  100.30131152223363
curr_Factors:  [100.30131152  -1.61659241  -0.97982746]
mat_Sqrt:  [[ 7.47645613  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.02688463 -0.00866815 -0.15172653]
Stock Position:  0.026884626550228826
Bond Position:  [6.74069538]


portfolio before change:  [9.45132643]
curr_Stock_Price:  100.79323247700135
curr_Factors:  [100.79323248  -1.84245365  -1.00153282]
mat_Sqrt:  [[ 5.86548251  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00719943  0.00909302 -0.47944103]
Stock Position:  0.007199432511025694
Bond Position:  [8.72567236]


portfolio before change:  [9.45180306]
curr_Stock_Price:  100.70792789159151
curr_Factors:  [100.70792789  -1.73999957  -1.02004846]
mat_Sqrt:  [[ 6.37367675  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00491593  0.01502766 -0.09538072]
Stock Position:  0.004915928766116074
Bond Position:  [8.95673006]


portfolio before change:  [9.4536223]
curr_Stock_Price:  100.85023488238623
curr_Factors:  [100.85023488  -1.6203795   -1.01676303]
mat_Sqrt:  [[ 7.21739482  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00975806  0.02644345 -0.02234318]
Stock Position:  -0.009758059978282326
Bond Position:  [10.43772494]


portfolio before change:  [9.44639038]
curr_Stock_Price:  101.7250722347361
curr_Factors:  [101.72507223  -1.6191847   -1.03802059]
mat_Sqrt:  [[ 7.13540142  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02290841 -0.01746424  0.50157357]
Stock Position:  -0.022908405739660086
Bond Position:  [11.77674961]


portfolio before change:  [9.4397379]
curr_Stock_Price:  102.07973063060862
curr_Factors:  [102.07973063  -1.27595262  -1.06413338]
mat_Sqrt:  [[ 9.83225375  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00078198  0.11096878  0.41836709]
Stock Position:  -0.0007819827162988285
Bond Position:  [9.51956249]


portfolio before change:  [9.44085315]
curr_Stock_Price:  102.17534775010921
curr_Factors:  [102.17534775  -1.17448406  -1.06528888]
mat_Sqrt:  [[10.87990474  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0034826   0.00297934 -0.20277112]
Stock Position:  0.0034826030325701735
Bond Position:  [9.08501698]


portfolio before change:  [9.44018565]
curr_Stock_Price:  101.65757367086175
curr_Factors:  [101.65757367  -1.09233437  -1.05540275]
mat_Sqrt:  [[11.86832307  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00380636  0.02714597  0.01860624]
Stock Position:  -0.0038063585466314707
Bond Position:  [9.82713082]


portfolio before change:  [9.44103881]
curr_Stock_Price:  101.7561725997916
curr_Factors:  [101.7561726   -0.82514059  -1.04688712]
mat_Sqrt:  [[15.65126555  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00548006 -0.01721221 -0.1844328 ]
Stock Position:  -0.005480056060433063
Bond Position:  [9.99866835]


portfolio before change:  [9.44383717]
curr_Stock_Price:  101.47361196791275
curr_Factors:  [101.47361197  -0.98104111  -1.05356373]
mat_Sqrt:  [[13.26586172  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00757961 0.02169093 0.50942831]
Stock Position:  0.007579611899953435
Bond Position:  [8.67470658]


portfolio before change:  [9.45038062]
curr_Stock_Price:  102.19383836581758
curr_Factors:  [102.19383837  -0.77302654  -1.0867509 ]
mat_Sqrt:  [[15.91232465  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00923333  0.04052099 -0.13029993]
Stock Position:  0.009233333440256846
Bond Position:  [8.50679083]


portfolio before change:  [9.44180455]
curr_Stock_Price:  101.14985157220138
curr_Factors:  [101.14985157  -0.81440431  -1.09736187]
mat_Sqrt:  [[14.95187808  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00700556 -0.03106164 -0.33155568]
Stock Position:  -0.007005559375033414
Bond Position:  [10.15041585]


portfolio before change:  [9.44273046]
curr_Stock_Price:  101.19880920284663
curr_Factors:  [101.1988092   -0.9203312   -1.09545226]
mat_Sqrt:  [[13.48129996  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00665447 -0.01370103 -0.19125051]
Stock Position:  -0.006654472082895653
Bond Position:  [10.11615511]


portfolio before change:  [9.44205903]
curr_Stock_Price:  101.48974618573139
curr_Factors:  [101.48974619  -1.02383094  -1.07387997]
mat_Sqrt:  [[12.4565533   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00306159  0.00253796  0.13172951]
Stock Position:  -0.0030615938034945175
Bond Position:  [9.7527794]


portfolio before change:  [9.44395069]
curr_Stock_Price:  101.27009163438971
curr_Factors:  [101.27009163  -0.90537861  -1.06432104]
mat_Sqrt:  [[14.12705098  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00405947 0.02051145 0.13709273]
Stock Position:  0.004059469152069474
Bond Position:  [9.03284788]


portfolio before change:  [9.43827083]
curr_Stock_Price:  99.59276989343961
curr_Factors:  [99.59276989 -0.69491311 -1.03733602]
mat_Sqrt:  [[17.61657899  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00607077 -0.01042334  0.10588378]
Stock Position:  0.00607077314906002
Bond Position:  [8.83366572]


portfolio before change:  [9.44232092]
curr_Stock_Price:  100.07801453423775
curr_Factors:  [100.07801453  -0.77839388  -1.04070918]
mat_Sqrt:  [[16.22976592  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00280611 -0.00367013 -0.0748179 ]
Stock Position:  -0.0028061081152969984
Bond Position:  [9.72315065]


portfolio before change:  [9.44420809]
curr_Stock_Price:  99.83864548704163
curr_Factors:  [99.83864549 -0.89650968 -1.04662426]
mat_Sqrt:  [[14.30231487  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0083752  -0.01990903  0.29092089]
Stock Position:  0.008375195582082213
Bond Position:  [8.6080399]


portfolio before change:  [9.44383875]
curr_Stock_Price:  99.66606311942874
curr_Factors:  [99.66606312 -0.95083909 -1.01589093]
mat_Sqrt:  [[13.94464005  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 4.82240265e-04 -1.06409505e-02  6.44961671e-01]
Stock Position:  0.0004822402654286824
Bond Position:  [9.39577576]


portfolio before change:  [9.44502233]
curr_Stock_Price:  99.6847996659353
curr_Factors:  [99.68479967 -1.00783228 -1.0190557 ]
mat_Sqrt:  [[13.13296161  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-6.17052865e-03 -2.13441975e-04 -2.37761866e-01]
Stock Position:  -0.006170528653443077
Bond Position:  [10.06013024]


portfolio before change:  [9.44341098]
curr_Stock_Price:  100.149742978221
curr_Factors:  [100.14974298  -1.01316311  -1.00650221]
mat_Sqrt:  [[13.28985783  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01053279  0.0259145   0.1807454 ]
Stock Position:  -0.010532794311379552
Bond Position:  [10.49826762]


portfolio before change:  [9.44208287]
curr_Stock_Price:  100.40043372015445
curr_Factors:  [100.40043372  -0.99468627  -0.99422523]
mat_Sqrt:  [[13.739227    0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00204079 -0.02866579  0.23978628]
Stock Position:  0.0020407922752755745
Bond Position:  [9.23718644]


portfolio before change:  [9.44229112]
curr_Stock_Price:  99.93666031635706
curr_Factors:  [99.93666032 -0.83219406 -0.96752393]
mat_Sqrt:  [[16.5240782   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00036791  0.01609904 -0.1181809 ]
Stock Position:  -0.0003679126047809786
Bond Position:  [9.47905908]


portfolio before change:  [9.4431175]
curr_Stock_Price:  100.91128698946946
curr_Factors:  [100.91128699  -0.64895154  -0.97432089]
mat_Sqrt:  [[19.90496809  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00215448  0.02328151  0.08378082]
Stock Position:  -0.002154477807715748
Bond Position:  [9.66052863]


portfolio before change:  [9.43794368]
curr_Stock_Price:  103.87324174300727
curr_Factors:  [103.87324174  -0.7285753   -0.98996915]
mat_Sqrt:  [[18.62727444  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00386465 -0.02113157  0.16756607]
Stock Position:  0.003864646087276175
Bond Position:  [9.03651036]


portfolio before change:  [9.44312382]
curr_Stock_Price:  104.92133493512404
curr_Factors:  [104.92133494  -0.79684297  -1.00397116]
mat_Sqrt:  [[17.32926601  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00111986 -0.01407634 -0.11351592]
Stock Position:  -0.0011198565419964703
Bond Position:  [9.56062067]


portfolio before change:  [9.44596126]
curr_Stock_Price:  103.45482464136056
curr_Factors:  [103.45482464  -0.67489063  -1.02157804]
mat_Sqrt:  [[18.96635035  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00171581  0.10954901  0.03654765]
Stock Position:  -0.0017158112162190997
Bond Position:  [9.6234702]


portfolio before change:  [9.44772256]
curr_Stock_Price:  103.12944318614517
curr_Factors:  [103.12944319  -0.7282688   -1.03819145]
mat_Sqrt:  [[17.62863709  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 1.14441075e-04 -3.48731164e-02 -2.00726247e-01]
Stock Position:  0.00011444107452949497
Bond Position:  [9.43592031]


portfolio before change:  [9.44890977]
curr_Stock_Price:  103.1962577341086
curr_Factors:  [103.19625773  -0.87229568  -1.01801284]
mat_Sqrt:  [[15.58523624  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00612343 -0.01759547  0.12384615]
Stock Position:  0.006123426960127972
Bond Position:  [8.81699502]


portfolio before change:  [9.44980764]
curr_Stock_Price:  103.16289093524661
curr_Factors:  [103.16289094  -0.69025411  -1.01971704]
mat_Sqrt:  [[18.65917636  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00294584 -0.02726141 -0.02746793]
Stock Position:  -0.0029458431949397103
Bond Position:  [9.75370934]


portfolio before change:  [9.44712005]
curr_Stock_Price:  104.48912716143072
curr_Factors:  [104.48912716  -0.97738063  -1.01946318]
mat_Sqrt:  [[14.18576802  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00858304  0.02047763  0.10223017]
Stock Position:  -0.008583041916929726
Bond Position:  [10.34395461]


portfolio before change:  [9.44036194]
curr_Stock_Price:  105.42716131980049
curr_Factors:  [105.42716132  -0.91525652  -1.0264291 ]
mat_Sqrt:  [[15.12478342  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00344722 -0.05218142 -0.39574898]
Stock Position:  0.0034472187158202123
Bond Position:  [9.07693145]


portfolio before change:  [9.4461245]
curr_Stock_Price:  106.76965734005394
curr_Factors:  [106.76965734  -0.73627653  -1.04066969]
mat_Sqrt:  [[18.06050596  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01275189 -0.1311392   0.26034473]
Stock Position:  -0.012751891575546697
Bond Position:  [10.8076396]


portfolio before change:  [9.45591684]
curr_Stock_Price:  106.10769273163629
curr_Factors:  [106.10769273  -0.71662431  -1.04182444]
mat_Sqrt:  [[18.28362415  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00217609 -0.01600571  0.22917117]
Stock Position:  -0.002176090377553414
Bond Position:  [9.68681677]


portfolio before change:  [9.4582254]
curr_Stock_Price:  105.60328922548018
curr_Factors:  [105.60328923  -0.71369966  -1.04354736]
mat_Sqrt:  [[18.21858988  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00192018  0.02093046 -0.08326662]
Stock Position:  -0.0019201781589340907
Bond Position:  [9.66100253]


portfolio before change:  [9.45682495]
curr_Stock_Price:  106.96157334685135
curr_Factors:  [106.96157335  -0.67678316  -1.0721305 ]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [9.45682495]
Stock Price:  106.17210231075686
PL:  [3.28472264]
Settle:  Tensor("sub_364:0", shape=(), dtype=float64)
PL:  Tensor("sub_365:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  183
output_Z_Vals[:, i, :]:  [[ 1.19260232e+02 -2.92559343e+01 -2.92733494e+01]
 [ 8.59196572e-04 -8.55104851e-02 -3.08585609e-02]
 [-2.82265756e-02  4.75098817e-02  9.73861010e-02]
 [ 8.60266765e-02  1.79946276e-01  3.80852484e-02]
 [ 2.18031612e-01 -2.80571605e-02 -5.44821882e-02]
 [ 7.79425501e-02  3.07795188e-02 -3.72217195e-02]
 [ 2.35844837e-02  6.16501787e-02 -1.91541347e-02]
 [-8.43867540e-02  1.01155182e-01 -1.31980607e-02]
 [-1.56191272e-01 -6.52038499e-02  1.35623551e-01]
 [-3.47397095e-02  4.63402846e-02 -4.07800006e-02]
 [ 5.41251425e-02  9.25792961e-02 -7.75386012e-02]
 [-3.16946804e-02  6.40433228e-02 -4.31852781e-03]
 [-9.70562625e-02  1.42355393e-02 -5.36480416e-02]
 [-3.66683944e-02 -1.53556063e-02  1.14017501e-01]
 [ 2.15963552e-01  2.80018370e-01  4.53294927e-02]
 [-7.62428337e-02 -7.54665057e-02 -1.06655698e-01]
 [-7.47474327e-02 -4.54383556e-02 -5.45494296e-02]
 [-4.81700651e-02 -3.42071486e-02  2.99033435e-02]
 [ 7.80348750e-02  6.58727836e-02  8.79787192e-02]
 [ 2.28917836e-01 -6.08327295e-02 -1.19486163e-02]
 [-4.77376195e-02 -8.51972544e-04 -4.30118383e-02]
 [ 5.02821850e-02 -4.01709511e-02  4.88423719e-02]
 [-7.36611373e-02  8.88364358e-02  2.91082796e-01]
 [-1.95438756e-02 -9.90136004e-03 -7.82385529e-02]
 [-2.74445644e-02  5.40774139e-02  8.16695840e-02]
 [ 1.44681492e-02 -8.91796976e-02  8.36478711e-02]
 [-4.97075635e-02  5.30346598e-02 -2.32255606e-02]
 [-5.07806065e-02  7.36225950e-02  2.93687317e-02]
 [ 2.46120580e-02 -8.18290634e-02 -2.10207981e-01]
 [ 8.07024214e-03 -7.37697955e-03 -1.17009113e-01]
 [-2.30432643e-02  2.67660025e-01  2.20923513e-02]
 [ 1.84554499e-02 -1.01545293e-01 -7.87606925e-02]
 [-1.82110419e-02  2.43838647e-03  7.79723216e-02]
 [-4.94721058e-02 -8.49355373e-02 -6.04255282e-03]
 [-2.10000507e-01  1.96285715e-01  2.25448312e-02]
 [ 1.05117353e-01 -1.56387219e-01 -1.28297212e-01]
 [-9.92254859e-02 -1.80608517e-01 -1.85197324e-02]
 [-3.16659377e-02  4.47348146e-03 -3.06802754e-02]
 [-3.86906926e-02  7.44497202e-02  5.82863813e-04]
 [-6.38259212e-01  3.20665412e-01  3.92052514e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.26023247 -29.25593426 -29.27334937]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  8.31486419  -9.25153874 -83.50871763]
init_Out:  [2.49911038]
Stock Position:  8.31486419409362
Bond position:  [-828.98730903]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [2.87141653]
curr_Stock_Price:  100.05723918344917
curr_Factors:  [100.05723918  -0.93527074  -0.98208372]
mat_Sqrt:  [[14.70794689  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00051997 -0.02704079 -0.08803089]
Stock Position:  -0.0005199673411884867
Bond Position:  [2.92344302]


portfolio before change:  [2.87195906]
curr_Stock_Price:  99.71668806979875
curr_Factors:  [99.71668807 -1.04458974 -0.97543407]
mat_Sqrt:  [[13.22764864  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00053834  0.01502394  0.27781544]
Stock Position:  -0.0005383436875770238
Bond Position:  [2.92564091]


portfolio before change:  [2.87184146]
curr_Stock_Price:  100.61448541777975
curr_Factors:  [100.61448542  -1.20009887  -0.98921487]
mat_Sqrt:  [[11.26817626  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00873673 0.05690401 0.10864661]
Stock Position:  0.008736727738129344
Bond Position:  [1.99280009]


portfolio before change:  [2.87240773]
curr_Stock_Price:  100.65078692637407
curr_Factors:  [100.65078693  -1.12026391  -0.99209196]
mat_Sqrt:  [[12.17398264  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01693661 -0.00887245 -0.15542252]
Stock Position:  0.01693661432435597
Bond Position:  [1.16772417]


portfolio before change:  [2.87043672]
curr_Stock_Price:  100.52579232288834
curr_Factors:  [100.52579232  -1.14505451  -0.96497382]
mat_Sqrt:  [[12.18719728  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00583723  0.00973334 -0.10618321]
Stock Position:  0.005837225778146202
Bond Position:  [2.28364498]


portfolio before change:  [2.87523741]
curr_Stock_Price:  101.29931339936334
curr_Factors:  [101.2993134   -1.38742219  -0.96530307]
mat_Sqrt:  [[ 9.63453816  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00220732  0.0194955  -0.05464141]
Stock Position:  0.0022073152631698497
Bond Position:  [2.65163789]


portfolio before change:  [2.87458208]
curr_Stock_Price:  100.85225053373064
curr_Factors:  [100.85225053  -1.54459057  -0.95867799]
mat_Sqrt:  [[ 8.25144238  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01023687  0.03198808 -0.03765039]
Stock Position:  -0.01023687463934609
Bond Position:  [3.90699392]


portfolio before change:  [2.87641109]
curr_Stock_Price:  100.72129239530778
curr_Factors:  [100.7212924   -1.46406994  -0.97319794]
mat_Sqrt:  [[ 8.80297154  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01478941 -0.02061927  0.38689624]
Stock Position:  -0.014789413624177626
Bond Position:  [4.36601994]


portfolio before change:  [2.88222759]
curr_Stock_Price:  100.3649078834031
curr_Factors:  [100.36490788  -1.39888457  -0.96404641]
mat_Sqrt:  [[ 9.44874228  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.004431    0.01465408 -0.11633399]
Stock Position:  -0.004431001510659976
Bond Position:  [3.32694465]


portfolio before change:  [2.88135805]
curr_Stock_Price:  100.65500869065679
curr_Factors:  [100.65500869  -1.47910558  -0.97962008]
mat_Sqrt:  [[ 8.61042135  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00472544  0.02927614 -0.22119605]
Stock Position:  0.004725439939097212
Bond Position:  [2.40571885]


portfolio before change:  [2.88253383]
curr_Stock_Price:  100.84018809326096
curr_Factors:  [100.84018809  -1.17554083  -0.97640394]
mat_Sqrt:  [[11.72346272  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00263767  0.02025228 -0.01231956]
Stock Position:  -0.002637668191995416
Bond Position:  [3.14851679]


portfolio before change:  [2.8835053]
curr_Stock_Price:  100.62110378029105
curr_Factors:  [100.62110378  -1.05134982  -0.97760558]
mat_Sqrt:  [[13.22893689  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00813668  0.00450167 -0.15304293]
Stock Position:  -0.008136675229390811
Bond Position:  [3.70222654]


portfolio before change:  [2.88384071]
curr_Stock_Price:  100.63676088422696
curr_Factors:  [100.63676088  -1.19549191  -0.97878171]
mat_Sqrt:  [[11.44146448  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00120537 -0.00485587  0.32526019]
Stock Position:  -0.001205365766711283
Bond Position:  [3.00514481]


portfolio before change:  [2.88451172]
curr_Stock_Price:  100.39173282397249
curr_Factors:  [100.39173282  -0.99519086  -0.95905332]
mat_Sqrt:  [[14.22264877  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.0163434  0.08854958 0.12931243]
Stock Position:  0.01634340009961855
Bond Position:  [1.24376947]


portfolio before change:  [2.89093516]
curr_Stock_Price:  100.77524894407665
curr_Factors:  [100.77524894  -1.03518736  -0.9723346 ]
mat_Sqrt:  [[13.53624395  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00738479 -0.0238646  -0.30425902]
Stock Position:  -0.007384794043052674
Bond Position:  [3.63513962]


portfolio before change:  [2.88748094]
curr_Stock_Price:  101.30453164229503
curr_Factors:  [101.30453164  -0.89424271  -0.97170686]
mat_Sqrt:  [[15.67679474  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00555314 -0.01436887 -0.15561434]
Stock Position:  -0.005553144191020583
Bond Position:  [3.45003961]


portfolio before change:  [2.88685868]
curr_Stock_Price:  101.49425156508669
curr_Factors:  [101.49425157  -0.88424989  -0.9537803 ]
mat_Sqrt:  [[16.1508386   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00265926 -0.01081725  0.08530592]
Stock Position:  -0.002659261015063118
Bond Position:  [3.15675838]


portfolio before change:  [2.88924832]
curr_Stock_Price:  100.7440341532124
curr_Factors:  [100.74403415  -1.02555568  -0.97422239]
mat_Sqrt:  [[13.63724853  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00716378 0.0208308  0.2509788 ]
Stock Position:  0.007163782611220093
Bond Position:  [2.16753996]


portfolio before change:  [2.8919837]
curr_Stock_Price:  101.08804562777829
curr_Factors:  [101.08804563  -1.22019858  -0.98501185]
mat_Sqrt:  [[11.14266512  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.02018441 -0.019237   -0.03408608]
Stock Position:  0.02018441172109737
Bond Position:  [0.85158097]


portfolio before change:  [2.88916735]
curr_Stock_Price:  100.9432405812523
curr_Factors:  [100.94324058  -1.04940992  -0.97976646]
mat_Sqrt:  [[13.2683567   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00426122 -0.00026942 -0.1227008 ]
Stock Position:  -0.004261218883710203
Bond Position:  [3.3193086]


portfolio before change:  [2.8869658]
curr_Stock_Price:  101.55726533407444
curr_Factors:  [101.55726533  -0.70328488  -0.95588322]
mat_Sqrt:  [[19.32606553  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00306399 -0.01270317  0.13933369]
Stock Position:  0.003063990590392329
Bond Position:  [2.57579529]


portfolio before change:  [2.8858357]
curr_Stock_Price:  101.08334282918115
curr_Factors:  [101.08334283  -0.74916456  -0.95621238]
mat_Sqrt:  [[18.3672359   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-6.50634831e-04  2.80925476e-02  8.30378196e-01]
Stock Position:  -0.0006506348311695549
Bond Position:  [2.95160404]


portfolio before change:  [2.8869988]
curr_Stock_Price:  99.86279340728039
curr_Factors:  [99.86279341 -0.6718412  -0.94180049]
mat_Sqrt:  [[19.8887747   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0017985  -0.00313108 -0.22319281]
Stock Position:  -0.0017984971849872703
Bond Position:  [3.06660176]


portfolio before change:  [2.88558785]
curr_Stock_Price:  100.86046268564891
curr_Factors:  [100.86046269  -0.74484735  -0.93732227]
mat_Sqrt:  [[18.75702572  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00049995  0.01710078  0.23298059]
Stock Position:  -0.0004999490710552964
Bond Position:  [2.93601294]


portfolio before change:  [2.88620717]
curr_Stock_Price:  100.35581517531237
curr_Factors:  [100.35581518  -0.67142321  -0.90762904]
mat_Sqrt:  [[20.69039896  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00141322 -0.0282011   0.23862409]
Stock Position:  0.0014132201894879234
Bond Position:  [2.74438231]


portfolio before change:  [2.88636451]
curr_Stock_Price:  100.22438972429477
curr_Factors:  [100.22438972  -0.6464116   -0.9061846 ]
mat_Sqrt:  [[21.21726778  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00250169  0.01677103 -0.06625606]
Stock Position:  -0.0025016940295316537
Bond Position:  [3.13709526]


portfolio before change:  [2.88206251]
curr_Stock_Price:  102.10078243351518
curr_Factors:  [102.10078243  -0.64602943  -0.90443913]
mat_Sqrt:  [[21.6605327   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00197986  0.02328151  0.08378082]
Stock Position:  -0.0019798595259698697
Bond Position:  [3.08420771]


portfolio before change:  [2.88259543]
curr_Stock_Price:  102.02634425445483
curr_Factors:  [102.02634425  -0.46143396  -0.9078119 ]
mat_Sqrt:  [[25.94516308  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00078663 -0.02587662 -0.59966486]
Stock Position:  -0.0007866315463588051
Bond Position:  [2.96285258]


portfolio before change:  [2.88194484]
curr_Stock_Price:  103.32425726903217
curr_Factors:  [ 1.03324257e+02  1.88527214e-02 -9.24721479e-01]
mat_Sqrt:  [[41.76269239  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00038323 -0.00233281 -0.33379443]
Stock Position:  -0.00038322758529492937
Bond Position:  [2.92154154]


portfolio before change:  [2.88295845]
curr_Stock_Price:  101.6323086056097
curr_Factors:  [101.63230861  -0.30785736  -0.92237084]
mat_Sqrt:  [[29.69959114  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00039134  0.08464153  0.06302333]
Stock Position:  -0.00039134309343114276
Bond Position:  [2.92273155]


portfolio before change:  [2.88319134]
curr_Stock_Price:  101.97082528679684
curr_Factors:  [101.97082529  -0.34301668  -0.92310525]
mat_Sqrt:  [[28.74790263  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-8.46661230e-06 -3.21114413e-02 -2.24682333e-01]
Stock Position:  -8.466612298668116e-06
Bond Position:  [2.88405469]


portfolio before change:  [2.88354613]
curr_Stock_Price:  102.6485604123273
curr_Factors:  [102.64856041  -0.32677529  -0.96230396]
mat_Sqrt:  [[28.28217843  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-7.89207078e-05  7.71085507e-04  2.22433330e-01]
Stock Position:  -7.892070779479207e-05
Bond Position:  [2.89164723]


portfolio before change:  [2.88403248]
curr_Stock_Price:  101.06635666288905
curr_Factors:  [101.06635666  -0.32616069  -0.97258407]
mat_Sqrt:  [[27.57839129  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00191812 -0.02685898 -0.01723772]
Stock Position:  -0.0019181163355025438
Bond Position:  [3.07788951]


portfolio before change:  [2.88521848]
curr_Stock_Price:  100.64863282303054
curr_Factors:  [100.64863282  -0.16593684  -0.96871771]
mat_Sqrt:  [[32.36187446  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00619032  0.06207099  0.06431413]
Stock Position:  -0.006190323983694729
Bond Position:  [3.50826613]


portfolio before change:  [2.881934]
curr_Stock_Price:  101.2500619328059
curr_Factors:  [101.25006193  -0.23643498  -0.99189323]
mat_Sqrt:  [[29.6441588   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00252633 -0.04945398 -0.36599623]
Stock Position:  0.002526328845390022
Bond Position:  [2.62614305]


portfolio before change:  [2.88198617]
curr_Stock_Price:  101.14076594240547
curr_Factors:  [101.14076594  -0.40879511  -0.97701207]
mat_Sqrt:  [[25.29751295  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00425611 -0.05711343 -0.05283164]
Stock Position:  -0.004256114128972918
Bond Position:  [3.31245282]


portfolio before change:  [2.88615415]
curr_Stock_Price:  100.2587641595173
curr_Factors:  [100.25876416  -0.44153295  -0.97544113]
mat_Sqrt:  [[24.30738963  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00155562  0.00141464 -0.08752229]
Stock Position:  -0.0015556182074314803
Bond Position:  [3.04211851]


portfolio before change:  [2.88735266]
curr_Stock_Price:  99.73278981874039
curr_Factors:  [99.73278982 -0.52457485 -0.96059107]
mat_Sqrt:  [[22.58596258  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00162266  0.02354307  0.00166275]
Stock Position:  -0.0016226641823634523
Bond Position:  [3.04918548]


portfolio before change:  [2.88690041]
curr_Stock_Price:  100.24640547510697
curr_Factors:  [100.24640548  -0.2425082   -0.99514845]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [2.88690041]
Stock Price:  97.59021381001938
PL:  [2.88690041]
Settle:  Tensor("sub_366:0", shape=(), dtype=float64)
PL:  Tensor("sub_367:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  184
output_Z_Vals[:, i, :]:  [[ 1.19260232e+02 -2.92559343e+01 -2.92733494e+01]
 [ 1.32997618e-02 -4.16420876e-02 -3.39915517e-02]
 [-5.67890683e-02 -7.79135280e-02 -6.67901001e-02]
 [ 8.36628281e-02  1.58451733e-01  3.77980831e-02]
 [ 1.08777163e-01  6.73704959e-03 -6.58182657e-02]
 [ 7.46546427e-02  3.01704992e-02 -4.86232115e-02]
 [ 5.28382894e-02  3.18329913e-02 -4.59468310e-02]
 [-1.31088304e-01  1.67259379e-01 -2.98895247e-02]
 [-1.45631853e-01 -5.53602834e-02  1.14991148e-01]
 [-5.56888136e-02  2.22779440e-01  7.39534123e-02]
 [ 5.28457346e-02  1.24595202e-02 -7.20734915e-02]
 [-7.06294703e-02  9.76137839e-02  2.00412790e-02]
 [-7.69541459e-02 -3.90817589e-02 -6.21920309e-02]
 [ 1.51863833e-01  1.47869540e-01  2.38118965e-01]
 [ 1.78221646e-01  1.87415457e-01 -1.10440452e-02]
 [-6.93905362e-02 -8.53694796e-02 -1.18637569e-01]
 [-7.94331937e-02 -2.17890430e-02 -7.66228967e-02]
 [-4.24931594e-02 -1.02078944e-01  9.30230631e-03]
 [ 2.68077873e-02  6.40494793e-02  2.71715816e-02]
 [ 3.28894133e-01 -1.64062362e-01 -8.43262935e-02]
 [ 2.13957811e-02  1.68888843e-02  7.45322356e-02]
 [ 1.36601080e-02 -1.48786829e-02  1.31689901e-02]
 [-1.07167516e-01  2.10744906e-01  3.09422742e-01]
 [ 9.28982109e-02 -1.70560225e-02 -3.00677902e-02]
 [ 9.40048082e-02  2.18038875e-02  1.08558727e-01]
 [ 8.38134474e-02 -1.15220025e-02  6.14480451e-02]
 [-1.63150281e-01  7.13648114e-02  8.14695234e-02]
 [-5.07806065e-02  7.36225950e-02  2.93687317e-02]
 [ 6.20848838e-02 -6.23725319e-02  9.08311027e-02]
 [ 8.85781746e-03 -1.95981384e-02 -6.43986769e-02]
 [-9.27801199e-02  5.03566015e-01 -1.61250193e-03]
 [ 3.25643312e-02 -7.19634980e-02  9.06649950e-03]
 [ 2.77503640e-02 -1.70222636e-02  7.23747829e-02]
 [-4.83682877e-02 -8.38564634e-02 -1.79258620e-03]
 [-1.69751151e-01  1.68684240e-01  3.28754150e-02]
 [ 1.16780837e-01 -1.51456206e-01 -1.22334441e-01]
 [-1.23651695e-01 -1.91812311e-01 -8.11742418e-03]
 [-3.92247598e-02 -1.65346458e-02  5.86705186e-03]
 [-4.43239690e-02  9.46880253e-02 -2.06612853e-02]
 [-2.37069419e-01  1.33183270e-01  1.41404306e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.26023247 -29.25593426 -29.27334937]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  8.31486419  -9.25153874 -83.50871763]
init_Out:  [2.49911038]
Stock Position:  8.31486419409362
Bond position:  [-828.98730903]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-1.51946921]
curr_Stock_Price:  99.52916252060895
curr_Factors:  [99.52916252 -0.92512585 -1.01653826]
mat_Sqrt:  [[14.27895224  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0003702  -0.01316838 -0.09696844]
Stock Position:  0.00037020022475973865
Bond Position:  [-1.55631493]


portfolio before change:  [-1.51928583]
curr_Stock_Price:  100.55003876306384
curr_Factors:  [100.55003876  -1.08268849  -1.02764165]
mat_Sqrt:  [[12.18645838  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00594383 -0.02463842 -0.19053356]
Stock Position:  -0.005943831814630974
Bond Position:  [-0.92163331]


portfolio before change:  [-1.5183426]
curr_Stock_Price:  100.37196513772136
curr_Factors:  [100.37196514  -0.98618392  -1.05067631]
mat_Sqrt:  [[13.09227951  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00729205 0.05010684 0.10782741]
Stock Position:  0.007292048387924986
Bond Position:  [-2.25025983]


portfolio before change:  [-1.52423197]
curr_Stock_Price:  99.60289897741394
curr_Factors:  [99.60289898 -0.98325587 -1.04476341]
mat_Sqrt:  [[13.10733497  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00728722  0.00213044 -0.18776119]
Stock Position:  0.0072872186362884705
Bond Position:  [-2.25006007]


portfolio before change:  [-1.52240222]
curr_Stock_Price:  99.89258713057889
curr_Factors:  [99.89258713 -1.098422   -1.05860841]
mat_Sqrt:  [[11.5543856   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00566958  0.00954075 -0.13870849]
Stock Position:  0.005669576245137267
Bond Position:  [-2.08875086]


portfolio before change:  [-1.51899872]
curr_Stock_Price:  100.53895171241834
curr_Factors:  [100.53895171  -1.38507492  -1.06030242]
mat_Sqrt:  [[ 8.7160652   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00508043  0.01006648 -0.13107352]
Stock Position:  0.005080429654758833
Bond Position:  [-2.02977979]


portfolio before change:  [-1.51933678]
curr_Stock_Price:  100.52235542149066
curr_Factors:  [100.52235542  -1.11423691  -1.10982035]
mat_Sqrt:  [[10.87343748  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01221977  0.05289206 -0.08526649]
Stock Position:  -0.012219765793751971
Bond Position:  [-0.29097714]


portfolio before change:  [-1.5247331]
curr_Stock_Price:  100.96098458628073
curr_Factors:  [100.96098459  -1.18395322  -1.12128475]
mat_Sqrt:  [[10.06935018  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01227376 -0.01750646  0.32803774]
Stock Position:  -0.012273759198114288
Bond Position:  [-0.28556228]


portfolio before change:  [-1.52847228]
curr_Stock_Price:  101.26272480515757
curr_Factors:  [101.26272481  -1.15488596  -1.10696427]
mat_Sqrt:  [[10.54728139  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00330332  0.07044904  0.2109685 ]
Stock Position:  -0.0033033153149443616
Bond Position:  [-1.19396957]


portfolio before change:  [-1.53100283]
curr_Stock_Price:  101.98360474152834
curr_Factors:  [101.98360474  -1.2877683   -1.08679665]
mat_Sqrt:  [[ 9.49008064  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00405218  0.00394005 -0.20560561]
Stock Position:  0.004052178227008697
Bond Position:  [-1.94425857]


portfolio before change:  [-1.52989617]
curr_Stock_Price:  102.31668601275263
curr_Factors:  [102.31668601  -1.42441863  -1.07352727]
mat_Sqrt:  [[ 8.41593446  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00760678  0.03086819  0.05717219]
Stock Position:  -0.007606782646186599
Bond Position:  [-0.75159538]


portfolio before change:  [-1.52979197]
curr_Stock_Price:  102.2906363314057
curr_Factors:  [102.29063633  -1.14895489  -1.0867137 ]
mat_Sqrt:  [[10.93697823  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00828914 -0.01235874 -0.17741655]
Stock Position:  -0.008289138538858102
Bond Position:  [-0.68189072]


portfolio before change:  [-1.52932228]
curr_Stock_Price:  102.22368920482313
curr_Factors:  [102.2236892   -0.84310234  -1.10668668]
mat_Sqrt:  [[14.54684933  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01404343 0.04676045 0.67928713]
Stock Position:  0.014043428471383743
Bond Position:  [-2.96489335]


portfolio before change:  [-1.54099628]
curr_Stock_Price:  101.41880294924135
curr_Factors:  [101.41880295  -0.81767428  -1.08836144]
mat_Sqrt:  [[15.07778973  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01199157  0.05926597 -0.03150559]
Stock Position:  0.011991567668900865
Bond Position:  [-2.75716672]


portfolio before change:  [-1.52920302]
curr_Stock_Price:  102.4310083373456
curr_Factors:  [102.43100834  -0.95567316  -1.06365001]
mat_Sqrt:  [[13.59723295  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0070464  -0.0269962  -0.33843996]
Stock Position:  -0.007046401236560183
Bond Position:  [-0.80743303]


portfolio before change:  [-1.52838213]
curr_Stock_Price:  102.3001868911046
curr_Factors:  [102.30018689  -0.86060526  -1.0530119 ]
mat_Sqrt:  [[15.09395522  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00633607 -0.0068903  -0.2185838 ]
Stock Position:  -0.006336070716562412
Bond Position:  [-0.88020091]


portfolio before change:  [-1.5259431]
curr_Stock_Price:  101.8978775065797
curr_Factors:  [101.89787751  -0.66779371  -1.05265531]
mat_Sqrt:  [[18.23826928  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00237029 -0.0322802   0.02653689]
Stock Position:  -0.0023702907549051724
Bond Position:  [-1.28441551]


portfolio before change:  [-1.52891133]
curr_Stock_Price:  103.0824014625539
curr_Factors:  [103.08240146  -0.82083019  -1.07077337]
mat_Sqrt:  [[15.54789281  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.0021873  0.02025422 0.07751296]
Stock Position:  0.0021873004916091957
Bond Position:  [-1.75438352]


portfolio before change:  [-1.52822926]
curr_Stock_Price:  103.49450185857344
curr_Factors:  [103.49450186  -0.68278451  -1.06885881]
mat_Sqrt:  [[17.9551175   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01712298 -0.05188107 -0.24055944]
Stock Position:  0.017122975011029017
Bond Position:  [-3.30036302]


portfolio before change:  [-1.54537288]
curr_Stock_Price:  102.51739049046627
curr_Factors:  [102.51739049  -0.74076988  -1.04663622]
mat_Sqrt:  [[17.16077663  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00215874 0.00534073 0.21261972]
Stock Position:  0.0021587414089973248
Bond Position:  [-1.76668142]


portfolio before change:  [-1.54520781]
curr_Stock_Price:  102.69616035647974
curr_Factors:  [102.69616036  -0.65427042  -1.04831859]
mat_Sqrt:  [[18.71238705  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00085313 -0.00470505  0.03756746]
Stock Position:  0.0008531274444271155
Bond Position:  [-1.63282072]


portfolio before change:  [-1.54519914]
curr_Stock_Price:  102.9455781497898
curr_Factors:  [102.94557815  -0.6278102   -1.01553471]
mat_Sqrt:  [[19.90270346  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0019377   0.06664339  0.88269696]
Stock Position:  -0.0019376992194920183
Bond Position:  [-1.34572158]


portfolio before change:  [-1.54457091]
curr_Stock_Price:  102.53454371712452
curr_Factors:  [102.53454372  -0.43958438  -1.01732272]
mat_Sqrt:  [[23.88600347  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00361384 -0.00539359 -0.08577504]
Stock Position:  0.00361384290930169
Bond Position:  [-1.91511464]


portfolio before change:  [-1.54804622]
curr_Stock_Price:  101.63912376124433
curr_Factors:  [101.63912376  -0.29041267  -1.01110068]
mat_Sqrt:  [[27.65800462  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00422038 0.00689499 0.30968783]
Stock Position:  0.004220378189088669
Bond Position:  [-1.97700176]


portfolio before change:  [-1.54328549]
curr_Stock_Price:  102.82571682495193
curr_Factors:  [102.82571682  -0.33577341  -1.04349443]
mat_Sqrt:  [[25.88769214  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0037106  -0.00364358  0.17529417]
Stock Position:  0.0037106042423797336
Bond Position:  [-1.92483103]


portfolio before change:  [-1.54153991]
curr_Stock_Price:  103.36099218343503
curr_Factors:  [103.36099218  -0.54802684  -1.05962321]
mat_Sqrt:  [[20.70919049  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00698616  0.02256753  0.23240987]
Stock Position:  -0.006986161662038172
Bond Position:  [-0.81944331]


portfolio before change:  [-1.53722217]
curr_Stock_Price:  102.72828771293342
curr_Factors:  [102.72828771  -0.3589563   -1.09036042]
mat_Sqrt:  [[24.11347452  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00177846  0.02328151  0.08378082]
Stock Position:  -0.0017784584285317497
Bond Position:  [-1.35452418]


portfolio before change:  [-1.53880558]
curr_Stock_Price:  103.52340682426257
curr_Factors:  [103.52340682  -0.4941729   -1.11207112]
mat_Sqrt:  [[20.77091565  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00380413 -0.01972393  0.25911585]
Stock Position:  0.0038041295097955737
Bond Position:  [-1.93262203]


portfolio before change:  [-1.53706239]
curr_Stock_Price:  104.04515343972497
curr_Factors:  [104.04515344  -0.52274771  -1.09985602]
mat_Sqrt:  [[20.53685842  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00023341 -0.00619748 -0.1837115 ]
Stock Position:  -0.00023341102498028677
Bond Position:  [-1.5127771]


portfolio before change:  [-1.53749761]
curr_Stock_Price:  105.09959854403918
curr_Factors:  [105.09959854  -0.46718428  -1.09908985]
mat_Sqrt:  [[21.94708488  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00365002  0.15924156 -0.00460002]
Stock Position:  -0.0036500178669988427
Bond Position:  [-1.1538822]


portfolio before change:  [-1.53794682]
curr_Stock_Price:  105.18314891870372
curr_Factors:  [105.18314892  -0.57058619  -1.10709587]
mat_Sqrt:  [[19.64889397  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00165693 -0.02275686  0.0258642 ]
Stock Position:  0.001656934640894538
Bond Position:  [-1.71222842]


portfolio before change:  [-1.53744118]
curr_Stock_Price:  105.6174909621946
curr_Factors:  [105.61749096  -0.74630437  -1.09647105]
mat_Sqrt:  [[16.72740795  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00251589 -0.00538291  0.20646511]
Stock Position:  0.00251588840499674
Bond Position:  [-1.803163]


portfolio before change:  [-1.54157264]
curr_Stock_Price:  104.0649412079343
curr_Factors:  [104.06494121  -0.47384035  -1.10982676]
mat_Sqrt:  [[21.35632664  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00238334 -0.02651774 -0.00511375]
Stock Position:  -0.0023833388246907606
Bond Position:  [-1.29355062]


portfolio before change:  [-1.54153502]
curr_Stock_Price:  103.98131028124524
curr_Factors:  [103.98131028  -0.31252778  -1.118465  ]
mat_Sqrt:  [[24.85896364  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00638341  0.05334264  0.09378441]
Stock Position:  -0.006383414817533156
Bond Position:  [-0.87777918]


portfolio before change:  [-1.52728634]
curr_Stock_Price:  101.73198052734072
curr_Factors:  [ 1.01731981e+02 -6.77274908e-02 -1.09551596e+00]
mat_Sqrt:  [[31.78829897  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00276513 -0.04789466 -0.34898611]
Stock Position:  0.002765131942051028
Bond Position:  [-1.80858869]


portfolio before change:  [-1.52726585]
curr_Stock_Price:  101.8211551302915
curr_Factors:  [101.82115513  -0.33873273  -1.09247404]
mat_Sqrt:  [[24.33732378  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00535232 -0.06065638 -0.02315675]
Stock Position:  -0.005352323489370325
Bond Position:  [-0.98228609]


portfolio before change:  [-1.52700631]
curr_Stock_Price:  101.7497225827789
curr_Factors:  [101.74972258  -0.47965035  -1.09179189]
mat_Sqrt:  [[21.13803154  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00181919 -0.00522871  0.01673707]
Stock Position:  -0.001819189051419347
Bond Position:  [-1.34190433]


portfolio before change:  [-1.52807037]
curr_Stock_Price:  102.24241676761048
curr_Factors:  [102.24241677  -0.65193511  -1.07238464]
mat_Sqrt:  [[18.22923948  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00252872  0.02994298 -0.0589409 ]
Stock Position:  -0.0025287177731965617
Bond Position:  [-1.26952815]


portfolio before change:  [-1.52800749]
curr_Stock_Price:  102.15479336448414
curr_Factors:  [102.15479336  -0.79757149  -1.06545922]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-1.52800749]
Stock Price:  101.6888340308619
PL:  [-3.21684152]
Settle:  Tensor("sub_368:0", shape=(), dtype=float64)
PL:  Tensor("sub_369:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  185
output_Z_Vals[:, i, :]:  [[ 1.19260232e+02 -2.92559343e+01 -2.92733494e+01]
 [-4.87605204e-02  8.34136107e-02  1.95413983e-03]
 [ 6.27557703e-02  5.38655665e-02 -2.25059193e-02]
 [ 8.19154728e-02  1.42562979e-01  3.75858107e-02]
 [ 2.00101496e-01 -2.42064135e-02 -5.81545643e-02]
 [ 5.94638047e-02  3.08846295e-02  2.15240338e-02]
 [ 4.25527640e-02  4.20788140e-02 -3.85207381e-02]
 [-1.37663104e-01  9.51972920e-02 -6.50383298e-02]
 [ 2.73898225e-02 -3.96338159e-02  2.08645592e-03]
 [-6.23482400e-02  2.66587932e-01  1.03080200e-01]
 [ 5.92366644e-02  1.05513923e-01 -8.44385775e-02]
 [-4.90544959e-02  3.43967263e-02  5.37071901e-03]
 [-6.41467588e-02 -6.08684014e-02 -5.32186842e-02]
 [ 1.77100915e-01  1.55325527e-01  2.49778536e-01]
 [ 1.45172430e-01  1.05588752e-01 -6.12465100e-02]
 [-6.98498698e-02 -9.26790007e-02 -1.21971472e-01]
 [-8.51183638e-02  7.35079443e-03 -9.74615847e-02]
 [ 3.57148446e-02 -1.60260265e-01 -8.23365842e-02]
 [ 2.56059999e-02  6.49149266e-02  2.67160268e-02]
 [ 3.14713876e-01 -1.85324625e-01 -7.27344372e-02]
 [ 9.42328691e-02  4.81496198e-03  1.49311577e-01]
 [ 1.47619866e-02 -1.56396722e-02  1.42423245e-02]
 [-1.00153291e-01  2.06010321e-01  1.93182142e-01]
 [ 1.89273298e-01 -2.67818919e-02  3.37300776e-02]
 [ 4.00755177e-02  3.33968089e-02  6.79371381e-02]
 [ 1.01941245e-01  3.42768263e-03  5.62532626e-02]
 [-1.33877675e-01  7.41182681e-02  8.58592209e-02]
 [-5.07806065e-02  7.36225950e-02  2.93687317e-02]
 [ 6.20848838e-02 -6.23725319e-02  9.08311027e-02]
 [ 8.46319740e-03 -4.13994888e-02  5.03196544e-03]
 [-2.69809219e-02  3.09426254e-01  1.20798443e-02]
 [ 2.82849637e-02 -1.21668874e-01 -6.76908130e-02]
 [ 1.49283851e-01 -1.18672335e-01 -2.52408271e-02]
 [-5.07134797e-02 -8.61474416e-02 -9.45756919e-03]
 [-1.53943875e-01  1.09167956e-01  3.24854560e-02]
 [ 8.47165236e-02 -1.65012150e-01 -1.38726811e-01]
 [-1.91330875e-01 -3.14271475e-01  5.13970753e-02]
 [-3.84919558e-02 -1.52981431e-02  2.42727827e-03]
 [-4.37831073e-02  9.35537761e-02 -2.10006515e-02]
 [ 2.14127863e-02  1.09574277e-02 -1.80718962e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.26023247 -29.25593426 -29.27334937]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  8.31486419  -9.25153874 -83.50871763]
init_Out:  [2.49911038]
Stock Position:  8.31486419409362
Bond position:  [-828.98730903]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [7.08756266]
curr_Stock_Price:  100.56430051721948
curr_Factors:  [100.56430052  -0.93409823  -1.0195065 ]
mat_Sqrt:  [[14.25621003  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00324125  0.0263777   0.00557462]
Stock Position:  -0.0032412473563997925
Bond Position:  [7.41351643]


portfolio before change:  [7.08697806]
curr_Stock_Price:  101.0305837167512
curr_Factors:  [101.03058372  -0.87821829  -1.03315048]
mat_Sqrt:  [[14.94018418  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00398607  0.01703379 -0.06420312]
Stock Position:  0.003986066773289015
Bond Position:  [6.68426341]


portfolio before change:  [7.08488383]
curr_Stock_Price:  100.29556839287899
curr_Factors:  [100.29556839  -0.80758793  -1.05019988]
mat_Sqrt:  [[15.64785274  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00596047 0.04508237 0.10722186]
Stock Position:  0.005960473048125813
Bond Position:  [6.4870748]


portfolio before change:  [7.08639485]
curr_Stock_Price:  100.41302334523571
curr_Factors:  [100.41302335  -0.95299113  -1.07282898]
mat_Sqrt:  [[13.24303557  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01416637 -0.00765474 -0.16589878]
Stock Position:  0.01416636973738415
Bond Position:  [5.66390684]


portfolio before change:  [7.09378856]
curr_Stock_Price:  100.88496366948496
curr_Factors:  [100.88496367  -1.06807717  -1.08273844]
mat_Sqrt:  [[11.74191925  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00550632 0.00976658 0.06140208]
Stock Position:  0.005506324480317259
Bond Position:  [6.53828322]


portfolio before change:  [7.09610645]
curr_Stock_Price:  101.15747785356139
curr_Factors:  [101.15747785  -1.01476838  -1.10807617]
mat_Sqrt:  [[12.10760705  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00295485  0.01330649 -0.10988894]
Stock Position:  0.0029548548615236387
Bond Position:  [6.79720079]


portfolio before change:  [7.09401525]
curr_Stock_Price:  100.16219943946005
curr_Factors:  [100.16219944  -1.03285248  -1.11954397]
mat_Sqrt:  [[11.63938282  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01275678  0.03010403 -0.18553625]
Stock Position:  -0.012756777224585385
Bond Position:  [8.37176212]


portfolio before change:  [7.10068889]
curr_Stock_Price:  99.7210929794875
curr_Factors:  [99.72109298 -0.65510294 -1.0865125 ]
mat_Sqrt:  [[17.47483379  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0015332  -0.01253331  0.00595208]
Stock Position:  0.0015331978648413852
Bond Position:  [6.94779672]


portfolio before change:  [7.10181746]
curr_Stock_Price:  99.89070309043068
curr_Factors:  [99.89070309 -0.30411007 -1.08761328]
mat_Sqrt:  [[24.83746653  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00138596  0.08430251  0.29405912]
Stock Position:  -0.001385963072550021
Bond Position:  [7.24026229]


portfolio before change:  [7.10197478]
curr_Stock_Price:  100.43023622760983
curr_Factors:  [100.43023623  -0.41375525  -1.07883683]
mat_Sqrt:  [[22.57563534  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00198112  0.03336643 -0.24087976]
Stock Position:  0.001981121196539052
Bond Position:  [6.90301031]


portfolio before change:  [7.1046595]
curr_Stock_Price:  101.34981486087577
curr_Factors:  [101.34981486  -0.35439063  -1.08574137]
mat_Sqrt:  [[24.00941496  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00196048  0.0108772   0.01532117]
Stock Position:  -0.0019604843717717837
Bond Position:  [7.30335423]


portfolio before change:  [7.10646347]
curr_Stock_Price:  100.89533800082722
curr_Factors:  [100.895338    -0.48412797  -1.10574931]
mat_Sqrt:  [[20.57766851  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00372159 -0.01924828 -0.15181809]
Stock Position:  -0.0037215874380034293
Bond Position:  [7.4819543]


portfolio before change:  [7.1017372]
curr_Stock_Price:  102.41661932199787
curr_Factors:  [102.41661932  -0.64206878  -1.10014676]
mat_Sqrt:  [[17.93642312  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01294    0.04911824 0.71254864]
Stock Position:  0.012939995434361229
Bond Position:  [5.77646661]


portfolio before change:  [7.10007065]
curr_Stock_Price:  102.2320248028148
curr_Factors:  [102.2320248   -0.71432714  -1.09529508]
mat_Sqrt:  [[16.73701548  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00808966  0.0333901  -0.17471925]
Stock Position:  0.008089663779358524
Bond Position:  [6.27304794]


portfolio before change:  [7.10382031]
curr_Stock_Price:  102.5986019609463
curr_Factors:  [102.59860196  -0.85538119  -1.09417134]
mat_Sqrt:  [[14.60365406  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00665177 -0.02930767 -0.34795066]
Stock Position:  -0.006651770397486223
Bond Position:  [7.78628266]


portfolio before change:  [7.09783368]
curr_Stock_Price:  103.64493664940217
curr_Factors:  [103.64493665  -0.6642016   -1.11750618]
mat_Sqrt:  [[17.44866615  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0060075   0.00232453 -0.27803077]
Stock Position:  -0.006007498160378795
Bond Position:  [7.72048045]


portfolio before change:  [7.10103128]
curr_Stock_Price:  103.27332117477343
curr_Factors:  [103.27332117  -0.88036048  -1.09268888]
mat_Sqrt:  [[14.35832222  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00102868 -0.05067875 -0.23488336]
Stock Position:  0.001028675720539182
Bond Position:  [6.99479652]


portfolio before change:  [7.1019055]
curr_Stock_Price:  103.27314224595305
curr_Factors:  [103.27314225  -0.96144607  -1.12281635]
mat_Sqrt:  [[12.84705912  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00254809 0.0205279  0.07621339]
Stock Position:  0.0025480915057939073
Bond Position:  [6.83875608]


portfolio before change:  [7.10454071]
curr_Stock_Price:  103.97182699852294
curr_Factors:  [103.971827    -0.98010409  -1.10555655]
mat_Sqrt:  [[12.91590278  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.02284641 -0.05860479 -0.2074911 ]
Stock Position:  0.022846406098931984
Bond Position:  [4.72915813]


portfolio before change:  [7.10529953]
curr_Stock_Price:  103.97916477133901
curr_Factors:  [103.97916477  -1.14738721  -1.14499286]
mat_Sqrt:  [[10.50457067  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.0118839  0.00152262 0.42594437]
Stock Position:  0.011883902045812595
Bond Position:  [5.86962133]


portfolio before change:  [7.10501589]
curr_Stock_Price:  103.89355371415564
curr_Factors:  [103.89355371  -1.19465955  -1.12827352]
mat_Sqrt:  [[10.18008938  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00169599 -0.0049457   0.04062939]
Stock Position:  0.001695994377708136
Bond Position:  [6.92881301]


portfolio before change:  [7.10632839]
curr_Stock_Price:  104.15672761290897
curr_Factors:  [104.15672761  -1.09590885  -1.11642598]
mat_Sqrt:  [[11.39941382  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00485999  0.06514618  0.55109488]
Stock Position:  -0.0048599856180506365
Bond Position:  [7.61252859]


portfolio before change:  [7.10474555]
curr_Stock_Price:  104.67822372247021
curr_Factors:  [104.67822372  -1.0837818   -1.12186711]
mat_Sqrt:  [[11.53334259  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01694798 -0.00846918  0.09622252]
Stock Position:  0.01694798483901866
Bond Position:  [5.3306606]


portfolio before change:  [7.09603652]
curr_Stock_Price:  104.12503688368328
curr_Factors:  [104.12503688  -1.11220421  -1.10964229]
mat_Sqrt:  [[11.28806475  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00485517 0.010561   0.19380574]
Stock Position:  0.004855166151270894
Bond Position:  [6.59049217]


portfolio before change:  [7.09743291]
curr_Stock_Price:  104.24295876522788
curr_Factors:  [104.24295877  -1.09947485  -1.11852065]
mat_Sqrt:  [[11.34445211  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01000598 0.00108393 0.1604749 ]
Stock Position:  0.010005983144063944
Bond Position:  [6.05437963]


portfolio before change:  [7.10151566]
curr_Stock_Price:  104.5753497457134
curr_Factors:  [104.57534975  -1.13048009  -1.13467804]
mat_Sqrt:  [[10.85634529  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01054112  0.02343825  0.24493246]
Stock Position:  -0.010541117286099163
Bond Position:  [8.20385668]


portfolio before change:  [7.10473107]
curr_Stock_Price:  104.3676046958797
curr_Factors:  [104.3676047   -0.90985356  -1.13310241]
mat_Sqrt:  [[13.53072956  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00316944  0.02328151  0.08378082]
Stock Position:  -0.0031694382645722843
Bond Position:  [7.43551775]


portfolio before change:  [7.10513347]
curr_Stock_Price:  104.53391142361158
curr_Factors:  [104.53391142  -1.11813801  -1.13656626]
mat_Sqrt:  [[10.96608425  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00720542 -0.01972393  0.25911585]
Stock Position:  0.007205420948534898
Bond Position:  [6.35192263]


portfolio before change:  [7.10911673]
curr_Stock_Price:  104.97652568652626
curr_Factors:  [104.97652569  -1.04392632  -1.13580148]
mat_Sqrt:  [[11.8699378   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00070947 -0.01309167  0.0143548 ]
Stock Position:  0.0007094740497048881
Bond Position:  [7.03463861]


portfolio before change:  [7.10982565]
curr_Stock_Price:  104.73626303652773
curr_Factors:  [104.73626304  -1.41467149  -1.12606089]
mat_Sqrt:  [[ 8.25412464  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00200212  0.09784917  0.03446043]
Stock Position:  -0.0020021241831862735
Bond Position:  [7.31952066]


portfolio before change:  [7.11168495]
curr_Stock_Price:  104.26461320834754
curr_Factors:  [104.26461321  -1.14558417  -1.15501184]
mat_Sqrt:  [[10.44722099  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00108413 -0.03847508 -0.19310305]
Stock Position:  0.0010841311394730433
Bond Position:  [6.99864844]


portfolio before change:  [7.11143]
curr_Stock_Price:  103.22245141488065
curr_Factors:  [103.22245141  -0.94828202  -1.17546615]
mat_Sqrt:  [[12.34360628  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01142838 -0.03752749 -0.07200505]
Stock Position:  0.01142838476692299
Bond Position:  [5.93176411]


portfolio before change:  [7.10747036]
curr_Stock_Price:  102.81109350272077
curr_Factors:  [102.8110935   -1.12509817  -1.17354446]
mat_Sqrt:  [[10.32172228  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00531581 -0.02724221 -0.02697981]
Stock Position:  -0.005315810071905178
Bond Position:  [7.65399461]


portfolio before change:  [7.11253013]
curr_Stock_Price:  102.03925167358014
curr_Factors:  [102.03925167  -0.89845319  -1.17026403]
mat_Sqrt:  [[12.89243018  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01120767  0.03452194  0.09267196]
Stock Position:  -0.011207670130527663
Bond Position:  [8.25615241]


portfolio before change:  [7.10240148]
curr_Stock_Price:  103.03506378665587
curr_Factors:  [103.03506379  -1.15926664  -1.17386398]
mat_Sqrt:  [[ 9.99353859  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00521721 -0.05218142 -0.39574898]
Stock Position:  0.005217214702289016
Bond Position:  [6.56484543]


portfolio before change:  [7.10248889]
curr_Stock_Price:  102.8945186856372
curr_Factors:  [102.89451869  -1.34438253  -1.17715602]
mat_Sqrt:  [[ 8.26612484  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02285883 -0.09938137  0.14662155]
Stock Position:  -0.022858830355415933
Bond Position:  [9.45453723]


portfolio before change:  [7.10938808]
curr_Stock_Price:  102.64440532483084
curr_Factors:  [102.64440532  -1.30116358  -1.15311574]
mat_Sqrt:  [[ 8.81973048  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00435291 -0.0048377   0.00692435]
Stock Position:  -0.004352909207475105
Bond Position:  [7.55618985]


portfolio before change:  [7.10944894]
curr_Stock_Price:  102.84742325701055
curr_Factors:  [102.84742326  -1.339407    -1.13807448]
mat_Sqrt:  [[ 8.63449376  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00528743  0.0295843  -0.05990901]
Stock Position:  -0.005287432068698606
Bond Position:  [7.6532477]


portfolio before change:  [7.10887444]
curr_Stock_Price:  103.13701821841462
curr_Factors:  [103.13701822  -1.35059552  -1.19089542]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [7.10887444]
Stock Price:  103.3727460698113
PL:  [3.73612837]
Settle:  Tensor("sub_370:0", shape=(), dtype=float64)
PL:  Tensor("sub_371:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  186
output_Z_Vals[:, i, :]:  [[ 1.19260232e+02 -2.92559343e+01 -2.92733494e+01]
 [ 5.10913603e-03 -1.05543241e-01 -3.67404020e-02]
 [-5.78567400e-02 -8.79732624e-02 -8.96403726e-02]
 [ 8.71885039e-02  1.90510806e-01  3.82263897e-02]
 [ 1.07567816e-01  6.68598869e-03 -6.41180750e-02]
 [ 6.87425282e-02  2.88887359e-02 -9.54218517e-02]
 [ 7.55873607e-02  1.10697931e-02 -7.47163779e-02]
 [-1.30803693e-01  5.05278935e-04 -1.03558185e-01]
 [-1.68338583e-01 -9.03485681e-02  1.55484768e-01]
 [-5.01335667e-02 -1.14048621e-01 -1.29974234e-01]
 [ 5.52639082e-02  1.85861432e-01 -8.34711240e-02]
 [-9.74055579e-02  8.18546113e-02  2.57398614e-02]
 [-1.07938245e-01  4.00621959e-02 -4.74608258e-02]
 [-1.03955054e-01 -1.10382527e-01  6.07488532e-02]
 [ 2.97955369e-01  3.75283918e-01  4.71790833e-02]
 [-5.58776524e-02 -2.82697004e-01 -6.97466528e-02]
 [-6.70731123e-02 -4.97700381e-02 -3.81826578e-02]
 [-4.31782306e-02  1.41428169e-01  5.35494120e-02]
 [-1.73270329e-03  5.86066006e-02 -3.42370035e-02]
 [-5.64936174e-02 -2.26798256e-02  1.32138318e-01]
 [ 8.69180570e-02 -9.74466809e-02  4.78702065e-02]
 [ 1.21327654e-01  3.97471928e-02  2.57845221e-01]
 [-3.46352279e-02 -4.96470379e-02  2.39072086e-01]
 [-6.32395960e-02 -6.93224931e-04 -8.35692345e-02]
 [-5.42090483e-01  1.60367001e-01  5.59476021e-02]
 [-1.19400810e-01 -2.39688946e-01  1.26571442e-01]
 [ 1.23847004e-01  5.95039352e-02 -8.67190542e-02]
 [ 2.47056068e-02 -3.20969444e-02 -1.50658596e-02]
 [-1.15206171e-01 -1.43657644e-01 -1.21934988e-01]
 [ 5.04511445e-02  4.81774843e-02 -9.80184500e-02]
 [ 8.18958471e-02 -6.05199413e-02  6.58912481e-02]
 [ 8.30350212e-02 -9.81692474e-02 -7.53235420e-02]
 [ 4.29097638e-01 -4.92124040e-01 -4.91252328e-01]
 [-4.75474100e-02 -8.30565328e-02 -7.47719799e-04]
 [-1.60591844e-01 -3.64552995e-03  2.00558606e-02]
 [ 9.94771453e-02 -8.29629910e-02 -4.96975477e-02]
 [ 2.33014138e-02  1.20185827e-02 -9.25484084e-02]
 [-1.43842686e-02  3.00167641e-02 -6.15527054e-02]
 [ 1.78022741e-01 -2.54903434e-01 -4.72157257e-02]
 [-6.23989713e-01  3.25542483e-01  3.66915059e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.26023247 -29.25593426 -29.27334937]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  8.31486419  -9.25153874 -83.50871763]
init_Out:  [2.49911038]
Stock Position:  8.31486419409362
Bond position:  [-828.98730903]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [1.9453526]
curr_Stock_Price:  99.94586467353386
curr_Factors:  [99.94586467 -1.04678913 -0.9846187 ]
mat_Sqrt:  [[13.10797533  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00039026 -0.0333757  -0.10481014]
Stock Position:  -0.00039026483904078713
Bond Position:  [1.98435796]


portfolio before change:  [1.94544397]
curr_Stock_Price:  100.34735565608767
curr_Factors:  [100.34735566  -1.18693027  -0.99232347]
mat_Sqrt:  [[11.35188698  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00690863 -0.02781959 -0.25571903]
Stock Position:  -0.0069086280042588676
Bond Position:  [2.63870653]


portfolio before change:  [1.94458111]
curr_Stock_Price:  100.51999787447146
curr_Factors:  [100.51999787  -1.3241212   -1.01516708]
mat_Sqrt:  [[ 9.68974792  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01031094 0.06024481 0.10904925]
Stock Position:  0.010310939117499742
Bond Position:  [0.90812553]


portfolio before change:  [1.93264379]
curr_Stock_Price:  99.35125395572089
curr_Factors:  [99.35125396 -1.34255019 -1.01410461]
mat_Sqrt:  [[ 9.4122007   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01005635  0.0021143  -0.18291102]
Stock Position:  0.010056351651172248
Bond Position:  [0.93353264]


portfolio before change:  [1.93244861]
curr_Stock_Price:  99.32024129915145
curr_Factors:  [99.3202413  -1.15440063 -0.99849547]
mat_Sqrt:  [[11.53577743  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00433525  0.00913542 -0.27221198]
Stock Position:  0.004335254259839509
Bond Position:  [1.50187011]


portfolio before change:  [1.93131685]
curr_Stock_Price:  99.01587471722131
curr_Factors:  [99.01587472 -1.06241392 -0.98343231]
mat_Sqrt:  [[12.79985649  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00473613  0.00350058 -0.21314503]
Stock Position:  0.004736128472872486
Bond Position:  [1.46236495]


portfolio before change:  [1.93623851]
curr_Stock_Price:  100.0164503019303
curr_Factors:  [100.0164503   -1.34065967  -0.97923337]
mat_Sqrt:  [[ 9.83002662  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-1.54556421e-02  1.59783229e-04 -2.95422677e-01]
Stock Position:  -0.015455642083640883
Bond Position:  [3.48205697]


portfolio before change:  [1.94328878]
curr_Stock_Price:  99.58845239453255
curr_Factors:  [99.58845239 -1.46626665 -1.01625128]
mat_Sqrt:  [[ 8.31888544  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01670094 -0.02857073  0.44355477]
Stock Position:  -0.016700936452051444
Bond Position:  [3.6065092]


portfolio before change:  [1.95323794]
curr_Stock_Price:  99.01972267522997
curr_Factors:  [99.01972268 -1.1652972  -1.03694855]
mat_Sqrt:  [[10.947086    0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00727218 -0.03606534 -0.37078031]
Stock Position:  -0.007272179001339869
Bond Position:  [2.67332709]


portfolio before change:  [1.95356828]
curr_Stock_Price:  99.02025151501466
curr_Factors:  [99.02025152 -1.47458015 -1.04127557]
mat_Sqrt:  [[ 8.00021702  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0053779   0.05877455 -0.23811988]
Stock Position:  0.005377898847162403
Bond Position:  [1.42104739]


portfolio before change:  [1.95696514]
curr_Stock_Price:  99.6188531280594
curr_Factors:  [99.61885313 -1.3483594  -1.03158989]
mat_Sqrt:  [[ 9.22025     0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00976524  0.0258847   0.07342866]
Stock Position:  -0.00976523995473477
Bond Position:  [2.92976715]


portfolio before change:  [1.96116915]
curr_Stock_Price:  99.22585104038313
curr_Factors:  [99.22585104 -1.24948354 -1.0435194 ]
mat_Sqrt:  [[10.01812188  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01163808  0.01266878 -0.13539253]
Stock Position:  -0.011638084056576348
Bond Position:  [3.11596794]


portfolio before change:  [1.96534522]
curr_Stock_Price:  98.90049234211084
curr_Factors:  [98.90049234 -1.28020732 -1.01067136]
mat_Sqrt:  [[10.00650657  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00943434 -0.03490602  0.17329957]
Stock Position:  -0.009434342586592278
Bond Position:  [2.89840635]


portfolio before change:  [1.96370864]
curr_Stock_Price:  99.11236729744607
curr_Factors:  [99.1123673  -1.08481165 -1.01119619]
mat_Sqrt:  [[12.18549607  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.02603715 0.1186752  0.13458879]
Stock Position:  0.026037146618899505
Bond Position:  [-0.6168946]


portfolio before change:  [1.94552817]
curr_Stock_Price:  98.4170776520096
curr_Factors:  [98.41707765 -1.08418499 -0.99789907]
mat_Sqrt:  [[12.2696691   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00630937 -0.08939664 -0.19896779]
Stock Position:  -0.006309366040017889
Bond Position:  [2.56647753]


portfolio before change:  [1.94995805]
curr_Stock_Price:  97.76581540419123
curr_Factors:  [97.7658154  -0.94835119 -1.04093537]
mat_Sqrt:  [[13.37367763  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00569418 -0.01573867 -0.10892449]
Stock Position:  -0.00569418327661863
Bond Position:  [2.50665452]


portfolio before change:  [1.95512756]
curr_Stock_Price:  96.9129876889708
curr_Factors:  [96.91298769 -1.13302933 -1.01400567]
mat_Sqrt:  [[11.32234873  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00252561  0.04472351  0.15276157]
Stock Position:  -0.0025256105156431247
Bond Position:  [2.19989202]


portfolio before change:  [1.95579279]
curr_Stock_Price:  96.75847902833603
curr_Factors:  [96.75847903 -1.21696196 -1.02303873]
mat_Sqrt:  [[10.30075584  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00069976  0.01853303 -0.09766864]
Stock Position:  -0.0006997628676385533
Bond Position:  [2.02350078]


portfolio before change:  [1.95601419]
curr_Stock_Price:  96.80356415954273
curr_Factors:  [96.80356416 -1.22522282 -1.00389067]
mat_Sqrt:  [[10.41836721  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00288976 -0.00717199  0.37695384]
Stock Position:  -0.002889760568006604
Bond Position:  [2.23575332]


portfolio before change:  [1.95540704]
curr_Stock_Price:  97.11038592686745
curr_Factors:  [97.11038593 -1.42102292 -1.00698546]
mat_Sqrt:  [[ 8.56633462  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01099344 -0.03081535  0.13656037]
Stock Position:  0.010993436947321725
Bond Position:  [0.88783013]


portfolio before change:  [1.95282122]
curr_Stock_Price:  96.8650754843211
curr_Factors:  [96.86507548 -1.02124291 -0.99525577]
mat_Sqrt:  [[12.89475135  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01357036 0.01256917 0.73556065]
Stock Position:  0.013570355299472866
Bond Position:  [0.63832773]


portfolio before change:  [1.95382478]
curr_Stock_Price:  96.93314767678095
curr_Factors:  [96.93314768 -0.88183441 -0.96593289]
mat_Sqrt:  [[15.27556103  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00084339 -0.01569977  0.68200612]
Stock Position:  0.0008433913629338064
Bond Position:  [1.8720722]


portfolio before change:  [1.95329431]
curr_Stock_Price:  96.02669887898887
curr_Factors:  [96.02669888 -0.89361658 -0.98927631]
mat_Sqrt:  [[14.61039667  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-5.49718090e-03 -2.19216971e-04 -2.38399765e-01]
Stock Position:  -0.005497180899875626
Bond Position:  [2.48117045]


portfolio before change:  [1.95246564]
curr_Stock_Price:  96.23386639695842
curr_Factors:  [96.2338664  -0.96860614 -0.9968691 ]
mat_Sqrt:  [[13.48133443  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.03905619  0.0507125   0.15960294]
Stock Position:  -0.039056190661895224
Bond Position:  [5.71099387]


portfolio before change:  [1.97359347]
curr_Stock_Price:  95.71118590491099
curr_Factors:  [95.7111859  -0.90167831 -0.99183653]
mat_Sqrt:  [[14.40852918  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00692321 -0.0757963   0.36107309]
Stock Position:  -0.0069232093996603
Bond Position:  [2.63622205]


portfolio before change:  [1.97395545]
curr_Stock_Price:  95.70650119662163
curr_Factors:  [95.7065012  -1.26683217 -0.9962744 ]
mat_Sqrt:  [[ 9.95604253  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01081574  0.0188168  -0.24738532]
Stock Position:  0.010815736835483354
Bond Position:  [0.93881912]


portfolio before change:  [1.96346607]
curr_Stock_Price:  94.72582439860028
curr_Factors:  [94.7258244  -0.92178872 -1.0012289 ]
mat_Sqrt:  [[13.84562149  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00150239 -0.01014995 -0.0429787 ]
Stock Position:  0.0015023927646036397
Bond Position:  [1.82115067]


portfolio before change:  [1.96529495]
curr_Stock_Price:  95.79160729148862
curr_Factors:  [95.79160729 -1.02669683 -0.99822147]
mat_Sqrt:  [[12.64493549  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01137256 -0.04542854 -0.34784658]
Stock Position:  -0.011372558623501242
Bond Position:  [3.05469062]


portfolio before change:  [1.95688542]
curr_Stock_Price:  96.5646424378438
curr_Factors:  [96.56464244 -1.39991048 -1.00113005]
mat_Sqrt:  [[ 8.75103628  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00362096  0.01523506 -0.27961935]
Stock Position:  0.0036209596761263125
Bond Position:  [1.60722875]


portfolio before change:  [1.95482389]
curr_Stock_Price:  95.93982257378568
curr_Factors:  [95.93982257 -1.26701328 -0.95946445]
mat_Sqrt:  [[10.35265922  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00905885 -0.01913809  0.18796939]
Stock Position:  0.009058853541080056
Bond Position:  [1.08571909]


portfolio before change:  [1.95624858]
curr_Stock_Price:  96.08211047704833
curr_Factors:  [96.08211048 -1.15296947 -0.95738864]
mat_Sqrt:  [[11.64462887  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0055927  -0.03104384 -0.2148771 ]
Stock Position:  0.005592702797654451
Bond Position:  [1.41888989]


portfolio before change:  [1.95690667]
curr_Stock_Price:  96.16806517346993
curr_Factors:  [96.16806517 -1.37859617 -0.99316421]
mat_Sqrt:  [[ 8.97404894  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.03522541 -0.15562329 -1.40140615]
Stock Position:  0.035225413899773655
Bond Position:  [-1.43065323]


portfolio before change:  [1.95356271]
curr_Stock_Price:  96.07821179863998
curr_Factors:  [96.0782118  -1.51503746 -1.00368609]
mat_Sqrt:  [[ 7.74028895  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00643962 -0.02626478 -0.00213304]
Stock Position:  -0.006439623694146365
Bond Position:  [2.57227024]


portfolio before change:  [1.95329492]
curr_Stock_Price:  96.16973002336383
curr_Factors:  [96.16973002 -1.02835753 -0.99979199]
mat_Sqrt:  [[12.65389576  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01237501 -0.00115282  0.05721379]
Stock Position:  -0.012375009901811005
Bond Position:  [3.14339628]


portfolio before change:  [1.95111098]
curr_Stock_Price:  96.37796321698548
curr_Factors:  [96.37796322 -0.87882185 -1.01548722]
mat_Sqrt:  [[14.49738828  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00601423 -0.0262352  -0.14177327]
Stock Position:  0.006014226764702941
Bond Position:  [1.37147205]


portfolio before change:  [1.94354841]
curr_Stock_Price:  95.09201087633971
curr_Factors:  [95.09201088 -1.21116214 -1.00849401]
mat_Sqrt:  [[10.33141033  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00045689  0.00380061 -0.26401485]
Stock Position:  0.0004568947838141603
Bond Position:  [1.90010137]


portfolio before change:  [1.94394796]
curr_Stock_Price:  95.44661669297804
curr_Factors:  [95.44661669 -1.16435674 -1.01316782]
mat_Sqrt:  [[10.81617331  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00241986  0.00949213 -0.17559274]
Stock Position:  -0.0024198606759561407
Bond Position:  [2.17491547]


portfolio before change:  [1.94642463]
curr_Stock_Price:  94.53549357033106
curr_Factors:  [94.53549357 -0.75395078 -1.00751341]
mat_Sqrt:  [[16.2405494   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00996292 -0.08060754 -0.13469332]
Stock Position:  0.009962919907799055
Bond Position:  [1.00457508]


portfolio before change:  [1.94992631]
curr_Stock_Price:  94.87435971534956
curr_Factors:  [94.87435972 -0.55681965 -1.01133474]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [1.94992631]
Stock Price:  93.57682896421704
PL:  [1.94992631]
Settle:  Tensor("sub_372:0", shape=(), dtype=float64)
PL:  Tensor("sub_373:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  187
output_Z_Vals[:, i, :]:  [[ 1.19260232e+02 -2.92559343e+01 -2.92733494e+01]
 [ 4.03706775e-03 -1.27034308e-01 -3.91946428e-02]
 [-2.78588843e-02  5.58907157e-02  1.14854147e-01]
 [-4.38446497e-02  1.18937446e-01  1.39056289e-02]
 [-2.36191220e-02  5.44774759e-02 -7.10118069e-02]
 [ 6.28673343e-02  2.91380841e-02  1.20971270e-02]
 [ 4.56918626e-02  3.32706192e-02 -4.73202102e-02]
 [-1.18749748e-01 -3.59414091e-02 -1.14357826e-01]
 [ 1.02837501e-01 -3.60675168e-02 -9.13333180e-02]
 [-4.72661022e-02  3.30659263e-02 -4.32274208e-02]
 [ 1.15827306e-01  9.57289704e-02  2.77315627e-03]
 [-2.56771370e-01 -1.18489016e-01  7.69235181e-02]
 [ 4.18231299e-03 -1.47605850e-01  7.38556615e-02]
 [-1.35308871e-01 -1.28363678e-01  3.55884375e-02]
 [-1.42970242e-01  1.04717669e-01  3.12287353e-01]
 [ 6.22914600e-02 -8.23410152e-01  7.61433287e-02]
 [-6.73692735e-02 -4.15494943e-01 -1.97598786e-01]
 [ 2.81331475e-01 -2.98989246e-02 -3.84579631e-01]
 [-1.48392752e-01  2.47486160e-02 -2.70018267e-01]
 [-7.17857396e-02 -3.15611796e-02  1.54093246e-01]
 [ 2.93378024e-01 -2.21516091e-01  1.33099232e-01]
 [ 9.71343235e-02  4.81428790e-01  5.08188542e-01]
 [-5.17822186e-02  1.27214135e-02  2.48619963e-01]
 [-1.08950255e-01 -7.54433004e-02 -7.15090232e-02]
 [-8.63666939e-01  1.77818670e-01  3.88584412e-02]
 [-1.83599753e-01 -3.11783116e-01  1.47146455e-01]
 [ 2.68568276e-02  6.97409738e-02 -4.88721607e-03]
 [ 7.70006985e-03 -5.28893360e-02 -3.72699475e-02]
 [-1.30780011e-01 -1.84826086e-01 -7.79633195e-02]
 [ 1.40352716e-01  1.89385614e-01  6.11797905e-02]
 [ 9.32470648e-02 -1.15561042e-01  8.69198707e-02]
 [ 1.05975563e-01  2.39259728e-02  5.90539085e-03]
 [ 5.31373424e-01 -6.31900168e-01 -6.68048314e-01]
 [-4.60981632e-02 -8.16416903e-02  3.23915454e-03]
 [-5.93832362e-02 -1.98075207e-01  6.55294336e-03]
 [ 1.99257552e-01 -1.59160079e-02 -1.43428367e-02]
 [ 2.00182890e-02 -1.12991922e-02 -8.88113919e-02]
 [-1.36234334e-02  3.32420739e-02 -5.64528301e-02]
 [ 1.14453291e-01 -2.01181965e-01 -2.43945540e-02]
 [-7.37461162e-01  3.77063769e-01  4.39923324e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.26023247 -29.25593426 -29.27334937]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  8.31486419  -9.25153874 -83.50871763]
init_Out:  [2.49911038]
Stock Position:  8.31486419409362
Bond position:  [-828.98730903]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [0.60668127]
curr_Stock_Price:  99.78486729568006
curr_Factors:  [99.7848673  -0.82762995 -0.98426444]
mat_Sqrt:  [[16.2992999   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00044441 -0.04017178 -0.11181141]
Stock Position:  -0.000444406630413636
Bond Position:  [0.65102633]


portfolio before change:  [0.60681544]
curr_Stock_Price:  99.66608185492153
curr_Factors:  [99.66608185 -0.79339262 -0.97623484]
mat_Sqrt:  [[16.98274706  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-1.74959191e-04  1.76741962e-02  3.27646911e-01]
Stock Position:  -0.0001749591907912406
Bond Position:  [0.62425294]


portfolio before change:  [0.60695613]
curr_Stock_Price:  99.30797528792259
curr_Factors:  [99.30797529 -0.81961225 -0.96018231]
mat_Sqrt:  [[16.75055391  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00226471  0.03761132  0.03966889]
Stock Position:  -0.0022647145680659503
Bond Position:  [0.83186035]


portfolio before change:  [0.60990661]
curr_Stock_Price:  98.05108781807257
curr_Factors:  [98.05108782 -0.55764087 -0.94442021]
mat_Sqrt:  [[21.83310876  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00168129  0.01722729 -0.20257692]
Stock Position:  -0.0016812880105572209
Bond Position:  [0.77475873]


portfolio before change:  [0.60933276]
curr_Stock_Price:  98.450011533745
curr_Factors:  [98.45001153 -0.64738567 -0.95739048]
mat_Sqrt:  [[19.78200678  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00334086 0.00921427 0.03450974]
Stock Position:  0.003340863887905044
Bond Position:  [0.28042467]


portfolio before change:  [0.61285456]
curr_Stock_Price:  99.49367607323678
curr_Factors:  [99.49367607 -0.66792254 -0.97086851]
mat_Sqrt:  [[19.32313416  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0019092   0.01052109 -0.13499139]
Stock Position:  0.0019091990211327727
Bond Position:  [0.42290133]


portfolio before change:  [0.61309926]
curr_Stock_Price:  99.59415672510545
curr_Factors:  [99.59415673 -0.60226899 -1.01620631]
mat_Sqrt:  [[19.7396282   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00724537 -0.01136567 -0.32623105]
Stock Position:  -0.0072453717545338855
Bond Position:  [1.33469595]


portfolio before change:  [0.62580701]
curr_Stock_Price:  97.8632719650093
curr_Factors:  [97.86327197 -0.65121636 -0.998954  ]
mat_Sqrt:  [[18.79143085  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0044309  -0.01140555 -0.26054853]
Stock Position:  0.004430897605008374
Bond Position:  [0.19218487]


portfolio before change:  [0.63064975]
curr_Stock_Price:  98.95079701070242
curr_Factors:  [98.95079701 -0.43326989 -0.98176974]
mat_Sqrt:  [[24.03673052  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00229799  0.01045636 -0.1233158 ]
Stock Position:  -0.002297987404304987
Bond Position:  [0.85803743]


portfolio before change:  [0.63450254]
curr_Stock_Price:  97.32087833154712
curr_Factors:  [97.32087833 -0.37609578 -0.98946638]
mat_Sqrt:  [[24.83990371  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00478525 0.03027216 0.00791104]
Stock Position:  0.004785247450502012
Bond Position:  [0.16879806]


portfolio before change:  [0.62217738]
curr_Stock_Price:  94.74080980994555
curr_Factors:  [94.74080981 -0.55935345 -1.00143224]
mat_Sqrt:  [[19.89282575  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0122722  -0.03746952  0.21944139]
Stock Position:  -0.012272202974825062
Bond Position:  [1.78485582]


portfolio before change:  [0.61912292]
curr_Stock_Price:  95.00788301278025
curr_Factors:  [95.00788301 -0.51985706 -0.99561126]
mat_Sqrt:  [[20.87373229  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00074001 -0.04667707  0.21068964]
Stock Position:  0.0007400147656544497
Bond Position:  [0.54881568]


portfolio before change:  [0.61840656]
curr_Stock_Price:  93.94713841713634
curr_Factors:  [93.94713842 -0.69008551 -1.01146036]
mat_Sqrt:  [[17.13608367  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00766562 -0.04059216  0.10152391]
Stock Position:  -0.007665622452273575
Bond Position:  [1.33856985]


portfolio before change:  [0.62868778]
curr_Stock_Price:  92.6277560689857
curr_Factors:  [92.62775607 -0.70730953 -1.015717  ]
mat_Sqrt:  [[16.53637188  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00462744  0.03311463  0.8908689 ]
Stock Position:  -0.004627439136401259
Bond Position:  [1.05731708]


portfolio before change:  [0.63557097]
curr_Stock_Price:  91.16884631404561
curr_Factors:  [91.16884631 -0.57246761 -0.9929527 ]
mat_Sqrt:  [[19.05430259  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00296908 -0.26038515  0.21721572]
Stock Position:  0.002969082333738286
Bond Position:  [0.36488316]


portfolio before change:  [0.63524482]
curr_Stock_Price:  91.04363591190284
curr_Factors:  [91.04363591 -0.57866137 -0.97887188]
mat_Sqrt:  [[19.17880294  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00617515 -0.13139104 -0.56369434]
Stock Position:  -0.006175150268732957
Bond Position:  [1.19745295]


portfolio before change:  [0.62359674]
curr_Stock_Price:  92.95415936385051
curr_Factors:  [92.95415936 -0.67485006 -1.01028292]
mat_Sqrt:  [[17.23553911  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01172331 -0.00945487 -1.09709864]
Stock Position:  0.0117233060241065
Bond Position:  [-0.46613331]


portfolio before change:  [0.63456126]
curr_Stock_Price:  93.894405043632
curr_Factors:  [93.89440504 -0.51968178 -1.00270095]
mat_Sqrt:  [[20.48694934  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00990245  0.0078262  -0.77028696]
Stock Position:  -0.00990245009923722
Bond Position:  [1.56434592]


portfolio before change:  [0.63611873]
curr_Stock_Price:  93.75687161457242
curr_Factors:  [93.75687161 -0.64606594 -1.01284747]
mat_Sqrt:  [[17.84621687  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00230561 -0.00998052  0.43958514]
Stock Position:  -0.0023056143378937717
Bond Position:  [0.85228592]


portfolio before change:  [0.63788503]
curr_Stock_Price:  93.03699607496985
curr_Factors:  [93.03699607 -0.54155001 -1.00690432]
mat_Sqrt:  [[19.77745986  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01591849 -0.07004954  0.37969506]
Stock Position:  0.015918488651091935
Bond Position:  [-0.84312334]


portfolio before change:  [0.6103341]
curr_Stock_Price:  91.31286645993762
curr_Factors:  [91.31286646 -0.61040052 -0.9832843 ]
mat_Sqrt:  [[18.55254322  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01149699 0.15224115 1.44972046]
Stock Position:  0.011496985115963483
Bond Position:  [-0.43948857]


portfolio before change:  [0.6329588]
curr_Stock_Price:  93.28552646868572
curr_Factors:  [93.28552647 -0.65168427 -0.98184809]
mat_Sqrt:  [[18.21294505  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-3.86766438e-05  4.02286417e-03  7.09243553e-01]
Stock Position:  -3.867664384239037e-05
Bond Position:  [0.63656677]


portfolio before change:  [0.63304255]
curr_Stock_Price:  93.17757500168062
curr_Factors:  [93.177575   -0.79929926 -0.98509382]
mat_Sqrt:  [[15.64441535  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00802171 -0.02385727 -0.20399534]
Stock Position:  -0.008021706692709194
Bond Position:  [1.38048573]


portfolio before change:  [0.6349167]
curr_Stock_Price:  92.96545324346121
curr_Factors:  [92.96545324 -0.93142811 -0.97289751]
mat_Sqrt:  [[13.84469782  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.06147796  0.0562312   0.11085232]
Stock Position:  -0.061477956791090284
Bond Position:  [6.35024282]


portfolio before change:  [0.60291148]
curr_Stock_Price:  93.49896238749976
curr_Factors:  [93.49896239 -0.93660365 -0.97690393]
mat_Sqrt:  [[13.79688383  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01171379 -0.09859448  0.41976788]
Stock Position:  -0.011713790998818944
Bond Position:  [1.69813878]


portfolio before change:  [0.60164272]
curr_Stock_Price:  93.62539770940288
curr_Factors:  [93.62539771 -0.91740557 -0.96610286]
mat_Sqrt:  [[14.23627462  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00194292  0.02205403 -0.01394187]
Stock Position:  0.001942919317023221
Bond Position:  [0.41973613]


portfolio before change:  [0.60080993]
curr_Stock_Price:  93.16976063065174
curr_Factors:  [93.16976063 -0.8225439  -0.96261288]
mat_Sqrt:  [[15.63116113  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-8.14541603e-05 -1.67250766e-02 -1.06320786e-01]
Stock Position:  -8.145416031903776e-05
Bond Position:  [0.60839899]


portfolio before change:  [0.60079104]
curr_Stock_Price:  94.33529542109568
curr_Factors:  [94.33529542 -0.93914518 -0.97443996]
mat_Sqrt:  [[13.9192151   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01088182 -0.05844714 -0.22240765]
Stock Position:  -0.010881820166621297
Bond Position:  [1.62733076]


portfolio before change:  [0.6004323]
curr_Stock_Price:  94.38695734191192
curr_Factors:  [94.38695734 -0.90771719 -0.94408184]
mat_Sqrt:  [[14.81446205  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01064709 0.05988899 0.17452891]
Stock Position:  0.0106470895204481
Bond Position:  [-0.40451409]


portfolio before change:  [0.6015069]
curr_Stock_Price:  94.4926365006296
curr_Factors:  [94.4926365  -1.17443684 -0.92452794]
mat_Sqrt:  [[11.58321583  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00932433 -0.03654361  0.2479582 ]
Stock Position:  0.00932433077913138
Bond Position:  [-0.2795737]


portfolio before change:  [0.60035149]
curr_Stock_Price:  94.37247115899655
curr_Factors:  [94.37247116 -1.23107664 -0.94143369]
mat_Sqrt:  [[10.7482084   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01002946 0.00756606 0.01684644]
Stock Position:  0.010029463277970111
Bond Position:  [-0.34615374]


portfolio before change:  [0.59833988]
curr_Stock_Price:  94.17621516905916
curr_Factors:  [94.17621517 -1.57916389 -0.92727305]
mat_Sqrt:  [[ 7.68085384  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.04930351 -0.19982438 -1.90575589]
Stock Position:  0.0493035082600223
Bond Position:  [-4.04487792]


portfolio before change:  [0.59721191]
curr_Stock_Price:  94.16359270377262
curr_Factors:  [94.1635927  -1.62057071 -0.90310287]
mat_Sqrt:  [[ 7.54858432  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00629853 -0.02581737  0.00924041]
Stock Position:  -0.006298525776525959
Bond Position:  [1.19030372]


portfolio before change:  [0.5970593]
curr_Stock_Price:  94.21144592627864
curr_Factors:  [94.21144593 -1.66493693 -0.91411598]
mat_Sqrt:  [[ 7.14554274  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00883906 -0.06263688  0.01869372]
Stock Position:  -0.008839062957483752
Bond Position:  [1.4298002]


portfolio before change:  [0.60010659]
curr_Stock_Price:  93.88691471940572
curr_Factors:  [93.88691472 -1.59719793 -0.89099161]
mat_Sqrt:  [[ 7.79826668  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.02512339 -0.00503308 -0.04091612]
Stock Position:  0.02512338850085438
Bond Position:  [-1.75865085]


portfolio before change:  [0.61661414]
curr_Stock_Price:  94.55272471121195
curr_Factors:  [94.55272471 -1.4977509  -0.90152645]
mat_Sqrt:  [[ 8.58383053  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 1.86163471e-04 -3.57311831e-03 -2.53354181e-01]
Stock Position:  0.00018616347102182748
Bond Position:  [0.59901188]


portfolio before change:  [0.61672859]
curr_Stock_Price:  94.76526606682582
curr_Factors:  [94.76526607 -1.45510047 -0.89399623]
mat_Sqrt:  [[ 9.04585154  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00268504  0.01051207 -0.16104421]
Stock Position:  -0.0026850443352711014
Bond Position:  [0.87117753]


portfolio before change:  [0.61662482]
curr_Stock_Price:  94.84447278859757
curr_Factors:  [94.84447279 -1.42788298 -0.91821874]
mat_Sqrt:  [[ 9.08056765  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01148378 -0.06361932 -0.06959087]
Stock Position:  0.01148378399381093
Bond Position:  [-0.47254861]


portfolio before change:  [0.62310945]
curr_Stock_Price:  95.41429370388067
curr_Factors:  [95.4142937  -1.56772745 -0.94250261]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [0.62310945]
Stock Price:  95.08739202343259
PL:  [0.62310945]
Settle:  Tensor("sub_374:0", shape=(), dtype=float64)
PL:  Tensor("sub_375:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  188
output_Z_Vals[:, i, :]:  [[ 1.19260232e+02 -2.92559343e+01 -2.92733494e+01]
 [-6.20242731e-03 -5.65184823e-02 -2.44120017e-02]
 [-3.95272601e-02 -4.16219975e-03  2.60558463e-02]
 [ 5.08431937e-02  1.32455152e-01  3.17670528e-02]
 [ 1.29154337e-01 -1.30492759e-04 -6.42523933e-02]
 [ 4.87023374e-02  2.95629351e-02  4.15094372e-02]
 [ 6.94473386e-02  1.62221627e-02 -6.40138462e-02]
 [-1.23120777e-01  2.54586248e-01  1.27047890e-02]
 [-1.29433158e-01 -2.98177810e-02  1.03335625e-01]
 [-4.16049642e-02  1.65309628e-01  3.33984730e-02]
 [ 5.55260523e-02  3.33890020e-02 -7.63794505e-02]
 [-4.87719696e-02  8.58694715e-02  6.55255405e-03]
 [-6.64287153e-02 -6.43319632e-02 -6.60891416e-02]
 [ 2.36030500e-01  1.96860456e-01  2.85305412e-01]
 [ 1.75623042e-01  2.21433153e-01  3.09715337e-02]
 [-6.10445367e-02 -7.05530222e-02 -1.19285202e-01]
 [-8.61480882e-02  1.41224682e-02 -1.10208896e-01]
 [ 6.47601834e-02 -9.91287082e-02 -8.24068978e-02]
 [ 2.52937846e-02  6.51397632e-02  2.65976771e-02]
 [ 3.20656007e-01 -1.86567483e-01 -7.26986476e-02]
 [ 1.59893950e-01  3.22122168e-03  2.44839641e-01]
 [-1.74472202e-03 -4.23966062e-03 -1.83677774e-03]
 [-1.26111240e-01  3.25377072e-01  1.62517022e-01]
 [ 2.60920297e-01 -3.77759328e-02  7.44055082e-02]
 [-1.04818111e-01 -3.73613020e-02 -9.50389990e-02]
 [ 1.05042602e-01 -3.31235877e-03  5.64219019e-02]
 [-1.10811517e-01  7.34848276e-02  9.69310315e-02]
 [-5.07806065e-02  7.36225950e-02  2.93687317e-02]
 [ 6.20848838e-02 -6.23725319e-02  9.08311027e-02]
 [-2.33045560e-02 -5.15042858e-02 -7.84622963e-02]
 [-1.31336803e-01  6.33291454e-01 -1.46287799e-02]
 [ 4.34951510e-02  5.17894959e-02  1.54164699e-01]
 [-6.60716506e-02  2.27031835e-02  8.38011601e-02]
 [-4.59687445e-01  3.47243729e-02  2.85282607e-02]
 [-1.14400643e-01  2.00954843e-02  3.62379502e-02]
 [ 1.07133076e-01 -1.55535024e-01 -1.27266705e-01]
 [-3.52087992e-01 -6.50483391e-01  2.03853674e-01]
 [-1.02528536e-01 -1.41737662e-01  3.05389670e-01]
 [-6.71415311e-03  1.58159143e-02 -4.42597414e-02]
 [ 3.34452305e-01 -2.26184858e-02 -3.40349840e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.26023247 -29.25593426 -29.27334937]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  8.31486419  -9.25153874 -83.50871763]
init_Out:  [2.49911038]
Stock Position:  8.31486419409362
Bond position:  [-828.98730903]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [4.29311643]
curr_Stock_Price:  100.22822212123819
curr_Factors:  [100.22822212  -1.10148731  -1.01780773]
mat_Sqrt:  [[12.03904075  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00105032 -0.01787271 -0.06964065]
Stock Position:  -0.0010503168398178972
Bond Position:  [4.39838782]


portfolio before change:  [4.29407494]
curr_Stock_Price:  99.8391233804208
curr_Factors:  [99.83912338 -0.82984908 -1.05511834]
mat_Sqrt:  [[15.158974    0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00226375 -0.0013162   0.07433008]
Stock Position:  -0.002263748213661445
Bond Position:  [4.52008558]


portfolio before change:  [4.29428504]
curr_Stock_Price:  99.99591910020841
curr_Factors:  [99.9959191  -0.75519487 -1.06487713]
mat_Sqrt:  [[16.20074753  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00374968 0.041886   0.09062256]
Stock Position:  0.0037496784265726195
Bond Position:  [3.9193325]


portfolio before change:  [4.29433593]
curr_Stock_Price:  99.87882654085767
curr_Factors:  [99.87882654 -0.8764971  -1.11101596]
mat_Sqrt:  [[13.68697506  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 8.47780478e-03 -4.12654335e-05 -1.83294194e-01]
Stock Position:  0.008477804781935652
Bond Position:  [3.44758274]


portfolio before change:  [4.30222604]
curr_Stock_Price:  100.75866889188416
curr_Factors:  [100.75866889  -0.92445169  -1.13724118]
mat_Sqrt:  [[12.82037075  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00451927 0.00934862 0.11841487]
Stock Position:  0.004519270829230438
Bond Position:  [3.84687033]


portfolio before change:  [4.29955979]
curr_Stock_Price:  100.06228789614025
curr_Factors:  [100.0622879   -0.88467428  -1.16099085]
mat_Sqrt:  [[12.93746984  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0043903   0.0051299  -0.18261369]
Stock Position:  0.004390303676461039
Bond Position:  [3.86025596]


portfolio before change:  [4.30338917]
curr_Stock_Price:  100.82460734711927
curr_Factors:  [100.82460735  -0.96084784  -1.15053755]
mat_Sqrt:  [[12.20684741  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00933526  0.08050724  0.03624323]
Stock Position:  -0.009335255057804272
Bond Position:  [5.24461259]


portfolio before change:  [4.29835827]
curr_Stock_Price:  101.43375138675847
curr_Factors:  [101.43375139  -1.07699566  -1.17983273]
mat_Sqrt:  [[10.61828479  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01027565 -0.00942921  0.29478778]
Stock Position:  -0.010275647704694869
Bond Position:  [5.34065577]


portfolio before change:  [4.30247582]
curr_Stock_Price:  101.09801318681316
curr_Factors:  [101.09801319  -1.0340131   -1.17605212]
mat_Sqrt:  [[11.08979433  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00275201  0.05227549  0.09527655]
Stock Position:  -0.0027520125487181736
Bond Position:  [4.58069882]


portfolio before change:  [4.30178353]
curr_Stock_Price:  101.55764447543608
curr_Factors:  [101.55764448  -1.23454768  -1.18447059]
mat_Sqrt:  [[ 9.03954003  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0045132   0.01055853 -0.21788931]
Stock Position:  0.004513201163009405
Bond Position:  [3.84343346]


portfolio before change:  [4.30335605]
curr_Stock_Price:  101.79961402101766
curr_Factors:  [101.79961402  -1.06792793  -1.20219526]
mat_Sqrt:  [[10.51584455  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00429992  0.02715431  0.01869261]
Stock Position:  -0.004299920440107806
Bond Position:  [4.74108629]


portfolio before change:  [4.30021993]
curr_Stock_Price:  102.66679051839468
curr_Factors:  [102.66679052  -1.07612342  -1.18465334]
mat_Sqrt:  [[10.70501094  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00762074 -0.02034355 -0.18853393]
Stock Position:  -0.007620744104477673
Bond Position:  [5.08261727]


portfolio before change:  [4.29949977]
curr_Stock_Price:  102.84466379665037
curr_Factors:  [102.8446638   -1.06372527  -1.19077463]
mat_Sqrt:  [[10.79107961  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.02774061 0.06225274 0.81389693]
Stock Position:  0.02774061065403986
Bond Position:  [1.446526]


portfolio before change:  [4.31565951]
curr_Stock_Price:  103.42067521275135
curr_Factors:  [103.42067521  -1.14237811  -1.16050832]
mat_Sqrt:  [[10.33895154  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01815101 0.07002331 0.08835316]
Stock Position:  0.018151014506289545
Bond Position:  [2.43846933]


portfolio before change:  [4.31794479]
curr_Stock_Price:  103.5297847563598
curr_Factors:  [103.52978476  -1.46854168  -1.14341495]
mat_Sqrt:  [[ 7.59813417  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0114785  -0.02231082 -0.34028748]
Stock Position:  -0.011478501941949024
Bond Position:  [5.50631162]


portfolio before change:  [4.31707688]
curr_Stock_Price:  103.66536322569071
curr_Factors:  [103.66536323  -1.40392732  -1.15367343]
mat_Sqrt:  [[ 8.03307428  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01347924  0.00446592 -0.3143953 ]
Stock Position:  -0.013479241021011884
Bond Position:  [5.7144073]


portfolio before change:  [4.31558379]
curr_Stock_Price:  103.82912849838917
curr_Factors:  [103.8291285   -1.37436736  -1.16485136]
mat_Sqrt:  [[ 8.19502965  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00553744 -0.03134725 -0.23508394]
Stock Position:  0.005537436166070016
Bond Position:  [3.74063662]


portfolio before change:  [4.3173867]
curr_Stock_Price:  104.0702677727458
curr_Factors:  [104.07026777  -1.29330927  -1.19490549]
mat_Sqrt:  [[ 8.64388008  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00374889 0.020599   0.07587577]
Stock Position:  0.0037488852082984596
Bond Position:  [3.92723921]


portfolio before change:  [4.31815508]
curr_Stock_Price:  104.14427482050479
curr_Factors:  [104.14427482  -1.15502699  -1.18872574]
mat_Sqrt:  [[ 9.99439523  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.03011681 -0.05899782 -0.20738901]
Stock Position:  0.03011681039571528
Bond Position:  [1.1816617]


portfolio before change:  [4.33459373]
curr_Stock_Price:  104.6851999863585
curr_Factors:  [104.68519999  -0.93365961  -1.2080327 ]
mat_Sqrt:  [[12.29589474  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.0170752  0.00101864 0.69845934]
Stock Position:  0.017075195304206814
Bond Position:  [2.5470735]


portfolio before change:  [4.34683429]
curr_Stock_Price:  105.38341448449619
curr_Factors:  [105.38341448  -1.23156279  -1.20365727]
mat_Sqrt:  [[ 9.22931849  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00024153 -0.0013407  -0.00523982]
Stock Position:  -0.0002415259889669824
Bond Position:  [4.37228712]


portfolio before change:  [4.34730364]
curr_Stock_Price:  105.7031229052872
curr_Factors:  [105.70312291  -1.17968711  -1.20912054]
mat_Sqrt:  [[ 9.69709917  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0087177   0.10289326  0.46361583]
Stock Position:  -0.00871769899378614
Bond Position:  [5.26879165]


portfolio before change:  [4.34398551]
curr_Stock_Price:  106.15929475372512
curr_Factors:  [106.15929475  -1.05806003  -1.2368167 ]
mat_Sqrt:  [[10.69807707  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.02571798 -0.0119458   0.2122582 ]
Stock Position:  0.025717975862619334
Bond Position:  [1.61378333]


portfolio before change:  [4.33637116]
curr_Stock_Price:  105.85537954647201
curr_Factors:  [105.85537955  -0.75190407  -1.22244605]
mat_Sqrt:  [[14.6981804   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00851687 -0.01181468 -0.27111981]
Stock Position:  -0.00851687263391763
Bond Position:  [5.23792795]


portfolio before change:  [4.33431632]
curr_Stock_Price:  106.1735272473158
curr_Factors:  [106.17352725  -0.61177805  -1.22348023]
mat_Sqrt:  [[16.94235198  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00687473 -0.00104746  0.16095598]
Stock Position:  0.006874733203543081
Bond Position:  [3.60440165]


portfolio before change:  [4.33342708]
curr_Stock_Price:  105.97863710737943
curr_Factors:  [105.97863711  -0.55988103  -1.23689428]
mat_Sqrt:  [[17.57473276  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00507138  0.02323794  0.27651725]
Stock Position:  -0.005071381968226347
Bond Position:  [4.87088523]


portfolio before change:  [4.33883776]
curr_Stock_Price:  105.03179757003146
curr_Factors:  [105.03179757  -0.49654169  -1.23011029]
mat_Sqrt:  [[18.68294653  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0022954   0.02328151  0.08378082]
Stock Position:  -0.0022953987441944332
Bond Position:  [4.57992762]


portfolio before change:  [4.34353856]
curr_Stock_Price:  103.23330029492604
curr_Factors:  [103.23330029  -0.39672011  -1.21356564]
mat_Sqrt:  [[20.62916245  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00383027 -0.01972393  0.25911585]
Stock Position:  0.003830269568981691
Bond Position:  [3.94812719]


portfolio before change:  [4.34954062]
curr_Stock_Price:  104.67145418644834
curr_Factors:  [104.67145419  -0.38427109  -1.19487133]
mat_Sqrt:  [[21.57820999  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00188387 -0.01628709 -0.22383109]
Stock Position:  -0.0018838652575146387
Bond Position:  [4.54672754]


portfolio before change:  [4.34588722]
curr_Stock_Price:  106.91247658784286
curr_Factors:  [106.91247659  -0.53106847  -1.22121426]
mat_Sqrt:  [[18.53624101  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00636436  0.20026434 -0.04173184]
Stock Position:  -0.0063643634914288625
Bond Position:  [5.02631708]


portfolio before change:  [4.34357849]
curr_Stock_Price:  107.37396036935391
curr_Factors:  [107.37396037  -0.40459381  -1.25203795]
mat_Sqrt:  [[20.48485707  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00372476 0.01637728 0.43978898]
Stock Position:  0.0037247556645686702
Bond Position:  [3.94363673]


portfolio before change:  [4.3520059]
curr_Stock_Price:  109.50414601741709
curr_Factors:  [109.50414602  -0.46110976  -1.24095038]
mat_Sqrt:  [[19.96343337  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00242341  0.00717938  0.23906138]
Stock Position:  -0.002423411638880387
Bond Position:  [4.61737952]


portfolio before change:  [4.35146293]
curr_Stock_Price:  109.96637948683251
curr_Factors:  [109.96637949  -0.62627879  -1.23824121]
mat_Sqrt:  [[17.04155336  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02658018  0.01098081  0.08138319]
Stock Position:  -0.026580180175900317
Bond Position:  [7.27438911]


portfolio before change:  [4.32088361]
curr_Stock_Price:  111.15104668639286
curr_Factors:  [111.15104669  -0.64429911  -1.24383948]
mat_Sqrt:  [[16.8230752   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00632968  0.00635475  0.10337679]
Stock Position:  -0.006329683377171276
Bond Position:  [5.02443455]


portfolio before change:  [4.31365982]
curr_Stock_Price:  112.39153419848846
curr_Factors:  [112.3915342   -0.66911148  -1.25161608]
mat_Sqrt:  [[16.46539744  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00468491 -0.04918449 -0.36305648]
Stock Position:  0.0046849140628516086
Bond Position:  [3.78711514]


portfolio before change:  [4.31640181]
curr_Stock_Price:  112.87576378006453
curr_Factors:  [112.87576378  -0.50434564  -1.28056819]
mat_Sqrt:  [[18.94185351  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01727771 -0.20570091  0.58153779]
Stock Position:  -0.01727771489175033
Bond Position:  [6.26663707]


portfolio before change:  [4.3152102]
curr_Stock_Price:  112.99007222228296
curr_Factors:  [112.99007222  -0.51389654  -1.30379269]
mat_Sqrt:  [[18.34965413  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00238973 -0.04482138  0.87119172]
Stock Position:  -0.0023897334113083704
Bond Position:  [4.58522635]


portfolio before change:  [4.31791513]
curr_Stock_Price:  112.09802928855976
curr_Factors:  [112.09802929  -0.27958308  -1.27478676]
mat_Sqrt:  [[23.6888368   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00064757  0.00500143 -0.12626072]
Stock Position:  -0.0006475737903555876
Bond Position:  [4.39050688]


portfolio before change:  [4.31858498]
curr_Stock_Price:  111.9111805428075
curr_Factors:  [111.91118054  -0.28440805  -1.27430717]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [4.31858498]
Stock Price:  111.81943984682778
PL:  [-7.50085487]
Settle:  Tensor("sub_376:0", shape=(), dtype=float64)
PL:  Tensor("sub_377:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  189
output_Z_Vals[:, i, :]:  [[ 1.19260232e+02 -2.92559343e+01 -2.92733494e+01]
 [-4.92884207e-02  8.51553511e-02  2.30107967e-03]
 [-4.09986688e-02 -5.01102397e-02 -4.08794472e-02]
 [ 8.39493924e-02  1.61057470e-01  3.78328956e-02]
 [ 2.19049661e-01 -2.72555207e-02 -5.29470077e-02]
 [ 3.29220315e-02  3.09925717e-02  5.76865872e-02]
 [ 2.33625932e-02  6.18415729e-02 -1.88584994e-02]
 [ 1.34064064e-01  1.32975453e-01  1.19868172e-01]
 [ 7.90313503e-03  2.41293458e-02 -3.49730650e-02]
 [-3.31013899e-02  3.89773508e-01  1.63944198e-01]
 [ 2.40626280e-02 -1.14364514e-01 -3.05945897e-02]
 [-1.12661931e-01  1.20198359e-01  4.59803981e-02]
 [-8.44500033e-03 -1.48394767e-01 -3.26845859e-02]
 [ 3.91223281e-01  2.87193561e-01  3.72311302e-01]
 [ 1.36345743e-01  1.31151881e-01 -2.07769269e-02]
 [-5.93608159e-02 -9.59733175e-02 -1.34156468e-01]
 [-8.64346681e-02  1.37935978e-02 -1.05498609e-01]
 [ 1.14213155e-02 -2.15874290e-01 -6.79083113e-02]
 [ 1.48799158e-02  5.92709969e-02  4.00572741e-03]
 [ 2.90971830e-01 -7.88312125e-02 -5.21848379e-02]
 [-5.11789348e-02  6.43827119e-03  1.19894401e-02]
 [ 5.94728616e-02 -4.65182988e-02  5.77949639e-02]
 [-1.18629199e-01  2.45901382e-01  3.72898418e-01]
 [ 1.48383421e-01 -2.34646935e-02 -6.84938546e-03]
 [-1.09611832e-01 -3.86937000e-02 -9.90749712e-02]
 [ 1.01067113e-01  5.32739407e-03  5.62057309e-02]
 [-1.47757100e-01  7.19326191e-02  8.61681386e-02]
 [-5.07806065e-02  7.36225950e-02  2.93687317e-02]
 [ 6.20848838e-02 -6.23725319e-02  9.08311027e-02]
 [ 3.79679907e-02  8.75828227e-03 -3.28835254e-02]
 [-3.05252808e-02  3.09434571e-01  1.42024019e-02]
 [ 2.69495970e-02 -1.21877718e-01 -6.72299183e-02]
 [ 8.56346625e-02 -8.69741622e-02 -9.65457230e-03]
 [-3.56274359e-02 -7.43734513e-02  1.60113726e-02]
 [-1.24701862e-01  4.67344629e-02  3.61189126e-02]
 [ 8.47165236e-02 -1.65012150e-01 -1.38726811e-01]
 [-2.12717659e-01 -3.60952760e-01  6.56075615e-02]
 [-4.92519276e-02 -3.50106583e-02  5.31355595e-02]
 [-3.60306642e-02  7.72960111e-02 -2.58649584e-02]
 [ 3.98337579e-02  3.30249138e-03 -3.03338436e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.26023247 -29.25593426 -29.27334937]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  8.31486419  -9.25153874 -83.50871763]
init_Out:  [2.49911038]
Stock Position:  8.31486419409362
Bond position:  [-828.98730903]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [7.13066953]
curr_Stock_Price:  100.56948483157962
curr_Factors:  [100.56948483  -0.94654795  -1.00316132]
mat_Sqrt:  [[14.31259054  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00325727  0.02692849  0.00656434]
Stock Position:  -0.0032572728814928144
Bond Position:  [7.45825178]


portfolio before change:  [7.13147109]
curr_Stock_Price:  100.60963500346371
curr_Factors:  [100.609635    -0.84435019  -1.02025884]
mat_Sqrt:  [[15.5901453   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00324801 -0.01584625 -0.11661768]
Stock Position:  -0.0032480128261463924
Bond Position:  [7.45825247]


portfolio before change:  [7.13311904]
curr_Stock_Price:  100.38931035040277
curr_Factors:  [100.38931035  -0.99972516  -1.024077  ]
mat_Sqrt:  [[13.26665273  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00722341 0.05093084 0.10792672]
Stock Position:  0.007223411044760303
Bond Position:  [6.40796579]


portfolio before change:  [7.13728288]
curr_Stock_Price:  100.85485052181258
curr_Factors:  [100.85485052  -0.90499723  -1.06194446]
mat_Sqrt:  [[14.10798112  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01471069 -0.00861895 -0.15104308]
Stock Position:  0.014710691940055946
Bond Position:  [5.65363824]


portfolio before change:  [7.14758997]
curr_Stock_Price:  101.50746051958215
curr_Factors:  [101.50746052  -1.03702607  -1.08479975]
mat_Sqrt:  [[12.16188008  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00374099 0.00980071 0.16456378]
Stock Position:  0.0037409908070615474
Bond Position:  [6.76785149]


portfolio before change:  [7.14898144]
curr_Stock_Price:  101.65326142090989
curr_Factors:  [101.65326142  -1.12321047  -1.08869303]
mat_Sqrt:  [[11.13022218  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00189663  0.01955602 -0.05379805]
Stock Position:  0.0018966252759577645
Bond Position:  [6.9561833]


portfolio before change:  [7.15060884]
curr_Stock_Price:  102.05282337445519
curr_Factors:  [102.05282337  -1.03950797  -1.12220557]
mat_Sqrt:  [[11.74910441  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01378535 0.04205053 0.34195053]
Stock Position:  0.01378534553604418
Bond Position:  [5.74377541]


portfolio before change:  [7.14249648]
curr_Stock_Price:  101.41226043384582
curr_Factors:  [101.41226043  -0.78193278  -1.09282014]
mat_Sqrt:  [[15.55591696  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 8.91818254e-05  7.63036912e-03 -9.97684197e-02]
Stock Position:  8.918182537560726e-05
Bond Position:  [7.13345235]


portfolio before change:  [7.14339692]
curr_Stock_Price:  101.50991342072575
curr_Factors:  [101.50991342  -0.74073811  -1.10448862]
mat_Sqrt:  [[16.03750004  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00065019 0.12325721 0.46768716]
Stock Position:  0.0006501941169072773
Bond Position:  [7.07739577]


portfolio before change:  [7.14539272]
curr_Stock_Price:  103.21873790366287
curr_Factors:  [103.2187379   -0.86707965  -1.13717317]
mat_Sqrt:  [[13.90985508  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00106864 -0.03616523 -0.08727785]
Stock Position:  0.0010686419326536357
Bond Position:  [7.03508885]


portfolio before change:  [7.14714268]
curr_Stock_Price:  104.03334434640136
curr_Factors:  [104.03334435  -0.60882516  -1.1115523 ]
mat_Sqrt:  [[18.62181996  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00537932  0.03801006  0.13116928]
Stock Position:  -0.005379319204815412
Bond Position:  [7.70677125]


portfolio before change:  [7.14731878]
curr_Stock_Price:  104.17970382965548
curr_Factors:  [104.17970383  -0.80078919  -1.11526069]
mat_Sqrt:  [[15.33392123  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00123571 -0.04692655 -0.09324003]
Stock Position:  -0.0012357080488811024
Bond Position:  [7.27605447]


portfolio before change:  [7.14837293]
curr_Stock_Price:  104.0626918826673
curr_Factors:  [104.06269188  -0.72337138  -1.13897418]
mat_Sqrt:  [[16.16176002  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.02936786 0.09081858 1.06210051]
Stock Position:  0.02936786046412038
Bond Position:  [4.09227432]


portfolio before change:  [7.16761257]
curr_Stock_Price:  104.70039818769295
curr_Factors:  [104.70039819  -1.1002826   -1.13881341]
mat_Sqrt:  [[11.15632853  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01214477  0.04147387 -0.05927079]
Stock Position:  0.012144765858795804
Bond Position:  [5.89605075]


portfolio before change:  [7.16850838]
curr_Stock_Price:  104.71347031849837
curr_Factors:  [104.71347032  -0.82954564  -1.15718202]
mat_Sqrt:  [[14.36076901  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.006213   -0.03034943 -0.38271106]
Stock Position:  -0.006212996718697013
Bond Position:  [7.81909283]


portfolio before change:  [7.17467261]
curr_Stock_Price:  103.87864285375252
curr_Factors:  [103.87864285  -0.71086398  -1.14936337]
mat_Sqrt:  [[16.16738555  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0066562   0.00436192 -0.30095817]
Stock Position:  -0.006656198805489804
Bond Position:  [7.8661095]


portfolio before change:  [7.17972037]
curr_Stock_Price:  103.26801799672916
curr_Factors:  [103.268018    -0.6155898   -1.13843611]
mat_Sqrt:  [[17.87318979  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0004484  -0.06826544 -0.19372351]
Stock Position:  -0.0004483956596715297
Bond Position:  [7.2260253]


portfolio before change:  [7.18112367]
curr_Stock_Price:  102.15296621672138
curr_Factors:  [102.15296622  -0.5612606   -1.11329438]
mat_Sqrt:  [[19.14260321  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00089998 0.01874313 0.01142723]
Stock Position:  0.0008999795821931118
Bond Position:  [7.08918808]


portfolio before change:  [7.18186564]
curr_Stock_Price:  101.99270433971104
curr_Factors:  [101.99270434  -0.72751692  -1.11057886]
mat_Sqrt:  [[16.22909311  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01714724 -0.02492862 -0.14886882]
Stock Position:  0.017147244727400313
Bond Position:  [5.43297178]


portfolio before change:  [7.16804883]
curr_Stock_Price:  101.14732228517695
curr_Factors:  [101.14732229  -0.56811101  -1.09108845]
mat_Sqrt:  [[19.24745086  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00252321  0.00203596  0.03420254]
Stock Position:  -0.00252321024097954
Bond Position:  [7.42326479]


portfolio before change:  [7.17141128]
curr_Stock_Price:  100.18248697620311
curr_Factors:  [100.18248698  -0.27288568  -1.07238569]
mat_Sqrt:  [[26.0944337   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00268521 -0.01471038  0.16487295]
Stock Position:  0.002685212974457797
Bond Position:  [6.90239996]


portfolio before change:  [7.17866919]
curr_Stock_Price:  102.56407016957837
curr_Factors:  [102.56407017  -0.29944519  -1.05093057]
mat_Sqrt:  [[26.57874724  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00136058  0.07776084  1.06377539]
Stock Position:  -0.0013605788593562403
Bond Position:  [7.31821569]


portfolio before change:  [7.17862875]
curr_Stock_Price:  103.26617926720438
curr_Factors:  [103.26617927  -0.17889655  -1.05426295]
mat_Sqrt:  [[30.08872218  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00486493 -0.00742019 -0.01953939]
Stock Position:  0.004864927099210315
Bond Position:  [6.67624631]


portfolio before change:  [7.19087409]
curr_Stock_Price:  105.61169525033677
curr_Factors:  [105.61169525  -0.15540058  -1.05451145]
mat_Sqrt:  [[31.4958909   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00415402 -0.01223602 -0.28263332]
Stock Position:  -0.004154017837679473
Bond Position:  [7.62958696]


portfolio before change:  [7.196726]
curr_Stock_Price:  104.4325615717024
curr_Factors:  [104.43256157  -0.40155774  -1.04779201]
mat_Sqrt:  [[24.51271003  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.0045967  0.00168467 0.16033931]
Stock Position:  0.004596701579629146
Bond Position:  [6.71668067]


portfolio before change:  [7.19627307]
curr_Stock_Price:  104.15136719179067
curr_Factors:  [104.15136719  -0.47536473  -1.00960839]
mat_Sqrt:  [[23.5911627   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00543894  0.02274709  0.24581371]
Stock Position:  -0.005438935426215329
Bond Position:  [7.76274563]


portfolio before change:  [7.19465847]
curr_Stock_Price:  104.62664453910013
curr_Factors:  [104.62664454  -0.48523127  -1.00855884]
mat_Sqrt:  [[23.49078312  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0018256   0.02328151  0.08378082]
Stock Position:  -0.0018256016325450054
Bond Position:  [7.38566504]


portfolio before change:  [7.19590863]
curr_Stock_Price:  104.44758328886071
curr_Factors:  [104.44758329  -0.4647319   -0.99915154]
mat_Sqrt:  [[24.16250165  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00327016 -0.01972393  0.25911585]
Stock Position:  0.003270160280296336
Bond Position:  [6.85434829]


portfolio before change:  [7.19358479]
curr_Stock_Price:  103.47494385058609
curr_Factors:  [103.47494385  -0.76147541  -0.97132197]
mat_Sqrt:  [[18.29324966  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00172095  0.00276961 -0.09380755]
Stock Position:  0.0017209521365897814
Bond Position:  [7.01550936]


portfolio before change:  [7.19478241]
curr_Stock_Price:  103.66125182710765
curr_Factors:  [103.66125183  -0.95212463  -0.97829779]
mat_Sqrt:  [[15.03988943  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00130564  0.0978518   0.0405155 ]
Stock Position:  -0.0013056386787879057
Bond Position:  [7.33012655]


portfolio before change:  [7.19526958]
curr_Stock_Price:  103.98994142345504
curr_Factors:  [103.98994142  -0.93045577  -0.99565549]
mat_Sqrt:  [[15.15276334  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00066519 -0.03854112 -0.19178824]
Stock Position:  0.0006651907623358197
Bond Position:  [7.12609643]


portfolio before change:  [7.19643169]
curr_Stock_Price:  104.39777587990602
curr_Factors:  [104.39777588  -1.09528568  -1.02940657]
mat_Sqrt:  [[12.47237407  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00652789 -0.02750365 -0.02754181]
Stock Position:  0.006527888555888985
Bond Position:  [6.51493464]


portfolio before change:  [7.1981867]
curr_Stock_Price:  104.54186419856906
curr_Factors:  [104.5418642   -0.9235154   -1.06819931]
mat_Sqrt:  [[14.2659117   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00240289 -0.02351895  0.04567599]
Stock Position:  -0.0024028918082023014
Bond Position:  [7.44938949]


portfolio before change:  [7.19852769]
curr_Stock_Price:  104.78750047412139
curr_Factors:  [104.78750047  -1.020907    -1.09280963]
mat_Sqrt:  [[12.65709413  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00917449  0.01477873  0.1030372 ]
Stock Position:  -0.009174494544084267
Bond Position:  [8.15990004]


portfolio before change:  [7.19856994]
curr_Stock_Price:  104.89407884702156
curr_Factors:  [104.89407885  -1.01539123  -1.09214551]
mat_Sqrt:  [[12.74850899  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00408977 -0.05218142 -0.39574898]
Stock Position:  0.004089767401746259
Bond Position:  [6.76957756]


portfolio before change:  [7.19925049]
curr_Stock_Price:  104.85356318110559
curr_Factors:  [104.85356318  -1.04062219  -1.08451421]
mat_Sqrt:  [[12.52126427  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01666328 -0.11414328  0.18716011]
Stock Position:  -0.01666327992189141
Bond Position:  [8.94645476]


portfolio before change:  [7.20420713]
curr_Stock_Price:  104.62322032825463
curr_Factors:  [104.62322033  -0.93661644  -1.07725822]
mat_Sqrt:  [[13.96411542  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00281505 -0.01107134  0.15158096]
Stock Position:  -0.002815047503602461
Bond Position:  [7.49872647]


portfolio before change:  [7.20530049]
curr_Stock_Price:  104.56781910204099
curr_Factors:  [104.5678191   -1.10049016  -1.08523892]
mat_Sqrt:  [[11.75297935  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00334507  0.02444314 -0.07378553]
Stock Position:  -0.003345071165318788
Bond Position:  [7.55508729]


portfolio before change:  [7.20906871]
curr_Stock_Price:  103.72365849399952
curr_Factors:  [103.72365849  -1.10327792  -1.07728861]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [7.20906871]
Stock Price:  104.45513551387492
PL:  [2.7539332]
Settle:  Tensor("sub_378:0", shape=(), dtype=float64)
PL:  Tensor("sub_379:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  190
output_Z_Vals[:, i, :]:  [[ 1.19260232e+02 -2.92559343e+01 -2.92733494e+01]
 [-4.89829536e-02  8.41475011e-02  2.10032454e-03]
 [-4.73759524e-02  1.93460392e-02  1.03526603e-01]
 [-4.30619410e-03  1.35690395e-01  2.12806132e-02]
 [ 9.83159899e-02  1.04427639e-02 -6.73261872e-02]
 [ 6.70423067e-02  2.94068100e-02 -4.39074351e-02]
 [ 5.08997111e-02  2.92211511e-02 -5.43201344e-02]
 [-1.08167301e-01 -5.98608893e-02 -1.19548473e-01]
 [-8.10700134e-02 -6.69804168e-02  9.30185874e-02]
 [-3.02373184e-02 -1.38282977e-03 -7.13025778e-02]
 [ 5.56007837e-02  1.35353360e-01 -8.14286931e-02]
 [-9.63497439e-02  6.26464517e-02  2.50574033e-02]
 [-1.05268475e-01  3.60169765e-02 -5.01576103e-02]
 [-1.24650995e-01 -9.86963442e-02  5.44431195e-02]
 [ 2.99046012e-01  3.97071571e-01  7.05245686e-02]
 [-7.50284541e-02 -8.34420208e-02 -1.08113235e-01]
 [-7.22929180e-02 -5.62541249e-02 -6.11282673e-02]
 [-8.00339639e-02  1.55549172e-01  1.24565049e-01]
 [ 1.43242378e-01  7.19960385e-02  1.74993042e-01]
 [ 1.64152699e-01 -5.11524954e-02  1.97975883e-02]
 [-4.46656690e-02  2.69987355e-04 -4.85221953e-02]
 [ 9.26794546e-02 -6.36498979e-02  8.96993286e-02]
 [-2.14044769e-02 -9.09785853e-02  1.72343230e-01]
 [-6.74375827e-02 -5.93328645e-04 -8.23460557e-02]
 [-3.39508792e-01  1.18926261e-01  5.90258855e-02]
 [-2.81591151e-02 -1.37090187e-01  9.73140637e-02]
 [ 2.35647180e-01  4.12919794e-02 -1.32115274e-01]
 [ 2.03920612e-02  8.66559974e-03  1.03620592e-02]
 [-8.30235269e-02 -7.88456747e-02 -1.95208389e-01]
 [ 8.55110304e-03 -8.66208117e-03 -1.18534452e-01]
 [ 4.41244590e-02  3.94556049e-02  1.50693732e-02]
 [ 2.74699434e-02 -6.86668932e-02 -8.77984775e-02]
 [ 3.28250692e-01 -3.57901059e-01 -3.22961426e-01]
 [-4.81170510e-02 -8.36126508e-02 -2.31480066e-03]
 [-1.78670757e-01  1.01430551e-01  2.38828507e-02]
 [ 8.04690044e-02 -1.61495957e-01 -1.36768461e-01]
 [-1.23613643e-01 -2.40051347e-01  1.25195261e-02]
 [-3.08036938e-02 -2.32529365e-03 -3.36613343e-02]
 [-4.82464693e-02  9.42594656e-02  6.81925896e-03]
 [-5.68033337e-01  2.88893603e-01  3.46708569e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.26023247 -29.25593426 -29.27334937]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  8.31486419  -9.25153874 -83.50871763]
init_Out:  [2.49911038]
Stock Position:  8.31486419409362
Bond position:  [-828.98730903]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [7.16789174]
curr_Stock_Price:  100.57396141874726
curr_Factors:  [100.57396142  -0.89927899  -0.99295566]
mat_Sqrt:  [[15.15997517  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00305947  0.02660978  0.00599164]
Stock Position:  -0.0030594738438377545
Bond Position:  [7.47559514]


portfolio before change:  [7.17321542]
curr_Stock_Price:  99.13934541989016
curr_Factors:  [99.13934542 -1.11940785 -0.99718566]
mat_Sqrt:  [[11.94046297  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00215604  0.00611775  0.29533258]
Stock Position:  -0.002156043730781129
Bond Position:  [7.38696418]


portfolio before change:  [7.17378339]
curr_Stock_Price:  99.30420861313993
curr_Factors:  [99.30420861 -0.93257277 -1.00534106]
mat_Sqrt:  [[14.3002087   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00024763 0.04290907 0.06070767]
Stock Position:  0.0002476330167010352
Bond Position:  [7.14919239]


portfolio before change:  [7.17474083]
curr_Stock_Price:  99.56158164229329
curr_Factors:  [99.56158164 -0.89199952 -1.02728508]
mat_Sqrt:  [[14.6068671   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00580841  0.00330229 -0.19206287]
Stock Position:  0.005808413258615652
Bond Position:  [6.59644602]


portfolio before change:  [7.17279205]
curr_Stock_Price:  99.08410360278319
curr_Factors:  [99.0841036  -0.83359887 -1.01912059]
mat_Sqrt:  [[15.53739286  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00378693  0.00929925 -0.12525569]
Stock Position:  0.00378693003158946
Bond Position:  [6.79756748]


portfolio before change:  [7.17573346]
curr_Stock_Price:  99.63644071679765
curr_Factors:  [99.63644072 -0.71956528 -1.0246739 ]
mat_Sqrt:  [[17.41424917  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00232948  0.00924054 -0.15496022]
Stock Position:  0.0023294801036062743
Bond Position:  [6.94363235]


portfolio before change:  [7.17615644]
curr_Stock_Price:  99.44539968709506
curr_Factors:  [99.44539969 -0.85637967 -1.04673706]
mat_Sqrt:  [[14.82762525  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00904498 -0.01892968 -0.34103852]
Stock Position:  -0.009044983947841489
Bond Position:  [8.07563849]


portfolio before change:  [7.17365217]
curr_Stock_Price:  99.83387901552118
curr_Factors:  [99.83387902 -1.10748663 -1.04355261]
mat_Sqrt:  [[11.6169861   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.005493   -0.02118107  0.26535614]
Stock Position:  -0.005492999662511382
Bond Position:  [7.72203964]


portfolio before change:  [7.17290403]
curr_Stock_Price:  100.14581363753703
curr_Factors:  [100.14581364  -1.22897622  -1.01695695]
mat_Sqrt:  [[10.59830511  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0042297  -0.00043729 -0.20340641]
Stock Position:  -0.004229695231943039
Bond Position:  [7.5964903]


portfolio before change:  [7.17435941]
curr_Stock_Price:  100.0262391734339
curr_Factors:  [100.02623917  -1.25473073  -1.01152028]
mat_Sqrt:  [[10.37274327  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00409477  0.04280249 -0.2322934 ]
Stock Position:  0.004094773089518559
Bond Position:  [6.76477466]


portfolio before change:  [7.17333303]
curr_Stock_Price:  99.56906288111865
curr_Factors:  [99.56906288 -1.13208038 -1.00698745]
mat_Sqrt:  [[11.7257077   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00764281  0.01981055  0.0714818 ]
Stock Position:  -0.00764281361308957
Bond Position:  [7.93432082]


portfolio before change:  [7.17096698]
curr_Stock_Price:  100.0084178189999
curr_Factors:  [100.00841782  -1.26402112  -1.02222303]
mat_Sqrt:  [[10.16560756  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01127103  0.01138957 -0.1430857 ]
Stock Position:  -0.011271033173940478
Bond Position:  [8.29816517]


portfolio before change:  [7.17440248]
curr_Stock_Price:  99.79564495123023
curr_Factors:  [99.79564495 -1.22110304 -1.02587977]
mat_Sqrt:  [[10.55016749  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01100325 -0.03121052  0.15531107]
Stock Position:  -0.0110032536187442
Bond Position:  [8.27247927]


portfolio before change:  [7.17337076]
curr_Stock_Price:  99.9833932330535
curr_Factors:  [99.98339323 -1.2402377  -1.04883131]
mat_Sqrt:  [[10.13439507  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.03194015 0.12556506 0.20118696]
Stock Position:  0.03194015244238724
Bond Position:  [3.97988594]


portfolio before change:  [7.17852001]
curr_Stock_Price:  100.12903215577285
curr_Factors:  [100.12903216  -1.24435492  -1.05216746]
mat_Sqrt:  [[10.0737929   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00985244 -0.02638668 -0.30841697]
Stock Position:  -0.009852439937076842
Bond Position:  [8.16503528]


portfolio before change:  [7.1763199]
curr_Stock_Price:  100.45593649479007
curr_Factors:  [100.45593649  -1.2583736   -1.04055287]
mat_Sqrt:  [[10.082414    0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00855184 -0.01778912 -0.17438193]
Stock Position:  -0.008551835758581277
Bond Position:  [8.03540257]


portfolio before change:  [7.17878535]
curr_Stock_Price:  100.28509981178686
curr_Factors:  [100.28509981  -1.31047545  -1.0199922 ]
mat_Sqrt:  [[ 9.7527518   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00518735  0.04918897  0.35534941]
Stock Position:  -0.005187353102828612
Bond Position:  [7.69899958]


portfolio before change:  [7.17996405]
curr_Stock_Price:  100.24341043841342
curr_Factors:  [100.24341044  -1.50825668  -1.05913396]
mat_Sqrt:  [[ 7.69222971  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.02350705 0.02276715 0.49920644]
Stock Position:  0.02350704802771621
Bond Position:  [4.82353738]


portfolio before change:  [7.18803539]
curr_Stock_Price:  100.5611177627506
curr_Factors:  [100.56111776  -1.42701876  -1.04652891]
mat_Sqrt:  [[ 8.47582513  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01968813 -0.01617584  0.05647701]
Stock Position:  0.01968812597548672
Bond Position:  [5.20817543]


portfolio before change:  [7.20139715]
curr_Stock_Price:  101.20672011340002
curr_Factors:  [101.20672011  -1.37709447  -1.0549625 ]
mat_Sqrt:  [[ 8.89161049  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-6.13648672e-03  8.53774980e-05 -1.38420317e-01]
Stock Position:  -0.006136486717603274
Bond Position:  [7.82245084]


portfolio before change:  [7.20612457]
curr_Stock_Price:  100.5956932826923
curr_Factors:  [100.59569328  -1.5132828   -1.03408626]
mat_Sqrt:  [[ 7.87537176  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01388453 -0.02012787  0.25588722]
Stock Position:  0.013884528036863302
Bond Position:  [5.80940085]


portfolio before change:  [7.19119725]
curr_Stock_Price:  99.46828401854816
curr_Factors:  [99.46828402 -1.1853895  -1.03915351]
mat_Sqrt:  [[10.75419415  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00106246 -0.02876995  0.49164726]
Stock Position:  0.0010624580878355926
Bond Position:  [7.08551637]


portfolio before change:  [7.19155827]
curr_Stock_Price:  98.97440388174779
curr_Factors:  [98.97440388 -1.03635602 -1.03379568]
mat_Sqrt:  [[12.48726808  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-6.74781065e-03 -1.87626992e-04 -2.34910376e-01]
Stock Position:  -0.006747810654746183
Bond Position:  [7.8594188]


portfolio before change:  [7.19710896]
curr_Stock_Price:  98.29741273063483
curr_Factors:  [98.29741273 -0.98868622 -1.01248767]
mat_Sqrt:  [[13.28750097  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02441313  0.03760779  0.16838442]
Stock Position:  -0.024413132421253456
Bond Position:  [9.59685672]


portfolio before change:  [7.1795289]
curr_Stock_Price:  99.0666606372231
curr_Factors:  [99.06666064 -1.21797439 -1.00174747]
mat_Sqrt:  [[10.76253479  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00109961 -0.04335172  0.27760994]
Stock Position:  -0.001099612564058029
Bond Position:  [7.28846384]


portfolio before change:  [7.18100317]
curr_Stock_Price:  98.55452122808192
curr_Factors:  [98.55452123 -1.10005513 -1.04425655]
mat_Sqrt:  [[11.54552865  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01816681  0.01305767 -0.3768881 ]
Stock Position:  0.018166809277087515
Bond Position:  [5.39058198]


portfolio before change:  [7.1740831]
curr_Stock_Price:  98.13650999340307
curr_Factors:  [98.13650999 -1.15905551 -1.05826055]
mat_Sqrt:  [[10.6871641   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00212694 0.0027403  0.02956007]
Stock Position:  0.0021269395917406266
Bond Position:  [6.96535267]


portfolio before change:  [7.17502803]
curr_Stock_Price:  98.1713987784397
curr_Factors:  [98.17139878 -1.05624449 -1.06248566]
mat_Sqrt:  [[11.79864581  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01058647 -0.02493319 -0.5568752 ]
Stock Position:  -0.010586474170883415
Bond Position:  [8.21431701]


portfolio before change:  [7.17070337]
curr_Stock_Price:  98.67690349297438
curr_Factors:  [98.67690349 -1.07878184 -1.05968115]
mat_Sqrt:  [[11.62767364  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0013647  -0.00273919 -0.3381458 ]
Stock Position:  -0.0013647007225384073
Bond Position:  [7.30536781]


portfolio before change:  [7.1718175]
curr_Stock_Price:  98.52969076675713
curr_Factors:  [98.52969077 -1.02913071 -1.06379665]
mat_Sqrt:  [[12.15123201  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00396826 0.01247696 0.04298873]
Stock Position:  0.003968257806545686
Bond Position:  [6.78082629]


portfolio before change:  [7.17614206]
curr_Stock_Price:  99.40586917496069
curr_Factors:  [99.40586917 -1.22784694 -1.07274214]
mat_Sqrt:  [[ 9.96044835  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00078061 -0.02171438 -0.25046462]
Stock Position:  0.000780605689927756
Bond Position:  [7.09854527]


portfolio before change:  [7.17614141]
curr_Stock_Price:  98.26826618640382
curr_Factors:  [98.26826619 -1.19507059 -1.07189599]
mat_Sqrt:  [[10.18315175  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.02485336 -0.11317825 -0.92131905]
Stock Position:  0.02485335654718485
Bond Position:  [4.73384516]


portfolio before change:  [7.19942168]
curr_Stock_Price:  99.18116104978498
curr_Factors:  [99.18116105 -0.9883042  -1.08637592]
mat_Sqrt:  [[12.45681631  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00407395 -0.02644064 -0.00660348]
Stock Position:  -0.004073948416504246
Bond Position:  [7.60348062]


portfolio before change:  [7.20097622]
curr_Stock_Price:  99.03289067404899
curr_Factors:  [99.03289067 -0.87279608 -1.0742364 ]
mat_Sqrt:  [[14.1316864   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01211298  0.03207516  0.06813113]
Stock Position:  -0.012112975079507734
Bond Position:  [8.40055916]


portfolio before change:  [7.18944783]
curr_Stock_Price:  100.07132460987772
curr_Factors:  [100.07132461  -1.08195684  -1.09495352]
mat_Sqrt:  [[11.34722039  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00426373 -0.05106951 -0.39016235]
Stock Position:  0.0042637271257157175
Bond Position:  [6.76277101]


portfolio before change:  [7.19381114]
curr_Stock_Price:  100.89640158443395
curr_Factors:  [100.89640158  -1.17135864  -1.09611473]
mat_Sqrt:  [[10.45019769  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0121774  -0.0759109   0.03571472]
Stock Position:  -0.012177396829897609
Bond Position:  [8.42246666]


portfolio before change:  [7.19435465]
curr_Stock_Price:  100.93822994300442
curr_Factors:  [100.93822994  -1.11047174  -1.08357437]
mat_Sqrt:  [[11.25106324  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00335389 -0.00073532 -0.09602642]
Stock Position:  -0.0033538895768370812
Bond Position:  [7.53289033]


portfolio before change:  [7.19722012]
curr_Stock_Price:  100.36462792815139
curr_Factors:  [100.36462793  -1.07231879  -1.06369009]
mat_Sqrt:  [[11.85560732  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00374681  0.02980746  0.01945345]
Stock Position:  -0.003746811422881033
Bond Position:  [7.57326745]


portfolio before change:  [7.19967944]
curr_Stock_Price:  99.9609220407396
curr_Factors:  [99.96092204 -0.99326873 -1.05363325]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [7.19967944]
Stock Price:  99.54902574589491
PL:  [7.19967944]
Settle:  Tensor("sub_380:0", shape=(), dtype=float64)
PL:  Tensor("sub_381:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  191
output_Z_Vals[:, i, :]:  [[ 1.19260232e+02 -2.92559343e+01 -2.92733494e+01]
 [-1.38209304e-02 -3.18651577e-02 -2.10084073e-02]
 [-6.20568870e-02 -1.07178324e-01 -1.16151825e-01]
 [ 8.34257805e-02  1.56296252e-01  3.77692861e-02]
 [ 1.33494350e-01 -1.54006951e-03 -6.41264925e-02]
 [ 4.60752904e-02  3.01445023e-02  4.29586124e-02]
 [-1.18410323e-02  6.05319565e-02 -7.41166449e-02]
 [ 2.98663783e-01  2.01457544e-02  1.72058404e-01]
 [ 6.41858862e-02  6.37666802e-02  5.88727914e-02]
 [-5.11668209e-02  8.41244918e-02  1.90631765e-02]
 [-4.05087474e-03 -2.38238142e-01  9.91935596e-03]
 [-1.66293562e-01  1.49015314e-01  7.90776095e-02]
 [ 5.78097238e-02 -2.45043069e-01  5.99147842e-03]
 [ 6.10686396e-01  4.13917364e-01  4.88695930e-01]
 [ 7.88563843e-02 -1.55962821e-02 -1.13115327e-01]
 [-5.80520174e-02 -9.83914790e-02 -1.36718298e-01]
 [-7.97339112e-02 -1.72524836e-02 -7.54984717e-02]
 [ 8.28966156e-03 -1.45796763e-01 -5.07867818e-02]
 [ 2.00253771e-02  6.89337197e-02  2.46006114e-02]
 [ 3.26304023e-01 -1.22413743e-01 -7.44124764e-02]
 [ 1.04612480e-01  1.14974639e-02  1.53862710e-01]
 [ 1.48675870e-02 -1.57126029e-02  1.43451893e-02]
 [-9.64843292e-02  1.75152499e-01  2.74936841e-01]
 [ 2.36592732e-01 -3.12863628e-02  5.54891022e-02]
 [-2.82219569e-02  3.41731751e-04 -8.48356081e-03]
 [ 1.03848803e-01 -7.17928810e-04  5.63569879e-02]
 [-8.30127867e-02  8.85527314e-02  9.89958279e-02]
 [-5.07806065e-02  7.36225950e-02  2.93687317e-02]
 [ 6.20848838e-02 -6.23725319e-02  9.08311027e-02]
 [-5.48940282e-02 -1.28672590e-01  1.08477639e-02]
 [-9.78085688e-02  5.43268731e-01 -1.21883540e-02]
 [ 4.27249596e-02 -8.06805909e-02 -4.08783697e-03]
 [ 1.14089508e-01 -1.19501153e-01 -4.69096207e-02]
 [-2.33047791e-01 -1.82649354e-03  4.95713244e-02]
 [ 8.54648123e-02  2.12461977e-01 -9.55316063e-03]
 [ 8.47165236e-02 -1.65012150e-01 -1.38726811e-01]
 [-2.64755316e-01 -4.72704293e-01  1.18926273e-01]
 [-4.56856694e-02 -3.51084461e-02  3.71856330e-02]
 [-3.53416221e-02  7.58510104e-02 -2.62973011e-02]
 [ 1.40104205e-01 -7.61196200e-03 -1.33375026e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.26023247 -29.25593426 -29.27334937]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  8.31486419  -9.25153874 -83.50871763]
init_Out:  [2.49911038]
Stock Position:  8.31486419409362
Bond position:  [-828.98730903]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [5.59733546]
curr_Stock_Price:  100.38507603972695
curr_Factors:  [100.38507604  -0.8357397   -1.00728303]
mat_Sqrt:  [[15.8947811   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00119108 -0.01007665 -0.05993114]
Stock Position:  -0.0011910833079271535
Bond Position:  [5.71690245]


portfolio before change:  [5.59799217]
curr_Stock_Price:  100.4337273532105
curr_Factors:  [100.43372735  -1.01954957  -1.0063063 ]
mat_Sqrt:  [[13.24529265  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00668416 -0.03389276 -0.33134883]
Stock Position:  -0.006684156694000359
Bond Position:  [6.26930695]


portfolio before change:  [5.59710631]
curr_Stock_Price:  100.68350823261105
curr_Factors:  [100.68350823  -0.95325884  -0.9987636 ]
mat_Sqrt:  [[14.29571123  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00665731 0.04942521 0.10774526]
Stock Position:  0.006657308201216501
Bond Position:  [4.92682517]


portfolio before change:  [5.5919155]
curr_Stock_Price:  99.81127889702788
curr_Factors:  [99.8112789  -0.95714871 -1.01174333]
mat_Sqrt:  [[13.9347978   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00863772 -0.00048701 -0.18293503]
Stock Position:  0.00863771557683713
Bond Position:  [4.72977407]


portfolio before change:  [5.60239047]
curr_Stock_Price:  100.95552953320863
curr_Factors:  [100.95552953  -0.82597313  -1.02108943]
mat_Sqrt:  [[15.92065876  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00349373 0.00953253 0.12254896]
Stock Position:  0.003493731569636492
Bond Position:  [5.24967895]


portfolio before change:  [5.60736837]
curr_Stock_Price:  102.19249963872764
curr_Factors:  [102.19249964  -0.83367591  -1.06021658]
mat_Sqrt:  [[15.37842875  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00165213  0.01914189 -0.21143416]
Stock Position:  -0.0016521259157940287
Bond Position:  [5.77620324]


portfolio before change:  [5.60648325]
curr_Stock_Price:  103.16529931590227
curr_Factors:  [103.16529932  -0.90122723  -1.05661577]
mat_Sqrt:  [[14.56307986  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.02295567 0.00637065 0.49083473]
Stock Position:  0.0229556674541368
Bond Position:  [3.23825495]


portfolio before change:  [5.62684604]
curr_Stock_Price:  104.03471353531116
curr_Factors:  [104.03471354  -0.92401076  -1.06487627]
mat_Sqrt:  [[14.23690592  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00546816 0.02016479 0.16794769]
Stock Position:  0.00546816095025622
Bond Position:  [5.05796748]


portfolio before change:  [5.62978449]
curr_Stock_Price:  104.45645655328195
curr_Factors:  [104.45645655  -0.7301249   -1.08036645]
mat_Sqrt:  [[17.08633382  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00263974  0.0266025   0.05438194]
Stock Position:  -0.002639740139786494
Bond Position:  [5.90552239]


portfolio before change:  [5.62797716]
curr_Stock_Price:  105.4207803013298
curr_Factors:  [105.4207803   -0.77110684  -1.10523466]
mat_Sqrt:  [[16.14512697  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00050649 -0.07533752  0.02829716]
Stock Position:  -0.0005064919641136131
Bond Position:  [5.68137194]


portfolio before change:  [5.62846569]
curr_Stock_Price:  105.85846743295563
curr_Factors:  [105.85846743  -0.6536508   -1.1272239 ]
mat_Sqrt:  [[17.83616774  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00820268  0.04712278  0.22558641]
Stock Position:  -0.008202678742897856
Bond Position:  [6.49678869]


portfolio before change:  [5.62435994]
curr_Stock_Price:  106.45801527386719
curr_Factors:  [106.45801527  -0.71464391  -1.11994163]
mat_Sqrt:  [[16.99918063  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00310049 -0.07748942  0.01709202]
Stock Position:  0.0031004873416297977
Bond Position:  [5.29428821]


portfolio before change:  [5.6237973]
curr_Stock_Price:  106.0630882566491
curr_Factors:  [106.06308826  -0.89196891  -1.11928151]
mat_Sqrt:  [[14.19349375  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.05080696 0.13089216 1.39411346]
Stock Position:  0.05080696470189587
Bond Position:  [0.23505372]


portfolio before change:  [5.61559271]
curr_Stock_Price:  105.90102443975753
curr_Factors:  [105.90102444  -0.88732482  -1.13747281]
mat_Sqrt:  [[13.98111236  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00395992 -0.00493198 -0.32268654]
Stock Position:  0.0039599224394941965
Bond Position:  [5.19623287]


portfolio before change:  [5.6128153]
curr_Stock_Price:  105.03560676204062
curr_Factors:  [105.03560676  -0.65756061  -1.12266722]
mat_Sqrt:  [[17.70897499  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00499746 -0.03111412 -0.39001925]
Stock Position:  -0.0049974648605818515
Bond Position:  [6.13772705]


portfolio before change:  [5.62579851]
curr_Stock_Price:  102.59117827511287
curr_Factors:  [102.59117828  -0.42957728  -1.11285366]
mat_Sqrt:  [[21.94020961  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00435686 -0.00545571 -0.21537612]
Stock Position:  -0.004356860355066823
Bond Position:  [6.07277394]


portfolio before change:  [5.62549183]
curr_Stock_Price:  102.83580864060531
curr_Factors:  [102.83580864  -0.77309795  -1.11880876]
mat_Sqrt:  [[15.50599807  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00037673 -0.04610498 -0.14488055]
Stock Position:  -0.0003767318345441262
Bond Position:  [5.66423335]


portfolio before change:  [5.62619357]
curr_Stock_Price:  102.852618155791
curr_Factors:  [102.85261816  -1.17522899  -1.07507958]
mat_Sqrt:  [[10.83724161  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00247543 0.02179876 0.0701787 ]
Stock Position:  0.002475428510287251
Bond Position:  [5.37158927]


portfolio before change:  [5.62672471]
curr_Stock_Price:  102.795921886579
curr_Factors:  [102.79592189  -0.92858796  -1.08109735]
mat_Sqrt:  [[13.77782442  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.02235142 -0.03871062 -0.21227808]
Stock Position:  0.022351419293072734
Bond Position:  [3.32908996]


portfolio before change:  [5.64259557]
curr_Stock_Price:  103.48736311170526
curr_Factors:  [103.48736311  -0.83733515  -1.08368856]
mat_Sqrt:  [[15.15644421  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00899396 0.00363582 0.43892749]
Stock Position:  0.00899395896616992
Bond Position:  [4.71183447]


portfolio before change:  [5.64073168]
curr_Stock_Price:  103.21463491890619
curr_Factors:  [103.21463492  -0.85322998  -1.08928504]
mat_Sqrt:  [[14.79509392  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0011754  -0.00496876  0.04092283]
Stock Position:  0.001175395635690067
Bond Position:  [5.51941365]


portfolio before change:  [5.64095312]
curr_Stock_Price:  102.81601936889413
curr_Factors:  [102.81601937  -0.73265663  -1.08074738]
mat_Sqrt:  [[16.7690874   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00213731  0.05538808  0.78431828]
Stock Position:  -0.0021373055442049853
Bond Position:  [5.86070237]


portfolio before change:  [5.63617718]
curr_Stock_Price:  105.39336182925918
curr_Factors:  [105.39336183  -1.00480035  -1.09861071]
mat_Sqrt:  [[12.86214615  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01921231 -0.00989362  0.15829496]
Stock Position:  0.019212313731382817
Bond Position:  [3.61132685]


portfolio before change:  [5.62706769]
curr_Stock_Price:  104.89571557256413
curr_Factors:  [104.89571557  -0.80753166  -1.08916035]
mat_Sqrt:  [[15.74109269  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00190234  0.00010807 -0.02420124]
Stock Position:  -0.0019023350945291553
Bond Position:  [5.82661449]


portfolio before change:  [5.62646895]
curr_Stock_Price:  105.59333932775918
curr_Factors:  [105.59333933  -0.7895168   -1.08531529]
mat_Sqrt:  [[16.19598222  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00712115 -0.00022703  0.1607708 ]
Stock Position:  0.00712115429232127
Bond Position:  [4.87452249]


portfolio before change:  [5.63431411]
curr_Stock_Price:  106.60944022309566
curr_Factors:  [106.60944022  -0.83106807  -1.0827503 ]
mat_Sqrt:  [[15.72660241  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00384819  0.02800283  0.28240754]
Stock Position:  -0.003848188226901963
Bond Position:  [6.04456731]


portfolio before change:  [5.63347411]
curr_Stock_Price:  107.02408292577695
curr_Factors:  [107.02408293  -0.81859969  -1.06888839]
mat_Sqrt:  [[16.20898646  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00264574  0.02328151  0.08378082]
Stock Position:  -0.0026457429722831728
Bond Position:  [5.91663232]


portfolio before change:  [5.63301706]
curr_Stock_Price:  107.47638323910547
curr_Factors:  [107.47638324  -1.14031474  -1.03884   ]
mat_Sqrt:  [[12.15956861  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0064982  -0.01972393  0.25911585]
Stock Position:  0.006498195427416061
Bond Position:  [4.93461452]


portfolio before change:  [5.63418099]
curr_Stock_Price:  107.56056976617279
curr_Factors:  [107.56056977  -1.35094649  -1.03201711]
mat_Sqrt:  [[ 9.92533449  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00564233 -0.04068985  0.03094565]
Stock Position:  -0.0056423337381760474
Bond Position:  [6.24107362]


portfolio before change:  [5.6351028]
curr_Stock_Price:  107.53546962175665
curr_Factors:  [107.53546962  -1.20791387  -1.02893671]
mat_Sqrt:  [[11.48417686  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00751202  0.17179666 -0.03476998]
Stock Position:  -0.007512020130998252
Bond Position:  [6.44291141]


portfolio before change:  [5.64777933]
curr_Stock_Price:  105.95518650083298
curr_Factors:  [105.9551865   -1.20626616  -1.01229367]
mat_Sqrt:  [[11.52428336  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00345422 -0.02551344 -0.01166146]
Stock Position:  0.003454216475029265
Bond Position:  [5.28178718]


portfolio before change:  [5.64960299]
curr_Stock_Price:  106.2919910990772
curr_Factors:  [106.2919911   -1.39628016  -0.99092198]
mat_Sqrt:  [[ 9.76678943  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01038505 -0.03778958 -0.13382009]
Stock Position:  0.010385051948781688
Bond Position:  [4.54575514]


portfolio before change:  [5.66270664]
curr_Stock_Price:  107.49905247694925
curr_Factors:  [107.49905248  -1.57662953  -1.01356019]
mat_Sqrt:  [[ 8.06305335  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02765407 -0.00057759  0.14141319]
Stock Position:  -0.027654070584353495
Bond Position:  [8.63549302]


portfolio before change:  [5.67292612]
curr_Stock_Price:  107.16854120877109
curr_Factors:  [107.16854121  -1.80732613  -0.96255143]
mat_Sqrt:  [[ 6.71621791  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01325158  0.06718638 -0.02725251]
Stock Position:  0.013251584053398865
Bond Position:  [4.25277319]


portfolio before change:  [5.6664952]
curr_Stock_Price:  106.64312781827195
curr_Factors:  [106.64312782  -1.60346621  -0.91779709]
mat_Sqrt:  [[ 8.56963129  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00608409 -0.05218142 -0.39574898]
Stock Position:  0.006084093315774028
Bond Position:  [5.01766845]


portfolio before change:  [5.66276713]
curr_Stock_Price:  105.92727561307726
curr_Factors:  [105.92727561  -1.88867886  -0.91229916]
mat_Sqrt:  [[ 6.43514745  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.03926635 -0.14948222  0.33926355]
Stock Position:  -0.03926635183853702
Bond Position:  [9.8221448]


portfolio before change:  [5.65742847]
curr_Stock_Price:  106.09450546758569
curr_Factors:  [106.09450547  -1.88166793  -0.93243544]
mat_Sqrt:  [[ 6.36126265  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00613112 -0.01110227  0.10608026]
Stock Position:  -0.006131122419886648
Bond Position:  [6.30790687]


portfolio before change:  [5.66075183]
curr_Stock_Price:  105.68107056139648
curr_Factors:  [105.68107056  -2.01392482  -0.93105035]
mat_Sqrt:  [[ 5.55918003  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00697065  0.0239862  -0.07501888]
Stock Position:  -0.006970645192419092
Bond Position:  [6.39741707]


portfolio before change:  [5.66118395]
curr_Stock_Price:  105.7338067768321
curr_Factors:  [105.73380678  -1.85794455  -0.93149144]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [5.66118395]
Stock Price:  105.3173613409351
PL:  [0.34382261]
Settle:  Tensor("sub_382:0", shape=(), dtype=float64)
PL:  Tensor("sub_383:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  192
output_Z_Vals[:, i, :]:  [[ 1.19260232e+02 -2.92559343e+01 -2.92733494e+01]
 [-8.83689292e-03 -4.82082154e-02 -2.39481720e-02]
 [-5.07160876e-02 -5.53228182e-02 -4.45683640e-02]
 [ 2.24138109e-02  1.56261423e-01  2.61952149e-02]
 [ 6.19622369e-02  2.25188352e-02 -6.94319832e-02]
 [ 6.93030717e-02  2.88814638e-02 -1.05544368e-01]
 [ 7.64586303e-02  1.03386715e-02 -7.62350678e-02]
 [-9.25593539e-02 -3.21597770e-03 -9.88900887e-02]
 [ 5.49158949e-02 -4.13778135e-02 -7.00292496e-02]
 [-9.74464465e-02 -1.40203628e-01 -1.24871593e-01]
 [ 6.62529564e-02  1.27921860e-01 -1.01517197e-01]
 [-1.25012680e-01  1.27276255e-02  3.29489995e-02]
 [-1.14261955e-01  4.93581553e-02 -3.85962522e-02]
 [-9.62623594e-02 -1.14884369e-01  6.32126881e-02]
 [ 2.21901496e-01  2.62076591e-01  1.72582760e-02]
 [-8.44984731e-02 -1.32706652e-01 -1.05316078e-01]
 [-6.76340349e-02 -6.51032407e-02 -5.20715152e-02]
 [-5.49804214e-02  1.52105219e-01  7.87059333e-02]
 [ 5.14328575e-02  5.06562441e-02  2.06144014e-02]
 [-3.14959471e-02 -8.16168641e-03  9.62491158e-02]
 [ 3.38097847e-02 -7.47089162e-02  4.66567014e-02]
 [ 1.13100312e-01 -6.03126904e-02  1.44000721e-01]
 [-7.86151173e-02  1.01911689e-01  3.37046786e-01]
 [ 4.63164630e-02 -2.18503353e-02 -6.97545267e-02]
 [ 8.69290252e-02  2.82800241e-02  9.94215915e-02]
 [ 5.33012187e-02 -4.57929611e-02  7.12275772e-02]
 [-1.16195770e-01  5.71092900e-02  1.63226747e-02]
 [-5.07806065e-02  7.36225950e-02  2.93687317e-02]
 [ 5.98824135e-02 -8.51192862e-02 -7.76815141e-02]
 [ 7.86206313e-02  7.81747226e-02 -7.73577180e-02]
 [ 2.36275977e-02  1.54881064e-01  1.31866420e-02]
 [ 5.29985519e-02 -1.09929457e-01 -5.59724660e-02]
 [ 1.84759868e-01 -8.35021061e-02  5.32529402e-02]
 [-4.37957963e-02 -7.93939805e-02  9.57295975e-03]
 [-2.06259524e-01  1.94988144e-01  2.36208417e-02]
 [ 9.53363837e-02 -1.60522354e-01 -1.33297576e-01]
 [-8.52192395e-02 -1.56202794e-01 -3.22543929e-02]
 [-2.89369347e-02  1.98503454e-02 -4.48818388e-02]
 [-1.45606034e-02  6.53845780e-02 -1.31874678e-02]
 [-8.48027363e-01  4.21054275e-01  5.19790307e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.26023247 -29.25593426 -29.27334937]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  8.31486419  -9.25153874 -83.50871763]
init_Out:  [2.49911038]
Stock Position:  8.31486419409362
Bond position:  [-828.98730903]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [5.09695258]
curr_Stock_Price:  100.32489671796996
curr_Factors:  [100.32489672  -1.03755713  -0.99214654]
mat_Sqrt:  [[13.18012767  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0011358  -0.01524478 -0.06831747]
Stock Position:  -0.001135802641761659
Bond Position:  [5.21090186]


portfolio before change:  [5.09774075]
curr_Stock_Price:  100.20448420272862
curr_Factors:  [100.2044842   -1.1673866   -0.98292303]
mat_Sqrt:  [[11.66862132  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00524843 -0.01749461 -0.12714114]
Stock Position:  -0.0052484345985851465
Bond Position:  [5.62365743]


portfolio before change:  [5.10365564]
curr_Stock_Price:  99.21144679399355
curr_Factors:  [99.21144679 -1.09852555 -0.96286095]
mat_Sqrt:  [[12.62737278  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00251799 0.0494142  0.07472766]
Stock Position:  0.0025179853232245126
Bond Position:  [4.85384267]


portfolio before change:  [5.10400216]
curr_Stock_Price:  99.10809062911241
curr_Factors:  [99.10809063 -0.95357151 -0.94270233]
mat_Sqrt:  [[14.87879788  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.003251    0.00712108 -0.19807012]
Stock Position:  0.0032509969507843435
Bond Position:  [4.78180206]


portfolio before change:  [5.10568806]
curr_Stock_Price:  99.44280071779362
curr_Factors:  [99.44280072 -1.08463199 -0.94312288]
mat_Sqrt:  [[13.08972731  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00370555  0.00913312 -0.3010887 ]
Stock Position:  0.0037055496176853935
Bond Position:  [4.73719783]


portfolio before change:  [5.10452265]
curr_Stock_Price:  98.96848672374126
curr_Factors:  [98.96848672 -0.96857093 -0.95939382]
mat_Sqrt:  [[14.39436378  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00424917  0.00326937 -0.21747743]
Stock Position:  0.0042491739459799265
Bond Position:  [4.68398834]


portfolio before change:  [5.10320304]
curr_Stock_Price:  98.52012894443094
curr_Factors:  [98.52012894 -0.91882814 -0.93876021]
mat_Sqrt:  [[15.37391951  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00733894 -0.00101698 -0.2821059 ]
Stock Position:  -0.007338938181225214
Bond Position:  [5.82623618]


portfolio before change:  [5.10946719]
curr_Stock_Price:  97.7658196563742
curr_Factors:  [97.76581966 -1.01438614 -0.92489149]
mat_Sqrt:  [[14.05948693  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00281325 -0.01308481 -0.19977396]
Stock Position:  0.0028132508516662425
Bond Position:  [4.83442742]


portfolio before change:  [5.10935563]
curr_Stock_Price:  97.51134253070899
curr_Factors:  [97.51134253 -1.09465362 -0.9210129 ]
mat_Sqrt:  [[12.99158951  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00974136 -0.04433628 -0.3562239 ]
Stock Position:  -0.009741363495078731
Bond Position:  [6.05924906]


portfolio before change:  [5.10632462]
curr_Stock_Price:  97.9002474024728
curr_Factors:  [97.9002474  -1.25030404 -0.90242572]
mat_Sqrt:  [[11.37274053  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00429393  0.04045244 -0.28960031]
Stock Position:  0.004293931914747137
Bond Position:  [4.68594762]


portfolio before change:  [5.11204241]
curr_Stock_Price:  99.09542578448684
curr_Factors:  [99.09542578 -1.21972009 -0.91789451]
mat_Sqrt:  [[11.6869014   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01009321  0.00402483  0.09399432]
Stock Position:  -0.010093211554368904
Bond Position:  [6.11223351]


portfolio before change:  [5.11059536]
curr_Stock_Price:  99.3144965405891
curr_Factors:  [99.31449654 -1.18503808 -0.89449162]
mat_Sqrt:  [[12.4132178   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00973688  0.01560842 -0.11010436]
Stock Position:  -0.00973687581775311
Bond Position:  [6.07760828]


portfolio before change:  [5.11423645]
curr_Stock_Price:  99.01857564572569
curr_Factors:  [99.01857565 -1.01828137 -0.88352092]
mat_Sqrt:  [[14.78340376  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00583935 -0.03632963  0.1803282 ]
Stock Position:  -0.005839347051705704
Bond Position:  [5.69244028]


portfolio before change:  [5.11690609]
curr_Stock_Price:  98.68325832469203
curr_Factors:  [98.68325832 -0.74345006 -0.90313588]
mat_Sqrt:  [[19.01692492  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01220971 0.08287589 0.04923306]
Stock Position:  0.012209708798677098
Bond Position:  [3.91201224]


portfolio before change:  [5.13153391]
curr_Stock_Price:  99.84125365641285
curr_Factors:  [99.84125366 -0.69688913 -0.90937412]
mat_Sqrt:  [[20.03174387  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00546245 -0.04196553 -0.30043746]
Stock Position:  -0.005462454954176167
Bond Position:  [5.67691226]


portfolio before change:  [5.13465741]
curr_Stock_Price:  99.39935609179187
curr_Factors:  [99.39935609 -0.66604656 -0.9228988 ]
mat_Sqrt:  [[20.29146337  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00393979 -0.02058745 -0.14854554]
Stock Position:  -0.003939787162160572
Bond Position:  [5.52626972]


portfolio before change:  [5.1413024]
curr_Stock_Price:  97.88806563455645
curr_Factors:  [97.88806563 -0.50976842 -0.90967528]
mat_Sqrt:  [[23.67408367  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00147787  0.04809989  0.22452612]
Stock Position:  -0.0014778734708669498
Bond Position:  [5.28596857]


portfolio before change:  [5.14239675]
curr_Stock_Price:  97.59469514093382
curr_Factors:  [97.59469514 -0.60454121 -0.94625681]
mat_Sqrt:  [[20.69775256  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00275144 0.01601891 0.05880715]
Stock Position:  0.002751443325983902
Bond Position:  [4.87387048]


portfolio before change:  [5.14285672]
curr_Stock_Price:  97.5404312024499
curr_Factors:  [97.5404312  -0.49714579 -0.95718148]
mat_Sqrt:  [[22.78129257  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00052938 -0.00258095  0.27457194]
Stock Position:  -0.0005293778832521745
Bond Position:  [5.19449247]


portfolio before change:  [5.14388869]
curr_Stock_Price:  96.81765198574318
curr_Factors:  [96.81765199 -0.26809288 -0.94690709]
mat_Sqrt:  [[28.72676775  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00144132 -0.02362503  0.13309858]
Stock Position:  0.0014413235914010655
Bond Position:  [5.00434313]


portfolio before change:  [5.14705403]
curr_Stock_Price:  98.57975308573636
curr_Factors:  [98.57975309 -0.28500334 -0.97414518]
mat_Sqrt:  [[27.9863637   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00503592 -0.01907255  0.41079398]
Stock Position:  0.005035919303949099
Bond Position:  [4.65061435]


portfolio before change:  [5.15658964]
curr_Stock_Price:  100.35782796225118
curr_Factors:  [100.35782796  -0.49260771  -0.96093913]
mat_Sqrt:  [[23.45761648  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-3.06270747e-04  3.22273058e-02  9.61500665e-01]
Stock Position:  -0.00030627074660599814
Bond Position:  [5.18732631]


portfolio before change:  [5.15719737]
curr_Stock_Price:  100.4908073894866
curr_Factors:  [100.49080739  -0.54806429  -0.95530767]
mat_Sqrt:  [[22.34704941  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0014102  -0.00690968 -0.19899025]
Stock Position:  0.001410195413827518
Bond Position:  [5.01548569]


portfolio before change:  [5.15938859]
curr_Stock_Price:  101.60004734941708
curr_Factors:  [101.60004735  -0.58198842  -0.96779667]
mat_Sqrt:  [[21.56903918  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00500502 0.00894293 0.28362213]
Stock Position:  0.005005024043887985
Bond Position:  [4.65087791]


portfolio before change:  [5.1593701]
curr_Stock_Price:  101.4801906311581
curr_Factors:  [101.48019063  -0.39463094  -0.98935731]
mat_Sqrt:  [[25.42862131  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00262138 -0.01448101  0.20319245]
Stock Position:  0.0026213815151439014
Bond Position:  [4.8933518]


portfolio before change:  [5.1586417]
curr_Stock_Price:  100.96896802883494
curr_Factors:  [100.96896803  -0.20182949  -0.99472219]
mat_Sqrt:  [[30.51631761  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00365016  0.01805954  0.04656405]
Stock Position:  -0.003650157389143658
Bond Position:  [5.52719432]


portfolio before change:  [5.1597726]
curr_Stock_Price:  100.84843454961292
curr_Factors:  [100.84843455  -0.14462717  -0.99917323]
mat_Sqrt:  [[32.13090529  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00133469  0.02328151  0.08378082]
Stock Position:  -0.0013346904363598503
Bond Position:  [5.29437405]


portfolio before change:  [5.15995977]
curr_Stock_Price:  101.20407990774247
curr_Factors:  [ 1.01204080e+02 -7.67870481e-02 -9.81933416e-01]
mat_Sqrt:  [[35.10763427  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00119142 -0.02691708 -0.22160374]
Stock Position:  0.0011914209316524738
Bond Position:  [5.03938311]


portfolio before change:  [5.15758057]
curr_Stock_Price:  98.67838810998812
curr_Factors:  [ 9.86783881e+01  6.75160747e-03 -9.89173355e-01]
mat_Sqrt:  [[36.94551316  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00175525  0.02472102 -0.22068004]
Stock Position:  0.0017552474000589065
Bond Position:  [4.98437558]


portfolio before change:  [5.15605548]
curr_Stock_Price:  97.45453030955166
curr_Factors:  [97.45453031  0.13013628 -0.9613612 ]
mat_Sqrt:  [[42.44295751  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00071433 0.04897769 0.03761782]
Stock Position:  0.0007143310300494701
Bond Position:  [5.08644068]


portfolio before change:  [5.15510889]
curr_Stock_Price:  95.23926259992051
curr_Factors:  [95.2392626   0.32089721 -0.94115772]
mat_Sqrt:  [[51.22008616  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00075624 -0.03476275 -0.15967387]
Stock Position:  0.0007562434322577215
Bond Position:  [5.08308482]


portfolio before change:  [5.15551979]
curr_Stock_Price:  94.94236411573748
curr_Factors:  [94.94236412  0.21683044 -0.94805194]
mat_Sqrt:  [[45.69772507  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00423378 -0.02640568  0.15191582]
Stock Position:  0.004233778890444751
Bond Position:  [4.75355481]


portfolio before change:  [5.17196133]
curr_Stock_Price:  98.68542878083163
curr_Factors:  [ 9.86854288e+01 -8.56829455e-02 -9.43651098e-01]
mat_Sqrt:  [[35.25485536  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00124498 -0.02510658  0.02730899]
Stock Position:  -0.0012449822131804305
Bond Position:  [5.29482293]


portfolio before change:  [5.16977244]
curr_Stock_Price:  100.97524445098705
curr_Factors:  [100.97524445  -0.18328576  -0.95911688]
mat_Sqrt:  [[32.21630664  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0060964   0.06166067  0.06738369]
Stock Position:  -0.006096396153509021
Bond Position:  [5.78535753]


portfolio before change:  [5.16826318]
curr_Stock_Price:  101.34143980155
curr_Factors:  [101.3414398   -0.26660696  -0.92577032]
mat_Sqrt:  [[30.75701577  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00208026 -0.05076163 -0.38026088]
Stock Position:  0.002080255803086823
Bond Position:  [4.95744707]


portfolio before change:  [5.16832386]
curr_Stock_Price:  101.0727038541274
curr_Factors:  [101.07270385  -0.14854716  -0.93135286]
mat_Sqrt:  [[34.32726955  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00279184 -0.04939566 -0.09201281]
Stock Position:  -0.0027918410048513257
Bond Position:  [5.45050278]


portfolio before change:  [5.17346698]
curr_Stock_Price:  99.47456012058989
curr_Factors:  [99.47456012 -0.30031973 -0.90925767]
mat_Sqrt:  [[29.67558159  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00126656  0.00627723 -0.12803539]
Stock Position:  -0.0012665587657509749
Bond Position:  [5.29945736]


portfolio before change:  [5.17362046]
curr_Stock_Price:  99.8764312362304
curr_Factors:  [99.87643124 -0.21822131 -0.92605538]
mat_Sqrt:  [[31.80606665  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00048935  0.02067642 -0.03762017]
Stock Position:  -0.0004893488271963091
Bond Position:  [5.22249488]


portfolio before change:  [5.17532468]
curr_Stock_Price:  97.7279282201002
curr_Factors:  [97.72792822 -0.10710873 -0.91953977]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [5.17532468]
Stock Price:  97.68706921974182
PL:  [5.17532468]
Settle:  Tensor("sub_384:0", shape=(), dtype=float64)
PL:  Tensor("sub_385:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  193
output_Z_Vals[:, i, :]:  [[ 1.19260232e+02 -2.92559343e+01 -2.92733494e+01]
 [ 4.54799653e-02  3.15508072e-02 -8.02284522e-02]
 [-4.09840987e-02 -1.08235555e-02  1.68602383e-02]
 [-2.49279082e-01 -1.30280338e-01 -2.67639420e-02]
 [-7.05871789e-02  6.43063733e-02 -1.02590486e-01]
 [-1.84494910e-02  2.93322822e-02  1.35894151e-01]
 [-8.77108802e-03 -3.54719547e-02  1.81029853e-01]
 [-4.14021914e-02 -1.13976775e-01 -3.92928384e-02]
 [ 8.47390533e-02 -3.07366446e-02 -1.10085620e-01]
 [-1.54884108e-01 -1.75853867e-01 -7.67990007e-02]
 [ 1.54243871e-01  9.06138234e-02  1.14429117e-01]
 [-2.33212833e-01 -1.09952712e-01  6.26753379e-02]
 [-6.77095785e-02 -4.06237694e-02  8.92597782e-03]
 [-9.62623594e-02 -1.14884369e-01  6.32126881e-02]
 [ 2.63073167e-01  3.94529822e-01  1.14352071e-01]
 [-5.09969529e-02 -4.40224164e-01 -5.28925120e-02]
 [-6.64234415e-02 -2.93077804e-02 -2.95250952e-02]
 [ 3.20381719e-02  8.92132114e-02 -8.71786513e-02]
 [-1.42234720e-02  5.15270012e-02 -6.11032789e-02]
 [-4.61089077e-02 -1.66485972e-02  1.17228971e-01]
 [ 8.73477230e-02 -1.00623295e-01  5.46337351e-02]
 [ 1.13544129e-01  1.39788470e-01  3.10929063e-01]
 [-5.14632489e-02  8.45457463e-03  2.75592594e-01]
 [-7.11768067e-02 -5.04349183e-04 -8.12565479e-02]
 [-4.90588765e-01  1.42903407e-01  8.32583997e-02]
 [-1.43032282e-01 -2.66400766e-01  1.34164857e-01]
 [ 3.88851475e-02  6.78127693e-02 -1.70312581e-02]
 [ 2.52067654e-02 -8.56664163e-02 -4.84087387e-02]
 [-1.35007256e-01 -1.94054323e-01 -6.77178463e-02]
 [ 1.23550909e-01  1.72817628e-01  6.09111557e-02]
 [ 9.31848719e-02 -1.15259473e-01  8.68046556e-02]
 [ 9.99984420e-02 -2.58735524e-02 -2.88767630e-02]
 [ 5.21327828e-01 -6.24796212e-01 -6.61944843e-01]
 [-4.36914851e-02 -7.92921455e-02  9.85991962e-03]
 [-6.10885445e-02 -2.09769443e-01  8.22061154e-03]
 [ 1.24927198e-01 -5.48771406e-02 -3.53317118e-02]
 [ 1.12214778e-02 -4.70881861e-02 -8.27700935e-02]
 [-1.29027296e-02  3.62972599e-02 -5.16219553e-02]
 [ 1.54328741e-01 -2.39537983e-01 -3.65673913e-02]
 [-5.12085840e-01  2.77058602e-01  2.91647619e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.26023247 -29.25593426 -29.27334937]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  8.31486419  -9.25153874 -83.50871763]
init_Out:  [2.49911038]
Stock Position:  8.31486419409362
Bond position:  [-828.98730903]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-6.16498894]
curr_Stock_Price:  98.97046190609994
curr_Factors:  [98.97046191 -0.74607458 -1.01867891]
mat_Sqrt:  [[16.94661236  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00176543  0.00997724 -0.22886944]
Stock Position:  0.0017654289097661872
Bond Position:  [-6.33971426]


portfolio before change:  [-6.16391437]
curr_Stock_Price:  100.02804725498125
curr_Factors:  [100.02804725  -0.40300594  -1.0006683 ]
mat_Sqrt:  [[24.57614793  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00153897 -0.00342271  0.04809757]
Stock Position:  -0.0015389710393406662
Bond Position:  [-6.0099741]


portfolio before change:  [-6.16139828]
curr_Stock_Price:  97.90495545689441
curr_Factors:  [97.90495546 -0.42520514 -0.98715449]
mat_Sqrt:  [[23.84650207  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01082364 -0.04119826 -0.07635008]
Stock Position:  -0.010823644991911388
Bond Position:  [-5.1017098]


portfolio before change:  [-6.15048846]
curr_Stock_Price:  96.8380708088445
curr_Factors:  [96.83807081 -0.43992298 -0.9962208 ]
mat_Sqrt:  [[23.03227373  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00390183  0.02033546 -0.2926621 ]
Stock Position:  -0.003901828878038744
Bond Position:  [-5.77264287]


portfolio before change:  [-6.1448474]
curr_Stock_Price:  95.2073792363187
curr_Factors:  [95.20737924 -0.43147094 -1.00919967]
mat_Sqrt:  [[22.54214883  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.0004457  0.00927568 0.38766819]
Stock Position:  0.0004457047440856383
Bond Position:  [-6.18728178]


portfolio before change:  [-6.14562555]
curr_Stock_Price:  95.19685680164591
curr_Factors:  [95.1968568  -0.69931687 -1.03517806]
mat_Sqrt:  [[16.80122832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00162283 -0.01121722  0.51642778]
Stock Position:  0.0016228333716428738
Bond Position:  [-6.30011419]


portfolio before change:  [-6.14619238]
curr_Stock_Price:  95.33287487478347
curr_Factors:  [95.33287487 -0.69935604 -1.04977286]
mat_Sqrt:  [[16.58080677  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00315821 -0.03604262 -0.11209153]
Stock Position:  -0.00315821038418756
Bond Position:  [-5.8451111]


portfolio before change:  [-6.15203844]
curr_Stock_Price:  96.95258294098302
curr_Factors:  [96.95258294 -0.88015935 -1.07588174]
mat_Sqrt:  [[13.71076008  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00448365 -0.00971978 -0.31404363]
Stock Position:  0.004483653941395099
Bond Position:  [-6.58674027]


portfolio before change:  [-6.15758584]
curr_Stock_Price:  95.89897692173865
curr_Factors:  [95.89897692 -0.82357319 -1.09345662]
mat_Sqrt:  [[14.10127909  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0124174  -0.05560988 -0.21908617]
Stock Position:  -0.012417395907060726
Bond Position:  [-4.96677028]


portfolio before change:  [-6.15969979]
curr_Stock_Price:  96.01921645048685
curr_Factors:  [96.01921645 -1.02627735 -1.10717148]
mat_Sqrt:  [[11.37137817  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01582405 0.02865461 0.32643442]
Stock Position:  0.015824049869753217
Bond Position:  [-7.67911266]


portfolio before change:  [-6.16463684]
curr_Stock_Price:  95.76788356298594
curr_Factors:  [95.76788356 -0.92334969 -1.08724535]
mat_Sqrt:  [[12.82417868  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01740917 -0.0347701   0.17879529]
Stock Position:  -0.017409165622204955
Bond Position:  [-4.49739789]


portfolio before change:  [-6.1758365]
curr_Stock_Price:  96.37890941793317
curr_Factors:  [96.37890942 -0.8353214  -1.07286326]
mat_Sqrt:  [[14.29775791  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00468161 -0.01284636  0.02546333]
Stock Position:  -0.0046816062013730845
Bond Position:  [-5.7246284]


portfolio before change:  [-6.17906042]
curr_Stock_Price:  96.91468602796995
curr_Factors:  [96.91468603 -0.94215388 -1.07931229]
mat_Sqrt:  [[12.83742706  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00672451 -0.03632963  0.1803282 ]
Stock Position:  -0.006724511441909467
Bond Position:  [-5.5273565]


portfolio before change:  [-6.17772151]
curr_Stock_Price:  96.61282433667901
curr_Factors:  [96.61282434 -0.89033534 -1.07493997]
mat_Sqrt:  [[13.5371286   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.02191025 0.12476128 0.32621463]
Stock Position:  0.021910252196683695
Bond Position:  [-8.29453286]


portfolio before change:  [-6.15924146]
curr_Stock_Price:  97.50359138875729
curr_Factors:  [97.50359139 -0.78105369 -1.09230064]
mat_Sqrt:  [[14.97728746  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00488474 -0.1392111  -0.15088761]
Stock Position:  -0.004884738373768827
Bond Position:  [-5.68296193]


portfolio before change:  [-6.15538419]
curr_Stock_Price:  96.56849855422753
curr_Factors:  [96.56849855 -0.9476339  -1.076573  ]
mat_Sqrt:  [[12.75656049  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00573877 -0.00926793 -0.08422688]
Stock Position:  -0.005738768695085227
Bond Position:  [-5.60119991]


portfolio before change:  [-6.15293809]
curr_Stock_Price:  96.0202456059966
curr_Factors:  [96.02024561 -0.86626871 -1.05549896]
mat_Sqrt:  [[14.0523746   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00117748  0.02821169 -0.24869643]
Stock Position:  0.0011774792458267567
Bond Position:  [-6.26599993]


portfolio before change:  [-6.15317514]
curr_Stock_Price:  96.48415818581222
curr_Factors:  [96.48415819 -0.99380314 -1.07785747]
mat_Sqrt:  [[12.1547279   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0020869   0.01629427 -0.17431065]
Stock Position:  -0.002086900285408823
Bond Position:  [-5.95182232]


portfolio before change:  [-6.15384296]
curr_Stock_Price:  96.44764523174344
curr_Factors:  [96.44764523 -0.71387122 -1.0599194 ]
mat_Sqrt:  [[16.36606046  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00138149 -0.00526475  0.33442162]
Stock Position:  -0.001381487577275793
Bond Position:  [-6.02060174]


portfolio before change:  [-6.15444201]
curr_Stock_Price:  96.33647552834154
curr_Factors:  [96.33647553 -0.66762158 -1.04273134]
mat_Sqrt:  [[17.41782475  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00550595 -0.03181988  0.15585484]
Stock Position:  0.00550595189180358
Bond Position:  [-6.68486601]


portfolio before change:  [-6.16110968]
curr_Stock_Price:  95.27725662950802
curr_Factors:  [95.27725663 -0.49279928 -1.0658684 ]
mat_Sqrt:  [[20.04788076  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00900951 0.044205   0.88699407]
Stock Position:  0.009009509919486848
Bond Position:  [-7.01951107]


portfolio before change:  [-6.15730135]
curr_Stock_Price:  95.79735354670242
curr_Factors:  [95.79735355 -0.55476259 -1.07484971]
mat_Sqrt:  [[18.77681289  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [2.66826424e-04 2.67357125e-03 7.86188959e-01]
Stock Position:  0.0002668264235400908
Bond Position:  [-6.18286262]


portfolio before change:  [-6.15820804]
curr_Stock_Price:  95.2959610559127
curr_Factors:  [95.29596106 -0.51288027 -1.07843302]
mat_Sqrt:  [[19.40778224  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-4.52273481e-03 -1.59489215e-04 -2.31802314e-01]
Stock Position:  -0.00452273480841183
Bond Position:  [-5.72720968]


portfolio before change:  [-6.16216443]
curr_Stock_Price:  96.01243830560927
curr_Factors:  [96.01243831 -0.58989994 -1.10123472]
mat_Sqrt:  [[17.69607891  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02655413  0.04519003  0.23751304]
Stock Position:  -0.026554129185764254
Bond Position:  [-3.61263774]


portfolio before change:  [-6.13076196]
curr_Stock_Price:  94.81284806861736
curr_Factors:  [94.81284807 -0.93173773 -1.07794204]
mat_Sqrt:  [[12.7079167   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00964158 -0.08424332  0.38273499]
Stock Position:  -0.009641582977039109
Bond Position:  [-5.21661602]


portfolio before change:  [-6.12385018]
curr_Stock_Price:  94.02834042005428
curr_Factors:  [94.02834042 -0.92761494 -1.04220192]
mat_Sqrt:  [[13.11529841  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0028333   0.02144428 -0.04858544]
Stock Position:  0.0028332999740090558
Bond Position:  [-6.39026068]


portfolio before change:  [-6.12422236]
curr_Stock_Price:  94.17892650294269
curr_Factors:  [94.1789265  -1.14467927 -1.05770699]
mat_Sqrt:  [[10.41045079  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00125965 -0.0270901  -0.13809666]
Stock Position:  0.0012596453186895383
Bond Position:  [-6.2428544]


portfolio before change:  [-6.12510958]
curr_Stock_Price:  94.09412941687548
curr_Factors:  [94.09412942 -1.47944967 -1.04902676]
mat_Sqrt:  [[ 7.50687466  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02049329 -0.06136536 -0.19318017]
Stock Position:  -0.020493290732947464
Bond Position:  [-4.19681123]


portfolio before change:  [-6.12544571]
curr_Stock_Price:  94.08493112296644
curr_Factors:  [94.08493112 -1.34240375 -1.07565805]
mat_Sqrt:  [[ 8.38241529  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01675489 0.05464973 0.17376257]
Stock Position:  0.016754893840044475
Bond Position:  [-7.70182874]


portfolio before change:  [-6.12127853]
curr_Stock_Price:  94.39110850235545
curr_Factors:  [94.3911085  -1.20856765 -1.10713186]
mat_Sqrt:  [[ 9.31613055  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01158505 -0.03644825  0.24762952]
Stock Position:  0.011585047102906561
Bond Position:  [-7.21480397]


portfolio before change:  [-6.11512272]
curr_Stock_Price:  95.00031728071104
curr_Factors:  [95.00031728 -1.45840302 -1.12168776]
mat_Sqrt:  [[ 7.19790099  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.012981   -0.00818194 -0.08237737]
Stock Position:  0.012980998950342822
Bond Position:  [-7.34832174]


portfolio before change:  [-6.11858699]
curr_Stock_Price:  94.80420952701753
curr_Factors:  [94.80420953 -1.50329997 -1.13890114]
mat_Sqrt:  [[ 6.75047386  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.05482233 -0.19757791 -1.88834439]
Stock Position:  0.05482233413738265
Bond Position:  [-11.31597505]


portfolio before change:  [-6.18186445]
curr_Stock_Price:  93.6757849668895
curr_Factors:  [93.67578497 -1.34574613 -1.12836075]
mat_Sqrt:  [[ 7.89107872  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00554121 -0.02507438  0.02812761]
Stock Position:  -0.005541213490197869
Bond Position:  [-5.66278693]


portfolio before change:  [-6.18531759]
curr_Stock_Price:  94.17120790764412
curr_Factors:  [94.17120791 -1.48597692 -1.10269329]
mat_Sqrt:  [[ 7.07412863  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00916392 -0.06633492  0.02345112]
Stock Position:  -0.009163919169397178
Bond Position:  [-5.32234025]


portfolio before change:  [-6.1909809]
curr_Stock_Price:  94.71660592621264
curr_Factors:  [94.71660593 -1.94436333 -1.14262915]
mat_Sqrt:  [[ 4.32277195  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.02690362 -0.01735368 -0.10079154]
Stock Position:  0.026903621618356594
Bond Position:  [-8.73920063]


portfolio before change:  [-6.19847543]
curr_Stock_Price:  94.47864302533371
curr_Factors:  [94.47864303 -1.80741464 -1.1535515 ]
mat_Sqrt:  [[ 4.89105328  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00140863 -0.01489059 -0.23612004]
Stock Position:  -0.0014086349405424941
Bond Position:  [-6.06538952]


portfolio before change:  [-6.19910905]
curr_Stock_Price:  94.39018435948523
curr_Factors:  [94.39018436 -1.39947291 -1.18388386]
mat_Sqrt:  [[ 7.12835375  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00315681  0.0114782  -0.14726307]
Stock Position:  -0.0031568054315129087
Bond Position:  [-5.9011376]


portfolio before change:  [-6.19861856]
curr_Stock_Price:  94.00112834187146
curr_Factors:  [94.00112834 -1.18561258 -1.1803702 ]
mat_Sqrt:  [[ 8.82266529  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01594525 -0.07574856 -0.10431659]
Stock Position:  0.01594525064008207
Bond Position:  [-7.69749012]


portfolio before change:  [-6.20600192]
curr_Stock_Price:  93.59843116307441
curr_Factors:  [93.59843116 -1.08637159 -1.16571486]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-6.20600192]
Stock Price:  94.00861052777687
PL:  [-6.20600192]
Settle:  Tensor("sub_386:0", shape=(), dtype=float64)
PL:  Tensor("sub_387:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  194
output_Z_Vals[:, i, :]:  [[ 1.19260232e+02 -2.92559343e+01 -2.92733494e+01]
 [-3.76458232e-03 -6.42085211e-02 -2.48412140e-02]
 [ 5.13336222e-02  4.26576270e-02 -2.41052514e-02]
 [ 8.57483587e-02  1.77415524e-01  3.80514378e-02]
 [ 1.32966168e-01 -1.39677905e-03 -6.40313441e-02]
 [ 6.89006481e-02  2.91119804e-02 -8.80251769e-02]
 [ 7.91588565e-02  8.07278979e-03 -8.09417702e-02]
 [-1.03659579e-01 -4.35013050e-02 -1.13582137e-01]
 [-7.42577895e-02 -6.94022604e-02  5.70383225e-02]
 [-5.68964913e-02 -1.17787230e-01 -1.29244860e-01]
 [ 5.78895543e-02  1.64885880e-01 -8.56725652e-02]
 [-1.11434155e-01  2.99331161e-02  2.85103704e-02]
 [-1.11838816e-01  4.37609866e-02 -2.27513293e-02]
 [-9.62623594e-02 -1.14884369e-01  6.32126881e-02]
 [ 2.52118533e-01  3.10135195e-01  3.26631250e-02]
 [-6.36460261e-02 -2.81248321e-01 -7.48813138e-02]
 [-6.70015797e-02 -5.01370430e-02 -4.00980924e-02]
 [-4.15779860e-02  1.40224938e-01  5.02344008e-02]
 [-2.19331035e-03  5.15812970e-02 -4.61660090e-02]
 [-5.32082739e-02 -2.07717648e-02  1.27421544e-01]
 [ 8.15263590e-03 -5.02151673e-02  1.55840804e-02]
 [ 1.16218039e-01 -6.26031400e-02  1.42113124e-01]
 [-3.87701312e-02 -3.45911321e-02  2.41233854e-01]
 [-6.75026535e-02 -5.91780204e-04 -8.23270959e-02]
 [-4.19905492e-01  1.41796190e-01  3.32077983e-02]
 [-3.95418376e-02 -1.49692770e-01  1.00941624e-01]
 [ 1.61669777e-01  4.59185388e-02 -1.01592275e-01]
 [ 4.06247612e-02 -5.53304492e-02 -1.81403832e-02]
 [-9.12584957e-02 -8.78030150e-02 -1.83081326e-01]
 [ 8.04969796e-03 -7.32207519e-03 -1.16943944e-01]
 [ 4.89332599e-02  7.67232798e-02  1.57653902e-02]
 [ 3.98861008e-02 -8.55164531e-02 -8.35411240e-02]
 [ 2.48293245e-01 -2.03104545e-01 -1.08454727e-01]
 [-4.74225429e-02 -8.29346300e-02 -4.04210661e-04]
 [-1.96603124e-01  1.25553593e-01  2.03606597e-02]
 [ 1.26085697e-01 -1.41010580e-01 -1.04438875e-01]
 [-1.30450087e-01 -2.04393787e-01 -1.12425998e-03]
 [-4.88391994e-02 -3.27576463e-02  5.09971200e-02]
 [-4.08219314e-02  8.73438496e-02 -2.28586552e-02]
 [-4.70374239e-01  2.42357014e-01  2.86958032e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.26023247 -29.25593426 -29.27334937]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  8.31486419  -9.25153874 -83.50871763]
init_Out:  [2.49911038]
Stock Position:  8.31486419409362
Bond position:  [-828.98730903]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [3.68457464]
curr_Stock_Price:  100.15503490184305
curr_Factors:  [100.1550349   -1.05537422  -1.00622637]
mat_Sqrt:  [[12.7447414   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00082333 -0.02030452 -0.07086507]
Stock Position:  -0.0008233302235729505
Bond Position:  [3.76703531]


portfolio before change:  [3.68430834]
curr_Stock_Price:  101.05044219028834
curr_Factors:  [101.05044219  -1.06371728  -1.01237557]
mat_Sqrt:  [[12.67367462  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00374908  0.01348953 -0.06876557]
Stock Position:  0.0037490763332446624
Bond Position:  [3.30546252]


portfolio before change:  [3.6803091]
curr_Stock_Price:  99.87350111084672
curr_Factors:  [99.87350111 -1.13282964 -1.00948744]
mat_Sqrt:  [[11.72340558  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00836757 0.05610371 0.10855016]
Stock Position:  0.00836757070156209
Bond Position:  [2.84461052]


portfolio before change:  [3.68011871]
curr_Stock_Price:  99.8082495244464
curr_Factors:  [99.80824952 -0.96603042 -1.02463936]
mat_Sqrt:  [[13.63419615  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00879111 -0.0004417  -0.1826636 ]
Stock Position:  0.008791113095359829
Bond Position:  [2.8026931]


portfolio before change:  [3.67638319]
curr_Stock_Price:  99.34347651631361
curr_Factors:  [99.34347652 -1.06153305 -1.02005257]
mat_Sqrt:  [[12.39133808  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.004171    0.00920602 -0.25111133]
Stock Position:  0.004170998474138183
Bond Position:  [3.2620217]


portfolio before change:  [3.6741013]
curr_Stock_Price:  98.69862634501688
curr_Factors:  [98.69862635 -0.93296732 -0.98634321]
mat_Sqrt:  [[14.47988588  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00434017  0.00255284 -0.23090434]
Stock Position:  0.004340167173273894
Bond Position:  [3.24573276]


portfolio before change:  [3.67609541]
curr_Stock_Price:  99.0645948555796
curr_Factors:  [99.06459486 -1.18950228 -0.97210475]
mat_Sqrt:  [[11.40629136  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01121904 -0.01375632 -0.32401822]
Stock Position:  -0.011219039577283613
Bond Position:  [4.78750502]


portfolio before change:  [3.6814178]
curr_Stock_Price:  98.64353254814394
curr_Factors:  [98.64353255 -1.34952936 -0.97193998]
mat_Sqrt:  [[ 9.67982025  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00665372 -0.02194692  0.16271446]
Stock Position:  -0.006653723691543168
Bond Position:  [4.33776461]


portfolio before change:  [3.6801395]
curr_Stock_Price:  98.91714654208984
curr_Factors:  [98.91714654 -1.33044925 -0.98091835]
mat_Sqrt:  [[ 9.80522098  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00880345 -0.03724759 -0.36869961]
Stock Position:  -0.008803446794017972
Bond Position:  [4.55095134]


portfolio before change:  [3.68048605]
curr_Stock_Price:  98.9424038350181
curr_Factors:  [98.94240384 -1.16062336 -0.96591702]
mat_Sqrt:  [[11.79879638  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00378505  0.05214149 -0.24439998]
Stock Position:  0.003785051361413607
Bond Position:  [3.30598397]


portfolio before change:  [3.68218153]
curr_Stock_Price:  99.28115903842804
curr_Factors:  [99.28115904 -1.15611796 -0.97317184]
mat_Sqrt:  [[11.8066863   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00887985  0.00946568  0.08133215]
Stock Position:  -0.00887985225103496
Bond Position:  [4.56378356]


portfolio before change:  [3.69116725]
curr_Stock_Price:  98.33348500100601
curr_Factors:  [98.333485   -0.91589061 -0.96043773]
mat_Sqrt:  [[15.05991024  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00765961  0.01383844 -0.06490321]
Stock Position:  -0.0076596079043851
Bond Position:  [4.44436319]


portfolio before change:  [3.69585466]
curr_Stock_Price:  97.79405334736342
curr_Factors:  [97.79405335 -0.90084805 -0.97696029]
mat_Sqrt:  [[14.95514568  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00577229 -0.03632963  0.1803282 ]
Stock Position:  -0.0057722891509512115
Bond Position:  [4.26035022]


portfolio before change:  [3.69135727]
curr_Stock_Price:  98.66545338704675
curr_Factors:  [98.66545339 -0.82954406 -0.99084322]
mat_Sqrt:  [[15.98015418  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.0166953  0.09807336 0.0931788 ]
Stock Position:  0.01669530335344127
Bond Position:  [2.04410759]


portfolio before change:  [3.68971751]
curr_Stock_Price:  98.55193127226259
curr_Factors:  [98.55193127 -0.91169196 -0.99677489]
mat_Sqrt:  [[14.61599943  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00589716 -0.08893853 -0.21361555]
Stock Position:  -0.005897161609141879
Bond Position:  [4.27089418]


portfolio before change:  [3.69250111]
curr_Stock_Price:  98.17044136142395
curr_Factors:  [98.17044136 -0.69629477 -1.0133542 ]
mat_Sqrt:  [[17.76190856  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00430591 -0.01585473 -0.1143887 ]
Stock Position:  -0.004305905595658258
Bond Position:  [4.11521377]


portfolio before change:  [3.69674843]
curr_Stock_Price:  97.30351951889928
curr_Factors:  [97.30351952 -0.84378522 -1.02197724]
mat_Sqrt:  [[15.06045909  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00183948  0.04434302  0.14330476]
Stock Position:  -0.0018394751038145053
Bond Position:  [3.87573583]


portfolio before change:  [3.6983184]
curr_Stock_Price:  96.7134202913957
curr_Factors:  [96.71342029 -0.883601   -1.00380359]
mat_Sqrt:  [[14.64864132  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00070212  0.01631144 -0.13169877]
Stock Position:  -0.0007021186403198104
Bond Position:  [3.76622269]


portfolio before change:  [3.69897489]
curr_Stock_Price:  96.44895863612506
curr_Factors:  [96.44895864 -0.93532672 -0.9697328 ]
mat_Sqrt:  [[14.35293454  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00193234 -0.00656861  0.3634982 ]
Stock Position:  -0.001932342454872221
Bond Position:  [3.88534731]


portfolio before change:  [3.69570671]
curr_Stock_Price:  98.39161734101202
curr_Factors:  [98.39161734 -0.93435278 -0.97997146]
mat_Sqrt:  [[14.50700117  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00069188 -0.01587943  0.04445704]
Stock Position:  0.0006918847543968062
Bond Position:  [3.62763105]


portfolio before change:  [3.6965692]
curr_Stock_Price:  98.98277365635127
curr_Factors:  [98.98277366 -0.9704789  -0.99171408]
mat_Sqrt:  [[13.91201499  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01032276 -0.01979685  0.40540919]
Stock Position:  0.01032275718633728
Bond Position:  [2.67479406]


portfolio before change:  [3.68745128]
curr_Stock_Price:  98.067098311051
curr_Factors:  [98.06709831 -0.86576476 -0.99558795]
mat_Sqrt:  [[15.24572605  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 6.28266820e-04 -1.09386764e-02  6.88173038e-01]
Stock Position:  0.0006282668204796865
Bond Position:  [3.62583897]


portfolio before change:  [3.68842671]
curr_Stock_Price:  98.89822645087472
curr_Factors:  [98.89822645 -1.17434308 -0.98712754]
mat_Sqrt:  [[11.38868918  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-7.40409013e-03 -1.87137332e-04 -2.34856289e-01]
Stock Position:  -0.007404090133789658
Bond Position:  [4.42067809]


portfolio before change:  [3.69345571]
curr_Stock_Price:  98.2936431318774
curr_Factors:  [98.29364313 -1.41607852 -0.97733193]
mat_Sqrt:  [[ 8.97595111  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0456181   0.04483989  0.09473261]
Stock Position:  -0.045618097985391605
Bond Position:  [8.17742476]


portfolio before change:  [3.666489]
curr_Stock_Price:  98.90719247633795
curr_Factors:  [98.90719248 -1.58628627 -0.96478232]
mat_Sqrt:  [[ 7.71459026  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00295573 -0.04733701  0.28795836]
Stock Position:  -0.0029557325543951886
Bond Position:  [3.95883221]


portfolio before change:  [3.66689326]
curr_Stock_Price:  98.93785337575778
curr_Factors:  [98.93785338 -1.50724949 -0.95115113]
mat_Sqrt:  [[ 8.46628067  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01678635  0.01452072 -0.28981448]
Stock Position:  0.016786350226513605
Bond Position:  [2.0060878]


portfolio before change:  [3.66067664]
curr_Stock_Price:  98.55257588153775
curr_Factors:  [98.55257588 -1.36219849 -0.96061516]
mat_Sqrt:  [[ 9.65790279  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00367505 -0.01749702 -0.05174946]
Stock Position:  0.0036750468210218898
Bond Position:  [3.29849131]


portfolio before change:  [3.66109239]
curr_Stock_Price:  98.55350580256186
curr_Factors:  [98.5535058  -1.29684524 -0.96613362]
mat_Sqrt:  [[10.25351678  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01276605 -0.02776575 -0.52228006]
Stock Position:  -0.012766047188458609
Bond Position:  [4.9192311]


portfolio before change:  [3.65627135]
curr_Stock_Price:  98.97932138272121
curr_Factors:  [98.97932138 -1.11921534 -0.98632338]
mat_Sqrt:  [[12.05370682  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00132826 -0.00231544 -0.33360852]
Stock Position:  -0.001328258613490356
Bond Position:  [3.78774149]


portfolio before change:  [3.65723868]
curr_Stock_Price:  98.60753139908316
curr_Factors:  [98.6075314  -0.83752279 -0.97945171]
mat_Sqrt:  [[16.02537093  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00337792 0.02426203 0.04497427]
Stock Position:  0.0033779151490785594
Bond Position:  [3.32415081]


portfolio before change:  [3.65606747]
curr_Stock_Price:  98.1377883295061
curr_Factors:  [98.13778833 -0.85643952 -0.97366737]
mat_Sqrt:  [[15.74095012  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0013103  -0.02704268 -0.23831957]
Stock Position:  0.0013102967008018795
Bond Position:  [3.52747785]


portfolio before change:  [3.65648686]
curr_Stock_Price:  98.12132306145737
curr_Factors:  [98.12132306 -0.8502335  -0.96686637]
mat_Sqrt:  [[15.94435474  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01385512 -0.0642273  -0.30939115]
Stock Position:  0.01385511567055454
Bond Position:  [2.29700458]


portfolio before change:  [3.66526387]
curr_Stock_Price:  98.7340835563019
curr_Factors:  [98.73408356 -0.88346218 -0.98102078]
mat_Sqrt:  [[15.30144481  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00324456 -0.02622623 -0.0011531 ]
Stock Position:  -0.0032445573341267886
Bond Position:  [3.98561227]


portfolio before change:  [3.66595829]
curr_Stock_Price:  98.673618533282
curr_Factors:  [98.67361853 -0.57556594 -0.96654027]
mat_Sqrt:  [[21.10925161  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00896314  0.03970353  0.05808329]
Stock Position:  -0.008963143038189502
Bond Position:  [4.55038405]


portfolio before change:  [3.66749116]
curr_Stock_Price:  98.5660624545447
curr_Factors:  [98.56606245 -0.5533464  -0.95682504]
mat_Sqrt:  [[21.77049402  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00464511 -0.04459146 -0.29793504]
Stock Position:  0.004645109283333377
Bond Position:  [3.20964103]


portfolio before change:  [3.68380656]
curr_Stock_Price:  101.99206722371221
curr_Factors:  [101.99206722  -0.43876976  -0.9820958 ]
mat_Sqrt:  [[24.63158304  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00551962 -0.06463499 -0.0032072 ]
Stock Position:  -0.005519620886678325
Bond Position:  [4.2467641]


portfolio before change:  [3.67601476]
curr_Stock_Price:  103.49990193331544
curr_Factors:  [103.49990193  -0.11158733  -0.935567  ]
mat_Sqrt:  [[36.32173541  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00108132 -0.01035888  0.14548059]
Stock Position:  -0.0010813154760291636
Bond Position:  [3.78793081]


portfolio before change:  [3.67728543]
curr_Stock_Price:  102.76269803651259
curr_Factors:  [102.76269804  -0.25116506  -0.93770231]
mat_Sqrt:  [[31.29802703  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00138132  0.02762055 -0.06520938]
Stock Position:  -0.0013813243345635056
Bond Position:  [3.81923405]


portfolio before change:  [3.67975435]
curr_Stock_Price:  101.32097474339508
curr_Factors:  [101.32097474  -0.39609789  -0.89981078]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [3.67975435]
Stock Price:  102.05614647651701
PL:  [1.62360788]
Settle:  Tensor("sub_388:0", shape=(), dtype=float64)
PL:  Tensor("sub_389:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  195
output_Z_Vals[:, i, :]:  [[ 1.19260232e+02 -2.92559343e+01 -2.92733494e+01]
 [-7.06216871e-02  1.55541772e-01  1.63214542e-02]
 [-6.17714446e-02 -1.04515441e-01 -1.10125535e-01]
 [ 4.94794040e-02  1.34854157e-01  3.14903344e-02]
 [ 1.69203735e-01 -1.32678210e-02 -6.25829822e-02]
 [ 1.08288989e-02  2.85945250e-02  9.77856796e-02]
 [ 1.70707392e-03  7.21559456e-02  1.11519112e-02]
 [ 2.06583194e-01  1.96953957e-01  1.59610333e-01]
 [ 1.96216038e-02  3.58607752e-02 -2.99998682e-02]
 [-3.54740594e-02  2.65508719e-01  1.01644882e-01]
 [ 5.67099601e-02  2.94860588e-02 -7.76421689e-02]
 [-7.17245528e-02  8.47932854e-02  2.03648229e-02]
 [-2.28853362e-03 -1.57375441e-01 -2.90907606e-02]
 [ 2.84278025e-01  2.24943906e-01  3.12354472e-01]
 [ 1.43361204e-01  7.52387350e-02 -9.33874494e-02]
 [-7.83757128e-02 -1.03637883e-01 -1.19142665e-01]
 [-7.41639667e-02 -4.50461860e-02 -4.73931268e-02]
 [-8.54844651e-02  1.03265843e-01  1.13730664e-01]
 [ 4.10524531e-02  6.03403425e-02  3.54057787e-02]
 [ 3.05597056e-01 -9.06751765e-02 -5.85200661e-02]
 [-4.20623367e-02  5.66564914e-05  1.72576925e-02]
 [ 3.25591342e-02 -2.79308983e-02  3.15784368e-02]
 [-6.45395137e-02  6.02278894e-02  2.46070137e-01]
 [ 8.87117216e-02 -1.82391975e-02 -2.22579889e-02]
 [ 9.44152305e-02  2.91228377e-02  9.64137345e-02]
 [ 6.77871152e-02 -2.93161229e-02  6.65611957e-02]
 [-1.60069425e-01  7.22481060e-02  8.03196614e-02]
 [-5.07806065e-02  7.36225950e-02  2.93687317e-02]
 [ 2.39602911e-02 -8.14007909e-02 -2.10737550e-01]
 [ 1.28296185e-02 -3.29817738e-03 -1.00802943e-01]
 [-3.52864503e-02  3.28229210e-01  1.10720396e-02]
 [ 2.70888835e-02 -1.21231176e-01 -6.75236451e-02]
 [ 4.37482193e-02 -2.93614774e-02  6.12434725e-02]
 [-3.54620827e-02 -7.47940095e-02  1.46532453e-02]
 [-1.51822167e-01  1.27623997e-01  3.48491209e-02]
 [ 8.47165236e-02 -1.65012150e-01 -1.38726811e-01]
 [-1.07267053e-01 -2.15155204e-01 -1.85323033e-03]
 [-2.37556123e-02  2.06592891e-02 -6.81779291e-02]
 [-4.80872296e-02  9.06633532e-02  5.80425938e-03]
 [-6.69121423e-01  3.36846940e-01  4.08862294e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.26023247 -29.25593426 -29.27334937]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  8.31486419  -9.25153874 -83.50871763]
init_Out:  [2.49911038]
Stock Position:  8.31486419409362
Bond position:  [-828.98730903]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [8.16535653]
curr_Stock_Price:  100.69392306379979
curr_Factors:  [100.69392306  -0.8048289   -1.02130865]
mat_Sqrt:  [[16.21518084  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00390215  0.04918663  0.04656057]
Stock Position:  -0.0039021466097765574
Bond Position:  [8.55827898]


portfolio before change:  [8.1676968]
curr_Stock_Price:  100.36835380525469
curr_Factors:  [100.36835381  -0.85533787  -1.05005151]
mat_Sqrt:  [[14.93126859  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0058233  -0.03305068 -0.3141575 ]
Stock Position:  -0.005823303085090694
Bond Position:  [8.75217214]


portfolio before change:  [8.17138165]
curr_Stock_Price:  99.92345779156568
curr_Factors:  [99.92345779 -0.77811953 -1.061725  ]
mat_Sqrt:  [[15.87205389  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00374175 0.04264463 0.08983316]
Stock Position:  0.003741750207205742
Bond Position:  [7.79749303]


portfolio before change:  [8.17389634]
curr_Stock_Price:  100.33501501033722
curr_Factors:  [100.33501501  -0.64396446  -1.05674363]
mat_Sqrt:  [[18.31657982  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00852159 -0.00419565 -0.17853183]
Stock Position:  0.008521594354427392
Bond Position:  [7.31888205]


portfolio before change:  [8.18310457]
curr_Stock_Price:  101.3082263006244
curr_Factors:  [101.3082263   -0.52038145  -1.02720422]
mat_Sqrt:  [[21.55444241  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.0014627  0.00904238 0.27895533]
Stock Position:  0.0014626972976229473
Bond Position:  [8.0349213]


portfolio before change:  [8.18460674]
curr_Stock_Price:  101.64851205894708
curr_Factors:  [101.64851206  -0.56760202  -1.02910317]
mat_Sqrt:  [[20.59020988  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00028395 0.02281771 0.0318133 ]
Stock Position:  0.0002839459527307996
Bond Position:  [8.15574405]


portfolio before change:  [8.18586017]
curr_Stock_Price:  102.47228047557577
curr_Factors:  [102.47228048  -0.54152533  -1.04617777]
mat_Sqrt:  [[20.94477522  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01166156 0.06228231 0.45532385]
Stock Position:  0.011661564468982729
Bond Position:  [6.99087307]


portfolio before change:  [8.18117635]
curr_Stock_Price:  101.99569420572035
curr_Factors:  [101.99569421  -0.48272265  -1.02073101]
mat_Sqrt:  [[22.67985151  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00063598  0.01134017 -0.08558127]
Stock Position:  0.0006359753986505108
Bond Position:  [8.11630959]


portfolio before change:  [8.18265265]
curr_Stock_Price:  102.72166298060571
curr_Factors:  [102.72166298  -0.63304681  -1.01097557]
mat_Sqrt:  [[19.84596371  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00039658  0.08396123  0.28996456]
Stock Position:  -0.000396578321986394
Bond Position:  [8.22338983]


portfolio before change:  [8.18399144]
curr_Stock_Price:  101.93794697960051
curr_Factors:  [101.93794698  -0.55360459  -1.00482234]
mat_Sqrt:  [[21.45456272  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00194004  0.00932431 -0.2214915 ]
Stock Position:  0.001940037001649156
Bond Position:  [7.98622805]


portfolio before change:  [8.18586073]
curr_Stock_Price:  102.38688352671487
curr_Factors:  [102.38688353  -0.61712139  -0.99908266]
mat_Sqrt:  [[20.33929158  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00321438  0.02681399  0.05809517]
Stock Position:  -0.0032143817420973927
Bond Position:  [8.51497126]


portfolio before change:  [8.18113244]
curr_Stock_Price:  104.1890133435207
curr_Factors:  [104.18901334  -0.63805806  -0.96684978]
mat_Sqrt:  [[20.93241355  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00058713 -0.04976648 -0.08298784]
Stock Position:  -0.0005871313712757882
Bond Position:  [8.24230508]


portfolio before change:  [8.18276289]
curr_Stock_Price:  103.16691974396167
curr_Factors:  [103.16691974  -0.66939921  -1.00200597]
mat_Sqrt:  [[19.39359914  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01824546 0.07113351 0.89106037]
Stock Position:  0.018245460186243494
Bond Position:  [6.30043497]


portfolio before change:  [8.14430291]
curr_Stock_Price:  101.01583196997352
curr_Factors:  [101.01583197  -0.52058377  -1.00523832]
mat_Sqrt:  [[21.96510734  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00574735  0.02379258 -0.2664084 ]
Stock Position:  0.005747353021864531
Bond Position:  [7.56372926]


portfolio before change:  [8.14706122]
curr_Stock_Price:  101.33124422878566
curr_Factors:  [101.33124423  -0.39915003  -0.99797788]
mat_Sqrt:  [[25.05984808  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0042048  -0.03277318 -0.33988086]
Stock Position:  -0.0042047950888147315
Bond Position:  [8.57313834]


portfolio before change:  [8.14758647]
curr_Stock_Price:  101.46120560688954
curr_Factors:  [101.46120561  -0.39789395  -1.00983399]
mat_Sqrt:  [[24.82741716  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00342368 -0.01424485 -0.1351994 ]
Stock Position:  -0.0034236801675667627
Bond Position:  [8.49495719]


portfolio before change:  [8.15662618]
curr_Stock_Price:  99.13102950913246
curr_Factors:  [99.13102951 -0.4767227  -0.97536487]
mat_Sqrt:  [[23.2047022   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00256857  0.03265553  0.32444193]
Stock Position:  -0.002568573276588361
Bond Position:  [8.4112515]


portfolio before change:  [8.15306174]
curr_Stock_Price:  100.92810445931278
curr_Factors:  [100.92810446  -0.67547257  -0.95113552]
mat_Sqrt:  [[19.84198887  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00251172 0.01908129 0.10100283]
Stock Position:  0.002511724438707743
Bond Position:  [7.89955815]


portfolio before change:  [8.1567624]
curr_Stock_Price:  102.00830304916389
curr_Factors:  [102.00830305  -0.76841009  -0.95255823]
mat_Sqrt:  [[18.24855492  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01596348 -0.02867401 -0.16694146]
Stock Position:  0.0159634817908412
Bond Position:  [6.52835472]


portfolio before change:  [8.15254367]
curr_Stock_Price:  101.69290660532671
curr_Factors:  [101.69290661  -0.8704218   -0.94367286]
mat_Sqrt:  [[16.57445894  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-2.32515356e-03  1.79163557e-05  4.92313932e-02]
Stock Position:  -0.0023251535557266764
Bond Position:  [8.3889953]


portfolio before change:  [8.15142544]
curr_Stock_Price:  102.62485553561396
curr_Factors:  [102.62485554  -0.88491494  -0.95283442]
mat_Sqrt:  [[16.33533909  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00234362 -0.00883253  0.09008449]
Stock Position:  0.002343623400722959
Bond Position:  [7.91091143]


portfolio before change:  [8.14955392]
curr_Stock_Price:  101.40433469579733
curr_Factors:  [101.4043347   -0.95853149  -0.96100328]
mat_Sqrt:  [[14.8734994   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0008576   0.01904573  0.70196961]
Stock Position:  -0.0008576044867432157
Bond Position:  [8.23651874]


portfolio before change:  [8.149522]
curr_Stock_Price:  102.64215194717515
curr_Factors:  [102.64215195  -0.93298748  -0.95713994]
mat_Sqrt:  [[15.5043599   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00539831 -0.00576774 -0.06349585]
Stock Position:  0.005398313446252613
Bond Position:  [7.59542749]


portfolio before change:  [8.14981769]
curr_Stock_Price:  102.5210409373314
curr_Factors:  [102.52104094  -0.82680154  -0.9720822 ]
mat_Sqrt:  [[16.96554147  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00676946 0.00920945 0.27504155]
Stock Position:  0.006769459744843721
Bond Position:  [7.45580563]


portfolio before change:  [8.14862176]
curr_Stock_Price:  102.20669391853387
curr_Factors:  [102.20669392  -0.69480199  -0.93478121]
mat_Sqrt:  [[20.03366238  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00402407 -0.00927057  0.18988056]
Stock Position:  0.004024073172317816
Bond Position:  [7.73733455]


portfolio before change:  [8.15443407]
curr_Stock_Price:  103.41071696549005
curr_Factors:  [103.41071697  -0.74867491  -0.91293897]
mat_Sqrt:  [[19.63070091  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00722383  0.02284686  0.22912964]
Stock Position:  -0.0072238278677095764
Bond Position:  [8.90145529]


portfolio before change:  [8.15544094]
curr_Stock_Price:  103.4253744053976
curr_Factors:  [103.42537441  -0.84964884  -0.90813495]
mat_Sqrt:  [[17.83328302  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00240476  0.02328151  0.08378082]
Stock Position:  -0.0024047625979869472
Bond Position:  [8.40415441]


portfolio before change:  [8.15707779]
curr_Stock_Price:  103.18158052030587
curr_Factors:  [103.18158052  -0.89677135  -0.90874732]
mat_Sqrt:  [[16.96193447  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00124739 -0.02574119 -0.60117557]
Stock Position:  -0.001247386645445209
Bond Position:  [8.28578511]


portfolio before change:  [8.15968885]
curr_Stock_Price:  101.91872143673046
curr_Factors:  [101.91872144  -0.75390062  -0.89746074]
mat_Sqrt:  [[19.54685285  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00040067 -0.00104298 -0.28756274]
Stock Position:  -0.00040067087636222367
Bond Position:  [8.20052471]


portfolio before change:  [8.15982671]
curr_Stock_Price:  104.1331745322299
curr_Factors:  [104.13317453  -1.00979163  -0.91114782]
mat_Sqrt:  [[15.25231279  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00160969  0.10379519  0.03158545]
Stock Position:  -0.0016096927890940512
Bond Position:  [8.32744913]


portfolio before change:  [8.16125866]
curr_Stock_Price:  103.89030185835782
curr_Factors:  [103.89030186  -0.86826225  -0.88135604]
mat_Sqrt:  [[18.06032     0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00056342 -0.03833666 -0.19262616]
Stock Position:  0.0005634175755864521
Bond Position:  [8.10272504]


portfolio before change:  [8.16204197]
curr_Stock_Price:  103.4828022927485
curr_Factors:  [103.48280229  -0.94656082  -0.85129857]
mat_Sqrt:  [[17.14224771  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00323711 -0.00928491  0.17471058]
Stock Position:  0.0032371122858326612
Bond Position:  [7.82705652]


portfolio before change:  [8.16529433]
curr_Stock_Price:  104.18525365450435
curr_Factors:  [104.18525365  -1.01345024  -0.85560381]
mat_Sqrt:  [[16.07260951  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00214042 -0.02365194  0.04180163]
Stock Position:  -0.002140422471133994
Bond Position:  [8.38829479]


portfolio before change:  [8.16883524]
curr_Stock_Price:  103.0208523638387
curr_Factors:  [103.02085236  -0.86608152  -0.85585817]
mat_Sqrt:  [[18.41179941  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00768058  0.04035825  0.09941484]
Stock Position:  -0.0076805845773826
Bond Position:  [8.96009561]


portfolio before change:  [8.18424251]
curr_Stock_Price:  101.1606829152335
curr_Factors:  [101.16068292  -0.54268667  -0.82350592]
mat_Sqrt:  [[25.80369222  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00202058 -0.05218142 -0.39574898]
Stock Position:  0.00202058046688574
Bond Position:  [7.97983921]


portfolio before change:  [8.18492621]
curr_Stock_Price:  101.00535857872805
curr_Factors:  [101.00535858  -0.85782093  -0.81503333]
mat_Sqrt:  [[18.9597689   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00597057 -0.06803805 -0.00528675]
Stock Position:  -0.005970569916161548
Bond Position:  [8.78798576]


portfolio before change:  [8.19714158]
curr_Stock_Price:  99.14342480203955
curr_Factors:  [99.1434248  -0.83488424 -0.82080844]
mat_Sqrt:  [[18.93240225  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00196166  0.00653304 -0.19449265]
Stock Position:  -0.0019616609006365194
Bond Position:  [8.39162736]


portfolio before change:  [8.19667135]
curr_Stock_Price:  99.91789778016306
curr_Factors:  [99.91789778 -0.80420509 -0.82724386]
mat_Sqrt:  [[19.54852578  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00227953  0.02867027  0.01655794]
Stock Position:  -0.0022795336552024607
Bond Position:  [8.42443756]


portfolio before change:  [8.19800169]
curr_Stock_Price:  99.79628266476394
curr_Factors:  [99.79628266 -0.99847213 -0.80071956]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [8.19800169]
Stock Price:  99.83724465409516
PL:  [8.19800169]
Settle:  Tensor("sub_390:0", shape=(), dtype=float64)
PL:  Tensor("sub_391:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  196
output_Z_Vals[:, i, :]:  [[ 1.19260232e+02 -2.92559343e+01 -2.92733494e+01]
 [-8.23433795e-02  1.94216017e-01  2.40250338e-02]
 [-4.96933381e-02 -5.06463229e-02 -3.81127386e-02]
 [ 2.25604477e-02  1.46512714e-01  2.62961761e-02]
 [ 1.84736879e-01 -1.87826355e-02 -6.02953658e-02]
 [ 7.34134163e-02  3.06815163e-02  2.27807258e-03]
 [ 5.72815447e-02  2.43348437e-02 -6.29085455e-02]
 [-1.39755975e-01  3.15669867e-02 -9.42379436e-02]
 [-3.12363443e-02 -5.18438508e-02  4.88535233e-02]
 [-5.63488214e-02  3.66724698e-01  1.60351290e-01]
 [ 5.56680768e-02  2.48953156e-02 -7.61407264e-02]
 [-3.00037787e-02  4.92607002e-02 -5.72649395e-03]
 [-8.69498732e-02 -1.94075909e-02 -5.44253249e-02]
 [ 3.68324602e-02  1.96286587e-02  1.52540952e-01]
 [ 1.91463853e-01  2.29260893e-01  1.93643864e-02]
 [-6.90966633e-02 -6.88650789e-02 -1.10367519e-01]
 [-8.05244550e-02 -1.65173286e-02 -8.15541558e-02]
 [ 3.08249956e-02 -4.38315967e-02 -3.14849578e-02]
 [ 2.71354718e-02  6.38135027e-02  2.72957952e-02]
 [ 3.03670149e-01 -1.94546016e-01 -5.51933515e-02]
 [-5.47976947e-03  1.02023794e-02  2.48079733e-02]
 [ 2.77841846e-02 -2.46331797e-02  2.69271823e-02]
 [-9.10583246e-02  1.64713097e-01  2.01509198e-01]
 [ 1.19035569e-01 -2.09453392e-02 -5.50058358e-03]
 [ 6.05323535e-02  3.29606168e-02  8.10008081e-02]
 [ 1.01669903e-01  4.01737806e-03  5.62385081e-02]
 [-1.27581799e-01  7.43865808e-02  8.76829944e-02]
 [-5.07806065e-02  7.36225950e-02  2.93687317e-02]
 [ 6.12981205e-02 -7.20543252e-02  2.10301948e-02]
 [ 4.34965600e-02  1.40614649e-02 -1.30049670e-02]
 [ 1.90668817e-03  2.09447534e-01  2.27304242e-02]
 [ 1.92856478e-02 -8.02483195e-02 -8.22503893e-02]
 [ 2.47569440e-01 -3.30809809e-01 -3.22503343e-01]
 [-4.90330762e-02 -8.48854771e-02 -7.17790946e-03]
 [-8.16331095e-02 -9.62132948e-03  3.52312667e-02]
 [ 8.47165236e-02 -1.65012150e-01 -1.38726811e-01]
 [-1.74310876e-01 -2.73797238e-01  3.82584097e-02]
 [-3.73389771e-02 -1.33526554e-02 -2.98479044e-03]
 [-4.44573052e-02  9.49676466e-02 -2.05776228e-02]
 [-2.90206470e-01  1.57996881e-01  1.74627824e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.26023247 -29.25593426 -29.27334937]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  8.31486419  -9.25153874 -83.50871763]
init_Out:  [2.49911038]
Stock Position:  8.31486419409362
Bond position:  [-828.98730903]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [8.63971613]
curr_Stock_Price:  100.75097265467376
curr_Factors:  [100.75097265  -0.89091087  -1.01837868]
mat_Sqrt:  [[14.92984611  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.004851    0.0614165   0.06853673]
Stock Position:  -0.004850998027126941
Bond Position:  [9.1284589]


portfolio before change:  [8.64381359]
curr_Stock_Price:  100.14154447783112
curr_Factors:  [100.14154448  -1.086062    -1.00694002]
mat_Sqrt:  [[12.34909282  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00475992 -0.01601577 -0.10872503]
Stock Position:  -0.004759924601814118
Bond Position:  [9.12047979]


portfolio before change:  [8.64861781]
curr_Stock_Price:  99.37176607718331
curr_Factors:  [99.37176608 -0.9759517  -1.01003801]
mat_Sqrt:  [[13.63824972  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00232516 0.04633139 0.07501567]
Stock Position:  0.0023251571711335526
Bond Position:  [8.41756283]


portfolio before change:  [8.65185972]
curr_Stock_Price:  100.31348834594813
curr_Factors:  [100.31348835  -0.86089778  -1.02394346]
mat_Sqrt:  [[15.23292076  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01128767 -0.00593959 -0.1720059 ]
Stock Position:  0.011287669379289135
Bond Position:  [7.51955423]


portfolio before change:  [8.65415536]
curr_Stock_Price:  100.43358704416286
curr_Factors:  [100.43358704  -0.9853186   -1.03099521]
mat_Sqrt:  [[13.3722661   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00558399 0.00970235 0.00649871]
Stock Position:  0.005583991429487856
Bond Position:  [8.09333507]


portfolio before change:  [8.65388687]
curr_Stock_Price:  100.20432089712911
curr_Factors:  [100.2043209   -0.81071747  -1.03343814]
mat_Sqrt:  [[15.84819633  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00284378  0.00769535 -0.17946057]
Stock Position:  0.0028437756329658787
Bond Position:  [8.36892826]


portfolio before change:  [8.65406195]
curr_Stock_Price:  99.89800313216566
curr_Factors:  [99.89800313 -0.88450025 -1.04590451]
mat_Sqrt:  [[14.4941473   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01091317  0.00998236 -0.26883462]
Stock Position:  -0.010913174498608312
Bond Position:  [9.74426629]


portfolio before change:  [8.65428444]
curr_Stock_Price:  99.98923447584397
curr_Factors:  [99.98923448 -0.91727404 -1.04095074]
mat_Sqrt:  [[14.10935065  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00160197 -0.01639447  0.1393655 ]
Stock Position:  -0.001601970467684765
Bond Position:  [8.81446424]


portfolio before change:  [8.653276]
curr_Stock_Price:  101.3065562636797
curr_Factors:  [101.30655626  -0.90293853  -1.04805496]
mat_Sqrt:  [[14.39898396  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0009826   0.11596853  0.4574376 ]
Stock Position:  -0.0009826013029229403
Bond Position:  [8.75281996]


portfolio before change:  [8.65391962]
curr_Stock_Price:  101.76508806263595
curr_Factors:  [101.76508806  -1.00075312  -1.0670008 ]
mat_Sqrt:  [[12.87018212  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00316769  0.00787259 -0.2172083 ]
Stock Position:  0.0031676871368007064
Bond Position:  [8.33155966]


portfolio before change:  [8.65181205]
curr_Stock_Price:  100.77096037863511
curr_Factors:  [100.77096038  -0.93157502  -1.05079728]
mat_Sqrt:  [[13.88040202  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00215417  0.0155776  -0.01633609]
Stock Position:  -0.002154173096875674
Bond Position:  [8.86889014]


portfolio before change:  [8.65347157]
curr_Stock_Price:  100.5152492208993
curr_Factors:  [100.51524922  -0.67209247  -1.03268217]
mat_Sqrt:  [[18.2750147   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00539318 -0.00613722 -0.1552603 ]
Stock Position:  -0.00539318296351515
Bond Position:  [9.1955687]


portfolio before change:  [8.65083904]
curr_Stock_Price:  101.21651376426568
curr_Factors:  [101.21651376  -0.81332127  -1.0000719 ]
mat_Sqrt:  [[16.50839026  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00414799 0.00620713 0.43515688]
Stock Position:  0.004147985385795833
Bond Position:  [8.23099442]


portfolio before change:  [8.65297228]
curr_Stock_Price:  101.48273890257043
curr_Factors:  [101.4827389   -0.98424081  -1.01024795]
mat_Sqrt:  [[13.81009659  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.0145789  0.07249866 0.0552412 ]
Stock Position:  0.01457890474051571
Bond Position:  [7.1734651]


portfolio before change:  [8.66030833]
curr_Stock_Price:  101.92442577913309
curr_Factors:  [101.92442578  -1.3429072   -1.05015533]
mat_Sqrt:  [[ 9.31074482  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01003179 -0.02177705 -0.31484781]
Stock Position:  -0.010031789002245514
Bond Position:  [9.68279266]


portfolio before change:  [8.65644656]
curr_Stock_Price:  102.430038288807
curr_Factors:  [102.43003829  -1.39432536  -1.01415172]
mat_Sqrt:  [[ 9.21380525  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01059259 -0.00522324 -0.23265131]
Stock Position:  -0.010592594516980547
Bond Position:  [9.74144642]


portfolio before change:  [8.64902682]
curr_Stock_Price:  103.24546578455472
curr_Factors:  [103.24546578  -1.53879891  -0.99207284]
mat_Sqrt:  [[ 8.21726608  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00283141 -0.01386077 -0.08981782]
Stock Position:  0.0028314074626101145
Bond Position:  [8.35669684]


portfolio before change:  [8.653536]
curr_Stock_Price:  104.46907310253427
curr_Factors:  [104.4690731   -1.41951355  -1.00217007]
mat_Sqrt:  [[ 9.27393203  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00370445 0.0201796  0.07786731]
Stock Position:  0.003704454610121857
Bond Position:  [8.26653506]


portfolio before change:  [8.6540246]
curr_Stock_Price:  104.32201175511364
curr_Factors:  [104.32201176  -1.58783718  -0.98700217]
mat_Sqrt:  [[ 7.9457964   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.03616764 -0.06152085 -0.15745127]
Stock Position:  0.03616763913216785
Bond Position:  [4.88094373]


portfolio before change:  [8.63235168]
curr_Stock_Price:  103.70590630849232
curr_Factors:  [103.70590631  -1.67466074  -0.98667001]
mat_Sqrt:  [[ 7.24439686  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-2.10423075e-05  3.22627564e-03  7.07702426e-02]
Stock Position:  -2.1042307541677698e-05
Bond Position:  [8.63453389]


portfolio before change:  [8.63343742]
curr_Stock_Price:  103.40392586209518
curr_Factors:  [103.40392586  -1.52437568  -0.99256681]
mat_Sqrt:  [[ 8.34531608  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00391173 -0.0077897   0.07681576]
Stock Position:  0.003911732803701328
Bond Position:  [8.22894889]


portfolio before change:  [8.63561221]
curr_Stock_Price:  103.69691739425294
curr_Factors:  [103.69691739  -1.14823787  -1.00113472]
mat_Sqrt:  [[12.086629    0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00377877  0.05208685  0.57484965]
Stock Position:  -0.0037787672545209795
Bond Position:  [9.02745872]


portfolio before change:  [8.63850677]
curr_Stock_Price:  103.22955328867634
curr_Factors:  [103.22955329  -0.98301493  -0.99255786]
mat_Sqrt:  [[14.31606585  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00819862 -0.0066235  -0.01569163]
Stock Position:  0.008198618367549954
Bond Position:  [7.79216706]


portfolio before change:  [8.64150316]
curr_Stock_Price:  103.47621797618405
curr_Factors:  [103.47621798  -0.84119077  -0.97781289]
mat_Sqrt:  [[16.78252476  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00464278 0.01042306 0.23107276]
Stock Position:  0.004642782585906298
Bond Position:  [8.16108558]


portfolio before change:  [8.64683959]
curr_Stock_Price:  104.40588227661141
curr_Factors:  [104.40588228  -0.9733532   -0.98519787]
mat_Sqrt:  [[14.72777189  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00768978 0.00127041 0.16043281]
Stock Position:  0.0076897761314624145
Bond Position:  [7.84398173]


portfolio before change:  [8.65166043]
curr_Stock_Price:  104.90528320928098
curr_Factors:  [104.90528321  -1.05461469  -1.00380134]
mat_Sqrt:  [[13.39179023  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00804694  0.0235231   0.25013518]
Stock Position:  -0.00804693976189461
Bond Position:  [9.49582692]


portfolio before change:  [8.65154262]
curr_Stock_Price:  105.06743891012864
curr_Factors:  [105.06743891  -1.07703578  -1.01710405]
mat_Sqrt:  [[12.94180267  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00331367  0.02328151  0.08378082]
Stock Position:  -0.0033136660400096083
Bond Position:  [8.99970103]


portfolio before change:  [8.65483418]
curr_Stock_Price:  104.41362353689394
curr_Factors:  [104.41362354  -1.1554771   -1.01035541]
mat_Sqrt:  [[11.97148593  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00532352 -0.02278558  0.05999329]
Stock Position:  0.005323520966032453
Bond Position:  [8.09898607]


portfolio before change:  [8.64755913]
curr_Stock_Price:  102.85685518788642
curr_Factors:  [102.85685519  -1.27960632  -1.01587461]
mat_Sqrt:  [[10.35901686  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00397769  0.00444663 -0.03709955]
Stock Position:  0.003977693854617754
Bond Position:  [8.23842605]


portfolio before change:  [8.64949179]
curr_Stock_Price:  103.0838199347415
curr_Factors:  [103.08381993  -1.278174    -1.02070518]
mat_Sqrt:  [[10.34665478  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00115539 0.06623313 0.06484357]
Stock Position:  0.0011553906932400446
Bond Position:  [8.53038971]


portfolio before change:  [8.65034837]
curr_Stock_Price:  102.90224685539215
curr_Factors:  [102.90224686  -1.49434594  -1.00853008]
mat_Sqrt:  [[ 8.4224727   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 5.03836275e-05 -2.53767468e-02 -2.34637467e-01]
Stock Position:  5.038362750090727e-05
Bond Position:  [8.64516378]


portfolio before change:  [8.65140939]
curr_Stock_Price:  102.5113756508263
curr_Factors:  [102.51137565  -1.58058997  -0.97282847]
mat_Sqrt:  [[ 7.97694363  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.02171223 -0.10461125 -0.92001227]
Stock Position:  0.021712231694893513
Bond Position:  [6.42565865]


portfolio before change:  [8.64573711]
curr_Stock_Price:  102.2131319686219
curr_Factors:  [102.21313197  -1.626657    -0.98413011]
mat_Sqrt:  [[ 7.51028231  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00701571 -0.02684314 -0.02047658]
Stock Position:  -0.007015714227058856
Bond Position:  [9.36283524]


portfolio before change:  [8.64674713]
curr_Stock_Price:  102.2359967458165
curr_Factors:  [102.23599675  -1.53779032  -1.00422466]
mat_Sqrt:  [[ 8.04675464  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.009282   -0.00304253  0.100505  ]
Stock Position:  -0.009282000297987857
Bond Position:  [9.59570168]


portfolio before change:  [8.64716325]
curr_Stock_Price:  102.32039871407942
curr_Factors:  [102.32039871  -1.20664063  -0.98909367]
mat_Sqrt:  [[11.38588863  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00457922 -0.05218142 -0.39574898]
Stock Position:  0.004579215394081044
Bond Position:  [8.1786161]


portfolio before change:  [8.64903779]
curr_Stock_Price:  102.50648953283482
curr_Factors:  [102.50648953  -1.10901756  -1.00954482]
mat_Sqrt:  [[12.32172216  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01408657 -0.08658229  0.10914059]
Stock Position:  -0.014086571873432895
Bond Position:  [10.09300282]


portfolio before change:  [8.65937267]
curr_Stock_Price:  101.86238799872606
curr_Factors:  [101.862388    -0.74258269  -1.02772963]
mat_Sqrt:  [[17.34510691  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00220771 -0.00422248 -0.00851478]
Stock Position:  -0.0022077124760194523
Bond Position:  [8.88425554]


portfolio before change:  [8.65930152]
curr_Stock_Price:  102.39767309842371
curr_Factors:  [102.3976731   -0.99107637  -1.01270383]
mat_Sqrt:  [[13.80573089  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00334684  0.03003141 -0.05870223]
Stock Position:  -0.0033468449518316117
Bond Position:  [9.00201066]


portfolio before change:  [8.66180325]
curr_Stock_Price:  101.98641740639765
curr_Factors:  [101.98641741  -0.68199683  -1.02882029]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [8.66180325]
Stock Price:  100.90080179847892
PL:  [7.76100145]
Settle:  Tensor("sub_392:0", shape=(), dtype=float64)
PL:  Tensor("sub_393:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  197
output_Z_Vals[:, i, :]:  [[ 1.19260232e+02 -2.92559343e+01 -2.92733494e+01]
 [-8.48522874e-02  2.02493842e-01  2.56739060e-02]
 [-5.37004743e-02 -6.72220608e-02 -5.14674979e-02]
 [ 8.37859095e-02  1.59570916e-01  3.78130353e-02]
 [ 1.73681283e-01 -1.52926439e-02 -6.02223208e-02]
 [ 7.23456850e-02  3.22333490e-02 -1.65763975e-03]
 [ 1.28566084e-02  6.27428921e-02 -3.36905905e-02]
 [-1.02945496e-01  2.26638929e-01  2.01614595e-02]
 [-7.15021079e-02 -4.41038350e-02  5.84316315e-02]
 [-5.95997290e-02  2.10240806e-01  6.81678647e-02]
 [ 5.51656066e-02  1.26435591e-01 -8.04612082e-02]
 [-4.32185995e-02  6.59784805e-02 -2.08298550e-04]
 [-1.05268475e-01  3.60169765e-02 -5.01576103e-02]
 [ 1.80738565e-02  7.22583346e-02  1.63124420e-01]
 [ 2.92814311e-01  4.23034512e-01  1.08124485e-01]
 [-7.16084065e-02 -6.94699170e-02 -1.08172804e-01]
 [-7.36801162e-02 -5.06069924e-02 -6.12911628e-02]
 [-6.27884106e-02  6.72161707e-02  8.32043512e-02]
 [ 3.57528095e-02  7.24004727e-02  4.75556949e-02]
 [ 3.23099283e-01 -7.98844769e-02 -5.24262085e-02]
 [-4.70165778e-02  1.22951907e-02 -2.12001056e-02]
 [ 2.81164613e-02 -2.48626596e-02  2.72508514e-02]
 [-6.07089215e-02  5.67556957e-02  1.52516703e-01]
 [ 4.41667163e-02 -1.23660778e-02 -3.84564855e-02]
 [ 9.25306577e-02  2.91191760e-02  9.59199801e-02]
 [ 7.06804038e-02 -2.61396043e-02  6.56421855e-02]
 [-1.69590654e-01  7.23061846e-02  7.63018335e-02]
 [-5.07806065e-02  7.36225950e-02  2.93687317e-02]
 [ 6.09210003e-02 -7.66951113e-02 -1.24275620e-02]
 [ 2.00102538e-02  9.08014712e-05 -8.15044126e-02]
 [-1.23585622e-02  2.37743913e-01  2.36100569e-02]
 [ 1.64860191e-02 -8.52519247e-02 -8.31737190e-02]
 [ 1.68287487e-01 -8.96023305e-02  3.36859025e-02]
 [-5.29758550e-02 -8.83561094e-02 -1.56813580e-02]
 [-1.64094587e-01  1.20638159e-01  3.02920972e-02]
 [ 8.63812373e-02 -1.64308353e-01 -1.37875753e-01]
 [-4.49082566e-02 -1.57931837e-01 -4.16087502e-02]
 [-2.56765898e-02  2.38962124e-02 -5.99978221e-02]
 [ 1.46071138e-02 -3.62321668e-02  6.04866512e-04]
 [-7.08547627e-01  3.54303379e-01  4.34854469e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.26023247 -29.25593426 -29.27334937]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  8.31486419  -9.25153874 -83.50871763]
init_Out:  [2.49911038]
Stock Position:  8.31486419409362
Bond position:  [-828.98730903]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [8.59145374]
curr_Stock_Price:  100.74516830443305
curr_Factors:  [100.7451683   -1.10677532  -1.02342883]
mat_Sqrt:  [[11.96983929  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00621422  0.06403418  0.07324051]
Stock Position:  -0.006214223349864899
Bond Position:  [9.21750672]


portfolio before change:  [8.59326373]
curr_Stock_Price:  100.63932655385227
curr_Factors:  [100.63932655  -1.01118433  -0.99196001]
mat_Sqrt:  [[13.57729303  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00485678 -0.02125748 -0.14682245]
Stock Position:  -0.004856778099911969
Bond Position:  [9.08204661]


portfolio before change:  [8.59603909]
curr_Stock_Price:  100.30164723540074
curr_Factors:  [100.30164724  -0.95738347  -0.99088394]
mat_Sqrt:  [[14.29506982  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00668934 0.05046075 0.10787006]
Stock Position:  0.0066893388807142285
Bond Position:  [7.92508738]


portfolio before change:  [8.59545025]
curr_Stock_Price:  100.06552033572247
curr_Factors:  [100.06552034  -1.07901778  -0.99153214]
mat_Sqrt:  [[12.61990397  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01275712 -0.00483596 -0.17179752]
Stock Position:  0.012757117620822203
Bond Position:  [7.31890264]


portfolio before change:  [8.60757387]
curr_Stock_Price:  100.94414342250116
curr_Factors:  [100.94414342  -1.1517186   -0.98468189]
mat_Sqrt:  [[11.91939418  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00611101  0.01019308 -0.00472878]
Stock Position:  0.006111013791635158
Bond Position:  [7.99070282]


portfolio before change:  [8.61367132]
curr_Stock_Price:  101.77846525642337
curr_Factors:  [101.77846526  -0.93608602  -0.97921601]
mat_Sqrt:  [[14.99169705  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00050692  0.01984104 -0.09610988]
Stock Position:  0.0005069179255702135
Bond Position:  [8.562078]


portfolio before change:  [8.61438553]
curr_Stock_Price:  101.07595311154999
curr_Factors:  [101.07595311  -1.1368387   -0.95421179]
mat_Sqrt:  [[12.4886691   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00744501  0.07166952  0.05751503]
Stock Position:  -0.007445009765540334
Bond Position:  [9.36689699]


portfolio before change:  [8.61794769]
curr_Stock_Price:  100.75476888932623
curr_Factors:  [100.75476889  -1.17375464  -0.94453422]
mat_Sqrt:  [[12.11447088  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00501166 -0.01394686  0.16668918]
Stock Position:  -0.005011655714006916
Bond Position:  [9.1228959]


portfolio before change:  [8.61838512]
curr_Stock_Price:  100.89504164117548
curr_Factors:  [100.89504164  -1.29830911  -0.98440374]
mat_Sqrt:  [[10.29201075  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00391144  0.06648398  0.19446394]
Stock Position:  -0.003911444377140727
Bond Position:  [9.01303047]


portfolio before change:  [8.62236194]
curr_Stock_Price:  100.16638083017378
curr_Factors:  [100.16638083  -1.37584265  -0.98083034]
mat_Sqrt:  [[ 9.48925047  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0044267   0.03998244 -0.22953343]
Stock Position:  0.004426702014130931
Bond Position:  [8.17895522]


portfolio before change:  [8.62352223]
curr_Stock_Price:  100.19752380456184
curr_Factors:  [100.1975238   -1.3465512   -0.98084885]
mat_Sqrt:  [[ 9.77417234  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00425177  0.02086423 -0.00059422]
Stock Position:  -0.0042517729138802215
Bond Position:  [9.04953935]


portfolio before change:  [8.62170111]
curr_Stock_Price:  100.8919135496001
curr_Factors:  [100.89191355  -1.5853394   -0.98873544]
mat_Sqrt:  [[ 7.69041652  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01489866  0.01138957 -0.1430857 ]
Stock Position:  -0.014898659874067823
Bond Position:  [10.12485541]


portfolio before change:  [8.61952909]
curr_Stock_Price:  101.12265274076692
curr_Factors:  [101.12265274  -1.63833302  -1.01766414]
mat_Sqrt:  [[ 7.10171997  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00749638 0.02285009 0.46534857]
Stock Position:  0.007496379999751113
Bond Position:  [7.86147526]


portfolio before change:  [8.6222226]
curr_Stock_Price:  101.3508640947846
curr_Factors:  [101.35086409  -1.52220054  -1.00223568]
mat_Sqrt:  [[ 8.118555    0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.04013126 0.13377526 0.30844906]
Stock Position:  0.04013125897625827
Bond Position:  [4.55488482]


portfolio before change:  [8.62727198]
curr_Stock_Price:  101.46249744452349
curr_Factors:  [101.46249744  -1.28047799  -1.02326857]
mat_Sqrt:  [[10.13447203  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00942159 -0.02196832 -0.3085869 ]
Stock Position:  -0.009421585355770385
Bond Position:  [9.58320956]


portfolio before change:  [8.63402704]
curr_Stock_Price:  100.87267292325697
curr_Factors:  [100.87267292  -1.06880886  -1.04781071]
mat_Sqrt:  [[12.14891029  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00720211 -0.01600334 -0.17484663]
Stock Position:  -0.007202110087582584
Bond Position:  [9.36052313]


portfolio before change:  [8.6324699]
curr_Stock_Price:  101.25134972173845
curr_Factors:  [101.25134972  -1.24963893  -1.05668486]
mat_Sqrt:  [[10.08735077  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00436873  0.02125562  0.23735885]
Stock Position:  -0.00436872678125633
Bond Position:  [9.07480939]


portfolio before change:  [8.63063788]
curr_Stock_Price:  101.93036719871465
curr_Factors:  [101.9303672   -1.24258279  -1.04047397]
mat_Sqrt:  [[10.39404603  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00455352 0.02289504 0.13566316]
Stock Position:  0.004553515263303493
Bond Position:  [8.1664964]


portfolio before change:  [8.63260157]
curr_Stock_Price:  102.1374185957323
curr_Factors:  [102.1374186   -1.40765429  -1.03748687]
mat_Sqrt:  [[ 8.8567332   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.03503947 -0.02526169 -0.14955738]
Stock Position:  0.035039468068526064
Bond Position:  [5.05376075]


portfolio before change:  [8.65552532]
curr_Stock_Price:  102.77361519641191
curr_Factors:  [102.7736152   -1.49717455  -1.01550951]
mat_Sqrt:  [[ 8.32984291  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00612575  0.00388808 -0.060478  ]
Stock Position:  -0.006125754268775412
Bond Position:  [9.28509123]


portfolio before change:  [8.65320692]
curr_Stock_Price:  103.34156389982094
curr_Factors:  [103.3415639   -1.39262134  -1.04215884]
mat_Sqrt:  [[ 9.05447825  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0036487  -0.00786226  0.07773909]
Stock Position:  0.00364869913280666
Bond Position:  [8.27614464]


portfolio before change:  [8.65168457]
curr_Stock_Price:  102.64078671958902
curr_Factors:  [102.64078672  -1.32630709  -1.05162335]
mat_Sqrt:  [[ 9.51914417  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00295312  0.01794773  0.4350877 ]
Stock Position:  -0.002953117809338028
Bond Position:  [8.95479491]


portfolio before change:  [8.65411439]
curr_Stock_Price:  102.19705362109914
curr_Factors:  [102.19705362  -1.18592024  -1.07698546]
mat_Sqrt:  [[10.6333698   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00338534 -0.0039105  -0.10970565]
Stock Position:  0.0033853358747263943
Bond Position:  [8.30814304]


portfolio before change:  [8.65772317]
curr_Stock_Price:  102.95627004802799
curr_Factors:  [102.95627005  -1.32505755  -1.07130898]
mat_Sqrt:  [[ 9.37398044  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01203993 0.00920829 0.273633  ]
Stock Position:  0.012039932901565223
Bond Position:  [7.41813659]


portfolio before change:  [8.65241958]
curr_Stock_Price:  102.4387492941992
curr_Factors:  [102.43874929  -1.13618516  -1.04288535]
mat_Sqrt:  [[11.59060132  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00719589 -0.00826607  0.18725888]
Stock Position:  0.007195885258026309
Bond Position:  [7.9152821]


portfolio before change:  [8.65630839]
curr_Stock_Price:  102.841664182132
curr_Factors:  [102.84166418  -1.01571772  -1.07033801]
mat_Sqrt:  [[12.77046178  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01191411  0.02286522  0.21766789]
Stock Position:  -0.011914108663700664
Bond Position:  [9.88157515]


portfolio before change:  [8.66231962]
curr_Stock_Price:  102.44079855850818
curr_Factors:  [102.44079856  -0.87656944  -1.06141101]
mat_Sqrt:  [[14.75090751  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00290727  0.02328151  0.08378082]
Stock Position:  -0.00290726600925308
Bond Position:  [8.96014227]


portfolio before change:  [8.6649747]
curr_Stock_Price:  101.91281142124046
curr_Factors:  [101.91281142  -0.72008404  -1.07577796]
mat_Sqrt:  [[16.91592797  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00333437 -0.02425312 -0.03545238]
Stock Position:  0.003334370755796469
Bond Position:  [8.3251596]


portfolio before change:  [8.66556958]
curr_Stock_Price:  101.77910322842372
curr_Factors:  [101.77910323  -0.82219853  -1.09992847]
mat_Sqrt:  [[14.88982069  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 2.26703851e-04  2.87139464e-05 -2.32509403e-01]
Stock Position:  0.00022670385131632364
Bond Position:  [8.64249587]


portfolio before change:  [8.66658934]
curr_Stock_Price:  101.51171438227955
curr_Factors:  [101.51171438  -0.55888918  -1.10815796]
mat_Sqrt:  [[19.16579277  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-7.30811472e-05  7.51812264e-02  6.73529206e-02]
Stock Position:  -7.308114717604175e-05
Bond Position:  [8.67400793]


portfolio before change:  [8.66762801]
curr_Stock_Price:  102.13640253721981
curr_Factors:  [102.13640254  -0.94538758  -1.09114051]
mat_Sqrt:  [[13.32685412  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-2.02068727e-04 -2.69590257e-02 -2.37271469e-01]
Stock Position:  -0.00020206872721470796
Bond Position:  [8.68826658]


portfolio before change:  [8.66886093]
curr_Stock_Price:  101.40980291868804
curr_Factors:  [101.40980292  -0.73532543  -1.09793939]
mat_Sqrt:  [[16.21448433  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01066023 -0.02833474  0.0960965 ]
Stock Position:  0.010660226219763121
Bond Position:  [7.58780949]


portfolio before change:  [8.67164461]
curr_Stock_Price:  101.58195176589258
curr_Factors:  [101.58195177  -1.09736347  -1.10534136]
mat_Sqrt:  [[11.22519772  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00520776 -0.02794066 -0.04473455]
Stock Position:  -0.005207760718320773
Bond Position:  [9.20065911]


portfolio before change:  [8.67385349]
curr_Stock_Price:  101.37865410334378
curr_Factors:  [101.3786541   -0.84380412  -1.09076778]
mat_Sqrt:  [[14.64780736  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01056789  0.03814914  0.08641492]
Stock Position:  -0.010567887120611547
Bond Position:  [9.74521167]


portfolio before change:  [8.68862107]
curr_Stock_Price:  100.09652946603538
curr_Factors:  [100.09652947  -0.92451012  -1.10343728]
mat_Sqrt:  [[13.17324154  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00409884 -0.05195886 -0.39332114]
Stock Position:  0.004098842612811106
Bond Position:  [8.27834115]


portfolio before change:  [8.68595548]
curr_Stock_Price:  99.19372720206262
curr_Factors:  [99.1937272  -0.75388105 -1.09457177]
mat_Sqrt:  [[15.62109061  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0036796  -0.04994243 -0.11869818]
Stock Position:  -0.0036796015754616868
Bond Position:  [9.05094888]


portfolio before change:  [8.68853678]
curr_Stock_Price:  98.79969978700153
curr_Factors:  [98.79969979 -0.6962524  -1.09205228]
mat_Sqrt:  [[16.52360372  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00225778  0.00755665 -0.17115709]
Stock Position:  -0.00225777602989045
Bond Position:  [8.91160438]


portfolio before change:  [8.69122725]
curr_Stock_Price:  98.10147145757429
curr_Factors:  [98.10147146 -0.61412929 -1.11017001]
mat_Sqrt:  [[17.49129036  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00078868 -0.01145762  0.00172552]
Stock Position:  0.0007886823026344567
Bond Position:  [8.61385635]


portfolio before change:  [8.69309922]
curr_Stock_Price:  99.10970313565558
curr_Factors:  [99.10970314 -0.67362571 -1.12158112]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [8.69309922]
Stock Price:  99.46723714192963
PL:  [8.69309922]
Settle:  Tensor("sub_394:0", shape=(), dtype=float64)
PL:  Tensor("sub_395:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  198
output_Z_Vals[:, i, :]:  [[ 1.19260232e+02 -2.92559343e+01 -2.92733494e+01]
 [ 4.88187003e-02  1.66078437e-03 -9.58130076e-02]
 [-3.10881279e-02  4.98441280e-02  1.12979921e-01]
 [-5.57217528e-02  1.04553504e-01  1.17603928e-02]
 [ 2.24748682e-01 -2.27679578e-02 -4.43530995e-02]
 [ 5.14720406e-02  3.00208100e-02  3.59581262e-02]
 [ 6.07133158e-02  2.15546563e-02 -6.75057594e-02]
 [-8.62094906e-02  1.98291701e-02 -9.04855293e-02]
 [ 9.31828550e-02 -3.50421960e-02 -1.02868035e-01]
 [-8.51690013e-02  3.10088767e-01  1.39110355e-01]
 [ 5.60889317e-02  1.75543766e-01 -8.39816569e-02]
 [-1.47926796e-01 -5.26176179e-02  3.66924786e-02]
 [-1.10883861e-01  4.45253739e-02 -4.44854051e-02]
 [-1.32501186e-01 -7.71145416e-02  5.65513049e-02]
 [ 3.04258933e-01  4.15573303e-01  8.47821713e-02]
 [-6.48678725e-02 -3.37842581e-02 -9.63887282e-02]
 [-7.73984676e-02 -3.53707723e-02 -5.67660427e-02]
 [-4.47516525e-02  5.34798984e-03  4.81159167e-02]
 [ 5.32979459e-02  7.04379220e-02  6.58133698e-02]
 [ 3.18805320e-01 -9.48932868e-02 -6.04005303e-02]
 [-4.29727602e-02 -1.31136221e-03 -1.11877010e-02]
 [ 9.13973682e-02 -6.36563432e-02  8.85184032e-02]
 [-5.91526115e-02  3.97815685e-02  2.50522075e-01]
 [-5.16797763e-02 -2.27651581e-03 -8.40446413e-02]
 [-2.05236521e-01  9.40533701e-02  5.42813975e-02]
 [ 1.06242475e-02 -9.30763485e-02  8.48320350e-02]
 [-1.41891765e-01  6.40238736e-02  3.30682142e-02]
 [-5.07806065e-02  7.36225950e-02  2.93687317e-02]
 [-7.16191958e-02 -6.64409555e-02 -2.12002750e-01]
 [ 3.38202814e-02  7.89949917e-03 -4.19832701e-02]
 [-2.27383064e-02  2.89462416e-01  1.30688878e-02]
 [ 3.99429646e-02 -1.05770779e-01 -3.33537727e-02]
 [-2.41836135e-02  4.96725005e-03  7.86997080e-02]
 [-6.44266552e-02 -5.14181534e-02  3.71250287e-02]
 [-1.14715512e-01  1.69489860e-02  3.65864806e-02]
 [ 8.47165236e-02 -1.65012150e-01 -1.38726811e-01]
 [-1.85665639e-01 -3.10612711e-01  4.15054762e-02]
 [-4.33634676e-02 -2.35181272e-02  2.52940986e-02]
 [-3.62812944e-02  7.78216113e-02 -2.57076993e-02]
 [-3.22137303e-02  3.58579430e-02  1.56567073e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.26023247 -29.25593426 -29.27334937]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  8.31486419  -9.25153874 -83.50871763]
init_Out:  [2.49911038]
Stock Position:  8.31486419409362
Bond position:  [-828.98730903]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-4.670632]
curr_Stock_Price:  99.15018305517454
curr_Factors:  [99.15018306 -0.9089617  -1.025573  ]
mat_Sqrt:  [[14.32635719  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00204545  0.00052519 -0.27332784]
Stock Position:  0.0020454490231050686
Bond Position:  [-4.87343864]


portfolio before change:  [-4.67049444]
curr_Stock_Price:  99.51527443728034
curr_Factors:  [99.51527444 -0.95742619 -1.00546719]
mat_Sqrt:  [[13.97706481  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00048216  0.0157621   0.32230027]
Stock Position:  -0.0004821633472381529
Bond Position:  [-4.62251182]


portfolio before change:  [-4.67090603]
curr_Stock_Price:  99.17045244052169
curr_Factors:  [99.17045244 -0.76441274 -1.02138261]
mat_Sqrt:  [[16.6272806   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00304449  0.03306272  0.03354913]
Stock Position:  -0.0030444914016826787
Bond Position:  [-4.36898244]


portfolio before change:  [-4.6779793]
curr_Stock_Price:  101.31436262545405
curr_Factors:  [101.31436263  -0.77648691  -0.9846058 ]
mat_Sqrt:  [[17.41157956  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01235427 -0.00719986 -0.12652705]
Stock Position:  0.012354265566603262
Bond Position:  [-5.92964384]


portfolio before change:  [-4.68532569]
curr_Stock_Price:  100.77971872665742
curr_Factors:  [100.77971873  -0.73777522  -0.97130642]
mat_Sqrt:  [[18.24435087  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00326606 0.00949341 0.10257853]
Stock Position:  0.0032660573564296295
Bond Position:  [-5.01447803]


portfolio before change:  [-4.69004591]
curr_Stock_Price:  99.52641051151808
curr_Factors:  [99.52641051 -0.79391227 -0.92819285]
mat_Sqrt:  [[17.78433333  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00267034  0.00681618 -0.19257514]
Stock Position:  0.002670344642499219
Bond Position:  [-4.95581573]


portfolio before change:  [-4.69414306]
curr_Stock_Price:  98.22409484443597
curr_Factors:  [98.22409484 -0.77406607 -0.88152969]
mat_Sqrt:  [[18.75866517  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00555305  0.00627053 -0.25813003]
Stock Position:  -0.005553048895857639
Bond Position:  [-4.14869986]


portfolio before change:  [-4.69164237]
curr_Stock_Price:  97.6803746769151
curr_Factors:  [97.68037468 -0.88843577 -0.88292548]
mat_Sqrt:  [[16.61555686  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00428997 -0.01108132 -0.29345387]
Stock Position:  0.004289968745243141
Bond Position:  [-5.11068813]


portfolio before change:  [-4.68245717]
curr_Stock_Price:  99.97038669427019
curr_Factors:  [99.97038669 -0.78857135 -0.86586424]
mat_Sqrt:  [[19.11433196  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00255132  0.09805868  0.39684312]
Stock Position:  -0.0025513191702556284
Bond Position:  [-4.42740081]


portfolio before change:  [-4.68113973]
curr_Stock_Price:  99.23708191105841
curr_Factors:  [99.23708191 -1.11222298 -0.84053145]
mat_Sqrt:  [[14.08002779  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00308797  0.05551181 -0.23957629]
Stock Position:  0.0030879746089533173
Bond Position:  [-4.98758132]


portfolio before change:  [-4.6836543]
curr_Stock_Price:  98.62468171729503
curr_Factors:  [98.62468172 -1.29335947 -0.82064252]
mat_Sqrt:  [[11.90929941  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01190629 -0.01663915  0.10467343]
Stock Position:  -0.011906288677153353
Bond Position:  [-3.50940037]


portfolio before change:  [-4.69490099]
curr_Stock_Price:  99.5324366000348
curr_Factors:  [99.5324366  -1.44100683 -0.82634178]
mat_Sqrt:  [[10.31021325  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01152399  0.01408016 -0.12690448]
Stock Position:  -0.011523987238456572
Bond Position:  [-3.54789046]


portfolio before change:  [-4.69897837]
curr_Stock_Price:  99.84776703591653
curr_Factors:  [99.84776704 -1.42366811 -0.83927662]
mat_Sqrt:  [[10.38852634  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01183506 -0.02438576  0.16132513]
Stock Position:  -0.01183505576558994
Bond Position:  [-3.51727448]


portfolio before change:  [-4.70583439]
curr_Stock_Price:  100.38991353762208
curr_Factors:  [100.38991354  -1.48382844  -0.8319928 ]
mat_Sqrt:  [[ 9.90698933  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.03354148 0.13141582 0.24185994]
Stock Position:  0.0335414793650331
Bond Position:  [-8.0730606]


portfolio before change:  [-4.6700481]
curr_Stock_Price:  101.48692804875539
curr_Factors:  [101.48692805  -1.59910404  -0.82995261]
mat_Sqrt:  [[ 8.9430201   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00955107 -0.01068352 -0.27497021]
Stock Position:  -0.00955107380976621
Bond Position:  [-3.70073896]


portfolio before change:  [-4.6735854]
curr_Stock_Price:  101.80884814121946
curr_Factors:  [101.80884814  -1.419936    -0.83025456]
mat_Sqrt:  [[10.72852899  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00837944 -0.01118522 -0.16193772]
Stock Position:  -0.00837943925468579
Bond Position:  [-3.82048434]


portfolio before change:  [-4.67357799]
curr_Stock_Price:  101.7509681421063
curr_Factors:  [101.75096814  -1.31240064  -0.79771454]
mat_Sqrt:  [[12.33465973  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00282067  0.00169118  0.13726132]
Stock Position:  -0.0028206653752969493
Bond Position:  [-4.38657256]


portfolio before change:  [-4.67252028]
curr_Stock_Price:  101.18157741584724
curr_Factors:  [101.18157742  -1.07701593  -0.7837702 ]
mat_Sqrt:  [[15.73882467  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00435552 0.02227443 0.18774723]
Stock Position:  0.004355518567732186
Bond Position:  [-5.11321852]


portfolio before change:  [-4.66941253]
curr_Stock_Price:  102.04185364329545
curr_Factors:  [102.04185364  -1.05756868  -0.79030539]
mat_Sqrt:  [[16.07891828  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01890836 -0.03000789 -0.1723059 ]
Stock Position:  0.0189083602564665
Bond Position:  [-6.59885666]


portfolio before change:  [-4.67412161]
curr_Stock_Price:  101.83643256543617
curr_Factors:  [101.83643257  -1.17479754  -0.82577002]
mat_Sqrt:  [[13.77424248  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00328804 -0.00041469 -0.0319154 ]
Stock Position:  -0.00328804284048145
Bond Position:  [-4.33927906]


portfolio before change:  [-4.67016204]
curr_Stock_Price:  100.46722522232193
curr_Factors:  [100.46722522  -1.11765062  -0.81958681]
mat_Sqrt:  [[14.47747699  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0074476  -0.0201299   0.25251837]
Stock Position:  0.007447603742903418
Bond Position:  [-5.41840213]


portfolio before change:  [-4.66609823]
curr_Stock_Price:  101.10382685980335
curr_Factors:  [101.10382686  -1.0806936   -0.78897587]
mat_Sqrt:  [[15.58764343  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-4.48294285e-04  1.25800365e-02  7.14669747e-01]
Stock Position:  -0.00044829428462017347
Bond Position:  [-4.62077396]


portfolio before change:  [-4.66617066]
curr_Stock_Price:  99.97687761498756
curr_Factors:  [99.97687761 -0.96853514 -0.770036  ]
mat_Sqrt:  [[17.5730732   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00392044 -0.0007199  -0.23975597]
Stock Position:  -0.003920435283601736
Bond Position:  [-4.27421778]


portfolio before change:  [-4.66454505]
curr_Stock_Price:  99.42593894260646
curr_Factors:  [99.42593894 -0.83595243 -0.74941937]
mat_Sqrt:  [[20.36955196  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00941248  0.02974229  0.15484972]
Stock Position:  -0.009412476511690934
Bond Position:  [-3.72870073]


portfolio before change:  [-4.67558251]
curr_Stock_Price:  100.54905977820445
curr_Factors:  [100.54905978  -0.95239816  -0.73671738]
mat_Sqrt:  [[18.56968157  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00137521 -0.02943333  0.24200218]
Stock Position:  0.0013752143805413743
Bond Position:  [-4.81385903]


portfolio before change:  [-4.67532408]
curr_Stock_Price:  101.17456134977755
curr_Factors:  [101.17456135  -0.91939852  -0.75198097]
mat_Sqrt:  [[19.01955886  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00701849  0.02024613  0.09433441]
Stock Position:  -0.007018493727653427
Bond Position:  [-3.96523106]


portfolio before change:  [-4.68591189]
curr_Stock_Price:  102.61249382834318
curr_Factors:  [102.61249383  -0.82871136  -0.72062965]
mat_Sqrt:  [[21.79365111  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00196777  0.02328151  0.08378082]
Stock Position:  -0.001967766290464382
Bond Position:  [-4.48399448]


portfolio before change:  [-4.68498496]
curr_Stock_Price:  101.85657694299452
curr_Factors:  [101.85657694  -0.76266073  -0.69373965]
mat_Sqrt:  [[23.74009389  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00491193 -0.02101047 -0.60478484]
Stock Position:  -0.004911925564780909
Bond Position:  [-4.18467303]


portfolio before change:  [-4.69323525]
curr_Stock_Price:  103.42972383344282
curr_Factors:  [103.42972383  -0.91305763  -0.70842268]
mat_Sqrt:  [[20.43833031  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00124543  0.00249804 -0.11976658]
Stock Position:  0.001245426904230749
Bond Position:  [-4.82204941]


portfolio before change:  [-4.69334583]
curr_Stock_Price:  103.82494557267451
curr_Factors:  [103.82494557  -1.03176052  -0.71703724]
mat_Sqrt:  [[18.06377411  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00069735  0.09153605  0.0372819 ]
Stock Position:  -0.0006973483668558084
Bond Position:  [-4.62094367]


portfolio before change:  [-4.69487396]
curr_Stock_Price:  105.18794210317567
curr_Factors:  [105.1879421   -0.98337656  -0.70019512]
mat_Sqrt:  [[19.53439949  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00155642 -0.03344766 -0.09514903]
Stock Position:  0.0015564166406275039
Bond Position:  [-4.85859023]


portfolio before change:  [-4.69425088]
curr_Stock_Price:  105.97850750027726
curr_Factors:  [105.9785075   -1.09677103  -0.71252983]
mat_Sqrt:  [[17.35595111  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00046041  0.00157078  0.22450836]
Stock Position:  -0.00046040974279621885
Bond Position:  [-4.64545734]


portfolio before change:  [-4.69454827]
curr_Stock_Price:  105.36312927872692
curr_Factors:  [105.36312928  -1.24010848  -0.67876346]
mat_Sqrt:  [[15.46440324  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00376194 -0.01625985  0.10590737]
Stock Position:  -0.0037619396329302626
Bond Position:  [-4.29817854]


portfolio before change:  [-4.69605335]
curr_Stock_Price:  105.62038390098785
curr_Factors:  [105.6203839   -1.26886891  -0.71330939]
mat_Sqrt:  [[14.5511945   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00734027  0.00535974  0.10437105]
Stock Position:  -0.0073402706895321764
Bond Position:  [-3.92077114]


portfolio before change:  [-4.6897698]
curr_Stock_Price:  104.69757404080424
curr_Factors:  [104.69757404  -1.08648689  -0.70350321]
mat_Sqrt:  [[17.48049783  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00298266 -0.05218142 -0.39574898]
Stock Position:  0.0029826631366742734
Bond Position:  [-5.0020474]


portfolio before change:  [-4.69304026]
curr_Stock_Price:  103.81072823496335
curr_Factors:  [103.81072823  -0.95328795  -0.72186414]
mat_Sqrt:  [[19.44164138  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00952663 -0.09822436  0.11840357]
Stock Position:  -0.009526631574750151
Bond Position:  [-3.7040737]


portfolio before change:  [-4.69536598]
curr_Stock_Price:  104.00625131024572
curr_Factors:  [104.00625131  -0.93963869  -0.70480817]
mat_Sqrt:  [[20.08562026  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00193211 -0.00743708  0.07215702]
Stock Position:  -0.0019321069647317884
Bond Position:  [-4.49441477]


portfolio before change:  [-4.69641658]
curr_Stock_Price:  104.25922111809366
curr_Factors:  [104.25922112  -1.12036716  -0.69483187]
mat_Sqrt:  [[16.97397486  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00232824  0.02460935 -0.07333691]
Stock Position:  -0.0023282414093309853
Bond Position:  [-4.45367594]


portfolio before change:  [-4.69630303]
curr_Stock_Price:  103.97132444593343
curr_Factors:  [103.97132445  -1.24061098  -0.66665383]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-4.69630303]
Stock Price:  104.01215162687181
PL:  [-8.70845466]
Settle:  Tensor("sub_396:0", shape=(), dtype=float64)
PL:  Tensor("sub_397:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  199
output_Z_Vals[:, i, :]:  [[ 1.19260232e+02 -2.92559343e+01 -2.92733494e+01]
 [ 3.49095459e-02  4.54022051e-02 -5.41354422e-02]
 [-4.52944076e-02  2.32436216e-02  1.04734715e-01]
 [-1.14698473e-03  1.26045919e-01  2.19522952e-02]
 [ 1.26000017e-01  1.37683880e-03 -6.62316927e-02]
 [ 7.30848637e-02  3.06813814e-02  1.02490127e-03]
 [ 1.79826117e-02  5.48731538e-02 -1.00837531e-02]
 [-5.62423107e-02  1.21145832e-03 -6.49107479e-02]
 [ 1.25798216e-01 -2.82152874e-02 -9.83918933e-02]
 [-8.55196004e-02 -1.35717277e-01 -1.03523169e-01]
 [ 1.33337498e-01  8.89323590e-02  5.40921639e-02]
 [-2.04538213e-01 -9.95626229e-02  4.53329544e-02]
 [-3.24294332e-02 -3.18019096e-02  8.74644254e-02]
 [-1.21374890e-01 -1.23553506e-01  4.54463163e-02]
 [ 1.89776889e-01  1.50491334e-01 -6.79538305e-02]
 [-6.43060695e-02 -4.80606161e-01 -4.90068045e-02]
 [-6.70196251e-02 -3.31321599e-02 -5.30856629e-02]
 [-6.60650729e-02  1.68168180e-01  1.04701303e-01]
 [ 1.06333427e-01  4.85145265e-02  9.34203669e-02]
 [ 1.85695986e-01 -4.88754329e-02 -7.89530051e-04]
 [-5.24849425e-02  5.82320696e-04 -3.63527820e-03]
 [ 9.06700813e-02 -5.96121868e-02  9.93856842e-02]
 [-6.67988788e-02  6.08834533e-02  3.13418751e-01]
 [ 6.53670434e-02 -2.75388458e-02 -6.78740651e-02]
 [ 3.98993447e-02  3.36413210e-02  7.43882014e-02]
 [ 1.01623486e-01  4.11825507e-03  5.62359841e-02]
 [-1.42589238e-01  7.19689648e-02  8.81645822e-02]
 [-5.07806065e-02  7.36225950e-02  2.93687317e-02]
 [ 6.20848838e-02 -6.23725319e-02  9.08311027e-02]
 [-4.92424908e-02 -8.65962999e-02 -5.16005701e-02]
 [-6.76051653e-02  4.09737401e-01  1.07133540e-02]
 [ 2.60916705e-02 -5.23133710e-02  3.43089838e-02]
 [-6.60716506e-02  2.27031835e-02  8.38011601e-02]
 [-1.63739908e-01 -4.79658994e-02  1.52686563e-02]
 [-1.47565270e-01  1.14927296e-01  3.50484318e-02]
 [ 8.70135339e-02 -1.64041035e-01 -1.37552501e-01]
 [-2.03919979e-01 -3.43875032e-01  5.74398164e-02]
 [-5.45939921e-02 -4.99856985e-02  7.89812654e-02]
 [-2.96080580e-02  6.38270668e-02 -2.98948529e-02]
 [ 1.71183237e-01 -1.00117191e-02 -1.66473250e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.26023247 -29.25593426 -29.27334937]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  8.31486419  -9.25153874 -83.50871763]
init_Out:  [2.49911038]
Stock Position:  8.31486419409362
Bond position:  [-828.98730903]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-2.8961106]
curr_Stock_Price:  99.36359861517678
curr_Factors:  [99.36359862 -0.89755647 -0.98940478]
mat_Sqrt:  [[15.05672273  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00166248  0.01435744 -0.15443335]
Stock Position:  0.0016624783077270478
Bond Position:  [-3.06130042]


portfolio before change:  [-2.89673583]
curr_Stock_Price:  99.21770381497906
curr_Factors:  [99.21770381 -0.74488839 -1.00217399]
mat_Sqrt:  [[17.29217495  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00134832  0.00735028  0.29877899]
Stock Position:  -0.0013483194444664978
Bond Position:  [-2.76295867]


portfolio before change:  [-2.89764794]
curr_Stock_Price:  99.63801452160038
curr_Factors:  [99.63801452 -0.73708197 -0.98881447]
mat_Sqrt:  [[17.73690191  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00037146 0.03985922 0.06262379]
Stock Position:  0.0003714572269006205
Bond Position:  [-2.9346592]


portfolio before change:  [-2.89790485]
curr_Stock_Price:  99.93398287859324
curr_Factors:  [99.93398288 -0.67327918 -1.02802032]
mat_Sqrt:  [[18.23258352  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00617115  0.00043539 -0.18894058]
Stock Position:  0.006171153886954788
Bond Position:  [-3.51461284]


portfolio before change:  [-2.90213557]
curr_Stock_Price:  99.3196140242039
curr_Factors:  [99.31961402 -0.44526473 -1.00605276]
mat_Sqrt:  [[23.26675659  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00318421 0.0097023  0.00292376]
Stock Position:  0.003184210932432047
Bond Position:  [-3.21839017]


portfolio before change:  [-2.90244422]
curr_Stock_Price:  99.34903137477298
curr_Factors:  [99.34903137 -0.43027336 -1.01447084]
mat_Sqrt:  [[23.42713627  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00074021  0.01735241 -0.02876614]
Stock Position:  0.0007402139427023418
Bond Position:  [-2.97598376]


portfolio before change:  [-2.90402835]
curr_Stock_Price:  97.71152783436777
curr_Factors:  [97.71152783 -0.35485696 -1.00579876]
mat_Sqrt:  [[25.06227729  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00277153  0.0003831  -0.1851723 ]
Stock Position:  -0.0027715311382764045
Bond Position:  [-2.63321781]


portfolio before change:  [-2.90825211]
curr_Stock_Price:  99.11673936069295
curr_Factors:  [99.11673936 -0.19754213 -0.99616288]
mat_Sqrt:  [[30.04190754  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00349464 -0.00892246 -0.28068468]
Stock Position:  0.0034946362633933403
Bond Position:  [-3.25462906]


portfolio before change:  [-2.91626787]
curr_Stock_Price:  96.93942861456367
curr_Factors:  [96.93942861 -0.30662074 -0.98116739]
mat_Sqrt:  [[26.74368079  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00411893 -0.04291757 -0.29532279]
Stock Position:  -0.0041189312992428355
Bond Position:  [-2.51698102]


portfolio before change:  [-2.91661828]
curr_Stock_Price:  96.94811332638605
curr_Factors:  [96.94811333 -0.21724877 -0.98369381]
mat_Sqrt:  [[29.17270008  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00502783 0.02812288 0.15430989]
Stock Position:  0.005027825259444169
Bond Position:  [-3.40405646]


portfolio before change:  [-2.92031452]
curr_Stock_Price:  96.29759252495207
curr_Factors:  [ 9.62975925e+01 -5.80063838e-03 -9.87290952e-01]
mat_Sqrt:  [[35.67148849  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0055466  -0.03148447  0.1293223 ]
Stock Position:  -0.005546596635522356
Bond Position:  [-2.38619062]


portfolio before change:  [-2.92698917]
curr_Stock_Price:  97.4471904701792
curr_Factors:  [ 9.74471905e+01  6.09240587e-02 -9.97032800e-01]
mat_Sqrt:  [[38.21399669  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00040291 -0.01005665  0.24951166]
Stock Position:  -0.00040291399116489535
Bond Position:  [-2.88772634]


portfolio before change:  [-2.92691]
curr_Stock_Price:  96.35473838471992
curr_Factors:  [96.35473838 -0.17906883 -0.97953688]
mat_Sqrt:  [[30.24802426  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00381143 -0.03907105  0.12964569]
Stock Position:  -0.003811433652293256
Bond Position:  [-2.5596603]


portfolio before change:  [-2.93353717]
curr_Stock_Price:  98.00954711741409
curr_Factors:  [98.00954712 -0.29785552 -1.00017225]
mat_Sqrt:  [[26.7634494   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0067178   0.04758954 -0.19385336]
Stock Position:  0.006717801499716982
Bond Position:  [-3.59194585]


portfolio before change:  [-2.93776127]
curr_Stock_Price:  97.44759550837051
curr_Factors:  [97.44759551 -0.31343648 -0.99789917]
mat_Sqrt:  [[26.25822047  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00330254 -0.15198101 -0.13980277]
Stock Position:  -0.0033025367946373763
Bond Position:  [-2.615937]


portfolio before change:  [-2.93959619]
curr_Stock_Price:  97.90418624896141
curr_Factors:  [97.90418625 -0.29766967 -1.0208922 ]
mat_Sqrt:  [[26.19130374  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00300524 -0.01047731 -0.15143862]
Stock Position:  -0.003005240218106308
Bond Position:  [-2.64537059]


portfolio before change:  [-2.94150356]
curr_Stock_Price:  98.42883031127805
curr_Factors:  [98.42883031 -0.34994544 -1.02702346]
mat_Sqrt:  [[24.83775439  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00162458  0.05317945  0.29868368]
Stock Position:  -0.0016245802442638843
Bond Position:  [-2.78159803]


portfolio before change:  [-2.94288049]
curr_Stock_Price:  99.0623514034414
curr_Factors:  [99.0623514  -0.47641849 -1.02562804]
mat_Sqrt:  [[22.05860855  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00574177 0.01534164 0.2665023 ]
Stock Position:  0.00574176827938471
Bond Position:  [-3.51167356]


portfolio before change:  [-2.93426085]
curr_Stock_Price:  100.64002389775072
curr_Factors:  [100.6400239   -0.69724408  -1.02722516]
mat_Sqrt:  [[17.94085987  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01027113 -0.01545577 -0.00225231]
Stock Position:  0.010271127843723355
Bond Position:  [-3.9679474]


portfolio before change:  [-2.93698774]
curr_Stock_Price:  100.42282598829868
curr_Factors:  [100.42282599  -0.43370626  -1.03113353]
mat_Sqrt:  [[23.20922285  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00229271  0.00018415 -0.01037044]
Stock Position:  -0.002292707316532663
Bond Position:  [-2.70674759]


portfolio before change:  [-2.93536851]
curr_Stock_Price:  99.5689923762093
curr_Factors:  [99.56899238 -0.31552949 -1.03301229]
mat_Sqrt:  [[25.84995903  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00423281 -0.01885103  0.28351969]
Stock Position:  0.00423280822217301
Bond Position:  [-3.35682496]


portfolio before change:  [-2.93505519]
curr_Stock_Price:  99.74215160464149
curr_Factors:  [99.7421516  -0.4983167  -1.05056706]
mat_Sqrt:  [[21.19371359  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-5.90052413e-05  1.92530384e-02  8.94096457e-01]
Stock Position:  -5.9005241283849605e-05
Bond Position:  [-2.92916988]


portfolio before change:  [-2.93545408]
curr_Stock_Price:  100.2966559714361
curr_Factors:  [100.29665597  -0.35822669  -1.06648202]
mat_Sqrt:  [[24.12922208  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00210538 -0.00870855 -0.19362582]
Stock Position:  0.0021053831639111843
Bond Position:  [-3.14661697]


portfolio before change:  [-2.929294]
curr_Stock_Price:  103.4093576966095
curr_Factors:  [103.4093577   -0.34033624  -1.08893104]
mat_Sqrt:  [[24.76492098  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00225934 0.01063832 0.21220883]
Stock Position:  0.0022593404577160563
Bond Position:  [-3.16293095]


portfolio before change:  [-2.92706428]
curr_Stock_Price:  104.57125111557936
curr_Factors:  [104.57125112  -0.47236474  -1.11770613]
mat_Sqrt:  [[21.32324527  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00530918 0.00130231 0.16042561]
Stock Position:  0.005309179688505763
Bond Position:  [-3.48225184]


portfolio before change:  [-2.92825389]
curr_Stock_Price:  104.4291756108203
curr_Factors:  [104.42917561  -0.4522514   -1.10237251]
mat_Sqrt:  [[22.06262914  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.005563    0.02275858  0.25150901]
Stock Position:  -0.005563003707848095
Bond Position:  [-2.347314]


portfolio before change:  [-2.93377036]
curr_Stock_Price:  105.36806306405244
curr_Factors:  [105.36806306  -0.39812468  -1.08981445]
mat_Sqrt:  [[23.79607031  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00180218  0.02328151  0.08378082]
Stock Position:  -0.0018021804210340924
Bond Position:  [-2.7438781]


portfolio before change:  [-2.93661044]
curr_Stock_Price:  106.75364923510197
curr_Factors:  [106.75364924  -0.2919774   -1.07765795]
mat_Sqrt:  [[27.13673902  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00291174 -0.01972393  0.25911585]
Stock Position:  0.0029117445942211115
Bond Position:  [-3.2474498]


portfolio before change:  [-2.9397847]
curr_Stock_Price:  105.80291172328613
curr_Factors:  [105.80291172  -0.3670032   -1.06981879]
mat_Sqrt:  [[25.14743855  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00246591 -0.02738415 -0.14720206]
Stock Position:  -0.0024659099883931673
Bond Position:  [-2.67888425]


portfolio before change:  [-2.93342801]
curr_Stock_Price:  103.08927794528014
curr_Factors:  [103.08927795  -0.11241094  -1.08290622]
mat_Sqrt:  [[31.19563635  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0017579   0.12957034  0.03056222]
Stock Position:  -0.0017579040948769134
Bond Position:  [-2.75220694]


portfolio before change:  [-2.93661444]
curr_Stock_Price:  104.70619736798555
curr_Factors:  [ 1.04706197e+02  2.96400425e-02 -1.05883955e+00]
mat_Sqrt:  [[37.4107764   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00084853 -0.01654294  0.09787398]
Stock Position:  0.0008485318976669224
Bond Position:  [-3.02546099]


portfolio before change:  [-2.93823644]
curr_Stock_Price:  103.24038224525415
curr_Factors:  [ 1.03240382e+02  1.18490749e-02 -1.05506646e+00]
mat_Sqrt:  [[36.37358023  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00133008  0.00717938  0.23906138]
Stock Position:  -0.0013300757434965675
Bond Position:  [-2.80091891]


portfolio before change:  [-2.94235714]
curr_Stock_Price:  106.07522677336607
curr_Factors:  [106.07522677  -0.36310883  -1.05730761]
mat_Sqrt:  [[25.62919413  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00631552 -0.01516815  0.04355723]
Stock Position:  -0.006315519730712034
Bond Position:  [-2.27243695]


portfolio before change:  [-2.9341755]
curr_Stock_Price:  104.73476494180446
curr_Factors:  [104.73476494  -0.6203774   -1.0468451 ]
mat_Sqrt:  [[19.77084955  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00695183  0.0363432   0.09998342]
Stock Position:  -0.006951832227701315
Bond Position:  [-2.20607698]


portfolio before change:  [-2.93685623]
curr_Stock_Price:  105.08071121676612
curr_Factors:  [105.08071122  -0.71724778  -1.0630991 ]
mat_Sqrt:  [[17.71447066  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00308788 -0.05187433 -0.392399  ]
Stock Position:  0.003087883737856713
Bond Position:  [-3.26133325]


portfolio before change:  [-2.93717598]
curr_Stock_Price:  105.10919273498045
curr_Factors:  [105.10919273  -0.67975865  -1.05409067]
mat_Sqrt:  [[18.56262996  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01083219 -0.10874283  0.16385981]
Stock Position:  -0.01083219030179324
Bond Position:  [-1.7986132]


portfolio before change:  [-2.94789606]
curr_Stock_Price:  106.07808634474534
curr_Factors:  [106.07808634  -0.76015668  -1.05159032]
mat_Sqrt:  [[17.32981602  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00229446 -0.01580687  0.22531157]
Stock Position:  -0.0022944637101276906
Bond Position:  [-2.70450374]


portfolio before change:  [-2.94784537]
curr_Stock_Price:  105.90864628694938
curr_Factors:  [105.90864629  -0.70727606  -1.0343185 ]
mat_Sqrt:  [[18.55951004  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0018353   0.02018389 -0.08528169]
Stock Position:  -0.0018353023018657939
Bond Position:  [-2.75347099]


portfolio before change:  [-2.94907399]
curr_Stock_Price:  106.39053689166579
curr_Factors:  [106.39053689  -0.79346252  -1.03295918]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-2.94907399]
Stock Price:  105.70174120446278
PL:  [-8.65081519]
Settle:  Tensor("sub_398:0", shape=(), dtype=float64)
PL:  Tensor("sub_399:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


FINAL AVERAGE P&L:  0.021319529702995544
FINAL STD P&L:  6.521470476960093
