WARNING:tensorflow:From main.py:92: The name tf.reset_default_graph is deprecated. Please use tf.compat.v1.reset_default_graph instead.

WARNING From main.py:92: The name tf.reset_default_graph is deprecated. Please use tf.compat.v1.reset_default_graph instead.

WARNING:tensorflow:From main.py:93: The name tf.Session is deprecated. Please use tf.compat.v1.Session instead.

WARNING From main.py:93: The name tf.Session is deprecated. Please use tf.compat.v1.Session instead.

2019-12-19 00:00:52.741998: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcuda.so.1
2019-12-19 00:00:52.769334: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1618] Found device 0 with properties: 
name: Tesla P100-PCIE-16GB major: 6 minor: 0 memoryClockRate(GHz): 1.3285
pciBusID: 0000:04:00.0
2019-12-19 00:00:52.769824: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcudart.so.10.0
2019-12-19 00:00:52.771789: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcublas.so.10.0
2019-12-19 00:00:52.773713: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcufft.so.10.0
2019-12-19 00:00:52.774658: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcurand.so.10.0
2019-12-19 00:00:52.776886: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcusolver.so.10.0
2019-12-19 00:00:52.778742: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcusparse.so.10.0
2019-12-19 00:00:52.783592: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcudnn.so.7
2019-12-19 00:00:52.785531: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1746] Adding visible gpu devices: 0
2019-12-19 00:00:52.785921: I tensorflow/core/platform/cpu_feature_guard.cc:142] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX AVX2 FMA
2019-12-19 00:00:52.792349: I tensorflow/core/platform/profile_utils/cpu_utils.cc:94] CPU Frequency: 2399775000 Hz
2019-12-19 00:00:52.792519: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x555e7fae2a70 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2019-12-19 00:00:52.792537: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2019-12-19 00:00:52.793632: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1618] Found device 0 with properties: 
name: Tesla P100-PCIE-16GB major: 6 minor: 0 memoryClockRate(GHz): 1.3285
pciBusID: 0000:04:00.0
2019-12-19 00:00:52.793656: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcudart.so.10.0
2019-12-19 00:00:52.793668: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcublas.so.10.0
2019-12-19 00:00:52.793679: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcufft.so.10.0
2019-12-19 00:00:52.793689: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcurand.so.10.0
2019-12-19 00:00:52.793699: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcusolver.so.10.0
2019-12-19 00:00:52.793724: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcusparse.so.10.0
2019-12-19 00:00:52.793734: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcudnn.so.7
2019-12-19 00:00:52.795594: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1746] Adding visible gpu devices: 0
2019-12-19 00:00:52.795622: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcudart.so.10.0
2019-12-19 00:00:52.887130: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1159] Device interconnect StreamExecutor with strength 1 edge matrix:
2019-12-19 00:00:52.887162: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1165]      0 
2019-12-19 00:00:52.887173: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1178] 0:   N 
2019-12-19 00:00:52.890157: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1304] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 15216 MB memory) -> physical GPU (device: 0, name: Tesla P100-PCIE-16GB, pci bus id: 0000:04:00.0, compute capability: 6.0)
2019-12-19 00:00:52.892246: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x555e8011bd80 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2019-12-19 00:00:52.892267: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Tesla P100-PCIE-16GB, Compute Capability 6.0
INFO   Y0_true: -1.0000e+00
WARNING:tensorflow:From /home/dz4/DeepBSDE/solver.py:232: The name tf.placeholder is deprecated. Please use tf.compat.v1.placeholder instead.

WARNING From /home/dz4/DeepBSDE/solver.py:232: The name tf.placeholder is deprecated. Please use tf.compat.v1.placeholder instead.

WARNING:tensorflow:From /home/dz4/DeepBSDE/solver.py:237: The name tf.random_uniform is deprecated. Please use tf.random.uniform instead.

WARNING From /home/dz4/DeepBSDE/solver.py:237: The name tf.random_uniform is deprecated. Please use tf.random.uniform instead.

WARNING:tensorflow:From /home/dz4/DeepBSDE/solver.py:311: The name tf.variable_scope is deprecated. Please use tf.compat.v1.variable_scope instead.

WARNING From /home/dz4/DeepBSDE/solver.py:311: The name tf.variable_scope is deprecated. Please use tf.compat.v1.variable_scope instead.

WARNING:tensorflow:From /home/dz4/DeepBSDE/solver.py:317: calling reduce_sum_v1 (from tensorflow.python.ops.math_ops) with keep_dims is deprecated and will be removed in a future version.
Instructions for updating:
keep_dims is deprecated, use keepdims instead
WARNING From /home/dz4/DeepBSDE/solver.py:317: calling reduce_sum_v1 (from tensorflow.python.ops.math_ops) with keep_dims is deprecated and will be removed in a future version.
Instructions for updating:
keep_dims is deprecated, use keepdims instead
WARNING:tensorflow:From /home/dz4/DeepBSDE/solver.py:487: The name tf.get_variable is deprecated. Please use tf.compat.v1.get_variable instead.

WARNING From /home/dz4/DeepBSDE/solver.py:487: The name tf.get_variable is deprecated. Please use tf.compat.v1.get_variable instead.

WARNING:tensorflow:From /home/dz4/DeepBSDE/solver.py:489: calling RandomNormal.__init__ (from tensorflow.python.ops.init_ops) with dtype is deprecated and will be removed in a future version.
Instructions for updating:
Call initializer instance with the dtype argument instead of passing it to the constructor
WARNING From /home/dz4/DeepBSDE/solver.py:489: calling RandomNormal.__init__ (from tensorflow.python.ops.init_ops) with dtype is deprecated and will be removed in a future version.
Instructions for updating:
Call initializer instance with the dtype argument instead of passing it to the constructor
WARNING:tensorflow:From /home/dz4/DeepBSDE/solver.py:492: calling RandomUniform.__init__ (from tensorflow.python.ops.init_ops) with dtype is deprecated and will be removed in a future version.
Instructions for updating:
Call initializer instance with the dtype argument instead of passing it to the constructor
WARNING From /home/dz4/DeepBSDE/solver.py:492: calling RandomUniform.__init__ (from tensorflow.python.ops.init_ops) with dtype is deprecated and will be removed in a future version.
Instructions for updating:
Call initializer instance with the dtype argument instead of passing it to the constructor
WARNING:tensorflow:From /home/dz4/DeepBSDE/solver.py:494: calling Constant.__init__ (from tensorflow.python.ops.init_ops) with dtype is deprecated and will be removed in a future version.
Instructions for updating:
Call initializer instance with the dtype argument instead of passing it to the constructor
WARNING From /home/dz4/DeepBSDE/solver.py:494: calling Constant.__init__ (from tensorflow.python.ops.init_ops) with dtype is deprecated and will be removed in a future version.
Instructions for updating:
Call initializer instance with the dtype argument instead of passing it to the constructor
WARNING:tensorflow:From /home/dz4/DeepBSDE/solver.py:330: where (from tensorflow.python.ops.array_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.where in 2.0, which has the same broadcast rule as np.where
WARNING From /home/dz4/DeepBSDE/solver.py:330: where (from tensorflow.python.ops.array_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.where in 2.0, which has the same broadcast rule as np.where
WARNING:tensorflow:From /home/dz4/DeepBSDE/solver.py:337: The name tf.train.piecewise_constant is deprecated. Please use tf.compat.v1.train.piecewise_constant instead.

WARNING From /home/dz4/DeepBSDE/solver.py:337: The name tf.train.piecewise_constant is deprecated. Please use tf.compat.v1.train.piecewise_constant instead.

WARNING:tensorflow:From /home/dz4/DeepBSDE/solver.py:340: The name tf.trainable_variables is deprecated. Please use tf.compat.v1.trainable_variables instead.

WARNING From /home/dz4/DeepBSDE/solver.py:340: The name tf.trainable_variables is deprecated. Please use tf.compat.v1.trainable_variables instead.

WARNING:tensorflow:From /home/dz4/DeepBSDE/solver.py:342: The name tf.train.AdamOptimizer is deprecated. Please use tf.compat.v1.train.AdamOptimizer instead.

WARNING From /home/dz4/DeepBSDE/solver.py:342: The name tf.train.AdamOptimizer is deprecated. Please use tf.compat.v1.train.AdamOptimizer instead.

WARNING:tensorflow:From /home/dz4/DeepBSDE/solver.py:195: The name tf.global_variables_initializer is deprecated. Please use tf.compat.v1.global_variables_initializer instead.

WARNING From /home/dz4/DeepBSDE/solver.py:195: The name tf.global_variables_initializer is deprecated. Please use tf.compat.v1.global_variables_initializer instead.

2019-12-19 00:01:09.376682: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcublas.so.10.0
INFO   step:     0,    loss: 1.9431e+02,   Y0: 2.5634e+00,  elapsed time  16
INFO   step:     1,    loss: 1.3534e+02,   Y0: 2.5584e+00,  elapsed time  23
INFO   step:     2,    loss: 1.3532e+02,   Y0: 2.5537e+00,  elapsed time  25
INFO   step:     3,    loss: 1.3531e+02,   Y0: 2.5489e+00,  elapsed time  26
INFO   step:     4,    loss: 1.3529e+02,   Y0: 2.5449e+00,  elapsed time  28
INFO   step:     5,    loss: 1.3528e+02,   Y0: 2.5410e+00,  elapsed time  30
INFO   step:     6,    loss: 1.3527e+02,   Y0: 2.5375e+00,  elapsed time  31
INFO   step:     7,    loss: 1.3526e+02,   Y0: 2.5343e+00,  elapsed time  33
INFO   step:     8,    loss: 1.3526e+02,   Y0: 2.5307e+00,  elapsed time  34
INFO   step:     9,    loss: 1.3525e+02,   Y0: 2.5267e+00,  elapsed time  36
INFO   step:    10,    loss: 1.3524e+02,   Y0: 2.5230e+00,  elapsed time  37
INFO   step:    11,    loss: 1.3523e+02,   Y0: 2.5199e+00,  elapsed time  39
INFO   step:    12,    loss: 1.3521e+02,   Y0: 2.5169e+00,  elapsed time  41
INFO   step:    13,    loss: 1.3520e+02,   Y0: 2.5150e+00,  elapsed time  42
INFO   step:    14,    loss: 1.3518e+02,   Y0: 2.5125e+00,  elapsed time  44
INFO   step:    15,    loss: 1.3517e+02,   Y0: 2.5101e+00,  elapsed time  45
INFO   step:    16,    loss: 1.3515e+02,   Y0: 2.5083e+00,  elapsed time  47
INFO   step:    17,    loss: 1.3513e+02,   Y0: 2.5057e+00,  elapsed time  48
INFO   step:    18,    loss: 1.3512e+02,   Y0: 2.5027e+00,  elapsed time  50
INFO   step:    19,    loss: 1.3510e+02,   Y0: 2.5002e+00,  elapsed time  52
INFO   step:    20,    loss: 1.3509e+02,   Y0: 2.4991e+00,  elapsed time  53
INFO   step:    21,    loss: 1.3508e+02,   Y0: 2.4995e+00,  elapsed time  55
INFO   step:    22,    loss: 1.3507e+02,   Y0: 2.5000e+00,  elapsed time  56
INFO   step:    23,    loss: 1.3505e+02,   Y0: 2.5005e+00,  elapsed time  58
INFO   step:    24,    loss: 1.3504e+02,   Y0: 2.5017e+00,  elapsed time  59
INFO   step:    25,    loss: 1.3503e+02,   Y0: 2.5034e+00,  elapsed time  61
INFO   step:    26,    loss: 1.3502e+02,   Y0: 2.5047e+00,  elapsed time  63
INFO   step:    27,    loss: 1.3501e+02,   Y0: 2.5060e+00,  elapsed time  64
INFO   step:    28,    loss: 1.3500e+02,   Y0: 2.5066e+00,  elapsed time  66
INFO   step:    29,    loss: 1.3498e+02,   Y0: 2.5059e+00,  elapsed time  67
INFO   step:    30,    loss: 1.3496e+02,   Y0: 2.5048e+00,  elapsed time  69
INFO   step:    31,    loss: 1.3495e+02,   Y0: 2.5045e+00,  elapsed time  70
INFO   step:    32,    loss: 1.3493e+02,   Y0: 2.5036e+00,  elapsed time  72
INFO   step:    33,    loss: 1.3492e+02,   Y0: 2.5027e+00,  elapsed time  74
INFO   step:    34,    loss: 1.3491e+02,   Y0: 2.5018e+00,  elapsed time  75
INFO   step:    35,    loss: 1.3490e+02,   Y0: 2.5011e+00,  elapsed time  77
INFO   step:    36,    loss: 1.3489e+02,   Y0: 2.5012e+00,  elapsed time  78
INFO   step:    37,    loss: 1.3488e+02,   Y0: 2.5014e+00,  elapsed time  80
INFO   step:    38,    loss: 1.3487e+02,   Y0: 2.5019e+00,  elapsed time  81
INFO   step:    39,    loss: 1.3486e+02,   Y0: 2.5030e+00,  elapsed time  83
INFO   step:    40,    loss: 1.3485e+02,   Y0: 2.5031e+00,  elapsed time  85
INFO   step:    41,    loss: 1.3484e+02,   Y0: 2.5031e+00,  elapsed time  86
INFO   step:    42,    loss: 1.3483e+02,   Y0: 2.5029e+00,  elapsed time  88
INFO   step:    43,    loss: 1.3482e+02,   Y0: 2.5025e+00,  elapsed time  89
INFO   step:    44,    loss: 1.3481e+02,   Y0: 2.5031e+00,  elapsed time  91
INFO   step:    45,    loss: 1.3479e+02,   Y0: 2.5031e+00,  elapsed time  92
INFO   step:    46,    loss: 1.3477e+02,   Y0: 2.5030e+00,  elapsed time  94
INFO   step:    47,    loss: 1.3475e+02,   Y0: 2.5039e+00,  elapsed time  95
INFO   step:    48,    loss: 1.3473e+02,   Y0: 2.5060e+00,  elapsed time  97
INFO   step:    49,    loss: 1.3471e+02,   Y0: 2.5086e+00,  elapsed time  99
INFO   step:    50,    loss: 1.3470e+02,   Y0: 2.5102e+00,  elapsed time 100
INFO   step:    51,    loss: 1.3467e+02,   Y0: 2.5113e+00,  elapsed time 102
INFO   step:    52,    loss: 1.3466e+02,   Y0: 2.5120e+00,  elapsed time 103
INFO   step:    53,    loss: 1.3463e+02,   Y0: 2.5132e+00,  elapsed time 105
INFO   step:    54,    loss: 1.3460e+02,   Y0: 2.5134e+00,  elapsed time 106
INFO   step:    55,    loss: 1.3458e+02,   Y0: 2.5129e+00,  elapsed time 108
INFO   step:    56,    loss: 1.3455e+02,   Y0: 2.5124e+00,  elapsed time 109
INFO   step:    57,    loss: 1.3453e+02,   Y0: 2.5124e+00,  elapsed time 111
INFO   step:    58,    loss: 1.3450e+02,   Y0: 2.5119e+00,  elapsed time 112
INFO   step:    59,    loss: 1.3448e+02,   Y0: 2.5117e+00,  elapsed time 114
INFO   step:    60,    loss: 1.3446e+02,   Y0: 2.5111e+00,  elapsed time 116
INFO   step:    61,    loss: 1.3445e+02,   Y0: 2.5103e+00,  elapsed time 117
INFO   step:    62,    loss: 1.3443e+02,   Y0: 2.5098e+00,  elapsed time 119
INFO   step:    63,    loss: 1.3441e+02,   Y0: 2.5092e+00,  elapsed time 120
INFO   step:    64,    loss: 1.3440e+02,   Y0: 2.5078e+00,  elapsed time 122
INFO   step:    65,    loss: 1.3439e+02,   Y0: 2.5064e+00,  elapsed time 123
INFO   step:    66,    loss: 1.3437e+02,   Y0: 2.5059e+00,  elapsed time 125
INFO   step:    67,    loss: 1.3436e+02,   Y0: 2.5047e+00,  elapsed time 126
INFO   step:    68,    loss: 1.3435e+02,   Y0: 2.5032e+00,  elapsed time 128
INFO   step:    69,    loss: 1.3433e+02,   Y0: 2.5016e+00,  elapsed time 129
INFO   step:    70,    loss: 1.3432e+02,   Y0: 2.5004e+00,  elapsed time 131
INFO   step:    71,    loss: 1.3431e+02,   Y0: 2.4986e+00,  elapsed time 132
INFO   step:    72,    loss: 1.3430e+02,   Y0: 2.4972e+00,  elapsed time 134
INFO   step:    73,    loss: 1.3429e+02,   Y0: 2.4968e+00,  elapsed time 136
INFO   step:    74,    loss: 1.3428e+02,   Y0: 2.4963e+00,  elapsed time 137
INFO   step:    75,    loss: 1.3427e+02,   Y0: 2.4962e+00,  elapsed time 139
INFO   step:    76,    loss: 1.3426e+02,   Y0: 2.4954e+00,  elapsed time 140
INFO   step:    77,    loss: 1.3425e+02,   Y0: 2.4944e+00,  elapsed time 142
INFO   step:    78,    loss: 1.3424e+02,   Y0: 2.4933e+00,  elapsed time 143
INFO   step:    79,    loss: 1.3423e+02,   Y0: 2.4914e+00,  elapsed time 145
INFO   step:    80,    loss: 1.3422e+02,   Y0: 2.4896e+00,  elapsed time 146
INFO   step:    81,    loss: 1.3421e+02,   Y0: 2.4878e+00,  elapsed time 148
INFO   step:    82,    loss: 1.3420e+02,   Y0: 2.4861e+00,  elapsed time 149
INFO   step:    83,    loss: 1.3419e+02,   Y0: 2.4849e+00,  elapsed time 151
INFO   step:    84,    loss: 1.3418e+02,   Y0: 2.4843e+00,  elapsed time 153
INFO   step:    85,    loss: 1.3418e+02,   Y0: 2.4849e+00,  elapsed time 154
INFO   step:    86,    loss: 1.3417e+02,   Y0: 2.4852e+00,  elapsed time 156
INFO   step:    87,    loss: 1.3416e+02,   Y0: 2.4857e+00,  elapsed time 157
INFO   step:    88,    loss: 1.3414e+02,   Y0: 2.4867e+00,  elapsed time 159
INFO   step:    89,    loss: 1.3413e+02,   Y0: 2.4870e+00,  elapsed time 160
INFO   step:    90,    loss: 1.3411e+02,   Y0: 2.4868e+00,  elapsed time 162
INFO   step:    91,    loss: 1.3410e+02,   Y0: 2.4867e+00,  elapsed time 163
INFO   step:    92,    loss: 1.3408e+02,   Y0: 2.4864e+00,  elapsed time 165
INFO   step:    93,    loss: 1.3407e+02,   Y0: 2.4853e+00,  elapsed time 167
INFO   step:    94,    loss: 1.3405e+02,   Y0: 2.4846e+00,  elapsed time 168
INFO   step:    95,    loss: 1.3404e+02,   Y0: 2.4838e+00,  elapsed time 170
INFO   step:    96,    loss: 1.3402e+02,   Y0: 2.4833e+00,  elapsed time 171
INFO   step:    97,    loss: 1.3401e+02,   Y0: 2.4826e+00,  elapsed time 173
INFO   step:    98,    loss: 1.3399e+02,   Y0: 2.4833e+00,  elapsed time 174
INFO   step:    99,    loss: 1.3397e+02,   Y0: 2.4839e+00,  elapsed time 176
INFO   step:   100,    loss: 1.3395e+02,   Y0: 2.4844e+00,  elapsed time 177
INFO   step:   101,    loss: 1.3394e+02,   Y0: 2.4845e+00,  elapsed time 179
INFO   step:   102,    loss: 1.3392e+02,   Y0: 2.4850e+00,  elapsed time 180
INFO   step:   103,    loss: 1.3391e+02,   Y0: 2.4854e+00,  elapsed time 182
INFO   step:   104,    loss: 1.3390e+02,   Y0: 2.4844e+00,  elapsed time 183
INFO   step:   105,    loss: 1.3388e+02,   Y0: 2.4838e+00,  elapsed time 185
INFO   step:   106,    loss: 1.3387e+02,   Y0: 2.4834e+00,  elapsed time 187
INFO   step:   107,    loss: 1.3385e+02,   Y0: 2.4823e+00,  elapsed time 188
INFO   step:   108,    loss: 1.3384e+02,   Y0: 2.4809e+00,  elapsed time 190
INFO   step:   109,    loss: 1.3382e+02,   Y0: 2.4790e+00,  elapsed time 191
INFO   step:   110,    loss: 1.3381e+02,   Y0: 2.4775e+00,  elapsed time 193
INFO   step:   111,    loss: 1.3379e+02,   Y0: 2.4763e+00,  elapsed time 194
INFO   step:   112,    loss: 1.3378e+02,   Y0: 2.4755e+00,  elapsed time 196
INFO   step:   113,    loss: 1.3377e+02,   Y0: 2.4741e+00,  elapsed time 197
INFO   step:   114,    loss: 1.3376e+02,   Y0: 2.4735e+00,  elapsed time 199
INFO   step:   115,    loss: 1.3374e+02,   Y0: 2.4732e+00,  elapsed time 200
INFO   step:   116,    loss: 1.3373e+02,   Y0: 2.4728e+00,  elapsed time 202
INFO   step:   117,    loss: 1.3371e+02,   Y0: 2.4725e+00,  elapsed time 204
INFO   step:   118,    loss: 1.3368e+02,   Y0: 2.4725e+00,  elapsed time 205
INFO   step:   119,    loss: 1.3367e+02,   Y0: 2.4720e+00,  elapsed time 207
INFO   step:   120,    loss: 1.3365e+02,   Y0: 2.4712e+00,  elapsed time 208
INFO   step:   121,    loss: 1.3363e+02,   Y0: 2.4699e+00,  elapsed time 210
INFO   step:   122,    loss: 1.3361e+02,   Y0: 2.4692e+00,  elapsed time 211
INFO   step:   123,    loss: 1.3359e+02,   Y0: 2.4682e+00,  elapsed time 213
INFO   step:   124,    loss: 1.3357e+02,   Y0: 2.4669e+00,  elapsed time 214
INFO   step:   125,    loss: 1.3355e+02,   Y0: 2.4662e+00,  elapsed time 216
INFO   step:   126,    loss: 1.3353e+02,   Y0: 2.4662e+00,  elapsed time 217
INFO   step:   127,    loss: 1.3351e+02,   Y0: 2.4658e+00,  elapsed time 219
INFO   step:   128,    loss: 1.3348e+02,   Y0: 2.4658e+00,  elapsed time 221
INFO   step:   129,    loss: 1.3346e+02,   Y0: 2.4662e+00,  elapsed time 222
INFO   step:   130,    loss: 1.3344e+02,   Y0: 2.4669e+00,  elapsed time 224
INFO   step:   131,    loss: 1.3342e+02,   Y0: 2.4682e+00,  elapsed time 225
INFO   step:   132,    loss: 1.3339e+02,   Y0: 2.4696e+00,  elapsed time 227
INFO   step:   133,    loss: 1.3337e+02,   Y0: 2.4711e+00,  elapsed time 228
INFO   step:   134,    loss: 1.3336e+02,   Y0: 2.4729e+00,  elapsed time 230
INFO   step:   135,    loss: 1.3334e+02,   Y0: 2.4746e+00,  elapsed time 231
INFO   step:   136,    loss: 1.3332e+02,   Y0: 2.4754e+00,  elapsed time 233
INFO   step:   137,    loss: 1.3330e+02,   Y0: 2.4759e+00,  elapsed time 234
INFO   step:   138,    loss: 1.3329e+02,   Y0: 2.4761e+00,  elapsed time 236
INFO   step:   139,    loss: 1.3328e+02,   Y0: 2.4764e+00,  elapsed time 238
INFO   step:   140,    loss: 1.3327e+02,   Y0: 2.4772e+00,  elapsed time 239
INFO   step:   141,    loss: 1.3325e+02,   Y0: 2.4782e+00,  elapsed time 241
INFO   step:   142,    loss: 1.3323e+02,   Y0: 2.4789e+00,  elapsed time 242
INFO   step:   143,    loss: 1.3322e+02,   Y0: 2.4797e+00,  elapsed time 244
INFO   step:   144,    loss: 1.3320e+02,   Y0: 2.4812e+00,  elapsed time 245
INFO   step:   145,    loss: 1.3319e+02,   Y0: 2.4821e+00,  elapsed time 247
INFO   step:   146,    loss: 1.3317e+02,   Y0: 2.4833e+00,  elapsed time 248
INFO   step:   147,    loss: 1.3315e+02,   Y0: 2.4837e+00,  elapsed time 250
INFO   step:   148,    loss: 1.3314e+02,   Y0: 2.4838e+00,  elapsed time 251
INFO   step:   149,    loss: 1.3312e+02,   Y0: 2.4836e+00,  elapsed time 253
Delta:  120 ,  120.05
Other1:  -50.05 ,  -50
Other2:  -50.05 ,  -50
all_one_vec:  Tensor("ones:0", shape=(?, 1), dtype=float64)
y:  Tensor("mul:0", shape=(?, 1), dtype=float64)
z output:  [<tf.Tensor 'MatMul:0' shape=(?, 3) dtype=float64>, <tf.Tensor 'MatMul_1:0' shape=(?, 3) dtype=float64>, <tf.Tensor 'MatMul_2:0' shape=(?, 3) dtype=float64>, <tf.Tensor 'MatMul_3:0' shape=(?, 3) dtype=float64>, <tf.Tensor 'MatMul_4:0' shape=(?, 3) dtype=float64>, <tf.Tensor 'MatMul_5:0' shape=(?, 3) dtype=float64>, <tf.Tensor 'MatMul_6:0' shape=(?, 3) dtype=float64>, <tf.Tensor 'MatMul_7:0' shape=(?, 3) dtype=float64>, <tf.Tensor 'MatMul_8:0' shape=(?, 3) dtype=float64>, <tf.Tensor 'MatMul_9:0' shape=(?, 3) dtype=float64>, <tf.Tensor 'MatMul_10:0' shape=(?, 3) dtype=float64>, <tf.Tensor 'MatMul_11:0' shape=(?, 3) dtype=float64>, <tf.Tensor 'MatMul_12:0' shape=(?, 3) dtype=float64>, <tf.Tensor 'MatMul_13:0' shape=(?, 3) dtype=float64>, <tf.Tensor 'MatMul_14:0' shape=(?, 3) dtype=float64>, <tf.Tensor 'MatMul_15:0' shape=(?, 3) dtype=float64>, <tf.Tensor 'MatMul_16:0' shape=(?, 3) dtype=float64>, <tf.Tensor 'MatMul_17:0' shape=(?, 3) dtype=float64>, <tf.Tensor 'MatMul_18:0' shape=(?, 3) dtype=float64>, <tf.Tensor 'MatMul_19:0' shape=(?, 3) dtype=float64>]
num_iterations:  150
total time intervals:  20
# of dimensions:  3
Loss out:  121.00767934438711
Output_Z_Vals:  [[[ 1.19271183e+02 -4.92738716e+01 -4.92570741e+01]
  [ 1.19271183e+02 -4.92738716e+01 -4.92570741e+01]
  [ 1.19271183e+02 -4.92738716e+01 -4.92570741e+01]
  ...
  [ 1.19271183e+02 -4.92738716e+01 -4.92570741e+01]
  [ 1.19271183e+02 -4.92738716e+01 -4.92570741e+01]
  [ 1.19271183e+02 -4.92738716e+01 -4.92570741e+01]]

 [[ 3.43491950e-02  6.40787412e-02 -3.85063808e-02]
  [ 1.86965428e-02  3.89309942e-02 -4.57702188e-02]
  [ 5.47384521e-02  8.64707770e-02 -4.18467773e-02]
  ...
  [-1.33699093e-03  2.36099157e-03 -5.87932861e-02]
  [ 1.74419933e-02  3.69154192e-02 -4.63524105e-02]
  [ 1.18247632e-02  2.73240127e-02 -4.94408471e-02]]

 [[-1.95496397e+00 -2.63537053e+00 -7.49182739e-01]
  [-2.17792030e+00 -2.93268854e+00 -8.35191335e-01]
  [-2.14800512e+00 -2.89279588e+00 -8.23651127e-01]
  ...
  [-2.24362017e+00 -3.02030100e+00 -8.60535999e-01]
  [-2.31160275e+00 -3.11095752e+00 -8.86761252e-01]
  [-1.91893228e+00 -2.58732135e+00 -7.35283002e-01]]

 ...

 [[-1.63320183e-01 -2.63994854e-01  3.68559176e-01]
  [-5.61073897e-02 -1.48512691e-01  2.62610251e-01]
  [ 1.13471420e-01 -1.13507145e-02 -2.67052538e-02]
  ...
  [ 1.15216134e-01 -1.08333916e-02 -3.18137274e-02]
  [ 1.15216134e-01 -1.08333916e-02 -3.18137274e-02]
  [ 9.78583544e-02 -1.61360435e-02  1.24012492e-02]]

 [[ 8.37809207e-02 -2.64557937e-01  2.39616307e-01]
  [ 3.73272699e-02 -2.44650818e-02  4.52612062e-02]
  [-6.66225814e-02 -3.06401862e-01  8.18434156e-02]
  ...
  [-4.86823163e-02 -8.68645919e-02 -1.20649457e-02]
  [-6.08037415e-02 -2.40433022e-01  4.75474470e-02]
  [-4.60759063e-02 -1.08920850e-01  1.01412942e-02]]

 [[ 1.35287591e-01 -1.14990854e+00 -1.85731478e-01]
  [ 7.46730899e-02 -6.71248272e-01 -3.24624716e-01]
  [ 3.27094136e-02 -2.95533036e-01 -2.86630257e-01]
  ...
  [ 5.00712698e-02 -3.72878458e-01 -4.07776775e-01]
  [ 5.70140036e-02 -4.18923194e-01 -4.58359128e-01]
  [ 6.40080565e-02 -5.41800519e-01 -4.93052580e-01]]]
Z_Vals dimensionality:  (20, 200, 3)
X_test:  [[[ 1.00000000e+02  1.00109889e+02  1.01345118e+02 ...  1.10610833e+02
    1.09952496e+02  1.09697291e+02]
  [-1.00000000e+00 -1.17358996e+00 -1.36411082e+00 ... -1.60088340e+00
   -1.63547221e+00 -1.92089214e+00]
  [-1.00000000e+00 -9.82979075e-01 -9.93776051e-01 ... -1.10910193e+00
   -1.12712899e+00 -1.13304337e+00]]

 [[ 1.00000000e+02  1.00195862e+02  1.00347238e+02 ...  1.05074628e+02
    1.04985391e+02  1.05769305e+02]
  [-1.00000000e+00 -9.03511121e-01 -1.02453789e+00 ... -6.79739261e-01
   -8.37642871e-01 -6.27160829e-01]
  [-1.00000000e+00 -1.01343217e+00 -1.01702892e+00 ... -1.12860245e+00
   -1.11846258e+00 -1.08588207e+00]]

 [[ 1.00000000e+02  9.92211749e+01  1.00114021e+02 ...  9.49311933e+01
    9.38084383e+01  9.32225405e+01]
  [-1.00000000e+00 -1.06310254e+00 -1.00056397e+00 ... -4.77916197e-01
   -1.36335335e-01 -6.88462601e-02]
  [-1.00000000e+00 -1.05569337e+00 -1.11755748e+00 ... -1.04768021e+00
   -1.08754676e+00 -1.09953800e+00]]

 ...

 [[ 1.00000000e+02  1.00836171e+02  9.97989719e+01 ...  9.89555729e+01
    9.86408790e+01  9.78165479e+01]
  [-1.00000000e+00 -9.21857000e-01 -9.87262520e-01 ... -7.30268517e-01
   -3.46567557e-01 -5.99356387e-02]
  [-1.00000000e+00 -1.01932041e+00 -9.69443519e-01 ... -9.40095025e-01
   -9.11923179e-01 -9.32884613e-01]]

 [[ 1.00000000e+02  1.00012084e+02  1.00083337e+02 ...  9.49948526e+01
    9.52053007e+01  9.42295291e+01]
  [-1.00000000e+00 -7.24072092e-01 -8.82150812e-01 ... -8.34041386e-01
   -5.96687026e-01 -9.32840017e-01]
  [-1.00000000e+00 -9.86807672e-01 -9.38971538e-01 ... -8.48063449e-01
   -8.53824890e-01 -8.25448165e-01]]

 [[ 1.00000000e+02  1.00832513e+02  1.01988589e+02 ...  1.00095731e+02
    1.00045105e+02  1.01762532e+02]
  [-1.00000000e+00 -1.19361800e+00 -1.32742598e+00 ... -6.55483786e-01
   -7.07241939e-01 -5.61944589e-01]
  [-1.00000000e+00 -1.02995358e+00 -1.06194969e+00 ... -1.18013620e+00
   -1.19702704e+00 -1.23141509e+00]]]
X_test type:  <class 'numpy.ndarray'>
first element:  100.0
first element type:  <class 'float'>
---------------------------- TESTING DELTA HEDGING ----------------------------

Test sample:  0
output_Z_Vals[:, i, :]:  [[ 1.19271183e+02 -4.92738716e+01 -4.92570741e+01]
 [ 3.43491950e-02  6.40787412e-02 -3.85063808e-02]
 [-1.95496397e+00 -2.63537053e+00 -7.49182739e-01]
 [ 9.35771478e-02  2.96483564e-01 -5.05486238e-02]
 [ 6.04417184e-01 -3.26156552e-02 -3.83331264e-01]
 [ 7.57175145e-02  1.17192732e-01 -6.73936232e-03]
 [ 7.09444122e-02 -8.31868649e-02  4.95770450e-02]
 [ 5.54064423e-02  2.85916551e-01  2.79111621e-01]
 [-3.36569357e-02 -2.46591932e-01  4.32861554e-02]
 [-1.48292984e+00 -6.11185818e-01 -5.83702220e-02]
 [ 6.81032621e-02 -8.82938891e-02  2.16665837e-02]
 [-2.01743931e-01  4.98117348e-02  2.54160732e-02]
 [-8.35285195e-01 -1.03034595e+00  3.00458311e-01]
 [ 1.17122194e-02 -5.12991472e-02 -1.93704213e-02]
 [-1.63331236e-01 -2.01828633e-01  6.84225920e-02]
 [ 8.33379283e-02  5.11879909e-03  1.62957416e-02]
 [-2.83285298e-01 -2.88612008e-01 -3.03680988e-01]
 [-1.63320183e-01 -2.63994854e-01  3.68559176e-01]
 [ 8.37809207e-02 -2.64557937e-01  2.39616307e-01]
 [ 1.35287591e-01 -1.14990854e+00 -1.85731478e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.27118322 -49.27387164 -49.25707411]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [   7.3268874   -15.90307369 -140.51672192]
init_Out:  [2.48374395]
Stock Position:  7.326887399052493
Bond position:  [-730.20499595]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [3.10631069]
curr_Stock_Price:  100.10988851898092
curr_Factors:  [100.10988852  -1.17358996  -0.98297908]
mat_Sqrt:  [[11.58486412  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00341559  0.02068132 -0.10984799]
Stock Position:  0.0034155887182115564
Bond Position:  [2.76437648]


portfolio before change:  [3.1112209]
curr_Stock_Price:  101.34511751734314
curr_Factors:  [101.34511752  -1.36411082  -0.99377605]
mat_Sqrt:  [[ 9.58927062  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.27591598 -0.85056218 -2.13720982]
Stock Position:  -0.27591598100266823
Bond Position:  [31.07395842]


portfolio before change:  [3.27440371]
curr_Stock_Price:  100.7818541995564
curr_Factors:  [100.7818542   -0.9078488   -0.99630107]
mat_Sqrt:  [[15.01137803  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00957796  0.09568966 -0.14420115]
Stock Position:  0.009577961929705022
Bond Position:  [2.30911895]


portfolio before change:  [3.26844921]
curr_Stock_Price:  100.09988712799074
curr_Factors:  [100.09988713  -0.94471267  -0.99825294]
mat_Sqrt:  [[14.34215284  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.03622276 -0.01052666 -1.0935374 ]
Stock Position:  0.036222761000769044
Bond Position:  [-0.35744508]


portfolio before change:  [3.35526472]
curr_Stock_Price:  102.49906598026915
curr_Factors:  [102.49906598  -0.93714411  -1.04629008]
mat_Sqrt:  [[14.10345063  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00696735  0.03782379 -0.01922552]
Stock Position:  0.006967352651563818
Bond Position:  [2.64111758]


portfolio before change:  [3.36478842]
curr_Stock_Price:  103.77118970830992
curr_Factors:  [103.77118971  -1.00145325  -1.05713934]
mat_Sqrt:  [[13.24467771  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00483846 -0.02684845  0.14142951]
Stock Position:  0.004838459477241379
Bond Position:  [2.86269572]


portfolio before change:  [3.36323426]
curr_Stock_Price:  103.30204790579148
curr_Factors:  [103.30204791  -0.54724602  -1.05659139]
mat_Sqrt:  [[20.77644271  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00821807 0.09227917 0.79622776]
Stock Position:  0.008218073575192018
Bond Position:  [2.51429043]


portfolio before change:  [3.37064996]
curr_Stock_Price:  104.12791651509127
curr_Factors:  [104.12791652  -0.62208812  -1.07285692]
mat_Sqrt:  [[19.11885581  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00393102 -0.0795872   0.12348335]
Stock Position:  -0.003931017333758919
Bond Position:  [3.7799786]


portfolio before change:  [3.37051264]
curr_Stock_Price:  104.40327312323508
curr_Factors:  [104.40327312  -0.38425588  -1.08105856]
mat_Sqrt:  [[24.11771394  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.06715406 -0.19725937 -0.166514  ]
Stock Position:  -0.0671540594686967
Bond Position:  [10.38161625]


portfolio before change:  [3.21250394]
curr_Stock_Price:  106.79485491165173
curr_Factors:  [106.79485491  -0.32287989  -1.01995294]
mat_Sqrt:  [[27.88466557  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00195459 -0.02849673  0.06180873]
Stock Position:  0.0019545875543674914
Bond Position:  [3.00376405]


portfolio before change:  [3.20998795]
curr_Stock_Price:  105.12339143461966
curr_Factors:  [105.12339143  -0.37423302  -1.04498398]
mat_Sqrt:  [[25.4297009   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00732954  0.01607667  0.07250498]
Stock Position:  -0.0073295442938552694
Bond Position:  [3.98049451]


portfolio before change:  [3.20356429]
curr_Stock_Price:  106.13558381803935
curr_Factors:  [106.13558382  -0.49366257  -1.08024865]
mat_Sqrt:  [[21.99480203  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.04475025 -0.33254273  0.85712393]
Stock Position:  -0.04475024979801467
Bond Position:  [7.95315818]


portfolio before change:  [3.16285206]
curr_Stock_Price:  107.08978570091193
curr_Factors:  [107.0897857  -0.6639391  -1.0553488]
mat_Sqrt:  [[19.18981565  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00014138 -0.01655673 -0.05525842]
Stock Position:  -0.0001413846740594771
Bond Position:  [3.17799291]


portfolio before change:  [3.1632347]
curr_Stock_Price:  110.00347801861524
curr_Factors:  [110.00347802  -0.90959766  -1.09958481]
mat_Sqrt:  [[14.75127488  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01291838 -0.06513991  0.19519061]
Stock Position:  -0.012918383802872373
Bond Position:  [4.58430185]


portfolio before change:  [3.16288767]
curr_Stock_Price:  110.119069321277
curr_Factors:  [110.11906932  -1.05287334  -1.08014266]
mat_Sqrt:  [[13.04684352  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00672263 0.00165209 0.04648722]
Stock Position:  0.006722633947617019
Bond Position:  [2.42259748]


portfolio before change:  [3.17133318]
curr_Stock_Price:  111.28524734967499
curr_Factors:  [111.28524735  -1.25131469  -1.10316223]
mat_Sqrt:  [[10.56577264  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.03825433 -0.09314913 -0.86631733]
Stock Position:  -0.038254334413566404
Bond Position:  [7.42847625]


portfolio before change:  [3.19320042]
curr_Stock_Price:  110.76217226042266
curr_Factors:  [110.76217226  -1.59817247  -1.10325503]
mat_Sqrt:  [[ 7.4332101   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01910024 -0.08520397  1.05139674]
Stock Position:  -0.019100237761164443
Bond Position:  [5.30878425]


portfolio before change:  [3.19741841]
curr_Stock_Price:  110.61083258880988
curr_Factors:  [110.61083259  -1.6008834   -1.10910193]
mat_Sqrt:  [[ 7.35979955  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01069183 -0.08538571  0.68355863]
Stock Position:  0.010691830840794057
Bond Position:  [2.0147861]


portfolio before change:  [3.19088335]
curr_Stock_Price:  109.95249607091824
curr_Factors:  [109.95249607  -1.63547221  -1.12712899]
mat_Sqrt:  [[ 6.9410094   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01978801 -0.37113139 -0.52984021]
Stock Position:  -0.019788013166492563
Bond Position:  [5.36662479]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [3.19727517]
Stock Price:  109.69729101893476
PL:  [-6.50001585]
Settle:  Tensor("sub:0", shape=(), dtype=float64)
PL:  Tensor("sub_1:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  1
output_Z_Vals[:, i, :]:  [[ 1.19271183e+02 -4.92738716e+01 -4.92570741e+01]
 [ 1.86965428e-02  3.89309942e-02 -4.57702188e-02]
 [-2.17792030e+00 -2.93268854e+00 -8.35191335e-01]
 [ 9.48044870e-02  2.14360202e-01 -4.55402243e-02]
 [ 4.44168843e-01  1.44611937e-01 -4.51351660e-01]
 [ 2.29135444e-02  7.51696968e-02 -5.52451115e-03]
 [ 5.20106285e-02 -3.54093911e-02  9.27296325e-02]
 [-5.28799947e-02  5.41975579e-02  1.54574899e-01]
 [-5.52366381e-02 -3.02155506e-01  6.20009588e-02]
 [-1.42317087e+00 -5.78062328e-01 -5.63128187e-02]
 [ 2.44972316e-01 -5.80831104e-03  4.30483237e-02]
 [-2.12922934e-01  6.52866361e-03  2.70800260e-02]
 [-7.16317494e-01 -9.89591698e-01  2.51297690e-01]
 [ 5.36091580e-03 -3.69558009e-02 -1.97691167e-02]
 [-1.13694683e-01 -1.15927145e-01  2.08469618e-02]
 [ 1.27952329e-01  1.57932370e-02  3.35882922e-02]
 [-3.51995620e-02 -4.56586089e-02 -6.19361954e-02]
 [-5.61073897e-02 -1.48512691e-01  2.62610251e-01]
 [ 3.73272699e-02 -2.44650818e-02  4.52612062e-02]
 [ 7.46730899e-02 -6.71248272e-01 -3.24624716e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.27118322 -49.27387164 -49.25707411]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [   7.3268874   -15.90307369 -140.51672192]
init_Out:  [2.48374395]
Stock Position:  7.326887399052493
Bond position:  [-730.20499595]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [3.73622805]
curr_Stock_Price:  100.19586191097541
curr_Factors:  [100.19586191  -0.90351112  -1.01343217]
mat_Sqrt:  [[14.73438085  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00117416  0.01256492 -0.13056969]
Stock Position:  0.0011741580529203125
Bond Position:  [3.61858227]


portfolio before change:  [3.73731055]
curr_Stock_Price:  100.34723802976578
curr_Factors:  [100.34723803  -1.02453789  -1.01702892]
mat_Sqrt:  [[13.02759429  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.22621487 -0.94652116 -2.38256841]
Stock Position:  -0.2262148707192547
Bond Position:  [26.43734803]


portfolio before change:  [3.8447228]
curr_Stock_Price:  99.90163473234685
curr_Factors:  [99.90163473 -1.2998699  -1.01566074]
mat_Sqrt:  [[ 9.86166882  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01310779  0.06918446 -0.12991358]
Stock Position:  0.01310779372053152
Bond Position:  [2.53523278]


portfolio before change:  [3.86369512]
curr_Stock_Price:  101.30068268925534
curr_Factors:  [101.30068269  -1.40472506  -1.01779659]
mat_Sqrt:  [[ 8.98513459  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.04246524  0.0466733  -1.28758065]
Stock Position:  0.04246523588371112
Bond Position:  [-0.43806226]


portfolio before change:  [3.86066619]
curr_Stock_Price:  101.23193457519228
curr_Factors:  [101.23193458  -1.3818847   -1.03769844]
mat_Sqrt:  [[ 9.0054606   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00412303  0.02426092 -0.01575989]
Stock Position:  0.00412303267862126
Bond Position:  [3.44328361]


portfolio before change:  [3.86919928]
curr_Stock_Price:  103.09273947742106
curr_Factors:  [103.09273948  -1.01798793  -1.06604672]
mat_Sqrt:  [[12.82753861  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00496674 -0.01142833  0.26453183]
Stock Position:  0.0049667419207219754
Bond Position:  [3.35716425]


portfolio before change:  [3.87667933]
curr_Stock_Price:  104.42976443366983
curr_Factors:  [104.42976443  -1.19266653  -1.03983003]
mat_Sqrt:  [[11.20116933  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00091638  0.01749219  0.44095916]
Stock Position:  -0.0009163771367419241
Bond Position:  [3.97237638]


portfolio before change:  [3.87763983]
curr_Stock_Price:  104.46546340509992
curr_Factors:  [104.46546341  -1.02271894  -1.02528702]
mat_Sqrt:  [[13.47519472  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00773703 -0.09752027  0.17687148]
Stock Position:  -0.007737029545706279
Bond Position:  [4.68589221]


portfolio before change:  [3.88341412]
curr_Stock_Price:  103.87057514967665
curr_Factors:  [103.87057515  -0.58830576  -1.0692798 ]
mat_Sqrt:  [[19.79758773  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.07842684 -0.18656881 -0.1606448 ]
Stock Position:  -0.0784268354429886
Bond Position:  [12.02965463]


portfolio before change:  [3.76535122]
curr_Stock_Price:  105.41431572124239
curr_Factors:  [105.41431572  -0.86480214  -1.07222959]
mat_Sqrt:  [[15.19348502  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01662383 -0.00187462  0.12280489]
Stock Position:  0.016623829328435136
Bond Position:  [2.01296163]


portfolio before change:  [3.73863498]
curr_Stock_Price:  103.77693423428528
curr_Factors:  [103.77693423  -0.79750136  -1.03332131]
mat_Sqrt:  [[16.63353878  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01238838  0.00210712  0.07725178]
Stock Position:  -0.012388379383399789
Bond Position:  [5.02426301]


portfolio before change:  [3.75885814]
curr_Stock_Price:  102.24590768709838
curr_Factors:  [102.24590769  -0.70009703  -1.03787324]
mat_Sqrt:  [[17.98270574  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.04821416 -0.31938935  0.71688236]
Stock Position:  -0.048214164212828245
Bond Position:  [8.68855912]


portfolio before change:  [3.59340637]
curr_Stock_Price:  105.72256615186288
curr_Factors:  [105.72256615  -0.74832953  -1.11939122]
mat_Sqrt:  [[16.33153029  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00038074 -0.01192743 -0.05639579]
Stock Position:  -0.0003807364902134381
Bond Position:  [3.63365881]


portfolio before change:  [3.59445296]
curr_Stock_Price:  105.35994138090614
curr_Factors:  [105.35994138  -0.76826521  -1.10918781]
mat_Sqrt:  [[16.11788443  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00825808 -0.03741533  0.05947058]
Stock Position:  -0.008258084055459428
Bond Position:  [4.46452421]


portfolio before change:  [3.58542624]
curr_Stock_Price:  106.58819173513889
curr_Factors:  [106.58819174  -0.8640963   -1.15845386]
mat_Sqrt:  [[14.10349416  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.0097871  0.00509725 0.09581805]
Stock Position:  0.00978709887679917
Bond Position:  [2.54223706]


portfolio before change:  [3.57147553]
curr_Stock_Price:  105.09782721388689
curr_Factors:  [105.09782721  -0.76352635  -1.11352224]
mat_Sqrt:  [[16.08428992  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00355392 -0.01473625 -0.17668673]
Stock Position:  -0.003553918745246557
Bond Position:  [3.94498467]


portfolio before change:  [3.56952825]
curr_Stock_Price:  105.92329675675064
curr_Factors:  [105.92329676  -0.80853993  -1.09849095]
mat_Sqrt:  [[15.73180309  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00208605 -0.04793226  0.74915395]
Stock Position:  -0.002086049676965325
Bond Position:  [3.79048951]


portfolio before change:  [3.57224635]
curr_Stock_Price:  105.07462771958475
curr_Factors:  [105.07462772  -0.67973926  -1.12860245]
mat_Sqrt:  [[17.22443698  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00241356 -0.00789607  0.12911762]
Stock Position:  0.0024135628367581846
Bond Position:  [3.31864214]


portfolio before change:  [3.57286074]
curr_Stock_Price:  104.98539060797152
curr_Factors:  [104.98539061  -0.83764287  -1.11846258]
mat_Sqrt:  [[14.84578158  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00866297 -0.21664445 -0.92606396]
Stock Position:  -0.008662974856778572
Bond Position:  [4.48234654]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [3.56719044]
Stock Price:  105.76930481113013
PL:  [-2.20211438]
Settle:  Tensor("sub_2:0", shape=(), dtype=float64)
PL:  Tensor("sub_3:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  2
output_Z_Vals[:, i, :]:  [[ 1.19271183e+02 -4.92738716e+01 -4.92570741e+01]
 [ 5.47384521e-02  8.64707770e-02 -4.18467773e-02]
 [-2.14800512e+00 -2.89279588e+00 -8.23651127e-01]
 [ 5.24745365e-02  1.97330823e-01 -7.68197192e-02]
 [ 4.57549286e-01 -7.83119319e-02 -2.58084020e-01]
 [-4.50634401e-02 -6.53073968e-02  1.79713370e-02]
 [-1.43890378e-02  3.32535932e-02 -6.03775189e-03]
 [ 1.18271210e-01  3.01945162e-01  1.65792028e-01]
 [ 8.46361133e-02  1.28651760e-01 -8.02793786e-02]
 [-9.50080410e-01 -3.89631064e-01 -3.23842592e-02]
 [ 1.10334411e-01 -2.68895409e-03 -2.04232681e-01]
 [-1.46524043e-02 -4.17002017e-02  2.88638973e-02]
 [-5.91035983e-01 -1.19977527e+00  2.10798245e-01]
 [ 3.69965378e-02  5.02939103e-02  1.17941100e-01]
 [ 9.18212791e-02  1.25285777e-01 -1.03540385e-01]
 [-7.11709887e-02  6.93897102e-02  1.27865198e-01]
 [ 2.92316749e-02  1.11421682e-01  1.32232104e-01]
 [ 1.13471420e-01 -1.13507145e-02 -2.67052538e-02]
 [-6.66225814e-02 -3.06401862e-01  8.18434156e-02]
 [ 3.27094136e-02 -2.95533036e-01 -2.86630257e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.27118322 -49.27387164 -49.25707411]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [   7.3268874   -15.90307369 -140.51672192]
init_Out:  [2.48374395]
Stock Position:  7.326887399052493
Bond position:  [-730.20499595]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-3.40519366]
curr_Stock_Price:  99.22117493620745
curr_Factors:  [99.22117494 -1.06310254 -1.05569337]
mat_Sqrt:  [[11.92402816  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00535451  0.02790832 -0.11937721]
Stock Position:  0.005354506633491408
Bond Position:  [-3.9364741]


portfolio before change:  [-3.40139716]
curr_Stock_Price:  100.11402061046032
curr_Factors:  [100.11402061  -1.00056397  -1.11755748]
mat_Sqrt:  [[12.03944437  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.2414249  -0.93364585 -2.3496474 ]
Stock Position:  -0.24142490308605166
Bond Position:  [20.76862057]


portfolio before change:  [-3.45689201]
curr_Stock_Price:  100.36539344000582
curr_Factors:  [100.36539344  -0.87600007  -1.13330613]
mat_Sqrt:  [[13.4571594   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00572734  0.06368825 -0.21914528]
Stock Position:  0.005727342622006274
Bond Position:  [-4.03171901]


portfolio before change:  [-3.4648853]
curr_Stock_Price:  99.1457646899402
curr_Factors:  [99.14576469 -0.48207329 -1.13211849]
mat_Sqrt:  [[19.73511157  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01970512 -0.02527507 -0.73624187]
Stock Position:  0.019705120423135748
Bond Position:  [-5.41856453]


portfolio before change:  [-3.48524639]
curr_Stock_Price:  98.18122963025246
curr_Factors:  [98.18122963 -0.4977115  -1.12470775]
mat_Sqrt:  [[19.38298841  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0028234  -0.02107787  0.05126722]
Stock Position:  -0.0028233970789715225
Bond Position:  [-3.2080418]


portfolio before change:  [-3.48627787]
curr_Stock_Price:  98.26246661521309
curr_Factors:  [98.26246662 -0.62344734 -1.11432887]
mat_Sqrt:  [[17.28546405  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00051104  0.01073255 -0.01722403]
Stock Position:  -0.0005110436971167727
Bond Position:  [-3.43606145]


portfolio before change:  [-3.48679615]
curr_Stock_Price:  97.59551919102218
curr_Factors:  [97.59551919 -0.57563871 -1.11849309]
mat_Sqrt:  [[17.93402561  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01191855 0.09745238 0.47295851]
Stock Position:  0.011918554627475061
Bond Position:  [-4.64999368]


portfolio before change:  [-3.47054489]
curr_Stock_Price:  99.05659412214348
curr_Factors:  [99.05659412 -0.78009021 -1.14335259]
mat_Sqrt:  [[14.47247455  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00653033  0.04152218 -0.22901472]
Stock Position:  0.006530333430824281
Bond Position:  [-4.11741748]


portfolio before change:  [-3.47846672]
curr_Stock_Price:  98.0011581201819
curr_Factors:  [98.00115812 -0.43198528 -1.1173987 ]
mat_Sqrt:  [[20.81336469  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.04978647 -0.12575289 -0.09238328]
Stock Position:  -0.04978646857822825
Bond Position:  [1.40066485]


portfolio before change:  [-3.47351166]
curr_Stock_Price:  97.9086660220201
curr_Factors:  [97.90866602 -0.14385491 -1.14705376]
mat_Sqrt:  [[26.92691661  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00252895 -0.00086786 -0.58261899]
Stock Position:  0.002528945655414743
Bond Position:  [-3.72111736]


portfolio before change:  [-3.47415067]
curr_Stock_Price:  98.02388425965066
curr_Factors:  [98.02388426 -0.35501193 -1.15672057]
mat_Sqrt:  [[21.61697031  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00079903 -0.01345868  0.08234066]
Stock Position:  -0.0007990298203749481
Bond Position:  [-3.39582667]


portfolio before change:  [-3.47641849]
curr_Stock_Price:  99.79947285180512
curr_Factors:  [99.79947285 -0.6525588  -1.14456136]
mat_Sqrt:  [[16.54431829  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.04792643 -0.3872258   0.60134872]
Stock Position:  -0.047926427528957774
Bond Position:  [1.30661372]


portfolio before change:  [-3.43051581]
curr_Stock_Price:  98.84851563498327
curr_Factors:  [98.84851563 -0.85348626 -1.10696171]
mat_Sqrt:  [[13.91740978  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00512576 0.01623229 0.33645313]
Stock Position:  0.005125764530654062
Bond Position:  [-3.93719002]


portfolio before change:  [-3.43317309]
curr_Stock_Price:  98.52215261350501
curr_Factors:  [98.52215261 -0.66133625 -1.09529484]
mat_Sqrt:  [[17.00743047  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00565988  0.04043581 -0.2953719 ]
Stock Position:  0.005659881361229509
Bond Position:  [-3.99079679]


portfolio before change:  [-3.43657578]
curr_Stock_Price:  98.09725555781993
curr_Factors:  [98.09725556 -0.45053174 -1.07064472]
mat_Sqrt:  [[21.42980974  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00144222  0.02239543  0.36476382]
Stock Position:  -0.0014422199502509535
Bond Position:  [-3.29509796]


portfolio before change:  [-3.43428018]
curr_Stock_Price:  95.93428730006538
curr_Factors:  [95.9342873  -0.31933354 -1.05382853]
mat_Sqrt:  [[24.30060842  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.0032496  0.03596119 0.37722139]
Stock Position:  0.00324960158500981
Bond Position:  [-3.74602839]


portfolio before change:  [-3.43689857]
curr_Stock_Price:  95.41675928216398
curr_Factors:  [95.41675928 -0.26650303 -1.00378658]
mat_Sqrt:  [[26.78828411  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00394588 -0.00366343 -0.07618266]
Stock Position:  0.003945877153711453
Bond Position:  [-3.81340138]


portfolio before change:  [-3.43976802]
curr_Stock_Price:  94.93119326588413
curr_Factors:  [94.93119327 -0.4779162  -1.04768021]
mat_Sqrt:  [[20.64670904  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00544689 -0.09889078  0.23347648]
Stock Position:  -0.005446891418298274
Bond Position:  [-2.92268812]


portfolio before change:  [-3.43438326]
curr_Stock_Price:  93.80843828045737
curr_Factors:  [93.80843828 -0.13633534 -1.08754676]
mat_Sqrt:  [[27.58777444  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00312182 -0.09538288 -0.81767634]
Stock Position:  -0.0031218237975841764
Bond Position:  [-3.14152984]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-3.43333967]
Stock Price:  93.22254050651321
PL:  [-3.43333967]
Settle:  Tensor("sub_4:0", shape=(), dtype=float64)
PL:  Tensor("sub_5:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  3
output_Z_Vals[:, i, :]:  [[ 1.19271183e+02 -4.92738716e+01 -4.92570741e+01]
 [ 3.57731099e-02  6.63664207e-02 -3.78455926e-02]
 [-2.46115520e+00 -2.78557972e+00 -8.42798565e-01]
 [ 3.86477933e-02  1.32963820e-01 -8.45322621e-02]
 [ 7.52268873e-01 -1.78707105e-01 -2.85644168e-01]
 [-1.33698641e-01 -1.88224032e-01 -9.64700847e-03]
 [-7.00836785e-02  1.28537749e-01 -1.19696650e-01]
 [ 1.24590276e-01  3.20548802e-01  1.83156834e-01]
 [-1.76089773e-01  3.84859619e-01 -9.36568751e-02]
 [-8.67772693e-01 -3.55968209e-01 -2.81913339e-02]
 [ 2.51503600e-01  1.20874276e-02 -9.49057812e-02]
 [-6.03612335e-03 -4.86669121e-02  3.07626020e-02]
 [-6.19609835e-01 -1.27268754e+00  2.19347791e-01]
 [ 2.45641095e-02  3.94695147e-02  9.41143717e-02]
 [ 9.15811160e-02  1.24347087e-01 -1.03618514e-01]
 [-1.86523206e-01  1.08603760e-01  1.33532121e-01]
 [ 3.00200298e-02  1.12754439e-01  1.30745432e-01]
 [ 1.13027983e-01 -1.14821975e-02 -2.54068822e-02]
 [-5.49023642e-02 -1.75071771e-01  2.85285836e-02]
 [ 4.78307561e-02 -3.72301451e-01 -3.93473083e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.27118322 -49.27387164 -49.25707411]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [   7.3268874   -15.90307369 -140.51672192]
init_Out:  [2.48374395]
Stock Position:  7.326887399052493
Bond position:  [-730.20499595]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-0.0568309]
curr_Stock_Price:  99.67817155414403
curr_Factors:  [99.67817155 -0.93734361 -1.01234997]
mat_Sqrt:  [[14.1859655   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00293212  0.02141967 -0.10796294]
Stock Position:  0.0029321162196458846
Bond Position:  [-0.34909889]


portfolio before change:  [-0.06030315]
curr_Stock_Price:  98.52372909734926
curr_Factors:  [98.5237291  -1.10283058 -0.9653311 ]
mat_Sqrt:  [[12.45516932  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.25706554 -0.89904199 -2.40426972]
Stock Position:  -0.25706553874836674
Bond Position:  [25.26675235]


portfolio before change:  [-0.3392749]
curr_Stock_Price:  99.63352090187065
curr_Factors:  [99.6335209  -0.70934622 -0.97563644]
mat_Sqrt:  [[18.47680208  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00262674  0.04291389 -0.24114701]
Stock Position:  0.002626744795144221
Bond Position:  [-0.60098673]


portfolio before change:  [-0.34285136]
curr_Stock_Price:  98.32917095430284
curr_Factors:  [98.32917095 -0.43351246 -0.98085972]
mat_Sqrt:  [[23.90167546  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.02750784 -0.05767747 -0.8148633 ]
Stock Position:  0.0275078442729492
Bond Position:  [-3.04767488]


portfolio before change:  [-0.44048615]
curr_Stock_Price:  94.8075290084786
curr_Factors:  [94.80752901 -0.34489499 -0.93679075]
mat_Sqrt:  [[26.31563061  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00661542 -0.06074905 -0.02752023]
Stock Position:  -0.00661541806657994
Bond Position:  [0.18670529]


portfolio before change:  [-0.44537505]
curr_Stock_Price:  95.55360228146317
curr_Factors:  [95.55360228 -0.4476185  -0.93317923]
mat_Sqrt:  [[24.02006791  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00284258  0.04148538 -0.34146123]
Stock Position:  -0.0028425813392727434
Bond Position:  [-0.17375617]


portfolio before change:  [-0.44292195]
curr_Stock_Price:  94.67533464746523
curr_Factors:  [ 9.46753346e+01 -4.72756034e-02 -9.15301838e-01]
mat_Sqrt:  [[36.15719886  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00628945 0.10345668 0.52249547]
Stock Position:  0.006289446226969212
Bond Position:  [-1.03837738]


portfolio before change:  [-0.43317385]
curr_Stock_Price:  96.2665283204959
curr_Factors:  [96.26652832 -0.27405654 -0.92352889]
mat_Sqrt:  [[29.06501624  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00401336  0.12421291 -0.267177  ]
Stock Position:  -0.0040133561446265955
Bond Position:  [-0.04682199]


portfolio before change:  [-0.44015644]
curr_Stock_Price:  98.00345013536001
curr_Factors:  [98.00345014 -0.73412376 -0.95062625]
mat_Sqrt:  [[18.17873806  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.05204921 -0.11488825 -0.08042203]
Stock Position:  -0.05204920869001563
Bond Position:  [4.66084558]


portfolio before change:  [-0.52735675]
curr_Stock_Price:  99.70118328649653
curr_Factors:  [99.70118329 -0.95799087 -0.94164467]
mat_Sqrt:  [[14.9176042   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01572628  0.0039012  -0.27073978]
Stock Position:  0.01572627692239318
Bond Position:  [-2.09528517]


portfolio before change:  [-0.54956141]
curr_Stock_Price:  98.32255001398953
curr_Factors:  [98.32255001 -0.47042435 -0.9473237 ]
mat_Sqrt:  [[23.81951842  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00040684 -0.01570718  0.08775714]
Stock Position:  -0.00040684388274866675
Bond Position:  [-0.50955948]


portfolio before change:  [-0.55018928]
curr_Stock_Price:  99.55267046185986
curr_Factors:  [99.55267046 -1.1266948  -0.99503136]
mat_Sqrt:  [[11.92886022  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.06996661 -0.41075814  0.62573819]
Stock Position:  -0.06996660998661264
Bond Position:  [6.41517358]


portfolio before change:  [-0.54150764]
curr_Stock_Price:  99.45151289408875
curr_Factors:  [99.45151289 -1.00929116 -1.02084323]
mat_Sqrt:  [[13.05976097  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00396882 0.01273873 0.26848211]
Stock Position:  0.003968817367697978
Bond Position:  [-0.93621253]


portfolio before change:  [-0.54514798]
curr_Stock_Price:  98.59325721347506
curr_Factors:  [98.59325721 -0.70285575 -1.01098681]
mat_Sqrt:  [[17.76375797  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0053937   0.04013285 -0.29559478]
Stock Position:  0.005393696438923294
Bond Position:  [-1.07693008]


portfolio before change:  [-0.5562426]
curr_Stock_Price:  96.58621937956426
curr_Factors:  [96.58621938 -0.81942776 -0.94105101]
mat_Sqrt:  [[16.60920909  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0082543   0.03505171  0.38092997]
Stock Position:  -0.008254301896861377
Bond Position:  [0.24100922]


portfolio before change:  [-0.55021521]
curr_Stock_Price:  95.86330790113944
curr_Factors:  [95.8633079  -0.54681933 -0.93526774]
mat_Sqrt:  [[21.77660512  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.003661   0.03639134 0.37298033]
Stock Position:  0.0036610037458497217
Bond Position:  [-0.90117114]


portfolio before change:  [-0.55473875]
curr_Stock_Price:  94.68925392553267
curr_Factors:  [94.68925393 -0.30447347 -0.9862181 ]
mat_Sqrt:  [[26.04716539  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00405027 -0.00370586 -0.07247876]
Stock Position:  0.004050269180391231
Bond Position:  [-0.93825571]


portfolio before change:  [-0.54338513]
curr_Stock_Price:  97.55035122087187
curr_Factors:  [97.55035122 -0.35648876 -1.00359278]
mat_Sqrt:  [[25.03530762  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00338783 -0.05650417  0.08138411]
Stock Position:  -0.0033878300312541417
Bond Position:  [-0.21290112]


portfolio before change:  [-0.53592383]
curr_Stock_Price:  95.3322582496975
curr_Factors:  [95.33225825 -0.38732055 -0.9860627 ]
mat_Sqrt:  [[24.1427708   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00449337 -0.12015978 -1.12246918]
Stock Position:  -0.004493366434606945
Bond Position:  [-0.10756107]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-0.54670268]
Stock Price:  97.72510714704448
PL:  [-0.54670268]
Settle:  Tensor("sub_6:0", shape=(), dtype=float64)
PL:  Tensor("sub_7:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  4
output_Z_Vals[:, i, :]:  [[ 1.19271183e+02 -4.92738716e+01 -4.92570741e+01]
 [ 9.84454629e-02  1.51770327e-01 -4.69461597e-02]
 [-2.61369570e+00 -2.95523412e+00 -9.01068343e-01]
 [-5.47590478e-02  1.99498326e-02 -1.37097623e-01]
 [ 8.45745248e-01 -1.82873141e-02 -4.97563732e-01]
 [ 6.07924115e-02  9.46408881e-02 -3.68582019e-03]
 [ 1.49865783e-02  2.28650712e-02  1.03745006e-01]
 [ 1.28241785e-01  3.40706254e-01  2.03776564e-01]
 [ 6.65886802e-02  1.15212035e-02 -4.36509562e-02]
 [-1.35829924e+00 -5.49369342e-01 -5.33332098e-02]
 [ 3.63361346e-01  1.16920341e-01  5.96478866e-02]
 [-4.10524015e-02 -3.82917396e-02  3.39219606e-02]
 [-6.57548604e-01 -1.06347433e+00  2.31879471e-01]
 [ 1.63395614e-02  3.23087444e-02  7.83520387e-02]
 [ 9.70836848e-02  1.29373140e-01 -1.04208749e-01]
 [ 2.35709747e-02  4.38887536e-02  8.30086778e-02]
 [ 1.25539909e-01  1.15578973e-01  1.03380930e-01]
 [ 9.86531335e-02 -1.59072547e-02  9.78299014e-03]
 [-4.02662917e-02 -7.83327498e-02 -1.32816820e-03]
 [ 4.04877144e-02 -3.24649702e-01 -3.40122421e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.27118322 -49.27387164 -49.25707411]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [   7.3268874   -15.90307369 -140.51672192]
init_Out:  [2.48374395]
Stock Position:  7.326887399052493
Bond position:  [-730.20499595]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-8.04529506]
curr_Stock_Price:  98.58787717375328
curr_Factors:  [98.58787717 -0.94718819 -1.0309496 ]
mat_Sqrt:  [[13.63732493  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00878784  0.04898366 -0.13392433]
Stock Position:  0.008787838314724388
Bond Position:  [-8.91166938]


portfolio before change:  [-8.05212074]
curr_Stock_Price:  98.0647130558761
curr_Factors:  [98.06471306 -0.83325052 -0.985386  ]
mat_Sqrt:  [[15.910688    0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.21374689 -0.95379771 -2.57049717]
Stock Position:  -0.21374689411537898
Bond Position:  [12.9089071]


portfolio before change:  [-8.21180475]
curr_Stock_Price:  98.82688384059037
curr_Factors:  [98.82688384 -0.31391086 -1.02204057]
mat_Sqrt:  [[25.98237039  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00302789  0.00643878 -0.39110136]
Stock Position:  -0.0030278892647350036
Bond Position:  [-7.91256788]


portfolio before change:  [-8.22082787]
curr_Stock_Price:  101.15349991731735
curr_Factors:  [101.15349992  -0.45872592  -1.04895938]
mat_Sqrt:  [[22.39760125  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.03305924 -0.00590221 -1.41941083]
Stock Position:  0.03305923639882374
Bond Position:  [-11.56488534]


portfolio before change:  [-8.28656414]
curr_Stock_Price:  99.25252781426384
curr_Factors:  [99.25252781 -0.50098902 -1.05583584]
mat_Sqrt:  [[20.92286394  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00379291  0.03054522 -0.01051462]
Stock Position:  0.003792909860349593
Bond Position:  [-8.66302003]


portfolio before change:  [-8.28318932]
curr_Stock_Price:  100.71337000609905
curr_Factors:  [100.71337001  -0.81085886  -1.09923695]
mat_Sqrt:  [[14.91224597  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00273807 0.00737967 0.29595562]
Stock Position:  0.002738068573555516
Bond Position:  [-8.55894944]


portfolio before change:  [-8.28631162]
curr_Stock_Price:  100.35461695536968
curr_Factors:  [100.35461696  -0.69081766  -1.12888349]
mat_Sqrt:  [[16.2648921   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01471783 0.10996247 0.58131782]
Stock Position:  0.01471782740751612
Bond Position:  [-9.76331355]


portfolio before change:  [-8.27474256]
curr_Stock_Price:  101.30653662618104
curr_Factors:  [101.30653663  -0.77489027  -1.10995136]
mat_Sqrt:  [[15.38371229  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00390219  0.00371845 -0.12452403]
Stock Position:  0.0039021934888268167
Bond Position:  [-8.67006027]


portfolio before change:  [-8.27056669]
curr_Stock_Price:  102.93220081149632
curr_Factors:  [102.93220081  -0.69114482  -1.14654713]
mat_Sqrt:  [[16.38520139  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0904063  -0.17730819 -0.1521448 ]
Stock Position:  -0.09040629705491125
Bond Position:  [1.03515243]


portfolio before change:  [-8.19076024]
curr_Stock_Price:  102.05231042789693
curr_Factors:  [102.05231043  -0.85514643  -1.14856271]
mat_Sqrt:  [[13.76014527  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.02902609 0.03773588 0.17015882]
Stock Position:  0.029026087790386387
Bond Position:  [-11.15293956]


portfolio before change:  [-8.21121182]
curr_Stock_Price:  101.44378884989165
curr_Factors:  [101.44378885  -0.92442726  -1.14882018]
mat_Sqrt:  [[12.75926143  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00328737 -0.01235861  0.09676991]
Stock Position:  -0.0032873673039374145
Bond Position:  [-7.87772883]


portfolio before change:  [-8.21208206]
curr_Stock_Price:  101.10934415435695
curr_Factors:  [101.10934415  -0.71111204  -1.16414543]
mat_Sqrt:  [[15.50162834  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.05336841 -0.34323486  0.66148759]
Stock Position:  -0.05336840594690519
Bond Position:  [-2.81603754]


portfolio before change:  [-8.17902141]
curr_Stock_Price:  100.47667113942585
curr_Factors:  [100.47667114  -0.45615717  -1.15298211]
mat_Sqrt:  [[20.10133632  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00193659 0.0104276  0.22351656]
Stock Position:  0.0019365926023479382
Bond Position:  [-8.37360378]


portfolio before change:  [-8.1827989]
curr_Stock_Price:  99.60719184009494
curr_Factors:  [99.60719184 -0.62652829 -1.1417808 ]
mat_Sqrt:  [[16.99510357  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00601469  0.041755   -0.29727855]
Stock Position:  0.006014693843459209
Bond Position:  [-8.78190566]


portfolio before change:  [-8.18257815]
curr_Stock_Price:  100.00895679053124
curr_Factors:  [100.00895679  -0.61031166  -1.14511919]
mat_Sqrt:  [[17.28482408  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00286227 0.01416503 0.23680065]
Stock Position:  0.0028622683208434155
Bond Position:  [-8.46883062]


portfolio before change:  [-8.18266188]
curr_Stock_Price:  100.71949494186173
curr_Factors:  [100.71949494  -0.51434314  -1.13776919]
mat_Sqrt:  [[19.30235369  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00881939 0.03730295 0.29491702]
Stock Position:  0.008819386238790227
Bond Position:  [-9.070946]


portfolio before change:  [-8.19255765]
curr_Stock_Price:  99.85461030080431
curr_Factors:  [99.8546103  -0.17213164 -1.12120231]
mat_Sqrt:  [[27.39556869  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00355543 -0.00513404  0.02790815]
Stock Position:  0.003555429871491159
Bond Position:  [-8.54758371]


portfolio before change:  [-8.19241496]
curr_Stock_Price:  100.49584144512531
curr_Factors:  [ 1.00495841e+02 -2.39804938e-02 -1.15178451e+00]
mat_Sqrt:  [[31.01129053  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00182279 -0.02528179 -0.00378889]
Stock Position:  -0.0018227880076203788
Bond Position:  [-8.00923234]


portfolio before change:  [-8.18989432]
curr_Stock_Price:  98.0143694860086
curr_Factors:  [98.01436949 -0.11223918 -1.15030556]
mat_Sqrt:  [[27.73151121  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00343322 -0.10478024 -0.9702746 ]
Stock Position:  -0.003433218134386477
Bond Position:  [-7.85338961]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-8.1878344]
Stock Price:  96.84243271404314
PL:  [-8.1878344]
Settle:  Tensor("sub_8:0", shape=(), dtype=float64)
PL:  Tensor("sub_9:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  5
output_Z_Vals[:, i, :]:  [[ 1.19271183e+02 -4.92738716e+01 -4.92570741e+01]
 [ 2.41931576e-02  4.14980930e-02 -5.09557558e-02]
 [-2.40723339e+00 -2.95402528e+00 -8.76187313e-01]
 [-3.07564644e-02 -2.21017362e-02 -1.31739287e-01]
 [ 8.90644033e-02 -8.04076428e-02 -5.65485349e-02]
 [-1.40331217e-01 -2.28523743e-01 -2.84483763e-02]
 [-1.49899926e-02  3.76592475e-02 -4.83755096e-02]
 [-3.30259724e-02 -1.48599830e-02 -3.22076471e-02]
 [-8.78553273e-03 -1.82552864e-01  2.17166542e-02]
 [-1.01299621e+00 -4.11847278e-01 -3.56640514e-02]
 [ 2.28438896e-01 -2.64934602e-03 -1.17546549e-01]
 [-9.80419743e-03 -4.55932617e-02  3.51092060e-02]
 [-6.35675664e-01 -1.14086048e+00  2.25696012e-01]
 [ 1.07921105e-02  2.72955835e-02  6.74477084e-02]
 [ 1.16754683e-01  1.22522520e-01 -1.05641744e-01]
 [-3.36566507e-02  5.92922679e-02  1.10103663e-01]
 [ 8.89740539e-02  1.10578832e-01  1.06329536e-01]
 [ 1.15216134e-01 -1.08333916e-02 -3.18137274e-02]
 [-5.95976520e-02 -2.20019612e-01  4.47941126e-02]
 [ 7.49302613e-02 -5.75823682e-01 -5.91000279e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.27118322 -49.27387164 -49.25707411]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [   7.3268874   -15.90307369 -140.51672192]
init_Out:  [2.48374395]
Stock Position:  7.326887399052493
Bond position:  [-730.20499595]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [1.39904433]
curr_Stock_Price:  99.87687465363541
curr_Factors:  [99.87687465 -0.84123139 -1.06893363]
mat_Sqrt:  [[14.78736574  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00150552  0.01339345 -0.14536259]
Stock Position:  0.0015055163038369568
Bond Position:  [1.24867807]


portfolio before change:  [1.3973244]
curr_Stock_Price:  98.52707523223785
curr_Factors:  [98.52707523 -0.8821499  -1.05001863]
mat_Sqrt:  [[14.27004891  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.22348012 -0.95340756 -2.49951852]
Stock Position:  -0.22348012115416246
Bond Position:  [23.41616711]


portfolio before change:  [1.37702868]
curr_Stock_Price:  98.64409005505587
curr_Factors:  [98.64409006 -1.42653678 -1.06558783]
mat_Sqrt:  [[ 8.16122042  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0076164  -0.0071333  -0.37581552]
Stock Position:  -0.007616401541477711
Bond Position:  [2.12834168]


portfolio before change:  [1.38203445]
curr_Stock_Price:  98.05672346494532
curr_Factors:  [98.05672346 -1.13523504 -1.09074536]
mat_Sqrt:  [[10.58635304  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00577237 -0.02595146 -0.16131723]
Stock Position:  0.005772369426211027
Bond Position:  [0.81601482]


portfolio before change:  [1.39081994]
curr_Stock_Price:  99.54336646824285
curr_Factors:  [99.54336647 -1.7137163  -1.11418601]
mat_Sqrt:  [[ 5.88667359  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.03274947 -0.07375572 -0.0811553 ]
Stock Position:  -0.03274946848812107
Bond Position:  [4.65081228]


portfolio before change:  [1.3616468]
curr_Stock_Price:  100.46967120307315
curr_Factors:  [100.4696712   -2.0428837   -1.15715668]
mat_Sqrt:  [[ 4.09519988  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00419453  0.01215447 -0.13800186]
Stock Position:  -0.004194530420185247
Bond Position:  [1.78306989]


portfolio before change:  [1.3623422]
curr_Stock_Price:  100.41017118839322
curr_Factors:  [100.41017119  -1.91315896  -1.13587882]
mat_Sqrt:  [[ 4.7598956   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00895684 -0.00479604 -0.09187945]
Stock Position:  -0.008956837650352656
Bond Position:  [2.2616998]


portfolio before change:  [1.36401197]
curr_Stock_Price:  100.28688234111083
curr_Factors:  [100.28688234  -1.81680915  -1.12392486]
mat_Sqrt:  [[ 5.29784902  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00785528 -0.05891868  0.06195157]
Stock Position:  -0.007855279850022405
Bond Position:  [2.1517935]


portfolio before change:  [1.37008806]
curr_Stock_Price:  99.58186957970398
curr_Factors:  [99.58186958 -1.1302825  -1.11722863]
mat_Sqrt:  [[10.52200723  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.10495565 -0.13292314 -0.10173961]
Stock Position:  -0.10495564720683175
Bond Position:  [11.82176763]


portfolio before change:  [1.35906753]
curr_Stock_Price:  99.71503377487872
curr_Factors:  [99.71503377 -1.3268965  -1.09651533]
mat_Sqrt:  [[ 8.83662159  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.02307488 -0.00085507 -0.33532759]
Stock Position:  0.023074883299102598
Bond Position:  [-0.94184523]


portfolio before change:  [1.39644028]
curr_Stock_Price:  101.34486795804558
curr_Factors:  [101.34486796  -1.13248207  -1.09856039]
mat_Sqrt:  [[10.88610032  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0010972  -0.01471516  0.10015679]
Stock Position:  -0.0010972015683973215
Bond Position:  [1.50763603]


portfolio before change:  [1.3974963]
curr_Stock_Price:  100.72596133979602
curr_Factors:  [100.72596134  -0.79955392  -1.06528372]
mat_Sqrt:  [[15.60460305  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.05270771 -0.36821114  0.6438479 ]
Stock Position:  -0.052707706020232316
Bond Position:  [6.70653066]


portfolio before change:  [1.41257131]
curr_Stock_Price:  100.47176370863939
curr_Factors:  [100.47176371  -0.87018463  -1.04063197]
mat_Sqrt:  [[14.86575326  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00202691 0.00880961 0.19240954]
Stock Position:  0.0020269073096095295
Bond Position:  [1.20892436]


portfolio before change:  [1.41204838]
curr_Stock_Price:  100.06463701332852
curr_Factors:  [100.06463701  -1.10756599  -1.03267446]
mat_Sqrt:  [[11.77025858  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01021222  0.03954397 -0.30136649]
Stock Position:  0.01021221889587391
Bond Position:  [0.3901664]


portfolio before change:  [1.40118204]
curr_Stock_Price:  98.9910319246144
curr_Factors:  [98.99103192 -0.79035192 -1.04084161]
mat_Sqrt:  [[15.86056328  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [5.80779516e-05 1.91364972e-02 3.14095105e-01]
Stock Position:  5.8077951579325794e-05
Bond Position:  [1.39543284]


portfolio before change:  [1.40147128]
curr_Stock_Price:  97.96369574804179
curr_Factors:  [97.96369575 -0.85953787 -1.00895451]
mat_Sqrt:  [[15.12130347  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00881209 0.03568916 0.30332857]
Stock Position:  0.00881209012737848
Bond Position:  [0.53820636]


portfolio before change:  [1.39237391]
curr_Stock_Price:  96.91605130169471
curr_Factors:  [96.9160513  -0.91560062 -1.04666238]
mat_Sqrt:  [[13.62058368  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00781984 -0.00349646 -0.09075571]
Stock Position:  0.007819843123917638
Bond Position:  [0.63450559]


portfolio before change:  [1.39048826]
curr_Stock_Price:  96.65462806768116
curr_Factors:  [96.65462807 -0.87284315 -1.03871995]
mat_Sqrt:  [[14.29030005  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00667344 -0.07101102  0.12778513]
Stock Position:  -0.006673436317305323
Bond Position:  [2.03550677]


portfolio before change:  [1.39131013]
curr_Stock_Price:  96.60773740366783
curr_Factors:  [96.6077374  -0.93987545 -1.04747841]
mat_Sqrt:  [[13.24082641  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01232904 -0.18584629 -1.68595929]
Stock Position:  -0.012329040299291489
Bond Position:  [2.58239081]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [1.3944224]
Stock Price:  96.40767369459327
PL:  [1.3944224]
Settle:  Tensor("sub_10:0", shape=(), dtype=float64)
PL:  Tensor("sub_11:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  6
output_Z_Vals[:, i, :]:  [[ 1.19271183e+02 -4.92738716e+01 -4.92570741e+01]
 [ 7.66517107e-03  1.83800157e-02 -5.32930985e-02]
 [-2.05946230e+00 -2.77472175e+00 -7.89494466e-01]
 [-6.83730754e-02  1.29708038e-01  4.66059744e-02]
 [ 8.60807841e-01 -2.09497574e-02 -5.05137149e-01]
 [ 1.45197115e-03  4.97743055e-03  8.45470130e-03]
 [-3.43881177e-04  2.37230733e-02  6.45209213e-02]
 [ 1.11307512e-01  2.81443694e-01  1.46655772e-01]
 [-7.33495973e-02  2.99767676e-01 -8.10774294e-02]
 [-8.11730487e-01 -3.31517558e-01 -2.53689530e-02]
 [ 9.45572398e-02 -2.56474335e-02 -2.20393173e-01]
 [ 3.59728516e-02  3.19697173e-04  2.30553738e-02]
 [-6.33752641e-01 -1.13148813e+00  2.16791087e-01]
 [ 2.14789075e-01  5.81494040e-02  1.06635263e-01]
 [ 7.33406663e-02  1.27320003e-01 -1.02392891e-01]
 [-3.59217539e-01  1.86763851e-01  8.05826016e-02]
 [-1.55411217e-01  1.23395835e-01  2.15914043e-01]
 [ 1.09897154e-01 -1.24105158e-02 -1.62399016e-02]
 [-1.10961445e-01 -5.61104239e-01  1.72262317e-01]
 [ 5.65745134e-02 -4.16691980e-01 -4.55253824e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.27118322 -49.27387164 -49.25707411]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [   7.3268874   -15.90307369 -140.51672192]
init_Out:  [2.48374395]
Stock Position:  7.326887399052493
Bond position:  [-730.20499595]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [8.27251039]
curr_Stock_Price:  100.81499007431982
curr_Factors:  [100.81499007  -1.07929377  -0.99699706]
mat_Sqrt:  [[12.64164125  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 4.26026862e-05  5.93212456e-03 -1.52030376e-01]
Stock Position:  4.260268618609232e-05
Bond Position:  [8.2682154]


portfolio before change:  [8.27461151]
curr_Stock_Price:  101.60872277925698
curr_Factors:  [101.60872278  -1.18377772  -0.97987988]
mat_Sqrt:  [[11.67525659  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.23871038 -0.89553759 -2.25220796]
Stock Position:  -0.23871037573032813
Bond Position:  [32.52966791]


portfolio before change:  [8.28699076]
curr_Stock_Price:  101.5909363175067
curr_Factors:  [101.59093632  -1.15739002  -0.97779682]
mat_Sqrt:  [[12.01033441  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00269627  0.04186309  0.13295387]
Stock Position:  -0.0026962719913374987
Bond Position:  [8.56090756]


portfolio before change:  [8.29023489]
curr_Stock_Price:  101.18161662783133
curr_Factors:  [101.18161663  -0.63442765  -1.0002438 ]
mat_Sqrt:  [[19.7320781   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.03818254 -0.00676151 -1.44101568]
Stock Position:  0.03818253692622916
Bond Position:  [4.42686408]


portfolio before change:  [8.20614636]
curr_Stock_Price:  98.95035073171756
curr_Factors:  [98.95035073 -0.49850675 -0.96807872]
mat_Sqrt:  [[22.82902477  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.0001837  0.00160646 0.02411891]
Stock Position:  0.00018370445630630774
Bond Position:  [8.18796873]


portfolio before change:  [8.20818019]
curr_Stock_Price:  98.87733003746892
curr_Factors:  [98.87733004 -0.42216122 -0.92661528]
mat_Sqrt:  [[25.66436588  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00068846 0.00765659 0.18406023]
Stock Position:  0.0006884584198594325
Bond Position:  [8.14010726]


portfolio before change:  [8.20894988]
curr_Stock_Price:  97.03902923795142
curr_Factors:  [97.03902924 -0.44137301 -0.95405251]
mat_Sqrt:  [[24.03924604  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00826536 0.09083556 0.4183681 ]
Stock Position:  0.008265356976032237
Bond Position:  [7.40688766]


portfolio before change:  [8.20193315]
curr_Stock_Price:  95.96603520076579
curr_Factors:  [95.9660352  -0.72108092 -0.94390729]
mat_Sqrt:  [[18.15609142  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00158127  0.0967496  -0.23129134]
Stock Position:  -0.001581267525843307
Bond Position:  [8.35368113]


portfolio before change:  [8.20149933]
curr_Stock_Price:  97.56127719170082
curr_Factors:  [97.56127719 -0.95883816 -0.9612503 ]
mat_Sqrt:  [[14.30189719  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.06185051 -0.10699683 -0.07237056]
Stock Position:  -0.061850510443950096
Bond Position:  [14.23571412]


portfolio before change:  [8.17876143]
curr_Stock_Price:  97.98645194130864
curr_Factors:  [97.98645194 -0.76143101 -0.97736687]
mat_Sqrt:  [[17.21930863  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00257469 -0.00827767 -0.62872038]
Stock Position:  0.002574691722534602
Bond Position:  [7.92647652]


portfolio before change:  [8.17727199]
curr_Stock_Price:  96.63821349937383
curr_Factors:  [96.6382135  -0.60279132 -0.98861986]
mat_Sqrt:  [[19.6792162   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00207042 0.00010318 0.06577056]
Stock Position:  0.002070421280075099
Bond Position:  [7.97719018]


portfolio before change:  [8.17842117]
curr_Stock_Price:  96.22990343473498
curr_Factors:  [96.22990343 -0.50147693 -0.97554447]
mat_Sqrt:  [[21.97089772  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.03734323 -0.36518622  0.61844463]
Stock Position:  -0.03734323483372974
Bond Position:  [11.77195705]


portfolio before change:  [8.27603572]
curr_Stock_Price:  93.69474028661354
curr_Factors:  [93.69474029 -0.24474301 -0.98137408]
mat_Sqrt:  [[27.49282225  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00903602 0.01876764 0.30420072]
Stock Position:  0.00903601680697103
Bond Position:  [7.42940847]


portfolio before change:  [8.28733041]
curr_Stock_Price:  94.73912858239898
curr_Factors:  [ 9.47391286e+01  7.61222630e-02 -1.00504647e+00]
mat_Sqrt:  [[37.41990922  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00209591  0.04109235 -0.29209842]
Stock Position:  0.0020959134649912933
Bond Position:  [8.0887654]


portfolio before change:  [8.28280441]
curr_Stock_Price:  91.61474292918518
curr_Factors:  [91.61474293 -0.13308207 -1.00074641]
mat_Sqrt:  [[29.48152314  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01033344  0.06027777  0.22987973]
Stock Position:  -0.010333444149373497
Bond Position:  [9.22950024]


portfolio before change:  [8.30234794]
curr_Stock_Price:  89.94677394968467
curr_Factors:  [89.94677395 -0.39205853 -0.99278657]
mat_Sqrt:  [[22.51930627  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0038256   0.03982583  0.61594267]
Stock Position:  -0.003825600901513206
Bond Position:  [8.6464484]


portfolio before change:  [8.31360233]
curr_Stock_Price:  87.57002058317654
curr_Factors:  [87.57002058 -0.80057898 -0.99217837]
mat_Sqrt:  [[14.5804466   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0071362  -0.00400548 -0.04632792]
Stock Position:  0.007136195098243157
Bond Position:  [7.68868558]


portfolio before change:  [8.32163637]
curr_Stock_Price:  88.42644618169926
curr_Factors:  [88.42644618 -0.89509714 -1.00015378]
mat_Sqrt:  [[13.28878141  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01432287 -0.18109561  0.49141644]
Stock Position:  -0.014322868631100489
Bond Position:  [9.58815674]


portfolio before change:  [8.32298412]
curr_Stock_Price:  88.49972645528916
curr_Factors:  [88.49972646 -0.74127153 -0.95981823]
mat_Sqrt:  [[16.14983282  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00751777 -0.13448676 -1.29871244]
Stock Position:  -0.007517766888770999
Bond Position:  [8.98830443]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [8.3074062]
Stock Price:  90.87081373079971
PL:  [8.3074062]
Settle:  Tensor("sub_12:0", shape=(), dtype=float64)
PL:  Tensor("sub_13:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  7
output_Z_Vals[:, i, :]:  [[ 1.19271183e+02 -4.92738716e+01 -4.92570741e+01]
 [ 2.65377459e-02  5.15287692e-02 -4.21313959e-02]
 [-2.19861020e+00 -2.96027905e+00 -8.43172760e-01]
 [ 1.93920395e-02  1.03873890e-01 -9.26841733e-02]
 [ 7.07830685e-01 -1.28463248e-01 -3.30078634e-01]
 [-1.09851108e-01 -2.01849266e-01  4.79653292e-02]
 [ 3.15980208e-03  2.48125838e-02  6.40720393e-02]
 [ 9.08565454e-02  2.21235042e-01  9.04564705e-02]
 [ 4.55701814e-02  1.00980226e-01 -5.41852973e-02]
 [-7.08465717e-01 -2.78882414e-01 -2.03295294e-02]
 [-3.91104825e-03 -4.27961228e-02 -3.17334691e-01]
 [ 1.53788405e-01  5.21075570e-02  1.76884662e-02]
 [-6.83967152e-01 -9.66787837e-01  2.26362982e-01]
 [ 1.36060233e-01  7.13173437e-02  1.15356887e-01]
 [ 1.11828557e-01  1.37737642e-01 -1.04379374e-01]
 [-2.47574363e-01  1.39132932e-01  1.11804720e-01]
 [-3.81345866e-03  1.12253990e-01  1.43686815e-01]
 [ 1.13602772e-01 -1.13117676e-02 -2.70898475e-02]
 [-6.85041855e-02 -3.45847869e-01  9.57718817e-02]
 [ 6.79027653e-02 -4.95787212e-01 -5.35858856e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.27118322 -49.27387164 -49.25707411]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [   7.3268874   -15.90307369 -140.51672192]
init_Out:  [2.48374395]
Stock Position:  7.326887399052493
Bond position:  [-730.20499595]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [2.18069323]
curr_Stock_Price:  99.9835569129516
curr_Factors:  [99.98355691 -0.93304601 -1.0092528 ]
mat_Sqrt:  [[14.33504051  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00198506  0.01663084 -0.12018915]
Stock Position:  0.00198506426607526
Bond Position:  [1.98221945]


portfolio before change:  [2.18172186]
curr_Stock_Price:  100.2520671126505
curr_Factors:  [100.25206711  -0.99364721  -1.01865203]
mat_Sqrt:  [[13.4017922   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.22198423 -0.95542596 -2.40533719]
Stock Position:  -0.2219842319746933
Bond Position:  [24.43609998]


portfolio before change:  [2.3950644]
curr_Stock_Price:  99.31851993524229
curr_Factors:  [99.31851994 -0.85263546 -0.9941363 ]
mat_Sqrt:  [[15.66705819  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00138355  0.03352515 -0.26440215]
Stock Position:  0.0013835482453057979
Bond Position:  [2.25765244]


portfolio before change:  [2.39550425]
curr_Stock_Price:  99.22843656327424
curr_Factors:  [99.22843656 -0.48748403 -1.01943207]
mat_Sqrt:  [[21.98825684  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.02793451 -0.04146133 -0.94162247]
Stock Position:  0.02793451159228344
Bond Position:  [-0.37639366]


portfolio before change:  [2.35472197]
curr_Stock_Price:  97.77188083409447
curr_Factors:  [97.77188083 -0.48728107 -0.97866588]
mat_Sqrt:  [[22.57154569  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00625843 -0.06514657  0.13683173]
Stock Position:  -0.006258434264534779
Bond Position:  [2.96662086]


portfolio before change:  [2.34353587]
curr_Stock_Price:  99.67776456768013
curr_Factors:  [99.67776457 -0.82269385 -0.94921647]
mat_Sqrt:  [[16.9460084   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00125713 0.00800823 0.18277969]
Stock Position:  0.0012571278908846894
Bond Position:  [2.21822817]


portfolio before change:  [2.34308283]
curr_Stock_Price:  98.87620100089461
curr_Factors:  [98.876201   -0.78809067 -0.91138723]
mat_Sqrt:  [[18.07248591  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00854782 0.0714033  0.25804713]
Stock Position:  0.008547817371414718
Bond Position:  [1.49790712]


portfolio before change:  [2.33477514]
curr_Stock_Price:  97.86047832522783
curr_Factors:  [97.86047833 -0.88884576 -0.93285293]
mat_Sqrt:  [[15.82900608  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00348235  0.03259123 -0.15457557]
Stock Position:  0.0034823510690771783
Bond Position:  [1.9939906]


portfolio before change:  [2.32954264]
curr_Stock_Price:  96.21473356280833
curr_Factors:  [96.21473356 -1.02600895 -0.93858458]
mat_Sqrt:  [[13.4905436   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.05704308 -0.09000891 -0.05799449]
Stock Position:  -0.05704307566820983
Bond Position:  [7.81792696]


portfolio before change:  [2.3755083]
curr_Stock_Price:  95.4431949133922
curr_Factors:  [95.44319491 -0.74544332 -0.93569093]
mat_Sqrt:  [[17.76796298  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00435742 -0.01381239 -0.90526754]
Stock Position:  -0.004357418055072238
Bond Position:  [2.7913942]


portfolio before change:  [2.37676303]
curr_Stock_Price:  95.31541520829366
curr_Factors:  [95.31541521 -0.26700811 -0.94804839]
mat_Sqrt:  [[28.27944013  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00594197 0.01681764 0.05046027]
Stock Position:  0.00594196551805007
Bond Position:  [1.81040212]


portfolio before change:  [2.36706258]
curr_Stock_Price:  93.60670357051012
curr_Factors:  [93.60670357 -0.1849587  -0.9449134 ]
mat_Sqrt:  [[30.24194591  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02761415 -0.31202943  0.64575058]
Stock Position:  -0.027614153682616813
Bond Position:  [4.95193248]


portfolio before change:  [2.31032597]
curr_Stock_Price:  95.7061612457391
curr_Factors:  [95.70616125 -0.28366804 -0.95577362]
mat_Sqrt:  [[27.71132066  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00628497 0.02301757 0.32908109]
Stock Position:  0.006284974736142262
Bond Position:  [1.70881516]


portfolio before change:  [2.30101917]
curr_Stock_Price:  94.15737968408902
curr_Factors:  [94.15737968 -0.44538874 -0.94497749]
mat_Sqrt:  [[23.44369073  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00506054  0.04445463 -0.2977653 ]
Stock Position:  0.0050605421558555935
Bond Position:  [1.82453178]


portfolio before change:  [2.30512443]
curr_Stock_Price:  94.87846244317093
curr_Factors:  [94.87846244 -0.23340473 -0.93377   ]
mat_Sqrt:  [[29.53045196  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00664913  0.04490496  0.31894774]
Stock Position:  -0.006649133900141648
Bond Position:  [2.93598403]


portfolio before change:  [2.30680743]
curr_Stock_Price:  94.73575141535217
curr_Factors:  [94.73575142 -0.36262393 -0.94267127]
mat_Sqrt:  [[25.68215133  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00188575 0.03622982 0.40989849]
Stock Position:  0.0018857547702375583
Bond Position:  [2.12815903]


portfolio before change:  [2.30802263]
curr_Stock_Price:  95.09799368164124
curr_Factors:  [95.09799368 -0.41587838 -0.95843272]
mat_Sqrt:  [[24.06110845  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00439564 -0.00365086 -0.07727979]
Stock Position:  0.004395644332478964
Bond Position:  [1.89000568]


portfolio before change:  [2.30065703]
curr_Stock_Price:  93.31482901423479
curr_Factors:  [93.31482901 -0.52027    -0.93035165]
mat_Sqrt:  [[21.87528332  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00546511 -0.11162192  0.27321052]
Stock Position:  -0.005465105568290893
Bond Position:  [2.81063243]


portfolio before change:  [2.27445855]
curr_Stock_Price:  98.23719122688533
curr_Factors:  [98.23719123 -0.70931054 -0.94589618]
mat_Sqrt:  [[18.76846669  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00760217 -0.16001463 -1.52865616]
Stock Position:  -0.007602171716885853
Bond Position:  [3.02127455]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [2.27558372]
Stock Price:  98.18855292719896
PL:  [2.27558372]
Settle:  Tensor("sub_14:0", shape=(), dtype=float64)
PL:  Tensor("sub_15:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  8
output_Z_Vals[:, i, :]:  [[ 1.19271183e+02 -4.92738716e+01 -4.92570741e+01]
 [ 8.99604888e-02  1.45432570e-01 -3.84393316e-02]
 [-2.81847749e+00 -2.97854891e+00 -9.37448961e-01]
 [-5.89297709e-02  2.28757340e-02 -1.36931890e-01]
 [ 5.79033162e-01 -1.23282316e-01 -2.67075746e-01]
 [ 7.66575977e-02  1.25890334e-01 -1.46791066e-03]
 [-3.73313530e-03  2.57540547e-02  4.58067797e-02]
 [ 1.31325703e-01  3.40378230e-01  2.01665803e-01]
 [ 7.80392742e-02  1.18956017e-01 -7.89659122e-02]
 [-1.07212263e+00 -4.38279620e-01 -3.86282371e-02]
 [ 2.47868192e-01  1.46078236e-02 -9.32508952e-02]
 [ 3.38727369e-02 -5.99409755e-02  3.69138121e-02]
 [-6.57966510e-01 -1.12628945e+00  2.32905140e-01]
 [ 3.06580230e-02  4.47752305e-02  1.05793347e-01]
 [ 8.90501497e-02  1.30231038e-01 -1.03641797e-01]
 [-1.63363957e-02  5.46303097e-02  1.01903217e-01]
 [ 9.27059103e-02  1.10836065e-01  9.77873177e-02]
 [ 1.15216134e-01 -1.08333916e-02 -3.18137274e-02]
 [-5.76865813e-02 -2.09102650e-01  4.30760396e-02]
 [ 8.59155151e-02 -6.58600497e-01 -6.56529911e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.27118322 -49.27387164 -49.25707411]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [   7.3268874   -15.90307369 -140.51672192]
init_Out:  [2.48374395]
Stock Position:  7.326887399052493
Bond position:  [-730.20499595]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-7.68961309]
curr_Stock_Price:  98.63642193108693
curr_Factors:  [98.63642193 -0.87670599 -1.00465149]
mat_Sqrt:  [[15.03052461  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00743822  0.04693816 -0.10965671]
Stock Position:  0.007438222876300691
Bond Position:  [-8.42329278]


portfolio before change:  [-7.70252423]
curr_Stock_Price:  97.183782063586
curr_Factors:  [97.18378206 -0.65084035 -1.01708263]
mat_Sqrt:  [[18.33259953  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.19734393 -0.96132253 -2.67428095]
Stock Position:  -0.1973439286180095
Bond Position:  [11.47610512]


portfolio before change:  [-7.80145364]
curr_Stock_Price:  97.69962663109096
curr_Factors:  [97.69962663 -0.6013168  -1.02797805]
mat_Sqrt:  [[19.15574924  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00429173  0.00738311 -0.39062857]
Stock Position:  -0.004291734310365757
Bond Position:  [-7.3821528]


portfolio before change:  [-7.80854524]
curr_Stock_Price:  98.92193536335652
curr_Factors:  [98.92193536 -0.50680684 -1.05942948]
mat_Sqrt:  [[20.65783532  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.02417251 -0.0397892  -0.76189276]
Stock Position:  0.024172506405717102
Bond Position:  [-10.19973635]


portfolio before change:  [-7.76010269]
curr_Stock_Price:  101.03147235866076
curr_Factors:  [101.03147236  -0.55615488  -1.10359777]
mat_Sqrt:  [[19.21477323  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00531129  0.04063093 -0.00418754]
Stock Position:  0.005311289255378878
Bond Position:  [-8.29671007]


portfolio before change:  [-7.77296637]
curr_Stock_Price:  99.00009289715591
curr_Factors:  [99.0000929  -0.461649   -1.12860348]
mat_Sqrt:  [[20.18355787  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00053876 0.00831209 0.13067399]
Stock Position:  0.0005387632308378079
Bond Position:  [-7.82630398]


portfolio before change:  [-7.77472389]
curr_Stock_Price:  99.37002254497739
curr_Factors:  [99.37002254 -0.59704007 -1.12815352]
mat_Sqrt:  [[17.70163304  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01366936 0.1098566  0.5752964 ]
Stock Position:  0.01366935902939736
Bond Position:  [-9.1330484]


portfolio before change:  [-7.77093089]
curr_Stock_Price:  99.81456060435808
curr_Factors:  [99.8145606  -0.56801128 -1.15222364]
mat_Sqrt:  [[17.86921052  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00482406  0.03839289 -0.22526777]
Stock Position:  0.004824064280898184
Bond Position:  [-8.25244274]


portfolio before change:  [-7.77398853]
curr_Stock_Price:  99.60845393965779
curr_Factors:  [99.60845394 -0.6727896  -1.15349469]
mat_Sqrt:  [[16.03802954  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.07291862 -0.14145414 -0.11019561]
Stock Position:  -0.07291862337150151
Bond Position:  [-0.51067719]


portfolio before change:  [-7.79146911]
curr_Stock_Price:  99.84643014304415
curr_Factors:  [99.84643014 -0.9408387  -1.17035502]
mat_Sqrt:  [[12.0907366   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01917296  0.00471465 -0.26601885]
Stock Position:  0.01917296272702317
Bond Position:  [-9.70582099]


portfolio before change:  [-7.77034115]
curr_Stock_Price:  101.07496857421837
curr_Factors:  [101.07496857  -1.22489829  -1.16108751]
mat_Sqrt:  [[ 9.29871952  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00313724 -0.01934587  0.10530483]
Stock Position:  0.003137242363994438
Bond Position:  [-8.08743782]


portfolio before change:  [-7.77265517]
curr_Stock_Price:  100.98192010213121
curr_Factors:  [100.9819201   -0.99632711  -1.12555639]
mat_Sqrt:  [[12.09821584  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.06945882 -0.36350836  0.66441354]
Stock Position:  -0.06945882174862807
Bond Position:  [-0.75856999]


portfolio before change:  [-7.66409636]
curr_Stock_Price:  99.41626614172836
curr_Factors:  [99.41626614 -0.59755722 -1.12234671]
mat_Sqrt:  [[17.80379817  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00344829 0.01445114 0.30179897]
Stock Position:  0.0034482925832116135
Bond Position:  [-8.00691273]


portfolio before change:  [-7.66652609]
curr_Stock_Price:  99.29221926970952
curr_Factors:  [99.29221927 -0.49841887 -1.10559331]
mat_Sqrt:  [[19.96648332  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00473181  0.04203189 -0.2956612 ]
Stock Position:  0.00473181252465344
Bond Position:  [-8.13635826]


portfolio before change:  [-7.66961045]
curr_Stock_Price:  99.07031396578307
curr_Factors:  [99.07031397 -0.70618637 -1.14846249]
mat_Sqrt:  [[15.5052858   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00100713 0.01763186 0.29070151]
Stock Position:  0.0010071324641973364
Bond Position:  [-7.76938738]


portfolio before change:  [-7.67216526]
curr_Stock_Price:  98.46243163341487
curr_Factors:  [98.46243163 -0.62018017 -1.13313922]
mat_Sqrt:  [[17.05350388  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00793332 0.03577219 0.27896   ]
Stock Position:  0.00793332448732238
Bond Position:  [-8.45329968]


portfolio before change:  [-7.67596094]
curr_Stock_Price:  98.25040263862068
curr_Factors:  [98.25040264 -1.09402694 -1.12947084]
mat_Sqrt:  [[10.63362947  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01001641 -0.00349646 -0.09075571]
Stock Position:  0.01001641329426938
Bond Position:  [-8.66007758]


portfolio before change:  [-7.68725086]
curr_Stock_Price:  97.33943521377861
curr_Factors:  [97.33943521 -1.12225478 -1.11590419]
mat_Sqrt:  [[10.38170611  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00882096 -0.06748759  0.12288395]
Stock Position:  -0.008820960667821438
Bond Position:  [-6.82862353]


portfolio before change:  [-7.67632373]
curr_Stock_Price:  95.90710826679282
curr_Factors:  [95.90710827 -1.17544342 -1.13999406]
mat_Sqrt:  [[ 9.468236    0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0192786  -0.2125624  -1.87289709]
Stock Position:  -0.019278602193623286
Bond Position:  [-5.82736874]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-7.68752845]
Stock Price:  96.41273122021468
PL:  [-7.68752845]
Settle:  Tensor("sub_16:0", shape=(), dtype=float64)
PL:  Tensor("sub_17:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  9
output_Z_Vals[:, i, :]:  [[ 1.19271183e+02 -4.92738716e+01 -4.92570741e+01]
 [ 1.37300416e-01  2.15221237e-01 -4.99846441e-02]
 [-2.71897659e+00 -2.77755214e+00 -8.80770084e-01]
 [-4.73056846e-02  3.41398599e-02 -1.42255351e-01]
 [ 2.01182464e-01  2.94791460e-03 -1.72819467e-03]
 [-1.20286965e-01 -1.15428553e-01 -9.47933532e-02]
 [-9.11657981e-02  1.50453434e-01 -2.01576975e-01]
 [ 8.20020208e-02  1.54441551e-01  2.52089453e-02]
 [-7.28946643e-02  3.22253458e-01 -8.78453791e-02]
 [-7.23646512e-01 -2.77534021e-01 -2.12635137e-02]
 [ 1.02732225e-01 -2.50627084e-02 -1.98610653e-01]
 [-1.76054328e-03 -5.37568510e-02  3.20019262e-02]
 [-5.71467859e-01 -1.28399231e+00  2.03027275e-01]
 [ 2.84058741e-02  4.28143785e-02  1.01477107e-01]
 [ 9.04776650e-02  1.28130814e-01 -1.03769927e-01]
 [-4.51245146e-02  6.23789836e-02  1.15533237e-01]
 [ 8.97731945e-02  7.67287417e-02  5.98423217e-02]
 [ 1.11850486e-01 -1.18412514e-02 -2.23794519e-02]
 [-5.12983765e-02 -1.14287841e-01 -1.42100595e-03]
 [ 6.41372262e-02 -4.55633556e-01 -5.07187331e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.27118322 -49.27387164 -49.25707411]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [   7.3268874   -15.90307369 -140.51672192]
init_Out:  [2.48374395]
Stock Position:  7.326887399052493
Bond position:  [-730.20499595]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-11.75779276]
curr_Stock_Price:  98.08118210638926
curr_Factors:  [98.08118211 -0.74050625 -0.99293451]
mat_Sqrt:  [[17.32853861  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0098698   0.06946236 -0.14259228]
Stock Position:  0.009869799063874536
Bond Position:  [-12.72583432]


portfolio before change:  [-11.76791893]
curr_Stock_Price:  97.37759038659628
curr_Factors:  [97.37759039 -0.90887863 -1.00368391]
mat_Sqrt:  [[14.38280737  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.24096328 -0.8964511  -2.51259189]
Stock Position:  -0.2409632834751873
Bond Position:  [11.69650499]


portfolio before change:  [-11.47757143]
curr_Stock_Price:  96.18478205763451
curr_Factors:  [96.18478206 -0.79029961 -1.00517101]
mat_Sqrt:  [[15.9714146   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00434368  0.01101859 -0.40581492]
Stock Position:  -0.0043436770291895915
Bond Position:  [-11.0597758]


portfolio before change:  [-11.47530692]
curr_Stock_Price:  95.02682433532456
curr_Factors:  [95.02682434 -0.88149444 -0.99492709]
mat_Sqrt:  [[14.55213441  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01384205  0.00095144 -0.00493006]
Stock Position:  0.013842054577404554
Bond Position:  [-12.79067341]


portfolio before change:  [-11.47251404]
curr_Stock_Price:  95.4596323537141
curr_Factors:  [95.45963235 -1.01640126 -1.01677989]
mat_Sqrt:  [[12.49742116  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01305856 -0.03725441 -0.27041905]
Stock Position:  -0.013058560626142836
Bond Position:  [-10.22594864]


portfolio before change:  [-11.46900731]
curr_Stock_Price:  94.99529813512598
curr_Factors:  [94.99529814 -0.76827967 -1.00230002]
mat_Sqrt:  [[16.17145584  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00628276  0.04855864 -0.575043  ]
Stock Position:  -0.0062827582365067546
Bond Position:  [-10.87217482]


portfolio before change:  [-11.47091271]
curr_Stock_Price:  94.86590012951449
curr_Factors:  [94.86590013 -0.78349037 -1.03034515]
mat_Sqrt:  [[15.46576385  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00767327 0.0498458  0.0719141 ]
Stock Position:  0.007673272790117279
Bond Position:  [-12.19884464]


portfolio before change:  [-11.46489619]
curr_Stock_Price:  96.04748469540561
curr_Factors:  [96.0474847  -0.69702953 -0.97728446]
mat_Sqrt:  [[18.00282542  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00139124  0.10400686 -0.25059842]
Stock Position:  -0.0013912435889951655
Bond Position:  [-11.33127074]


portfolio before change:  [-11.46697424]
curr_Stock_Price:  95.50472050227218
curr_Factors:  [95.5047205  -0.68295345 -1.00232211]
mat_Sqrt:  [[17.70593893  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.04431498 -0.08957372 -0.06065889]
Stock Position:  -0.04431497852365147
Bond Position:  [-7.2346846]


portfolio before change:  [-11.59706151]
curr_Stock_Price:  98.39941606249954
curr_Factors:  [98.39941606 -0.89315722 -1.00588859]
mat_Sqrt:  [[14.73151467  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00387435 -0.00808895 -0.56658091]
Stock Position:  0.0038743531976018724
Bond Position:  [-11.9782956]


portfolio before change:  [-11.60047587]
curr_Stock_Price:  98.29116267175718
curr_Factors:  [98.29116267 -1.01703904 -0.98780108]
mat_Sqrt:  [[13.23803333  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00046844 -0.01734995  0.09129259]
Stock Position:  -0.0004684418414465959
Bond Position:  [-11.55443218]


portfolio before change:  [-11.60350576]
curr_Stock_Price:  98.59198958822128
curr_Factors:  [98.59198959 -0.66589004 -0.99776599]
mat_Sqrt:  [[18.67776884  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.04240972 -0.41440674  0.5791803 ]
Stock Position:  -0.042409718755414334
Bond Position:  [-7.42224721]


portfolio before change:  [-11.63849374]
curr_Stock_Price:  99.37322991364906
curr_Factors:  [99.37322991 -0.58205355 -0.99802792]
mat_Sqrt:  [[20.46674332  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00282699 0.01381828 0.28948594]
Stock Position:  0.002826988608988492
Bond Position:  [-11.91942072]


portfolio before change:  [-11.64186569]
curr_Stock_Price:  99.23466369107051
curr_Factors:  [99.23466369 -0.59100122 -1.02642122]
mat_Sqrt:  [[19.68909528  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00484788  0.04135404 -0.29602672]
Stock Position:  0.004847876901799458
Bond Position:  [-12.12294312]


portfolio before change:  [-11.64579603]
curr_Stock_Price:  99.04917511642996
curr_Factors:  [99.04917512 -0.29551197 -0.96932605]
mat_Sqrt:  [[27.96009809  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-3.15032323e-04  2.01327304e-02  3.29584167e-01]
Stock Position:  -0.0003150323231803341
Bond Position:  [-11.61459234]


portfolio before change:  [-11.64964791]
curr_Stock_Price:  102.05797214992374
curr_Factors:  [102.05797215  -0.48085646  -0.97399494]
mat_Sqrt:  [[23.82390777  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00493834 0.02476409 0.17071349]
Stock Position:  0.004938343750499002
Bond Position:  [-12.15364526]


portfolio before change:  [-11.66738863]
curr_Stock_Price:  99.08087513991526
curr_Factors:  [99.08087514 -0.81797496 -0.92534157]
mat_Sqrt:  [[17.33313359  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00604999 -0.00382175 -0.06384235]
Stock Position:  0.006049985932190338
Bond Position:  [-12.26682653]


portfolio before change:  [-11.67422959]
curr_Stock_Price:  98.45709272208735
curr_Factors:  [98.45709272 -0.96656157 -0.9654109 ]
mat_Sqrt:  [[14.26270906  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00525267 -0.03688624 -0.00405373]
Stock Position:  -0.00525267294524455
Bond Position:  [-11.15706668]


portfolio before change:  [-11.66992265]
curr_Stock_Price:  97.10605506705487
curr_Factors:  [97.10605507 -0.61874518 -0.97299092]
mat_Sqrt:  [[19.76806252  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00669756 -0.1470551  -1.44686428]
Stock Position:  -0.006697558960021704
Bond Position:  [-11.01954912]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-11.65077575]
Stock Price:  93.8358890389334
PL:  [-11.65077575]
Settle:  Tensor("sub_18:0", shape=(), dtype=float64)
PL:  Tensor("sub_19:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  10
output_Z_Vals[:, i, :]:  [[ 1.19271183e+02 -4.92738716e+01 -4.92570741e+01]
 [ 3.85990925e-03  1.26395984e-02 -5.47418021e-02]
 [-2.18219453e+00 -2.93838833e+00 -8.36840181e-01]
 [-5.89118508e-02  1.40790583e-01  4.06685177e-02]
 [ 6.24150855e-01  1.20207977e-01 -5.09710122e-01]
 [ 6.68082083e-02  1.04928777e-01 -5.26641261e-03]
 [ 2.05559958e-02  2.37408126e-02  1.11656510e-01]
 [ 5.54847164e-02  1.11125709e-01  2.31424347e-02]
 [-1.35228902e-02 -1.94750646e-01  2.58250849e-02]
 [-1.40461762e+00 -5.29997247e-01 -5.65072456e-02]
 [ 4.80212500e-01  8.49869999e-02  6.61803951e-02]
 [-1.24706349e-01 -2.94679578e-02  3.10820172e-02]
 [-8.10547229e-01 -1.15639249e+00  2.91054595e-01]
 [-2.26962300e-02 -2.03675695e-02 -1.52411398e-02]
 [ 9.33513343e-02  1.09311990e-01 -1.03659832e-01]
 [ 5.55549314e-02 -1.15890540e-03  6.15308838e-03]
 [-3.39180459e-02 -4.44036046e-02 -6.06874342e-02]
 [ 2.20179255e-02 -8.39032051e-02  1.29039070e-01]
 [ 2.76029614e-02 -7.84726587e-02  6.95158997e-02]
 [ 1.34163496e-01 -1.05633435e+00 -5.05163184e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.27118322 -49.27387164 -49.25707411]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [   7.3268874   -15.90307369 -140.51672192]
init_Out:  [2.48374395]
Stock Position:  7.326887399052493
Bond position:  [-730.20499595]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [6.30285022]
curr_Stock_Price:  100.54616375593383
curr_Factors:  [100.54616376  -0.79914674  -1.03158715]
mat_Sqrt:  [[16.11713631  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00029374  0.00407941 -0.15616312]
Stock Position:  -0.00029373500293231297
Bond Position:  [6.33238415]


portfolio before change:  [6.30426156]
curr_Stock_Price:  101.13157327942851
curr_Factors:  [101.13157328  -0.95654983  -1.03370463]
mat_Sqrt:  [[13.82070622  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.21365115 -0.94836076 -2.3872721 ]
Stock Position:  -0.2136511533650959
Bond Position:  [27.91113883]


portfolio before change:  [6.20660601]
curr_Stock_Price:  101.62131653437214
curr_Factors:  [101.62131653  -0.83495427  -1.02625691]
mat_Sqrt:  [[15.80050883  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00138424  0.04543997  0.11601596]
Stock Position:  -0.0013842381443167056
Bond Position:  [6.34727411]


portfolio before change:  [6.20772585]
curr_Stock_Price:  101.95881369516762
curr_Factors:  [101.9588137   -1.09578824  -1.03286059]
mat_Sqrt:  [[12.13289203  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.04488988  0.03879696 -1.4540611 ]
Stock Position:  0.044889879613755845
Bond Position:  [1.63080698]


portfolio before change:  [6.20737254]
curr_Stock_Price:  101.94185981724618
curr_Factors:  [101.94185982  -1.20031448  -1.04946501]
mat_Sqrt:  [[10.74696261  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00810943  0.03386562 -0.01502361]
Stock Position:  0.008109426473351273
Bond Position:  [5.38068253]


portfolio before change:  [6.20593098]
curr_Stock_Price:  101.59819756325562
curr_Factors:  [101.59819756  -1.22559655  -1.04351243]
mat_Sqrt:  [[10.50568779  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00458741 0.00766231 0.31852494]
Stock Position:  0.004587406310597657
Bond Position:  [5.73985877]


portfolio before change:  [6.20681756]
curr_Stock_Price:  101.47861767842525
curr_Factors:  [101.47861768  -1.3434724   -1.08414296]
mat_Sqrt:  [[ 8.95518554  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00925632 0.03586567 0.06601892]
Stock Position:  0.009256322620957824
Bond Position:  [5.26749874]


portfolio before change:  [6.21853521]
curr_Stock_Price:  102.60223978964137
curr_Factors:  [102.60223979  -1.17883147  -1.10790157]
mat_Sqrt:  [[10.42416549  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00460513 -0.0628555   0.07367178]
Stock Position:  -0.004605133718015157
Bond Position:  [6.69103224]


portfolio before change:  [6.2146917]
curr_Stock_Price:  103.80013592614968
curr_Factors:  [103.80013593  -1.55212183  -1.15337311]
mat_Sqrt:  [[ 6.93771407  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.21971752 -0.17105588 -0.16119944]
Stock Position:  -0.21971752288268806
Bond Position:  [29.02140044]


portfolio before change:  [6.13022854]
curr_Stock_Price:  104.2175783831873
curr_Factors:  [104.21757838  -1.71258399  -1.17066847]
mat_Sqrt:  [[ 5.83123232  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.08764347 0.02742944 0.18879425]
Stock Position:  0.08764346662074828
Bond Position:  [-3.00376131]


portfolio before change:  [6.12978276]
curr_Stock_Price:  104.22106134231176
curr_Factors:  [104.22106134  -1.72008953  -1.13027702]
mat_Sqrt:  [[ 6.02638716  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02063871 -0.00951074  0.08866834]
Stock Position:  -0.020638713974192664
Bond Position:  [8.28077144]


portfolio before change:  [6.13316803]
curr_Stock_Price:  104.15735495744399
curr_Factors:  [104.15735496  -1.46809385  -1.15344959]
mat_Sqrt:  [[ 7.5712588   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.13038566 -0.37322407  0.83029775]
Stock Position:  -0.1303856614584576
Bond Position:  [19.71379365]


portfolio before change:  [6.23813248]
curr_Stock_Price:  103.39012811692075
curr_Factors:  [103.39012812  -1.60351994  -1.15928694]
mat_Sqrt:  [[ 6.52540229  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00459203 -0.0065736  -0.04347873]
Stock Position:  -0.004592027595880586
Bond Position:  [6.7129028]


portfolio before change:  [6.24054553]
curr_Stock_Price:  103.23015098736664
curr_Factors:  [103.23015099  -1.81016759  -1.17268976]
mat_Sqrt:  [[ 5.22839118  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01807536  0.03528029 -0.29571265]
Stock Position:  0.018075364501079175
Bond Position:  [4.37462292]


portfolio before change:  [6.2410039]
curr_Stock_Price:  103.1949969733043
curr_Factors:  [103.19499697  -2.19388978  -1.18491388]
mat_Sqrt:  [[ 3.51773285  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01608262 -0.00037404  0.01755305]
Stock Position:  0.016082621149067427
Bond Position:  [4.58135786]


portfolio before change:  [6.24675681]
curr_Stock_Price:  103.48148179318102
curr_Factors:  [103.48148179  -2.13443071  -1.18968806]
mat_Sqrt:  [[ 3.72577135  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01486126 -0.0143312  -0.17312436]
Stock Position:  -0.014861262059447449
Bond Position:  [7.78462223]


portfolio before change:  [6.24394384]
curr_Stock_Price:  103.80173495811309
curr_Factors:  [103.80173496  -2.06766865  -1.17151523]
mat_Sqrt:  [[ 4.06859936  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00767617 -0.02707964  0.36811255]
Stock Position:  0.007676166302293041
Bond Position:  [5.44714446]


portfolio before change:  [6.24083925]
curr_Stock_Price:  103.21986190323062
curr_Factors:  [103.2198619   -1.82773479  -1.13707779]
mat_Sqrt:  [[ 5.3230621   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00484208 -0.02532694  0.19830951]
Stock Position:  0.004842075891430878
Bond Position:  [5.74104084]


portfolio before change:  [6.24206291]
curr_Stock_Price:  103.17612458396329
curr_Factors:  [103.17612458  -1.65424029  -1.15150363]
mat_Sqrt:  [[ 6.23821171  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02958794 -0.34093045 -1.44108995]
Stock Position:  -0.029587943168948118
Bond Position:  [9.29483222]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [6.23009718]
Stock Price:  103.65908231374057
PL:  [2.57101486]
Settle:  Tensor("sub_20:0", shape=(), dtype=float64)
PL:  Tensor("sub_21:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  11
output_Z_Vals[:, i, :]:  [[ 1.19271183e+02 -4.92738716e+01 -4.92570741e+01]
 [-4.87294924e-03 -5.97406502e-03 -6.26901723e-02]
 [-2.29259424e+00 -3.08560918e+00 -8.79428447e-01]
 [ 4.24736730e-02  1.43948696e-01 -8.33190288e-02]
 [ 7.86429610e-01  3.59763917e-02 -5.13322486e-01]
 [ 6.97983553e-02  1.09044813e-01 -5.76076494e-03]
 [ 3.06336711e-02  1.40520563e-02  1.08524655e-01]
 [ 5.15480242e-02  2.56237403e-01  2.37624010e-01]
 [-2.76746489e-02 -2.31188697e-01  3.80980708e-02]
 [-1.18156269e+00 -4.82362823e-01 -4.42177197e-02]
 [ 3.25451395e-01  1.00817206e-01  7.22705367e-02]
 [-1.49945321e-01 -4.88240488e-03  2.95055695e-02]
 [-7.25693876e-01 -1.00237749e+00  2.54921709e-01]
 [-1.47923683e-02 -2.42174937e-02 -1.56868938e-02]
 [-6.09470303e-02 -2.46415567e-02 -2.97105946e-02]
 [ 9.37477192e-02  2.49998256e-02  4.97828035e-02]
 [ 2.83269398e-02  1.65536721e-02 -3.33982788e-05]
 [ 6.77822397e-02 -5.28467355e-02  3.00586455e-02]
 [-1.21280975e-02  6.09956282e-02 -3.36914876e-02]
 [ 5.15495183e-02 -4.33068931e-01 -4.11077302e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.27118322 -49.27387164 -49.25707411]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [   7.3268874   -15.90307369 -140.51672192]
init_Out:  [2.48374395]
Stock Position:  7.326887399052493
Bond position:  [-730.20499595]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [11.91660448]
curr_Stock_Price:  101.31234916991968
curr_Factors:  [101.31234917  -1.09012361  -1.02024822]
mat_Sqrt:  [[12.27833695  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0015384  -0.00192812 -0.17883761]
Stock Position:  -0.001538398731654306
Bond Position:  [12.07246327]


portfolio before change:  [11.91833328]
curr_Stock_Price:  102.15067962653202
curr_Factors:  [102.15067963  -0.71205285  -1.03092466]
mat_Sqrt:  [[17.87622232  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.17352403 -0.99587608 -2.50876457]
Stock Position:  -0.17352403091314794
Bond Position:  [29.64393097]


portfolio before change:  [12.28257345]
curr_Stock_Price:  100.09431742596747
curr_Factors:  [100.09431743  -0.65181669  -1.06048282]
mat_Sqrt:  [[18.06205634  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00303673  0.04645924 -0.237686  ]
Stock Position:  0.0030367335174448663
Bond Position:  [11.97861368]


portfolio before change:  [12.29085281]
curr_Stock_Price:  101.83445420272088
curr_Factors:  [101.8344542   -0.73773423  -1.03532953]
mat_Sqrt:  [[17.29270498  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.03984291  0.01161133 -1.46436617]
Stock Position:  0.039842913354468455
Bond Position:  [8.23347148]


portfolio before change:  [12.29619302]
curr_Stock_Price:  101.91681716529828
curr_Factors:  [101.91681717  -1.21082298  -1.01344978]
mat_Sqrt:  [[11.02189995  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0082455   0.03519406 -0.01643386]
Stock Position:  0.008245504300551074
Bond Position:  [11.45583746]


portfolio before change:  [12.30264709]
curr_Stock_Price:  102.35217671152682
curr_Factors:  [102.35217671  -1.1193242   -0.98593332]
mat_Sqrt:  [[12.46795881  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00446381 0.00453528 0.30959063]
Stock Position:  0.0044638050490364055
Bond Position:  [11.84576693]


portfolio before change:  [12.30799093]
curr_Stock_Price:  102.88580837062871
curr_Factors:  [102.88580837  -0.64149915  -1.0208079 ]
mat_Sqrt:  [[19.51752275  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00780617 0.08270027 0.67787516]
Stock Position:  0.007806168079294549
Bond Position:  [11.50484702]


portfolio before change:  [12.31671219]
curr_Stock_Price:  103.63453487462478
curr_Factors:  [103.63453487  -0.78187529  -1.01523703]
mat_Sqrt:  [[17.18021279  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00390502 -0.07461583  0.10868319]
Stock Position:  -0.003905021941363378
Bond Position:  [12.72140732]


portfolio before change:  [12.32728793]
curr_Stock_Price:  101.74082048156028
curr_Factors:  [101.74082048  -0.92343496  -1.00509434]
mat_Sqrt:  [[14.78923132  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.08716143 -0.15568193 -0.12614085]
Stock Position:  -0.08716142611509113
Bond Position:  [21.19516294]


portfolio before change:  [12.2709762]
curr_Stock_Price:  102.44768353155307
curr_Factors:  [102.44768353  -0.64336812  -0.98089529]
mat_Sqrt:  [[20.18800979  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01787114 0.03253861 0.20616773]
Stock Position:  0.017871141645002243
Bond Position:  [10.44011913]


portfolio before change:  [12.27871411]
curr_Stock_Price:  102.73460175191217
curr_Factors:  [102.73460175  -0.94348913  -0.98706723]
mat_Sqrt:  [[14.90344841  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00972387 -0.00157579  0.08417118]
Stock Position:  -0.009723866226774455
Bond Position:  [13.27769163]


portfolio before change:  [12.28504989]
curr_Stock_Price:  102.4244432227081
curr_Factors:  [102.42444322  -0.76499646  -0.98613878]
mat_Sqrt:  [[17.77850508  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.04940053 -0.32351594  0.72722068]
Stock Position:  -0.04940053426334818
Bond Position:  [17.3448721]


portfolio before change:  [12.23058246]
curr_Stock_Price:  103.61479854259424
curr_Factors:  [103.61479854  -0.77579193  -1.01134041]
mat_Sqrt:  [[17.34922469  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00132212 -0.00781616 -0.04475034]
Stock Position:  -0.0013221234784007547
Bond Position:  [12.36757402]


portfolio before change:  [12.23293064]
curr_Stock_Price:  104.17760297946529
curr_Factors:  [104.17760298  -0.84955526  -0.99856899]
mat_Sqrt:  [[16.4113457   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00438974 -0.00795303 -0.08475606]
Stock Position:  -0.0043897446340534435
Bond Position:  [12.69024371]


portfolio before change:  [12.22899964]
curr_Stock_Price:  105.79591138031171
curr_Factors:  [105.79591138  -0.60229611  -0.9729633 ]
mat_Sqrt:  [[21.89487217  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00497891 0.00806866 0.14201648]
Stock Position:  0.004978912808986366
Bond Position:  [11.70225102]


portfolio before change:  [12.2206811]
curr_Stock_Price:  103.53749338975925
curr_Factors:  [103.53749339  -0.64893928  -0.96767121]
mat_Sqrt:  [[20.55950394  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 1.54182351e-03  5.34267471e-03 -9.52759932e-05]
Stock Position:  0.0015418235143681103
Bond Position:  [12.06104456]


portfolio before change:  [12.22198573]
curr_Stock_Price:  102.42776341022147
curr_Factors:  [102.42776341  -0.77866951  -0.95855071]
mat_Sqrt:  [[18.02820696  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00350177 -0.01705621  0.08574895]
Stock Position:  0.003501770330893698
Bond Position:  [11.86330723]


portfolio before change:  [12.22463884]
curr_Stock_Price:  102.33835438940345
curr_Factors:  [102.33835439  -0.52474207  -0.93865738]
mat_Sqrt:  [[23.68602162  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00027673  0.01968625 -0.09611244]
Stock Position:  -0.0002767312834749045
Bond Position:  [12.25295906]


portfolio before change:  [12.22814601]
curr_Stock_Price:  100.73553594387045
curr_Factors:  [100.73553594  -0.48520742  -0.92327006]
mat_Sqrt:  [[24.63137787  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00490273 -0.1397724  -1.17268912]
Stock Position:  -0.004902734663941806
Bond Position:  [12.72202561]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [12.24314175]
Stock Price:  98.32568993565171
PL:  [12.24314175]
Settle:  Tensor("sub_22:0", shape=(), dtype=float64)
PL:  Tensor("sub_23:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  12
output_Z_Vals[:, i, :]:  [[ 1.19271183e+02 -4.92738716e+01 -4.92570741e+01]
 [ 4.45210395e-02  8.04209538e-02 -3.37859903e-02]
 [-2.45784515e+00 -3.30597553e+00 -9.43176352e-01]
 [ 8.02224069e-02  2.62582112e-01 -5.90905981e-02]
 [ 1.04636789e+00 -5.35881463e-02 -5.64466427e-01]
 [ 7.57175145e-02  1.17192732e-01 -6.73936232e-03]
 [ 3.56337631e-02  2.15168743e-03  1.04532536e-01]
 [-4.46328636e-02  1.45104809e-01  2.73368689e-01]
 [-3.54527358e-02 -2.51215771e-01  4.48435469e-02]
 [-1.77537850e+00 -6.82077034e-01 -7.38908629e-02]
 [ 7.90169104e-02 -1.42755702e-01  6.96083245e-03]
 [-4.01590303e-02  1.51079875e-01  2.01147532e-02]
 [-9.23802295e-01 -1.19068847e+00  3.37853069e-01]
 [ 1.81977419e-02 -5.31392631e-02 -2.96013881e-03]
 [-1.22948906e-01 -1.31942590e-01  2.97169467e-02]
 [ 1.13028154e-01  1.18274513e-02  2.71346611e-02]
 [-1.16439490e-01 -1.25217865e-01 -1.41099672e-01]
 [-7.12869666e-02 -1.65371795e-01  2.76143513e-01]
 [ 5.85221409e-02 -8.10458327e-02  9.53295695e-02]
 [ 7.22816051e-02 -6.87932845e-01 -1.94968886e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.27118322 -49.27387164 -49.25707411]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [   7.3268874   -15.90307369 -140.51672192]
init_Out:  [2.48374395]
Stock Position:  7.326887399052493
Bond position:  [-730.20499595]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [2.18334789]
curr_Stock_Price:  99.98391922982086
curr_Factors:  [99.98391923 -1.33498785 -0.99970599]
mat_Sqrt:  [[ 9.68245537  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00558127  0.02595575 -0.09638203]
Stock Position:  0.005581266265031333
Bond Position:  [1.62531101]


portfolio before change:  [2.18241474]
curr_Stock_Price:  99.7439155847172
curr_Factors:  [99.74391558 -0.6551802  -0.93797854]
mat_Sqrt:  [[20.27619053  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.16399529 -1.06699902 -2.6906196 ]
Stock Position:  -0.16399528524547466
Bond Position:  [18.53994663]


portfolio before change:  [2.02302536]
curr_Stock_Price:  100.74409648923552
curr_Factors:  [100.74409649  -0.50163762  -0.98630226]
mat_Sqrt:  [[22.75178764  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00535166  0.08474801 -0.16856903]
Stock Position:  0.005351664674299629
Bond Position:  [1.48387673]


portfolio before change:  [2.02690295]
curr_Stock_Price:  101.39932794550033
curr_Factors:  [101.39932795  -0.42770346  -0.97278365]
mat_Sqrt:  [[24.99258942  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.03681924 -0.0172955  -1.6102656 ]
Stock Position:  0.03681923519746297
Bond Position:  [-1.70654275]


portfolio before change:  [2.02283992]
curr_Stock_Price:  101.30056587016782
curr_Factors:  [101.30056587  -0.69821054  -0.99376824]
mat_Sqrt:  [[18.65498154  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00526742  0.03782379 -0.01922552]
Stock Position:  0.00526742489456206
Bond Position:  [1.4892468]


portfolio before change:  [2.03041538]
curr_Stock_Price:  102.66804624741275
curr_Factors:  [102.66804625  -0.9492612   -1.03880959]
mat_Sqrt:  [[14.06135352  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00408286 0.00069445 0.29820223]
Stock Position:  0.0040828636381249365
Bond Position:  [1.61123574]


portfolio before change:  [2.03867125]
curr_Stock_Price:  104.5914557346975
curr_Factors:  [104.59145573  -0.72030999  -1.04223283]
mat_Sqrt:  [[17.94872426  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00227246 0.04683238 0.77984478]
Stock Position:  0.002272455744122247
Bond Position:  [1.8009918]


portfolio before change:  [2.03847933]
curr_Stock_Price:  104.3088419102625
curr_Factors:  [104.30884191  -0.52535184  -1.04663203]
mat_Sqrt:  [[21.65794283  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00358198 -0.08107954  0.12792616]
Stock Position:  -0.0035819786876423745
Bond Position:  [2.41211138]


portfolio before change:  [2.03083459]
curr_Stock_Price:  106.61143572768164
curr_Factors:  [106.61143573  -0.30437179  -1.073595  ]
mat_Sqrt:  [[26.87573938  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.07180044 -0.22013942 -0.21079006]
Stock Position:  -0.07180043580815201
Bond Position:  [9.68558214]


portfolio before change:  [1.88277428]
curr_Stock_Price:  108.70727279601932
curr_Factors:  [108.7072728   -0.73093577  -1.05417672]
mat_Sqrt:  [[18.23870919  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00281258 -0.0460742   0.01985732]
Stock Position:  0.0028125838387492563
Bond Position:  [1.57702596]


portfolio before change:  [1.8856048]
curr_Stock_Price:  109.57345619771017
curr_Factors:  [109.5734562   -0.75927877  -1.05239982]
mat_Sqrt:  [[17.90207391  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00029126  0.04876082  0.05738179]
Stock Position:  -0.0002912552589162456
Bond Position:  [1.91751864]


portfolio before change:  [1.88647942]
curr_Stock_Price:  108.21662546792396
curr_Factors:  [108.21662547  -1.1443648   -1.0717545 ]
mat_Sqrt:  [[11.79901095  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.09304904 -0.38429305  0.96380077]
Stock Position:  -0.0930490356730285
Bond Position:  [11.95593206]


portfolio before change:  [1.8915353]
curr_Stock_Price:  108.19441650525015
curr_Factors:  [108.19441651  -1.05448621  -1.0923959 ]
mat_Sqrt:  [[12.64229134  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00053365 -0.01715062 -0.00844445]
Stock Position:  0.0005336453058628621
Bond Position:  [1.83379786]


portfolio before change:  [1.89144908]
curr_Stock_Price:  107.1736535033177
curr_Factors:  [107.1736535   -1.04756077  -1.06548866]
mat_Sqrt:  [[12.95395341  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01110206 -0.04258429  0.08477418]
Stock Position:  -0.011102064645373727
Bond Position:  [3.08129791]


portfolio before change:  [1.88508143]
curr_Stock_Price:  107.8166033176702
curr_Factors:  [107.81660332  -1.03377624  -1.10395935]
mat_Sqrt:  [[12.71390245  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00951567 0.00381729 0.07740764]
Stock Position:  0.009515667016262405
Bond Position:  [0.85913453]


portfolio before change:  [1.87996965]
curr_Stock_Price:  107.2568325537128
curr_Factors:  [107.25683255  -0.80763026  -1.10605636]
mat_Sqrt:  [[15.82418792  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01079369 -0.04041389 -0.40251809]
Stock Position:  -0.010793686858174821
Bond Position:  [3.03766631]


portfolio before change:  [1.88738979]
curr_Stock_Price:  106.63974677384972
curr_Factors:  [106.63974677  -0.96588081  -1.09592456]
mat_Sqrt:  [[13.56714319  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00358777 -0.05337352  0.78776058]
Stock Position:  -0.003587769630876349
Bond Position:  [2.26998864]


portfolio before change:  [1.88717732]
curr_Stock_Price:  106.85716260492633
curr_Factors:  [106.8571626   -0.62470954  -1.11124777]
mat_Sqrt:  [[18.8315885   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00326249 -0.02615743  0.27194873]
Stock Position:  0.0032624861384965244
Bond Position:  [1.53855731]


portfolio before change:  [1.88991853]
curr_Stock_Price:  107.5794721677607
curr_Factors:  [107.57947217  -0.79294501  -1.13580648]
mat_Sqrt:  [[15.63447427  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00690397 -0.22202937 -0.55619196]
Stock Position:  -0.006903970935654503
Bond Position:  [2.63264408]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [1.87980585]
Stock Price:  109.13957871901084
PL:  [-7.25977287]
Settle:  Tensor("sub_24:0", shape=(), dtype=float64)
PL:  Tensor("sub_25:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  13
output_Z_Vals[:, i, :]:  [[ 1.19271183e+02 -4.92738716e+01 -4.92570741e+01]
 [ 3.76639359e-02  6.94042455e-02 -3.69681276e-02]
 [-2.44236007e+00 -3.28532578e+00 -9.37202761e-01]
 [ 4.14908018e-03  8.65051030e-02 -1.03834484e-01]
 [ 6.36391005e-01  1.11786028e-02 -1.71451870e-01]
 [-1.37850420e-01 -2.11616494e-01  4.56280754e-03]
 [-6.93215649e-02  1.31335682e-01 -1.31720789e-01]
 [ 1.28038473e-01  3.30700464e-01  1.92632488e-01]
 [-2.57958948e-01  6.16584341e-01 -1.35549910e-01]
 [-8.07886993e-01 -3.18945212e-01 -2.54069941e-02]
 [-1.24888844e-01 -3.94914575e-02 -3.69638796e-01]
 [ 1.95731885e-01  7.36533384e-02  1.53015172e-02]
 [-6.85147501e-01 -9.24975927e-01  2.25103694e-01]
 [ 3.32877665e-01  1.87673307e-01 -7.76848662e-03]
 [ 5.90815212e-02  1.21155998e-01 -1.01621174e-01]
 [ 5.44236151e-02  3.55843885e-02  6.84011898e-02]
 [ 1.25539909e-01  1.15578973e-01  1.03380930e-01]
 [ 8.24070852e-02 -3.45697762e-02  2.26871183e-02]
 [-2.19300184e-02  5.97873399e-02 -4.64381124e-02]
 [ 5.38104871e-02 -5.24641978e-01 -3.19266618e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.27118322 -49.27387164 -49.25707411]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [   7.3268874   -15.90307369 -140.51672192]
init_Out:  [2.48374395]
Stock Position:  7.326887399052493
Bond position:  [-730.20499595]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-2.11997911]
curr_Stock_Price:  99.39658565087093
curr_Factors:  [99.39658565 -0.77060466 -0.99429013]
mat_Sqrt:  [[17.01717225  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00260237  0.02240012 -0.10545978]
Stock Position:  0.0026023671922012137
Bond Position:  [-2.37864552]


portfolio before change:  [-2.11969179]
curr_Stock_Price:  99.73553044822856
curr_Factors:  [99.73553045 -0.6623971  -0.96017773]
mat_Sqrt:  [[19.68677644  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.16784262 -1.06033434 -2.67357861]
Stock Position:  -0.1678426181862915
Bond Position:  [14.62018077]


portfolio before change:  [-2.05368833]
curr_Stock_Price:  99.36406367948413
curr_Factors:  [99.36406368 -0.5233425  -0.96065387]
mat_Sqrt:  [[22.52879228  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 2.71534818e-05  2.79194019e-02 -2.96210880e-01]
Stock Position:  2.7153481799540394e-05
Bond Position:  [-2.05638641]


portfolio before change:  [-2.05428092]
curr_Stock_Price:  96.47551926128908
curr_Factors:  [96.47551926 -0.20348512 -0.96334384]
mat_Sqrt:  [[30.03791246  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.02009711  0.00360788 -0.48910446]
Stock Position:  0.02009711434222775
Bond Position:  [-3.99316047]


portfolio before change:  [-2.09167308]
curr_Stock_Price:  94.66462535824026
curr_Factors:  [94.66462536 -0.14960389 -0.97387889]
mat_Sqrt:  [[30.77976856  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00585174 -0.06829893  0.01301642]
Stock Position:  -0.005851735895986671
Bond Position:  [-1.53772069]


portfolio before change:  [-2.09168063]
curr_Stock_Price:  94.60021222849069
curr_Factors:  [ 9.46002122e+01  5.82495782e-02 -9.99502591e-01]
mat_Sqrt:  [[36.90720195  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0018804   0.04238841 -0.37576275]
Stock Position:  -0.001880396532083149
Bond Position:  [-1.91379472]


portfolio before change:  [-2.08960669]
curr_Stock_Price:  93.24281290797171
curr_Factors:  [ 9.32428129e+01  5.74246225e-02 -9.76008014e-01]
mat_Sqrt:  [[37.21171348  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00631154 0.10673312 0.54952687]
Stock Position:  0.006311543934417179
Bond Position:  [-2.6781128]


portfolio before change:  [-2.0915309]
curr_Stock_Price:  93.04403481725005
curr_Factors:  [ 9.30440348e+01  4.09693948e-02 -9.75217315e-01]
mat_Sqrt:  [[36.55525507  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00437059  0.19900174 -0.38668616]
Stock Position:  -0.004370594741596264
Bond Position:  [-1.68487313]


portfolio before change:  [-2.10433273]
curr_Stock_Price:  95.87673059092852
curr_Factors:  [ 9.58767306e+01 -7.09432918e-02 -1.00282553e+00]
mat_Sqrt:  [[32.76282485  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02680409 -0.10293912 -0.07247908]
Stock Position:  -0.026804086547626605
Bond Position:  [0.46555545]


portfolio before change:  [-2.00932636]
curr_Stock_Price:  92.3365997398872
curr_Factors:  [92.33659974 -0.16779927 -1.02718822]
mat_Sqrt:  [[27.95100362  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00745598 -0.01274581 -1.0544766 ]
Stock Position:  -0.007455982969081686
Bond Position:  [-1.32086624]


portfolio before change:  [-2.02806245]
curr_Stock_Price:  94.80519853956163
curr_Factors:  [94.80519854 -0.25760206 -1.04245323]
mat_Sqrt:  [[25.8360022   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00827875 0.02377151 0.04365097]
Stock Position:  0.00827874672135562
Bond Position:  [-2.81293067]


portfolio before change:  [-2.04333778]
curr_Stock_Price:  93.04502689342992
curr_Factors:  [ 9.30450269e+01 -5.44972638e-02 -1.02114761e+00]
mat_Sqrt:  [[31.73558691  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02609085 -0.2985347   0.64215818]
Stock Position:  -0.026090846375316192
Bond Position:  [0.38428572]


portfolio before change:  [-2.04418691]
curr_Stock_Price:  93.0812544984506
curr_Factors:  [93.0812545   0.27446746 -0.98464964]
mat_Sqrt:  [[45.75452217  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0080779   0.0605713  -0.02216133]
Stock Position:  0.0080779028049092
Bond Position:  [-2.79608823]


portfolio before change:  [-2.01037683]
curr_Stock_Price:  97.35330226109933
curr_Factors:  [ 9.73533023e+01 -8.21775074e-02 -9.80779287e-01]
mat_Sqrt:  [[33.62903594  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00187543  0.03910293 -0.28989692]
Stock Position:  0.0018754343850386282
Bond Position:  [-2.19295656]


portfolio before change:  [-2.00357456]
curr_Stock_Price:  101.27270500916536
curr_Factors:  [101.27270501  -0.47108779  -0.98779764]
mat_Sqrt:  [[23.54542404  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00321292 0.01148481 0.19512956]
Stock Position:  0.0032129207902283474
Bond Position:  [-2.32895573]


portfolio before change:  [-2.00541902]
curr_Stock_Price:  100.87986832549133
curr_Factors:  [ 1.00879868e+02 -2.03194899e-02 -9.84908526e-01]
mat_Sqrt:  [[36.91811569  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00461115 0.03730295 0.29491702]
Stock Position:  0.004611148464912186
Bond Position:  [-2.47059107]


portfolio before change:  [-2.00403663]
curr_Stock_Price:  101.31362505837967
curr_Factors:  [101.31362506  -0.22586244  -0.9360763 ]
mat_Sqrt:  [[31.69890584  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00252316 -0.01115735  0.06472003]
Stock Position:  0.0025231643093777518
Bond Position:  [-2.25966755]


portfolio before change:  [-2.0033609]
curr_Stock_Price:  101.8053547295696
curr_Factors:  [101.80535473  -0.54534566  -0.9120554 ]
mat_Sqrt:  [[23.70442275  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00081019  0.01929628 -0.13247501]
Stock Position:  -0.0008101913715198279
Bond Position:  [-1.92087908]


portfolio before change:  [-2.00652364]
curr_Stock_Price:  105.11625390367196
curr_Factors:  [105.1162539   -0.71936908  -0.90727676]
mat_Sqrt:  [[20.66457886  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00573211 -0.16932747 -0.91077879]
Stock Position:  -0.005732109736328694
Bond Position:  [-1.40398574]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-2.01463193]
Stock Price:  106.46955049626396
PL:  [-8.48418242]
Settle:  Tensor("sub_26:0", shape=(), dtype=float64)
PL:  Tensor("sub_27:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  14
output_Z_Vals[:, i, :]:  [[ 1.19271183e+02 -4.92738716e+01 -4.92570741e+01]
 [ 3.21373814e-02  6.05252138e-02 -3.95328046e-02]
 [-2.22437499e+00 -2.99463706e+00 -8.53111895e-01]
 [ 4.00820053e-02  1.31170446e-01 -8.06380481e-02]
 [ 7.21414959e-01 -1.05177597e-01 -3.66709289e-01]
 [ 6.53143986e-02  1.01473615e-01 -4.61097817e-03]
 [ 1.59179568e-02  3.71655775e-02  1.09572861e-01]
 [ 6.56341034e-02  2.23891348e-01  1.49509342e-01]
 [-2.96349223e-02 -2.36236023e-01  3.97981003e-02]
 [-1.28553445e+00 -5.05606485e-01 -4.99240829e-02]
 [ 5.06234796e-01  1.26045142e-01  7.89840226e-02]
 [-1.18238029e-01 -2.16599704e-02  3.10385506e-02]
 [-8.00626715e-01 -1.13110256e+00  2.86139021e-01]
 [-2.27915463e-02 -2.60721382e-02 -2.10337586e-02]
 [ 8.08391627e-02  1.19393856e-01 -1.03169795e-01]
 [ 8.32365619e-02  5.09589486e-03  1.62587361e-02]
 [-1.72645052e-02 -2.80945882e-02 -4.44595495e-02]
 [ 2.80055061e-02 -7.59356124e-02  1.27411717e-01]
 [ 2.04232418e-02 -3.57773726e-02  3.89164373e-02]
 [ 1.03589212e-01 -8.40762322e-01 -4.81283566e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.27118322 -49.27387164 -49.25707411]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [   7.3268874   -15.90307369 -140.51672192]
init_Out:  [2.48374395]
Stock Position:  7.326887399052493
Bond position:  [-730.20499595]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [1.94888036]
curr_Stock_Price:  99.9519182568049
curr_Factors:  [99.95191826 -0.99906451 -0.96610659]
mat_Sqrt:  [[14.00645311  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0026004   0.01953443 -0.11277609]
Stock Position:  0.0026004041659321198
Bond Position:  [1.68896498]


portfolio before change:  [1.94960374]
curr_Stock_Price:  100.06770098741744
curr_Factors:  [100.06770099  -0.99107974  -0.98423352]
mat_Sqrt:  [[13.88117638  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.21682553 -0.96651495 -2.43369078]
Stock Position:  -0.2168255321283252
Bond Position:  [23.64683625]


portfolio before change:  [2.09118039]
curr_Stock_Price:  99.44201726793865
curr_Factors:  [99.44201727 -0.86928522 -0.9612546 ]
mat_Sqrt:  [[15.94323997  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00316102  0.04233508 -0.23003791]
Stock Position:  0.0031610192143414558
Bond Position:  [1.77684227]


portfolio before change:  [2.09202122]
curr_Stock_Price:  99.56747098539529
curr_Factors:  [99.56747099 -0.69280926 -0.97933735]
mat_Sqrt:  [[18.70309292  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.03342182 -0.03394592 -1.04611953]
Stock Position:  0.03342182248360488
Bond Position:  [-1.23570512]


portfolio before change:  [2.0887525]
curr_Stock_Price:  99.47891338903459
curr_Factors:  [99.47891339 -0.56482501 -1.03012559]
mat_Sqrt:  [[20.18611724  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00421509  0.03275047 -0.01315384]
Stock Position:  0.0042150949795487
Bond Position:  [1.66943943]


portfolio before change:  [2.09821861]
curr_Stock_Price:  101.62565102739454
curr_Factors:  [101.62565103  -0.54577451  -1.02151965]
mat_Sqrt:  [[21.20001335  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00216372 0.01199514 0.31258087]
Stock Position:  0.0021637163307941347
Bond Position:  [1.87832953]


portfolio before change:  [2.09938003]
curr_Stock_Price:  101.94536469132026
curr_Factors:  [101.94536469  -0.87753867  -1.01450673]
mat_Sqrt:  [[15.36960153  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00922953 0.07226062 0.42650854]
Stock Position:  0.009229530113469778
Bond Position:  [1.15847221]


portfolio before change:  [2.11120782]
curr_Stock_Price:  103.19549772375093
curr_Factors:  [103.19549772  -1.16496736  -0.98071665]
mat_Sqrt:  [[12.07263369  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00577609 -0.07624485  0.1135329 ]
Stock Position:  -0.0057760922013072955
Bond Position:  [2.70727453]


portfolio before change:  [2.11360373]
curr_Stock_Price:  102.89788977634555
curr_Factors:  [102.89788978  -1.20408032  -1.01963894]
mat_Sqrt:  [[11.13416024  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.12564321 -0.16318379 -0.14241951]
Stock Position:  -0.1256432118373401
Bond Position:  [15.0420251]


portfolio before change:  [2.10441182]
curr_Stock_Price:  103.00098243211744
curr_Factors:  [103.00098243  -1.54086739  -0.99848357]
mat_Sqrt:  [[ 8.12859071  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.06742696 0.04068089 0.22531943]
Stock Position:  0.06742696464377018
Bond Position:  [-4.84063178]


portfolio before change:  [2.12737937]
curr_Stock_Price:  103.35956098639488
curr_Factors:  [103.35956099  -1.44723903  -1.03158825]
mat_Sqrt:  [[ 8.66581965  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01342327 -0.00699073  0.08854435]
Stock Position:  -0.013423269758433005
Bond Position:  [3.51480264]


portfolio before change:  [2.12062743]
curr_Stock_Price:  103.92803327878545
curr_Factors:  [103.92803328  -1.36546374  -1.00036146]
mat_Sqrt:  [[ 9.7559121   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.09974507 -0.36506178  0.81627498]
Stock Position:  -0.09974507400271242
Bond Position:  [12.4869368]


portfolio before change:  [2.15848512]
curr_Stock_Price:  103.57978978926737
curr_Factors:  [103.57978979  -1.40302978  -1.04261678]
mat_Sqrt:  [[ 8.9772686   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0036099  -0.00841475 -0.06000346]
Stock Position:  -0.0036098950165826117
Bond Position:  [2.53239729]


portfolio before change:  [2.16168688]
curr_Stock_Price:  102.86825082845938
curr_Factors:  [102.86825083  -1.28796934  -1.03494395]
mat_Sqrt:  [[10.07982365  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00834845  0.0385342  -0.29431471]
Stock Position:  0.00834844817021045
Bond Position:  [1.30289662]


portfolio before change:  [2.1673903]
curr_Stock_Price:  103.51240088873377
curr_Factors:  [103.51240089  -1.82095312  -1.04422687]
mat_Sqrt:  [[ 5.89739916  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01485325 0.00164469 0.04638165]
Stock Position:  0.014853252323808044
Bond Position:  [0.62989449]


portfolio before change:  [2.16610237]
curr_Stock_Price:  103.41508713317421
curr_Factors:  [103.41508713  -1.82943176  -1.03069957]
mat_Sqrt:  [[ 5.92167614  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00541647 -0.00906749 -0.12683072]
Stock Position:  -0.005416465847232536
Bond Position:  [2.72624666]


portfolio before change:  [2.16756847]
curr_Stock_Price:  103.27025995436571
curr_Factors:  [103.27025995  -1.62909391  -1.03878133]
mat_Sqrt:  [[ 7.16690714  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00537373 -0.02450811  0.36347016]
Stock Position:  0.005373729716601724
Bond Position:  [1.612622]


portfolio before change:  [2.16830241]
curr_Stock_Price:  103.33180647228565
curr_Factors:  [103.33180647  -1.49313906  -1.06082186]
mat_Sqrt:  [[ 8.03642485  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00262107 -0.0115471   0.11101776]
Stock Position:  0.002621066098869654
Bond Position:  [1.89746291]


portfolio before change:  [2.16750886]
curr_Stock_Price:  102.84804366770001
curr_Factors:  [102.84804367  -1.29967383  -1.11168161]
mat_Sqrt:  [[ 9.22481517  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01802446 -0.27135487 -1.37296805]
Stock Position:  -0.0180244560206791
Bond Position:  [4.0212889]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [2.18304523]
Stock Price:  102.04186529439127
PL:  [0.14117994]
Settle:  Tensor("sub_28:0", shape=(), dtype=float64)
PL:  Tensor("sub_29:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  15
output_Z_Vals[:, i, :]:  [[ 1.19271183e+02 -4.92738716e+01 -4.92570741e+01]
 [ 2.21222337e-02  4.44347522e-02 -4.41804777e-02]
 [-2.39472585e+00 -3.22180432e+00 -9.18827178e-01]
 [-6.13008748e-03  1.98188865e-01  8.13473362e-03]
 [ 6.85604613e-01 -1.29258253e-02 -4.30961694e-01]
 [ 1.98503420e-02  3.27773851e-02  4.69055975e-03]
 [ 5.49340629e-03  2.47710435e-02  6.85351666e-02]
 [ 8.33071438e-02  1.67602373e-01  3.81573611e-02]
 [-9.44545558e-02  3.41069378e-01 -9.13200798e-02]
 [-7.57105959e-01 -2.97017989e-01 -2.28447274e-02]
 [ 1.17329128e-01 -1.09651014e-02 -1.75191006e-01]
 [-7.56612812e-03 -4.72657528e-02  3.03955897e-02]
 [-6.17606690e-01 -1.19945777e+00  2.14217557e-01]
 [ 6.64979767e-02  7.61629606e-02  1.61240404e-01]
 [ 8.33697847e-02  1.22209113e-01 -1.02790617e-01]
 [-1.05534898e-01  7.96763213e-02  1.33543608e-01]
 [ 5.18319172e-02  1.21361863e-01  1.33907203e-01]
 [ 1.15216134e-01 -1.08333916e-02 -3.18137274e-02]
 [-6.20150235e-02 -2.51592155e-01  5.87707391e-02]
 [ 6.53357499e-02 -4.66551358e-01 -5.15716705e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.27118322 -49.27387164 -49.25707411]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [   7.3268874   -15.90307369 -140.51672192]
init_Out:  [2.48374395]
Stock Position:  7.326887399052493
Bond position:  [-730.20499595]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [0.62450152]
curr_Stock_Price:  99.77116225910827
curr_Factors:  [99.77116226 -0.69821544 -1.02176752]
mat_Sqrt:  [[17.86594202  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00124114  0.01434125 -0.12603461]
Stock Position:  0.0012411401130607526
Bond Position:  [0.50067153]


portfolio before change:  [0.62643095]
curr_Stock_Price:  101.22486118271713
curr_Factors:  [101.22486118  -0.5830786   -1.04267379]
mat_Sqrt:  [[19.91736564  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.16266854 -1.03983287 -2.62115819]
Stock Position:  -0.16266853626155262
Bond Position:  [17.09253095]


portfolio before change:  [0.60608534]
curr_Stock_Price:  101.37620744217222
curr_Factors:  [101.37620744  -0.78408795  -1.0196016 ]
mat_Sqrt:  [[16.69566119  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00215538 0.06396518 0.02320613]
Stock Position:  0.0021553827915505863
Bond Position:  [0.38758081]


portfolio before change:  [0.60447769]
curr_Stock_Price:  100.58536973719391
curr_Factors:  [100.58536974  -0.71189507  -1.03951211]
mat_Sqrt:  [[17.45453729  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.03408835 -0.00417179 -1.22941376]
Stock Position:  0.0340883543564055
Bond Position:  [-2.82431204]


portfolio before change:  [0.56867037]
curr_Stock_Price:  99.55565879762831
curr_Factors:  [99.5556588  -0.79370135 -1.02637353]
mat_Sqrt:  [[16.12937257  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00170487 0.01057886 0.01338086]
Stock Position:  0.0017048681917984912
Bond Position:  [0.3989411]


portfolio before change:  [0.56959043]
curr_Stock_Price:  100.03681599671023
curr_Factors:  [100.036816   -0.901011   -1.0222558]
mat_Sqrt:  [[14.61826055  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00167869 0.00799482 0.19551175]
Stock Position:  0.0016786851339256846
Bond Position:  [0.40166011]


portfolio before change:  [0.56755649]
curr_Stock_Price:  98.76536618649982
curr_Factors:  [98.76536619 -1.0319478  -0.97910502]
mat_Sqrt:  [[13.21951549  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00947899 0.05409343 0.10885233]
Stock Position:  0.009478991391996169
Bond Position:  [-0.36863956]


portfolio before change:  [0.54321518]
curr_Stock_Price:  96.20716733371565
curr_Factors:  [96.20716733 -0.59694628 -1.00589432]
mat_Sqrt:  [[19.36879478  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00224457  0.11007967 -0.26051077]
Stock Position:  -0.002244574028901825
Bond Position:  [0.75915929]


portfolio before change:  [0.54404486]
curr_Stock_Price:  95.92209605929277
curr_Factors:  [95.92209606 -0.52420497 -0.98165592]
mat_Sqrt:  [[21.2780381   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.03865007 -0.09586214 -0.06516965]
Stock Position:  -0.03865007002300005
Bond Position:  [4.25144058]


portfolio before change:  [0.44556428]
curr_Stock_Price:  98.49760425911721
curr_Factors:  [98.49760426 -0.54499424 -0.98279866]
mat_Sqrt:  [[21.37537004  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00371129 -0.00353897 -0.49977118]
Stock Position:  0.0037112887970463366
Bond Position:  [0.08001122]


portfolio before change:  [0.44466138]
curr_Stock_Price:  98.24892895270492
curr_Factors:  [98.24892895 -0.48530048 -0.9697896 ]
mat_Sqrt:  [[22.92927017  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00048016 -0.01525496  0.08671016]
Stock Position:  -0.0004801607574085898
Bond Position:  [0.49183666]


portfolio before change:  [0.44526385]
curr_Stock_Price:  97.25030717469113
curr_Factors:  [97.25030717 -0.65480924 -0.95697124]
mat_Sqrt:  [[19.40455167  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.04219206 -0.38712333  0.61110306]
Stock Position:  -0.04219205984148042
Bond Position:  [4.54845463]


portfolio before change:  [0.45745748]
curr_Stock_Price:  96.98825850092699
curr_Factors:  [96.9882585  -0.82712752 -0.9530524 ]
mat_Sqrt:  [[16.3529777   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00702977 0.02458149 0.45997399]
Stock Position:  0.007029773888859371
Bond Position:  [-0.22434805]


portfolio before change:  [0.46175723]
curr_Stock_Price:  97.60788621497265
curr_Factors:  [97.60788621 -0.64151565 -0.98719506]
mat_Sqrt:  [[19.1489443   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00456075  0.03944282 -0.29323302]
Stock Position:  0.004560751090806485
Bond Position:  [0.01659195]


portfolio before change:  [0.46212674]
curr_Stock_Price:  97.68799679406136
curr_Factors:  [97.68799679 -0.66335723 -1.03570203]
mat_Sqrt:  [[17.86278379  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00347155  0.02571542  0.38096274]
Stock Position:  -0.003471550850285646
Bond Position:  [0.80125559]


portfolio before change:  [0.46512813]
curr_Stock_Price:  96.88113884620763
curr_Factors:  [96.88113885 -1.05052609 -1.06563531]
mat_Sqrt:  [[11.67352499  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00890378 0.03916937 0.38199998]
Stock Position:  0.008903779891953081
Bond Position:  [-0.39748021]


portfolio before change:  [0.46061782]
curr_Stock_Price:  96.38573956357074
curr_Factors:  [96.38573956 -1.39844238 -1.05921824]
mat_Sqrt:  [[ 8.25399761  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01290415 -0.00349646 -0.09075571]
Stock Position:  0.012904150520245641
Bond Position:  [-0.78315827]


portfolio before change:  [0.4583816]
curr_Stock_Price:  96.22761969527892
curr_Factors:  [96.2276197  -1.01892571 -1.08457703]
mat_Sqrt:  [[11.74248759  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00863314 -0.08120102  0.16765656]
Stock Position:  -0.008633139230156494
Bond Position:  [1.28912804]


portfolio before change:  [0.45794415]
curr_Stock_Price:  96.31562664539491
curr_Factors:  [96.31562665 -0.64038296 -1.05871559]
mat_Sqrt:  [[17.61114648  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00767519 -0.1505788  -1.47119621]
Stock Position:  -0.007675189065426408
Bond Position:  [1.19718479]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [0.45697611]
Stock Price:  96.48075212158187
PL:  [0.45697611]
Settle:  Tensor("sub_30:0", shape=(), dtype=float64)
PL:  Tensor("sub_31:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  16
output_Z_Vals[:, i, :]:  [[ 1.19271183e+02 -4.92738716e+01 -4.92570741e+01]
 [ 4.71153981e-03  1.30707056e-02 -5.51431374e-02]
 [-1.88918059e+00 -2.54764670e+00 -7.23805859e-01]
 [ 9.81549947e-02  2.80826610e-01 -4.77204575e-02]
 [ 7.05737419e-01 -2.21878395e-02 -4.39214894e-01]
 [ 7.08184381e-02  1.10448991e-01 -5.92941226e-03]
 [ 1.30166613e-02  2.66173690e-02  7.06321393e-02]
 [-2.31276051e-02 -2.78554626e-02 -2.40557087e-02]
 [-8.12194208e-04 -1.62023055e-01  1.48018478e-02]
 [-1.12008069e+00 -4.41736696e-01 -4.14147752e-02]
 [ 4.39505435e-01  1.28428942e-01  5.89581836e-02]
 [-6.58776715e-02 -3.08565828e-02  3.29214760e-02]
 [-7.42854512e-01 -1.04253491e+00  2.61784403e-01]
 [-2.04304113e-02 -1.48947023e-02 -8.73864709e-03]
 [ 1.03374906e-01  1.22029231e-01 -1.05077279e-01]
 [ 1.15371339e-01  1.91795643e-02  3.95448867e-02]
 [-1.20192959e-02 -2.29578906e-02 -3.93484050e-02]
 [-6.71123552e-04 -1.00518988e-01  1.74026467e-01]
 [ 4.33050993e-02 -4.00215092e-02  5.90780980e-02]
 [ 8.57846384e-02 -7.42010783e-01 -3.81068243e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.27118322 -49.27387164 -49.25707411]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [   7.3268874   -15.90307369 -140.51672192]
init_Out:  [2.48374395]
Stock Position:  7.326887399052493
Bond position:  [-730.20499595]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [8.45356945]
curr_Stock_Price:  100.83970166822571
curr_Factors:  [100.83970167  -1.04284199  -0.99201783]
mat_Sqrt:  [[13.17962835  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00029413  0.00421855 -0.15730802]
Stock Position:  -0.0002941250895842965
Bond Position:  [8.48322894]


portfolio before change:  [8.45549647]
curr_Stock_Price:  101.49947583301582
curr_Factors:  [101.49947583  -1.46189589  -0.99901586]
mat_Sqrt:  [[ 8.66370001  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.29513522 -0.82224944 -2.06481665]
Stock Position:  -0.29513522400364645
Bond Position:  [38.41156701]


portfolio before change:  [8.74224526]
curr_Stock_Price:  100.56043271887222
curr_Factors:  [100.56043272  -1.1061373   -0.94986649]
mat_Sqrt:  [[12.86814752  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01132545  0.0906364  -0.13613318]
Stock Position:  0.011325452133702863
Bond Position:  [7.60335289]


portfolio before change:  [8.74386393]
curr_Stock_Price:  100.5354969944495
curr_Factors:  [100.53549699  -1.10330512  -0.93281873]
mat_Sqrt:  [[13.12327049  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.04660073 -0.00716109 -1.25295784]
Stock Position:  0.04660072967595314
Bond Position:  [4.05883641]


portfolio before change:  [8.81257564]
curr_Stock_Price:  101.98819677613207
curr_Factors:  [101.98819678  -1.25771935  -0.95597448]
mat_Sqrt:  [[11.14692038  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00826716  0.03564726 -0.01691496]
Stock Position:  0.008267163004180213
Bond Position:  [7.96942259]


portfolio before change:  [8.81120753]
curr_Stock_Price:  101.5816835385601
curr_Factors:  [101.58168354  -1.74394101  -0.9643665 ]
mat_Sqrt:  [[ 6.77036988  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00485463 0.00859072 0.20149383]
Stock Position:  0.0048546290110180685
Bond Position:  [8.31806614]


portfolio before change:  [8.81275534]
curr_Stock_Price:  101.47210546823587
curr_Factors:  [101.47210547  -1.59187336  -0.94420824]
mat_Sqrt:  [[ 8.03415911  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00419757 -0.00899031 -0.06862424]
Stock Position:  -0.004197567920453093
Bond Position:  [9.2386914]


portfolio before change:  [8.81489361]
curr_Stock_Price:  101.51300872849248
curr_Factors:  [101.51300873  -1.53455382  -0.95682751]
mat_Sqrt:  [[ 8.40482232  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00367213 -0.05229272  0.04222555]
Stock Position:  -0.003672129644610783
Bond Position:  [9.18766254]


portfolio before change:  [8.81711898]
curr_Stock_Price:  101.53257039784178
curr_Factors:  [101.5325704   -1.43300065  -0.95585931]
mat_Sqrt:  [[ 9.3140097   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.13084629 -0.14256991 -0.11814483]
Stock Position:  -0.13084628563898468
Bond Position:  [22.10227869]


portfolio before change:  [8.77384299]
curr_Stock_Price:  101.90554429843608
curr_Factors:  [101.9055443   -1.06308351  -0.93327838]
mat_Sqrt:  [[13.84168171  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.03451572 0.04145026 0.16819129]
Stock Position:  0.03451572446063473
Bond Position:  [5.2564993]


portfolio before change:  [8.76472312]
curr_Stock_Price:  101.60324258767444
curr_Factors:  [101.60324259  -0.96246658  -0.93388244]
mat_Sqrt:  [[15.25224085  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00429158 -0.00995892  0.09391581]
Stock Position:  -0.004291577715376156
Bond Position:  [9.20076133]


portfolio before change:  [8.76228924]
curr_Stock_Price:  102.70641701700717
curr_Factors:  [102.70641702  -0.96875299  -0.89426349]
mat_Sqrt:  [[15.94042147  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.05659979 -0.33647669  0.74679803]
Stock Position:  -0.0565997921048881
Bond Position:  [14.57545109]


portfolio before change:  [8.7614409]
curr_Stock_Price:  102.78579284946892
curr_Factors:  [102.78579285  -1.30261617  -0.8777855 ]
mat_Sqrt:  [[11.61439723  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00217442 -0.00480724 -0.02492893]
Stock Position:  -0.002174417494725348
Bond Position:  [8.98494013]


portfolio before change:  [8.76516901]
curr_Stock_Price:  102.10441764680894
curr_Factors:  [102.10441765  -1.26570775  -0.8473906 ]
mat_Sqrt:  [[12.34063701  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00865719  0.03938477 -0.29975623]
Stock Position:  0.008657187523636109
Bond Position:  [7.88123192]


portfolio before change:  [8.77234402]
curr_Stock_Price:  102.70558865919463
curr_Factors:  [102.70558866  -1.25791356  -0.87941577]
mat_Sqrt:  [[12.1161249   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01051148 0.00619018 0.11281055]
Stock Position:  0.010511481038032788
Bond Position:  [7.69275617]


portfolio before change:  [8.78660125]
curr_Stock_Price:  103.87895409062521
curr_Factors:  [103.87895409  -1.33254904  -0.86559038]
mat_Sqrt:  [[11.53155171  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0021452  -0.00740963 -0.11225005]
Stock Position:  -0.0021452026488703985
Bond Position:  [9.00944266]


portfolio before change:  [8.78857486]
curr_Stock_Price:  104.00902954371584
curr_Factors:  [104.00902954  -1.39229878  -0.88674819]
mat_Sqrt:  [[10.64862469  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00134604 -0.03244236  0.49644907]
Stock Position:  0.0013460449664215335
Bond Position:  [8.64857403]


portfolio before change:  [8.79209943]
curr_Stock_Price:  105.02100099455116
curr_Factors:  [105.02100099  -1.37354441  -0.87494226]
mat_Sqrt:  [[11.085896    0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00425721 -0.01291689  0.16853337]
Stock Position:  0.0042572119741926175
Bond Position:  [8.34500277]


portfolio before change:  [8.79423561]
curr_Stock_Price:  105.03266845794107
curr_Factors:  [105.03266846  -1.15424888  -0.90628463]
mat_Sqrt:  [[13.37969042  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01072244 -0.23948295 -1.08708163]
Stock Position:  -0.01072243850802065
Bond Position:  [9.92044194]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [8.78614257]
Stock Price:  106.01877487025865
PL:  [2.7673677]
Settle:  Tensor("sub_32:0", shape=(), dtype=float64)
PL:  Tensor("sub_33:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  17
output_Z_Vals[:, i, :]:  [[ 1.19271183e+02 -4.92738716e+01 -4.92570741e+01]
 [ 5.37298829e-02  9.52159971e-02 -2.95124943e-02]
 [-2.46834323e+00 -3.41303340e+00 -9.76319926e-01]
 [-5.14552663e-02 -4.97097756e-03 -1.31570159e-01]
 [ 7.55795038e-01 -1.79021047e-01 -2.87156048e-01]
 [-1.45829460e-01 -2.55703434e-01  4.41899776e-02]
 [-4.13550722e-02  7.67191711e-02 -5.80516195e-02]
 [ 1.00176129e-01  2.48672355e-01  1.16066707e-01]
 [ 4.42438560e-02  1.85317197e-01 -8.25095049e-02]
 [-8.30504869e-01 -3.40718343e-01 -2.62929993e-02]
 [ 3.23237676e-02 -4.27032013e-02 -3.00247950e-01]
 [ 2.28299345e-01  9.48509231e-02  1.27636134e-02]
 [-6.84843478e-01 -9.20511499e-01  2.23686289e-01]
 [ 9.93049765e-02  7.32433327e-02  1.37058373e-01]
 [ 1.22060950e-01  1.32757608e-01 -1.04787251e-01]
 [-1.98284436e-01  1.08159213e-01  1.42719175e-01]
 [ 5.96021582e-02  1.23683959e-01  1.30889988e-01]
 [ 1.15216134e-01 -1.08333916e-02 -3.18137274e-02]
 [-5.13300561e-02 -1.02874256e-01 -9.09687332e-03]
 [ 1.03416881e-01 -7.91604721e-01 -6.75065881e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.27118322 -49.27387164 -49.25707411]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [   7.3268874   -15.90307369 -140.51672192]
init_Out:  [2.48374395]
Stock Position:  7.326887399052493
Bond position:  [-730.20499595]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-3.24880887]
curr_Stock_Price:  99.24251889705424
curr_Factors:  [99.2425189  -1.02757133 -0.98980414]
mat_Sqrt:  [[13.19965997  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00508661  0.03073083 -0.08419093]
Stock Position:  0.005086612415399575
Bond Position:  [-3.7536171]


portfolio before change:  [-3.25071002]
curr_Stock_Price:  99.0532714145173
curr_Factors:  [99.05327141 -0.48067384 -1.00756826]
mat_Sqrt:  [[22.3631764   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.15044    -1.10155179 -2.78516899]
Stock Position:  -0.15043999842097436
Bond Position:  [11.65086398]


portfolio before change:  [-3.1425135]
curr_Stock_Price:  98.35343469335456
curr_Factors:  [98.35343469 -0.85833176 -0.98402373]
mat_Sqrt:  [[15.58348929  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00509043 -0.00160438 -0.37533304]
Stock Position:  -0.005090426646696317
Bond Position:  [-2.64185256]


portfolio before change:  [-3.14284961]
curr_Stock_Price:  98.28969919047418
curr_Factors:  [98.28969919 -0.46743647 -0.97080262]
mat_Sqrt:  [[23.32860147  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.02831876 -0.05777879 -0.81917628]
Stock Position:  0.02831875874369471
Bond Position:  [-5.92629188]


portfolio before change:  [-3.19640181]
curr_Stock_Price:  96.45097300565475
curr_Factors:  [96.45097301 -0.5930682  -0.98703016]
mat_Sqrt:  [[19.86454475  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00951466 -0.08252793  0.12606171]
Stock Position:  -0.009514663754852831
Bond Position:  [-2.27870323]


portfolio before change:  [-3.20305276]
curr_Stock_Price:  97.0901132204504
curr_Factors:  [97.09011322 -0.58258803 -1.01393532]
mat_Sqrt:  [[19.67042422  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00190868  0.02476101 -0.16560511]
Stock Position:  -0.001908681466708961
Bond Position:  [-3.01773866]


portfolio before change:  [-3.20313149]
curr_Stock_Price:  96.73604895665282
curr_Factors:  [96.73604896 -0.60542033 -1.02229386]
mat_Sqrt:  [[18.99682657  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00919249 0.08025866 0.33110601]
Stock Position:  0.00919249210038533
Bond Position:  [-4.09237686]


portfolio before change:  [-3.19511344]
curr_Stock_Price:  97.71959826860534
curr_Factors:  [97.71959827 -0.82401288 -1.04684572]
mat_Sqrt:  [[15.04797661  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00433476  0.05981087 -0.23537665]
Stock Position:  0.0043347614129570985
Bond Position:  [-3.61870459]


portfolio before change:  [-3.19867462]
curr_Stock_Price:  97.1067882123774
curr_Factors:  [97.10678821 -0.56625414 -1.01786185]
mat_Sqrt:  [[19.91942314  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.04545416 -0.10996637 -0.07500661]
Stock Position:  -0.04545416496813981
Bond Position:  [1.21523335]


portfolio before change:  [-3.15636078]
curr_Stock_Price:  96.1825607039441
curr_Factors:  [96.1825607  -0.62980892 -0.94416326]
mat_Sqrt:  [[19.93099139  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00189057 -0.0137824  -0.85652383]
Stock Position:  -0.0018905654113003842
Bond Position:  [-2.97452136]


portfolio before change:  [-3.15365895]
curr_Stock_Price:  94.3600608761514
curr_Factors:  [94.36006088 -0.29715192 -0.91244189]
mat_Sqrt:  [[28.14934521  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00889065 0.030613   0.03641104]
Stock Position:  0.008890653358609269
Bond Position:  [-3.99258154]


portfolio before change:  [-3.17174557]
curr_Stock_Price:  92.43800350228685
curr_Factors:  [ 9.24380035e+01 -5.80408614e-03 -9.39798808e-01]
mat_Sqrt:  [[35.90710881  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02303394 -0.29709381  0.63811472]
Stock Position:  -0.023033943855751953
Bond Position:  [-1.04253378]


portfolio before change:  [-3.26581241]
curr_Stock_Price:  96.51052243875714
curr_Factors:  [96.51052244 -0.34653897 -0.95105294]
mat_Sqrt:  [[26.36560006  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00539463 0.02363918 0.39098939]
Stock Position:  0.005394629066331422
Bond Position:  [-3.78645088]


portfolio before change:  [-3.27026554]
curr_Stock_Price:  95.86054186062971
curr_Factors:  [95.86054186 -0.98715292 -0.95020865]
mat_Sqrt:  [[13.81193221  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00925072  0.04284733 -0.29892886]
Stock Position:  0.009250724152569762
Bond Position:  [-4.15704497]


portfolio before change:  [-3.26264333]
curr_Stock_Price:  96.79685779518236
curr_Factors:  [96.7968578  -1.35286077 -0.94326847]
mat_Sqrt:  [[ 9.74237858  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01509632  0.03490824  0.40713808]
Stock Position:  -0.015096323545693055
Bond Position:  [-1.80136665]


portfolio before change:  [-3.26721196]
curr_Stock_Price:  97.0696549833032
curr_Factors:  [97.06965498 -1.3620389  -0.95581024]
mat_Sqrt:  [[ 9.55992294  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01167027 0.03991883 0.3733927 ]
Stock Position:  0.011670266395923213
Bond Position:  [-4.4000407]


portfolio before change:  [-3.25446045]
curr_Stock_Price:  98.25657403186446
curr_Factors:  [98.25657403 -1.47935605 -0.95971933]
mat_Sqrt:  [[ 8.57204884  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01242536 -0.00349646 -0.09075571]
Stock Position:  0.012425364065625432
Bond Position:  [-4.47533416]


portfolio before change:  [-3.25171357]
curr_Stock_Price:  98.56770041583859
curr_Factors:  [98.56770042 -1.4554964  -0.96502658]
mat_Sqrt:  [[ 8.76021679  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00846852 -0.03320252 -0.02595085]
Stock Position:  -0.008468519562585255
Bond Position:  [-2.41699107]


portfolio before change:  [-3.26113401]
curr_Stock_Price:  99.60874682804075
curr_Factors:  [99.60874683 -1.53486926 -0.96742247]
mat_Sqrt:  [[ 8.15766722  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02402231 -0.25548933 -1.92577506]
Stock Position:  -0.024022308930770064
Bond Position:  [-0.86830192]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-3.28244717]
Stock Price:  100.48693284109835
PL:  [-3.76938001]
Settle:  Tensor("sub_34:0", shape=(), dtype=float64)
PL:  Tensor("sub_35:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  18
output_Z_Vals[:, i, :]:  [[ 1.19271183e+02 -4.92738716e+01 -4.92570741e+01]
 [ 8.37482346e-02  1.30065385e-01 -4.11217775e-02]
 [-2.75758228e+00 -2.73975002e+00 -8.79772089e-01]
 [-2.49620178e-02 -4.06357654e-03 -1.22798372e-01]
 [ 2.78151210e-01 -5.65699766e-02 -1.88605484e-01]
 [-1.39481785e-01 -2.24324714e-01 -3.96703809e-02]
 [-2.14743761e-02  3.72800364e-02 -5.77069172e-02]
 [-2.22400233e-02  8.71980511e-03 -2.91219156e-02]
 [-5.10872961e-03 -1.67198276e-01  2.32360636e-02]
 [-9.86782274e-01 -3.97366734e-01 -3.44085723e-02]
 [ 2.02109752e-01 -1.05672987e-02 -1.33787966e-01]
 [ 6.74119722e-03 -6.38778964e-02  3.44662499e-02]
 [-6.50423997e-01 -1.25998938e+00  2.26121602e-01]
 [ 5.59633344e-02  6.68075074e-02  1.54290935e-01]
 [ 9.78905157e-02  1.21396550e-01 -1.03464966e-01]
 [-9.21249136e-03  5.27128239e-02  9.85303343e-02]
 [ 1.25539909e-01  1.15578973e-01  1.03380930e-01]
 [ 9.29996438e-02 -1.75346946e-02  2.84074090e-02]
 [-3.20254633e-02 -1.31514912e-02 -2.54404148e-02]
 [ 7.18099939e-02 -5.89352538e-01 -5.35635685e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.27118322 -49.27387164 -49.25707411]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [   7.3268874   -15.90307369 -140.51672192]
init_Out:  [2.48374395]
Stock Position:  7.326887399052493
Bond position:  [-730.20499595]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-6.52467303]
curr_Stock_Price:  98.79541714861108
curr_Factors:  [98.79541715 -1.0946469  -1.03927859]
mat_Sqrt:  [[11.69458282  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00871376  0.04197842 -0.11730899]
Stock Position:  0.008713758677031874
Bond Position:  [-7.38555246]


portfolio before change:  [-6.54122489]
curr_Stock_Price:  97.10782860604957
curr_Factors:  [97.10782861 -0.89908581 -1.02112095]
mat_Sqrt:  [[14.23374042  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.24564268 -0.88425052 -2.50974489]
Stock Position:  -0.24564267963064837
Bond Position:  [17.31260234]


portfolio before change:  [-6.8928698]
curr_Stock_Price:  98.55698067229545
curr_Factors:  [98.55698067 -1.27169039 -0.98725029]
mat_Sqrt:  [[10.29536903  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00493985 -0.00131151 -0.35030958]
Stock Position:  -0.0049398525197479545
Bond Position:  [-6.40601285]


portfolio before change:  [-6.89621701]
curr_Stock_Price:  98.91033304908697
curr_Factors:  [98.91033305 -1.2429266  -1.01815138]
mat_Sqrt:  [[10.31022096  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.02212416 -0.01825788 -0.53803895]
Stock Position:  0.022124160074048774
Bond Position:  [-9.08452505]


portfolio before change:  [-6.91184102]
curr_Stock_Price:  98.30680289148671
curr_Factors:  [98.30680289 -1.4299485  -1.00952341]
mat_Sqrt:  [[ 8.57303081  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02255557 -0.07240049 -0.11316855]
Stock Position:  -0.022555565552165653
Bond Position:  [-4.69447548]


portfolio before change:  [-6.93723342]
curr_Stock_Price:  99.38053484585369
curr_Factors:  [99.38053485 -1.66886744 -1.0397893 ]
mat_Sqrt:  [[ 6.62135167  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00387292  0.01203208 -0.16462177]
Stock Position:  -0.003872924595290038
Bond Position:  [-6.5523401]


portfolio before change:  [-6.94034014]
curr_Stock_Price:  99.75968854425594
curr_Factors:  [99.75968854 -1.68868726 -1.04747272]
mat_Sqrt:  [[ 6.46630077  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00408341  0.0028143  -0.08307672]
Stock Position:  -0.00408341454602156
Bond Position:  [-6.53297998]


portfolio before change:  [-6.93976132]
curr_Stock_Price:  99.21791756659728
curr_Factors:  [99.21791757 -1.64751522 -1.06025959]
mat_Sqrt:  [[ 6.61634967  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00521358 -0.05396301  0.06628602]
Stock Position:  -0.005213583750887289
Bond Position:  [-6.42248039]


portfolio before change:  [-6.94445472]
curr_Stock_Price:  99.81013726780846
curr_Factors:  [99.81013727 -1.40767976 -1.04461511]
mat_Sqrt:  [[ 8.59323177  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.12508892 -0.12824956 -0.09815808]
Stock Position:  -0.12508891514337633
Bond Position:  [5.54068707]


portfolio before change:  [-6.90497752]
curr_Stock_Price:  99.50561898498654
curr_Factors:  [99.50561898 -1.34855618 -1.04933656]
mat_Sqrt:  [[ 9.0459883   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01908507 -0.00341058 -0.38165983]
Stock Position:  0.01908507406865828
Bond Position:  [-8.80404963]


portfolio before change:  [-6.92744867]
curr_Stock_Price:  98.44353965735311
curr_Factors:  [98.44353966 -1.63762185 -1.06547334]
mat_Sqrt:  [[ 6.59550259  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00011183 -0.0206165   0.09832262]
Stock Position:  0.00011182923966574966
Bond Position:  [-6.93845753]


portfolio before change:  [-6.92918216]
curr_Stock_Price:  98.45549693543792
curr_Factors:  [98.45549694 -1.28485708 -1.0488021 ]
mat_Sqrt:  [[ 9.54431277  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.09025913 -0.40665982  0.64506199]
Stock Position:  -0.09025913078038199
Bond Position:  [1.95732541]


portfolio before change:  [-6.82308101]
curr_Stock_Price:  97.28540191871869
curr_Factors:  [97.28540192 -1.36736913 -1.06807711]
mat_Sqrt:  [[ 8.51818005  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01186813 0.02156203 0.44014909]
Stock Position:  0.011868129623404557
Bond Position:  [-7.97767677]


portfolio before change:  [-6.82228339]
curr_Stock_Price:  97.52067828990855
curr_Factors:  [97.52067829 -0.90069255 -1.07409184]
mat_Sqrt:  [[13.53501523  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00750282  0.03918057 -0.29515675]
Stock Position:  0.007502820138645871
Bond Position:  [-7.5539635]


portfolio before change:  [-6.81077712]
curr_Stock_Price:  99.3060056738545
curr_Factors:  [99.30600567 -1.12128802 -1.09784523]
mat_Sqrt:  [[10.7948892   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00200649 0.01701299 0.28107962]
Stock Position:  0.0020064947981892145
Bond Position:  [-7.01003411]


portfolio before change:  [-6.81055945]
curr_Stock_Price:  100.28801785729901
curr_Factors:  [100.28801786  -0.9816995   -1.11450505]
mat_Sqrt:  [[12.32761268  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01380924 0.03730295 0.29491702]
Stock Position:  0.013809235969512272
Bond Position:  [-8.19546035]


portfolio before change:  [-6.80927657]
curr_Stock_Price:  100.52930556553538
curr_Factors:  [100.52930557  -0.79853521  -1.09461643]
mat_Sqrt:  [[15.13935497  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0062895  -0.0056593   0.08103843]
Stock Position:  0.0062895035846485
Bond Position:  [-7.441556]


portfolio before change:  [-6.80525996]
curr_Stock_Price:  101.46375661814388
curr_Factors:  [101.46375662  -0.98461687  -1.0685303 ]
mat_Sqrt:  [[13.02088341  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00306454 -0.00424463 -0.07257442]
Stock Position:  -0.0030645388534451686
Bond Position:  [-6.49432034]


portfolio before change:  [-6.80192765]
curr_Stock_Price:  99.84651635009143
curr_Factors:  [99.84651635 -0.90942814 -1.05052905]
mat_Sqrt:  [[14.06482474  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01122142 -0.19021271 -1.52801952]
Stock Position:  -0.011221417152785995
Bond Position:  [-5.68150824]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-6.77676853]
Stock Price:  97.47786084371702
PL:  [-6.77676853]
Settle:  Tensor("sub_36:0", shape=(), dtype=float64)
PL:  Tensor("sub_37:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  19
output_Z_Vals[:, i, :]:  [[ 1.19271183e+02 -4.92738716e+01 -4.92570741e+01]
 [ 4.73432780e-02  8.49551976e-02 -3.24762900e-02]
 [-1.78276005e+00 -2.40573217e+00 -6.82752613e-01]
 [-1.67182455e-02  1.86674622e-01  1.46610947e-02]
 [ 4.44655519e-01  1.74661014e-01 -4.82643742e-01]
 [-1.42670618e-01 -7.57219214e-02 -4.23718708e-02]
 [ 1.22414238e-02  2.62111036e-02  7.17568524e-02]
 [-2.82612941e-02 -3.15547599e-02 -2.66800923e-02]
 [ 2.28686637e-02 -1.01049411e-01 -5.73516391e-03]
 [-1.05529115e+00 -4.33195929e-01 -3.77325404e-02]
 [ 3.39693139e-01  3.40302875e-02 -4.90379221e-02]
 [ 3.79767989e-02  1.94298628e-03  2.28503461e-02]
 [-5.30626989e-01 -1.32142309e+00  1.91815502e-01]
 [ 9.82619988e-03  2.64137212e-02  6.55357047e-02]
 [-3.79533889e-02 -1.32366305e-02 -3.36333694e-02]
 [ 7.90036016e-02  2.89683849e-02  5.67635519e-02]
 [-4.49241872e-02 -5.51820535e-02 -7.14122642e-02]
 [-5.57960122e-02 -1.47172970e-01  2.65199469e-01]
 [ 5.21281964e-02 -3.34882058e-02  5.81001624e-02]
 [ 3.94448143e-02 -4.40087256e-01 -2.32975601e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.27118322 -49.27387164 -49.25707411]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [   7.3268874   -15.90307369 -140.51672192]
init_Out:  [2.48374395]
Stock Position:  7.326887399052493
Bond position:  [-730.20499595]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [0.83864776]
curr_Stock_Price:  99.80038970991136
curr_Factors:  [99.80038971 -1.25174781 -0.97625604]
mat_Sqrt:  [[10.75282203  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00539909  0.02741917 -0.09264582]
Stock Position:  0.005399093369456043
Bond Position:  [0.29981614]


portfolio before change:  [0.84538724]
curr_Stock_Price:  101.03476598935895
curr_Factors:  [101.03476599  -1.72453677  -0.93642343]
mat_Sqrt:  [[ 7.06041951  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.34179192 -0.77644672 -1.94770316]
Stock Position:  -0.3417919234382322
Bond Position:  [35.37825424]


portfolio before change:  [0.77766097]
curr_Stock_Price:  101.25879686003101
curr_Factors:  [101.25879686  -1.5028727   -0.94305703]
mat_Sqrt:  [[ 8.77362316  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.0027787  0.06024898 0.04182402]
Stock Position:  0.0027786964499226185
Bond Position:  [0.49629351]


portfolio before change:  [0.77868522]
curr_Stock_Price:  101.58275056820345
curr_Factors:  [101.58275057  -1.9025606   -0.90909467]
mat_Sqrt:  [[ 6.10567381  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.06253017  0.0563716  -1.37684826]
Stock Position:  0.06253016773444411
Bond Position:  [-5.57330121]


portfolio before change:  [0.7642002]
curr_Stock_Price:  101.37338727344682
curr_Factors:  [101.37338727  -1.91898408  -0.88834566]
mat_Sqrt:  [[ 6.11950286  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02725326 -0.02443915 -0.12087515]
Stock Position:  -0.02725326166436081
Bond Position:  [3.52695565]


portfolio before change:  [0.76688697]
curr_Stock_Price:  101.30715969761054
curr_Factors:  [101.3071597   -1.7153349   -0.83288959]
mat_Sqrt:  [[ 7.92428898  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00406838 0.0084596  0.20470233]
Stock Position:  0.004068383821624474
Bond Position:  [0.35473056]


portfolio before change:  [0.76680176]
curr_Stock_Price:  101.26441515898838
curr_Factors:  [101.26441516  -1.52037807  -0.85728118]
mat_Sqrt:  [[ 9.39404354  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00427382 -0.01018425 -0.07611088]
Stock Position:  -0.004273818123705771
Bond Position:  [1.19958745]


portfolio before change:  [0.76833167]
curr_Stock_Price:  100.97662322866955
curr_Factors:  [100.97662323  -1.12340861  -0.82357846]
mat_Sqrt:  [[14.40970545  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 7.43494560e-05 -3.26135570e-02 -1.63608263e-02]
Stock Position:  7.434945603195474e-05
Bond Position:  [0.76082411]


portfolio before change:  [0.76852877]
curr_Stock_Price:  101.06904200395518
curr_Factors:  [101.069042    -1.03150258  -0.82441313]
mat_Sqrt:  [[15.79807602  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0728835  -0.13981338 -0.10764043]
Stock Position:  -0.07288349675253653
Bond Position:  [8.13479396]


portfolio before change:  [0.82891598]
curr_Stock_Price:  100.26840448180573
curr_Factors:  [100.26840448  -0.77315026  -0.84711079]
mat_Sqrt:  [[19.83780751  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0169691   0.01098323 -0.13989154]
Stock Position:  0.016969098917156242
Bond Position:  [-0.87254849]


portfolio before change:  [0.7715376]
curr_Stock_Price:  96.89991560471236
curr_Factors:  [ 9.68999156e+01 -4.23937530e-02 -8.30912656e-01]
mat_Sqrt:  [[40.46236322  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00106365 0.0006271  0.06518568]
Stock Position:  0.0010636481222829404
Bond Position:  [0.66847018]


portfolio before change:  [0.77358482]
curr_Stock_Price:  98.66749821041775
curr_Factors:  [98.66749821 -0.37066593 -0.8016262 ]
mat_Sqrt:  [[30.55301772  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0249143  -0.42648747  0.54719623]
Stock Position:  -0.024914304004006814
Bond Position:  [3.23181687]


portfolio before change:  [0.73517047]
curr_Stock_Price:  100.24179071925562
curr_Factors:  [100.24179072  -0.73291333  -0.8127384 ]
mat_Sqrt:  [[21.36883276  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00133818 0.00852499 0.18695512]
Stock Position:  0.0013381778108389453
Bond Position:  [0.60102913]


portfolio before change:  [0.7386634]
curr_Stock_Price:  102.73969904873475
curr_Factors:  [102.73969905  -0.68466107  -0.78278209]
mat_Sqrt:  [[23.68295139  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00200654 -0.0042721  -0.09594664]
Stock Position:  -0.002006535706931467
Bond Position:  [0.94481427]


portfolio before change:  [0.7346512]
curr_Stock_Price:  104.8569955105192
curr_Factors:  [104.85699551  -0.54184257  -0.79623365]
mat_Sqrt:  [[27.50922107  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00350804 0.00934951 0.16193061]
Stock Position:  0.0035080440743650455
Bond Position:  [0.36680824]


portfolio before change:  [0.73787512]
curr_Stock_Price:  105.7498613996041
curr_Factors:  [105.7498614   -0.49073382  -0.79539464]
mat_Sqrt:  [[29.22276546  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00242158 -0.01780993 -0.20371931]
Stock Position:  -0.002421575883536851
Bond Position:  [0.99395644]


portfolio before change:  [0.73861356]
curr_Stock_Price:  105.54755006779709
curr_Factors:  [105.54755007  -0.58903803  -0.80425426]
mat_Sqrt:  [[26.20287837  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00120994 -0.04749987  0.75654027]
Stock Position:  -0.0012099416476324758
Bond Position:  [0.86631993]


portfolio before change:  [0.73677145]
curr_Stock_Price:  107.24904452552721
curr_Factors:  [107.24904453  -0.59409105  -0.83594252]
mat_Sqrt:  [[25.66479166  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00222687 -0.01080827  0.16574359]
Stock Position:  0.0022268675222145936
Bond Position:  [0.49794204]


portfolio before change:  [0.73378099]
curr_Stock_Price:  105.85023533809803
curr_Factors:  [105.85023534  -0.47587564  -0.85990729]
mat_Sqrt:  [[27.83355441  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0035189  -0.14203755 -0.66461454]
Stock Position:  -0.0035189025678033763
Bond Position:  [1.10625766]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [0.73160078]
Stock Price:  106.54841093030795
PL:  [-5.81681015]
Settle:  Tensor("sub_38:0", shape=(), dtype=float64)
PL:  Tensor("sub_39:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  20
output_Z_Vals[:, i, :]:  [[ 1.19271183e+02 -4.92738716e+01 -4.92570741e+01]
 [ 7.14260932e-03  1.76855626e-02 -5.34122673e-02]
 [-2.05238883e+00 -2.76528910e+00 -7.86765775e-01]
 [ 9.02326633e-02  2.13112608e-01 -5.29621207e-02]
 [ 5.11443525e-01 -9.24288543e-02 -2.69412703e-01]
 [ 2.35358333e-02  3.83461657e-02  3.93654131e-03]
 [-1.73513350e-02  4.01848276e-02  3.51194672e-03]
 [ 1.59781990e-01  4.35729832e-01  2.91749647e-01]
 [-1.14367051e-01  3.30655083e-01 -9.26892039e-02]
 [-8.56156735e-01 -3.50522116e-01 -2.76143732e-02]
 [ 1.02138813e-01 -1.06072788e-02 -2.17378278e-01]
 [ 1.57044391e-03 -5.77222828e-02  3.29674498e-02]
 [-5.69916574e-01 -1.22497937e+00  2.00730307e-01]
 [ 2.49065861e-02  3.97676947e-02  9.47707275e-02]
 [ 1.06947480e-01  1.23814713e-01 -1.04719085e-01]
 [-6.67645597e-02  6.85611651e-02  1.22128082e-01]
 [ 9.47216516e-02  1.10841760e-01  8.88633904e-02]
 [ 1.09664885e-01 -1.24957403e-02 -1.62529760e-02]
 [-5.08259780e-02 -1.41174382e-01  1.78130116e-02]
 [ 6.54689079e-02 -5.04054379e-01 -5.18272602e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.27118322 -49.27387164 -49.25707411]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [   7.3268874   -15.90307369 -140.51672192]
init_Out:  [2.48374395]
Stock Position:  7.326887399052493
Bond position:  [-730.20499595]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [8.57755202]
curr_Stock_Price:  100.85662325640506
curr_Factors:  [100.85662326  -1.10760606  -1.00315655]
mat_Sqrt:  [[12.21833046  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-1.22826716e-05  5.70799079e-03 -1.52370332e-01]
Stock Position:  -1.2282671600253306e-05
Bond Position:  [8.57879081]


portfolio before change:  [8.57969441]
curr_Stock_Price:  101.06641271211656
curr_Factors:  [101.06641271  -1.22059624  -0.98788089]
mat_Sqrt:  [[11.1039481   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.25013166 -0.89249322 -2.24442376]
Stock Position:  -0.25013166246484053
Bond Position:  [33.85960424]


portfolio before change:  [8.82851532]
curr_Stock_Price:  100.10549897286025
curr_Factors:  [100.10549897  -0.96425451  -0.9861526 ]
mat_Sqrt:  [[14.23661982  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0086343   0.0687818  -0.15108619]
Stock Position:  0.008634299871211296
Bond Position:  [7.96417443]


portfolio before change:  [8.82203388]
curr_Stock_Price:  99.12421107778997
curr_Factors:  [99.12421108 -0.90072042 -1.00425492]
mat_Sqrt:  [[14.75229086  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.02966203 -0.02983128 -0.76855945]
Stock Position:  0.029662032188783667
Bond Position:  [5.88180834]


portfolio before change:  [8.82343386]
curr_Stock_Price:  99.12182881316933
curr_Factors:  [99.12182881 -0.59445803 -1.05551725]
mat_Sqrt:  [[19.03680872  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00168971 0.01237617 0.01122986]
Stock Position:  0.0016897136074785165
Bond Position:  [8.65594635]


portfolio before change:  [8.82360204]
curr_Stock_Price:  97.94051755510128
curr_Factors:  [97.94051756 -0.41876569 -1.05691017]
mat_Sqrt:  [[22.39156827  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00037656  0.0129696   0.01001861]
Stock Position:  -0.00037655997088346645
Bond Position:  [8.86048251]


portfolio before change:  [8.82479602]
curr_Stock_Price:  100.65301094351857
curr_Factors:  [100.65301094  -0.31928062  -1.07597502]
mat_Sqrt:  [[24.93876522  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.0123614  0.1406312  0.83228054]
Stock Position:  0.01236140259976172
Bond Position:  [7.58058363]


portfolio before change:  [8.78031626]
curr_Stock_Price:  96.9014030718986
curr_Factors:  [96.90140307 -0.41010952 -1.0326497 ]
mat_Sqrt:  [[22.89537153  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00287361  0.10671847 -0.2644165 ]
Stock Position:  -0.0028736144116422225
Bond Position:  [9.05877353]


portfolio before change:  [8.78149885]
curr_Stock_Price:  97.27806707498804
curr_Factors:  [97.27806707 -0.60702689 -1.06669374]
mat_Sqrt:  [[18.24430399  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.05115808 -0.11313053 -0.07877612]
Stock Position:  -0.05115807778554978
Bond Position:  [13.75805778]


portfolio before change:  [8.75849864]
curr_Stock_Price:  97.79489956147125
curr_Factors:  [97.79489956 -0.30804491 -1.08784317]
mat_Sqrt:  [[24.21529224  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00229613 -0.00342348 -0.62011972]
Stock Position:  0.0022961299010350223
Bond Position:  [8.53394885]


portfolio before change:  [8.76226863]
curr_Stock_Price:  98.50750364289833
curr_Factors:  [98.50750364 -0.81829439 -1.125714  ]
mat_Sqrt:  [[14.09928846  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00024701 -0.01862979  0.09404696]
Stock Position:  -0.00024700645286610565
Bond Position:  [8.78660062]


portfolio before change:  [8.76460646]
curr_Stock_Price:  97.93705739589537
curr_Factors:  [97.9370574  -0.43343856 -1.11377237]
mat_Sqrt:  [[20.84499913  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.03737062 -0.39536039  0.57262769]
Stock Position:  -0.03737061988628824
Bond Position:  [12.424575]


portfolio before change:  [8.69957248]
curr_Stock_Price:  99.760428420023
curr_Factors:  [99.76042842 -0.73623132 -1.14383725]
mat_Sqrt:  [[15.22141057  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00344049 0.01283497 0.27035451]
Stock Position:  0.0034404910331711567
Bond Position:  [8.35634762]


portfolio before change:  [8.70012424]
curr_Stock_Price:  99.31351850426104
curr_Factors:  [99.3135185  -0.91235674 -1.11304129]
mat_Sqrt:  [[13.10355636  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00845918  0.03996103 -0.2987344 ]
Stock Position:  0.008459181282984134
Bond Position:  [7.86001318]


portfolio before change:  [8.69316887]
curr_Stock_Price:  98.25896932981234
curr_Factors:  [98.25896933 -0.830255   -1.06804674]
mat_Sqrt:  [[14.72143796  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00189114  0.02212802  0.34839742]
Stock Position:  -0.0018911386323609194
Bond Position:  [8.8789902]


portfolio before change:  [8.69473654]
curr_Stock_Price:  98.60391906049989
curr_Factors:  [98.60391906 -0.6225032  -1.05339894]
mat_Sqrt:  [[18.45266632  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00734237 0.03577402 0.25350252]
Stock Position:  0.007342369514520255
Bond Position:  [7.97075013]


portfolio before change:  [8.70157084]
curr_Stock_Price:  99.26329127982201
curr_Factors:  [99.26329128 -0.61425912 -1.06451173]
mat_Sqrt:  [[18.52284774  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00560371 -0.00403298 -0.04636522]
Stock Position:  0.005603705191346126
Bond Position:  [8.14532861]


portfolio before change:  [8.70007942]
curr_Stock_Price:  98.63370794853182
curr_Factors:  [98.63370795 -0.38925369 -1.05590879]
mat_Sqrt:  [[23.24873188  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0032693  -0.04556384  0.05081556]
Stock Position:  -0.003269297130755466
Bond Position:  [9.02254232]


portfolio before change:  [8.70128778]
curr_Stock_Price:  98.95413184275894
curr_Factors:  [98.95413184 -0.67252933 -1.05944191]
mat_Sqrt:  [[17.50847745  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00817962 -0.16268285 -1.47848747]
Stock Position:  -0.008179621201311325
Bond Position:  [9.51069509]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [8.7008349]
Stock Price:  99.30021721572088
PL:  [8.7008349]
Settle:  Tensor("sub_40:0", shape=(), dtype=float64)
PL:  Tensor("sub_41:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  21
output_Z_Vals[:, i, :]:  [[ 1.19271183e+02 -4.92738716e+01 -4.92570741e+01]
 [ 3.92215116e-02  7.19066661e-02 -3.62453123e-02]
 [-2.36875318e+00 -3.20378027e+00 -9.14295046e-01]
 [-3.10073231e-02  3.29655034e-02 -1.18362381e-01]
 [ 8.26883399e-01 -1.29907963e-01 -3.92522468e-01]
 [ 8.54751958e-02  2.07470307e-01  4.79761617e-02]
 [ 1.67645751e-01 -3.72522477e-01 -4.64176141e-01]
 [-1.32429430e-01  1.98830938e-01  5.27635677e-01]
 [-6.96117508e-02 -3.39168650e-01  7.44676465e-02]
 [-1.71596490e+00 -6.63541882e-01 -7.06883909e-02]
 [ 2.07144970e-01  2.85987230e-02  5.26542581e-02]
 [-2.28362759e-01  2.95078176e-02  2.56434152e-02]
 [-8.18208152e-01 -9.96136503e-01  2.92803085e-01]
 [-3.85265471e-03 -4.69031483e-02 -2.76155531e-02]
 [-4.50282792e-02 -4.70586882e-02 -1.30934861e-02]
 [ 5.00022673e-02  3.67744483e-02  7.04945207e-02]
 [ 1.05939768e-01  1.12550444e-01  9.36411928e-02]
 [ 8.92153837e-02 -1.93406778e-02  3.87959268e-02]
 [-1.74409882e-02 -2.33497770e-02 -2.84475817e-03]
 [ 9.62500227e-02 -7.90969791e-01 -4.68135557e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.27118322 -49.27387164 -49.25707411]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [   7.3268874   -15.90307369 -140.51672192]
init_Out:  [2.48374395]
Stock Position:  7.326887399052493
Bond position:  [-730.20499595]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-1.337009]
curr_Stock_Price:  99.50344823297253
curr_Factors:  [99.50344823 -0.89311583 -1.00898218]
mat_Sqrt:  [[14.85140214  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00313108  0.02320778 -0.10339779]
Stock Position:  0.0031310750701655675
Bond Position:  [-1.64856177]


portfolio before change:  [-1.33738283]
curr_Stock_Price:  99.51570133244613
curr_Factors:  [99.51570133 -0.77482681 -0.96044458]
mat_Sqrt:  [[17.54982605  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.18287086 -1.03401564 -2.60822928]
Stock Position:  -0.18287086025486704
Bond Position:  [16.86113908]


portfolio before change:  [-1.19482507]
curr_Stock_Price:  98.75920053855262
curr_Factors:  [98.75920054 -0.69826862 -0.95776317]
mat_Sqrt:  [[18.85263664  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00256934  0.01063957 -0.33765493]
Stock Position:  -0.0025693428765983777
Bond Position:  [-0.94107882]


portfolio before change:  [-1.19710546]
curr_Stock_Price:  99.55515909893293
curr_Factors:  [99.5551591  -0.54850158 -0.96531547]
mat_Sqrt:  [[21.90894061  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.03287438 -0.04192761 -1.11975734]
Stock Position:  0.03287437519807522
Bond Position:  [-4.46991911]


portfolio before change:  [-1.13414439]
curr_Stock_Price:  101.5043578354322
curr_Factors:  [ 1.01504358e+02 -6.53685699e-02 -9.77389336e-01]
mat_Sqrt:  [[35.7783809   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.0038464  0.06696075 0.13686264]
Stock Position:  0.003846400660182355
Bond Position:  [-1.52457081]


portfolio before change:  [-1.10613721]
curr_Stock_Price:  108.88485861924441
curr_Factors:  [108.88485862  -0.37989003  -0.98727237]
mat_Sqrt:  [[27.74702354  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-1.13332472e-04 -1.20231112e-01 -1.32416533e+00]
Stock Position:  -0.00011333247163052667
Bond Position:  [-1.09379702]


portfolio before change:  [-1.10638816]
curr_Stock_Price:  108.68599877979133
curr_Factors:  [108.68599878  -0.28569856  -0.98864106]
mat_Sqrt:  [[30.39029632  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [5.21875370e-04 6.41724092e-02 1.50519772e+00]
Stock Position:  0.0005218753702163045
Bond Position:  [-1.1631087]


portfolio before change:  [-1.10665367]
curr_Stock_Price:  108.73447316833533
curr_Factors:  [108.73447317  -0.23515057  -0.98740591]
mat_Sqrt:  [[32.01973401  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00386148 -0.10946621  0.21243547]
Stock Position:  -0.0038614816979811273
Bond Position:  [-0.6867775]


portfolio before change:  [-1.09780885]
curr_Stock_Price:  106.39947862721465
curr_Factors:  [106.39947863  -0.41732349  -1.01501099]
mat_Sqrt:  [[25.40297262  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.07344963 -0.21415722 -0.2016543 ]
Stock Position:  -0.07344963331816408
Bond Position:  [6.71719384]


portfolio before change:  [-0.91692591]
curr_Stock_Price:  103.95966479658078
curr_Factors:  [103.9596648   -0.41507453  -1.01876066]
mat_Sqrt:  [[24.78324431  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.0090275  0.0092302  0.15020794]
Stock Position:  0.009027497071489789
Bond Position:  [-1.85542148]


portfolio before change:  [-0.91642758]
curr_Stock_Price:  104.06625553498672
curr_Factors:  [104.06625553  -0.43879199  -1.01267431]
mat_Sqrt:  [[24.37508415  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00890684  0.00952361  0.07315353]
Stock Position:  -0.008906843553997163
Bond Position:  [0.01047428]


portfolio before change:  [-0.93048018]
curr_Stock_Price:  105.6442799204635
curr_Factors:  [105.64427992  -0.38302522  -1.01956804]
mat_Sqrt:  [[25.98408784  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.03701402 -0.32150167  0.8352857 ]
Stock Position:  -0.0370140176194357
Bond Position:  [2.97983906]


portfolio before change:  [-0.93089063]
curr_Stock_Price:  105.67549802361076
curr_Factors:  [105.67549802  -0.21879657  -1.03834485]
mat_Sqrt:  [[30.06108989  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00063417 -0.01513793 -0.07877949]
Stock Position:  -0.0006341659937516415
Bond Position:  [-0.86387482]


portfolio before change:  [-0.92811682]
curr_Stock_Price:  100.96094431721234
curr_Factors:  [100.96094432  -0.13856771  -1.03979916]
mat_Sqrt:  [[31.07385777  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00184421 -0.01518813 -0.03735207]
Stock Position:  -0.0018442122869948975
Bond Position:  [-0.7419234]


portfolio before change:  [-0.92829336]
curr_Stock_Price:  100.95608580296336
curr_Factors:  [100.9560858   -0.41796255  -1.04577222]
mat_Sqrt:  [[23.35826447  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00307807 0.0118689  0.20110125]
Stock Position:  0.00307807345740858
Bond Position:  [-1.23904361]


portfolio before change:  [-0.93425368]
curr_Stock_Price:  99.12035246666058
curr_Factors:  [99.12035247 -0.40159245 -1.07331241]
mat_Sqrt:  [[22.67878569  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00652718 0.0363255  0.26713226]
Stock Position:  0.006527177511898274
Bond Position:  [-1.58122982]


portfolio before change:  [-0.92078324]
curr_Stock_Price:  101.24466945724548
curr_Factors:  [101.24466946  -0.90731105  -1.07289441]
mat_Sqrt:  [[13.9759025   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00666767 -0.00624218  0.11067398]
Stock Position:  0.006667667420364631
Bond Position:  [-1.59584903]


portfolio before change:  [-0.91527896]
curr_Stock_Price:  102.13003086475923
curr_Factors:  [102.13003086  -0.90481465  -1.10074591]
mat_Sqrt:  [[13.74515307  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00165789 -0.00753611 -0.0081153 ]
Stock Position:  -0.0016578880699231358
Bond Position:  [-0.7459588]


portfolio before change:  [-0.91676496]
curr_Stock_Price:  102.9138515559261
curr_Factors:  [102.91385156  -1.20919084  -1.1021618 ]
mat_Sqrt:  [[10.20154941  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01575876 -0.2552844  -1.33546044]
Stock Position:  -0.015758761130691117
Bond Position:  [0.70502984]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-0.90452508]
Stock Price:  102.14833434836218
PL:  [-3.05285943]
Settle:  Tensor("sub_42:0", shape=(), dtype=float64)
PL:  Tensor("sub_43:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  22
output_Z_Vals[:, i, :]:  [[ 1.19271183e+02 -4.92738716e+01 -4.92570741e+01]
 [ 7.61120708e-02  1.31175500e-01 -1.91257186e-02]
 [-2.05389656e+00 -2.60110286e+00 -7.52789235e-01]
 [ 9.64389039e-02  2.17873695e-01 -4.65000480e-02]
 [ 2.08851129e-01  1.40725559e-01 -3.38181012e-01]
 [-9.15974372e-02 -1.07067228e-01  2.62494007e-02]
 [-1.95333026e-03  2.98599544e-02  2.35283212e-02]
 [-4.23003069e-02 -4.16711657e-02 -3.38569497e-02]
 [ 6.98781565e-03 -1.41939533e-01  8.03735922e-03]
 [-1.08590277e+00 -4.31066298e-01 -3.96033636e-02]
 [ 3.37612364e-01  3.12112773e-02 -5.08842698e-02]
 [ 5.02637323e-02 -6.31091139e-02  3.75133813e-02]
 [-6.50360552e-01 -1.22763767e+00  2.29632081e-01]
 [ 2.38001535e-02  3.88043701e-02  9.26502511e-02]
 [ 1.26212560e-01  1.19308980e-01 -1.05535134e-01]
 [-3.65094462e-03  5.12158656e-02  9.58971649e-02]
 [ 1.25565004e-01  1.14831372e-01  1.01724281e-01]
 [ 9.65422453e-02 -1.64253789e-02  2.05312018e-02]
 [-5.53061231e-02 -1.44442414e-01  3.46100693e-03]
 [ 1.12899017e-01 -8.34136420e-01 -7.74732431e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.27118322 -49.27387164 -49.25707411]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [   7.3268874   -15.90307369 -140.51672192]
init_Out:  [2.48374395]
Stock Position:  7.326887399052493
Bond position:  [-730.20499595]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-4.36498165]
curr_Stock_Price:  99.09017961231798
curr_Factors:  [99.09017961 -1.44399042 -1.00043917]
mat_Sqrt:  [[ 8.59861163  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01151164  0.04233671 -0.05456035]
Stock Position:  0.011511641760534945
Bond Position:  [-5.5056723]


portfolio before change:  [-4.36208233]
curr_Stock_Price:  99.46162190850121
curr_Factors:  [99.46162191 -1.43320629 -1.02128216]
mat_Sqrt:  [[ 8.54446244  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.32050078 -0.83950234 -2.14749815]
Stock Position:  -0.320500784786828
Bond Position:  [27.51544555]


portfolio before change:  [-4.50356139]
curr_Stock_Price:  99.92451867235087
curr_Factors:  [99.92451867 -1.66307097 -1.01067205]
mat_Sqrt:  [[ 6.89414202  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01906262  0.07031843 -0.13265169]
Stock Position:  0.019062619069428154
Bond Position:  [-6.40838442]


portfolio before change:  [-4.49848481]
curr_Stock_Price:  100.2748837525517
curr_Factors:  [100.27488375  -1.95392044  -1.03440851]
mat_Sqrt:  [[ 5.05100032  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.03336878  0.04541898 -0.9647363 ]
Stock Position:  0.033368777039171786
Bond Position:  [-7.84453505]


portfolio before change:  [-4.50738299]
curr_Stock_Price:  100.06700069722059
curr_Factors:  [100.0670007   -1.31659848  -1.01343366]
mat_Sqrt:  [[ 9.73578072  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01110279 -0.0345558   0.07488223]
Stock Position:  -0.011102787773683167
Bond Position:  [-3.39636032]


portfolio before change:  [-4.51030648]
curr_Stock_Price:  100.25382711745735
curr_Factors:  [100.25382712  -1.46874469  -0.96688616]
mat_Sqrt:  [[ 8.77647106  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00101915 0.00963726 0.06711975]
Stock Position:  0.0010191460578459356
Bond Position:  [-4.61247977]


portfolio before change:  [-4.51043471]
curr_Stock_Price:  101.25960018556094
curr_Factors:  [101.25960019  -1.70864846  -0.96463234]
mat_Sqrt:  [[ 6.98948383  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00825775 -0.01344931 -0.09658445]
Stock Position:  -0.008257751263475102
Bond Position:  [-3.67425812]


portfolio before change:  [-4.50472067]
curr_Stock_Price:  100.45638890435524
curr_Factors:  [100.4563889   -1.66164267  -0.9982227 ]
mat_Sqrt:  [[ 7.02769187  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00289495 -0.04581079  0.02292835]
Stock Position:  -0.0028949549107847253
Bond Position:  [-4.21390396]


portfolio before change:  [-4.50693274]
curr_Stock_Price:  100.85655204277407
curr_Factors:  [100.85655204  -1.39462937  -1.03746822]
mat_Sqrt:  [[ 8.86048623  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.13339875 -0.13912605 -0.11297737]
Stock Position:  -0.13339875285429545
Bond Position:  [8.94720552]


portfolio before change:  [-4.44789578]
curr_Stock_Price:  100.43076189705344
curr_Factors:  [100.4307619   -1.23637165  -1.05133087]
mat_Sqrt:  [[10.19366075  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.03272589  0.0100734  -0.14515866]
Stock Position:  0.032725891081867055
Bond Position:  [-7.73458196]


portfolio before change:  [-4.45137457]
curr_Stock_Price:  100.3835544493623
curr_Factors:  [100.38355445  -1.28430033  -1.0529141 ]
mat_Sqrt:  [[ 9.69668395  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00464479 -0.02036838  0.10701524]
Stock Position:  0.0046447863572989636
Bond Position:  [-4.91763474]


portfolio before change:  [-4.45364758]
curr_Stock_Price:  100.15890565410308
curr_Factors:  [100.15890565  -1.27866843  -1.04376278]
mat_Sqrt:  [[ 9.81907352  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.08698148 -0.39621836  0.65507641]
Stock Position:  -0.0869814843993835
Bond Position:  [4.25832271]


portfolio before change:  [-4.3732172]
curr_Stock_Price:  99.24646241504993
curr_Factors:  [99.24646242 -1.48471625 -1.00792289]
mat_Sqrt:  [[ 8.20683326  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00616964 0.01252406 0.26430538]
Stock Position:  0.006169641085476489
Bond Position:  [-4.98553225]


portfolio before change:  [-4.37287623]
curr_Stock_Price:  99.50377285535073
curr_Factors:  [99.50377286 -1.56018746 -0.96184919]
mat_Sqrt:  [[ 7.98974553  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01614872  0.03850681 -0.30106236]
Stock Position:  0.016148716376440452
Bond Position:  [-5.97973443]


portfolio before change:  [-4.37151179]
curr_Stock_Price:  99.68084908233233
curr_Factors:  [99.68084908 -1.60294166 -0.95100378]
mat_Sqrt:  [[ 7.75259893  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00340252 0.01652985 0.27356792]
Stock Position:  0.0034025205284035505
Bond Position:  [-4.71067793]


portfolio before change:  [-4.37276895]
curr_Stock_Price:  99.65752959244186
curr_Factors:  [99.65752959 -1.62432264 -0.93391724]
mat_Sqrt:  [[ 7.71757134  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.02199775 0.03706167 0.29019106]
Stock Position:  0.021997754753619942
Bond Position:  [-6.56501085]


portfolio before change:  [-4.36114692]
curr_Stock_Price:  100.26047715890842
curr_Factors:  [100.26047716  -1.26534939  -0.90280015]
mat_Sqrt:  [[11.46870505  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00849096 -0.00530127  0.0585698 ]
Stock Position:  0.008490962360221538
Bond Position:  [-5.21245486]


portfolio before change:  [-4.39196564]
curr_Stock_Price:  96.78437619541405
curr_Factors:  [96.7843762  -1.18165191 -0.8193206 ]
mat_Sqrt:  [[13.08560887  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00642567 -0.04661859  0.00987329]
Stock Position:  -0.00642567214763284
Bond Position:  [-3.77006097]


portfolio before change:  [-4.39772661]
curr_Stock_Price:  97.53423363550063
curr_Factors:  [97.53423364 -1.8010334  -0.86190275]
mat_Sqrt:  [[ 6.80234411  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.03168172 -0.26921637 -2.21009598]
Stock Position:  -0.031681720115817436
Bond Position:  [-1.30767432]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-4.41415243]
Stock Price:  98.04237699428295
PL:  [-4.41415243]
Settle:  Tensor("sub_44:0", shape=(), dtype=float64)
PL:  Tensor("sub_45:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  23
output_Z_Vals[:, i, :]:  [[ 1.19271183e+02 -4.92738716e+01 -4.92570741e+01]
 [ 5.79280326e-02  1.00611443e-01 -2.92308400e-02]
 [-2.48029021e+00 -2.94679151e+00 -8.83222200e-01]
 [-6.91421193e-03  5.49337761e-02 -1.07770286e-01]
 [ 3.43992391e-01  3.74290055e-02 -3.20814962e-01]
 [-1.37402556e-01 -1.99453184e-01  4.24885818e-02]
 [-2.60610438e-02  3.91148325e-02 -7.73611199e-02]
 [-1.56731898e-02  2.33630659e-02 -2.72873271e-02]
 [ 6.10714157e-03 -1.44207099e-01  8.80111592e-03]
 [-1.02860024e+00 -4.02678352e-01 -3.67895172e-02]
 [ 3.78308387e-01  7.60298984e-02 -1.18322342e-02]
 [ 2.56921707e-02 -4.43975961e-02  3.61253213e-02]
 [-7.36566276e-01 -1.21353107e+00  2.62313671e-01]
 [-1.29433736e-02  5.62543165e-03  2.04637195e-02]
 [ 1.13394701e-01  1.21049418e-01 -1.05472009e-01]
 [ 7.54121110e-02  2.99350785e-02  5.84639787e-02]
 [ 2.58757466e-02  1.41531886e-02 -2.42194029e-03]
 [ 1.57175142e-03 -9.55575706e-02  1.78999757e-01]
 [ 1.43239038e-04  3.49727323e-02 -1.30467541e-02]
 [ 6.76141716e-02 -5.80884003e-01 -4.67828992e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.27118322 -49.27387164 -49.25707411]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [   7.3268874   -15.90307369 -140.51672192]
init_Out:  [2.48374395]
Stock Position:  7.326887399052493
Bond position:  [-730.20499595]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-4.05247388]
curr_Stock_Price:  99.13283179894827
curr_Factors:  [99.1328318  -1.06543162 -1.0191663 ]
mat_Sqrt:  [[12.32787273  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00588086  0.0324722  -0.08338745]
Stock Position:  0.005880863531392612
Bond Position:  [-4.63546054]


portfolio before change:  [-4.05814142]
curr_Stock_Price:  98.36618828064881
curr_Factors:  [98.36618828 -0.87478257 -1.02462743]
mat_Sqrt:  [[14.72117797  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.22159154 -0.95107287 -2.5195871 ]
Stock Position:  -0.2215915389792112
Bond Position:  [17.73897363]


portfolio before change:  [-4.18345094]
curr_Stock_Price:  98.95170171629685
curr_Factors:  [98.95170172 -1.08120539 -1.0325779 ]
mat_Sqrt:  [[11.95140189  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00148095  0.0177298  -0.30743863]
Stock Position:  -0.0014809492240088883
Bond Position:  [-4.0369085]


portfolio before change:  [-4.18605129]
curr_Stock_Price:  100.02600860762158
curr_Factors:  [100.02600861  -1.27619945  -1.03607353]
mat_Sqrt:  [[ 9.90616469  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0288857   0.01208016 -0.91519579]
Stock Position:  0.028885697365248562
Bond Position:  [-7.07537231]


portfolio before change:  [-4.18392635]
curr_Stock_Price:  100.16081595570796
curr_Factors:  [100.16081596  -1.50255834  -1.0138794 ]
mat_Sqrt:  [[ 8.08765891  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02095079 -0.06437324  0.1212081 ]
Stock Position:  -0.020950787314836034
Bond Position:  [-2.0854784]


portfolio before change:  [-4.16378482]
curr_Stock_Price:  99.17455371794213
curr_Factors:  [99.17455372 -1.77445939 -1.0001081 ]
mat_Sqrt:  [[ 6.18615647  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00547481  0.01262426 -0.22068974]
Stock Position:  -0.005474810519585823
Bond Position:  [-3.62082293]


portfolio before change:  [-4.16437424]
curr_Stock_Price:  99.11685451828158
curr_Factors:  [99.11685452 -1.79070994 -0.99932545]
mat_Sqrt:  [[ 6.08766205  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00270617  0.0075404  -0.07784315]
Stock Position:  -0.0027061663550629698
Bond Position:  [-3.89614755]


portfolio before change:  [-4.16634927]
curr_Stock_Price:  99.4867002077197
curr_Factors:  [99.48670021 -1.52069228 -0.98980665]
mat_Sqrt:  [[ 8.08107603  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00266456 -0.04654264  0.02510713]
Stock Position:  -0.002664557155823351
Bond Position:  [-3.90126127]


portfolio before change:  [-4.17012936]
curr_Stock_Price:  100.53927968257422
curr_Factors:  [100.53927968  -1.63425644  -0.99428651]
mat_Sqrt:  [[ 7.25728316  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.15409434 -0.12996388 -0.10495025]
Stock Position:  -0.15409433737278933
Bond Position:  [11.32240432]


portfolio before change:  [-4.2501074]
curr_Stock_Price:  101.07667124655401
curr_Factors:  [101.07667125  -1.69148098  -1.0091509 ]
mat_Sqrt:  [[ 6.78861859  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.05765719  0.02453854 -0.03375407]
Stock Position:  0.05765719117358036
Bond Position:  [-10.07790436]


portfolio before change:  [-4.21349078]
curr_Stock_Price:  101.7554489597849
curr_Factors:  [101.75544896  -1.60136808  -1.02638378]
mat_Sqrt:  [[ 7.35088352  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0032654  -0.01432926  0.10305549]
Stock Position:  0.003265403357712793
Bond Position:  [-4.54576336]


portfolio before change:  [-4.21335387]
curr_Stock_Price:  102.14544416496211
curr_Factors:  [102.14544416  -1.82205574  -1.06978628]
mat_Sqrt:  [[ 5.66640964  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.1642544  -0.39166547  0.74830789]
Stock Position:  -0.16425439980496476
Bond Position:  [12.56448475]


portfolio before change:  [-4.15950264]
curr_Stock_Price:  101.83671751061804
curr_Factors:  [101.83671751  -1.48661144  -1.05942545]
mat_Sqrt:  [[ 7.98315612  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00095425  0.0018156   0.0583773 ]
Stock Position:  -0.0009542526566850328
Bond Position:  [-4.06232469]


portfolio before change:  [-4.16074175]
curr_Stock_Price:  102.07082832497315
curr_Factors:  [102.07082832  -1.40376136  -1.0393483 ]
mat_Sqrt:  [[ 8.86895798  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0131441   0.03906853 -0.30088228]
Stock Position:  0.013144095049149812
Bond Position:  [-5.50237042]


portfolio before change:  [-4.15277314]
curr_Stock_Price:  102.78174650325742
curr_Factors:  [102.7817465   -0.73713562  -1.04848982]
mat_Sqrt:  [[17.23569188  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00542227 0.00966151 0.16678146]
Stock Position:  0.005422265240290599
Bond Position:  [-4.71008303]


portfolio before change:  [-4.15013106]
curr_Stock_Price:  103.48620319652042
curr_Factors:  [103.4862032  -0.7359562  -1.0450872]
mat_Sqrt:  [[17.43352187  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00162161  0.00456792 -0.00690912]
Stock Position:  0.0016216102422815196
Bond Position:  [-4.31794535]


portfolio before change:  [-4.15066617]
curr_Stock_Price:  103.82198562091332
curr_Factors:  [103.82198562  -0.85818599  -1.01848165]
mat_Sqrt:  [[15.89508768  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00117044 -0.03084107  0.51063648]
Stock Position:  0.0011704444040267234
Bond Position:  [-4.27218403]


portfolio before change:  [-4.15294904]
curr_Stock_Price:  102.78418479402123
curr_Factors:  [102.78418479  -0.8651608   -0.9680688 ]
mat_Sqrt:  [[16.43481424  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00028104  0.0112874  -0.03721876]
Stock Position:  0.0002810412412522135
Bond Position:  [-4.18183563]


portfolio before change:  [-4.15429727]
curr_Stock_Price:  101.70733714727048
curr_Factors:  [101.70733715  -0.8980891   -0.97719976]
mat_Sqrt:  [[15.59282051  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00939237 -0.18747951 -1.3345859 ]
Stock Position:  -0.00939236567264855
Bond Position:  [-3.19902477]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-4.15231345]
Stock Price:  101.41096083267313
PL:  [-5.56327428]
Settle:  Tensor("sub_46:0", shape=(), dtype=float64)
PL:  Tensor("sub_47:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  24
output_Z_Vals[:, i, :]:  [[ 1.19271183e+02 -4.92738716e+01 -4.92570741e+01]
 [ 1.97940241e-02  3.95933062e-02 -4.61966755e-02]
 [-2.24385132e+00 -3.02060925e+00 -8.60625170e-01]
 [-1.97012396e-01 -2.95511889e-02  1.28476572e-01]
 [ 8.59633106e-01  3.22364914e-02 -5.49466267e-01]
 [ 7.57666602e-02  1.17647425e-01 -6.46378120e-03]
 [ 6.48945423e-02 -6.08038839e-02  8.71775340e-02]
 [-6.77839296e-02  1.46863962e-01  3.30738342e-01]
 [-1.64516041e-02 -2.02291520e-01  2.83649859e-02]
 [-1.23462841e+00 -5.08867289e-01 -4.68189366e-02]
 [ 3.14362068e-01  3.55226844e-02 -5.94308922e-02]
 [ 5.91963247e-02  9.92263694e-03  2.20902037e-02]
 [-5.72381353e-01 -1.08124065e+00  2.03799461e-01]
 [ 1.08593974e-01  8.59849638e-02 -1.56256065e-01]
 [-1.82227959e-01 -2.34531481e-01  8.65347180e-02]
 [-1.88546767e-02  5.53081358e-02  1.03095522e-01]
 [ 1.22487374e-01  1.08811909e-01  9.21196550e-02]
 [ 9.85428388e-02 -1.58409036e-02  1.43040313e-02]
 [-4.34970187e-02 -3.85548077e-02 -2.91449470e-02]
 [ 5.69007484e-02 -4.55454753e-01 -4.52571346e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.27118322 -49.27387164 -49.25707411]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [   7.3268874   -15.90307369 -140.51672192]
init_Out:  [2.48374395]
Stock Position:  7.326887399052493
Bond position:  [-730.20499595]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [3.49887229]
curr_Stock_Price:  100.16346674112737
curr_Factors:  [100.16346674  -0.84762928  -0.9612664 ]
mat_Sqrt:  [[16.41027791  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00112406  0.01277868 -0.13178626]
Stock Position:  0.0011240587818612789
Bond Position:  [3.38628266]


portfolio before change:  [3.49979608]
curr_Stock_Price:  100.23206798729815
curr_Factors:  [100.23206799  -0.96599522  -0.96424071]
mat_Sqrt:  [[14.54507211  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.20873771 -0.97489744 -2.45512406]
Stock Position:  -0.20873770572814276
Bond Position:  [24.42200799]


portfolio before change:  [3.09315239]
curr_Stock_Price:  102.20942973068638
curr_Factors:  [102.20942973  -0.87960392  -0.96826625]
mat_Sqrt:  [[16.10538631  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01097889 -0.00953761  0.3665079 ]
Stock Position:  -0.01097889445731744
Bond Position:  [4.21529893]


portfolio before change:  [3.09542988]
curr_Stock_Price:  102.09798502670806
curr_Factors:  [102.09798503  -1.08322228  -0.92742689]
mat_Sqrt:  [[13.67109594  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.05515681  0.01040428 -1.56747432]
Stock Position:  0.055156808447219104
Bond Position:  [-2.53596912]


portfolio before change:  [3.104324]
curr_Stock_Price:  102.2707322724615
curr_Factors:  [102.27073227  -0.77709281  -0.90662211]
mat_Sqrt:  [[18.98992569  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00518496  0.03797054 -0.01843937]
Stock Position:  0.0051849558625667825
Bond Position:  [2.57405477]


portfolio before change:  [3.11211929]
curr_Stock_Price:  103.65004839982163
curr_Factors:  [103.6500484   -0.60093633  -0.94344875]
mat_Sqrt:  [[22.12338573  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00317664 -0.01962437  0.24869324]
Stock Position:  0.0031766404102294113
Bond Position:  [2.78286035]


portfolio before change:  [3.11741454]
curr_Stock_Price:  105.09794781072158
curr_Factors:  [105.09794781  -0.50285287  -0.96368336]
mat_Sqrt:  [[24.24854252  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00122507 0.04740014 0.94350443]
Stock Position:  0.0012250729056370313
Bond Position:  [2.9886619]


portfolio before change:  [3.11580299]
curr_Stock_Price:  103.17250111679013
curr_Factors:  [103.17250112  -0.72624444  -0.91236458]
mat_Sqrt:  [[20.04126377  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00259236 -0.06528931  0.08091741]
Stock Position:  -0.0025923619312984945
Bond Position:  [3.38326345]


portfolio before change:  [3.11900481]
curr_Stock_Price:  102.26371491011191
curr_Factors:  [102.26371491  -0.52319102  -0.91572337]
mat_Sqrt:  [[24.25543028  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.05557755 -0.16423621 -0.13356139]
Stock Position:  -0.05557754965124713
Bond Position:  [8.80257151]


portfolio before change:  [3.23568421]
curr_Stock_Price:  100.20391784323738
curr_Factors:  [100.20391784  -0.34662285  -0.94623561]
mat_Sqrt:  [[27.50447794  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01125205  0.0114649  -0.16953979]
Stock Position:  0.01125205236017736
Bond Position:  [2.10818448]


portfolio before change:  [3.19651656]
curr_Stock_Price:  96.6761386044044
curr_Factors:  [ 9.66761386e+01  1.96369954e-02 -9.29149877e-01]
mat_Sqrt:  [[38.93344827  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00168829 0.00320252 0.0630172 ]
Stock Position:  0.0016882891550442554
Bond Position:  [3.03329929]


portfolio before change:  [3.20328215]
curr_Stock_Price:  100.23427646323707
curr_Factors:  [100.23427646   0.23555942  -0.91949546]
mat_Sqrt:  [[50.5809066   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01485715 -0.34896892  0.58138314]
Stock Position:  -0.014857153331767473
Bond Position:  [4.69247816]


portfolio before change:  [3.15349297]
curr_Stock_Price:  103.6644382684411
curr_Factors:  [103.66443827   0.17648808  -0.89497557]
mat_Sqrt:  [[50.53527665  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00186503  0.02775153 -0.44575506]
Stock Position:  0.0018650327337600288
Bond Position:  [2.9601554]


portfolio before change:  [3.15385457]
curr_Stock_Price:  103.46147281999137
curr_Factors:  [ 1.03461473e+02  8.37458384e-03 -9.22641429e-01]
mat_Sqrt:  [[41.46843168  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00512288 -0.07569471  0.24685946]
Stock Position:  -0.005122876935778662
Bond Position:  [3.68387496]


portfolio before change:  [3.17362323]
curr_Stock_Price:  99.78237329936185
curr_Factors:  [99.7823733  -0.3224596  -0.92393448]
mat_Sqrt:  [[28.69140099  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.0004698  0.01785062 0.29410283]
Stock Position:  0.00046980398767790515
Bond Position:  [3.12674507]


portfolio before change:  [3.1749576]
curr_Stock_Price:  100.95858778939117
curr_Factors:  [100.95858779  -0.67194815  -0.93833658]
mat_Sqrt:  [[20.17462616  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00810436 0.03511889 0.26279173]
Stock Position:  0.008104356251631993
Bond Position:  [2.35675324]


portfolio before change:  [3.16658881]
curr_Stock_Price:  99.85325060343116
curr_Factors:  [99.8532506  -0.70481694 -0.94631164]
mat_Sqrt:  [[19.1551773   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00512807 -0.00511263  0.04080542]
Stock Position:  0.0051280718788511
Bond Position:  [2.65453417]


portfolio before change:  [3.16871199]
curr_Stock_Price:  100.1378532786951
curr_Factors:  [100.13785328  -0.50599369  -0.94910813]
mat_Sqrt:  [[23.36983172  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00245257 -0.01244351 -0.08314242]
Stock Position:  -0.0024525710748406326
Bond Position:  [3.4143072]


portfolio before change:  [3.16987524]
curr_Stock_Price:  100.01163427629436
curr_Factors:  [100.01163428  -0.56203204  -0.92861065]
mat_Sqrt:  [[22.52540605  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00570242 -0.14699739 -1.29106008]
Stock Position:  -0.005702418974635305
Bond Position:  [3.74018348]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [3.17418923]
Stock Price:  99.41910814601394
PL:  [3.17418923]
Settle:  Tensor("sub_48:0", shape=(), dtype=float64)
PL:  Tensor("sub_49:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  25
output_Z_Vals[:, i, :]:  [[ 1.19271183e+02 -4.92738716e+01 -4.92570741e+01]
 [ 2.01885932e-02  4.13281411e-02 -4.50778113e-02]
 [-2.37039966e+00 -3.18936472e+00 -9.09443003e-01]
 [-5.53253479e-01 -4.76822273e-01  3.72093536e-01]
 [ 1.27197322e+00  3.01415035e-01 -9.43002630e-01]
 [ 8.33872398e-02  2.17965000e-01  5.28116498e-02]
 [ 3.04037879e-02  1.81652683e-02  1.11912182e-01]
 [ 1.20363032e-01  3.70329401e-01  2.70889648e-01]
 [ 1.01363476e-01  1.01059598e-01 -7.38090859e-02]
 [-1.04238163e+00 -4.26101112e-01 -3.71134840e-02]
 [ 1.38607150e-01 -9.32822556e-03 -1.51027191e-01]
 [-8.60073228e-03 -4.62767443e-02  3.01398549e-02]
 [-5.96106028e-01 -1.28729035e+00  2.10503407e-01]
 [ 3.69735972e-02  5.02739369e-02  1.17897134e-01]
 [ 9.10398251e-02  1.30281484e-01 -1.04077389e-01]
 [ 6.48174882e-02  3.27867506e-02  6.34801077e-02]
 [ 1.25539909e-01  1.15578973e-01  1.03380930e-01]
 [ 1.03202663e-01 -1.44386495e-02  1.53222208e-03]
 [-4.90300706e-02 -1.09652850e-01  2.07001072e-03]
 [ 6.91519543e-02 -5.10014282e-01 -5.45660648e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.27118322 -49.27387164 -49.25707411]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [   7.3268874   -15.90307369 -140.51672192]
init_Out:  [2.48374395]
Stock Position:  7.326887399052493
Bond position:  [-730.20499595]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [3.80849913]
curr_Stock_Price:  100.20572572915394
curr_Factors:  [100.20572573  -0.91636532  -0.98335273]
mat_Sqrt:  [[14.99185843  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00129558  0.0133386  -0.12859445]
Stock Position:  0.0012955828727514594
Bond Position:  [3.67867431]


portfolio before change:  [3.80943003]
curr_Stock_Price:  100.21430093055619
curr_Factors:  [100.21430093  -0.68233415  -1.04420155]
mat_Sqrt:  [[17.82808825  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.17988834 -1.02936304 -2.59438775]
Stock Position:  -0.1798883447625315
Bond Position:  [21.83681474]


portfolio before change:  [3.16573037]
curr_Stock_Price:  103.82298131552591
curr_Factors:  [103.82298132  -0.50552634  -1.03868987]
mat_Sqrt:  [[22.16403959  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02592628 -0.15389373  1.06147929]
Stock Position:  -0.025926282081124814
Bond Position:  [5.85747427]


portfolio before change:  [3.09379019]
curr_Stock_Price:  106.65426800853783
curr_Factors:  [106.65426801  -0.63874797  -1.03426077]
mat_Sqrt:  [[20.01703621  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.05700193  0.09728128 -2.69012402]
Stock Position:  0.05700193024075605
Bond Position:  [-2.98570896]


portfolio before change:  [3.01740906]
curr_Stock_Price:  105.327390078812
curr_Factors:  [105.32739008  -0.45419143  -1.0006066 ]
mat_Sqrt:  [[24.58841683  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00563921 0.0703479  0.15065694]
Stock Position:  0.005639211861875366
Bond Position:  [2.4234456]


portfolio before change:  [3.00429465]
curr_Stock_Price:  102.89436431082906
curr_Factors:  [102.89436431  -0.31960186  -0.99344575]
mat_Sqrt:  [[27.67848131  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00205776 0.00586282 0.3192543 ]
Stock Position:  0.002057762333104203
Bond Position:  [2.79256251]


portfolio before change:  [3.00386146]
curr_Stock_Price:  102.34453404669934
curr_Factors:  [102.34453405  -0.46452276  -1.05975282]
mat_Sqrt:  [[22.28846612  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01127271 0.1195233  0.77277277]
Stock Position:  0.011272705859413411
Bond Position:  [1.85016163]


portfolio before change:  [2.97608509]
curr_Stock_Price:  99.83945957313502
curr_Factors:  [99.83945957 -0.61091838 -1.050812  ]
mat_Sqrt:  [[18.9505531   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00564237  0.03261685 -0.21055678]
Stock Position:  0.005642366367833482
Bond Position:  [2.41275428]


portfolio before change:  [2.97675186]
curr_Stock_Price:  99.85071489459216
curr_Factors:  [99.85071489 -0.86578217 -1.05543531]
mat_Sqrt:  [[14.62099827  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.07776042 -0.13752354 -0.10587444]
Stock Position:  -0.07776041652715436
Bond Position:  [10.74118504]


portfolio before change:  [3.04588197]
curr_Stock_Price:  98.99623798760622
curr_Factors:  [98.99623799 -0.76119222 -1.05042253]
mat_Sqrt:  [[16.17500419  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00654558 -0.00301067 -0.43083854]
Stock Position:  0.006545577130685214
Bond Position:  [2.39789446]


portfolio before change:  [3.0407135]
curr_Stock_Price:  98.1150290754516
curr_Factors:  [98.11502908 -0.65443151 -1.0050915 ]
mat_Sqrt:  [[18.66439222  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00063729 -0.01493575  0.08598062]
Stock Position:  -0.0006372916345978678
Bond Position:  [3.10324139]


portfolio before change:  [3.04109477]
curr_Stock_Price:  98.73427100283328
curr_Factors:  [98.734271   -0.92886235 -1.02910301]
mat_Sqrt:  [[13.93587913  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.05854702 -0.41547117  0.60050763]
Stock Position:  -0.05854702339219252
Bond Position:  [8.82169244]


portfolio before change:  [3.02740612]
curr_Stock_Price:  99.00575106671319
curr_Factors:  [99.00575107 -0.39787825 -1.06373503]
mat_Sqrt:  [[22.95566288  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00310605 0.01622584 0.33632771]
Stock Position:  0.0031060472416482247
Bond Position:  [2.71988958]


portfolio before change:  [3.03149153]
curr_Stock_Price:  100.10211331685105
curr_Factors:  [100.10211332  -0.51910975  -1.06772552]
mat_Sqrt:  [[20.47808977  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00470692  0.04204817 -0.29690382]
Stock Position:  0.004706919185629613
Bond Position:  [2.56031897]


portfolio before change:  [3.04130788]
curr_Stock_Price:  102.05162447844259
curr_Factors:  [102.05162448  -0.51779758  -1.07942929]
mat_Sqrt:  [[20.66108422  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00408826 0.01058188 0.18109108]
Stock Position:  0.004088259719568174
Bond Position:  [2.62409434]


portfolio before change:  [3.03368273]
curr_Stock_Price:  100.02600442908478
curr_Factors:  [100.02600443  -0.56476536  -1.06663645]
mat_Sqrt:  [[19.57059896  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.0086985  0.03730295 0.29491702]
Stock Position:  0.008698502935796196
Bond Position:  [2.16360623]


portfolio before change:  [3.03018706]
curr_Stock_Price:  99.56194351650217
curr_Factors:  [99.56194352 -0.49443351 -1.04167852]
mat_Sqrt:  [[21.42734627  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00469345 -0.00466005  0.004371  ]
Stock Position:  0.004693448672421031
Bond Position:  [2.56289819]


portfolio before change:  [3.02822851]
curr_Stock_Price:  99.0081180593422
curr_Factors:  [99.00811806 -0.56995762 -1.01606279]
mat_Sqrt:  [[20.27080012  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0035021  -0.03539031  0.00590516]
Stock Position:  -0.0035020978605568194
Bond Position:  [3.37496463]


portfolio before change:  [3.0352311]
curr_Stock_Price:  97.2495312180216
curr_Factors:  [97.24953122 -0.7610493  -0.98835999]
mat_Sqrt:  [[16.90942017  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00865416 -0.1646064  -1.55661795]
Stock Position:  -0.008654157689130049
Bond Position:  [3.87684388]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [3.04611478]
Stock Price:  96.10391474353666
PL:  [3.04611478]
Settle:  Tensor("sub_50:0", shape=(), dtype=float64)
PL:  Tensor("sub_51:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  26
output_Z_Vals[:, i, :]:  [[ 1.19271183e+02 -4.92738716e+01 -4.92570741e+01]
 [ 3.00520251e-02  5.71748542e-02 -4.05005442e-02]
 [-2.46995298e+00 -3.13848674e+00 -9.16254911e-01]
 [-5.58449253e-03  6.58867777e-02 -1.03046539e-01]
 [ 5.49211274e-01 -1.56463976e-01 -1.97085067e-01]
 [-1.47712969e-01 -2.65014257e-01  6.90733664e-02]
 [-6.17544485e-03  2.68918001e-02  3.43434957e-02]
 [ 1.53743306e-01  4.06376756e-01  2.63269426e-01]
 [-2.44002334e-01  4.85753363e-01 -9.68988758e-02]
 [-6.18278040e-01 -2.11477143e-01 -1.63839410e-02]
 [-6.59882510e-02 -3.75716500e-02 -3.39542803e-01]
 [ 5.34172939e-01  2.67878380e-01 -7.07986732e-03]
 [-7.23628727e-01 -9.65994915e-01  2.34867680e-01]
 [ 2.59093632e-01  5.04410087e-02  1.25589979e-01]
 [ 1.40630443e-01  1.51011552e-01 -1.05950932e-01]
 [-3.52286371e-01  1.78883226e-01  9.82026595e-02]
 [-1.00744434e-01  1.27943683e-01  1.99836193e-01]
 [ 1.10642570e-01 -1.21894934e-02 -1.84224587e-02]
 [-1.06979127e-01 -5.41158856e-01  1.65277142e-01]
 [ 6.23460525e-02 -4.45993076e-01 -4.96033771e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.27118322 -49.27387164 -49.25707411]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [   7.3268874   -15.90307369 -140.51672192]
init_Out:  [2.48374395]
Stock Position:  7.326887399052493
Bond position:  [-730.20499595]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-0.89620073]
curr_Stock_Price:  99.56361133448972
curr_Factors:  [99.56361133 -0.69786421 -0.97977359]
mat_Sqrt:  [[18.59995094  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0017987   0.0184531  -0.11553678]
Stock Position:  0.0017986958382467395
Bond Position:  [-1.07528539]


portfolio before change:  [-0.89757332]
curr_Stock_Price:  98.94998460539979
curr_Factors:  [98.94998461 -0.78817654 -0.95667128]
mat_Sqrt:  [[17.28374917  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.19079331 -1.01294224 -2.61382022]
Stock Position:  -0.1907933066746383
Bond Position:  [17.98142144]


portfolio before change:  [-0.8815368]
curr_Stock_Price:  98.88949716242757
curr_Factors:  [98.88949716 -0.94247416 -0.98141328]
mat_Sqrt:  [[14.44163844  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00091193  0.02126487 -0.29396309]
Stock Position:  -0.0009119254061769748
Bond Position:  [-0.79135695]


portfolio before change:  [-0.88096663]
curr_Stock_Price:  98.04728863413092
curr_Factors:  [98.04728863 -0.92085206 -0.9373105 ]
mat_Sqrt:  [[15.29135044  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.03119694 -0.05049853 -0.56222884]
Stock Position:  0.03119694234158936
Bond Position:  [-3.93974224]


portfolio before change:  [-0.8922308]
curr_Stock_Price:  97.71779777743443
curr_Factors:  [97.71779778 -0.771323   -0.9488101 ]
mat_Sqrt:  [[17.49562072  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01072893 -0.08553298  0.19704709]
Stock Position:  -0.010728926873474258
Bond Position:  [0.15617631]


portfolio before change:  [-0.9006813]
curr_Stock_Price:  98.50907447677507
curr_Factors:  [98.50907448 -0.53428441 -0.95708633]
mat_Sqrt:  [[22.17084046  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00028525 0.00867929 0.09797243]
Stock Position:  0.0002852466324083475
Bond Position:  [-0.92878068]


portfolio before change:  [-0.90109194]
curr_Stock_Price:  97.88357835721605
curr_Factors:  [ 9.78835784e+01 -8.61013260e-02 -9.95229598e-01]
mat_Sqrt:  [[33.19661364  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00874891 0.13115753 0.75103439]
Stock Position:  0.00874891227307094
Bond Position:  [-1.75746678]


portfolio before change:  [-0.94869156]
curr_Stock_Price:  92.49317211254196
curr_Factors:  [92.49317211 -0.2045897  -0.94060367]
mat_Sqrt:  [[29.4278483   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00559428  0.15677622 -0.27642552]
Stock Position:  -0.00559428411020821
Bond Position:  [-0.43125847]


portfolio before change:  [-0.95448276]
curr_Stock_Price:  93.50909831145498
curr_Factors:  [93.50909831 -0.4719967  -0.95042156]
mat_Sqrt:  [[22.54786735  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0294835  -0.06825395 -0.04673882]
Stock Position:  -0.029483497430684964
Bond Position:  [1.8024925]


portfolio before change:  [-0.96205787]
curr_Stock_Price:  93.78131101421782
curr_Factors:  [93.78131101 -0.35159697 -0.97628508]
mat_Sqrt:  [[24.85561143  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00575188 -0.0121262  -0.96862111]
Stock Position:  -0.005751876864442299
Bond Position:  [-0.42263931]


portfolio before change:  [-0.94357487]
curr_Stock_Price:  90.54955394108669
curr_Factors:  [90.54955394 -0.25953252 -0.94055122]
mat_Sqrt:  [[27.2707177   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.02153989  0.08645738 -0.02019689]
Stock Position:  0.021539888270779305
Bond Position:  [-2.89400215]


portfolio before change:  [-0.89920852]
curr_Stock_Price:  92.6428767487409
curr_Factors:  [92.64287675 -0.6184261  -0.96034631]
mat_Sqrt:  [[19.10556508  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.04568666 -0.31177352  0.67001212]
Stock Position:  -0.04568665965459652
Bond Position:  [3.33333506]


portfolio before change:  [-0.86924356]
curr_Stock_Price:  92.00523920547249
curr_Factors:  [92.00523921 -0.71211103 -0.94418491]
mat_Sqrt:  [[17.55870068  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01680226 0.01627977 0.35827325]
Stock Position:  0.01680225731815247
Bond Position:  [-2.41513926]


portfolio before change:  [-0.8691501]
curr_Stock_Price:  92.04674058844027
curr_Factors:  [92.04674059 -0.44050996 -0.95476332]
mat_Sqrt:  [[22.8059898   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0065697   0.04873877 -0.30224852]
Stock Position:  0.006569695295374437
Bond Position:  [-1.47386914]


portfolio before change:  [-0.86700774]
curr_Stock_Price:  92.42893096531118
curr_Factors:  [92.42893097 -0.72655871 -0.99331772]
mat_Sqrt:  [[16.55293798  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0178655   0.05773431  0.28014485]
Stock Position:  -0.017865496253329304
Bond Position:  [0.78428098]


portfolio before change:  [-0.85705469]
curr_Stock_Price:  91.88279723424832
curr_Factors:  [91.88279723 -0.88272561 -1.0251227 ]
mat_Sqrt:  [[13.63534755  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00248154  0.04129365  0.57007703]
Stock Position:  -0.0024815389962983
Bond Position:  [-0.62904395]


portfolio before change:  [-0.85044284]
curr_Stock_Price:  89.1550014927326
curr_Factors:  [89.15500149 -0.6928386  -0.99993793]
mat_Sqrt:  [[16.40522543  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00636346 -0.00393414 -0.05255415]
Stock Position:  0.006363456049753012
Bond Position:  [-1.41777678]


portfolio before change:  [-0.85230612]
curr_Stock_Price:  88.91789894181274
curr_Factors:  [88.91789894 -0.88963924 -1.00055941]
mat_Sqrt:  [[13.43031965  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01367843 -0.17465827  0.47148968]
Stock Position:  -0.013678428022126947
Bond Position:  [0.36395096]


portfolio before change:  [-0.8590629]
curr_Stock_Price:  89.41852476057046
curr_Factors:  [89.41852476 -0.79742401 -1.00013828]
mat_Sqrt:  [[14.81685793  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00877004 -0.14394365 -1.41504628]
Stock Position:  -0.008770035666218956
Bond Position:  [-0.07485925]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-0.86927065]
Stock Price:  90.58032511382216
PL:  [-0.86927065]
Settle:  Tensor("sub_52:0", shape=(), dtype=float64)
PL:  Tensor("sub_53:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  27
output_Z_Vals[:, i, :]:  [[ 1.19271183e+02 -4.92738716e+01 -4.92570741e+01]
 [ 4.25949214e-02  7.73264285e-02 -3.46798330e-02]
 [-2.07722839e+00 -2.79841329e+00 -7.96347992e-01]
 [ 3.54023747e-02  1.26405525e-01 -8.45321478e-02]
 [ 6.10263875e-01 -1.41162631e-01 -2.61436108e-01]
 [-1.38437346e-01 -2.18723102e-01 -4.72555103e-02]
 [-4.39703476e-02  6.69204022e-02 -8.95962045e-02]
 [-5.12533073e-03  3.73198463e-02 -2.28715086e-02]
 [ 1.17322634e-02 -1.25466287e-01  7.32714310e-03]
 [-7.97983573e-01 -3.24783971e-01 -2.46922790e-02]
 [ 8.24828139e-02 -4.10423807e-02 -2.35339786e-01]
 [-1.13779999e-03 -5.44982066e-02  3.21824353e-02]
 [-6.24750606e-01 -1.22069898e+00  2.17079776e-01]
 [ 4.91030586e-02  6.08345520e-02  1.41143227e-01]
 [ 8.89374999e-02  1.20280001e-01 -1.03198256e-01]
 [-6.03119341e-02  6.64668630e-02  1.22723871e-01]
 [ 5.52544644e-02  4.29241266e-02  2.62058726e-02]
 [-1.96684345e-02 -1.12498010e-01  2.17048026e-01]
 [ 1.72218094e-02  4.23809521e-02  3.43886787e-03]
 [ 2.95500518e-02 -2.14509663e-01 -2.52907437e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.27118322 -49.27387164 -49.25707411]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [   7.3268874   -15.90307369 -140.51672192]
init_Out:  [2.48374395]
Stock Position:  7.326887399052493
Bond position:  [-730.20499595]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [1.86906355]
curr_Stock_Price:  99.94102457035488
curr_Factors:  [99.94102457 -1.26568222 -1.00409964]
mat_Sqrt:  [[10.32737769  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00496739  0.024957   -0.09893191]
Stock Position:  0.004967390832325432
Bond Position:  [1.37261742]


portfolio before change:  [1.87193742]
curr_Stock_Price:  100.45048164691424
curr_Factors:  [100.45048165  -1.18915994  -1.01693808]
mat_Sqrt:  [[11.06256481  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.25410075 -0.90318401 -2.27175916]
Stock Position:  -0.25410074580260084
Bond Position:  [27.39647972]


portfolio before change:  [2.12163195]
curr_Stock_Price:  99.49477977060005
curr_Factors:  [99.49477977 -0.87297968 -0.99617826]
mat_Sqrt:  [[15.34741791  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00286366  0.04079721 -0.24114669]
Stock Position:  0.0028636570836583224
Bond Position:  [1.83671302]


portfolio before change:  [2.12005914]
curr_Stock_Price:  98.78518057655363
curr_Factors:  [98.78518058 -0.74080662 -0.98149538]
mat_Sqrt:  [[17.64840833  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.02992246 -0.04556004 -0.74580445]
Stock Position:  0.029922457721723087
Bond Position:  [-0.83583625]


portfolio before change:  [2.09499434]
curr_Stock_Price:  97.95450641066923
curr_Factors:  [97.95450641 -1.35373752 -0.96271464]
mat_Sqrt:  [[ 9.66055391  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0199502  -0.07059258 -0.13480682]
Stock Position:  -0.01995020206600713
Bond Position:  [4.04920654]


portfolio before change:  [2.10071239]
curr_Stock_Price:  97.71863831385474
curr_Factors:  [97.71863831 -1.22893378 -0.95965129]
mat_Sqrt:  [[10.95183744  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00443752  0.02159847 -0.25559303]
Stock Position:  -0.004437522614382896
Bond Position:  [2.53434106]


portfolio before change:  [2.09746917]
curr_Stock_Price:  98.59229775696578
curr_Factors:  [98.59229776 -1.41825285 -0.91761026]
mat_Sqrt:  [[ 9.53653328  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00022818  0.01204493 -0.06524605]
Stock Position:  -0.00022818314311629447
Bond Position:  [2.11996627]


portfolio before change:  [2.09792209]
curr_Stock_Price:  98.93034876283042
curr_Factors:  [98.93034876 -1.40140987 -0.91859023]
mat_Sqrt:  [[ 9.72223906  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00127366 -0.04049407  0.0209023 ]
Stock Position:  -0.001273656034093675
Bond Position:  [2.22392533]


portfolio before change:  [2.09959163]
curr_Stock_Price:  98.05610049146819
curr_Factors:  [98.05610049 -1.30107003 -0.89396228]
mat_Sqrt:  [[10.91903358  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.07961511 -0.10482358 -0.0704402 ]
Stock Position:  -0.07961511491733199
Bond Position:  [9.90633934]


portfolio before change:  [2.10594481]
curr_Stock_Price:  98.00741272827402
curr_Factors:  [98.00741273 -1.17317452 -0.91861461]
mat_Sqrt:  [[12.10058716  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00215416 -0.01324637 -0.6713589 ]
Stock Position:  0.0021541550103342205
Bond Position:  [1.89482165]


portfolio before change:  [2.10696202]
curr_Stock_Price:  98.25968949041031
curr_Factors:  [98.25968949 -1.1972866  -0.9486189 ]
mat_Sqrt:  [[11.4926576   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00049536 -0.01758922  0.09180753]
Stock Position:  -0.0004953586841959335
Bond Position:  [2.15563581]


portfolio before change:  [2.10782344]
curr_Stock_Price:  97.60875244257593
curr_Factors:  [97.60875244 -0.81994738 -0.96217089]
mat_Sqrt:  [[16.42572806  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.05050696 -0.3939789   0.61926818]
Stock Position:  -0.050506955653001784
Bond Position:  [7.03774437]


portfolio before change:  [2.09695264]
curr_Stock_Price:  97.85882594858981
curr_Factors:  [97.85882595 -0.70354702 -0.93966695]
mat_Sqrt:  [[18.9217475   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00477396 0.01963427 0.40264234]
Stock Position:  0.004773956536481149
Bond Position:  [1.62977886]


portfolio before change:  [2.09680049]
curr_Stock_Price:  97.74159704577895
curr_Factors:  [97.74159705 -0.77760302 -0.95565583]
mat_Sqrt:  [[17.27168373  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0053512  0.0388202 -0.2943959]
Stock Position:  0.005351203623434261
Bond Position:  [1.57376531]


portfolio before change:  [2.10307406]
curr_Stock_Price:  98.84043023396649
curr_Factors:  [98.84043023 -0.51327469 -0.91076713]
mat_Sqrt:  [[23.79474857  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00091169  0.02145209  0.35009704]
Stock Position:  -0.000911694323655682
Bond Position:  [2.19318632]


portfolio before change:  [2.09977023]
curr_Stock_Price:  103.06575221576514
curr_Factors:  [103.06575222  -0.43420791  -0.90506235]
mat_Sqrt:  [[27.00702173  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00256843 0.0138537  0.07475806]
Stock Position:  0.002568427094229921
Bond Position:  [1.83505336]


portfolio before change:  [2.10324599]
curr_Stock_Price:  104.24038013460428
curr_Factors:  [104.24038013  -0.26370654  -0.90257057]
mat_Sqrt:  [[32.47343833  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 5.15112730e-05 -3.63085765e-02  6.19177603e-01]
Stock Position:  5.151127297977088e-05
Bond Position:  [2.09787644]


portfolio before change:  [2.10375851]
curr_Stock_Price:  104.00708000735384
curr_Factors:  [104.00708001  -0.43267597  -0.88165384]
mat_Sqrt:  [[27.94195066  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00095107 0.01367839 0.00981013]
Stock Position:  0.0009510696418017101
Bond Position:  [2.00484054]


portfolio before change:  [2.1016465]
curr_Stock_Price:  101.25935312668426
curr_Factors:  [101.25935313   0.12913555  -0.89702121]
mat_Sqrt:  [[46.98363834  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00140179 -0.0692327  -0.72147452]
Stock Position:  -0.0014017872308293145
Bond Position:  [2.24359057]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [2.10788852]
Stock Price:  97.2066374549439
PL:  [2.10788852]
Settle:  Tensor("sub_54:0", shape=(), dtype=float64)
PL:  Tensor("sub_55:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  28
output_Z_Vals[:, i, :]:  [[ 1.19271183e+02 -4.92738716e+01 -4.92570741e+01]
 [ 4.37186672e-02  7.37046872e-02 -4.08613150e-02]
 [-2.44872601e+00 -3.33968859e+00 -9.54812037e-01]
 [-4.42631787e-02  1.79146432e-02 -1.28103684e-01]
 [ 6.26330093e-01  1.41995497e-02 -4.25433997e-01]
 [ 7.57175145e-02  1.17192732e-01 -6.73936232e-03]
 [ 1.95998268e-02  3.17245354e-02  1.09751669e-01]
 [ 1.07585396e-01  3.09570564e-01  1.97704756e-01]
 [-2.29685504e-02 -2.19071401e-01  3.40167491e-02]
 [-1.28903315e+00 -5.29985069e-01 -4.96145134e-02]
 [ 3.68811114e-01  7.37307489e-02  7.32246777e-03]
 [-2.33200316e-01  1.44880285e-02  2.62716985e-02]
 [-8.33898475e-01 -1.02706405e+00  2.98939665e-01]
 [-2.94098020e-03 -3.40585858e-02 -2.04568742e-02]
 [-5.03656007e-02 -6.32923444e-03 -3.98526805e-02]
 [ 1.19453591e-01  1.32793102e-02  2.94803754e-02]
 [-5.42930652e-02 -6.43571104e-02 -8.05416785e-02]
 [-5.73490196e-02 -1.54797826e-01  2.49565774e-01]
 [ 6.07079710e-02 -9.73302481e-02  1.08073650e-01]
 [ 8.58164493e-02 -7.70090790e-01 -2.66967489e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.27118322 -49.27387164 -49.25707411]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [   7.3268874   -15.90307369 -140.51672192]
init_Out:  [2.48374395]
Stock Position:  7.326887399052493
Bond position:  [-730.20499595]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-4.26375704]
curr_Stock_Price:  99.1039951119347
curr_Factors:  [99.10399511 -0.66302525 -1.01879335]
mat_Sqrt:  [[18.43684574  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00273489  0.02378809 -0.11656596]
Stock Position:  0.0027348925739355077
Bond Position:  [-4.53479582]


portfolio before change:  [-4.2644577]
curr_Stock_Price:  99.26238569099067
curr_Factors:  [99.26238569 -0.541193   -1.03897451]
mat_Sqrt:  [[20.4421551   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.16267058 -1.07787986 -2.72381297]
Stock Position:  -0.16267058234605292
Bond Position:  [11.88261238]


portfolio before change:  [-4.18978924]
curr_Stock_Price:  98.82163334643073
curr_Factors:  [98.82163335 -0.73192085 -1.03692099]
mat_Sqrt:  [[16.85209016  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00396125  0.00578193 -0.36544415]
Stock Position:  -0.003961254762548895
Bond Position:  [-3.79833157]


portfolio before change:  [-4.19858579]
curr_Stock_Price:  100.80253352513222
curr_Factors:  [100.80253353  -0.87257915  -1.03648107]
mat_Sqrt:  [[14.94091263  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.03630215  0.00458288 -1.21364477]
Stock Position:  0.0363021474542768
Bond Position:  [-7.85793422]


portfolio before change:  [-4.20598828]
curr_Stock_Price:  100.65274180119752
curr_Factors:  [100.6527418   -0.89810916  -1.05146594]
mat_Sqrt:  [[14.32636133  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00685894  0.03782379 -0.01922552]
Stock Position:  0.006858944284928111
Bond Position:  [-4.89635983]


portfolio before change:  [-4.2003914]
curr_Stock_Price:  101.64722763027135
curr_Factors:  [101.64722763  -0.84369306  -1.02639738]
mat_Sqrt:  [[15.66482615  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00309474 0.01023905 0.31309096]
Stock Position:  0.0030947382123962877
Bond Position:  [-4.51496296]


portfolio before change:  [-4.20226265]
curr_Stock_Price:  101.40734502329666
curr_Factors:  [101.40734502  -0.62920697  -0.99136851]
mat_Sqrt:  [[20.05683613  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01052671 0.09991347 0.56399664]
Stock Position:  0.010526711979617992
Bond Position:  [-5.26974857]


portfolio before change:  [-4.18273736]
curr_Stock_Price:  103.38734578304116
curr_Factors:  [103.38734578  -0.82276079  -1.01469767]
mat_Sqrt:  [[16.46149668  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00368998 -0.07070499  0.09704032]
Stock Position:  -0.003689984826789413
Bond Position:  [-3.80123962]


portfolio before change:  [-4.18127734]
curr_Stock_Price:  102.73410447712254
curr_Factors:  [102.73410448  -0.61000492  -0.99086842]
mat_Sqrt:  [[20.72355128  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.06791034 -0.17105195 -0.1415364 ]
Stock Position:  -0.06791034042728467
Bond Position:  [2.79543067]


portfolio before change:  [-4.08354653]
curr_Stock_Price:  101.30528135283411
curr_Factors:  [101.30528135  -0.55838924  -1.02150767]
mat_Sqrt:  [[20.86851646  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.0184659  0.0237965  0.02088896]
Stock Position:  0.018465904516469154
Bond Position:  [-5.95424018]


portfolio before change:  [-4.0485538]
curr_Stock_Price:  103.28089404448971
curr_Factors:  [103.28089404  -0.55522046  -0.98609033]
mat_Sqrt:  [[22.11246802  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01016984  0.00467599  0.07494584]
Stock Position:  -0.010169840454922674
Bond Position:  [-2.99820358]


portfolio before change:  [-4.07402956]
curr_Stock_Price:  105.71221220156553
curr_Factors:  [105.7122122   -0.60231225  -1.00113306]
mat_Sqrt:  [[21.26952092  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.04619409 -0.3314835   0.85279166]
Stock Position:  -0.04619409376705483
Bond Position:  [0.80925028]


portfolio before change:  [-4.04055578]
curr_Stock_Price:  104.99195897799234
curr_Factors:  [104.99195898  -0.86503381  -0.99430989]
mat_Sqrt:  [[16.35510467  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00086021 -0.01099236 -0.05835777]
Stock Position:  -0.0008602147261408256
Bond Position:  [-3.95024015]


portfolio before change:  [-4.04096099]
curr_Stock_Price:  104.31484103566844
curr_Factors:  [104.31484104  -0.92884316  -0.97900751]
mat_Sqrt:  [[15.48021826  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00386251 -0.00204275 -0.1136886 ]
Stock Position:  -0.0038625065604866544
Bond Position:  [-3.63804424]


portfolio before change:  [-4.044979]
curr_Stock_Price:  105.11959941483046
curr_Factors:  [105.11959941  -1.23748299  -0.9760367 ]
mat_Sqrt:  [[11.49117151  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01115481 0.00428588 0.08409931]
Stock Position:  0.011154813487294142
Bond Position:  [-5.21756853]


portfolio before change:  [-4.04646962]
curr_Stock_Price:  105.10291941465755
curr_Factors:  [105.10291941  -1.23873738  -0.99693829]
mat_Sqrt:  [[11.23758981  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00746338 -0.02077117 -0.22976299]
Stock Position:  -0.007463380320410285
Bond Position:  [-3.26204656]


portfolio before change:  [-4.05563177]
curr_Stock_Price:  106.2212517210015
curr_Factors:  [106.22125172  -1.23389636  -1.0039198 ]
mat_Sqrt:  [[11.33287783  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00335348 -0.04996078  0.71194169]
Stock Position:  -0.00335348124373512
Bond Position:  [-3.6994208]


portfolio before change:  [-4.05751416]
curr_Stock_Price:  106.50674998439237
curr_Factors:  [106.50674998  -1.04316788  -1.03511005]
mat_Sqrt:  [[13.32884434  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00471916 -0.0314132   0.30830404]
Stock Position:  0.004719160731535452
Bond Position:  [-4.56013663]


portfolio before change:  [-4.05656971]
curr_Stock_Price:  106.94848673341966
curr_Factors:  [106.94848673  -1.04189018  -1.01397439]
mat_Sqrt:  [[13.68749601  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00919614 -0.24854573 -0.76158394]
Stock Position:  -0.009196144078362962
Bond Position:  [-3.07305601]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-4.05758164]
Stock Price:  106.97497305591648
PL:  [-11.0325547]
Settle:  Tensor("sub_56:0", shape=(), dtype=float64)
PL:  Tensor("sub_57:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  29
output_Z_Vals[:, i, :]:  [[ 1.19271183e+02 -4.92738716e+01 -4.92570741e+01]
 [ 5.37056321e-02  9.51770354e-02 -2.95237482e-02]
 [-2.29345038e+00 -2.26171026e+00 -7.13156683e-01]
 [-3.60875595e-02 -1.62635870e-02 -1.32052736e-01]
 [ 1.16485998e-01 -3.90802505e-02  1.67791316e-02]
 [-1.43729840e-01 -2.45324296e-01  1.64514891e-02]
 [-9.86813962e-03  2.98246815e-02  9.48434657e-03]
 [ 8.15496239e-02  1.49524520e-01  2.03070163e-02]
 [ 4.32024048e-02 -3.05921380e-02 -8.89393345e-03]
 [-8.58325955e-01 -3.49716125e-01 -2.77608698e-02]
 [-1.00059782e-02 -4.10235143e-02 -3.17862160e-01]
 [ 7.37609365e-02  1.69731071e-02  2.13274068e-02]
 [-6.60296000e-01 -1.08741873e+00  2.23294744e-01]
 [ 1.59886678e-01  6.86831481e-02  1.13364178e-01]
 [ 1.11932118e-01  1.39665505e-01 -1.04414198e-01]
 [-3.53630780e-01  1.85191751e-01  8.24737114e-02]
 [-1.29623175e-01  1.18263936e-01  1.99825272e-01]
 [ 1.10353405e-01 -1.22752331e-02 -1.75757940e-02]
 [-7.39900636e-02 -3.81037573e-01  1.11360106e-01]
 [ 5.95768541e-02 -4.31934339e-01 -4.76467454e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.27118322 -49.27387164 -49.25707411]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [   7.3268874   -15.90307369 -140.51672192]
init_Out:  [2.48374395]
Stock Position:  7.326887399052493
Bond position:  [-730.20499595]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-2.66144943]
curr_Stock_Price:  99.32268383011974
curr_Factors:  [99.32268383 -1.09662493 -1.00553484]
mat_Sqrt:  [[12.1364608   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00552938  0.03071826 -0.08422304]
Stock Position:  0.00552937584732574
Bond Position:  [-3.21064188]


portfolio before change:  [-2.66750035]
curr_Stock_Price:  98.37354308541916
curr_Factors:  [98.37354309 -1.64003982 -0.99772694]
mat_Sqrt:  [[ 7.03575597  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.41227873 -0.72996385 -2.03443751]
Stock Position:  -0.4122787320011958
Bond Position:  [37.88981926]


portfolio before change:  [-2.45196184]
curr_Stock_Price:  97.87372378566641
curr_Factors:  [97.87372379 -1.22792974 -0.96877569]
mat_Sqrt:  [[10.88050537  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00609921 -0.00524905 -0.3767097 ]
Stock Position:  -0.006099211382426261
Bond Position:  [-1.85500931]


portfolio before change:  [-2.44775495]
curr_Stock_Price:  97.10793596561632
curr_Factors:  [97.10793597 -1.21993233 -0.98487774]
mat_Sqrt:  [[10.70823454  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01045306 -0.0126131   0.04786619]
Stock Position:  0.010453058381302336
Bond Position:  [-3.46282987]


portfolio before change:  [-2.44145576]
curr_Stock_Price:  97.79338169365695
curr_Factors:  [97.79338169 -1.15769848 -1.05020373]
mat_Sqrt:  [[10.75052606  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01771525 -0.07917808  0.04693152]
Stock Position:  -0.017715254592764875
Bond Position:  [-0.70902111]


portfolio before change:  [-2.46547533]
curr_Stock_Price:  99.13924409489753
curr_Factors:  [99.13924409 -0.91954644 -1.06442247]
mat_Sqrt:  [[13.63386076  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00013527  0.00962587  0.0270562 ]
Stock Position:  -0.00013526747051894792
Bond Position:  [-2.45206502]


portfolio before change:  [-2.46614215]
curr_Stock_Price:  99.53644986565286
curr_Factors:  [99.53644987 -1.23311762 -1.04958168]
mat_Sqrt:  [[10.15356233  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01144587 0.04825883 0.05793027]
Stock Position:  0.011445868670956075
Bond Position:  [-3.60542329]


portfolio before change:  [-2.47665391]
curr_Stock_Price:  98.69682022227683
curr_Factors:  [98.69682022 -1.26521122 -1.06017127]
mat_Sqrt:  [[ 9.64722427  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00364274 -0.00987357 -0.02537192]
Stock Position:  0.00364274150575321
Bond Position:  [-2.83618092]


portfolio before change:  [-2.48063031]
curr_Stock_Price:  97.79989602255775
curr_Factors:  [97.79989602 -0.96483684 -1.0477413 ]
mat_Sqrt:  [[13.07033781  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.07156495 -0.11287039 -0.07919403]
Stock Position:  -0.07156495399616253
Bond Position:  [4.51841475]


portfolio before change:  [-2.30260571]
curr_Stock_Price:  95.32808755309448
curr_Factors:  [95.32808755 -0.70949908 -1.03462874]
mat_Sqrt:  [[16.66309972  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00499686 -0.01324028 -0.90677227]
Stock Position:  -0.00499686199525851
Bond Position:  [-1.82626441]


portfolio before change:  [-2.30669057]
curr_Stock_Price:  96.05419130717736
curr_Factors:  [96.05419131 -0.79075819 -0.99948124]
mat_Sqrt:  [[16.03338468  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00508807 0.00547805 0.06084116]
Stock Position:  0.00508807078554206
Bond Position:  [-2.79542109]


portfolio before change:  [-2.30983799]
curr_Stock_Price:  95.57297270111499
curr_Factors:  [95.5729727  -0.54350185 -0.98029662]
mat_Sqrt:  [[20.82369652  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.04017945 -0.35096288  0.63699775]
Stock Position:  -0.04017944500974708
Bond Position:  [1.53023102]


portfolio before change:  [-2.28565626]
curr_Stock_Price:  94.98065186169825
curr_Factors:  [94.98065186 -0.50777568 -0.96885782]
mat_Sqrt:  [[21.69408631  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00908298 0.02216739 0.32339644]
Stock Position:  0.009082979119015528
Bond Position:  [-3.14836354]


portfolio before change:  [-2.29800508]
curr_Stock_Price:  93.70776132859119
curr_Factors:  [93.70776133 -0.36070043 -0.91810237]
mat_Sqrt:  [[26.08546375  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00456683  0.04507685 -0.29786464]
Stock Position:  0.004566825481040051
Bond Position:  [-2.72595208]


portfolio before change:  [-2.30680009]
curr_Stock_Price:  91.93115876394941
curr_Factors:  [ 9.19311588e+01 -3.40997575e-02 -8.97896438e-01]
mat_Sqrt:  [[36.19944646  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00825962  0.05977038  0.23527454]
Stock Position:  -0.00825962343160157
Bond Position:  [-1.54748334]


portfolio before change:  [-2.29685867]
curr_Stock_Price:  90.68069723621973
curr_Factors:  [90.68069724 -0.1995688  -0.96354601]
mat_Sqrt:  [[28.33873826  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00228286  0.03816952  0.57004588]
Stock Position:  -0.002282864081959335
Bond Position:  [-2.08984696]


portfolio before change:  [-2.29698415]
curr_Stock_Price:  90.50677202027384
curr_Factors:  [90.50677202 -0.33894382 -1.01427584]
mat_Sqrt:  [[23.3875779   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00445793 -0.00396181 -0.05013885]
Stock Position:  0.0044579259290149125
Bond Position:  [-2.70045664]


portfolio before change:  [-2.28604452]
curr_Stock_Price:  93.11220567681056
curr_Factors:  [93.11220568 -0.36795244 -1.01846052]
mat_Sqrt:  [[23.27529084  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00554398 -0.12297935  0.31767939]
Stock Position:  -0.005543979961563623
Bond Position:  [-1.76983232]


portfolio before change:  [-2.28672008]
curr_Stock_Price:  93.1542412965455
curr_Factors:  [93.1542413  -0.63069462 -1.03369481]
mat_Sqrt:  [[17.63467608  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0071365  -0.13940621 -1.35922902]
Stock Position:  -0.007136501110973627
Bond Position:  [-1.62192473]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-2.29269869]
Stock Price:  93.93516820063522
PL:  [-2.29269869]
Settle:  Tensor("sub_58:0", shape=(), dtype=float64)
PL:  Tensor("sub_59:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  30
output_Z_Vals[:, i, :]:  [[ 1.19271183e+02 -4.92738716e+01 -4.92570741e+01]
 [ 6.64586885e-02  1.09135915e-01 -3.16709886e-02]
 [-2.15779596e+00 -2.90585222e+00 -8.27428085e-01]
 [ 9.32186766e-02  2.22028376e-01 -5.10473109e-02]
 [ 2.73278709e-01  1.45588316e-01 -3.71521614e-01]
 [ 4.44282338e-02  7.41220002e-02 -1.56639650e-03]
 [ 1.76184372e-03  2.63354360e-02  5.21003340e-02]
 [ 9.53921172e-02  2.34587988e-01  1.02920232e-01]
 [ 3.02659231e-02 -7.05287559e-02 -2.97483971e-03]
 [-9.76299991e-01 -3.96417248e-01 -3.38036346e-02]
 [ 1.45481778e-01 -1.96605673e-02 -1.60159913e-01]
 [ 2.16452618e-03 -5.84295184e-02  3.31396511e-02]
 [-6.76961426e-01 -1.22258479e+00  2.32847329e-01]
 [ 4.33302787e-02  5.58084338e-02  1.30079704e-01]
 [ 1.06146442e-01  1.19989200e-01 -1.04504958e-01]
 [-1.68036365e-01  9.90463930e-02  1.37124704e-01]
 [ 6.37349570e-02  1.16264083e-01  1.24196800e-01]
 [ 1.15216134e-01 -1.08333916e-02 -3.18137274e-02]
 [-5.07091125e-02 -1.30556113e-01  1.10959242e-02]
 [ 7.49326856e-02 -5.80220360e-01 -5.88289975e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.27118322 -49.27387164 -49.25707411]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [   7.3268874   -15.90307369 -140.51672192]
init_Out:  [2.48374395]
Stock Position:  7.326887399052493
Bond position:  [-730.20499595]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-4.60574294]
curr_Stock_Price:  99.05731964360449
curr_Factors:  [99.05731964 -1.2009519  -1.0347919 ]
mat_Sqrt:  [[10.5904735   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00776841  0.03522347 -0.09034851]
Stock Position:  0.0077684109633019294
Bond Position:  [-5.37526091]


portfolio before change:  [-4.60040358]
curr_Stock_Price:  99.9176435941765
curr_Factors:  [99.91764359 -1.05255019 -1.05267017]
mat_Sqrt:  [[12.17185012  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.23988536 -0.93785977 -2.36042201]
Stock Position:  -0.2398853573973035
Bond Position:  [19.36837607]


portfolio before change:  [-4.62386945]
curr_Stock_Price:  100.03565236107482
curr_Factors:  [100.03565236  -1.34072377  -1.07454927]
mat_Sqrt:  [[ 8.93747942  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01433514  0.07165935 -0.14562377]
Stock Position:  0.014335142415215557
Bond Position:  [-6.05789478]


portfolio before change:  [-4.61923707]
curr_Stock_Price:  100.46446219243262
curr_Factors:  [100.46446219  -1.22855567  -1.10829025]
mat_Sqrt:  [[ 9.7080762   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0233991   0.04698843 -1.05984775]
Stock Position:  0.02339910223574368
Bond Position:  [-6.97001529]


portfolio before change:  [-4.61872758]
curr_Stock_Price:  100.56071390376708
curr_Factors:  [100.5607139   -1.16968432  -1.13735397]
mat_Sqrt:  [[10.01138929  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00591712  0.02392277 -0.00446849]
Stock Position:  0.005917119256100485
Bond Position:  [-5.21375732]


portfolio before change:  [-4.62378659]
curr_Stock_Price:  99.92604585327986
curr_Factors:  [99.92604585 -0.93646103 -1.0785723 ]
mat_Sqrt:  [[13.32173676  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.0013341  0.00849973 0.14862775]
Stock Position:  0.0013340961877877457
Bond Position:  [-4.75709755]


portfolio before change:  [-4.62655689]
curr_Stock_Price:  98.74106763885236
curr_Factors:  [98.74106764 -0.88929987 -1.07689735]
mat_Sqrt:  [[13.82258332  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01188531 0.07571295 0.29360277]
Stock Position:  0.011885310463202008
Bond Position:  [-5.80012513]


portfolio before change:  [-4.62550697]
curr_Stock_Price:  98.9514228369685
curr_Factors:  [98.95142284 -1.37016411 -1.05670509]
mat_Sqrt:  [[ 8.73868611  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00174649 -0.02276306 -0.00848639]
Stock Position:  0.0017464941849283649
Bond Position:  [-4.79832505]


portfolio before change:  [-4.62579529]
curr_Stock_Price:  99.47327410404489
curr_Factors:  [99.4732741  -1.27454081 -1.07508716]
mat_Sqrt:  [[ 9.49021278  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.11212799 -0.12794312 -0.09643236]
Stock Position:  -0.11212798757162092
Bond Position:  [6.52794276]


portfolio before change:  [-4.58350138]
curr_Stock_Price:  99.11063749957877
curr_Factors:  [99.1106375  -1.1760525  -1.06281636]
mat_Sqrt:  [[10.56311189  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01029773 -0.00634542 -0.45689165]
Stock Position:  0.010297730153605819
Bond Position:  [-5.60411598]


portfolio before change:  [-4.5913707]
curr_Stock_Price:  98.48252724081357
curr_Factors:  [98.48252724 -1.04524981 -1.01730026]
mat_Sqrt:  [[12.52002134  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00023944 -0.01885805  0.0945382 ]
Stock Position:  -0.00023943620355825252
Bond Position:  [-4.56779042]


portfolio before change:  [-4.59236703]
curr_Stock_Price:  97.87375995681214
curr_Factors:  [97.87375996 -1.34879072 -1.03939601]
mat_Sqrt:  [[ 8.9844181   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.09783502 -0.39458754  0.66424862]
Stock Position:  -0.09783502161844651
Bond Position:  [4.98311439]


portfolio before change:  [-4.62813302]
curr_Stock_Price:  98.25206953118361
curr_Factors:  [98.25206953 -0.96940458 -1.03022483]
mat_Sqrt:  [[13.30190037  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00610999 0.01801209 0.37108119]
Stock Position:  0.00610999434411406
Bond Position:  [-5.22845261]


portfolio before change:  [-4.62671803]
curr_Stock_Price:  98.69761270844556
curr_Factors:  [98.69761271 -1.0116554  -1.04406023]
mat_Sqrt:  [[12.63341304  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00865223  0.03872635 -0.29812356]
Stock Position:  0.0086522263868268
Bond Position:  [-5.48067212]


portfolio before change:  [-4.64347579]
curr_Stock_Price:  96.91917734660952
curr_Factors:  [96.91917735 -1.1954777  -1.05407454]
mat_Sqrt:  [[10.21978114  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01172512  0.03196709  0.39117861]
Stock Position:  -0.011725118191703899
Bond Position:  [-3.50708698]


portfolio before change:  [-4.64759472]
curr_Stock_Price:  97.19568180534169
curr_Factors:  [97.19568181 -0.75420209 -1.07738883]
mat_Sqrt:  [[15.56672095  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00724744 0.03752407 0.3542989 ]
Stock Position:  0.007247436988466042
Bond Position:  [-5.3520143]


portfolio before change:  [-4.65626042]
curr_Stock_Price:  96.18463124709051
curr_Factors:  [96.18463125 -0.80244284 -1.10373333]
mat_Sqrt:  [[14.29762472  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00744955 -0.00349646 -0.09075571]
Stock Position:  0.007449547021065168
Bond Position:  [-5.37279235]


portfolio before change:  [-4.63703612]
curr_Stock_Price:  98.94555952258497
curr_Factors:  [98.94555952 -1.14899328 -1.09964566]
mat_Sqrt:  [[10.44298916  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00719084 -0.0421368   0.03165358]
Stock Position:  -0.007190835903270277
Bond Position:  [-3.92553484]


portfolio before change:  [-4.63264174]
curr_Stock_Price:  98.19795775149264
curr_Factors:  [98.19795775 -0.90790805 -1.04477381]
mat_Sqrt:  [[13.93360524  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01174057 -0.18726532 -1.67822755]
Stock Position:  -0.011740571436985859
Bond Position:  [-3.47974161]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-4.6365234]
Stock Price:  98.45447077452548
PL:  [-4.6365234]
Settle:  Tensor("sub_60:0", shape=(), dtype=float64)
PL:  Tensor("sub_61:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  31
output_Z_Vals[:, i, :]:  [[ 1.19271183e+02 -4.92738716e+01 -4.92570741e+01]
 [-4.96711779e-03 -5.89343039e-03 -6.25367387e-02]
 [-2.03858148e+00 -2.74687664e+00 -7.81439391e-01]
 [-2.52611656e-01 -9.83846936e-02  1.63861901e-01]
 [ 5.05941678e-01  1.21125107e-01 -4.58375127e-01]
 [-1.10207994e-01 -1.88111788e-01  4.55932469e-02]
 [ 2.11827434e-02  2.46480768e-02  1.12492479e-01]
 [ 4.20343877e-02  7.17061349e-02  1.17496489e-03]
 [ 2.92548512e-02 -8.46062089e-02 -1.12735278e-02]
 [-1.13275874e+00 -4.60644142e-01 -4.17689254e-02]
 [ 3.11662719e-01  3.12992668e-02 -5.84707213e-02]
 [-2.08699944e-01  4.36586501e-03  2.74274128e-02]
 [-7.54992093e-01 -1.01981553e+00  2.67126520e-01]
 [-8.25642194e-03 -3.22035905e-02 -2.08972236e-02]
 [ 3.30236957e-02  1.00688534e-01 -1.00068101e-01]
 [ 4.66420138e-02 -3.17282285e-03  2.89927697e-03]
 [-1.32009056e-01 -1.40465332e-01 -1.56271289e-01]
 [-6.29587610e-02 -1.68170293e-01  2.33966290e-01]
 [ 7.21754510e-02 -1.80444032e-01  1.73451627e-01]
 [ 1.73460031e-01 -1.38582586e+00 -3.44458827e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.27118322 -49.27387164 -49.25707411]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [   7.3268874   -15.90307369 -140.51672192]
init_Out:  [2.48374395]
Stock Position:  7.326887399052493
Bond position:  [-730.20499595]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [9.91606985]
curr_Stock_Price:  101.03930899346261
curr_Factors:  [101.03930899  -0.9197671   -0.98198284]
mat_Sqrt:  [[15.08588747  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00125517 -0.0019021  -0.17839991]
Stock Position:  -0.0012551709405366864
Bond Position:  [10.04289145]


portfolio before change:  [9.9178275]
curr_Stock_Price:  101.63953760545826
curr_Factors:  [101.63953761  -1.20823975  -0.99024047]
mat_Sqrt:  [[11.27911052  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.2445934  -0.88655062 -2.22922907]
Stock Position:  -0.24459339834568156
Bond Position:  [34.77818741]


portfolio before change:  [9.76310605]
curr_Stock_Price:  102.30765492314232
curr_Factors:  [102.30765492  -1.36979098  -1.03196804]
mat_Sqrt:  [[ 9.26482971  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02582305 -0.03175352  0.46745239]
Stock Position:  -0.025823051774289403
Bond Position:  [12.40500192]


portfolio before change:  [9.78979127]
curr_Stock_Price:  101.39437854767944
curr_Factors:  [101.39437855  -1.22952637  -1.03376171]
mat_Sqrt:  [[10.54582003  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.04144778  0.03909296 -1.30761665]
Stock Position:  0.04144777786401042
Bond Position:  [5.58721959]


portfolio before change:  [9.72309563]
curr_Stock_Price:  99.75152521137203
curr_Factors:  [99.75152521 -1.31404444 -1.05858821]
mat_Sqrt:  [[ 9.30032828  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01497791 -0.06071282  0.13006484]
Stock Position:  -0.014977908826899502
Bond Position:  [11.21716488]


portfolio before change:  [9.69605087]
curr_Stock_Price:  101.74441985561046
curr_Factors:  [101.74441986  -1.19661213  -1.09642743]
mat_Sqrt:  [[10.27202752  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00478741 0.00795513 0.32090973]
Stock Position:  0.004787413388557405
Bond Position:  [9.20895828]


portfolio before change:  [9.69429437]
curr_Stock_Price:  100.89656504062506
curr_Factors:  [100.89656504  -1.55559263  -1.11447823]
mat_Sqrt:  [[ 6.98681654  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00814551 0.02314306 0.00335185]
Stock Position:  0.008145509410838506
Bond Position:  [8.87244045]


portfolio before change:  [9.69898527]
curr_Stock_Price:  101.20010832278177
curr_Factors:  [101.20010832  -1.19920007  -1.1451708 ]
mat_Sqrt:  [[ 9.70585162  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0009977  -0.02730654 -0.03216024]
Stock Position:  0.0009976952396943716
Bond Position:  [9.59801841]


portfolio before change:  [9.70101832]
curr_Stock_Price:  100.83250646645072
curr_Factors:  [100.83250647  -1.02785408  -1.12687427]
mat_Sqrt:  [[11.68998435  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.1056728  -0.14867226 -0.11915512]
Stock Position:  -0.10567280011552961
Bond Position:  [20.35627162]


portfolio before change:  [9.76723132]
curr_Stock_Price:  100.2540861572733
curr_Factors:  [100.25408616  -0.81679164  -1.11565465]
mat_Sqrt:  [[14.51614581  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.02108799  0.01010179 -0.16680069]
Stock Position:  0.02108799216265145
Bond Position:  [7.65307394]


portfolio before change:  [9.83156016]
curr_Stock_Price:  103.21384304865398
curr_Factors:  [103.21384305  -0.72083501  -1.08617217]
mat_Sqrt:  [[16.94200097  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01193544  0.00140908  0.07824277]
Stock Position:  -0.011935435991957413
Bond Position:  [11.06346237]


portfolio before change:  [9.83526213]
curr_Stock_Price:  103.13544087073608
curr_Factors:  [103.13544087  -0.82038802  -1.0870269 ]
mat_Sqrt:  [[15.31186734  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.05934182 -0.32914405  0.76203761]
Stock Position:  -0.05934182118790079
Bond Position:  [15.95550702]


portfolio before change:  [9.74171925]
curr_Stock_Price:  104.77900789884514
curr_Factors:  [104.7790079   -1.26194645  -1.04653093]
mat_Sqrt:  [[10.41634352  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00183323 -0.01039366 -0.05961396]
Stock Position:  -0.0018332325741560898
Bond Position:  [9.93380354]


portfolio before change:  [9.74267561]
curr_Stock_Price:  105.61218070389657
curr_Factors:  [105.6121807   -1.85150107  -1.06044236]
mat_Sqrt:  [[ 5.74213034  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00577318  0.03249708 -0.28546644]
Stock Position:  0.005773178109972757
Bond Position:  [9.13295768]


portfolio before change:  [9.74787968]
curr_Stock_Price:  106.1180626336343
curr_Factors:  [106.11806263  -1.89373851  -1.07050948]
mat_Sqrt:  [[ 5.47561327  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00850794 -0.00102402  0.00827083]
Stock Position:  0.008507937679089401
Bond Position:  [8.84503382]


portfolio before change:  [9.75295423]
curr_Stock_Price:  106.45457314698128
curr_Factors:  [106.45457315  -1.88693868  -1.08392689]
mat_Sqrt:  [[ 5.45674675  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.03529212 -0.04533499 -0.44579849]
Stock Position:  -0.03529212075003805
Bond Position:  [13.50996188]


portfolio before change:  [9.73490668]
curr_Stock_Price:  107.06166213243401
curr_Factors:  [107.06166213  -1.98898639  -1.09342492]
mat_Sqrt:  [[ 4.90862393  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01009004 -0.05427673  0.6674407 ]
Stock Position:  -0.010090039516013958
Bond Position:  [10.81516308]


portfolio before change:  [9.73285411]
curr_Stock_Price:  107.5330874238711
curr_Factors:  [107.53308742  -2.09577796  -1.12237235]
mat_Sqrt:  [[ 4.30444534  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01643606 -0.05823806  0.49480921]
Stock Position:  0.0164360624034762
Bond Position:  [7.96543357]


portfolio before change:  [9.73829707]
curr_Stock_Price:  107.74307415867943
curr_Factors:  [107.74307416  -2.07104889  -1.1209243 ]
mat_Sqrt:  [[ 4.42723953  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.04059705 -0.44727337 -0.98264515]
Stock Position:  -0.04059704718882386
Bond Position:  [14.11234774]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [9.71938709]
Stock Price:  108.29578693753238
PL:  [1.42360016]
Settle:  Tensor("sub_62:0", shape=(), dtype=float64)
PL:  Tensor("sub_63:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  32
output_Z_Vals[:, i, :]:  [[ 1.19271183e+02 -4.92738716e+01 -4.92570741e+01]
 [ 3.93449499e-02  7.21049836e-02 -3.61880290e-02]
 [-2.29524883e+00 -3.08914915e+00 -8.80452494e-01]
 [-3.29589282e-01 -1.93685237e-01  2.12853174e-01]
 [ 1.30234180e+00  1.51329977e-02 -7.29260951e-01]
 [ 8.56146838e-02  2.60158953e-01  6.11781093e-02]
 [ 6.64572182e-02 -6.52588624e-02  8.52688249e-02]
 [ 3.53404566e-02  2.83456851e-01  3.21930393e-01]
 [-4.16742961e-02 -2.67235089e-01  5.02391393e-02]
 [-1.31994102e+00 -5.35727739e-01 -5.13356610e-02]
 [ 3.14885229e-01  8.22842555e-02  6.65983598e-02]
 [-1.36105922e-01 -2.07267230e-02  3.04732740e-02]
 [-6.37779720e-01 -1.02817548e+00  2.24802530e-01]
 [ 1.42981030e-02  3.04965037e-02  7.43877611e-02]
 [ 2.47422593e-02  4.51212131e-02 -6.10265162e-02]
 [ 2.24398171e-02  4.41932185e-02  8.35442356e-02]
 [ 1.25539909e-01  1.15578973e-01  1.03380930e-01]
 [ 1.15216134e-01 -1.08333916e-02 -3.18137274e-02]
 [-4.73340427e-02 -7.54157417e-02 -1.57667691e-02]
 [ 3.92968056e-02 -3.23584919e-01 -3.32412311e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.27118322 -49.27387164 -49.25707411]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [   7.3268874   -15.90307369 -140.51672192]
init_Out:  [2.48374395]
Stock Position:  7.326887399052493
Bond position:  [-730.20499595]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-1.51568898]
curr_Stock_Price:  99.47906134554806
curr_Factors:  [99.47906135 -0.87143294 -1.00062065]
mat_Sqrt:  [[15.30062374  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00305063  0.02327178 -0.10323437]
Stock Position:  0.003050625148110716
Bond Position:  [-1.81916231]


portfolio before change:  [-1.50899201]
curr_Stock_Price:  101.82343863292706
curr_Factors:  [101.82343863  -0.72424653  -1.03381123]
mat_Sqrt:  [[17.55225727  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.17693111 -0.9970186  -2.51168589]
Stock Position:  -0.17693111056618965
Bond Position:  [16.50674207]


portfolio before change:  [-1.68005495]
curr_Stock_Price:  102.81359878915612
curr_Factors:  [102.81359879  -0.69897787  -0.99112218]
mat_Sqrt:  [[18.96921826  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01716869 -0.06251164  0.60721086]
Stock Position:  -0.01716869079943936
Bond Position:  [0.08511994]


portfolio before change:  [-1.6938751]
curr_Stock_Price:  103.61980068157007
curr_Factors:  [103.61980068  -0.19701251  -0.99702468]
mat_Sqrt:  [[31.39633752  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.03683777  0.00488415 -2.08037851]
Stock Position:  0.03683776947831798
Bond Position:  [-5.51099743]


portfolio before change:  [-1.64246314]
curr_Stock_Price:  105.05283749680002
curr_Factors:  [105.0528375   -0.14300359  -0.99508741]
mat_Sqrt:  [[33.66209527  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00449192 0.08396594 0.17452412]
Stock Position:  0.0044919169665724925
Bond Position:  [-2.11435176]


portfolio before change:  [-1.64929699]
curr_Stock_Price:  103.64916148389756
curr_Factors:  [103.64916148  -0.7031728   -0.99348893]
mat_Sqrt:  [[18.99830977  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00371305 -0.02106221  0.24324822]
Stock Position:  0.0037130531923413603
Bond Position:  [-2.03415184]


portfolio before change:  [-1.6489033]
curr_Stock_Price:  103.89216520599167
curr_Factors:  [103.89216521  -0.44039818  -1.04576276]
mat_Sqrt:  [[23.50451528  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00676102 0.09148531 0.9183778 ]
Stock Position:  0.006761024779339865
Bond Position:  [-2.35132081]


portfolio before change:  [-1.6430477]
curr_Stock_Price:  104.8452029162865
curr_Factors:  [104.84520292  -0.29744484  -1.02519213]
mat_Sqrt:  [[27.93409644  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00307754 -0.08624975  0.14331828]
Stock Position:  -0.003077543929871847
Bond Position:  [-1.32038198]


portfolio before change:  [-1.63719324]
curr_Stock_Price:  102.83561459366344
curr_Factors:  [102.83561459  -0.73024766  -1.07086725]
mat_Sqrt:  [[16.97967144  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.08479403 -0.17290538 -0.14644635]
Stock Position:  -0.08479403353690167
Bond Position:  [7.08265332]


portfolio before change:  [-1.64965646]
curr_Stock_Price:  103.00348152272258
curr_Factors:  [103.00348152  -0.7237801   -1.04935331]
mat_Sqrt:  [[17.49000145  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01974132 0.02655713 0.18998658]
Stock Position:  0.019741322865493162
Bond Position:  [-3.68308145]


portfolio before change:  [-1.6771505]
curr_Stock_Price:  101.65741427679554
curr_Factors:  [101.65741428  -0.32995031  -1.02816683]
mat_Sqrt:  [[26.14064367  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00513057 -0.00668952  0.08693177]
Stock Position:  -0.005130570532669056
Bond Position:  [-1.15558996]


portfolio before change:  [-1.67437884]
curr_Stock_Price:  101.06087319828058
curr_Factors:  [101.0608732   -0.23646029  -1.01469476]
mat_Sqrt:  [[28.92100036  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02772268 -0.33184221  0.64129904]
Stock Position:  -0.027722676483877287
Bond Position:  [1.12729906]


portfolio before change:  [-1.65859478]
curr_Stock_Price:  100.50168494664194
curr_Factors:  [100.50168495  -0.24919199  -1.01909902]
mat_Sqrt:  [[28.27232684  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00126298 0.0098427  0.21220758]
Stock Position:  0.00126298461646399
Bond Position:  [-1.78552686]


portfolio before change:  [-1.65850943]
curr_Stock_Price:  100.92274343253716
curr_Factors:  [100.92274343  -0.34678525  -1.04015023]
mat_Sqrt:  [[25.2145154   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00085251  0.01456281 -0.17409166]
Stock Position:  0.0008525090608239677
Bond Position:  [-1.74454698]


portfolio before change:  [-1.65946032]
curr_Stock_Price:  100.31899312265833
curr_Factors:  [100.31899312  -0.54326901  -1.04063487]
mat_Sqrt:  [[20.58270511  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00235703 0.0142633  0.23832845]
Stock Position:  0.0023570330242664007
Bond Position:  [-1.8959155]


portfolio before change:  [-1.66039297]
curr_Stock_Price:  100.12442291959646
curr_Factors:  [100.12442292  -0.84962271  -1.02582001]
mat_Sqrt:  [[15.34778138  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01109183 0.03730295 0.29491702]
Stock Position:  0.011091825476010399
Bond Position:  [-2.77095559]


portfolio before change:  [-1.67663247]
curr_Stock_Price:  98.72278886863141
curr_Factors:  [98.72278887 -0.8979937  -1.00061388]
mat_Sqrt:  [[14.78640572  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00720329 -0.00349646 -0.09075571]
Stock Position:  0.007203293999959822
Bond Position:  [-2.38776175]


portfolio before change:  [-1.67323216]
curr_Stock_Price:  99.27771978302438
curr_Factors:  [99.27771978 -0.67602399 -0.94846927]
mat_Sqrt:  [[19.5588509   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0033717  -0.02434033 -0.0449782 ]
Stock Position:  -0.003371700875848485
Bond Position:  [-1.33849738]


portfolio before change:  [-1.66924888]
curr_Stock_Price:  97.99707601080762
curr_Factors:  [97.99707601 -0.1911703  -0.90483365]
mat_Sqrt:  [[32.75100653  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00288871 -0.10443658 -0.9482798 ]
Stock Position:  -0.002888707197535759
Bond Position:  [-1.38616402]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-1.66901969]
Stock Price:  97.79775894479543
PL:  [-1.66901969]
Settle:  Tensor("sub_64:0", shape=(), dtype=float64)
PL:  Tensor("sub_65:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  33
output_Z_Vals[:, i, :]:  [[ 1.19271183e+02 -4.92738716e+01 -4.92570741e+01]
 [ 1.31026219e-02  2.78209315e-02 -5.01705004e-02]
 [-2.51459719e+00 -3.39198002e+00 -9.68479667e-01]
 [ 9.33274529e-02  2.97337560e-01 -5.07028838e-02]
 [ 1.01596363e+00  1.65133136e-02 -6.06114625e-01]
 [ 8.16055054e-02  1.71668127e-01  2.62771400e-02]
 [ 9.53539696e-02 -1.56717969e-01 -8.14909975e-02]
 [-9.60287487e-02  1.20330377e-01  3.20944901e-01]
 [-4.50443284e-02 -2.75912273e-01  5.31617696e-02]
 [-1.94249029e+00 -7.02501672e-01 -8.27387673e-02]
 [ 7.96141282e-02 -1.39458927e-01  9.46820052e-03]
 [-1.16478622e-01  7.40918741e-02  2.51680056e-02]
 [-9.08887722e-01 -1.15711475e+00  3.29823474e-01]
 [ 2.28014192e-02 -4.30422285e-02 -1.83242857e-02]
 [-8.21364543e-02 -6.13121745e-02 -9.40096119e-03]
 [ 1.29151228e-01  1.54705389e-02  3.30206620e-02]
 [ 3.82517448e-02  2.62731551e-02  9.63773374e-03]
 [ 2.71538582e-02 -8.14215344e-02  1.14553623e-01]
 [ 1.23437160e-02  1.10890743e-02  5.25682825e-03]
 [ 6.27704419e-02 -5.65797261e-01 -4.03493846e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.27118322 -49.27387164 -49.25707411]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [   7.3268874   -15.90307369 -140.51672192]
init_Out:  [2.48374395]
Stock Position:  7.326887399052493
Bond position:  [-730.20499595]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [3.82833646]
curr_Stock_Price:  100.20843319844128
curr_Factors:  [100.2084332   -0.73491759  -0.98136542]
mat_Sqrt:  [[18.01075966  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00047419  0.00897917 -0.14312247]
Stock Position:  0.00047419072884986955
Bond Position:  [3.78081855]


portfolio before change:  [3.82896374]
curr_Stock_Price:  99.53773214009178
curr_Factors:  [99.53773214 -0.54653485 -0.94831159]
mat_Sqrt:  [[22.32462546  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.15250748 -1.09475684 -2.76280292]
Stock Position:  -0.15250747687961028
Bond Position:  [19.00921212]


portfolio before change:  [3.63097357]
curr_Stock_Price:  100.86712971893972
curr_Factors:  [100.86712972  -0.65578008  -0.93860572]
mat_Sqrt:  [[20.47937533  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00701543  0.09596528 -0.14464121]
Stock Position:  0.00701542615752175
Bond Position:  [2.92334767]


portfolio before change:  [3.64296863]
curr_Stock_Price:  102.47275388550281
curr_Factors:  [102.47275389  -0.78100226  -0.94300619]
mat_Sqrt:  [[18.27599585  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.04900481  0.00532965 -1.72907631]
Stock Position:  0.049004813151141226
Bond Position:  [-1.37868953]


portfolio before change:  [3.70228445]
curr_Stock_Price:  103.6901962453503
curr_Factors:  [103.69019625  -0.58849866  -0.9469786 ]
mat_Sqrt:  [[22.32998327  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00546399 0.05540565 0.07496137]
Stock Position:  0.005463994859390988
Bond Position:  [3.13572175]


portfolio before change:  [3.71024491]
curr_Stock_Price:  105.00359995425094
curr_Factors:  [105.00359995  -0.91326591  -0.93612119]
mat_Sqrt:  [[16.52059086  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00282858 -0.05058051 -0.23247113]
Stock Position:  0.0028285772745103867
Bond Position:  [3.41323411]


portfolio before change:  [3.71365743]
curr_Stock_Price:  105.90833079326444
curr_Factors:  [105.90833079  -0.69330432  -0.90631037]
mat_Sqrt:  [[21.39076382  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-2.78335545e-04  3.88364621e-02  9.15566468e-01]
Stock Position:  -0.00027833554477322837
Bond Position:  [3.74313548]


portfolio before change:  [3.71478978]
curr_Stock_Price:  105.2025141433684
curr_Factors:  [105.20251414  -0.2644813   -0.89826824]
mat_Sqrt:  [[32.88898053  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00275208 -0.0890503   0.15165573]
Stock Position:  -0.002752079361218732
Bond Position:  [4.00431545]


portfolio before change:  [3.70614225]
curr_Stock_Price:  108.70849627314638
curr_Factors:  [108.70849627  -0.75158469  -0.88373694]
mat_Sqrt:  [[21.18616408  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.09925236 -0.22673144 -0.23603067]
Stock Position:  -0.09925236196595885
Bond Position:  [14.49571727]


portfolio before change:  [3.72412047]
curr_Stock_Price:  108.56387666772282
curr_Factors:  [108.56387667  -0.65361025  -0.91010899]
mat_Sqrt:  [[22.7284963   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00233539 -0.04501018  0.02701014]
Stock Position:  0.0023353890890671944
Bond Position:  [3.47058157]


portfolio before change:  [3.72200844]
curr_Stock_Price:  107.28795421253835
curr_Factors:  [107.28795421  -0.9892183   -0.89202799]
mat_Sqrt:  [[16.35068976  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0058846   0.02391305  0.07179731]
Stock Position:  -0.005884600907469331
Bond Position:  [4.35335524]


portfolio before change:  [3.72297356]
curr_Stock_Price:  107.30891685350943
curr_Factors:  [107.30891685  -1.18226406  -0.88250652]
mat_Sqrt:  [[13.61185577  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.07917788 -0.37345718  0.94089457]
Stock Position:  -0.07917787732963613
Bond Position:  [12.21946582]


portfolio before change:  [3.74068711]
curr_Stock_Price:  107.12378557299496
curr_Factors:  [107.12378557  -1.18473617  -0.85511096]
mat_Sqrt:  [[13.93129721  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00073755 -0.01389182 -0.05227409]
Stock Position:  0.0007375502605107938
Bond Position:  [3.66167794]


portfolio before change:  [3.74025523]
curr_Stock_Price:  105.2969053817354
curr_Factors:  [105.29690538  -0.99188896  -0.83550802]
mat_Sqrt:  [[16.93507717  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00570241 -0.01978842 -0.02681833]
Stock Position:  -0.005702407590646689
Bond Position:  [4.3407011]


portfolio before change:  [3.74873017]
curr_Stock_Price:  104.00102650674746
curr_Factors:  [104.00102651  -1.18059531  -0.85958207]
mat_Sqrt:  [[13.5207208   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01028417 0.00499309 0.09419876]
Stock Position:  0.010284174536046596
Bond Position:  [2.67916546]


portfolio before change:  [3.74285746]
curr_Stock_Price:  103.36484608616253
curr_Factors:  [103.36484609  -0.59262143  -0.83162719]
mat_Sqrt:  [[24.87880663  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00183216 0.00847962 0.02749377]
Stock Position:  0.0018321628095210095
Bond Position:  [3.55347623]


portfolio before change:  [3.74352893]
curr_Stock_Price:  103.24640341982679
curr_Factors:  [103.24640342  -0.80566352  -0.81667109]
mat_Sqrt:  [[20.38468296  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00166384 -0.02627869  0.3267896 ]
Stock Position:  0.0016638432667606302
Bond Position:  [3.5717431]


portfolio before change:  [3.74538276]
curr_Stock_Price:  103.82385188165532
curr_Factors:  [103.82385188  -1.18787326  -0.80285393]
mat_Sqrt:  [[14.18192884  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00110565 0.00357898 0.01499627]
Stock Position:  0.0011056542138245511
Bond Position:  [3.63058948]


portfolio before change:  [3.74584677]
curr_Stock_Price:  103.42250084133143
curr_Factors:  [103.42250084  -0.91614913  -0.76261641]
mat_Sqrt:  [[19.29907195  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00699957 -0.18261028 -1.15105563]
Stock Position:  -0.006999573710071245
Bond Position:  [4.46976018]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [3.74197002]
Stock Price:  104.13601991625163
PL:  [-0.3940499]
Settle:  Tensor("sub_66:0", shape=(), dtype=float64)
PL:  Tensor("sub_67:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  34
output_Z_Vals[:, i, :]:  [[ 1.19271183e+02 -4.92738716e+01 -4.92570741e+01]
 [ 2.62551551e-02  5.10747554e-02 -4.22625362e-02]
 [-1.92246542e+00 -2.59203288e+00 -7.36645960e-01]
 [-7.02561637e-02  1.27376720e-01  4.78044381e-02]
 [ 5.26964884e-01  8.14311034e-02 -4.35286009e-01]
 [ 4.59544962e-02  7.62229511e-02 -1.81872903e-03]
 [ 5.55957463e-02 -4.40734415e-02  8.57853920e-02]
 [-7.62537624e-04  1.25686996e-01  1.42743529e-01]
 [-1.34933050e-02 -1.94674470e-01  2.57994275e-02]
 [-1.37607026e+00 -5.56224522e-01 -5.42472805e-02]
 [ 3.14094607e-01  5.80062274e-02  5.96279810e-02]
 [-2.27786858e-01  1.45813805e-02  2.65033720e-02]
 [-6.47409899e-01 -1.00867245e+00  2.27731416e-01]
 [-7.84603904e-03 -1.91050469e-02 -7.51325339e-03]
 [-1.63185608e-01 -2.01576608e-01  6.82830103e-02]
 [ 1.02783277e-01  2.25677949e-02  4.55048293e-02]
 [-1.09002356e-01 -1.17934589e-01 -1.33852628e-01]
 [-1.65226077e-01 -2.47805426e-01  4.23061558e-01]
 [ 4.58560325e-02 -2.15024474e-02  4.37212366e-02]
 [ 3.46741336e-02 -4.79704918e-01  5.32024033e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.27118322 -49.27387164 -49.25707411]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [   7.3268874   -15.90307369 -140.51672192]
init_Out:  [2.48374395]
Stock Position:  7.326887399052493
Bond position:  [-730.20499595]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [5.21664601]
curr_Stock_Price:  100.39791469033929
curr_Factors:  [100.39791469  -1.22310353  -1.022524  ]
mat_Sqrt:  [[10.6282325   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00263957  0.01648431 -0.12056325]
Stock Position:  0.002639567946062301
Bond Position:  [4.95163889]


portfolio before change:  [5.21986319]
curr_Stock_Price:  101.14770137907988
curr_Factors:  [101.14770138  -1.37482719  -1.05742562]
mat_Sqrt:  [[ 8.88468519  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.29285553 -0.83657502 -2.10144588]
Stock Position:  -0.292855525051364
Bond Position:  [34.84152638]


portfolio before change:  [5.12491461]
curr_Stock_Price:  101.50166447210204
curr_Factors:  [101.50166447  -1.46473366  -1.07561599]
mat_Sqrt:  [[ 8.00227239  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00431096  0.04111066  0.13637276]
Stock Position:  -0.004310957913828743
Bond Position:  [5.56248402]


portfolio before change:  [5.12780075]
curr_Stock_Price:  101.15479502439014
curr_Factors:  [101.15479502  -1.14975346  -1.03163395]
mat_Sqrt:  [[11.41883927  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.03982319  0.02628178 -1.24174982]
Stock Position:  0.039823185436711504
Bond Position:  [1.09949459]


portfolio before change:  [5.19355803]
curr_Stock_Price:  102.79912304684485
curr_Factors:  [102.79912305  -1.38924154  -1.0428381 ]
mat_Sqrt:  [[ 9.03130771  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00677003  0.02460085 -0.00518833]
Stock Position:  0.006770026715934037
Bond Position:  [4.49760523]


portfolio before change:  [5.19645972]
curr_Stock_Price:  103.06162507541742
curr_Factors:  [103.06162508  -1.18604744  -1.0578411 ]
mat_Sqrt:  [[10.929205    0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00586595 -0.01422464  0.24472185]
Stock Position:  0.005865949306517403
Bond Position:  [4.59190545]


portfolio before change:  [5.19789985]
curr_Stock_Price:  103.1114051235335
curr_Factors:  [103.11140512  -1.08639838  -1.08567461]
mat_Sqrt:  [[11.74863452  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00459888 0.0405653  0.40720756]
Stock Position:  0.004598884561183814
Bond Position:  [4.7237024]


portfolio before change:  [5.19808037]
curr_Stock_Price:  102.8938406794616
curr_Factors:  [102.89384068  -0.9345409   -1.07439334]
mat_Sqrt:  [[13.80131035  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00347538 -0.06283092  0.07359859]
Stock Position:  -0.003475378607118775
Bond Position:  [5.55567542]


portfolio before change:  [5.19765886]
curr_Stock_Price:  103.41482128500199
curr_Factors:  [103.41482129  -0.68807742  -1.06591512]
mat_Sqrt:  [[17.89919511  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.08384077 -0.17952069 -0.15475239]
Stock Position:  -0.08384076973560116
Bond Position:  [13.86803708]


portfolio before change:  [5.16700041]
curr_Stock_Price:  103.8218534818385
curr_Factors:  [103.82185348  -0.88810757  -1.1003234 ]
mat_Sqrt:  [[14.21425757  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.02378644 0.01872143 0.17010203]
Stock Position:  0.023786440335987657
Bond Position:  [2.69744808]


portfolio before change:  [5.14327974]
curr_Stock_Price:  102.79626422550108
curr_Factors:  [102.79626423  -0.36439476  -1.10863828]
mat_Sqrt:  [[23.56390211  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00931087  0.00470612  0.07560674]
Stock Position:  -0.009310871660329663
Bond Position:  [6.10040256]


portfolio before change:  [5.15988448]
curr_Stock_Price:  101.17671099007016
curr_Factors:  [101.17671099  -0.28712485  -1.08562674]
mat_Sqrt:  [[25.63906107  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.03146835 -0.32554763  0.64965434]
Stock Position:  -0.03146834506014699
Bond Position:  [8.34374813]


portfolio before change:  [5.08689179]
curr_Stock_Price:  103.56256521863698
curr_Factors:  [103.56256522  -0.38266972  -1.08510894]
mat_Sqrt:  [[23.86462561  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00055645 -0.00616613 -0.02143322]
Stock Position:  -0.0005564502477974929
Bond Position:  [5.14451921]


portfolio before change:  [5.08687632]
curr_Stock_Price:  105.90197459374087
curr_Factors:  [105.90197459  -0.56501606  -1.09450979]
mat_Sqrt:  [[20.14564342  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00945088 -0.06505857  0.19479242]
Stock Position:  -0.009450879570613056
Bond Position:  [6.08774313]


portfolio before change:  [5.07393614]
curr_Stock_Price:  107.43223488938136
curr_Factors:  [107.43223489  -0.25886572  -1.1241539 ]
mat_Sqrt:  [[26.94615605  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00433006 0.00728372 0.12981261]
Stock Position:  0.004330062616407642
Bond Position:  [4.60874783]


portfolio before change:  [5.07725295]
curr_Stock_Price:  107.93210731734632
curr_Factors:  [ 1.07932107e+02 -3.50233471e-02 -1.12094143e+00]
mat_Sqrt:  [[33.9720327   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00472148 -0.03806322 -0.38184429]
Stock Position:  -0.004721478050810277
Bond Position:  [5.58685202]


portfolio before change:  [5.06979164]
curr_Stock_Price:  109.80825605618556
curr_Factors:  [ 1.09808256e+02 -5.07273803e-02 -1.11579371e+00]
mat_Sqrt:  [[34.19962319  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00378519 -0.07997886  1.20687687]
Stock Position:  -0.003785189918502553
Bond Position:  [5.48543674]


portfolio before change:  [5.06809553]
curr_Stock_Price:  110.61868946209206
curr_Factors:  [110.61868946  -0.28240625  -1.14229502]
mat_Sqrt:  [[26.61267972  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00189351 -0.00693989  0.12472452]
Stock Position:  0.0018935118293423568
Bond Position:  [4.85863773]


portfolio before change:  [5.07140698]
curr_Stock_Price:  111.72596360006138
curr_Factors:  [111.7259636   -0.39193813  -1.15855912]
mat_Sqrt:  [[23.70182068  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00221018 -0.1548241   0.15177165]
Stock Position:  -0.0022101815849369807
Bond Position:  [5.31834164]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [5.07383553]
Stock Price:  111.22880749874908
PL:  [-6.15497197]
Settle:  Tensor("sub_68:0", shape=(), dtype=float64)
PL:  Tensor("sub_69:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  35
output_Z_Vals[:, i, :]:  [[ 1.19271183e+02 -4.92738716e+01 -4.92570741e+01]
 [ 8.67685178e-02  1.43068139e-01 -4.23540493e-02]
 [-2.38629073e+00 -3.21055587e+00 -9.15573210e-01]
 [-5.31296613e-02  8.24549708e-03 -1.34518328e-01]
 [ 4.94094330e-01 -1.05793748e-01 -1.57013151e-01]
 [-1.02265336e-01 -1.89193913e-01  4.37362515e-02]
 [ 6.05714989e-03  2.30744171e-02  8.00822070e-02]
 [ 6.43226091e-02  1.69167243e-01  7.46230707e-02]
 [ 7.84578069e-02  4.20819167e-02 -5.39443499e-02]
 [-9.73561132e-01 -3.90273738e-01 -3.37708933e-02]
 [ 2.93681564e-01  2.55867214e-02 -6.80087094e-02]
 [ 2.73563592e-02 -6.98785992e-02  3.70678099e-02]
 [-6.69333748e-01 -1.04372175e+00  2.35515665e-01]
 [ 6.34499739e-03  2.32354339e-02  5.86447233e-02]
 [-1.60249242e-02 -1.65166865e-02 -2.82570555e-02]
 [ 5.99227051e-02  3.41042413e-02  6.57975912e-02]
 [ 8.79439049e-02  7.49372959e-02  5.80597878e-02]
 [ 2.83360597e-02 -7.82720471e-02  1.18968748e-01]
 [-6.47057769e-03  4.80913097e-02 -2.40738860e-02]
 [ 5.39014768e-02 -5.15575913e-01 -3.45020964e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.27118322 -49.27387164 -49.25707411]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [   7.3268874   -15.90307369 -140.51672192]
init_Out:  [2.48374395]
Stock Position:  7.326887399052493
Bond position:  [-730.20499595]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-8.35601445]
curr_Stock_Price:  98.54546907091193
curr_Factors:  [98.54546907 -0.52255858 -0.9805355 ]
mat_Sqrt:  [[21.9205372   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00489617  0.04617504 -0.12082431]
Stock Position:  0.0048961708559287585
Bond Position:  [-8.83850991]


portfolio before change:  [-8.34600226]
curr_Stock_Price:  101.0417258696734
curr_Factors:  [101.04172587  -0.62772266  -1.02038636]
mat_Sqrt:  [[19.44178356  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.16606158 -1.03620245 -2.61187552]
Stock Position:  -0.16606158040928676
Bond Position:  [8.43314643]


portfolio before change:  [-7.97808534]
curr_Stock_Price:  98.83887818465087
curr_Factors:  [98.83887818 -0.54070972 -1.01788544]
mat_Sqrt:  [[20.79881219  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00379373  0.00266122 -0.38374335]
Stock Position:  -0.0037937260235727725
Bond Position:  [-7.60311772]


portfolio before change:  [-7.97531887]
curr_Stock_Price:  97.60856187198527
curr_Factors:  [97.60856187 -0.66300327 -0.9936685 ]
mat_Sqrt:  [[18.62106452  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.02365327 -0.03414479 -0.44791481]
Stock Position:  0.023653271591826685
Bond Position:  [-10.2840807]


portfolio before change:  [-7.93758992]
curr_Stock_Price:  99.31235551306267
curr_Factors:  [99.31235551 -1.15643248 -1.04094746]
mat_Sqrt:  [[11.0329919   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0119602  -0.06106207  0.12476735]
Stock Position:  -0.01196019705698808
Bond Position:  [-6.74979458]


portfolio before change:  [-7.94361656]
curr_Stock_Price:  99.67514044381238
curr_Factors:  [99.67514044 -0.61597392 -1.01495751]
mat_Sqrt:  [[19.5111261   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00138966 0.00744724 0.22845225]
Stock Position:  0.0013896639005486283
Bond Position:  [-8.08213151]


portfolio before change:  [-7.94323891]
curr_Stock_Price:  101.40105434755354
curr_Factors:  [101.40105435  -1.10306525  -1.01419084]
mat_Sqrt:  [[12.20477665  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00934766 0.05459849 0.21287885]
Stock Position:  0.009347659666917908
Bond Position:  [-8.89110145]


portfolio before change:  [-7.95520484]
curr_Stock_Price:  100.35877405917323
curr_Factors:  [100.35877406  -1.0051306   -0.97782699]
mat_Sqrt:  [[13.81553825  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00550369  0.01358188 -0.15388822]
Stock Position:  0.005503686971648539
Bond Position:  [-8.50754812]


portfolio before change:  [-7.96042754]
curr_Stock_Price:  99.7963252786232
curr_Factors:  [99.79632528 -1.47978835 -1.02086851]
mat_Sqrt:  [[ 8.18640214  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.12949753 -0.12596031 -0.09633896]
Stock Position:  -0.12949753284370968
Bond Position:  [4.96295037]


portfolio before change:  [-7.98932381]
curr_Stock_Price:  100.02904912313323
curr_Factors:  [100.02904912  -0.89368198  -1.01269837]
mat_Sqrt:  [[14.86605286  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01917269  0.00825808 -0.19400992]
Stock Position:  0.01917268929583583
Bond Position:  [-9.90714969]


portfolio before change:  [-7.99885632]
curr_Stock_Price:  99.6610563172846
curr_Factors:  [99.66105632 -0.75232699 -1.02542738]
mat_Sqrt:  [[16.84443982  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00122645 -0.02255322  0.10574414]
Stock Position:  0.0012264512880642755
Bond Position:  [-8.12108575]


portfolio before change:  [-7.99873661]
curr_Stock_Price:  101.41427012435474
curr_Factors:  [101.41427012  -0.60306812  -0.96814442]
mat_Sqrt:  [[21.07318285  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.03959099 -0.33685975  0.67186064]
Stock Position:  -0.039590987773120895
Bond Position:  [-3.98364548]


portfolio before change:  [-7.97202295]
curr_Stock_Price:  100.71437104698703
curr_Factors:  [100.71437105  -0.67208113  -0.93915705]
mat_Sqrt:  [[20.10664427  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00114682 0.0074992  0.16729707]
Stock Position:  0.001146820631924125
Bond Position:  [-8.08752427]


portfolio before change:  [-7.97297162]
curr_Stock_Price:  101.65040619183462
curr_Factors:  [101.65040619  -0.40298035  -0.97161264]
mat_Sqrt:  [[25.71171052  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00097871 -0.00533074 -0.08060951]
Stock Position:  -0.0009787106915265735
Bond Position:  [-7.87348528]


portfolio before change:  [-7.97546319]
curr_Stock_Price:  102.18473088604283
curr_Factors:  [102.18473089  -0.40149243  -0.98696502]
mat_Sqrt:  [[25.49098355  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00315073 0.0110071  0.18770221]
Stock Position:  0.0031507250832785634
Bond Position:  [-8.29741918]


portfolio before change:  [-7.97891426]
curr_Stock_Price:  101.74785993113382
curr_Factors:  [101.74785993  -0.79837971  -0.96474438]
mat_Sqrt:  [[17.45059418  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.0065953  0.02418591 0.16562841]
Stock Position:  0.006595295246922692
Bond Position:  [-8.64997144]


portfolio before change:  [-7.97115996]
curr_Stock_Price:  103.25151737643749
curr_Factors:  [103.25151738  -1.06280082  -0.95315335]
mat_Sqrt:  [[13.75240555  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0026645  -0.02526219  0.33938472]
Stock Position:  0.0026644966828340737
Bond Position:  [-8.24627328]


portfolio before change:  [-7.97510375]
curr_Stock_Price:  102.54520575901857
curr_Factors:  [102.54520576  -0.74450733  -0.93400663]
mat_Sqrt:  [[19.14017962  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-8.19240797e-05  1.55214035e-02 -6.86760959e-02]
Stock Position:  -8.192407965799421e-05
Bond Position:  [-7.96670283]


portfolio before change:  [-7.97722159]
curr_Stock_Price:  104.08225294521839
curr_Factors:  [104.08225295  -0.68295696  -0.95545004]
mat_Sqrt:  [[20.22206804  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0060215  -0.16640141 -0.98424878]
Stock Position:  -0.006021497158971816
Bond Position:  [-7.3504906]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-7.96714486]
Stock Price:  102.10357821309672
PL:  [-10.07072308]
Settle:  Tensor("sub_70:0", shape=(), dtype=float64)
PL:  Tensor("sub_71:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  36
output_Z_Vals[:, i, :]:  [[ 1.19271183e+02 -4.92738716e+01 -4.92570741e+01]
 [ 5.14142053e-02  7.68525560e-02 -5.01935784e-02]
 [-2.26328487e+00 -3.04652439e+00 -8.68121939e-01]
 [-5.14421686e-02 -6.44726500e-05 -1.32801337e-01]
 [ 3.16914234e-01 -3.97233556e-02 -2.30725335e-01]
 [-1.36250485e-02 -1.39285720e-02  1.04077298e-02]
 [ 1.32010270e-02  2.42327256e-02  8.57661163e-02]
 [ 1.00347052e-01  2.58926762e-01  1.29456888e-01]
 [ 8.54322187e-02  6.00396825e-02 -5.99928460e-02]
 [-1.11092878e+00 -4.55345574e-01 -4.05797069e-02]
 [ 3.10264212e-01  3.68140840e-02 -5.56969859e-02]
 [-1.18574761e-01 -2.18149653e-02  3.10339451e-02]
 [-7.65841881e-01 -1.02381852e+00  2.71726992e-01]
 [-1.20473089e-02 -1.77180705e-02 -7.94114067e-03]
 [-7.16224626e-02 -4.31165610e-02 -1.94784091e-02]
 [ 1.29151228e-01  1.54705389e-02  3.30206620e-02]
 [-7.28693189e-02 -8.25490631e-02 -9.86431327e-02]
 [-6.77890817e-02 -1.65506322e-01  2.61431172e-01]
 [ 6.56454992e-02 -1.33116372e-01  1.36223305e-01]
 [ 1.10400509e-01 -9.38735159e-01 -2.92939104e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.27118322 -49.27387164 -49.25707411]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [   7.3268874   -15.90307369 -140.51672192]
init_Out:  [2.48374395]
Stock Position:  7.326887399052493
Bond position:  [-730.20499595]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-4.66135701]
curr_Stock_Price:  99.04972923565937
curr_Factors:  [99.04972924 -0.76047073 -1.05067807]
mat_Sqrt:  [[16.19128672  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00351152  0.02480406 -0.14318831]
Stock Position:  0.003511515010155323
Bond Position:  [-5.00917162]


portfolio before change:  [-4.65929704]
curr_Stock_Price:  99.99303033971208
curr_Factors:  [99.99303034 -0.87142421 -1.05034881]
mat_Sqrt:  [[14.63370562  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.20926748 -0.98326152 -2.47651025]
Stock Position:  -0.20926748040134618
Bond Position:  [16.26599248]


portfolio before change:  [-4.37969329]
curr_Stock_Price:  98.67635780774278
curr_Factors:  [98.67635781 -0.87301271 -1.0538699 ]
mat_Sqrt:  [[14.36741473  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-5.46815763e-03 -2.08084583e-05 -3.78845249e-01]
Stock Position:  -0.0054681576254792825
Bond Position:  [-3.84011541]


portfolio before change:  [-4.38371949]
curr_Stock_Price:  99.2370685030904
curr_Factors:  [99.2370685  -1.07864161 -1.05592316]
mat_Sqrt:  [[11.73935472  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.02229331 -0.01282066 -0.65819516]
Stock Position:  0.022293314432232456
Bond Position:  [-6.59604267]


portfolio before change:  [-4.36030793]
curr_Stock_Price:  100.36120731197538
curr_Factors:  [100.36120731  -1.22814757  -1.03417977]
mat_Sqrt:  [[10.44839542  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00137282 -0.00449543  0.02969036]
Stock Position:  -0.001372817239739318
Bond Position:  [-4.22253034]


portfolio before change:  [-4.3622718]
curr_Stock_Price:  101.02269674686416
curr_Factors:  [101.02269675  -1.2441245   -1.04105954]
mat_Sqrt:  [[10.27959816  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00346847 0.00782108 0.24466686]
Stock Position:  0.0034684669550388283
Bond Position:  [-4.71266569]


portfolio before change:  [-4.36638949]
curr_Stock_Price:  100.17523990989767
curr_Factors:  [100.17523991  -0.89523427  -1.05795403]
mat_Sqrt:  [[14.20697087  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01264348 0.08356825 0.36930447]
Stock Position:  0.01264347862181752
Bond Position:  [-5.63295299]


portfolio before change:  [-4.3566874]
curr_Stock_Price:  101.05399327906288
curr_Factors:  [101.05399328  -0.72649443  -1.08259032]
mat_Sqrt:  [[16.5530473   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00516169  0.01937772 -0.17114289]
Stock Position:  0.005161694860568565
Bond Position:  [-4.87829728]


portfolio before change:  [-4.3615334]
curr_Stock_Price:  100.35145947344995
curr_Factors:  [100.35145947  -0.65083827  -1.07205902]
mat_Sqrt:  [[17.91756162  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.06765201 -0.14696215 -0.11576261]
Stock Position:  -0.06765201272787398
Bond Position:  [2.42744482]


portfolio before change:  [-4.36582362]
curr_Stock_Price:  100.42384698170652
curr_Factors:  [100.42384698  -0.21216435  -1.092846  ]
mat_Sqrt:  [[27.23190744  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01125187  0.01188169 -0.158888  ]
Stock Position:  0.011251865350517958
Bond Position:  [-5.49577922]


portfolio before change:  [-4.35321905]
curr_Stock_Price:  101.66619080083363
curr_Factors:  [101.6661908   -0.45533598  -1.12281038]
mat_Sqrt:  [[20.97955631  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00556222 -0.00704075  0.08853121]
Stock Position:  -0.0055622217568150455
Bond Position:  [-3.78772915]


portfolio before change:  [-4.36388914]
curr_Stock_Price:  103.4142409407634
curr_Factors:  [103.41424094  -0.82525648  -1.1495916 ]
mat_Sqrt:  [[14.35207594  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.06405777 -0.33043601  0.77516147]
Stock Position:  -0.0640577659126563
Bond Position:  [2.26059609]


portfolio before change:  [-4.36585666]
curr_Stock_Price:  103.45377931597544
curr_Factors:  [103.45377932  -0.79076708  -1.14063423]
mat_Sqrt:  [[14.99510226  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00115271 -0.00571848 -0.02265386]
Stock Position:  -0.0011527079424646456
Bond Position:  [-4.24660467]


portfolio before change:  [-4.36878688]
curr_Stock_Price:  105.07468760915872
curr_Factors:  [105.07468761  -0.91316871  -1.12292384]
mat_Sqrt:  [[13.71621694  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00615327 -0.01391581 -0.05556648]
Stock Position:  -0.0061532715427851815
Bond Position:  [-3.7222338]


portfolio before change:  [-4.36981651]
curr_Stock_Price:  105.09076976462195
curr_Factors:  [105.09076976  -1.14160409  -1.09052841]
mat_Sqrt:  [[11.27617347  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01233126 0.00499309 0.09419876]
Stock Position:  0.012331262279753853
Bond Position:  [-5.66571836]


portfolio before change:  [-4.36089012]
curr_Stock_Price:  105.92953245140573
curr_Factors:  [105.92953245  -0.93166522  -1.11418286]
mat_Sqrt:  [[13.69356487  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00802238 -0.0266426  -0.2814014 ]
Stock Position:  -0.008022382924503949
Bond Position:  [-3.51108285]


portfolio before change:  [-4.36869303]
curr_Stock_Price:  106.79274634080939
curr_Factors:  [106.79274634  -1.31936179  -1.14153825]
mat_Sqrt:  [[ 9.11562498  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00528856 -0.05341694  0.74579036]
Stock Position:  -0.005288557158266666
Bond Position:  [-3.80391349]


portfolio before change:  [-4.37041989]
curr_Stock_Price:  106.93943363088974
curr_Factors:  [106.93943363  -1.32933296  -1.19217783]
mat_Sqrt:  [[ 8.59131527  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00771473 -0.04296312  0.38860717]
Stock Position:  0.007714732527147035
Bond Position:  [-5.19542902]


portfolio before change:  [-4.3748376]
curr_Stock_Price:  106.53518315478189
curr_Factors:  [106.53518315  -1.21867964  -1.1732458 ]
mat_Sqrt:  [[ 9.74300748  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01447335 -0.30297547 -0.83567372]
Stock Position:  -0.014473348947698778
Bond Position:  [-2.83291672]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-4.37254698]
Stock Price:  106.32797943954702
PL:  [-10.70052642]
Settle:  Tensor("sub_72:0", shape=(), dtype=float64)
PL:  Tensor("sub_73:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  37
output_Z_Vals[:, i, :]:  [[ 1.19271183e+02 -4.92738716e+01 -4.92570741e+01]
 [ 6.19081956e-02  1.08355377e-01 -2.57172309e-02]
 [-2.15739828e+00 -2.73998375e+00 -7.93926860e-01]
 [ 2.85961434e-02  1.11437280e-01 -8.35239703e-02]
 [ 4.54104216e-01 -1.35737811e-01 -1.83970706e-01]
 [-1.40813928e-01 -2.30909950e-01 -2.20711837e-02]
 [-1.83378574e-02  3.36598931e-02 -2.95841189e-02]
 [ 7.67200350e-02  1.35623405e-01  1.29277245e-02]
 [ 6.71952475e-02  9.95084826e-02 -6.38766953e-02]
 [-8.49976760e-01 -3.49260239e-01 -2.72726483e-02]
 [ 3.49241124e-01  3.55800943e-02 -4.61171374e-02]
 [-1.39685168e-01 -2.60126903e-03  2.97314522e-02]
 [-7.72246806e-01 -1.02452439e+00  2.73552729e-01]
 [ 3.02958688e-03 -3.61422083e-02 -1.99622520e-02]
 [-1.73138541e-01 -2.18801248e-01  7.78226949e-02]
 [ 1.11504416e-01  2.02203939e-02  4.13757198e-02]
 [-2.41952705e-01 -2.48134493e-01 -2.63404834e-01]
 [-2.45636889e-01 -3.26978630e-01  5.23983930e-01]
 [ 4.53446546e-02 -1.79612398e-03  3.70861343e-02]
 [ 2.99292046e-02 -4.41037223e-01  2.01537887e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.27118322 -49.27387164 -49.25707411]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [   7.3268874   -15.90307369 -140.51672192]
init_Out:  [2.48374395]
Stock Position:  7.326887399052493
Bond position:  [-730.20499595]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-0.20707198]
curr_Stock_Price:  99.65766610994552
curr_Factors:  [99.65766611 -1.52376172 -1.01643244]
mat_Sqrt:  [[ 7.85811547  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01002488  0.03497155 -0.0733641 ]
Stock Position:  0.010024876410425838
Bond Position:  [-1.20612777]


portfolio before change:  [-0.210202]
curr_Stock_Price:  99.37552295004248
curr_Factors:  [99.37552295 -1.27627634 -0.99942932]
mat_Sqrt:  [[10.2082905   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.28200165 -0.88432595 -2.26485235]
Stock Position:  -0.2820016498427531
Bond Position:  [27.81385942]


portfolio before change:  [-0.13253864]
curr_Stock_Price:  99.12478318913017
curr_Factors:  [99.12478319 -1.0561681  -0.96407339]
mat_Sqrt:  [[13.14626913  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00260864  0.03596623 -0.23827064]
Stock Position:  0.0026086430716555265
Bond Position:  [-0.39111982]


portfolio before change:  [-0.13451242]
curr_Stock_Price:  98.40564267099917
curr_Factors:  [98.40564267 -1.17147769 -0.93038748]
mat_Sqrt:  [[12.02794837  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.03232837 -0.04380919 -0.52481722]
Stock Position:  0.03232837194323261
Bond Position:  [-3.31580663]


portfolio before change:  [-0.15031647]
curr_Stock_Price:  97.94242738706802
curr_Factors:  [97.94242739 -1.2356833  -0.90943129]
mat_Sqrt:  [[11.46461392  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01678674 -0.07452587 -0.06296294]
Stock Position:  -0.016786739391567305
Bond Position:  [1.49381754]


portfolio before change:  [-0.16321815]
curr_Stock_Price:  98.73324107547708
curr_Factors:  [98.73324108 -1.2092188  -0.92461542]
mat_Sqrt:  [[11.68828966  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00149773  0.01086368 -0.08439526]
Stock Position:  -0.0014977292605501214
Bond Position:  [-0.01534249]


portfolio before change:  [-0.16264094]
curr_Stock_Price:  98.34528659204952
curr_Factors:  [98.34528659 -1.05828764 -0.91795668]
mat_Sqrt:  [[13.62955096  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00785374 0.04377227 0.0368792 ]
Stock Position:  0.00785373689174729
Bond Position:  [-0.93501894]


portfolio before change:  [-0.16297477]
curr_Stock_Price:  98.33254765088743
curr_Factors:  [98.33254765 -0.82079204 -0.91399205]
mat_Sqrt:  [[17.34962664  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00429223  0.03211622 -0.18222243]
Stock Position:  0.004292228139448348
Bond Position:  [-0.5850405]


portfolio before change:  [-0.16566368]
curr_Stock_Price:  97.74016656197033
curr_Factors:  [97.74016656 -0.64629388 -0.93639602]
mat_Sqrt:  [[20.07795999  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.04616187 -0.11272326 -0.07780127]
Stock Position:  -0.04616187172073444
Bond Position:  [4.34620535]


portfolio before change:  [-0.28954177]
curr_Stock_Price:  100.44726588654355
curr_Factors:  [100.44726589  -0.78271221  -0.95673727]
mat_Sqrt:  [[17.64025297  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01967604  0.01148343 -0.13155936]
Stock Position:  0.019676036381129067
Bond Position:  [-2.26594582]


portfolio before change:  [-0.25354032]
curr_Stock_Price:  102.30577030688661
curr_Factors:  [102.30577031  -0.80989656  -0.96290826]
mat_Sqrt:  [[17.37723921  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00771971 -0.00083956  0.08481556]
Stock Position:  -0.007719709736664892
Bond Position:  [0.53623053]


portfolio before change:  [-0.26274497]
curr_Stock_Price:  103.51549480572223
curr_Factors:  [103.51549481  -0.84394469  -0.99214137]
mat_Sqrt:  [[16.50453595  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.05607781 -0.33066382  0.78036979]
Stock Position:  -0.05607781142967906
Bond Position:  [5.54217743]


portfolio before change:  [-0.36344668]
curr_Stock_Price:  105.33595503498766
curr_Factors:  [105.33595503  -0.53432757  -0.99941165]
mat_Sqrt:  [[22.72386287  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00037065 -0.01166485 -0.05694675]
Stock Position:  -0.0003706538879516996
Bond Position:  [-0.3244035]


portfolio before change:  [-0.36375938]
curr_Stock_Price:  105.96077274719899
curr_Factors:  [105.96077275  -0.37397502  -0.98807077]
mat_Sqrt:  [[27.14039399  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00743967 -0.0706178   0.22200649]
Stock Position:  -0.007439673421326052
Bond Position:  [0.42455417]


portfolio before change:  [-0.37809916]
curr_Stock_Price:  107.90251615751679
curr_Factors:  [107.90251616  -0.36406396  -0.97710081]
mat_Sqrt:  [[28.22091665  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00439666 0.0065261  0.11803341]
Stock Position:  0.004396656255642559
Bond Position:  [-0.85250944]


portfolio before change:  [-0.3640477]
curr_Stock_Price:  111.14694028170182
curr_Factors:  [111.14694028  -0.41364426  -0.98019466]
mat_Sqrt:  [[27.57788515  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01255971 -0.08008506 -0.75142067]
Stock Position:  -0.012559709739950475
Bond Position:  [1.03192561]


portfolio before change:  [-0.39094691]
curr_Stock_Price:  113.30918930299735
curr_Factors:  [113.3091893   -0.21407948  -0.99020066]
mat_Sqrt:  [[33.98231124  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00604501 -0.1055319   1.4947803 ]
Stock Position:  -0.006045008205035619
Bond Position:  [0.29400807]


portfolio before change:  [-0.38619189]
curr_Stock_Price:  112.53474742664854
curr_Factors:  [112.53474743  -0.1776428   -0.99953858]
mat_Sqrt:  [[34.67713926  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00151536 -0.0005797   0.10579642]
Stock Position:  0.0015153556174571292
Bond Position:  [-0.55672205]


portfolio before change:  [-0.38757785]
curr_Stock_Price:  111.71199377093716
curr_Factors:  [111.71199377  -0.4927884   -0.9485008 ]
mat_Sqrt:  [[26.43357218  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00211789 -0.14234415  0.05749315]
Stock Position:  -0.0021178850210899444
Bond Position:  [-0.15098469]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-0.39271784]
Stock Price:  114.1211136261356
PL:  [-14.51383147]
Settle:  Tensor("sub_74:0", shape=(), dtype=float64)
PL:  Tensor("sub_75:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  38
output_Z_Vals[:, i, :]:  [[ 1.19271183e+02 -4.92738716e+01 -4.92570741e+01]
 [-1.92572724e-04 -6.92507645e-03 -7.12323750e-02]
 [-2.00538653e+00 -2.70261031e+00 -7.68633964e-01]
 [-3.64593910e-02  2.50634701e-02 -1.20948145e-01]
 [ 3.99304467e-01 -3.54266445e-02 -9.41240356e-02]
 [-1.45188566e-01 -2.52535272e-01  3.57229917e-02]
 [-2.48868501e-02  4.78863491e-02 -2.15492551e-02]
 [ 9.68840937e-02  2.38980441e-01  1.07020186e-01]
 [ 9.60732880e-03  1.44609416e-01 -5.58363140e-02]
 [-9.43938127e-01 -3.86396729e-01 -3.20867108e-02]
 [ 3.86948227e-01  5.69783218e-02 -2.40627413e-02]
 [-8.77469040e-03 -5.72417016e-02  3.55480672e-02]
 [-7.00667214e-01 -9.82048423e-01  2.45066724e-01]
 [ 2.40452125e-03 -3.59240714e-02 -2.00140346e-02]
 [-1.11596238e-01 -1.12295556e-01  1.88356448e-02]
 [ 1.24222655e-01  1.43569038e-02  3.12214033e-02]
 [-3.51254655e-02 -4.55860454e-02 -6.18639928e-02]
 [ 2.12521420e-03 -9.64794803e-02  1.73988286e-01]
 [ 9.57976880e-03  3.71812028e-02 -2.29304270e-03]
 [ 2.70817172e-02 -3.24874505e-01 -2.21975631e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.27118322 -49.27387164 -49.25707411]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [   7.3268874   -15.90307369 -140.51672192]
init_Out:  [2.48374395]
Stock Position:  7.326887399052493
Bond position:  [-730.20499595]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [14.45217666]
curr_Stock_Price:  101.65841320071101
curr_Factors:  [101.6584132   -0.95443871  -1.01534766]
mat_Sqrt:  [[14.17999173  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00113867 -0.00223506 -0.20320614]
Stock Position:  -0.001138674549679885
Bond Position:  [14.56793251]


portfolio before change:  [14.45650037]
curr_Stock_Price:  101.06011837249471
curr_Factors:  [101.06011837  -1.29644188  -0.99261723]
mat_Sqrt:  [[10.24363417  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.26494028 -0.87226373 -2.19269875]
Stock Position:  -0.2649402796673997
Bond Position:  [41.23139639]


portfolio before change:  [15.09433194]
curr_Stock_Price:  98.69157540090004
curr_Factors:  [98.6915754  -0.77958871 -0.98259828]
mat_Sqrt:  [[16.94228554  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00330721  0.0080892  -0.34503139]
Stock Position:  -0.003307214257355345
Bond Position:  [15.42072613]


portfolio before change:  [15.10379514]
curr_Stock_Price:  96.99602825953444
curr_Factors:  [96.99602826 -0.67686021 -0.98813406]
mat_Sqrt:  [[18.3508476   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.02031841 -0.0114339  -0.26850967]
Stock Position:  0.02031840998651595
Bond Position:  [13.13299007]


portfolio before change:  [15.10946387]
curr_Stock_Price:  97.11341302692122
curr_Factors:  [97.11341303 -0.90350073 -0.97066783]
mat_Sqrt:  [[14.90521196  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01271    -0.08150541  0.10190775]
Stock Position:  -0.012709996174545626
Bond Position:  [16.34377498]


portfolio before change:  [15.1034595]
curr_Stock_Price:  97.90734104628082
curr_Factors:  [97.90734105 -0.75141449 -0.94879306]
mat_Sqrt:  [[17.88234611  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00109107  0.01545525 -0.06147403]
Stock Position:  -0.0010910656362818853
Bond Position:  [15.21028284]


portfolio before change:  [15.10808506]
curr_Stock_Price:  97.15348477632848
curr_Factors:  [97.15348478 -0.5968889  -0.93938118]
mat_Sqrt:  [[20.90570251  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.0080127  0.07713061 0.3052988 ]
Stock Position:  0.008012702557663084
Bond Position:  [14.32962308]


portfolio before change:  [15.11048072]
curr_Stock_Price:  97.00532133467253
curr_Factors:  [97.00532133 -0.92233205 -0.96744773]
mat_Sqrt:  [[14.65799711  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00189167  0.04667249 -0.15928546]
Stock Position:  0.0018916678862505151
Bond Position:  [14.92697887]


portfolio before change:  [15.11810881]
curr_Stock_Price:  99.06481589694789
curr_Factors:  [99.0648159  -0.89674968 -0.96153802]
mat_Sqrt:  [[15.44810967  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.06663344 -0.12470901 -0.09153445]
Stock Position:  -0.0666334407791546
Bond Position:  [21.71913836]


portfolio before change:  [14.99803925]
curr_Stock_Price:  100.94825500838341
curr_Factors:  [100.94825501  -0.61171705  -1.02946023]
mat_Sqrt:  [[19.55890675  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.02012725  0.01838967 -0.0686443 ]
Stock Position:  0.02012725437387462
Bond Position:  [12.96622804]


portfolio before change:  [15.00313859]
curr_Stock_Price:  101.04053667373182
curr_Factors:  [101.04053667  -0.85867318  -1.03231626]
mat_Sqrt:  [[15.24928089  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0008658  -0.01847468  0.10140874]
Stock Position:  -0.0008658037755808908
Bond Position:  [15.09061986]


portfolio before change:  [15.00617463]
curr_Stock_Price:  101.89186811903706
curr_Factors:  [101.89186812  -0.6613328   -1.02745995]
mat_Sqrt:  [[18.82375011  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.04521432 -0.31695477  0.69910715]
Stock Position:  -0.045214315350864
Bond Position:  [19.61314568]


portfolio before change:  [14.85066583]
curr_Stock_Price:  105.43969798760622
curr_Factors:  [105.43969799  -0.81373898  -1.03479639]
mat_Sqrt:  [[16.60333925  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00054289 -0.01159444 -0.05709447]
Stock Position:  -0.0005428906010278796
Bond Position:  [14.90790805]


portfolio before change:  [14.85378733]
curr_Stock_Price:  106.55582715276257
curr_Factors:  [106.55582715  -1.01276187  -1.01103687]
mat_Sqrt:  [[14.0816186   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00927973 -0.03624323  0.05373285]
Stock Position:  -0.009279733140184813
Bond Position:  [15.84259697]


portfolio before change:  [14.87234952]
curr_Stock_Price:  104.98239334953374
curr_Factors:  [104.98239335  -1.19647161  -0.95320743]
mat_Sqrt:  [[12.23271114  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01091551 0.00463367 0.08906597]
Stock Position:  0.010915510630645353
Bond Position:  [13.72641309]


portfolio before change:  [14.87280725]
curr_Stock_Price:  104.70990933859103
curr_Factors:  [104.70990934  -1.14041207  -0.93182411]
mat_Sqrt:  [[13.18338833  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00432807 -0.01471283 -0.17648075]
Stock Position:  -0.004328068877225893
Bond Position:  [15.32599895]


portfolio before change:  [14.8806151]
curr_Stock_Price:  103.79128482831827
curr_Factors:  [103.79128483  -0.76827635  -0.93418961]
mat_Sqrt:  [[18.91425826  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00094884 -0.03113862  0.49634015]
Stock Position:  0.000948841490775254
Bond Position:  [14.78213363]


portfolio before change:  [14.88409529]
curr_Stock_Price:  103.56383818850544
curr_Factors:  [103.56383819  -0.74050222  -0.8971055 ]
mat_Sqrt:  [[20.13743464  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00082937  0.01200018 -0.00654141]
Stock Position:  0.0008293650585346165
Bond Position:  [14.79820306]


portfolio before change:  [14.88813762]
curr_Stock_Price:  103.97658699267997
curr_Factors:  [103.97658699  -0.13240633  -0.86374061]
mat_Sqrt:  [[38.3985159   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00220174 -0.1048528  -0.63323469]
Stock Position:  -0.002201741328099171
Bond Position:  [15.11706717]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [14.89468209]
Stock Price:  102.72088688445486
PL:  [12.1737952]
Settle:  Tensor("sub_76:0", shape=(), dtype=float64)
PL:  Tensor("sub_77:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  39
output_Z_Vals[:, i, :]:  [[ 1.19271183e+02 -4.92738716e+01 -4.92570741e+01]
 [ 7.25288863e-02  1.22450223e-01 -3.73800957e-02]
 [-2.41053542e+00 -3.24288679e+00 -9.24925947e-01]
 [ 5.76355826e-02  1.71449090e-01 -7.36614035e-02]
 [ 8.43850107e-01 -1.59264262e-01 -3.64744301e-01]
 [ 8.15423545e-02  1.71083858e-01  2.59230258e-02]
 [ 6.41004082e-02 -5.57474539e-02  9.06564346e-02]
 [-1.46460894e-02  2.79360394e-01  4.32038537e-01]
 [ 5.48179575e-02 -1.87861383e-02 -3.34429025e-02]
 [-1.00294847e+00 -4.15719459e-01 -3.49825331e-02]
 [ 1.41477965e-01  1.41217164e-02 -1.38537125e-01]
 [-1.76726185e-02 -7.35413278e-02  3.44369887e-02]
 [-7.25576498e-01 -8.71625815e-01  2.52984184e-01]
 [ 1.36748775e-02  2.48454237e-02  5.19602488e-02]
 [ 5.73780970e-02  1.04202125e-01 -9.36563181e-02]
 [ 6.03776901e-02  3.39817765e-02  6.55821740e-02]
 [ 1.25539909e-01  1.15578973e-01  1.03380930e-01]
 [ 9.65990957e-02 -1.64985396e-02  1.65496533e-02]
 [-4.77817096e-02 -8.81755841e-02 -8.58492196e-03]
 [ 5.46453808e-02 -3.96605194e-01 -4.43930257e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.27118322 -49.27387164 -49.25707411]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [   7.3268874   -15.90307369 -140.51672192]
init_Out:  [2.48374395]
Stock Position:  7.326887399052493
Bond position:  [-730.20499595]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-7.03058795]
curr_Stock_Price:  98.72636805683288
curr_Factors:  [98.72636806 -0.60872882 -0.98453783]
mat_Sqrt:  [[20.06717543  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00447964  0.03952064 -0.10663501]
Stock Position:  0.004479641572070534
Bond Position:  [-7.4728467]


portfolio before change:  [-7.0273091]
curr_Stock_Price:  99.87541123301718
curr_Factors:  [99.87541123 -0.68814213 -0.98288303]
mat_Sqrt:  [[18.78198864  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.17363905 -1.04663721 -2.63855628]
Stock Position:  -0.17363904840254765
Bond Position:  [10.31496227]


portfolio before change:  [-7.08016315]
curr_Stock_Price:  100.19465458105505
curr_Factors:  [100.19465458  -0.58019218  -1.00223012]
mat_Sqrt:  [[20.58767397  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00376907  0.05533496 -0.21013548]
Stock Position:  0.0037690712747149918
Bond Position:  [-7.45780394]


portfolio before change:  [-7.08567766]
curr_Stock_Price:  99.2262905561642
curr_Factors:  [99.22629056 -0.26626598 -1.01055851]
mat_Sqrt:  [[27.67635714  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.02662516 -0.05140232 -1.04051397]
Stock Position:  0.026625155314648295
Bond Position:  [-9.72759306]


portfolio before change:  [-7.0423532]
curr_Stock_Price:  100.944840640339
curr_Factors:  [100.94484064  -0.24009316  -1.02811752]
mat_Sqrt:  [[28.39927329  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.0042873  0.05521708 0.07395118]
Stock Position:  0.00428730041765636
Bond Position:  [-7.47513406]


portfolio before change:  [-7.03160801]
curr_Stock_Price:  103.88706635117747
curr_Factors:  [103.88706635  -0.17262534  -1.0441879 ]
mat_Sqrt:  [[30.76849171  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00231491 -0.01799241  0.25861757]
Stock Position:  0.0023149062580248075
Bond Position:  [-7.27209683]


portfolio before change:  [-7.0298607]
curr_Stock_Price:  105.42732833638912
curr_Factors:  [105.42732834  -0.17459811  -1.02896177]
mat_Sqrt:  [[31.64126116  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.0041265  0.09016318 1.23248569]
Stock Position:  0.00412649826483098
Bond Position:  [-7.46490639]


portfolio before change:  [-7.04341268]
curr_Stock_Price:  102.59550487416118
curr_Factors:  [ 1.02595505e+02 -4.55223510e-02 -1.02378671e+00]
mat_Sqrt:  [[35.21545547  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0012539  -0.0060632  -0.09540329]
Stock Position:  0.001253902544326073
Bond Position:  [-7.17205744]


portfolio before change:  [-7.050471]
curr_Stock_Price:  98.39654758620169
curr_Factors:  [98.39654759  0.12326885 -1.00464204]
mat_Sqrt:  [[40.75720071  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02686513 -0.13417288 -0.09979543]
Stock Position:  -0.026865133219314496
Bond Position:  [-4.40703464]


portfolio before change:  [-7.05815689]
curr_Stock_Price:  98.64162349430194
curr_Factors:  [ 9.86416235e+01  7.35061523e-02 -1.01804692e+00]
mat_Sqrt:  [[38.35759475  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0030263   0.00455776 -0.39520786]
Stock Position:  0.0030263048650231356
Bond Position:  [-7.35667652]


portfolio before change:  [-7.05587585]
curr_Stock_Price:  100.00316566156846
curr_Factors:  [100.00316566   0.12619631  -0.98628212]
mat_Sqrt:  [[42.31391696  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0006063  -0.02373536  0.09823914]
Stock Position:  -0.0006062959933283767
Bond Position:  [-6.99524433]


portfolio before change:  [-7.05929842]
curr_Stock_Price:  102.76342908904651
curr_Factors:  [102.76342909  -0.1047054   -0.94261945]
mat_Sqrt:  [[36.05713258  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02362518 -0.28131602  0.72169346]
Stock Position:  -0.023625178462340538
Bond Position:  [-4.63149406]


portfolio before change:  [-7.01208801]
curr_Stock_Price:  100.716104001748
curr_Factors:  [100.716104    -0.20122446  -0.93066991]
mat_Sqrt:  [[32.47307661  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00090391 0.00801883 0.14822813]
Stock Position:  0.0009039109557993775
Bond Position:  [-7.1031264]


portfolio before change:  [-7.01458651]
curr_Stock_Price:  99.9168069765776
curr_Factors:  [99.91680698 -0.34721766 -0.89812415]
mat_Sqrt:  [[28.76030406  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00206989  0.03363109 -0.26717541]
Stock Position:  0.002069892959433248
Bond Position:  [-7.22140361]


portfolio before change:  [-7.01271803]
curr_Stock_Price:  101.69180726909748
curr_Factors:  [101.69180727  -0.68256053  -0.89602558]
mat_Sqrt:  [[20.97561636  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00384738 0.01096757 0.18708769]
Stock Position:  0.003847376642848807
Bond Position:  [-7.40396471]


portfolio before change:  [-7.02096054]
curr_Stock_Price:  100.03060064101166
curr_Factors:  [100.03060064  -0.42893394  -0.94312771]
mat_Sqrt:  [[25.36612179  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00671111 0.03730295 0.29491702]
Stock Position:  0.006711113109815568
Bond Position:  [-7.69227721]


portfolio before change:  [-7.02321399]
curr_Stock_Price:  99.9814064857673
curr_Factors:  [99.98140649 -0.29021342 -0.93497618]
mat_Sqrt:  [[29.36473978  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00328998 -0.00532488  0.04721155]
Stock Position:  0.0032899841780003377
Bond Position:  [-7.35215124]


portfolio before change:  [-7.02796254]
curr_Stock_Price:  99.09681840334856
curr_Factors:  [99.0968184  -0.35251212 -0.94969246]
mat_Sqrt:  [[26.94756015  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00250608 -0.02845855 -0.02449039]
Stock Position:  -0.002506084589588216
Bond Position:  [-6.77961753]


portfolio before change:  [-7.03030095]
curr_Stock_Price:  99.35350907023165
curr_Factors:  [99.35350907 -0.39801641 -0.96967685]
mat_Sqrt:  [[25.30472212  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00462081 -0.12800378 -1.26640946]
Stock Position:  -0.00462080552344115
Bond Position:  [-6.5712077]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-7.04627371]
Stock Price:  102.45464732416197
PL:  [-9.50092104]
Settle:  Tensor("sub_78:0", shape=(), dtype=float64)
PL:  Tensor("sub_79:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  40
output_Z_Vals[:, i, :]:  [[ 1.19271183e+02 -4.92738716e+01 -4.92570741e+01]
 [ 4.43948768e-02  7.99636916e-02 -3.41589490e-02]
 [-2.15550501e+00 -2.90279717e+00 -8.26544317e-01]
 [-2.17473104e-01 -5.48821416e-02  1.41498487e-01]
 [ 5.37548781e-01  3.44320666e-01 -6.48582888e-01]
 [ 2.97728285e-02  5.39483493e-02  8.56539048e-04]
 [ 6.89951800e-02 -1.02109170e-01 -7.76744698e-02]
 [-1.84221463e-02  6.20454713e-03  3.57930680e-02]
 [-6.00239712e-02 -3.14481966e-01  6.61527305e-02]
 [-1.39977940e+00 -5.23301830e-01 -5.63610388e-02]
 [ 5.18352514e-01  1.11456351e-01  7.34207985e-02]
 [-2.99903756e-02 -4.61666983e-02  3.45276260e-02]
 [-8.01714969e-01 -1.23930477e+00  2.88485253e-01]
 [-2.10774849e-02 -2.08863869e-02 -1.50605647e-02]
 [ 5.11384686e-02  1.15577785e-01 -1.01158013e-01]
 [ 1.01867141e-01  2.28143841e-02  4.59385830e-02]
 [ 8.83604523e-03 -2.53399961e-03 -1.90261157e-02]
 [ 4.23584192e-02 -6.53883104e-02  9.87438743e-02]
 [ 1.94064099e-02 -2.05082524e-02  2.94136977e-02]
 [ 7.78715919e-02 -6.66261276e-01 -4.32491134e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.27118322 -49.27387164 -49.25707411]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [   7.3268874   -15.90307369 -140.51672192]
init_Out:  [2.48374395]
Stock Position:  7.326887399052493
Bond position:  [-730.20499595]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [1.03985527]
curr_Stock_Price:  99.82785123621584
curr_Factors:  [99.82785124 -1.27265735 -1.05176798]
mat_Sqrt:  [[ 9.76712242  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00550262  0.02580817 -0.09744597]
Stock Position:  0.005502616681401566
Bond Position:  [0.49054087]


portfolio before change:  [1.04118882]
curr_Stock_Price:  100.0479101926516
curr_Factors:  [100.04791019  -1.04350525  -1.05866801]
mat_Sqrt:  [[12.22491301  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.23859095 -0.93687376 -2.35790087]
Stock Position:  -0.23859095394053143
Bond Position:  [24.91171516]


portfolio before change:  [0.53005053]
curr_Stock_Price:  102.21633690750096
curr_Factors:  [102.21633691  -1.09636963  -1.09659305]
mat_Sqrt:  [[11.40587796  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01751664 -0.01771314  0.4036558 ]
Stock Position:  -0.017516636320918325
Bond Position:  [2.32053693]


portfolio before change:  [0.50851045]
curr_Stock_Price:  103.47915271834897
curr_Factors:  [103.47915272  -1.3738895   -1.10400731]
mat_Sqrt:  [[ 8.6839228   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.05474962  0.11112902 -1.85022645]
Stock Position:  0.0547496248141354
Bond Position:  [-5.15693433]


portfolio before change:  [0.53283022]
curr_Stock_Price:  103.9469030926151
curr_Factors:  [103.94690309  -1.50633362  -1.11111821]
mat_Sqrt:  [[ 7.58694033  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00539873 0.01741175 0.00244347]
Stock Position:  0.005398728302387111
Bond Position:  [-0.02835087]


portfolio before change:  [0.53193846]
curr_Stock_Price:  103.78303674731927
curr_Factors:  [103.78303675  -1.71495909  -1.15400717]
mat_Sqrt:  [[ 5.8904728   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00548292 -0.03295559 -0.22158364]
Stock Position:  0.005482921198919199
Bond Position:  [-0.03709575]


portfolio before change:  [0.53434483]
curr_Stock_Price:  104.22361307003867
curr_Factors:  [104.22361307  -1.70500874  -1.17331483]
mat_Sqrt:  [[ 5.86038411  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00168068  0.00200251  0.10210766]
Stock Position:  -0.0016806780630894767
Bond Position:  [0.70951117]


portfolio before change:  [0.53523364]
curr_Stock_Price:  103.80032774191261
curr_Factors:  [103.80032774  -1.77425077  -1.1835935 ]
mat_Sqrt:  [[ 5.39042833  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02053899 -0.10149862  0.18871533]
Stock Position:  -0.020538991936302948
Bond Position:  [2.66718773]


portfolio before change:  [0.53539512]
curr_Stock_Price:  103.82493451840085
curr_Factors:  [103.82493452  -1.67881306  -1.14961605]
mat_Sqrt:  [[ 6.13663804  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.24738343 -0.16889494 -0.16078236]
Stock Position:  -0.24738343371700036
Bond Position:  [26.21996392]


portfolio before change:  [0.5921862]
curr_Stock_Price:  103.62186808072757
curr_Factors:  [103.62186808  -1.76395384  -1.15163785]
mat_Sqrt:  [[ 5.61340061  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.0990648  0.03597238 0.2094491 ]
Stock Position:  0.0990647990516843
Bond Position:  [-9.67309334]


portfolio before change:  [0.5646713]
curr_Stock_Price:  103.36853567907205
curr_Factors:  [103.36853568  -1.94654109  -1.16376823]
mat_Sqrt:  [[ 4.60890959  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00702253 -0.01490024  0.09849771]
Stock Position:  -0.007022526819715209
Bond Position:  [1.29057962]


portfolio before change:  [0.56266943]
curr_Stock_Price:  103.6995500805407
curr_Factors:  [103.69955008  -1.90132275  -1.11535312]
mat_Sqrt:  [[ 5.07751469  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.19611961 -0.3999839   0.82296813]
Stock Position:  -0.19611960811776977
Bond Position:  [20.90018455]


portfolio before change:  [0.62747579]
curr_Stock_Price:  103.39575249584806
curr_Factors:  [103.3957525   -1.42259548  -1.10835969]
mat_Sqrt:  [[ 8.22854091  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00345324 -0.00674105 -0.0429636 ]
Stock Position:  -0.0034532398860335407
Bond Position:  [0.98452613]


portfolio before change:  [0.62599451]
curr_Stock_Price:  103.89599055845721
curr_Factors:  [103.89599056  -1.29641963  -1.06971882]
mat_Sqrt:  [[ 9.74984957  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00554695  0.03730257 -0.28857565]
Stock Position:  0.005546946330740821
Bond Position:  [0.04968903]


portfolio before change:  [0.62583108]
curr_Stock_Price:  103.86428701753717
curr_Factors:  [103.86428702  -1.16577443  -1.12893747]
mat_Sqrt:  [[10.46852585  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.0110714  0.00736331 0.13104999]
Stock Position:  0.011071404235700012
Bond Position:  [-0.52409243]


portfolio before change:  [0.61909005]
curr_Stock_Price:  103.2672542238568
curr_Factors:  [103.26725422  -1.32061482  -1.10856746]
mat_Sqrt:  [[ 9.09875923  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00048744 -0.00081784 -0.05427621]
Stock Position:  0.00048744065150199234
Bond Position:  [0.56875339]


portfolio before change:  [0.61908123]
curr_Stock_Price:  102.95742784966633
curr_Factors:  [102.95742785  -1.45009472  -1.06553485]
mat_Sqrt:  [[ 8.32019768  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00590937 -0.02110399  0.28168879]
Stock Position:  0.005909366227896987
Bond Position:  [0.01066808]


portfolio before change:  [0.62268785]
curr_Stock_Price:  103.56729863830859
curr_Factors:  [103.56729864  -1.20755702  -1.08108439]
mat_Sqrt:  [[10.50215225  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00202094 -0.00661901  0.08390909]
Stock Position:  0.002020940640111147
Bond Position:  [0.41338449]


portfolio before change:  [0.62165505]
curr_Stock_Price:  103.00510727087689
curr_Factors:  [103.00510727  -0.95807834  -1.11168617]
mat_Sqrt:  [[13.00084119  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0112616  -0.2150349  -1.23377682]
Stock Position:  -0.01126160243215352
Bond Position:  [1.78165762]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [0.61071028]
Stock Price:  104.01653014660971
PL:  [-3.40581987]
Settle:  Tensor("sub_80:0", shape=(), dtype=float64)
PL:  Tensor("sub_81:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  41
output_Z_Vals[:, i, :]:  [[ 1.19271183e+02 -4.92738716e+01 -4.92570741e+01]
 [ 7.39287799e-02  1.28606123e-01 -2.31708745e-02]
 [-2.56455119e+00 -2.68229634e+00 -8.36763050e-01]
 [-3.75611144e-02 -1.43666257e-02 -1.32210289e-01]
 [ 4.22494608e-01 -9.79693931e-03 -3.19094335e-01]
 [-6.71574643e-02 -9.86914868e-02  2.24915760e-02]
 [-1.26538324e-02  3.04968686e-02  2.92038895e-04]
 [ 1.01980322e-01  2.53983987e-01  1.21024632e-01]
 [-1.81249358e-01  4.72003125e-01 -1.07946292e-01]
 [-7.45585007e-01 -2.80876433e-01 -2.25007870e-02]
 [ 4.67223939e-02 -3.38624634e-02 -2.81905316e-01]
 [ 1.18613191e-01  3.53630645e-02  1.94873207e-02]
 [-6.85799038e-01 -9.72306630e-01  2.27099348e-01]
 [ 2.73094550e-01  5.23796679e-02  1.43472147e-01]
 [ 1.79863070e-01  1.63042234e-01 -1.07997754e-01]
 [-4.13831873e-01  2.05236615e-01  8.91526925e-02]
 [-1.80476535e-01  1.06643748e-01  1.69035716e-01]
 [ 1.10772134e-01 -1.21510763e-02 -1.88018206e-02]
 [-1.10944700e-01 -5.63378614e-01  1.74056783e-01]
 [ 6.76831696e-02 -4.93286228e-01 -5.34135793e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.27118322 -49.27387164 -49.25707411]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [   7.3268874   -15.90307369 -140.51672192]
init_Out:  [2.48374395]
Stock Position:  7.326887399052493
Bond position:  [-730.20499595]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-6.28072962]
curr_Stock_Price:  98.82871142550182
curr_Factors:  [98.82871143 -1.00412346 -0.98161159]
mat_Sqrt:  [[13.56717288  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00703541  0.04150745 -0.06610006]
Stock Position:  0.0070354126694839965
Bond Position:  [-6.97603038]


portfolio before change:  [-6.28841887]
curr_Stock_Price:  97.9836967309905
curr_Factors:  [97.98369673 -1.12538678 -0.97254518]
mat_Sqrt:  [[12.02357304  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.27303666 -0.86570742 -2.38705207]
Stock Position:  -0.273036656787836
Bond Position:  [20.46472211]


portfolio before change:  [-6.35981722]
curr_Stock_Price:  98.26393444542995
curr_Factors:  [98.26393445 -1.21244911 -1.01646964]
mat_Sqrt:  [[10.57759747  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00637962 -0.00463681 -0.37715915]
Stock Position:  -0.00637961521679037
Bond Position:  [-5.73293113]


portfolio before change:  [-6.37164902]
curr_Stock_Price:  99.89387425786154
curr_Factors:  [99.89387426 -1.13305188 -1.02590941]
mat_Sqrt:  [[11.53224558  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.03081446 -0.00316195 -0.91028732]
Stock Position:  0.030814463305232742
Bond Position:  [-9.44982514]


portfolio before change:  [-6.41010522]
curr_Stock_Price:  98.72255889990818
curr_Factors:  [98.7225589  -0.72943633 -1.01135287]
mat_Sqrt:  [[17.31415335  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00477712 -0.03185254  0.06416221]
Stock Position:  -0.0047771152477068
Bond Position:  [-5.93849618]


portfolio before change:  [-6.41080921]
curr_Stock_Price:  98.55910730522095
curr_Factors:  [98.55910731 -0.81321158 -1.00483362]
mat_Sqrt:  [[16.00036031  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00039806  0.00984282  0.00083311]
Stock Position:  -0.0003980580985030073
Bond Position:  [-6.37157695]


portfolio before change:  [-6.41115891]
curr_Stock_Price:  95.4354708705574
curr_Factors:  [95.43547087 -0.42677236 -0.97785311]
mat_Sqrt:  [[23.42549242  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00762113 0.08197298 0.34524959]
Stock Position:  0.007621126272486854
Bond Position:  [-7.13848468]


portfolio before change:  [-6.41807501]
curr_Stock_Price:  94.76217762652209
curr_Factors:  [94.76217763 -0.35279993 -1.03235486]
mat_Sqrt:  [[23.71755695  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00450875  0.15233835 -0.30794072]
Stock Position:  -0.004508751396933654
Bond Position:  [-5.99081591]


portfolio before change:  [-6.42017566]
curr_Stock_Price:  94.89586421470878
curr_Factors:  [94.89586421 -0.21832654 -1.02826739]
mat_Sqrt:  [[27.28088302  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02959991 -0.09065248 -0.06418848]
Stock Position:  -0.02959990783879343
Bond Position:  [-3.61126682]


portfolio before change:  [-6.46245348]
curr_Stock_Price:  96.29366894737693
curr_Factors:  [96.29366895 -0.27693712 -1.00245142]
mat_Sqrt:  [[26.78960753  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-6.61951991e-04 -1.09290631e-02 -8.04197398e-01]
Stock Position:  -0.0006619519914365505
Bond Position:  [-6.39871169]


portfolio before change:  [-6.46364472]
curr_Stock_Price:  95.67634617824292
curr_Factors:  [95.67634618 -0.44640679 -1.03922127]
mat_Sqrt:  [[21.65731014  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.0059938  0.01141338 0.0555919 ]
Stock Position:  0.005993795103118772
Bond Position:  [-7.03710913]


portfolio before change:  [-6.47582163]
curr_Stock_Price:  93.93831374653605
curr_Factors:  [93.93831375 -0.29362589 -1.05573705]
mat_Sqrt:  [[24.36811193  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.03438567 -0.31381062  0.64785123]
Stock Position:  -0.03438566927103796
Bond Position:  [-3.24568984]


portfolio before change:  [-6.39455307]
curr_Stock_Price:  91.55127042191403
curr_Factors:  [91.55127042 -0.72322553 -1.01840548]
mat_Sqrt:  [[16.04292812  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01951468 0.01690547 0.4092861 ]
Stock Position:  0.019514681611522512
Bond Position:  [-8.18114696]


portfolio before change:  [-6.41551166]
curr_Stock_Price:  90.58210002769958
curr_Factors:  [90.58210003 -0.69888128 -1.06426039]
mat_Sqrt:  [[15.53530141  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01230095  0.05262165 -0.30808753]
Stock Position:  0.012300950736761365
Bond Position:  [-7.52975761]


portfolio before change:  [-6.41632109]
curr_Stock_Price:  90.6693490756459
curr_Factors:  [90.66934908 -0.93844602 -1.02681439]
mat_Sqrt:  [[12.70453425  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0278436   0.06623983  0.25432782]
Stock Position:  -0.02784359502819909
Bond Position:  [-3.89176045]


portfolio before change:  [-6.39166863]
curr_Stock_Price:  89.74901094906991
curr_Factors:  [89.74901095 -0.92542545 -1.04320128]
mat_Sqrt:  [[12.53331467  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00990988  0.03441912  0.48221185]
Stock Position:  -0.009909884440508257
Bond Position:  [-5.5022663]


portfolio before change:  [-6.38158304]
curr_Stock_Price:  88.59245582921486
curr_Factors:  [88.59245583 -0.77772629 -1.04998512]
mat_Sqrt:  [[14.24399327  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00733319 -0.00392174 -0.05363636]
Stock Position:  0.007333189413105444
Bond Position:  [-7.0312483]


portfolio before change:  [-6.38424746]
curr_Stock_Price:  88.4688554222872
curr_Factors:  [88.46885542 -0.64272032 -1.0030408 ]
mat_Sqrt:  [[17.06260893  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01115976 -0.18182967  0.49653555]
Stock Position:  -0.011159763813168671
Bond Position:  [-5.39695593]


portfolio before change:  [-6.39014322]
curr_Stock_Price:  88.87624368140406
curr_Factors:  [88.87624368 -0.94925605 -1.00245925]
mat_Sqrt:  [[12.62311408  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01125225 -0.15920745 -1.52374074]
Stock Position:  -0.01125225291163082
Bond Position:  [-5.39008525]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-6.40240098]
Stock Price:  89.84583357941838
PL:  [-6.40240098]
Settle:  Tensor("sub_82:0", shape=(), dtype=float64)
PL:  Tensor("sub_83:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  42
output_Z_Vals[:, i, :]:  [[ 1.19271183e+02 -4.92738716e+01 -4.92570741e+01]
 [ 2.41328356e-02  4.76650103e-02 -4.32474290e-02]
 [-2.23195541e+00 -3.00474575e+00 -8.56036153e-01]
 [-1.35224546e-02  1.90149930e-01  1.26912634e-02]
 [ 7.35602913e-01  5.30445588e-02 -5.07281221e-01]
 [-1.32446548e-02  2.68097604e-02  4.78096887e-04]
 [ 7.26670208e-05  2.65629101e-02  4.76443897e-02]
 [ 5.34763520e-02  9.24885686e-02  5.09836053e-03]
 [ 2.37341703e-02 -9.88208980e-02 -6.48576670e-03]
 [-1.11385852e+00 -4.26880344e-01 -4.13595126e-02]
 [ 3.92311743e-01  6.82299316e-02 -7.11003657e-03]
 [ 1.46539959e-02 -7.36323453e-02  3.68207362e-02]
 [-6.80714736e-01 -1.08272695e+00  2.39848984e-01]
 [ 8.02218796e-03  2.47666845e-02  6.19646936e-02]
 [ 1.10770457e-01  1.26102978e-01 -1.05670712e-01]
 [-5.24273199e-03  5.16443147e-02  9.66508124e-02]
 [ 1.14123723e-01  1.00596176e-01  8.37507388e-02]
 [-4.29602126e-03 -1.01060856e-01  1.87109239e-01]
 [ 4.86117665e-02 -5.38313348e-02  7.13436948e-02]
 [ 4.49593436e-02 -4.70476158e-01 -2.71531873e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.27118322 -49.27387164 -49.25707411]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [   7.3268874   -15.90307369 -140.51672192]
init_Out:  [2.48374395]
Stock Position:  7.326887399052493
Bond position:  [-730.20499595]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [1.87413913]
curr_Stock_Price:  99.94171730425427
curr_Factors:  [99.9417173  -0.83961074 -0.99867718]
mat_Sqrt:  [[15.89968464  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00157453  0.01538382 -0.12337288]
Stock Position:  0.0015745325247466739
Bond Position:  [1.71677765]


portfolio before change:  [1.87625318]
curr_Stock_Price:  101.01174563325704
curr_Factors:  [101.01174563  -0.93227769  -0.97340938]
mat_Sqrt:  [[15.02250992  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.20103393 -0.96977752 -2.44203287]
Stock Position:  -0.20103393091100044
Bond Position:  [22.18304147]


portfolio before change:  [1.81189556]
curr_Stock_Price:  101.35946837164775
curr_Factors:  [101.35946837  -1.01957897  -0.9816514 ]
mat_Sqrt:  [[13.70064512  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00203511 0.06137063 0.03620464]
Stock Position:  0.002035110783775965
Bond Position:  [1.60561781]


portfolio before change:  [1.81345514]
curr_Stock_Price:  101.92853843017491
curr_Factors:  [101.92853843  -1.09612586  -0.97536373]
mat_Sqrt:  [[12.84278762  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.05005784  0.01712006 -1.44713212]
Stock Position:  0.050057842765598735
Bond Position:  [-3.28886762]


portfolio before change:  [1.74661374]
curr_Stock_Price:  100.60968267616526
curr_Factors:  [100.60968268  -1.25566166  -0.95861077]
mat_Sqrt:  [[10.98989348  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00069833  0.00865281  0.00136388]
Stock Position:  -0.000698327447307196
Bond Position:  [1.81687224]


portfolio before change:  [1.74772251]
curr_Stock_Price:  99.67244537125835
curr_Factors:  [99.67244537 -0.99286624 -0.92153892]
mat_Sqrt:  [[14.69465916  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00103576 0.00857314 0.13591618]
Stock Position:  0.001035761938110977
Bond Position:  [1.64448559]


portfolio before change:  [1.74928106]
curr_Stock_Price:  100.78019872570951
curr_Factors:  [100.78019873  -1.29991405  -0.93642791]
mat_Sqrt:  [[10.76822786  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.006816   0.02985056 0.0145442 ]
Stock Position:  0.0068159962288051245
Bond Position:  [1.0623636]


portfolio before change:  [1.74726459]
curr_Stock_Price:  100.44538417047774
curr_Factors:  [100.44538417  -1.36320926  -0.9115665 ]
mat_Sqrt:  [[10.32779055  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00021675 -0.03189431 -0.01850209]
Stock Position:  0.0002167489120048293
Bond Position:  [1.72549316]


portfolio before change:  [1.74798427]
curr_Stock_Price:  101.77528604114968
curr_Factors:  [101.77528604  -1.75927006  -0.91548198]
mat_Sqrt:  [[ 7.01475135  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.17241346 -0.13777504 -0.11798718]
Stock Position:  -0.1724134636272672
Bond Position:  [19.29541385]


portfolio before change:  [1.90690833]
curr_Stock_Price:  100.8815066239468
curr_Factors:  [100.88150662  -1.32207137  -0.88681881]
mat_Sqrt:  [[11.07905565  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.03653631  0.02202112 -0.02028296]
Stock Position:  0.036536307982590624
Bond Position:  [-1.77892947]


portfolio before change:  [1.88071377]
curr_Stock_Price:  100.17673461559014
curr_Factors:  [100.17673462  -0.7104299   -0.84264781]
mat_Sqrt:  [[21.19697031  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00033683 -0.02376474  0.10503931]
Stock Position:  0.0003368338756986789
Bond Position:  [1.84697086]


portfolio before change:  [1.88163188]
curr_Stock_Price:  101.5314347454183
curr_Factors:  [101.53143475  -0.81886118  -0.83295343]
mat_Sqrt:  [[19.46375166  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.04381306 -0.34944862  0.68422239]
Stock Position:  -0.04381305795119285
Bond Position:  [6.33003452]


portfolio before change:  [1.94227548]
curr_Stock_Price:  100.18341449981372
curr_Factors:  [100.1834145   -1.10458474  -0.8130316 ]
mat_Sqrt:  [[14.72263803  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00174739 0.00799341 0.17676802]
Stock Position:  0.0017473876864519328
Bond Position:  [1.76721621]


portfolio before change:  [1.94387644]
curr_Stock_Price:  100.84675107699968
curr_Factors:  [100.84675108  -0.98522484  -0.87140201]
mat_Sqrt:  [[15.75212381  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00729687  0.04069956 -0.30144913]
Stock Position:  0.0072968684885773615
Bond Position:  [1.20801096]


portfolio before change:  [1.9399198]
curr_Stock_Price:  100.26311908727413
curr_Factors:  [100.26311909  -0.88765816  -0.83210355]
mat_Sqrt:  [[17.95800921  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00139369 0.01666813 0.27571787]
Stock Position:  0.001393689232043012
Bond Position:  [1.80018417]


portfolio before change:  [1.94189409]
curr_Stock_Price:  101.3567572003034
curr_Factors:  [101.3567572   -0.53544621  -0.87772604]
mat_Sqrt:  [[24.66719668  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00615203 0.03246728 0.23891755]
Stock Position:  0.006152031841196246
Bond Position:  [1.3183441]


portfolio before change:  [1.9580051]
curr_Stock_Price:  103.9219872254729
curr_Factors:  [103.92198723  -0.68350766  -0.92249526]
mat_Sqrt:  [[20.85591433  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0006362  -0.03261725  0.53377058]
Stock Position:  0.0006361999401522349
Bond Position:  [1.89188994]


portfolio before change:  [1.95969509]
curr_Stock_Price:  105.83483974976276
curr_Factors:  [105.83483975  -0.82969839  -0.94910924]
mat_Sqrt:  [[17.86908514  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00292049 -0.01737399  0.2035237 ]
Stock Position:  0.0029204887414303856
Bond Position:  [1.65060563]


portfolio before change:  [1.95873349]
curr_Stock_Price:  105.3642683863393
curr_Factors:  [105.36426839  -0.53378754  -0.95064413]
mat_Sqrt:  [[23.87882064  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00446012 -0.15184553 -0.77460485]
Stock Position:  -0.004460120252886021
Bond Position:  [2.4286708]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [1.95740041]
Stock Price:  105.7993063273454
PL:  [-3.84190592]
Settle:  Tensor("sub_84:0", shape=(), dtype=float64)
PL:  Tensor("sub_85:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  43
output_Z_Vals[:, i, :]:  [[ 1.19271183e+02 -4.92738716e+01 -4.92570741e+01]
 [-1.99472375e-03  1.52363307e-03 -5.89120615e-02]
 [-2.14053748e+00 -2.88283759e+00 -8.20770379e-01]
 [ 9.39686106e-02  2.95144700e-01 -5.03067805e-02]
 [ 6.08330661e-01  4.21414874e-02 -4.38021007e-01]
 [ 7.57175145e-02  1.17192732e-01 -6.73936232e-03]
 [ 4.86660511e-02 -2.66230925e-02  9.61421960e-02]
 [ 1.25209567e-01  3.57108068e-01  2.37879235e-01]
 [ 7.66143784e-02  3.73354436e-02 -5.23456530e-02]
 [-1.29962399e+00 -5.36523901e-01 -5.01071116e-02]
 [ 2.36243156e-01  2.82065628e-02 -8.58586826e-02]
 [-1.16727060e-04 -6.86837314e-02  3.48386003e-02]
 [-6.36686768e-01 -9.89294917e-01  2.23892413e-01]
 [ 7.85546506e-02  7.97641644e-02  3.99144933e-02]
 [-3.38150036e-03  3.67677498e-02 -5.82676171e-02]
 [-6.08745337e-02  6.66182936e-02  1.22990240e-01]
 [ 8.03985088e-02  1.08859799e-01  8.92618534e-02]
 [ 1.09212274e-01 -1.26312768e-02 -1.49842590e-02]
 [-4.42655897e-02 -7.54913027e-02 -6.82780304e-03]
 [ 3.66575121e-02 -2.73184036e-01 -3.11784589e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.27118322 -49.27387164 -49.25707411]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [   7.3268874   -15.90307369 -140.51672192]
init_Out:  [2.48374395]
Stock Position:  7.326887399052493
Bond position:  [-730.20499595]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [8.80925691]
curr_Stock_Price:  100.88824717491511
curr_Factors:  [100.88824717  -0.95750033  -1.03058914]
mat_Sqrt:  [[13.8173351   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00099217  0.00049175 -0.16805971]
Stock Position:  -0.0009921658227390587
Bond Position:  [8.90935479]


portfolio before change:  [8.81206185]
curr_Stock_Price:  100.30636635422573
curr_Factors:  [100.30636635  -1.05586216  -1.05618399]
mat_Sqrt:  [[12.13608224  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.2386712  -0.93043183 -2.34142943]
Stock Position:  -0.2386711986302079
Bond Position:  [32.75230254]


portfolio before change:  [8.71916019]
curr_Stock_Price:  100.72992297703819
curr_Factors:  [100.72992298  -1.02863613  -1.02611256]
mat_Sqrt:  [[12.90602445  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01115339  0.09525754 -0.14351124]
Stock Position:  0.011153391364978034
Bond Position:  [7.59567993]


portfolio before change:  [8.7263103]
curr_Stock_Price:  101.20071747505159
curr_Factors:  [101.20071748  -0.92351366  -1.04808444]
mat_Sqrt:  [[14.09059765  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.03743788  0.01360111 -1.24955201]
Stock Position:  0.03743787917025799
Bond Position:  [4.93757007]


portfolio before change:  [8.75507654]
curr_Stock_Price:  101.93611414724647
curr_Factors:  [101.93611415  -0.92905727  -1.0717928 ]
mat_Sqrt:  [[13.78383069  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00712891  0.03782379 -0.01922552]
Stock Position:  0.007128911866597912
Bond Position:  [8.02838296]


portfolio before change:  [8.76579006]
curr_Stock_Price:  103.15736333333017
curr_Factors:  [103.15736333  -0.78532163  -1.10226304]
mat_Sqrt:  [[15.62185595  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00402363 -0.00859257  0.27426692]
Stock Position:  0.004023630665633053
Bond Position:  [8.35072293]


portfolio before change:  [8.76063171]
curr_Stock_Price:  101.35642912929931
curr_Factors:  [101.35642913  -0.56648052  -1.08578093]
mat_Sqrt:  [[19.42152245  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01270039 0.11525613 0.67860324]
Stock Position:  0.012700386489192752
Bond Position:  [7.47336589]


portfolio before change:  [8.77013142]
curr_Stock_Price:  101.95728792794645
curr_Factors:  [101.95728793  -0.26839476  -1.0674496 ]
mat_Sqrt:  [[26.80824846  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00274357  0.01204996 -0.14932758]
Stock Position:  0.002743574699205429
Bond Position:  [8.49040399]


portfolio before change:  [8.77214282]
curr_Stock_Price:  101.91665918770688
curr_Factors:  [ 1.01916659e+02 -4.77307338e-02 -1.06447485e+00]
mat_Sqrt:  [[33.51354994  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.04235211 -0.17316234 -0.14294164]
Stock Position:  -0.04235210975283349
Bond Position:  [13.08852836]


portfolio before change:  [8.87025977]
curr_Stock_Price:  99.67723351208315
curr_Factors:  [99.67723351 -0.17536163 -1.09089654]
mat_Sqrt:  [[28.09745863  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00798916  0.00910363 -0.24493092]
Stock Position:  0.007989155499319082
Bond Position:  [8.07392285]


portfolio before change:  [8.87061038]
curr_Stock_Price:  99.46843544597347
curr_Factors:  [ 9.94684354e+01 -2.40210006e-02 -1.13003586e+00]
mat_Sqrt:  [[31.36785073  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00022397 -0.02216758  0.09938483]
Stock Position:  -0.0002239661101818173
Bond Position:  [8.89288794]


portfolio before change:  [8.8724755]
curr_Stock_Price:  101.06859453098868
curr_Factors:  [101.06859453  -0.11890225  -1.13896201]
mat_Sqrt:  [[28.72980756  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02759935 -0.31929356  0.63870273]
Stock Position:  -0.027599346014440595
Bond Position:  [11.66190261]


portfolio before change:  [8.9124007]
curr_Stock_Price:  99.72764376176801
curr_Factors:  [ 9.97276438e+01  3.75519459e-02 -1.09819771e+00]
mat_Sqrt:  [[34.52891682  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00298254 0.02574377 0.11386494]
Stock Position:  0.002982542279686914
Bond Position:  [8.61495879]


portfolio before change:  [8.91214055]
curr_Stock_Price:  98.9182146912155
curr_Factors:  [ 9.89182147e+01  3.32096111e-02 -1.08235941e+00]
mat_Sqrt:  [[34.64465988  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00022428  0.01186674 -0.16622129]
Stock Position:  -0.00022428109924521142
Bond Position:  [8.93432604]


portfolio before change:  [8.91451188]
curr_Stock_Price:  98.30530769270479
curr_Factors:  [98.30530769 -0.18215467 -1.08663176]
mat_Sqrt:  [[27.64076259  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00080211  0.02150096  0.35085692]
Stock Position:  -0.0008021071715991785
Bond Position:  [8.99336327]


portfolio before change:  [8.91689292]
curr_Stock_Price:  98.1402142159098
curr_Factors:  [98.14021422 -0.19878265 -1.07160194]
mat_Sqrt:  [[27.55027793  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00438616 0.03513435 0.25463922]
Stock Position:  0.0043861598040563915
Bond Position:  [8.48643426]


portfolio before change:  [8.9233042]
curr_Stock_Price:  99.11815403882575
curr_Factors:  [99.11815404 -0.31979088 -1.06030291]
mat_Sqrt:  [[24.93366331  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00415403 -0.00407673 -0.04274592]
Stock Position:  0.004154033663420104
Bond Position:  [8.51156405]


portfolio before change:  [8.9296459]
curr_Stock_Price:  100.13247975681524
curr_Factors:  [100.13247976  -0.21198769  -1.05724652]
mat_Sqrt:  [[28.14190934  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00217003 -0.02436471 -0.01947782]
Stock Position:  -0.0021700342364627248
Bond Position:  [9.14693681]


portfolio before change:  [8.93060971]
curr_Stock_Price:  100.74224142991667
curr_Factors:  [ 1.00742241e+02  1.38276123e-02 -1.06542659e+00]
mat_Sqrt:  [[35.19718882  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.002351   -0.08816977 -0.88943465]
Stock Position:  -0.0023510033394069756
Bond Position:  [9.16745506]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [8.92820258]
Stock Price:  102.74108349392634
PL:  [6.18711909]
Settle:  Tensor("sub_86:0", shape=(), dtype=float64)
PL:  Tensor("sub_87:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  44
output_Z_Vals[:, i, :]:  [[ 1.19271183e+02 -4.92738716e+01 -4.92570741e+01]
 [ 3.62447668e-02  6.71241905e-02 -3.76267135e-02]
 [-2.46250094e+00 -2.88613903e+00 -8.68601252e-01]
 [-3.76315360e-02 -1.16929290e-02 -1.32864490e-01]
 [ 3.41898783e-01 -1.15199102e-01 -1.49247092e-01]
 [-1.41362579e-01 -2.33622115e-01 -1.48228607e-02]
 [-1.11054753e-02  2.97834000e-02  7.51083902e-03]
 [ 9.98213783e-02  2.47627951e-01  1.15091851e-01]
 [ 3.29906936e-02  1.84749820e-01 -8.38720400e-02]
 [-7.81367265e-01 -3.17312419e-01 -2.38601730e-02]
 [ 3.81016450e-02 -3.13572389e-02 -2.82653969e-01]
 [ 3.52031406e-01  1.63508771e-01  4.94108983e-03]
 [-7.04237108e-01 -9.33819499e-01  2.26223130e-01]
 [ 3.02108697e-01  4.45464930e-02  2.05878792e-01]
 [ 1.22486248e-01  1.40759285e-01 -1.04931576e-01]
 [-2.82331335e-01  1.52730325e-01  1.05030473e-01]
 [-3.70821821e-02  1.12543761e-01  1.57428909e-01]
 [ 1.11264214e-01 -1.20051706e-02 -2.02426147e-02]
 [-9.69546875e-02 -4.97851783e-01  1.53030323e-01]
 [ 2.61540090e-02 -2.62252391e-01 -2.40311753e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.27118322 -49.27387164 -49.25707411]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [   7.3268874   -15.90307369 -140.51672192]
init_Out:  [2.48374395]
Stock Position:  7.326887399052493
Bond position:  [-730.20499595]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [0.85149939]
curr_Stock_Price:  99.80214374688072
curr_Factors:  [99.80214375 -1.06484023 -1.04644339]
mat_Sqrt:  [[12.08428735  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00349759  0.02166424 -0.10733854]
Stock Position:  0.003497592604644885
Bond Position:  [0.50243215]


portfolio before change:  [0.84648626]
curr_Stock_Price:  98.33291589715067
curr_Factors:  [98.3329159  -0.93349808 -1.03048061]
mat_Sqrt:  [[13.79601978  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.23404824 -0.93149737 -2.4778776 ]
Stock Position:  -0.23404823606962977
Bond Position:  [23.86113177]


portfolio before change:  [0.99315406]
curr_Stock_Price:  97.73175017750262
curr_Factors:  [97.73175018 -1.17566796 -0.96950725]
mat_Sqrt:  [[11.43925969  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00586919 -0.00377388 -0.37902541]
Stock Position:  -0.005869190607587169
Bond Position:  [1.56676033]


portfolio before change:  [0.98994582]
curr_Stock_Price:  98.34512022585686
curr_Factors:  [98.34512023 -1.36215727 -0.93273661]
mat_Sqrt:  [[ 9.91044296  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.02905207 -0.03718035 -0.42576041]
Stock Position:  0.029052074765538366
Bond Position:  [-1.86718397]


portfolio before change:  [0.99578965]
curr_Stock_Price:  98.56234018256423
curr_Factors:  [98.56234018 -1.36056684 -0.94152859]
mat_Sqrt:  [[ 9.86106145  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01947825 -0.07540121 -0.0422855 ]
Stock Position:  -0.01947824761954322
Bond Position:  [2.91561132]


portfolio before change:  [0.98983495]
curr_Stock_Price:  98.90547673464599
curr_Factors:  [98.90547673 -0.91118654 -0.96318358]
mat_Sqrt:  [[15.17720288  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00023014  0.00961255  0.02142633]
Stock Position:  -0.00023013599320618002
Bond Position:  [1.01259666]


portfolio before change:  [0.99020034]
curr_Stock_Price:  98.4178786141103
curr_Factors:  [98.41787861 -0.70972911 -0.97364365]
mat_Sqrt:  [[18.28077068  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00951061 0.07992158 0.32832501]
Stock Position:  0.009510608206331825
Bond Position:  [0.05418646]


portfolio before change:  [0.98371148]
curr_Stock_Price:  97.73417788123754
curr_Factors:  [97.73417788 -0.7173034  -0.91788537]
mat_Sqrt:  [[19.04991333  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00281273  0.05962775 -0.23926358]
Stock Position:  0.0028127311243400063
Bond Position:  [0.70881152]


portfolio before change:  [0.98119423]
curr_Stock_Price:  96.77622053528663
curr_Factors:  [96.77622054 -0.58880877 -0.9264476 ]
mat_Sqrt:  [[21.26675252  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.04001593 -0.10241214 -0.06806643]
Stock Position:  -0.04001592756053402
Bond Position:  [4.85378446]


portfolio before change:  [1.01351527]
curr_Stock_Price:  95.99884387030828
curr_Factors:  [95.99884387 -0.20637893 -0.88831248]
mat_Sqrt:  [[32.12532754  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00080919 -0.01012051 -0.8063331 ]
Stock Position:  -0.0008091940629313074
Bond Position:  [1.09119697]


portfolio before change:  [1.01639036]
curr_Stock_Price:  92.78298380119841
curr_Factors:  [92.7829838  -0.34866706 -0.94690371]
mat_Sqrt:  [[25.39856022  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01521409 0.05277223 0.01409555]
Stock Position:  0.015214094299131975
Bond Position:  [-0.3952187]


portfolio before change:  [0.99839013]
curr_Stock_Price:  91.60634987328078
curr_Factors:  [91.60634987 -0.33758309 -0.97308676]
mat_Sqrt:  [[24.70067938  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.03435835 -0.30138895  0.64535162]
Stock Position:  -0.03435835100747618
Bond Position:  [4.14583325]


portfolio before change:  [1.04922311]
curr_Stock_Price:  90.15702549077768
curr_Factors:  [90.15702549 -0.54274683 -0.96740923]
mat_Sqrt:  [[19.91347869  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01773806 0.01437732 0.58731489]
Stock Position:  0.017738063221485977
Bond Position:  [-0.54998791]


portfolio before change:  [1.11429917]
curr_Stock_Price:  93.83350195296026
curr_Factors:  [93.83350195 -0.53655639 -0.96558502]
mat_Sqrt:  [[20.89229738  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00621279  0.04542986 -0.29934058]
Stock Position:  0.006212794442055582
Bond Position:  [0.53133091]


portfolio before change:  [1.11545319]
curr_Stock_Price:  93.99786729628646
curr_Factors:  [93.9978673  -0.32194681 -0.9590258 ]
mat_Sqrt:  [[26.10950644  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00879818  0.0492935   0.2996227 ]
Stock Position:  -0.008798179825882949
Bond Position:  [1.94246332]


portfolio before change:  [1.11898901]
curr_Stock_Price:  93.65118805368654
curr_Factors:  [93.65118805 -0.2215317  -0.95950635]
mat_Sqrt:  [[28.74716221  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00062704 0.03632334 0.44910086]
Stock Position:  0.0006270447978085214
Bond Position:  [1.06026552]


portfolio before change:  [1.11820973]
curr_Stock_Price:  91.98563586719513
curr_Factors:  [91.98563587 -0.36013833 -0.96731243]
mat_Sqrt:  [[24.39020632  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00429195 -0.00387465 -0.05774655]
Stock Position:  0.004291954751583495
Bond Position:  [0.72341154]


portfolio before change:  [1.11058537]
curr_Stock_Price:  90.16706152565158
curr_Factors:  [ 9.01670615e+01  6.84939283e-02 -9.85500528e-01]
mat_Sqrt:  [[36.04101477  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00464307 -0.16068097  0.43655292]
Stock Position:  -0.0046430732952862045
Bond Position:  [1.52923764]


portfolio before change:  [1.08676857]
curr_Stock_Price:  95.3789455506946
curr_Factors:  [ 9.53789456e+01 -3.94013208e-03 -1.02508440e+00]
mat_Sqrt:  [[34.08417917  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00224243 -0.0846416  -0.68554254]
Stock Position:  -0.0022424323885364148
Bond Position:  [1.3006494]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [1.08930334]
Stock Price:  94.39360003397053
PL:  [1.08930334]
Settle:  Tensor("sub_88:0", shape=(), dtype=float64)
PL:  Tensor("sub_89:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  45
output_Z_Vals[:, i, :]:  [[ 1.19271183e+02 -4.92738716e+01 -4.92570741e+01]
 [ 6.35610425e-02  1.11010861e-01 -2.49502035e-02]
 [-2.44212969e+00 -3.10202888e+00 -9.07055819e-01]
 [-5.51475835e-02  5.89483269e-04 -1.32167029e-01]
 [ 5.83434134e-01 -1.27611533e-02 -3.89249719e-01]
 [-8.11167078e-02 -1.01666775e-01  2.25741224e-02]
 [ 1.17067811e-02  2.46511110e-02  8.04764400e-02]
 [ 6.85284304e-02  1.48809788e-01  4.32355127e-02]
 [ 7.08935409e-02  2.26053900e-02 -4.73843081e-02]
 [-9.94918221e-01 -4.05584040e-01 -3.47190913e-02]
 [ 3.76162299e-01  4.83246589e-02 -2.94985295e-02]
 [-2.20528735e-02 -6.00731510e-02  3.52515121e-02]
 [-6.33156327e-01 -1.11357365e+00  2.24470263e-01]
 [ 2.65034570e-02  4.11580235e-02  9.78311279e-02]
 [ 9.26064897e-02  1.24047121e-01 -1.03729437e-01]
 [-1.57356485e-02  5.44686113e-02  1.01618788e-01]
 [ 9.33087600e-02  1.11265983e-01  1.09042780e-01]
 [ 1.15216134e-01 -1.08333916e-02 -3.18137274e-02]
 [-5.26055074e-02 -1.31460882e-01  6.20360966e-03]
 [ 8.22652404e-02 -6.46664950e-01 -6.09532513e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.27118322 -49.27387164 -49.25707411]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [   7.3268874   -15.90307369 -140.51672192]
init_Out:  [2.48374395]
Stock Position:  7.326887399052493
Bond position:  [-730.20499595]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-4.96030769]
curr_Stock_Price:  99.00892736875703
curr_Factors:  [99.00892737 -1.04011997 -0.97950116]
mat_Sqrt:  [[13.13905227  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00617458  0.0358286  -0.07117599]
Stock Position:  0.006174577815883622
Bond Position:  [-5.57164602]


portfolio before change:  [-4.96258438]
curr_Stock_Price:  98.865823850697
curr_Factors:  [98.86582385 -0.80137766 -0.98747492]
mat_Sqrt:  [[16.5256057   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.19729871 -1.00117551 -2.58757777]
Stock Position:  -0.19729870968520372
Bond Position:  [14.5435151]


portfolio before change:  [-4.79999777]
curr_Stock_Price:  98.06019124550802
curr_Factors:  [98.06019125 -0.74181851 -0.95710114]
mat_Sqrt:  [[17.9333451   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-4.57280764e-03  1.90254907e-04 -3.77035745e-01]
Stock Position:  -0.004572807642386672
Bond Position:  [-4.35158738]


portfolio before change:  [-4.81111829]
curr_Stock_Price:  100.25413409510034
curr_Factors:  [100.2541341   -1.06665124  -0.98622053]
mat_Sqrt:  [[12.86919585  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.03895923 -0.00411864 -1.1104211 ]
Stock Position:  0.03895923367811393
Bond Position:  [-8.71694252]


portfolio before change:  [-4.82791949]
curr_Stock_Price:  99.87882644058374
curr_Factors:  [99.87882644 -1.23011633 -1.01643177]
mat_Sqrt:  [[10.5635524   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00920727 -0.03281281  0.06439769]
Stock Position:  -0.009207265157756645
Bond Position:  [-3.90830865]


portfolio before change:  [-4.83828746]
curr_Stock_Price:  100.89875676573044
curr_Factors:  [100.89875677  -1.2615591   -1.00426429]
mat_Sqrt:  [[10.46769885  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.0031684  0.00795611 0.22957688]
Stock Position:  0.0031683995795989133
Bond Position:  [-5.15797504]


portfolio before change:  [-4.83994013]
curr_Stock_Price:  100.78418214410789
curr_Factors:  [100.78418214  -1.12888833  -0.9615542 ]
mat_Sqrt:  [[12.46019165  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.0086459  0.04802815 0.12333888]
Stock Position:  0.00864589536302864
Bond Position:  [-5.71130963]


portfolio before change:  [-4.84183746]
curr_Stock_Price:  100.72989949306911
curr_Factors:  [100.72989949  -0.90104846  -0.95223737]
mat_Sqrt:  [[15.78652677  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00417036  0.00729586 -0.13517424]
Stock Position:  0.004170364161129651
Bond Position:  [-5.26191782]


portfolio before change:  [-4.84585557]
curr_Stock_Price:  100.081884208331
curr_Factors:  [100.08188421  -1.24104241  -0.96160836]
mat_Sqrt:  [[11.0600324   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.09808242 -0.13090169 -0.0990439 ]
Stock Position:  -0.09808241803874278
Bond Position:  [4.97041764]


portfolio before change:  [-4.90744355]
curr_Stock_Price:  100.72247556039368
curr_Factors:  [100.72247556  -0.86797409  -0.95504152]
mat_Sqrt:  [[16.27049513  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.02335548  0.01559672 -0.08415109]
Stock Position:  0.02335547647011236
Bond Position:  [-7.25986496]


portfolio before change:  [-4.90428701]
curr_Stock_Price:  100.93534810137514
curr_Factors:  [100.9353481   -0.6648527   -0.95436782]
mat_Sqrt:  [[19.99055028  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00135662 -0.01938853  0.10056275]
Stock Position:  -0.0013566194521517773
Bond Position:  [-4.76735615]


portfolio before change:  [-4.90533444]
curr_Stock_Price:  100.82878909218365
curr_Factors:  [100.82878909  -0.57020536  -0.96068685]
mat_Sqrt:  [[21.81355806  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.03734576 -0.35940435  0.64035118]
Stock Position:  -0.03734575506053275
Bond Position:  [-1.13980718]


portfolio before change:  [-4.85298656]
curr_Stock_Price:  99.41944919911258
curr_Factors:  [99.4194492  -0.70706192 -0.98727385]
mat_Sqrt:  [[18.26546273  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00300428 0.01328369 0.27908498]
Stock Position:  0.0030042764058060356
Bond Position:  [-5.15167007]


portfolio before change:  [-4.85648853]
curr_Stock_Price:  98.68253772351785
curr_Factors:  [98.68253772 -0.73078048 -0.98925715]
mat_Sqrt:  [[17.67003688  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00547559  0.04003604 -0.29591121]
Stock Position:  0.005475586733812939
Bond Position:  [-5.39683332]


portfolio before change:  [-4.85368744]
curr_Stock_Price:  99.44053133068408
curr_Factors:  [99.44053133 -0.8773521  -1.02186312]
mat_Sqrt:  [[14.88485975  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00108335 0.01757967 0.28989012]
Stock Position:  0.001083353059470874
Bond Position:  [-4.96141665]


portfolio before change:  [-4.856416]
curr_Stock_Price:  98.0669778977016
curr_Factors:  [98.0669779  -1.01822735 -1.01993525]
mat_Sqrt:  [[12.7749739   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01082422 0.03591094 0.3110687 ]
Stock Position:  0.01082421763150096
Bond Position:  [-5.91791431]


portfolio before change:  [-4.86808683]
curr_Stock_Price:  97.12546175398542
curr_Factors:  [97.12546175 -0.9489115  -1.00439813]
mat_Sqrt:  [[13.77277658  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00773343 -0.00349646 -0.09075571]
Stock Position:  0.0077334317452590106
Bond Position:  [-5.61919996]


portfolio before change:  [-4.86062943]
curr_Stock_Price:  98.27144460112206
curr_Factors:  [98.2714446  -1.13127108 -1.00091392]
mat_Sqrt:  [[11.65282325  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00670855 -0.04242882  0.01769717]
Stock Position:  -0.006708549449441203
Bond Position:  [-4.20137058]


portfolio before change:  [-4.8657255]
curr_Stock_Price:  98.87449496464842
curr_Factors:  [98.87449496 -1.11777907 -0.98681405]
mat_Sqrt:  [[12.05233236  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0144499  -0.20871022 -1.7388266 ]
Stock Position:  -0.014449899625785348
Bond Position:  [-3.43699897]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-4.86883275]
Stock Price:  99.03005961789374
PL:  [-4.86883275]
Settle:  Tensor("sub_90:0", shape=(), dtype=float64)
PL:  Tensor("sub_91:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  46
output_Z_Vals[:, i, :]:  [[ 1.19271183e+02 -4.92738716e+01 -4.92570741e+01]
 [ 8.42439743e-02  1.34586174e-01 -3.84740891e-02]
 [-2.47734088e+00 -2.90504138e+00 -8.75594124e-01]
 [-2.67333391e-02  4.39776261e-02 -1.20334161e-01]
 [ 4.17565220e-01  1.73345443e-02 -3.33161351e-01]
 [ 7.57175145e-02  1.17192732e-01 -6.73936232e-03]
 [-5.38024622e-02  8.69897738e-02 -1.08013069e-01]
 [ 1.41912968e-01  3.71547658e-01  2.30759630e-01]
 [-2.57656173e-01  4.80819823e-01 -1.04327175e-01]
 [-1.00132666e+00 -4.10956299e-01 -3.49870663e-02]
 [ 1.36198579e-01  1.23171553e-02 -1.50912653e-01]
 [ 1.03546370e-01  2.50417829e-02  2.07402731e-02]
 [-5.63653501e-01 -1.07658012e+00  2.00838468e-01]
 [ 2.04217216e-01  1.90689175e-01 -6.45331055e-03]
 [ 2.03835993e-02  6.70052412e-02 -7.34600375e-02]
 [ 4.22732193e-02  3.88548160e-02  7.41539150e-02]
 [ 1.08624679e-01  1.12965305e-01  9.49753836e-02]
 [ 1.01268074e-01 -1.51545056e-02  1.16853110e-03]
 [ 8.61921858e-02  1.30749047e-01  4.11666693e-02]
 [ 4.02444555e-02 -3.07252870e-01 -3.41488131e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.27118322 -49.27387164 -49.25707411]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [   7.3268874   -15.90307369 -140.51672192]
init_Out:  [2.48374395]
Stock Position:  7.326887399052493
Bond position:  [-730.20499595]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-6.9293666]
curr_Stock_Price:  98.74018311269819
curr_Factors:  [98.74018311 -0.98057178 -1.01936717]
mat_Sqrt:  [[13.36384649  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00777192  0.0434375  -0.10975587]
Stock Position:  0.007771921923172647
Bond Position:  [-7.69676759]


portfolio before change:  [-6.93518627]
curr_Stock_Price:  98.23898857673012
curr_Factors:  [98.23898858 -0.89186976 -1.04356238]
mat_Sqrt:  [[14.18196422  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.22909802 -0.93759807 -2.49782632]
Stock Position:  -0.2290980164595798
Bond Position:  [15.57117115]


portfolio before change:  [-7.12687056]
curr_Stock_Price:  99.09267368276339
curr_Factors:  [99.09267368 -0.73367541 -1.0569747 ]
mat_Sqrt:  [[16.53377744  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00255958  0.01419372 -0.34327987]
Stock Position:  -0.002559581543905971
Bond Position:  [-6.87323478]


portfolio before change:  [-7.1312582]
curr_Stock_Price:  100.13547023710517
curr_Factors:  [100.13547024  -0.96771192  -1.08145127]
mat_Sqrt:  [[12.90172182  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.02736823  0.0055947  -0.9504166 ]
Stock Position:  0.027368234142517107
Bond Position:  [-9.8717892]


portfolio before change:  [-7.15131939]
curr_Stock_Price:  99.49264728404317
curr_Factors:  [99.49264728 -0.47751632 -1.11192805]
mat_Sqrt:  [[20.30037521  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00484049  0.03782379 -0.01922552]
Stock Position:  0.004840487584848578
Bond Position:  [-7.63291231]


portfolio before change:  [-7.16519668]
curr_Stock_Price:  97.01999782612197
curr_Factors:  [97.01999783 -0.81473484 -1.14459137]
mat_Sqrt:  [[13.6752949   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00424809  0.02807583 -0.30813122]
Stock Position:  -0.004248085672531116
Bond Position:  [-6.75304742]


portfolio before change:  [-7.17017227]
curr_Stock_Price:  97.79378365302851
curr_Factors:  [97.79378365 -0.41767028 -1.2062376 ]
mat_Sqrt:  [[19.27777992  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01373905 0.11991649 0.65829299]
Stock Position:  0.013739052372372312
Bond Position:  [-8.51376618]


portfolio before change:  [-7.19767196]
curr_Stock_Price:  95.94715072567223
curr_Factors:  [ 9.59471507e+01 -8.85550685e-02 -1.21467826e+00]
mat_Sqrt:  [[26.06423843  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0069369   0.15518393 -0.29761639]
Stock Position:  -0.006936896838512141
Bond Position:  [-6.53209647]


portfolio before change:  [-7.21269697]
curr_Stock_Price:  97.87766619366519
curr_Factors:  [97.87766619 -0.16163762 -1.22774458]
mat_Sqrt:  [[24.39397544  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.04477968 -0.13263558 -0.09980836]
Stock Position:  -0.04477968238391181
Bond Position:  [-2.82976617]


portfolio before change:  [-7.24775718]
curr_Stock_Price:  98.64481485283541
curr_Factors:  [ 9.86448149e+01 -1.21187001e-02 -1.25333476e+00]
mat_Sqrt:  [[27.82882098  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00387756  0.00397534 -0.43051179]
Stock Position:  0.003877558879990423
Bond Position:  [-7.63025826]


portfolio before change:  [-7.25887486]
curr_Stock_Price:  96.26963968607711
curr_Factors:  [96.26963969  0.23143728 -1.25694885]
mat_Sqrt:  [[34.52354075  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00326999 0.0080822  0.05916623]
Stock Position:  0.0032699888420767483
Bond Position:  [-7.57367551]


portfolio before change:  [-7.24879005]
curr_Stock_Price:  99.93279259774894
curr_Factors:  [99.9327926   0.11430263 -1.26614992]
mat_Sqrt:  [[31.58399791  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.023506   -0.34746474  0.57293625]
Stock Position:  -0.023506001968976634
Bond Position:  [-4.89976963]


portfolio before change:  [-7.20741803]
curr_Stock_Price:  98.12061226886689
curr_Factors:  [98.12061227  0.31916626 -1.21884599]
mat_Sqrt:  [[39.90564219  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0060599   0.06154467 -0.0184095 ]
Stock Position:  0.006059900073638116
Bond Position:  [-7.80201914]


portfolio before change:  [-7.20708627]
curr_Stock_Price:  98.49726955496156
curr_Factors:  [ 9.84972696e+01  7.14796683e-02 -1.20845151e+00]
mat_Sqrt:  [[31.59683576  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00060342  0.02162585 -0.20956104]
Stock Position:  0.0006034154707357353
Bond Position:  [-7.26652105]


portfolio before change:  [-7.20725393]
curr_Stock_Price:  101.23037626762401
curr_Factors:  [101.23037627   0.21512076  -1.17776683]
mat_Sqrt:  [[38.65796368  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00169023 0.01254034 0.21154048]
Stock Position:  0.0016902346544544076
Bond Position:  [-7.37835702]


portfolio before change:  [-7.2119352]
curr_Stock_Price:  99.5522392852511
curr_Factors:  [99.55223929  0.1920455  -1.1977961 ]
mat_Sqrt:  [[36.41322085  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00414878 0.0364594  0.27093833]
Stock Position:  0.00414877868790447
Bond Position:  [-7.62495541]


portfolio before change:  [-7.21311909]
curr_Stock_Price:  99.72640756625457
curr_Factors:  [99.72640757  0.25821096 -1.15098557]
mat_Sqrt:  [[40.83975093  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00240974 -0.0048911   0.00333349]
Stock Position:  0.0024097404408384183
Bond Position:  [-7.45343385]


portfolio before change:  [-7.20713978]
curr_Stock_Price:  102.98107486449443
curr_Factors:  [102.98107486   0.30865678  -1.14667203]
mat_Sqrt:  [[44.54633966  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00272266 0.04219907 0.11743705]
Stock Position:  0.002722655450668274
Bond Position:  [-7.48752176]


portfolio before change:  [-7.21554069]
curr_Stock_Price:  100.58312191003628
curr_Factors:  [ 1.00583122e+02 -5.77773232e-02 -1.14251953e+00]
mat_Sqrt:  [[30.28606225  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00304362 -0.09916544 -0.97417059]
Stock Position:  -0.003043619405347238
Bond Position:  [-6.90940395]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-7.20964883]
Stock Price:  98.07971095097714
PL:  [-7.20964883]
Settle:  Tensor("sub_92:0", shape=(), dtype=float64)
PL:  Tensor("sub_93:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  47
output_Z_Vals[:, i, :]:  [[ 1.19271183e+02 -4.92738716e+01 -4.92570741e+01]
 [ 5.98767022e-02  1.05091554e-01 -2.66599745e-02]
 [-2.25570502e+00 -3.03641646e+00 -8.65197904e-01]
 [ 9.43747722e-02  2.14899885e-01 -5.03447102e-02]
 [ 7.35039244e-01  1.49580923e-02 -4.78404031e-01]
 [ 7.57175145e-02  1.17192732e-01 -6.73936232e-03]
 [ 6.10018821e-04  2.61367859e-02  5.12577259e-02]
 [ 1.01801663e-01  2.55590248e-01  1.22530704e-01]
 [ 8.58781957e-02  6.11879872e-02 -6.03796155e-02]
 [-1.08655365e+00 -4.35334688e-01 -3.95514461e-02]
 [ 3.77352379e-01  7.28045113e-02 -1.22512437e-02]
 [ 3.43384929e-02 -6.78152700e-02  3.72036194e-02]
 [-6.06572022e-01 -1.24022299e+00  2.15952931e-01]
 [ 4.87554033e-02  6.05318631e-02  1.40476947e-01]
 [ 3.92633271e-02  9.53801841e-02 -8.92095954e-02]
 [ 5.83125753e-02  3.45376274e-02  6.65599231e-02]
 [ 7.81154337e-02  1.08615455e-01  9.16581104e-02]
 [ 9.99556653e-02 -1.54853381e-02  7.48243689e-03]
 [-5.10969283e-02 -1.11932106e-01 -2.40278540e-03]
 [ 5.25058189e-02 -3.91256008e-01 -4.27252990e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.27118322 -49.27387164 -49.25707411]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [   7.3268874   -15.90307369 -140.51672192]
init_Out:  [2.48374395]
Stock Position:  7.326887399052493
Bond position:  [-730.20499595]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-4.96849871]
curr_Stock_Price:  99.00780942871585
curr_Factors:  [99.00780943 -0.94110279 -0.97487399]
mat_Sqrt:  [[14.57374975  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00520707  0.03391815 -0.07605349]
Stock Position:  0.005207066308950636
Bond Position:  [-5.48403894]


portfolio before change:  [-4.95943971]
curr_Stock_Price:  101.01089155417642
curr_Factors:  [101.01089155  -0.86807758  -1.00072412]
mat_Sqrt:  [[15.58683511  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.19581388 -0.9799992  -2.46816879]
Stock Position:  -0.19581388373970665
Bond Position:  [14.81989526]


portfolio before change:  [-4.77210713]
curr_Stock_Price:  100.07312790417305
curr_Factors:  [100.0731279   -0.98821031  -0.97356786]
mat_Sqrt:  [[14.07109975  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00909413  0.06935864 -0.14361945]
Stock Position:  0.009094133289024876
Bond Position:  [-5.6821855]


portfolio before change:  [-4.76255253]
curr_Stock_Price:  101.2799860015434
curr_Factors:  [101.279986    -1.01940553  -0.96885295]
mat_Sqrt:  [[13.86864215  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.04617891  0.0048277  -1.36475354]
Stock Position:  0.046178907106114504
Bond Position:  [-9.43955159]


portfolio before change:  [-4.76578618]
curr_Stock_Price:  101.2610710628488
curr_Factors:  [101.26107106  -0.74340113  -0.923896  ]
mat_Sqrt:  [[19.11369163  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00514101  0.03782379 -0.01922552]
Stock Position:  0.005141011799237179
Bond Position:  [-5.28637054]


portfolio before change:  [-4.77537965]
curr_Stock_Price:  99.65210644665787
curr_Factors:  [99.65210645 -0.92284737 -0.95012835]
mat_Sqrt:  [[15.31311216  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00107151 0.00843561 0.14622402]
Stock Position:  0.0010715070332907427
Bond Position:  [-4.88215758]


portfolio before change:  [-4.77661172]
curr_Stock_Price:  99.6414854645788
curr_Factors:  [99.64148546 -0.79004163 -0.97053993]
mat_Sqrt:  [[17.13283912  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01044691 0.0824914  0.34954599]
Stock Position:  0.010446912992112901
Bond Position:  [-5.81755765]


portfolio before change:  [-4.76866028]
curr_Stock_Price:  100.5418481427031
curr_Factors:  [100.54184814  -0.90221851  -0.97471127]
mat_Sqrt:  [[15.38886601  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00559126  0.01974834 -0.17224624]
Stock Position:  0.005591263434159814
Bond Position:  [-5.33081624]


portfolio before change:  [-4.76818441]
curr_Stock_Price:  100.86534169240129
curr_Factors:  [100.86534169  -1.29752823  -1.02437743]
mat_Sqrt:  [[ 9.8935271   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.11962259 -0.14050367 -0.11282927]
Stock Position:  -0.11962259446773994
Bond Position:  [7.29758945]


portfolio before change:  [-4.78457499]
curr_Stock_Price:  101.01761395481098
curr_Factors:  [101.01761395  -1.54608209  -1.03772416]
mat_Sqrt:  [[ 7.62542948  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.05110699  0.02349755 -0.03494939]
Stock Position:  0.05110699197609238
Bond Position:  [-9.94728138]


portfolio before change:  [-4.80321945]
curr_Stock_Price:  100.70146681595946
curr_Factors:  [100.70146682  -1.03809824  -1.06432457]
mat_Sqrt:  [[12.30170107  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00228342 -0.02188728  0.10613157]
Stock Position:  0.002283417204097172
Bond Position:  [-5.03316291]


portfolio before change:  [-4.8065077]
curr_Stock_Price:  99.81253636784571
curr_Factors:  [99.81253637 -0.90248796 -1.0185035 ]
mat_Sqrt:  [[14.61871173  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.05579495 -0.40028025  0.6160536 ]
Stock Position:  -0.05579494879470619
Bond Position:  [0.76252766]


portfolio before change:  [-4.70441903]
curr_Stock_Price:  97.98624181574168
curr_Factors:  [97.98624182 -0.54535499 -0.95622789]
mat_Sqrt:  [[21.8291057   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00411314 0.01953657 0.40074163]
Stock Position:  0.004113139402342793
Bond Position:  [-5.1074501]


portfolio before change:  [-4.70200874]
curr_Stock_Price:  98.88271356842661
curr_Factors:  [98.88271357 -0.16575979 -0.94557861]
mat_Sqrt:  [[32.54409829  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00124517  0.03078382 -0.25449014]
Stock Position:  0.0012451687224975896
Bond Position:  [-4.8251344]


portfolio before change:  [-4.69967002]
curr_Stock_Price:  101.72983759758651
curr_Factors:  [101.7298376   -0.51802689  -0.95606327]
mat_Sqrt:  [[23.29480757  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00338913 0.01114697 0.18987693]
Stock Position:  0.003389125502368067
Bond Position:  [-5.04444521]


portfolio before change:  [-4.71427332]
curr_Stock_Price:  97.79312150487215
curr_Factors:  [97.7931215  -0.39013681 -0.9287181 ]
mat_Sqrt:  [[26.15392656  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00454984 0.03505549 0.26147508]
Stock Position:  0.004549837048172691
Bond Position:  [-5.15921609]


portfolio before change:  [-4.70792722]
curr_Stock_Price:  99.47143817122378
curr_Factors:  [99.47143817 -0.33121553 -0.93147903]
mat_Sqrt:  [[28.13954821  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00349409 -0.00499787  0.02134531]
Stock Position:  0.003494088789402431
Bond Position:  [-5.05548925]


portfolio before change:  [-4.71290523]
curr_Stock_Price:  98.40850401240331
curr_Factors:  [98.40850401 -0.78469207 -0.9427623 ]
mat_Sqrt:  [[17.49076197  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0042557  -0.03612593 -0.00685448]
Stock Position:  -0.0042557002593875595
Bond Position:  [-4.29410814]


portfolio before change:  [-4.71974826]
curr_Stock_Price:  99.76418436529893
curr_Factors:  [99.76418437 -0.38933098 -0.92917373]
mat_Sqrt:  [[26.69041574  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00429261 -0.12627733 -1.21883386]
Stock Position:  -0.004292613189280522
Bond Position:  [-4.29149921]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-4.72175145]
Stock Price:  99.98087598834347
PL:  [-4.72175145]
Settle:  Tensor("sub_94:0", shape=(), dtype=float64)
PL:  Tensor("sub_95:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  48
output_Z_Vals[:, i, :]:  [[ 1.19271183e+02 -4.92738716e+01 -4.92570741e+01]
 [ 3.76805303e-02  6.46425228e-02 -4.28744536e-02]
 [-2.40741816e+00 -3.23872984e+00 -9.23723419e-01]
 [ 3.46265308e-02  2.26337264e-01 -4.36288835e-02]
 [ 6.93408976e-01  1.98828723e-01 -5.98488625e-01]
 [ 8.34232470e-02  1.88485781e-01  3.64700007e-02]
 [ 2.93610814e-02  1.84398810e-02  1.10761732e-01]
 [ 1.55337775e-01  4.63756532e-01  3.48790159e-01]
 [ 2.69338799e-02 -9.05822626e-02 -9.26068616e-03]
 [-1.20722436e+00 -4.94988068e-01 -4.54797017e-02]
 [ 3.51715383e-01  5.83571088e-02 -1.31289722e-02]
 [ 7.91486423e-03 -6.52751087e-02  3.48064503e-02]
 [-5.66231939e-01 -1.26454816e+00  2.01250108e-01]
 [ 3.90741649e-02  5.21028134e-02  1.21922869e-01]
 [ 9.49188936e-02  1.31793459e-01 -1.04312875e-01]
 [ 8.69591294e-02  2.68270575e-02  5.29969285e-02]
 [-2.35956880e-02 -3.42947931e-02 -5.06289105e-02]
 [-2.76068838e-02 -1.19478196e-01  2.29645234e-01]
 [ 4.84013435e-02 -5.32837397e-02  7.08573323e-02]
 [ 9.83142911e-02 -8.35647010e-01 -3.47656607e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.27118322 -49.27387164 -49.25707411]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [   7.3268874   -15.90307369 -140.51672192]
init_Out:  [2.48374395]
Stock Position:  7.326887399052493
Bond position:  [-730.20499595]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-3.98885698]
curr_Stock_Price:  99.14151446341808
curr_Factors:  [99.14151446 -0.54948382 -1.01648125]
mat_Sqrt:  [[20.70930668  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00203406  0.02086328 -0.12230888]
Stock Position:  0.002034057413053266
Bond Position:  [-4.19051651]


portfolio before change:  [-3.98564378]
curr_Stock_Price:  101.23632438794698
curr_Factors:  [101.23632439  -0.57841189  -1.02275095]
mat_Sqrt:  [[20.41550763  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.15953928 -1.04529556 -2.6351258 ]
Stock Position:  -0.15953927937534984
Bond Position:  [12.16552646]


portfolio before change:  [-3.95354677]
curr_Stock_Price:  101.0542047026342
curr_Factors:  [101.0542047   -0.40959274  -1.05910976]
mat_Sqrt:  [[23.26510395  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0030914   0.07305004 -0.12446106]
Stock Position:  0.0030913991601783587
Bond Position:  [-4.26594565]


portfolio before change:  [-3.94874815]
curr_Stock_Price:  102.95148171924406
curr_Factors:  [102.95148172  -0.72714673  -1.13355106]
mat_Sqrt:  [[16.01554854  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.03820217  0.06417169 -1.70732146]
Stock Position:  0.03820217200781866
Bond Position:  [-7.88171836]


portfolio before change:  [-3.91255526]
curr_Stock_Price:  103.95047111195633
curr_Factors:  [103.95047111  -0.49883581  -1.1781482 ]
mat_Sqrt:  [[19.43218161  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00665608 0.06083352 0.10403876]
Stock Position:  0.0066560799095876436
Bond Position:  [-4.6044579]


portfolio before change:  [-3.92129039]
curr_Stock_Price:  102.81108150982062
curr_Factors:  [102.81108151  -0.50893642  -1.17765747]
mat_Sqrt:  [[19.03537802  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00292793 0.00595145 0.31597239]
Stock Position:  0.0029279297788290235
Bond Position:  [-4.22231401]


portfolio before change:  [-3.92386591]
curr_Stock_Price:  102.29200890993727
curr_Factors:  [102.29200891  -0.27238237  -1.17063346]
mat_Sqrt:  [[24.16283551  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01329307 0.14967678 0.99500124]
Stock Position:  0.013293066273901857
Bond Position:  [-5.28364036]


portfolio before change:  [-3.92545469]
curr_Stock_Price:  102.27186998778491
curr_Factors:  [102.27186999  -0.5844558   -1.12704454]
mat_Sqrt:  [[18.46975103  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00035482 -0.0292353  -0.02641816]
Stock Position:  0.00035482466986511076
Bond Position:  [-3.96174327]


portfolio before change:  [-3.92682458]
curr_Stock_Price:  101.2028139362682
curr_Factors:  [101.20281394  -0.55927458  -1.12253813]
mat_Sqrt:  [[18.82741117  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.06998025 -0.15975671 -0.12974093]
Stock Position:  -0.06998024660042815
Bond Position:  [3.1553733]


portfolio before change:  [-3.91905181]
curr_Stock_Price:  101.10301686369331
curr_Factors:  [101.10301686  -0.49359775  -1.11476421]
mat_Sqrt:  [[20.24237135  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01783129  0.01883468 -0.0374533 ]
Stock Position:  0.017831287216018687
Bond Position:  [-5.72184874]


portfolio before change:  [-3.9596693]
curr_Stock_Price:  98.90537147640757
curr_Factors:  [98.90537148 -0.71718056 -1.12324472]
mat_Sqrt:  [[15.70121757  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00010798 -0.02106745  0.09929311]
Stock Position:  0.0001079836880790923
Bond Position:  [-3.97034946]


portfolio before change:  [-3.96067222]
curr_Stock_Price:  98.81081907000976
curr_Factors:  [98.81081907 -0.63239128 -1.14181003]
mat_Sqrt:  [[16.76017926  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.04673439 -0.40813116  0.57411054]
Stock Position:  -0.04673438948383252
Bond Position:  [0.65719108]


portfolio before change:  [-3.97164986]
curr_Stock_Price:  99.04922930361782
curr_Factors:  [99.0492293  -0.27766775 -1.14021178]
mat_Sqrt:  [[23.99240823  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00310919 0.01681611 0.34781201]
Stock Position:  0.0031091922039987387
Bond Position:  [-4.27961295]


portfolio before change:  [-3.9687976]
curr_Stock_Price:  100.31074488311508
curr_Factors:  [100.31074488  -0.51750636  -1.15977749]
mat_Sqrt:  [[18.74616061  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00536261  0.04253616 -0.2975756 ]
Stock Position:  0.005362609782336641
Bond Position:  [-4.50672498]


portfolio before change:  [-3.95204674]
curr_Stock_Price:  103.64450937261986
curr_Factors:  [103.64450937  -0.74571185  -1.18637569]
mat_Sqrt:  [[15.01244212  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00687784 0.0086584  0.15118549]
Stock Position:  0.006877837164769093
Bond Position:  [-4.6648968]


portfolio before change:  [-3.94505571]
curr_Stock_Price:  104.83055080957074
curr_Factors:  [104.83055081  -0.70637116  -1.18457275]
mat_Sqrt:  [[15.82199938  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00258695 -0.0110686  -0.14443019]
Stock Position:  -0.002586946532180635
Bond Position:  [-3.67386468]


portfolio before change:  [-3.94597294]
curr_Stock_Price:  104.83002757349844
curr_Factors:  [104.83002757  -0.78605136  -1.17737821]
mat_Sqrt:  [[14.7156372   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-3.47870175e-04 -3.85614221e-02  6.55113933e-01]
Stock Position:  -0.0003478701747602725
Bond Position:  [-3.9095057]


portfolio before change:  [-3.94713731]
curr_Stock_Price:  105.36721463026745
curr_Factors:  [105.36721463  -0.89520942  -1.16554882]
mat_Sqrt:  [[13.41929084  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00387416 -0.01719725  0.20213625]
Stock Position:  0.0038741643393974006
Bond Position:  [-4.35534722]


portfolio before change:  [-3.94978989]
curr_Stock_Price:  104.96361641461407
curr_Factors:  [104.96361641  -1.08188356  -1.19835558]
mat_Sqrt:  [[10.73355312  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01334382 -0.26970391 -0.99176753]
Stock Position:  -0.013343815105831507
Bond Position:  [-2.5491748]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-3.95744967]
Stock Price:  105.4898835353618
PL:  [-9.44733321]
Settle:  Tensor("sub_96:0", shape=(), dtype=float64)
PL:  Tensor("sub_97:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  49
output_Z_Vals[:, i, :]:  [[ 1.19271183e+02 -4.92738716e+01 -4.92570741e+01]
 [ 4.99683008e-02  8.91725922e-02 -3.12581105e-02]
 [-2.53729628e+00 -2.79943206e+00 -8.58268931e-01]
 [ 3.07859851e-02  1.18627871e-01 -8.58194566e-02]
 [ 7.53323826e-01 -4.88120622e-02 -4.38099610e-01]
 [ 1.04216971e-02  1.85306944e-02  6.61957587e-03]
 [ 1.65178632e-02  2.34785807e-02  1.05895190e-01]
 [ 8.03349880e-02  2.09321347e-01  9.21760759e-02]
 [ 1.37095037e-02 -1.24632482e-01  2.20803555e-03]
 [-1.01447552e+00 -4.08918966e-01 -3.58145186e-02]
 [ 3.67679465e-01  5.81876412e-02 -2.46696006e-02]
 [ 5.61611000e-02 -6.13663499e-02  3.76280910e-02]
 [-6.57961242e-01 -1.30506845e+00  2.30903078e-01]
 [ 1.51219230e-02  3.12485975e-02  7.60184367e-02]
 [ 1.28898147e-01  1.18238916e-01 -1.06129701e-01]
 [ 8.38177354e-02  2.74652831e-02  5.41331387e-02]
 [ 9.55206502e-02  8.23572954e-02  6.54428754e-02]
 [ 1.08440855e-01 -1.28622820e-02 -1.28218877e-02]
 [-4.45114434e-02 -5.15312136e-02 -2.34609930e-02]
 [ 8.59301803e-02 -6.75562194e-01 -6.12313905e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.27118322 -49.27387164 -49.25707411]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [   7.3268874   -15.90307369 -140.51672192]
init_Out:  [2.48374395]
Stock Position:  7.326887399052493
Bond position:  [-730.20499595]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-2.32125412]
curr_Stock_Price:  99.36911491135012
curr_Factors:  [99.36911491 -1.0384485  -1.00048907]
mat_Sqrt:  [[12.93457271  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00477712  0.02878033 -0.08917069]
Stock Position:  0.004777123010129259
Bond Position:  [-2.79595261]


portfolio before change:  [-2.32778933]
curr_Stock_Price:  98.14743175273767
curr_Factors:  [98.14743175 -1.01637515 -0.98884183]
mat_Sqrt:  [[13.21369484  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.24852408 -0.90351281 -2.44840236]
Stock Position:  -0.24852408148475935
Bond Position:  [22.064211]


portfolio before change:  [-2.62773894]
curr_Stock_Price:  99.37655349695709
curr_Factors:  [99.3765535  -0.95676811 -1.0029427 ]
mat_Sqrt:  [[14.00207313  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00267696  0.03828698 -0.24481902]
Stock Position:  0.0026769589269673142
Bond Position:  [-2.89376589]


portfolio before change:  [-2.62600198]
curr_Stock_Price:  100.29569221151678
curr_Factors:  [100.29569221  -0.82356484  -0.96894819]
mat_Sqrt:  [[16.70335694  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.03914982 -0.01575403 -1.24977624]
Stock Position:  0.0391498187424956
Bond Position:  [-6.55256015]


portfolio before change:  [-2.64003344]
curr_Stock_Price:  99.979136084149
curr_Factors:  [99.97913608 -0.97948663 -0.96968758]
mat_Sqrt:  [[14.23619006  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00109267 0.00598076 0.01888381]
Stock Position:  0.001092671175389456
Bond Position:  [-2.74927776]


portfolio before change:  [-2.6397024]
curr_Stock_Price:  100.91120577345555
curr_Factors:  [100.91120577  -1.00237904  -0.95598228]
mat_Sqrt:  [[14.23750476  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00301501 0.00757768 0.3020895 ]
Stock Position:  0.003015006802947142
Bond Position:  [-2.94395037]


portfolio before change:  [-2.6417772]
curr_Stock_Price:  100.46718616497981
curr_Factors:  [100.46718616  -0.94924338  -0.95533245]
mat_Sqrt:  [[14.9581356   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.009485   0.06755817 0.26295269]
Stock Position:  0.009484998367548306
Bond Position:  [-3.59470829]


portfolio before change:  [-2.63524311]
curr_Stock_Price:  101.25083144319818
curr_Factors:  [101.25083144  -1.27212839  -0.95185035]
mat_Sqrt:  [[10.95309629  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00102987 -0.04022496  0.00629891]
Stock Position:  -0.0010298715118010604
Bond Position:  [-2.53096777]


portfolio before change:  [-2.63498014]
curr_Stock_Price:  100.3810225782685
curr_Factors:  [100.38102258  -1.37048629  -0.96345791]
mat_Sqrt:  [[ 9.72820091  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.11361364 -0.13197803 -0.10216885]
Stock Position:  -0.11361364452975461
Bond Position:  [8.76967367]


portfolio before change:  [-2.68026375]
curr_Stock_Price:  100.79889758915206
curr_Factors:  [100.79889759  -1.45539285  -0.98207933]
mat_Sqrt:  [[ 8.80795459  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0425208   0.01877998 -0.0703755 ]
Stock Position:  0.042520803471661484
Bond Position:  [-6.96631387]


portfolio before change:  [-2.68917815]
curr_Stock_Price:  100.63021316469974
curr_Factors:  [100.63021316  -1.50531055  -0.93872532]
mat_Sqrt:  [[ 8.73568776  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00587424 -0.0198059   0.10734247]
Stock Position:  0.005874242484745076
Bond Position:  [-3.28030442]


portfolio before change:  [-2.69642385]
curr_Stock_Price:  99.5363655371894
curr_Factors:  [99.53636554 -1.5829531  -0.94725732]
mat_Sqrt:  [[ 7.92730107  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.11065864 -0.42120903  0.65870221]
Stock Position:  -0.11065863677202327
Bond Position:  [8.31813467]


portfolio before change:  [-2.70605666]
curr_Stock_Price:  99.64220999892692
curr_Factors:  [99.64221    -1.64735739 -0.94870318]
mat_Sqrt:  [[ 7.42999584  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.0049822  0.01008544 0.21685944]
Stock Position:  0.004982198575764649
Bond Position:  [-3.20249394]


portfolio before change:  [-2.70550985]
curr_Stock_Price:  99.91267916382886
curr_Factors:  [99.91267916 -1.49562719 -0.98132302]
mat_Sqrt:  [[ 8.39256662  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01565313  0.03816145 -0.3027585 ]
Stock Position:  0.01565312922532345
Bond Position:  [-4.26945593]


portfolio before change:  [-2.69496303]
curr_Stock_Price:  100.65465964876972
curr_Factors:  [100.65465965  -1.80080673  -0.98286364]
mat_Sqrt:  [[ 6.22158732  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01614925 0.00886438 0.15442678]
Stock Position:  0.016149245914356614
Bond Position:  [-4.32045989]


portfolio before change:  [-2.70018215]
curr_Stock_Price:  100.39837151311447
curr_Factors:  [100.39837151  -1.80084704  -0.96708122]
mat_Sqrt:  [[ 6.30421038  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01993751 0.0265807  0.18669031]
Stock Position:  0.01993750621017958
Bond Position:  [-4.7018753]


portfolio before change:  [-2.71739176]
curr_Stock_Price:  99.59415842067348
curr_Factors:  [99.59415842 -1.28421278 -0.95531271]
mat_Sqrt:  [[10.60767739  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00972862 -0.00415128 -0.03657728]
Stock Position:  0.00972862316730233
Bond Position:  [-3.6863058]


portfolio before change:  [-2.71318705]
curr_Stock_Price:  100.12109936427481
curr_Factors:  [100.12109936  -0.8890625   -1.00529347]
mat_Sqrt:  [[15.0597328   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00397213 -0.01663163 -0.06692768]
Stock Position:  -0.00397212648295941
Bond Position:  [-2.31549338]


portfolio before change:  [-2.71075466]
curr_Stock_Price:  99.36298304039826
curr_Factors:  [99.36298304 -1.19952489 -1.00533502]
mat_Sqrt:  [[10.95635585  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01615103 -0.21803676 -1.74676114]
Stock Position:  -0.016151029587531732
Bond Position:  [-1.10594018]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-2.72006987]
Stock Price:  99.92261844761083
PL:  [-2.72006987]
Settle:  Tensor("sub_98:0", shape=(), dtype=float64)
PL:  Tensor("sub_99:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  50
output_Z_Vals[:, i, :]:  [[ 1.19271183e+02 -4.92738716e+01 -4.92570741e+01]
 [ 2.88027800e-03  1.05600075e-02 -5.56262527e-02]
 [-2.13232081e+00 -2.87188045e+00 -8.17600679e-01]
 [-2.41393875e-01 -8.44967533e-02  1.56722509e-01]
 [ 6.11270261e-01  1.51256264e-01 -5.29520322e-01]
 [ 7.57175145e-02  1.17192732e-01 -6.73936232e-03]
 [ 2.91588379e-02  1.26750287e-02  1.10146601e-01]
 [ 8.59766471e-03  2.84665966e-02  1.24187075e-02]
 [-2.08304192e-02 -2.13566125e-01  3.21624740e-02]
 [-1.25682677e+00 -5.01399294e-01 -4.83015053e-02]
 [ 4.18334630e-01  1.17509179e-01  5.06502571e-02]
 [-1.09368278e-01 -2.09128557e-02  3.12767447e-02]
 [-6.61562200e-01 -1.14621349e+00  2.34378445e-01]
 [ 3.99431399e-04  1.78072186e-02  4.68755761e-02]
 [ 1.11282283e-01  1.24934184e-01 -1.05536106e-01]
 [ 7.39427009e-02  3.03305882e-02  5.91596854e-02]
 [-2.14274531e-02 -3.21714141e-02 -4.85160946e-02]
 [-1.01284709e-02 -1.06912694e-01  1.94313284e-01]
 [ 4.34134119e-02 -4.03033769e-02  5.93284469e-02]
 [ 6.10555512e-02 -5.77107169e-01 -3.15792629e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.27118322 -49.27387164 -49.25707411]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [   7.3268874   -15.90307369 -140.51672192]
init_Out:  [2.48374395]
Stock Position:  7.326887399052493
Bond position:  [-730.20499595]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [9.33268781]
curr_Stock_Price:  100.95968690995232
curr_Factors:  [100.95968691  -1.11863301  -1.01728784]
mat_Sqrt:  [[11.92694877  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00052979  0.00340823 -0.15868622]
Stock Position:  -0.0005297944094704044
Bond Position:  [9.38617569]


portfolio before change:  [9.33478173]
curr_Stock_Price:  101.4370663599298
curr_Factors:  [101.43706636  -1.05260435  -1.00014264]
mat_Sqrt:  [[13.02266858  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.22157002 -0.92689543 -2.33238716]
Stock Position:  -0.22157002409341217
Bond Position:  [31.81019497]


portfolio before change:  [9.15757863]
curr_Stock_Price:  102.27272384031576
curr_Factors:  [102.27272384  -1.32974823  -1.01936251]
mat_Sqrt:  [[ 9.76234138  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02321685 -0.02727121  0.4470857 ]
Stock Position:  -0.023216853964441002
Bond Position:  [11.53202952]


portfolio before change:  [9.16298509]
curr_Stock_Price:  102.16404893252394
curr_Factors:  [102.16404893  -1.16665063  -1.03148759]
mat_Sqrt:  [[11.3411945   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.04709005  0.04881775 -1.51057409]
Stock Position:  0.0470900515677123
Bond Position:  [4.35207475]


portfolio before change:  [9.15682235]
curr_Stock_Price:  102.01006978156018
curr_Factors:  [102.01006978  -1.10060749  -0.98106581]
mat_Sqrt:  [[12.72283281  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00772341  0.03782379 -0.01922552]
Stock Position:  0.007723414720344459
Bond Position:  [8.36895628]


portfolio before change:  [9.15951349]
curr_Stock_Price:  102.08757951508828
curr_Factors:  [102.08757952  -1.41816167  -0.95553871]
mat_Sqrt:  [[ 9.50797278  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.0057036  0.00409085 0.31421759]
Stock Position:  0.005703602571656118
Bond Position:  [8.57724651]


portfolio before change:  [9.16061377]
curr_Stock_Price:  101.90448309849864
curr_Factors:  [101.9044831   -1.32526151  -0.95935899]
mat_Sqrt:  [[10.37516983  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00163307 0.00918755 0.03542712]
Stock Position:  0.0016330665179779308
Bond Position:  [8.99419697]


portfolio before change:  [9.16441385]
curr_Stock_Price:  102.85438567071358
curr_Factors:  [102.85438567  -1.14238859  -0.96984757]
mat_Sqrt:  [[12.44200315  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00465032 -0.06892817  0.09175059]
Stock Position:  -0.004650319061200552
Bond Position:  [9.64271956]


portfolio before change:  [9.16753302]
curr_Stock_Price:  102.7020964520533
curr_Factors:  [102.70209645  -1.08141118  -0.97655966]
mat_Sqrt:  [[13.11637816  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.10437592 -0.16182593 -0.13779075]
Stock Position:  -0.10437591520686648
Bond Position:  [19.88715834]


portfolio before change:  [9.26524744]
curr_Stock_Price:  101.81355811607236
curr_Factors:  [101.81355812  -0.93592141  -0.95590229]
mat_Sqrt:  [[15.35313327  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.02948323 0.03792592 0.14449109]
Stock Position:  0.029483234654951486
Bond Position:  [6.26345441]


portfolio before change:  [9.26470428]
curr_Stock_Price:  101.74201842423786
curr_Factors:  [101.74201842  -0.69719883  -0.95455274]
mat_Sqrt:  [[19.50535051  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00549863 -0.0067496   0.08922385]
Stock Position:  -0.005498632676927132
Bond Position:  [9.82414626]


portfolio before change:  [9.2707584]
curr_Stock_Price:  101.08771308298796
curr_Factors:  [101.08771308  -1.00552287  -0.93989108]
mat_Sqrt:  [[14.44826936  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.05867068 -0.36993881  0.66861646]
Stock Position:  -0.0586706773873533
Bond Position:  [15.20164301]


portfolio before change:  [9.28141581]
curr_Stock_Price:  100.97084850410101
curr_Factors:  [100.9708485   -1.09774849  -0.97415458]
mat_Sqrt:  [[12.71686131  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00106966 0.00574726 0.13372297]
Stock Position:  0.001069662651321975
Bond Position:  [9.17341107]


portfolio before change:  [9.28458265]
curr_Stock_Price:  101.78717883727829
curr_Factors:  [101.78717884  -1.20462976  -0.9431703 ]
mat_Sqrt:  [[11.88270634  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00969829  0.04032233 -0.30106513]
Stock Position:  0.009698287257433522
Bond Position:  [8.29742135]


portfolio before change:  [9.28767974]
curr_Stock_Price:  101.89260735843015
curr_Factors:  [101.89260736  -1.05395598  -0.96800984]
mat_Sqrt:  [[13.49006606  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00683539 0.00978916 0.16876612]
Stock Position:  0.006835387319251705
Bond Position:  [8.59120431]


portfolio before change:  [9.3050059]
curr_Stock_Price:  104.11312386429879
curr_Factors:  [104.11312386  -1.32541223  -0.98833618]
mat_Sqrt:  [[10.29573395  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00368092 -0.01038328 -0.13840291]
Stock Position:  -0.0036809150307628527
Bond Position:  [9.68823746]


portfolio before change:  [9.30679915]
curr_Stock_Price:  104.28403738011285
curr_Factors:  [104.28403738  -1.1571496   -0.9934289 ]
mat_Sqrt:  [[12.14041297  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00063524 -0.03450592  0.55432171]
Stock Position:  0.0006352419680440062
Bond Position:  [9.24055355]


portfolio before change:  [9.30978898]
curr_Stock_Price:  105.35356575163087
curr_Factors:  [105.35356575  -0.89364293  -1.01594416]
mat_Sqrt:  [[15.60723979  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00303045 -0.01300786  0.16924755]
Stock Position:  0.0030304454006983466
Bond Position:  [8.99052075]


portfolio before change:  [9.31159326]
curr_Stock_Price:  105.2071721867855
curr_Factors:  [105.20717219  -0.7528775   -0.99450422]
mat_Sqrt:  [[18.33019595  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00661241 -0.18626054 -0.90086847]
Stock Position:  -0.006612414683729296
Bond Position:  [10.00726671]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [9.31378488]
Stock Price:  105.25413078404829
PL:  [4.05965409]
Settle:  Tensor("sub_100:0", shape=(), dtype=float64)
PL:  Tensor("sub_101:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  51
output_Z_Vals[:, i, :]:  [[ 1.19271183e+02 -4.92738716e+01 -4.92570741e+01]
 [ 4.05824470e-02  7.40931619e-02 -3.56137507e-02]
 [-2.23548575e+00 -3.00945355e+00 -8.57398032e-01]
 [-5.63233556e-02  1.43605479e-01  3.90730131e-02]
 [ 8.18633170e-01  1.66941597e-02 -5.16529120e-01]
 [ 7.57175145e-02  1.17192732e-01 -6.73936232e-03]
 [-1.04050288e-02  2.92454629e-02  1.21121157e-02]
 [ 1.43411269e-01  3.75958732e-01  2.34876966e-01]
 [ 8.98998165e-02  7.15428856e-02 -6.38673302e-02]
 [-1.14209207e+00 -4.70190217e-01 -4.21226055e-02]
 [ 2.18883016e-01  2.23865065e-02 -9.33400650e-02]
 [ 7.64142277e-03 -7.57046698e-02  3.66843346e-02]
 [-6.61577510e-01 -1.06066224e+00  2.33174730e-01]
 [ 6.93958977e-03  2.37782881e-02  5.98217088e-02]
 [-9.76950780e-03  3.94644642e-03 -4.08923572e-02]
 [ 7.79794948e-02  2.92440358e-02  5.72484254e-02]
 [-2.33437287e-03 -1.34733268e-02 -2.99110236e-02]
 [-1.15067353e-03 -9.92566098e-02  1.79183906e-01]
 [ 1.59509689e-02  7.01740477e-03  1.02918463e-02]
 [ 4.65826167e-02 -4.64397925e-01 -3.22323902e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.27118322 -49.27387164 -49.25707411]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [   7.3268874   -15.90307369 -140.51672192]
init_Out:  [2.48374395]
Stock Position:  7.326887399052493
Bond position:  [-730.20499595]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-0.5945301]
curr_Stock_Price:  99.60478442926266
curr_Factors:  [99.60478443 -0.99018018 -1.00521545]
mat_Sqrt:  [[13.54225194  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00357673  0.02391347 -0.10159612]
Stock Position:  0.0035767333349188447
Bond Position:  [-0.95078986]


portfolio before change:  [-0.58969999]
curr_Stock_Price:  101.02167437527596
curr_Factors:  [101.02167438  -0.87040181  -1.03633368]
mat_Sqrt:  [[15.00824333  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.20154281 -0.97129696 -2.44591793]
Stock Position:  -0.20154280949831047
Bond Position:  [19.77049208]


portfolio before change:  [-0.72228921]
curr_Stock_Price:  101.70407263492186
curr_Factors:  [101.70407263  -0.47261375  -1.01190168]
mat_Sqrt:  [[23.04737584  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00082588  0.04634847  0.11146443]
Stock Position:  -0.000825875564632381
Bond Position:  [-0.63829431]


portfolio before change:  [-0.72240688]
curr_Stock_Price:  101.653302772748
curr_Factors:  [101.65330277  -0.89300392  -0.97539629]
mat_Sqrt:  [[15.69226345  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.04566612  0.00538802 -1.4735138 ]
Stock Position:  0.045666120027575675
Bond Position:  [-5.3645188]


portfolio before change:  [-0.79177284]
curr_Stock_Price:  100.16369379582522
curr_Factors:  [100.1636938   -0.71301178  -0.96196081]
mat_Sqrt:  [[18.76199325  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00523738  0.03782379 -0.01922552]
Stock Position:  0.0052373813837307435
Bond Position:  [-1.3163683]


portfolio before change:  [-0.8012514]
curr_Stock_Price:  98.41674672431907
curr_Factors:  [98.41674672 -0.69449571 -0.96409008]
mat_Sqrt:  [[18.73934252  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00010475  0.00943893  0.03455249]
Stock Position:  -0.0001047501234610565
Bond Position:  [-0.79094223]


portfolio before change:  [-0.80137476]
curr_Stock_Price:  97.70647655981524
curr_Factors:  [97.70647656 -0.18265345 -0.99283598]
mat_Sqrt:  [[30.15885023  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00888952 0.12134016 0.67003861]
Stock Position:  0.008889516069562002
Bond Position:  [-1.66993805]


portfolio before change:  [-0.7740168]
curr_Stock_Price:  100.83099917831792
curr_Factors:  [100.83099918  -0.70877653  -0.98202223]
mat_Sqrt:  [[18.59043278  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00492009  0.02309037 -0.18219572]
Stock Position:  0.004920088941154995
Bond Position:  [-1.27011429]


portfolio before change:  [-0.77479267]
curr_Stock_Price:  100.73785133706161
curr_Factors:  [100.73785134  -0.43498375  -0.99999314]
mat_Sqrt:  [[23.98778449  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.05197093 -0.15175324 -0.12016407]
Stock Position:  -0.05197093074408482
Bond Position:  [4.46064723]


portfolio before change:  [-0.70427303]
curr_Stock_Price:  99.4024061468787
curr_Factors:  [99.40240615 -0.33361684 -0.95371657]
mat_Sqrt:  [[27.43564022  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00745015  0.00722521 -0.26627322]
Stock Position:  0.007450151682857639
Bond Position:  [-1.44483604]


portfolio before change:  [-0.70135738]
curr_Stock_Price:  99.8422507886992
curr_Factors:  [99.84225079 -0.45092572 -0.9605085 ]
mat_Sqrt:  [[24.34087959  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-1.32932666e-05 -2.44335771e-02  1.04650196e-01]
Stock Position:  -1.3293266625571088e-05
Bond Position:  [-0.70003015]


portfolio before change:  [-0.7015518]
curr_Stock_Price:  101.30116030739835
curr_Factors:  [101.30116031  -0.58665888  -0.93834326]
mat_Sqrt:  [[22.04521837  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.03767201 -0.34232727  0.6651826 ]
Stock Position:  -0.0376720101798517
Bond Position:  [3.11466654]


portfolio before change:  [-0.67696111]
curr_Stock_Price:  100.66907479647188
curr_Factors:  [100.6690748   -0.67848639  -0.93848545]
mat_Sqrt:  [[19.98269838  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00120126 0.00767441 0.17065468]
Stock Position:  0.001201257569614572
Bond Position:  [-0.7978906]


portfolio before change:  [-0.67710041]
curr_Stock_Price:  100.71918853275922
curr_Factors:  [100.71918853  -0.22990128  -0.92356248]
mat_Sqrt:  [[31.78112533  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0005447   0.00127371 -0.11665451]
Stock Position:  -0.0005446962644945018
Bond Position:  [-0.62223904]


portfolio before change:  [-0.67920589]
curr_Stock_Price:  104.2989997866034
curr_Factors:  [104.29899979  -0.47965734  -0.95605727]
mat_Sqrt:  [[24.8174532   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00385353 0.00943847 0.16331382]
Stock Position:  0.003853525733909864
Bond Position:  [-1.08112477]


portfolio before change:  [-0.67831099]
curr_Stock_Price:  104.60137830946803
curr_Factors:  [104.60137831  -0.4427584   -0.98571993]
mat_Sqrt:  [[25.07016279  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00044635 -0.0043485  -0.08532782]
Stock Position:  -0.0004463539553992884
Bond Position:  [-0.63162175]


portfolio before change:  [-0.67814669]
curr_Stock_Price:  103.87948030920138
curr_Factors:  [103.87948031  -0.28162919  -0.98649972]
mat_Sqrt:  [[29.22727857  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00051884 -0.03203493  0.51116181]
Stock Position:  0.0005188446639088194
Bond Position:  [-0.732044]


portfolio before change:  [-0.67817564]
curr_Stock_Price:  104.17644834989065
curr_Factors:  [104.17644835  -0.77503979  -0.97270783]
mat_Sqrt:  [[18.1439734   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00107387 0.00226486 0.02935977]
Stock Position:  0.0010738664854705708
Bond Position:  [-0.79004724]


portfolio before change:  [-0.67895806]
curr_Stock_Price:  103.63180084257606
curr_Factors:  [103.63180084  -0.52389404  -0.9673087 ]
mat_Sqrt:  [[23.32770018  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00488716 -0.14988379 -0.91950037]
Stock Position:  -0.00488716431375476
Bond Position:  [-0.17249242]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-0.66678196]
Stock Price:  101.13153249465422
PL:  [-1.79831446]
Settle:  Tensor("sub_102:0", shape=(), dtype=float64)
PL:  Tensor("sub_103:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  52
output_Z_Vals[:, i, :]:  [[ 1.19271183e+02 -4.92738716e+01 -4.92570741e+01]
 [-3.22396179e-03 -7.38605969e-03 -6.53769518e-02]
 [-2.26023582e+00 -3.04245840e+00 -8.66945725e-01]
 [-1.21021055e-01  6.45283048e-02  8.01130044e-02]
 [ 8.48732254e-01  8.93358095e-03 -5.16237158e-01]
 [ 7.85448820e-02  1.43351393e-01  9.11490563e-03]
 [-4.61652504e-03  2.82878813e-02  4.60642945e-02]
 [ 1.22186318e-01  3.13471431e-01  1.76550753e-01]
 [-1.20393945e-01  3.78281873e-01 -9.27168276e-02]
 [-8.93675790e-01 -3.64811171e-01 -2.95481143e-02]
 [ 7.55856272e-02 -3.53476293e-02 -2.61053212e-01]
 [ 5.29648495e-03 -6.21580134e-02  3.40474841e-02]
 [-6.69106221e-01 -1.23218236e+00  2.30806962e-01]
 [ 3.91310610e-02  5.21523505e-02  1.22031910e-01]
 [ 1.09264952e-01  1.21147407e-01 -1.04000399e-01]
 [-6.27306030e-02  6.78798095e-02  1.16088018e-01]
 [ 9.84732432e-02  1.11977164e-01  1.08777661e-01]
 [ 1.15216134e-01 -1.08333916e-02 -3.18137274e-02]
 [-5.54033345e-02 -1.67203618e-01  2.18491338e-02]
 [ 8.62581250e-02 -6.60710228e-01 -6.58343282e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.27118322 -49.27387164 -49.25707411]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [   7.3268874   -15.90307369 -140.51672192]
init_Out:  [2.48374395]
Stock Position:  7.326887399052493
Bond position:  [-730.20499595]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [12.44057452]
curr_Stock_Price:  101.38386248921395
curr_Factors:  [101.38386249  -0.94492603  -1.02056904]
mat_Sqrt:  [[14.20251216  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00127278 -0.00238384 -0.18650225]
Stock Position:  -0.001272778301941459
Bond Position:  [12.5696137]


portfolio before change:  [12.44355496]
curr_Stock_Price:  101.51141824227146
curr_Factors:  [101.51141824  -0.76830217  -1.07204041]
mat_Sqrt:  [[16.11626008  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.18976112 -0.98194923 -2.47315484]
Stock Position:  -0.18976112209814644
Bond Position:  [31.70647559]


portfolio before change:  [12.37971275]
curr_Stock_Price:  101.8896296730882
curr_Factors:  [101.88962967  -0.79232527  -1.07274364]
mat_Sqrt:  [[15.78122992  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00579779  0.02082642  0.2285401 ]
Stock Position:  -0.005797790936727297
Bond Position:  [12.97044752]


portfolio before change:  [12.38454397]
curr_Stock_Price:  101.61569585324598
curr_Factors:  [101.61569585  -0.29362829  -1.10594169]
mat_Sqrt:  [[25.06890007  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.02972525  0.0028833  -1.47268092]
Stock Position:  0.029725250933045885
Bond Position:  [9.36399192]


portfolio before change:  [12.32056008]
curr_Stock_Price:  99.38442176983246
curr_Factors:  [99.38442177 -0.22796632 -1.09311417]
mat_Sqrt:  [[26.52041693  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00413519 0.04626646 0.02600229]
Stock Position:  0.00413518894680425
Bond Position:  [11.90958672]


portfolio before change:  [12.3183182]
curr_Stock_Price:  98.12216980556842
curr_Factors:  [ 9.81221698e+01 -9.01914568e-02 -1.12349716e+00]
mat_Sqrt:  [[29.15203473  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00036226 0.00912987 0.13140861]
Stock Position:  0.00036225770828676474
Bond Position:  [12.28277269]


portfolio before change:  [12.32021955]
curr_Stock_Price:  94.89316063795569
curr_Factors:  [94.89316064 -0.29876396 -1.12355202]
mat_Sqrt:  [[22.88394674  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00971037 0.10117247 0.50365016]
Stock Position:  0.009710373803971462
Bond Position:  [11.39877148]


portfolio before change:  [12.33221999]
curr_Stock_Price:  95.83549218677004
curr_Factors:  [95.83549219 -0.61357267 -1.08911724]
mat_Sqrt:  [[17.46053493  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00355678  0.12208995 -0.2644953 ]
Stock Position:  -0.003556776724453782
Bond Position:  [12.67308543]


portfolio before change:  [12.32829985]
curr_Stock_Price:  97.82853465778999
curr_Factors:  [97.82853466 -0.77432904 -1.09227407]
mat_Sqrt:  [[15.12899638  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.06439119 -0.1177423  -0.08429255]
Stock Position:  -0.06439118745316393
Bond Position:  [18.62759536]


portfolio before change:  [12.35193611]
curr_Stock_Price:  97.53379274357299
curr_Factors:  [97.53379274 -0.88054082 -1.07780705]
mat_Sqrt:  [[13.7611725   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00109606 -0.0114084  -0.74471215]
Stock Position:  0.0010960591369039085
Bond Position:  [12.2450333]


portfolio before change:  [12.35629967]
curr_Stock_Price:  98.72161488256769
curr_Factors:  [98.72161488 -0.85328611 -1.06865954]
mat_Sqrt:  [[14.44514342  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-3.05675627e-05 -2.00614126e-02  9.71279951e-02]
Stock Position:  -3.056756266976049e-05
Bond Position:  [12.35931735]


portfolio before change:  [12.35941323]
curr_Stock_Price:  97.9581204718188
curr_Factors:  [97.95812047 -1.30531077 -1.01263247]
mat_Sqrt:  [[ 9.64651593  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.09055198 -0.39768515  0.65842802]
Stock Position:  -0.09055198000954608
Bond Position:  [21.22971499]


portfolio before change:  [12.31835441]
curr_Stock_Price:  98.47016786223989
curr_Factors:  [98.47016786 -1.0630442  -1.02281782]
mat_Sqrt:  [[12.22999585  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00610681 0.0168321  0.34812307]
Stock Position:  0.006106811095572102
Bond Position:  [11.7170157]


portfolio before change:  [12.31921282]
curr_Stock_Price:  98.13100299712073
curr_Factors:  [98.131003   -1.24020339 -1.03583023]
mat_Sqrt:  [[10.07714243  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01119018  0.03910016 -0.29668419]
Stock Position:  0.011190183288978672
Bond Position:  [11.22110891]


portfolio before change:  [12.32616125]
curr_Stock_Price:  98.50122036593031
curr_Factors:  [98.50122037 -1.13468025 -1.04148947]
mat_Sqrt:  [[11.17745968  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0022526   0.02190811  0.3311668 ]
Stock Position:  -0.002252598380972252
Bond Position:  [12.54804494]


portfolio before change:  [12.32980204]
curr_Stock_Price:  98.27774762085342
curr_Factors:  [98.27774762 -1.12872127 -1.04121962]
mat_Sqrt:  [[11.22178229  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01279072 0.03614047 0.31031239]
Stock Position:  0.01279071625433074
Bond Position:  [11.07275926]


portfolio before change:  [12.32480893]
curr_Stock_Price:  97.67092884113445
curr_Factors:  [97.67092884 -1.12679475 -1.03223536]
mat_Sqrt:  [[11.27484175  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00944677 -0.00349646 -0.09075571]
Stock Position:  0.009446769187219105
Bond Position:  [11.40213421]


portfolio before change:  [12.32808308]
curr_Stock_Price:  97.71573366825338
curr_Factors:  [97.71573367 -1.19844043 -1.03787613]
mat_Sqrt:  [[10.4410591   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00814799 -0.05396474  0.0623295 ]
Stock Position:  -0.008147994707278578
Bond Position:  [13.12427037]


portfolio before change:  [12.33675678]
curr_Stock_Price:  97.05394927228753
curr_Factors:  [97.05394927 -1.20260703 -0.99942113]
mat_Sqrt:  [[10.73209566  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01705096 -0.21324331 -1.87807014]
Stock Position:  -0.017050961074467706
Bond Position:  [13.99161989]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [12.33512985]
Stock Price:  97.3545345267137
PL:  [12.33512985]
Settle:  Tensor("sub_104:0", shape=(), dtype=float64)
PL:  Tensor("sub_105:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  53
output_Z_Vals[:, i, :]:  [[ 1.19271183e+02 -4.92738716e+01 -4.92570741e+01]
 [ 5.23777863e-02  9.30437018e-02 -3.01399541e-02]
 [-2.69965206e+00 -2.72944027e+00 -8.73644340e-01]
 [-4.16833415e-02  3.15251304e-03 -1.35708457e-01]
 [ 3.27200392e-01  5.46618718e-02 -3.20205760e-01]
 [ 6.06971965e-02  9.65167664e-02 -4.25609680e-03]
 [ 9.74103160e-03  2.61558371e-02  6.75940548e-02]
 [ 6.32213004e-02  1.37030774e-01  3.91995037e-02]
 [ 9.64324943e-03 -1.35102303e-01  5.73445808e-03]
 [-1.22022338e+00 -4.79675351e-01 -4.65804149e-02]
 [ 4.67515917e-01  1.41141392e-01  6.39150341e-02]
 [-8.71463096e-03 -4.25375657e-02  3.50346065e-02]
 [-7.35639708e-01 -1.15611167e+00  2.62032004e-01]
 [-8.98633629e-03  9.23814919e-03  2.82966079e-02]
 [ 1.05985178e-01  1.27272115e-01 -1.04779114e-01]
 [ 8.24316453e-02  2.80456851e-02  5.51405107e-02]
 [ 9.45410392e-02  8.13979504e-02  6.44883028e-02]
 [ 8.26668755e-02 -2.92537794e-02  3.70894433e-02]
 [-2.77336777e-02 -7.35219186e-02  1.42982093e-02]
 [ 7.84507326e-02 -6.62312723e-01 -4.54224485e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.27118322 -49.27387164 -49.25707411]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [   7.3268874   -15.90307369 -140.51672192]
init_Out:  [2.48374395]
Stock Position:  7.326887399052493
Bond position:  [-730.20499595]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-3.11691783]
curr_Stock_Price:  99.26051986093653
curr_Factors:  [99.26051986 -1.02658425 -1.00866061]
mat_Sqrt:  [[12.9682368   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00502905  0.03002973 -0.0859809 ]
Stock Position:  0.005029053763217319
Bond Position:  [-3.61610432]


portfolio before change:  [-3.12897526]
curr_Stock_Price:  97.04274966172392
curr_Factors:  [97.04274966 -0.87537914 -1.0783398 ]
mat_Sqrt:  [[13.75541622  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.24972917 -0.88092306 -2.49226413]
Stock Position:  -0.24972916615869048
Bond Position:  [21.1054297]


portfolio before change:  [-3.48064557]
curr_Stock_Price:  98.47208744106587
curr_Factors:  [98.47208744 -1.10281961 -1.1222957 ]
mat_Sqrt:  [[10.6403973   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0064604   0.00101747 -0.38713845]
Stock Position:  -0.006460398833700932
Bond Position:  [-2.84447661]


portfolio before change:  [-3.4915141]
curr_Stock_Price:  100.04433161351892
curr_Factors:  [100.04433161  -0.84751669  -1.15086527]
mat_Sqrt:  [[13.56145319  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.02013033  0.01764204 -0.91345791]
Stock Position:  0.02013032590929664
Bond Position:  [-5.5054391]


portfolio before change:  [-3.48133935]
curr_Stock_Price:  100.61815680218356
curr_Factors:  [100.6181568   -1.04759097  -1.1700803 ]
mat_Sqrt:  [[10.95352649  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00726066  0.03115065 -0.01214146]
Stock Position:  0.007260659555528309
Bond Position:  [-4.21189353]


portfolio before change:  [-3.47902589]
curr_Stock_Price:  101.08182819417593
curr_Factors:  [101.08182819  -1.30140477  -1.18419385]
mat_Sqrt:  [[ 8.41765892  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.0034306  0.00844176 0.19282702]
Stock Position:  0.0034306032621140153
Bond Position:  [-3.82579754]


portfolio before change:  [-3.47993717]
curr_Stock_Price:  101.09502935101987
curr_Factors:  [101.09502935  -1.38350576  -1.19509488]
mat_Sqrt:  [[ 7.6711023   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01293089 0.04422649 0.11182527]
Stock Position:  0.012930886760617558
Bond Position:  [-4.78718555]


portfolio before change:  [-3.47436338]
curr_Stock_Price:  101.61863902885054
curr_Factors:  [101.61863903  -1.2469995   -1.19282345]
mat_Sqrt:  [[ 8.85873546  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00189235 -0.04360408  0.01635881]
Stock Position:  -0.0018923526237961269
Bond Position:  [-3.28206508]


portfolio before change:  [-3.47519794]
curr_Stock_Price:  101.62600739086871
curr_Factors:  [101.62600739  -1.26501777  -1.18757052]
mat_Sqrt:  [[ 8.74700357  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.15178282 -0.15481455 -0.13288096]
Stock Position:  -0.15178282206024685
Bond Position:  [11.94988425]


portfolio before change:  [-3.5395634]
curr_Stock_Price:  102.06975524754216
curr_Factors:  [102.06975525  -1.4406243   -1.2362104 ]
mat_Sqrt:  [[ 7.02041092  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.07255599 0.04555319 0.1823318 ]
Stock Position:  0.07255599293759073
Bond Position:  [-10.94533584]


portfolio before change:  [-3.50274367]
curr_Stock_Price:  102.61493983388102
curr_Factors:  [102.61493983  -1.6513631   -1.22826068]
mat_Sqrt:  [[ 5.76243285  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0017781  -0.01372894  0.09994398]
Stock Position:  -0.0017780972638736456
Bond Position:  [-3.32028432]


portfolio before change:  [-3.50309221]
curr_Stock_Price:  102.34407041317671
curr_Factors:  [102.34407041  -1.50720378  -1.25511689]
mat_Sqrt:  [[ 6.46252236  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.14207192 -0.37313344  0.74750437]
Stock Position:  -0.1420719195556041
Bond Position:  [11.03712633]


portfolio before change:  [-3.43888303]
curr_Stock_Price:  101.91154613439382
curr_Factors:  [101.91154613  -1.34325269  -1.23286329]
mat_Sqrt:  [[ 7.7522976   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00017086  0.0029816   0.08072235]
Stock Position:  -0.00017086367914246136
Bond Position:  [-3.42147005]


portfolio before change:  [-3.43977464]
curr_Stock_Price:  102.12302393297539
curr_Factors:  [102.12302393  -1.14799892  -1.22966595]
mat_Sqrt:  [[ 9.47364124  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01167202  0.0410769  -0.29890565]
Stock Position:  0.011672021306768985
Bond Position:  [-4.63175675]


portfolio before change:  [-3.44471365]
curr_Stock_Price:  101.79909287626394
curr_Factors:  [101.79909288  -1.08997462  -1.22917933]
mat_Sqrt:  [[10.01262942  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00992866 0.00905171 0.15730053]
Stock Position:  0.009928656320809283
Bond Position:  [-4.45544186]


portfolio before change:  [-3.44970865]
curr_Stock_Price:  101.40820396147447
curr_Factors:  [101.40820396  -0.88594477  -1.2157431 ]
mat_Sqrt:  [[12.39714407  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01002811 0.02627108 0.18396718]
Stock Position:  0.010028111734826504
Bond Position:  [-4.46664145]


portfolio before change:  [-3.44567062]
curr_Stock_Price:  101.9222426697607
curr_Factors:  [101.92224267  -1.04312448  -1.23564158]
mat_Sqrt:  [[10.43790763  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0080731  -0.00944162  0.10580586]
Stock Position:  0.008073104950698573
Bond Position:  [-4.26849958]


portfolio before change:  [-3.44866784]
curr_Stock_Price:  101.68318097430918
curr_Factors:  [101.68318097  -0.86339297  -1.22927997]
mat_Sqrt:  [[12.543329    0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00317481 -0.0237291   0.04078881]
Stock Position:  -0.0031748084316801247
Bond Position:  [-3.12584322]


portfolio before change:  [-3.45102824]
curr_Stock_Price:  102.18048192990248
curr_Factors:  [102.18048193  -0.90605464  -1.22194686]
mat_Sqrt:  [[12.16714369  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01228402 -0.21376051 -1.29577602]
Stock Position:  -0.012284022803762066
Bond Position:  [-2.19584087]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-3.44658064]
Stock Price:  101.77372353282735
PL:  [-5.22030417]
Settle:  Tensor("sub_106:0", shape=(), dtype=float64)
PL:  Tensor("sub_107:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  54
output_Z_Vals[:, i, :]:  [[ 1.19271183e+02 -4.92738716e+01 -4.92570741e+01]
 [ 1.78817785e-02  3.76219836e-02 -4.61483218e-02]
 [-1.98384337e+00 -2.67388196e+00 -7.60323383e-01]
 [ 1.01107049e-01  2.70730121e-01 -4.58966961e-02]
 [ 4.75886459e-01  2.61853523e-02 -3.66644892e-01]
 [-5.42372366e-02 -5.34515802e-02  1.33146258e-02]
 [ 3.20819842e-03  2.68961801e-02  5.12261448e-02]
 [ 8.19760451e-02  2.07184335e-01  8.66922439e-02]
 [ 5.10876924e-02 -2.83908517e-02 -3.02078635e-02]
 [-1.11489681e+00 -4.53698919e-01 -4.08513469e-02]
 [ 2.87120980e-01  2.98365194e-02 -6.71675209e-02]
 [-7.77841226e-02 -3.68058180e-02  3.27750580e-02]
 [-7.09446326e-01 -9.16263858e-01  2.47354567e-01]
 [ 4.39282710e-02  5.20584188e-02  8.73015784e-02]
 [ 7.44036034e-02  1.27779494e-01 -1.02450419e-01]
 [-1.23274802e-01  8.81078157e-02  1.31377380e-01]
 [ 9.65102460e-02  1.11093435e-01  8.89554575e-02]
 [ 1.11813559e-01 -1.18422848e-02 -2.18510829e-02]
 [-9.40401827e-02 -4.80410313e-01  1.45718461e-01]
 [ 2.99248498e-03 -1.44665378e-01 -7.66594387e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.27118322 -49.27387164 -49.25707411]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [   7.3268874   -15.90307369 -140.51672192]
init_Out:  [2.48374395]
Stock Position:  7.326887399052493
Bond position:  [-730.20499595]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [5.84518206]
curr_Stock_Price:  100.48369955571115
curr_Factors:  [100.48369956  -1.10799658  -1.04105263]
mat_Sqrt:  [[11.71589314  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00137773  0.01214244 -0.13164832]
Stock Position:  0.0013777308130107225
Bond Position:  [5.70674257]


portfolio before change:  [5.84602953]
curr_Stock_Price:  100.06315863213146
curr_Factors:  [100.06315863  -1.34801062  -1.04212215]
mat_Sqrt:  [[ 9.16753835  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.29286462 -0.86299169 -2.16899098]
Stock Position:  -0.2928646165681524
Bond Position:  [35.15098812]


portfolio before change:  [5.78888936]
curr_Stock_Price:  100.28827635815881
curr_Factors:  [100.28827636  -1.65700116  -1.03094677]
mat_Sqrt:  [[ 6.82164655  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.02154919  0.08737777 -0.1309305 ]
Stock Position:  0.021549193238526995
Bond Position:  [3.62775792]


portfolio before change:  [5.79179774]
curr_Stock_Price:  100.38114878384306
curr_Factors:  [100.38114878  -1.02416091  -1.05303285]
mat_Sqrt:  [[12.57587966  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.03231507  0.00845129 -1.04593582]
Stock Position:  0.03231507120211208
Bond Position:  [2.54797377]


portfolio before change:  [5.78456048]
curr_Stock_Price:  100.13747508398784
curr_Factors:  [100.13747508  -1.24005713  -1.02049169]
mat_Sqrt:  [[10.44366081  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0059778  -0.01725142  0.03798292]
Stock Position:  -0.005977804070176698
Bond Position:  [6.38316269]


portfolio before change:  [5.78546346]
curr_Stock_Price:  100.25340573676678
curr_Factors:  [100.25340574  -1.1764798   -1.01401824]
mat_Sqrt:  [[11.21444859  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00170805 0.0086807  0.14613393]
Stock Position:  0.0017080510963568103
Bond Position:  [5.61422552]


portfolio before change:  [5.78693148]
curr_Stock_Price:  100.29104591690603
curr_Factors:  [100.29104592  -1.01060815  -1.00713648]
mat_Sqrt:  [[13.33419491  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01064656 0.06686846 0.24730884]
Stock Position:  0.010646563332736367
Bond Position:  [4.71917651]


portfolio before change:  [5.78560471]
curr_Stock_Price:  100.05559766229818
curr_Factors:  [100.05559766  -1.2158125   -1.00108843]
mat_Sqrt:  [[10.90067892  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00358934 -0.00916311 -0.08617463]
Stock Position:  0.0035893433852244093
Bond Position:  [5.42647081]


portfolio before change:  [5.79107839]
curr_Stock_Price:  101.20257328208623
curr_Factors:  [101.20257328  -1.08673125  -0.98538114]
mat_Sqrt:  [[12.7433784   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.09541006 -0.1464307  -0.11653752]
Stock Position:  -0.0954100567816926
Bond Position:  [15.44682165]


portfolio before change:  [5.91331855]
curr_Stock_Price:  99.96184480402854
curr_Factors:  [99.9618448  -0.60270682 -0.98847981]
mat_Sqrt:  [[20.36060548  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01372753  0.0096297  -0.19161024]
Stock Position:  0.013727529956945279
Bond Position:  [4.54108933]


portfolio before change:  [5.93417266]
curr_Stock_Price:  101.39827941323661
curr_Factors:  [101.39827941  -0.6155427   -0.98915041]
mat_Sqrt:  [[20.3761075   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0038578  -0.01187903  0.09349812]
Stock Position:  -0.003857797572846559
Bond Position:  [6.3253467]


portfolio before change:  [5.93245296]
curr_Stock_Price:  102.25401068781672
curr_Factors:  [102.25401069  -0.33962483  -0.97343107]
mat_Sqrt:  [[27.50599872  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.03075645 -0.29572289  0.70563373]
Stock Position:  -0.030756449592505918
Bond Position:  [9.07742328]


portfolio before change:  [6.02765888]
curr_Stock_Price:  99.2323265296995
curr_Factors:  [99.23232653 -0.15690018 -0.94743159]
mat_Sqrt:  [[32.88879648  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.0022006  0.01680178 0.2490471 ]
Stock Position:  0.0022005977440863905
Bond Position:  [5.80928844]


portfolio before change:  [6.02635352]
curr_Stock_Price:  97.97909417827096
curr_Factors:  [97.97909418 -0.35965434 -0.97430883]
mat_Sqrt:  [[25.81074707  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00308297  0.04124065 -0.29226253]
Stock Position:  0.0030829746642562898
Bond Position:  [5.72428645]


portfolio before change:  [6.02566747]
curr_Stock_Price:  97.29232113832501
curr_Factors:  [97.29232114 -0.3042678  -0.96884275]
mat_Sqrt:  [[27.23790376  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00288101  0.02843668  0.3747831 ]
Stock Position:  -0.0028810063743768344
Bond Position:  [6.30596726]


portfolio before change:  [6.02300101]
curr_Stock_Price:  98.76511952675601
curr_Factors:  [98.76511953 -0.26350568 -1.01213064]
mat_Sqrt:  [[27.58047735  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00497979 0.03585525 0.25376516]
Stock Position:  0.004979792530585393
Bond Position:  [5.53117121]


portfolio before change:  [6.00621152]
curr_Stock_Price:  95.11587867808635
curr_Factors:  [ 9.51158787e+01  8.10169426e-02 -9.61829469e-01]
mat_Sqrt:  [[39.42039799  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00266197 -0.00382208 -0.06233506]
Stock Position:  0.0026619703129921158
Bond Position:  [5.75301587]


portfolio before change:  [5.99491164]
curr_Stock_Price:  90.33058541168752
curr_Factors:  [ 9.03305854e+01  5.48357193e-02 -9.48189932e-01]
mat_Sqrt:  [[36.97055922  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00439157 -0.15505176  0.41569421]
Stock Position:  -0.004391571948040114
Bond Position:  [6.39160491]


portfolio before change:  [6.01945598]
curr_Stock_Price:  85.1055240884428
curr_Factors:  [ 8.51055241e+01  5.55727048e-02 -9.23857439e-01]
mat_Sqrt:  [[35.71630161  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00118112 -0.04669055 -0.21868804]
Stock Position:  -0.0011811204458946538
Bond Position:  [6.11997585]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [6.02007795]
Stock Price:  85.87446094929331
PL:  [6.02007795]
Settle:  Tensor("sub_108:0", shape=(), dtype=float64)
PL:  Tensor("sub_109:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  55
output_Z_Vals[:, i, :]:  [[ 1.19271183e+02 -4.92738716e+01 -4.92570741e+01]
 [ 2.34428179e-02  4.65564192e-02 -4.35676417e-02]
 [-2.12533782e+00 -2.86256845e+00 -8.14906890e-01]
 [ 3.12359309e-02  1.18948485e-01 -8.53308813e-02]
 [ 4.96704913e-01 -7.36655322e-02 -2.85065359e-01]
 [ 7.57175145e-02  1.17192732e-01 -6.73936232e-03]
 [ 4.87462360e-03  2.34294059e-02  7.57477762e-02]
 [ 6.06352729e-02  1.82130550e-01  9.64516407e-02]
 [ 1.20939736e-02 -1.28792161e-01  3.60908953e-03]
 [-1.27874509e+00 -5.18934877e-01 -4.92358699e-02]
 [ 1.98387700e-01  1.07136802e-02  4.77873447e-02]
 [-1.91519869e-01  3.71625076e-02  2.62329569e-02]
 [-7.71603000e-01 -9.19129785e-01  2.72774343e-01]
 [-8.97651139e-03 -2.27779709e-02 -1.17075839e-02]
 [-1.04982063e-01 -1.00849001e-01  1.24960917e-02]
 [ 6.01453342e-02  3.40443180e-02  6.56921853e-02]
 [ 5.47633513e-02  4.24431736e-02  2.57273121e-02]
 [ 5.86241810e-02 -5.78438437e-02  5.30878595e-02]
 [ 3.05482174e-02  6.32048499e-02  9.90755216e-03]
 [ 3.88021109e-02 -4.23562375e-01 -2.62567498e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.27118322 -49.27387164 -49.25707411]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [   7.3268874   -15.90307369 -140.51672192]
init_Out:  [2.48374395]
Stock Position:  7.326887399052493
Bond position:  [-730.20499595]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [3.20015073]
curr_Stock_Price:  100.12269614638957
curr_Factors:  [100.12269615  -0.94077178  -0.9909349 ]
mat_Sqrt:  [[14.50784762  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00165792  0.01502602 -0.12428635]
Stock Position:  0.0016579233630791192
Bond Position:  [3.03415497]


portfolio before change:  [3.20156006]
curr_Stock_Price:  100.51517359734022
curr_Factors:  [100.5151736   -1.11844557  -1.00032624]
mat_Sqrt:  [[12.07982718  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.23808282 -0.92388999 -2.32470253]
Stock Position:  -0.23808282061500277
Bond Position:  [27.13249611]


portfolio before change:  [3.48292776]
curr_Stock_Price:  99.36186181564209
curr_Factors:  [99.36186182 -0.92748705 -0.98744527]
mat_Sqrt:  [[14.64114971  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00260212  0.03839046 -0.24342525]
Stock Position:  0.002602124583662649
Bond Position:  [3.22437581]


portfolio before change:  [3.48363112]
curr_Stock_Price:  99.32234575550046
curr_Factors:  [99.32234576 -0.97592968 -1.00218342]
mat_Sqrt:  [[13.73926058  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.03082257 -0.02377545 -0.81321212]
Stock Position:  0.03082256674264084
Bond Position:  [0.42226149]


portfolio before change:  [3.51933236]
curr_Stock_Price:  100.4772028627829
curr_Factors:  [100.47720286  -0.8295227   -0.99794014]
mat_Sqrt:  [[16.15885209  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00608111  0.03782379 -0.01922552]
Stock Position:  0.006081107346211751
Bond Position:  [2.90831971]


portfolio before change:  [3.5147172]
curr_Stock_Price:  99.59868934168443
curr_Factors:  [99.59868934 -0.60842406 -1.02162644]
mat_Sqrt:  [[19.51334334  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00128728 0.00756181 0.21608732]
Stock Position:  0.0012872771565307782
Bond Position:  [3.38650608]


portfolio before change:  [3.51803317]
curr_Stock_Price:  101.51687509269422
curr_Factors:  [101.51687509  -1.0129941   -0.98331112]
mat_Sqrt:  [[13.78967086  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00852092 0.05878238 0.27514968]
Stock Position:  0.008520915806569497
Bond Position:  [2.65301642]


portfolio before change:  [3.52138187]
curr_Stock_Price:  101.83202537341451
curr_Factors:  [101.83202537  -0.8942981   -0.9887193 ]
mat_Sqrt:  [[15.49174402  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00086878 -0.04156749  0.01029573]
Stock Position:  -0.0008687797684401469
Bond Position:  [3.60985148]


portfolio before change:  [3.52142852]
curr_Stock_Price:  102.81723087010604
curr_Factors:  [102.81723087  -0.82909356  -0.97400106]
mat_Sqrt:  [[16.94306045  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.08231821 -0.16748551 -0.14045623]
Stock Position:  -0.082318213002012
Bond Position:  [11.98515923]


portfolio before change:  [3.3864672]
curr_Stock_Price:  104.49314172513184
curr_Factors:  [104.49314173  -0.47856105  -1.03165978]
mat_Sqrt:  [[23.07848074  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00911365 0.00345783 0.13632399]
Stock Position:  0.009113648945510732
Bond Position:  [2.43415339]


portfolio before change:  [3.3924286]
curr_Stock_Price:  105.0804792730502
curr_Factors:  [105.08047927  -0.60838247  -1.0427519 ]
mat_Sqrt:  [[20.1578171   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00885906  0.01199415  0.07483532]
Stock Position:  -0.008859060619717299
Bond Position:  [4.32334294]


portfolio before change:  [3.40170504]
curr_Stock_Price:  104.15538481307301
curr_Factors:  [104.15538481  -0.19283256  -1.06086835]
mat_Sqrt:  [[29.73078255  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.03039072 -0.29664786  0.77814928]
Stock Position:  -0.03039071542637758
Bond Position:  [6.5670617]


portfolio before change:  [3.41670545]
curr_Stock_Price:  103.71582842659761
curr_Factors:  [103.71582843  -0.37640266  -1.05609874]
mat_Sqrt:  [[24.75811568  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00064689 -0.00735156 -0.03339848]
Stock Position:  -0.0006468927595171355
Bond Position:  [3.48379846]


portfolio before change:  [3.41808671]
curr_Stock_Price:  102.92713435626418
curr_Factors:  [102.92713436  -0.4128106   -1.05137158]
mat_Sqrt:  [[23.80365471  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00516799 -0.03254888  0.03564787]
Stock Position:  -0.005167988969116726
Bond Position:  [3.950013]


portfolio before change:  [3.42625815]
curr_Stock_Price:  101.53707365073319
curr_Factors:  [101.53707365  -0.53378017  -1.04958022]
mat_Sqrt:  [[20.84394703  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00386222 0.01098776 0.18740152]
Stock Position:  0.0038622225702224563
Bond Position:  [3.03409937]


portfolio before change:  [3.43267232]
curr_Stock_Price:  103.00139844818018
curr_Factors:  [103.00139845  -0.4706274   -1.05500419]
mat_Sqrt:  [[22.40112031  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00306586 0.01369848 0.07339286]
Stock Position:  0.003065855299139105
Bond Position:  [3.11688494]


portfolio before change:  [3.4321546]
curr_Stock_Price:  102.57833996063495
curr_Factors:  [102.57833996  -0.32798963  -1.06240538]
mat_Sqrt:  [[25.53964081  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00225741 -0.01866902  0.15144489]
Stock Position:  0.0022574072271443917
Bond Position:  [3.20059351]


portfolio before change:  [3.43538279]
curr_Stock_Price:  103.65388469088334
curr_Factors:  [103.65388469  -0.2213882   -1.07625742]
mat_Sqrt:  [[28.31556631  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00160591 0.02039928 0.02826349]
Stock Position:  0.0016059090427654277
Bond Position:  [3.26892408]


portfolio before change:  [3.4377113]
curr_Stock_Price:  104.59489278211683
curr_Factors:  [104.59489278  -0.31363943  -1.16332799]
mat_Sqrt:  [[23.88205398  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00423973 -0.13670417 -0.74903199]
Stock Position:  -0.0042397342789489674
Bond Position:  [3.88116585]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [3.44367067]
Stock Price:  103.41817812313666
PL:  [0.02549255]
Settle:  Tensor("sub_110:0", shape=(), dtype=float64)
PL:  Tensor("sub_111:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  56
output_Z_Vals[:, i, :]:  [[ 1.19271183e+02 -4.92738716e+01 -4.92570741e+01]
 [ 7.00837491e-03  1.51949624e-02 -5.54082179e-02]
 [-3.08233408e+00 -3.12248008e+00 -1.00092736e+00]
 [-4.93233429e-02 -2.08244346e-03 -1.32752460e-01]
 [ 8.35142690e-01 -1.38197422e-01 -3.86550748e-01]
 [ 5.67744677e-02  8.95627661e-02 -3.15373458e-03]
 [ 9.05734282e-03  2.59525895e-02  6.76235901e-02]
 [ 1.99574193e-02  4.47953430e-02 -8.42093906e-03]
 [ 1.90322587e-02 -1.10927414e-01 -2.40807599e-03]
 [-9.44886349e-01 -3.84783677e-01 -3.21775478e-02]
 [ 3.69825690e-01  4.89293039e-02 -2.77505320e-02]
 [ 5.74967781e-02 -6.09716362e-02  3.76540713e-02]
 [-6.88815344e-01 -1.21062035e+00  2.42928868e-01]
 [ 2.93201775e-04  1.77102325e-02  4.66652963e-02]
 [ 1.28145158e-01  1.19497981e-01 -1.06551212e-01]
 [ 1.06470588e-01  1.03457370e-02  2.47407105e-02]
 [ 1.27569237e-02  1.30576471e-03 -1.52054528e-02]
 [ 3.42243475e-02 -5.70783162e-02  1.56427018e-01]
 [ 2.11390320e-02 -8.85992306e-03  2.06726599e-02]
 [ 1.37532236e-01 -1.06313905e+00 -5.92220873e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.27118322 -49.27387164 -49.25707411]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [   7.3268874   -15.90307369 -140.51672192]
init_Out:  [2.48374395]
Stock Position:  7.326887399052493
Bond position:  [-730.20499595]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [3.7689136]
curr_Stock_Price:  100.20032295343977
curr_Factors:  [100.20032295  -0.56431073  -0.98176374]
mat_Sqrt:  [[21.35096496  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-5.62092382e-05  4.90415304e-03 -1.58064223e-01]
Stock Position:  -5.620923819223229e-05
Bond Position:  [3.77454579]


portfolio before change:  [3.77005873]
curr_Stock_Price:  96.61779483178
curr_Factors:  [96.61779483 -0.42285348 -0.96521568]
mat_Sqrt:  [[24.11161734  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.162744   -1.00777611 -2.85536716]
Stock Position:  -0.16274400211071388
Bond Position:  [19.49402534]


portfolio before change:  [3.60994169]
curr_Stock_Price:  97.63160273189247
curr_Factors:  [97.63160273 -0.86527047 -0.93213042]
mat_Sqrt:  [[16.18039544  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00474935 -0.00067211 -0.37870582]
Stock Position:  -0.004749352547989293
Bond Position:  [4.07362859]


portfolio before change:  [3.60220786]
curr_Stock_Price:  99.47445647218686
curr_Factors:  [99.47445647 -0.75173847 -0.90813759]
mat_Sqrt:  [[18.91631603  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.03848682 -0.04460303 -1.10272169]
Stock Position:  0.038486823586192126
Bond Position:  [-0.22624799]


portfolio before change:  [3.65783722]
curr_Stock_Price:  100.92133943866047
curr_Factors:  [100.92133944  -1.20376327  -0.95336632]
mat_Sqrt:  [[11.67222174  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00637519  0.02890626 -0.00899673]
Stock Position:  0.006375190520471766
Bond Position:  [3.01444446]


portfolio before change:  [3.65793377]
curr_Stock_Price:  100.81825937078683
curr_Factors:  [100.81825937  -1.40932939  -0.92519889]
mat_Sqrt:  [[ 9.7648696   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00288365 0.00837616 0.19291128]
Stock Position:  0.0028836535106495508
Bond Position:  [3.36720885]


portfolio before change:  [3.65833633]
curr_Stock_Price:  100.66590000718072
curr_Factors:  [100.66590001  -1.38675657  -0.88647393]
mat_Sqrt:  [[10.36647052  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00264143  0.01445763 -0.0240226 ]
Stock Position:  0.0026414306969497117
Bond Position:  [3.39243433]


portfolio before change:  [3.6595258]
curr_Stock_Price:  100.79509343050042
curr_Factors:  [100.79509343  -1.43190566  -0.90925152]
mat_Sqrt:  [[ 9.69812432  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00042299 -0.03580167 -0.00686957]
Stock Position:  -0.0004229943068805053
Bond Position:  [3.70216155]


portfolio before change:  [3.66088142]
curr_Stock_Price:  99.77860889593319
curr_Factors:  [99.7786089  -1.35855646 -0.92045939]
mat_Sqrt:  [[10.2158248   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.10082379 -0.1241884  -0.09179359]
Stock Position:  -0.10082379277139789
Bond Position:  [13.72093921]


portfolio before change:  [3.57878244]
curr_Stock_Price:  100.62691702290418
curr_Factors:  [100.62691702  -1.26680732  -0.90357031]
mat_Sqrt:  [[11.48500373  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.03257716  0.01579186 -0.07916454]
Stock Position:  0.03257715866177119
Bond Position:  [0.3006434]


portfolio before change:  [3.56748243]
curr_Stock_Price:  100.27774026152112
curr_Factors:  [100.27774026  -1.46097281  -0.9497963 ]
mat_Sqrt:  [[ 8.9995505   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00585997 -0.01967851  0.10741658]
Stock Position:  0.005859970462186926
Bond Position:  [2.97985783]


portfolio before change:  [3.57171077]
curr_Stock_Price:  100.87216045140171
curr_Factors:  [100.87216045  -1.56725249  -0.97194866]
mat_Sqrt:  [[ 7.96178185  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.1113249  -0.39072604  0.69300844]
Stock Position:  -0.11132489646451868
Bond Position:  [14.80129359]


portfolio before change:  [3.57434086]
curr_Stock_Price:  100.8817782135054
curr_Factors:  [100.88177821  -1.29288057  -0.9740887 ]
mat_Sqrt:  [[10.45395159  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00128505 0.00571595 0.1331231 ]
Stock Position:  0.0012850453209788477
Bond Position:  [3.4447032]


portfolio before change:  [3.57617213]
curr_Stock_Price:  101.6366063345646
curr_Factors:  [101.63660633  -1.52918816  -0.98705279]
mat_Sqrt:  [[ 8.20843939  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01593335  0.03856781 -0.30396095]
Stock Position:  0.015933346189008546
Bond Position:  [1.9567609]


portfolio before change:  [3.58006484]
curr_Stock_Price:  101.85021217452969
curr_Factors:  [101.85021217  -1.75551717  -0.95708371]
mat_Sqrt:  [[ 6.75918517  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01681158 0.00333907 0.07057836]
Stock Position:  0.01681157951750549
Bond Position:  [1.8678019]


portfolio before change:  [3.58694759]
curr_Stock_Price:  102.2318387432728
curr_Factors:  [102.23183874  -2.17639279  -0.91411244]
mat_Sqrt:  [[ 4.64939885  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00213354  0.00042143 -0.04337692]
Stock Position:  0.002133536416914087
Bond Position:  [3.36883224]


portfolio before change:  [3.58901954]
curr_Stock_Price:  102.80817607175976
curr_Factors:  [102.80817607  -2.39555887  -0.92642524]
mat_Sqrt:  [[ 3.70943945  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01469328 -0.01842195  0.44624274]
Stock Position:  0.01469327563104766
Bond Position:  [2.07843067]


portfolio before change:  [3.59196]
curr_Stock_Price:  102.97293049839884
curr_Factors:  [102.9729305   -2.00931328  -0.93670889]
mat_Sqrt:  [[ 5.41105437  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00435226 -0.00285953  0.05897334]
Stock Position:  0.004352256548205642
Bond Position:  [3.14379539]


portfolio before change:  [3.5905857]
curr_Stock_Price:  102.47655706468491
curr_Factors:  [102.47655706  -1.91668244  -0.91563201]
mat_Sqrt:  [[ 6.03345381  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.03320929 -0.34312665 -1.68944131]
Stock Position:  -0.03320928618928434
Bond Position:  [6.99375901]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [3.60801305]
Stock Price:  102.0044392746434
PL:  [1.60357378]
Settle:  Tensor("sub_112:0", shape=(), dtype=float64)
PL:  Tensor("sub_113:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  57
output_Z_Vals[:, i, :]:  [[ 1.19271183e+02 -4.92738716e+01 -4.92570741e+01]
 [-3.01619377e-03 -7.56396726e-03 -6.57154788e-02]
 [-2.20673790e+00 -2.97111755e+00 -8.46308138e-01]
 [ 4.23872954e-02  2.50949787e-01 -2.17705586e-02]
 [ 8.22810604e-01  2.72541522e-02 -5.22682390e-01]
 [-7.12896116e-03 -6.81841438e-03  9.86866290e-03]
 [ 1.45464095e-02  2.19656310e-02  1.02262670e-01]
 [ 1.06453929e-01  2.67154507e-01  1.33318116e-01]
 [ 6.93511064e-02  1.86339185e-02 -4.60466456e-02]
 [-1.21888730e+00 -4.86327603e-01 -4.63593289e-02]
 [ 3.63186391e-01  9.67947508e-02  7.03098590e-02]
 [-2.09025484e-01  4.89305520e-03  2.72728773e-02]
 [-7.97963203e-01 -9.96335008e-01  2.83605173e-01]
 [-1.03884465e-02 -3.14595516e-02 -2.10738478e-02]
 [-4.97318720e-02 -5.23249758e-03 -4.04600966e-02]
 [ 1.19224679e-01  1.81423907e-02  3.77204846e-02]
 [-4.63757199e-02 -5.66035572e-02 -7.28266965e-02]
 [-2.56999667e-02 -1.14081119e-01  2.37403720e-01]
 [-1.14034603e-02 -2.49716357e-03 -3.85256630e-03]
 [ 5.78639029e-02 -5.27647906e-01 -3.98358715e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.27118322 -49.27387164 -49.25707411]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [   7.3268874   -15.90307369 -140.51672192]
init_Out:  [2.48374395]
Stock Position:  7.326887399052493
Bond position:  [-730.20499595]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [9.53696159]
curr_Stock_Price:  100.98756693168708
curr_Factors:  [100.98756693  -0.41875676  -1.01404808]
mat_Sqrt:  [[24.09953546  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00074584 -0.00244126 -0.18746797]
Stock Position:  -0.000745835872783144
Bond Position:  [9.61228174]


portfolio before change:  [9.53913577]
curr_Stock_Price:  101.29486022593234
curr_Factors:  [101.29486023  -0.89412303  -1.04649926]
mat_Sqrt:  [[14.54741599  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.20525753 -0.95892407 -2.41428155]
Stock Position:  -0.20525752902972091
Bond Position:  [30.33066848]


portfolio before change:  [9.58107727]
curr_Stock_Price:  101.12747108714076
curr_Factors:  [101.12747109  -0.82799201  -1.01466045]
mat_Sqrt:  [[16.01826048  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00556667  0.0809937  -0.06210534]
Stock Position:  0.005566666214268891
Bond Position:  [9.01813439]


portfolio before change:  [9.58727452]
curr_Stock_Price:  101.83569356408093
curr_Factors:  [101.83569356  -0.65588146  -1.03838616]
mat_Sqrt:  [[18.7106532   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.03857063  0.00879624 -1.49106737]
Stock Position:  0.038570633020411194
Bond Position:  [5.65940735]


portfolio before change:  [9.52139976]
curr_Stock_Price:  100.09110759200209
curr_Factors:  [100.09110759  -1.114134    -1.00357099]
mat_Sqrt:  [[12.04170287  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00054032 -0.00220063  0.02815255]
Stock Position:  -0.0005403165862627532
Bond Position:  [9.57548065]


portfolio before change:  [9.5235198]
curr_Stock_Price:  100.59846669218376
curr_Factors:  [100.59846669  -0.94350644  -0.96919942]
mat_Sqrt:  [[14.85640608  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00268601 0.00708938 0.29172693]
Stock Position:  0.0026860066337160275
Bond Position:  [9.25331165]


portfolio before change:  [9.5215984]
curr_Stock_Price:  99.02177105649719
curr_Factors:  [99.02177106 -0.67979157 -0.96382237]
mat_Sqrt:  [[19.13895532  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00983335 0.08622375 0.38031948]
Stock Position:  0.009833350777496622
Bond Position:  [8.54788259]


portfolio before change:  [9.53905708]
curr_Stock_Price:  100.57988110241905
curr_Factors:  [100.5798811   -1.05625883  -1.00453629]
mat_Sqrt:  [[12.8091163   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00497735  0.00601407 -0.13135826]
Stock Position:  0.004977354056494152
Bond Position:  [9.0384354]


portfolio before change:  [9.54920699]
curr_Stock_Price:  102.16506383199844
curr_Factors:  [102.16506383  -1.12986205  -1.02158013]
mat_Sqrt:  [[11.883461    0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.11172011 -0.15696156 -0.13225026]
Stock Position:  -0.11172010939109699
Bond Position:  [20.96309909]


portfolio before change:  [9.47293722]
curr_Stock_Price:  102.89466567946731
curr_Factors:  [102.89466568  -0.92110987  -1.06522618]
mat_Sqrt:  [[14.11685893  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.0281434  0.03124037 0.20057446]
Stock Position:  0.02814340487464547
Bond Position:  [6.57713098]


portfolio before change:  [9.49832202]
curr_Stock_Price:  103.73821367719452
curr_Factors:  [103.73821368  -0.83000976  -1.03814493]
mat_Sqrt:  [[16.01804434  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01263947  0.00157923  0.07780193]
Stock Position:  -0.012639473119311939
Bond Position:  [10.80951838]


portfolio before change:  [9.49454503]
curr_Stock_Price:  104.25086996983624
curr_Factors:  [104.25086997  -0.67375454  -1.05925552]
mat_Sqrt:  [[18.42650557  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.05120062 -0.32156574  0.80904662]
Stock Position:  -0.05120062332951272
Bond Position:  [14.83225456]


portfolio before change:  [9.48934718]
curr_Stock_Price:  104.42482053294201
curr_Factors:  [104.42482053  -0.78378943  -1.08804253]
mat_Sqrt:  [[16.0648784   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00131416 -0.01015353 -0.06011782]
Stock Position:  -0.001314157584387362
Bond Position:  [9.62657785]


portfolio before change:  [9.49097464]
curr_Stock_Price:  105.01796272705344
curr_Factors:  [105.01796273  -1.01160668  -1.10646046]
mat_Sqrt:  [[12.62986524  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00467613 -0.00168878 -0.11542139]
Stock Position:  -0.004676125407153699
Bond Position:  [9.98205181]


portfolio before change:  [9.49121776]
curr_Stock_Price:  105.49970956671632
curr_Factors:  [105.49970957  -0.96173242  -1.10588576]
mat_Sqrt:  [[13.34430924  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00978901 0.00585543 0.10760604]
Stock Position:  0.009789014809719563
Bond Position:  [8.45847954]


portfolio before change:  [9.49531818]
curr_Stock_Price:  105.70254231907016
curr_Factors:  [105.70254232  -0.50273809  -1.09830227]
mat_Sqrt:  [[21.3187846   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00341462 -0.01826872 -0.20775429]
Stock Position:  -0.003414620540082162
Bond Position:  [9.85625225]


portfolio before change:  [9.50205694]
curr_Stock_Price:  104.45075165134217
curr_Factors:  [104.45075165  -0.4356891   -1.11112742]
mat_Sqrt:  [[22.24014905  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-2.36889674e-05 -3.68195228e-02  6.77246732e-01]
Stock Position:  -2.368896740029089e-05
Bond Position:  [9.50453127]


portfolio before change:  [9.50448187]
curr_Stock_Price:  102.40330205378986
curr_Factors:  [102.40330205  -0.68088776  -1.0896824 ]
mat_Sqrt:  [[17.43271827  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00072849 -0.00080596 -0.0109903 ]
Stock Position:  -0.0007284918668137467
Bond Position:  [9.57908184]


portfolio before change:  [9.50666223]
curr_Stock_Price:  102.69803125712663
curr_Factors:  [102.69803126  -0.68124885  -1.08841409]
mat_Sqrt:  [[17.4987598   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00749518 -0.17029763 -1.13640653]
Stock Position:  -0.007495183013113831
Bond Position:  [10.27640277]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [9.50977148]
Stock Price:  102.62600790064704
PL:  [6.88376358]
Settle:  Tensor("sub_114:0", shape=(), dtype=float64)
PL:  Tensor("sub_115:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  58
output_Z_Vals[:, i, :]:  [[ 1.19271183e+02 -4.92738716e+01 -4.92570741e+01]
 [ 1.77587713e-01  2.92689167e-01 -2.23978714e-02]
 [-2.26395807e+00 -2.99061047e+00 -8.58649428e-01]
 [ 8.78552182e-02  2.41009057e-01 -5.43584906e-02]
 [ 9.95956981e-01  1.68585886e-02 -5.93426033e-01]
 [ 6.09498154e-02  1.60953191e-01  1.05545752e-02]
 [ 1.26035325e-01 -2.52903043e-01 -2.56731781e-01]
 [-1.09959937e-01  1.37542263e-01  3.62566288e-01]
 [-1.21307519e-01 -4.54996010e-01  1.33118068e-01]
 [-1.77014650e+00 -6.60838851e-01 -7.38198701e-02]
 [ 8.29546771e-02 -8.53177897e-02  2.28862224e-02]
 [-8.91679252e-02  1.09556488e-01  2.27156909e-02]
 [-8.87756956e-01 -1.11169400e+00  3.22665270e-01]
 [ 1.10445979e-02 -5.88162289e-02  8.72834740e-03]
 [-1.39599301e-01 -1.60757921e-01  4.56760126e-02]
 [ 8.59028106e-02  5.69834684e-03  1.72320953e-02]
 [-9.98839918e-02 -1.09004863e-01 -1.24967325e-01]
 [-6.46008677e-02 -1.70298516e-01  2.34552198e-01]
 [ 6.69519933e-02 -1.42585555e-01  1.43671842e-01]
 [ 1.20567057e-01 -1.02377833e+00 -2.73827197e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.27118322 -49.27387164 -49.25707411]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [   7.3268874   -15.90307369 -140.51672192]
init_Out:  [2.48374395]
Stock Position:  7.326887399052493
Bond position:  [-730.20499595]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-14.236269]
curr_Stock_Price:  97.74291073703516
curr_Factors:  [97.74291074 -1.19777769 -0.93652295]
mat_Sqrt:  [[11.56565615  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.02012516  0.09446502 -0.06389489]
Stock Position:  0.0201251610209462
Bond Position:  [-16.20336081]


portfolio before change:  [-14.20621833]
curr_Stock_Price:  99.43740706212223
curr_Factors:  [99.43740706 -1.03082849 -0.95167725]
mat_Sqrt:  [[13.69488805  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.22268783 -0.96521538 -2.44948781]
Stock Position:  -0.22268783422422941
Bond Position:  [7.93728249]


portfolio before change:  [-14.43545533]
curr_Stock_Price:  100.47572857707821
curr_Factors:  [100.47572858  -0.56640842  -0.93643774]
mat_Sqrt:  [[22.35544767  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0056342   0.07778534 -0.15506964]
Stock Position:  0.005634201891302791
Bond Position:  [-15.00155587]


portfolio before change:  [-14.42847503]
curr_Stock_Price:  102.38037464859806
curr_Factors:  [102.38037465  -0.5250822   -1.01104438]
mat_Sqrt:  [[22.03359785  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.03986029  0.00544109 -1.69287929]
Stock Position:  0.039860292019367
Bond Position:  [-18.50938666]


portfolio before change:  [-14.24918596]
curr_Stock_Price:  106.9944150648148
curr_Factors:  [106.99441506  -0.92446417  -1.03149659]
mat_Sqrt:  [[15.1320632   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00634141 0.05194742 0.03010927]
Stock Position:  0.006341414934562371
Bond Position:  [-14.92768194]


portfolio before change:  [-14.25590619]
curr_Stock_Price:  106.52325098727458
curr_Factors:  [106.52325099  -1.02022064  -0.96979197]
mat_Sqrt:  [[14.56105744  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00151133 -0.08162411 -0.73238431]
Stock Position:  0.0015113292373010534
Bond Position:  [-14.4168979]


portfolio before change:  [-14.25835229]
curr_Stock_Price:  107.28984279595223
curr_Factors:  [107.2898428   -0.81702292  -1.01253717]
mat_Sqrt:  [[17.21831928  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-4.57402769e-04  4.43915745e-02  1.03430070e+00]
Stock Position:  -0.0004574027686838209
Bond Position:  [-14.20927762]


portfolio before change:  [-14.2619517]
curr_Stock_Price:  107.39182465963093
curr_Factors:  [107.39182466  -0.92491978  -0.99561068]
mat_Sqrt:  [[15.73603957  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01188422 -0.14684933  0.37974879]
Stock Position:  -0.011884221449039493
Bond Position:  [-12.98568348]


portfolio before change:  [-14.26143364]
curr_Stock_Price:  107.07502693428962
curr_Factors:  [107.07502693  -0.819611    -0.99994329]
mat_Sqrt:  [[17.35664592  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.11062668 -0.21328482 -0.21058754]
Stock Position:  -0.11062667839400774
Bond Position:  [-2.41607907]


portfolio before change:  [-14.23163245]
curr_Stock_Price:  106.80018108993228
curr_Factors:  [106.80018109  -0.37517067  -0.98356944]
mat_Sqrt:  [[27.44597466  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00255815 -0.0275362   0.06528802]
Stock Position:  0.0025581487876774004
Bond Position:  [-14.5048432]


portfolio before change:  [-14.23171881]
curr_Stock_Price:  108.18411284827611
curr_Factors:  [108.18411285  -0.82221719  -0.95994576]
mat_Sqrt:  [[18.20455013  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00341497  0.0353592   0.06480154]
Stock Position:  -0.003414969295085937
Bond Position:  [-13.86227339]


portfolio before change:  [-14.23398712]
curr_Stock_Price:  107.83339334323522
curr_Factors:  [107.83339334  -0.67963914  -0.96132631]
mat_Sqrt:  [[20.89734118  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.05018901 -0.3587977   0.9204742 ]
Stock Position:  -0.05018900548633248
Bond Position:  [-8.82193634]


portfolio before change:  [-14.26244087]
curr_Stock_Price:  108.35637640551025
curr_Factors:  [108.35637641  -0.86809924  -0.95408399]
mat_Sqrt:  [[17.51823522  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 4.68341640e-05 -1.89828562e-02  2.48995456e-02]
Stock Position:  4.683416396545491e-05
Bond Position:  [-14.26751565]


portfolio before change:  [-14.26601011]
curr_Stock_Price:  108.31563137908545
curr_Factors:  [108.31563138  -1.13930063  -0.94547348]
mat_Sqrt:  [[13.46744605  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01210996 -0.0518844   0.13030095]
Stock Position:  -0.012109964745595794
Bond Position:  [-12.95431163]


portfolio before change:  [-14.25719812]
curr_Stock_Price:  107.32050254830939
curr_Factors:  [107.32050255  -1.28901438  -0.90455788]
mat_Sqrt:  [[11.96813195  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00756872 0.00183913 0.04915837]
Stock Position:  0.0075687223346152036
Bond Position:  [-15.0694772]


portfolio before change:  [-14.26988885]
curr_Stock_Price:  106.1415863139037
curr_Factors:  [106.14158631  -1.42931612  -0.92584343]
mat_Sqrt:  [[10.07054039  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01466092 -0.03518117 -0.35649699]
Stock Position:  -0.01466091777894169
Bond Position:  [-12.71375578]


portfolio before change:  [-14.28514773]
curr_Stock_Price:  106.9655487187471
curr_Factors:  [106.96554872  -1.95157892  -0.89831367]
mat_Sqrt:  [[ 6.18801418  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00832014 -0.05496361  0.66911213]
Stock Position:  -0.008320139276414526
Bond Position:  [-13.39517946]


portfolio before change:  [-14.29105003]
curr_Stock_Price:  107.27240503165967
curr_Factors:  [107.27240503  -1.705467    -0.9031816 ]
mat_Sqrt:  [[ 7.89889474  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00850419 -0.04601929  0.40985577]
Stock Position:  0.008504193680825398
Bond Position:  [-15.20331534]


portfolio before change:  [-14.28545557]
curr_Stock_Price:  108.37724377895513
curr_Factors:  [108.37724378  -1.57926828  -0.91724615]
mat_Sqrt:  [[ 8.92720807  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01616469 -0.33042304 -0.78115277]
Stock Position:  -0.01616469127672749
Bond Position:  [-12.53357088]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-14.27225375]
Stock Price:  107.36667067016229
PL:  [-21.63892442]
Settle:  Tensor("sub_116:0", shape=(), dtype=float64)
PL:  Tensor("sub_117:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  59
output_Z_Vals[:, i, :]:  [[ 1.19271183e+02 -4.92738716e+01 -4.92570741e+01]
 [ 6.16777124e-02  1.07985079e-01 -2.58241899e-02]
 [-2.31206639e+00 -3.14347008e+00 -8.97475799e-01]
 [-3.04484848e-02  3.80973399e-02 -1.21684708e-01]
 [ 5.70748951e-01 -5.98091782e-02 -3.42466611e-01]
 [-7.35756076e-02 -1.08389307e-01  2.38046705e-02]
 [-4.63464195e-02  8.04080432e-02 -7.79503911e-02]
 [ 7.57931357e-02  1.33903296e-01  1.26155092e-02]
 [-7.50748994e-02  1.65838801e-01 -3.25115065e-02]
 [-6.95645762e-01 -2.69322468e-01 -1.97682158e-02]
 [-8.73798752e-03 -5.33450596e-02 -3.33437547e-01]
 [ 1.12352727e-01  3.38778116e-02  1.95784531e-02]
 [-6.37007486e-01 -1.24716629e+00  2.21655426e-01]
 [ 5.34796993e-02  6.46451101e-02  1.49531052e-01]
 [ 1.25449225e-01  1.29579964e-01 -1.04898593e-01]
 [-9.36851160e-02  7.71818568e-02  1.20835237e-01]
 [ 9.94784716e-02  1.14403138e-01  1.19127398e-01]
 [ 1.15216134e-01 -1.08333916e-02 -3.18137274e-02]
 [-6.03396206e-02 -2.08362599e-01  3.48989122e-02]
 [ 8.57403655e-02 -6.57521957e-01 -6.55602877e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.27118322 -49.27387164 -49.25707411]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [   7.3268874   -15.90307369 -140.51672192]
init_Out:  [2.48374395]
Stock Position:  7.326887399052493
Bond position:  [-730.20499595]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-4.15157757]
curr_Stock_Price:  99.11930577021596
curr_Factors:  [99.11930577 -1.12420386 -0.99542509]
mat_Sqrt:  [[11.901867    0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0065913   0.03485203 -0.07366923]
Stock Position:  0.006591296448338562
Bond Position:  [-4.8049023]


portfolio before change:  [-4.15091375]
curr_Stock_Price:  99.40228492390261
curr_Factors:  [99.40228492 -0.81886391 -1.0010608 ]
mat_Sqrt:  [[16.10694264  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.19475583 -1.01455061 -2.56024865]
Stock Position:  -0.19475583193437737
Bond Position:  [15.20826095]


portfolio before change:  [-4.07053313]
curr_Stock_Price:  99.00908450455263
curr_Factors:  [99.0090845  -0.63884036 -1.01471993]
mat_Sqrt:  [[18.9471083   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00250754  0.01229586 -0.3471326 ]
Stock Position:  -0.0025075427901864794
Bond Position:  [-3.82226362]


portfolio before change:  [-4.07325319]
curr_Stock_Price:  99.71271014370433
curr_Factors:  [99.71271014 -0.77787832 -1.03496546]
mat_Sqrt:  [[16.27205754  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.03002907 -0.01930333 -0.97696192]
Stock Position:  0.030029069682840498
Bond Position:  [-7.06753311]


portfolio before change:  [-4.10177216]
curr_Stock_Price:  98.82184444104801
curr_Factors:  [98.82184444 -0.78324912 -0.99154969]
mat_Sqrt:  [[16.75203723  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00542271 -0.0349825   0.0679081 ]
Stock Position:  -0.005422706082531743
Bond Position:  [-3.56589035]


portfolio before change:  [-4.0934134]
curr_Stock_Price:  97.11598914181491
curr_Factors:  [97.11598914 -0.78943294 -0.99498926]
mat_Sqrt:  [[16.30519595  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00281167  0.02595158 -0.22237077]
Stock Position:  -0.0028116652789602434
Bond Position:  [-3.82035574]


portfolio before change:  [-4.09085676]
curr_Stock_Price:  95.8669616966805
curr_Factors:  [95.8669617  -0.86715495 -0.93670042]
mat_Sqrt:  [[15.78572489  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.006696   0.0432171  0.03598854]
Stock Position:  0.006695996690463163
Bond Position:  [-4.73278161]


portfolio before change:  [-4.09719767]
curr_Stock_Price:  95.09671483015572
curr_Factors:  [95.09671483 -1.05826422 -0.92880764]
mat_Sqrt:  [[13.03740534  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00367094  0.05352424 -0.09274628]
Stock Position:  -0.00367094357720376
Bond Position:  [-3.748103]


portfolio before change:  [-4.10103429]
curr_Stock_Price:  95.88655905126762
curr_Factors:  [95.88655905 -1.06772359 -0.97095246]
mat_Sqrt:  [[12.48452366  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.06044733 -0.08692345 -0.05639322]
Stock Position:  -0.0604473323423855
Bond Position:  [1.69505242]


portfolio before change:  [-4.0845453]
curr_Stock_Price:  95.62078772072309
curr_Factors:  [95.62078772 -1.13678305 -0.97933115]
mat_Sqrt:  [[11.52220497  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00761049 -0.01721704 -0.95120451]
Stock Position:  -0.007610492678918221
Bond Position:  [-3.356824]


portfolio before change:  [-4.08488491]
curr_Stock_Price:  95.55512808299441
curr_Factors:  [95.55512808 -0.8005127  -0.98961025]
mat_Sqrt:  [[15.95193895  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00772724 0.01093402 0.05585188]
Stock Position:  0.00772723879318838
Bond Position:  [-4.8232622]


portfolio before change:  [-4.06656956]
curr_Stock_Price:  98.08142797882827
curr_Factors:  [98.08142798 -1.06217255 -0.97863293]
mat_Sqrt:  [[12.74313317  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0664153  -0.40252119  0.63232123]
Stock Position:  -0.06641530023418638
Bond Position:  [2.44753793]


portfolio before change:  [-4.0184406]
curr_Stock_Price:  97.36597542706701
curr_Factors:  [97.36597543 -1.15915491 -0.95206338]
mat_Sqrt:  [[11.79008043  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00824407 0.02086412 0.42657047]
Stock Position:  0.008244068048281143
Bond Position:  [-4.82113233]


portfolio before change:  [-4.02433891]
curr_Stock_Price:  96.7967329916435
curr_Factors:  [96.79673299 -1.24329642 -0.96367795]
mat_Sqrt:  [[10.65084114  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01225136  0.04182175 -0.29924649]
Stock Position:  0.012251359978215493
Bond Position:  [-5.21023053]


portfolio before change:  [-4.00787667]
curr_Stock_Price:  98.24677269346087
curr_Factors:  [98.24677269 -1.30775092 -0.98460916]
mat_Sqrt:  [[ 9.92565008  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0053664   0.02491034  0.3447093 ]
Stock Position:  -0.005366403762225308
Bond Position:  [-3.48064482]


portfolio before change:  [-4.00809569]
curr_Stock_Price:  98.12541652749333
curr_Factors:  [98.12541653 -1.47927358 -1.01292352]
mat_Sqrt:  [[ 8.11771996  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01812673 0.03692345 0.33983731]
Stock Position:  0.018126726879818093
Bond Position:  [-5.78678832]


portfolio before change:  [-4.01933776]
curr_Stock_Price:  97.58504375201531
curr_Factors:  [97.58504375 -1.18217355 -0.99091189]
mat_Sqrt:  [[11.10770262  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00958892 -0.00349646 -0.09075571]
Stock Position:  0.009588916025876124
Bond Position:  [-4.95507255]


portfolio before change:  [-4.03146883]
curr_Stock_Price:  96.44913315253304
curr_Factors:  [96.44913315 -1.24434113 -0.98526441]
mat_Sqrt:  [[10.37511568  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0092286  -0.06724874  0.09955688]
Stock Position:  -0.009228595643454084
Bond Position:  [-3.14137878]


portfolio before change:  [-4.02848867]
curr_Stock_Price:  96.0410959816503
curr_Factors:  [96.04109598 -1.22192145 -0.99822245]
mat_Sqrt:  [[10.42943704  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01747938 -0.2122143  -1.87025252]
Stock Position:  -0.0174793824531079
Bond Position:  [-2.34974962]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-4.02821901]
Stock Price:  95.99205740313653
PL:  [-4.02821901]
Settle:  Tensor("sub_118:0", shape=(), dtype=float64)
PL:  Tensor("sub_119:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  60
output_Z_Vals[:, i, :]:  [[ 1.19271183e+02 -4.92738716e+01 -4.92570741e+01]
 [-4.46444561e-03 -4.57285190e-03 -6.18674432e-02]
 [-2.34441575e+00 -3.17018212e+00 -9.04528780e-01]
 [-6.30718767e-03  6.59563307e-02 -1.04316459e-01]
 [ 6.17476583e-01  1.20188961e-02 -4.25173024e-01]
 [ 3.94289050e-02  1.16705789e-01 -1.28630369e-02]
 [ 1.83904148e-02  2.67331413e-02  1.08356291e-01]
 [ 7.10520817e-02  1.55411218e-01  4.63198459e-02]
 [ 9.62675769e-02  1.06860683e-01 -7.85396393e-02]
 [-9.42734135e-01 -3.85287536e-01 -3.20384878e-02]
 [ 1.02832977e-01 -3.23558306e-02 -1.89688042e-01]
 [ 1.87354872e-02 -7.24262011e-02  3.69001253e-02]
 [-6.20863326e-01 -1.30917645e+00  2.19075892e-01]
 [ 2.04574501e-02  3.58940179e-02  8.62439655e-02]
 [ 1.26030894e-01  1.17730219e-01 -1.06268498e-01]
 [-1.50683323e-02  5.42889950e-02  1.01302840e-01]
 [ 1.15408610e-01  1.01858339e-01  8.50364349e-02]
 [ 9.03773132e-02 -1.82714980e-02  3.78121729e-02]
 [-4.03580535e-02  9.65697275e-03 -5.28014260e-02]
 [ 9.28608189e-02 -7.31085771e-01 -6.15271202e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.27118322 -49.27387164 -49.25707411]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [   7.3268874   -15.90307369 -140.51672192]
init_Out:  [2.48374395]
Stock Position:  7.326887399052493
Bond position:  [-730.20499595]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [7.65481493]
curr_Stock_Price:  100.73068477234068
curr_Factors:  [100.73068477  -0.7568505   -0.94804876]
mat_Sqrt:  [[18.31190152  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00098442 -0.00147588 -0.17649059]
Stock Position:  -0.0009844151925939926
Bond Position:  [7.75397575]


portfolio before change:  [7.65793218]
curr_Stock_Price:  99.53351994135828
curr_Factors:  [99.53351994 -0.83179372 -0.94331335]
mat_Sqrt:  [[16.86747829  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.18830098 -1.02317188 -2.58036884]
Stock Position:  -0.1883009763481453
Bond Position:  [26.40019116]


portfolio before change:  [7.77691218]
curr_Stock_Price:  98.93671405211735
curr_Factors:  [98.93671405 -0.83303013 -0.96419352]
mat_Sqrt:  [[16.39959677  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00086206  0.02128731 -0.29758582]
Stock Position:  -0.0008620587606220556
Bond Position:  [7.86220144]


portfolio before change:  [7.77731529]
curr_Stock_Price:  100.74945723973855
curr_Factors:  [100.74945724  -1.24905935  -0.94679207]
mat_Sqrt:  [[11.20976632  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.04756048  0.00387908 -1.21290029]
Stock Position:  0.047560478534398654
Bond Position:  [2.98562289]


portfolio before change:  [7.81023743]
curr_Stock_Price:  101.42597797721795
curr_Factors:  [101.42597798  -1.34270371  -0.94691909]
mat_Sqrt:  [[10.2749249   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00590036  0.03766663 -0.03669466]
Stock Position:  0.005900356304673647
Bond Position:  [7.21178803]


portfolio before change:  [7.81122067]
curr_Stock_Price:  101.28701448617421
curr_Factors:  [101.28701449  -1.02004793  -0.93956225]
mat_Sqrt:  [[14.27269167  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00322052 0.00862808 0.30911034]
Stock Position:  0.003220515848273592
Bond Position:  [7.48502424]


portfolio before change:  [7.81101018]
curr_Stock_Price:  100.64053829254708
curr_Factors:  [100.64053829  -1.10092604  -0.94939185]
mat_Sqrt:  [[12.95183203  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.0086652  0.05015875 0.13213763]
Stock Position:  0.008665203685341726
Bond Position:  [6.93893941]


portfolio before change:  [7.80076258]
curr_Stock_Price:  99.25770309718932
curr_Factors:  [99.2577031  -0.66533056 -0.95840618]
mat_Sqrt:  [[19.56970644  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00521462  0.03448914 -0.22405173]
Stock Position:  0.005214620160833772
Bond Position:  [7.28317136]


portfolio before change:  [7.80312631]
curr_Stock_Price:  99.36177707115235
curr_Factors:  [99.36177707 -1.07076619 -0.93364034]
mat_Sqrt:  [[13.38802936  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.07677907 -0.12435102 -0.09139689]
Stock Position:  -0.07677907069973948
Bond Position:  [15.43203121]


portfolio before change:  [7.85962405]
curr_Stock_Price:  98.67618330255826
curr_Factors:  [98.6761833  -1.17517195 -0.94228119]
mat_Sqrt:  [[11.87446704  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00484304 -0.0104428  -0.54112719]
Stock Position:  0.004843035133926336
Bond Position:  [7.38173183]


portfolio before change:  [7.86415814]
curr_Stock_Price:  99.23129593772946
curr_Factors:  [99.23129594 -1.22934992 -0.96113739]
mat_Sqrt:  [[11.10023345  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00103455 -0.02337546  0.10526579]
Stock Position:  0.0010345509770279778
Bond Position:  [7.76149831]


portfolio before change:  [7.86606752]
curr_Stock_Price:  99.20109526981048
curr_Factors:  [99.20109527 -1.2511129  -0.96197588]
mat_Sqrt:  [[10.84886295  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.07773895 -0.42253488  0.62496254]
Stock Position:  -0.07773894603417937
Bond Position:  [15.57785611]


portfolio before change:  [7.84718565]
curr_Stock_Price:  99.4940863910283
curr_Factors:  [99.49408639 -1.32551138 -0.97617086]
mat_Sqrt:  [[ 9.95839556  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00455784 0.01158474 0.24603003]
Stock Position:  0.004557838783094882
Bond Position:  [7.39370764]


portfolio before change:  [7.85166066]
curr_Stock_Price:  100.07031470928207
curr_Factors:  [100.07031471  -1.38100356  -0.94813892]
mat_Sqrt:  [[ 9.74476877  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01317327  0.03799726 -0.30315444]
Stock Position:  0.01317327390173176
Bond Position:  [6.53340699]


portfolio before change:  [7.8479961]
curr_Stock_Price:  99.66812819162237
curr_Factors:  [99.66812819 -1.25507578 -0.928618  ]
mat_Sqrt:  [[11.22509805  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.001487   0.0175217  0.28898881]
Stock Position:  0.0014869997558712748
Bond Position:  [7.69978962]


portfolio before change:  [7.85079972]
curr_Stock_Price:  100.25886970593918
curr_Factors:  [100.25886971  -1.45240579  -0.94955675]
mat_Sqrt:  [[ 9.07744703  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01691647 0.03287464 0.24258528]
Stock Position:  0.01691646842039174
Bond Position:  [6.15477372]


portfolio before change:  [7.86344867]
curr_Stock_Price:  100.91563000520284
curr_Factors:  [100.91563001  -1.61970472  -0.96242425]
mat_Sqrt:  [[ 7.6305189   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01236692 -0.0058971   0.1078676 ]
Stock Position:  0.012366922615257027
Bond Position:  [6.61543289]


portfolio before change:  [7.86479216]
curr_Stock_Price:  100.89051635465718
curr_Factors:  [100.89051635  -1.29357229  -0.93985665]
mat_Sqrt:  [[10.81146341  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00454748  0.00311677 -0.15062777]
Stock Position:  -0.0045474767206484645
Bond Position:  [8.32358943]


portfolio before change:  [7.8684041]
curr_Stock_Price:  100.55389455994066
curr_Factors:  [100.55389456  -1.38739707  -0.93336065]
mat_Sqrt:  [[ 9.87430705  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01842794 -0.23595692 -1.75519748]
Stock Position:  -0.01842794096985396
Bond Position:  [9.72140533]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [7.86276541]
Stock Price:  100.99178081566973
PL:  [6.87098459]
Settle:  Tensor("sub_120:0", shape=(), dtype=float64)
PL:  Tensor("sub_121:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  61
output_Z_Vals[:, i, :]:  [[ 1.19271183e+02 -4.92738716e+01 -4.92570741e+01]
 [ 3.80413987e-03  1.00964032e-02 -5.68531958e-02]
 [-2.75333157e+00 -2.53947530e+00 -8.31210797e-01]
 [-3.96254070e-02  3.30342334e-02 -1.43632640e-01]
 [ 2.62143159e-01  1.01114742e-02 -2.33425160e-02]
 [-1.42807343e-01 -2.39856108e-01  1.71266965e-02]
 [-6.98241395e-02  1.22025315e-01 -1.27190771e-01]
 [ 6.19437945e-02  1.15441111e-01  6.83857171e-03]
 [ 1.99018317e-02  1.93402045e-01 -8.24523314e-02]
 [-6.13955631e-01 -2.17958493e-01 -1.59883953e-02]
 [-2.14874656e-02 -4.18447447e-02 -3.24315352e-01]
 [ 1.56441126e-02 -7.42438019e-03  2.37988355e-02]
 [-6.96790666e-01 -1.08620114e+00  2.34230885e-01]
 [ 1.34903963e-01  7.12497655e-02  1.15360032e-01]
 [ 1.33962474e-01  1.46871402e-01 -1.05570540e-01]
 [-2.87292753e-01  1.51046727e-01  1.15318291e-01]
 [-1.30285736e-02  1.18233462e-01  1.51456578e-01]
 [ 1.13375017e-01 -1.13792991e-02 -2.64229865e-02]
 [-6.88681355e-02 -3.39238865e-01  8.98891799e-02]
 [ 6.01121712e-02 -4.34652051e-01 -4.80249843e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.27118322 -49.27387164 -49.25707411]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [   7.3268874   -15.90307369 -140.51672192]
init_Out:  [2.48374395]
Stock Position:  7.326887399052493
Bond position:  [-730.20499595]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [6.56790643]
curr_Stock_Price:  100.58233958202953
curr_Factors:  [100.58233958  -0.78766199  -0.97705939]
mat_Sqrt:  [[17.22316555  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00033327  0.0032586  -0.16218634]
Stock Position:  -0.00033327499751337485
Bond Position:  [6.60142801]


portfolio before change:  [6.57065028]
curr_Stock_Price:  97.30189861628152
curr_Factors:  [97.30189862 -1.18858743 -0.93233087]
mat_Sqrt:  [[11.6685852   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.29492607 -0.81961213 -2.37121304]
Stock Position:  -0.29492607109148883
Bond Position:  [35.26751695]


portfolio before change:  [7.17090681]
curr_Stock_Price:  95.29651962962777
curr_Factors:  [95.29651963 -0.93099948 -0.94910717]
mat_Sqrt:  [[14.53975529  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00427801  0.01066175 -0.40974394]
Stock Position:  -0.004278009563490217
Bond Position:  [7.57858623]


portfolio before change:  [7.16934522]
curr_Stock_Price:  96.1044809613974
curr_Factors:  [96.10448096 -0.94386099 -0.95124686]
mat_Sqrt:  [[14.4447076   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01796107  0.00326346 -0.0665897 ]
Stock Position:  0.017961068562648928
Bond Position:  [5.44320605]


portfolio before change:  [7.17659233]
curr_Stock_Price:  96.43219723944273
curr_Factors:  [96.43219724 -0.81530595 -0.9695891 ]
mat_Sqrt:  [[16.18273758  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01163411 -0.07741323  0.0488577 ]
Stock Position:  -0.01163411275603557
Bond Position:  [8.29849539]


portfolio before change:  [7.18382263]
curr_Stock_Price:  95.98906797422613
curr_Factors:  [95.98906797 -0.71949855 -0.94582764]
mat_Sqrt:  [[18.1543122   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00390423  0.0393835  -0.36283987]
Stock Position:  -0.0039042257830027368
Bond Position:  [7.55858562]


portfolio before change:  [7.18889535]
curr_Stock_Price:  95.17383874462836
curr_Factors:  [95.17383874 -0.84026793 -0.89746626]
mat_Sqrt:  [[16.74284346  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00519052 0.03725846 0.01950854]
Stock Position:  0.0051905179937457736
Bond Position:  [6.69489383]


portfolio before change:  [7.20280731]
curr_Stock_Price:  97.53160487343528
curr_Factors:  [97.53160487 -0.70978549 -0.90056722]
mat_Sqrt:  [[19.48848483  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00218331  0.06242024 -0.23521355]
Stock Position:  0.0021833070925000404
Bond Position:  [6.98986587]


portfolio before change:  [7.19724813]
curr_Stock_Price:  94.18490907365579
curr_Factors:  [94.18490907 -0.58982746 -0.85197822]
mat_Sqrt:  [[22.27476193  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02970671 -0.0703458  -0.04561044]
Stock Position:  -0.029706707607073727
Bond Position:  [9.99517169]


portfolio before change:  [7.17508811]
curr_Stock_Price:  95.01499514834472
curr_Factors:  [95.01499515 -0.75947165 -0.84376109]
mat_Sqrt:  [[19.12128251  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00503259 -0.01350533 -0.92518143]
Stock Position:  -0.005032590377025479
Bond Position:  [7.65325966]


portfolio before change:  [7.16758342]
curr_Stock_Price:  96.88644538779124
curr_Factors:  [96.88644539 -0.60026166 -0.89299792]
mat_Sqrt:  [[21.76449654  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00087236 -0.00239621  0.06789145]
Stock Position:  0.0008723626678999579
Bond Position:  [7.08306331]


portfolio before change:  [7.16799549]
curr_Stock_Price:  95.32869461786676
curr_Factors:  [95.32869462 -0.7938951  -0.85565502]
mat_Sqrt:  [[18.3161052   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.04753731 -0.35056991  0.66819552]
Stock Position:  -0.0475373097509424
Bond Position:  [11.69966517]


portfolio before change:  [7.16767384]
curr_Stock_Price:  95.3969973427153
curr_Factors:  [95.39699734 -0.82058816 -0.90804179]
mat_Sqrt:  [[16.93558715  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01021491 0.02299576 0.32909006]
Stock Position:  0.01021491176979414
Bond Position:  [6.19320193]


portfolio before change:  [7.14413183]
curr_Stock_Price:  92.94073516396949
curr_Factors:  [92.94073516 -0.58485158 -0.84574649]
mat_Sqrt:  [[22.22824902  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00640595  0.04740254 -0.30116337]
Stock Position:  0.006405946618738423
Bond Position:  [6.54875845]


portfolio before change:  [7.15605676]
curr_Stock_Price:  94.54666969698222
curr_Factors:  [94.5466697  -0.65870088 -0.86573631]
mat_Sqrt:  [[20.5869296   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01131403  0.04875012  0.32897099]
Stock Position:  -0.011314034000120326
Bond Position:  [8.22576099]


portfolio before change:  [7.15930527]
curr_Stock_Price:  94.44133007320087
curr_Factors:  [94.44133007 -0.82424744 -0.8475948 ]
mat_Sqrt:  [[17.74558154  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00236801 0.03815969 0.43206346]
Stock Position:  0.002368007791742591
Bond Position:  [6.93566747]


portfolio before change:  [7.15761636]
curr_Stock_Price:  92.99579039356594
curr_Factors:  [92.99579039 -0.88233688 -0.84858735]
mat_Sqrt:  [[16.47147339  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00641465 -0.00367265 -0.07537743]
Stock Position:  0.006414645178536752
Bond Position:  [6.56108136]


portfolio before change:  [7.15810739]
curr_Stock_Price:  92.81659967759816
curr_Factors:  [92.81659968 -0.8222747  -0.84848519]
mat_Sqrt:  [[17.45918028  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0068598  -0.10948887  0.25642881]
Stock Position:  -0.006859796684038489
Bond Position:  [7.79481039]


portfolio before change:  [7.15178098]
curr_Stock_Price:  94.0229553749496
curr_Factors:  [94.02295537 -0.67346559 -0.8791504 ]
mat_Sqrt:  [[19.90404483  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0063626  -0.14028335 -1.37001913]
Stock Position:  -0.006362595984432757
Bond Position:  [7.75001106]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [7.14853696]
Stock Price:  94.83736635901289
PL:  [7.14853696]
Settle:  Tensor("sub_122:0", shape=(), dtype=float64)
PL:  Tensor("sub_123:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  62
output_Z_Vals[:, i, :]:  [[ 1.19271183e+02 -4.92738716e+01 -4.92570741e+01]
 [ 5.38443920e-02  9.53999688e-02 -2.94593547e-02]
 [-2.48969158e+00 -2.96742181e+00 -8.86030956e-01]
 [-5.65171540e-02  1.11250243e-02 -1.34509668e-01]
 [ 8.66863184e-01 -1.88909684e-01 -3.34777668e-01]
 [ 7.97175478e-02  1.54200838e-01  1.56905480e-02]
 [ 5.61952210e-03  2.37691477e-02  9.02791340e-02]
 [ 1.39272273e-01  3.63773325e-01  2.23502996e-01]
 [ 5.29392125e-02  1.39340478e-01 -8.66601863e-02]
 [-1.12699095e+00 -4.53121043e-01 -4.15848767e-02]
 [ 4.11757054e-01  8.89925041e-02  1.13609411e-02]
 [ 4.30487871e-02 -6.52412425e-02  3.73730433e-02]
 [-7.21946319e-01 -9.80665624e-01  2.53492341e-01]
 [-7.46007635e-03 -1.34138866e-02 -1.60781515e-03]
 [-9.14297532e-02 -7.73952457e-02 -4.93522473e-04]
 [ 1.27710131e-01  1.51449160e-02  3.24945653e-02]
 [-3.20708705e-02 -4.25946430e-02 -5.88874717e-02]
 [-3.28452187e-03 -9.76791779e-02  1.92919953e-01]
 [ 1.15323680e-02  1.33532050e-02  4.31644279e-03]
 [ 5.83464230e-02 -5.79612787e-01 -2.25810805e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.27118322 -49.27387164 -49.25707411]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [   7.3268874   -15.90307369 -140.51672192]
init_Out:  [2.48374395]
Stock Position:  7.326887399052493
Bond position:  [-730.20499595]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-1.94551413]
curr_Stock_Price:  99.42039726039317
curr_Factors:  [99.42039726 -1.14352095 -0.98049949]
mat_Sqrt:  [[11.88571028  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00566264  0.03079021 -0.08403934]
Stock Position:  0.005662637064152858
Bond Position:  [-2.50849575]


portfolio before change:  [-1.95117692]
curr_Stock_Price:  98.53113140027449
curr_Factors:  [98.5311314  -0.89494871 -0.98716805]
mat_Sqrt:  [[15.00308415  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.21837339 -0.95773127 -2.52759969]
Stock Position:  -0.21837338892750818
Bond Position:  [19.56540016]


portfolio before change:  [-1.70067995]
curr_Stock_Price:  97.40642930877831
curr_Factors:  [97.40642931 -0.65669552 -0.93607156]
mat_Sqrt:  [[19.80877735  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00412458  0.00359059 -0.38371864]
Stock Position:  -0.004124582632551181
Bond Position:  [-1.29891908]


portfolio before change:  [-1.70534511]
curr_Stock_Price:  98.45875175981561
curr_Factors:  [98.45875176 -0.37579186 -0.95103327]
mat_Sqrt:  [[26.12290632  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.02909194 -0.06097034 -0.9550275 ]
Stock Position:  0.029091937243377247
Bond Position:  [-4.56970094]


portfolio before change:  [-1.64391168]
curr_Stock_Price:  100.60972568042018
curr_Factors:  [100.60972568  -0.31373294  -0.99076999]
mat_Sqrt:  [[27.29615916  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00419094 0.04976811 0.04476077]
Stock Position:  0.004190936938196096
Bond Position:  [-2.0655607]


portfolio before change:  [-1.65028958]
curr_Stock_Price:  99.2111248530055
curr_Factors:  [99.21112485 -0.1447109  -1.01638055]
mat_Sqrt:  [[31.06738952  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00093022 0.00767146 0.25754124]
Stock Position:  0.0009302207410995279
Bond Position:  [-1.74257783]


portfolio before change:  [-1.65260273]
curr_Stock_Price:  97.1928485474697
curr_Factors:  [97.19284855 -0.21963035 -1.02971787]
mat_Sqrt:  [[27.86437278  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00930039 0.11740734 0.63759184]
Stock Position:  0.009300390591688598
Bond Position:  [-2.55653418]


portfolio before change:  [-1.63575401]
curr_Stock_Price:  99.0731921825983
curr_Factors:  [99.07319218 -0.54773241 -0.97865471]
mat_Sqrt:  [[21.53052672  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00295824  0.04497195 -0.24721739]
Stock Position:  0.002958243089541996
Bond Position:  [-1.9288366]


portfolio before change:  [-1.62951187]
curr_Stock_Price:  101.34630092119707
curr_Factors:  [101.34630092  -1.19872286  -0.99486537]
mat_Sqrt:  [[11.30172236  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.10865356 -0.14624419 -0.11863008]
Stock Position:  -0.10865356023654925
Bond Position:  [9.38212454]


portfolio before change:  [-1.61649321]
curr_Stock_Price:  101.24807276483678
curr_Factors:  [101.24807276  -1.13625672  -1.01128701]
mat_Sqrt:  [[11.82280076  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.03656    0.02872221 0.0324096 ]
Stock Position:  0.03656000163421224
Bond Position:  [-5.31812291]


portfolio before change:  [-1.62996914]
curr_Stock_Price:  100.91584544457048
curr_Factors:  [100.91584544  -1.27368394  -1.00409963]
mat_Sqrt:  [[10.3450008   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00361143 -0.02105652  0.10661489]
Stock Position:  0.0036114269589640033
Bond Position:  [-1.99441934]


portfolio before change:  [-1.6250474]
curr_Stock_Price:  102.41674755411073
curr_Factors:  [102.41674755  -0.6479706   -1.05930671]
mat_Sqrt:  [[18.57418922  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.04685965 -0.31650847  0.72314309]
Stock Position:  -0.04685964665785291
Bond Position:  [3.1741652]


portfolio before change:  [-1.6608431]
curr_Stock_Price:  103.19757573975215
curr_Factors:  [103.19757574  -0.43582763  -1.04932671]
mat_Sqrt:  [[23.37088522  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00045041 -0.00432931 -0.00458665]
Stock Position:  -0.00045040520678471226
Bond Position:  [-1.61436237]


portfolio before change:  [-1.66232842]
curr_Stock_Price:  105.59914660857976
curr_Factors:  [105.59914661  -0.92082616  -1.08657417]
mat_Sqrt:  [[14.18592048  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00756586 -0.02497921 -0.00140788]
Stock Position:  -0.007565863041164002
Bond Position:  [-0.86337974]


portfolio before change:  [-1.65848968]
curr_Stock_Price:  105.06323819340729
curr_Factors:  [105.06323819  -1.20656195  -1.09354904]
mat_Sqrt:  [[10.53234972  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.0130488  0.004888   0.09269795]
Stock Position:  0.013048797580802804
Bond Position:  [-3.02943861]


portfolio before change:  [-1.66381396]
curr_Stock_Price:  104.71325777413901
curr_Factors:  [104.71325777  -1.02632004  -1.11314591]
mat_Sqrt:  [[12.32660321  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00428227 -0.01374736 -0.16798957]
Stock Position:  -0.004282268157453827
Bond Position:  [-1.21540371]


portfolio before change:  [-1.66080435]
curr_Stock_Price:  103.93948679198527
curr_Factors:  [103.93948679  -0.97364297  -1.08424522]
mat_Sqrt:  [[13.27550589  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00121701 -0.03152582  0.55034693]
Stock Position:  0.0012170097440990138
Bond Position:  [-1.78729972]


portfolio before change:  [-1.66156225]
curr_Stock_Price:  103.6839264229446
curr_Factors:  [103.68392642  -0.78762861  -1.04699346]
mat_Sqrt:  [[16.55561027  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00091444 0.00430973 0.01231361]
Stock Position:  0.0009144434739506842
Bond Position:  [-1.75637534]


portfolio before change:  [-1.65923972]
curr_Stock_Price:  106.70399667355564
curr_Factors:  [106.70399667  -0.65200124  -1.06874705]
mat_Sqrt:  [[19.09278136  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00555498 -0.18706922 -0.64417537]
Stock Position:  -0.005554977932422869
Bond Position:  [-1.06650137]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-1.66277145]
Stock Price:  107.29177051926996
PL:  [-8.95454197]
Settle:  Tensor("sub_124:0", shape=(), dtype=float64)
PL:  Tensor("sub_125:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  63
output_Z_Vals[:, i, :]:  [[ 1.19271183e+02 -4.92738716e+01 -4.92570741e+01]
 [ 4.28753856e-02  7.77770257e-02 -3.45496796e-02]
 [-2.48303211e+00 -3.00005337e+00 -8.92236780e-01]
 [-6.03457608e-02  2.50956795e-02 -1.37182700e-01]
 [ 3.49081139e-01  8.46055581e-03 -5.84305313e-02]
 [-1.30674102e-01 -1.72602854e-01 -4.01155209e-02]
 [-7.74744459e-02  1.24873727e-01 -1.64045137e-01]
 [ 8.17213138e-02  1.51610910e-01  2.24239884e-02]
 [-2.80487231e-02  2.66553876e-01 -8.91685440e-02]
 [-8.39037014e-01 -3.43185788e-01 -2.67493712e-02]
 [ 6.34667431e-02 -3.61939832e-02 -2.77125323e-01]
 [ 8.62853304e-03 -6.61247082e-02  3.50133151e-02]
 [-5.98884406e-01 -1.22359622e+00  2.14541929e-01]
 [ 4.37932966e-02  5.62115641e-02  1.30967077e-01]
 [ 9.71443368e-02  1.20240785e-01 -1.03503288e-01]
 [-6.26064282e-02  6.70844542e-02  1.23810222e-01]
 [ 1.54614589e-02  3.95434912e-03 -1.25700442e-02]
 [ 4.56703672e-02 -6.82311748e-02  7.63987671e-02]
 [-4.40794551e-02 -4.62944381e-02 -2.56893324e-02]
 [ 4.43606634e-02 -3.44535103e-01 -3.67519061e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.27118322 -49.27387164 -49.25707411]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [   7.3268874   -15.90307369 -140.51672192]
init_Out:  [2.48374395]
Stock Position:  7.326887399052493
Bond position:  [-730.20499595]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-3.63273174]
curr_Stock_Price:  99.19011971996328
curr_Factors:  [99.19011972 -0.73431172 -1.0045792 ]
mat_Sqrt:  [[17.42920914  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00296624  0.02510243 -0.09856062]
Stock Position:  0.0029662350261678533
Bond Position:  [-3.92695294]


portfolio before change:  [-3.63555851]
curr_Stock_Price:  98.56814933238037
curr_Factors:  [98.56814933 -0.86271434 -0.99280389]
mat_Sqrt:  [[15.41328726  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.21264396 -0.96826306 -2.54530318]
Stock Position:  -0.21264396456857063
Bond Position:  [17.32436355]


portfolio before change:  [-3.40593125]
curr_Stock_Price:  97.50865240871654
curr_Factors:  [97.50865241 -0.55179328 -1.00884738]
mat_Sqrt:  [[20.47696216  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00406434  0.0080996  -0.39134406]
Stock Position:  -0.004064344480678995
Bond Position:  [-3.0096225]


portfolio before change:  [-3.39816304]
curr_Stock_Price:  95.41219920468784
curr_Factors:  [95.4121992  -0.66898083 -0.97753479]
mat_Sqrt:  [[18.38786301  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01842961  0.00273063 -0.16668604]
Stock Position:  0.01842960544914831
Bond Position:  [-5.15657223]


portfolio before change:  [-3.3927472]
curr_Stock_Price:  95.77602402370165
curr_Factors:  [95.77602402 -0.89348106 -1.00353106]
mat_Sqrt:  [[14.36795329  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0121169  -0.05570733 -0.11443842]
Stock Position:  -0.012116900364711306
Bond Position:  [-2.23223866]


portfolio before change:  [-3.39760182]
curr_Stock_Price:  96.13061061584226
curr_Factors:  [96.13061062 -1.03015089 -1.00626905]
mat_Sqrt:  [[12.5445694   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00681333  0.04030282 -0.46797511]
Stock Position:  -0.006813328843815371
Bond Position:  [-2.74263236]


portfolio before change:  [-3.39988886]
curr_Stock_Price:  96.36563505077659
curr_Factors:  [96.36563505 -0.92197494 -1.02675214]
mat_Sqrt:  [[13.72779448  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00854078 0.04893221 0.0639694 ]
Stock Position:  0.008540777535386268
Bond Position:  [-4.22292631]


portfolio before change:  [-3.39545773]
curr_Stock_Price:  97.00808217462271
curr_Factors:  [97.00808217 -0.66048972 -0.97850075]
mat_Sqrt:  [[18.83663841  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00043319  0.08602989 -0.25437304]
Stock Position:  0.00043319333727631724
Bond Position:  [-3.43748098]


portfolio before change:  [-3.3960029]
curr_Stock_Price:  97.73363695684456
curr_Factors:  [97.73363696 -0.86194182 -0.97153098]
mat_Sqrt:  [[15.62344996  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.05853699 -0.11076274 -0.07630851]
Stock Position:  -0.05853698859889594
Bond Position:  [2.32502989]


portfolio before change:  [-3.34734928]
curr_Stock_Price:  96.91240769078392
curr_Factors:  [96.91240769 -0.57533625 -1.00491271]
mat_Sqrt:  [[19.95657362  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-2.45178568e-05 -1.16815578e-02 -7.90561409e-01]
Stock Position:  -2.451785684732832e-05
Bond Position:  [-3.34497319]


portfolio before change:  [-3.34823843]
curr_Stock_Price:  99.06591970740224
curr_Factors:  [99.06591971 -0.60253404 -0.96208485]
mat_Sqrt:  [[20.72139194  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00010993 -0.02134166  0.09988324]
Stock Position:  0.00010993211902354474
Bond Position:  [-3.35912895]


portfolio before change:  [-3.34896127]
curr_Stock_Price:  100.13061225561036
curr_Factors:  [100.13061226  -0.76540615  -0.97626294]
mat_Sqrt:  [[17.54565547  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.04587214 -0.39491398  0.61202841]
Stock Position:  -0.04587213919935114
Bond Position:  [1.24424411]


portfolio before change:  [-3.25872147]
curr_Stock_Price:  98.17019140468517
curr_Factors:  [98.1701914  -0.84236172 -0.95885535]
mat_Sqrt:  [[16.20768553  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00505939 0.0181422  0.37361262]
Stock Position:  0.005059388435120689
Bond Position:  [-3.7554026]


portfolio before change:  [-3.26089219]
curr_Stock_Price:  97.9267324302692
curr_Factors:  [97.92673243 -0.99705436 -0.96538621]
mat_Sqrt:  [[13.76018122  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00730811  0.03880755 -0.29526607]
Stock Position:  0.007308106083730393
Bond Position:  [-3.97655114]


portfolio before change:  [-3.25685415]
curr_Stock_Price:  98.61532534311259
curr_Factors:  [98.61532534 -0.60204943 -0.96103372]
mat_Sqrt:  [[20.65884431  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00114431  0.02165141  0.3531961 ]
Stock Position:  -0.0011443145236632302
Bond Position:  [-3.1440072]


portfolio before change:  [-3.2634829]
curr_Stock_Price:  103.72113605964094
curr_Factors:  [103.72113606  -0.79544247  -0.96309953]
mat_Sqrt:  [[17.87072535  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00076677  0.00127626 -0.03585884]
Stock Position:  0.0007667728780374408
Bond Position:  [-3.34301345]


portfolio before change:  [-3.26494457]
curr_Stock_Price:  102.90497153816858
curr_Factors:  [102.90497154  -0.52375402  -0.95987639]
mat_Sqrt:  [[23.34016144  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00202816 -0.02202152  0.21794442]
Stock Position:  0.002028159491737095
Bond Position:  [-3.47365226]


portfolio before change:  [-3.27181168]
curr_Stock_Price:  99.94732076249196
curr_Factors:  [99.94732076 -0.3678865  -0.94018881]
mat_Sqrt:  [[27.01974635  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00217519 -0.01494147 -0.07328451]
Stock Position:  -0.0021751899522131184
Bond Position:  [-3.05440727]


portfolio before change:  [-3.26914255]
curr_Stock_Price:  98.36914806214014
curr_Factors:  [98.36914806 -0.23691809 -0.96838293]
mat_Sqrt:  [[29.47157384  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00342658 -0.11119823 -1.04842958]
Stock Position:  -0.0034265826722672944
Bond Position:  [-2.93207253]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-3.26719964]
Stock Price:  97.58818905565565
PL:  [-3.26719964]
Settle:  Tensor("sub_126:0", shape=(), dtype=float64)
PL:  Tensor("sub_127:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  64
output_Z_Vals[:, i, :]:  [[ 1.19271183e+02 -4.92738716e+01 -4.92570741e+01]
 [-5.97027474e-03 -5.03444734e-03 -6.09022439e-02]
 [-2.02477627e+00 -2.65012495e+00 -7.60087658e-01]
 [-1.45085714e-03  6.51228021e-02 -1.04519574e-01]
 [ 4.32199654e-01 -1.33046858e-01 -1.75532969e-01]
 [-1.47712969e-01 -2.65014257e-01  6.90733664e-02]
 [-1.32604579e-02  3.20430975e-02 -1.03987432e-02]
 [-5.89486731e-04  7.46246549e-04 -1.44327531e-02]
 [ 4.20249186e-02 -5.17257473e-02 -2.23482541e-02]
 [-1.08919409e+00 -4.27504320e-01 -3.98753616e-02]
 [ 2.47359693e-01  2.77554153e-03 -1.06161028e-01]
 [ 4.26415146e-02 -6.53615979e-02  3.73651215e-02]
 [-5.96446792e-01 -1.24970131e+00  2.12005016e-01]
 [ 2.45323245e-02  3.94418408e-02  9.40534557e-02]
 [ 1.11678338e-01  1.24145761e-01 -1.05163646e-01]
 [-4.73006044e-02  6.29647047e-02  1.16563528e-01]
 [ 1.00043776e-01  1.11903472e-01  9.92630855e-02]
 [ 1.09935622e-01 -1.24146668e-02 -1.70118810e-02]
 [-4.59493701e-02 -1.19221131e-01  1.73521767e-02]
 [ 6.14641702e-02 -5.44403213e-01 -4.31629339e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.27118322 -49.27387164 -49.25707411]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [   7.3268874   -15.90307369 -140.51672192]
init_Out:  [2.48374395]
Stock Position:  7.326887399052493
Bond position:  [-730.20499595]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [11.44074505]
curr_Stock_Price:  101.24740215958914
curr_Factors:  [101.24740216  -1.17452168  -1.02558013]
mat_Sqrt:  [[11.21738982  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00173209 -0.00162486 -0.17373715]
Stock Position:  -0.0017320914922388268
Bond Position:  [11.61611481]


portfolio before change:  [11.44656416]
curr_Stock_Price:  99.56462519150573
curr_Factors:  [99.56462519 -1.39528675 -1.02185424]
mat_Sqrt:  [[ 8.87879586  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.3064473  -0.85532415 -2.16831852]
Stock Position:  -0.30644729850605684
Bond Position:  [41.95787458]


portfolio before change:  [11.62223888]
curr_Stock_Price:  99.02559633606904
curr_Factors:  [99.02559634 -1.08680907 -1.04086308]
mat_Sqrt:  [[11.79535977  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00080478  0.02101829 -0.29816525]
Stock Position:  -0.0008047816800101587
Bond Position:  [11.70193286]


portfolio before change:  [11.62568938]
curr_Stock_Price:  98.3736828330988
curr_Factors:  [98.37368283 -0.77294476 -1.03605548]
mat_Sqrt:  [[16.11536357  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0229105  -0.04294069 -0.5007467 ]
Stock Position:  0.02291050146672709
Bond Position:  [9.37189897]


portfolio before change:  [11.63140535]
curr_Stock_Price:  98.52089503275253
curr_Factors:  [98.52089503 -1.11670031 -1.05411112]
mat_Sqrt:  [[11.23975698  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01670047 -0.08553298  0.19704709]
Stock Position:  -0.01670047098148564
Bond Position:  [13.2767507]


portfolio before change:  [11.62294249]
curr_Stock_Price:  99.22641149264618
curr_Factors:  [99.22641149 -1.13527031 -1.07214247]
mat_Sqrt:  [[10.91340054  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00081023  0.01034187 -0.02966472]
Stock Position:  -0.0008102261552749563
Bond Position:  [11.70333833]


portfolio before change:  [11.62385522]
curr_Stock_Price:  101.71148234520253
curr_Factors:  [101.71148235  -1.66361683  -1.07546563]
mat_Sqrt:  [[ 6.57357444  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00051467  0.00024085 -0.04117263]
Stock Position:  -0.0005146717678566633
Bond Position:  [11.67620325]


portfolio before change:  [11.62710775]
curr_Stock_Price:  101.06426156837921
curr_Factors:  [101.06426157  -1.11563186  -1.09792979]
mat_Sqrt:  [[11.04739788  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00243538 -0.01669441 -0.06375335]
Stock Position:  0.0024353813096313222
Bond Position:  [11.38097773]


portfolio before change:  [11.62920349]
curr_Stock_Price:  100.75636037072549
curr_Factors:  [100.75636037  -1.49795217  -1.08688181]
mat_Sqrt:  [[ 7.59789589  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.15591127 -0.13797643 -0.11375331]
Stock Position:  -0.1559112654639105
Bond Position:  [27.33825514]


portfolio before change:  [11.78118549]
curr_Stock_Price:  99.8254040537274
curr_Factors:  [99.82540405 -1.29819305 -1.07958388]
mat_Sqrt:  [[ 9.25946033  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.02443514  0.0008958  -0.30284786]
Stock Position:  0.02443514101831369
Bond Position:  [9.34193766]


portfolio before change:  [11.78608568]
curr_Stock_Price:  99.93035196788868
curr_Factors:  [99.93035197 -1.0366343  -1.09605502]
mat_Sqrt:  [[11.84355857  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00311788 -0.02109536  0.10659229]
Stock Position:  0.0031178769105545054
Bond Position:  [11.47451514]


portfolio before change:  [11.78751738]
curr_Stock_Price:  99.4693710429734
curr_Factors:  [99.46937104 -0.84900811 -1.06300231]
mat_Sqrt:  [[14.69988025  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.05498451 -0.40333936  0.6047913 ]
Stock Position:  -0.05498450646469995
Bond Position:  [17.25679166]


portfolio before change:  [11.78414852]
curr_Stock_Price:  99.60911231905271
curr_Factors:  [99.60911232 -0.90879404 -1.087076  ]
mat_Sqrt:  [[13.53641699  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00382538 0.0127298  0.26830833]
Stock Position:  0.003825379923682144
Bond Position:  [11.40310582]


portfolio before change:  [11.78755051]
curr_Stock_Price:  99.75311278729848
curr_Factors:  [99.75311279 -0.97401976 -1.1097528 ]
mat_Sqrt:  [[12.4152518   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00930735  0.04006787 -0.30000261]
Stock Position:  0.00930734610731914
Bond Position:  [10.85911376]


portfolio before change:  [11.777702]
curr_Stock_Price:  98.40325180397663
curr_Factors:  [98.4032518  -0.80609901 -1.12956406]
mat_Sqrt:  [[14.20239733  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00075019  0.02032177  0.3325233 ]
Stock Position:  -0.0007501942845203924
Bond Position:  [11.85152356]


portfolio before change:  [11.78047657]
curr_Stock_Price:  98.65476765615742
curr_Factors:  [98.65476766 -0.87707067 -1.11952498]
mat_Sqrt:  [[13.39700157  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01068508 0.03611669 0.28316995]
Stock Position:  0.010685075172746684
Bond Position:  [10.72634296]


portfolio before change:  [11.79178369]
curr_Stock_Price:  99.46198739416602
curr_Factors:  [99.46198739 -0.80303372 -1.15629702]
mat_Sqrt:  [[14.01943797  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0074132  -0.00400682 -0.04853016]
Stock Position:  0.007413203971368975
Bond Position:  [11.05445169]


portfolio before change:  [11.8006456]
curr_Stock_Price:  100.28456644350082
curr_Factors:  [100.28456644  -0.70753756  -1.24442549]
mat_Sqrt:  [[14.23991248  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00468706 -0.03847845  0.04950093]
Stock Position:  -0.004687057135624516
Bond Position:  [12.27068509]


portfolio before change:  [11.79531402]
curr_Stock_Price:  102.0766560215952
curr_Factors:  [102.07665602  -0.68450096  -1.22564218]
mat_Sqrt:  [[15.11338711  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0091156  -0.17570538 -1.23131836]
Stock Position:  -0.009115603221559998
Bond Position:  [12.72580432]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [11.7969303]
Stock Price:  102.24840229437397
PL:  [9.54852801]
Settle:  Tensor("sub_128:0", shape=(), dtype=float64)
PL:  Tensor("sub_129:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  65
output_Z_Vals[:, i, :]:  [[ 1.19271183e+02 -4.92738716e+01 -4.92570741e+01]
 [ 1.78700700e-02  1.21577513e-02 -9.00659592e-02]
 [-1.99099554e+00 -2.68341955e+00 -7.63082432e-01]
 [-3.60867396e-01 -2.32408455e-01  2.32759669e-01]
 [ 6.29659001e-01  2.15197166e-01 -5.90550696e-01]
 [ 5.11770137e-02  8.34119195e-02 -2.68215267e-03]
 [ 6.66940840e-02 -8.11536691e-02  1.49279326e-02]
 [-3.83748908e-02  3.89458215e-02  1.10340491e-01]
 [-5.17057187e-02 -2.93064069e-01  5.89388007e-02]
 [-1.41599138e+00 -5.60510322e-01 -5.60309581e-02]
 [ 4.30449626e-01  1.11817678e-01  7.52695974e-02]
 [ 9.61974941e-03 -5.65152555e-02  3.60708806e-02]
 [-6.38921999e-01 -1.21101763e+00  2.27454976e-01]
 [ 1.35061513e-02  2.97734634e-02  7.28201063e-02]
 [ 1.07140855e-01  1.18798185e-01 -1.04661295e-01]
 [-1.07497842e-01  8.03423549e-02  1.33066933e-01]
 [ 1.25539909e-01  1.15578973e-01  1.03380930e-01]
 [ 1.09091150e-01 -1.26675482e-02 -1.46447336e-02]
 [-4.98701967e-02 -8.76800295e-02 -1.49641799e-02]
 [ 6.17914208e-02 -5.38492183e-01 -4.54170567e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.27118322 -49.27387164 -49.25707411]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [   7.3268874   -15.90307369 -140.51672192]
init_Out:  [2.48374395]
Stock Position:  7.326887399052493
Bond position:  [-730.20499595]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [19.90101979]
curr_Stock_Price:  102.40209094965375
curr_Factors:  [102.40209095  -1.19898514  -1.02031757]
mat_Sqrt:  [[11.12955763  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 1.76747693e-04  3.92389737e-03 -2.56933112e-01]
Stock Position:  0.00017674769276935755
Bond Position:  [19.88292046]


portfolio before change:  [19.9062167]
curr_Stock_Price:  103.67822085504493
curr_Factors:  [103.67822086  -1.12263653  -1.04306971]
mat_Sqrt:  [[11.88866987  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.22664519 -0.86606994 -2.17686178]
Stock Position:  -0.22664518715668883
Bond Position:  [43.40438647]


portfolio before change:  [20.11283926]
curr_Stock_Price:  102.81444731971018
curr_Factors:  [102.81444732  -1.17853464  -1.03876407]
mat_Sqrt:  [[11.19679048  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.03222314 -0.07500951  0.66399855]
Stock Position:  -0.032223136237657296
Bond Position:  [23.42584321]


portfolio before change:  [20.11898134]
curr_Stock_Price:  102.8056063152898
curr_Factors:  [102.80560632  -1.29297637  -1.02091005]
mat_Sqrt:  [[10.16503069  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.05440616  0.06945459 -1.68467676]
Stock Position:  0.05440615969461446
Bond Position:  [14.52572311]


portfolio before change:  [20.15910405]
curr_Stock_Price:  103.47631751697695
curr_Factors:  [103.47631752  -1.39264864  -1.05495494]
mat_Sqrt:  [[ 8.95076667  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00755867  0.02692108 -0.00765143]
Stock Position:  0.007558671887069123
Bond Position:  [19.37696052]


portfolio before change:  [20.16440897]
curr_Stock_Price:  103.53718552270352
curr_Factors:  [103.53718552  -1.39042321  -1.0217262 ]
mat_Sqrt:  [[ 9.27925635  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00573061 -0.02619223  0.04258524]
Stock Position:  0.005730611387971377
Bond Position:  [19.5710776]


portfolio before change:  [20.1677575]
curr_Stock_Price:  103.26760598504309
curr_Factors:  [103.26760599  -1.15406783  -0.99898169]
mat_Sqrt:  [[11.99241313  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00065891  0.01256971  0.31477071]
Stock Position:  -0.0006589124086392448
Bond Position:  [20.23580181]


portfolio before change:  [20.17224721]
curr_Stock_Price:  104.13247302066304
curr_Factors:  [104.13247302  -1.16486418  -1.02018352]
mat_Sqrt:  [[11.71202589  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00849523 -0.09458602  0.16813599]
Stock Position:  -0.008495228743511163
Bond Position:  [21.05687639]


portfolio before change:  [20.17653619]
curr_Stock_Price:  104.24734888902405
curr_Factors:  [104.24734889  -1.02047733  -1.01015596]
mat_Sqrt:  [[13.68271209  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.11268543 -0.18090393 -0.15984073]
Stock Position:  -0.11268543338300972
Bond Position:  [31.92369388]


portfolio before change:  [20.3375137]
curr_Stock_Price:  102.88962605978776
curr_Factors:  [102.88962606  -1.18454238  -0.98575149]
mat_Sqrt:  [[11.74424055  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.0399037  0.036089   0.21472321]
Stock Position:  0.03990370034852118
Bond Position:  [16.23183689]


portfolio before change:  [20.27128997]
curr_Stock_Price:  101.12833083182501
curr_Factors:  [101.12833083  -1.16277683  -0.93724106]
mat_Sqrt:  [[12.38359263  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00043982 -0.01824022  0.10290018]
Stock Position:  0.0004398205765605717
Bond Position:  [20.22681165]


portfolio before change:  [20.27610304]
curr_Stock_Price:  100.57295125127223
curr_Factors:  [100.57295125  -1.09838094  -0.9676746 ]
mat_Sqrt:  [[12.74103398  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.06590445 -0.39085426  0.64886573]
Stock Position:  -0.0659044537010491
Bond Position:  [26.90430844]


portfolio before change:  [20.32326178]
curr_Stock_Price:  99.95945973865743
curr_Factors:  [99.95945974 -1.13775089 -0.92004452]
mat_Sqrt:  [[12.768348    0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00269792 0.00960934 0.20773549]
Stock Position:  0.002697919579565143
Bond Position:  [20.05357919]


portfolio before change:  [20.32547448]
curr_Stock_Price:  98.92113595940671
curr_Factors:  [98.92113596 -1.15333851 -0.86642274]
mat_Sqrt:  [[13.1255627   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00838261  0.03834195 -0.29856954]
Stock Position:  0.008382614788152287
Bond Position:  [19.49625671]


portfolio before change:  [20.32352511]
curr_Stock_Price:  98.10706508689867
curr_Factors:  [98.10706509 -0.91282573 -0.89577106]
mat_Sqrt:  [[16.0781723   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00397656  0.02593038  0.37960292]
Stock Position:  -0.003976562247895183
Bond Position:  [20.71365397]


portfolio before change:  [20.32128644]
curr_Stock_Price:  99.97242956460883
curr_Factors:  [99.97242956 -0.76187763 -0.90832449]
mat_Sqrt:  [[18.81571319  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00904749 0.03730295 0.29491702]
Stock Position:  0.009047486573797706
Bond Position:  [19.41678722]


portfolio before change:  [20.31841251]
curr_Stock_Price:  99.11818855441904
curr_Factors:  [99.11818855 -0.6945437  -0.871231  ]
mat_Sqrt:  [[20.70837611  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00499875 -0.00408843 -0.04177735]
Stock Position:  0.004998752824736637
Bond Position:  [19.82294518]


portfolio before change:  [20.32094387]
curr_Stock_Price:  98.63306811573729
curr_Factors:  [98.63306812 -0.90757892 -0.90191766]
mat_Sqrt:  [[16.14983772  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00438533 -0.02829861 -0.04268864]
Stock Position:  -0.004385329401775126
Bond Position:  [20.75348236]


portfolio before change:  [20.3144554]
curr_Stock_Price:  101.29592084713305
curr_Factors:  [101.29592085  -0.78944187  -0.91257076]
mat_Sqrt:  [[18.46788945  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00762594 -0.1737976  -1.29562221]
Stock Position:  -0.007625939872582145
Bond Position:  [21.086932]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [20.31196042]
Stock Price:  102.31446711657465
PL:  [17.9974933]
Settle:  Tensor("sub_130:0", shape=(), dtype=float64)
PL:  Tensor("sub_131:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  66
output_Z_Vals[:, i, :]:  [[ 1.19271183e+02 -4.92738716e+01 -4.92570741e+01]
 [ 3.46506019e-02  6.45629853e-02 -3.83665086e-02]
 [-2.39549902e+00 -3.26423833e+00 -9.32802150e-01]
 [-6.22463376e-02  1.72120031e-02 -1.34799677e-01]
 [ 1.90288194e-01  3.13277211e-03  2.66080310e-03]
 [-1.02768337e-01 -1.91544059e-02 -1.89196889e-01]
 [-1.00273340e-01  1.60117552e-01 -2.37769543e-01]
 [ 9.00500232e-02  2.18860601e-01  8.82401457e-02]
 [-8.44849959e-02  3.21793983e-01 -8.31994686e-02]
 [-6.78757013e-01 -2.52796185e-01 -1.91123398e-02]
 [-5.88111925e-02 -4.50936515e-02 -3.46053379e-01]
 [ 1.55720847e-01  5.22471262e-02  1.77091909e-02]
 [-7.10208798e-01 -1.06431318e+00  2.37531693e-01]
 [ 1.52121625e-01  7.75325335e-02  1.17839449e-01]
 [ 1.61702427e-01  1.45828838e-01 -1.06869604e-01]
 [-3.08544085e-01  1.56971087e-01  1.16138472e-01]
 [-3.39475726e-02  1.26439265e-01  1.73794432e-01]
 [ 1.15216134e-01 -1.08333916e-02 -3.18137274e-02]
 [-8.25829585e-02 -4.25716109e-01  1.27701694e-01]
 [ 7.14111835e-02 -5.35744746e-01 -5.63387747e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.27118322 -49.27387164 -49.25707411]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [   7.3268874   -15.90307369 -140.51672192]
init_Out:  [2.48374395]
Stock Position:  7.326887399052493
Bond position:  [-730.20499595]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-2.89792883]
curr_Stock_Price:  99.29040826950741
curr_Factors:  [99.29040827 -0.61514679 -0.99069596]
mat_Sqrt:  [[19.92960311  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00200696  0.02083761 -0.10944897]
Stock Position:  0.0020069609588204127
Bond Position:  [-3.0972008]


portfolio before change:  [-2.89863861]
curr_Stock_Price:  99.32260370749161
curr_Factors:  [99.32260371 -0.68880647 -0.97726201]
mat_Sqrt:  [[18.77084176  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.17325895 -1.05352839 -2.66102489]
Stock Position:  -0.1732589492488545
Bond Position:  [14.30989135]


portfolio before change:  [-2.6328784]
curr_Stock_Price:  97.8093641721666
curr_Factors:  [97.80936417 -0.53047902 -0.98043103]
mat_Sqrt:  [[21.58741005  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00399533  0.00555515 -0.38454596]
Stock Position:  -0.003995329723360139
Bond Position:  [-2.24209774]


portfolio before change:  [-2.62287889]
curr_Stock_Price:  95.16625355492566
curr_Factors:  [95.16625355 -1.03395606 -0.96270987]
mat_Sqrt:  [[12.92236431  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01481701 0.0010111  0.00759053]
Stock Position:  0.014817010089452166
Bond Position:  [-4.03295823]


portfolio before change:  [-2.62653205]
curr_Stock_Price:  94.98775671990897
curr_Factors:  [94.98775672 -1.19804636 -0.96058095]
mat_Sqrt:  [[10.96952196  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0132456  -0.00618206 -0.53972606]
Stock Position:  -0.013245596991611536
Bond Position:  [-1.3683625]


portfolio before change:  [-2.62304936]
curr_Stock_Price:  94.69899512362402
curr_Factors:  [94.69899512 -0.96095454 -0.96761856]
mat_Sqrt:  [[13.76501583  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00843617  0.05167772 -0.67829032]
Stock Position:  -0.008436168012953396
Bond Position:  [-1.82415273]


portfolio before change:  [-2.62878865]
curr_Stock_Price:  95.32525060576931
curr_Factors:  [95.32525061 -0.56215977 -0.9908691 ]
mat_Sqrt:  [[20.17140221  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00757194 0.07063696 0.25172457]
Stock Position:  0.007571942649178743
Bond Position:  [-3.35058598]


portfolio before change:  [-2.62617111]
curr_Stock_Price:  95.78157864402044
curr_Factors:  [95.78157864 -0.72420745 -0.97316196]
mat_Sqrt:  [[17.54380626  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00203959  0.10385856 -0.23734493]
Stock Position:  -0.00203958560121554
Bond Position:  [-2.43081639]


portfolio before change:  [-2.62522874]
curr_Stock_Price:  95.0215453216176
curr_Factors:  [95.02154532 -0.82991205 -0.99341085]
mat_Sqrt:  [[15.34486296  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.04785055 -0.08158962 -0.05452219]
Stock Position:  -0.04785054842114912
Bond Position:  [1.92160431]


portfolio before change:  [-2.59629414]
curr_Stock_Price:  94.42689929957714
curr_Factors:  [94.4268993  -0.99287599 -1.04178001]
mat_Sqrt:  [[12.34399837  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01123248 -0.01455391 -0.98719397]
Stock Position:  -0.011232482501114891
Bond Position:  [-1.53564565]


portfolio before change:  [-2.60130234]
curr_Stock_Price:  94.83858372516158
curr_Factors:  [94.83858373 -1.11999912 -1.08396016]
mat_Sqrt:  [[10.46689117  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01624175 0.01686269 0.05051939]
Stock Position:  0.016241749099876905
Bond Position:  [-4.14164682]


portfolio before change:  [-2.59287597]
curr_Stock_Price:  95.42115075076318
curr_Factors:  [95.42115075 -0.93265293 -1.05006923]
mat_Sqrt:  [[13.13891058  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.06689861 -0.3435056   0.6776118 ]
Stock Position:  -0.0668986105629186
Bond Position:  [3.79066643]


portfolio before change:  [-2.57662217]
curr_Stock_Price:  95.19235647116867
curr_Factors:  [95.19235647 -0.75726884 -1.08155923]
mat_Sqrt:  [[15.13593284  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01268516 0.02502352 0.33616315]
Stock Position:  0.012685162249898643
Bond Position:  [-3.78415266]


portfolio before change:  [-2.59159507]
curr_Stock_Price:  94.08659687641372
curr_Factors:  [94.08659688 -1.1584145  -1.11005499]
mat_Sqrt:  [[ 9.73517986  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.017427    0.04706606 -0.30486923]
Stock Position:  0.017426996679102538
Bond Position:  [-4.23124188]


portfolio before change:  [-2.59899652]
curr_Stock_Price:  93.72259213070966
curr_Factors:  [93.72259213 -1.15789684 -1.11770933]
mat_Sqrt:  [[ 9.62855439  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02625481  0.0506622   0.33131074]
Stock Position:  -0.026254806214750917
Bond Position:  [-0.13832802]


portfolio before change:  [-2.61058448]
curr_Stock_Price:  94.16264016414992
curr_Factors:  [94.16264016 -0.97145412 -1.10745555]
mat_Sqrt:  [[11.77659195  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00232133 0.0408081  0.49578714]
Stock Position:  0.002321331524635008
Bond Position:  [-2.82916718]


portfolio before change:  [-2.6115263]
curr_Stock_Price:  94.0616470938584
curr_Factors:  [94.06164709 -0.9610021  -1.1234431 ]
mat_Sqrt:  [[11.69902125  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00910425 -0.00349646 -0.09075571]
Stock Position:  0.009104251142850928
Bond Position:  [-3.46788716]


portfolio before change:  [-2.62749772]
curr_Stock_Price:  92.40260397159248
curr_Factors:  [92.40260397 -0.83150191 -1.09427396]
mat_Sqrt:  [[13.46884567  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0106479  -0.13739928  0.36429739]
Stock Position:  -0.010647898093466833
Bond Position:  [-1.64360421]


portfolio before change:  [-2.62875548]
curr_Stock_Price:  92.48213139583156
curr_Factors:  [92.4821314  -0.93129441 -1.08832794]
mat_Sqrt:  [[12.2728942   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01246228 -0.17291087 -1.60718843]
Stock Position:  -0.012462284345997833
Bond Position:  [-1.47621686]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-2.64172786]
Stock Price:  93.4934455262221
PL:  [-2.64172786]
Settle:  Tensor("sub_132:0", shape=(), dtype=float64)
PL:  Tensor("sub_133:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  67
output_Z_Vals[:, i, :]:  [[ 1.19271183e+02 -4.92738716e+01 -4.92570741e+01]
 [ 7.38997308e-02  1.27621127e-01 -2.01523868e-02]
 [-2.44491446e+00 -2.24685385e+00 -7.33245565e-01]
 [-2.37621507e-02 -6.80937332e-03 -1.37074123e-01]
 [-1.22656141e-01 -2.68462805e-02  9.45159768e-02]
 [-9.60776020e-02  1.38122053e-02 -2.79119036e-01]
 [-8.16089935e-02  1.21663583e-01 -1.91519835e-01]
 [ 5.13117369e-02  1.03057026e-01  2.12881466e-03]
 [ 1.62300739e-02  8.39319287e-02 -3.19366456e-02]
 [-7.65220087e-01 -3.10871406e-01 -2.30341377e-02]
 [ 4.91035862e-02 -5.75227666e-02 -3.07573468e-01]
 [-8.84856681e-03 -1.68299696e-02  2.47061154e-02]
 [-6.70299456e-01 -1.18683877e+00  2.29642894e-01]
 [ 6.23543146e-02  7.28248351e-02  1.59175887e-01]
 [ 1.19752751e-01  1.31994161e-01 -1.04665966e-01]
 [-1.89555310e-01  1.05580300e-01  1.39737449e-01]
 [ 4.48755214e-02  1.18644711e-01  1.32759401e-01]
 [ 1.15216134e-01 -1.08333916e-02 -3.18137274e-02]
 [-5.74686074e-02 -1.86698407e-01  2.88203032e-02]
 [ 9.59862133e-02 -7.21651107e-01 -7.07109686e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.27118322 -49.27387164 -49.25707411]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [   7.3268874   -15.90307369 -140.51672192]
init_Out:  [2.48374395]
Stock Position:  7.326887399052493
Bond position:  [-730.20499595]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-5.11460943]
curr_Stock_Price:  98.98786771139254
curr_Factors:  [98.98786771 -1.30088568 -0.99949164]
mat_Sqrt:  [[ 9.92066526  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00966031  0.04118954 -0.05748915]
Stock Position:  0.00966030937382997
Bond Position:  [-6.07086286]


portfolio before change:  [-5.12860651]
curr_Stock_Price:  97.6960689377334
curr_Factors:  [97.69606894 -1.5372818  -1.0185759 ]
mat_Sqrt:  [[ 7.5837183   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.4026026  -0.72516896 -2.0917455 ]
Stock Position:  -0.4026026007493073
Bond Position:  [34.20408493]


portfolio before change:  [-4.81575348]
curr_Stock_Price:  96.94023442213714
curr_Factors:  [96.94023442 -1.5532268  -1.02721417]
mat_Sqrt:  [[ 7.34231131  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00723645 -0.00219772 -0.39103432]
Stock Position:  -0.007236446959674982
Bond Position:  [-4.11425061]


portfolio before change:  [-4.81849276]
curr_Stock_Price:  97.17662009616696
curr_Factors:  [97.1766201  -1.9396258  -1.02826285]
mat_Sqrt:  [[ 4.99601954  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02178597 -0.0086646   0.26962777]
Stock Position:  -0.021785968040599034
Bond Position:  [-2.70140602]


portfolio before change:  [-4.81569551]
curr_Stock_Price:  97.0172200694874
curr_Factors:  [97.01722007 -1.94512658 -0.9927351 ]
mat_Sqrt:  [[ 5.13986502  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.029229    0.00445787 -0.79624892]
Stock Position:  -0.029229003369915792
Bond Position:  [-1.97997886]


portfolio before change:  [-4.80079371]
curr_Stock_Price:  96.49045348006096
curr_Factors:  [96.49045348 -1.51857285 -0.94482789]
mat_Sqrt:  [[ 8.21567026  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01166896  0.03926675 -0.54635278]
Stock Position:  -0.011668961662823574
Bond Position:  [-3.67485031]


portfolio before change:  [-4.79556456]
curr_Stock_Price:  95.96358782607756
curr_Factors:  [95.96358783 -1.00702577 -0.95460499]
mat_Sqrt:  [[13.49525397  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00539321 0.03326151 0.00607292]
Stock Position:  0.005393207624511699
Bond Position:  [-5.31311611]


portfolio before change:  [-4.78992196]
curr_Stock_Price:  97.25614849624225
curr_Factors:  [97.2561485  -1.02919994 -0.96956905]
mat_Sqrt:  [[13.17840114  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00203694  0.02708891 -0.09110636]
Stock Position:  0.002036936528158125
Bond Position:  [-4.98802656]


portfolio before change:  [-4.79084041]
curr_Stock_Price:  97.41752164725428
curr_Factors:  [97.41752165 -1.26065488 -0.94708206]
mat_Sqrt:  [[10.71097738  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.077806   -0.10033331 -0.06570998]
Stock Position:  -0.07780599673689106
Bond Position:  [2.78882696]


portfolio before change:  [-4.76329391]
curr_Stock_Price:  97.07244266187165
curr_Factors:  [97.07244266 -1.29781729 -0.95713083]
mat_Sqrt:  [[10.18085918  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00249698 -0.01856539 -0.87742149]
Stock Position:  -0.002496976936848466
Bond Position:  [-4.52090626]


portfolio before change:  [-4.76358173]
curr_Stock_Price:  96.7350159736667
curr_Factors:  [96.73501597 -1.45211174 -0.92482967]
mat_Sqrt:  [[ 8.98030673  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0008063  -0.00543185  0.07047967]
Stock Position:  -0.0008063037831953198
Bond Position:  [-4.68558392]


portfolio before change:  [-4.76501876]
curr_Stock_Price:  97.0642900800209
curr_Factors:  [97.06429008 -1.06056153 -0.93283233]
mat_Sqrt:  [[13.22329017  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.06546678 -0.38305057  0.65510726]
Stock Position:  -0.06546678135086857
Bond Position:  [1.58946789]


portfolio before change:  [-4.76888649]
curr_Stock_Price:  97.12943980561198
curr_Factors:  [97.12943981 -0.94939411 -0.99142637]
mat_Sqrt:  [[13.94643663  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00786662 0.02350411 0.4540845 ]
Stock Position:  0.007866616149157117
Bond Position:  [-5.53296651]


portfolio before change:  [-4.78016055]
curr_Stock_Price:  95.87214643425257
curr_Factors:  [95.87214643 -0.92046922 -1.01379516]
mat_Sqrt:  [[13.85645398  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00904496  0.04260093 -0.29858287]
Stock Position:  0.009044961728833177
Bond Position:  [-5.64732044]


portfolio before change:  [-4.77328876]
curr_Stock_Price:  96.78799258184628
curr_Factors:  [96.78799258 -1.38352435 -1.00841063]
mat_Sqrt:  [[ 8.85150911  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01575777  0.0340759   0.39863205]
Stock Position:  -0.015757768772223395
Bond Position:  [-3.24812596]


portfolio before change:  [-4.77033533]
curr_Stock_Price:  96.54902687965551
curr_Factors:  [96.54902688 -0.90073467 -1.01625169]
mat_Sqrt:  [[14.1974813   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00677537 0.03829242 0.37872562]
Stock Position:  0.006775368741391003
Bond Position:  [-5.42449059]


portfolio before change:  [-4.76558632]
curr_Stock_Price:  97.45012936300179
curr_Factors:  [97.45012936 -1.08114498 -1.01951409]
mat_Sqrt:  [[11.92553244  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00893133 -0.00349646 -0.09075571]
Stock Position:  0.008931326811319156
Bond Position:  [-5.63594527]


portfolio before change:  [-4.76959658]
curr_Stock_Price:  97.15889669490421
curr_Factors:  [97.15889669 -1.1151196  -1.01499789]
mat_Sqrt:  [[11.54474381  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00776937 -0.06025665  0.0822163 ]
Stock Position:  -0.0077693660197719625
Bond Position:  [-4.01473355]


portfolio before change:  [-4.77112362]
curr_Stock_Price:  97.2262419954482
curr_Factors:  [97.226242   -1.39045241 -1.00582122]
mat_Sqrt:  [[ 8.85309423  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02210056 -0.23291189 -2.01718711]
Stock Position:  -0.022100562497529747
Bond Position:  [-2.62236898]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-4.74973575]
Stock Price:  96.22882229889753
PL:  [-4.74973575]
Settle:  Tensor("sub_134:0", shape=(), dtype=float64)
PL:  Tensor("sub_135:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  68
output_Z_Vals[:, i, :]:  [[ 1.19271183e+02 -4.92738716e+01 -4.92570741e+01]
 [-4.64513982e-03 -4.08171614e-03 -6.12870855e-02]
 [-2.10849282e+00 -2.84010521e+00 -8.08408692e-01]
 [ 7.20762524e-03  9.09501241e-02 -1.02393923e-01]
 [ 7.87477602e-01 -1.20414141e-01 -3.83197446e-01]
 [ 7.81274076e-02  1.39488941e-01  6.77394689e-03]
 [ 1.48860862e-02  3.13991847e-02  1.03027734e-01]
 [ 8.05675900e-02  2.53667621e-01  1.65320355e-01]
 [-1.76173052e-02 -2.05292976e-01  2.93759297e-02]
 [-1.29744007e+00 -4.94734709e-01 -5.08651883e-02]
 [ 4.18497884e-01  9.33363688e-02  6.99258096e-02]
 [-1.88751044e-01 -2.90795951e-04  2.79588907e-02]
 [-7.99924397e-01 -1.08848853e+00  2.85405866e-01]
 [-3.82260167e-03 -3.37509155e-02 -2.05299108e-02]
 [ 2.01483334e-02  9.51503500e-02 -9.31228489e-02]
 [ 8.43544715e-02  2.75281330e-02  5.42301296e-02]
 [ 6.12367494e-03 -5.19025704e-03 -2.16691592e-02]
 [ 6.61506414e-02 -5.18020799e-02  3.96871061e-02]
 [ 4.08578611e-02  9.83096156e-02  9.57666224e-03]
 [ 3.10221292e-02 -3.74492857e-01 -2.24439543e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.27118322 -49.27387164 -49.25707411]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [   7.3268874   -15.90307369 -140.51672192]
init_Out:  [2.48374395]
Stock Position:  7.326887399052493
Bond position:  [-730.20499595]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [8.40918686]
curr_Stock_Price:  100.83364417127657
curr_Factors:  [100.83364417  -0.85046089  -0.9806461 ]
mat_Sqrt:  [[16.15718897  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00111334 -0.00131737 -0.174835  ]
Stock Position:  -0.00111334283520412
Bond Position:  [8.52144927]


portfolio before change:  [8.41073672]
curr_Stock_Price:  101.35528799532167
curr_Factors:  [101.355288    -1.09671274  -1.00136023]
mat_Sqrt:  [[12.43554722  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.22944246 -0.91664001 -2.30616498]
Stock Position:  -0.2294424646566509
Bond Position:  [31.6659438]


portfolio before change:  [8.8640326]
curr_Stock_Price:  99.41415471117679
curr_Factors:  [99.41415471 -0.66334604 -1.00918756]
mat_Sqrt:  [[18.6670681   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 2.60976683e-04  2.93540263e-02 -2.92101362e-01]
Stock Position:  0.0002609766825063271
Bond Position:  [8.83808782]


portfolio before change:  [8.866281]
curr_Stock_Price:  99.56209485014494
curr_Factors:  [99.56209485 -0.4801029  -1.00046801]
mat_Sqrt:  [[22.65114986  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.03022709 -0.0388635  -1.09315565]
Stock Position:  0.030227088763397837
Bond Position:  [5.85680872]


portfolio before change:  [8.90656709]
curr_Stock_Price:  100.84642953925886
curr_Factors:  [100.84642954  -0.44312902  -1.01628452]
mat_Sqrt:  [[23.43393815  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00460798 0.04501986 0.01932418]
Stock Position:  0.004607983257918768
Bond Position:  [8.44186843]


portfolio before change:  [8.90883977]
curr_Stock_Price:  100.881574865248
curr_Factors:  [100.88157487  -0.52217787  -1.00949945]
mat_Sqrt:  [[21.8078497   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00194085 0.01013404 0.29390945]
Stock Position:  0.001940854627611821
Bond Position:  [8.7130433]


portfolio before change:  [8.91285286]
curr_Stock_Price:  101.82680879527929
curr_Factors:  [101.8268088   -0.79221556  -1.00324898]
mat_Sqrt:  [[16.90837187  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00982313 0.08187087 0.47161296]
Stock Position:  0.00982313102545749
Bond Position:  [7.91259478]


portfolio before change:  [8.92017917]
curr_Stock_Price:  102.37122928094033
curr_Factors:  [102.37122928  -1.43864238  -1.0167137 ]
mat_Sqrt:  [[ 8.78679153  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00609167 -0.06625802  0.08380135]
Stock Position:  -0.006091668585809889
Bond Position:  [9.54379077]


portfolio before change:  [8.91727227]
curr_Stock_Price:  103.24014455301686
curr_Factors:  [103.24014455  -1.57440363  -1.00862412]
mat_Sqrt:  [[ 7.79926912  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.18063362 -0.15967494 -0.14510422]
Stock Position:  -0.18063361573746006
Bond Position:  [27.56591287]


portfolio before change:  [8.89064455]
curr_Stock_Price:  103.42571393118308
curr_Factors:  [103.42571393  -1.24489664  -1.02635124]
mat_Sqrt:  [[10.6718105   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.04233805 0.03012418 0.19947887]
Stock Position:  0.04233804912736859
Bond Position:  [4.51180159]


portfolio before change:  [8.93050808]
curr_Stock_Price:  104.34062253085489
curr_Factors:  [104.34062253  -1.14613758  -0.97191928]
mat_Sqrt:  [[12.54853464  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-1.45916095e-02 -9.38539897e-05  7.97589329e-02]
Stock Position:  -0.014591609514085882
Bond Position:  [10.4530057]


portfolio before change:  [8.93758722]
curr_Stock_Price:  104.03458640269545
curr_Factors:  [104.0345864   -1.14627979  -1.02189671]
mat_Sqrt:  [[11.90010126  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.08099536 -0.35130816  0.8141835 ]
Stock Position:  -0.08099535779776693
Bond Position:  [17.36390577]


portfolio before change:  [8.85469562]
curr_Stock_Price:  105.11160020767225
curr_Factors:  [105.11160021  -1.29554391  -0.99261668]
mat_Sqrt:  [[10.66387705  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00139749 -0.01089306 -0.05856612]
Stock Position:  -0.0013974869427061062
Bond Position:  [9.00158771]


portfolio before change:  [8.8578547]
curr_Stock_Price:  104.4615774986878
curr_Factors:  [104.4615775   -1.20761058  -0.98973713]
mat_Sqrt:  [[11.6054128   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00177178  0.03070964 -0.26565357]
Stock Position:  0.0017717763017114944
Bond Position:  [8.67277215]


portfolio before change:  [8.8585373]
curr_Stock_Price:  103.62294709192389
curr_Factors:  [103.62294709  -0.92225779  -0.9654787 ]
mat_Sqrt:  [[15.68998037  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00643999 0.00888467 0.15470346]
Stock Position:  0.006439989381544637
Bond Position:  [8.19120662]


portfolio before change:  [8.86410032]
curr_Stock_Price:  104.16875031483421
curr_Factors:  [104.16875031  -0.62482747  -0.96582503]
mat_Sqrt:  [[21.22881965  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 3.01957235e-05 -1.67514826e-03 -6.18160795e-02]
Stock Position:  3.0195723543297204e-05
Bond Position:  [8.86095487]


portfolio before change:  [8.86625747]
curr_Stock_Price:  102.23583135988687
curr_Factors:  [102.23583136  -0.45358842  -0.96020187]
mat_Sqrt:  [[24.86576433  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00256086 -0.01671905  0.11321627]
Stock Position:  0.002560857645432333
Bond Position:  [8.60444606]


portfolio before change:  [8.87186938]
curr_Stock_Price:  103.58714741635518
curr_Factors:  [103.58714742  -0.15388367  -0.91967395]
mat_Sqrt:  [[35.40509157  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00177602 0.03172929 0.02731955]
Stock Position:  0.0017760173074701656
Bond Position:  [8.68789681]


portfolio before change:  [8.87608315]
curr_Stock_Price:  104.73664187143203
curr_Factors:  [104.73664187  -0.26029368  -0.89368966]
mat_Sqrt:  [[33.03163338  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00276203 -0.12086705 -0.64026354]
Stock Position:  -0.0027620321961147097
Bond Position:  [9.16536912]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [8.87933669]
Stock Price:  104.38837726482627
PL:  [4.49095943]
Settle:  Tensor("sub_136:0", shape=(), dtype=float64)
PL:  Tensor("sub_137:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  69
output_Z_Vals[:, i, :]:  [[ 1.19271183e+02 -4.92738716e+01 -4.92570741e+01]
 [ 3.91397172e-02  7.17752541e-02 -3.62832702e-02]
 [-2.09190222e+00 -2.81798122e+00 -8.02008631e-01]
 [-2.11996688e-01 -4.81021795e-02  1.38013103e-01]
 [ 4.20513564e-01  1.18322862e-01 -4.16640314e-01]
 [ 7.57175145e-02  1.17192732e-01 -6.73936232e-03]
 [ 1.83309533e-02  3.44729400e-02  1.10386937e-01]
 [ 1.33490004e-01  3.54091898e-01  2.14489585e-01]
 [ 6.34797396e-02  1.37057038e-01 -8.74469513e-02]
 [-9.98817435e-01 -4.09138725e-01 -3.48760624e-02]
 [ 1.97388363e-01  4.38888350e-03 -1.19038467e-01]
 [ 3.53490993e-03 -6.00609157e-02  3.35368720e-02]
 [-6.79020033e-01 -1.05876980e+00  2.27964402e-01]
 [ 1.58095642e-01  6.82587590e-02  1.13215979e-01]
 [ 9.54114505e-02  1.29573174e-01 -1.03474300e-01]
 [-1.48329928e-01  9.65560675e-02  1.31812552e-01]
 [ 6.51566289e-02  1.07806459e-01  1.12189140e-01]
 [ 1.14701168e-01 -1.09860837e-02 -3.03059195e-02]
 [-5.28744834e-02 -1.34710860e-01  7.58397901e-03]
 [ 6.76578217e-02 -4.92997539e-01 -5.33936900e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.27118322 -49.27387164 -49.25707411]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [   7.3268874   -15.90307369 -140.51672192]
init_Out:  [2.48374395]
Stock Position:  7.326887399052493
Bond position:  [-730.20499595]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-2.89129522]
curr_Stock_Price:  99.29131364842172
curr_Factors:  [99.29131365 -0.72860772 -0.99053264]
mat_Sqrt:  [[17.79500384  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0026066   0.02316536 -0.10350607]
Stock Position:  0.00260660174580982
Bond Position:  [-3.15010813]


portfolio before change:  [-2.88372582]
curr_Stock_Price:  102.49741101057742
curr_Factors:  [102.49741101  -1.02721783  -1.03605143]
mat_Sqrt:  [[13.02106315  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.21740387 -0.90949953 -2.28790739]
Stock Position:  -0.2174038729144358
Bond Position:  [19.39960829]


portfolio before change:  [-2.81478699]
curr_Stock_Price:  102.20262176183269
curr_Factors:  [102.20262176  -1.10732538  -1.03177776]
mat_Sqrt:  [[12.03542269  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01608948 -0.01552491  0.39371297]
Stock Position:  -0.016089480405548487
Bond Position:  [-1.17039991]


portfolio before change:  [-2.7949387]
curr_Stock_Price:  100.95081448375137
curr_Factors:  [100.95081448  -1.19589991  -1.06454829]
mat_Sqrt:  [[10.5295461   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0341534   0.03818854 -1.18855884]
Stock Position:  0.034153397111454736
Bond Position:  [-6.24275196]


portfolio before change:  [-2.77812001]
curr_Stock_Price:  101.48896233307697
curr_Factors:  [101.48896233  -0.80804292  -1.03751485]
mat_Sqrt:  [[16.02888287  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00613042  0.03782379 -0.01922552]
Stock Position:  0.006130415634848745
Bond Position:  [-3.40028953]


portfolio before change:  [-2.7775143]
curr_Stock_Price:  101.726448233332
curr_Factors:  [101.72644823  -0.72336715  -1.03656736]
mat_Sqrt:  [[17.50265905  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00273675 0.01112609 0.31490321]
Stock Position:  0.002736747130281531
Bond Position:  [-3.05591386]


portfolio before change:  [-2.78230051]
curr_Stock_Price:  100.25677072503932
curr_Factors:  [100.25677073  -0.52802057  -1.0125212 ]
mat_Sqrt:  [[21.48151581  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01161702 0.11428267 0.61187908]
Stock Position:  0.0116170206581103
Bond Position:  [-3.94698548]


portfolio before change:  [-2.79755103]
curr_Stock_Price:  99.02894680200713
curr_Factors:  [99.0289468  -0.6107981  -1.02425113]
mat_Sqrt:  [[19.30497747  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00381282  0.04423497 -0.24946181]
Stock Position:  0.0038128175116225256
Bond Position:  [-3.17513033]


portfolio before change:  [-2.79630711]
curr_Stock_Price:  99.56340817304296
curr_Factors:  [99.56340817 -0.83251058 -0.98292568]
mat_Sqrt:  [[16.20562572  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.06722675 -0.13204896 -0.0994917 ]
Stock Position:  -0.06722675157659647
Bond Position:  [3.8970174]


portfolio before change:  [-2.78002378]
curr_Stock_Price:  99.33568699370834
curr_Factors:  [99.33568699 -0.76847088 -0.97506852]
mat_Sqrt:  [[17.37383775  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01001423  0.00141651 -0.33958361]
Stock Position:  0.010014230408160813
Bond Position:  [-3.77479424]


portfolio before change:  [-2.78683401]
curr_Stock_Price:  98.74987942590779
curr_Factors:  [98.74987943 -0.6419901  -1.0009975 ]
mat_Sqrt:  [[19.09836222  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-9.84004697e-05 -1.93845772e-02  9.56713610e-02]
Stock Position:  -9.840046974716577e-05
Bond Position:  [-2.77711697]


portfolio before change:  [-2.78716911]
curr_Stock_Price:  95.09886410651575
curr_Factors:  [95.09886411 -0.57061044 -0.96093054]
mat_Sqrt:  [[20.56058823  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0412735  -0.34171648  0.65031899]
Stock Position:  -0.04127350178459084
Bond Position:  [1.13789403]


portfolio before change:  [-2.78673256]
curr_Stock_Price:  95.09518041946004
curr_Factors:  [95.09518042 -0.37227784 -0.96620967]
mat_Sqrt:  [[24.93795087  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00782498 0.02203042 0.32297368]
Stock Position:  0.007824982046224945
Bond Position:  [-3.53085064]


portfolio before change:  [-2.78468288]
curr_Stock_Price:  95.46994194947283
curr_Factors:  [95.46994195 -0.45591262 -0.97258736]
mat_Sqrt:  [[22.88110513  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00440271  0.04181956 -0.29518338]
Stock Position:  0.004402709581899051
Bond Position:  [-3.20500931]


portfolio before change:  [-2.77868453]
curr_Stock_Price:  97.01437842047883
curr_Factors:  [97.01437842 -0.47175597 -0.94511445]
mat_Sqrt:  [[23.52323785  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.004324    0.03116334  0.37602452]
Stock Position:  -0.004323995669939957
Bond Position:  [-2.35919478]


portfolio before change:  [-2.77874839]
curr_Stock_Price:  96.89272842415723
curr_Factors:  [96.89272842 -0.46718283 -0.90157232]
mat_Sqrt:  [[24.65178534  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00446471 0.03479439 0.32004439]
Stock Position:  0.004464708784578773
Bond Position:  [-3.21134621]


portfolio before change:  [-2.78205165]
curr_Stock_Price:  96.33270859814625
curr_Factors:  [96.3327086  -0.5020507  -0.93992442]
mat_Sqrt:  [[22.77885738  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0046654  -0.00354574 -0.08645435]
Stock Position:  0.004665399629161629
Bond Position:  [-3.23148224]


portfolio before change:  [-2.77532668]
curr_Stock_Price:  97.94734953390638
curr_Factors:  [97.94734953 -0.61570531 -0.94140052]
mat_Sqrt:  [[20.64192607  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00381864 -0.04347774  0.02163498]
Stock Position:  -0.003818643130068796
Bond Position:  [-2.40130071]


portfolio before change:  [-2.76793868]
curr_Stock_Price:  95.85540292228474
curr_Factors:  [95.85540292 -0.77307706 -0.93735093]
mat_Sqrt:  [[17.32954499  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00819204 -0.15911427 -1.52317336]
Stock Position:  -0.008192038098464423
Bond Position:  [-1.98268757]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-2.78677345]
Stock Price:  98.09404479823627
PL:  [-2.78677345]
Settle:  Tensor("sub_138:0", shape=(), dtype=float64)
PL:  Tensor("sub_139:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  70
output_Z_Vals[:, i, :]:  [[ 1.19271183e+02 -4.92738716e+01 -4.92570741e+01]
 [ 5.24908741e-03  1.67778511e-02 -5.24767429e-02]
 [-2.36881337e+00 -3.18724936e+00 -9.08831068e-01]
 [ 8.30252707e-02  2.71865469e-01 -5.72898850e-02]
 [ 1.01289543e+00 -1.23431092e-01 -4.97042847e-01]
 [-1.47712969e-01 -2.65014257e-01  6.90733664e-02]
 [-2.03203693e-02  4.68098827e-02  7.86120818e-04]
 [ 8.50069536e-02  1.84743203e-01  5.50215516e-02]
 [ 5.15133488e-02  8.13430997e-02 -4.40822299e-02]
 [-9.62408281e-01 -3.92930186e-01 -3.30493139e-02]
 [ 6.70125791e-02 -3.94085672e-02 -2.79683560e-01]
 [ 3.82998889e-02  1.31653827e-03  2.29533598e-02]
 [-6.90324131e-01 -1.09988936e+00  2.32745602e-01]
 [ 1.08554923e-01  7.57221454e-02  1.34799949e-01]
 [ 1.24681843e-01  1.37086430e-01 -1.04978685e-01]
 [-1.91040696e-01  1.08274849e-01  1.35979246e-01]
 [ 2.32075894e-02  1.27882308e-01  1.50885507e-01]
 [ 1.15216134e-01 -1.08333916e-02 -3.18137274e-02]
 [-5.40344942e-02 -1.61678304e-01  2.21429587e-02]
 [ 9.68417806e-02 -7.38107245e-01 -6.82266191e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.27118322 -49.27387164 -49.25707411]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [   7.3268874   -15.90307369 -140.51672192]
init_Out:  [2.48374395]
Stock Position:  7.326887399052493
Bond position:  [-730.20499595]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [6.58470966]
curr_Stock_Price:  100.58463294744993
curr_Factors:  [100.58463295  -0.88604575  -1.04355319]
mat_Sqrt:  [[14.60553477  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-1.39530555e-04  5.41502815e-03 -1.49701541e-01]
Stock Position:  -0.0001395305551497109
Bond Position:  [6.59874429]


portfolio before change:  [6.5862777]
curr_Stock_Price:  101.1712268333478
curr_Factors:  [101.17122683  -0.65398327  -1.01554324]
mat_Sqrt:  [[19.0542063   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.16820025 -1.02868031 -2.59264207]
Stock Position:  -0.16820025122409457
Bond Position:  [23.60330347]


portfolio before change:  [6.65473613]
curr_Stock_Price:  100.79930788383469
curr_Factors:  [100.79930788  -0.48023784  -0.97889628]
mat_Sqrt:  [[23.42953393  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00541305  0.0877442  -0.1634321 ]
Stock Position:  0.005413053826643841
Bond Position:  [6.10910405]


portfolio before change:  [6.65277038]
curr_Stock_Price:  100.1539759245617
curr_Factors:  [100.15397592  -0.29884158  -0.96937355]
mat_Sqrt:  [[28.17665038  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.03145305 -0.03983721 -1.41792489]
Stock Position:  0.031453054567913065
Bond Position:  [3.50262191]


portfolio before change:  [6.54251066]
curr_Stock_Price:  96.62059939919935
curr_Factors:  [96.6205994  -0.40386758 -1.00800919]
mat_Sqrt:  [[23.54504025  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00797235 -0.08553298  0.19704709]
Stock Position:  -0.007972347181274144
Bond Position:  [7.31280362]


portfolio before change:  [6.53523193]
curr_Stock_Price:  97.76294243966436
curr_Factors:  [97.76294244 -0.45605264 -0.97535583]
mat_Sqrt:  [[23.36261564  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00045393  0.01510782  0.00224258]
Stock Position:  -0.00045392501784268706
Bond Position:  [6.57960898]


portfolio before change:  [6.53733544]
curr_Stock_Price:  96.75307724120053
curr_Factors:  [96.75307724 -0.79255463 -0.97592148]
mat_Sqrt:  [[16.50537403  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00811546 0.05962561 0.15696117]
Stock Position:  0.00811546159592855
Bond Position:  [5.75213956]


portfolio before change:  [6.54923291]
curr_Stock_Price:  98.04188251116052
curr_Factors:  [98.04188251 -0.96390084 -0.99005104]
mat_Sqrt:  [[13.89380248  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00425508  0.02625337 -0.12575433]
Stock Position:  0.004255076465380716
Bond Position:  [6.1320572]


portfolio before change:  [6.55641191]
curr_Stock_Price:  99.36872131226562
curr_Factors:  [99.36872131 -1.04596949 -0.98650204]
mat_Sqrt:  [[13.01842762  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.08060582 -0.12681767 -0.09428049]
Stock Position:  -0.08060581609139246
Bond Position:  [14.56610879]


portfolio before change:  [6.7367989]
curr_Stock_Price:  97.17601341127529
curr_Factors:  [97.17601341 -0.8456719  -0.95243205]
mat_Sqrt:  [[16.09357224  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 1.16703201e-04 -1.27190604e-02 -7.97859347e-01]
Stock Position:  0.00011670320142769425
Bond Position:  [6.72545815]


portfolio before change:  [6.73840201]
curr_Stock_Price:  96.50358592003309
curr_Factors:  [96.50358592 -0.80185713 -1.02259941]
mat_Sqrt:  [[15.56653824  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00277865 0.00042491 0.06547955]
Stock Position:  0.0027786499751789183
Bond Position:  [6.47025232]


portfolio before change:  [6.73814938]
curr_Stock_Price:  95.83045665958944
curr_Factors:  [95.83045666 -0.87870295 -0.98978197]
mat_Sqrt:  [[14.79213522  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.05863448 -0.35498776  0.66395842]
Stock Position:  -0.058634476793715924
Bond Position:  [12.35711807]


portfolio before change:  [6.72939147]
curr_Stock_Price:  96.03251478465502
curr_Factors:  [96.03251478 -0.87736993 -0.96944499]
mat_Sqrt:  [[15.14805151  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01000311 0.02443922 0.38454673]
Stock Position:  0.01000310602804043
Bond Position:  [5.76876805]


portfolio before change:  [6.71895456]
curr_Stock_Price:  94.84495477137389
curr_Factors:  [94.84495477 -0.79085843 -0.97734512]
mat_Sqrt:  [[16.18427274  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00810885  0.04424446 -0.29947497]
Stock Position:  0.008108848107627603
Bond Position:  [5.94987122]


portfolio before change:  [6.73408634]
curr_Stock_Price:  96.5275770275442
curr_Factors:  [96.52757703 -1.05544164 -1.00774998]
mat_Sqrt:  [[12.26361959  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01151231  0.03494556  0.38791094]
Stock Position:  -0.01151230571977053
Bond Position:  [7.84534132]


portfolio before change:  [6.7421315]
curr_Stock_Price:  95.99913563064703
curr_Factors:  [95.99913563 -1.41095655 -1.01772004]
mat_Sqrt:  [[ 8.46265195  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.0094664  0.04127384 0.43043435]
Stock Position:  0.00946639797600005
Bond Position:  [5.83336548]


portfolio before change:  [6.74545516]
curr_Stock_Price:  96.19616250259068
curr_Factors:  [96.1961625  -1.18288396 -1.0765537 ]
mat_Sqrt:  [[10.04376262  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01060467 -0.00349646 -0.09075571]
Stock Position:  0.010604673932462134
Bond Position:  [5.72532622]


portfolio before change:  [6.7675294]
curr_Stock_Price:  98.14273207579565
curr_Factors:  [98.14273208 -1.20298479 -1.08387283]
mat_Sqrt:  [[ 9.96984706  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00827666 -0.05218145  0.0631677 ]
Stock Position:  -0.008276659277584053
Bond Position:  [7.57982336]


portfolio before change:  [6.76638462]
curr_Stock_Price:  98.51002658595787
curr_Factors:  [98.51002659 -1.38523249 -1.07312733]
mat_Sqrt:  [[ 8.43001472  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02290515 -0.23822309 -1.94631554]
Stock Position:  -0.02290514778202455
Bond Position:  [9.02277134]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [6.75322823]
Stock Price:  99.18290444596424
PL:  [6.75322823]
Settle:  Tensor("sub_140:0", shape=(), dtype=float64)
PL:  Tensor("sub_141:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  71
output_Z_Vals[:, i, :]:  [[ 1.19271183e+02 -4.92738716e+01 -4.92570741e+01]
 [-3.20932510e-03 -2.30372897e-03 -6.10702549e-02]
 [-2.48396153e+00 -3.34080239e+00 -9.53251118e-01]
 [-1.47898107e-01  3.12537321e-02  9.72185071e-02]
 [ 1.09564702e+00 -3.01527426e-02 -6.01791619e-01]
 [ 8.35596737e-02  1.89747994e-01  3.72350041e-02]
 [ 1.97355908e-02  3.23637423e-02  1.10374056e-01]
 [ 1.36144282e-01  4.03140461e-01  2.90056274e-01]
 [-1.29109810e-01  2.87891271e-01 -9.31318212e-02]
 [-1.26406043e+00 -5.22080060e-01 -4.82932783e-02]
 [ 2.86937163e-01  5.25183698e-02  1.55120661e-02]
 [-2.47924857e-01  2.99831112e-02  2.51296493e-02]
 [-6.22880156e-01 -1.08526702e+00  2.20650640e-01]
 [-5.10687092e-03  1.07614712e-03  1.14966731e-02]
 [-1.20182302e-01 -1.27154679e-01  2.70652127e-02]
 [ 1.29151228e-01  1.54705389e-02  3.30206620e-02]
 [-1.44836585e-01 -1.53027488e-01 -1.68770952e-01]
 [-8.10228614e-02 -1.73936310e-01  2.91309441e-01]
 [ 4.66167810e-02 -4.86396768e-02  6.67325732e-02]
 [ 6.41224393e-02 -5.85263659e-01 -3.81400389e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.27118322 -49.27387164 -49.25707411]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [   7.3268874   -15.90307369 -140.51672192]
init_Out:  [2.48374395]
Stock Position:  7.326887399052493
Bond position:  [-730.20499595]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [7.14342096]
curr_Stock_Price:  100.66088787944652
curr_Factors:  [100.66088788  -0.72025674  -0.97601787]
mat_Sqrt:  [[18.45771999  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00087473 -0.00074353 -0.17421644]
Stock Position:  -0.0008747280493334727
Bond Position:  [7.23147186]


portfolio before change:  [7.14470154]
curr_Stock_Price:  101.26395051513812
curr_Factors:  [101.26395052  -0.48114511  -0.98401517]
mat_Sqrt:  [[23.39612017  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.14363414 -1.07823934 -2.7193601 ]
Stock Position:  -0.14363413701352662
Bond Position:  [21.68966168]


portfolio before change:  [7.026251]
curr_Stock_Price:  102.12637524948036
curr_Factors:  [102.12637525  -0.37547802  -0.98824971]
mat_Sqrt:  [[26.1143061   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00465928  0.0100871   0.27733734]
Stock Position:  -0.004659278336883063
Bond Position:  [7.5020862]


portfolio before change:  [7.02875293]
curr_Stock_Price:  101.99198170349445
curr_Factors:  [101.9919817   -0.25996326  -1.013984  ]
mat_Sqrt:  [[28.52973675  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.03388226 -0.00973176 -1.71674398]
Stock Position:  0.03388225871506443
Bond Position:  [3.57303422]


portfolio before change:  [7.06613973]
curr_Stock_Price:  103.06904783024457
curr_Factors:  [103.06904783  -0.38397098  -1.0124674 ]
mat_Sqrt:  [[25.50719974  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00509238 0.0612409  0.1062211 ]
Stock Position:  0.005092381189116536
Bond Position:  [6.54127285]


portfolio before change:  [7.06086108]
curr_Stock_Price:  101.71129883168899
curr_Factors:  [101.71129883  -0.86237568  -1.00126503]
mat_Sqrt:  [[15.77612451  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00309783 0.01044535 0.31486646]
Stock Position:  0.003097834437514178
Bond Position:  [6.74577632]


portfolio before change:  [7.06339505]
curr_Stock_Price:  101.98481843197006
curr_Factors:  [101.98481843  -0.30285297  -0.98829868]
mat_Sqrt:  [[28.04112854  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00990126 0.13011302 0.82744981]
Stock Position:  0.009901258890485687
Bond Position:  [6.05361696]


portfolio before change:  [7.02644251]
curr_Stock_Price:  98.09984387812189
curr_Factors:  [ 9.80998439e+01 -9.23649476e-02 -9.31201491e-01]
mat_Sqrt:  [[35.24837174  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.002535    0.09291651 -0.26567916]
Stock Position:  -0.0025350022982520855
Bond Position:  [7.27512584]


portfolio before change:  [7.01729221]
curr_Stock_Price:  102.42698473077931
curr_Factors:  [102.42698473  -0.34038663  -0.90802266]
mat_Sqrt:  [[29.39254029  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.04696727 -0.16850061 -0.13776728]
Stock Position:  -0.046967270673876294
Bond Position:  [11.82800812]


portfolio before change:  [7.07474807]
curr_Stock_Price:  101.26663423583764
curr_Factors:  [101.26663424  -0.15367859  -0.87372716]
mat_Sqrt:  [[36.24680485  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00829932 0.01695023 0.04425161]
Stock Position:  0.008299319592213696
Bond Position:  [6.23430391]


portfolio before change:  [7.09622931]
curr_Stock_Price:  103.66712779088576
curr_Factors:  [103.66712779  -0.38263606  -0.90344827]
mat_Sqrt:  [[28.64848994  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00826134  0.00967701  0.07168789]
Stock Position:  -0.008261343332854096
Bond Position:  [7.95265904]


portfolio before change:  [7.12161864]
curr_Stock_Price:  100.83454689947177
curr_Factors:  [100.8345469   -0.26797917  -0.87282089]
mat_Sqrt:  [[32.22301546  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0248074  -0.35026842  0.62945486]
Stock Position:  -0.024807400063392333
Bond Position:  [9.62306159]


portfolio before change:  [7.0909169]
curr_Stock_Price:  102.16914101486893
curr_Factors:  [102.16914101  -0.3138905   -0.85971834]
mat_Sqrt:  [[31.59569391  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-8.04050943e-05  3.47324990e-04  3.27968082e-02]
Stock Position:  -8.040509434019522e-05
Bond Position:  [7.09913182]


portfolio before change:  [7.09248579]
curr_Stock_Price:  104.73263498069016
curr_Factors:  [104.73263498  -0.70732156  -0.86578197]
mat_Sqrt:  [[21.72160175  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00647342 -0.041039    0.07720952]
Stock Position:  -0.006473416654008235
Bond Position:  [7.77046377]


portfolio before change:  [7.08178288]
curr_Stock_Price:  106.68612678384605
curr_Factors:  [106.68612678  -0.7141811   -0.90170918]
mat_Sqrt:  [[21.199993    0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00655894 0.00499309 0.09419876]
Stock Position:  0.006558938609320223
Bond Position:  [6.38203512]


portfolio before change:  [7.09160454]
curr_Stock_Price:  107.94028592146196
curr_Factors:  [107.94028592  -0.92369333  -0.92295276]
mat_Sqrt:  [[17.02924363  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01236246 -0.04938941 -0.48145655]
Stock Position:  -0.012362464288435274
Bond Position:  [8.42601247]


portfolio before change:  [7.10856628]
curr_Stock_Price:  106.7386664410416
curr_Factors:  [106.73866644  -0.77121418  -0.88595256]
mat_Sqrt:  [[20.35276422  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00280376 -0.0561377   0.83102475]
Stock Position:  -0.0028037553455173077
Bond Position:  [7.40783539]


portfolio before change:  [7.1134339]
curr_Stock_Price:  105.66317222427946
curr_Factors:  [105.66317222  -1.00578589  -0.86368366]
mat_Sqrt:  [[16.29383581  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00308767 -0.01569839  0.19036946]
Stock Position:  0.0030876693864816105
Bond Position:  [6.78718095]


portfolio before change:  [7.1117028]
curr_Stock_Price:  104.5529175814223
curr_Factors:  [104.55291758  -0.93494949  -0.84612079]
mat_Sqrt:  [[17.6127497   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00756253 -0.18889303 -1.08802915]
Stock Position:  -0.0075625348309210725
Bond Position:  [7.90238789]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [7.10933531]
Stock Price:  105.12724090765248
PL:  [1.9820944]
Settle:  Tensor("sub_142:0", shape=(), dtype=float64)
PL:  Tensor("sub_143:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  72
output_Z_Vals[:, i, :]:  [[ 1.19271183e+02 -4.92738716e+01 -4.92570741e+01]
 [ 2.36878295e-02  4.69500578e-02 -4.34539405e-02]
 [-2.07956709e+00 -2.82166885e+00 -8.03902017e-01]
 [ 5.16465306e-03  7.98913558e-02 -1.02371209e-01]
 [ 4.46373391e-01  1.27650327e-02 -3.40751423e-01]
 [ 7.57175145e-02  1.17192732e-01 -6.73936232e-03]
 [ 1.62594351e-02  2.58850683e-02  1.05363650e-01]
 [ 1.17532194e-01  3.22472507e-01  1.97381623e-01]
 [ 1.18225671e-02 -1.29490980e-01  3.84446434e-03]
 [-1.15076208e+00 -4.69031527e-01 -4.26642804e-02]
 [ 1.18816532e-01 -1.60447064e-02 -1.65080045e-01]
 [-3.65349556e-03 -6.29374393e-02  3.59002963e-02]
 [-6.99589632e-01 -1.10594076e+00  2.46699383e-01]
 [ 2.70795822e-03  1.99148701e-02  5.14452659e-02]
 [ 6.30120928e-02  1.18064873e-01 -9.92863385e-02]
 [ 7.14706147e-02  3.09959804e-02  6.03301191e-02]
 [ 1.25539909e-01  1.15578973e-01  1.03380930e-01]
 [ 1.15216134e-01 -1.08333916e-02 -3.18137274e-02]
 [-6.96533214e-02 -3.78720480e-01  1.21118169e-01]
 [ 6.33552553e-02 -4.76249204e-01 -5.07664758e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.27118322 -49.27387164 -49.25707411]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [   7.3268874   -15.90307369 -140.51672192]
init_Out:  [2.48374395]
Stock Position:  7.326887399052493
Bond position:  [-730.20499595]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [3.39455141]
curr_Stock_Price:  100.14922865149461
curr_Factors:  [100.14922865  -1.01620345  -1.04646149]
mat_Sqrt:  [[12.73044561  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00191678  0.01515307 -0.123962  ]
Stock Position:  0.001916780619600949
Bond Position:  [3.20258731]


portfolio before change:  [3.39413329]
curr_Stock_Price:  99.51333702126209
curr_Factors:  [99.51333702 -1.15936187 -1.07454048]
mat_Sqrt:  [[10.65883706  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.26453483 -0.91068971 -2.29330869]
Stock Position:  -0.2645348294403596
Bond Position:  [29.71887693]


portfolio before change:  [3.47294056]
curr_Stock_Price:  99.24351766058174
curr_Factors:  [99.24351766 -1.12002059 -1.09958322]
mat_Sqrt:  [[10.78302123  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 5.34147325e-05  2.57848242e-02 -2.92036565e-01]
Stock Position:  5.341473253803504e-05
Bond Position:  [3.46763949]


portfolio before change:  [3.47385587]
curr_Stock_Price:  100.14770585851639
curr_Factors:  [100.14770586  -0.80530066  -1.10851741]
mat_Sqrt:  [[14.77339726  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.02568288  0.0041199  -0.97206896]
Stock Position:  0.02568288410202656
Bond Position:  [0.90177395]


portfolio before change:  [3.4870333]
curr_Stock_Price:  100.65200902759999
curr_Factors:  [100.65200903  -0.90589377  -1.12113175]
mat_Sqrt:  [[13.25856278  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00741134  0.03782379 -0.01922552]
Stock Position:  0.007411339809278992
Bond Position:  [2.74106706]


portfolio before change:  [3.49040507]
curr_Stock_Price:  101.01448217877072
curr_Factors:  [101.01448218  -0.74887299  -1.14502329]
mat_Sqrt:  [[15.20109735  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00283206 0.00835437 0.30057316]
Stock Position:  0.002832063139487045
Bond Position:  [3.20432568]


portfolio before change:  [3.49066023]
curr_Stock_Price:  100.82168466219734
curr_Factors:  [100.82168466  -0.76447471  -1.1569279 ]
mat_Sqrt:  [[14.76044331  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01515178 0.10407755 0.56307483]
Stock Position:  0.015151778963986435
Bond Position:  [1.96303235]


portfolio before change:  [3.50991379]
curr_Stock_Price:  102.06000349719277
curr_Factors:  [102.0600035   -0.89803495  -1.18352692]
mat_Sqrt:  [[12.73047896  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00108597 -0.04179303  0.01096719]
Stock Position:  -0.001085970173481078
Bond Position:  [3.62074791]


portfolio before change:  [3.51216001]
curr_Stock_Price:  100.82523784223994
curr_Factors:  [100.82523784  -0.9557557   -1.16892759]
mat_Sqrt:  [[12.04567191  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.10420436 -0.15137927 -0.12170932]
Stock Position:  -0.1042043615819586
Bond Position:  [14.01858955]


portfolio before change:  [3.71258941]
curr_Stock_Price:  98.93544826006823
curr_Factors:  [98.93544826 -0.85887112 -1.15096335]
mat_Sqrt:  [[13.2584241   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00617303 -0.00517841 -0.47092742]
Stock Position:  0.006173026050134672
Bond Position:  [3.10185831]


portfolio before change:  [3.72540816]
curr_Stock_Price:  100.88638666197498
curr_Factors:  [100.88638666  -0.69907688  -1.13300685]
mat_Sqrt:  [[16.1498583   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00056796 -0.02031297  0.10241355]
Stock Position:  -0.0005679572587266457
Bond Position:  [3.78270732]


portfolio before change:  [3.72597585]
curr_Stock_Price:  101.55212862742799
curr_Factors:  [101.55212863  -1.29122559  -1.14384218]
mat_Sqrt:  [[ 8.89513483  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0983663  -0.35694084  0.70376467]
Stock Position:  -0.09836630480689022
Bond Position:  [13.71528348]


portfolio before change:  [3.76390469]
curr_Stock_Price:  101.20140287510782
curr_Factors:  [101.20140288  -0.93959235  -1.16921763]
mat_Sqrt:  [[12.28406195  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00140624 0.0064275  0.14675902]
Stock Position:  0.0014062355787724922
Bond Position:  [3.62159168]


portfolio before change:  [3.76675891]
curr_Stock_Price:  102.58716648087734
curr_Factors:  [102.58716648  -0.84839399  -1.17764026]
mat_Sqrt:  [[13.52687696  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00494166  0.03810527 -0.28323629]
Stock Position:  0.004941661346938841
Bond Position:  [3.25980788]


portfolio before change:  [3.76267109]
curr_Stock_Price:  101.59501484314099
curr_Factors:  [101.59501484  -0.82223384  -1.15511926]
mat_Sqrt:  [[14.06432393  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00640717 0.01000391 0.17210504]
Stock Position:  0.006407167322442071
Bond Position:  [3.11173483]


portfolio before change:  [3.75852479]
curr_Stock_Price:  100.8264486639492
curr_Factors:  [100.82644866  -0.47453006  -1.15833385]
mat_Sqrt:  [[19.69838797  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00864207 0.03730295 0.29491702]
Stock Position:  0.00864207328771522
Bond Position:  [2.88717523]


portfolio before change:  [3.72253656]
curr_Stock_Price:  96.57861267449864
curr_Factors:  [96.57861267 -0.38691165 -1.2103713 ]
mat_Sqrt:  [[19.5519371   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00544758 -0.00349646 -0.09075571]
Stock Position:  0.005447584405122693
Bond Position:  [3.19641642]


portfolio before change:  [3.71211559]
curr_Stock_Price:  94.5189510620079
curr_Factors:  [94.51895106 -0.17760185 -1.21080284]
mat_Sqrt:  [[23.57992376  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00518391 -0.12223151  0.34551642]
Stock Position:  -0.005183908737940919
Bond Position:  [4.2020932]


portfolio before change:  [3.69137138]
curr_Stock_Price:  98.72327952384349
curr_Factors:  [98.72327952 -0.54232241 -1.21598581]
mat_Sqrt:  [[17.01359209  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00808091 -0.15370877 -1.44822625]
Stock Position:  -0.008080912038439617
Bond Position:  [4.48914552]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [3.69136549]
Stock Price:  98.86290726094053
PL:  [3.69136549]
Settle:  Tensor("sub_144:0", shape=(), dtype=float64)
PL:  Tensor("sub_145:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  73
output_Z_Vals[:, i, :]:  [[ 1.19271183e+02 -4.92738716e+01 -4.92570741e+01]
 [ 4.75234865e-02  8.52447229e-02 -3.23926616e-02]
 [-2.38422689e+00 -3.20780368e+00 -9.14777053e-01]
 [-2.02925973e-02  1.82787642e-01  1.68642646e-02]
 [ 9.72131755e-01 -7.23513373e-03 -5.71372606e-01]
 [ 7.57175145e-02  1.17192732e-01 -6.73936232e-03]
 [ 9.83319364e-02 -1.64104475e-01 -9.30597568e-02]
 [-6.31411603e-02  6.84893449e-02  1.89946812e-01]
 [-8.65506411e-02 -3.77603381e-01  9.32997578e-02]
 [-1.43496517e+00 -5.65131346e-01 -5.57978463e-02]
 [ 3.80235591e-01  1.73995184e-02  5.26689669e-02]
 [-1.37728368e-01  2.97602898e-02  2.79152345e-02]
 [-9.00807418e-01 -1.13739968e+00  3.25500530e-01]
 [ 3.09021648e-02 -4.61109677e-02 -1.19136111e-02]
 [-5.18356997e-02 -8.87340178e-03 -3.84436203e-02]
 [ 7.32939926e-02  2.84932252e-03  1.26290329e-02]
 [-1.49066668e-01 -1.57170060e-01 -1.72892917e-01]
 [-5.92723903e-02 -1.59441574e-01  2.44047605e-01]
 [ 6.02400231e-02 -9.39386642e-02  1.05405803e-01]
 [ 6.18265882e-02 -5.94474643e-01 -2.89731572e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.27118322 -49.27387164 -49.25707411]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [   7.3268874   -15.90307369 -140.51672192]
init_Out:  [2.48374395]
Stock Position:  7.326887399052493
Bond position:  [-730.20499595]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-3.76788655]
curr_Stock_Price:  99.17167330341375
curr_Factors:  [99.1716733  -0.80671263 -0.98172323]
mat_Sqrt:  [[16.58363836  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00351623  0.02751262 -0.09240725]
Stock Position:  0.003516228892188378
Bond Position:  [-4.11659686]


portfolio before change:  [-3.75998768]
curr_Stock_Price:  101.71080056235692
curr_Factors:  [101.71080056  -0.62169119  -0.98649943]
mat_Sqrt:  [[20.36754848  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.1583767  -1.03531419 -2.60960431]
Stock Position:  -0.15837670198023104
Bond Position:  [12.34863347]


portfolio before change:  [-3.72626412]
curr_Stock_Price:  101.51736292202716
curr_Factors:  [101.51736292  -0.56134967  -0.94308263]
mat_Sqrt:  [[22.551409    0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00090731 0.05899446 0.04810905]
Stock Position:  0.0009073125964936406
Bond Position:  [-3.8183721]


portfolio before change:  [-3.72687274]
curr_Stock_Price:  101.89881121117085
curr_Factors:  [101.89881121  -0.9687969   -0.89511883]
mat_Sqrt:  [[15.80086281  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0540492  -0.00233513 -1.62996701]
Stock Position:  0.05404919682869707
Bond Position:  [-9.23442164]


portfolio before change:  [-3.68573418]
curr_Stock_Price:  102.70266138981337
curr_Factors:  [102.70266139  -0.97042673  -0.87906773]
mat_Sqrt:  [[16.15684132  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00608186  0.03782379 -0.01922552]
Stock Position:  0.006081864159498504
Bond Position:  [-4.31035781]


portfolio before change:  [-3.67174214]
curr_Stock_Price:  105.18048130787344
curr_Factors:  [105.18048131  -0.80039387  -0.8762633 ]
mat_Sqrt:  [[19.66854341  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00233055 -0.05296449 -0.26547358]
Stock Position:  0.002330549157919622
Bond Position:  [-3.91687042]


portfolio before change:  [-3.67057654]
curr_Stock_Price:  106.10083646951782
curr_Factors:  [106.10083647  -1.26979507  -0.85494781]
mat_Sqrt:  [[12.67519653  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00081956  0.02210484  0.54186538]
Stock Position:  -0.0008195613081623177
Bond Position:  [-3.5836204]


portfolio before change:  [-3.67099879]
curr_Stock_Price:  105.52276294828181
curr_Factors:  [105.52276295  -1.06477175  -0.78278445]
mat_Sqrt:  [[16.63269761  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00869275 -0.12187097  0.26615824]
Stock Position:  -0.008692749575696018
Bond Position:  [-2.75371584]


portfolio before change:  [-3.67114031]
curr_Stock_Price:  105.4598368759754
curr_Factors:  [105.45983688  -1.24314689  -0.76856204]
mat_Sqrt:  [[14.10629647  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.11071026 -0.18239536 -0.15917572]
Stock Position:  -0.11071026428723876
Bond Position:  [8.0043461]


portfolio before change:  [-3.68506681]
curr_Stock_Price:  105.60370647160552
curr_Factors:  [105.60370647  -1.38183672  -0.78144818]
mat_Sqrt:  [[12.13881987  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.03250219 0.00561567 0.1502499 ]
Stock Position:  0.03250219254667779
Bond Position:  [-7.11741881]


portfolio before change:  [-3.66503206]
curr_Stock_Price:  106.27487128290574
curr_Factors:  [106.27487128  -1.37083441  -0.77809783]
mat_Sqrt:  [[12.39256403  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01016379  0.00960509  0.07963439]
Stock Position:  -0.010163788594964791
Bond Position:  [-2.58487674]


portfolio before change:  [-3.67181878]
curr_Stock_Price:  106.87901803250222
curr_Factors:  [106.87901803  -1.1773761   -0.76907336]
mat_Sqrt:  [[15.26019897  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.06989002 -0.36709417  0.92856241]
Stock Position:  -0.06989002177353382
Bond Position:  [3.79795812]


portfolio before change:  [-3.74170809]
curr_Stock_Price:  107.89259502968169
curr_Factors:  [107.89259503  -1.23676249  -0.75837819]
mat_Sqrt:  [[14.67280183  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00129886 -0.01488225 -0.03398622]
Stock Position:  0.0012988621740218508
Bond Position:  [-3.8818457]


portfolio before change:  [-3.74177861]
curr_Stock_Price:  108.58555556141212
curr_Factors:  [108.58555556  -1.72203948  -0.74880002]
mat_Sqrt:  [[ 9.17698661  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00670092 -0.00286388 -0.10966895]
Stock Position:  -0.006700919269665319
Bond Position:  [-3.01415557]


portfolio before change:  [-3.73365105]
curr_Stock_Price:  107.26018561671613
curr_Factors:  [107.26018562  -1.36799997  -0.76201588]
mat_Sqrt:  [[12.7463082   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00599809 0.00091961 0.03602712]
Stock Position:  0.005998089599617877
Bond Position:  [-4.37700725]


portfolio before change:  [-3.73479635]
curr_Stock_Price:  107.25169763964958
curr_Factors:  [107.25169764  -1.66391069  -0.75511376]
mat_Sqrt:  [[ 9.5463027   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0226727  -0.05072642 -0.49321537]
Stock Position:  -0.022672703507168677
Bond Position:  [-1.30311041]


portfolio before change:  [-3.71186117]
curr_Stock_Price:  106.22575028475376
curr_Factors:  [106.22575028  -1.37608106  -0.74618637]
mat_Sqrt:  [[12.72157177  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00330166 -0.05145955  0.69619989]
Stock Position:  -0.0033016562153016585
Bond Position:  [-3.36114026]


portfolio before change:  [-3.71408533]
curr_Stock_Price:  106.64486391926428
curr_Factors:  [106.64486392  -1.20031081  -0.79162549]
mat_Sqrt:  [[14.54966517  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00430118 -0.03031857  0.30069342]
Stock Position:  0.004301180973944654
Bond Position:  [-4.17278419]


portfolio before change:  [-3.71523059]
curr_Stock_Price:  106.6211647001721
curr_Factors:  [106.6211647   -0.91582278  -0.77788402]
mat_Sqrt:  [[19.6008951   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00605387 -0.19186587 -0.82652353]
Stock Position:  -0.006053868917155621
Bond Position:  [-3.06976003]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-3.7058424]
Stock Price:  104.94360574110894
PL:  [-8.64944814]
Settle:  Tensor("sub_146:0", shape=(), dtype=float64)
PL:  Tensor("sub_147:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  74
output_Z_Vals[:, i, :]:  [[ 1.19271183e+02 -4.92738716e+01 -4.92570741e+01]
 [ 4.48898586e-02  8.10135033e-02 -3.36148345e-02]
 [-2.38142178e+00 -3.06728417e+00 -8.92544502e-01]
 [-4.73462032e-02  1.74600751e-02 -1.38070795e-01]
 [ 4.78901149e-01  1.54219790e-02 -1.07439219e-01]
 [-1.44024304e-01 -2.46779931e-01  2.03417075e-02]
 [-4.56666561e-02  8.78632782e-02 -5.97453247e-02]
 [ 1.16179208e-01  2.95786205e-01  1.60043203e-01]
 [-2.33012061e-01  5.32076882e-01 -1.15462457e-01]
 [-5.00958951e-01 -1.40549589e-01 -1.08952183e-02]
 [-1.01228461e-01 -3.83730376e-02 -3.57093569e-01]
 [ 4.26805672e-01  2.08968671e-01 -3.94206668e-04]
 [-7.28543848e-01 -9.70291674e-01  2.35809716e-01]
 [ 1.55605903e-01  6.70198355e-02  1.12699253e-01]
 [ 1.20083909e-01  1.39521292e-01 -1.04798463e-01]
 [-2.86035818e-01  1.52394733e-01  1.09663790e-01]
 [ 1.29170597e-02  1.14168966e-01  1.39366778e-01]
 [ 1.14826528e-01 -1.09489132e-02 -3.06729717e-02]
 [-6.52665643e-02 -2.90957233e-01  7.11195077e-02]
 [ 5.22799139e-02 -3.94889048e-01 -4.24909485e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.27118322 -49.27387164 -49.25707411]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [   7.3268874   -15.90307369 -140.51672192]
init_Out:  [2.48374395]
Stock Position:  7.326887399052493
Bond position:  [-730.20499595]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [0.69928304]
curr_Stock_Price:  99.78136871005975
curr_Factors:  [99.78136871 -1.17839221 -0.9716352 ]
mat_Sqrt:  [[11.62263015  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00469473  0.026147   -0.09589377]
Stock Position:  0.00469472663554114
Bond Position:  [0.23083679]


portfolio before change:  [0.69551793]
curr_Stock_Price:  98.96708771234982
curr_Factors:  [98.96708771 -0.84844671 -1.00518089]
mat_Sqrt:  [[15.50495644  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.2057225  -0.98996171 -2.54618103]
Stock Position:  -0.20572250124010896
Bond Position:  [21.05527475]


portfolio before change:  [1.13553002]
curr_Stock_Price:  96.85381563494167
curr_Factors:  [96.85381563 -0.84735055 -0.9784539 ]
mat_Sqrt:  [[15.60198798  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0046126   0.00563522 -0.39387755]
Stock Position:  -0.0046126021489247895
Bond Position:  [1.58227814]


portfolio before change:  [1.13906565]
curr_Stock_Price:  96.17306970444834
curr_Factors:  [96.1730697  -0.59740628 -0.93419862]
mat_Sqrt:  [[20.79150465  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.02213011  0.00497742 -0.30649419]
Stock Position:  0.022130106333104055
Bond Position:  [-0.98925461]


portfolio before change:  [1.14962303]
curr_Stock_Price:  96.6613060400496
curr_Factors:  [96.66130604 -0.8478504  -0.95815106]
mat_Sqrt:  [[15.8824022   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0119784  -0.07964788  0.05802923]
Stock Position:  -0.011978402908728265
Bond Position:  [2.3074711]


portfolio before change:  [1.14930697]
curr_Stock_Price:  96.73585649330818
curr_Factors:  [96.73585649 -0.51747207 -0.93788607]
mat_Sqrt:  [[22.57009929  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00176903  0.02835775 -0.17043678]
Stock Position:  -0.0017690264597442326
Bond Position:  [1.32043526]


portfolio before change:  [1.15576619]
curr_Stock_Price:  93.27120308044866
curr_Factors:  [ 9.32712031e+01 -2.79593740e-02 -9.26789321e-01]
mat_Sqrt:  [[35.90091264  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00582785 0.09546459 0.45655871]
Stock Position:  0.005827846171549829
Bond Position:  [0.61219596]


portfolio before change:  [1.15609045]
curr_Stock_Price:  93.30057887087257
curr_Factors:  [93.30057887 -0.11744583 -0.91399421]
mat_Sqrt:  [[33.2610244   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00444878  0.17172708 -0.32938225]
Stock Position:  -0.004448780530759493
Bond Position:  [1.57116425]


portfolio before change:  [1.16438794]
curr_Stock_Price:  91.52376786885657
curr_Factors:  [91.52376787 -0.31835398 -0.87678376]
mat_Sqrt:  [[27.70079061  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01920063 -0.04536218 -0.03108103]
Stock Position:  -0.019200625006202433
Bond Position:  [2.92170148]


portfolio before change:  [1.13902866]
curr_Stock_Price:  92.8825669172666
curr_Factors:  [92.88256692 -0.25558581 -0.9094211 ]
mat_Sqrt:  [[28.97197736  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0062803  -0.01238484 -1.01868856]
Stock Position:  -0.006280301181978635
Bond Position:  [1.72235916]


portfolio before change:  [1.14527905]
curr_Stock_Price:  91.95590093563654
curr_Factors:  [91.95590094 -0.14930829 -0.91411144]
mat_Sqrt:  [[31.74989409  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0147837   0.06744435 -0.00112456]
Stock Position:  0.014783695190150714
Bond Position:  [-0.21416896]


portfolio before change:  [1.15152205]
curr_Stock_Price:  92.38181310476085
curr_Factors:  [92.3818131  -0.66080124 -0.90146016]
mat_Sqrt:  [[19.36890093  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.04535463 -0.31316029  0.67269948]
Stock Position:  -0.04535463075167073
Bond Position:  [5.34146507]


portfolio before change:  [1.03281652]
curr_Stock_Price:  95.02853438141051
curr_Factors:  [95.02853438 -0.52476398 -0.92381026]
mat_Sqrt:  [[22.32267481  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00861415 0.02163056 0.3214996 ]
Stock Position:  0.008614151774687948
Bond Position:  [0.2142263]


portfolio before change:  [1.02474703]
curr_Stock_Price:  94.08554534899952
curr_Factors:  [94.08554535 -0.5707211  -0.93090725]
mat_Sqrt:  [[20.95916607  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00606759  0.0450303  -0.29896085]
Stock Position:  0.006067592418072772
Bond Position:  [0.45387429]


portfolio before change:  [1.02565332]
curr_Stock_Price:  94.21620736108822
curr_Factors:  [94.21620736 -0.49304943 -0.92195381]
mat_Sqrt:  [[22.88745577  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0101603   0.04918519  0.31284027]
Stock Position:  -0.010160296908161904
Bond Position:  [1.98291796]


portfolio before change:  [1.01472453]
curr_Stock_Price:  95.34064099901352
curr_Factors:  [95.340641   -0.5438462  -0.95526458]
mat_Sqrt:  [[21.29229754  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00303724 0.03684788 0.39757462]
Stock Position:  0.0030372404166177738
Bond Position:  [0.72515208]


portfolio before change:  [1.01753713]
curr_Stock_Price:  96.2069839328362
curr_Factors:  [96.20698393 -0.57632999 -0.92614471]
mat_Sqrt:  [[21.41362173  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00496555 -0.00353375 -0.08750145]
Stock Position:  0.004965554070424415
Bond Position:  [0.53981615]


portfolio before change:  [1.008303]
curr_Stock_Price:  94.32016446053673
curr_Factors:  [94.32016446 -0.37431857 -0.89661588]
mat_Sqrt:  [[26.46334451  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00416201 -0.09390604  0.20288416]
Stock Position:  -0.00416201179753901
Bond Position:  [1.40086464]


portfolio before change:  [1.0125722]
curr_Stock_Price:  93.37856625761027
curr_Factors:  [93.37856626 -0.54910583 -0.90588737]
mat_Sqrt:  [[21.79473956  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00527929 -0.12744989 -1.21214849]
Stock Position:  -0.005279290467810416
Bond Position:  [1.50554478]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [1.01498898]
Stock Price:  92.9920859053727
PL:  [1.01498898]
Settle:  Tensor("sub_148:0", shape=(), dtype=float64)
PL:  Tensor("sub_149:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  75
output_Z_Vals[:, i, :]:  [[ 1.19271183e+02 -4.92738716e+01 -4.92570741e+01]
 [ 1.07741269e-01  1.72915552e-01 -4.05492552e-02]
 [-2.75052437e+00 -3.09744891e+00 -9.51520494e-01]
 [-9.82759187e-02 -1.13511647e-02 -1.15601778e-01]
 [ 7.64755581e-01 -1.41321314e-01 -2.77168097e-01]
 [-1.39130694e-01 -2.18829971e-01  8.94465465e-03]
 [-1.80115159e-02  4.93763732e-02  1.78710622e-02]
 [ 1.20867342e-01  3.09588302e-01  1.72926204e-01]
 [ 8.75640667e-02  6.55287801e-02 -6.18416721e-02]
 [-9.02940523e-01 -3.69177935e-01 -3.00078009e-02]
 [ 2.31514682e-01  1.05281360e-02 -1.02434612e-01]
 [-4.00596796e-03 -5.11340059e-02  3.13602110e-02]
 [-5.49347669e-01 -1.21965779e+00  1.98095984e-01]
 [-2.21773131e-03  1.31919647e-02  3.44816778e-02]
 [-1.27277829e-01 -1.39434265e-01  3.38661316e-02]
 [ 7.32150614e-02  3.05264413e-02  5.95041936e-02]
 [ 2.13490611e-02  9.72015000e-03 -6.83292608e-03]
 [ 8.55996124e-03 -9.13699651e-02  1.62286805e-01]
 [ 5.41292510e-02 -6.81897819e-02  8.40965656e-02]
 [ 3.40442863e-02 -3.95827831e-01 -2.33280966e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.27118322 -49.27387164 -49.25707411]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [   7.3268874   -15.90307369 -140.51672192]
init_Out:  [2.48374395]
Stock Position:  7.326887399052493
Bond position:  [-730.20499595]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-9.19361064]
curr_Stock_Price:  98.43115092471761
curr_Factors:  [98.43115092 -0.84734651 -0.99618829]
mat_Sqrt:  [[15.57742147  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00865101  0.05580825 -0.11567574]
Stock Position:  0.00865100981861584
Bond Position:  [-10.04513949]


portfolio before change:  [-9.20308757]
curr_Stock_Price:  97.62600418708813
curr_Factors:  [97.62600419 -0.59661462 -1.00661284]
mat_Sqrt:  [[19.64683866  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.18206577 -0.99969734 -2.71442312]
Stock Position:  -0.1820657688556178
Bond Position:  [8.57126594]


portfolio before change:  [-9.2601726]
curr_Stock_Price:  97.95131582537246
curr_Factors:  [97.95131583 -0.16453909 -1.03448412]
mat_Sqrt:  [[29.5312008   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00420539 -0.00366357 -0.32977969]
Stock Position:  -0.004205385360142566
Bond Position:  [-8.84824957]


portfolio before change:  [-9.2619862]
curr_Stock_Price:  97.85649977492919
curr_Factors:  [ 9.78564998e+01 -1.48049419e-02 -1.05308241e+00]
mat_Sqrt:  [[33.63660012  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.02019621 -0.04561126 -0.79068343]
Stock Position:  0.02019620846261512
Bond Position:  [-11.23831647]


portfolio before change:  [-9.33111205]
curr_Stock_Price:  94.57291701882478
curr_Factors:  [ 9.45729170e+01 -9.38935589e-02 -1.00918847e+00]
mat_Sqrt:  [[31.3837145   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00579834 -0.07062707  0.02551661]
Stock Position:  -0.005798337058665112
Bond Position:  [-8.7827464]


portfolio before change:  [-9.35047461]
curr_Stock_Price:  97.53352370419351
curr_Factors:  [97.5335237  -0.1839578  -0.98580501]
mat_Sqrt:  [[30.27836233  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00014151  0.01593616  0.05098117]
Stock Position:  -0.00014150998503266275
Bond Position:  [-9.33667264]


portfolio before change:  [-9.35273062]
curr_Stock_Price:  96.9791635955419
curr_Factors:  [96.9791636  -0.35086348 -0.97507435]
mat_Sqrt:  [[25.75318531  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00851779 0.09991919 0.49331033]
Stock Position:  0.00851778916776664
Bond Position:  [-10.17877869]


portfolio before change:  [-9.33211616]
curr_Stock_Price:  99.69811760361888
curr_Factors:  [99.6981176  -0.93952671 -1.01116821]
mat_Sqrt:  [[14.17460338  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00623063  0.02114932 -0.17641708]
Stock Position:  0.006230628972919382
Bond Position:  [-9.95329814]


portfolio before change:  [-9.34219724]
curr_Stock_Price:  98.47954979518558
curr_Factors:  [98.4795498  -0.89780242 -0.98739096]
mat_Sqrt:  [[14.94916629  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.06585143 -0.11915167 -0.0856039 ]
Stock Position:  -0.0658514294936394
Bond Position:  [-2.85717811]


portfolio before change:  [-9.41726423]
curr_Stock_Price:  99.6086461402011
curr_Factors:  [99.60864614 -0.87043934 -1.01373154]
mat_Sqrt:  [[15.13603142  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01405615  0.00339794 -0.29221744]
Stock Position:  0.014056151505681345
Bond Position:  [-10.81737845]


portfolio before change:  [-9.4364354]
curr_Stock_Price:  98.43716723000162
curr_Factors:  [98.43716723 -0.42796463 -0.99489266]
mat_Sqrt:  [[23.72575482  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00033897 -0.01650343  0.08946195]
Stock Position:  -0.0003389682228967261
Bond Position:  [-9.40306832]


portfolio before change:  [-9.4391748]
curr_Stock_Price:  99.58282401873777
curr_Factors:  [99.58282402 -0.25243753 -0.98902116]
mat_Sqrt:  [[28.77569228  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02633727 -0.39364286  0.5651127 ]
Stock Position:  -0.026337267297963606
Bond Position:  [-6.81643534]


portfolio before change:  [-9.49515982]
curr_Stock_Price:  101.64380840311597
curr_Factors:  [101.6438084   -0.40222593  -0.97599445]
mat_Sqrt:  [[25.61695025  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00029331 0.00425769 0.09836663]
Stock Position:  0.00029330619587562894
Bond Position:  [-9.52497258]


portfolio before change:  [-9.49714934]
curr_Stock_Price:  102.98035934848045
curr_Factors:  [102.98035935  -0.32861283  -1.01454123]
mat_Sqrt:  [[26.88004595  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0055367  -0.04500222  0.09661065]
Stock Position:  -0.005536703104484605
Bond Position:  [-8.92697766]


portfolio before change:  [-9.49912428]
curr_Stock_Price:  102.93392718715783
curr_Factors:  [102.93392719  -0.6713177   -0.99474072]
mat_Sqrt:  [[19.45353655  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00470827 0.00985237 0.1697489 ]
Stock Position:  0.004708269240147894
Bond Position:  [-9.98376492]


portfolio before change:  [-9.4987871]
curr_Stock_Price:  103.53572732717632
curr_Factors:  [103.53572733  -0.81240854  -0.9883132 ]
mat_Sqrt:  [[17.10199298  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0012828   0.00313716 -0.01949244]
Stock Position:  0.001282798630117553
Bond Position:  [-9.63160259]


portfolio before change:  [-9.50101127]
curr_Stock_Price:  103.67918403810593
curr_Factors:  [103.67918404  -0.72683056  -1.01426835]
mat_Sqrt:  [[18.17782515  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00126725 -0.02948953  0.46295908]
Stock Position:  0.0012672473369103427
Bond Position:  [-9.63239844]


portfolio before change:  [-9.50024008]
curr_Stock_Price:  106.18824358881719
curr_Factors:  [106.18824359  -0.70605548  -1.00648892]
mat_Sqrt:  [[19.15701557  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00299505 -0.02200816  0.23990409]
Stock Position:  0.002995049484855031
Bond Position:  [-9.81827912]


portfolio before change:  [-9.50671134]
curr_Stock_Price:  104.84723411273023
curr_Factors:  [104.84723411  -0.29390411  -0.9879421 ]
mat_Sqrt:  [[29.09767183  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00324328 -0.12775288 -0.66548566]
Stock Position:  -0.0032432838538897593
Bond Position:  [-9.166662]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-9.50263727]
Stock Price:  102.88440152325995
PL:  [-12.38703879]
Settle:  Tensor("sub_150:0", shape=(), dtype=float64)
PL:  Tensor("sub_151:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  76
output_Z_Vals[:, i, :]:  [[ 1.19271183e+02 -4.92738716e+01 -4.92570741e+01]
 [ 3.23462462e-02  6.08607786e-02 -3.94358779e-02]
 [-2.20459049e+00 -2.96825392e+00 -8.45479741e-01]
 [ 1.01283485e-01  2.70126684e-01 -4.57876952e-02]
 [ 9.69112265e-01 -4.08310965e-02 -5.42392967e-01]
 [ 8.20870049e-02  1.76122936e-01  2.89771152e-02]
 [ 1.83854511e-02  3.94254210e-02  1.14909572e-01]
 [-1.35948073e-02  1.52334491e-01  2.13353357e-01]
 [ 5.37643956e-03 -1.46088516e-01  9.43481069e-03]
 [-1.37550970e+00 -5.76612721e-01 -5.29327499e-02]
 [ 1.48652271e-01  2.08531016e-02  5.27950831e-02]
 [ 5.63132464e-03 -6.25566292e-02  3.41445411e-02]
 [-5.41603985e-01 -1.26619050e+00  1.93598490e-01]
 [ 2.45406021e-01  4.12176572e-02  1.23783217e-01]
 [ 1.77335114e-01  1.66878278e-01 -1.07937418e-01]
 [-4.22227573e-01  2.06530969e-01  9.62355709e-02]
 [-6.59315811e-02  1.23931757e-01  1.75668913e-01]
 [ 1.15216134e-01 -1.08333916e-02 -3.18137274e-02]
 [-5.79615723e-02 -2.44348933e-01  4.86280418e-02]
 [ 8.68838020e-02 -6.64563038e-01 -6.61654874e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.27118322 -49.27387164 -49.25707411]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [   7.3268874   -15.90307369 -140.51672192]
init_Out:  [2.48374395]
Stock Position:  7.326887399052493
Bond position:  [-730.20499595]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [0.59759642]
curr_Stock_Price:  99.76749015430426
curr_Factors:  [99.76749015 -0.87267617 -0.96107873]
mat_Sqrt:  [[15.94407808  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00230302  0.01964273 -0.11249958]
Stock Position:  0.002303023453173986
Bond Position:  [0.36782955]


portfolio before change:  [0.59796444]
curr_Stock_Price:  99.88735499413171
curr_Factors:  [99.88735499 -1.08113061 -0.93197957]
mat_Sqrt:  [[13.34221293  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.22358102 -0.95799983 -2.41191836]
Stock Position:  -0.22358102245586092
Bond Position:  [22.9308814]


portfolio before change:  [0.47780916]
curr_Stock_Price:  100.45041138080555
curr_Factors:  [100.45041138  -1.07131084  -0.930259  ]
mat_Sqrt:  [[13.57316053  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01083583  0.08718301 -0.13061955]
Stock Position:  0.01083583212165771
Bond Position:  [-0.61065464]


portfolio before change:  [0.48693956]
curr_Stock_Price:  101.30711400190482
curr_Factors:  [101.307114    -0.7383487   -0.92943808]
mat_Sqrt:  [[19.11302158  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.04447555 -0.01317818 -1.54729616]
Stock Position:  0.044475550230943094
Bond Position:  [-4.01875008]


portfolio before change:  [0.46437631]
curr_Stock_Price:  100.82238842793798
curr_Factors:  [100.82238843  -0.19448493  -0.90825998]
mat_Sqrt:  [[33.46886239  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00370353 0.05684343 0.08266364]
Stock Position:  0.003703528252797555
Bond Position:  [0.09097775]


portfolio before change:  [0.46939086]
curr_Stock_Price:  102.17023763700996
curr_Factors:  [102.17023764  -0.40291742  -0.87262761]
mat_Sqrt:  [[28.53397226  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00174841 0.0127245  0.32780502]
Stock Position:  0.0017484053422997321
Bond Position:  [0.29075587]


portfolio before change:  [0.47098127]
curr_Stock_Price:  103.03829199309551
curr_Factors:  [103.03829199  -0.66466088  -0.86842852]
mat_Sqrt:  [[22.24264277  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00274477 0.04916575 0.60863774]
Stock Position:  0.0027447688096527358
Bond Position:  [0.18816497]


portfolio before change:  [0.47006293]
curr_Stock_Price:  102.6865746132723
curr_Factors:  [102.68657461  -0.36712083  -0.83864755]
mat_Sqrt:  [[30.75070771  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00073227 -0.04714987  0.02691489]
Stock Position:  -0.000732271965039724
Bond Position:  [0.54525743]


portfolio before change:  [0.46917788]
curr_Stock_Price:  104.08138707391649
curr_Factors:  [104.08138707  -0.25274713  -0.82078456]
mat_Sqrt:  [[35.57494042  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.04227738 -0.18610096 -0.1510024 ]
Stock Position:  -0.04227737608530271
Bond Position:  [4.86946582]


portfolio before change:  [0.48585053]
curr_Stock_Price:  103.71582188453156
curr_Factors:  [ 1.03715822e+02 -4.04744495e-02 -8.19384037e-01]
mat_Sqrt:  [[43.89481444  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00372904 0.00673031 0.15060968]
Stock Position:  0.003729042853475824
Bond Position:  [0.09908979]


portfolio before change:  [0.46856633]
curr_Stock_Price:  99.0741538696922
curr_Factors:  [99.07415387 -0.37053248 -0.80340223]
mat_Sqrt:  [[30.62859026  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-5.49383944e-06 -2.01900652e-02  9.74048717e-02]
Stock Position:  -5.493839438767059e-06
Bond Position:  [0.46911063]


portfolio before change:  [0.46869036]
curr_Stock_Price:  97.84776479464685
curr_Factors:  [97.84776479 -0.1690575  -0.78842918]
mat_Sqrt:  [[37.55949354  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0202491  -0.40866123  0.5522826 ]
Stock Position:  -0.020249099257352767
Bond Position:  [2.45001946]


portfolio before change:  [0.58164989]
curr_Stock_Price:  92.2995204926233
curr_Factors:  [92.29952049 -0.36456278 -0.76176528]
mat_Sqrt:  [[29.92549777  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00932605 0.01330294 0.35311906]
Stock Position:  0.009326049823483359
Bond Position:  [-0.27914004]


portfolio before change:  [0.55970136]
curr_Stock_Price:  89.95353964618471
curr_Factors:  [89.95353965 -0.69705559 -0.70589714]
mat_Sqrt:  [[22.11686803  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00856208  0.05385973 -0.30791541]
Stock Position:  0.008562078772442978
Bond Position:  [-0.21048793]


portfolio before change:  [0.57241354]
curr_Stock_Price:  91.44439310285104
curr_Factors:  [91.4443931  -0.9586106  -0.72673653]
mat_Sqrt:  [[16.95196795  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02126158  0.06665758  0.2745333 ]
Stock Position:  -0.02126157933559694
Bond Position:  [2.51666576]


portfolio before change:  [0.54705062]
curr_Stock_Price:  92.6668878667774
curr_Factors:  [92.66688787 -1.10651879 -0.73211524]
mat_Sqrt:  [[14.73723354  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-3.24066954e-04  3.99988025e-02  5.01134513e-01]
Stock Position:  -0.00032406695393727983
Bond Position:  [0.57708089]


portfolio before change:  [0.54668517]
curr_Stock_Price:  94.23980435599013
curr_Factors:  [94.23980436 -1.3530494  -0.78696124]
mat_Sqrt:  [[11.08765141  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00960626 -0.00349646 -0.09075571]
Stock Position:  0.009606256881458154
Bond Position:  [-0.3586066]


portfolio before change:  [0.5477011]
curr_Stock_Price:  94.35489502419261
curr_Factors:  [94.35489502 -1.27368804 -0.77356319]
mat_Sqrt:  [[12.1802029   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00803869 -0.07886328  0.13872227]
Stock Position:  -0.008038694662424297
Bond Position:  [1.30619129]


portfolio before change:  [0.54897745]
curr_Stock_Price:  94.23674667389668
curr_Factors:  [94.23674667 -1.37611929 -0.78724756]
mat_Sqrt:  [[10.83133526  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01697199 -0.2144868  -1.88751719]
Stock Position:  -0.016971988324444694
Bond Position:  [2.14836241]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [0.50322323]
Stock Price:  96.96426278604653
PL:  [0.50322323]
Settle:  Tensor("sub_152:0", shape=(), dtype=float64)
PL:  Tensor("sub_153:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  77
output_Z_Vals[:, i, :]:  [[ 1.19271183e+02 -4.92738716e+01 -4.92570741e+01]
 [ 2.73155355e-02  5.27783758e-02 -4.17704514e-02]
 [-2.23425846e+00 -3.00781693e+00 -8.56924588e-01]
 [ 6.35863814e-03  2.11769909e-01  4.36894880e-04]
 [ 4.42490646e-01 -5.75934771e-02 -2.76023899e-01]
 [-1.44090138e-01 -2.47105372e-01  2.12114576e-02]
 [-1.12122733e-02  3.35029974e-02 -1.57695596e-02]
 [ 6.47921363e-02  1.13488016e-01  8.90995071e-03]
 [ 1.93276451e-02 -1.10166851e-01 -2.66424726e-03]
 [-9.65672768e-01 -3.95428908e-01 -3.31908792e-02]
 [ 1.01530298e-01 -3.45099462e-02 -1.90715939e-01]
 [ 8.96136944e-03 -6.65209391e-02  3.51097915e-02]
 [-6.43391840e-01 -1.27491630e+00  2.24507794e-01]
 [ 5.10486356e-02  6.25284845e-02  1.44871922e-01]
 [ 9.16107872e-02  1.20880893e-01 -1.03159223e-01]
 [-7.18442201e-02  7.00295751e-02  1.23500059e-01]
 [ 9.22009174e-02  1.10967328e-01  1.04346392e-01]
 [ 1.15216134e-01 -1.08333916e-02 -3.18137274e-02]
 [-6.18675985e-02 -2.56384742e-01  5.49089106e-02]
 [ 7.46132919e-02 -5.72213704e-01 -5.88513171e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.27118322 -49.27387164 -49.25707411]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [   7.3268874   -15.90307369 -140.51672192]
init_Out:  [2.48374395]
Stock Position:  7.326887399052493
Bond position:  [-730.20499595]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [2.37162809]
curr_Stock_Price:  100.00961639041937
curr_Factors:  [100.00961639  -0.96835144  -1.00890476]
mat_Sqrt:  [[13.84619046  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00213507  0.01703415 -0.11915947]
Stock Position:  0.0021350651475418605
Bond Position:  [2.15810105]


portfolio before change:  [2.37204886]
curr_Stock_Price:  99.95396059521583
curr_Factors:  [99.9539606  -0.961015   -1.00698875]
mat_Sqrt:  [[13.96711914  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.21644732 -0.97076874 -2.44456733]
Stock Position:  -0.21644732128416416
Bond Position:  [24.00681588]


portfolio before change:  [2.09254661]
curr_Stock_Price:  101.27300995721149
curr_Factors:  [101.27300996  -0.96883185  -0.99082685]
mat_Sqrt:  [[14.27002585  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00348108 0.06834844 0.00124634]
Stock Position:  0.003481084830838835
Bond Position:  [1.74000667]


portfolio before change:  [2.08636667]
curr_Stock_Price:  99.37274102362133
curr_Factors:  [99.37274102 -1.18986563 -0.97744407]
mat_Sqrt:  [[11.37670838  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.03290858 -0.01858821 -0.78741935]
Stock Position:  0.03290857705696343
Bond Position:  [-1.18384884]


portfolio before change:  [2.09261855]
curr_Stock_Price:  99.5717129767207
curr_Factors:  [99.57171298 -1.46909923 -0.97060048]
mat_Sqrt:  [[ 8.68136178  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02190907 -0.07975292  0.06051038]
Stock Position:  -0.021909067432805986
Bond Position:  [4.27414193]


portfolio before change:  [2.08774473]
curr_Stock_Price:  99.8429475241499
curr_Factors:  [99.84294752 -1.63554396 -0.9347838 ]
mat_Sqrt:  [[ 7.63903024  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0009939   0.01081305 -0.04498616]
Stock Position:  -0.0009939023938212253
Bond Position:  [2.18697887]


portfolio before change:  [2.08788915]
curr_Stock_Price:  100.2478081377907
curr_Factors:  [100.24780814  -1.21409655  -0.90781165]
mat_Sqrt:  [[12.00996838  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00747517 0.0366281  0.02541761]
Stock Position:  0.007475166779616364
Bond Position:  [1.33852006]


portfolio before change:  [2.08659072]
curr_Stock_Price:  100.02933845710727
curr_Factors:  [100.02933846  -1.34970435  -0.87182601]
mat_Sqrt:  [[10.84748404  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00034145 -0.0355562  -0.00760036]
Stock Position:  -0.00034145303337653236
Bond Position:  [2.12074604]


portfolio before change:  [2.08722783]
curr_Stock_Price:  99.7164005587936
curr_Factors:  [99.71640056 -1.02305536 -0.89704457]
mat_Sqrt:  [[14.61765772  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.07204741 -0.12762413 -0.09468434]
Stock Position:  -0.07204741252364523
Bond Position:  [9.27153647]


portfolio before change:  [2.16647502]
curr_Stock_Price:  98.64864505191737
curr_Factors:  [98.64864505 -1.21279433 -0.87248826]
mat_Sqrt:  [[12.25926413  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00453178 -0.01113804 -0.54405949]
Stock Position:  0.004531777419619277
Bond Position:  [1.71942132]


portfolio before change:  [2.16791875]
curr_Stock_Price:  98.8723591817671
curr_Factors:  [98.87235918 -1.13872863 -0.88306032]
mat_Sqrt:  [[13.09251589  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00019474 -0.02146954  0.10015846]
Stock Position:  0.0001947368858969533
Bond Position:  [2.14866466]


portfolio before change:  [2.16834677]
curr_Stock_Price:  98.31150750925138
curr_Factors:  [98.31150751 -1.18630934 -0.87782566]
mat_Sqrt:  [[12.47848663  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.06874276 -0.41147747  0.64045824]
Stock Position:  -0.06874275739362899
Bond Position:  [8.92655088]


portfolio before change:  [2.22521457]
curr_Stock_Price:  97.51672000299602
curr_Factors:  [97.51672    -0.97804103 -0.89045736]
mat_Sqrt:  [[15.05221958  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00620401 0.02018098 0.41327927]
Stock Position:  0.00620400638118619
Bond Position:  [1.62022022]


portfolio before change:  [2.22625614]
curr_Stock_Price:  97.61930919354013
curr_Factors:  [97.61930919 -0.91638331 -0.88180072]
mat_Sqrt:  [[16.16569313  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00589076  0.03901414 -0.29428455]
Stock Position:  0.00589075935830566
Bond Position:  [1.65120428]


portfolio before change:  [2.23282488]
curr_Stock_Price:  98.66431692438363
curr_Factors:  [98.66431692 -1.00088041 -0.8986271 ]
mat_Sqrt:  [[14.76435521  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00219042  0.02260195  0.35231129]
Stock Position:  -0.0021904206724881036
Bond Position:  [2.44894124]


portfolio before change:  [2.23509982]
curr_Stock_Price:  97.9052729337071
curr_Factors:  [97.90527293 -1.11414922 -0.87303245]
mat_Sqrt:  [[13.42097446  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01014469 0.03581455 0.29767121]
Stock Position:  0.010144691572945013
Bond Position:  [1.24188102]


portfolio before change:  [2.22871632]
curr_Stock_Price:  97.24541986190461
curr_Factors:  [97.24541986 -0.87315187 -0.89515793]
mat_Sqrt:  [[16.59212335  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00641936 -0.00349646 -0.09075571]
Stock Position:  0.006419360883409995
Bond Position:  [1.60446288]


portfolio before change:  [2.21353176]
curr_Stock_Price:  94.81749516542912
curr_Factors:  [94.81749517 -0.93334193 -0.87789147]
mat_Sqrt:  [[15.4981482   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00664555 -0.08274782  0.15663984]
Stock Position:  -0.006645547521615268
Bond Position:  [2.84364593]


portfolio before change:  [2.2163084]
curr_Stock_Price:  94.50666508283356
curr_Factors:  [94.50666508 -1.05040232 -0.88839158]
mat_Sqrt:  [[13.59737084  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01193753 -0.18468118 -1.67886427]
Stock Position:  -0.011937534918421016
Bond Position:  [3.34448501]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [2.23009092]
Stock Price:  93.42216232065802
PL:  [2.23009092]
Settle:  Tensor("sub_154:0", shape=(), dtype=float64)
PL:  Tensor("sub_155:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  78
output_Z_Vals[:, i, :]:  [[ 1.19271183e+02 -4.92738716e+01 -4.92570741e+01]
 [ 1.41242645e-01  2.33699477e-01 -2.29084924e-02]
 [-2.42750140e+00 -2.76607851e+00 -8.33283627e-01]
 [-3.42892865e-02 -2.21865995e-02 -1.30957184e-01]
 [ 1.42187615e-01 -1.06453197e-01 -2.78222458e-02]
 [-1.34560074e-01 -1.98395525e-01 -8.20332826e-02]
 [-2.63408390e-02  3.95344038e-02 -6.13506629e-02]
 [ 2.57119222e-02  7.32386868e-02 -9.21131459e-03]
 [ 3.40075641e-02 -3.75002177e-02  1.24881773e-02]
 [-8.08058856e-01 -3.28973336e-01 -2.52040744e-02]
 [ 4.12444054e-02 -4.92173684e-02 -3.04619659e-01]
 [ 2.06499747e-01  7.59785546e-02  1.51799142e-02]
 [-7.29365505e-01 -9.97387927e-01  2.41045889e-01]
 [ 1.41423230e-01  7.71131044e-02  1.17967100e-01]
 [ 1.26100393e-01  1.40471408e-01 -1.05098467e-01]
 [-2.67672008e-01  1.46518946e-01  1.07996212e-01]
 [-6.74827675e-02  1.15095820e-01  1.71810312e-01]
 [ 1.13655022e-01 -1.12962751e-02 -2.72428334e-02]
 [-6.77265833e-02 -3.08927339e-01  7.97077722e-02]
 [ 7.45067025e-02 -5.70999752e-01 -5.87676815e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.27118322 -49.27387164 -49.25707411]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [   7.3268874   -15.90307369 -140.51672192]
init_Out:  [2.48374395]
Stock Position:  7.326887399052493
Bond position:  [-730.20499595]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-11.20331104]
curr_Stock_Price:  98.1568597706536
curr_Factors:  [98.15685977 -1.21438066 -0.96302481]
mat_Sqrt:  [[11.12462744  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01656417  0.07542618 -0.06535155]
Stock Position:  0.016564165884249867
Bond Position:  [-12.82919755]


portfolio before change:  [-11.19803751]
curr_Stock_Price:  98.66888256460948
curr_Factors:  [98.66888256 -1.15181322 -0.95607302]
mat_Sqrt:  [[11.98772707  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.26378796 -0.892748   -2.37712625]
Stock Position:  -0.2637879641046602
Bond Position:  [14.82962614]


portfolio before change:  [-11.03257004]
curr_Stock_Price:  98.05566430210551
curr_Factors:  [98.0556643  -1.29043501 -0.96608387]
mat_Sqrt:  [[10.26783755  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00638398 -0.00716069 -0.3735844 ]
Stock Position:  -0.006383976193145553
Bond Position:  [-10.40658502]


portfolio before change:  [-11.03302458]
curr_Stock_Price:  97.71928553345529
curr_Factors:  [97.71928553 -1.421605   -0.97122234]
mat_Sqrt:  [[ 8.92870702  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01285503 -0.03435762 -0.07936912]
Stock Position:  0.012855025378720157
Bond Position:  [-12.28920848]


portfolio before change:  [-11.02696648]
curr_Stock_Price:  98.42957491021306
curr_Factors:  [98.42957491 -1.58760227 -0.9929231 ]
mat_Sqrt:  [[ 7.45448565  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02572979 -0.06403188 -0.23401812]
Stock Position:  -0.02572979190964987
Bond Position:  [-8.494394]


portfolio before change:  [-11.02995226]
curr_Stock_Price:  98.46307379432078
curr_Factors:  [98.46307379 -1.29348271 -1.03785152]
mat_Sqrt:  [[ 9.56726496  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00321869  0.01275967 -0.17501636]
Stock Position:  -0.0032186904373497976
Bond Position:  [-10.71303011]


portfolio before change:  [-11.03266986]
curr_Stock_Price:  98.47519113432513
curr_Factors:  [98.47519113 -1.42510782 -1.05443622]
mat_Sqrt:  [[ 8.25039113  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00470056  0.02363768 -0.02627732]
Stock Position:  0.004700559553630506
Bond Position:  [-11.49555836]


portfolio before change:  [-11.03755028]
curr_Stock_Price:  98.04839688225242
curr_Factors:  [98.04839688 -1.28774316 -1.03898884]
mat_Sqrt:  [[ 9.57091873  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00301977 -0.01210314  0.03562529]
Stock Position:  0.003019773081333041
Bond Position:  [-11.33363419]


portfolio before change:  [-11.04301914]
curr_Stock_Price:  97.17578149704656
curr_Factors:  [97.1757815  -0.95692461 -1.05163513]
mat_Sqrt:  [[13.03922057  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.06751592 -0.10617569 -0.07190021]
Stock Position:  -0.06751592339101106
Bond Position:  [-4.48210652]


portfolio before change:  [-11.00444706]
curr_Stock_Price:  96.58787947722584
curr_Factors:  [96.58787948 -0.84236983 -1.07408064]
mat_Sqrt:  [[14.21080787  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00218019 -0.01588484 -0.8689951 ]
Stock Position:  -0.0021801909938503707
Bond Position:  [-10.79386703]


portfolio before change:  [-11.00250059]
curr_Stock_Price:  94.45720585309381
curr_Factors:  [94.45720585 -0.62640085 -1.02369811]
mat_Sqrt:  [[18.13870264  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01241034 0.02452197 0.04330407]
Stock Position:  0.012410335850985397
Bond Position:  [-12.17474624]


portfolio before change:  [-11.00684534]
curr_Stock_Price:  94.35239929155844
curr_Factors:  [94.35239929 -0.79237692 -1.0370577 ]
mat_Sqrt:  [[15.14396459  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.05835679 -0.32190557  0.68763683]
Stock Position:  -0.058356791063531394
Bond Position:  [-5.50074209]


portfolio before change:  [-11.07009954]
curr_Stock_Price:  95.41275304432904
curr_Factors:  [95.41275304 -0.7696858  -1.03808471]
mat_Sqrt:  [[15.64954341  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01158141 0.02488815 0.3365273 ]
Stock Position:  0.011581411999177109
Bond Position:  [-12.17511394]


portfolio before change:  [-11.08968392]
curr_Stock_Price:  93.98458298113582
curr_Factors:  [93.98458298 -0.59721502 -1.02901907]
mat_Sqrt:  [[18.4838369   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00721283  0.04533695 -0.29981667]
Stock Position:  0.007212834924200544
Bond Position:  [-11.76757921]


portfolio before change:  [-11.09026763]
curr_Stock_Price:  94.31157731341943
curr_Factors:  [94.31157731 -0.34234258 -0.9939655 ]
mat_Sqrt:  [[24.78641867  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00870313  0.04728879  0.30808313]
Stock Position:  -0.008703125754421013
Bond Position:  [-10.26946211]


portfolio before change:  [-11.07860171]
curr_Stock_Price:  92.67611824829028
curr_Factors:  [92.67611825 -0.27134151 -0.94953473]
mat_Sqrt:  [[27.33682171  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-3.26237574e-04  3.71470163e-02  4.90126998e-01]
Stock Position:  -0.00032623757440117875
Bond Position:  [-11.04836728]


portfolio before change:  [-11.0818682]
curr_Stock_Price:  94.22116854184343
curr_Factors:  [94.22116854 -0.57709632 -0.97615223]
mat_Sqrt:  [[19.93339214  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00530709 -0.00364586 -0.07771622]
Stock Position:  0.005307087638311949
Bond Position:  [-11.5819082]


portfolio before change:  [-11.08287468]
curr_Stock_Price:  94.57717584346844
curr_Factors:  [94.57717584 -0.73404145 -1.01307822]
mat_Sqrt:  [[16.48245538  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00694774 -0.09970587  0.22738409]
Stock Position:  -0.006947741027227505
Bond Position:  [-10.42577695]


portfolio before change:  [-11.08720727]
curr_Stock_Price:  94.82557594438171
curr_Factors:  [94.82557594 -0.99068346 -1.01287208]
mat_Sqrt:  [[12.78769816  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01266899 -0.18428938 -1.67647837]
Stock Position:  -0.012668985392833306
Bond Position:  [-9.88586343]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-11.09367427]
Stock Price:  95.14093117350754
PL:  [-11.09367427]
Settle:  Tensor("sub_156:0", shape=(), dtype=float64)
PL:  Tensor("sub_157:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  79
output_Z_Vals[:, i, :]:  [[ 1.19271183e+02 -4.92738716e+01 -4.92570741e+01]
 [ 1.59025399e-02  3.44421142e-02 -4.70668159e-02]
 [-2.25131282e+00 -3.03614822e+00 -8.65349730e-01]
 [-2.96944027e-02  2.55226426e-02 -1.17329408e-01]
 [ 5.06926028e-01 -1.28949209e-01 -2.21024037e-01]
 [-1.42412174e-01 -2.38810624e-01 -9.56448224e-04]
 [-1.51770280e-02  3.19009668e-02 -1.29702866e-02]
 [ 9.23070948e-02  2.25505531e-01  9.44425833e-02]
 [ 4.20729018e-02  1.20243784e-01 -5.93279923e-02]
 [-7.82102992e-01 -3.17995658e-01 -2.38895251e-02]
 [ 4.98939698e-02 -4.96683310e-02 -3.01161793e-01]
 [ 1.24535963e-01  3.76540958e-02  1.92653824e-02]
 [-5.18698062e-01 -1.24931861e+00  1.86142056e-01]
 [ 1.31166003e-02  2.94178090e-02  7.20489966e-02]
 [ 9.35023329e-02  1.22953153e-01 -1.03620884e-01]
 [-1.30257933e-01  8.77229695e-02  1.35609987e-01]
 [ 4.12684956e-02  1.21586712e-01  1.37053597e-01]
 [ 1.15216134e-01 -1.08333916e-02 -3.18137274e-02]
 [-6.54653822e-02 -2.88275569e-01  6.99703797e-02]
 [ 6.89643468e-02 -5.07877612e-01 -5.44188582e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.27118322 -49.27387164 -49.25707411]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [   7.3268874   -15.90307369 -140.51672192]
init_Out:  [2.48374395]
Stock Position:  7.326887399052493
Bond position:  [-730.20499595]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [5.89282658]
curr_Stock_Price:  100.49020225121401
curr_Factors:  [100.49020225  -1.04191931  -1.01379647]
mat_Sqrt:  [[12.86286464  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00103597  0.01111614 -0.13426852]
Stock Position:  0.0010359693445307744
Bond Position:  [5.78872181]


portfolio before change:  [5.89335742]
curr_Stock_Price:  99.60550446674169
curr_Factors:  [99.60550447 -0.94007167 -1.01167733]
mat_Sqrt:  [[14.14651673  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.21543839 -0.97991262 -2.46860191]
Stock Position:  -0.21543838777989643
Bond Position:  [27.35220672]


portfolio before change:  [6.11058607]
curr_Stock_Price:  98.62893875383676
curr_Factors:  [98.62893875 -0.91235436 -0.96924584]
mat_Sqrt:  [[15.02573671  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00322343  0.0082374  -0.33470814]
Stock Position:  -0.003223427985249578
Bond Position:  [6.42850935]


portfolio before change:  [6.11214931]
curr_Stock_Price:  98.64261587129569
curr_Factors:  [98.64261587 -0.78163346 -1.01235206]
mat_Sqrt:  [[16.40387949  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.02654787 -0.04161818 -0.63052006]
Stock Position:  0.02654786864626486
Bond Position:  [3.4933981]


portfolio before change:  [6.08563221]
curr_Stock_Price:  97.61087357279942
curr_Factors:  [97.61087357 -1.15474151 -1.01108195]
mat_Sqrt:  [[11.19162171  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01709801 -0.0770758  -0.00272848]
Stock Position:  -0.017098006711019815
Bond Position:  [7.75458358]


portfolio before change:  [6.07348752]
curr_Stock_Price:  98.43457082413717
curr_Factors:  [98.43457082 -0.90181267 -0.98962866]
mat_Sqrt:  [[14.8492706   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00076184  0.01029599 -0.03700062]
Stock Position:  -0.0007618434165397069
Bond Position:  [6.14847925]


portfolio before change:  [6.07647481]
curr_Stock_Price:  96.53131558348994
curr_Factors:  [96.53131558 -0.65714956 -1.00462791]
mat_Sqrt:  [[18.32177049  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00860267 0.0727816  0.2694184 ]
Stock Position:  0.008602674625671634
Bond Position:  [5.24604731]


portfolio before change:  [6.08834009]
curr_Stock_Price:  97.75809758155125
curr_Factors:  [97.75809758 -0.88199906 -0.95882159]
mat_Sqrt:  [[15.51295347  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00351366  0.03880851 -0.16924625]
Stock Position:  0.0035136626848213163
Bond Position:  [5.74485111]


portfolio before change:  [6.08693574]
curr_Stock_Price:  96.94961027521302
curr_Factors:  [96.94961028 -0.90372845 -1.00432523]
mat_Sqrt:  [[14.38430495  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.05922358 -0.10263266 -0.06815017]
Stock Position:  -0.05922357845033729
Bond Position:  [11.82863858]


portfolio before change:  [6.09775455]
curr_Stock_Price:  96.81687119780263
curr_Factors:  [96.8168712  -0.92093164 -1.00464457]
mat_Sqrt:  [[14.1150988   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0015387  -0.01603038 -0.85913077]
Stock Position:  -0.0015387018973634318
Bond Position:  [6.24672685]


portfolio before change:  [6.10109222]
curr_Stock_Price:  95.6627866217455
curr_Factors:  [95.66278662 -0.33509232 -1.0456336 ]
mat_Sqrt:  [[24.04924113  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00566149 0.01215281 0.05495877]
Stock Position:  0.0056614926906398445
Bond Position:  [5.55949805]


portfolio before change:  [6.11632453]
curr_Stock_Price:  98.10777086004393
curr_Factors:  [ 9.81077709e+01 -3.83441468e-02 -1.04442694e+00]
mat_Sqrt:  [[33.22476357  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02214367 -0.40321585  0.53101147]
Stock Position:  -0.022143665974169186
Bond Position:  [8.28879023]


portfolio before change:  [6.06520143]
curr_Stock_Price:  100.51006277521107
curr_Factors:  [100.51006278  -0.53265434  -1.06079733]
mat_Sqrt:  [[20.42595042  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00165615 0.00949456 0.20553573]
Stock Position:  0.001656149387720837
Bond Position:  [5.89874175]


portfolio before change:  [6.06309533]
curr_Stock_Price:  98.34783278248497
curr_Factors:  [98.34783278 -0.75627291 -1.04251719]
mat_Sqrt:  [[16.27646841  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00598708  0.03968296 -0.29560154]
Stock Position:  0.005987079824083996
Bond Position:  [5.474279]


portfolio before change:  [6.05799884]
curr_Stock_Price:  97.26796922651664
curr_Factors:  [97.26796923 -0.64895048 -1.03890251]
mat_Sqrt:  [[17.98641512  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00470746  0.02831247  0.38685755]
Stock Position:  -0.004707457444091047
Bond Position:  [6.51588366]


portfolio before change:  [6.06336196]
curr_Stock_Price:  96.4747706441327
curr_Factors:  [96.47477064 -1.08699464 -1.00820236]
mat_Sqrt:  [[11.87083476  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00792389 0.03924194 0.39097576]
Stock Position:  0.007923893260452845
Bond Position:  [5.29890618]


portfolio before change:  [6.0606128]
curr_Stock_Price:  95.96062230275983
curr_Factors:  [95.9606223  -1.03287854 -1.02190386]
mat_Sqrt:  [[12.29454333  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00866326 -0.00349646 -0.09075571]
Stock Position:  0.0086632601791348
Bond Position:  [5.22928096]


portfolio before change:  [6.05188279]
curr_Stock_Price:  94.80199529646637
curr_Factors:  [94.8019953  -1.04463861 -0.98935251]
mat_Sqrt:  [[12.40127558  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00887221 -0.09304054  0.19960602]
Stock Position:  -0.008872211717365875
Bond Position:  [6.89298617]


portfolio before change:  [6.03989603]
curr_Stock_Price:  96.347294454963
curr_Factors:  [96.34729445 -0.77296349 -1.00949085]
mat_Sqrt:  [[16.2080003   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0089948  -0.16391679 -1.55241855]
Stock Position:  -0.00899480275741633
Bond Position:  [6.90652094]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [6.04652833]
Stock Price:  95.80192926794152
PL:  [6.04652833]
Settle:  Tensor("sub_158:0", shape=(), dtype=float64)
PL:  Tensor("sub_159:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  80
output_Z_Vals[:, i, :]:  [[ 1.19271183e+02 -4.92738716e+01 -4.92570741e+01]
 [-1.21993120e-03  3.56876118e-03 -5.78722357e-02]
 [-3.31143640e+00 -3.11577492e+00 -1.03507856e+00]
 [ 7.92052985e-03  9.58614428e-02 -1.05274792e-01]
 [ 8.66611734e-01 -8.41120144e-02 -4.61290596e-01]
 [-1.47712969e-01 -2.65014257e-01  6.90733664e-02]
 [-6.53362605e-02  1.13466824e-01 -1.19119000e-01]
 [ 5.05027250e-02  1.02114699e-01  1.77044101e-03]
 [-1.13985667e-01  2.57759523e-01 -5.38800034e-02]
 [-6.29350303e-01 -2.29545435e-01 -1.66601666e-02]
 [ 2.03942992e-02 -5.51444610e-02 -3.22159361e-01]
 [-1.46764938e-02 -3.85026129e-02  2.82802557e-02]
 [-7.12629163e-01 -1.25399140e+00  2.44630505e-01]
 [ 2.80801073e-02  4.25307470e-02  1.00852776e-01]
 [ 1.39001543e-01  1.24553203e-01 -1.05463153e-01]
 [-1.01179083e-01  7.97778280e-02  1.18471713e-01]
 [ 7.83481647e-02  1.17490149e-01  1.18743842e-01]
 [ 1.15216134e-01 -1.08333916e-02 -3.18137274e-02]
 [-5.18534120e-02 -8.35705471e-02 -2.44882849e-02]
 [ 9.15902566e-02 -7.04659760e-01 -6.57383758e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.27118322 -49.27387164 -49.25707411]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [   7.3268874   -15.90307369 -140.51672192]
init_Out:  [2.48374395]
Stock Position:  7.326887399052493
Bond position:  [-730.20499595]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [3.2917616]
curr_Stock_Price:  100.13519952856211
curr_Factors:  [100.13519953  -0.38552199  -1.02365427]
mat_Sqrt:  [[24.46748306  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0005029   0.00115181 -0.16509338]
Stock Position:  -0.0005028952705565022
Bond Position:  [3.34211912]


portfolio before change:  [3.2948882]
curr_Stock_Price:  95.57965994260927
curr_Factors:  [95.57965994 -0.24499655 -1.00360512]
mat_Sqrt:  [[27.42234982  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.15165461 -1.00561203 -2.95279102]
Stock Position:  -0.15165461178331294
Bond Position:  [17.78998442]


portfolio before change:  [2.67533289]
curr_Stock_Price:  99.69429486249784
curr_Factors:  [99.69429486 -0.46393357 -1.02693779]
mat_Sqrt:  [[22.44879854  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 2.67232031e-04  3.09391476e-02 -3.00319678e-01]
Stock Position:  0.0002672320306513558
Bond Position:  [2.64869138]


portfolio before change:  [2.67613114]
curr_Stock_Price:  100.20320150069102
curr_Factors:  [100.2032015   -0.54973751  -0.97851472]
mat_Sqrt:  [[21.73552274  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.03474873 -0.02714704 -1.31593367]
Stock Position:  0.034748733719025975
Bond Position:  [-0.80580323]


portfolio before change:  [2.58117164]
curr_Stock_Price:  97.47625263526179
curr_Factors:  [97.47625264 -0.73109273 -0.95257965]
mat_Sqrt:  [[18.1004428   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01037042 -0.08553298  0.19704709]
Stock Position:  -0.010370422280639594
Bond Position:  [3.59204155]


portfolio before change:  [2.59502224]
curr_Stock_Price:  96.22727045365495
curr_Factors:  [96.22727045 -0.7341342  -0.97250557]
mat_Sqrt:  [[17.46280208  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00380752  0.03662126 -0.33981335]
Stock Position:  -0.0038075221687908127
Bond Position:  [2.9614097]


portfolio before change:  [2.599074]
curr_Stock_Price:  95.35759195931612
curr_Factors:  [95.35759196 -0.99699681 -0.99547505]
mat_Sqrt:  [[13.00276582  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00551484 0.03295738 0.00505058]
Stock Position:  0.005514841332272133
Bond Position:  [2.07319201]


portfolio before change:  [2.59581847]
curr_Stock_Price:  94.6732745264507
curr_Factors:  [94.67327453 -0.8313475  -0.91280871]
mat_Sqrt:  [[16.54817019  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00437323  0.08319153 -0.15370465]
Stock Position:  -0.004373228773299832
Bond Position:  [3.00984635]


portfolio before change:  [2.59635194]
curr_Stock_Price:  94.7233702199676
curr_Factors:  [94.72337022 -0.83928794 -0.88866314]
mat_Sqrt:  [[16.82741956  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.04038687 -0.07408547 -0.04752682]
Stock Position:  -0.04038687026240856
Bond Position:  [6.4219324]


portfolio before change:  [2.537373]
curr_Stock_Price:  96.22347712352901
curr_Factors:  [96.22347712 -1.10455936 -0.9155004 ]
mat_Sqrt:  [[12.7638073   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00443618 -0.0177978  -0.91903098]
Stock Position:  -0.004436177981191757
Bond Position:  [2.96423747]


portfolio before change:  [2.53296264]
curr_Stock_Price:  97.38472867684737
curr_Factors:  [97.38472868 -1.50560799 -0.9337947 ]
mat_Sqrt:  [[ 8.49320745  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00197371 -0.01242666  0.0806757 ]
Stock Position:  -0.001973709439389355
Bond Position:  [2.72517179]


portfolio before change:  [2.5321466]
curr_Stock_Price:  98.14340969304716
curr_Factors:  [98.14340969 -1.73981949 -0.91286297]
mat_Sqrt:  [[ 6.91537588  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.1328437  -0.40472398  0.69786274]
Stock Position:  -0.13284369611214422
Bond Position:  [15.56987989]


portfolio before change:  [2.50048618]
curr_Stock_Price:  98.41104281896041
curr_Factors:  [98.41104282 -2.03399495 -0.83102444]
mat_Sqrt:  [[ 5.60766061  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01022675 0.01372674 0.2877049 ]
Stock Position:  0.01022675056582458
Bond Position:  [1.49406099]


portfolio before change:  [2.504913]
curr_Stock_Price:  98.80738146396166
curr_Factors:  [98.80738146 -1.96642449 -0.85037069]
mat_Sqrt:  [[ 5.90841221  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.02418556  0.04019937 -0.30085702]
Stock Position:  0.024185564262567717
Bond Position:  [0.11520072]


portfolio before change:  [2.49218746]
curr_Stock_Price:  98.28002794687966
curr_Factors:  [98.28002795 -1.75857273 -0.82128469]
mat_Sqrt:  [[ 7.44813313  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00815125  0.02574818  0.33796682]
Stock Position:  -0.00815124592409495
Bond Position:  [3.29329214]


portfolio before change:  [2.50016221]
curr_Stock_Price:  97.402698797781
curr_Factors:  [97.4026988  -1.3873684  -0.83658594]
mat_Sqrt:  [[10.53707068  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.0120118  0.03791978 0.33874313]
Stock Position:  0.012011803856451389
Bond Position:  [1.3301801]


portfolio before change:  [2.50163501]
curr_Stock_Price:  97.49762338388675
curr_Factors:  [97.49762338 -1.23039843 -0.80001275]
mat_Sqrt:  [[12.79963718  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00832139 -0.00349646 -0.09075571]
Stock Position:  0.008321394279060484
Bond Position:  [1.69031885]


portfolio before change:  [2.50548083]
curr_Stock_Price:  97.90899481325772
curr_Factors:  [97.90899481 -1.36523243 -0.79812639]
mat_Sqrt:  [[11.25350462  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00656781 -0.02697228 -0.06985826]
Stock Position:  -0.006567805426341636
Bond Position:  [3.14852806]


portfolio before change:  [2.50155304]
curr_Stock_Price:  98.62689438754913
curr_Factors:  [98.62689439 -1.36924251 -0.83153766]
mat_Sqrt:  [[10.91964892  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01707342 -0.22742796 -1.87533288]
Stock Position:  -0.017073416339572562
Bond Position:  [4.18545107]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [2.51028111]
Stock Price:  98.17697943330307
PL:  [2.51028111]
Settle:  Tensor("sub_160:0", shape=(), dtype=float64)
PL:  Tensor("sub_161:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  81
output_Z_Vals[:, i, :]:  [[ 1.19271183e+02 -4.92738716e+01 -4.92570741e+01]
 [ 4.44474699e-02  4.02362531e-02 -1.17777724e-01]
 [-2.26545738e+00 -3.04942149e+00 -8.68960016e-01]
 [-4.01467055e-01 -2.82672015e-01  2.58598723e-01]
 [ 8.79573544e-01  4.31471837e-01 -8.68701676e-01]
 [ 8.46803839e-02  2.00116748e-01  4.35193089e-02]
 [ 1.04367746e-01 -1.79482920e-01 -1.17644323e-01]
 [ 1.42762481e-01  4.17397669e-01  2.99504718e-01]
 [ 3.10681959e-03 -1.51932350e-01  1.14031183e-02]
 [-1.38641937e+00 -5.69975630e-01 -5.45721511e-02]
 [ 2.41314950e-01  4.16429061e-02  1.11631583e-02]
 [ 9.20975636e-02  2.16687969e-02  2.10075602e-02]
 [-6.73558057e-01 -9.26746781e-01  2.21887210e-01]
 [ 2.97001258e-01  5.46358887e-02  1.76260833e-01]
 [ 1.51636010e-01  1.54159029e-01 -1.06521580e-01]
 [-3.02392837e-01  1.61996976e-01  9.34908545e-02]
 [-9.50894038e-02  1.21914162e-01  1.94225854e-01]
 [ 1.11560410e-01 -1.19173458e-02 -2.11098693e-02]
 [-1.04096728e-01 -5.42374357e-01  1.72326315e-01]
 [ 1.99943722e-02 -2.30980991e-01 -1.96789625e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.27118322 -49.27387164 -49.25707411]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [   7.3268874   -15.90307369 -140.51672192]
init_Out:  [2.48374395]
Stock Position:  7.326887399052493
Bond position:  [-730.20499595]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [24.8329864]
curr_Stock_Price:  103.07522352803475
curr_Factors:  [103.07522353  -0.84356192  -1.03694413]
mat_Sqrt:  [[15.72030203  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00182054  0.01298619 -0.33598706]
Stock Position:  0.001820536489794835
Bond Position:  [24.64533419]


portfolio before change:  [24.8394387]
curr_Stock_Price:  103.23462789987487
curr_Factors:  [103.2346279   -0.65673666  -1.07370326]
mat_Sqrt:  [[18.29384052  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.16755878 -0.98419655 -2.47890105]
Stock Position:  -0.16755878300672492
Bond Position:  [42.13730732]


portfolio before change:  [24.87534865]
curr_Stock_Price:  103.08319268623079
curr_Factors:  [103.08319269  -0.73260104  -1.13134108]
mat_Sqrt:  [[15.98409615  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02542408 -0.091232    0.73771018]
Stock Position:  -0.02542408352063396
Bond Position:  [27.49614435]


portfolio before change:  [24.81190644]
curr_Stock_Price:  105.84896034199203
curr_Factors:  [105.84896034  -0.74967731  -1.16756793]
mat_Sqrt:  [[15.56100234  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.05078878  0.13925694 -2.47816408]
Stock Position:  0.05078878335550328
Bond Position:  [19.43596652]


portfolio before change:  [24.74468702]
curr_Stock_Price:  104.42976868028097
curr_Factors:  [104.42976868  -0.47961632  -1.20702722]
mat_Sqrt:  [[19.33411656  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00695208 0.0645874  0.12414847]
Stock Position:  0.006952083137098907
Bond Position:  [24.01868258]


portfolio before change:  [24.75952143]
curr_Stock_Price:  105.69974659945301
curr_Factors:  [105.6997466   -0.47502347  -1.15974149]
mat_Sqrt:  [[20.61126024  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00212102 -0.05792786 -0.33560651]
Stock Position:  0.002121020306276057
Bond Position:  [24.53533012]


portfolio before change:  [24.75744614]
curr_Stock_Price:  101.82901923153797
curr_Factors:  [101.82901923  -0.43862151  -1.1716223 ]
mat_Sqrt:  [[20.34939772  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01420679 0.13471452 0.85440359]
Stock Position:  0.014206787418053273
Bond Position:  [23.31078291]


portfolio before change:  [24.78529083]
curr_Stock_Price:  103.37871992916777
curr_Factors:  [103.37871993  -0.24660976  -1.21189756]
mat_Sqrt:  [[24.04415223  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00106382 -0.04903595  0.03252992]
Stock Position:  -0.0010638174880835986
Bond Position:  [24.89526692]


portfolio before change:  [24.79246401]
curr_Stock_Price:  102.48704304031307
curr_Factors:  [102.48704304  -0.15148375  -1.22132565]
mat_Sqrt:  [[25.96960935  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.05829524 -0.18395884 -0.15567916]
Stock Position:  -0.05829524179148994
Bond Position:  [30.76697096]


portfolio before change:  [24.87692954]
curr_Stock_Price:  101.17007744794088
curr_Factors:  [101.17007745  -0.11784262  -1.15571736]
mat_Sqrt:  [[28.3107917   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00890452 0.01344019 0.03184538]
Stock Position:  0.008904517590939586
Bond Position:  [23.9760588]


portfolio before change:  [24.83917578]
curr_Stock_Price:  96.25700752739283
curr_Factors:  [ 9.62570075e+01 -3.44309564e-02 -1.16080060e+00]
mat_Sqrt:  [[29.13063063  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00346058 0.00699357 0.05992872]
Stock Position:  0.0034605786529923748
Bond Position:  [24.50607084]


portfolio before change:  [24.83544702]
curr_Stock_Price:  93.40891410346808
curr_Factors:  [ 9.34089141e+01 -3.25272557e-02 -1.15266675e+00]
mat_Sqrt:  [[28.55387851  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02862788 -0.29910624  0.63298245]
Stock Position:  -0.02862787674970444
Bond Position:  [27.5095459]


portfolio before change:  [24.90967685]
curr_Stock_Price:  91.0562566732363
curr_Factors:  [91.05625667 -0.20788227 -1.16801655]
mat_Sqrt:  [[23.00194316  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01496103 0.01763366 0.50282309]
Stock Position:  0.014961034016866433
Bond Position:  [23.5473811]


portfolio before change:  [24.9220679]
curr_Stock_Price:  91.49095024072554
curr_Factors:  [91.49095024 -0.40102631 -1.14544044]
mat_Sqrt:  [[19.48750149  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00828018  0.04975461 -0.30387642]
Stock Position:  0.008280177098396476
Bond Position:  [24.16450663]


portfolio before change:  [24.93962204]
curr_Stock_Price:  92.88128990484488
curr_Factors:  [92.8812899  -0.28183362 -1.14875841]
mat_Sqrt:  [[22.21416607  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01126496  0.0522843   0.26670338]
Stock Position:  -0.011264955920438758
Bond Position:  [25.98592567]


portfolio before change:  [24.95496067]
curr_Stock_Price:  92.09643666079181
curr_Factors:  [92.09643666 -0.35929254 -1.15781886]
mat_Sqrt:  [[20.20085329  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00151269  0.03934763  0.5540723 ]
Stock Position:  -0.0015126882416302107
Bond Position:  [25.09427386]


portfolio before change:  [24.96119625]
curr_Stock_Price:  92.12206824192843
curr_Factors:  [92.12206824 -0.23467568 -1.12302523]
mat_Sqrt:  [[23.69854399  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.004423   -0.00384631 -0.06022058]
Stock Position:  0.004423004125391273
Bond Position:  [24.55373996]


portfolio before change:  [24.95773367]
curr_Stock_Price:  89.95119615329446
curr_Factors:  [ 8.99511962e+01 -7.41352524e-03 -1.11482883e+00]
mat_Sqrt:  [[29.28351997  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00613425 -0.17505057  0.49159901]
Stock Position:  -0.00613425123635361
Bond Position:  [25.50951691]


portfolio before change:  [24.95319189]
curr_Stock_Price:  91.73135838491035
curr_Factors:  [ 9.17313584e+01  4.40360615e-02 -1.15214692e+00]
mat_Sqrt:  [[30.2880556   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00222279 -0.07454879 -0.56138602]
Stock Position:  -0.002222788413284441
Bond Position:  [25.15709129]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [24.95871152]
Stock Price:  92.07796213004144
PL:  [24.95871152]
Settle:  Tensor("sub_162:0", shape=(), dtype=float64)
PL:  Tensor("sub_163:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  82
output_Z_Vals[:, i, :]:  [[ 1.19271183e+02 -4.92738716e+01 -4.92570741e+01]
 [ 2.20848177e-02  4.43746390e-02 -4.41978412e-02]
 [-2.39686946e+00 -3.26750261e+00 -9.33805425e-01]
 [-4.83915205e-02  1.48323964e-02 -1.32469800e-01]
 [ 6.10928984e-01 -8.92882212e-02 -3.27063962e-01]
 [ 7.80384862e-02  1.38666245e-01  6.27532627e-03]
 [ 1.50823678e-02  2.67573923e-02  1.03620541e-01]
 [ 1.46597587e-01  4.08472038e-01  2.75913137e-01]
 [ 6.45891049e-02  1.21024144e-01 -6.62132783e-02]
 [-1.24279879e+00 -5.10816574e-01 -4.72647494e-02]
 [ 3.04015591e-01  3.61608842e-02 -2.44472928e-02]
 [-1.81027404e-01 -7.41224564e-04  2.84340178e-02]
 [-7.39362782e-01 -8.86989409e-01  2.59359121e-01]
 [-2.47757916e-03 -1.14624569e-02 -6.27195620e-02]
 [-1.96823415e-01 -2.59790516e-01  1.00524167e-01]
 [ 7.45334058e-02  3.01715927e-02  5.88800103e-02]
 [ 1.25539909e-01  1.15578973e-01  1.03380930e-01]
 [ 9.97833444e-02 -1.55819069e-02  6.05971108e-03]
 [-4.73927732e-02 -1.35391645e-01  1.77244252e-02]
 [ 3.01570807e-02 -2.21562999e-01 -2.59309346e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.27118322 -49.27387164 -49.25707411]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [   7.3268874   -15.90307369 -140.51672192]
init_Out:  [2.48374395]
Stock Position:  7.326887399052493
Bond position:  [-730.20499595]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [2.1942487]
curr_Stock_Price:  99.98540701163104
curr_Factors:  [99.98540701 -0.84778895 -1.02552941]
mat_Sqrt:  [[15.35906557  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00144025  0.01432185 -0.12608414]
Stock Position:  0.001440250794838092
Bond Position:  [2.05024464]


portfolio before change:  [2.19376723]
curr_Stock_Price:  99.29518435460999
curr_Factors:  [99.29518435 -0.63319116 -1.03726703]
mat_Sqrt:  [[18.68346453  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.17418921 -1.05458193 -2.66388696]
Stock Position:  -0.17418920711451244
Bond Position:  [19.48991666]


portfolio before change:  [2.26331012]
curr_Stock_Price:  98.92392252808607
curr_Factors:  [98.92392253 -0.60386147 -1.04357458]
mat_Sqrt:  [[19.0471037   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00380132  0.00478714 -0.37789947]
Stock Position:  -0.003801320982200965
Bond Position:  [2.6393517]


portfolio before change:  [2.26197145]
curr_Stock_Price:  99.44968464267804
curr_Factors:  [99.44968464 -0.5212     -1.06643053]
mat_Sqrt:  [[20.32844844  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.02587219 -0.02881765 -0.93302245]
Stock Position:  0.02587218850984898
Bond Position:  [-0.31100954]


portfolio before change:  [2.29736503]
curr_Stock_Price:  100.82070657982592
curr_Factors:  [100.82070658  -0.442118    -1.10950817]
mat_Sqrt:  [[21.36422046  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00503761 0.04475434 0.01790176]
Stock Position:  0.005037607658065739
Bond Position:  [1.78946986]


portfolio before change:  [2.29787802]
curr_Stock_Price:  100.83372256712835
curr_Factors:  [100.83372257  -0.65419279  -1.10724504]
mat_Sqrt:  [[17.32299867  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00240695 0.00863591 0.29560056]
Stock Position:  0.0024069534799770367
Bond Position:  [2.05517594]


portfolio before change:  [2.29887673]
curr_Stock_Price:  101.03515894509104
curr_Factors:  [101.03515895  -0.46086639  -1.14098608]
mat_Sqrt:  [[20.36089395  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01406113 0.13183378 0.78710338]
Stock Position:  0.014061127496695457
Bond Position:  [0.87820848]


portfolio before change:  [2.28952735]
curr_Stock_Price:  100.35463313003491
curr_Factors:  [100.35463313  -0.37762517  -1.11286156]
mat_Sqrt:  [[22.60618425  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00335206  0.03906037 -0.18888805]
Stock Position:  0.0033520617680105795
Bond Position:  [1.95313242]


portfolio before change:  [2.29328057]
curr_Stock_Price:  101.32862488667641
curr_Factors:  [101.32862489  -0.32972363  -1.1295631 ]
mat_Sqrt:  [[23.54897322  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.05761256 -0.16486534 -0.13483317]
Stock Position:  -0.057612561417333834
Bond Position:  [8.1310822]


portfolio before change:  [2.31937965]
curr_Stock_Price:  100.91090247390308
curr_Factors:  [100.91090247  -0.24397417  -1.12203222]
mat_Sqrt:  [[25.74477214  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0119017   0.01167088 -0.06974132]
Stock Position:  0.011901702455368066
Bond Position:  [1.11836812]


portfolio before change:  [2.33328998]
curr_Stock_Price:  102.05617564204154
curr_Factors:  [102.05617564  -0.29079003  -1.11127024]
mat_Sqrt:  [[25.11494627  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00698288 -0.00023923  0.08111434]
Stock Position:  -0.006982879222718908
Bond Position:  [3.04593593]


portfolio before change:  [2.32661913]
curr_Stock_Price:  103.12055536020107
curr_Factors:  [103.12055536  -0.15216729  -1.11073749]
mat_Sqrt:  [[29.16571753  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02974305 -0.2862746   0.73987938]
Stock Position:  -0.029743045984721616
Bond Position:  [5.39373855]


portfolio before change:  [2.24351179]
curr_Stock_Price:  105.96007422341732
curr_Factors:  [ 1.05960074e+02  2.08741976e-02 -1.08358517e+00]
mat_Sqrt:  [[36.61109697  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00048127 -0.00369949 -0.17892145]
Stock Position:  -0.0004812726689739243
Bond Position:  [2.29450748]


portfolio before change:  [2.24400091]
curr_Stock_Price:  106.13582009574132
curr_Factors:  [ 1.06135820e+02 -5.96486416e-03 -1.09281021e+00]
mat_Sqrt:  [[35.37284791  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00648332 -0.08384703  0.28676747]
Stock Position:  -0.006483320860104614
Bond Position:  [2.93211348]


portfolio before change:  [2.24513045]
curr_Stock_Price:  106.07467497222419
curr_Factors:  [106.07467497   0.38929483  -1.10937922]
mat_Sqrt:  [[51.62773045  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00179576 0.00973784 0.16796828]
Stock Position:  0.0017957595147171834
Bond Position:  [2.05464584]


portfolio before change:  [2.2368301]
curr_Stock_Price:  101.16640313530158
curr_Factors:  [101.16640314   0.42001069  -1.10627969]
mat_Sqrt:  [[50.93232156  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00334237 0.03730295 0.29491702]
Stock Position:  0.0033423748864784436
Bond Position:  [1.89869405]


portfolio before change:  [2.23353424]
curr_Stock_Price:  100.03828681937755
curr_Factors:  [100.03828682   0.2333872   -1.11906184]
mat_Sqrt:  [[41.25937437  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00237133 -0.00502904  0.01728667]
Stock Position:  0.0023713310193939647
Bond Position:  [1.99631035]


portfolio before change:  [2.23184583]
curr_Stock_Price:  99.11578593765
curr_Factors:  [ 9.91157859e+01  9.50507718e-02 -1.11932264e+00]
mat_Sqrt:  [[35.58829706  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0020066  -0.04369747  0.05056285]
Stock Position:  -0.002006600478153579
Bond Position:  [2.43073161]


portfolio before change:  [2.22867505]
curr_Stock_Price:  100.99884122163495
curr_Factors:  [100.99884122   0.19159494  -1.13236612]
mat_Sqrt:  [[39.42254506  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00172492 -0.07150915 -0.73973739]
Stock Position:  -0.0017249159253207831
Bond Position:  [2.40288956]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [2.23466332]
Stock Price:  97.87551524634998
PL:  [2.23466332]
Settle:  Tensor("sub_164:0", shape=(), dtype=float64)
PL:  Tensor("sub_165:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  83
output_Z_Vals[:, i, :]:  [[ 1.19271183e+02 -4.92738716e+01 -4.92570741e+01]
 [ 1.81989076e-02  3.81314872e-02 -4.60011535e-02]
 [-2.27236794e+00 -3.10192229e+00 -8.85924399e-01]
 [-8.27777988e-03  7.02692414e-02 -1.11201691e-01]
 [ 3.68213235e-01 -7.32694505e-02 -2.16207217e-01]
 [-8.13971670e-02 -1.24877321e-01  2.68100820e-02]
 [ 1.27860189e-02  2.26625029e-02  9.47647912e-02]
 [-4.70341942e-03  6.40344063e-02  7.81206107e-02]
 [-4.56385251e-03 -1.71682851e-01  1.80554399e-02]
 [-1.29018271e+00 -5.15409038e-01 -4.99929127e-02]
 [ 2.97238786e-01  8.04030266e-02  6.54868244e-02]
 [-2.33723534e-01  2.23772191e-02  2.58236990e-02]
 [-7.61269157e-01 -9.00236393e-01  2.68795458e-01]
 [-3.09836670e-03 -5.50243840e-03  8.26422387e-03]
 [ 9.06639154e-02  1.29631947e-01 -1.04132506e-01]
 [ 1.34212088e-03  4.98719211e-02  9.35331486e-02]
 [ 1.16863588e-01  1.03287585e-01  8.64923291e-02]
 [ 1.01553196e-01 -1.49248254e-02  6.48496690e-03]
 [-4.50488731e-02 -9.12303889e-02  1.36147080e-03]
 [ 6.83941677e-02 -5.82681520e-01 -4.79848074e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.27118322 -49.27387164 -49.25707411]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [   7.3268874   -15.90307369 -140.51672192]
init_Out:  [2.48374395]
Stock Position:  7.326887399052493
Bond position:  [-730.20499595]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [2.89424681]
curr_Stock_Price:  100.08094527622899
curr_Factors:  [100.08094528  -0.83545764  -1.03721369]
mat_Sqrt:  [[15.38369196  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00107858  0.01230688 -0.13122849]
Stock Position:  0.0010785784539023848
Bond Position:  [2.78630165]


portfolio before change:  [2.89410598]
curr_Stock_Price:  99.3044689386869
curr_Factors:  [99.30446894 -0.80731758 -1.07777774]
mat_Sqrt:  [[15.07586708  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.20472346 -1.00114111 -2.52729572]
Stock Position:  -0.20472346428408178
Bond Position:  [23.22406088]


portfolio before change:  [2.89647813]
curr_Stock_Price:  99.32124565633563
curr_Factors:  [99.32124566 -0.87432849 -1.10428664]
mat_Sqrt:  [[13.73221287  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00121125  0.0226793  -0.31722747]
Stock Position:  -0.0012112455019830668
Bond Position:  [3.01678054]


portfolio before change:  [2.89767665]
curr_Stock_Price:  98.95448943206762
curr_Factors:  [98.95448943 -0.86515566 -1.07080764]
mat_Sqrt:  [[14.27766951  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.02165088 -0.02364761 -0.61677901]
Stock Position:  0.021650876365250378
Bond Position:  [0.75522524]


portfolio before change:  [2.89255764]
curr_Stock_Price:  98.70933339471848
curr_Factors:  [98.70933339 -0.85494771 -1.06642899]
mat_Sqrt:  [[14.45156621  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00701758 -0.04030398  0.0764817 ]
Stock Position:  -0.007017582519373707
Bond Position:  [3.58525853]


portfolio before change:  [2.88038241]
curr_Stock_Price:  100.5720342189718
curr_Factors:  [100.57203422  -0.89111323  -1.08039376]
mat_Sqrt:  [[14.00433941  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.0026246  0.00731429 0.27033757]
Stock Position:  0.0026245982684733908
Bond Position:  [2.61642122]


portfolio before change:  [2.88696632]
curr_Stock_Price:  102.83132385325167
curr_Factors:  [102.83132385  -1.27074572  -1.0716333 ]
mat_Sqrt:  [[ 9.88196115  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00246043 0.02066702 0.22285636]
Stock Position:  0.0024604277986081747
Bond Position:  [2.63395728]


portfolio before change:  [2.88621813]
curr_Stock_Price:  102.25956814473597
curr_Factors:  [102.25956814  -1.15102327  -1.09421691]
mat_Sqrt:  [[10.82950317  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00331713 -0.0554104   0.05150714]
Stock Position:  -0.003317134314292394
Bond Position:  [3.22542685]


portfolio before change:  [2.88632248]
curr_Stock_Price:  102.4712287522181
curr_Factors:  [102.47122875  -0.97581565  -1.11771333]
mat_Sqrt:  [[12.62972401  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.11129261 -0.16634755 -0.14261586]
Stock Position:  -0.11129260644859411
Bond Position:  [14.29061262]


portfolio before change:  [2.83726556]
curr_Stock_Price:  102.94412646428053
curr_Factors:  [102.94412646  -0.6552305   -1.10119118]
mat_Sqrt:  [[17.77449733  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01839818 0.02594997 0.18681568]
Stock Position:  0.01839818145328244
Bond Position:  [0.94328085]


portfolio before change:  [2.8522556]
curr_Stock_Price:  103.74606345825921
curr_Factors:  [103.74606346  -0.39708857  -1.10244401]
mat_Sqrt:  [[23.15969858  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00966699  0.00722222  0.07366783]
Stock Position:  -0.009666989511618887
Bond Position:  [3.8551677]


portfolio before change:  [2.8498896]
curr_Stock_Price:  104.0905247671955
curr_Factors:  [ 1.04090525e+02 -6.06000760e-02 -1.09050060e+00]
mat_Sqrt:  [[32.92263055  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02703798 -0.29055005  0.76679862]
Stock Position:  -0.027037982165435386
Bond Position:  [5.66428736]


portfolio before change:  [2.88328165]
curr_Stock_Price:  102.90789974679463
curr_Factors:  [102.90789975  -0.29348186  -1.10933333]
mat_Sqrt:  [[25.3054356   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00010016 -0.0017759   0.02357553]
Stock Position:  -0.00010016107389518652
Bond Position:  [2.89358901]


portfolio before change:  [2.88420838]
curr_Stock_Price:  100.87873549464868
curr_Factors:  [100.87873549  -0.53745769  -1.11735313]
mat_Sqrt:  [[19.28077212  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00497226  0.04183853 -0.29706106]
Stock Position:  0.004972257666706647
Bond Position:  [2.38261331]


portfolio before change:  [2.87848934]
curr_Stock_Price:  99.60873548036474
curr_Factors:  [99.60873548 -0.79449796 -1.09879376]
mat_Sqrt:  [[14.9986193   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00204116 0.01609609 0.26682404]
Stock Position:  0.0020411584254240653
Bond Position:  [2.67517213]


portfolio before change:  [2.88096146]
curr_Stock_Price:  100.4921786155314
curr_Factors:  [100.49217862  -1.1791041   -1.10985934]
mat_Sqrt:  [[10.18704135  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01527453 0.03333592 0.24673854]
Stock Position:  0.01527452827271887
Bond Position:  [1.34599084]


portfolio before change:  [2.87502234]
curr_Stock_Price:  100.08132063157838
curr_Factors:  [100.08132063  -1.00514068  -1.14217147]
mat_Sqrt:  [[11.68926509  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00854035 -0.00481697  0.01849981]
Stock Position:  0.008540350127876057
Bond Position:  [2.02029282]


portfolio before change:  [2.87703709]
curr_Stock_Price:  100.25808341172748
curr_Factors:  [100.25808341  -0.65078852  -1.14616381]
mat_Sqrt:  [[16.62313445  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00381356 -0.02944448  0.0038839 ]
Stock Position:  -0.0038135581089628863
Bond Position:  [3.25937712]


portfolio before change:  [2.87340762]
curr_Stock_Price:  101.4235092858274
curr_Factors:  [101.42350929  -0.83173089  -1.16655663]
mat_Sqrt:  [[13.7497053   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01079978 -0.18805965 -1.36887299]
Stock Position:  -0.010799778920178648
Bond Position:  [3.9687591]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [2.88306041]
Stock Price:  100.62159651608569
PL:  [2.2614639]
Settle:  Tensor("sub_166:0", shape=(), dtype=float64)
PL:  Tensor("sub_167:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  84
output_Z_Vals[:, i, :]:  [[ 1.19271183e+02 -4.92738716e+01 -4.92570741e+01]
 [ 2.41372251e-02  4.76720625e-02 -4.32453920e-02]
 [-1.79122813e+00 -2.41702458e+00 -6.86019297e-01]
 [ 1.04210322e-01  2.38755728e-01 -4.62043412e-02]
 [ 2.16174466e-01  1.44855389e-01 -3.47632265e-01]
 [-1.45153453e-01 -1.61657002e-01  1.05200294e-02]
 [-5.91062112e-03  3.41986152e-02 -1.05334689e-02]
 [-4.21834439e-02 -3.52916595e-02 -3.47642052e-02]
 [-2.11995833e-02 -2.14516651e-01  3.24826282e-02]
 [-1.04969540e+00 -3.92155727e-01 -3.82712280e-02]
 [ 3.48364802e-01  6.42320256e-02 -3.90091125e-02]
 [ 8.56522426e-02 -5.26512582e-02  3.82017233e-02]
 [-7.39150554e-01 -1.21671342e+00  2.61338479e-01]
 [-2.03535145e-02 -1.40692950e-03  5.17885342e-03]
 [ 1.30937918e-01  1.09603359e-01 -1.06326998e-01]
 [ 1.09753323e-01  1.10874872e-02  2.59391286e-02]
 [ 9.42424498e-02  8.11055381e-02  6.41973452e-02]
 [ 8.93413538e-02 -1.85817211e-02  4.07160790e-02]
 [-2.27501139e-02  3.47468366e-02 -4.34397542e-02]
 [ 1.03862847e-01 -8.24328219e-01 -5.70094457e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.27118322 -49.27387164 -49.25707411]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [   7.3268874   -15.90307369 -140.51672192]
init_Out:  [2.48374395]
Stock Position:  7.326887399052493
Bond position:  [-730.20499595]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [6.33231253]
curr_Stock_Price:  100.55018487830114
curr_Factors:  [100.55018488  -1.24992241  -0.99106933]
mat_Sqrt:  [[10.69381154  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00234162  0.01538609 -0.12336707]
Stock Position:  0.0023416174226989204
Bond Position:  [6.09686247]


portfolio before change:  [6.33331512]
curr_Stock_Price:  100.32733984025316
curr_Factors:  [100.32733984  -1.69058945  -1.0060112 ]
mat_Sqrt:  [[ 6.76550961  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.35838162 -0.78009133 -1.9570221 ]
Stock Position:  -0.35838162244448
Bond Position:  [42.28878995]


portfolio before change:  [6.44361534]
curr_Stock_Price:  100.04907026923901
curr_Factors:  [100.04907027  -1.63491971  -1.03822474]
mat_Sqrt:  [[ 6.90686829  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.02077855  0.07705808 -0.13180812]
Stock Position:  0.020778550202378978
Bond Position:  [4.36474071]


portfolio before change:  [6.44967186]
curr_Stock_Price:  100.28802803631972
curr_Factors:  [100.28802804  -1.72995691  -1.04242042]
mat_Sqrt:  [[ 6.26932689  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.02787904  0.04675188 -0.99169809]
Stock Position:  0.027879039107833105
Bond Position:  [3.653738]


portfolio before change:  [6.46594666]
curr_Stock_Price:  100.8390246660193
curr_Factors:  [100.83902467  -1.77436783  -1.06404571]
mat_Sqrt:  [[ 5.90094133  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02982645 -0.05217457  0.03001072]
Stock Position:  -0.02982645452665487
Bond Position:  [9.47361725]


portfolio before change:  [6.46828232]
curr_Stock_Price:  100.84013272593526
curr_Factors:  [100.84013273  -2.00379363  -1.04616412]
mat_Sqrt:  [[ 4.77588199  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00022613  0.01103756 -0.03004905]
Stock Position:  -0.00022613485073428655
Bond Position:  [6.49108578]


portfolio before change:  [6.46995177]
curr_Stock_Price:  100.63457086723174
curr_Factors:  [100.63457087  -2.14968138  -1.0138123 ]
mat_Sqrt:  [[ 4.25460602  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01327586 -0.01139033 -0.0991726 ]
Stock Position:  -0.013275856130980564
Bond Position:  [7.80596186]


portfolio before change:  [6.46919006]
curr_Stock_Price:  100.83896031165744
curr_Factors:  [100.83896031  -2.46839952  -1.00737405]
mat_Sqrt:  [[ 3.11974489  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01870574 -0.06923495  0.0926639 ]
Stock Position:  -0.018705735482086157
Bond Position:  [8.35545698]


portfolio before change:  [6.46798397]
curr_Stock_Price:  101.01512135197588
curr_Factors:  [101.01512135  -2.07230854  -0.98168626]
mat_Sqrt:  [[ 4.76489463  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.23873685 -0.12656772 -0.10917716]
Stock Position:  -0.23873684966897102
Bond Position:  [30.58401581]


portfolio before change:  [6.47789729]
curr_Stock_Price:  101.00562820481987
curr_Factors:  [101.0056282   -2.25231281  -0.95525093]
mat_Sqrt:  [[ 4.08618798  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.08651423  0.0207308  -0.11128214]
Stock Position:  0.08651423032317689
Bond Position:  [-2.26052689]


portfolio before change:  [6.49443413]
curr_Stock_Price:  101.20330716392287
curr_Factors:  [101.20330716  -2.07163318  -0.96715808]
mat_Sqrt:  [[ 4.84690413  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.017063   -0.01699312  0.10897888]
Stock Position:  0.017063003800913197
Bond Position:  [4.76760172]


portfolio before change:  [6.50570362]
curr_Stock_Price:  101.79390902387708
curr_Factors:  [101.79390902  -1.96269486  -0.97726928]
mat_Sqrt:  [[ 5.38160217  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.17358504 -0.39269257  0.74552594]
Stock Position:  -0.17358504397948515
Bond Position:  [24.1756038]


portfolio before change:  [6.46035135]
curr_Stock_Price:  102.08999980182044
curr_Factors:  [102.0899998   -1.75790596  -0.97528646]
mat_Sqrt:  [[ 6.63701526  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00295066 -0.00045408  0.01477383]
Stock Position:  -0.002950659739036208
Bond Position:  [6.7615842]


portfolio before change:  [6.4616755]
curr_Stock_Price:  102.21419423040957
curr_Factors:  [102.21419423  -2.10278982  -0.9403462 ]
mat_Sqrt:  [[ 4.87409543  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.02700126  0.03537433 -0.30332133]
Stock Position:  0.02700125670373501
Bond Position:  [3.7017638]


portfolio before change:  [6.45064532]
curr_Stock_Price:  101.77140986250652
curr_Factors:  [101.77140986  -1.73958067  -0.96336578]
mat_Sqrt:  [[ 6.81947692  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.0172024  0.00357847 0.07399711]
Stock Position:  0.017202397028142052
Bond Position:  [4.69993312]


portfolio before change:  [6.437782]
curr_Stock_Price:  100.95533447527359
curr_Factors:  [100.95533448  -1.35213285  -0.92317168]
mat_Sqrt:  [[10.37473637  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01194269 0.0261767  0.18313716]
Stock Position:  0.011942691575740431
Bond Position:  [5.23210358]


portfolio before change:  [6.43767179]
curr_Stock_Price:  100.83656703386879
curr_Factors:  [100.83656703  -1.54469505  -0.87670049]
mat_Sqrt:  [[ 8.95404613  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01048236 -0.00599722  0.11615164]
Stock Position:  0.010482357289988697
Bond Position:  [5.38066686]


portfolio before change:  [6.44833045]
curr_Stock_Price:  101.7250438499301
curr_Factors:  [101.72504385  -1.31127471  -0.87836258]
mat_Sqrt:  [[11.38886626  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00215338  0.01121449 -0.12392153]
Stock Position:  -0.0021533792457457007
Bond Position:  [6.66738305]


portfolio before change:  [6.4494494]
curr_Stock_Price:  101.97957842238162
curr_Factors:  [101.97957842  -1.51954864  -0.88608772]
mat_Sqrt:  [[ 9.19938119  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01965051 -0.26605079 -1.6263208 ]
Stock Position:  -0.019650505434552636
Bond Position:  [8.45339966]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [6.4620163]
Stock Price:  101.44761831843567
PL:  [5.01439798]
Settle:  Tensor("sub_168:0", shape=(), dtype=float64)
PL:  Tensor("sub_169:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  85
output_Z_Vals[:, i, :]:  [[ 1.19271183e+02 -4.92738716e+01 -4.92570741e+01]
 [ 4.51987422e-03  1.27462399e-02 -5.52461357e-02]
 [-2.56864471e+00 -3.45372960e+00 -9.85918868e-01]
 [-4.60077878e-03  8.01369163e-02 -1.13224852e-01]
 [ 7.30169137e-01 -8.83763524e-02 -3.92574045e-01]
 [ 7.75286731e-02  1.33949480e-01  3.41658448e-03]
 [ 1.60477545e-02  3.19673551e-02  1.05076384e-01]
 [ 1.67997629e-01  4.73598745e-01  3.36680759e-01]
 [-9.65452472e-04 -1.62417665e-01  1.49347597e-02]
 [-1.19742688e+00 -4.91276894e-01 -4.49743084e-02]
 [ 3.87398077e-01  6.48929907e-02 -1.54728746e-02]
 [-1.65554297e-02 -4.60731003e-02  3.49247913e-02]
 [-6.66953090e-01 -1.09347886e+00  2.35429995e-01]
 [ 7.79293396e-03  2.45573790e-02  6.15108892e-02]
 [ 1.11837045e-01  1.29679246e-01 -1.05454607e-01]
 [ 1.86746974e-02  4.52066464e-02  8.53268687e-02]
 [ 1.25549846e-01  1.15282961e-01  1.02724982e-01]
 [ 1.15216134e-01 -1.08333916e-02 -3.18137274e-02]
 [-5.11388314e-02 -1.69828944e-01  3.59471098e-02]
 [ 7.23759894e-02 -5.73586891e-01 -5.66518335e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.27118322 -49.27387164 -49.25707411]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [   7.3268874   -15.90307369 -140.51672192]
init_Out:  [2.48374395]
Stock Position:  7.326887399052493
Bond position:  [-730.20499595]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [3.01479378]
curr_Stock_Price:  100.09739796123644
curr_Factors:  [100.09739796  -0.46727643  -0.99897146]
mat_Sqrt:  [[23.10145968  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00017988  0.00411383 -0.15760185]
Stock Position:  -0.00017987524316541198
Bond Position:  [3.03279882]


portfolio before change:  [3.01557095]
curr_Stock_Price:  99.99244906724506
curr_Factors:  [99.99244907 -0.36940662 -1.03289805]
mat_Sqrt:  [[24.6010718   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.1412493  -1.11468644 -2.8125521 ]
Stock Position:  -0.14124929969186029
Bond Position:  [17.13943435]


portfolio before change:  [3.04809997]
curr_Stock_Price:  99.79249322506996
curr_Factors:  [99.79249323 -0.30333616 -1.04471731]
mat_Sqrt:  [[25.92063827  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00043806  0.02586408 -0.32299899]
Stock Position:  -0.0004380611785103168
Bond Position:  [3.09181518]


portfolio before change:  [3.04886638]
curr_Stock_Price:  99.80764009833094
curr_Factors:  [99.8076401  -0.65109188 -0.99693805]
mat_Sqrt:  [[19.2058478   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.03290641 -0.02852335 -1.11990448]
Stock Position:  0.03290641237963627
Bond Position:  [-0.23544498]


portfolio before change:  [3.12050791]
curr_Stock_Price:  101.98655878430003
curr_Factors:  [101.98655878  -0.62453423  -1.05679774]
mat_Sqrt:  [[18.98233976  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.0055614  0.04323201 0.00974656]
Stock Position:  0.005561401014575086
Bond Position:  [2.55331976]


portfolio before change:  [3.11638738]
curr_Stock_Price:  101.1308499483735
curr_Factors:  [101.13084995  -0.57149257  -1.04809352]
mat_Sqrt:  [[20.0219492   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00219867 0.01031742 0.29975368]
Stock Position:  0.0021986715800571444
Bond Position:  [2.89403385]


portfolio before change:  [3.11740312]
curr_Stock_Price:  101.26372231806066
curr_Factors:  [101.26372232  -0.20051617  -1.09955599]
mat_Sqrt:  [[27.59559233  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01208147 0.15285334 0.96045649]
Stock Position:  0.01208146706545948
Bond Position:  [1.89398879]


portfolio before change:  [3.13841121]
curr_Stock_Price:  102.96339474209368
curr_Factors:  [102.96339474  -0.49216029  -1.09339642]
mat_Sqrt:  [[21.09037597  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0014732  -0.05242008  0.04260471]
Stock Position:  -0.0014731968039172244
Bond Position:  [3.29009656]


portfolio before change:  [3.14137058]
curr_Stock_Price:  101.51298595266053
curr_Factors:  [101.51298595  -0.6678384   -1.04310787]
mat_Sqrt:  [[18.34286122  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.07124781 -0.15855894 -0.12829918]
Stock Position:  -0.07124781023849565
Bond Position:  [10.37394854]


portfolio before change:  [3.18102815]
curr_Stock_Price:  100.99277685164621
curr_Factors:  [100.99277685  -0.85486014  -1.05822425]
mat_Sqrt:  [[14.90899317  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.02666082  0.02094412 -0.0441398 ]
Stock Position:  0.026660815516159432
Bond Position:  [0.48847836]


portfolio before change:  [3.18963401]
curr_Stock_Price:  101.31098645684615
curr_Factors:  [101.31098646  -1.03277847  -1.10446951]
mat_Sqrt:  [[11.9525768   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00157548 -0.01487003  0.09963071]
Stock Position:  -0.001575481927024684
Bond Position:  [3.34924764]


portfolio before change:  [3.19068143]
curr_Stock_Price:  101.17769510101631
curr_Factors:  [101.1776951   -0.91583004  -1.10787913]
mat_Sqrt:  [[13.37208275  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0629746  -0.35291878  0.67161624]
Stock Position:  -0.06297460139637873
Bond Position:  [9.56230644]


portfolio before change:  [3.2170486]
curr_Stock_Price:  100.7969654353789
curr_Factors:  [100.79696544  -0.87572852  -1.11618838]
mat_Sqrt:  [[13.75209744  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00184419 0.00792586 0.17547345]
Stock Position:  0.0018441947306406573
Bond Position:  [3.03115937]


portfolio before change:  [3.21772847]
curr_Stock_Price:  100.7546617371483
curr_Factors:  [100.75466174  -0.8752805   -1.11199094]
mat_Sqrt:  [[13.81033231  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00845612  0.0418538  -0.30083264]
Stock Position:  0.008456123733237623
Bond Position:  [2.36573458]


portfolio before change:  [3.21026355]
curr_Stock_Price:  99.80192907482213
curr_Factors:  [99.80192907 -1.1167809  -1.14331663]
mat_Sqrt:  [[10.41336396  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00435207 0.01459038 0.24341381]
Stock Position:  0.004352074868838091
Bond Position:  [2.77591808]


portfolio before change:  [3.21158835]
curr_Stock_Price:  99.9468567299442
curr_Factors:  [99.94685673 -1.29845265 -1.19113402]
mat_Sqrt:  [[ 8.29001636  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.02051269 0.03720742 0.29304578]
Stock Position:  0.02051268938712224
Bond Position:  [1.16140953]


portfolio before change:  [3.19766199]
curr_Stock_Price:  99.25378590117455
curr_Factors:  [99.2537859  -1.30586468 -1.20044116]
mat_Sqrt:  [[ 8.09603328  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01315593 -0.00349646 -0.09075571]
Stock Position:  0.013155927594030295
Bond Position:  [1.89188637]


portfolio before change:  [3.19562142]
curr_Stock_Price:  99.06272365369861
curr_Factors:  [99.06272365 -0.80705294 -1.231795  ]
mat_Sqrt:  [[12.89584651  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0060847  -0.05481206  0.1025471 ]
Stock Position:  -0.0060846991596730975
Bond Position:  [3.7983883]


portfolio before change:  [3.19954043]
curr_Stock_Price:  98.5747316220567
curr_Factors:  [98.57473162 -0.80676719 -1.24054214]
mat_Sqrt:  [[12.72419921  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01260174 -0.18512437 -1.61611912]
Stock Position:  -0.012601737267749834
Bond Position:  [4.44175329]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [3.19977097]
Stock Price:  98.64456593224573
PL:  [3.19977097]
Settle:  Tensor("sub_170:0", shape=(), dtype=float64)
PL:  Tensor("sub_171:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  86
output_Z_Vals[:, i, :]:  [[ 1.19271183e+02 -4.92738716e+01 -4.92570741e+01]
 [ 2.66719681e-02  5.17444124e-02 -4.20691081e-02]
 [-2.21643827e+00 -2.98405324e+00 -8.50050194e-01]
 [ 5.94721900e-02  2.69528999e-01 -3.23013980e-02]
 [ 8.68451041e-01 -4.89043311e-02 -4.86529762e-01]
 [ 8.00053405e-02  1.56863482e-01  1.73043257e-02]
 [ 1.76550293e-02  3.91070509e-02  1.13644797e-01]
 [ 3.88190015e-02  2.70170172e-01  2.91231678e-01]
 [ 9.53094870e-04 -1.57477776e-01  1.32709167e-02]
 [-1.22401650e+00 -4.93867346e-01 -4.65049405e-02]
 [ 4.44948237e-01  1.08803787e-01  7.46141019e-02]
 [-6.14180533e-02 -3.54165414e-02  3.32141869e-02]
 [-7.70798075e-01 -1.17312579e+00  2.74786995e-01]
 [-2.29684409e-02 -1.18904360e-02 -6.81305451e-03]
 [ 1.22741865e-01  1.19948139e-01 -1.06312577e-01]
 [ 1.09396999e-01  1.10069739e-02  2.58090464e-02]
 [ 4.53595751e-02  3.32339404e-02  1.65638916e-02]
 [ 8.69542136e-02 -1.92749603e-02  4.83230064e-02]
 [-1.68582585e-02  4.09550346e-02 -3.65226697e-02]
 [ 3.90614940e-02 -4.16698179e-01 -2.86154743e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.27118322 -49.27387164 -49.25707411]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [   7.3268874   -15.90307369 -140.51672192]
init_Out:  [2.48374395]
Stock Position:  7.326887399052493
Bond position:  [-730.20499595]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [2.63917501]
curr_Stock_Price:  100.04613215753808
curr_Factors:  [100.04613216  -0.9821448   -1.01260781]
mat_Sqrt:  [[13.61100687  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00210469  0.01670044 -0.12001146]
Stock Position:  0.0021046886259193016
Bond Position:  [2.42860905]


portfolio before change:  [2.64002528]
curr_Stock_Price:  100.1616121483626
curr_Factors:  [100.16161215  -0.95990385  -1.02872168]
mat_Sqrt:  [[13.71046583  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.21874321 -0.96309904 -2.42495659]
Stock Position:  -0.21874321387079648
Bond Position:  [24.54969823]


portfolio before change:  [2.4484603]
curr_Stock_Price:  101.06542614050596
curr_Factors:  [101.06542614  -0.7336053   -1.02646171]
mat_Sqrt:  [[17.38662249  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00620569  0.08699011 -0.0921469 ]
Stock Position:  0.006205694713195119
Bond Position:  [1.82127912]


portfolio before change:  [2.44686535]
curr_Stock_Price:  100.73503215286163
curr_Factors:  [100.73503215  -0.49874018  -1.01220996]
mat_Sqrt:  [[22.23224     0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.03414663 -0.0157838  -1.38793399]
Stock Position:  0.03414662733792816
Bond Position:  [-0.99289625]


portfolio before change:  [2.48173555]
curr_Stock_Price:  101.76349269907607
curr_Factors:  [101.7634927   -0.44197488  -1.00471784]
mat_Sqrt:  [[23.94976968  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00482498 0.05062747 0.04936442]
Stock Position:  0.004824981483467444
Bond Position:  [1.99072859]


portfolio before change:  [2.48379814]
curr_Stock_Price:  102.08781332322593
curr_Factors:  [102.08781332  -0.39452663  -1.0178349 ]
mat_Sqrt:  [[24.86526441  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.001964   0.01262175 0.32419697]
Stock Position:  0.001963999609604212
Bond Position:  [2.28329771]


portfolio before change:  [2.48697485]
curr_Stock_Price:  103.41460283076415
curr_Factors:  [103.41460283  -0.47544946  -0.9967773 ]
mat_Sqrt:  [[23.72476448  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00646644 0.08719705 0.83080291]
Stock Position:  0.006466436135495074
Bond Position:  [1.81825092]


portfolio before change:  [2.48437484]
curr_Stock_Price:  102.94222023876009
curr_Factors:  [102.94222024  -0.3967819   -0.99922013]
mat_Sqrt:  [[25.4869317   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00111755 -0.05082573  0.03785823]
Stock Position:  -0.0011175533899475533
Bond Position:  [2.59941826]


portfolio before change:  [2.48577979]
curr_Stock_Price:  102.26662208614104
curr_Factors:  [102.26662209  -0.99309506  -0.99089873]
mat_Sqrt:  [[14.06359515  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.09487756 -0.159395   -0.13266565]
Stock Position:  -0.0948775554209244
Bond Position:  [12.18858689]


portfolio before change:  [2.40983111]
curr_Stock_Price:  103.09923422082366
curr_Factors:  [103.09923422  -1.28221771  -0.97558084]
mat_Sqrt:  [[10.78216536  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.04473946 0.03511627 0.21285326]
Stock Position:  0.044739460052020216
Bond Position:  [-2.20277296]


portfolio before change:  [2.41590383]
curr_Stock_Price:  103.24727978114267
curr_Factors:  [103.24727978  -1.77772443  -1.02103833]
mat_Sqrt:  [[ 6.28624634  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00984174 -0.01143064  0.09475083]
Stock Position:  -0.00984174079794632
Bond Position:  [3.4320368]


portfolio before change:  [2.41856383]
curr_Stock_Price:  103.06419422376767
curr_Factors:  [103.06419422  -1.6051412   -0.96433207]
mat_Sqrt:  [[ 7.89223032  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.12090001 -0.37862472  0.78389081]
Stock Position:  -0.12090000878498276
Bond Position:  [14.87902581]


portfolio before change:  [2.47279958]
curr_Stock_Price:  102.64636524724112
curr_Factors:  [102.64636525  -1.6275928   -0.95491238]
mat_Sqrt:  [[ 7.75846532  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00345252 -0.00383762 -0.01943575]
Stock Position:  -0.003452522343039142
Bond Position:  [2.82718844]


portfolio before change:  [2.4768476]
curr_Stock_Price:  101.67862693908023
curr_Factors:  [101.67862694  -1.46208949  -0.89988488]
mat_Sqrt:  [[ 9.5815824   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01310068  0.0387131  -0.30328019]
Stock Position:  0.013100676567883931
Bond Position:  [1.14478879]


portfolio before change:  [2.47739053]
curr_Stock_Price:  101.69822098007002
curr_Factors:  [101.69822098  -1.75520749  -0.9070915 ]
mat_Sqrt:  [[ 7.09727437  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01647281 0.00355249 0.07362603]
Stock Position:  0.016472807924590892
Bond Position:  [0.80213527]


portfolio before change:  [2.4790341]
curr_Stock_Price:  101.78582076455733
curr_Factors:  [101.78582076  -1.79117392  -0.91146344]
mat_Sqrt:  [[ 6.82255101  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00813838 0.01072621 0.04725217]
Stock Position:  0.008138380352955292
Bond Position:  [1.65066238]


portfolio before change:  [2.47511266]
curr_Stock_Price:  101.25326358141606
curr_Factors:  [101.25326358  -1.29673545  -0.92388528]
mat_Sqrt:  [[10.99020256  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00845149 -0.00622097  0.13785209]
Stock Position:  0.008451493103676986
Bond Position:  [1.61937141]


portfolio before change:  [2.48194226]
curr_Stock_Price:  102.01344956977691
curr_Factors:  [102.01344957  -0.96097637  -0.94660804]
mat_Sqrt:  [[15.1427255   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00105354  0.01321818 -0.10418901]
Stock Position:  -0.0010535425640081334
Bond Position:  [2.58941778]


portfolio before change:  [2.48078134]
curr_Stock_Price:  103.72990292086719
curr_Factors:  [103.72990292  -0.37194463  -0.97054192]
mat_Sqrt:  [[27.09377209  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00385357 -0.13448876 -0.81631983]
Stock Position:  -0.0038535703943972004
Bond Position:  [2.88051183]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [2.47846042]
Stock Price:  104.51907908684781
PL:  [-2.04061867]
Settle:  Tensor("sub_172:0", shape=(), dtype=float64)
PL:  Tensor("sub_173:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  87
output_Z_Vals[:, i, :]:  [[ 1.19271183e+02 -4.92738716e+01 -4.92570741e+01]
 [ 6.84382997e-02  1.20278196e-01 -2.73122953e-02]
 [-2.80814103e+00 -3.20979644e+00 -9.78582317e-01]
 [-5.54770558e-02  7.07007681e-03 -1.33718505e-01]
 [ 8.38561657e-01 -1.33485151e-01 -3.94325240e-01]
 [-9.63983613e-02 -1.79406031e-01  4.04654052e-02]
 [ 1.03726753e-02  3.43580688e-02  9.96199989e-02]
 [ 1.25053583e-01  3.95167017e-01  3.02483350e-01]
 [-2.68134452e-02 -2.28971263e-01  3.73511996e-02]
 [-1.49695870e+00 -5.91600970e-01 -5.92762901e-02]
 [ 3.33619604e-01  1.65020781e-02  5.03321892e-02]
 [-1.19825959e-01  4.07616334e-02  2.78269797e-02]
 [-8.69287319e-01 -1.11326984e+00  3.12716594e-01]
 [ 1.41712530e-02 -4.00304530e-02 -1.90392382e-02]
 [-1.40178793e-01 -1.61760796e-01  4.62314445e-02]
 [ 8.79497998e-02  6.16087407e-03  1.79793834e-02]
 [-1.71582220e-01 -1.79219815e-01 -1.94832982e-01]
 [-7.52608912e-02 -1.72594357e-01  2.71584191e-01]
 [ 6.58922760e-02 -1.34904956e-01  1.37630220e-01]
 [ 9.47306362e-02 -8.44882871e-01 -2.32140308e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.27118322 -49.27387164 -49.25707411]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [   7.3268874   -15.90307369 -140.51672192]
init_Out:  [2.48374395]
Stock Position:  7.326887399052493
Bond position:  [-730.20499595]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-6.45269783]
curr_Stock_Price:  98.80524058349098
curr_Factors:  [98.80524058 -0.76341301 -0.96488264]
mat_Sqrt:  [[17.54650867  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0049819   0.03881962 -0.07791438]
Stock Position:  0.004981896194856816
Bond Position:  [-6.94493528]


portfolio before change:  [-6.45935025]
curr_Stock_Price:  97.81847466048436
curr_Factors:  [97.81847466 -0.52942844 -0.94826996]
mat_Sqrt:  [[22.31848058  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.16412812 -1.03595735 -2.79162297]
Stock Position:  -0.1641281204147364
Bond Position:  [9.59541214]


portfolio before change:  [-6.59098971]
curr_Stock_Price:  98.6351452642598
curr_Factors:  [98.63514526 -0.49195758 -0.97575816]
mat_Sqrt:  [[22.73059698  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00357796  0.00228186 -0.38146168]
Stock Position:  -0.0035779552158513943
Bond Position:  [-6.23807757]


portfolio before change:  [-6.59579781]
curr_Stock_Price:  99.5430354546013
curr_Factors:  [99.54303545 -0.52994239 -0.96387768]
mat_Sqrt:  [[22.34874118  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.03270085 -0.04308215 -1.12490015]
Stock Position:  0.032700849040720945
Bond Position:  [-9.85093959]


portfolio before change:  [-6.66117904]
curr_Stock_Price:  97.61898178265133
curr_Factors:  [97.61898178 -0.27865628 -0.9502308 ]
mat_Sqrt:  [[28.56507701  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00436755 -0.05790305  0.11543654]
Stock Position:  -0.004367553353879026
Bond Position:  [-6.23482293]


portfolio before change:  [-6.67518571]
curr_Stock_Price:  100.46903725045695
curr_Factors:  [100.46903725  -0.22439061  -0.95273   ]
mat_Sqrt:  [[30.96101968  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00121833 0.01108902 0.28418813]
Stock Position:  0.0012183330601216976
Bond Position:  [-6.79759046]


portfolio before change:  [-6.67489258]
curr_Stock_Price:  102.10466851644524
curr_Factors:  [102.10466852  -0.23407689  -0.94021909]
mat_Sqrt:  [[31.55406638  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00847627 0.12753961 0.8629008 ]
Stock Position:  0.008476272592458102
Bond Position:  [-7.54035958]


portfolio before change:  [-6.66380653]
curr_Stock_Price:  103.63498469056228
curr_Factors:  [103.63498469  -0.72320538  -0.95778557]
mat_Sqrt:  [[19.29573355  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0034167  -0.07390016  0.10655258]
Stock Position:  -0.003416699692618503
Bond Position:  [-6.30971691]


portfolio before change:  [-6.67072501]
curr_Stock_Price:  105.1981468208476
curr_Factors:  [105.19814682  -0.96385111  -0.95860517]
mat_Sqrt:  [[15.38494448  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.10593593 -0.19093839 -0.16909876]
Stock Position:  -0.10593593390433038
Bond Position:  [4.47353892]


portfolio before change:  [-6.68270345]
curr_Stock_Price:  105.32177782573285
curr_Factors:  [105.32177783  -1.1935337   -0.9598933 ]
mat_Sqrt:  [[12.2263471   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.02840277 0.00532602 0.14358373]
Stock Position:  0.028402767342081157
Bond Position:  [-9.6741334]


portfolio before change:  [-6.64201499]
curr_Stock_Price:  106.83949239083793
curr_Factors:  [106.83949239  -1.20051875  -0.97124981]
mat_Sqrt:  [[12.17712357  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00869051  0.01315576  0.07938263]
Stock Position:  -0.008690506139822462
Bond Position:  [-5.71352573]


portfolio before change:  [-6.63315767]
curr_Stock_Price:  105.65591576443914
curr_Factors:  [105.65591576  -1.23163159  -0.95419317]
mat_Sqrt:  [[11.87414058  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.08697047 -0.3593063   0.8920934 ]
Stock Position:  -0.08697046827203483
Bond Position:  [2.5557868]


portfolio before change:  [-6.71124421]
curr_Stock_Price:  106.56111451591511
curr_Factors:  [106.56111452  -1.29693162  -0.96608917]
mat_Sqrt:  [[11.08616437  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00019066 -0.01291977 -0.05431365]
Stock Position:  0.00019066132461045663
Bond Position:  [-6.73156129]


portfolio before change:  [-6.71264395]
curr_Stock_Price:  108.0472760598194
curr_Factors:  [108.04727606  -1.1079863   -0.9509579 ]
mat_Sqrt:  [[13.7856014   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01187914 -0.05220807  0.13188544]
Stock Position:  -0.011879142500689993
Bond Position:  [-5.42913496]


portfolio before change:  [-6.71608021]
curr_Stock_Price:  108.22227178991213
curr_Factors:  [108.22227179  -1.18896154  -0.97424741]
mat_Sqrt:  [[12.4407607   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00746557 0.00198841 0.05129018]
Stock Position:  0.007465573157605689
Bond Position:  [-7.52402149]


portfolio before change:  [-6.71919188]
curr_Stock_Price:  108.05745693373706
curr_Factors:  [108.05745693  -1.44945878  -0.96473879]
mat_Sqrt:  [[ 9.66455942  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02565408 -0.05784295 -0.55580427]
Stock Position:  -0.02565408483066315
Bond Position:  [-3.94707672]


portfolio before change:  [-6.69085019]
curr_Stock_Price:  106.91422439141495
curr_Factors:  [106.91422439  -1.22195424  -0.99096878]
mat_Sqrt:  [[11.69432704  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00470781 -0.05570459  0.7747541 ]
Stock Position:  -0.004707810537749158
Bond Position:  [-6.18751828]


portfolio before change:  [-6.69558069]
curr_Stock_Price:  107.59042582872009
curr_Factors:  [107.59042583  -1.15374127  -0.96927351]
mat_Sqrt:  [[12.87537907  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0051609  -0.04354039  0.39262071]
Stock Position:  0.0051609018976051324
Bond Position:  [-7.25084433]


portfolio before change:  [-6.6946949]
curr_Stock_Price:  108.11334503861296
curr_Factors:  [108.11334504  -1.19363356  -0.99263514]
mat_Sqrt:  [[12.14492593  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0103019  -0.27268477 -0.66223168]
Stock Position:  -0.010301898953563272
Bond Position:  [-5.58092214]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-6.69096155]
Stock Price:  107.61549994885937
PL:  [-14.3064615]
Settle:  Tensor("sub_174:0", shape=(), dtype=float64)
PL:  Tensor("sub_175:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  88
output_Z_Vals[:, i, :]:  [[ 1.19271183e+02 -4.92738716e+01 -4.92570741e+01]
 [ 3.31976749e-02  6.22286946e-02 -3.90407602e-02]
 [-1.98257104e+00 -2.67218527e+00 -7.59832563e-01]
 [ 1.09029075e-01  2.43635551e-01 -4.10025161e-02]
 [ 6.18891839e-01 -9.84887611e-02 -3.19785904e-01]
 [-1.46259992e-01 -2.31052324e-01  4.25739214e-02]
 [-3.61233400e-03  3.08770436e-02  1.42255238e-02]
 [-7.23002110e-03  1.98120183e-02 -2.14910943e-02]
 [ 1.33453759e-02 -1.25570041e-01  2.52382211e-03]
 [-1.13364644e+00 -4.42636814e-01 -4.22046478e-02]
 [ 4.60982826e-01  1.24163527e-01  4.95202403e-02]
 [-1.81766742e-01  5.11710579e-03  2.82066979e-02]
 [-8.52633381e-01 -1.04641065e+00  3.07819615e-01]
 [ 2.32416663e-02 -4.31958670e-02 -1.82878142e-02]
 [-1.63960603e-01 -2.02917820e-01  6.90258266e-02]
 [ 1.29151228e-01  1.54705389e-02  3.30206620e-02]
 [-1.90702548e-01 -1.97944587e-01 -2.13464605e-01]
 [-2.05046862e-01 -2.95024407e-01  4.49932506e-01]
 [ 5.77863003e-02 -7.47258713e-02  9.05041798e-02]
 [ 5.83359441e-02 -6.05302571e-01 -1.41692445e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.27118322 -49.27387164 -49.25707411]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [   7.3268874   -15.90307369 -140.51672192]
init_Out:  [2.48374395]
Stock Position:  7.326887399052493
Bond position:  [-730.20499595]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [6.93032162]
curr_Stock_Price:  100.63180331347937
curr_Factors:  [100.63180331  -1.48351379  -0.95668786]
mat_Sqrt:  [[ 8.76938514  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00432538  0.02008422 -0.11137242]
Stock Position:  0.004325376477076021
Bond Position:  [6.49505118]


portfolio before change:  [6.93223657]
curr_Stock_Price:  100.69907673011586
curr_Factors:  [100.69907673  -1.41328557  -0.92780425]
mat_Sqrt:  [[ 9.68953859  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.27690986 -0.86244409 -2.16759081]
Stock Position:  -0.2769098572426433
Bond Position:  [34.81680353]


portfolio before change:  [7.10568983]
curr_Stock_Price:  100.10412509046125
curr_Factors:  [100.10412509  -1.2518222   -0.91126882]
mat_Sqrt:  [[11.50889103  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01306741  0.07863304 -0.11696877]
Stock Position:  0.013067407558927439
Bond Position:  [5.79758843]


portfolio before change:  [7.09741014]
curr_Stock_Price:  99.35958058086165
curr_Factors:  [99.35958058 -1.14172337 -0.90726911]
mat_Sqrt:  [[12.80393967  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.04166779 -0.03178711 -0.91226017]
Stock Position:  0.041667790863319655
Bond Position:  [2.95731592]


portfolio before change:  [7.1198234]
curr_Stock_Price:  99.87973867370347
curr_Factors:  [99.87973867 -1.43010646 -0.94181761]
mat_Sqrt:  [[ 9.31888304  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01982351 -0.07457182  0.12145155]
Stock Position:  -0.019823511459601064
Bond Position:  [9.09979055]


portfolio before change:  [7.11454318]
curr_Stock_Price:  100.2608746932816
curr_Factors:  [100.26087469  -1.59147715  -0.92896852]
mat_Sqrt:  [[ 8.06335612  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00069378 0.00996552 0.04058146]
Stock Position:  0.0006937792324595336
Bond Position:  [7.04498427]


portfolio before change:  [7.11633671]
curr_Stock_Price:  100.3070870367538
curr_Factors:  [100.30708704  -1.56219701  -0.95947765]
mat_Sqrt:  [[ 8.05716449  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00093988  0.0063943  -0.06130811]
Stock Position:  -0.0009398791681877905
Bond Position:  [7.21061325]


portfolio before change:  [7.11796659]
curr_Stock_Price:  100.49114860490702
curr_Factors:  [100.4911486   -1.56867587  -0.94432999]
mat_Sqrt:  [[ 8.14222754  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00144571 -0.04052756  0.00719976]
Stock Position:  -0.0014457135095676072
Bond Position:  [7.263248]


portfolio before change:  [7.11783644]
curr_Stock_Price:  101.83732438972878
curr_Factors:  [101.83732439  -1.53060064  -0.92431702]
mat_Sqrt:  [[ 8.74479815  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.140954   -0.14286042 -0.12039811]
Stock Position:  -0.14095400149348664
Bond Position:  [21.47221482]


portfolio before change:  [7.13796212]
curr_Stock_Price:  101.73263100085066
curr_Factors:  [101.732631    -1.16942659  -0.89681815]
mat_Sqrt:  [[12.88550926  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.03852668 0.04007361 0.14126746]
Stock Position:  0.038526678779489135
Bond Position:  [3.21854172]


portfolio before change:  [7.15977358]
curr_Stock_Price:  102.27788246347454
curr_Factors:  [102.27788246  -0.55206582  -0.92977648]
mat_Sqrt:  [[23.23944711  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00752877  0.00165154  0.08046586]
Stock Position:  -0.007528774150023533
Bond Position:  [7.92980066]


portfolio before change:  [7.12576484]
curr_Stock_Price:  107.05840080643844
curr_Factors:  [107.05840081  -0.39894997  -0.94994867]
mat_Sqrt:  [[27.78443157  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.03611366 -0.33772759  0.87812368]
Stock Position:  -0.03611366469335435
Bond Position:  [10.99203603]


portfolio before change:  [7.12946363]
curr_Stock_Price:  107.03208296647892
curr_Factors:  [107.03208297  -0.70233208  -0.96152313]
mat_Sqrt:  [[20.27266482  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00052738 -0.01394141 -0.05217004]
Stock Position:  0.0005273782460819452
Bond Position:  [7.07301723]


portfolio before change:  [7.13206254]
curr_Stock_Price:  108.60674724942717
curr_Factors:  [108.60674725  -0.75152207  -0.97348189]
mat_Sqrt:  [[19.35071893  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00988548 -0.06549144  0.19691147]
Stock Position:  -0.009885482389519007
Bond Position:  [8.20569263]


portfolio before change:  [7.13115123]
curr_Stock_Price:  108.90647926291014
curr_Factors:  [108.90647926  -0.58890431  -0.96058472]
mat_Sqrt:  [[23.12699376  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00601243 0.00499309 0.09419876]
Stock Position:  0.006012430930064765
Bond Position:  [6.47635854]


portfolio before change:  [7.13686463]
curr_Stock_Price:  109.58742049541468
curr_Factors:  [109.5874205   -0.56191848  -0.97131228]
mat_Sqrt:  [[23.65304428  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01161293 -0.06388634 -0.6089551 ]
Stock Position:  -0.011612927911918442
Bond Position:  [8.40949545]


portfolio before change:  [7.1155456]
curr_Stock_Price:  111.6042824777028
curr_Factors:  [111.60428248  -0.58876742  -0.97260761]
mat_Sqrt:  [[23.41986031  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0074051  -0.09521872  1.2835322 ]
Stock Position:  -0.007405098763470972
Bond Position:  [7.94198633]


portfolio before change:  [7.1444963]
curr_Stock_Price:  107.96287885489068
curr_Factors:  [107.96287885  -0.65754975  -0.93886541]
mat_Sqrt:  [[21.87560964  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00278882 -0.02411767  0.25818323]
Stock Position:  0.002788815261873617
Bond Position:  [6.84340777]


portfolio before change:  [7.14957917]
curr_Stock_Price:  109.1719272677778
curr_Factors:  [109.17192727  -0.81213946  -0.92583872]
mat_Sqrt:  [[19.20068157  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00490315 -0.19536056 -0.40420911]
Stock Position:  -0.004903147570041237
Bond Position:  [7.68486524]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [7.14661743]
Stock Price:  110.16785905532545
PL:  [-3.02124163]
Settle:  Tensor("sub_176:0", shape=(), dtype=float64)
PL:  Tensor("sub_177:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  89
output_Z_Vals[:, i, :]:  [[ 1.19271183e+02 -4.92738716e+01 -4.92570741e+01]
 [ 2.78389420e-02  5.36192872e-02 -4.15275572e-02]
 [-2.13692156e+00 -2.87801566e+00 -8.19375485e-01]
 [ 9.49564991e-02  2.59119402e-01 -4.98160556e-02]
 [ 7.21781780e-01 -6.82963242e-03 -4.53679189e-01]
 [ 7.57175145e-02  1.17192732e-01 -6.73936232e-03]
 [ 2.02792198e-02  3.47559880e-02  1.13251833e-01]
 [ 2.20669915e-02  2.31433006e-01  2.64383279e-01]
 [ 2.52483397e-03 -1.53430850e-01  1.19078401e-02]
 [-1.43357428e+00 -5.95970769e-01 -5.62594011e-02]
 [ 1.93719824e-01 -1.70911601e-02  4.00793695e-02]
 [-1.65992455e-01  3.80270005e-02  2.68377372e-02]
 [-8.74309017e-01 -1.10474433e+00  3.15775491e-01]
 [ 6.28680162e-03 -3.72789187e-02 -1.96924132e-02]
 [-9.23825100e-02 -7.90440956e-02  4.19675603e-04]
 [ 1.10893031e-01  2.03849555e-02  4.16651858e-02]
 [-8.15886823e-02 -9.10880425e-02 -1.07139634e-01]
 [-6.79741953e-02 -1.61537256e-01  2.73637782e-01]
 [ 5.56183916e-02 -5.90232377e-02  7.81508974e-02]
 [ 4.80776783e-02 -5.24988455e-01 -1.59155747e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.27118322 -49.27387164 -49.25707411]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [   7.3268874   -15.90307369 -140.51672192]
init_Out:  [2.48374395]
Stock Position:  7.326887399052493
Bond position:  [-730.20499595]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [3.05575874]
curr_Stock_Price:  100.10298900657571
curr_Factors:  [100.10298901  -1.02414826  -0.98719827]
mat_Sqrt:  [[13.39461839  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00226264  0.01730555 -0.11846656]
Stock Position:  0.0022626367654939653
Bond Position:  [2.82926203]


portfolio before change:  [3.05868138]
curr_Stock_Price:  101.08204047433064
curr_Factors:  [101.08204047  -1.05386525  -1.01357288]
mat_Sqrt:  [[12.78783516  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.22612493 -0.92887556 -2.33745019]
Stock Position:  -0.2261249329026838
Bond Position:  [25.915851]


portfolio before change:  [3.21639852]
curr_Stock_Price:  100.4132182800738
curr_Factors:  [100.41321828  -1.03583374  -1.03868523]
mat_Sqrt:  [[12.61359102  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01091524  0.08363043 -0.14211134]
Stock Position:  0.01091523941963493
Bond Position:  [2.12036421]


portfolio before change:  [3.2216537]
curr_Stock_Price:  100.84610127555642
curr_Factors:  [100.84610128  -0.82115263  -1.00629021]
mat_Sqrt:  [[16.21850327  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.03870769 -0.00220425 -1.29422045]
Stock Position:  0.03870769082698762
Bond Position:  [-0.68186601]


portfolio before change:  [3.21686862]
curr_Stock_Price:  100.72688480667108
curr_Factors:  [100.72688481  -0.64561575  -0.9907316 ]
mat_Sqrt:  [[19.61050505  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00501077  0.03782379 -0.01922552]
Stock Position:  0.005010769173606562
Bond Position:  [2.71214945]


portfolio before change:  [3.22410588]
curr_Stock_Price:  102.0358934397422
curr_Factors:  [102.03589344  -0.88434404  -1.00103661]
mat_Sqrt:  [[15.48611789  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00326042 0.01121745 0.32307596]
Stock Position:  0.00326041620371839
Bond Position:  [2.8914264]


portfolio before change:  [3.22961896]
curr_Stock_Price:  103.50507033707251
curr_Factors:  [103.50507034  -0.60814834  -1.01826611]
mat_Sqrt:  [[20.35254872  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00605698 0.07469468 0.75421191]
Stock Position:  0.0060569842461270845
Bond Position:  [2.60269038]


portfolio before change:  [3.22765384]
curr_Stock_Price:  103.07319262059075
curr_Factors:  [103.07319262  -0.2526877   -1.01251332]
mat_Sqrt:  [[29.08545821  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00090641 -0.04951959  0.03396975]
Stock Position:  -0.0009064127283061949
Bond Position:  [3.32108069]


portfolio before change:  [3.22772554]
curr_Stock_Price:  103.91019396663384
curr_Factors:  [103.91019397  -0.22534821  -1.03363656]
mat_Sqrt:  [[29.50448355  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.05310075 -0.19234874 -0.16049241]
Stock Position:  -0.053100750009182233
Bond Position:  [8.74543477]


portfolio before change:  [3.1510703]
curr_Stock_Price:  105.39495412979502
curr_Factors:  [105.39495413  -0.63464263  -1.06535989]
mat_Sqrt:  [[19.25387315  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01030506 -0.00551615  0.11433529]
Stock Position:  0.010305057624167729
Bond Position:  [2.06496922]


portfolio before change:  [3.15456435]
curr_Stock_Price:  105.6839135449254
curr_Factors:  [105.68391354  -0.77790274  -1.06485044]
mat_Sqrt:  [[16.73829997  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0091259   0.01227316  0.07656059]
Stock Position:  -0.009125896651258921
Bond Position:  [4.11902482]


portfolio before change:  [3.14895775]
curr_Stock_Price:  106.4111272364378
curr_Factors:  [106.41112724  -0.99569023  -1.01712377]
mat_Sqrt:  [[14.21782075  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.07282105 -0.3565547   0.90081958]
Stock Position:  -0.07282104793525772
Bond Position:  [10.89792755]


portfolio before change:  [3.19842056]
curr_Stock_Price:  105.76930755980003
curr_Factors:  [105.76930756  -0.86743421  -1.0205744 ]
mat_Sqrt:  [[16.01061227  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00033368 -0.01203172 -0.05617697]
Stock Position:  -0.00033368010648227736
Bond Position:  [3.23371367]


portfolio before change:  [3.19945749]
curr_Stock_Price:  105.0848021996254
curr_Factors:  [105.0848022   -0.8707661   -0.95264894]
mat_Sqrt:  [[16.96839718  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00639021 -0.02551137  0.00119722]
Stock Position:  -0.0063902118394522905
Bond Position:  [3.87097164]


portfolio before change:  [3.20119885]
curr_Stock_Price:  104.96375919429376
curr_Factors:  [104.96375919  -0.85056795  -0.92121334]
mat_Sqrt:  [[17.84697194  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00692325 0.00657922 0.11885918]
Stock Position:  0.0069232452257082765
Bond Position:  [2.474509]


portfolio before change:  [3.21132226]
curr_Stock_Price:  106.3366288454295
curr_Factors:  [106.33662885  -0.81586293  -0.95613281]
mat_Sqrt:  [[18.07652377  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00675195 -0.02939854 -0.30563955]
Stock Position:  -0.006751947379948553
Bond Position:  [3.92930159]


portfolio before change:  [3.21238015]
curr_Stock_Price:  106.32545620625942
curr_Factors:  [106.32545621  -0.85464967  -0.94870416]
mat_Sqrt:  [[17.51663315  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00257423 -0.05213593  0.78061243]
Stock Position:  -0.0025742259299522535
Bond Position:  [3.4860859]


portfolio before change:  [3.21014073]
curr_Stock_Price:  107.53399505118749
curr_Factors:  [107.53399505  -0.61781287  -0.94229777]
mat_Sqrt:  [[22.59427139  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00263442 -0.01904967  0.22294276]
Stock Position:  0.0026344203688811697
Bond Position:  [2.92685098]


portfolio before change:  [3.21283412]
curr_Stock_Price:  108.2785930975305
curr_Factors:  [108.2785931   -0.63671148  -0.9635884 ]
mat_Sqrt:  [[21.8545162   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0041901  -0.1694393  -0.45402705]
Stock Position:  -0.004190102922305892
Bond Position:  [3.66653257]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [3.21239351]
Stock Price:  108.6025358683531
PL:  [-5.39014236]
Settle:  Tensor("sub_178:0", shape=(), dtype=float64)
PL:  Tensor("sub_179:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  90
output_Z_Vals[:, i, :]:  [[ 1.19271183e+02 -4.92738716e+01 -4.92570741e+01]
 [ 2.11288125e-02  4.28387091e-02 -4.46414891e-02]
 [-2.19206496e+00 -2.95155081e+00 -8.40647840e-01]
 [-1.50226201e-01  2.83714837e-02  9.87001882e-02]
 [ 6.68038217e-01  1.90140542e-01 -5.85874716e-01]
 [ 7.57175145e-02  1.17192732e-01 -6.73936232e-03]
 [ 1.48555106e-02  2.18570808e-02  1.03493470e-01]
 [ 8.85148432e-02  2.32292232e-01  1.11263280e-01]
 [ 3.54299099e-02 -6.87066233e-02 -1.66287920e-02]
 [-1.14604100e+00 -4.63283120e-01 -4.25049288e-02]
 [ 3.02778377e-01  1.12751378e-02 -8.40987508e-02]
 [ 5.06574795e-02 -6.29927555e-02  3.75210400e-02]
 [-6.35297863e-01 -1.25121873e+00  2.24012453e-01]
 [ 3.28186200e-02  4.66563719e-02  1.09934127e-01]
 [ 8.63581036e-02  1.24303841e-01 -1.03155318e-01]
 [-1.11714155e-01  8.13856708e-02  1.35998181e-01]
 [ 5.86233730e-02  1.11089935e-01  1.19918967e-01]
 [ 1.14050774e-01 -1.11823643e-02 -2.85470973e-02]
 [ 2.64467590e-02 -1.47721380e-03  2.32979388e-02]
 [ 5.47788334e-02 -5.12205621e-01 -3.72696748e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.27118322 -49.27387164 -49.25707411]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [   7.3268874   -15.90307369 -140.51672192]
init_Out:  [2.48374395]
Stock Position:  7.326887399052493
Bond position:  [-730.20499595]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [2.99159697]
curr_Stock_Price:  100.09423197693188
curr_Factors:  [100.09423198  -0.85124573  -0.97246813]
mat_Sqrt:  [[16.15772399  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00128489  0.01382613 -0.12734974]
Stock Position:  0.0012848852695157612
Bond Position:  [2.86298736]


portfolio before change:  [2.99289977]
curr_Stock_Price:  100.55105846782044
curr_Factors:  [100.55105847  -1.00338734  -1.00020051]
mat_Sqrt:  [[13.55936961  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.21875237 -0.95260893 -2.3981343 ]
Stock Position:  -0.2187523721557263
Bond Position:  [24.98868233]


portfolio before change:  [2.68501284]
curr_Stock_Price:  101.9870880777559
curr_Factors:  [101.98708808  -0.93518191  -1.01925673]
mat_Sqrt:  [[14.44585583  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0086037   0.00915686  0.28156416]
Stock Position:  -0.008603699625368656
Bond Position:  [3.56247911]


portfolio before change:  [2.67914892]
curr_Stock_Price:  102.77217432432441
curr_Factors:  [102.77217432  -1.13395234  -1.03885481]
mat_Sqrt:  [[11.70138822  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.05018715  0.0613676  -1.67133749]
Stock Position:  0.05018714921818754
Bond Position:  [-2.47869352]


portfolio before change:  [2.6449919]
curr_Stock_Price:  102.10393007658261
curr_Factors:  [102.10393008  -1.03296634  -1.00469635]
mat_Sqrt:  [[13.30750976  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00738408  0.03782379 -0.01922552]
Stock Position:  0.007384079810397174
Bond Position:  [1.89104833]


portfolio before change:  [2.63457973]
curr_Stock_Price:  100.62981379623724
curr_Factors:  [100.6298138   -0.91653445  -1.00328464]
mat_Sqrt:  [[14.75570056  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00274081 0.00705434 0.29523806]
Stock Position:  0.0027408108733094727
Bond Position:  [2.35877244]


portfolio before change:  [2.63459985]
curr_Stock_Price:  100.42197389018291
curr_Factors:  [100.42197389  -0.89561532  -0.97569799]
mat_Sqrt:  [[15.45708911  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01026343 0.074972   0.31740317]
Stock Position:  0.010263434289810348
Bond Position:  [1.60392552]


portfolio before change:  [2.64171678]
curr_Stock_Price:  101.07632609176362
curr_Factors:  [101.07632609  -1.02446363  -0.9644842 ]
mat_Sqrt:  [[13.83121664  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00130219 -0.02217497 -0.04743732]
Stock Position:  0.0013021913877652846
Bond Position:  [2.51009606]


portfolio before change:  [2.64306711]
curr_Stock_Price:  101.63133815462824
curr_Factors:  [101.63133815  -1.11310638  -0.96021208]
mat_Sqrt:  [[12.78194299  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.09773824 -0.14952398 -0.12125473]
Stock Position:  -0.09773823568283611
Bond Position:  [12.57633479]


portfolio before change:  [2.78280734]
curr_Stock_Price:  100.23377097007673
curr_Factors:  [100.23377097  -1.70045256  -0.98078202]
mat_Sqrt:  [[ 6.86386426  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.04194624  0.00363904 -0.23991033]
Stock Position:  0.04194624314831382
Bond Position:  [-1.42162279]


portfolio before change:  [2.7719841]
curr_Stock_Price:  99.98421840026249
curr_Factors:  [99.9842184  -1.44334698 -1.03799358]
mat_Sqrt:  [[ 8.36178392  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00543641 -0.02033082  0.10703708]
Stock Position:  0.005436410195674481
Bond Position:  [2.22842887]


portfolio before change:  [2.7708971]
curr_Stock_Price:  99.68178154625514
curr_Factors:  [99.68178155 -1.21992148 -1.06541001]
mat_Sqrt:  [[10.14165742  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0833173  -0.40382911  0.63904517]
Stock Position:  -0.08331729529616907
Bond Position:  [11.07611353]


portfolio before change:  [2.82148981]
curr_Stock_Price:  99.10779103762947
curr_Factors:  [99.10779104 -0.77032525 -1.07161618]
mat_Sqrt:  [[15.70951569  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00412378 0.01505828 0.31361147]
Stock Position:  0.004123775874187427
Bond Position:  [2.4127915]


portfolio before change:  [2.81826966]
curr_Stock_Price:  98.18062449210065
curr_Factors:  [98.18062449 -0.62747881 -1.01267434]
mat_Sqrt:  [[19.04216531  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0047618   0.04011889 -0.29427341]
Stock Position:  0.004761802367740606
Bond Position:  [2.35075293]


portfolio before change:  [2.81611485]
curr_Stock_Price:  97.60467170337394
curr_Factors:  [97.6046717  -0.57479093 -1.01412085]
mat_Sqrt:  [[19.92576418  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00337959  0.02626711  0.38796495]
Stock Position:  -0.0033795874379890407
Bond Position:  [3.14597837]


portfolio before change:  [2.81932824]
curr_Stock_Price:  96.88659747522813
curr_Factors:  [96.88659748 -0.44407088 -1.03460028]
mat_Sqrt:  [[22.08436822  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00478972 0.03585412 0.34209543]
Stock Position:  0.0047897167124908244
Bond Position:  [2.35526888]


portfolio before change:  [2.82906023]
curr_Stock_Price:  98.79549916705767
curr_Factors:  [98.79549917 -0.3558724  -1.02370983]
mat_Sqrt:  [[24.8652144   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00426061 -0.00360909 -0.08143692]
Stock Position:  0.004260612043298169
Bond Position:  [2.40813093]


portfolio before change:  [2.85424573]
curr_Stock_Price:  104.56542119817227
curr_Factors:  [104.5654212   -0.76203321  -1.03464854]
mat_Sqrt:  [[17.34199766  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00178185 -0.00047677  0.06646253]
Stock Position:  0.001781853302142092
Bond Position:  [2.66792549]


portfolio before change:  [2.85237302]
curr_Stock_Price:  103.14006203538796
curr_Factors:  [103.14006204  -0.64482498  -1.04968672]
mat_Sqrt:  [[18.94568466  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00664273 -0.16531365 -1.06320008]
Stock Position:  -0.006642732032997587
Bond Position:  [3.53750481]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [2.85273638]
Stock Price:  103.21851280336718
PL:  [-0.36577643]
Settle:  Tensor("sub_180:0", shape=(), dtype=float64)
PL:  Tensor("sub_181:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  91
output_Z_Vals[:, i, :]:  [[ 1.19271183e+02 -4.92738716e+01 -4.92570741e+01]
 [ 4.33689153e-02  7.85699368e-02 -3.43206501e-02]
 [-2.08531647e+00 -2.80919895e+00 -7.99468082e-01]
 [ 9.59986106e-02  2.88201782e-01 -4.90526586e-02]
 [ 1.69943886e-01  1.13242607e-01 -3.00034410e-01]
 [-1.16493554e-01 -2.12930867e-01  5.16685016e-02]
 [-1.41670450e-02  3.32098118e-02 -1.92743844e-02]
 [ 9.70752523e-02  2.41174181e-01  1.09073024e-01]
 [ 1.01363476e-01  1.01059598e-01 -7.38090859e-02]
 [-9.95710830e-01 -4.05835429e-01 -3.47610154e-02]
 [ 6.94999307e-02 -4.13276002e-02 -2.70695823e-01]
 [-6.20882764e-03 -4.98309236e-02  3.09617750e-02]
 [-5.63901334e-01 -1.25942979e+00  2.00190090e-01]
 [ 4.61315214e-02  5.82473588e-02  1.35448281e-01]
 [ 1.26097490e-01  1.32100865e-01 -1.04968446e-01]
 [-2.21462730e-01  1.20979772e-01  1.27362279e-01]
 [ 1.39063445e-03  1.34145845e-01  1.69298710e-01]
 [ 1.15216134e-01 -1.08333916e-02 -3.18137274e-02]
 [-6.85049656e-02 -3.24655076e-01  8.85193796e-02]
 [ 9.69093903e-02 -7.26298850e-01 -7.14718447e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.27118322 -49.27387164 -49.25707411]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [   7.3268874   -15.90307369 -140.51672192]
init_Out:  [2.48374395]
Stock Position:  7.326887399052493
Bond position:  [-730.20499595]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [2.85144835]
curr_Stock_Price:  100.07510398865504
curr_Factors:  [100.07510399  -1.38314528  -1.01252996]
mat_Sqrt:  [[ 9.11795638  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00574704  0.02535834 -0.09790726]
Stock Position:  0.0057470403405732685
Bond Position:  [2.27631269]


portfolio before change:  [2.85096798]
curr_Stock_Price:  99.89248425737638
curr_Factors:  [99.89248426 -1.16030852 -1.07147185]
mat_Sqrt:  [[10.72217554  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.26318656 -0.90666506 -2.28065991]
Stock Position:  -0.2631865642240553
Bond Position:  [29.1413277]


portfolio before change:  [2.68872111]
curr_Stock_Price:  100.53663987573702
curr_Factors:  [100.53663988  -1.44416046  -1.06467837]
mat_Sqrt:  [[ 8.17992848  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01770367  0.09301673 -0.13993358]
Stock Position:  0.017703665905631456
Bond Position:  [0.90885403]


portfolio before change:  [2.6778927]
curr_Stock_Price:  99.91215589821557
curr_Factors:  [99.9121559  -1.48947304 -1.10267848]
mat_Sqrt:  [[ 7.47930475  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01762399  0.03654889 -0.85591466]
Stock Position:  0.01762398687629016
Bond Position:  [0.91704218]


portfolio before change:  [2.67371361]
curr_Stock_Price:  99.66202043531752
curr_Factors:  [99.66202044 -1.3534585  -1.1500304 ]
mat_Sqrt:  [[ 8.15226469  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01832756 -0.06872314  0.14739585]
Stock Position:  -0.01832755708750203
Bond Position:  [4.50027498]


portfolio before change:  [2.67913391]
curr_Stock_Price:  99.42766868182319
curr_Factors:  [99.42766868 -1.25372108 -1.1415664 ]
mat_Sqrt:  [[ 9.06248129  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00124938  0.01071842 -0.05498445]
Stock Position:  -0.0012493805422454085
Bond Position:  [2.80335691]


portfolio before change:  [2.6795712]
curr_Stock_Price:  99.6386828278333
curr_Factors:  [99.63868283 -1.00453236 -1.13433009]
mat_Sqrt:  [[11.7363166   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01436304 0.07783863 0.31115498]
Stock Position:  0.014363038184850725
Bond Position:  [1.24845699]


portfolio before change:  [2.68525224]
curr_Stock_Price:  100.01248175241676
curr_Factors:  [100.01248175  -0.77706951  -1.15209293]
mat_Sqrt:  [[14.52879529  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00735959  0.03261685 -0.21055678]
Stock Position:  0.007359589098483623
Bond Position:  [1.94920147]


portfolio before change:  [2.67658333]
curr_Stock_Price:  98.76835288125632
curr_Factors:  [98.76835288 -0.79915801 -1.17423914]
mat_Sqrt:  [[13.72721125  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.07908724 -0.13098282 -0.0991635 ]
Stock Position:  -0.07908723650388638
Bond Position:  [10.48789941]


portfolio before change:  [2.77422058]
curr_Stock_Price:  97.56695863237104
curr_Factors:  [97.56695863 -1.06720635 -1.17285338]
mat_Sqrt:  [[10.38621213  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 5.59242960e-04 -1.33384256e-02 -7.72219837e-01]
Stock Position:  0.0005592429603466269
Bond Position:  [2.71965694]


portfolio before change:  [2.77519745]
curr_Stock_Price:  98.09781081763104
curr_Factors:  [98.09781082 -0.90551046 -1.19356898]
mat_Sqrt:  [[12.02377106  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00083672 -0.01608286  0.08832533]
Stock Position:  -0.0008367155715885639
Bond Position:  [2.85727742]


portfolio before change:  [2.77539194]
curr_Stock_Price:  98.71919413280439
curr_Factors:  [98.71919413 -0.60318506 -1.18264867]
mat_Sqrt:  [[16.55098576  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.04713422 -0.40647922  0.5710866 ]
Stock Position:  -0.04713421561974034
Bond Position:  [7.42844372]


portfolio before change:  [2.78219836]
curr_Stock_Price:  98.61419443520079
curr_Factors:  [98.61419444 -0.38852161 -1.19261049]
mat_Sqrt:  [[20.28908597  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00422244 0.01879925 0.38639624]
Stock Position:  0.004222441487995914
Bond Position:  [2.3658057]


portfolio before change:  [2.7714049]
curr_Stock_Price:  95.9178894280896
curr_Factors:  [95.91788943 -0.9528361  -1.17609682]
mat_Sqrt:  [[11.41079209  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01153609  0.04263537 -0.29944576]
Stock Position:  0.01153608540309114
Bond Position:  [1.66488793]


portfolio before change:  [2.76758751]
curr_Stock_Price:  95.55089606344862
curr_Factors:  [95.55089606 -1.05036408 -1.16530559]
mat_Sqrt:  [[10.42273395  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01638439  0.03904605  0.36332913]
Stock Position:  -0.016384388406907438
Bond Position:  [4.3331305]


portfolio before change:  [2.76873181]
curr_Stock_Price:  95.5471802293989
curr_Factors:  [95.54718023 -1.54880954 -1.17265666]
mat_Sqrt:  [[ 6.28492534  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01007665 0.04329539 0.4829621 ]
Stock Position:  0.010076650317219412
Bond Position:  [1.80593628]


portfolio before change:  [2.76709382]
curr_Stock_Price:  95.3398172694471
curr_Factors:  [95.33981727 -1.66479307 -1.19274214]
mat_Sqrt:  [[ 5.47346748  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01945948 -0.00349646 -0.09075571]
Stock Position:  0.019459479388095394
Bond Position:  [0.91183061]


portfolio before change:  [2.76054598]
curr_Stock_Price:  94.99161553229737
curr_Factors:  [94.99161553 -1.49526232 -1.15938289]
mat_Sqrt:  [[ 6.68016989  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01747051 -0.10478198  0.25252115]
Stock Position:  -0.017470508196852415
Bond Position:  [4.42009778]


portfolio before change:  [2.76987519]
curr_Stock_Price:  94.52087685060721
curr_Factors:  [94.52087685 -1.4185062  -1.17354778]
mat_Sqrt:  [[ 7.07641017  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02787247 -0.23441195 -2.03889279]
Stock Position:  -0.027872470507618066
Bond Position:  [5.40440554]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [2.76872431]
Stock Price:  94.61064829877219
PL:  [2.76872431]
Settle:  Tensor("sub_182:0", shape=(), dtype=float64)
PL:  Tensor("sub_183:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  92
output_Z_Vals[:, i, :]:  [[ 1.19271183e+02 -4.92738716e+01 -4.92570741e+01]
 [-5.42066589e-04 -7.29430986e-03 -7.08679642e-02]
 [-2.39765143e+00 -3.22570566e+00 -9.19955763e-01]
 [-2.37624034e-01 -7.98295810e-02  1.54323250e-01]
 [ 1.03034897e+00  8.71741524e-02 -6.61099757e-01]
 [ 8.00334853e-02  1.57123877e-01  1.74621461e-02]
 [ 9.85874883e-02 -1.66124048e-01 -9.79198412e-02]
 [-9.96928372e-02  1.19398647e-01  3.15946412e-01]
 [-8.43000356e-02 -3.75455921e-01  8.84312095e-02]
 [-1.64838654e+00 -6.37723044e-01 -6.73838472e-02]
 [ 2.05829671e-01 -4.07730360e-02  3.39866918e-02]
 [-1.61334830e-01  5.45742429e-02  2.60442313e-02]
 [-9.24640125e-01 -1.18079049e+00  3.39467919e-01]
 [-4.86681003e-02 -7.86293300e-02  7.09246137e-02]
 [-1.65021056e-01 -2.04753051e-01  7.00422496e-02]
 [ 1.06224079e-01  1.02900371e-02  2.46507182e-02]
 [-3.19056575e-01 -3.23643257e-01 -3.38537969e-01]
 [-2.08775247e-01 -2.90529387e-01  4.78166371e-01]
 [ 8.44591596e-02  1.20619728e-01  4.74181960e-02]
 [ 5.65926744e-03 -2.56683655e-01  1.05389945e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.27118322 -49.27387164 -49.25707411]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [   7.3268874   -15.90307369 -140.51672192]
init_Out:  [2.48374395]
Stock Position:  7.326887399052493
Bond position:  [-730.20499595]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [12.02279225]
curr_Stock_Price:  101.32684206013707
curr_Factors:  [101.32684206  -0.39684382  -1.03283772]
mat_Sqrt:  [[24.25614089  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00068011 -0.00235423 -0.20216658]
Stock Position:  -0.0006801112365009941
Bond Position:  [12.09170578]


portfolio before change:  [12.02497071]
curr_Stock_Price:  102.5690622735412
curr_Factors:  [102.56906227  -0.52879021  -1.00893734]
mat_Sqrt:  [[22.03889404  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.14718892 -1.04109202 -2.62437772]
Stock Position:  -0.14718892058400898
Bond Position:  [27.12200027]


portfolio before change:  [12.04936279]
curr_Stock_Price:  102.44941514176598
curr_Factors:  [102.44941514  -0.57378334  -1.02371622]
mat_Sqrt:  [[20.73596436  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0107262  -0.02576489  0.44024128]
Stock Position:  -0.010726198889856113
Bond Position:  [13.14825559]


portfolio before change:  [12.03988782]
curr_Stock_Price:  103.63925358138248
curr_Factors:  [103.63925358  -0.54850816  -1.03925166]
mat_Sqrt:  [[21.18209672  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.04311173  0.02813534 -1.88593359]
Stock Position:  0.04311173294869708
Bond Position:  [7.57182]


portfolio before change:  [12.08759322]
curr_Stock_Price:  104.70189266759313
curr_Factors:  [104.70189267  -0.81335161  -1.02991954]
mat_Sqrt:  [[16.57417963  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00697897 0.05071151 0.04981464]
Stock Position:  0.006978970334305625
Bond Position:  [11.35688182]


portfolio before change:  [12.09402291]
curr_Stock_Price:  105.21631140996895
curr_Factors:  [105.21631141  -0.84787266  -1.01346566]
mat_Sqrt:  [[16.35739381  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00273208 -0.05361631 -0.27933805]
Stock Position:  0.0027320828443619877
Bond Position:  [11.80656323]


portfolio before change:  [12.10270492]
curr_Stock_Price:  107.31361293377242
curr_Factors:  [107.31361293  -1.03030129  -1.02224255]
mat_Sqrt:  [[13.77990909  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-7.85810642e-04  3.85357477e-02  9.01307170e-01]
Stock Position:  -0.0007858106417129609
Bond Position:  [12.1870331]


portfolio before change:  [12.10617878]
curr_Stock_Price:  106.7705836222505
curr_Factors:  [106.77058362  -0.52952346  -1.07034147]
mat_Sqrt:  [[21.55952079  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00662764 -0.12117788  0.25226963]
Stock Position:  -0.006627638467850749
Bond Position:  [12.81381561]


portfolio before change:  [12.11540578]
curr_Stock_Price:  105.86179144580392
curr_Factors:  [105.86179145  -0.69784054  -1.07156719]
mat_Sqrt:  [[18.0424382   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0993389  -0.20582423 -0.19222736]
Stock Position:  -0.09933889534484698
Bond Position:  [22.6315992]


portfolio before change:  [12.07986714]
curr_Stock_Price:  106.27650565944052
curr_Factors:  [106.27650566  -0.84379799  -1.05468465]
mat_Sqrt:  [[15.91976779  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01284217 -0.01315944  0.09695457]
Stock Position:  0.012842173162604565
Bond Position:  [10.71504585]


portfolio before change:  [12.08041685]
curr_Stock_Price:  106.1106939915654
curr_Factors:  [106.11069399  -0.64522224  -1.04715057]
mat_Sqrt:  [[19.53309156  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00741709  0.01761376  0.07429694]
Stock Position:  -0.007417087673798945
Bond Position:  [12.86744917]


portfolio before change:  [12.06093989]
curr_Stock_Price:  109.17041591100475
curr_Factors:  [109.17041591  -0.81331234  -1.07243096]
mat_Sqrt:  [[16.56292581  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.06619449 -0.38109849  0.96840748]
Stock Position:  -0.06619448687631986
Bond Position:  [19.28741955]


portfolio before change:  [11.99582405]
curr_Stock_Price:  110.2269736832334
curr_Factors:  [110.22697368  -0.63488247  -1.11586016]
mat_Sqrt:  [[19.14035643  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00262486 -0.02537751  0.20232818]
Stock Position:  -0.0026248632903233806
Bond Position:  [12.28515478]


portfolio before change:  [11.99304772]
curr_Stock_Price:  112.45489925295709
curr_Factors:  [112.45489925  -1.08616251  -1.094789  ]
mat_Sqrt:  [[12.69998406  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01515898 -0.06608376  0.19981104]
Stock Position:  -0.01515897830817993
Bond Position:  [13.6977491]


portfolio before change:  [12.0032223]
curr_Stock_Price:  112.00963732179429
curr_Factors:  [112.00963732  -0.61094278  -1.11421786]
mat_Sqrt:  [[19.95389312  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00568091 0.0033211  0.07032164]
Stock Position:  0.005680912986087834
Bond Position:  [11.3669053]


portfolio before change:  [12.01324101]
curr_Stock_Price:  113.27292472066152
curr_Factors:  [113.27292472  -0.35898594  -1.11054089]
mat_Sqrt:  [[26.05665842  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01743216 -0.10445541 -0.9657546 ]
Stock Position:  -0.017432156679569134
Bond Position:  [13.98783238]


portfolio before change:  [12.0433608]
curr_Stock_Price:  111.7457244974901
curr_Factors:  [111.7457245   -0.14483917  -1.11099771]
mat_Sqrt:  [[31.82935863  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00535587 -0.09376796  1.36407556]
Stock Position:  -0.005355873170863528
Bond Position:  [12.64185673]


portfolio before change:  [12.05779145]
curr_Stock_Price:  109.6415306090562
curr_Factors:  [109.64153061   0.31302647  -1.12566524]
mat_Sqrt:  [[48.64638304  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00244129 0.03892985 0.13527091]
Stock Position:  0.0024412864811703414
Bond Position:  [11.79012507]


portfolio before change:  [12.06107614]
curr_Stock_Price:  109.77948675361465
curr_Factors:  [ 1.09779487e+02  1.23931001e-02 -1.15906444e+00]
mat_Sqrt:  [[34.87611994  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00127838 -0.08284429  0.03006482]
Stock Position:  -0.0012783761807299765
Bond Position:  [12.20141562]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [12.06502508]
Stock Price:  109.07687691522534
PL:  [2.98814816]
Settle:  Tensor("sub_184:0", shape=(), dtype=float64)
PL:  Tensor("sub_185:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  93
output_Z_Vals[:, i, :]:  [[ 1.19271183e+02 -4.92738716e+01 -4.92570741e+01]
 [ 2.58205220e-02  5.03764684e-02 -4.24642339e-02]
 [-2.20932531e+00 -2.97456793e+00 -8.47306268e-01]
 [ 9.67166409e-02  2.34290549e-01 -4.87975488e-02]
 [ 7.63998639e-01 -6.14210275e-02 -4.32458249e-01]
 [ 6.44546132e-02  1.00174478e-01 -4.43507380e-03]
 [-4.54517974e-02  8.54776312e-02 -6.28928761e-02]
 [ 8.73563666e-02  2.08434613e-01  7.83306010e-02]
 [ 9.18177509e-02  9.86971060e-02 -7.14579293e-02]
 [-9.63307478e-01 -3.94070857e-01 -3.30786910e-02]
 [ 1.06072015e-01 -3.48945171e-02 -1.88118105e-01]
 [ 1.72745482e-02 -7.28579313e-02  3.68717085e-02]
 [-5.85582258e-01 -1.26370236e+00  2.09313871e-01]
 [ 2.41112168e-02  3.90751999e-02  9.32464034e-02]
 [ 1.17601392e-01  1.18858895e-01 -1.05235293e-01]
 [-4.12653800e-02  6.18433300e-02  1.08568547e-01]
 [ 1.25539909e-01  1.15578973e-01  1.03380930e-01]
 [ 1.04480834e-01 -1.40481297e-02 -1.72152030e-03]
 [-4.86722668e-02 -1.05288863e-01  2.06722681e-04]
 [ 9.74748155e-02 -7.48237301e-01 -6.63973806e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.27118322 -49.27387164 -49.25707411]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [   7.3268874   -15.90307369 -140.51672192]
init_Out:  [2.48374395]
Stock Position:  7.326887399052493
Bond position:  [-730.20499595]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [4.72962368]
curr_Stock_Price:  100.33144412760497
curr_Factors:  [100.33144413  -1.13388542  -0.98627863]
mat_Sqrt:  [[12.04097119  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00227852  0.01625894 -0.12113864]
Stock Position:  0.0022785205350466207
Bond Position:  [4.50101643]


portfolio before change:  [4.73279503]
curr_Stock_Price:  101.22937479145209
curr_Factors:  [101.22937479  -0.93027947  -1.00475605]
mat_Sqrt:  [[14.61945924  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.20448514 -0.96003767 -2.41712894]
Stock Position:  -0.20448513626401943
Bond Position:  [25.43269753]


portfolio before change:  [4.94204908]
curr_Stock_Price:  100.23715070610862
curr_Factors:  [100.23715071  -0.89374194  -0.96350898]
mat_Sqrt:  [[15.64713705  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00860095  0.07561695 -0.13920582]
Stock Position:  0.008600949850381852
Bond Position:  [4.07991437]


portfolio before change:  [4.94264098]
curr_Stock_Price:  100.18736487904727
curr_Factors:  [100.18736488  -0.69939963  -0.98873799]
mat_Sqrt:  [[18.520986    0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.03580727 -0.01982355 -1.23368301]
Stock Position:  0.035807270386195994
Bond Position:  [1.35520492]


portfolio before change:  [4.92408136]
curr_Stock_Price:  99.659582139676
curr_Factors:  [99.65958214 -0.59564333 -0.97668589]
mat_Sqrt:  [[20.68545873  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00406069  0.03233117 -0.01265203]
Stock Position:  0.004060694926665738
Bond Position:  [4.5193942]


portfolio before change:  [4.91380912]
curr_Stock_Price:  96.85162986497551
curr_Factors:  [96.85162986 -0.61114988 -0.92993614]
mat_Sqrt:  [[20.74062203  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00196916  0.02758779 -0.17941587]
Stock Position:  -0.0019691648356483446
Bond Position:  [5.10452594]


portfolio before change:  [4.91362087]
curr_Stock_Price:  97.59536361225216
curr_Factors:  [97.59536361 -0.76112335 -0.95095088]
mat_Sqrt:  [[17.61508727  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00828222 0.06727198 0.2234554 ]
Stock Position:  0.008282222423712534
Bond Position:  [4.10531436]


portfolio before change:  [4.92532663]
curr_Stock_Price:  98.88478826041965
curr_Factors:  [98.88478826 -0.79005004 -0.94729338]
mat_Sqrt:  [[17.40246729  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00559564  0.03185435 -0.20384958]
Stock Position:  0.005595638993931919
Bond Position:  [4.37200305]


portfolio before change:  [4.92870793]
curr_Stock_Price:  99.29370676937522
curr_Factors:  [99.29370677 -0.93126032 -0.97307306]
mat_Sqrt:  [[14.78700589  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.07104204 -0.12718582 -0.0943643 ]
Stock Position:  -0.07104203664712498
Bond Position:  [11.98273508]


portfolio before change:  [4.96540977]
curr_Stock_Price:  98.81925826763725
curr_Factors:  [98.81925827 -1.32626938 -0.99932358]
mat_Sqrt:  [[ 9.65715942  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00626993 -0.01126216 -0.53664859]
Stock Position:  0.006269934224090946
Bond Position:  [4.34581953]


portfolio before change:  [4.96982647]
curr_Stock_Price:  99.35038095937927
curr_Factors:  [99.35038096 -0.85971333 -0.98410235]
mat_Sqrt:  [[15.71848051  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00063167 -0.0235148   0.10518472]
Stock Position:  0.0006316699138848788
Bond Position:  [4.90706982]


portfolio before change:  [4.97117602]
curr_Stock_Price:  99.54451257093156
curr_Factors:  [99.54451257 -0.77136486 -0.97078047]
mat_Sqrt:  [[17.43464952  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.045932   -0.40785818  0.59711421]
Stock Position:  -0.04593200492113123
Bond Position:  [9.54345506]


portfolio before change:  [4.9811123]
curr_Stock_Price:  99.38013656505352
curr_Factors:  [99.38013657 -1.12140746 -0.99218385]
mat_Sqrt:  [[12.00545278  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00425817 0.01261147 0.26600603]
Stock Position:  0.004258169336555167
Bond Position:  [4.55793485]


portfolio before change:  [4.98136389]
curr_Stock_Price:  99.17158811140038
curr_Factors:  [99.17158811 -1.27005494 -1.02443288]
mat_Sqrt:  [[ 9.99778672  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01204089  0.03836154 -0.300207  ]
Stock Position:  0.012040894791603246
Bond Position:  [3.78724923]


portfolio before change:  [4.97916807]
curr_Stock_Price:  98.91058154743475
curr_Factors:  [98.91058155 -1.29610022 -1.03009179]
mat_Sqrt:  [[ 9.6602952   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00067081  0.01995985  0.30971584]
Stock Position:  -0.000670807793215852
Bond Position:  [5.04551806]


portfolio before change:  [4.98001659]
curr_Stock_Price:  99.52627567255475
curr_Factors:  [99.52627567 -1.42849759 -1.04152335]
mat_Sqrt:  [[ 8.41823966  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.02022215 0.03730295 0.29491702]
Stock Position:  0.020222150876866782
Bond Position:  [2.96738123]


portfolio before change:  [4.99265255]
curr_Stock_Price:  100.11444347356517
curr_Factors:  [100.11444347  -1.52964061  -1.06975492]
mat_Sqrt:  [[ 7.44035405  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01360982 -0.00453401 -0.00491102]
Stock Position:  0.013609818429218089
Bond Position:  [3.63011315]


portfolio before change:  [4.98500183]
curr_Stock_Price:  99.4856058316943
curr_Factors:  [99.48560583 -1.34680504 -1.1058615 ]
mat_Sqrt:  [[ 8.56210803  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00818981 -0.03398183  0.00058972]
Stock Position:  -0.008189813621056008
Bond Position:  [5.7997704]


portfolio before change:  [4.98939946]
curr_Stock_Price:  99.12570641057904
curr_Factors:  [99.12570641 -1.36436213 -1.10308429]
mat_Sqrt:  [[ 8.40597183  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02269715 -0.24149255 -1.89413245]
Stock Position:  -0.022697145971762346
Bond Position:  [7.23927009]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [4.97943496]
Stock Price:  99.64447380598044
PL:  [4.97943496]
Settle:  Tensor("sub_186:0", shape=(), dtype=float64)
PL:  Tensor("sub_187:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  94
output_Z_Vals[:, i, :]:  [[ 1.19271183e+02 -4.92738716e+01 -4.92570741e+01]
 [ 7.83116536e-03  1.97089731e-02 -5.23131565e-02]
 [-2.21542948e+00 -2.98270800e+00 -8.49661039e-01]
 [ 6.81774149e-02  2.78995621e-01 -3.76671511e-02]
 [ 9.00224594e-01 -1.62591830e-02 -5.26595962e-01]
 [ 7.68531072e-02  1.27699178e-01 -3.71604915e-04]
 [ 3.93846637e-02 -5.00282488e-03  1.03130523e-01]
 [ 1.04417615e-01  2.90166691e-01  1.72345792e-01]
 [ 4.83207131e-02 -3.55152902e-02 -2.78082255e-02]
 [-1.08277020e+00 -4.32259409e-01 -3.93911874e-02]
 [ 4.29937840e-01  1.00282746e-01  2.34555199e-02]
 [ 4.69188082e-02 -6.40975910e-02  3.74483191e-02]
 [-6.53657860e-01 -1.18946846e+00  2.32335347e-01]
 [-1.46680038e-02  4.05086940e-03  1.70498433e-02]
 [ 1.33164389e-01  1.20207564e-01 -1.06882622e-01]
 [ 1.25619444e-01  1.46725151e-02  3.17313247e-02]
 [ 6.85832597e-02  5.59771791e-02  3.91939907e-02]
 [ 8.32845189e-02 -2.49436250e-02  4.70375990e-02]
 [-3.66233801e-02  3.98427080e-03 -4.36059928e-02]
 [ 8.54399240e-02 -6.88910832e-01 -5.61988327e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.27118322 -49.27387164 -49.25707411]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [   7.3268874   -15.90307369 -140.51672192]
init_Out:  [2.48374395]
Stock Position:  7.326887399052493
Bond position:  [-730.20499595]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [6.9023957]
curr_Stock_Price:  100.62799188343503
curr_Factors:  [100.62799188  -0.94686168  -1.0257191 ]
mat_Sqrt:  [[13.99709339  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 8.40077471e-05  6.36104371e-03 -1.49234874e-01]
Stock Position:  8.400774708449495e-05
Bond Position:  [6.89394217]


portfolio before change:  [6.90410088]
curr_Stock_Price:  100.40753404990566
curr_Factors:  [100.40753405  -0.96469397  -1.00877714]
mat_Sqrt:  [[13.95399904  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.21482792 -0.96266487 -2.42384645]
Stock Position:  -0.21482791640531154
Bond Position:  [28.47444221]


portfolio before change:  [6.76881302]
curr_Stock_Price:  101.07042445418236
curr_Factors:  [101.07042445  -0.56064926  -1.00800107]
mat_Sqrt:  [[21.05561385  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00557753  0.09004545 -0.1074539 ]
Stock Position:  0.005577533065455247
Bond Position:  [6.20508938]


portfolio before change:  [6.77234518]
curr_Stock_Price:  101.42554535131481
curr_Factors:  [101.42554535  -0.62246007  -0.9943896 ]
mat_Sqrt:  [[20.13531651  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.03920548 -0.00524763 -1.5022317 ]
Stock Position:  0.03920548013844277
Bond Position:  [2.79590798]


portfolio before change:  [6.87223303]
curr_Stock_Price:  103.95551768729354
curr_Factors:  [103.95551769  -0.9187579   -1.0283456 ]
mat_Sqrt:  [[14.83307656  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00693341  0.04121473 -0.00106009]
Stock Position:  0.006933405806206339
Bond Position:  [6.15146724]


portfolio before change:  [6.8666161]
curr_Stock_Price:  102.92355970027418
curr_Factors:  [102.9235597   -0.70506219  -0.98746121]
mat_Sqrt:  [[18.94354365  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00313642 -0.00161465  0.29420268]
Stock Position:  0.003136419314766023
Bond Position:  [6.54380466]


portfolio before change:  [6.86214812]
curr_Stock_Price:  100.97734649611118
curr_Factors:  [100.9773465   -0.69313273  -0.97899637]
mat_Sqrt:  [[18.96826078  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01048212 0.0936509  0.49165457]
Stock Position:  0.01048211968990904
Bond Position:  [5.80369148]


portfolio before change:  [6.8671468]
curr_Stock_Price:  101.31578723223755
curr_Factors:  [101.31578723  -0.79321612  -0.9821795 ]
mat_Sqrt:  [[17.16455705  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00206209 -0.01146251 -0.07932913]
Stock Position:  0.002062089599278647
Bond Position:  [6.65822457]


portfolio before change:  [6.86847286]
curr_Stock_Price:  101.1515382144712
curr_Factors:  [101.15153821  -1.36174001  -0.94525912]
mat_Sqrt:  [[10.07060357  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.11707794 -0.13951112 -0.11237209]
Stock Position:  -0.11707793503670669
Bond Position:  [18.71108608]


portfolio before change:  [6.84142336]
curr_Stock_Price:  101.42253600640282
curr_Factors:  [101.42253601  -1.0826826   -0.96607581]
mat_Sqrt:  [[13.07284146  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.03481996 0.03236612 0.06691207]
Stock Position:  0.03481995935538649
Bond Position:  [3.30989478]


portfolio before change:  [6.79776532]
curr_Stock_Price:  100.14494658839664
curr_Factors:  [100.14494659  -1.23702259  -0.95624195]
mat_Sqrt:  [[11.17136789  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00371298 -0.02068741  0.10682963]
Stock Position:  0.0037129784581965432
Bond Position:  [6.4259293]


portfolio before change:  [6.8019862]
curr_Stock_Price:  100.84901525504125
curr_Factors:  [100.84901526  -1.17226521  -0.99498179]
mat_Sqrt:  [[11.54644385  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.07353189 -0.38389929  0.66278808]
Stock Position:  -0.07353188993762158
Bond Position:  [14.21760489]


portfolio before change:  [6.73938841]
curr_Stock_Price:  101.74866082287768
curr_Factors:  [101.74866082  -1.68057418  -0.98974087]
mat_Sqrt:  [[ 7.04410159  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00147085  0.00130741  0.04863846]
Stock Position:  -0.0014708531236741244
Bond Position:  [6.88904574]


portfolio before change:  [6.74153858]
curr_Stock_Price:  101.45788155134869
curr_Factors:  [101.45788155  -1.52874095  -1.00769872]
mat_Sqrt:  [[ 8.03015704  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01692175  0.03879682 -0.30490637]
Stock Position:  0.016921752652302387
Bond Position:  [5.0246934]


portfolio before change:  [6.76572128]
curr_Stock_Price:  102.8127280066867
curr_Factors:  [102.81272801  -1.46927241  -1.03088328]
mat_Sqrt:  [[ 8.43806877  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01600978 0.00473553 0.09052064]
Stock Position:  0.016009775714342294
Bond Position:  [5.11971257]


portfolio before change:  [6.74875083]
curr_Stock_Price:  101.67276574837383
curr_Factors:  [101.67276575  -1.31356551  -1.02170093]
mat_Sqrt:  [[ 9.84036735  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00894377 0.01806656 0.11180955]
Stock Position:  0.008943771121291796
Bond Position:  [5.83941289]


portfolio before change:  [6.75012327]
curr_Stock_Price:  101.66297101009303
curr_Factors:  [101.66297101  -1.33292731  -1.01382484]
mat_Sqrt:  [[ 9.72705305  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0090258  -0.00805052  0.13418518]
Stock Position:  0.009025799700113963
Bond Position:  [5.83253365]


portfolio before change:  [6.7470246]
curr_Stock_Price:  101.15808702987329
curr_Factors:  [101.15808703  -1.26403339  -0.98774953]
mat_Sqrt:  [[10.64299137  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00420099  0.00128592 -0.12439576]
Stock Position:  -0.004200992808123433
Bond Position:  [7.171989]


portfolio before change:  [6.7494994]
curr_Stock_Price:  100.99584464880311
curr_Factors:  [100.99584465  -1.19216538  -1.03691665]
mat_Sqrt:  [[10.86989833  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01563021 -0.22234502 -1.60319627]
Stock Position:  -0.015630210372107607
Bond Position:  [8.3280857]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [6.75969455]
Stock Price:  100.47679422941079
PL:  [6.28290032]
Settle:  Tensor("sub_188:0", shape=(), dtype=float64)
PL:  Tensor("sub_189:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  95
output_Z_Vals[:, i, :]:  [[ 1.19271183e+02 -4.92738716e+01 -4.92570741e+01]
 [-5.76033600e-03 -5.21421364e-03 -6.12443078e-02]
 [-2.05217088e+00 -2.76499844e+00 -7.86681695e-01]
 [-9.52973863e-02  9.63749568e-02  6.37415548e-02]
 [ 6.37613582e-01  1.69364917e-02 -4.31066598e-01]
 [ 7.57175145e-02  1.17192732e-01 -6.73936232e-03]
 [-1.37330179e-02  3.27127428e-02 -1.54068833e-02]
 [ 9.37597864e-02  2.30321091e-01  9.89391826e-02]
 [ 8.26847437e-02  5.29654641e-02 -5.76101230e-02]
 [-1.13251562e+00 -4.61009547e-01 -4.17466593e-02]
 [ 3.83614489e-01  6.70808362e-02 -1.39519747e-02]
 [ 3.85568934e-02 -6.65686670e-02  3.72856715e-02]
 [-7.13757284e-01 -1.04760630e+00  2.51443509e-01]
 [-1.74107186e-03  1.58529703e-02  4.26384861e-02]
 [ 5.68371038e-02  8.96467928e-02 -8.33552710e-02]
 [ 6.14937594e-02  3.36813728e-02  6.50537600e-02]
 [ 1.25539909e-01  1.15578973e-01  1.03380930e-01]
 [ 1.15216134e-01 -1.08333916e-02 -3.18137274e-02]
 [-4.33104356e-02 -9.92057498e-02  1.16968785e-02]
 [ 4.60710847e-02 -4.53322504e-01 -3.40423812e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.27118322 -49.27387164 -49.25707411]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [   7.3268874   -15.90307369 -140.51672192]
init_Out:  [2.48374395]
Stock Position:  7.326887399052493
Bond position:  [-730.20499595]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [11.09027638]
curr_Stock_Price:  101.19956893297713
curr_Factors:  [101.19956893  -1.12031857  -0.99326494]
mat_Sqrt:  [[12.22534172  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00158082 -0.00168288 -0.17471296]
Stock Position:  -0.0015808249232518493
Bond Position:  [11.25025518]


portfolio before change:  [11.09182265]
curr_Stock_Price:  102.00082771576996
curr_Factors:  [102.00082772  -1.12981169  -1.02911748]
mat_Sqrt:  [[11.77586109  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.23583452 -0.89239941 -2.24418391]
Stock Position:  -0.23583452005960692
Bond Position:  [35.1471389]


portfolio before change:  [11.15999688]
curr_Stock_Price:  101.749014067749
curr_Factors:  [101.74901407  -0.91129018  -1.078355  ]
mat_Sqrt:  [[13.91356064  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0045002   0.03110488  0.18183691]
Stock Position:  -0.004500195305805644
Bond Position:  [11.61788732]


portfolio before change:  [11.1667674]
curr_Stock_Price:  100.89001127930172
curr_Factors:  [100.89001128  -0.76359316  -1.06121709]
mat_Sqrt:  [[16.26833644  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.03399731  0.00546623 -1.22971302]
Stock Position:  0.03399730700137124
Bond Position:  [7.73677871]


portfolio before change:  [11.1530491]
curr_Stock_Price:  100.42960040217116
curr_Factors:  [100.4296004   -0.68521252  -1.08181362]
mat_Sqrt:  [[17.15742192  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00572718  0.03782379 -0.01922552]
Stock Position:  0.005727184107357812
Bond Position:  [10.57787029]


portfolio before change:  [11.14939599]
curr_Stock_Price:  99.32994743531489
curr_Factors:  [99.32994744 -1.2378352  -1.06815696]
mat_Sqrt:  [[ 9.89921     0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00103043  0.01055799 -0.04395155]
Stock Position:  -0.0010304331470379813
Bond Position:  [11.25174886]


portfolio before change:  [11.15203306]
curr_Stock_Price:  99.50096087857885
curr_Factors:  [99.50096088 -1.00285963 -1.10634572]
mat_Sqrt:  [[12.07288407  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01333317 0.07433581 0.28224595]
Stock Position:  0.0133331652539202
Bond Position:  [9.8253703]


portfolio before change:  [11.16793939]
curr_Stock_Price:  100.50970012707214
curr_Factors:  [100.50970013  -1.06275581  -1.09622285]
mat_Sqrt:  [[11.60313806  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00704436  0.01709453 -0.16434565]
Stock Position:  0.007044357855482261
Bond Position:  [10.4599131]


portfolio before change:  [11.17338795]
curr_Stock_Price:  100.91190232937495
curr_Factors:  [100.91190233  -1.02235292  -1.10415754]
mat_Sqrt:  [[12.03401736  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.1026374  -0.14879019 -0.1190916 ]
Stock Position:  -0.10263740428823878
Bond Position:  [21.53072367]


portfolio before change:  [11.16909978]
curr_Stock_Price:  101.00613241664827
curr_Factors:  [101.00613242  -0.94522155  -1.10692898]
mat_Sqrt:  [[12.97508143  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0304013   0.02165025 -0.0398011 ]
Stock Position:  0.03040130229999453
Bond Position:  [8.09838181]


portfolio before change:  [11.14749356]
curr_Stock_Price:  100.22882813948772
curr_Factors:  [100.22882814  -0.98682457  -1.14151658]
mat_Sqrt:  [[11.93069754  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00273073 -0.02148494  0.10636564]
Stock Position:  0.002730731111164807
Bond Position:  [10.87379558]


portfolio before change:  [11.15520058]
curr_Stock_Price:  102.05552875289412
curr_Factors:  [102.05552875  -0.9861574   -1.12745178]
mat_Sqrt:  [[12.32842885  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.07107745 -0.33811348  0.71729834]
Stock Position:  -0.07107745396999071
Bond Position:  [18.40904773]


portfolio before change:  [11.20185684]
curr_Stock_Price:  101.46387250892568
curr_Factors:  [101.46387251  -0.86433538  -1.11799425]
mat_Sqrt:  [[13.97644157  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00072969 0.00511652 0.12163573]
Stock Position:  0.0007296883572371647
Bond Position:  [11.12781983]


portfolio before change:  [11.20502308]
curr_Stock_Price:  101.99004760314467
curr_Factors:  [101.9900476   -0.68663373  -1.10345498]
mat_Sqrt:  [[17.02676515  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00341353  0.02893338 -0.23778939]
Stock Position:  0.0034135289264349967
Bond Position:  [10.85687711]


portfolio before change:  [11.20759033]
curr_Stock_Price:  101.94689188182197
curr_Factors:  [101.94689188  -0.33348478  -1.15217983]
mat_Sqrt:  [[23.07586802  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00353824 0.01087062 0.18558027]
Stock Position:  0.003538241073433114
Bond Position:  [10.84687765]


portfolio before change:  [11.20385175]
curr_Stock_Price:  100.12377311130085
curr_Factors:  [100.12377311  -0.40104332  -1.19488056]
mat_Sqrt:  [[20.29720661  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00838711 0.03730295 0.29491702]
Stock Position:  0.008387110393419816
Bond Position:  [10.36410262]


portfolio before change:  [11.19123834]
curr_Stock_Price:  98.31090096071291
curr_Factors:  [98.31090096 -0.11238929 -1.22523525]
mat_Sqrt:  [[25.80350614  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00412777 -0.00349646 -0.09075571]
Stock Position:  0.004127765700505914
Bond Position:  [10.78543398]


portfolio before change:  [11.2041393]
curr_Stock_Price:  100.78300304520293
curr_Factors:  [100.78300305  -0.29176549  -1.23589231]
mat_Sqrt:  [[21.87428895  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00279658 -0.03201852  0.03336794]
Stock Position:  -0.0027965758935893834
Bond Position:  [11.48598661]


portfolio before change:  [11.20127933]
curr_Stock_Price:  102.83258979949647
curr_Factors:  [102.8325898   -0.38524659  -1.25759428]
mat_Sqrt:  [[19.89088238  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00582939 -0.14630921 -0.97113438]
Stock Position:  -0.0058293896342086916
Bond Position:  [11.80073056]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [11.20329816]
Stock Price:  102.99242122951618
PL:  [8.21087693]
Settle:  Tensor("sub_190:0", shape=(), dtype=float64)
PL:  Tensor("sub_191:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  96
output_Z_Vals[:, i, :]:  [[ 1.19271183e+02 -4.92738716e+01 -4.92570741e+01]
 [ 8.59739767e-02  1.31329677e-01 -4.69199630e-02]
 [-2.21333069e+00 -2.40849947e+00 -7.35605038e-01]
 [-4.28127662e-02 -5.17267527e-03 -1.33380982e-01]
 [ 3.46079187e-01 -5.45405669e-02 -2.27824677e-01]
 [-1.21007018e-01 -2.20460686e-01  5.41847640e-02]
 [-5.77739031e-02  1.01134562e-01 -1.01503919e-01]
 [ 1.34098193e-01  3.48540578e-01  2.09284612e-01]
 [-5.07327327e-02  2.47165448e-01 -9.09023254e-02]
 [-8.16315232e-01 -3.35065018e-01 -2.55669599e-02]
 [ 5.99448442e-02 -3.73340097e-02 -2.80270252e-01]
 [-1.38335662e-02 -4.14057933e-02  2.88702838e-02]
 [-5.75996905e-01 -1.21344773e+00  2.02171859e-01]
 [ 1.08984675e-01  7.72670574e-02  1.36669348e-01]
 [ 8.26431457e-02  1.30469485e-01 -1.02882822e-01]
 [-2.25223327e-01  1.29429979e-01  1.14500624e-01]
 [ 7.47800844e-02  1.08598705e-01  1.06227612e-01]
 [ 1.05074061e-01 -1.38930217e-02 -4.33954690e-03]
 [-4.89751350e-02 -1.18054770e-01  7.81205557e-03]
 [ 6.20568387e-02 -4.41392189e-01 -4.93547236e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.27118322 -49.27387164 -49.25707411]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [   7.3268874   -15.90307369 -140.51672192]
init_Out:  [2.48374395]
Stock Position:  7.326887399052493
Bond position:  [-730.20499595]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-6.94674309]
curr_Stock_Price:  98.73781150598492
curr_Factors:  [98.73781151 -0.97469952 -1.04176842]
mat_Sqrt:  [[13.14445544  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00785153  0.04238647 -0.13384959]
Stock Position:  0.007851526282270902
Bond Position:  [-7.72198561]


portfolio before change:  [-6.94959669]
curr_Stock_Price:  98.62027236652284
curr_Factors:  [98.62027237 -1.4984068  -1.04571905]
mat_Sqrt:  [[ 7.7458018   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.36860204 -0.77733986 -2.09847642]
Stock Position:  -0.36860203820979043
Bond Position:  [29.40203671]


portfolio before change:  [-6.80036269]
curr_Stock_Price:  98.23535162733253
curr_Factors:  [98.23535163 -1.06887039 -1.03268987]
mat_Sqrt:  [[12.01079569  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00591925 -0.00166947 -0.38049881]
Stock Position:  -0.005919250887999683
Bond Position:  [-6.218883]


portfolio before change:  [-6.80722815]
curr_Stock_Price:  99.13251669124686
curr_Factors:  [99.13251669 -1.17420228 -1.01420922]
mat_Sqrt:  [[11.11222661  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.02595714 -0.01760289 -0.64992039]
Stock Position:  0.025957140101701453
Bond Position:  [-9.38042478]


portfolio before change:  [-6.83045263]
curr_Stock_Price:  98.32814936497158
curr_Factors:  [98.32814936 -0.89220269 -1.01556683]
mat_Sqrt:  [[14.5929835   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01061798 -0.07115338  0.15457405]
Stock Position:  -0.010617976016089246
Bond Position:  [-5.7864067]


portfolio before change:  [-6.8127842]
curr_Stock_Price:  96.52788057469952
curr_Factors:  [96.52788057 -0.68912519 -1.0059858 ]
mat_Sqrt:  [[17.72047762  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00326455  0.03264104 -0.28956243]
Stock Position:  -0.0032645450628296054
Bond Position:  [-6.49766458]


portfolio before change:  [-6.82104318]
curr_Stock_Price:  98.56012844279283
curr_Factors:  [98.56012844 -0.38625536 -1.01818211]
mat_Sqrt:  [[24.19701627  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.0102477  0.11249099 0.59703074]
Stock Position:  0.010247700803264766
Bond Position:  [-7.83105789]


portfolio before change:  [-6.82858336]
curr_Stock_Price:  98.01540442590056
curr_Factors:  [98.01540443 -0.40910788 -1.01405701]
mat_Sqrt:  [[23.61683397  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00079755  0.07977231 -0.25931903]
Stock Position:  -0.000797552135214422
Bond Position:  [-6.75041097]


portfolio before change:  [-6.82956702]
curr_Stock_Price:  97.13251290790893
curr_Factors:  [97.13251291 -0.6102881  -0.97981883]
mat_Sqrt:  [[19.80568914  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.04493299 -0.10814177 -0.07293542]
Stock Position:  -0.04493299472047322
Bond Position:  [-2.46511233]


portfolio before change:  [-6.81424728]
curr_Stock_Price:  96.77784922749008
curr_Factors:  [96.77784923 -0.52479452 -0.99096861]
mat_Sqrt:  [[21.25633585  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-2.29854023e-04 -1.20494998e-02 -7.99533018e-01]
Stock Position:  -0.00022985402263696233
Bond Position:  [-6.7920025]


portfolio before change:  [-6.8162278]
curr_Stock_Price:  98.00608211639408
curr_Factors:  [98.00608212 -0.43590667 -1.0242179 ]
mat_Sqrt:  [[22.75773226  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0007203  -0.01336366  0.08235888]
Stock Position:  -0.0007202987614810803
Bond Position:  [-6.74563414]


portfolio before change:  [-6.81763163]
curr_Stock_Price:  97.61348353603937
curr_Factors:  [97.61348354 -0.39493224 -1.04590749]
mat_Sqrt:  [[23.10793122  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.03385949 -0.39163857  0.57674004]
Stock Position:  -0.03385948832976158
Bond Position:  [-3.51248903]


portfolio before change:  [-6.77923786]
curr_Stock_Price:  96.45363122433824
curr_Factors:  [96.45363122 -0.2370061  -1.0544165 ]
mat_Sqrt:  [[26.51312212  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00575769 0.02493784 0.38987961]
Stock Position:  0.005757687082549858
Bond Position:  [-7.33458769]


portfolio before change:  [-6.78430363]
curr_Stock_Price:  95.89231377647646
curr_Factors:  [95.89231378 -0.14192005 -1.09070387]
mat_Sqrt:  [[27.95516303  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00315771  0.04210885 -0.29349605]
Stock Position:  0.0031577082817676252
Bond Position:  [-7.08710358]


portfolio before change:  [-6.78845859]
curr_Stock_Price:  95.13766262375373
curr_Factors:  [95.13766262 -0.31688277 -1.06075729]
mat_Sqrt:  [[23.99114646  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00731233  0.04177335  0.32663841]
Stock Position:  -0.007312330893815939
Bond Position:  [-6.09278052]


portfolio before change:  [-6.807823]
curr_Stock_Price:  97.57751623382832
curr_Factors:  [97.57751623 -0.3717266  -1.06458346]
mat_Sqrt:  [[23.20428675  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00511247 0.03505008 0.30303781]
Stock Position:  0.005112474434108989
Bond Position:  [-7.30668555]


portfolio before change:  [-6.80051256]
curr_Stock_Price:  99.36477841187289
curr_Factors:  [99.36477841 -0.33128526 -1.06392491]
mat_Sqrt:  [[24.62069944  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00411655 -0.00448395 -0.01237952]
Stock Position:  0.004116550545692318
Bond Position:  [-7.2095527]


portfolio before change:  [-6.80303602]
curr_Stock_Price:  99.18966921354091
curr_Factors:  [99.18966921 -0.6993268  -1.07627386]
mat_Sqrt:  [[16.80091249  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00425443 -0.03810201  0.02228562]
Stock Position:  -0.004254431715784464
Bond Position:  [-6.38104035]


portfolio before change:  [-6.80009612]
curr_Stock_Price:  98.12363580577033
curr_Factors:  [98.12363581 -0.51043681 -1.07679457]
mat_Sqrt:  [[20.06539919  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00641836 -0.14245872 -1.40795289]
Stock Position:  -0.00641835584450068
Bond Position:  [-6.1703037]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-6.79299873]
Stock Price:  96.77747205845284
PL:  [-6.79299873]
Settle:  Tensor("sub_192:0", shape=(), dtype=float64)
PL:  Tensor("sub_193:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  97
output_Z_Vals[:, i, :]:  [[ 1.19271183e+02 -4.92738716e+01 -4.92570741e+01]
 [ 2.39818099e-02  4.74223705e-02 -4.33175147e-02]
 [-2.28606826e+00 -3.12110724e+00 -8.91511821e-01]
 [-3.77584807e-02  3.01015128e-02 -1.27308950e-01]
 [ 8.89098093e-01 -7.31310971e-02 -4.76406284e-01]
 [ 8.26649069e-02  1.81469657e-01  3.22176612e-02]
 [ 6.93646559e-03  2.79330853e-02  9.18840014e-02]
 [ 1.23158981e-01  3.19864376e-01  1.82529195e-01]
 [ 1.01363476e-01  1.01059598e-01 -7.38090859e-02]
 [-1.14961918e+00 -4.71357867e-01 -4.25466708e-02]
 [ 3.31191837e-01  1.08308465e-01  6.25311823e-02]
 [-4.13046826e-02 -6.13278086e-02  3.47216530e-02]
 [-6.71635273e-01 -1.04425637e+00  2.36289410e-01]
 [-8.64851398e-03 -9.34032941e-03  1.98244421e-03]
 [-1.00780677e-02 -9.40173942e-03 -3.17731883e-02]
 [-2.69375977e-02  5.74837527e-02  1.06922461e-01]
 [ 9.37719866e-02  1.10894162e-01  9.48464934e-02]
 [ 1.15216134e-01 -1.08333916e-02 -3.18137274e-02]
 [-5.09828294e-02 -1.28475306e-01  8.92036110e-03]
 [ 6.98918876e-02 -5.85583541e-01 -5.04369331e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.27118322 -49.27387164 -49.25707411]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [   7.3268874   -15.90307369 -140.51672192]
init_Out:  [2.48374395]
Stock Position:  7.326887399052493
Bond position:  [-730.20499595]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [1.99236988]
curr_Stock_Price:  99.95785386303623
curr_Factors:  [99.95785386 -0.85881004 -1.01112922]
mat_Sqrt:  [[15.40680626  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00161096  0.0153055  -0.12357281]
Stock Position:  0.001610957498573697
Bond Position:  [1.83134203]


portfolio before change:  [1.99177517]
curr_Stock_Price:  99.30445113222703
curr_Factors:  [99.30445113 -0.81260536 -1.04378949]
mat_Sqrt:  [[15.51481764  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.20014033 -1.00733303 -2.54323508]
Stock Position:  -0.2001403286662735
Bond Position:  [21.86660066]


portfolio before change:  [2.04734181]
curr_Stock_Price:  99.05413024349046
curr_Factors:  [99.05413024 -0.54899981 -1.02740992]
mat_Sqrt:  [[20.47606697  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00281308  0.00971522 -0.363177  ]
Stock Position:  -0.0028130825078990195
Bond Position:  [2.32598925]


portfolio before change:  [2.04412323]
curr_Stock_Price:  100.40501310841601
curr_Factors:  [100.40501311  -0.34723817  -1.02655305]
mat_Sqrt:  [[25.41706786  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.03056703 -0.02360296 -1.35905452]
Stock Position:  0.030567028771860547
Bond Position:  [-1.02495969]


portfolio before change:  [2.06124401]
curr_Stock_Price:  100.9735031275911
curr_Factors:  [100.97350313  -0.17342009  -1.01699291]
mat_Sqrt:  [[30.70560277  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00411272 0.05856908 0.09190802]
Stock Position:  0.00411272330365315
Bond Position:  [1.64596793]


portfolio before change:  [2.05575199]
curr_Stock_Price:  99.53806328316945
curr_Factors:  [ 9.95380633e+01 -5.81292255e-02 -1.03651281e+00]
mat_Sqrt:  [[33.31134669  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00094244 0.00901536 0.26211948]
Stock Position:  0.0009424424144939324
Bond Position:  [1.9619431]


portfolio before change:  [2.05650754]
curr_Stock_Price:  99.81924831333247
curr_Factors:  [99.81924831 -0.6447201  -1.04903033]
mat_Sqrt:  [[18.34965175  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01230049 0.10323578 0.52070499]
Stock Position:  0.012300486242188035
Bond Position:  [0.82868225]


portfolio before change:  [2.06814743]
curr_Stock_Price:  100.7486988380718
curr_Factors:  [100.74869884  -0.67940133  -1.03054983]
mat_Sqrt:  [[18.22288338  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00586768  0.03261685 -0.21055678]
Stock Position:  0.00586767534098529
Bond Position:  [1.47698677]


portfolio before change:  [2.07016389]
curr_Stock_Price:  101.02941751673862
curr_Factors:  [101.02941752  -0.71899224  -1.03606518]
mat_Sqrt:  [[17.46771504  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.07181932 -0.1521301  -0.12137381]
Stock Position:  -0.0718193248180948
Bond Position:  [9.32602844]


portfolio before change:  [1.99564241]
curr_Stock_Price:  102.09950939418378
curr_Factors:  [102.09950939  -0.65541266  -1.00237452]
mat_Sqrt:  [[19.45610186  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01881489 0.03495641 0.17838406]
Stock Position:  0.018814885763820056
Bond Position:  [0.0746518]


portfolio before change:  [1.97190222]
curr_Stock_Price:  100.83674027527142
curr_Factors:  [100.83674028  -0.36175771  -1.0067981 ]
mat_Sqrt:  [[25.66034917  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00182132 -0.01979347  0.09905121]
Stock Position:  -0.0018213174352488012
Bond Position:  [2.15555793]


portfolio before change:  [1.97138047]
curr_Stock_Price:  101.41912517268496
curr_Factors:  [101.41912517  -0.65145644  -1.00130106]
mat_Sqrt:  [[19.42389841  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.04306864 -0.33703229  0.67406792]
Stock Position:  -0.04306863741237889
Bond Position:  [6.33936399]


portfolio before change:  [1.91045664]
curr_Stock_Price:  102.87050298730107
curr_Factors:  [102.87050299  -0.56856998  -0.99632847]
mat_Sqrt:  [[21.51117341  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00047187 -0.00301458  0.00565536]
Stock Position:  -0.0004718680758363925
Bond Position:  [1.95899795]


portfolio before change:  [1.91154777]
curr_Stock_Price:  101.59617457207534
curr_Factors:  [101.59617457  -0.40044267  -0.99501083]
mat_Sqrt:  [[25.16747241  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00073439 -0.0030344  -0.09064006]
Stock Position:  -0.0007343949492309887
Bond Position:  [1.98615948]


portfolio before change:  [1.91371897]
curr_Stock_Price:  99.31592691407481
curr_Factors:  [99.31592691 -0.28508854 -1.01782837]
mat_Sqrt:  [[26.98791125  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [2.45357271e-04 1.85528014e-02 3.05020021e-01]
Stock Position:  0.00024535727111564445
Bond Position:  [1.88935109]


portfolio before change:  [1.91396441]
curr_Stock_Price:  98.39091430319726
curr_Factors:  [98.3909143  -0.75816915 -1.02226481]
mat_Sqrt:  [[16.58526264  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.0081861  0.03579094 0.27057065]
Stock Position:  0.008186100218184278
Bond Position:  [1.10852652]


portfolio before change:  [1.91545103]
curr_Stock_Price:  98.53865981705076
curr_Factors:  [98.53865982 -0.96257622 -1.01076061]
mat_Sqrt:  [[13.69611368  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00777672 -0.00349646 -0.09075571]
Stock Position:  0.007776719010247852
Bond Position:  [1.14914357]


portfolio before change:  [1.91628276]
curr_Stock_Price:  98.60866382944991
curr_Factors:  [98.60866383 -0.72952759 -1.02474557]
mat_Sqrt:  [[17.06254943  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00441827 -0.04146523  0.02544731]
Stock Position:  -0.004418265895468098
Bond Position:  [2.35196205]


portfolio before change:  [1.90762678]
curr_Stock_Price:  100.70089606412076
curr_Factors:  [100.70089606  -0.90109401  -1.0268705 ]
mat_Sqrt:  [[14.64633585  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01041857 -0.18899628 -1.43882531]
Stock Position:  -0.010418565593727983
Bond Position:  [2.95678567]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [1.90546723]
Stock Price:  100.9791340407974
PL:  [0.92633319]
Settle:  Tensor("sub_194:0", shape=(), dtype=float64)
PL:  Tensor("sub_195:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  98
output_Z_Vals[:, i, :]:  [[ 1.19271183e+02 -4.92738716e+01 -4.92570741e+01]
 [ 3.34362239e-02  6.26119505e-02 -3.89300581e-02]
 [-2.19744537e+00 -2.57267256e+00 -7.60714212e-01]
 [ 7.75584483e-02  1.80006152e-01 -4.84136718e-02]
 [ 4.78246931e-01 -4.90608306e-02 -3.06060072e-01]
 [ 5.92506956e-02  9.37491302e-02 -3.79022266e-03]
 [ 1.14561058e-02  2.50347526e-02  7.76434045e-02]
 [-3.30570319e-03  1.83629036e-04 -1.60355347e-02]
 [ 1.46673221e-02 -1.22166284e-01  1.37737610e-03]
 [-1.21841617e+00 -5.00699056e-01 -4.60257374e-02]
 [ 2.55537907e-01  6.67184987e-02  6.30006713e-02]
 [-1.74793184e-01  3.55777122e-02  2.67243641e-02]
 [-8.51930289e-01 -1.06066249e+00  3.06244633e-01]
 [ 2.00382376e-02 -4.20779270e-02 -1.85531972e-02]
 [-1.73534050e-01 -2.19485719e-01  7.82017820e-02]
 [ 1.29151228e-01  1.54705389e-02  3.30206620e-02]
 [-3.39686536e-02 -4.44531653e-02 -6.07367484e-02]
 [-8.30871298e-02 -1.77567436e-01  2.89289120e-01]
 [ 4.82484939e-02 -1.31097058e-03  4.06085059e-02]
 [ 9.03359828e-03 -2.64937801e-01 -4.02018570e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.27118322 -49.27387164 -49.25707411]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [   7.3268874   -15.90307369 -140.51672192]
init_Out:  [2.48374395]
Stock Position:  7.326887399052493
Bond position:  [-730.20499595]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [3.45144646]
curr_Stock_Price:  100.15699389344135
curr_Factors:  [100.15699389  -1.20043996  -0.99952565]
mat_Sqrt:  [[11.09809292  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00344836  0.02020792 -0.11105662]
Stock Position:  0.0034483645310920985
Bond Position:  [3.10606864]


portfolio before change:  [3.44921311]
curr_Stock_Price:  99.28412751254288
curr_Factors:  [99.28412751 -1.46367145 -0.95753487]
mat_Sqrt:  [[ 8.81786162  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.32636825 -0.8303265  -2.17010591]
Stock Position:  -0.3263682536162564
Bond Position:  [35.85240042]


portfolio before change:  [3.36773246]
curr_Stock_Price:  99.56125274668628
curr_Factors:  [99.56125275 -1.66316611 -0.9386911 ]
mat_Sqrt:  [[ 7.38104959  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01414699  0.05809674 -0.13811073]
Stock Position:  0.014146992202080827
Bond Position:  [1.95924019]


portfolio before change:  [3.36857534]
curr_Stock_Price:  99.5862059935673
curr_Factors:  [99.58620599 -1.27843594 -0.94958396]
mat_Sqrt:  [[10.72957301  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.03781681 -0.01583431 -0.87310419]
Stock Position:  0.03781680590528346
Bond Position:  [-0.39745688]


portfolio before change:  [3.42543993]
curr_Stock_Price:  101.09251943036878
curr_Factors:  [101.09251943  -1.24755327  -0.93866259]
mat_Sqrt:  [[11.35684084  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00683407  0.0302574  -0.01081245]
Stock Position:  0.006834073115453601
Bond Position:  [2.73456626]


portfolio before change:  [3.42501385]
curr_Stock_Price:  100.93012626783154
curr_Factors:  [100.93012627  -1.37330065  -0.9304442 ]
mat_Sqrt:  [[10.08131394  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00321537 0.00807993 0.22149502]
Stock Position:  0.0032153742075192305
Bond Position:  [3.10048572]


portfolio before change:  [3.42704305]
curr_Stock_Price:  101.32012305175459
curr_Factors:  [101.32012305  -1.54012652  -0.96737062]
mat_Sqrt:  [[ 8.25474268  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-7.92448671e-04  5.92660166e-05 -4.57449169e-02]
Stock Position:  -0.0007924486713113248
Bond Position:  [3.50733405]


portfolio before change:  [3.42795096]
curr_Stock_Price:  101.28105311460074
curr_Factors:  [101.28105311  -1.24074683  -0.99361549]
mat_Sqrt:  [[10.84318783  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00092119 -0.039429    0.00392927]
Stock Position:  -0.0009211876316134512
Bond Position:  [3.52124981]


portfolio before change:  [3.42825452]
curr_Stock_Price:  101.90725910335654
curr_Factors:  [101.9072591   -0.63208747  -0.99353636]
mat_Sqrt:  [[20.05421473  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.06632102 -0.16159993 -0.13129862]
Stock Position:  -0.06632101638033662
Bond Position:  [10.18684752]


portfolio before change:  [3.35480834]
curr_Stock_Price:  103.05309824721984
curr_Factors:  [103.05309825  -0.45397671  -0.99758881]
mat_Sqrt:  [[24.13538081  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01168478 0.0215333  0.17972338]
Stock Position:  0.011684784417505773
Bond Position:  [2.1506551]


portfolio before change:  [3.38327581]
curr_Stock_Price:  105.44336421373285
curr_Factors:  [105.44336421  -0.78057481  -1.01991822]
mat_Sqrt:  [[17.42107964  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00930343  0.01148266  0.07623717]
Stock Position:  -0.009303431800460614
Bond Position:  [4.36426096]


portfolio before change:  [3.37950228]
curr_Stock_Price:  105.96626069596759
curr_Factors:  [105.9662607   -0.79162111  -0.98302402]
mat_Sqrt:  [[17.96590186  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0559908  -0.34232735  0.8736307 ]
Stock Position:  -0.05599079831813409
Bond Position:  [9.31263781]


portfolio before change:  [3.33804335]
curr_Stock_Price:  106.74830668458898
curr_Factors:  [106.74830668  -0.6180509   -0.98061229]
mat_Sqrt:  [[21.58094168  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00035503 -0.01358059 -0.05292711]
Stock Position:  0.00035503368232490154
Bond Position:  [3.30014411]


portfolio before change:  [3.33941371]
curr_Stock_Price:  108.28400061069208
curr_Factors:  [108.28400061  -0.56682176  -1.00398507]
mat_Sqrt:  [[22.50979567  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00899046 -0.07083871  0.22308792]
Stock Position:  -0.00899046422999848
Bond Position:  [4.31293715]


portfolio before change:  [3.35159161]
curr_Stock_Price:  107.0494117866434
curr_Factors:  [107.04941179  -0.71559271  -0.98658454]
mat_Sqrt:  [[19.5136315   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00712576 0.00499309 0.09419876]
Stock Position:  0.007125759886309735
Bond Position:  [2.58878321]


portfolio before change:  [3.33610127]
curr_Stock_Price:  104.78472503527476
curr_Factors:  [104.78472504  -1.03329446  -0.99769135]
mat_Sqrt:  [[13.74839651  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0040325  -0.0143472  -0.17326504]
Stock Position:  -0.0040325033398400725
Bond Position:  [3.75864603]


portfolio before change:  [3.3280409]
curr_Stock_Price:  107.01662661482479
curr_Factors:  [107.01662661  -0.9540697   -0.97540315]
mat_Sqrt:  [[15.54146113  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00387879 -0.05730964  0.82526134]
Stock Position:  -0.003878788235284317
Bond Position:  [3.74313573]


portfolio before change:  [3.33148225]
curr_Stock_Price:  106.37069012211246
curr_Factors:  [106.37069012  -0.34851489  -1.00687133]
mat_Sqrt:  [[27.42743659  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0020516  -0.00042311  0.11584476]
Stock Position:  0.0020515978427256016
Bond Position:  [3.11325238]


portfolio before change:  [3.33586955]
curr_Stock_Price:  108.12975011499098
curr_Factors:  [ 1.08129750e+02 -4.68897525e-03 -9.94081243e-01]
mat_Sqrt:  [[39.82766127  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00133708 -0.08550831 -0.11468471]
Stock Position:  -0.0013370801071096482
Bond Position:  [3.48044769]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [3.33442545]
Stock Price:  109.86062181948007
PL:  [-6.52619637]
Settle:  Tensor("sub_196:0", shape=(), dtype=float64)
PL:  Tensor("sub_197:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  99
output_Z_Vals[:, i, :]:  [[ 1.19271183e+02 -4.92738716e+01 -4.92570741e+01]
 [ 7.24162021e-04  6.82609406e-03 -5.68562145e-02]
 [-2.13220759e+00 -2.87172946e+00 -8.17557003e-01]
 [-1.39747761e-01  4.13440970e-02  9.20313401e-02]
 [ 7.21319144e-01  6.89482179e-02 -5.11125317e-01]
 [ 7.35147033e-02  1.13864282e-01 -6.28868691e-03]
 [ 1.57231440e-02  3.02765640e-02  1.04301076e-01]
 [ 9.94595098e-02  2.47121428e-01  1.14620833e-01]
 [ 2.52068615e-02  5.44723459e-02 -2.27498472e-02]
 [-9.04969835e-01 -3.67212431e-01 -3.01706017e-02]
 [ 9.37995645e-02 -3.81592977e-02 -2.07644115e-01]
 [ 7.10498518e-03 -6.43109741e-02  3.45716979e-02]
 [-6.15748226e-01 -1.26952943e+00  2.18254571e-01]
 [ 5.08191875e-03  2.20822615e-02  5.61444805e-02]
 [ 1.14168623e-01  1.24200653e-01 -1.05537488e-01]
 [ 8.12959130e-02  2.83513813e-02  5.56782344e-02]
 [ 4.73702132e-02  3.52029829e-02  1.85231388e-02]
 [ 8.27074166e-02 -2.46040024e-02  5.04053173e-02]
 [-1.44293048e-02 -1.93238295e-02 -6.32158165e-03]
 [ 8.55672346e-02 -6.87749891e-01 -5.72528118e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.27118322 -49.27387164 -49.25707411]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [   7.3268874   -15.90307369 -140.51672192]
init_Out:  [2.48374395]
Stock Position:  7.326887399052493
Bond position:  [-730.20499595]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [9.50340603]
curr_Stock_Price:  100.982987147921
curr_Factors:  [100.98298715  -1.09779315  -1.02451673]
mat_Sqrt:  [[12.09318628  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00078459  0.00220311 -0.16219495]
Stock Position:  -0.0007845900442080342
Bond Position:  [9.58263628]


portfolio before change:  [9.5059185]
curr_Stock_Price:  100.83448732533219
curr_Factors:  [100.83448733  -1.0866807   -1.00187566]
mat_Sqrt:  [[12.48994699  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.23100819 -0.9268467  -2.33226257]
Stock Position:  -0.23100818913727558
Bond Position:  [32.79951082]


portfolio before change:  [9.25588816]
curr_Stock_Price:  101.95233186593242
curr_Factors:  [101.95233187  -0.90112333  -1.01417187]
mat_Sqrt:  [[15.01740967  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00749281  0.01334375  0.2625398 ]
Stock Position:  -0.007492811131550518
Bond Position:  [10.01979773]


portfolio before change:  [9.25811371]
curr_Stock_Price:  101.98966215817238
curr_Factors:  [101.98966216  -0.94072785  -1.02322288]
mat_Sqrt:  [[14.30945805  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.04410091  0.02225294 -1.45809826]
Stock Position:  0.04410090999320175
Bond Position:  [4.7602768]


portfolio before change:  [9.18886971]
curr_Stock_Price:  100.39254720483365
curr_Factors:  [100.3925472   -0.96600276  -1.01062719]
mat_Sqrt:  [[13.90791397  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00686469  0.03674954 -0.01793987]
Stock Position:  0.006864687252736647
Bond Position:  [8.49970627]


portfolio before change:  [9.19505998]
curr_Stock_Price:  100.98471969948649
curr_Factors:  [100.9847197   -0.63050081  -1.00788939]
mat_Sqrt:  [[19.62057994  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00220145 0.00977172 0.29754194]
Stock Position:  0.0022014481671045606
Bond Position:  [8.97274735]


portfolio before change:  [9.193953]
curr_Stock_Price:  99.46279053520742
curr_Factors:  [99.46279054 -0.82687776 -0.99554392]
mat_Sqrt:  [[16.07655385  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01077966 0.0797581  0.32698133]
Stock Position:  0.010779663429891794
Bond Position:  [8.12177759]


portfolio before change:  [9.1748734]
curr_Stock_Price:  97.50444623624796
curr_Factors:  [97.50444624 -1.06642729 -0.97038613]
mat_Sqrt:  [[12.71884258  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00249096  0.01758087 -0.06489898]
Stock Position:  0.0024909648224209083
Bond Position:  [8.93199326]


portfolio before change:  [9.18083728]
curr_Stock_Price:  99.002099419864
curr_Factors:  [99.00209942 -1.37885577 -1.00676516]
mat_Sqrt:  [[ 9.11134298  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.10822612 -0.1185173  -0.08606833]
Stock Position:  -0.10822612087684932
Bond Position:  [19.89545046]


portfolio before change:  [9.23988095]
curr_Stock_Price:  98.5025048382581
curr_Factors:  [98.50250484 -1.27619561 -0.97698857]
mat_Sqrt:  [[10.34908184  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00421536 -0.01231586 -0.59235086]
Stock Position:  0.004215364565681386
Bond Position:  [8.82465698]


portfolio before change:  [9.24245179]
curr_Stock_Price:  98.58895037001676
curr_Factors:  [98.58895037 -1.46119497 -0.96093457]
mat_Sqrt:  [[ 8.74803979  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00011825 -0.02075628  0.09862343]
Stock Position:  0.00011825287472440488
Bond Position:  [9.23079336]


portfolio before change:  [9.24487636]
curr_Stock_Price:  99.57480053387043
curr_Factors:  [99.57480053 -1.07963643 -0.99364993]
mat_Sqrt:  [[12.52369903  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0663014  -0.40973886  0.62261954]
Stock Position:  -0.06630140235685247
Bond Position:  [15.84682527]


portfolio before change:  [9.16747021]
curr_Stock_Price:  100.80204979049952
curr_Factors:  [100.80204979  -0.96009334  -1.02832794]
mat_Sqrt:  [[13.80094969  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00152525 0.00712702 0.16016458]
Stock Position:  0.0015252490640990009
Bond Position:  [9.01372198]


portfolio before change:  [9.16881977]
curr_Stock_Price:  100.20926013841583
curr_Factors:  [100.20926014  -1.0290307   -1.0335571 ]
mat_Sqrt:  [[12.73905915  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00926114  0.04008559 -0.30106908]
Stock Position:  0.009261141228708249
Bond Position:  [8.24076766]


portfolio before change:  [9.18399615]
curr_Stock_Price:  101.62549233180067
curr_Factors:  [101.62549233  -1.33713437  -1.0351721 ]
mat_Sqrt:  [[ 9.47813859  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01038689 0.00915037 0.1588345 ]
Stock Position:  0.010386890374156367
Bond Position:  [8.1284233]


portfolio before change:  [9.19009156]
curr_Stock_Price:  102.0166632879472
curr_Factors:  [102.01666329  -1.5144075   -1.03624141]
mat_Sqrt:  [[ 7.9604637   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00732834 0.01136171 0.05284136]
Stock Position:  0.0073283434343741774
Bond Position:  [8.44247841]


portfolio before change:  [9.19022017]
curr_Stock_Price:  101.74616954823486
curr_Factors:  [101.74616955  -1.46339693  -1.0291405 ]
mat_Sqrt:  [[ 8.41439343  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01045519 -0.00794091  0.14379234]
Stock Position:  0.010455190701937166
Bond Position:  [8.12644456]


portfolio before change:  [9.19354638]
curr_Stock_Price:  101.86996838363181
curr_Factors:  [101.86996838  -1.431182    -1.02938869]
mat_Sqrt:  [[ 8.69829028  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00226069 -0.00623674 -0.01803371]
Stock Position:  -0.002260691674696672
Bond Position:  [9.42384296]


portfolio before change:  [9.19809909]
curr_Stock_Price:  100.89838305944393
curr_Factors:  [100.89838306  -1.23854945  -0.96527342]
mat_Sqrt:  [[11.13720194  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01541554 -0.22197032 -1.63326336]
Stock Position:  -0.015415535921813661
Bond Position:  [10.75350173]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [9.20641151]
Stock Price:  100.53357483161233
PL:  [8.67283668]
Settle:  Tensor("sub_198:0", shape=(), dtype=float64)
PL:  Tensor("sub_199:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  100
output_Z_Vals[:, i, :]:  [[ 1.19271183e+02 -4.92738716e+01 -4.92570741e+01]
 [-1.32720176e-04  4.33260747e-03 -5.82031311e-02]
 [-2.10149210e+00 -2.83076957e+00 -8.05708064e-01]
 [ 5.37350907e-02  1.50935850e-01 -7.41437666e-02]
 [ 6.33197592e-01 -6.44499231e-02 -3.70335751e-01]
 [-1.18375447e-01 -2.16070431e-01  5.27176592e-02]
 [-5.32641798e-02  8.95558112e-02 -9.70926460e-02]
 [ 7.33539860e-02  1.29376805e-01  1.17939101e-02]
 [ 1.35028847e-02  1.93273606e-01 -7.95375774e-02]
 [-8.86289744e-01 -3.63935136e-01 -2.91262623e-02]
 [ 4.22099183e-02 -4.10134305e-02 -2.93401930e-01]
 [ 1.93122714e-01  7.83240605e-02  1.45290954e-02]
 [-6.39637543e-01 -1.16890231e+00  2.19817821e-01]
 [ 5.41793800e-02  6.52542929e-02  1.50871989e-01]
 [ 1.16239471e-01  1.31476832e-01 -1.04491362e-01]
 [-2.45392508e-01  1.31281552e-01  1.29098749e-01]
 [ 3.76230959e-02  1.19750928e-01  1.34293577e-01]
 [ 1.15035867e-01 -1.08868423e-02 -3.12859105e-02]
 [-6.56022814e-02 -3.13203942e-01  8.11172521e-02]
 [ 3.82595790e-02 -3.23710256e-01 -3.25846044e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.27118322 -49.27387164 -49.25707411]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [   7.3268874   -15.90307369 -140.51672192]
init_Out:  [2.48374395]
Stock Position:  7.326887399052493
Bond position:  [-730.20499595]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [8.70195847]
curr_Stock_Price:  100.87360269623193
curr_Factors:  [100.8736027   -0.97698012  -0.98382114]
mat_Sqrt:  [[14.19751588  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00078387  0.00139834 -0.16603733]
Stock Position:  -0.0007838691541298068
Bond Position:  [8.78103017]


portfolio before change:  [8.70471434]
curr_Stock_Price:  100.15877050225669
curr_Factors:  [100.1587705   -1.21453534  -0.96079974]
mat_Sqrt:  [[11.37504087  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.25000218 -0.91362695 -2.29846084]
Stock Position:  -0.2500021778222638
Bond Position:  [33.74462509]


portfolio before change:  [8.84670117]
curr_Stock_Price:  99.62457668027272
curr_Factors:  [99.62457668 -0.90063107 -0.97746356]
mat_Sqrt:  [[15.23071719  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00455725  0.04871434 -0.21151153]
Stock Position:  0.004557251515504317
Bond Position:  [8.39268691]


portfolio before change:  [8.84976073]
curr_Stock_Price:  99.83547763348898
curr_Factors:  [99.83547763 -0.95754248 -0.96828063]
mat_Sqrt:  [[14.55159339  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.03741496 -0.02080112 -1.05646482]
Stock Position:  0.03741496362838115
Bond Position:  [5.11441996]


portfolio before change:  [8.81212678]
curr_Stock_Price:  98.79544693015195
curr_Factors:  [98.79544693 -1.00069916 -0.92651222]
mat_Sqrt:  [[14.38002575  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01055072 -0.06973643  0.15038881]
Stock Position:  -0.010550724607495357
Bond Position:  [9.85449033]


portfolio before change:  [8.83373512]
curr_Stock_Price:  96.98093537259359
curr_Factors:  [96.98093537 -1.01242262 -0.89404235]
mat_Sqrt:  [[14.41183077  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00380261  0.02890401 -0.27697829]
Stock Position:  -0.003802614019388918
Bond Position:  [9.20251619]


portfolio before change:  [8.83678421]
curr_Stock_Price:  96.78418477346057
curr_Factors:  [96.78418477 -0.93374638 -0.89803009]
mat_Sqrt:  [[15.49794035  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00659251 0.04175618 0.03364474]
Stock Position:  0.006592510704067812
Bond Position:  [8.19873343]


portfolio before change:  [8.84264254]
curr_Stock_Price:  97.36186964021499
curr_Factors:  [97.36186964 -0.73444642 -0.90737589]
mat_Sqrt:  [[18.85187429  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00194777  0.06237879 -0.22689857]
Stock Position:  0.0019477720829217168
Bond Position:  [8.65300381]


portfolio before change:  [8.84714976]
curr_Stock_Price:  98.56513887089169
curr_Factors:  [98.56513887 -0.81375554 -0.88508769]
mat_Sqrt:  [[18.02706799  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0536151  -0.11745956 -0.08308912]
Stock Position:  -0.05361510072184069
Bond Position:  [14.1317296]


portfolio before change:  [8.97247116]
curr_Stock_Price:  96.29361399949575
curr_Factors:  [96.293614   -0.53182329 -0.84886375]
mat_Sqrt:  [[24.20876987  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00107615 -0.01323703 -0.83699404]
Stock Position:  -0.001076152629946061
Bond Position:  [9.07609779]


portfolio before change:  [8.97625627]
curr_Stock_Price:  94.88508155516614
curr_Factors:  [94.88508156 -0.13814136 -0.84847808]
mat_Sqrt:  [[35.37647511  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00599484 0.02527898 0.04144747]
Stock Position:  0.005994839349218418
Bond Position:  [8.40743545]


portfolio before change:  [8.98870164]
curr_Stock_Price:  96.61044059318078
curr_Factors:  [96.61044059 -0.66456206 -0.87350848]
mat_Sqrt:  [[20.75145298  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.04015953 -0.3772616   0.62707906]
Stock Position:  -0.040159530175561106
Bond Position:  [12.86853155]


portfolio before change:  [8.96340581]
curr_Stock_Price:  97.32044307996597
curr_Factors:  [97.32044308 -0.88456892 -0.86762058]
mat_Sqrt:  [[16.87476949  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00582503 0.02106073 0.43039579]
Stock Position:  0.0058250260906656205
Bond Position:  [8.39651169]


portfolio before change:  [8.95789033]
curr_Stock_Price:  96.01317455844202
curr_Factors:  [96.01317456 -0.95929338 -0.8841767 ]
mat_Sqrt:  [[15.19574325  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00801197  0.04243397 -0.29808477]
Stock Position:  0.008011971189231634
Bond Position:  [8.18863554]


portfolio before change:  [8.95780761]
curr_Stock_Price:  95.74730656307942
curr_Factors:  [95.74730656 -0.91812648 -0.86258499]
mat_Sqrt:  [[16.13516477  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01191451  0.04237094  0.3682828 ]
Stock Position:  -0.011914511235981473
Bond Position:  [10.09858997]


portfolio before change:  [8.95481028]
curr_Stock_Price:  96.2107996138115
curr_Factors:  [96.21079961 -1.07437284 -0.90208185]
mat_Sqrt:  [[13.33093037  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00671219 0.03864945 0.38310219]
Stock Position:  0.006712188185544806
Bond Position:  [8.30902529]


portfolio before change:  [8.95617357]
curr_Stock_Price:  96.10439148834988
curr_Factors:  [96.10439149 -0.68082649 -0.90230524]
mat_Sqrt:  [[19.73321558  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00539331 -0.00351371 -0.08924999]
Stock Position:  0.005393312087612157
Bond Position:  [8.43785259]


portfolio before change:  [8.94617931]
curr_Stock_Price:  93.86013227117124
curr_Factors:  [93.86013227 -0.6818532  -0.90978452]
mat_Sqrt:  [[19.10916364  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00591218 -0.10108614  0.23140494]
Stock Position:  -0.005912178093469119
Bond Position:  [9.50109712]


portfolio before change:  [8.95249279]
curr_Stock_Price:  93.19406362538936
curr_Factors:  [93.19406363 -0.32618305 -0.88131256]
mat_Sqrt:  [[27.85990106  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00338589 -0.10447704 -0.92954807]
Stock Position:  -0.0033858894687372747
Bond Position:  [9.26803759]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [8.9550875]
Stock Price:  93.11213355579905
PL:  [8.9550875]
Settle:  Tensor("sub_200:0", shape=(), dtype=float64)
PL:  Tensor("sub_201:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  101
output_Z_Vals[:, i, :]:  [[ 1.19271183e+02 -4.92738716e+01 -4.92570741e+01]
 [ 3.07109084e-02  5.82334244e-02 -4.01947799e-02]
 [-2.21998615e+00 -2.98878443e+00 -8.51418839e-01]
 [-9.96517683e-02  9.09841050e-02  6.65128369e-02]
 [ 1.16242024e+00 -1.16190951e-01 -5.69009541e-01]
 [ 8.32109001e-02  1.86521159e-01  3.52792804e-02]
 [ 1.28466987e-02  3.70112361e-02  1.05318845e-01]
 [-7.55025584e-02  9.17568293e-02  2.50232761e-01]
 [ 5.19529306e-03 -1.46554933e-01  9.59190836e-03]
 [-1.23403121e+00 -5.10412467e-01 -4.67504764e-02]
 [ 1.73989941e-01 -1.48347865e-02  4.30111807e-02]
 [-1.87469487e-01  6.39791546e-02  2.48641517e-02]
 [-7.74264508e-01 -9.72570657e-01  2.73173669e-01]
 [ 9.11885748e-03 -3.82672562e-02 -1.94577960e-02]
 [-1.64007935e-01 -2.02999734e-01  6.90711937e-02]
 [ 9.90126881e-02  2.35826949e-02  4.72900518e-02]
 [-1.78653749e-01 -1.86145051e-01 -2.01723768e-01]
 [-1.32972589e-01 -2.29112822e-01  3.44896982e-01]
 [ 7.35500603e-02 -1.90406900e-01  1.81288500e-01]
 [ 9.98832724e-02 -9.01337815e-01 -1.67857237e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.27118322 -49.27387164 -49.25707411]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [   7.3268874   -15.90307369 -140.51672192]
init_Out:  [2.48374395]
Stock Position:  7.326887399052493
Bond position:  [-730.20499595]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [3.00829498]
curr_Stock_Price:  100.09651098212349
curr_Factors:  [100.09651098  -1.10823629  -1.011887  ]
mat_Sqrt:  [[12.01326596  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00286292  0.01879476 -0.11466452]
Stock Position:  0.00286292099432505
Bond Position:  [2.72172658]


portfolio before change:  [3.01110372]
curr_Stock_Price:  100.83988460950512
curr_Factors:  [100.83988461  -0.92171297  -1.01998892]
mat_Sqrt:  [[14.46644841  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.20764353 -0.96462603 -2.42886096]
Stock Position:  -0.20764352631162297
Bond Position:  [23.94985295]


portfolio before change:  [2.8069554]
curr_Stock_Price:  101.85189077803383
curr_Factors:  [101.85189078  -0.65036539  -0.98562557]
mat_Sqrt:  [[19.83660057  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00340294  0.02936499  0.18974261]
Stock Position:  -0.0034029439350678177
Bond Position:  [3.15355167]


portfolio before change:  [2.81126776]
curr_Stock_Price:  100.81635246965025
curr_Factors:  [100.81635247  -0.15341034  -0.96270182]
mat_Sqrt:  [[33.0224758   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0309654  -0.03750047 -1.62322584]
Stock Position:  0.03096540323783511
Bond Position:  [-0.31055124]


portfolio before change:  [2.76727057]
curr_Stock_Price:  99.39800985430232
curr_Factors:  [ 9.93980099e+01  5.87854622e-02 -9.40236482e-01]
mat_Sqrt:  [[41.16881581  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00312095 0.06019945 0.10064197]
Stock Position:  0.003120947801094844
Bond Position:  [2.45705457]


portfolio before change:  [2.77313624]
curr_Stock_Price:  101.08061730739725
curr_Factors:  [101.08061731  -0.34618939  -0.87375069]
mat_Sqrt:  [[29.84383562  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00140397 0.01194533 0.30044535]
Stock Position:  0.0014039651370739885
Bond Position:  [2.63122257]


portfolio before change:  [2.77822551]
curr_Stock_Price:  104.23695169447394
curr_Factors:  [104.23695169  -0.66437714  -0.84789198]
mat_Sqrt:  [[22.97479098  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-2.47846679e-04  2.96143893e-02  7.13844415e-01]
Stock Position:  -0.0002478466789615345
Bond Position:  [2.80406029]


portfolio before change:  [2.77934046]
curr_Stock_Price:  102.56718402617543
curr_Factors:  [102.56718403  -0.45792676  -0.82523227]
mat_Sqrt:  [[28.42755747  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00080071 -0.0473004   0.02736304]
Stock Position:  -0.000800707809430105
Bond Position:  [2.8614668]


portfolio before change:  [2.78028321]
curr_Stock_Price:  102.2833087383242
curr_Factors:  [102.28330874  -0.33320728  -0.84854326]
mat_Sqrt:  [[31.37451561  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.04295721 -0.16473492 -0.1333661 ]
Stock Position:  -0.04295720891444652
Bond Position:  [7.17408868]


portfolio before change:  [2.66052057]
curr_Stock_Price:  105.11301748051862
curr_Factors:  [105.11301748  -0.41930291  -0.85719957]
mat_Sqrt:  [[29.32773467  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00612872 -0.00478791  0.12269893]
Stock Position:  0.0061287182706997395
Bond Position:  [2.0163125]


portfolio before change:  [2.66498475]
curr_Stock_Price:  105.75916193832815
curr_Factors:  [105.75916194  -0.51886161  -0.85208203]
mat_Sqrt:  [[26.84879162  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00630697  0.02064918  0.0709305 ]
Stock Position:  -0.006306966249878567
Bond Position:  [3.33200421]


portfolio before change:  [2.67900525]
curr_Stock_Price:  103.66823587912585
curr_Factors:  [103.66823588  -0.59188143  -0.88053087]
mat_Sqrt:  [[23.77853936  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.03856538 -0.31389583  0.77928844]
Stock Position:  -0.038565376378188285
Bond Position:  [6.67700979]


portfolio before change:  [2.60173547]
curr_Stock_Price:  105.71513016017164
curr_Factors:  [105.71513016  -0.48125122  -0.88567802]
mat_Sqrt:  [[26.94556675  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-9.88741294e-05 -1.23507038e-02 -5.55076759e-02]
Stock Position:  -9.887412938479014e-05
Bond Position:  [2.61218796]


portfolio before change:  [2.60208587]
curr_Stock_Price:  108.77682008932939
curr_Factors:  [108.77682009  -0.75186054  -0.91702095]
mat_Sqrt:  [[20.49983366  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00933403 -0.06551788  0.19704089]
Stock Position:  -0.009334026156745607
Bond Position:  [3.61741156]


portfolio before change:  [2.62318377]
curr_Stock_Price:  106.61339923814336
curr_Factors:  [106.61339924  -0.48982319  -0.94392797]
mat_Sqrt:  [[25.41801171  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00446453 0.00761128 0.13490535]
Stock Position:  0.004464532011287248
Bond Position:  [2.14720483]


portfolio before change:  [2.63351169]
curr_Stock_Price:  108.80647510760329
curr_Factors:  [108.80647511  -0.95694173  -0.98429128]
mat_Sqrt:  [[15.61665295  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01650976 -0.06007806 -0.57546176]
Stock Position:  -0.01650975668075001
Bond Position:  [4.42988012]


portfolio before change:  [2.62950557]
curr_Stock_Price:  109.11621486896884
curr_Factors:  [109.11621487  -1.11836074  -0.97439782]
mat_Sqrt:  [[13.45909312  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00812375 -0.07394585  0.98389509]
Stock Position:  -0.008123745458709645
Bond Position:  [3.51593793]


portfolio before change:  [2.63003278]
curr_Stock_Price:  109.15953111870526
curr_Factors:  [109.15953112  -1.25526792  -0.93238388]
mat_Sqrt:  [[12.24550103  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00585429 -0.06145356  0.51716563]
Stock Position:  0.005854294935107562
Bond Position:  [1.99098069]


portfolio before change:  [2.63560686]
curr_Stock_Price:  110.02663465822843
curr_Factors:  [110.02663466  -1.35419844  -0.91854572]
mat_Sqrt:  [[11.33594106  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01044159 -0.29090553 -0.47884998]
Stock Position:  -0.010441590427222019
Bond Position:  [3.78445992]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [2.63056669]
Stock Price:  110.59995788478561
PL:  [-7.96939119]
Settle:  Tensor("sub_202:0", shape=(), dtype=float64)
PL:  Tensor("sub_203:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  102
output_Z_Vals[:, i, :]:  [[ 1.19271183e+02 -4.92738716e+01 -4.92570741e+01]
 [-3.94400452e-04  3.64478340e-03 -5.85518574e-02]
 [-2.48957682e+00 -2.74929585e+00 -8.42362681e-01]
 [-3.76437174e-02 -4.28492739e-03 -1.34716480e-01]
 [ 1.99414995e-01 -1.07213180e-01 -8.23859745e-02]
 [-1.46539170e-01 -2.59211768e-01  5.35660820e-02]
 [-3.65981576e-02  4.92799591e-02 -9.04348070e-02]
 [-1.43115966e-02  2.66198005e-02 -2.69408131e-02]
 [ 4.88708737e-03 -1.03808227e-01  4.46770771e-02]
 [-7.90568364e-01 -3.18384350e-01 -2.43861032e-02]
 [ 6.07535038e-02 -5.40319375e-02 -2.79682265e-01]
 [-1.75740826e-02 -3.04469482e-02  2.66021531e-02]
 [-6.79293049e-01 -1.18243567e+00  2.32200140e-01]
 [ 4.65966486e-02  5.86523255e-02  1.36339697e-01]
 [ 9.33300946e-02  1.22656820e-01 -1.03268297e-01]
 [-4.21816270e-02  6.15868694e-02  1.14139898e-01]
 [ 8.36317912e-02  1.09103511e-01  8.25558725e-02]
 [ 1.09230659e-01 -1.26257714e-02 -1.50357932e-02]
 [-1.79020993e-02  5.41559538e-03 -2.95830432e-02]
 [ 2.14801759e-02 -1.67993215e-01 -1.93406446e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.27118322 -49.27387164 -49.25707411]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [   7.3268874   -15.90307369 -140.51672192]
init_Out:  [2.48374395]
Stock Position:  7.326887399052493
Bond position:  [-730.20499595]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [8.12084493]
curr_Stock_Price:  100.79429022577247
curr_Factors:  [100.79429023  -0.90027228  -0.99726289]
mat_Sqrt:  [[15.11286757  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00076771  0.00117635 -0.16703215]
Stock Position:  -0.0007677073819307834
Bond Position:  [8.19822545]


portfolio before change:  [8.12489664]
curr_Stock_Price:  98.18665282905728
curr_Factors:  [98.18665283 -1.07066581 -1.00560421]
mat_Sqrt:  [[12.31231854  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.2617477  -0.88733142 -2.40302626]
Stock Position:  -0.26174769896484157
Bond Position:  [33.82502709]


portfolio before change:  [8.25962496]
curr_Stock_Price:  97.70423787029489
curr_Factors:  [97.70423787 -1.16587772 -1.01330303]
mat_Sqrt:  [[11.05368859  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00597242 -0.00138295 -0.38430862]
Stock Position:  -0.005972419089739972
Bond Position:  [8.84315562]


portfolio before change:  [8.25986752]
curr_Stock_Price:  98.03383832821767
curr_Factors:  [98.03383833 -1.23944952 -1.01341711]
mat_Sqrt:  [[10.30311297  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01559851 -0.0346029  -0.23502425]
Stock Position:  0.015598511899082368
Bond Position:  [6.73068552]


portfolio before change:  [8.27807072]
curr_Stock_Price:  99.09293432594508
curr_Factors:  [99.09293433 -1.28550751 -1.01419892]
mat_Sqrt:  [[ 9.93786001  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01896952 -0.08366024  0.15280912]
Stock Position:  -0.018969518531737437
Bond Position:  [10.15781597]


portfolio before change:  [8.29484732]
curr_Stock_Price:  98.34242327440498
curr_Factors:  [98.34242327 -1.49708416 -1.01101264]
mat_Sqrt:  [[ 8.00734069  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0056197   0.01590504 -0.25798533]
Stock Position:  -0.005619700403161171
Bond Position:  [8.84750228]


portfolio before change:  [8.30016699]
curr_Stock_Price:  97.78945577967339
curr_Factors:  [97.78945578 -1.50379496 -1.01275055]
mat_Sqrt:  [[ 7.89532842  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00182097  0.0085915  -0.07685464]
Stock Position:  -0.001820965803504443
Bond Position:  [8.47823824]


portfolio before change:  [8.30240035]
curr_Stock_Price:  97.72710700723839
curr_Factors:  [97.72710701 -1.47313066 -1.01792646]
mat_Sqrt:  [[ 8.09399035  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00088745 -0.03350396  0.12745127]
Stock Position:  -0.0008874495418971489
Bond Position:  [8.38912822]


portfolio before change:  [8.304257]
curr_Stock_Price:  97.99855069725423
curr_Factors:  [97.9985507  -1.68275847 -1.00638398]
mat_Sqrt:  [[ 6.65794072  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.12924959 -0.10275811 -0.06956676]
Stock Position:  -0.12924958720148713
Bond Position:  [20.97052922]


portfolio before change:  [8.36457339]
curr_Stock_Price:  97.57245183105329
curr_Factors:  [97.57245183 -1.38902779 -1.0338384 ]
mat_Sqrt:  [[ 8.65146795  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00085137 -0.01743873 -0.79785565]
Stock Position:  -0.0008513725665866654
Bond Position:  [8.4476439]


portfolio before change:  [8.36682257]
curr_Stock_Price:  97.41152436174596
curr_Factors:  [97.41152436 -0.82139186 -1.02320207]
mat_Sqrt:  [[15.39973947  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00119216 -0.00982671  0.07588854]
Stock Position:  -0.001192156412270451
Bond Position:  [8.48295235]


portfolio before change:  [8.36915287]
curr_Stock_Price:  97.23596320622579
curr_Factors:  [97.23596321 -1.18569858 -1.03850674]
mat_Sqrt:  [[10.5163934   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.08303788 -0.38162947  0.66240237]
Stock Position:  -0.083037884860598
Bond Position:  [16.44342159]


portfolio before change:  [8.31315353]
curr_Stock_Price:  97.95985818725799
curr_Factors:  [97.95985819 -1.08116454 -1.01631201]
mat_Sqrt:  [[12.0261234   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.0071843  0.01892996 0.3889392 ]
Stock Position:  0.0071842958475992055
Bond Position:  [7.60938093]


portfolio before change:  [8.3084727]
curr_Stock_Price:  97.04349624897189
curr_Factors:  [97.04349625 -0.73715616 -1.04096658]
mat_Sqrt:  [[16.39598619  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00593363  0.03958732 -0.29459571]
Stock Position:  0.005933632728811909
Bond Position:  [7.73265224]


portfolio before change:  [8.3206628]
curr_Stock_Price:  98.77206451932732
curr_Factors:  [98.77206452 -0.57922914 -1.06250886]
mat_Sqrt:  [[19.12653836  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00032999  0.01987708  0.32560936]
Stock Position:  -0.00032998918576240593
Bond Position:  [8.35325651]


portfolio before change:  [8.3228906]
curr_Stock_Price:  98.35015708040304
curr_Factors:  [98.35015708 -0.1905714  -1.03718871]
mat_Sqrt:  [[28.81148323  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.0042606  0.03521301 0.23550893]
Stock Position:  0.0042605963086585355
Bond Position:  [7.90386028]


portfolio before change:  [8.32762661]
curr_Stock_Price:  98.99790761251982
curr_Factors:  [98.99790761 -0.20532693 -1.0145137 ]
mat_Sqrt:  [[29.2318271   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00354354 -0.00407495 -0.04289293]
Stock Position:  0.003543544008461119
Bond Position:  [7.97682317]


portfolio before change:  [8.33367368]
curr_Stock_Price:  100.14156984536355
curr_Factors:  [100.14156985   0.11132855  -0.99564705]
mat_Sqrt:  [[41.35802102  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00055214  0.00174788 -0.08439219]
Stock Position:  -0.0005521361596484152
Bond Position:  [8.38896547]


portfolio before change:  [8.33524842]
curr_Stock_Price:  101.0883812121048
curr_Factors:  [101.08838121   0.31844559  -1.00592697]
mat_Sqrt:  [[50.83137672  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0010287  -0.05421958 -0.55173476]
Stock Position:  -0.0010286996773179503
Bond Position:  [8.439238]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [8.33808437]
Stock Price:  100.38275469294706
PL:  [7.95532968]
Settle:  Tensor("sub_204:0", shape=(), dtype=float64)
PL:  Tensor("sub_205:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  103
output_Z_Vals[:, i, :]:  [[ 1.19271183e+02 -4.92738716e+01 -4.92570741e+01]
 [ 5.90326478e-02  1.03735486e-01 -2.70516701e-02]
 [-2.20076686e+00 -2.96315502e+00 -8.44004723e-01]
 [ 1.04371946e-01  2.59563660e-01 -4.38796620e-02]
 [ 4.76135370e-01  1.27091691e-02 -3.62034127e-01]
 [-1.39922261e-01 -2.26502134e-01 -3.38511753e-02]
 [-1.19331094e-02  3.31293621e-02 -1.47493513e-02]
 [-4.25175694e-03  3.83373740e-02 -2.24845355e-02]
 [ 5.66706710e-02 -1.40157583e-02 -3.50496516e-02]
 [-8.03832711e-01 -3.29276309e-01 -2.49456039e-02]
 [ 7.02965344e-02 -3.76927409e-02 -2.72814635e-01]
 [ 6.37165835e-02  1.43488267e-02  2.15105923e-02]
 [-6.56734708e-01 -1.18359944e+00  2.25454025e-01]
 [ 9.47331436e-02  6.74923690e-02  1.31924974e-01]
 [-2.75989168e-03  1.22773066e-02 -4.48697493e-02]
 [ 7.33829740e-02  3.04812455e-02  5.94246936e-02]
 [ 2.79604149e-02  1.61947298e-02 -3.90555044e-04]
 [-3.01080423e-02 -1.23958694e-01  2.26964072e-01]
 [ 5.83316121e-02 -8.01069189e-02  9.45256397e-02]
 [ 1.01477592e-01 -8.69064506e-01 -3.40212122e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.27118322 -49.27387164 -49.25707411]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [   7.3268874   -15.90307369 -140.51672192]
init_Out:  [2.48374395]
Stock Position:  7.326887399052493
Bond position:  [-730.20499595]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-4.20734342]
curr_Stock_Price:  99.1116946468832
curr_Factors:  [99.11169465 -1.01289329 -0.96238608]
mat_Sqrt:  [[13.74902725  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00543207  0.03348048 -0.07717089]
Stock Position:  0.005432069098196252
Bond Position:  [-4.74572499]


portfolio before change:  [-4.20236327]
curr_Stock_Price:  100.24693920892558
curr_Factors:  [100.24693921  -1.06595575  -0.93257586]
mat_Sqrt:  [[13.58688415  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.21917461 -0.95635417 -2.40771055]
Stock Position:  -0.21917461391977697
Bond Position:  [17.76922093]


portfolio before change:  [-4.20346552]
curr_Stock_Price:  100.27223918036671
curr_Factors:  [100.27223918  -1.27049004  -0.96233889]
mat_Sqrt:  [[10.75165774  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01380236  0.08377381 -0.12517646]
Stock Position:  0.013802360689377293
Bond Position:  [-5.58745913]


portfolio before change:  [-4.20496763]
curr_Stock_Price:  100.26462656527383
curr_Factors:  [100.26462657  -1.34253468  -0.96905252]
mat_Sqrt:  [[ 9.93660837  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.04074124  0.00410187 -1.03278259]
Stock Position:  0.040741236539187355
Bond Position:  [-8.2898725]


portfolio before change:  [-4.25538795]
curr_Stock_Price:  99.07792740271536
curr_Factors:  [99.0779274  -1.53613696 -0.94726214]
mat_Sqrt:  [[ 8.26895045  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02334839 -0.07310325 -0.09656798]
Stock Position:  -0.023348387270715046
Bond Position:  [-1.94207813]


portfolio before change:  [-4.26864752]
curr_Stock_Price:  99.62503096077442
curr_Factors:  [99.62503096 -1.54884992 -0.89663489]
mat_Sqrt:  [[ 8.63590613  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00094736  0.01069246 -0.04207579]
Stock Position:  -0.0009473592264498535
Bond Position:  [-4.17426682]


portfolio before change:  [-4.26907892]
curr_Stock_Price:  98.9787157992729
curr_Factors:  [98.9787158  -1.41664813 -0.88483207]
mat_Sqrt:  [[ 9.90881374  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00010252  0.01237333 -0.06414212]
Stock Position:  -0.00010251578619501851
Bond Position:  [-4.25893204]


portfolio before change:  [-4.270191]
curr_Stock_Price:  99.4392435585177
curr_Factors:  [99.43924356 -1.05431924 -0.87654882]
mat_Sqrt:  [[14.42090353  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00323525 -0.00452357 -0.0999869 ]
Stock Position:  0.003235250552093532
Bond Position:  [-4.59190187]


portfolio before change:  [-4.27653581]
curr_Stock_Price:  97.83297269283236
curr_Factors:  [97.83297269 -0.97034845 -0.86742321]
mat_Sqrt:  [[15.57224255  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0562628  -0.10627347 -0.07116286]
Stock Position:  -0.05626279923849311
Bond Position:  [1.2278211]


portfolio before change:  [-4.24118893]
curr_Stock_Price:  97.21018325040362
curr_Factors:  [97.21018325 -0.80156333 -0.88294544]
mat_Sqrt:  [[18.0359448   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 3.83372300e-04 -1.21652798e-02 -7.78264217e-01]
Stock Position:  0.00038337230019737714
Bond Position:  [-4.27845663]


portfolio before change:  [-4.24267197]
curr_Stock_Price:  96.13214456247027
curr_Factors:  [96.13214456 -0.84811909 -0.85700912]
mat_Sqrt:  [[17.47192901  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00406574 0.00463106 0.06136373]
Stock Position:  0.0040657420649730675
Bond Position:  [-4.63352048]


portfolio before change:  [-4.24127309]
curr_Stock_Price:  96.76115808984416
curr_Factors:  [96.76115809 -0.85787499 -0.82531696]
mat_Sqrt:  [[17.97629055  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0474133  -0.38200508  0.64315758]
Stock Position:  -0.047413303641904034
Bond Position:  [0.34649308]


portfolio before change:  [-4.21975485]
curr_Stock_Price:  96.30914128558602
curr_Factors:  [96.30914129 -0.63377408 -0.79952419]
mat_Sqrt:  [[22.97174459  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.0058959  0.02178307 0.37634523]
Stock Position:  0.005895896920228706
Bond Position:  [-4.78758362]


portfolio before change:  [-4.18679119]
curr_Stock_Price:  102.10311944560824
curr_Factors:  [102.10311945  -0.60524374  -0.83821492]
mat_Sqrt:  [[24.10753909  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00039045  0.00396248 -0.12800091]
Stock Position:  -0.0003904503134885635
Bond Position:  [-4.146925]


portfolio before change:  [-4.18847608]
curr_Stock_Price:  103.76280749045482
curr_Factors:  [103.76280749  -0.64566531  -0.81132408]
mat_Sqrt:  [[24.17014517  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00379538 0.00983778 0.16952211]
Stock Position:  0.0037953825426199532
Bond Position:  [-4.58229563]


portfolio before change:  [-4.19089618]
curr_Stock_Price:  103.42703476337819
curr_Factors:  [103.42703476  -0.79045567  -0.79794969]
mat_Sqrt:  [[21.1250815   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00147627  0.00522683 -0.00111414]
Stock Position:  0.0014762749460589559
Bond Position:  [-4.34358292]


portfolio before change:  [-4.19013882]
curr_Stock_Price:  104.67571330561883
curr_Factors:  [104.67571331  -0.80421111  -0.7878212 ]
mat_Sqrt:  [[21.30272105  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-4.26337905e-04 -4.00074963e-02  6.47465323e-01]
Stock Position:  -0.00042633790463122165
Bond Position:  [-4.1455116]


portfolio before change:  [-4.19183889]
curr_Stock_Price:  106.23213802997665
curr_Factors:  [106.23213803  -1.19951821  -0.79648725]
mat_Sqrt:  [[14.43450076  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00424503 -0.0258544   0.26965534]
Stock Position:  0.0042450253177710295
Bond Position:  [-4.64279701]


portfolio before change:  [-4.19115702]
curr_Stock_Price:  106.666225541836
curr_Factors:  [106.66622554  -1.38005364  -0.81953201]
mat_Sqrt:  [[11.82385287  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01229421 -0.28048936 -0.97053049]
Stock Position:  -0.012294213016180661
Bond Position:  [-2.87977973]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-4.17763761]
Stock Price:  105.50800168786121
PL:  [-9.6856393]
Settle:  Tensor("sub_206:0", shape=(), dtype=float64)
PL:  Tensor("sub_207:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  104
output_Z_Vals[:, i, :]:  [[ 1.19271183e+02 -4.92738716e+01 -4.92570741e+01]
 [ 2.71477946e-02  5.25088811e-02 -4.18482940e-02]
 [-2.48463583e+00 -3.41460111e+00 -9.77071640e-01]
 [-5.32287587e-02  1.85391396e-02 -1.37074027e-01]
 [ 3.38210932e-01 -3.22736877e-02 -6.87508924e-02]
 [-1.46776828e-01 -2.60386596e-01  5.67058353e-02]
 [-1.29822782e-02  3.06796408e-02 -1.43432518e-03]
 [ 8.51315854e-02  1.85999987e-01  5.62580522e-02]
 [ 6.83940381e-02  1.27665290e-01 -8.35922475e-02]
 [-1.07097238e+00 -4.37838596e-01 -3.85690157e-02]
 [ 3.49645632e-01  5.13522674e-02 -3.58182825e-02]
 [ 4.02898991e-02 -6.60565368e-02  3.73193802e-02]
 [-6.10200775e-01 -1.26134124e+00  2.14067675e-01]
 [ 8.80558104e-02  8.43719444e-02  1.59335116e-01]
 [ 1.24394366e-01  1.32522235e-01 -1.04894233e-01]
 [-2.08978229e-01  1.15133250e-01  1.31549940e-01]
 [-1.67493911e-02  1.28485678e-01  1.70356043e-01]
 [ 1.15216134e-01 -1.08333916e-02 -3.18137274e-02]
 [-6.96877532e-02 -3.54638085e-01  1.05016161e-01]
 [ 1.01114689e-01 -7.52194340e-01 -7.36976308e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.27118322 -49.27387164 -49.25707411]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [   7.3268874   -15.90307369 -140.51672192]
init_Out:  [2.48374395]
Stock Position:  7.326887399052493
Bond position:  [-730.20499595]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [1.0908893]
curr_Stock_Price:  99.83481654411756
curr_Factors:  [99.83481654 -0.80134229 -0.96234566]
mat_Sqrt:  [[17.11283973  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00171356  0.01694717 -0.11938153]
Stock Position:  0.0017135600099968608
Bond Position:  [0.91981635]


portfolio before change:  [1.08988275]
curr_Stock_Price:  99.11319868337578
curr_Factors:  [99.11319868 -0.49712141 -0.98499908]
mat_Sqrt:  [[22.51410788  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.15017616 -1.10205777 -2.78731342]
Stock Position:  -0.15017616042626133
Bond Position:  [15.97432237]


portfolio before change:  [1.12052642]
curr_Stock_Price:  98.93574314427151
curr_Factors:  [98.93574314 -0.35572458 -1.03580936]
mat_Sqrt:  [[24.60467942  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00314674  0.00598348 -0.39103405]
Stock Position:  -0.003146742537047057
Bond Position:  [1.43185173]


portfolio before change:  [1.12701189]
curr_Stock_Price:  96.98850423911531
curr_Factors:  [96.98850424 -0.63634276 -1.02403937]
mat_Sqrt:  [[18.43424955  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01722822 -0.01041629 -0.19612716]
Stock Position:  0.017228223730317307
Bond Position:  [-0.54392776]


portfolio before change:  [1.12949366]
curr_Stock_Price:  97.14045091117076
curr_Factors:  [97.14045091 -0.85127517 -1.05980554]
mat_Sqrt:  [[14.36905831  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01310823 -0.08403941  0.16176596]
Stock Position:  -0.013108234741079378
Bond Position:  [2.40283349]


portfolio before change:  [1.10967838]
curr_Stock_Price:  98.6979494838532
curr_Factors:  [98.69794948 -0.83029842 -1.05760735]
mat_Sqrt:  [[14.94173641  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00046933  0.00990181 -0.00409173]
Stock Position:  -0.00046932986261721945
Bond Position:  [1.15600028]


portfolio before change:  [1.10997067]
curr_Stock_Price:  98.69101943110502
curr_Factors:  [98.69101943 -1.02055262 -1.03799613]
mat_Sqrt:  [[12.59683006  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01068382 0.06003124 0.16048856]
Stock Position:  0.01068382282655873
Bond Position:  [0.05557331]


portfolio before change:  [1.1172713]
curr_Stock_Price:  99.37305393039496
curr_Factors:  [99.37305393 -0.57499388 -1.05146456]
mat_Sqrt:  [[19.5391969   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00396078  0.0412038  -0.23846541]
Stock Position:  0.003960777438036358
Bond Position:  [0.72367675]


portfolio before change:  [1.12055489]
curr_Stock_Price:  100.15639600547435
curr_Factors:  [100.15639601  -0.86022836  -1.06317145]
mat_Sqrt:  [[14.63378815  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.07983023 -0.1413118  -0.11002667]
Stock Position:  -0.07983022982844014
Bond Position:  [9.116063]


portfolio before change:  [1.07607394]
curr_Stock_Price:  100.74214218736294
curr_Factors:  [100.74214219  -1.46623781  -1.09760618]
mat_Sqrt:  [[ 7.75796622  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.04547796  0.01657387 -0.10217959]
Stock Position:  0.04547796204814573
Bond Position:  [-3.50547338]


portfolio before change:  [1.05218207]
curr_Stock_Price:  100.23606426181843
curr_Factors:  [100.23606426  -1.05603889  -1.08118704]
mat_Sqrt:  [[11.82601908  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00291087 -0.02131966  0.1064618 ]
Stock Position:  0.0029108655541076078
Bond Position:  [0.76040836]


portfolio before change:  [1.04736922]
curr_Stock_Price:  98.51734173283688
curr_Factors:  [98.51734173 -0.95165706 -1.09099816]
mat_Sqrt:  [[12.7761144   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.06449336 -0.40709614  0.61067549]
Stock Position:  -0.06449336403720296
Bond Position:  [7.40108401]


portfolio before change:  [1.16866013]
curr_Stock_Price:  96.66536191726381
curr_Factors:  [96.66536192 -0.87338707 -1.14374833]
mat_Sqrt:  [[12.85997459  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.0107156  0.02723093 0.45453874]
Stock Position:  0.010715597045810238
Bond Position:  [0.13283307]


portfolio before change:  [1.15925975]
curr_Stock_Price:  95.78500044257403
curr_Factors:  [95.78500044 -0.91475919 -1.13778741]
mat_Sqrt:  [[12.29951098  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01057228  0.04277137 -0.29923405]
Stock Position:  0.010572282791217708
Bond Position:  [0.14659364]


portfolio before change:  [1.16084775]
curr_Stock_Price:  95.93173806819291
curr_Factors:  [95.93173807 -1.12442066 -1.1322388 ]
mat_Sqrt:  [[10.04401988  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0157929   0.0371591   0.37527536]
Stock Position:  -0.015792903197034695
Bond Position:  [2.67588841]


portfolio before change:  [1.17892103]
curr_Stock_Price:  94.8297101199327
curr_Factors:  [94.82971012 -1.11344618 -1.16311123]
mat_Sqrt:  [[ 9.73303093  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00454652 0.04146857 0.48597837]
Stock Position:  0.004546519998743129
Bond Position:  [0.74777586]


portfolio before change:  [1.1812025]
curr_Stock_Price:  95.29039251188412
curr_Factors:  [95.29039251 -1.11251534 -1.18789715]
mat_Sqrt:  [[ 9.54976452  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01115324 -0.00349646 -0.09075571]
Stock Position:  0.011153241259299203
Bond Position:  [0.11840576]


portfolio before change:  [1.17490803]
curr_Stock_Price:  94.72337564056605
curr_Factors:  [94.72337564 -1.13052528 -1.20235033]
mat_Sqrt:  [[ 9.18971759  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01312789 -0.11445895  0.29958188]
Stock Position:  -0.01312789147345956
Bond Position:  [2.41842622]


portfolio before change:  [1.17797217]
curr_Stock_Price:  94.53602939278615
curr_Factors:  [94.53602939 -1.47931922 -1.22996524]
mat_Sqrt:  [[ 6.29462797  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.03222764 -0.24276968 -2.10238827]
Stock Position:  -0.03222763886426096
Bond Position:  [4.22464519]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [1.16934457]
Stock Price:  94.83651340831558
PL:  [1.16934457]
Settle:  Tensor("sub_208:0", shape=(), dtype=float64)
PL:  Tensor("sub_209:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  105
output_Z_Vals[:, i, :]:  [[ 1.19271183e+02 -4.92738716e+01 -4.92570741e+01]
 [ 4.60408896e-02  7.63272045e-02 -4.11526077e-02]
 [-2.23882267e+00 -3.03286544e+00 -8.64949052e-01]
 [-7.57036509e-03  7.38047500e-02 -1.12949778e-01]
 [ 4.15334033e-01  1.73394946e-02 -3.29005877e-01]
 [ 7.57175145e-02  1.17192732e-01 -6.73936232e-03]
 [ 1.66521843e-02  3.18594269e-02  1.05789324e-01]
 [ 1.24506702e-01  3.54956236e-01  2.35994713e-01]
 [ 1.01363476e-01  1.01059598e-01 -7.38090859e-02]
 [-1.02816773e+00 -4.20668781e-01 -3.63813000e-02]
 [ 9.41844698e-02 -2.80307868e-02 -2.18592699e-01]
 [ 2.36991813e-02 -5.65247445e-03  2.37028907e-02]
 [-6.18371505e-01 -1.14210895e+00  2.12521402e-01]
 [ 1.93404502e-01  6.58545077e-02  1.10980828e-01]
 [ 9.93500901e-02  1.28554184e-01 -1.03645232e-01]
 [-9.92988543e-02  7.80866804e-02  1.29683570e-01]
 [ 1.11749955e-01  1.13519302e-01  9.88224015e-02]
 [ 1.09770445e-01 -1.24641300e-02 -1.65488706e-02]
 [-4.55947626e-02 -5.46110184e-02 -2.45527060e-02]
 [ 9.88957593e-02 -7.58885859e-01 -6.71791762e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.27118322 -49.27387164 -49.25707411]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [   7.3268874   -15.90307369 -140.51672192]
init_Out:  [2.48374395]
Stock Position:  7.326887399052493
Bond position:  [-730.20499595]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-1.74815769]
curr_Stock_Price:  99.4473331779944
curr_Factors:  [99.44733318 -1.02921167 -1.05243363]
mat_Sqrt:  [[12.40355204  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00429078  0.0246345  -0.11739694]
Stock Position:  0.00429077685887811
Bond Position:  [-2.17486401]


portfolio before change:  [-1.74851498]
curr_Stock_Price:  99.49079746993031
curr_Factors:  [99.49079747 -0.88987185 -1.07766147]
mat_Sqrt:  [[13.90894034  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.2181662  -0.97885311 -2.46745889]
Stock Position:  -0.21816620471594095
Bond Position:  [19.95701471]


portfolio before change:  [-1.73789982]
curr_Stock_Price:  99.46501306261177
curr_Factors:  [99.46501306 -0.73507431 -1.10241363]
mat_Sqrt:  [[15.83650977  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00098259  0.02382038 -0.32221428]
Stock Position:  -0.0009825908997434189
Bond Position:  [-1.6401664]


portfolio before change:  [-1.73894574]
curr_Stock_Price:  100.1121111375843
curr_Factors:  [100.11211114  -0.75089059  -1.13443783]
mat_Sqrt:  [[15.19493664  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.02314688  0.0055963  -0.93856219]
Stock Position:  0.023146881607292186
Bond Position:  [-4.05622893]


portfolio before change:  [-1.74323552]
curr_Stock_Price:  99.97059773938051
curr_Factors:  [99.97059774 -0.85356583 -1.13616185]
mat_Sqrt:  [[13.66924533  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00718867  0.03782379 -0.01922552]
Stock Position:  0.007188671486941344
Bond Position:  [-2.46189131]


portfolio before change:  [-1.73457183]
curr_Stock_Price:  101.2614124033399
curr_Factors:  [101.2614124   -0.53153269  -1.16312187]
mat_Sqrt:  [[18.59794049  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00240616 0.01028259 0.30178749]
Stock Position:  0.0024061598592257268
Bond Position:  [-1.97822297]


portfolio before change:  [-1.73484955]
curr_Stock_Price:  101.35155280222133
curr_Factors:  [101.3515528   -0.62668284  -1.14035429]
mat_Sqrt:  [[17.31473831  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01415754 0.11456163 0.67322723]
Stock Position:  0.01415753764773702
Bond Position:  [-3.16973798]


portfolio before change:  [-1.75405679]
curr_Stock_Price:  100.050853159322
curr_Factors:  [100.05085316  -0.71946619  -1.13363815]
mat_Sqrt:  [[15.68295176  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00681797  0.03261685 -0.21055678]
Stock Position:  0.006817974387573837
Bond Position:  [-2.43620095]


portfolio before change:  [-1.75981218]
curr_Stock_Price:  99.29604542664318
curr_Factors:  [99.29604543 -0.68670454 -1.10134588]
mat_Sqrt:  [[16.61083713  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.06751392 -0.13577027 -0.10378572]
Stock Position:  -0.0675139176087205
Bond Position:  [4.94405285]


portfolio before change:  [-1.68222959]
curr_Stock_Price:  98.16522057457867
curr_Factors:  [98.16522057 -0.90468926 -1.09037364]
mat_Sqrt:  [[13.35097064  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00328386 -0.0090469  -0.62358413]
Stock Position:  0.0032838557384485207
Bond Position:  [-2.00459002]


portfolio before change:  [-1.68717918]
curr_Stock_Price:  96.81060162228458
curr_Factors:  [96.81060162 -0.58671442 -1.04160248]
mat_Sqrt:  [[19.00001192  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00144125 -0.00182433  0.06761775]
Stock Position:  0.0014412468391609599
Bond Position:  [-1.82670715]


portfolio before change:  [-1.68807068]
curr_Stock_Price:  96.50893832099862
curr_Factors:  [96.50893832 -0.44641387 -1.03507624]
mat_Sqrt:  [[21.93635965  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.03683942 -0.36861408  0.60626441]
Stock Position:  -0.036839420027100965
Bond Position:  [1.86726263]


portfolio before change:  [-1.59753231]
curr_Stock_Price:  94.06396239890941
curr_Factors:  [94.0639624  -0.68667081 -1.013775  ]
mat_Sqrt:  [[17.17627722  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.0133615  0.02125445 0.31659741]
Stock Position:  0.013361502046846113
Bond Position:  [-2.85436814]


portfolio before change:  [-1.57482631]
curr_Stock_Price:  95.81673591941131
curr_Factors:  [95.81673592 -0.56384167 -1.03890701]
mat_Sqrt:  [[19.29196507  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00541337  0.04149068 -0.295671  ]
Stock Position:  0.005413373294190719
Bond Position:  [-2.09351807]


portfolio before change:  [-1.56480163]
curr_Stock_Price:  97.76526537472179
curr_Factors:  [97.76526537 -0.80918366 -1.06871206]
mat_Sqrt:  [[14.94943679  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00380536  0.02520237  0.36995113]
Stock Position:  -0.0038053560396345823
Bond Position:  [-1.19276999]


portfolio before change:  [-1.56966023]
curr_Stock_Price:  98.96367260395279
curr_Factors:  [98.9636726  -1.29194074 -1.05542111]
mat_Sqrt:  [[ 9.46301446  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01638949 0.0366382  0.2819128 ]
Stock Position:  0.016389494486651366
Bond Position:  [-3.1916248]


portfolio before change:  [-1.55810536]
curr_Stock_Price:  99.71737943524793
curr_Factors:  [99.71737944 -1.46572724 -1.04232841]
mat_Sqrt:  [[ 8.1196279   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01278977 -0.00402278 -0.04720932]
Stock Position:  0.012789772140807804
Bond Position:  [-2.83346792]


portfolio before change:  [-1.55361125]
curr_Stock_Price:  100.12415472973234
curr_Factors:  [100.12415473  -1.57683473  -1.04474198]
mat_Sqrt:  [[ 7.27784104  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00848521 -0.01762563 -0.07004204]
Stock Position:  -0.008485207335391645
Bond Position:  [-0.70403704]


portfolio before change:  [-1.54773119]
curr_Stock_Price:  99.41043081976245
curr_Factors:  [99.41043082 -1.47030837 -0.96877238]
mat_Sqrt:  [[ 8.67266647  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02226998 -0.24492936 -1.91643491]
Stock Position:  -0.02226997752142363
Bond Position:  [0.66613687]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-1.51450982]
Stock Price:  97.92615395982486
PL:  [-1.51450982]
Settle:  Tensor("sub_210:0", shape=(), dtype=float64)
PL:  Tensor("sub_211:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  106
output_Z_Vals[:, i, :]:  [[ 1.19271183e+02 -4.92738716e+01 -4.92570741e+01]
 [ 5.89965328e-02  1.03677463e-01 -2.70684298e-02]
 [-1.92626217e+00 -2.59709594e+00 -7.38110609e-01]
 [ 4.27510898e-03  2.09504145e-01  1.72114694e-03]
 [ 3.33554327e-01  1.62817650e-01 -4.18844346e-01]
 [ 4.19135173e-02  7.93736100e-02 -3.28610378e-03]
 [ 1.16768899e-02  2.43342277e-02  8.23895033e-02]
 [ 8.31162202e-02  2.44913122e-01  1.44489744e-01]
 [ 2.46713240e-02 -9.64079079e-02 -7.29850485e-03]
 [-1.06418044e+00 -4.39293480e-01 -3.81330455e-02]
 [ 3.06150041e-01  8.66919278e-02  4.18174267e-02]
 [-2.41508615e-01  1.84089679e-02  2.59602549e-02]
 [-7.40562810e-01 -8.93905660e-01  2.58899365e-01]
 [ 1.87095314e-01  1.69295036e-01 -7.52301649e-02]
 [-4.52541003e-02 -1.54986120e-02 -3.22031856e-02]
 [-2.69034595e-02  5.74745640e-02  1.06906298e-01]
 [ 5.69967750e-02  1.02341378e-01  9.50615472e-02]
 [ 1.08309420e-01 -1.28812926e-02 -1.15910625e-02]
 [-8.88916941e-02 -4.57413816e-01  1.38845238e-01]
 [-1.94507155e-03 -1.19598266e-01 -4.17721597e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.27118322 -49.27387164 -49.25707411]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [   7.3268874   -15.90307369 -140.51672192]
init_Out:  [2.48374395]
Stock Position:  7.326887399052493
Bond position:  [-730.20499595]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-3.20998234]
curr_Stock_Price:  99.24781808110056
curr_Factors:  [99.24781808 -1.15063476 -0.98893065]
mat_Sqrt:  [[11.6820623   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00638879  0.03346176 -0.0772187 ]
Stock Position:  0.006388793714601192
Bond Position:  [-3.84405618]


portfolio before change:  [-3.20360484]
curr_Stock_Price:  100.39649173740423
curr_Factors:  [100.39649174  -1.45633231  -1.00760026]
mat_Sqrt:  [[ 8.54370451  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.30514379 -0.83820911 -2.10562412]
Stock Position:  -0.30514378722874785
Bond Position:  [27.43176088]


portfolio before change:  [-3.44514964]
curr_Stock_Price:  101.21054600974763
curr_Factors:  [101.21054601  -1.25208697  -0.99186672]
mat_Sqrt:  [[10.73220751  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.0044158  0.06761717 0.00490995]
Stock Position:  0.004415800860208796
Bond Position:  [-3.89207526]


portfolio before change:  [-3.44737842]
curr_Stock_Price:  100.92619528408979
curr_Factors:  [100.92619528  -1.65068588  -0.99623605]
mat_Sqrt:  [[ 7.15254031  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.03932772  0.05254917 -1.19484634]
Stock Position:  0.03932771908440968
Bond Position:  [-7.41657548]


portfolio before change:  [-3.42290122]
curr_Stock_Price:  101.59573767327932
curr_Factors:  [101.59573767  -1.3640779   -0.99060757]
mat_Sqrt:  [[ 9.64380862  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00595665  0.02561772 -0.00937434]
Stock Position:  0.005956652264267228
Bond Position:  [-4.0280717]


portfolio before change:  [-3.42865517]
curr_Stock_Price:  100.79884684825934
curr_Factors:  [100.79884685  -1.22167913  -0.97331693]
mat_Sqrt:  [[11.22485887  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00298104 0.00785384 0.23503432]
Stock Position:  0.0029810423998776867
Bond Position:  [-3.7291408]


portfolio before change:  [-3.42747324]
curr_Stock_Price:  101.50810525161977
curr_Factors:  [101.50810525  -0.81800485  -0.97220386]
mat_Sqrt:  [[16.94427354  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00959632 0.07904537 0.41218902]
Stock Position:  0.009596324493658293
Bond Position:  [-4.40157795]


portfolio before change:  [-3.42168634]
curr_Stock_Price:  102.22582016253955
curr_Factors:  [102.22582016  -0.42675855  -0.93513579]
mat_Sqrt:  [[26.18770314  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00013374 -0.03111552 -0.0208206 ]
Stock Position:  0.00013373991291421925
Bond Position:  [-3.43535802]


portfolio before change:  [-3.42283734]
curr_Stock_Price:  100.04213575825445
curr_Factors:  [100.04213576  -0.37587245  -0.91887782]
mat_Sqrt:  [[27.40817118  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.04238279 -0.14178136 -0.10878296]
Stock Position:  -0.042382788519477264
Bond Position:  [0.81722735]


portfolio before change:  [-3.4960139]
curr_Stock_Price:  101.77352009762006
curr_Factors:  [101.7735201   -0.384588    -0.88841655]
mat_Sqrt:  [[28.49547787  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01166437 0.0279797  0.11929348]
Stock Position:  0.011664373731956163
Bond Position:  [-4.68313828]


portfolio before change:  [-3.48439663]
curr_Stock_Price:  102.86986748237226
curr_Factors:  [102.86986748  -0.46168708  -0.9026148 ]
mat_Sqrt:  [[26.28932295  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00884206  0.00594147  0.07405738]
Stock Position:  -0.008842060556156755
Bond Position:  [-2.57481503]


portfolio before change:  [-3.48664622]
curr_Stock_Price:  103.05147799972849
curr_Factors:  [103.051478    -0.21506226  -0.88208002]
mat_Sqrt:  [[34.40102515  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02529526 -0.28850681  0.73856782]
Stock Position:  -0.025295261493993793
Bond Position:  [-0.87993214]


portfolio before change:  [-3.3915772]
curr_Stock_Price:  99.28440740429564
curr_Factors:  [99.2844074   0.15434021 -0.88323388]
mat_Sqrt:  [[47.89901146  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0043069   0.05463974 -0.21461072]
Stock Position:  0.004306899429601644
Bond Position:  [-3.81918515]


portfolio before change:  [-3.39552367]
curr_Stock_Price:  98.58980973095571
curr_Factors:  [98.58980973  0.12175069 -0.87924609]
mat_Sqrt:  [[46.22276916  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0011897  -0.00500216 -0.09186672]
Stock Position:  -0.0011896991453392103
Bond Position:  [-3.27823146]


portfolio before change:  [-3.3977251]
curr_Stock_Price:  99.7512476209169
curr_Factors:  [99.75124762  0.12142302 -0.9032945 ]
mat_Sqrt:  [[45.64107533  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [1.45716188e-04 1.85498358e-02 3.04973912e-01]
Stock Position:  0.0001457161876183128
Bond Position:  [-3.41226047]


portfolio before change:  [-3.39900259]
curr_Stock_Price:  96.83924888314965
curr_Factors:  [96.83924888  0.16557285 -0.89125875]
mat_Sqrt:  [[46.86946879  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.0020758  0.03303054 0.27118413]
Stock Position:  0.0020757964816941533
Bond Position:  [-3.60002117]


portfolio before change:  [-3.40921352]
curr_Stock_Price:  92.35383245132878
curr_Factors:  [92.35383245  0.42776513 -0.8888983 ]
mat_Sqrt:  [[58.23543563  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00177407 -0.00415742 -0.03306608]
Stock Position:  0.0017740748446940147
Bond Position:  [-3.57305613]


portfolio before change:  [-3.41278324]
curr_Stock_Price:  90.84524864747208
curr_Factors:  [90.84524865  0.6878015  -0.91315655]
mat_Sqrt:  [[ 7.25156534e+01  0.00000000e+00  0.00000000e+00]
 [-6.32455532e-01  3.09838668e+00  0.00000000e+00]
 [-7.15541753e-02  0.00000000e+00  3.50542437e-01]]
grads:  [-0.00212257 -0.14762967  0.39608682]
Stock Position:  -0.0021225656204641257
Bond Position:  [-3.21995824]


portfolio before change:  [-3.42039711]
curr_Stock_Price:  94.0530534951854
curr_Factors:  [94.0530535   0.39361661 -0.9183199 ]
mat_Sqrt:  [[55.65409943  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00062681 -0.03860017 -0.11916434]
Stock Position:  -0.000626812257852732
Bond Position:  [-3.3614435]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-3.42433476]
Stock Price:  98.99422749867774
PL:  [-3.42433476]
Settle:  Tensor("sub_212:0", shape=(), dtype=float64)
PL:  Tensor("sub_213:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  107
output_Z_Vals[:, i, :]:  [[ 1.19271183e+02 -4.92738716e+01 -4.92570741e+01]
 [ 1.16781771e-01  1.79830601e-01 -5.05814109e-02]
 [-2.43292454e+00 -3.19049762e+00 -9.23842458e-01]
 [-3.31367500e-02  3.35004721e-02 -1.22378152e-01]
 [ 7.78385382e-01 -1.81032314e-01 -2.96841892e-01]
 [-7.32984805e-02 -1.07970568e-01  2.37479728e-02]
 [ 1.20166780e-02  3.66494537e-02  1.03881607e-01]
 [ 1.17441638e-01  4.41544006e-01  3.99297713e-01]
 [-3.15742522e-02 -2.41229424e-01  4.14799668e-02]
 [-1.51779014e+00 -5.98813078e-01 -6.04427065e-02]
 [ 1.87497394e-01 -1.60011141e-02  4.13093270e-02]
 [-1.82667643e-01  8.52753108e-02  2.32074834e-02]
 [-7.02198582e-01 -8.94331194e-01  2.44335765e-01]
 [-7.42516432e-03 -2.44819187e-03  9.46266762e-03]
 [ 9.14651184e-02  1.29930100e-01 -1.04183335e-01]
 [-7.32831489e-02  6.99582239e-02  1.28865221e-01]
 [ 1.10925835e-01  1.13320869e-01  9.61188780e-02]
 [ 1.15216134e-01 -1.08333916e-02 -3.18137274e-02]
 [-4.90933820e-02 -1.08301888e-01  9.88921756e-04]
 [ 6.33874649e-02 -5.58015369e-01 -4.37165109e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.27118322 -49.27387164 -49.25707411]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [   7.3268874   -15.90307369 -140.51672192]
init_Out:  [2.48374395]
Stock Position:  7.326887399052493
Bond position:  [-730.20499595]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-9.70980386]
curr_Stock_Price:  98.3606990132399
curr_Factors:  [98.36069901 -0.86775573 -1.02120782]
mat_Sqrt:  [[14.87493793  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00962455  0.05804008 -0.14429469]
Stock Position:  0.009624554528070072
Bond Position:  [-10.65648177]


portfolio before change:  [-9.70617037]
curr_Stock_Price:  99.01506172584743
curr_Factors:  [99.01506173 -0.72939265 -0.98529879]
mat_Sqrt:  [[17.82461803  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.18360902 -1.02972868 -2.63546538]
Stock Position:  -0.18360902236042448
Bond Position:  [8.47388832]


portfolio before change:  [-9.68817154]
curr_Stock_Price:  98.92857312411219
curr_Factors:  [98.92857312 -0.56121316 -0.97506162]
mat_Sqrt:  [[21.28756974  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00240886  0.01081223 -0.3491108 ]
Stock Position:  -0.0024088625922167825
Bond Position:  [-9.4498662]


portfolio before change:  [-9.68959973]
curr_Stock_Price:  98.54059888098502
curr_Factors:  [98.54059888 -0.43260652 -0.97296893]
mat_Sqrt:  [[24.16470709  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.02817496 -0.05842793 -0.84680729]
Stock Position:  0.028174962574734723
Bond Position:  [-12.46597741]


portfolio before change:  [-9.71019738]
curr_Stock_Price:  97.92016270004699
curr_Factors:  [97.9201627  -0.25676073 -0.93139469]
mat_Sqrt:  [[29.84439522  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00303207 -0.03484735  0.06774636]
Stock Position:  -0.0030320716829101485
Bond Position:  [-9.41329642]


portfolio before change:  [-9.72173662]
curr_Stock_Price:  100.94965218404373
curr_Factors:  [100.94965218  -0.12419121  -0.94416576]
mat_Sqrt:  [[34.68352998  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00117354 0.01182856 0.29634531]
Stock Position:  0.0011735385854356848
Bond Position:  [-9.84020494]


portfolio before change:  [-9.72163554]
curr_Stock_Price:  103.13231968146412
curr_Factors:  [ 1.03132320e+02  8.43977609e-03 -9.75677126e-01]
mat_Sqrt:  [[39.20387018  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.0073737  0.14250772 1.13908523]
Stock Position:  0.007373704029184809
Bond Position:  [-10.48210274]


portfolio before change:  [-9.71759776]
curr_Stock_Price:  104.0353430382072
curr_Factors:  [104.03534304  -0.56917169  -0.96476867]
mat_Sqrt:  [[22.4387712   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00322424 -0.07785646  0.1183308 ]
Stock Position:  -0.003224238025202733
Bond Position:  [-9.38216306]


portfolio before change:  [-9.72363797]
curr_Stock_Price:  105.18115419050235
curr_Factors:  [105.18115419  -0.91121472  -1.0065884 ]
mat_Sqrt:  [[15.45420327  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.10691979 -0.19326609 -0.17242622]
Stock Position:  -0.10691978995665337
Bond Position:  [1.52230895]


portfolio before change:  [-9.73474993]
curr_Stock_Price:  105.28864216938445
curr_Factors:  [105.28864217  -0.55680414  -0.98162489]
mat_Sqrt:  [[22.60738269  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00852215 -0.00516434  0.11784401]
Stock Position:  0.00852214580073714
Bond Position:  [-10.63203509]


portfolio before change:  [-9.73114951]
curr_Stock_Price:  106.02305362625724
curr_Factors:  [106.02305363  -0.23011491  -0.98774596]
mat_Sqrt:  [[31.36823282  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0051174   0.02752249  0.06620449]
Stock Position:  -0.005117396504532689
Bond Position:  [-9.18858751]


portfolio before change:  [-9.71363827]
curr_Stock_Price:  102.15220298705005
curr_Factors:  [102.15220299  -0.22097881  -0.98668308]
mat_Sqrt:  [[30.53281462  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02734364 -0.28864415  0.69702193]
Stock Position:  -0.027343641720686488
Bond Position:  [-6.92042503]


portfolio before change:  [-9.72490495]
curr_Stock_Price:  102.50096247303648
curr_Factors:  [102.50096247  -0.61017941  -0.99926167]
mat_Sqrt:  [[20.50012741  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00029236 -0.00079015  0.02699436]
Stock Position:  -0.00029235625390169407
Bond Position:  [-9.69493815]


portfolio before change:  [-9.72667528]
curr_Stock_Price:  100.26497483116246
curr_Factors:  [100.26497483  -0.53794716  -1.03892681]
mat_Sqrt:  [[20.71674802  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00466872  0.04193476 -0.29720606]
Stock Position:  0.004668718020076038
Bond Position:  [-10.19478417]


portfolio before change:  [-9.7387762]
curr_Stock_Price:  98.21903738479962
curr_Factors:  [ 9.82190374e+01 -1.94512851e-02 -1.01084086e+00]
mat_Sqrt:  [[35.0546375   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00093279  0.02257892  0.36761661]
Stock Position:  -0.0009327862279341505
Bond Position:  [-9.64715883]


portfolio before change:  [-9.74202785]
curr_Stock_Price:  99.11909285218053
curr_Factors:  [99.11909285 -0.64290393 -0.97794026]
mat_Sqrt:  [[19.59898711  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.0078411  0.03657415 0.2742004 ]
Stock Position:  0.007841096253158627
Bond Position:  [-10.5192302]


portfolio before change:  [-9.74946385]
curr_Stock_Price:  98.50618603818543
curr_Factors:  [98.50618604 -0.48530333 -1.05708301]
mat_Sqrt:  [[21.06753037  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00505569 -0.00349646 -0.09075571]
Stock Position:  0.0050556864410606465
Bond Position:  [-10.24748024]


portfolio before change:  [-9.74898232]
curr_Stock_Price:  99.10822530910544
curr_Factors:  [99.10822531 -0.83819867 -1.03788195]
mat_Sqrt:  [[15.18232337  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0046764  -0.03495428  0.00282112]
Stock Position:  -0.004676395551696761
Bond Position:  [-9.28551305]


portfolio before change:  [-9.76555604]
curr_Stock_Price:  102.15588434609995
curr_Factors:  [102.15588435  -0.80518372  -1.02413779]
mat_Sqrt:  [[16.39831213  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0085224  -0.18009869 -1.24711037]
Stock Position:  -0.00852239538277786
Bond Position:  [-8.89494321]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-9.75886607]
Stock Price:  101.10993547216557
PL:  [-10.86880154]
Settle:  Tensor("sub_214:0", shape=(), dtype=float64)
PL:  Tensor("sub_215:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  108
output_Z_Vals[:, i, :]:  [[ 1.19271183e+02 -4.92738716e+01 -4.92570741e+01]
 [ 2.67804531e-02  5.19187057e-02 -4.20187641e-02]
 [-2.56372128e+00 -3.20928279e+00 -9.43454311e-01]
 [-3.31747345e-03  6.95733272e-02 -1.02304049e-01]
 [ 3.28658147e-01  1.20070404e-02 -4.90531281e-02]
 [-1.29889588e-01 -1.67361306e-01 -3.11652732e-02]
 [-8.91816368e-02  1.47979579e-01 -1.92154369e-01]
 [ 8.15360555e-02  1.49742771e-01  2.05859996e-02]
 [-2.40345472e-02  7.21794988e-02 -1.51702451e-02]
 [-7.50822014e-01 -3.05252400e-01 -2.22949385e-02]
 [ 1.93872372e-02 -5.53003223e-02 -3.22835388e-01]
 [-1.27917687e-02 -2.18969415e-02  2.53964704e-02]
 [-6.61794823e-01 -1.21210219e+00  2.27933364e-01]
 [ 3.83296117e-02  5.14545620e-02  1.20495934e-01]
 [ 1.03514616e-01  1.22287128e-01 -1.04464359e-01]
 [ 1.02889903e-02  4.74637619e-02  8.92971648e-02]
 [ 1.25539909e-01  1.15578973e-01  1.03380930e-01]
 [ 9.78568597e-02 -1.60317112e-02  1.68461956e-02]
 [-4.09157566e-02 -1.30657477e-02 -3.90143045e-02]
 [ 8.32010489e-02 -6.65252422e-01 -5.80815406e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.27118322 -49.27387164 -49.25707411]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [   7.3268874   -15.90307369 -140.51672192]
init_Out:  [2.48374395]
Stock Position:  7.326887399052493
Bond position:  [-730.20499595]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [0.13298151]
curr_Stock_Price:  99.70407783645615
curr_Factors:  [99.70407784 -0.70056938 -0.95941501]
mat_Sqrt:  [[18.95792752  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00151922  0.01675669 -0.11986784]
Stock Position:  0.0015192203997507485
Bond Position:  [-0.01849096]


portfolio before change:  [0.13150518]
curr_Stock_Price:  98.73535040535398
curr_Factors:  [98.73535041 -0.6800219  -0.94609602]
mat_Sqrt:  [[19.42042062  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.17566021 -1.03579157 -2.69141254]
Stock Position:  -0.1756602113579367
Bond Position:  [17.4753777]


portfolio before change:  [0.10072096]
curr_Stock_Price:  98.93547319307221
curr_Factors:  [98.93547319 -0.82824822 -0.9512264 ]
mat_Sqrt:  [[16.69306265  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00059897  0.02245469 -0.29184498]
Stock Position:  -0.00059896761989694
Bond Position:  [0.1599801]


portfolio before change:  [0.10242905]
curr_Stock_Price:  96.15052446344413
curr_Factors:  [96.15052446 -0.7935482  -0.95681105]
mat_Sqrt:  [[16.70245424  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01922449  0.00387526 -0.13993492]
Stock Position:  0.019224488877108148
Bond Position:  [-1.74601564]


portfolio before change:  [0.08461177]
curr_Stock_Price:  95.24643175841607
curr_Factors:  [95.24643176 -0.71829943 -0.96507497]
mat_Sqrt:  [[17.69165662  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00963243 -0.05401563 -0.08890585]
Stock Position:  -0.009632430674250902
Bond Position:  [1.00206642]


portfolio before change:  [0.08570939]
curr_Stock_Price:  95.15849258369238
curr_Factors:  [95.15849258 -0.83321476 -0.95552554]
mat_Sqrt:  [[15.90770447  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00617303  0.0477602  -0.54816293]
Stock Position:  -0.006173032582531412
Bond Position:  [0.67312586]


portfolio before change:  [0.078872]
curr_Stock_Price:  96.29337912604278
curr_Factors:  [96.29337913 -0.80378057 -0.90702406]
mat_Sqrt:  [[17.40217041  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00668332 0.04832927 0.05872613]
Stock Position:  0.006683319809036335
Bond Position:  [-0.56468745]


portfolio before change:  [0.07924254]
curr_Stock_Price:  96.36994756616572
curr_Factors:  [96.36994757 -1.08865869 -0.89586985]
mat_Sqrt:  [[13.24560587  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00093598  0.02329583 -0.04327649]
Stock Position:  -0.0009359769645540085
Bond Position:  [0.16944259]


portfolio before change:  [0.07875086]
curr_Stock_Price:  96.94052002270406
curr_Factors:  [96.94052002 -0.9735452  -0.926715  ]
mat_Sqrt:  [[14.49548745  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.05640944 -0.09851979 -0.06360125]
Stock Position:  -0.05640944032169871
Bond Position:  [5.54711134]


portfolio before change:  [0.12055533]
curr_Stock_Price:  96.2240172765564
curr_Factors:  [96.22401728 -1.11580016 -0.94876274]
mat_Sqrt:  [[12.20830045  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00473443 -0.0178481  -0.9209595 ]
Stock Position:  -0.004734433898622666
Bond Position:  [0.57612158]


portfolio before change:  [0.11673943]
curr_Stock_Price:  97.06043176018686
curr_Factors:  [97.06043176 -1.06585117 -0.97446203]
mat_Sqrt:  [[12.61669067  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00095726 -0.00706721  0.07244906]
Stock Position:  -0.0009572581852274271
Bond Position:  [0.20965133]


portfolio before change:  [0.11636177]
curr_Stock_Price:  97.50971296549716
curr_Factors:  [97.50971297 -1.11402732 -0.95776058]
mat_Sqrt:  [[12.28236006  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.07023792 -0.3912043   0.65023044]
Stock Position:  -0.07023792168623508
Bond Position:  [6.96524136]


portfolio before change:  [0.05918006]
curr_Stock_Price:  98.34862217241218
curr_Factors:  [98.34862217 -1.34977704 -1.0023409 ]
mat_Sqrt:  [[ 9.35958174  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00784531 0.01660689 0.34374136]
Stock Position:  0.007845314218271213
Bond Position:  [-0.71239578]


portfolio before change:  [0.06413545]
curr_Stock_Price:  99.00296311051252
curr_Factors:  [99.00296311 -0.92033963 -1.03391672]
mat_Sqrt:  [[14.02572906  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00763972  0.039468   -0.29800774]
Stock Position:  0.007639722200006135
Bond Position:  [-0.69221968]


portfolio before change:  [0.07122513]
curr_Stock_Price:  99.95361965999795
curr_Factors:  [99.95361966 -1.1009388  -1.03327578]
mat_Sqrt:  [[11.8282613   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00322999 0.01531886 0.25473996]
Stock Position:  0.003229992692010276
Bond Position:  [-0.25162433]


portfolio before change:  [0.07075525]
curr_Stock_Price:  99.82762514388558
curr_Factors:  [99.82762514 -1.23421032 -1.03615147]
mat_Sqrt:  [[10.30967903  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01651214 0.03730295 0.29491702]
Stock Position:  0.016512144759354083
Bond Position:  [-1.57761295]


portfolio before change:  [0.07672688]
curr_Stock_Price:  100.21316455904535
curr_Factors:  [100.21316456  -1.03309788  -1.0452748 ]
mat_Sqrt:  [[12.54004188  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00781681 -0.00517421  0.04805751]
Stock Position:  0.00781680927426372
Bond Position:  [-0.70662031]


portfolio before change:  [0.08247246]
curr_Stock_Price:  100.97079565280005
curr_Factors:  [100.97079565  -1.14969281  -1.01906044]
mat_Sqrt:  [[11.54298708  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00446562 -0.00421695 -0.11129695]
Stock Position:  -0.004465616430259387
Bond Position:  [0.53336931]


portfolio before change:  [0.08651496]
curr_Stock_Price:  100.09541053101245
curr_Factors:  [100.09541053  -1.16827534  -0.98918046]
mat_Sqrt:  [[11.5729217   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01478896 -0.2147093  -1.65690469]
Stock Position:  -0.014788960466047133
Bond Position:  [1.56682203]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [0.09210352]
Stock Price:  99.74401297302802
PL:  [0.09210352]
Settle:  Tensor("sub_216:0", shape=(), dtype=float64)
PL:  Tensor("sub_217:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  109
output_Z_Vals[:, i, :]:  [[ 1.19271183e+02 -4.92738716e+01 -4.92570741e+01]
 [-2.06501392e-03  3.02343827e-03 -5.75738847e-02]
 [-2.08816117e+00 -2.81299243e+00 -8.00565467e-01]
 [-2.07978480e-01 -4.31275207e-02  1.35455774e-01]
 [ 4.22146734e-01  2.73045676e-01 -5.41676825e-01]
 [-1.03476420e-01  4.72464315e-02 -1.17088752e-02]
 [ 3.20950979e-02 -1.37555769e-02  1.41851201e-02]
 [-3.76027034e-02 -3.82861083e-02 -3.14554966e-02]
 [-3.08612005e-02 -2.39393453e-01  4.08615791e-02]
 [-1.24847527e+00 -4.80841555e-01 -4.82404538e-02]
 [ 4.80219411e-01  1.17617129e-01  7.55467950e-02]
 [-1.79382599e-01 -5.88261132e-03  2.86632037e-02]
 [-8.01753521e-01 -1.09921707e+00  2.86516384e-01]
 [-2.02226168e-02 -2.46213531e-02 -1.84544613e-02]
 [ 1.79221123e-02  8.47176047e-02 -8.64056908e-02]
 [ 1.20001326e-01  1.34030736e-02  2.96803354e-02]
 [-6.41388992e-02 -7.39992562e-02 -9.01358580e-02]
 [ 6.98591605e-03 -9.25518638e-02  1.65650587e-01]
 [ 3.87779514e-02 -2.82402684e-02  4.86142476e-02]
 [ 8.40408367e-02 -7.39382617e-01 -3.39039032e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.27118322 -49.27387164 -49.25707411]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [   7.3268874   -15.90307369 -140.51672192]
init_Out:  [2.48374395]
Stock Position:  7.326887399052493
Bond position:  [-730.20499595]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [11.85874982]
curr_Stock_Price:  101.30445295759523
curr_Factors:  [101.30445296  -1.33549015  -1.00728367]
mat_Sqrt:  [[ 9.73138811  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00135644  0.00097581 -0.16424227]
Stock Position:  -0.0013564434001700264
Bond Position:  [11.99616358]


portfolio before change:  [11.86180447]
curr_Stock_Price:  101.26373143083032
curr_Factors:  [101.26373143  -1.14049806  -0.99685949]
mat_Sqrt:  [[11.94569275  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.23655184 -0.9078894  -2.28379044]
Stock Position:  -0.2365518391154087
Bond Position:  [35.81592638]


portfolio before change:  [11.67492593]
curr_Stock_Price:  102.09159919138645
curr_Factors:  [102.09159919  -1.5045078   -0.99131983]
mat_Sqrt:  [[ 8.41522708  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02247498 -0.01391935  0.38641762]
Stock Position:  -0.022474979272175497
Bond Position:  [13.96943251]


portfolio before change:  [11.67242931]
curr_Stock_Price:  102.35809201270656
curr_Factors:  [102.35809201  -1.90932025  -1.01692736]
mat_Sqrt:  [[ 5.4861666   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.06695251  0.08812511 -1.54525321]
Stock Position:  0.0669525111279215
Bond Position:  [4.81929801]


portfolio before change:  [11.64640062]
curr_Stock_Price:  101.95133113784013
curr_Factors:  [101.95133114  -1.88185521  -1.01114291]
mat_Sqrt:  [[ 5.64910678  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0170332   0.01524872 -0.03340216]
Stock Position:  -0.017033196689291378
Bond Position:  [13.38295769]


portfolio before change:  [11.64373222]
curr_Stock_Price:  102.30443890102836
curr_Factors:  [102.3044389   -1.85294112  -0.97899305]
mat_Sqrt:  [[ 6.02561107  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.005341   -0.00443959  0.0404662 ]
Stock Position:  0.005340998230180771
Bond Position:  [11.0973244]


portfolio before change:  [11.64693022]
curr_Stock_Price:  102.38369656116298
curr_Factors:  [102.38369656  -1.9363254   -0.98918405]
mat_Sqrt:  [[ 5.49159113  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00943964 -0.01235679 -0.08973378]
Stock Position:  -0.009439641011301032
Bond Position:  [12.61339556]


portfolio before change:  [11.6481307]
curr_Stock_Price:  102.5906177457807
curr_Factors:  [102.59061775  -1.70578678  -1.04462714]
mat_Sqrt:  [[ 6.5556847   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01088923 -0.0772639   0.11656671]
Stock Position:  -0.010889228644578378
Bond Position:  [12.76526339]


portfolio before change:  [11.65227995]
curr_Stock_Price:  102.5026832704659
curr_Factors:  [102.50268327  -1.50069639  -1.06105301]
mat_Sqrt:  [[ 7.91009325  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.17148643 -0.15519094 -0.13761659]
Stock Position:  -0.17148643437766967
Bond Position:  [29.23009962]


portfolio before change:  [11.55551851]
curr_Stock_Price:  103.10955274286489
curr_Factors:  [103.10955274  -1.48564452  -1.10219184]
mat_Sqrt:  [[ 7.75203729  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.06703384 0.03796077 0.21551398]
Stock Position:  0.06703384061183112
Bond Position:  [4.64368918]


portfolio before change:  [11.57435071]
curr_Stock_Price:  103.37316786122626
curr_Factors:  [103.37316786  -0.9800102   -1.11931568]
mat_Sqrt:  [[12.66724533  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01379404 -0.0018986   0.08176814]
Stock Position:  -0.01379404329100643
Bond Position:  [13.00028466]


portfolio before change:  [11.56798759]
curr_Stock_Price:  104.07010611854791
curr_Factors:  [104.07010612  -1.19258578  -1.07820468]
mat_Sqrt:  [[10.7432141   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.09007038 -0.35477079  0.81735149]
Stock Position:  -0.09007037798738905
Bond Position:  [20.94162138]


portfolio before change:  [11.61944447]
curr_Stock_Price:  103.55694274884955
curr_Factors:  [103.55694275  -1.22917069  -1.04560874]
mat_Sqrt:  [[10.64768188  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00272505 -0.00794651 -0.05264544]
Stock Position:  -0.0027250467212637203
Bond Position:  [11.90164197]


portfolio before change:  [11.62111849]
curr_Stock_Price:  104.03464415524671
curr_Factors:  [104.03464416  -1.0839442   -1.04261722]
mat_Sqrt:  [[12.40578064  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00141688  0.02734249 -0.24649139]
Stock Position:  0.0014168824746879877
Bond Position:  [11.47371363]


portfolio before change:  [11.62588063]
curr_Stock_Price:  105.37092324352012
curr_Factors:  [105.37092324  -1.22842125  -1.04293254]
mat_Sqrt:  [[10.87137225  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01184723 0.00432582 0.08466974]
Stock Position:  0.011847233899199495
Bond Position:  [10.37752665]


portfolio before change:  [11.62839048]
curr_Stock_Price:  105.363760489646
curr_Factors:  [105.36376049  -1.22844907  -1.073319  ]
mat_Sqrt:  [[10.54498798  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00925964 -0.02388316 -0.25713251]
Stock Position:  -0.009259644420271116
Bond Position:  [12.60402143]


portfolio before change:  [11.64588638]
curr_Stock_Price:  103.81461782457411
curr_Factors:  [103.81461782  -1.41786588  -1.01887533]
mat_Sqrt:  [[ 9.07810597  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00241318 -0.02987099  0.47255502]
Stock Position:  0.0024131829463507368
Bond Position:  [11.39536272]


portfolio before change:  [11.65189041]
curr_Stock_Price:  105.12194755304012
curr_Factors:  [105.12194755  -0.96163645  -0.95486336]
mat_Sqrt:  [[15.46564748  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00277627 -0.00911451  0.13868292]
Stock Position:  0.0027762673698449683
Bond Position:  [11.36004377]


portfolio before change:  [11.65613133]
curr_Stock_Price:  105.62642075506098
curr_Factors:  [105.62642076  -1.07243334  -0.95173676]
mat_Sqrt:  [[13.95361242  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00975311 -0.23863471 -0.96718399]
Stock Position:  -0.009753105969012946
Bond Position:  [12.686317]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [11.65353514]
Stock Price:  106.21783861499314
PL:  [5.43569653]
Settle:  Tensor("sub_218:0", shape=(), dtype=float64)
PL:  Tensor("sub_219:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  110
output_Z_Vals[:, i, :]:  [[ 1.19271183e+02 -4.92738716e+01 -4.92570741e+01]
 [ 2.59232500e-02  5.05415125e-02 -4.24165615e-02]
 [-2.33953071e+00 -3.18729617e+00 -9.10449506e-01]
 [-6.70969584e-02  2.12599534e-02 -1.34424520e-01]
 [ 4.98699936e-01 -9.14781850e-02 -2.63730183e-01]
 [ 7.70455115e-02  1.29479293e-01  7.07289191e-04]
 [-3.48919614e-02  6.64794241e-02 -4.22794132e-02]
 [ 1.50006089e-01  3.95374204e-01  2.52999544e-01]
 [ 1.01363476e-01  1.01059598e-01 -7.38090859e-02]
 [-9.69615496e-01 -3.97269066e-01 -3.33868911e-02]
 [ 3.18644957e-02 -3.18264231e-02 -2.86189835e-01]
 [ 6.11113598e-02  9.92685193e-03  2.21312858e-02]
 [-5.96594303e-01 -1.10551231e+00  2.04741967e-01]
 [ 2.90695712e-01  6.44414913e-02  1.49707965e-01]
 [ 1.42663185e-01  1.54844369e-01 -1.06106784e-01]
 [-3.50477606e-01  1.85778642e-01  7.38951010e-02]
 [-1.68617294e-01  1.23101439e-01  2.14064153e-01]
 [ 1.11592351e-01 -1.19078750e-02 -2.12033917e-02]
 [-9.96915720e-02 -5.12995685e-01  1.58941732e-01]
 [ 6.44236222e-02 -4.57203375e-01 -5.08892774e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.27118322 -49.27387164 -49.25707411]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [   7.3268874   -15.90307369 -140.51672192]
init_Out:  [2.48374395]
Stock Position:  7.326887399052493
Bond position:  [-730.20499595]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [2.45528031]
curr_Stock_Price:  100.02103354675653
curr_Factors:  [100.02103355  -0.93435897  -0.99811444]
mat_Sqrt:  [[14.48200856  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00190455  0.0163122  -0.12100264]
Stock Position:  0.0019045527128422595
Bond Position:  [2.26478498]


portfolio before change:  [2.45454668]
curr_Stock_Price:  99.33851160872088
curr_Factors:  [99.33851161 -0.74843342 -1.02019338]
mat_Sqrt:  [[16.94387692  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.18744114 -1.02869541 -2.59725902]
Stock Position:  -0.18744113644440508
Bond Position:  [21.07467019]


portfolio before change:  [2.74382093]
curr_Stock_Price:  97.82334300078246
curr_Factors:  [97.823343   -0.46075605 -1.01601344]
mat_Sqrt:  [[22.34033394  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00403739  0.00686162 -0.38347574]
Stock Position:  -0.004037387223550655
Bond Position:  [3.13877165]


portfolio before change:  [2.73945951]
curr_Stock_Price:  99.09798185570851
curr_Factors:  [99.09798186 -0.70057448 -1.05763906]
mat_Sqrt:  [[17.0797839   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.02495309 -0.02952446 -0.7523488 ]
Stock Position:  0.024953086902945443
Bond Position:  [0.26665896]


portfolio before change:  [2.76449955]
curr_Stock_Price:  100.0987944356276
curr_Factors:  [100.09879444  -0.41421148  -1.06944871]
mat_Sqrt:  [[22.70300862  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00456414 0.04178926 0.0020177 ]
Stock Position:  0.004564141172252705
Bond Position:  [2.30763452]


portfolio before change:  [2.7524734]
curr_Stock_Price:  97.33745903891977
curr_Factors:  [97.33745904 -0.54875822 -1.03005203]
mat_Sqrt:  [[20.07296035  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00149216  0.02145614 -0.1206114 ]
Stock Position:  -0.0014921643005839627
Bond Position:  [2.89771688]


portfolio before change:  [2.7510796]
curr_Stock_Price:  98.7570896009678
curr_Factors:  [98.7570896  -0.25803584 -1.04933507]
mat_Sqrt:  [[26.7167919   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01056844 0.12760648 0.72173728]
Stock Position:  0.010568440514194838
Bond Position:  [1.70737117]


portfolio before change:  [2.77621046]
curr_Stock_Price:  101.09461199491201
curr_Factors:  [101.09461199  -0.40928785  -1.08689981]
mat_Sqrt:  [[22.64341701  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00472217  0.03261685 -0.21055678]
Stock Position:  0.004722165537343091
Bond Position:  [2.29882497]


portfolio before change:  [2.76499052]
curr_Stock_Price:  98.59687577271205
curr_Factors:  [98.59687577 -0.60228756 -1.07469986]
mat_Sqrt:  [[18.43133405  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.05737636 -0.12821804 -0.09524351]
Stock Position:  -0.05737635553202046
Bond Position:  [8.42211992]


portfolio before change:  [2.91740102]
curr_Stock_Price:  95.97724769201811
curr_Factors:  [95.97724769 -0.25650702 -1.06923711]
mat_Sqrt:  [[25.49206001  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00129649 -0.01027193 -0.81641994]
Stock Position:  -0.0012964939341511455
Bond Position:  [3.04183494]


portfolio before change:  [2.91745554]
curr_Stock_Price:  96.52182407030224
curr_Factors:  [96.52182407 -0.24430139 -1.04475719]
mat_Sqrt:  [[26.59466312  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00254394 0.00320388 0.0631344 ]
Stock Position:  0.002543938964287767
Bond Position:  [2.67190991]


portfolio before change:  [2.91666418]
curr_Stock_Price:  95.94813927135172
curr_Factors:  [ 9.59481393e+01 -9.50452910e-02 -1.05772978e+00]
mat_Sqrt:  [[30.29651698  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02576083 -0.35680256  0.58407184]
Stock Position:  -0.025760825223869722
Bond Position:  [5.38836743]


portfolio before change:  [3.03104866]
curr_Stock_Price:  91.56018911924178
curr_Factors:  [ 9.15601891e+01 -2.34969694e-02 -1.07199808e+00]
mat_Sqrt:  [[30.61534979  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01092291 0.0207984  0.42707515]
Stock Position:  0.010922912493063826
Bond Position:  [2.03094472]


portfolio before change:  [3.02515174]
curr_Stock_Price:  90.97383351148942
curr_Factors:  [90.97383351 -0.16001185 -1.10601679]
mat_Sqrt:  [[25.64999251  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00594978  0.04997581 -0.30269312]
Stock Position:  0.00594977574133787
Bond Position:  [2.48387784]


portfolio before change:  [3.02767941]
curr_Stock_Price:  91.29428647969493
curr_Factors:  [91.29428648  0.0976343  -1.09491033]
mat_Sqrt:  [[33.67690102  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00883311  0.0599598   0.21080215]
Stock Position:  -0.008833114576869947
Bond Position:  [3.83409231]


portfolio before change:  [3.0416199]
curr_Stock_Price:  89.82460737523421
curr_Factors:  [89.82460738 -0.58430302 -1.11156245]
mat_Sqrt:  [[16.4774618   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00605637  0.03973082  0.61066544]
Stock Position:  -0.00605637304234006
Bond Position:  [3.58563123]


portfolio before change:  [3.03972845]
curr_Stock_Price:  90.28494392993936
curr_Factors:  [90.28494393 -0.60564953 -1.1132052 ]
mat_Sqrt:  [[16.18550334  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.006477   -0.00384325 -0.06048737]
Stock Position:  0.006477002271460236
Bond Position:  [2.45495266]


portfolio before change:  [3.04025927]
curr_Stock_Price:  90.27213027609162
curr_Factors:  [90.27213028 -0.59457595 -1.08375498]
mat_Sqrt:  [[16.85248033  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01020399 -0.16556865  0.45341652]
Stock Position:  -0.010203989511894364
Bond Position:  [3.96139514]


portfolio before change:  [3.03625549]
curr_Stock_Price:  90.76157206534592
curr_Factors:  [90.76157207 -0.75093293 -1.11739754]
mat_Sqrt:  [[14.01187959  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00947624 -0.14756175 -1.45172944]
Stock Position:  -0.00947623962095777
Bond Position:  [3.89633389]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [3.04603565]
Stock Price:  89.83230517289061
PL:  [3.04603565]
Settle:  Tensor("sub_220:0", shape=(), dtype=float64)
PL:  Tensor("sub_221:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  111
output_Z_Vals[:, i, :]:  [[ 1.19271183e+02 -4.92738716e+01 -4.92570741e+01]
 [ 5.65652630e-02  9.12439269e-02 -4.00433918e-02]
 [-2.25568744e+00 -2.87377960e+00 -8.35497490e-01]
 [ 4.73564715e-02  1.45385940e-01 -8.02360274e-02]
 [ 7.86855319e-01 -4.34388330e-02 -4.53317779e-01]
 [ 7.66760878e-02  1.26061404e-01 -1.36422869e-03]
 [ 1.73855000e-02  3.46034521e-02  1.09237332e-01]
 [ 1.38354892e-01  3.61072510e-01  2.20982031e-01]
 [-1.54809956e-01  4.28467357e-01 -9.89603821e-02]
 [-7.92386680e-01 -3.23475798e-01 -2.43863109e-02]
 [-2.53746694e-02 -3.55082286e-02 -3.17820160e-01]
 [ 3.09594013e-01  1.34416033e-01  8.47349378e-03]
 [-7.21371611e-01 -9.59204175e-01  2.32875590e-01]
 [ 2.86544223e-01  4.46855088e-02  1.81092233e-01]
 [ 1.48700086e-01  1.49688502e-01 -1.06313010e-01]
 [-2.92105587e-01  1.52513180e-01  1.13362157e-01]
 [-2.45628734e-02  1.19788117e-01  1.59929228e-01]
 [ 1.15216134e-01 -1.08333916e-02 -3.18137274e-02]
 [-7.18298168e-02 -3.59217000e-01  9.90628796e-02]
 [ 8.01480039e-02 -6.23085176e-01 -6.26003548e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.27118322 -49.27387164 -49.25707411]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [   7.3268874   -15.90307369 -140.51672192]
init_Out:  [2.48374395]
Stock Position:  7.326887399052493
Bond position:  [-730.20499595]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-5.03225814]
curr_Stock_Price:  98.99910731250456
curr_Factors:  [98.99910731 -0.83905868 -1.02666596]
mat_Sqrt:  [[15.32347854  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00437345  0.02944885 -0.11423265]
Stock Position:  0.004373453999731345
Bond Position:  [-5.46522618]


portfolio before change:  [-5.03295444]
curr_Stock_Price:  99.15234417194961
curr_Factors:  [99.15234417 -1.08638584 -1.01630472]
mat_Sqrt:  [[12.10921751  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.24880554 -0.92750838 -2.38344178]
Stock Position:  -0.24880554473461666
Bond Position:  [19.63669856]


portfolio before change:  [-5.23753717]
curr_Stock_Price:  99.99433713077511
curr_Factors:  [99.99433713 -0.63939554 -1.01768501]
mat_Sqrt:  [[19.0684095   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00318092  0.04692311 -0.22889105]
Stock Position:  0.003180922970016395
Bond Position:  [-5.55561145]


portfolio before change:  [-5.23735974]
curr_Stock_Price:  100.48680756903282
curr_Factors:  [100.48680757  -0.54068399  -1.03022564]
mat_Sqrt:  [[20.88678832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.03281765 -0.01401982 -1.29318944]
Stock Position:  0.03281764958269672
Bond Position:  [-8.53510057]


portfolio before change:  [-5.21066894]
curr_Stock_Price:  101.3651410391173
curr_Factors:  [101.36514104  -0.60081308  -1.01011786]
mat_Sqrt:  [[20.24278266  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00504524  0.04068614 -0.00389176]
Stock Position:  0.005045244709255627
Bond Position:  [-5.72208088]


portfolio before change:  [-5.21104095]
curr_Stock_Price:  101.57497993168589
curr_Factors:  [101.57497993  -0.69107964  -0.98794964]
mat_Sqrt:  [[18.94931836  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00246694 0.01116822 0.3116237 ]
Stock Position:  0.0024669424138862627
Bond Position:  [-5.46162057]


portfolio before change:  [-5.22058666]
curr_Stock_Price:  98.25908020672189
curr_Factors:  [98.25908021 -0.21682597 -0.92128333]
mat_Sqrt:  [[31.48459469  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.008168   0.11653565 0.63040023]
Stock Position:  0.008168003452611558
Bond Position:  [-6.02316716]


portfolio before change:  [-5.2511641]
curr_Stock_Price:  94.69989236299426
curr_Factors:  [94.69989236 -0.47170001 -0.95516895]
mat_Sqrt:  [[22.73359757  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00385111  0.13828724 -0.28230642]
Stock Position:  -0.0038511118190658385
Bond Position:  [-4.88646422]


portfolio before change:  [-5.26115272]
curr_Stock_Price:  96.97634020975363
curr_Factors:  [96.97634021 -0.71676637 -0.9695566 ]
mat_Sqrt:  [[17.95994628  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.04807329 -0.10440136 -0.06956736]
Stock Position:  -0.04807329165201788
Bond Position:  [-0.59918083]


portfolio before change:  [-5.15377465]
curr_Stock_Price:  94.73959129747327
curr_Factors:  [94.7395913  -0.39780522 -0.98292334]
mat_Sqrt:  [[23.8170906   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0040936  -0.01146023 -0.90665245]
Stock Position:  -0.004093595067157054
Bond Position:  [-4.76594913]


portfolio before change:  [-5.14821768]
curr_Stock_Price:  93.09101401021005
curr_Factors:  [93.09101401 -0.74431401 -0.96741833]
mat_Sqrt:  [[16.80783793  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.02015495 0.04338259 0.02417252]
Stock Position:  0.02015495490312071
Bond Position:  [-7.02446287]


portfolio before change:  [-5.16870294]
curr_Stock_Price:  92.16176737637933
curr_Factors:  [92.16176738 -0.57765074 -0.94221033]
mat_Sqrt:  [[20.15967462  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.04313724 -0.30958182  0.66432924]
Stock Position:  -0.043137244477776365
Bond Position:  [-1.19309825]


portfolio before change:  [-5.11288488]
curr_Stock_Price:  90.86088746264521
curr_Factors:  [90.86088746 -0.39033812 -0.93883374]
mat_Sqrt:  [[24.05054767  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01383049 0.01442219 0.51660574]
Stock Position:  0.013830492194997858
Bond Position:  [-6.36953567]


portfolio before change:  [-5.08840536]
curr_Stock_Price:  92.74600488467169
curr_Factors:  [92.74600488 -0.73100866 -0.94657903]
mat_Sqrt:  [[17.32718973  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00909288  0.04831176 -0.30328143]
Stock Position:  0.009092880810662219
Bond Position:  [-5.93173372]


portfolio before change:  [-5.07616298]
curr_Stock_Price:  94.25548205839422
curr_Factors:  [94.25548206 -0.73371015 -0.95643448]
mat_Sqrt:  [[17.38946143  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0136769   0.04922342  0.32339068]
Stock Position:  -0.013676904968698078
Bond Position:  [-3.78703971]


portfolio before change:  [-5.07630603]
curr_Stock_Price:  94.19670974988847
curr_Factors:  [94.19670975 -0.75240455 -0.95541662]
mat_Sqrt:  [[17.07412362  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00190547 0.03866145 0.45623357]
Stock Position:  0.0019054676626445621
Bond Position:  [-5.25579482]


portfolio before change:  [-5.07820238]
curr_Stock_Price:  93.89114985688519
curr_Factors:  [93.89114986 -1.14343319 -0.92561787]
mat_Sqrt:  [[11.85897622  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00898145 -0.00349646 -0.09075571]
Stock Position:  0.008981452160277788
Bond Position:  [-5.92148125]


portfolio before change:  [-5.08857808]
curr_Stock_Price:  92.90075930663697
curr_Factors:  [92.90075931 -0.97879415 -0.93815634]
mat_Sqrt:  [[13.66149545  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00914494 -0.11593679  0.28259882]
Stock Position:  -0.009144939846665796
Bond Position:  [-4.23900623]


portfolio before change:  [-5.09661948]
curr_Stock_Price:  93.66418851464064
curr_Factors:  [93.66418851 -1.19187031 -0.96733887]
mat_Sqrt:  [[10.81037949  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0161716  -0.20109988 -1.78581388]
Stock Position:  -0.01617160287908737
Bond Position:  [-3.58191942]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-5.09814209]
Stock Price:  93.70296128213869
PL:  [-5.09814209]
Settle:  Tensor("sub_222:0", shape=(), dtype=float64)
PL:  Tensor("sub_223:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  112
output_Z_Vals[:, i, :]:  [[ 1.19271183e+02 -4.92738716e+01 -4.92570741e+01]
 [ 4.19997414e-02  7.04920610e-02 -4.22160009e-02]
 [-2.43086133e+00 -3.29903908e+00 -9.42362155e-01]
 [ 2.14308449e-02  1.12827985e-01 -9.66967897e-02]
 [ 3.78024824e-01 -1.10330123e-01 -1.74873191e-01]
 [-1.39571010e-01 -2.21310856e-01  1.04516753e-02]
 [-8.96456360e-02  1.48904284e-01 -1.95802733e-01]
 [ 8.21518593e-02  1.55952518e-01  2.66955259e-02]
 [-2.74475369e-01  2.74538926e-01  1.24245718e-02]
 [-4.93309019e-01 -1.36662882e-01 -1.05216273e-02]
 [-1.79659039e-01 -7.05601846e-02 -4.36051884e-01]
 [ 5.47676282e-01  2.66604829e-01 -6.59052311e-03]
 [-7.63160085e-01 -9.97550605e-01  2.41472425e-01]
 [ 2.74334611e-01  5.06909106e-02  1.49035628e-01]
 [ 2.05850052e-01  1.65522032e-01 -1.09268359e-01]
 [-4.35857945e-01  2.09198716e-01  1.05686998e-01]
 [-1.42845009e-01  1.23154612e-01  2.00267392e-01]
 [ 1.09823935e-01 -1.24322257e-02 -1.60255195e-02]
 [-1.13989787e-01 -5.75691472e-01  1.77125473e-01]
 [ 1.74574709e-02 -2.18101586e-01 -1.78864649e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.27118322 -49.27387164 -49.25707411]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [   7.3268874   -15.90307369 -140.51672192]
init_Out:  [2.48374395]
Stock Position:  7.326887399052493
Bond position:  [-730.20499595]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-3.33947224]
curr_Stock_Price:  99.23014483319945
curr_Factors:  [99.23014483 -0.76608091 -1.0349236 ]
mat_Sqrt:  [[16.38616438  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00291536  0.02275121 -0.1204305 ]
Stock Position:  0.00291535998968233
Bond Position:  [-3.62876383]


portfolio before change:  [-3.33991744]
curr_Stock_Price:  99.38865033155585
curr_Factors:  [99.38865033 -0.58425208 -1.04475882]
mat_Sqrt:  [[19.49244636  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.16912365 -1.06476028 -2.68829693]
Stock Position:  -0.16912365284575723
Bond Position:  [13.46905415]


portfolio before change:  [-3.45548151]
curr_Stock_Price:  100.09187400326809
curr_Factors:  [100.091874    -0.43956291  -1.07048377]
mat_Sqrt:  [[22.11026169  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0011182   0.03641508 -0.27584903]
Stock Position:  0.0011181962322317253
Bond Position:  [-3.56740387]


portfolio before change:  [-3.458146]
curr_Stock_Price:  98.5067137946247
curr_Factors:  [98.50671379 -0.64483994 -1.09858204]
mat_Sqrt:  [[17.23087318  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01856017 -0.03560889 -0.49886454]
Stock Position:  0.018560170336045317
Bond Position:  [-5.28644738]


portfolio before change:  [-3.5163194]
curr_Stock_Price:  95.44361546247302
curr_Factors:  [95.44361546 -0.59211881 -1.07461567]
mat_Sqrt:  [[18.0257479   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01013065 -0.07142777  0.02981572]
Stock Position:  -0.010130645427964113
Bond Position:  [-2.54941397]


portfolio before change:  [-3.51275824]
curr_Stock_Price:  95.02917050510084
curr_Factors:  [95.02917051 -0.64999403 -1.07436563]
mat_Sqrt:  [[16.94248272  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00585621  0.04805865 -0.5585707 ]
Stock Position:  -0.005856210294844609
Bond Position:  [-2.95624743]


portfolio before change:  [-3.50099748]
curr_Stock_Price:  92.89469831656696
curr_Factors:  [92.89469832 -0.61248742 -1.0385646 ]
mat_Sqrt:  [[17.82165972  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00670166 0.05033346 0.0761549 ]
Stock Position:  0.006701661740194305
Bond Position:  [-4.12354632]


portfolio before change:  [-3.51013491]
curr_Stock_Price:  91.68508459868008
curr_Factors:  [91.6850846  -0.85512711 -1.07573784]
mat_Sqrt:  [[13.29641908  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01623739  0.08860706  0.03544385]
Stock Position:  -0.01623739357297054
Bond Position:  [-2.02140811]


portfolio before change:  [-3.51194888]
curr_Stock_Price:  91.7656732664805
curr_Factors:  [91.76567327 -1.00128248 -1.03987905]
mat_Sqrt:  [[11.91832073  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.04391163 -0.04410776 -0.03001527]
Stock Position:  -0.043911633444388656
Bond Position:  [0.51763173]


portfolio before change:  [-3.48230457]
curr_Stock_Price:  91.0935306593328
curr_Factors:  [91.09353066 -1.09660686 -0.99475041]
mat_Sqrt:  [[11.25181582  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02515779 -0.0227732  -1.24393465]
Stock Position:  -0.02515778782154873
Bond Position:  [-1.19059286]


portfolio before change:  [-3.45455665]
curr_Stock_Price:  89.97874222785734
curr_Factors:  [89.97874223 -0.96762224 -0.97258155]
mat_Sqrt:  [[12.9276659   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.04647022  0.08604634 -0.01880093]
Stock Position:  0.04647022006499806
Bond Position:  [-7.6358886]


portfolio before change:  [-3.39496768]
curr_Stock_Price:  91.30213127369075
curr_Factors:  [91.30213127 -1.25952014 -0.97882825]
mat_Sqrt:  [[ 9.73595505  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.09423769 -0.32195807  0.68885361]
Stock Position:  -0.09423768823007704
Bond Position:  [5.2091341]


portfolio before change:  [-3.38814271]
curr_Stock_Price:  91.24352919223986
curr_Factors:  [91.24352919 -1.00852085 -0.96764984]
mat_Sqrt:  [[12.64625835  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.02491675 0.01636042 0.42515716]
Stock Position:  0.02491674699103512
Bond Position:  [-5.66163464]


portfolio before change:  [-3.38880868]
curr_Stock_Price:  91.27361381139666
curr_Factors:  [91.27361381 -1.34584028 -0.922183  ]
mat_Sqrt:  [[ 9.44833427  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.02300223  0.05342201 -0.31171221]
Stock Position:  0.023002232903556533
Bond Position:  [-5.48830561]


portfolio before change:  [-3.39677504]
curr_Stock_Price:  90.9869413209267
curr_Factors:  [90.98694132 -1.63334103 -0.92804565]
mat_Sqrt:  [[ 7.02397516  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.05290198  0.0675186   0.30149559]
Stock Position:  -0.052901976396293994
Bond Position:  [1.41661398]


portfolio before change:  [-3.37202728]
curr_Stock_Price:  90.52583272830117
curr_Factors:  [90.52583273 -0.89317233 -0.95223972]
mat_Sqrt:  [[14.29948048  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0053727   0.03974798  0.57130713]
Stock Position:  -0.005372696532297787
Bond Position:  [-2.88565946]


portfolio before change:  [-3.3722785]
curr_Stock_Price:  90.43829891992984
curr_Factors:  [90.43829892 -0.2765519  -0.9543904 ]
mat_Sqrt:  [[26.40954604  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00393854 -0.00401248 -0.04571635]
Stock Position:  0.00393853880828552
Bond Position:  [-3.72847325]


portfolio before change:  [-3.38443677]
curr_Stock_Price:  87.58799283632217
curr_Factors:  [ 8.75879928e+01 -7.72719703e-02 -8.93902404e-01]
mat_Sqrt:  [[33.16415241  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0058903  -0.18580362  0.50528967]
Stock Position:  -0.005890297712241799
Bond Position:  [-2.86851742]


portfolio before change:  [-3.37862611]
curr_Stock_Price:  86.47974969956708
curr_Factors:  [86.4797497  -0.15453771 -0.91214787]
mat_Sqrt:  [[29.76177062  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00213606 -0.07039198 -0.51025106]
Stock Position:  -0.0021360598188247164
Bond Position:  [-3.19390019]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-3.3928435]
Stock Price:  92.76178946347912
PL:  [-3.3928435]
Settle:  Tensor("sub_224:0", shape=(), dtype=float64)
PL:  Tensor("sub_225:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  113
output_Z_Vals[:, i, :]:  [[ 1.19271183e+02 -4.92738716e+01 -4.92570741e+01]
 [ 2.75894237e-02  5.32184079e-02 -4.16433497e-02]
 [-2.04104382e+00 -2.75016023e+00 -7.82389276e-01]
 [-5.42089046e-01 -4.62362605e-01  3.63259956e-01]
 [ 6.43299621e-01  1.14678098e-01 -5.19021162e-01]
 [ 1.83050017e-02  1.51479561e-01 -2.50196123e-02]
 [ 1.76379372e-02  2.30878719e-02  1.00867901e-01]
 [ 4.87929103e-02  1.30282688e-01  5.76680704e-02]
 [ 4.47788421e-02 -4.46349251e-02 -2.47365697e-02]
 [-1.19619421e+00 -4.78064563e-01 -4.51816531e-02]
 [ 3.67281209e-01  6.37117245e-02  6.25759476e-02]
 [-1.90454789e-01  2.36497079e-05  2.79020704e-02]
 [-7.58180174e-01 -1.01917486e+00  2.67987713e-01]
 [-1.19426818e-02 -3.09171509e-02 -2.12026060e-02]
 [-1.74094619e-01 -2.20455845e-01  7.87390761e-02]
 [ 1.09629030e-01  2.07251768e-02  4.22636397e-02]
 [-8.18253148e-02 -9.13197795e-02 -1.07370218e-01]
 [-1.05442945e-01 -1.97553209e-01  3.23191333e-01]
 [ 5.87114033e-02 -8.28595621e-02  9.66908912e-02]
 [ 4.84527663e-02 -5.10452307e-01 -2.22157919e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.27118322 -49.27387164 -49.25707411]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [   7.3268874   -15.90307369 -140.51672192]
init_Out:  [2.48374395]
Stock Position:  7.326887399052493
Bond position:  [-730.20499595]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [0.56492962]
curr_Stock_Price:  99.76303167074832
curr_Factors:  [99.76303167 -0.77207425 -0.97296811]
mat_Sqrt:  [[17.42237555  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00171918  0.01717617 -0.11879689]
Stock Position:  0.001719178446580585
Bond Position:  [0.39341916]


portfolio before change:  [0.56931981]
curr_Stock_Price:  102.25947170632014
curr_Factors:  [102.25947171  -1.17991686  -0.97627372]
mat_Sqrt:  [[11.83809647  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.23332488 -0.8876104  -2.23193883]
Stock Position:  -0.23332488287552783
Bond Position:  [24.42899907]


portfolio before change:  [0.27159121]
curr_Stock_Price:  103.56167577472938
curr_Factors:  [103.56167577  -1.38873616  -0.96395326]
mat_Sqrt:  [[ 9.85006359  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.05708778 -0.14922689  1.03627954]
Stock Position:  -0.05708778264993105
Bond Position:  [6.18369765]


portfolio before change:  [0.36107056]
curr_Stock_Price:  102.02135969327828
curr_Factors:  [102.02135969  -1.43889858  -0.94242082]
mat_Sqrt:  [[ 9.42968601  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.05946788  0.0370122  -1.48062291]
Stock Position:  0.05946788023950079
Bond Position:  [-5.70592344]


portfolio before change:  [0.36450694]
curr_Stock_Price:  102.10313569682373
curr_Factors:  [102.1031357   -1.4441131   -0.91686633]
mat_Sqrt:  [[ 9.63116322  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00458081  0.04888982 -0.07137399]
Stock Position:  0.0045808101894895936
Bond Position:  [-0.10320814]


portfolio before change:  [0.36086065]
curr_Stock_Price:  101.3127746397504
curr_Factors:  [101.31277464  -1.38423478  -0.91096449]
mat_Sqrt:  [[10.20638234  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.0042072  0.00745158 0.28774804]
Stock Position:  0.0042072011369876545
Bond Position:  [-0.06538258]


portfolio before change:  [0.36127806]
curr_Stock_Price:  101.41587497451202
curr_Factors:  [101.41587497  -1.1136108   -0.95046322]
mat_Sqrt:  [[12.87330289  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00677046 0.04204856 0.16451095]
Stock Position:  0.006770461231348095
Bond Position:  [-0.32535419]


portfolio before change:  [0.35794189]
curr_Stock_Price:  100.93513637342478
curr_Factors:  [100.93513637  -0.98398808  -0.92681803]
mat_Sqrt:  [[14.93447024  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00205019 -0.01440586 -0.07056655]
Stock Position:  0.00205018621867893
Bond Position:  [0.15100606]


portfolio before change:  [0.36049817]
curr_Stock_Price:  102.16357434867221
curr_Factors:  [102.16357435  -1.16116206  -0.9629106 ]
mat_Sqrt:  [[12.21301927  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.10668954 -0.15429467 -0.12889068]
Stock Position:  -0.10668953919992624
Bond Position:  [11.26028284]


portfolio before change:  [0.16641823]
curr_Stock_Price:  104.00907262930203
curr_Factors:  [104.00907263  -1.10975898  -0.98026177]
mat_Sqrt:  [[12.86431733  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.03055425 0.02056287 0.17851176]
Stock Position:  0.030554250328805075
Bond Position:  [-3.01150101]


portfolio before change:  [0.17474608]
curr_Stock_Price:  104.3062756422277
curr_Factors:  [104.30627564  -1.12494888  -0.97616242]
mat_Sqrt:  [[12.75878716  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-1.44805672e-02  7.63291039e-06  7.95968403e-02]
Stock Position:  -0.014480567236282979
Bond Position:  [1.68516012]


portfolio before change:  [0.19139199]
curr_Stock_Price:  103.18583851127485
curr_Factors:  [103.18583851  -0.82560768  -1.00088898]
mat_Sqrt:  [[16.61049887  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.05487587 -0.32893727  0.76449435]
Stock Position:  -0.0548758719226792
Bond Position:  [5.85380485]


portfolio before change:  [0.13740218]
curr_Stock_Price:  104.19636354812029
curr_Factors:  [104.19636355  -0.66915664  -1.02809839]
mat_Sqrt:  [[19.08728097  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00118307 -0.00997847 -0.06048513]
Stock Position:  -0.0011830696431138893
Bond Position:  [0.26067373]


portfolio before change:  [0.13567897]
curr_Stock_Price:  105.7080157033931
curr_Factors:  [105.7080157   -0.34737784  -1.03583104]
mat_Sqrt:  [[26.50866988  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00765872 -0.07115182  0.22462067]
Stock Position:  -0.00765871823616743
Bond Position:  [0.94526687]


portfolio before change:  [0.12378505]
curr_Stock_Price:  107.29186614876512
curr_Factors:  [107.29186615  -0.48107512  -0.99830097]
mat_Sqrt:  [[24.43891527  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00501195 0.00668902 0.1205664 ]
Stock Position:  0.005011947828347784
Bond Position:  [-0.41395619]


portfolio before change:  [0.12122155]
curr_Stock_Price:  106.80104041633003
curr_Factors:  [106.80104042  -0.4109301   -0.97161847]
mat_Sqrt:  [[26.8004612   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00456644 -0.02947333 -0.30629735]
Stock Position:  -0.004566441590978895
Bond Position:  [0.60892227]


portfolio before change:  [0.11714349]
curr_Stock_Price:  107.7274321030297
curr_Factors:  [107.7274321   -0.7326894   -0.95643994]
mat_Sqrt:  [[19.89512876  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00401089 -0.06376002  0.92197491]
Stock Position:  -0.004010889850769157
Bond Position:  [0.54922635]


portfolio before change:  [0.12193877]
curr_Stock_Price:  106.56610426715471
curr_Factors:  [106.56610427  -0.7192994   -0.9796596 ]
mat_Sqrt:  [[19.48814819  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00315755 -0.02674281  0.2758322 ]
Stock Position:  0.0031575453408707976
Bond Position:  [-0.21454853]


portfolio before change:  [0.12267739]
curr_Stock_Price:  106.8170160562548
curr_Factors:  [106.81701606  -0.59754895  -0.98133664]
mat_Sqrt:  [[22.02617791  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00458957 -0.16474777 -0.6337547 ]
Stock Position:  -0.004589569293362374
Bond Position:  [0.61292149]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [0.12122983]
Stock Price:  107.16580993341493
PL:  [-7.0445801]
Settle:  Tensor("sub_226:0", shape=(), dtype=float64)
PL:  Tensor("sub_227:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  114
output_Z_Vals[:, i, :]:  [[ 1.19271183e+02 -4.92738716e+01 -4.92570741e+01]
 [ 2.21363872e-02  1.66650318e-02 -9.45143695e-02]
 [-1.97050251e+00 -2.65609158e+00 -7.55176955e-01]
 [-5.44046938e-02  1.45691955e-01  3.78903826e-02]
 [ 4.63600681e-01 -1.02605700e-02 -3.32277363e-01]
 [ 7.66261283e-02  1.25599181e-01 -1.64437342e-03]
 [ 1.82475016e-02  3.93652928e-02  1.14670703e-01]
 [ 5.14988916e-02  2.73677199e-01  2.67275851e-01]
 [-1.02630675e-02 -1.86357231e-01  2.29980329e-02]
 [-1.65311467e+00 -6.42966810e-01 -6.76364825e-02]
 [ 7.57168983e-02 -9.08782778e-02  1.95447477e-02]
 [-1.89433497e-01  4.69992390e-02  2.58505288e-02]
 [-8.38810518e-01 -1.03680652e+00  3.02323749e-01]
 [-8.45979130e-03 -4.89230122e-02 -2.24265937e-02]
 [-2.20866838e-01 -3.01400290e-01  1.23569300e-01]
 [ 1.03816510e-01  2.22896877e-02  4.50156350e-02]
 [-1.35294455e-01 -1.43682763e-01 -1.59472714e-01]
 [-1.45747464e-01 -2.33725567e-01  3.83906596e-01]
 [ 6.46349008e-02 -1.23454899e-01  1.28969143e-01]
 [ 9.24131105e-02 -8.58061901e-01 -1.02842089e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.27118322 -49.27387164 -49.25707411]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [   7.3268874   -15.90307369 -140.51672192]
init_Out:  [2.48374395]
Stock Position:  7.326887399052493
Bond position:  [-730.20499595]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [20.30150811]
curr_Stock_Price:  102.45675103895292
curr_Factors:  [102.45675104  -1.04750063  -1.02696513]
mat_Sqrt:  [[12.87097796  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00048524  0.00537862 -0.26962319]
Stock Position:  0.00048523567590218767
Bond Position:  [20.25179244]


portfolio before change:  [20.30681901]
curr_Stock_Price:  102.96644383414029
curr_Factors:  [102.96644383  -1.18314689  -1.06131382]
mat_Sqrt:  [[10.91286578  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.24437438 -0.85724987 -2.15430965]
Stock Position:  -0.24437437787334357
Bond Position:  [45.46917967]


portfolio before change:  [20.66013706]
curr_Stock_Price:  101.56715913209993
curr_Factors:  [101.56715913  -0.89849464  -1.10910846]
mat_Sqrt:  [[13.6415071   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00124115  0.04702188  0.10809071]
Stock Position:  -0.0012411463011408005
Bond Position:  [20.78619676]


portfolio before change:  [20.6673282]
curr_Stock_Price:  99.96062257105125
curr_Factors:  [99.96062257 -0.77562178 -1.0979453 ]
mat_Sqrt:  [[15.35143973  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.02564453 -0.00331158 -0.94789483]
Stock Position:  0.025644527479442788
Bond Position:  [18.10388527]


portfolio before change:  [20.69912584]
curr_Stock_Price:  101.02405014604624
curr_Factors:  [101.02405015  -0.55896634  -1.05406877]
mat_Sqrt:  [[20.13225974  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00506293  0.04053696 -0.00469094]
Stock Position:  0.005062933750355711
Bond Position:  [20.18764777]


portfolio before change:  [20.71032156]
curr_Stock_Price:  102.23840110272978
curr_Factors:  [102.2384011   -0.58978642  -1.10388046]
mat_Sqrt:  [[18.79593213  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00264366 0.01270509 0.3271236 ]
Stock Position:  0.0026436554058707875
Bond Position:  [20.44003846]


portfolio before change:  [20.71872057]
curr_Stock_Price:  103.48227079701074
curr_Factors:  [103.4822708   -0.65494155  -1.11805232]
mat_Sqrt:  [[17.573752    0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00921377 0.08832894 0.76246361]
Stock Position:  0.009213767819439719
Bond Position:  [19.76525895]


portfolio before change:  [20.72064009]
curr_Stock_Price:  103.15423890409943
curr_Factors:  [103.1542389   -0.64469174  -1.10080574]
mat_Sqrt:  [[18.00641078  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00242184 -0.06014654  0.06560699]
Stock Position:  -0.0024218387949875436
Bond Position:  [20.97046303]


portfolio before change:  [20.71964342]
curr_Stock_Price:  105.73077064493606
curr_Factors:  [105.73077064  -0.5957263   -1.10806279]
mat_Sqrt:  [[19.24222095  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.09344898 -0.20751665 -0.19294806]
Stock Position:  -0.09344898212210614
Bond Position:  [30.60007632]


portfolio before change:  [20.61117539]
curr_Stock_Price:  106.9733631973618
curr_Factors:  [106.9733632   -0.43638201  -1.14770513]
mat_Sqrt:  [[21.94397729  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00278692 -0.02933084  0.05575572]
Stock Position:  0.0027869151363321782
Bond Position:  [20.3130497]


portfolio before change:  [20.61165037]
curr_Stock_Price:  105.32138749435066
curr_Factors:  [105.32138749  -0.44602268  -1.10703914]
mat_Sqrt:  [[22.28591092  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00783289  0.01516894  0.07374436]
Stock Position:  -0.007832890524019321
Bond Position:  [21.43662127]


portfolio before change:  [20.60868909]
curr_Stock_Price:  106.38371560024567
curr_Factors:  [106.3837156   -0.46831477  -1.10985233]
mat_Sqrt:  [[21.95259625  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0450396  -0.33462787  0.8624455 ]
Stock Position:  -0.04503960145834053
Bond Position:  [25.40016925]


portfolio before change:  [20.64768702]
curr_Stock_Price:  105.6588625218067
curr_Factors:  [105.65886252  -0.26685613  -1.13793999]
mat_Sqrt:  [[25.93049019  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00088791 -0.01578983 -0.06397683]
Stock Position:  -0.0008879110440497823
Bond Position:  [20.74150269]


portfolio before change:  [20.651362]
curr_Stock_Price:  107.36066571056065
curr_Factors:  [107.36066571   0.28387345  -1.17958142]
mat_Sqrt:  [[43.83733735  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00586638 -0.09727653  0.35250882]
Stock Position:  -0.005866379025894541
Bond Position:  [21.28118036]


portfolio before change:  [20.65193598]
curr_Stock_Price:  108.1698488586965
curr_Factors:  [ 1.08169849e+02  2.70942172e-02 -1.20400041e+00]
mat_Sqrt:  [[33.34128692  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00352581 0.00719397 0.12841708]
Stock Position:  0.003525813246733204
Bond Position:  [20.2705493]


portfolio before change:  [20.65793721]
curr_Stock_Price:  108.43445732092474
curr_Factors:  [108.43445732  -0.19925077  -1.22380605]
mat_Sqrt:  [[26.13013103  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00754592 -0.04637341 -0.45493126]
Stock Position:  -0.007545917278867484
Bond Position:  [21.47617466]


portfolio before change:  [20.65649282]
curr_Stock_Price:  109.33747665307335
curr_Factors:  [109.33747665  -0.48198989  -1.24210725]
mat_Sqrt:  [[19.49858841  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00590258 -0.0754346   1.09517866]
Stock Position:  -0.0059025755049087
Bond Position:  [21.30186553]


portfolio before change:  [20.65891413]
curr_Stock_Price:  109.82960448568319
curr_Factors:  [109.82960449  -0.62183984  -1.25426713]
mat_Sqrt:  [[16.82428105  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00390867 -0.0398449   0.36791307]
Stock Position:  0.003908665762845981
Bond Position:  [20.22962691]


portfolio before change:  [20.66490744]
curr_Stock_Price:  110.06888510931954
curr_Factors:  [110.06888511  -1.05247512  -1.19269714]
mat_Sqrt:  [[11.65731797  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00889832 -0.27693829 -0.29337985]
Stock Position:  -0.00889832423952819
Bond Position:  [21.64433606]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [20.67407574]
Stock Price:  109.64672211867882
PL:  [11.02735362]
Settle:  Tensor("sub_228:0", shape=(), dtype=float64)
PL:  Tensor("sub_229:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  115
output_Z_Vals[:, i, :]:  [[ 1.19271183e+02 -4.92738716e+01 -4.92570741e+01]
 [ 5.70646668e-02  1.00573703e-01 -2.79649400e-02]
 [-1.98562008e+00 -2.67625125e+00 -7.61008775e-01]
 [ 1.05758210e-01  2.45796704e-01 -4.39633121e-02]
 [ 2.35386995e-01  1.23165940e-01 -3.44637814e-01]
 [-1.42304039e-01 -2.35748166e-01 -3.07451601e-03]
 [-1.77984640e-02  3.69515567e-02 -4.90438144e-02]
 [-1.22071005e-02  2.20139302e-02 -2.49245457e-02]
 [-2.47654183e-02 -2.23697989e-01  3.55750666e-02]
 [-1.02577712e+00 -3.97333551e-01 -3.67347727e-02]
 [ 2.61876921e-01  3.38230911e-04 -1.04543187e-01]
 [ 5.53801070e-02 -6.15971455e-02  3.76128999e-02]
 [-7.15953659e-01 -1.15938709e+00  2.53370045e-01]
 [-1.10897579e-02  7.31775588e-03  2.41329205e-02]
 [ 1.32094485e-01  1.24895856e-01 -1.06760808e-01]
 [ 1.03904882e-01  1.64972581e-02  3.52040614e-02]
 [ 7.21702634e-02  5.94899757e-02  4.26893125e-02]
 [ 8.85282437e-02 -1.88218526e-02  4.31376433e-02]
 [-1.99555753e-02 -7.49591300e-02  1.89219630e-02]
 [ 1.26499166e-01 -9.77209229e-01 -5.91195067e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.27118322 -49.27387164 -49.25707411]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [   7.3268874   -15.90307369 -140.51672192]
init_Out:  [2.48374395]
Stock Position:  7.326887399052493
Bond position:  [-730.20499595]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-4.40721701]
curr_Stock_Price:  99.0844151783281
curr_Factors:  [99.08441518 -0.97047877 -0.99387329]
mat_Sqrt:  [[13.89626506  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00517304  0.03246002 -0.07977619]
Stock Position:  0.005173035206274967
Bond Position:  [-4.91978418]


portfolio before change:  [-4.40360655]
curr_Stock_Price:  100.02014419001125
curr_Factors:  [100.02014419  -1.37604276  -1.00968207]
mat_Sqrt:  [[ 9.20407915  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.29196271 -0.86375638 -2.17094621]
Stock Position:  -0.2919627053261803
Bond Position:  [24.79854533]


portfolio before change:  [-4.41117171]
curr_Stock_Price:  100.06729257712593
curr_Factors:  [100.06729258  -1.64368698  -0.98128194]
mat_Sqrt:  [[ 7.24907564  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.02027255  0.07933054 -0.12541509]
Stock Position:  0.020272554139299494
Bond Position:  [-6.43979132]


portfolio before change:  [-4.41010063]
curr_Stock_Price:  100.19955188781371
curr_Factors:  [100.19955189  -1.69625291  -0.99788215]
mat_Sqrt:  [[ 6.77357262  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.02807665  0.03975164 -0.98315576]
Stock Position:  0.02807665142152227
Bond Position:  [-7.22336852]


portfolio before change:  [-4.41620378]
curr_Stock_Price:  100.0465033623721
curr_Factors:  [100.04650336  -1.66397951  -0.99632372]
mat_Sqrt:  [[ 6.99595332  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02730915 -0.07608739 -0.00877074]
Stock Position:  -0.027309146601262255
Bond Position:  [-1.68401916]


portfolio before change:  [-4.41038144]
curr_Stock_Price:  99.8178839522586
curr_Factors:  [99.81788395 -1.84267218 -1.01578984]
mat_Sqrt:  [[ 5.72524499  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0035399   0.01192606 -0.13990835]
Stock Position:  -0.0035398984456983125
Bond Position:  [-4.05703627]


portfolio before change:  [-4.41094841]
curr_Stock_Price:  99.69149088004372
curr_Factors:  [99.69149088 -1.64214009 -1.04359775]
mat_Sqrt:  [[ 6.79605628  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00188363  0.00710497 -0.07110279]
Stock Position:  -0.0018836258708865448
Bond Position:  [-4.22316694]


portfolio before change:  [-4.41269442]
curr_Stock_Price:  100.05785341168892
curr_Factors:  [100.05785341  -1.9201343   -1.05224149]
mat_Sqrt:  [[ 5.12111794  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01233439 -0.07219822  0.10148576]
Stock Position:  -0.012334386692051504
Bond Position:  [-3.17854217]


portfolio before change:  [-4.41775296]
curr_Stock_Price:  100.4035380918123
curr_Factors:  [100.40353809  -1.73312717  -1.03567101]
mat_Sqrt:  [[ 6.29905279  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.17691246 -0.12823885 -0.10479408]
Stock Position:  -0.17691246294251703
Bond Position:  [13.34488425]


portfolio before change:  [-4.3263713]
curr_Stock_Price:  99.90586240505462
curr_Factors:  [99.90586241 -1.48073417 -1.02241185]
mat_Sqrt:  [[ 8.17501335  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 2.94318998e-02  1.09163557e-04 -2.98232612e-01]
Stock Position:  0.02943189975971675
Bond Position:  [-7.26679062]


portfolio before change:  [-4.30732981]
curr_Stock_Price:  100.61456311865818
curr_Factors:  [100.61456312  -1.42800001  -1.04007211]
mat_Sqrt:  [[ 8.52689156  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0059206  -0.01988039  0.10729913]
Stock Position:  0.005920603427986076
Bond Position:  [-4.90302874]


portfolio before change:  [-4.30169025]
curr_Stock_Price:  101.77415296576699
curr_Factors:  [101.77415297  -1.56464278  -1.04053942]
mat_Sqrt:  [[ 7.52005891  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.11979874 -0.37419057  0.72279421]
Stock Position:  -0.11979874405613263
Bond Position:  [7.89072545]


portfolio before change:  [-4.28090349]
curr_Stock_Price:  101.61710763952746
curr_Factors:  [101.61710764  -1.68076348  -1.0620606 ]
mat_Sqrt:  [[ 6.54294799  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00071373  0.0023618   0.0688445 ]
Stock Position:  -0.0007137326248706912
Bond Position:  [-4.20837604]


portfolio before change:  [-4.28166348]
curr_Stock_Price:  101.20765663991378
curr_Factors:  [101.20765664  -1.32739945  -1.09772889]
mat_Sqrt:  [[ 8.95351391  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01516681  0.04030996 -0.30455887]
Stock Position:  0.015166814639647249
Bond Position:  [-5.81666124]


portfolio before change:  [-4.28375361]
curr_Stock_Price:  101.16573703483759
curr_Factors:  [101.16573703  -1.81148043  -1.09590671]
mat_Sqrt:  [[ 5.5254959   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.02071459 0.00532447 0.10042739]
Stock Position:  0.020714587736921874
Bond Position:  [-6.37936015]


portfolio before change:  [-4.28859889]
curr_Stock_Price:  101.00883100772795
curr_Factors:  [101.00883101  -1.79577612  -1.09065653]
mat_Sqrt:  [[ 5.63375007  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01651254 0.01920031 0.12178073]
Stock Position:  0.016512539987132396
Bond Position:  [-5.95651125]


portfolio before change:  [-4.28670682]
curr_Stock_Price:  101.21360819600423
curr_Factors:  [101.2136082   -1.54020285  -1.14770984]
mat_Sqrt:  [[ 6.8848306   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01357937 -0.00607473  0.12305969]
Stock Position:  0.01357937313744747
Bond Position:  [-5.66112417]


portfolio before change:  [-4.28577748]
curr_Stock_Price:  101.38628134328223
curr_Factors:  [101.38628134  -1.56701775  -1.15898748]
mat_Sqrt:  [[ 6.63880888  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00472888 -0.02419296  0.05397909]
Stock Position:  -0.004728877529734351
Bond Position:  [-3.80633417]


portfolio before change:  [-4.28564349]
curr_Stock_Price:  101.15669285197707
curr_Factors:  [101.15669285  -1.6064407   -1.17882684]
mat_Sqrt:  [[ 6.24264009  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.03102053 -0.31539292 -1.68651497]
Stock Position:  -0.03102053260947445
Bond Position:  [-1.147709]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-4.27356738]
Stock Price:  100.75814800395185
PL:  [-5.03171538]
Settle:  Tensor("sub_230:0", shape=(), dtype=float64)
PL:  Tensor("sub_231:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  116
output_Z_Vals[:, i, :]:  [[ 1.19271183e+02 -4.92738716e+01 -4.92570741e+01]
 [ 3.15638454e-02  5.96037637e-02 -3.97989622e-02]
 [-2.29580519e+00 -2.92349864e+00 -8.48812206e-01]
 [-6.03253359e-04  7.75236658e-02 -1.04350615e-01]
 [ 7.96493248e-01 -1.51911573e-01 -2.93565307e-01]
 [-1.45166785e-01 -2.52427603e-01  3.54352429e-02]
 [-5.85388786e-02  1.10090221e-01 -8.76658713e-02]
 [ 9.44756948e-02  2.31889996e-01  1.00401901e-01]
 [-3.01590078e-02  1.01755917e-01 -2.42238262e-02]
 [-7.23602566e-01 -2.89971413e-01 -2.09965100e-02]
 [ 4.16839194e-02 -5.06207212e-02 -3.06255444e-01]
 [ 2.09531572e-02 -5.81686721e-03  2.36682414e-02]
 [-6.10066079e-01 -1.18217089e+00  2.11368836e-01]
 [ 3.98640062e-02  5.27904953e-02  1.23436599e-01]
 [ 9.85970435e-02  1.19296488e-01 -1.03971898e-01]
 [-1.08784603e-01  8.12805719e-02  1.27631878e-01]
 [ 5.68137798e-02  1.16492314e-01  1.23803561e-01]
 [ 1.14183831e-01 -1.11394784e-02 -2.87911737e-02]
 [-6.39644797e-02 -2.54343159e-01  5.49515009e-02]
 [ 5.90486648e-02 -4.29252814e-01 -4.72735429e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.27118322 -49.27387164 -49.25707411]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [   7.3268874   -15.90307369 -140.51672192]
init_Out:  [2.48374395]
Stock Position:  7.326887399052493
Bond position:  [-730.20499595]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [1.22595265]
curr_Stock_Price:  99.85325047696081
curr_Factors:  [99.85325048 -0.93790478 -0.98718193]
mat_Sqrt:  [[14.56490549  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00244468  0.01923703 -0.11353536]
Stock Position:  0.00244467659643458
Bond Position:  [0.98184375]


portfolio before change:  [1.22467744]
curr_Stock_Price:  99.23120232489151
curr_Factors:  [99.23120232 -1.06025012 -0.97959391]
mat_Sqrt:  [[12.90491794  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.23757028 -0.94355513 -2.42142496]
Stock Position:  -0.2375702758647836
Bond Position:  [24.79906155]


portfolio before change:  [1.24052468]
curr_Stock_Price:  99.19059662760554
curr_Factors:  [99.19059663 -0.67026377 -0.97067808]
mat_Sqrt:  [[19.22288251  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00031625  0.02502066 -0.29768326]
Stock Position:  -0.0003162523303866717
Bond Position:  [1.27189394]


portfolio before change:  [1.24123599]
curr_Stock_Price:  97.94699435152812
curr_Factors:  [97.94699435 -0.53086482 -0.91990776]
mat_Sqrt:  [[22.95771122  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.03073306 -0.04902925 -0.83746011]
Stock Position:  0.03073305757807818
Bond Position:  [-1.76897463]


portfolio before change:  [1.2091472]
curr_Stock_Price:  96.91727282931497
curr_Factors:  [96.91727283 -0.81418396 -0.92356491]
mat_Sqrt:  [[17.04929559  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01111249 -0.08147066  0.10108688]
Stock Position:  -0.011112492237546697
Bond Position:  [2.28613964]


portfolio before change:  [1.21820278]
curr_Stock_Price:  96.15381027592016
curr_Factors:  [96.15381028 -0.52071057 -0.89795602]
mat_Sqrt:  [[23.27273524  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00231866  0.03553147 -0.25008633]
Stock Position:  -0.0023186585871153515
Bond Position:  [1.44115063]


portfolio before change:  [1.21684014]
curr_Stock_Price:  96.89689755156927
curr_Factors:  [96.89689755 -0.57308568 -0.91116304]
mat_Sqrt:  [[21.96386894  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00738961 0.07484217 0.28641868]
Stock Position:  0.007389613128779939
Bond Position:  [0.50080956]


portfolio before change:  [1.21174117]
curr_Stock_Price:  96.18993375385838
curr_Factors:  [96.18993375 -1.06141136 -0.91468882]
mat_Sqrt:  [[13.33276491  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00107501  0.03284158 -0.06910383]
Stock Position:  -0.0010750085401231846
Bond Position:  [1.31514617]


portfolio before change:  [1.21155604]
curr_Stock_Price:  96.6680343385726
curr_Factors:  [96.66803434 -1.15476281 -0.9489408 ]
mat_Sqrt:  [[11.79386131  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0667363  -0.09358787 -0.0598972 ]
Stock Position:  -0.06673629666085404
Bond Position:  [7.66282266]


portfolio before change:  [1.22017166]
curr_Stock_Price:  96.5676439947916
curr_Factors:  [96.56764399 -0.88118792 -0.95316347]
mat_Sqrt:  [[15.42350038  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0020205  -0.01633777 -0.87366154]
Stock Position:  -0.002020496125805511
Bond Position:  [1.41528621]


portfolio before change:  [1.21998596]
curr_Stock_Price:  96.8346901018389
curr_Factors:  [96.8346901  -0.58515297 -0.95157429]
mat_Sqrt:  [[20.82757945  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00118098 -0.00187739  0.0675189 ]
Stock Position:  0.0011809847520443326
Bond Position:  [1.10562567]


portfolio before change:  [1.22026646]
curr_Stock_Price:  96.83812097034834
curr_Factors:  [96.83812097 -0.47203331 -0.89845888]
mat_Sqrt:  [[24.5951322   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.03286139 -0.38154401  0.60297645]
Stock Position:  -0.03286138949607178
Bond Position:  [4.40250167]


portfolio before change:  [1.17194527]
curr_Stock_Price:  98.34207293831965
curr_Factors:  [98.34207294 -0.78268587 -0.88633058]
mat_Sqrt:  [[18.53082378  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00409244 0.01703806 0.35213026]
Stock Position:  0.004092436043871256
Bond Position:  [0.76948662]


portfolio before change:  [1.17228561]
curr_Stock_Price:  98.37822449018414
curr_Factors:  [98.37822449 -1.00223451 -0.87827639]
mat_Sqrt:  [[15.00387631  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00677993  0.03850278 -0.29660288]
Stock Position:  0.006779925418788364
Bond Position:  [0.50528859]


portfolio before change:  [1.17128741]
curr_Stock_Price:  98.21236208418924
curr_Factors:  [98.21236208 -1.2213398  -0.89344021]
mat_Sqrt:  [[11.85028697  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00558134  0.02623319  0.36409822]
Stock Position:  -0.005581343922756082
Bond Position:  [1.71944438]


portfolio before change:  [1.17954352]
curr_Stock_Price:  96.81015585848836
curr_Factors:  [96.81015586 -0.91941313 -0.92211366]
mat_Sqrt:  [[15.35168309  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00689592 0.03759773 0.3531771 ]
Stock Position:  0.0068959194338336196
Bond Position:  [0.51194849]


portfolio before change:  [1.16749218]
curr_Stock_Price:  95.04398838261555
curr_Factors:  [95.04398838 -0.66152559 -0.8925482 ]
mat_Sqrt:  [[20.09088097  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00527767 -0.00359525 -0.0821332 ]
Stock Position:  0.0052776690786079045
Bond Position:  [0.66588146]


portfolio before change:  [1.16903149]
curr_Stock_Price:  95.30410633088307
curr_Factors:  [95.30410633 -0.51238043 -0.93403223]
mat_Sqrt:  [[22.4358526   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00466508 -0.0820889   0.15676134]
Stock Position:  -0.004665083751493384
Bond Position:  [1.61363312]


portfolio before change:  [1.17002755]
curr_Stock_Price:  95.17707538523862
curr_Factors:  [95.17707539 -0.59584018 -0.94909431]
mat_Sqrt:  [[20.30373007  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0061599  -0.13854075 -1.34858259]
Stock Position:  -0.006159898395976449
Bond Position:  [1.75630867]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [1.17367085]
Stock Price:  94.656910839712
PL:  [1.17367085]
Settle:  Tensor("sub_232:0", shape=(), dtype=float64)
PL:  Tensor("sub_233:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  117
output_Z_Vals[:, i, :]:  [[ 1.19271183e+02 -4.92738716e+01 -4.92570741e+01]
 [ 5.37269265e-02  9.52112472e-02 -2.95138663e-02]
 [-2.14403712e+00 -2.90018672e+00 -8.26309772e-01]
 [ 6.85382354e-02  1.90159282e-01 -6.67206817e-02]
 [ 4.24585260e-01  1.45459129e-01 -4.39514471e-01]
 [ 7.57175145e-02  1.17192732e-01 -6.73936232e-03]
 [ 1.84933863e-02  3.20224687e-02  1.08402937e-01]
 [ 1.08237727e-01  3.37362706e-01  2.43067425e-01]
 [ 5.02884524e-02 -3.04487407e-02 -2.95147298e-02]
 [-1.23773323e+00 -5.08571018e-01 -4.70103936e-02]
 [ 3.69510580e-01  1.15227567e-01  7.15009694e-02]
 [-2.22541795e-01  1.05994151e-02  2.67992405e-02]
 [-7.23286958e-01 -9.67922309e-01  2.53960333e-01]
 [-1.71420701e-02 -1.82283212e-02 -1.06701402e-02]
 [-3.55764510e-02  1.33137105e-02 -4.98823563e-02]
 [ 1.08752354e-01  2.09611448e-02  4.26787104e-02]
 [ 7.09471338e-03 -4.23930720e-03 -2.07229400e-02]
 [ 4.37746377e-03 -9.36273741e-02  1.73230299e-01]
 [ 6.76870266e-03  4.44777029e-03  4.37232688e-03]
 [ 7.14308134e-02 -6.10761370e-01 -4.71292626e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.27118322 -49.27387164 -49.25707411]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [   7.3268874   -15.90307369 -140.51672192]
init_Out:  [2.48374395]
Stock Position:  7.326887399052493
Bond position:  [-730.20499595]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-0.47402583]
curr_Stock_Price:  99.62123128616875
curr_Factors:  [99.62123129 -1.290947   -0.99380636]
mat_Sqrt:  [[10.14135829  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00662015  0.0307293  -0.08419485]
Stock Position:  0.006620153464572827
Bond Position:  [-1.13353367]


portfolio before change:  [-0.47461748]
curr_Stock_Price:  99.57467296305728
curr_Factors:  [99.57467296 -1.11673603 -1.00740966]
mat_Sqrt:  [[11.90266295  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.24403825 -0.93603124 -2.35723178]
Stock Position:  -0.24403824965991713
Bond Position:  [23.82541142]


portfolio before change:  [-0.59677431]
curr_Stock_Price:  100.09964776762209
curr_Factors:  [100.09964777  -1.05280781  -1.08701025]
mat_Sqrt:  [[11.77935132  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00795757  0.06137364 -0.19033553]
Stock Position:  0.00795757182393634
Bond Position:  [-1.39332445]


portfolio before change:  [-0.58836218]
curr_Stock_Price:  101.20055002120037
curr_Factors:  [101.20055002  -1.15802668  -1.08321354]
mat_Sqrt:  [[10.76030576  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.03388021  0.04694673 -1.25381245]
Stock Position:  0.033880214247172566
Bond Position:  [-4.01705849]


portfolio before change:  [-0.59482132]
curr_Stock_Price:  101.0395489126165
curr_Factors:  [101.03954891  -0.93408738  -1.08979503]
mat_Sqrt:  [[13.35151147  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00735974  0.03782379 -0.01922552]
Stock Position:  0.007359744576995844
Bond Position:  [-1.33844659]


portfolio before change:  [-0.59156853]
curr_Stock_Price:  101.52699015889615
curr_Factors:  [101.52699016  -0.71172969  -1.09176723]
mat_Sqrt:  [[16.72371464  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.0028198  0.01033521 0.30924341]
Stock Position:  0.0028198042863951996
Bond Position:  [-0.87785477]


portfolio before change:  [-0.58955492]
curr_Stock_Price:  102.31892606013571
curr_Factors:  [102.31892606  -0.57943926  -1.06914764]
mat_Sqrt:  [[19.67812789  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.0115213  0.10888335 0.69340371]
Stock Position:  0.011521295756275411
Bond Position:  [-1.76840153]


portfolio before change:  [-0.59378559]
curr_Stock_Price:  101.99009875269023
curr_Factors:  [101.99009875  -0.45920131  -1.04858447]
mat_Sqrt:  [[22.5805736   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00168501 -0.00982729 -0.08419731]
Stock Position:  0.0016850085802517652
Bond Position:  [-0.76563978]


portfolio before change:  [-0.59445547]
curr_Stock_Price:  101.70615860555114
curr_Factors:  [101.70615861  -0.49607942  -1.06550865]
mat_Sqrt:  [[21.33821904  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.06332022 -0.16414059 -0.13410757]
Stock Position:  -0.06332022404105025
Bond Position:  [5.84560128]


portfolio before change:  [-0.62940075]
curr_Stock_Price:  102.2811229781277
curr_Factors:  [102.28112298  -0.85141263  -1.06721886]
mat_Sqrt:  [[15.01565974  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.02714675 0.03718954 0.20397236]
Stock Position:  0.027146751437777266
Bond Position:  [-3.40600098]


portfolio before change:  [-0.61011211]
curr_Stock_Price:  103.02302587246946
curr_Factors:  [103.02302587  -0.56419198  -1.044396  ]
mat_Sqrt:  [[20.62212517  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01042123  0.00342095  0.07645077]
Stock Position:  -0.010421225987598344
Bond Position:  [0.46351413]


portfolio before change:  [-0.60447189]
curr_Stock_Price:  102.49292282662432
curr_Factors:  [102.49292283  -0.57917074  -1.08300412]
mat_Sqrt:  [[19.44556245  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.04469008 -0.31239558  0.72447814]
Stock Position:  -0.044690084895720975
Bond Position:  [3.97594553]


portfolio before change:  [-0.63862492]
curr_Stock_Price:  103.27938669999112
curr_Factors:  [103.2793867   -1.12690221  -1.06616443]
mat_Sqrt:  [[11.52330109  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00199951 -0.00588317 -0.03043894]
Stock Position:  -0.0019995089649835827
Bond Position:  [-0.43211686]


portfolio before change:  [-0.6405087]
curr_Stock_Price:  104.16747352325402
curr_Factors:  [104.16747352  -0.93169681  -1.04273584]
mat_Sqrt:  [[14.4626183   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00297602  0.00429698 -0.14230048]
Stock Position:  -0.0029760167662531384
Bond Position:  [-0.33050455]


portfolio before change:  [-0.63830876]
curr_Stock_Price:  103.40048345485262
curr_Factors:  [103.40048345  -1.20608079  -1.02150821]
mat_Sqrt:  [[11.14533074  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01092321 0.00676518 0.12175048]
Stock Position:  0.010923209756660545
Bond Position:  [-1.76777393]


portfolio before change:  [-0.63841151]
curr_Stock_Price:  103.43154074285715
curr_Factors:  [103.43154074  -1.23646697  -1.02142543]
mat_Sqrt:  [[10.81590297  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00018485 -0.00136823 -0.05911678]
Stock Position:  0.00018484966286063225
Bond Position:  [-0.6575308]


portfolio before change:  [-0.63850806]
curr_Stock_Price:  103.79861056087731
curr_Factors:  [103.79861056  -1.27041693  -1.0030784 ]
mat_Sqrt:  [[10.68624344  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00193018 -0.03021811  0.49417782]
Stock Position:  0.0019301771337571078
Bond Position:  [-0.83885777]


portfolio before change:  [-0.64002584]
curr_Stock_Price:  103.12093618503397
curr_Factors:  [103.12093619  -1.12449589  -0.99854146]
mat_Sqrt:  [[12.3402354   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.0006944  0.00143551 0.01247303]
Stock Position:  0.0006944030789139645
Bond Position:  [-0.71163333]


portfolio before change:  [-0.64076749]
curr_Stock_Price:  102.30911973208735
curr_Factors:  [102.30911973  -0.98680423  -0.96956767]
mat_Sqrt:  [[14.46348098  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0103324  -0.19712238 -1.34446668]
Stock Position:  -0.01033240434316864
Bond Position:  [0.4163317]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-0.64614304]
Stock Price:  102.83945568480227
PL:  [-3.48559873]
Settle:  Tensor("sub_234:0", shape=(), dtype=float64)
PL:  Tensor("sub_235:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  118
output_Z_Vals[:, i, :]:  [[ 1.19271183e+02 -4.92738716e+01 -4.92570741e+01]
 [ 2.07196562e-02  4.21813535e-02 -4.48313640e-02]
 [-2.51279183e+00 -3.43467518e+00 -9.82682059e-01]
 [-8.96020047e-02 -1.07043586e-03 -1.21329356e-01]
 [ 8.22880411e-01 -9.02426471e-03 -4.98348430e-01]
 [ 7.57175145e-02  1.17192732e-01 -6.73936232e-03]
 [-1.22490247e-02  3.02716027e-02  2.41977416e-03]
 [ 8.59244116e-02  1.93747727e-01  6.38360359e-02]
 [-2.12903235e-03 -1.65413659e-01  1.59438639e-02]
 [-1.06181313e+00 -4.21817786e-01 -3.83633515e-02]
 [ 5.05279776e-01  1.44835224e-01  7.82655304e-02]
 [-7.04939241e-02 -2.33265613e-02  3.25200217e-02]
 [-7.54831143e-01 -1.12333532e+00  2.67138329e-01]
 [-2.17615134e-02 -2.17379611e-02 -1.62164299e-02]
 [ 1.06473628e-01  1.17921570e-01 -1.05316457e-01]
 [ 1.02255749e-01  2.27097855e-02  4.57545927e-02]
 [ 4.41381943e-02  3.20378273e-02  1.53737287e-02]
 [ 5.84531610e-02 -5.28020063e-02  6.87850220e-02]
 [-1.06353299e-03  1.73694092e-02 -1.36652710e-02]
 [ 1.01244827e-01 -8.06163980e-01 -5.86385606e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.27118322 -49.27387164 -49.25707411]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [   7.3268874   -15.90307369 -140.51672192]
init_Out:  [2.48374395]
Stock Position:  7.326887399052493
Bond position:  [-730.20499595]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [1.58749885]
curr_Stock_Price:  99.90259560485094
curr_Factors:  [99.9025956  -0.72483238 -0.98789997]
mat_Sqrt:  [[18.01965872  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00111982  0.01361397 -0.1278914 ]
Stock Position:  0.0011198172701806651
Bond Position:  [1.47562619]


portfolio before change:  [1.58707802]
curr_Stock_Price:  99.19732162974375
curr_Factors:  [99.19732163 -0.47892765 -0.9743302 ]
mat_Sqrt:  [[23.19306157  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.14721994 -1.10853665 -2.80331839]
Stock Position:  -0.1472199385949226
Bond Position:  [16.19090162]


portfolio before change:  [1.90570583]
curr_Stock_Price:  97.06052152911401
curr_Factors:  [97.06052153 -0.30283121 -0.95679619]
mat_Sqrt:  [[27.54186793  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-4.16045701e-03 -3.45481688e-04 -3.46118881e-01]
Stock Position:  -0.004160457013251633
Bond Position:  [2.30952196]


portfolio before change:  [1.8889296]
curr_Stock_Price:  101.23162242511857
curr_Factors:  [101.23162243  -0.78395987  -0.98342964]
mat_Sqrt:  [[17.28815656  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.04160729 -0.00291257 -1.42164936]
Stock Position:  0.04160729288605778
Bond Position:  [-2.32304416]


portfolio before change:  [1.87502152]
curr_Stock_Price:  100.91131204801151
curr_Factors:  [100.91131205  -0.89826631  -0.98584025]
mat_Sqrt:  [[15.33496442  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00640782  0.03782379 -0.01922552]
Stock Position:  0.006407821462938956
Bond Position:  [1.22839985]


portfolio before change:  [1.86054764]
curr_Stock_Price:  98.6045974203771
curr_Factors:  [98.60459742 -0.83323829 -0.97807012]
mat_Sqrt:  [[16.11595018  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00034599  0.00977012  0.00690294]
Stock Position:  -0.00034598799638664004
Bond Position:  [1.89466365]


portfolio before change:  [1.86072318]
curr_Stock_Price:  99.46642788610232
curr_Factors:  [99.46642789 -0.98620713 -0.95960495]
mat_Sqrt:  [[14.21088326  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.0097463  0.06253181 0.18210644]
Stock Position:  0.009746296165942223
Bond Position:  [0.89129392]


portfolio before change:  [1.88378271]
curr_Stock_Price:  101.8095411651436
curr_Factors:  [101.80954117  -1.33715358  -0.93788325]
mat_Sqrt:  [[10.46532068  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00311882 -0.05338703  0.04548341]
Stock Position:  -0.0031188176164536306
Bond Position:  [2.2013081]


portfolio before change:  [1.88602111]
curr_Stock_Price:  101.26830960417446
curr_Factors:  [101.2683096   -1.46563373  -0.86902086]
mat_Sqrt:  [[ 9.80722087  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.11784656 -0.1361411  -0.10943996]
Stock Position:  -0.11784655726181635
Bond Position:  [13.82014275]


portfolio before change:  [1.79983977]
curr_Stock_Price:  102.0289326396457
curr_Factors:  [102.02893264  -1.6359029   -0.83364224]
mat_Sqrt:  [[ 8.63402928  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.0637964  0.04674537 0.22326977]
Stock Position:  0.06379640477854592
Bond Position:  [-4.70923932]


portfolio before change:  [1.83339851]
curr_Stock_Price:  102.57341783974147
curr_Factors:  [102.57341784  -1.50583835  -0.83273797]
mat_Sqrt:  [[ 9.89473192  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00693473 -0.00752862  0.09277057]
Stock Position:  -0.006934732282431253
Bond Position:  [2.5447177]


portfolio before change:  [1.83281251]
curr_Stock_Price:  102.74967030882493
curr_Factors:  [102.74967031  -1.38305523  -0.80316604]
mat_Sqrt:  [[11.54294428  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.08053419 -0.36255491  0.7620713 ]
Stock Position:  -0.08053418591632733
Bond Position:  [10.10767356]


portfolio before change:  [1.80868188]
curr_Stock_Price:  103.08068322143826
curr_Factors:  [103.08068322  -1.22353398  -0.81694516]
mat_Sqrt:  [[13.39702784  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00220265 -0.0070159  -0.04626096]
Stock Position:  -0.0022026468385447275
Bond Position:  [2.03573223]


portfolio before change:  [1.81116646]
curr_Stock_Price:  102.18377418133231
curr_Factors:  [102.18377418  -1.43984244  -0.78389157]
mat_Sqrt:  [[11.05672546  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00986247  0.03805902 -0.30043854]
Stock Position:  0.009862471143797987
Bond Position:  [0.80338193]


portfolio before change:  [1.80822789]
curr_Stock_Price:  101.86545246620013
curr_Factors:  [101.86545247  -1.32858022  -0.78608179]
mat_Sqrt:  [[12.29251872  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00945542 0.00732955 0.13052512]
Stock Position:  0.00945542440412535
Bond Position:  [0.8450468]


portfolio before change:  [1.81266888]
curr_Stock_Price:  102.31278298324101
curr_Factors:  [102.31278298  -1.3945091   -0.73950037]
mat_Sqrt:  [[12.10992249  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00444396 0.01034016 0.04385697]
Stock Position:  0.004443962192106983
Bond Position:  [1.35799474]


portfolio before change:  [1.81343823]
curr_Stock_Price:  102.40950176019854
curr_Factors:  [102.40950176  -1.58974199  -0.71362624]
mat_Sqrt:  [[10.23293327  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00603108 -0.01704177  0.19622452]
Stock Position:  0.006031084030466638
Bond Position:  [1.19579792]


portfolio before change:  [1.81592597]
curr_Stock_Price:  102.77241404755085
curr_Factors:  [102.77241405  -1.88228801  -0.70020769]
mat_Sqrt:  [[ 7.76806635  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-3.95759941e-05  5.60595270e-03 -3.89832145e-02]
Stock Position:  -3.957599408516328e-05
Bond Position:  [1.81999329]


portfolio before change:  [1.81639283]
curr_Stock_Price:  102.47406770635834
curr_Factors:  [102.47406771  -1.65933696  -0.65068712]
mat_Sqrt:  [[10.17145928  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01799232 -0.26018831 -1.67279492]
Stock Position:  -0.017992321619804436
Bond Position:  [3.66013922]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [1.80902397]
Stock Price:  102.93448722614244
PL:  [-1.12546326]
Settle:  Tensor("sub_236:0", shape=(), dtype=float64)
PL:  Tensor("sub_237:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  119
output_Z_Vals[:, i, :]:  [[ 1.19271183e+02 -4.92738716e+01 -4.92570741e+01]
 [ 1.73795387e-02  3.68150789e-02 -4.63813934e-02]
 [-2.67740594e+00 -3.29181363e+00 -9.77399602e-01]
 [ 4.90896648e-02  1.45660305e-01 -7.75566517e-02]
 [ 6.52788530e-01 -1.22406758e-01 -3.07988627e-01]
 [ 5.69018553e-02  8.87622542e-02 -2.88984731e-03]
 [ 1.40657813e-02  3.45047191e-02  1.04700353e-01]
 [ 1.26801083e-01  3.80355451e-01  2.73085887e-01]
 [ 1.01363476e-01  1.01059598e-01 -7.38090859e-02]
 [-1.23925644e+00 -5.02997436e-01 -4.72197101e-02]
 [ 4.16008332e-01  1.20555510e-01  7.83411876e-02]
 [ 2.13788060e-03 -4.82817717e-02  3.55593630e-02]
 [-6.97842903e-01 -1.12016691e+00  2.46077400e-01]
 [-8.16174104e-03  6.23331174e-03  1.80854068e-02]
 [ 6.06649298e-02  1.15568157e-01 -9.96266052e-02]
 [ 8.18765850e-02  2.81950864e-02  5.54033095e-02]
 [ 2.78923453e-02  1.61280684e-02 -4.56884797e-04]
 [-4.15635152e-02 -1.33855098e-01  2.45330143e-01]
 [ 5.78610458e-02 -7.79012324e-02  9.27220718e-02]
 [ 7.53337931e-02 -6.73274419e-01 -3.48031361e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.27118322 -49.27387164 -49.25707411]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [   7.3268874   -15.90307369 -140.51672192]
init_Out:  [2.48374395]
Stock Position:  7.326887399052493
Bond position:  [-730.20499595]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [1.47300878]
curr_Stock_Price:  99.88696958855625
curr_Factors:  [99.88696959 -0.6625862  -1.01448764]
mat_Sqrt:  [[18.67088586  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00082625  0.01188202 -0.13231321]
Stock Position:  0.0008262501854390563
Bond Position:  [1.39047716]


portfolio before change:  [1.47210098]
curr_Stock_Price:  98.36748804434315
curr_Factors:  [98.36748804 -0.52555246 -0.95542861]
mat_Sqrt:  [[22.37019008  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.15864217 -1.06242828 -2.78824901]
Stock Position:  -0.15864216739611314
Bond Position:  [17.07733248]


portfolio before change:  [1.2749975]
curr_Stock_Price:  99.63684377739158
curr_Factors:  [99.63684378 -0.75780961 -0.95333232]
mat_Sqrt:  [[18.00032975  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00349945  0.04701166 -0.22124754]
Stock Position:  0.0034994506045402138
Bond Position:  [0.92632328]


portfolio before change:  [1.27352096]
curr_Stock_Price:  99.14872373265082
curr_Factors:  [99.14872373 -0.77261899 -0.97151305]
mat_Sqrt:  [[17.33086365  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.03259702 -0.03950661 -0.87860583]
Stock Position:  0.03259701601815567
Bond Position:  [-1.95843158]


portfolio before change:  [1.27945552]
curr_Stock_Price:  99.34580414082585
curr_Factors:  [99.34580414 -0.49659594 -0.99884547]
mat_Sqrt:  [[22.26832637  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00334244  0.02864789 -0.00824393]
Stock Position:  0.003342437401281086
Bond Position:  [0.94739839]


portfolio before change:  [1.28537197]
curr_Stock_Price:  101.04503400887128
curr_Factors:  [101.04503401  -0.48376862  -0.95231172]
mat_Sqrt:  [[24.0343958   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.0017675  0.01113635 0.29868096]
Stock Position:  0.0017675042865841768
Bond Position:  [1.10677444]


portfolio before change:  [1.28723334]
curr_Stock_Price:  101.94157693291349
curr_Factors:  [101.94157693  -0.34993658  -0.96835235]
mat_Sqrt:  [[27.27883001  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00953795 0.12275919 0.77903802]
Stock Position:  0.00953795443177384
Bond Position:  [0.31491922]


portfolio before change:  [1.27803957]
curr_Stock_Price:  100.9694069461475
curr_Factors:  [100.96940695  -0.45822756  -0.92842598]
mat_Sqrt:  [[25.23328676  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0042375   0.03261685 -0.21055678]
Stock Position:  0.004237496465068374
Bond Position:  [0.85018206]


portfolio before change:  [1.28534731]
curr_Stock_Price:  102.64378414738891
curr_Factors:  [102.64378415  -0.910089    -0.92123637]
mat_Sqrt:  [[16.44364737  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.08219399 -0.16234172 -0.13470469]
Stock Position:  -0.08219399360131578
Bond Position:  [9.72204984]


portfolio before change:  [1.30220796]
curr_Stock_Price:  102.46822589596187
curr_Factors:  [102.4682259   -1.01872501  -0.91595957]
mat_Sqrt:  [[14.80356723  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.03084445 0.03890912 0.2234856 ]
Stock Position:  0.030844454095805874
Bond Position:  [-1.85836853]


portfolio before change:  [1.26677084]
curr_Stock_Price:  101.33439280103092
curr_Factors:  [101.3343928   -1.32102593  -0.90744479]
mat_Sqrt:  [[10.91300441  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-4.20663447e-05 -1.55828748e-02  1.01440965e-01]
Stock Position:  -4.2066344686323605e-05
Bond Position:  [1.27103361]


portfolio before change:  [1.26707922]
curr_Stock_Price:  101.55824106486172
curr_Factors:  [101.55824106  -1.26160444  -0.95946183]
mat_Sqrt:  [[11.01839529  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.07952752 -0.36153232  0.70199033]
Stock Position:  -0.07952752234530051
Bond Position:  [9.34375451]


portfolio before change:  [1.24022157]
curr_Stock_Price:  101.92533265122485
curr_Factors:  [101.92533265  -0.80295617  -0.95472044]
mat_Sqrt:  [[17.57651972  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00018193  0.00201179  0.05159263]
Stock Position:  -0.00018193040800040062
Bond Position:  [1.25876489]


portfolio before change:  [1.240384]
curr_Stock_Price:  102.76247044679195
curr_Factors:  [102.76247045  -0.96491244  -0.90504654]
mat_Sqrt:  [[15.83877785  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0040356   0.03729946 -0.28420697]
Stock Position:  0.004035600858331638
Bond Position:  [0.82567569]


portfolio before change:  [1.24231368]
curr_Stock_Price:  103.18947920318513
curr_Factors:  [103.1894792   -0.9804143   -0.94962534]
mat_Sqrt:  [[14.97717329  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00660612 0.00909993 0.15805022]
Stock Position:  0.006606122140456854
Bond Position:  [0.56063138]


portfolio before change:  [1.24262311]
curr_Stock_Price:  103.21509928591932
curr_Factors:  [103.21509929  -0.94233144  -0.96629483]
mat_Sqrt:  [[15.30514258  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00203142  0.00520531 -0.00130337]
Stock Position:  0.002031422583429876
Bond Position:  [1.03294962]


portfolio before change:  [1.24701857]
curr_Stock_Price:  105.25169971877435
curr_Factors:  [105.25169972  -0.7588482   -1.0139204 ]
mat_Sqrt:  [[17.87827021  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00105205 -0.04320155  0.69985861]
Stock Position:  -0.001052046240609394
Bond Position:  [1.35774823]


portfolio before change:  [1.24677843]
curr_Stock_Price:  105.80265118508217
curr_Factors:  [105.80265119  -1.17513636  -1.02528799]
mat_Sqrt:  [[11.71829414  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00519584 -0.02514251  0.26451026]
Stock Position:  0.005195836202947429
Bond Position:  [0.69704518]


portfolio before change:  [1.24345712]
curr_Stock_Price:  105.12988419143181
curr_Factors:  [105.12988419  -0.96591959  -0.96541038]
mat_Sqrt:  [[15.23913223  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00873668 -0.21729838 -0.9928366 ]
Stock Position:  -0.008736677011120854
Bond Position:  [2.16194296]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [1.23900255]
Stock Price:  105.70162623782926
PL:  [-4.46262369]
Settle:  Tensor("sub_238:0", shape=(), dtype=float64)
PL:  Tensor("sub_239:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  120
output_Z_Vals[:, i, :]:  [[ 1.19271183e+02 -4.92738716e+01 -4.92570741e+01]
 [ 2.05482371e-02  4.19059495e-02 -4.49109134e-02]
 [-2.66911648e+00 -2.86740780e+00 -8.93573099e-01]
 [-4.57627213e-02  9.14210903e-04 -1.34269524e-01]
 [ 4.58813177e-01 -1.16194533e-01 -2.11102008e-01]
 [ 3.00791269e-02  4.82330881e-02  2.59784216e-03]
 [-3.45828075e-03  2.74765514e-02  3.56103591e-02]
 [ 1.02246247e-01  2.54766883e-01  1.21755395e-01]
 [ 7.26085730e-02  1.43619849e-01 -7.63327711e-02]
 [-1.02510713e+00 -4.20552747e-01 -3.62012443e-02]
 [ 3.95316942e-01  7.33435701e-02 -7.15988072e-03]
 [-5.59875278e-02 -2.46323980e-02  3.29981608e-02]
 [-7.18144971e-01 -1.08762966e+00  2.53515410e-01]
 [-7.87522936e-03  1.02525737e-02  3.04960252e-02]
 [ 5.81959578e-02  8.16299598e-02 -7.84487825e-02]
 [ 5.69184820e-02  3.49128646e-02  6.72199703e-02]
 [ 1.25625955e-01  1.13015576e-01  9.77005665e-02]
 [ 9.62802711e-02 -1.65903179e-02  1.75999646e-02]
 [-5.73756727e-02 -2.39886208e-01  6.44317391e-02]
 [ 3.50350508e-02 -2.99171156e-01 -3.01907214e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.27118322 -49.27387164 -49.25707411]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [   7.3268874   -15.90307369 -140.51672192]
init_Out:  [2.48374395]
Stock Position:  7.326887399052493
Bond position:  [-730.20499595]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [3.70881963]
curr_Stock_Price:  100.19212111145252
curr_Factors:  [100.19212111  -0.95582291  -1.02698176]
mat_Sqrt:  [[13.79470578  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00144511  0.01352509 -0.12811834]
Stock Position:  0.0014451088507397053
Bond Position:  [3.56403111]


portfolio before change:  [3.70594076]
curr_Stock_Price:  97.58332623157659
curr_Factors:  [97.58332623 -0.83579094 -1.02202482]
mat_Sqrt:  [[15.22427024  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.22574635 -0.92545189 -2.54911533]
Stock Position:  -0.22574635379137312
Bond Position:  [25.73502085]


portfolio before change:  [3.61918218]
curr_Stock_Price:  97.99614855539875
curr_Factors:  [97.99614856 -0.97374959 -1.02106362]
mat_Sqrt:  [[13.33130427  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-5.47461517e-03  2.95060300e-04 -3.83033579e-01]
Stock Position:  -0.005474615169512664
Bond Position:  [4.15567339]


portfolio before change:  [3.61654937]
curr_Stock_Price:  98.66685459466494
curr_Factors:  [98.66685459 -0.81537477 -1.02745644]
mat_Sqrt:  [[15.62571342  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.02508711 -0.03750162 -0.60221527]
Stock Position:  0.025087113792757333
Bond Position:  [1.14128277]


portfolio before change:  [3.65041663]
curr_Stock_Price:  100.00546624925487
curr_Factors:  [100.00546625  -0.9361942   -0.99288329]
mat_Sqrt:  [[14.52901036  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00278443 0.01556716 0.00741092]
Stock Position:  0.0027844255134711377
Bond Position:  [3.37195886]


portfolio before change:  [3.64967458]
curr_Stock_Price:  99.4361762497009
curr_Factors:  [99.43617625 -0.89206357 -1.01096422]
mat_Sqrt:  [[14.82756885  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00063525 0.00886802 0.10158644]
Stock Position:  0.0006352545743151396
Bond Position:  [3.5865073]


portfolio before change:  [3.64951693]
curr_Stock_Price:  97.77638584324234
curr_Factors:  [97.77638584 -0.66320614 -1.01108465]
mat_Sqrt:  [[18.32731009  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00977249 0.08222566 0.34733425]
Stock Position:  0.009772494384559672
Bond Position:  [2.69399775]


portfolio before change:  [3.65641979]
curr_Stock_Price:  98.41381455585973
curr_Factors:  [98.41381456 -0.83360277 -1.04373743]
mat_Sqrt:  [[15.05696971  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00573445  0.04635311 -0.21775615]
Stock Position:  0.005734453343175772
Bond Position:  [3.09207036]


portfolio before change:  [3.66262576]
curr_Stock_Price:  99.36122085663212
curr_Factors:  [99.36122086 -0.59389352 -1.04491586]
mat_Sqrt:  [[19.2970555   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.057954   -0.13573282 -0.10327207]
Stock Position:  -0.05795400461403642
Bond Position:  [9.42100641]


portfolio before change:  [3.56361493]
curr_Stock_Price:  101.11030396160463
curr_Factors:  [101.11030396  -0.88584747  -1.07152619]
mat_Sqrt:  [[14.27969194  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.02862993  0.02367154 -0.02042515]
Stock Position:  0.028629933541165456
Bond Position:  [0.66883365]


portfolio before change:  [3.5968969]
curr_Stock_Price:  102.26695127005037
curr_Factors:  [102.26695127  -1.25714447  -1.08782767]
mat_Sqrt:  [[ 9.80227425  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00553748 -0.00795007  0.09413457]
Stock Position:  -0.005537477552116143
Bond Position:  [4.16319784]


portfolio before change:  [3.59918915]
curr_Stock_Price:  102.04097701952209
curr_Factors:  [102.04097702  -1.19169995  -1.08853081]
mat_Sqrt:  [[10.43477212  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.08513917 -0.35103096  0.7232089 ]
Stock Position:  -0.08513916926699085
Bond Position:  [12.28687317]


portfolio before change:  [3.62651922]
curr_Stock_Price:  101.75605569436229
curr_Factors:  [101.75605569  -1.07113589  -1.09962867]
mat_Sqrt:  [[11.60938446  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [3.81194675e-05 3.30900392e-03 8.69966715e-02]
Stock Position:  3.811946750828605e-05
Bond Position:  [3.62264033]


portfolio before change:  [3.62740823]
curr_Stock_Price:  101.31634270536405
curr_Factors:  [101.31634271  -0.50693225  -1.13597042]
mat_Sqrt:  [[19.59638404  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00300287  0.02634596 -0.22379254]
Stock Position:  0.0030028658750914533
Bond Position:  [3.32316884]


portfolio before change:  [3.62983855]
curr_Stock_Price:  101.84897530552686
curr_Factors:  [101.84897531  -0.20012312  -1.14216077]
mat_Sqrt:  [[26.60787426  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00292268 0.01126808 0.19175986]
Stock Position:  0.0029226784113162985
Bond Position:  [3.33216675]


portfolio before change:  [3.62898826]
curr_Stock_Price:  101.27298360662996
curr_Factors:  [101.27298361  -0.23177844  -1.15589413]
mat_Sqrt:  [[25.2833762   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00666992 0.03647562 0.27871252]
Stock Position:  0.006669924396102934
Bond Position:  [2.95350512]


portfolio before change:  [3.62422061]
curr_Stock_Price:  100.4474695579769
curr_Factors:  [100.44746956  -0.27656686  -1.19850066]
mat_Sqrt:  [[22.97869262  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00419895 -0.0053545   0.0502078 ]
Stock Position:  0.004198949258655388
Bond Position:  [3.20244679]


portfolio before change:  [3.61189782]
curr_Stock_Price:  97.32204263445117
curr_Factors:  [97.32204263 -0.19356347 -1.17538943]
mat_Sqrt:  [[24.75611699  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00376433 -0.07742294  0.18380582]
Stock Position:  -0.0037643288817368046
Bond Position:  [3.97824999]


portfolio before change:  [3.61144423]
curr_Stock_Price:  97.70677891037691
curr_Factors:  [ 9.77067789e+01 -2.73819108e-02 -1.16017182e+00]
mat_Sqrt:  [[29.79728275  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00294186 -0.09655708 -0.86125725]
Stock Position:  -0.002941864141995917
Bond Position:  [3.8988843]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [3.61162957]
Stock Price:  97.97514726749965
PL:  [3.61162957]
Settle:  Tensor("sub_240:0", shape=(), dtype=float64)
PL:  Tensor("sub_241:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  121
output_Z_Vals[:, i, :]:  [[ 1.19271183e+02 -4.92738716e+01 -4.92570741e+01]
 [ 8.11292419e-02  1.30055877e-01 -4.27807937e-02]
 [-2.41369396e+00 -3.26516924e+00 -9.37696843e-01]
 [ 1.41700935e-02  9.64883395e-02 -9.53126566e-02]
 [ 7.79343915e-01 -3.41795450e-02 -4.59588718e-01]
 [ 7.57175145e-02  1.17192732e-01 -6.73936232e-03]
 [ 1.32732315e-02  3.34949883e-02  1.02731168e-01]
 [ 1.21572983e-01  3.44334628e-01  2.24466718e-01]
 [ 9.43296579e-02  1.04019069e-01 -7.07189313e-02]
 [-9.79717997e-01 -4.01605202e-01 -3.38971898e-02]
 [ 1.17446396e-01 -1.44646410e-02 -1.70720077e-01]
 [-1.92547945e-02 -3.34517902e-02  2.70258822e-02]
 [-5.81579272e-01 -1.28889464e+00  2.06213122e-01]
 [ 1.10994107e-02  2.75761442e-02  6.80560040e-02]
 [ 8.64352321e-02  1.26680252e-01 -1.03773267e-01]
 [ 6.24724847e-02  3.34179370e-02  6.45903728e-02]
 [ 5.73697091e-02  4.49956117e-02  2.82670528e-02]
 [ 5.35864903e-03 -9.47573296e-02  1.65546201e-01]
 [ 5.52632178e-02 -5.73647372e-02  7.67108696e-02]
 [ 7.48853708e-02 -6.89929429e-01 -2.73199827e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.27118322 -49.27387164 -49.25707411]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [   7.3268874   -15.90307369 -140.51672192]
init_Out:  [2.48374395]
Stock Position:  7.326887399052493
Bond position:  [-730.20499595]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-7.23990494]
curr_Stock_Price:  98.6977997202658
curr_Factors:  [98.69779972 -0.75323973 -1.00969453]
mat_Sqrt:  [[16.93069752  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00584407  0.04197535 -0.1220417 ]
Stock Position:  0.005844070719199326
Bond Position:  [-7.81670186]


portfolio before change:  [-7.23950543]
curr_Stock_Price:  99.10058958793437
curr_Factors:  [99.10058959 -0.65448556 -1.00118521]
mat_Sqrt:  [[18.924637    0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.1728752  -1.05382884 -2.67498809]
Stock Position:  -0.17287520016464855
Bond Position:  [9.89252884]


portfolio before change:  [-7.2635424]
curr_Stock_Price:  99.2539396311906
curr_Factors:  [99.25393963 -0.76495496 -0.96564131]
mat_Sqrt:  [[17.58568708  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00081942  0.03114148 -0.27190048]
Stock Position:  0.0008194208575655411
Bond Position:  [-7.34487315]


portfolio before change:  [-7.26425692]
curr_Stock_Price:  100.62311317969726
curr_Factors:  [100.62311318  -0.75344722  -0.9872362 ]
mat_Sqrt:  [[17.64934307  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.03844641 -0.0110314  -1.31107869]
Stock Position:  0.0384464106112591
Bond Position:  [-11.13285445]


portfolio before change:  [-7.2519507]
curr_Stock_Price:  101.01560202197473
curr_Factors:  [101.01560202  -0.63468222  -0.94878298]
mat_Sqrt:  [[20.73472397  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00473909  0.03782379 -0.01922552]
Stock Position:  0.004739089572800127
Bond Position:  [-7.73067268]


portfolio before change:  [-7.25480761]
curr_Stock_Price:  100.82062817588151
curr_Factors:  [100.82062818  -0.43788095  -0.94820816]
mat_Sqrt:  [[25.21033091  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.0016295  0.01081046 0.29306343]
Stock Position:  0.0016295017886052388
Bond Position:  [-7.419095]


portfolio before change:  [-7.25597438]
curr_Stock_Price:  101.2429855582928
curr_Factors:  [101.24298556  -0.52717088  -0.99883949]
mat_Sqrt:  [[22.01035575  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01079851 0.11113352 0.64034107]
Stock Position:  0.01079851113876165
Bond Position:  [-8.34924789]


portfolio before change:  [-7.27356959]
curr_Stock_Price:  99.80689560828006
curr_Factors:  [99.80689561 -0.56599989 -1.00316646]
mat_Sqrt:  [[20.78166122  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00486617  0.03357201 -0.20174143]
Stock Position:  0.004866166328558271
Bond Position:  [-7.75924654]


portfolio before change:  [-7.27867216]
curr_Stock_Price:  99.15699576218373
curr_Factors:  [99.15699576 -0.73323362 -0.99904948]
mat_Sqrt:  [[17.53890061  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.06092825 -0.12961752 -0.09669925]
Stock Position:  -0.060928251656050446
Bond Position:  [-1.23720977]


portfolio before change:  [-7.24962999]
curr_Stock_Price:  98.6752568308743
curr_Factors:  [98.67525683 -0.70363229 -1.003048  ]
mat_Sqrt:  [[17.90632381  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00444791 -0.00466844 -0.48701686]
Stock Position:  0.004447910410197222
Bond Position:  [-7.68852869]


portfolio before change:  [-7.25653854]
curr_Stock_Price:  97.55424109065336
curr_Factors:  [97.55424109 -0.70409176 -1.02010096]
mat_Sqrt:  [[17.39557418  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00118228 -0.01079652  0.07709732]
Stock Position:  -0.0011822821868511663
Bond Position:  [-7.1412019]


portfolio before change:  [-7.25960806]
curr_Stock_Price:  98.64027678309571
curr_Factors:  [98.64027678 -0.77191119 -0.9802248 ]
mat_Sqrt:  [[17.10453563  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0469221  -0.41598895  0.58826864]
Stock Position:  -0.04692209877988679
Bond Position:  [-2.63119925]


portfolio before change:  [-7.33000724]
curr_Stock_Price:  100.12659751983054
curr_Factors:  [100.12659752  -1.18951142  -0.93660298]
mat_Sqrt:  [[11.94509771  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00256341 0.00890016 0.19414484]
Stock Position:  0.0025634148804035083
Bond Position:  [-7.58667325]


portfolio before change:  [-7.32615347]
curr_Stock_Price:  102.36996024833782
curr_Factors:  [102.36996025  -1.00695384  -0.98117298]
mat_Sqrt:  [[14.0197423   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00649877  0.04088588 -0.29603625]
Stock Position:  0.00649877143168937
Bond Position:  [-7.99143244]


portfolio before change:  [-7.32962332]
curr_Stock_Price:  102.1434955113077
curr_Factors:  [102.14349551  -0.53722175  -0.96654614]
mat_Sqrt:  [[22.70558102  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00363251 0.01078559 0.18425836]
Stock Position:  0.003632514275254744
Bond Position:  [-7.70066103]


portfolio before change:  [-7.32810295]
curr_Stock_Price:  103.09208972070303
curr_Factors:  [103.09208972  -0.34724093  -0.96868599]
mat_Sqrt:  [[27.65193597  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00261553 0.01452227 0.08063803]
Stock Position:  0.002615527100422078
Bond Position:  [-7.5977431]


portfolio before change:  [-7.32832811]
curr_Stock_Price:  103.73230922252984
curr_Factors:  [103.73230922  -0.54079044  -0.95012674]
mat_Sqrt:  [[23.35699363  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00084807 -0.0305828   0.47225723]
Stock Position:  0.0008480700572421836
Bond Position:  [-7.41630037]


portfolio before change:  [-7.32788403]
curr_Stock_Price:  106.4424475487424
curr_Factors:  [106.44244755  -0.61396544  -0.99527978]
mat_Sqrt:  [[21.292592    0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00278088 -0.01851439  0.21883476]
Stock Position:  0.002780884099866423
Bond Position:  [-7.62388814]


portfolio before change:  [-7.32918361]
curr_Stock_Price:  106.66058965990419
curr_Factors:  [106.66058966  -0.93955703  -0.96142464]
mat_Sqrt:  [[15.93742415  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0076369  -0.22267377 -0.77936306]
Stock Position:  -0.0076369031898862435
Bond Position:  [-6.51462701]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-7.34070166]
Stock Price:  107.95551102486424
PL:  [-15.29621268]
Settle:  Tensor("sub_242:0", shape=(), dtype=float64)
PL:  Tensor("sub_243:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  122
output_Z_Vals[:, i, :]:  [[ 1.19271183e+02 -4.92738716e+01 -4.92570741e+01]
 [ 7.56064645e-03  1.26604756e-03 -7.93165136e-02]
 [-2.05545563e+00 -2.76937875e+00 -7.87948838e-01]
 [-3.25391821e-01 -1.88488659e-01  2.10181763e-01]
 [ 7.79675993e-01  9.41992649e-02 -5.57983351e-01]
 [ 7.62017080e-02  1.21672466e-01 -4.02428057e-03]
 [ 3.92259192e-02 -4.23139460e-03  1.03610912e-01]
 [ 1.08065552e-01  3.15841069e-01  2.07259366e-01]
 [-9.67809299e-05 -1.60181003e-01  1.41814121e-02]
 [-1.35328266e+00 -5.48752541e-01 -5.30471527e-02]
 [ 2.82549136e-01  7.65951076e-02  6.55683064e-02]
 [-1.17084485e-01  8.59105516e-02  2.41966969e-02]
 [-8.66793559e-01 -1.07999490e+00  3.13202180e-01]
 [-2.89126357e-03 -3.40759361e-02 -2.04527555e-02]
 [-1.83464246e-01 -2.36671011e-01  8.77196740e-02]
 [ 9.26010825e-02  2.53084569e-02  5.03256900e-02]
 [-5.05654540e-01 -5.06380930e-01 -5.20366587e-01]
 [-5.15512605e-01 -5.71330809e-01  9.24340957e-01]
 [ 4.02177447e-02  4.75687571e-03  2.86153686e-02]
 [-2.30290208e-02 -2.33799229e-01  6.88954379e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.27118322 -49.27387164 -49.25707411]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [   7.3268874   -15.90307369 -140.51672192]
init_Out:  [2.48374395]
Stock Position:  7.326887399052493
Bond position:  [-730.20499595]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [17.31332958]
curr_Stock_Price:  102.04891366242512
curr_Factors:  [102.04891366  -1.21067574  -0.99333409]
mat_Sqrt:  [[11.26209226  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00074332  0.00040862 -0.22626794]
Stock Position:  -0.0007433199809601409
Bond Position:  [17.38918457]


portfolio before change:  [17.3179179]
curr_Stock_Price:  101.72538187251445
curr_Factors:  [101.72538187  -1.16784299  -0.99793273]
mat_Sqrt:  [[11.66392949  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.23847813 -0.89381315 -2.24779871]
Stock Position:  -0.2384781295268062
Bond Position:  [41.5771967]


portfolio before change:  [17.09894124]
curr_Stock_Price:  102.6871986427217
curr_Factors:  [102.68719864  -1.125029    -0.98870319]
mat_Sqrt:  [[12.40320946  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02587747 -0.06083445  0.59959007]
Stock Position:  -0.02587747435075474
Bond Position:  [19.75622659]


portfolio before change:  [17.10895308]
curr_Stock_Price:  102.4911917678203
curr_Factors:  [102.49119177  -0.95026779  -1.01459084]
mat_Sqrt:  [[14.36677462  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.04767991  0.03040268 -1.59177119]
Stock Position:  0.04767990591472294
Bond Position:  [12.22218269]


portfolio before change:  [17.1190508]
curr_Stock_Price:  102.63888075322662
curr_Factors:  [102.63888075  -0.79088646  -1.06475738]
mat_Sqrt:  [[16.04781949  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00624487  0.03926962 -0.01148015]
Stock Position:  0.006244869803152341
Bond Position:  [16.47808435]


portfolio before change:  [17.12515347]
curr_Stock_Price:  102.9563624632851
curr_Factors:  [102.95636246  -0.64752248  -1.01015741]
mat_Sqrt:  [[19.62148892  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00303298 -0.00136568  0.29557309]
Stock Position:  0.003032984832471183
Bond Position:  [16.81288838]


portfolio before change:  [17.12527589]
curr_Stock_Price:  101.61071713082409
curr_Factors:  [101.61071713  -0.66166583  -1.05195293]
mat_Sqrt:  [[18.31151773  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01173267 0.10193727 0.59125328]
Stock Position:  0.011732669266865793
Bond Position:  [15.93311096]


portfolio before change:  [17.14070188]
curr_Stock_Price:  102.58596083741782
curr_Factors:  [102.58596084  -0.73579521  -1.05555108]
mat_Sqrt:  [[17.10472598  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00174799 -0.0516982   0.04045562]
Stock Position:  -0.0017479860672207446
Bond Position:  [17.32002071]


portfolio before change:  [17.14360836]
curr_Stock_Price:  103.40064909486354
curr_Factors:  [103.40064909  -0.69888744  -1.00774398]
mat_Sqrt:  [[18.76474447  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.07866478 -0.17710912 -0.15132876]
Stock Position:  -0.07866478076844263
Bond Position:  [25.27759776]


portfolio before change:  [17.18673749]
curr_Stock_Price:  102.93272767434998
curr_Factors:  [102.93272767  -0.55257984  -1.00397192]
mat_Sqrt:  [[21.70459269  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01435494 0.02472096 0.18704813]
Stock Position:  0.01435493981014493
Bond Position:  [15.70914438]


portfolio before change:  [17.25422947]
curr_Stock_Price:  107.36076487398516
curr_Factors:  [107.36076487  -0.78433432  -0.98508684]
mat_Sqrt:  [[18.29766818  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00517055  0.02772751  0.06902644]
Stock Position:  -0.005170546112266276
Bond Position:  [17.80934326]


portfolio before change:  [17.2612431]
curr_Stock_Price:  106.86551088158043
curr_Factors:  [106.86551088  -0.69890314  -0.96963143]
mat_Sqrt:  [[20.14662072  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.05079336 -0.34856686  0.89347864]
Stock Position:  -0.05079335545241141
Bond Position:  [22.68930098]


portfolio before change:  [17.36647553]
curr_Stock_Price:  104.90542389599592
curr_Factors:  [104.9054239   -0.6208534   -1.01702798]
mat_Sqrt:  [[20.39271734  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00068759 -0.01099796 -0.05834602]
Stock Position:  -0.0006875928251730797
Bond Position:  [17.43860775]


portfolio before change:  [17.37122058]
curr_Stock_Price:  104.3457167994801
curr_Factors:  [ 1.04345717e+02 -7.36669120e-02 -1.04559769e+00]
mat_Sqrt:  [[34.07094547  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00627716 -0.07638524  0.25023981]
Stock Position:  -0.006277161016320914
Bond Position:  [18.02621544]


portfolio before change:  [17.35105585]
curr_Stock_Price:  108.27613080217426
curr_Factors:  [108.2761308    0.29170171  -1.0408635 ]
mat_Sqrt:  [[51.18891178  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00211061 0.00816827 0.14356519]
Stock Position:  0.0021106101747041194
Bond Position:  [17.12252715]


portfolio before change:  [17.37874069]
curr_Stock_Price:  119.36470999254028
curr_Factors:  [119.36470999   0.52426457  -1.05110173]
mat_Sqrt:  [[70.48122977  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01014793 -0.16343374 -1.48446103]
Stock Position:  -0.010147928772338912
Bond Position:  [18.59004526]


portfolio before change:  [17.32523573]
curr_Stock_Price:  125.09524365159469
curr_Factors:  [125.09524365   0.38835772  -1.07746868]
mat_Sqrt:  [[62.8005882   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00706131 -0.18439623  2.63688746]
Stock Position:  -0.0070613146003810625
Bond Position:  [18.2085726]


portfolio before change:  [17.31562871]
curr_Stock_Price:  127.10049887870761
curr_Factors:  [127.10049888   0.29923789  -1.07696046]
mat_Sqrt:  [[58.39647541  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00080535 0.00153528 0.08163168]
Stock Position:  0.0008053538364368145
Bond Position:  [17.21326783]


portfolio before change:  [17.31947951]
curr_Stock_Price:  126.53795109502171
curr_Factors:  [126.5379511    0.23355696  -1.09132795]
mat_Sqrt:  [[53.66555083  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 1.30212276e-03 -7.54583766e-02  1.96539508e+00]
Stock Position:  0.0013021227612211997
Bond Position:  [17.15471156]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [17.31660576]
Stock Price:  121.03695852095986
PL:  [-3.72035276]
Settle:  Tensor("sub_244:0", shape=(), dtype=float64)
PL:  Tensor("sub_245:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  123
output_Z_Vals[:, i, :]:  [[ 1.19271183e+02 -4.92738716e+01 -4.92570741e+01]
 [ 1.56343214e-01  2.30911170e-01 -6.66618548e-02]
 [-2.42264043e+00 -2.90076041e+00 -8.70931205e-01]
 [-2.55198094e-02  3.70290215e-02 -1.19124277e-01]
 [ 2.35780813e-01  1.36342948e-02 -2.47393417e-01]
 [-1.47602915e-01 -2.64470222e-01  6.76194217e-02]
 [-2.25309829e-02  4.27200331e-02 -2.22958914e-02]
 [ 1.21781305e-01  3.12279055e-01  1.75437778e-01]
 [ 5.66804900e-02  1.38107931e-01 -8.87618939e-02]
 [-9.69721040e-01 -3.97194393e-01 -3.33947727e-02]
 [ 1.30044878e-01  1.80289379e-04 -1.53443560e-01]
 [ 3.24132852e-03 -6.20144052e-02  3.38708580e-02]
 [-5.21401436e-01 -1.26222405e+00  1.88056543e-01]
 [ 1.08616065e-01  9.96625987e-02  1.14800628e-01]
 [ 7.13042022e-02  1.25881494e-01 -1.02369160e-01]
 [ 6.62800405e-02  3.23930868e-02  6.27876479e-02]
 [ 1.25539909e-01  1.15578973e-01  1.03380930e-01]
 [ 7.46515839e-02 -4.51246381e-02  2.41327315e-02]
 [-4.66940601e-02 -1.01327701e-01  3.30511941e-03]
 [ 6.38048396e-02 -5.46190446e-01 -4.77166494e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.27118322 -49.27387164 -49.25707411]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [   7.3268874   -15.90307369 -140.51672192]
init_Out:  [2.48374395]
Stock Position:  7.326887399052493
Bond position:  [-730.20499595]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-12.54566812]
curr_Stock_Price:  97.97365003869665
curr_Factors:  [97.97365004 -0.91674769 -1.04696117]
mat_Sqrt:  [[13.74932474  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01380944  0.07452626 -0.19016772]
Stock Position:  0.013809439239302902
Bond Position:  [-13.89862928]


portfolio before change:  [-12.54623607]
curr_Stock_Price:  98.18416801618622
curr_Factors:  [98.18416802 -0.86458672 -1.09755601]
mat_Sqrt:  [[13.80046456  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.23133524 -0.9362164  -2.48452431]
Stock Position:  -0.23133523832364777
Bond Position:  [10.16722184]


portfolio before change:  [-12.72361898]
curr_Stock_Price:  98.96193550642114
curr_Factors:  [98.96193551 -0.9896715  -1.08303149]
mat_Sqrt:  [[12.45388099  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00339472  0.01195107 -0.3398284 ]
Stock Position:  -0.0033947195504468734
Bond Position:  [-12.38767096]


portfolio before change:  [-12.72840431]
curr_Stock_Price:  99.45918726371218
curr_Factors:  [99.45918726 -1.08746635 -1.10379608]
mat_Sqrt:  [[11.11710537  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01691672  0.00440045 -0.70574456]
Stock Position:  0.016916717608267372
Bond Position:  [-14.4109273]


portfolio before change:  [-12.74711826]
curr_Stock_Price:  98.56594294772667
curr_Factors:  [98.56594295 -1.16559912 -1.07909848]
mat_Sqrt:  [[10.44400568  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01798016 -0.0853574   0.19289939]
Stock Position:  -0.01798016217384382
Bond Position:  [-10.97488662]


portfolio before change:  [-12.74015748]
curr_Stock_Price:  98.0261904173249
curr_Factors:  [98.02619042 -0.65045936 -1.0867637 ]
mat_Sqrt:  [[17.25344153  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00106425  0.01378783 -0.06360397]
Stock Position:  -0.0010642469460928918
Bond Position:  [-12.63583341]


portfolio before change:  [-12.74408494]
curr_Stock_Price:  98.74792754634217
curr_Factors:  [98.74792755 -0.66716517 -1.14760904]
mat_Sqrt:  [[16.083537    0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01376165 0.10078763 0.50047515]
Stock Position:  0.013761654964818749
Bond Position:  [-14.10301985]


portfolio before change:  [-12.73922824]
curr_Stock_Price:  99.35707661928738
curr_Factors:  [99.35707662 -0.57051191 -1.13030762]
mat_Sqrt:  [[18.13603192  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0036807   0.04457414 -0.25321298]
Stock Position:  0.0036806953089374146
Bond Position:  [-13.10493136]


portfolio before change:  [-12.74650061]
curr_Stock_Price:  98.27148550887439
curr_Factors:  [98.27148551 -0.50424644 -1.1306959 ]
mat_Sqrt:  [[19.1593637   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.05520093 -0.12819394 -0.09526599]
Stock Position:  -0.055200929510951964
Bond Position:  [-7.32182327]


portfolio before change:  [-12.77506072]
curr_Stock_Price:  98.75570609640027
curr_Factors:  [98.7557061  -0.35497288 -1.11276446]
mat_Sqrt:  [[22.75788873  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 4.33960043e-03  5.81881467e-05 -4.37731767e-01]
Stock Position:  0.004339600430965282
Bond Position:  [-13.20362103]


portfolio before change:  [-12.77677463]
curr_Stock_Price:  99.121503504025
curr_Factors:  [ 9.91215035e+01  2.74486863e-02 -1.09890903e+00]
mat_Sqrt:  [[33.9499052   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-7.37394993e-05 -2.00150632e-02  9.66241299e-02]
Stock Position:  -7.3739499326494e-05
Bond Position:  [-12.76946546]


portfolio before change:  [-12.77994114]
curr_Stock_Price:  98.76549644857013
curr_Factors:  [98.76549645 -0.18967635 -1.08446889]
mat_Sqrt:  [[27.62173802  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02681457 -0.40738106  0.53647297]
Stock Position:  -0.026814567569874877
Bond Position:  [-10.13158706]


portfolio before change:  [-12.73537766]
curr_Stock_Price:  97.00911200054286
curr_Factors:  [ 9.70091120e+01 -6.01929454e-02 -1.07223033e+00]
mat_Sqrt:  [[31.26132282  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00487482 0.03216597 0.32749424]
Stock Position:  0.004874815726739394
Bond Position:  [-13.20827921]


portfolio before change:  [-12.72999812]
curr_Stock_Price:  98.79010762287642
curr_Factors:  [98.79010762 -0.28376887 -1.11888322]
mat_Sqrt:  [[24.2968178   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00313225  0.04062808 -0.29203072]
Stock Position:  0.0031322471066340713
Bond Position:  [-13.03943315]


portfolio before change:  [-12.7241179]
curr_Stock_Price:  101.70829570821395
curr_Factors:  [101.70829571  -0.64725693  -1.10636764]
mat_Sqrt:  [[17.61030608  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00486696 0.01045482 0.17911568]
Stock Position:  0.004866964049513546
Bond Position:  [-13.21912852]


portfolio before change:  [-12.7349581]
curr_Stock_Price:  100.16010096088087
curr_Factors:  [100.16010096  -0.56690999  -1.08822665]
mat_Sqrt:  [[19.13718447  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.0088955  0.03730295 0.29491702]
Stock Position:  0.008895504598978497
Bond Position:  [-13.62593274]


portfolio before change:  [-12.72041868]
curr_Stock_Price:  102.17756215508476
curr_Factors:  [102.17756216  -0.64636734  -1.09638779]
mat_Sqrt:  [[17.88490339  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00393441 -0.01456391  0.06884397]
Stock Position:  0.0039344148156480515
Bond Position:  [-13.12242759]


portfolio before change:  [-12.73368864]
curr_Stock_Price:  99.63869774205942
curr_Factors:  [99.63869774 -0.36260728 -1.07445808]
mat_Sqrt:  [[23.67655357  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00281725 -0.03270337  0.00942859]
Stock Position:  -0.002817252754489264
Bond Position:  [-12.45298124]


portfolio before change:  [-12.7396773]
curr_Stock_Price:  100.65920555048308
curr_Factors:  [100.65920555  -0.75148885  -1.10038894]
mat_Sqrt:  [[15.7976756   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00918407 -0.17628221 -1.36122319]
Stock Position:  -0.00918407395896724
Bond Position:  [-11.81521571]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-12.73950564]
Stock Price:  100.3188510258732
PL:  [-13.05835666]
Settle:  Tensor("sub_246:0", shape=(), dtype=float64)
PL:  Tensor("sub_247:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  124
output_Z_Vals[:, i, :]:  [[ 1.19271183e+02 -4.92738716e+01 -4.92570741e+01]
 [ 6.85138557e-02  1.18968113e-01 -2.26517794e-02]
 [-2.07922364e+00 -2.26832476e+00 -6.85790977e-01]
 [ 1.01685340e-02  5.32403088e-02 -9.53747571e-02]
 [ 7.23600893e-02 -4.73099775e-02 -8.59603544e-02]
 [-1.44591100e-01 -2.49581798e-01  2.78297618e-02]
 [-1.79266957e-02  3.34310914e-02 -2.74229865e-02]
 [ 6.82382407e-02  1.44698477e-01  3.89761086e-02]
 [ 1.08959377e-02 -1.31876872e-01  4.64807539e-03]
 [-1.11127846e+00 -4.38603902e-01 -4.09564398e-02]
 [ 4.39507379e-01  1.17327233e-01  4.20559022e-02]
 [ 5.12633990e-02 -6.28136968e-02  3.75328258e-02]
 [-6.50639090e-01 -1.12885674e+00  2.30502181e-01]
 [ 2.57438529e-02  4.04966679e-02  9.63753479e-02]
 [ 7.69270586e-02  1.27588488e-01 -1.02567100e-01]
 [-1.07294583e-01  8.01247535e-02  1.34634183e-01]
 [ 7.56338095e-02  1.08965567e-01  1.14294689e-01]
 [ 1.15216134e-01 -1.08333916e-02 -3.18137274e-02]
 [-5.64262448e-02 -1.87701193e-01  3.25061718e-02]
 [ 6.01528000e-02 -4.34858316e-01 -4.80536913e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.27118322 -49.27387164 -49.25707411]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [   7.3268874   -15.90307369 -140.51672192]
init_Out:  [2.48374395]
Stock Position:  7.326887399052493
Bond position:  [-730.20499595]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-2.69021394]
curr_Stock_Price:  99.31875794621251
curr_Factors:  [99.31875795 -1.44213379 -1.01641418]
mat_Sqrt:  [[ 8.49762308  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01037635  0.03839679 -0.06461922]
Stock Position:  0.010376353968506873
Bond Position:  [-3.72078053]


portfolio before change:  [-2.69380788]
curr_Stock_Price:  99.06205592002604
curr_Factors:  [99.06205592 -1.73428355 -1.02219424]
mat_Sqrt:  [[ 6.2919352   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.42629651 -0.73209867 -1.95637077]
Stock Position:  -0.4262965063233029
Bond Position:  [39.53600047]


portfolio before change:  [-2.65028717]
curr_Stock_Price:  98.98315431294715
curr_Factors:  [98.98315431 -1.73938388 -1.02785938]
mat_Sqrt:  [[ 6.2196051   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 2.52086068e-04  1.71832358e-02 -2.72077635e-01]
Stock Position:  0.0002520860677838157
Bond Position:  [-2.67523944]


portfolio before change:  [-2.65112155]
curr_Stock_Price:  98.32665960517333
curr_Factors:  [98.32665961 -1.60395912 -0.99810912]
mat_Sqrt:  [[ 7.28798389  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00619601 -0.01526923 -0.24522096]
Stock Position:  0.006196006660517016
Bond Position:  [-3.26035419]


portfolio before change:  [-2.65098919]
curr_Stock_Price:  98.47958939176392
curr_Factors:  [98.47958939 -1.23315844 -0.99777832]
mat_Sqrt:  [[10.5794406   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01794575 -0.08055218  0.07939056]
Stock Position:  -0.017945754609034737
Bond Position:  [-0.88369864]


portfolio before change:  [-2.65757975]
curr_Stock_Price:  98.8345260764705
curr_Factors:  [98.83452608 -1.17093447 -0.98635983]
mat_Sqrt:  [[11.42898533  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00146122  0.01078984 -0.07823015]
Stock Position:  -0.001461223014963903
Bond Position:  [-2.51316046]


portfolio before change:  [-2.66101709]
curr_Stock_Price:  100.75687121489295
curr_Factors:  [100.75687121  -1.18199644  -1.00271912]
mat_Sqrt:  [[11.3361285   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00932688 0.04670123 0.11118799]
Stock Position:  0.009326875438372916
Bond Position:  [-3.60076388]


portfolio before change:  [-2.65711294]
curr_Stock_Price:  101.27199040908062
curr_Factors:  [101.27199041  -1.370328    -0.99827494]
mat_Sqrt:  [[ 9.4802144   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0015901  -0.04256308  0.01325967]
Stock Position:  -0.0015901045046830934
Bond Position:  [-2.49607989]


portfolio before change:  [-2.6578974]
curr_Stock_Price:  101.37283941109953
curr_Factors:  [101.37283941  -1.43326803  -0.97432663]
mat_Sqrt:  [[ 9.12675794  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.13248607 -0.1415588  -0.11683732]
Stock Position:  -0.132486071676174
Bond Position:  [10.77259187]


portfolio before change:  [-2.68100886]
curr_Stock_Price:  101.56761414574184
curr_Factors:  [101.56761415  -1.42330037  -0.98137422]
mat_Sqrt:  [[ 9.17103485  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.05147089 0.0378672  0.11997378]
Stock Position:  0.051470889952227844
Bond Position:  [-7.90878435]


portfolio before change:  [-2.71890242]
curr_Stock_Price:  100.8698192083947
curr_Factors:  [100.86981921  -1.42793208  -0.9875734 ]
mat_Sqrt:  [[ 9.00991186  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00511692 -0.02027303  0.1070707 ]
Stock Position:  0.005116916074448778
Bond Position:  [-3.23504482]


portfolio before change:  [-2.71928643]
curr_Stock_Price:  100.95284864346945
curr_Factors:  [100.95284864  -0.86644154  -1.02491852]
mat_Sqrt:  [[15.23040102  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.05475988 -0.36433694  0.65755856]
Stock Position:  -0.05475988088670477
Bond Position:  [2.80887953]


portfolio before change:  [-2.64385152]
curr_Stock_Price:  99.58811580599583
curr_Factors:  [99.58811581 -0.61191977 -1.0321482 ]
mat_Sqrt:  [[19.23968111  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00279021 0.01307024 0.27493204]
Stock Position:  0.002790209247817837
Bond Position:  [-2.9217232]


portfolio before change:  [-2.64912343]
curr_Stock_Price:  97.96049886078863
curr_Factors:  [97.96049886 -0.39523787 -1.0075742 ]
mat_Sqrt:  [[24.08892658  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00340549  0.04117901 -0.29259539]
Stock Position:  0.0034054870731308087
Bond Position:  [-2.98272664]


portfolio before change:  [-2.65037575]
curr_Stock_Price:  97.81175542860137
curr_Factors:  [97.81175543 -0.71682134 -0.98578668]
mat_Sqrt:  [[17.82205516  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00356059  0.02586015  0.38407385]
Stock Position:  -0.003560593797401697
Bond Position:  [-2.30210782]


portfolio before change:  [-2.6492747]
curr_Stock_Price:  97.34086517999059
curr_Factors:  [97.34086518 -0.63759654 -1.00474528]
mat_Sqrt:  [[18.83801803  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00643415 0.03516849 0.32605093]
Stock Position:  0.0064341491891296435
Bond Position:  [-3.27558035]


portfolio before change:  [-2.64360553]
curr_Stock_Price:  98.3492602944557
curr_Factors:  [98.34926029 -0.39132868 -1.06953779]
mat_Sqrt:  [[22.82048393  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00466733 -0.00349646 -0.09075571]
Stock Position:  0.0046673343090434805
Bond Position:  [-3.10263441]


portfolio before change:  [-2.6489848]
curr_Stock_Price:  97.36293377061367
curr_Factors:  [97.36293377 -0.76810567 -1.03427803]
mat_Sqrt:  [[16.05566723  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00548749 -0.0605803   0.09273106]
Stock Position:  -0.0054874889068698505
Bond Position:  [-2.11470678]


portfolio before change:  [-2.64499251]
curr_Stock_Price:  96.53905371398768
curr_Factors:  [96.53905371 -0.54636979 -1.02592197]
mat_Sqrt:  [[20.03850898  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0063229  -0.14034992 -1.37083806]
Stock Position:  -0.006322899018087318
Bond Position:  [-2.03458583]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-2.64602297]
Stock Price:  96.62157069670867
PL:  [-2.64602297]
Settle:  Tensor("sub_248:0", shape=(), dtype=float64)
PL:  Tensor("sub_249:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  125
output_Z_Vals[:, i, :]:  [[ 1.19271183e+02 -4.92738716e+01 -4.92570741e+01]
 [ 4.76421450e-02  8.54353610e-02 -3.23375965e-02]
 [-2.42655647e+00 -2.96807988e+00 -8.81470661e-01]
 [-3.03062820e-02 -1.05582040e-02 -1.34726196e-01]
 [-7.40246370e-03 -5.80253311e-02 -1.95460622e-02]
 [-1.40235096e-01 -2.27637744e-01 -2.38981863e-02]
 [-5.52474854e-02  7.77677625e-02 -1.32154533e-01]
 [ 9.14451452e-02  2.22967909e-01  9.20739440e-02]
 [-1.61331348e-02  2.50505973e-01 -7.91260521e-02]
 [-8.77566417e-01 -3.57086850e-01 -2.87516130e-02]
 [ 8.56779538e-02 -2.48065828e-02 -2.45801990e-01]
 [ 7.72560761e-03 -1.43021789e-02  2.46799945e-02]
 [-5.84529116e-01 -1.19802518e+00  2.04220213e-01]
 [ 1.76539760e-02  3.34531503e-02  8.08711121e-02]
 [ 8.89598147e-02  1.23171800e-01 -1.00154687e-01]
 [ 3.36313459e-02  4.11808818e-02  7.82454955e-02]
 [ 1.25644008e-01  1.12477773e-01  9.65088201e-02]
 [ 8.93627773e-02 -1.85816199e-02  4.03884205e-02]
 [-4.15077370e-02 -7.77089999e-02 -3.36572932e-03]
 [ 9.27252985e-02 -7.42530573e-01 -5.50053392e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.27118322 -49.27387164 -49.25707411]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [   7.3268874   -15.90307369 -140.51672192]
init_Out:  [2.48374395]
Stock Position:  7.326887399052493
Bond position:  [-730.20499595]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-1.54233759]
curr_Stock_Price:  99.47542424785544
curr_Factors:  [99.47542425 -1.06847527 -1.01148619]
mat_Sqrt:  [[12.42796486  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00470557  0.02757414 -0.09225016]
Stock Position:  0.004705571782741226
Bond Position:  [-2.01042634]


portfolio before change:  [-1.54745138]
curr_Stock_Price:  98.49549557212568
curr_Factors:  [98.49549557 -0.86371893 -1.04500205]
mat_Sqrt:  [[14.60391783  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.21996445 -0.95794366 -2.51459044]
Stock Position:  -0.2199644452320758
Bond Position:  [20.11805566]


portfolio before change:  [-1.44340331]
curr_Stock_Price:  98.04534132714885
curr_Factors:  [98.04534133 -1.37775853 -1.06840109]
mat_Sqrt:  [[ 8.49323891  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00706001 -0.00340765 -0.38433634]
Stock Position:  -0.007060008169354313
Bond Position:  [-0.7512024]


portfolio before change:  [-1.4409907]
curr_Stock_Price:  97.67700790168026
curr_Factors:  [97.6770079  -1.4110096  -1.07987572]
mat_Sqrt:  [[ 8.09123097  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00287183 -0.0187276  -0.05575947]
Stock Position:  -0.0028718322536323746
Bond Position:  [-1.16047871]


portfolio before change:  [-1.44070594]
curr_Stock_Price:  97.47681704072035
curr_Factors:  [97.47681704 -1.22907393 -1.05501373]
mat_Sqrt:  [[ 9.92966679  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01929366 -0.07346977 -0.06817487]
Stock Position:  -0.019293663803403385
Bond Position:  [0.439979]


portfolio before change:  [-1.44242896]
curr_Stock_Price:  97.57182394262446
curr_Factors:  [97.57182394 -1.36123354 -1.0892622 ]
mat_Sqrt:  [[ 8.4156496   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00788402  0.02509944 -0.3770001 ]
Stock Position:  -0.007884018666815895
Bond Position:  [-0.67317088]


portfolio before change:  [-1.44162834]
curr_Stock_Price:  97.44892504386853
curr_Factors:  [97.44892504 -0.83731531 -1.0954132 ]
mat_Sqrt:  [[14.10599501  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.0110416  0.07196258 0.26266133]
Stock Position:  0.01104160281262545
Bond Position:  [-2.51762066]


portfolio before change:  [-1.45245461]
curr_Stock_Price:  96.52543701199653
curr_Factors:  [96.52543701 -0.88727614 -1.11333034]
mat_Sqrt:  [[13.05537708  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00144382  0.08085045 -0.2257246 ]
Stock Position:  0.0014438223327448952
Bond Position:  [-1.59182019]


portfolio before change:  [-1.45118215]
curr_Stock_Price:  97.68241252245264
curr_Factors:  [97.68241252 -0.9097849  -1.12279591]
mat_Sqrt:  [[12.79610359  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.07473567 -0.11524929 -0.08202035]
Stock Position:  -0.07473566910047694
Bond Position:  [5.84917831]


portfolio before change:  [-1.44566529]
curr_Stock_Price:  97.6281629557258
curr_Factors:  [97.62816296 -0.63927882 -1.13760229]
mat_Sqrt:  [[16.51526154  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00184316 -0.00800629 -0.70120466]
Stock Position:  0.0018431564151074587
Bond Position:  [-1.62560927]


portfolio before change:  [-1.44699699]
curr_Stock_Price:  97.12617191530494
curr_Factors:  [97.12617192 -0.41203522 -1.16181399]
mat_Sqrt:  [[20.12900194  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00048904 -0.00461601  0.07040515]
Stock Position:  0.0004890441348563665
Bond Position:  [-1.49449598]


portfolio before change:  [-1.44714705]
curr_Stock_Price:  97.58342287888557
curr_Factors:  [97.58342288 -0.45832323 -1.13973742]
mat_Sqrt:  [[19.73999904  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.03988798 -0.38666096  0.58258342]
Stock Position:  -0.039887980919330435
Bond Position:  [2.44525866]


portfolio before change:  [-1.56082399]
curr_Stock_Price:  100.4486552008379
curr_Factors:  [100.4486552   -0.38058079  -1.16619366]
mat_Sqrt:  [[21.38890355  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00191643 0.01079696 0.23070277]
Stock Position:  0.0019164291566212174
Bond Position:  [-1.75332672]


portfolio before change:  [-1.55972956]
curr_Stock_Price:  101.24848349560511
curr_Factors:  [101.2484835   -0.58742815  -1.13760431]
mat_Sqrt:  [[18.03916582  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00519193  0.03975353 -0.28571344]
Stock Position:  0.005191934259163706
Bond Position:  [-2.08540503]


portfolio before change:  [-1.56514985]
curr_Stock_Price:  100.30492835396463
curr_Factors:  [100.30492835  -0.71727627  -1.11656772]
mat_Sqrt:  [[16.0285394   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00361912 0.01329107 0.22321262]
Stock Position:  0.0036191166003980914
Bond Position:  [-1.92816508]


portfolio before change:  [-1.56486233]
curr_Stock_Price:  100.51758286286062
curr_Factors:  [100.51758286  -0.91522973  -1.15652227]
mat_Sqrt:  [[12.66168704  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01329232 0.03630204 0.2753128 ]
Stock Position:  0.013292321690552007
Bond Position:  [-2.90097438]


portfolio before change:  [-1.55459355]
curr_Stock_Price:  101.34468602940349
curr_Factors:  [101.34468603  -0.97805216  -1.16269373]
mat_Sqrt:  [[11.91480263  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00787374 -0.00599719  0.11521692]
Stock Position:  0.007873741156037641
Bond Position:  [-2.35255537]


portfolio before change:  [-1.56050232]
curr_Stock_Price:  100.66895062935258
curr_Factors:  [100.66895063  -1.42708036  -1.17677639]
mat_Sqrt:  [[ 7.44826169  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00779471 -0.02508047 -0.00960149]
Stock Position:  -0.007794710934141472
Bond Position:  [-0.77581695]


portfolio before change:  [-1.56333074]
curr_Stock_Price:  101.0069285689687
curr_Factors:  [101.00692857  -1.19068269  -1.1547148 ]
mat_Sqrt:  [[ 9.67738407  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0176827  -0.23965071 -1.56914922]
Stock Position:  -0.01768270199023267
Bond Position:  [0.22274467]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-1.5635377]
Stock Price:  101.02178178729
PL:  [-2.58531948]
Settle:  Tensor("sub_250:0", shape=(), dtype=float64)
PL:  Tensor("sub_251:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  126
output_Z_Vals[:, i, :]:  [[ 1.19271183e+02 -4.92738716e+01 -4.92570741e+01]
 [ 5.88017625e-02  1.03364542e-01 -2.71588157e-02]
 [-2.29591741e+00 -3.09004072e+00 -8.80710408e-01]
 [ 6.06155677e-02  1.62036996e-01 -7.18175297e-02]
 [ 7.02631488e-01 -1.46235687e-01 -3.04910800e-01]
 [-8.79226438e-02 -1.52170106e-01  3.33910286e-02]
 [-4.42496669e-02  8.11018340e-02 -6.57831187e-02]
 [ 1.04392315e-01  2.61085013e-01  1.27652795e-01]
 [-4.61773128e-02  2.92861743e-01 -8.59736878e-02]
 [-8.52767181e-01 -3.46584002e-01 -2.74959468e-02]
 [ 8.17446990e-02 -4.94177228e-02 -2.27440578e-01]
 [ 5.88716525e-03 -6.28611991e-02  3.42186993e-02]
 [-6.71971465e-01 -1.24525482e+00  2.32107854e-01]
 [ 3.47131747e-02  4.83058815e-02  1.13565038e-01]
 [ 1.07638477e-01  1.19967149e-01 -1.04215101e-01]
 [-8.64025124e-02  7.53567004e-02  1.16008108e-01]
 [ 1.17634886e-01  1.14488940e-01  1.03693265e-01]
 [ 1.15216134e-01 -1.08333916e-02 -3.18137274e-02]
 [-4.85498141e-02 -8.99064526e-02 -9.65985536e-03]
 [ 9.49073538e-02 -7.32015870e-01 -6.56746710e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.27118322 -49.27387164 -49.25707411]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [   7.3268874   -15.90307369 -140.51672192]
init_Out:  [2.48374395]
Stock Position:  7.326887399052493
Bond position:  [-730.20499595]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-3.91990764]
curr_Stock_Price:  99.15092491725663
curr_Factors:  [99.15092492 -1.09560685 -1.00599249]
mat_Sqrt:  [[12.12226505  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00613394  0.03336076 -0.07747654]
Stock Position:  0.0061339354503859
Bond Position:  [-4.52809302]


portfolio before change:  [-3.91077338]
curr_Stock_Price:  100.82463532212344
curr_Factors:  [100.82463532  -0.78009953  -1.03575018]
mat_Sqrt:  [[16.40412809  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.18936963 -0.99730635 -2.51242165]
Stock Position:  -0.1893696252556788
Bond Position:  [15.18235003]


portfolio before change:  [-3.76093028]
curr_Stock_Price:  100.05340796738894
curr_Factors:  [100.05340797  -0.62523439  -0.98071213]
mat_Sqrt:  [[20.08066881  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0039357   0.05229722 -0.20487542]
Stock Position:  0.003935702532294148
Bond Position:  [-4.15471073]


portfolio before change:  [-3.76616916]
curr_Stock_Price:  98.98623646617496
curr_Factors:  [98.98623647 -0.54386413 -0.99652388]
mat_Sqrt:  [[21.21254607  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0287821  -0.04719736 -0.86982564]
Stock Position:  0.02878209879156683
Bond Position:  [-6.61520079]


portfolio before change:  [-3.78449389]
curr_Stock_Price:  98.40703161652998
curr_Factors:  [98.40703162 -0.68890897 -1.01414301]
mat_Sqrt:  [[17.92256039  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0062585  -0.04911269  0.09525531]
Stock Position:  -0.006258498725314008
Bond Position:  [-3.16861361]


portfolio before change:  [-3.77635226]
curr_Stock_Price:  96.97955033147127
curr_Factors:  [96.97955033 -0.57584879 -1.02908525]
mat_Sqrt:  [[19.48346378  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00211065  0.0261755  -0.18766093]
Stock Position:  -0.0021106486890076783
Bond Position:  [-3.5716625]


portfolio before change:  [-3.77539005]
curr_Stock_Price:  96.10056476411057
curr_Factors:  [96.10056476 -0.50784893 -1.0276088 ]
mat_Sqrt:  [[20.69593841  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00887822 0.08426483 0.36415789]
Stock Position:  0.008878219680025536
Bond Position:  [-4.62859198]


portfolio before change:  [-3.77438999]
curr_Stock_Price:  96.34355894935709
curr_Factors:  [96.34355895 -0.75807808 -1.02594758]
mat_Sqrt:  [[16.18192506  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-2.43881082e-04  9.45207211e-02 -2.45259001e-01]
Stock Position:  -0.00024388108160953824
Bond Position:  [-3.75089362]


portfolio before change:  [-3.77573009]
curr_Stock_Price:  97.99295354707665
curr_Factors:  [97.99295355 -1.14631069 -1.03602705]
mat_Sqrt:  [[11.05140791  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.08407308 -0.11185951 -0.07843828]
Stock Position:  -0.08407308268532122
Bond Position:  [4.4628396]


portfolio before change:  [-3.81304187]
curr_Stock_Price:  98.45002765931872
curr_Factors:  [98.45002766 -1.57191061 -1.05211123]
mat_Sqrt:  [[ 7.13867542  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00353444 -0.0159495  -0.64882466]
Stock Position:  0.00353444209893762
Bond Position:  [-4.16100779]


portfolio before change:  [-3.81422178]
curr_Stock_Price:  98.41055057868198
curr_Factors:  [98.41055058 -1.62227847 -1.04864299]
mat_Sqrt:  [[ 6.80887262  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 5.95391680e-06 -2.02883648e-02  9.76164245e-02]
Stock Position:  5.95391679552525e-06
Bond Position:  [-3.81480771]


portfolio before change:  [-3.81517619]
curr_Stock_Price:  98.31198378771421
curr_Factors:  [98.31198379 -1.43045695 -1.07789767]
mat_Sqrt:  [[ 8.00279861  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.10980899 -0.40190427  0.6621391 ]
Stock Position:  -0.10980898892910161
Bond Position:  [6.98036335]


portfolio before change:  [-3.86655865]
curr_Stock_Price:  98.79580363106518
curr_Factors:  [98.79580363 -1.21310735 -1.09108073]
mat_Sqrt:  [[ 9.86375619  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00686908 0.01559066 0.32396944]
Stock Position:  0.006869080761755247
Bond Position:  [-4.545195]


portfolio before change:  [-3.87080432]
curr_Stock_Price:  98.343161267335
curr_Factors:  [98.34316127 -1.1221338  -1.07067962]
mat_Sqrt:  [[10.97532525  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01010028  0.03871923 -0.29729667]
Stock Position:  0.010100279260283267
Bond Position:  [-4.86409772]


portfolio before change:  [-3.87263518]
curr_Stock_Price:  98.28230329997359
curr_Factors:  [98.2823033  -1.42739995 -1.03309798]
mat_Sqrt:  [[ 8.39256378  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00564075  0.02432127  0.33093884]
Stock Position:  -0.005640747648431404
Bond Position:  [-3.31824951]


portfolio before change:  [-3.87785871]
curr_Stock_Price:  99.06125397751279
curr_Factors:  [99.06125398 -1.54585015 -1.06020884]
mat_Sqrt:  [[ 7.31318871  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.02217516 0.03695115 0.29580802]
Stock Position:  0.022175161670181135
Bond Position:  [-6.07455804]


portfolio before change:  [-3.87966094]
curr_Stock_Price:  99.04847389256301
curr_Factors:  [99.04847389 -1.67325509 -1.04618685]
mat_Sqrt:  [[ 6.52843616  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01631491 -0.00349646 -0.09075571]
Stock Position:  0.01631490682295531
Bond Position:  [-5.49562757]


portfolio before change:  [-3.87659609]
curr_Stock_Price:  99.3205524634751
curr_Factors:  [99.32055246 -1.28084834 -1.02786203]
mat_Sqrt:  [[ 9.87140464  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00697709 -0.02901718 -0.02755688]
Stock Position:  -0.006977092327070718
Bond Position:  [-3.18362742]


portfolio before change:  [-3.87713098]
curr_Stock_Price:  99.28312884985428
curr_Factors:  [99.28312885 -1.35088393 -1.06514602]
mat_Sqrt:  [[ 8.86353533  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0212751  -0.23625711 -1.87351556]
Stock Position:  -0.021275102289227004
Bond Position:  [-1.76487226]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-3.88038527]
Stock Price:  99.41534969273634
PL:  [-3.88038527]
Settle:  Tensor("sub_252:0", shape=(), dtype=float64)
PL:  Tensor("sub_253:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  127
output_Z_Vals[:, i, :]:  [[ 1.19271183e+02 -4.92738716e+01 -4.92570741e+01]
 [ 5.46550341e-02  9.67023565e-02 -2.90831646e-02]
 [-2.39574691e+00 -3.01365311e+00 -8.80597342e-01]
 [ 5.91784687e-02  1.53521608e-01 -6.71598102e-02]
 [ 2.85231985e-01  6.15592729e-02 -3.15477045e-01]
 [-1.29025948e-01 -9.16060289e-02  1.13251605e-02]
 [ 4.78132557e-03  2.90161341e-02  4.09022217e-02]
 [ 6.62784895e-02  1.16246340e-01  9.41061149e-03]
 [ 9.50480526e-02  8.47986010e-02 -6.83320917e-02]
 [-1.08983964e+00 -4.46380890e-01 -3.95125985e-02]
 [ 4.06128670e-01  1.10318555e-01  4.25627396e-02]
 [-1.12303852e-01 -2.03093085e-02  3.11680972e-02]
 [-7.31757301e-01 -1.06156566e+00  2.58265681e-01]
 [-1.27211601e-02  5.82830932e-03  2.09035873e-02]
 [ 1.07397615e-01  1.24468358e-01 -1.05174846e-01]
 [ 8.43048037e-02  2.75415017e-02  5.42536453e-02]
 [ 2.80859834e-02  1.63177006e-02 -2.68195968e-04]
 [ 2.58018972e-03 -9.48117079e-02  1.77016702e-01]
 [-5.94602739e-03  3.25260540e-02 -1.64080501e-02]
 [ 6.01534857e-02 -5.42750354e-01 -4.07842233e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.27118322 -49.27387164 -49.25707411]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [   7.3268874   -15.90307369 -140.51672192]
init_Out:  [2.48374395]
Stock Position:  7.326887399052493
Bond position:  [-730.20499595]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-3.19335299]
curr_Stock_Price:  99.25008771554693
curr_Factors:  [99.25008772 -1.02944712 -0.96352909]
mat_Sqrt:  [[13.52671472  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00506093  0.03121055 -0.08296617]
Stock Position:  0.005060929077027646
Bond Position:  [-3.69565064]


portfolio before change:  [-3.19537144]
curr_Stock_Price:  99.03383765410778
curr_Factors:  [99.03383765 -0.93496266 -0.96598712]
mat_Sqrt:  [[14.7982926   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.21560984 -0.97265236 -2.5120991 ]
Stock Position:  -0.21560983716725718
Bond Position:  [18.15729817]


portfolio before change:  [-3.27230675]
curr_Stock_Price:  99.4117202207673
curr_Factors:  [99.41172022 -1.16980876 -0.97612283]
mat_Sqrt:  [[11.62709813  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00660586  0.04954889 -0.19158824]
Stock Position:  0.006605861243667658
Bond Position:  [-3.92900678]


portfolio before change:  [-3.26956344]
curr_Stock_Price:  99.97571624099677
curr_Factors:  [99.97571624 -1.40877066 -1.03008317]
mat_Sqrt:  [[ 8.72396197  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.02675404  0.01986817 -0.8999682 ]
Stock Position:  0.02675404110691841
Bond Position:  [-5.94431786]


portfolio before change:  [-3.24156871]
curr_Stock_Price:  101.07764317193994
curr_Factors:  [101.07764317  -1.73024008  -1.01291634]
mat_Sqrt:  [[ 6.50605019  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02235046 -0.02956572  0.03230753]
Stock Position:  -0.02235045949894853
Bond Position:  [-0.98243694]


portfolio before change:  [-3.24095891]
curr_Stock_Price:  101.03936930587867
curr_Factors:  [101.03936931  -1.66195956  -1.03205661]
mat_Sqrt:  [[ 6.83115704  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00278918 0.00936492 0.11668265]
Stock Position:  0.0027891834529199305
Bond Position:  [-3.52277625]


portfolio before change:  [-3.24319088]
curr_Stock_Price:  100.55494034015749
curr_Factors:  [100.55494034  -1.33688669  -1.06765662]
mat_Sqrt:  [[ 9.08078765  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01012336 0.03751834 0.02684586]
Stock Position:  0.010123362733888626
Bond Position:  [-4.26114501]


portfolio before change:  [-3.24708132]
curr_Stock_Price:  100.27588083835079
curr_Factors:  [100.27588084  -0.92395214  -1.03548858]
mat_Sqrt:  [[14.1326041   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00696328  0.02736863 -0.19493244]
Stock Position:  0.006963278953415182
Bond Position:  [-3.94533025]


portfolio before change:  [-3.2485157]
curr_Stock_Price:  100.21155360767874
curr_Factors:  [100.21155361  -0.71815795  -1.06355182]
mat_Sqrt:  [[16.87062127  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.07047886 -0.14406881 -0.11271845]
Stock Position:  -0.07047886434157238
Bond Position:  [3.81428079]


portfolio before change:  [-3.3547645]
curr_Stock_Price:  101.73261226116725
curr_Factors:  [101.73261226  -0.88602478  -1.05119504]
mat_Sqrt:  [[14.6600793   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.02983172 0.03560516 0.12141965]
Stock Position:  0.02983172357897951
Bond Position:  [-6.38962366]


portfolio before change:  [-3.3561956]
curr_Stock_Price:  101.73819355291121
curr_Factors:  [101.73819355  -0.62831451  -1.03541535]
mat_Sqrt:  [[19.27237894  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00571218 -0.0065548   0.08891391]
Stock Position:  -0.005712180703913225
Bond Position:  [-2.77504866]


portfolio before change:  [-3.36082614]
curr_Stock_Price:  102.42736777874951
curr_Factors:  [102.42736778  -1.05677338  -1.02868574]
mat_Sqrt:  [[12.72660668  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.07038249 -0.34261884  0.7367601 ]
Stock Position:  -0.0703824865122453
Bond Position:  [3.84826669]


portfolio before change:  [-3.31433614]
curr_Stock_Price:  101.78050493933472
curr_Factors:  [101.78050494  -1.36540348  -0.9964614 ]
mat_Sqrt:  [[ 9.59223295  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00075734  0.00188108  0.05963212]
Stock Position:  -0.0007573350897434819
Bond Position:  [-3.23725419]


portfolio before change:  [-3.31531447]
curr_Stock_Price:  102.0035485451384
curr_Factors:  [102.00354855  -1.21894574  -0.99832988]
mat_Sqrt:  [[11.10873771  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01002237  0.04017199 -0.30003456]
Stock Position:  0.010022370640905645
Bond Position:  [-4.33763184]


portfolio before change:  [-3.30851259]
curr_Stock_Price:  102.79043088337785
curr_Factors:  [102.79043088  -1.12418946  -1.00931782]
mat_Sqrt:  [[12.17256911  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00829744 0.00888898 0.15477055]
Stock Position:  0.008297440517043642
Bond Position:  [-4.16141007]


portfolio before change:  [-3.3073666]
curr_Stock_Price:  103.05394274646699
curr_Factors:  [103.05394275  -1.06586068  -1.02865156]
mat_Sqrt:  [[12.68906163  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00247158  0.00526652 -0.00076509]
Stock Position:  0.0024715834606063333
Bond Position:  [-3.56207302]


portfolio before change:  [-3.30640866]
curr_Stock_Price:  103.80186965895079
curr_Factors:  [103.80186966  -0.87313291  -1.02209242]
mat_Sqrt:  [[15.59980882  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00124105 -0.03060035  0.50497938]
Stock Position:  0.001241054565016347
Bond Position:  [-3.43523245]


portfolio before change:  [-3.3088084]
curr_Stock_Price:  102.56032441620397
curr_Factors:  [102.56032442  -0.69318679  -1.01041239]
mat_Sqrt:  [[18.66876815  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00014227  0.01049774 -0.0468076 ]
Stock Position:  -0.00014226721311457686
Bond Position:  [-3.29421743]


portfolio before change:  [-3.30965895]
curr_Stock_Price:  102.74929622952064
curr_Factors:  [102.74929623  -0.73532766  -1.06735691]
mat_Sqrt:  [[16.93880989  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00790406 -0.17517192 -1.16346037]
Stock Position:  -0.007904062597375788
Bond Position:  [-2.49752208]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-3.30093225]
Stock Price:  101.56621459155285
PL:  [-4.86714684]
Settle:  Tensor("sub_254:0", shape=(), dtype=float64)
PL:  Tensor("sub_255:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  128
output_Z_Vals[:, i, :]:  [[ 1.19271183e+02 -4.92738716e+01 -4.92570741e+01]
 [ 5.73321317e-02  1.01003415e-01 -2.78408190e-02]
 [-2.13492842e+00 -2.87535776e+00 -8.18606601e-01]
 [ 6.51949818e-02  1.66313401e-01 -6.76860323e-02]
 [ 1.01277481e+00 -1.53525031e-01 -4.63146654e-01]
 [ 7.57175145e-02  1.17192732e-01 -6.73936232e-03]
 [-2.58535926e-02  4.68579379e-02 -2.73553076e-02]
 [ 8.23481161e-02  1.57931565e-01  2.86426330e-02]
 [ 5.92055198e-02 -7.48901127e-03 -3.72479765e-02]
 [-1.07698939e+00 -4.41461404e-01 -3.88508358e-02]
 [ 1.87069114e-01 -8.75812385e-03 -1.36236373e-01]
 [-6.53283475e-03 -4.80755934e-02  3.06186246e-02]
 [-5.83781847e-01 -1.31078660e+00  2.09527985e-01]
 [ 3.14253463e-02  4.54433067e-02  1.07263921e-01]
 [ 9.08235748e-02  1.25603497e-01 -1.03972546e-01]
 [-4.59506118e-02  6.26013377e-02  1.15924361e-01]
 [ 1.25539909e-01  1.15578973e-01  1.03380930e-01]
 [ 8.92374315e-02 -1.86128411e-02  4.10073846e-02]
 [-4.25675412e-02  2.22033089e-02 -6.68249602e-02]
 [ 7.25192135e-02 -6.07599549e-01 -5.02949958e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.27118322 -49.27387164 -49.25707411]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [   7.3268874   -15.90307369 -140.51672192]
init_Out:  [2.48374395]
Stock Position:  7.326887399052493
Bond position:  [-730.20499595]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [0.17500073]
curr_Stock_Price:  99.7098127712359
curr_Factors:  [99.70981277 -1.39522644 -0.95210991]
mat_Sqrt:  [[ 9.53460438  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00757938  0.03259871 -0.07942211]
Stock Position:  0.0075793794111235985
Bond Position:  [-0.58073777]


portfolio before change:  [0.1781175]
curr_Stock_Price:  100.14018673506433
curr_Factors:  [100.14018674  -1.21638821  -0.89548247]
mat_Sqrt:  [[12.11810228  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.23840001 -0.92801773 -2.33525678]
Stock Position:  -0.2384000125868872
Bond Position:  [24.05153927]


portfolio before change:  [0.29180724]
curr_Stock_Price:  99.68852522213699
curr_Factors:  [99.68852522 -0.59957021 -0.85977368]
mat_Sqrt:  [[23.16648664  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00368322  0.05367742 -0.19308941]
Stock Position:  0.0036832175014195534
Bond Position:  [-0.07536728]


portfolio before change:  [0.2921687]
curr_Stock_Price:  99.79177651398658
curr_Factors:  [99.79177651 -0.64169245 -0.86826104]
mat_Sqrt:  [[22.04602458  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.04022935 -0.04954999 -1.32122849]
Stock Position:  0.04022934964435663
Bond Position:  [-3.72238957]


portfolio before change:  [0.32787019]
curr_Stock_Price:  100.70236065956315
curr_Factors:  [100.70236066  -0.78762435  -0.87709836]
mat_Sqrt:  [[19.05722959  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00515624  0.03782379 -0.01922552]
Stock Position:  0.005156243393780834
Bond Position:  [-0.19137569]


portfolio before change:  [0.31411913]
curr_Stock_Price:  98.044764148574
curr_Factors:  [98.04476415 -0.99407556 -0.84760557]
mat_Sqrt:  [[15.54506186  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00140705  0.01512333 -0.07803708]
Stock Position:  -0.0014070471442469445
Bond Position:  [0.45207273]


portfolio before change:  [0.31267174]
curr_Stock_Price:  99.15376336723229
curr_Factors:  [99.15376337 -0.98016833 -0.85841912]
mat_Sqrt:  [[15.76960509  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.007637   0.05097219 0.08170946]
Stock Position:  0.007636996242817705
Bond Position:  [-0.44456517]


portfolio before change:  [0.31214154]
curr_Stock_Price:  99.098892294385
curr_Factors:  [99.09889229 -1.01087306 -0.86094667]
mat_Sqrt:  [[15.24571582  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00328444 -0.00241707 -0.10625811]
Stock Position:  0.0032844387877177007
Bond Position:  [-0.01334271]


portfolio before change:  [0.31985171]
curr_Stock_Price:  101.44739206040593
curr_Factors:  [101.44739206  -1.11719766  -0.81811922]
mat_Sqrt:  [[14.64682351  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.08022441 -0.14248106 -0.11083062]
Stock Position:  -0.08022440600834538
Bond Position:  [8.45840848]


portfolio before change:  [0.50507828]
curr_Stock_Price:  99.1648982770359
curr_Factors:  [99.16489828 -1.04429082 -0.78829542]
mat_Sqrt:  [[15.86630801  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00992495 -0.00282667 -0.38864445]
Stock Position:  0.009924945152846157
Bond Position:  [-0.4791279]


portfolio before change:  [0.49464399]
curr_Stock_Price:  98.12564895209604
curr_Factors:  [98.12564895 -0.99597063 -0.77995235]
mat_Sqrt:  [[16.61533084  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00060765 -0.01551633  0.08734641]
Stock Position:  -0.0006076450521374728
Bond Position:  [0.55426956]


portfolio before change:  [0.49391423]
curr_Stock_Price:  99.5546879397215
curr_Factors:  [99.55468794 -0.86742556 -0.79051366]
mat_Sqrt:  [[18.96827588  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.04262777 -0.42305456  0.59772502]
Stock Position:  -0.042627771016769976
Bond Position:  [4.73770867]


portfolio before change:  [0.52810745]
curr_Stock_Price:  98.78034176657866
curr_Factors:  [98.78034177 -0.68609791 -0.78355007]
mat_Sqrt:  [[22.72011453  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00275512 0.01466676 0.30599411]
Stock Position:  0.002755117207405605
Bond Position:  [0.25595604]


portfolio before change:  [0.5297223]
curr_Stock_Price:  99.34323996862459
curr_Factors:  [99.34323997 -0.70472495 -0.84678547]
mat_Sqrt:  [[21.05357765  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00452365  0.04053835 -0.29660473]
Stock Position:  0.004523647991305865
Bond Position:  [0.08032845]


portfolio before change:  [0.5301049]
curr_Stock_Price:  99.42337669171152
curr_Factors:  [99.42337669 -0.95683353 -0.7992142 ]
mat_Sqrt:  [[17.17301963  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00055373  0.02020449  0.33069993]
Stock Position:  -0.0005537294145838841
Bond Position:  [0.58515855]


portfolio before change:  [0.53004125]
curr_Stock_Price:  99.80253671966385
curr_Factors:  [99.80253672 -0.882089   -0.78201881]
mat_Sqrt:  [[18.89856135  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00900782 0.03730295 0.29491702]
Stock Position:  0.009007823893152193
Bond Position:  [-0.36896242]


portfolio before change:  [0.53650339]
curr_Stock_Price:  100.53016983432313
curr_Factors:  [100.53016983  -1.24926241  -0.7538805 ]
mat_Sqrt:  [[13.56258596  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00691673 -0.00600727  0.11698265]
Stock Position:  0.006916726562421985
Bond Position:  [-0.1588363]


portfolio before change:  [0.53318753]
curr_Stock_Price:  100.05651333091116
curr_Factors:  [100.05651333  -1.04603856  -0.76009103]
mat_Sqrt:  [[16.43816178  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00314365  0.00716609 -0.19063301]
Stock Position:  -0.003143654275862269
Bond Position:  [0.84773061]


portfolio before change:  [0.52937329]
curr_Stock_Price:  101.33725034322305
curr_Factors:  [101.33725034  -1.0515953   -0.78495612]
mat_Sqrt:  [[16.14971885  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00954634 -0.19610191 -1.43477624]
Stock Position:  -0.00954634299892734
Bond Position:  [1.49677344]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [0.53357166]
Stock Price:  100.93666460035129
PL:  [-0.40309294]
Settle:  Tensor("sub_256:0", shape=(), dtype=float64)
PL:  Tensor("sub_257:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  129
output_Z_Vals[:, i, :]:  [[ 1.19271183e+02 -4.92738716e+01 -4.92570741e+01]
 [ 6.70965462e-02  1.09657391e-01 -4.44200460e-02]
 [-2.44090787e+00 -3.28338923e+00 -9.36642554e-01]
 [ 8.43891563e-02  2.63797320e-01 -5.64597516e-02]
 [ 5.51234294e-01  1.74539293e-01 -5.20007998e-01]
 [ 5.12256447e-02  8.01854950e-02 -1.72854557e-03]
 [-1.26157480e-02  3.15883278e-02 -6.41413621e-03]
 [ 8.25483351e-02  1.89735162e-01  6.53227692e-02]
 [ 9.23362775e-02  7.78163029e-02 -6.59803291e-02]
 [-1.10122587e+00 -4.35058259e-01 -4.04323137e-02]
 [ 3.49654320e-01  3.94267503e-02 -4.25255800e-02]
 [ 4.48937795e-02 -6.46960185e-02  3.74089303e-02]
 [-6.82651259e-01 -1.21490164e+00  2.40952157e-01]
 [-1.41900815e-04  1.73129902e-02  4.58040181e-02]
 [ 1.10043692e-01  1.28417947e-01 -1.05556936e-01]
 [ 7.37723042e-02  3.03764526e-02  5.92403614e-02]
 [ 1.08789636e-02 -5.33344593e-04 -1.70354132e-02]
 [ 6.90311693e-02 -4.55175139e-02  4.62310906e-02]
 [-4.87898849e-03  3.57098746e-02 -1.97799187e-02]
 [ 8.54676648e-02 -7.13562009e-01 -4.74445407e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.27118322 -49.27387164 -49.25707411]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [   7.3268874   -15.90307369 -140.51672192]
init_Out:  [2.48374395]
Stock Position:  7.326887399052493
Bond position:  [-730.20499595]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-6.65194378]
curr_Stock_Price:  98.77804677803896
curr_Factors:  [98.77804678 -0.54317727 -1.00121923]
mat_Sqrt:  [[21.08324993  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00381407  0.03539177 -0.12671803]
Stock Position:  0.0038140734405773154
Bond Position:  [-7.02869051]


portfolio before change:  [-6.64586923]
curr_Stock_Price:  100.83148091438896
curr_Factors:  [100.83148091  -0.52220746  -1.04920066]
mat_Sqrt:  [[20.94798571  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.15764371 -1.05970932 -2.67198049]
Stock Position:  -0.15764371324996604
Bond Position:  [9.24957984]


portfolio before change:  [-6.60452458]
curr_Stock_Price:  100.58388482606459
curr_Factors:  [100.58388483  -0.93217994  -1.07218155]
mat_Sqrt:  [[13.55330687  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00934914  0.08514022 -0.16106396]
Stock Position:  0.00934913976483869
Bond Position:  [-7.54489737]


portfolio before change:  [-6.59254491]
curr_Stock_Price:  102.06702899649865
curr_Factors:  [102.067029    -1.12591448  -1.06716132]
mat_Sqrt:  [[11.38792907  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.04221275  0.05633231 -1.48343808]
Stock Position:  0.042212748804264
Bond Position:  [-10.90107477]


portfolio before change:  [-6.67333259]
curr_Stock_Price:  100.21777564393167
curr_Factors:  [100.21777564  -1.01291842  -1.04361715]
mat_Sqrt:  [[12.81748184  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00524601  0.02587976 -0.00493106]
Stock Position:  0.0052460072310278084
Bond Position:  [-7.19907577]


portfolio before change:  [-6.6805176]
curr_Stock_Price:  99.19127841550748
curr_Factors:  [99.19127842 -1.10466169 -1.04757746]
mat_Sqrt:  [[11.52836984  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00064858  0.01019509 -0.01829775]
Stock Position:  -0.000648581523196766
Bond Position:  [-6.61618397]


portfolio before change:  [-6.68271257]
curr_Stock_Price:  100.0249769277996
curr_Factors:  [100.02497693  -1.11389921  -1.05237998]
mat_Sqrt:  [[11.4631866   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01174297 0.06123676 0.18634768]
Stock Position:  0.011742966596016613
Bond Position:  [-7.85730253]


portfolio before change:  [-6.68795917]
curr_Stock_Price:  99.74548792529468
curr_Factors:  [99.74548793 -0.91866644 -1.02762838]
mat_Sqrt:  [[14.24387514  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00665214  0.0251151  -0.18822351]
Stock Position:  0.006652142387672487
Bond Position:  [-7.35148036]


portfolio before change:  [-6.6802907]
curr_Stock_Price:  101.17458679869547
curr_Factors:  [101.1745868   -1.43179284  -0.99944061]
mat_Sqrt:  [[ 8.89611054  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.13469763 -0.14041445 -0.11534214]
Stock Position:  -0.1346976263643129
Bond Position:  [6.94768599]


portfolio before change:  [-6.59253324]
curr_Stock_Price:  100.53596881383308
curr_Factors:  [100.53596881  -1.34151738  -0.97806327]
mat_Sqrt:  [[ 9.88417426  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.03531117  0.01272493 -0.12131364]
Stock Position:  0.035311171666033404
Bond Position:  [-10.14257609]


portfolio before change:  [-6.61234351]
curr_Stock_Price:  100.0467662258934
curr_Factors:  [100.04676623  -1.18079592  -0.95820542]
mat_Sqrt:  [[11.78274768  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00333741 -0.02088055  0.10671727]
Stock Position:  0.0033374071136408967
Bond Position:  [-6.9462403]


portfolio before change:  [-6.61157639]
curr_Stock_Price:  100.79701903675765
curr_Factors:  [100.79701904  -1.52215563  -0.96659274]
mat_Sqrt:  [[ 8.36754395  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.10534248 -0.39210782  0.68736944]
Stock Position:  -0.10534248380258861
Bond Position:  [4.00663195]


portfolio before change:  [-6.62761458]
curr_Stock_Price:  100.95877683716579
curr_Factors:  [100.95877684  -1.13901803  -0.95596447]
mat_Sqrt:  [[12.42523871  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00102548 0.00558774 0.13066611]
Stock Position:  0.001025477647427058
Bond Position:  [-6.73114555]


portfolio before change:  [-6.62930711]
curr_Stock_Price:  100.94948263689808
curr_Factors:  [100.94948264  -0.92645057  -0.93546535]
mat_Sqrt:  [[15.68499157  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00731337  0.04144671 -0.30112456]
Stock Position:  0.007313371854983599
Bond Position:  [-7.36758821]


portfolio before change:  [-6.62165278]
curr_Stock_Price:  102.24798843764229
curr_Factors:  [102.24798844  -0.93062136  -0.9736506 ]
mat_Sqrt:  [[15.22789833  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00604583 0.00980396 0.16899626]
Stock Position:  0.006045828368284167
Bond Position:  [-7.23982657]


portfolio before change:  [-6.61411094]
curr_Stock_Price:  103.79484324914876
curr_Factors:  [103.79484325  -0.83791796  -0.97296026]
mat_Sqrt:  [[16.97154411  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0004297  -0.00017214 -0.04859729]
Stock Position:  0.0004297049180803441
Bond Position:  [-6.6587121]


portfolio before change:  [-6.6164171]
curr_Stock_Price:  102.30249300955771
curr_Factors:  [102.30249301  -1.2146434   -0.9744608 ]
mat_Sqrt:  [[11.45962328  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00603657 -0.01469071  0.13188443]
Stock Position:  0.006036570824298863
Bond Position:  [-7.23397334]


portfolio before change:  [-6.61674099]
curr_Stock_Price:  102.54846510335109
curr_Factors:  [102.5484651   -0.89127382  -0.97128179]
mat_Sqrt:  [[15.92324376  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0001022   0.01152531 -0.0564266 ]
Stock Position:  -0.00010219650416453062
Bond Position:  [-6.60626089]


portfolio before change:  [-6.61843275]
curr_Stock_Price:  102.93980219148139
curr_Factors:  [102.93980219  -1.17125847  -0.97504199]
mat_Sqrt:  [[12.03529892  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01304773 -0.23030115 -1.35346069]
Stock Position:  -0.013047730239187242
Bond Position:  [-5.27530198]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-6.61774745]
Stock Price:  102.78618957999947
PL:  [-9.40393703]
Settle:  Tensor("sub_258:0", shape=(), dtype=float64)
PL:  Tensor("sub_259:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  130
output_Z_Vals[:, i, :]:  [[ 1.19271183e+02 -4.92738716e+01 -4.92570741e+01]
 [ 2.23339428e-02  4.47748866e-02 -4.40822311e-02]
 [-2.24470230e+00 -3.02174405e+00 -8.60953446e-01]
 [ 4.12704679e-02  1.31655579e-01 -7.90473051e-02]
 [ 1.66045450e-01  6.76601877e-03 -1.99646863e-01]
 [-1.28713147e-01 -1.66122237e-01 -1.11538871e-01]
 [-5.62161474e-02  7.75996056e-02 -1.37265174e-01]
 [ 4.86932973e-02  1.00007101e-01  9.68906168e-04]
 [ 4.89266946e-02  6.63290566e-02 -3.43739190e-02]
 [-7.23955134e-01 -2.77023126e-01 -2.12927788e-02]
 [ 4.95458272e-02 -4.47234661e-02 -2.94835850e-01]
 [ 9.67131873e-02  2.58994516e-02  2.04599834e-02]
 [-5.92934901e-01 -1.19233211e+00  2.06557329e-01]
 [ 4.02433497e-02  5.31207737e-02  1.24163610e-01]
 [ 8.39554028e-02  1.24762190e-01 -1.02856481e-01]
 [-8.38435445e-02  7.30064666e-02  1.31763648e-01]
 [ 4.67466188e-02  1.17311273e-01  1.31985777e-01]
 [ 1.15216134e-01 -1.08333916e-02 -3.18137274e-02]
 [-5.62388587e-02 -1.94936198e-01  3.78565107e-02]
 [ 8.48140069e-02 -6.61654757e-01 -6.24873675e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.27118322 -49.27387164 -49.25707411]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [   7.3268874   -15.90307369 -140.51672192]
init_Out:  [2.48374395]
Stock Position:  7.326887399052493
Bond position:  [-730.20499595]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [6.51817049]
curr_Stock_Price:  100.57555144198953
curr_Factors:  [100.57555144  -1.25341546  -1.02038743]
mat_Sqrt:  [[10.35123995  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00217127  0.01445103 -0.12575434]
Stock Position:  0.0021712693974328527
Bond Position:  [6.29979387]


portfolio before change:  [6.51777293]
curr_Stock_Price:  99.66700015189026
curr_Factors:  [99.66700015 -0.92628489 -1.04555097]
mat_Sqrt:  [[13.87375294  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.21892091 -0.9752637  -2.45606054]
Stock Position:  -0.21892090893166855
Bond Position:  [28.33696319]


portfolio before change:  [6.58188561]
curr_Stock_Price:  99.40650624699018
curr_Factors:  [99.40650625 -1.17872884 -1.04362106]
mat_Sqrt:  [[10.77111127  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00482857  0.04249166 -0.22549996]
Stock Position:  0.004828572049366327
Bond Position:  [6.10189414]


portfolio before change:  [6.58203351]
curr_Stock_Price:  99.12116900918575
curr_Factors:  [99.12116901 -1.28532106 -1.07202258]
mat_Sqrt:  [[ 9.38393687  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01349901  0.00218372 -0.56953693]
Stock Position:  0.013499005241679128
Bond Position:  [5.24399633]


portfolio before change:  [6.57127756]
curr_Stock_Price:  98.22724288639715
curr_Factors:  [98.22724289 -1.69405354 -1.07999295]
mat_Sqrt:  [[ 6.13025965  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.03024186 -0.05361572 -0.31818935]
Stock Position:  -0.030241864805122153
Bond Position:  [9.54185256]


portfolio before change:  [6.59157243]
curr_Stock_Price:  97.63504692851154
curr_Factors:  [97.63504693 -1.47735707 -1.05597285]
mat_Sqrt:  [[ 7.75165678  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00882332  0.02504517 -0.39157933]
Stock Position:  -0.008823317700863118
Bond Position:  [7.45303747]


portfolio before change:  [6.59324089]
curr_Stock_Price:  97.65715125270474
curr_Factors:  [97.65715125 -1.23249326 -1.02146053]
mat_Sqrt:  [[10.25237198  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00675989 0.03227715 0.00276402]
Stock Position:  0.006759893081027311
Bond Position:  [5.93308899]


portfolio before change:  [6.5971753]
curr_Stock_Price:  98.01972476204988
curr_Factors:  [98.01972476 -1.02668138 -1.01964375]
mat_Sqrt:  [[12.66501667  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00437816  0.02140761 -0.09805922]
Stock Position:  0.004378163184011432
Bond Position:  [6.16802895]


portfolio before change:  [6.58774288]
curr_Stock_Price:  95.51305087138013
curr_Factors:  [95.51305087 -0.80702568 -1.04410468]
mat_Sqrt:  [[15.00123496  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.05231893 -0.08940883 -0.06074237]
Stock Position:  -0.05231893340611937
Bond Position:  [11.58488382]


portfolio before change:  [6.53164333]
curr_Stock_Price:  96.64067565968368
curr_Factors:  [96.64067566 -0.65638881 -1.05817478]
mat_Sqrt:  [[17.39940707  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00113604 -0.01443444 -0.84108461]
Stock Position:  -0.0011360403215694677
Bond Position:  [6.64143104]


portfolio before change:  [6.53413893]
curr_Stock_Price:  95.9056398054486
curr_Factors:  [95.90563981 -0.54018033 -1.04984943]
mat_Sqrt:  [[19.55703418  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00542906 0.00835901 0.05836664]
Stock Position:  0.005429057719307463
Bond Position:  [6.01346167]


portfolio before change:  [6.54323783]
curr_Stock_Price:  97.30465707462034
curr_Factors:  [97.30465707 -0.45350246 -1.04843388]
mat_Sqrt:  [[21.66960319  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.03664836 -0.38482353  0.58925057]
Stock Position:  -0.03664835617424036
Bond Position:  [10.10929356]


portfolio before change:  [6.49803587]
curr_Stock_Price:  98.60702376178655
curr_Factors:  [98.60702376 -0.71549025 -1.04688172]
mat_Sqrt:  [[16.92463967  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00451598 0.01714466 0.35420422]
Stock Position:  0.0045159822823640835
Bond Position:  [6.0527283]


portfolio before change:  [6.49428991]
curr_Stock_Price:  97.44242037018324
curr_Factors:  [97.44242037 -0.52610972 -1.05300478]
mat_Sqrt:  [[20.08849275  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00440187  0.04026682 -0.29342091]
Stock Position:  0.004401867675748144
Bond Position:  [6.06536127]


portfolio before change:  [6.49813313]
curr_Stock_Price:  97.97098935678481
curr_Factors:  [97.97098936 -0.5248709  -1.0315228 ]
mat_Sqrt:  [[20.66161656  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00203493  0.02356274  0.37588501]
Stock Position:  -0.002034933704721038
Bond Position:  [6.6974976]


portfolio before change:  [6.50249432]
curr_Stock_Price:  96.65074533166964
curr_Factors:  [96.65074533 -0.74949803 -1.078548  ]
mat_Sqrt:  [[15.53441492  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00628502 0.03786205 0.37651868]
Stock Position:  0.006285023705280789
Bond Position:  [5.8950421]


portfolio before change:  [6.51136408]
curr_Stock_Price:  97.82748077796526
curr_Factors:  [97.82748078 -0.82943623 -1.10049042]
mat_Sqrt:  [[14.20052411  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00750049 -0.00349646 -0.09075571]
Stock Position:  0.007500485672204266
Bond Position:  [5.77761046]


portfolio before change:  [6.51073556]
curr_Stock_Price:  97.5510849095493
curr_Factors:  [97.55108491 -0.8443915  -1.08941693]
mat_Sqrt:  [[14.10554175  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00626014 -0.06291539  0.10799409]
Stock Position:  -0.006260136423206049
Bond Position:  [7.12141866]


portfolio before change:  [6.50575492]
curr_Stock_Price:  98.63112826779181
curr_Factors:  [98.63112827 -1.12558355 -1.10947606]
mat_Sqrt:  [[10.55212538  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01684945 -0.21354815 -1.78259066]
Stock Position:  -0.016849450052024862
Bond Position:  [8.16763519]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [6.52255751]
Stock Price:  97.7551100311972
PL:  [6.52255751]
Settle:  Tensor("sub_260:0", shape=(), dtype=float64)
PL:  Tensor("sub_261:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  131
output_Z_Vals[:, i, :]:  [[ 1.19271183e+02 -4.92738716e+01 -4.92570741e+01]
 [ 4.32343441e-02  7.83537329e-02 -3.43830998e-02]
 [-1.93333896e+00 -2.60653302e+00 -7.40840582e-01]
 [-1.41295828e-02  1.89489700e-01  1.30654869e-02]
 [ 4.51911308e-01  1.63804155e-01 -4.68494118e-01]
 [ 7.57175145e-02  1.17192732e-01 -6.73936232e-03]
 [ 2.04941274e-02  3.32973641e-02  1.12229283e-01]
 [ 4.97893468e-02  1.65738871e-01  9.71498802e-02]
 [-1.02063286e-02 -1.86211140e-01  2.29488267e-02]
 [-1.30934946e+00 -5.05249189e-01 -5.13519091e-02]
 [ 4.29406566e-01  8.33191974e-02  6.71459487e-02]
 [-1.78343044e-01 -7.27060657e-03  2.85385384e-02]
 [-7.95355018e-01 -1.08221863e+00  2.83718231e-01]
 [-2.00586851e-02 -2.80848091e-02 -2.18749635e-02]
 [ 6.57578342e-02  1.18104633e-01 -1.02084042e-01]
 [ 1.23516412e-01  1.69872184e-02  3.56885214e-02]
 [ 3.75133843e-02  2.55500697e-02  8.91824538e-03]
 [ 6.37784090e-02 -5.51051525e-02  3.99744247e-02]
 [-4.35827302e-02 -4.83490343e-02 -2.28851717e-02]
 [ 6.12116310e-02 -5.36494330e-01 -4.46973742e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.27118322 -49.27387164 -49.25707411]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [   7.3268874   -15.90307369 -140.51672192]
init_Out:  [2.48374395]
Stock Position:  7.326887399052493
Bond position:  [-730.20499595]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-0.6734425]
curr_Stock_Price:  99.59401418104417
curr_Factors:  [99.59401418 -1.05864617 -1.02167433]
mat_Sqrt:  [[12.43831418  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0041975   0.02528856 -0.09808541]
Stock Position:  0.004197499052989803
Bond Position:  [-1.09148828]


portfolio before change:  [-0.66950502]
curr_Stock_Price:  100.59708461442897
curr_Factors:  [100.59708461  -1.42130922  -1.02039368]
mat_Sqrt:  [[ 8.75320898  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.29893251 -0.84125492 -2.11341197]
Stock Position:  -0.2989325102525053
Bond Position:  [29.40223401]


portfolio before change:  [-0.8649039]
curr_Stock_Price:  101.27533255486335
curr_Factors:  [101.27533255  -1.33225891  -1.01892219]
mat_Sqrt:  [[ 9.64714269  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00282123 0.06115754 0.0372722 ]
Stock Position:  0.0028212313722856667
Bond Position:  [-1.15062505]


portfolio before change:  [-0.86456609]
curr_Stock_Price:  101.49704555462709
curr_Factors:  [101.49704555  -1.29097836  -1.05066796]
mat_Sqrt:  [[ 9.76088795  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.03992636  0.05286756 -1.33648331]
Stock Position:  0.03992636033370562
Bond Position:  [-4.9169737]


portfolio before change:  [-0.86188837]
curr_Stock_Price:  101.59490369507637
curr_Factors:  [101.5949037   -0.95643008  -1.01687479]
mat_Sqrt:  [[14.12135949  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00695852  0.03782379 -0.01922552]
Stock Position:  0.006958516582655663
Bond Position:  [-1.56883819]


portfolio before change:  [-0.85992882]
curr_Stock_Price:  101.93287809794339
curr_Factors:  [101.9328781   -0.88953343  -1.02865727]
mat_Sqrt:  [[14.97113234  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.0033531  0.01074668 0.32015891]
Stock Position:  0.003353095059487238
Bond Position:  [-1.20171945]


portfolio before change:  [-0.86065168]
curr_Stock_Price:  101.80690742599312
curr_Factors:  [101.80690743  -1.06058516  -1.01302084]
mat_Sqrt:  [[12.8003429   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00808192 0.05349199 0.27714157]
Stock Position:  0.00808191540406441
Bond Position:  [-1.6834465]


portfolio before change:  [-0.85598287]
curr_Stock_Price:  102.43667507059868
curr_Factors:  [102.43667507  -1.16579949  -1.04213797]
mat_Sqrt:  [[11.26057104  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00386589 -0.06009939  0.06546661]
Stock Position:  -0.003865888201300005
Bond Position:  [-0.45997414]


portfolio before change:  [-0.85852938]
curr_Stock_Price:  103.0656386265404
curr_Factors:  [103.06563863  -1.39852782  -1.06591493]
mat_Sqrt:  [[ 8.76637441  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.16232083 -0.16306847 -0.1464927 ]
Stock Position:  -0.16232083177653425
Bond Position:  [15.87117081]


portfolio before change:  [-0.9815584]
curr_Stock_Price:  103.84802314986553
curr_Factors:  [103.84802315  -1.37459928  -1.04042859]
mat_Sqrt:  [[ 9.28036284  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.04957997 0.02689116 0.1915487 ]
Stock Position:  0.049579972531972646
Bond Position:  [-6.13034053]


portfolio before change:  [-0.95847711]
curr_Stock_Price:  104.34447497057492
curr_Factors:  [104.34447497  -1.19875431  -1.08566623]
mat_Sqrt:  [[10.62571649  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01637553 -0.00234658  0.08141251]
Stock Position:  -0.0163755305995052
Bond Position:  [0.75021904]


portfolio before change:  [-0.95189294]
curr_Stock_Price:  103.95385623768617
curr_Factors:  [103.95385624  -1.1122489   -1.06477985]
mat_Sqrt:  [[11.78607039  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.08131194 -0.34928456  0.80936914]
Stock Position:  -0.08131193836588624
Bond Position:  [7.50079661]


portfolio before change:  [-0.93543334]
curr_Stock_Price:  103.77449555820212
curr_Factors:  [103.77449556  -1.20094806  -1.03176783]
mat_Sqrt:  [[11.12844396  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00271886 -0.00906433 -0.06240318]
Stock Position:  -0.0027188599890277444
Bond Position:  [-0.65328502]


portfolio before change:  [-0.93404644]
curr_Stock_Price:  103.20431258102595
curr_Factors:  [103.20431258  -1.25236759  -1.03816491]
mat_Sqrt:  [[10.44557181  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00660835  0.03811811 -0.29121736]
Stock Position:  0.006608352784125077
Bond Position:  [-1.61605694]


portfolio before change:  [-0.9283015]
curr_Stock_Price:  104.13480211374657
curr_Factors:  [104.13480211  -1.19547564  -1.0532246 ]
mat_Sqrt:  [[10.99000248  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01221736 0.0054826  0.10180942]
Stock Position:  0.012217358669338587
Bond Position:  [-2.20055372]


portfolio before change:  [-0.94220174]
curr_Stock_Price:  103.04209128890952
curr_Factors:  [103.04209129  -0.85336408  -1.02028117]
mat_Sqrt:  [[15.82343879  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00281539 0.00824625 0.02544127]
Stock Position:  0.0028153930534776106
Bond Position:  [-1.23230573]


portfolio before change:  [-0.94391282]
curr_Stock_Price:  102.54377236048605
curr_Factors:  [102.54377236  -0.71439853  -1.01966635]
mat_Sqrt:  [[18.10566497  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00335198 -0.01778511  0.11403591]
Stock Position:  0.0033519819504200807
Bond Position:  [-1.2876377]


portfolio before change:  [-0.95148372]
curr_Stock_Price:  100.38118808459724
curr_Factors:  [100.38118808  -0.82206864  -1.0309834 ]
mat_Sqrt:  [[15.73555468  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00369376 -0.01560458 -0.06528502]
Stock Position:  -0.0036937593098534966
Bond Position:  [-0.58069977]


portfolio before change:  [-0.95536543]
curr_Stock_Price:  101.39276491190753
curr_Factors:  [101.39276491  -0.74166909  -1.02954155]
mat_Sqrt:  [[17.24963695  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00808933 -0.1731528  -1.27509167]
Stock Position:  -0.008089326683485968
Bond Position:  [-0.13516623]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-0.95312924]
Stock Price:  101.11215048490965
PL:  [-2.06527973]
Settle:  Tensor("sub_262:0", shape=(), dtype=float64)
PL:  Tensor("sub_263:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  132
output_Z_Vals[:, i, :]:  [[ 1.19271183e+02 -4.92738716e+01 -4.92570741e+01]
 [ 2.29538100e-02  4.51519003e-02 -4.45589289e-02]
 [-2.00281504e+00 -2.69918117e+00 -7.67641976e-01]
 [ 9.20935509e-02  2.32954305e-01 -5.17164802e-02]
 [ 3.54626834e-01  2.33382813e-01 -4.73340610e-01]
 [ 7.57175145e-02  1.17192732e-01 -6.73936232e-03]
 [ 1.57109449e-02  2.25449670e-02  1.04803151e-01]
 [ 9.02056653e-02  2.73714588e-01  1.77276418e-01]
 [ 3.65797267e-03 -1.50513237e-01  1.09251357e-02]
 [-1.31436568e+00 -5.28898160e-01 -5.11483473e-02]
 [ 3.76957668e-01  8.31771552e-02  6.53541752e-02]
 [-1.61604737e-01 -1.40914425e-02  2.92946194e-02]
 [-7.92714651e-01 -1.09427197e+00  2.83394643e-01]
 [-1.63332546e-02 -2.93849186e-02 -2.15663361e-02]
 [ 4.18714570e-02  1.13716357e-01 -1.00689751e-01]
 [ 1.09542493e-01  2.07484692e-02  4.23046113e-02]
 [-7.07138049e-02 -8.04381418e-02 -9.65427125e-02]
 [-2.31772726e-02 -1.18908310e-01  2.13149190e-01]
 [ 3.30612397e-02 -1.33633618e-02  3.54008919e-02]
 [ 9.20312400e-02 -7.85532128e-01 -3.69615947e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.27118322 -49.27387164 -49.25707411]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [   7.3268874   -15.90307369 -140.51672192]
init_Out:  [2.48374395]
Stock Position:  7.326887399052493
Bond position:  [-730.20499595]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [1.98141596]
curr_Stock_Price:  99.95635883266661
curr_Factors:  [99.95635883 -0.87157367 -1.05338237]
mat_Sqrt:  [[14.5818506   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00158244  0.01457271 -0.12711422]
Stock Position:  0.001582436307580376
Bond Position:  [1.82324139]


portfolio before change:  [1.98386803]
curr_Stock_Price:  101.21783006125914
curr_Factors:  [101.21783006  -1.23848739  -1.05296309]
mat_Sqrt:  [[10.23511491  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.26482139 -0.87115698 -2.18986889]
Stock Position:  -0.2648213895296755
Bond Position:  [28.78851443]


portfolio before change:  [2.27512302]
curr_Stock_Price:  100.14519401438127
curr_Factors:  [100.14519401  -1.30832396  -1.08619601]
mat_Sqrt:  [[ 9.13488961  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01413138  0.07518568 -0.14753272]
Stock Position:  0.014131376787636091
Bond Position:  [0.85993355]


portfolio before change:  [2.29671469]
curr_Stock_Price:  101.6579027074213
curr_Factors:  [101.65790271  -1.39616902  -1.13384231]
mat_Sqrt:  [[ 8.09787716  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.03774392  0.07532398 -1.35030901]
Stock Position:  0.03774392326166752
Bond Position:  [-1.54025339]


portfolio before change:  [2.2975414]
curr_Stock_Price:  101.69000903162662
curr_Factors:  [101.69000903  -0.97394084  -1.14812153]
mat_Sqrt:  [[12.18086999  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00806705  0.03782379 -0.01922552]
Stock Position:  0.008067052209703024
Bond Position:  [1.47720279]


portfolio before change:  [2.29121353]
curr_Stock_Price:  100.85981494303698
curr_Factors:  [100.85981494  -0.81074299  -1.19098738]
mat_Sqrt:  [[13.62629269  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00306068 0.00727636 0.29897422]
Stock Position:  0.0030606836084296524
Bond Position:  [1.98251354]


portfolio before change:  [2.29495952]
curr_Stock_Price:  101.92176906494339
curr_Factors:  [101.92176906  -0.94047005  -1.20594383]
mat_Sqrt:  [[11.91492329  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.0152971  0.088341   0.50572028]
Stock Position:  0.015297103842660286
Bond Position:  [0.73585164]


portfolio before change:  [2.297536]
curr_Stock_Price:  102.07817060367945
curr_Factors:  [102.0781706   -1.08268646  -1.19322636]
mat_Sqrt:  [[10.48374626  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00236894 -0.04857794  0.03116637]
Stock Position:  -0.0023689364946463867
Bond Position:  [2.5393527]


portfolio before change:  [2.29696419]
curr_Stock_Price:  102.58756791558284
curr_Factors:  [102.58756792  -0.83735608  -1.13583279]
mat_Sqrt:  [[14.26099069  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.10046758 -0.17070115 -0.145912  ]
Stock Position:  -0.10046757656350125
Bond Position:  [12.60368852]


portfolio before change:  [2.20967521]
curr_Stock_Price:  103.48776173336725
curr_Factors:  [103.48776173  -1.13488747  -1.1876618 ]
mat_Sqrt:  [[10.14422008  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.04014863 0.02684531 0.18643727]
Stock Position:  0.0401486260596154
Bond Position:  [-1.94521624]


portfolio before change:  [2.24629288]
curr_Stock_Price:  104.41192868695987
curr_Factors:  [104.41192869  -1.30950328  -1.1736371 ]
mat_Sqrt:  [[ 8.71637586  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01818432 -0.00454799  0.0835694 ]
Stock Position:  -0.01818432382151171
Bond Position:  [4.1449532]


portfolio before change:  [2.25664909]
curr_Stock_Price:  103.89940771465157
curr_Factors:  [103.89940771  -1.15989643  -1.18985719]
mat_Sqrt:  [[ 9.91124109  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.09668156 -0.35317476  0.80844603]
Stock Position:  -0.09668156417449662
Bond Position:  [12.30180635]


portfolio before change:  [2.22833869]
curr_Stock_Price:  104.22404290072224
curr_Factors:  [104.2240429   -1.1461339   -1.23518358]
mat_Sqrt:  [[ 9.63329533  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00277513 -0.00948394 -0.06152275]
Stock Position:  -0.0027751288619357046
Bond Position:  [2.51757384]


portfolio before change:  [2.22900481]
curr_Stock_Price:  104.210839167449
curr_Factors:  [104.21083917  -1.14886167  -1.22303839]
mat_Sqrt:  [[ 9.72321269  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00457981  0.0367018  -0.28723983]
Stock Position:  0.004579813612504442
Bond Position:  [1.75173859]


portfolio before change:  [2.23167383]
curr_Stock_Price:  104.69798492726864
curr_Factors:  [104.69798493  -1.14551856  -1.22664951]
mat_Sqrt:  [[ 9.76604726  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01253456 0.00669654 0.12068328]
Stock Position:  0.012534564520753102
Bond Position:  [0.91933019]


portfolio before change:  [2.2434437]
curr_Stock_Price:  105.61863989711621
curr_Factors:  [105.6186399   -1.13765697  -1.18649035]
mat_Sqrt:  [[10.33656442  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01033611 -0.0259613  -0.27540949]
Stock Position:  -0.010336110353502665
Bond Position:  [3.33512962]


portfolio before change:  [2.25141235]
curr_Stock_Price:  104.92836449142203
curr_Factors:  [104.92836449  -1.14627194  -1.18991642]
mat_Sqrt:  [[10.14610125  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-3.88369233e-04 -3.83774921e-02  6.08055310e-01]
Stock Position:  -0.00038836923297518586
Bond Position:  [2.2921633]


portfolio before change:  [2.25215639]
curr_Stock_Price:  104.48825821821333
curr_Factors:  [104.48825822  -0.93756194  -1.15272564]
mat_Sqrt:  [[12.92013727  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00290706 -0.00431301  0.10098889]
Stock Position:  0.0029070613490906065
Bond Position:  [1.94840261]


portfolio before change:  [2.25293854]
curr_Stock_Price:  104.58972970333788
curr_Factors:  [104.5897297   -1.06720775  -1.13277869]
mat_Sqrt:  [[11.58902952  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01240504 -0.2535294  -1.05441141]
Stock Position:  -0.012405039876014039
Bond Position:  [3.5503783]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [2.26842581]
Stock Price:  103.41282369475616
PL:  [-1.14439789]
Settle:  Tensor("sub_264:0", shape=(), dtype=float64)
PL:  Tensor("sub_265:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  133
output_Z_Vals[:, i, :]:  [[ 1.19271183e+02 -4.92738716e+01 -4.92570741e+01]
 [ 4.33474339e-02  7.85354244e-02 -3.43306188e-02]
 [-1.77952956e+00 -2.40142423e+00 -6.81506406e-01]
 [-9.08604379e-02  1.01868028e-01  6.09177244e-02]
 [ 3.24147748e-01  2.12979380e-01 -4.49568652e-01]
 [-1.34428394e-01 -7.26659066e-02 -2.19078207e-03]
 [ 1.28248111e-02  2.68326030e-02  6.89504341e-02]
 [-4.49794458e-02 -4.36017328e-02 -3.52265473e-02]
 [ 1.60054875e-02 -1.18720766e-01  2.16864199e-04]
 [-1.07866131e+00 -4.38631957e-01 -3.90106884e-02]
 [ 3.28974306e-01  2.58639765e-02 -6.03947341e-02]
 [ 4.33698955e-02 -6.51463500e-02  3.73792892e-02]
 [-6.54057326e-01 -1.31443909e+00  2.28831022e-01]
 [ 2.25399910e-02  3.77071993e-02  9.02351518e-02]
 [ 1.19562940e-01  1.19965363e-01 -1.04887097e-01]
 [ 3.16756282e-02  4.17072871e-02  7.91714493e-02]
 [ 1.11670430e-01  9.81862717e-02  8.12959013e-02]
 [ 9.60809022e-02 -1.65635304e-02  2.18243966e-02]
 [-4.31369954e-02  4.97630069e-04 -5.40515811e-02]
 [ 1.10931162e-01 -8.58700386e-01 -6.29291299e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.27118322 -49.27387164 -49.25707411]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [   7.3268874   -15.90307369 -140.51672192]
init_Out:  [2.48374395]
Stock Position:  7.326887399052493
Bond position:  [-730.20499595]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [3.69855837]
curr_Stock_Price:  100.19072061720327
curr_Factors:  [100.19072062  -1.46690222  -1.01786038]
mat_Sqrt:  [[ 8.35042947  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00627162  0.0253472  -0.0979357 ]
Stock Position:  0.0062716177929478195
Bond Position:  [3.07020046]


portfolio before change:  [3.70254845]
curr_Stock_Price:  100.70453283265017
curr_Factors:  [100.70453283  -1.66749877  -1.02961549]
mat_Sqrt:  [[ 6.78745841  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.35489428 -0.77505634 -1.94414808]
Stock Position:  -0.3548942766536926
Bond Position:  [39.44201078]


portfolio before change:  [3.41195622]
curr_Stock_Price:  101.55113414342432
curr_Factors:  [101.55113414  -1.65283423  -1.02176087]
mat_Sqrt:  [[ 7.0004005   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00823266  0.03287776  0.17378131]
Stock Position:  -0.008232662584172924
Bond Position:  [4.24799245]


portfolio before change:  [3.41470643]
curr_Stock_Price:  101.34608844429586
curr_Factors:  [101.34608844  -1.76082883  -1.03827472]
mat_Sqrt:  [[ 6.16838914  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.04472062  0.0687388  -1.28249423]
Stock Position:  0.04472061636325141
Bond Position:  [-1.11755311]


portfolio before change:  [3.41703043]
curr_Stock_Price:  101.40430370213923
curr_Factors:  [101.4043037   -1.84758011  -1.0238187 ]
mat_Sqrt:  [[ 5.74147832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0260749  -0.02345282 -0.00624969]
Stock Position:  -0.02607489620186233
Bond Position:  [6.06113712]


portfolio before change:  [3.41259695]
curr_Stock_Price:  101.63245215655412
curr_Factors:  [101.63245216  -1.73544347  -1.01707145]
mat_Sqrt:  [[ 6.48082599  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00499573 0.00866019 0.1966964 ]
Stock Position:  0.004995727657597905
Bond Position:  [2.9048689]


portfolio before change:  [3.41256764]
curr_Stock_Price:  101.48119965541066
curr_Factors:  [101.48119966  -1.79471188  -0.99422069]
mat_Sqrt:  [[ 6.23975546  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00978727 -0.0140724  -0.10049153]
Stock Position:  -0.009787274758355554
Bond Position:  [4.40579203]


portfolio before change:  [3.41450489]
curr_Stock_Price:  101.39581696840975
curr_Factors:  [101.39581697  -1.11423513  -1.00248693]
mat_Sqrt:  [[12.21066534  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00067024 -0.03831696  0.00061865]
Stock Position:  -0.0006702354101855876
Bond Position:  [3.48246396]


portfolio before change:  [3.41571938]
curr_Stock_Price:  100.88291832898764
curr_Factors:  [100.88291833  -1.16145056  -0.98013302]
mat_Sqrt:  [[11.8505828   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0992491  -0.14156786 -0.11128664]
Stock Position:  -0.09924910277873879
Bond Position:  [13.42825851]


portfolio before change:  [3.46911146]
curr_Stock_Price:  100.37878683423997
curr_Factors:  [100.37878683  -1.41536424  -0.99977595]
mat_Sqrt:  [[ 8.96932761  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.03589185  0.00834756 -0.17228937]
Stock Position:  0.0358918481647387
Bond Position:  [-0.13366871]


portfolio before change:  [3.44834081]
curr_Stock_Price:  99.80101685001003
curr_Factors:  [99.80101685 -1.43675267 -1.00155798]
mat_Sqrt:  [[ 8.71344927  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00432687 -0.02102589  0.10663271]
Stock Position:  0.004326870660070517
Bond Position:  [3.01651472]


portfolio before change:  [3.44655851]
curr_Stock_Price:  99.21479146774097
curr_Factors:  [99.21479147 -1.58884482 -0.99696383]
mat_Sqrt:  [[ 7.47435977  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.11715467 -0.42423339  0.65279121]
Stock Position:  -0.11715466907388933
Bond Position:  [15.07003457]


portfolio before change:  [3.45702111]
curr_Stock_Price:  99.15764808914733
curr_Factors:  [99.15764809 -1.74165906 -0.97985595]
mat_Sqrt:  [[ 6.52209719  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00746019 0.01216995 0.25741577]
Stock Position:  0.0074601945727042745
Bond Position:  [2.71728576]


portfolio before change:  [3.45670051]
curr_Stock_Price:  99.02360304827928
curr_Factors:  [99.02360305 -1.48334749 -0.95441171]
mat_Sqrt:  [[ 8.65034349  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01417756  0.03871865 -0.29921369]
Stock Position:  0.014177561635248756
Bond Position:  [2.05278727]


portfolio before change:  [3.46547594]
curr_Stock_Price:  99.60636703530896
curr_Factors:  [99.60636704 -1.89519901 -0.92167424]
mat_Sqrt:  [[ 5.95572444  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00946147 0.01346097 0.22585411]
Stock Position:  0.009461468137938018
Bond Position:  [2.52305347]


portfolio before change:  [3.47080716]
curr_Stock_Price:  100.10315885479194
curr_Factors:  [100.10315885  -1.67502338  -0.96505185]
mat_Sqrt:  [[ 7.14295111  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.02076272 0.03168948 0.23191458]
Stock Position:  0.020762717334138363
Bond Position:  [1.39239357]


portfolio before change:  [3.47988608]
curr_Stock_Price:  100.52366115888604
curr_Factors:  [100.52366116  -1.66453537  -0.90825244]
mat_Sqrt:  [[ 7.67221468  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0126632  -0.00534586  0.06225893]
Stock Position:  0.012663197792123625
Bond Position:  [2.20693507]


portfolio before change:  [3.479193]
curr_Stock_Price:  100.42535455659115
curr_Factors:  [100.42535456  -1.67790638  -0.91313551]
mat_Sqrt:  [[ 7.5260687   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00718418  0.00016061 -0.15419412]
Stock Position:  -0.0071841823462214715
Bond Position:  [4.20066706]


portfolio before change:  [3.4776764]
curr_Stock_Price:  100.78265335117653
curr_Factors:  [100.78265335  -1.60003477  -0.95467548]
mat_Sqrt:  [[ 7.83229833  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02461651 -0.27714436 -1.79519291]
Stock Position:  -0.024616512300978163
Bond Position:  [5.95859383]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [3.48725167]
Stock Price:  100.45419784035779
PL:  [3.03305383]
Settle:  Tensor("sub_266:0", shape=(), dtype=float64)
PL:  Tensor("sub_267:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  134
output_Z_Vals[:, i, :]:  [[ 1.19271183e+02 -4.92738716e+01 -4.92570741e+01]
 [ 6.47639229e-02  1.12943424e-01 -2.43919896e-02]
 [-1.96512228e+00 -2.64891690e+00 -7.53101454e-01]
 [ 9.42842875e-02  2.94065035e-01 -5.01117571e-02]
 [ 3.97260311e-01  1.44729667e-02 -3.26808610e-01]
 [-3.17665828e-02 -4.52158337e-02  1.52509193e-02]
 [ 1.52206492e-02  2.33986264e-02  1.04044130e-01]
 [ 1.38460345e-01  3.61382967e-01  2.21271815e-01]
 [ 1.11201675e-02  1.62683894e-01 -7.92423676e-02]
 [-9.30144208e-01 -3.81984794e-01 -3.13578821e-02]
 [ 7.60909269e-02 -3.54210793e-02 -2.59576908e-01]
 [-1.65744628e-02 -3.87671819e-02  2.81894175e-02]
 [-6.21831885e-01 -1.24627203e+00  2.17060802e-01]
 [ 3.76568523e-02  5.08688185e-02  1.19206592e-01]
 [ 1.09073115e-01  1.23651596e-01 -1.04835952e-01]
 [-2.86021845e-03  5.10030320e-02  9.55227878e-02]
 [ 1.05677106e-01  1.12509858e-01  9.35106699e-02]
 [ 9.87793121e-02 -1.57554783e-02  1.42604618e-02]
 [-4.53976136e-02 -8.86172902e-02 -1.38511911e-03]
 [ 8.60570104e-02 -6.75222381e-01 -6.15927735e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.27118322 -49.27387164 -49.25707411]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [   7.3268874   -15.90307369 -140.51672192]
init_Out:  [2.48374395]
Stock Position:  7.326887399052493
Bond position:  [-730.20499595]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-1.3668595]
curr_Stock_Price:  99.49937413020186
curr_Factors:  [99.49937413 -1.44591963 -0.97935454]
mat_Sqrt:  [[ 8.80110418  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00941239  0.03645233 -0.06958356]
Stock Position:  0.009412388147703933
Bond Position:  [-2.30338623]


portfolio before change:  [-1.36042791]
curr_Stock_Price:  100.24387260052266
curr_Factors:  [100.2438726   -1.40385806  -1.00259347]
mat_Sqrt:  [[ 9.03543815  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.29434725 -0.85493425 -2.14838882]
Stock Position:  -0.2943472495289378
Bond Position:  [28.14608028]


portfolio before change:  [-1.47757136]
curr_Stock_Price:  100.6657581627402
curr_Factors:  [100.66575816  -1.24157746  -1.01179977]
mat_Sqrt:  [[10.57432055  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01362556  0.09490908 -0.14295489]
Stock Position:  0.013625560267983028
Bond Position:  [-2.84919872]


portfolio before change:  [-1.48634873]
curr_Stock_Price:  100.0738570070035
curr_Factors:  [100.07385701  -1.28939618  -1.00888979]
mat_Sqrt:  [[10.05050134  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.03318293  0.00467113 -0.932294  ]
Stock Position:  0.03318292826149022
Bond Position:  [-4.80709235]


portfolio before change:  [-1.51112368]
curr_Stock_Price:  99.36346084442314
curr_Factors:  [99.36346084 -0.86280013 -0.97998643]
mat_Sqrt:  [[15.73673655  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00240731 -0.01459335  0.04350663]
Stock Position:  -0.002407306320007504
Bond Position:  [-1.2719254]


portfolio before change:  [-1.51473242]
curr_Stock_Price:  100.7304306913027
curr_Factors:  [100.73043069  -0.86369251  -1.02014895]
mat_Sqrt:  [[15.31153536  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00269305 0.00755187 0.29680894]
Stock Position:  0.0026930540912456667
Bond Position:  [-1.78600492]


portfolio before change:  [-1.51893817]
curr_Stock_Price:  99.33454682266517
curr_Factors:  [99.33454682 -0.45306122 -1.06561042]
mat_Sqrt:  [[21.75452475  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01183176 0.11663585 0.6312269 ]
Stock Position:  0.011831757176838403
Bond Position:  [-2.6942404]


portfolio before change:  [-1.51489593]
curr_Stock_Price:  99.73312477637675
curr_Factors:  [99.73312478 -0.33492459 -1.10103637]
mat_Sqrt:  [[23.72517936  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00118661  0.052506   -0.22605642]
Stock Position:  0.001186612641516634
Bond Position:  [-1.63324052]


portfolio before change:  [-1.51774371]
curr_Stock_Price:  97.67734428470847
curr_Factors:  [97.67734428 -0.3383854  -1.11065976]
mat_Sqrt:  [[22.9340907   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.04423622 -0.12328506 -0.08945531]
Stock Position:  -0.04423621767374896
Bond Position:  [2.80313255]


portfolio before change:  [-1.51417074]
curr_Stock_Price:  97.61241794754851
curr_Factors:  [97.61241795 -0.91909814 -1.13880876]
mat_Sqrt:  [[12.46715784  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00127332 -0.0114321  -0.74050067]
Stock Position:  0.001273322684411258
Bond Position:  [-1.63846285]


portfolio before change:  [-1.51458031]
curr_Stock_Price:  97.61249374249894
curr_Factors:  [97.61249374 -0.95723148 -1.12737512]
mat_Sqrt:  [[12.13870248  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0015433  -0.01251205  0.08041656]
Stock Position:  -0.001543298378975699
Bond Position:  [-1.36393511]


portfolio before change:  [-1.5161931]
curr_Stock_Price:  98.4365502708742
curr_Factors:  [98.43655027 -1.02794778 -1.15706369]
mat_Sqrt:  [[11.0717931   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.07513857 -0.40223257  0.61921405]
Stock Position:  -0.07513857415225825
Bond Position:  [5.88018893]


portfolio before change:  [-1.54153458]
curr_Stock_Price:  98.79338043067706
curr_Factors:  [98.79338043 -0.94347866 -1.1274122 ]
mat_Sqrt:  [[12.45521908  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00581068 0.01641784 0.34006323]
Stock Position:  0.00581068462330583
Bond Position:  [-2.11559176]


portfolio before change:  [-1.53884956]
curr_Stock_Price:  99.34649718770471
curr_Factors:  [99.34649719 -0.9396988  -1.14158073]
mat_Sqrt:  [[12.39550841  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00910925  0.03990838 -0.29906779]
Stock Position:  0.009109254654677584
Bond Position:  [-2.4438221]


portfolio before change:  [-1.5395673]
curr_Stock_Price:  99.33478320915219
curr_Factors:  [99.33478321 -0.67682601 -1.16415048]
mat_Sqrt:  [[15.76069703  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00171625 0.01646116 0.27249993]
Stock Position:  0.0017162463831436176
Bond Position:  [-1.71005026]


portfolio before change:  [-1.54048456]
curr_Stock_Price:  99.04945086784556
curr_Factors:  [99.04945087 -0.8107352  -1.15363709]
mat_Sqrt:  [[13.89108039  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01063494 0.0363124  0.26675991]
Stock Position:  0.010634944553030682
Bond Position:  [-2.59386998]


portfolio before change:  [-1.52850956]
curr_Stock_Price:  100.23643941132835
curr_Factors:  [100.23643941  -0.84475015  -1.20578835]
mat_Sqrt:  [[12.89698149  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00763544 -0.00508506  0.04068113]
Stock Position:  0.007635441148766942
Bond Position:  [-2.29385899]


portfolio before change:  [-1.52769842]
curr_Stock_Price:  100.41778721809362
curr_Factors:  [100.41778722  -1.26030543  -1.18709328]
mat_Sqrt:  [[ 8.68798158  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00733994 -0.02860111 -0.00395136]
Stock Position:  -0.007339941715100679
Bond Position:  [-0.79063772]


portfolio before change:  [-1.5194399]
curr_Stock_Price:  99.2657060544235
curr_Factors:  [99.26570605 -1.13581428 -1.16942181]
mat_Sqrt:  [[ 9.90029012  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01792856 -0.21792709 -1.75707039]
Stock Position:  -0.017928555740209993
Bond Position:  [0.26025085]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-1.50185466]
Stock Price:  98.28848468582981
PL:  [-1.50185466]
Settle:  Tensor("sub_268:0", shape=(), dtype=float64)
PL:  Tensor("sub_269:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  135
output_Z_Vals[:, i, :]:  [[ 1.19271183e+02 -4.92738716e+01 -4.92570741e+01]
 [ 3.30727221e-02  6.20279438e-02 -3.90987464e-02]
 [-2.18854293e+00 -2.94685409e+00 -8.39289167e-01]
 [ 7.56362967e-02  1.78468090e-01 -5.96855056e-02]
 [ 5.45485912e-01 -7.74755795e-02 -3.06602250e-01]
 [-1.45276555e-01 -2.59791340e-01  6.32399810e-02]
 [-1.26107661e-02  3.04729032e-02  5.18402725e-04]
 [ 9.89453045e-02  2.45048746e-01  1.12684398e-01]
 [ 1.01363476e-01  1.01059598e-01 -7.38090859e-02]
 [-1.07482555e+00 -4.41137260e-01 -3.87286832e-02]
 [ 3.59765168e-01  3.89962869e-02 -4.37035968e-02]
 [ 1.92868311e-02 -7.22632704e-02  3.69108495e-02]
 [-5.43685293e-01 -1.30823792e+00  1.95559022e-01]
 [ 1.99567242e-02  3.26992306e-02  7.32301530e-02]
 [-5.67906908e-02 -6.99762732e-02 -7.61173787e-04]
 [ 6.56417848e-02  3.25648811e-02  6.30898363e-02]
 [ 7.41201254e-02  6.13994995e-02  4.45893370e-02]
 [ 8.11470123e-02 -3.30437300e-02  3.21771126e-02]
 [ 6.80510950e-02  1.30235769e-01  2.56662413e-02]
 [ 1.67907089e-02 -2.75214681e-01 -1.45092584e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.27118322 -49.27387164 -49.25707411]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [   7.3268874   -15.90307369 -140.51672192]
init_Out:  [2.48374395]
Stock Position:  7.326887399052493
Bond position:  [-730.20499595]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [5.5284365]
curr_Stock_Price:  100.4404689805448
curr_Factors:  [100.44046898  -1.33325086  -0.93643182]
mat_Sqrt:  [[10.38001711  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0036371   0.02001943 -0.11153784]
Stock Position:  0.0036370965960793753
Bond Position:  [5.16312482]


portfolio before change:  [5.52853927]
curr_Stock_Price:  100.11378577414796
curr_Factors:  [100.11378577  -1.08231085  -0.94643341]
mat_Sqrt:  [[13.16501771  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.22494358 -0.95109307 -2.39425838]
Stock Position:  -0.22494357807050397
Bond Position:  [28.04849246]


portfolio before change:  [5.63663346]
curr_Stock_Price:  99.66442335116041
curr_Factors:  [99.66442335 -1.08785986 -0.96693323]
mat_Sqrt:  [[12.76894035  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00782232  0.05760033 -0.17026613]
Stock Position:  0.007822316285711148
Bond Position:  [4.85702682]


portfolio before change:  [5.63590641]
curr_Stock_Price:  99.41622913166397
curr_Factors:  [99.41622913 -1.16353073 -0.93848268]
mat_Sqrt:  [[12.14966935  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.03844437 -0.02500514 -0.87465088]
Stock Position:  0.03844436747501228
Bond Position:  [1.81391237]


portfolio before change:  [5.62879943]
curr_Stock_Price:  99.21956789225713
curr_Factors:  [99.21956789 -1.22393992 -0.92564903]
mat_Sqrt:  [[11.56225948  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01603471 -0.08384729  0.18040606]
Stock Position:  -0.01603470611794236
Bond Position:  [7.21975605]


portfolio before change:  [5.63843932]
curr_Stock_Price:  98.7309573123609
curr_Factors:  [98.73095731 -0.90796888 -0.96162088]
mat_Sqrt:  [[15.22302046  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00041284  0.00983509  0.00147886]
Stock Position:  -0.0004128413440069779
Bond Position:  [5.67919955]


portfolio before change:  [5.63983588]
curr_Stock_Price:  98.7877020890958
curr_Factors:  [98.78770209 -0.69720029 -0.91806481]
mat_Sqrt:  [[19.64274437  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00875475 0.07908914 0.32145722]
Stock Position:  0.008754747990581818
Bond Position:  [4.77497444]


portfolio before change:  [5.65685442]
curr_Stock_Price:  100.59525344982974
curr_Factors:  [100.59525345  -0.50558952  -0.93550176]
mat_Sqrt:  [[23.80781262  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00449121  0.03261685 -0.21055678]
Stock Position:  0.004491213247112794
Bond Position:  [5.20505969]


portfolio before change:  [5.65799006]
curr_Stock_Price:  100.55833964880696
curr_Factors:  [100.55833965  -0.79149268  -0.94664773]
mat_Sqrt:  [[17.6828924   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.06632273 -0.14237644 -0.11048215]
Stock Position:  -0.06632273416960681
Bond Position:  [12.32729409]


portfolio before change:  [5.6611351]
curr_Stock_Price:  100.55739239108975
curr_Factors:  [100.55739239  -0.55766559  -0.93609796]
mat_Sqrt:  [[22.577754    0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01589194  0.012586   -0.1246742 ]
Stock Position:  0.015891939141095546
Bond Position:  [4.06308314]


portfolio before change:  [5.65467881]
curr_Stock_Price:  100.0872054131199
curr_Factors:  [100.08720541  -0.7397391   -0.91166423]
mat_Sqrt:  [[19.19478317  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00062885 -0.02332287  0.10529638]
Stock Position:  0.0006288452575767612
Bond Position:  [5.59173945]


portfolio before change:  [5.65531151]
curr_Stock_Price:  98.87004100249966
curr_Factors:  [98.870041   -0.51327207 -0.9237207 ]
mat_Sqrt:  [[23.49560776  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.03280655 -0.42223197  0.55787546]
Stock Position:  -0.032806553896978646
Bond Position:  [8.89889684]


portfolio before change:  [5.61583541]
curr_Stock_Price:  100.14116227427417
curr_Factors:  [100.14116227  -0.22518963  -0.92517837]
mat_Sqrt:  [[31.69670779  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00131179 0.01055363 0.20890524]
Stock Position:  0.0013117914139734652
Bond Position:  [5.48447109]


portfolio before change:  [5.61915972]
curr_Stock_Price:  101.62998050073739
curr_Factors:  [101.6299805   -0.28007401  -0.93548111]
mat_Sqrt:  [[30.1378982   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00236347 -0.02258475 -0.00217142]
Stock Position:  -0.0023634664639784783
Bond Position:  [5.85935877]


portfolio before change:  [5.61567681]
curr_Stock_Price:  103.72348660335766
curr_Factors:  [103.7234866   -0.15946188  -0.97557688]
mat_Sqrt:  [[33.33773081  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00255468 0.01051027 0.17997774]
Stock Position:  0.0025546796439287556
Bond Position:  [5.35069653]


portfolio before change:  [5.61476073]
curr_Stock_Price:  102.84121720211263
curr_Factors:  [102.8412172   -0.1666001   -0.97570847]
mat_Sqrt:  [[32.81473485  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00291805 0.0198166  0.12720097]
Stock Position:  0.0029180490569769195
Bond Position:  [5.31466502]


portfolio before change:  [5.61113621]
curr_Stock_Price:  101.14372840558876
curr_Factors:  [101.14372841   0.11000008  -0.97894718]
mat_Sqrt:  [[42.41896122  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00190882 -0.01066482  0.09179235]
Stock Position:  0.0019088188981712098
Bond Position:  [5.41807115]


portfolio before change:  [5.61624527]
curr_Stock_Price:  103.11058267587428
curr_Factors:  [103.11058268   0.11521378  -0.97660704]
mat_Sqrt:  [[43.57173949  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00229218 0.04203341 0.07321864]
Stock Position:  0.002292184353496505
Bond Position:  [5.3798968]


portfolio before change:  [5.62219269]
curr_Stock_Price:  105.11839667508875
curr_Factors:  [ 1.05118397e+02  7.28812901e-02 -9.74114828e-01]
mat_Sqrt:  [[42.68526437  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00161658 -0.08882516 -0.41390876]
Stock Position:  -0.0016165801802822655
Bond Position:  [5.792125]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [5.62220516]
Stock Price:  106.00652912495502
PL:  [-0.38432396]
Settle:  Tensor("sub_270:0", shape=(), dtype=float64)
PL:  Tensor("sub_271:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  136
output_Z_Vals[:, i, :]:  [[ 1.19271183e+02 -4.92738716e+01 -4.92570741e+01]
 [ 8.99545400e-02  1.55152506e-01 -1.83162967e-02]
 [-2.08741381e+00 -2.81199580e+00 -8.00277160e-01]
 [ 6.38834746e-02  1.61113254e-01 -6.55694674e-02]
 [ 6.13511848e-01 -5.62370442e-02 -3.70043411e-01]
 [-2.90746242e-02 -4.11482818e-02  1.47001687e-02]
 [ 1.47310086e-02  2.39940652e-02  9.00046173e-02]
 [-5.76306344e-03 -7.94451188e-03 -3.78830441e-03]
 [-8.47692044e-03 -1.81758247e-01  2.14490129e-02]
 [-1.32418536e+00 -5.01853946e-01 -5.23088354e-02]
 [ 4.71559516e-01  9.74534128e-02  7.10134862e-02]
 [-9.67620434e-02 -2.68076517e-02  3.18590498e-02]
 [-8.27070813e-01 -1.21835174e+00  2.97725024e-01]
 [-1.96145563e-02 -2.82398023e-02 -2.18381703e-02]
 [ 5.00950826e-02  9.71617474e-02 -1.00822786e-01]
 [ 4.69235890e-02 -3.10919955e-03  3.00207077e-03]
 [-7.25908109e-02 -8.22763168e-02 -9.83717432e-02]
 [-2.89580055e-02 -1.24496822e-01  2.20702317e-01]
 [ 3.25294973e-02 -1.19795801e-02  3.41718461e-02]
 [ 6.62322725e-02 -6.03118181e-01 -3.61229725e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.27118322 -49.27387164 -49.25707411]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [   7.3268874   -15.90307369 -140.51672192]
init_Out:  [2.48374395]
Stock Position:  7.326887399052493
Bond position:  [-730.20499595]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-7.24663832]
curr_Stock_Price:  98.69688072371332
curr_Factors:  [98.69688072 -1.16085587 -0.96914234]
mat_Sqrt:  [[11.72889119  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01005092  0.05007526 -0.0522513 ]
Stock Position:  0.010050917216891561
Bond Position:  [-8.2386325]


portfolio before change:  [-7.23823684]
curr_Stock_Price:  99.73772060761884
curr_Factors:  [99.73772061 -1.22960586 -0.9989387 ]
mat_Sqrt:  [[10.74026093  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.2630072  -0.90756774 -2.28296798]
Stock Position:  -0.26300719831943203
Bond Position:  [18.99350162]


portfolio before change:  [-7.17473531]
curr_Stock_Price:  99.51433295554713
curr_Factors:  [99.51433296 -1.10401747 -0.96985775]
mat_Sqrt:  [[12.5087257   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00666625  0.05199908 -0.18705144]
Stock Position:  0.006666248049718809
Bond Position:  [-7.83812254]


portfolio before change:  [-7.17422875]
curr_Stock_Price:  99.88430643934089
curr_Factors:  [99.88430644 -1.04782109 -0.95768647]
mat_Sqrt:  [[13.44362509  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.03916337 -0.01815043 -1.05563085]
Stock Position:  0.0391633737429042
Bond Position:  [-11.08603518]


portfolio before change:  [-7.18140713]
curr_Stock_Price:  99.7717901943452
curr_Factors:  [99.77179019 -1.03135626 -0.95877208]
mat_Sqrt:  [[13.63659716  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.002528   -0.01328055  0.04193549]
Stock Position:  -0.002528000368053951
Bond Position:  [-6.929184]


portfolio before change:  [-7.18664467]
curr_Stock_Price:  101.1582750955448
curr_Factors:  [101.1582751   -1.33057293  -0.98469619]
mat_Sqrt:  [[ 9.98832843  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00380453 0.00774405 0.25675812]
Stock Position:  0.003804529709661354
Bond Position:  [-7.57150434]


portfolio before change:  [-7.18456278]
curr_Stock_Price:  102.20308352148483
curr_Factors:  [102.20308352  -1.43715118  -0.9966299 ]
mat_Sqrt:  [[ 8.96367924  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00091012 -0.00256408 -0.01080698]
Stock Position:  -0.0009101189722909454
Bond Position:  [-7.09154581]


portfolio before change:  [-7.18651204]
curr_Stock_Price:  102.39663016585806
curr_Factors:  [102.39663017  -1.13446735  -1.02872459]
mat_Sqrt:  [[11.77127059  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00350004 -0.05866222  0.06118806]
Stock Position:  -0.003500038973657025
Bond Position:  [-6.82811984]


portfolio before change:  [-7.19195396]
curr_Stock_Price:  103.4636681927958
curr_Factors:  [103.46366819  -1.61450935  -1.02813372]
mat_Sqrt:  [[ 7.3638099   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.19518475 -0.16197266 -0.14922255]
Stock Position:  -0.19518474627824917
Bond Position:  [13.00257587]


portfolio before change:  [-7.23450886]
curr_Stock_Price:  103.69834819397492
curr_Factors:  [103.69834819  -1.5289323   -1.03305919]
mat_Sqrt:  [[ 8.00042523  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.0632401  0.03145295 0.20258171]
Stock Position:  0.06324009822203766
Bond Position:  [-13.79240259]


portfolio before change:  [-7.26224875]
curr_Stock_Price:  103.31423504023083
curr_Factors:  [103.31423504  -1.57269847  -1.02481506]
mat_Sqrt:  [[ 7.69262158  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01244451 -0.00865213  0.090885  ]
Stock Position:  -0.012444513228172749
Bond Position:  [-5.97655338]


portfolio before change:  [-7.27658931]
curr_Stock_Price:  104.34651635264225
curr_Factors:  [104.34651635  -1.78959116  -1.01131818]
mat_Sqrt:  [[ 6.33955076  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.16010487 -0.39322133  0.84932662]
Stock Position:  -0.16010487059632264
Bond Position:  [9.42979619]


portfolio before change:  [-7.21763244]
curr_Stock_Price:  103.99300350221078
curr_Factors:  [103.9930035   -1.64342763  -1.01222152]
mat_Sqrt:  [[ 7.30584326  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00408395 -0.00911436 -0.06229822]
Stock Position:  -0.004083947406766621
Bond Position:  [-6.79293048]


portfolio before change:  [-7.22220221]
curr_Stock_Price:  104.69607895716034
curr_Factors:  [104.69607896  -2.03289691  -0.97952124]
mat_Sqrt:  [[ 5.14818135  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00958548  0.03135882 -0.28761934]
Stock Position:  0.009585477440251686
Bond Position:  [-8.22576411]


portfolio before change:  [-7.21730294]
curr_Stock_Price:  105.42175618955392
curr_Factors:  [105.42175619  -1.95157134  -1.01525103]
mat_Sqrt:  [[ 5.42569852  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00864437 -0.00100349  0.00856407]
Stock Position:  0.008644365565172021
Bond Position:  [-8.12860714]


portfolio before change:  [-7.22121597]
curr_Stock_Price:  105.20420103954537
curr_Factors:  [105.20420104  -1.58228547  -1.01430497]
mat_Sqrt:  [[ 7.84057988  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0139614  -0.02655457 -0.2806272 ]
Stock Position:  -0.013961396144950724
Bond Position:  [-5.75241845]


portfolio before change:  [-7.21909861]
curr_Stock_Price:  104.94952354599174
curr_Factors:  [104.94952355  -1.04662277  -0.99326828]
mat_Sqrt:  [[13.64793821  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0006829  -0.04018118  0.62960228]
Stock Position:  -0.0006828973625085055
Bond Position:  [-7.14742885]


portfolio before change:  [-7.22070748]
curr_Stock_Price:  104.68857448065889
curr_Factors:  [104.68857448  -1.00810454  -0.97283507]
mat_Sqrt:  [[14.44069654  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00256632 -0.00386639  0.09748277]
Stock Position:  0.002566321823232847
Bond Position:  [-7.48937206]


portfolio before change:  [-7.22299242]
curr_Stock_Price:  104.5278954411834
curr_Factors:  [104.52789544  -0.85574378  -0.98203048]
mat_Sqrt:  [[16.63784165  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00785044 -0.19465556 -1.03048786]
Stock Position:  -0.007850442521199767
Bond Position:  [-6.40240218]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-7.22796181]
Stock Price:  104.95699191229302
PL:  [-12.18495373]
Settle:  Tensor("sub_272:0", shape=(), dtype=float64)
PL:  Tensor("sub_273:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  137
output_Z_Vals[:, i, :]:  [[ 1.19271183e+02 -4.92738716e+01 -4.92570741e+01]
 [-4.71682501e-03 -4.21701479e-03 -6.13374608e-02]
 [-2.58837012e+00 -2.99473011e+00 -9.04964482e-01]
 [-1.61368728e-02  5.17585073e-02 -1.09019055e-01]
 [ 4.15693882e-01 -3.93872451e-02 -1.02049778e-01]
 [-1.47429315e-01 -2.63612058e-01  6.53259595e-02]
 [-4.62911256e-02  7.12449566e-02 -9.37936956e-02]
 [ 7.42897204e-02  1.31113310e-01  1.21091013e-02]
 [ 4.19069923e-02 -1.42009501e-02  1.29676853e-03]
 [-7.02299932e-01 -2.71311515e-01 -2.01227622e-02]
 [ 2.63439204e-02 -5.29174792e-02 -3.16451428e-01]
 [ 4.16007462e-02  4.73014108e-03  2.25023097e-02]
 [-7.50805776e-01 -1.10437203e+00  2.51088115e-01]
 [ 1.45305657e-01  7.34977699e-02  1.16116968e-01]
 [ 1.28251668e-01  1.36306405e-01 -1.05135838e-01]
 [-1.80359603e-01  1.02534939e-01  1.41206896e-01]
 [ 7.05961098e-02  1.21764462e-01  1.26610504e-01]
 [ 1.15216134e-01 -1.08333916e-02 -3.18137274e-02]
 [-5.01059107e-02 -1.12310392e-01  7.19377847e-04]
 [ 8.03146400e-02 -6.25368542e-01 -6.23584776e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.27118322 -49.27387164 -49.25707411]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [   7.3268874   -15.90307369 -140.51672192]
init_Out:  [2.48374395]
Stock Position:  7.326887399052493
Bond position:  [-730.20499595]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [8.09766383]
curr_Stock_Price:  100.79112638558847
curr_Factors:  [100.79112639  -0.81098592  -1.0004816 ]
mat_Sqrt:  [[16.47069595  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0010988  -0.00136104 -0.1749787 ]
Stock Position:  -0.0010988045890779116
Bond Position:  [8.20841358]


portfolio before change:  [8.10251272]
curr_Stock_Price:  98.24605538972293
curr_Factors:  [98.24605539 -0.82305036 -0.97673381]
mat_Sqrt:  [[16.24346928  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.20835401 -0.96654499 -2.58161177]
Stock Position:  -0.20835400921138503
Bond Position:  [28.57247225]


portfolio before change:  [7.99181646]
curr_Stock_Price:  98.81163255212138
curr_Factors:  [98.81163255 -0.88337319 -0.97755168]
mat_Sqrt:  [[15.36804672  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00181058  0.01670499 -0.31100102]
Stock Position:  -0.001810583589186255
Bond Position:  [8.17072318]


portfolio before change:  [7.99709499]
curr_Stock_Price:  97.02458815930275
curr_Factors:  [97.02458816 -0.84468184 -0.94190156]
mat_Sqrt:  [[16.25468276  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.02379765 -0.01271218 -0.29111961]
Stock Position:  0.02379764504823921
Bond Position:  [5.68813828]


portfolio before change:  [8.01451938]
curr_Stock_Price:  97.69701482753011
curr_Factors:  [97.69701483 -0.90981319 -0.9534391 ]
mat_Sqrt:  [[15.15936832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01239526 -0.08508043  0.18635678]
Stock Position:  -0.01239525890149596
Bond Position:  [9.22549917]


portfolio before change:  [8.01795092]
curr_Stock_Price:  97.6062642309749
curr_Factors:  [97.60626423 -1.24244187 -0.93329135]
mat_Sqrt:  [[11.08073985  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.004593    0.02299421 -0.26756731]
Stock Position:  -0.004593002665119133
Bond Position:  [8.46625675]


portfolio before change:  [8.01875669]
curr_Stock_Price:  97.89171002393653
curr_Factors:  [97.89171002 -1.08570738 -0.96221433]
mat_Sqrt:  [[12.62829789  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00819785 0.04231664 0.0345439 ]
Stock Position:  0.008197848476958236
Bond Position:  [7.21625529]


portfolio before change:  [8.02140033]
curr_Stock_Price:  97.99409624105063
curr_Factors:  [97.99409624 -1.17482435 -0.98472411]
mat_Sqrt:  [[11.30628512  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00347355 -0.00458334  0.00369932]
Stock Position:  0.003473549170533956
Bond Position:  [7.68101302]


portfolio before change:  [8.01565628]
curr_Stock_Price:  95.78755089962529
curr_Factors:  [95.7875509  -0.95180308 -0.97158199]
mat_Sqrt:  [[13.99566532  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.05443033 -0.08756541 -0.05740464]
Stock Position:  -0.05443033160164308
Bond Position:  [13.22940444]


portfolio before change:  [7.98955581]
curr_Stock_Price:  96.32784212023108
curr_Factors:  [96.32784212 -1.01279102 -0.98621472]
mat_Sqrt:  [[13.04952399  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.003759   -0.01707904 -0.90274784]
Stock Position:  -0.0037590024138777493
Bond Position:  [8.3516524]


portfolio before change:  [7.99250202]
curr_Stock_Price:  96.09958102682577
curr_Factors:  [96.09958103 -1.44439749 -0.95555042]
mat_Sqrt:  [[ 8.71841151  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00540919 0.00152665 0.06419283]
Stock Position:  0.005409190303105628
Bond Position:  [7.4726811]


portfolio before change:  [7.99285094]
curr_Stock_Price:  95.81867209982589
curr_Factors:  [95.8186721  -1.40353641 -0.91614573]
mat_Sqrt:  [[ 9.41943802  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.09819924 -0.35643454  0.7162845 ]
Stock Position:  -0.09819923675524293
Bond Position:  [17.4021714]


portfolio before change:  [8.08446945]
curr_Stock_Price:  94.92999486176329
curr_Factors:  [94.92999486 -1.28068759 -0.94557077]
mat_Sqrt:  [[10.24593827  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01795937 0.0237213  0.33124939]
Stock Position:  0.017959370694855443
Bond Position:  [6.37958648]


portfolio before change:  [8.09118955]
curr_Stock_Price:  95.21536147009911
curr_Factors:  [95.21536147 -0.93755312 -0.96443872]
mat_Sqrt:  [[14.2128921   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00947128  0.0439927  -0.29992328]
Stock Position:  0.009471283683831443
Bond Position:  [7.18937785]


portfolio before change:  [8.10948807]
curr_Stock_Price:  96.95757042590236
curr_Factors:  [96.95757043 -1.21579767 -0.96668158]
mat_Sqrt:  [[10.9330926   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01194593  0.03309301  0.40282397]
Stock Position:  -0.011945934612118162
Bond Position:  [9.26773687]


portfolio before change:  [8.10625928]
curr_Stock_Price:  97.42183006666342
curr_Factors:  [97.42183007 -1.3033336  -0.9924852 ]
mat_Sqrt:  [[ 9.80832499  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01236658 0.03929931 0.36118453]
Stock Position:  0.012366580194231983
Bond Position:  [6.90148441]


portfolio before change:  [8.11741809]
curr_Stock_Price:  98.18462994776061
curr_Factors:  [98.18462995 -0.97836984 -1.01059157]
mat_Sqrt:  [[13.43533635  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00792766 -0.00349646 -0.09075571]
Stock Position:  0.007927663650446254
Bond Position:  [7.33904337]


portfolio before change:  [8.12490503]
curr_Stock_Price:  98.89756896295603
curr_Factors:  [98.89756896 -1.04104955 -1.02801293]
mat_Sqrt:  [[12.49117236  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00583487 -0.03624802  0.00205218]
Stock Position:  -0.005834867140984398
Bond Position:  [8.7019592]


portfolio before change:  [8.13284814]
curr_Stock_Price:  97.9091395803963
curr_Factors:  [97.90913958 -1.07111174 -0.98643526]
mat_Sqrt:  [[12.50955693  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01395948 -0.20183683 -1.77891379]
Stock Position:  -0.0139594782835057
Bond Position:  [9.49960865]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [8.12049352]
Stock Price:  98.96432372837748
PL:  [8.12049352]
Settle:  Tensor("sub_274:0", shape=(), dtype=float64)
PL:  Tensor("sub_275:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  138
output_Z_Vals[:, i, :]:  [[ 1.19271183e+02 -4.92738716e+01 -4.92570741e+01]
 [ 3.33940792e-02  5.62741499e-02 -4.66936663e-02]
 [-2.01578272e+00 -2.71647390e+00 -7.72644442e-01]
 [ 6.83387159e-02  1.63499934e-01 -5.88390593e-02]
 [ 4.90858518e-01  4.95328613e-02 -3.94242339e-01]
 [-7.84899002e-02 -6.16134839e-02  1.47109723e-02]
 [ 3.58433940e-03  2.52859366e-02  6.18989268e-02]
 [ 2.72439938e-02  5.23187635e-02 -5.04509475e-03]
 [-2.48466968e-03 -1.66329356e-01  1.62522872e-02]
 [-1.11025614e+00 -4.42322824e-01 -4.08164193e-02]
 [ 4.54317473e-01  1.31928796e-01  5.53867251e-02]
 [-5.87271994e-02 -3.87920141e-02  3.34126718e-02]
 [-6.53559745e-01 -1.18086982e+00  2.32208153e-01]
 [ 1.31977472e-02  2.94918948e-02  7.22096254e-02]
 [ 9.71296378e-02  1.24913006e-01 -1.04216304e-01]
 [ 1.86612031e-02  4.52102786e-02  8.53332577e-02]
 [ 1.07623549e-01  9.42109631e-02  7.72464725e-02]
 [ 6.30768701e-02 -5.25777708e-02  4.99909810e-02]
 [ 2.36434804e-02  8.37617782e-02 -2.26157312e-03]
 [ 4.39554596e-02 -4.72755609e-01 -2.42963392e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.27118322 -49.27387164 -49.25707411]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [   7.3268874   -15.90307369 -140.51672192]
init_Out:  [2.48374395]
Stock Position:  7.326887399052493
Bond position:  [-730.20499595]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [1.22821946]
curr_Stock_Price:  99.85355985895448
curr_Factors:  [99.85355986 -1.03686409 -1.07063093]
mat_Sqrt:  [[12.1364059   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0029127   0.0181624  -0.13320403]
Stock Position:  0.002912698167330193
Bond Position:  [0.93737618]


portfolio before change:  [1.22840856]
curr_Stock_Price:  99.83801696957877
curr_Factors:  [99.83801697 -1.3101879  -1.03863553]
mat_Sqrt:  [[ 9.5326773   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.28617312 -0.87673818 -2.20413953]
Stock Position:  -0.2861731209374031
Bond Position:  [29.79936546]


portfolio before change:  [1.35546285]
curr_Stock_Price:  99.420075840582
curr_Factors:  [99.42007584 -1.39218961 -0.9734165 ]
mat_Sqrt:  [[ 9.33478693  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00960949  0.05276938 -0.16785146]
Stock Position:  0.009609488476710656
Bond Position:  [0.40008678]


portfolio before change:  [1.36794345]
curr_Stock_Price:  100.70844464339453
curr_Factors:  [100.70844464  -1.20473133  -1.01587463]
mat_Sqrt:  [[10.93122847  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.03846731  0.01598666 -1.12466366]
Stock Position:  0.03846731335261972
Bond Position:  [-2.50603985]


portfolio before change:  [1.34767819]
curr_Stock_Price:  100.1979157762346
curr_Factors:  [100.19791578  -1.30018806  -0.99661283]
mat_Sqrt:  [[10.07791599  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0087383  -0.01988567  0.04196631]
Stock Position:  -0.0087382982172312
Bond Position:  [2.22323746]


portfolio before change:  [1.35098028]
curr_Stock_Price:  99.88364198378358
curr_Factors:  [99.88364198 -0.90229828 -0.99905719]
mat_Sqrt:  [[14.91922227  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00143311 0.008161   0.17658041]
Stock Position:  0.0014331092292956
Bond Position:  [1.20783611]


portfolio before change:  [1.35288663]
curr_Stock_Price:  101.00313350550545
curr_Factors:  [101.00313351  -1.52253501  -1.02253124]
mat_Sqrt:  [[ 7.92549906  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00465506  0.01688581 -0.01439225]
Stock Position:  0.004655062189464957
Bond Position:  [0.88271077]


portfolio before change:  [1.35430067]
curr_Stock_Price:  101.2594848843767
curr_Factors:  [101.25948488  -1.83125674  -1.04523226]
mat_Sqrt:  [[ 5.70416939  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00580611 -0.05368257  0.04636325]
Stock Position:  -0.005806107937966845
Bond Position:  [1.94222417]


portfolio before change:  [1.35603875]
curr_Stock_Price:  101.04376987825135
curr_Factors:  [101.04376988  -1.31552472  -1.04468467]
mat_Sqrt:  [[ 9.5385778   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.12673551 -0.14275908 -0.11643788]
Stock Position:  -0.12673551052264714
Bond Position:  [14.16187251]


portfolio before change:  [1.26279209]
curr_Stock_Price:  101.80746725450902
curr_Factors:  [101.80746725  -1.37509294  -1.0235949 ]
mat_Sqrt:  [[ 9.24789187  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.05326112 0.04257984 0.15800291]
Stock Position:  0.053261121642620646
Bond Position:  [-4.15958781]


portfolio before change:  [1.23973181]
curr_Stock_Price:  101.39402774716773
curr_Factors:  [101.39402775  -0.76410064  -1.0356338 ]
mat_Sqrt:  [[16.76477139  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00356851 -0.01252007  0.09531705]
Stock Position:  -0.0035685099192362727
Bond Position:  [1.6015574]


portfolio before change:  [1.24201657]
curr_Stock_Price:  100.86598445726358
curr_Factors:  [100.86598446  -1.14095073  -1.01091984]
mat_Sqrt:  [[11.72733192  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.07224188 -0.3811241   0.66242523]
Stock Position:  -0.0722418794113419
Bond Position:  [8.52876486]


portfolio before change:  [1.2833657]
curr_Stock_Price:  100.3231322529813
curr_Factors:  [100.32313225  -0.76217851  -1.01824016]
mat_Sqrt:  [[16.91122544  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00200798 0.00951847 0.20599396]
Stock Position:  0.0020079847651766156
Bond Position:  [1.08191837]


portfolio before change:  [1.28148438]
curr_Stock_Price:  99.2514978891564
curr_Factors:  [99.25149789 -0.77924324 -0.97541075]
mat_Sqrt:  [[17.16724179  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00590394  0.0403155  -0.29730011]
Stock Position:  0.005903938186169699
Bond Position:  [0.69550967]


portfolio before change:  [1.2891486]
curr_Stock_Price:  100.52019594959427
curr_Factors:  [100.52019595  -0.28794979  -0.96404418]
mat_Sqrt:  [[28.74215015  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00157637 0.01459155 0.24343203]
Stock Position:  0.0015763709608973113
Bond Position:  [1.13069148]


portfolio before change:  [1.29124832]
curr_Stock_Price:  101.67285018857757
curr_Factors:  [101.67285019  -0.40102712  -0.93700887]
mat_Sqrt:  [[26.67493373  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00534667 0.03040646 0.22036268]
Stock Position:  0.005346673116655328
Bond Position:  [0.74763682]


portfolio before change:  [1.29378412]
curr_Stock_Price:  102.11216566614782
curr_Factors:  [102.11216567  -0.1807737   -0.92921239]
mat_Sqrt:  [[33.65244732  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00185867 -0.0169694   0.14261035]
Stock Position:  0.0018586714724484364
Bond Position:  [1.10399116]


portfolio before change:  [1.29622554]
curr_Stock_Price:  103.27718156359305
curr_Factors:  [103.27718156  -0.23301865  -0.94574448]
mat_Sqrt:  [[31.77415841  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00126769  0.027034   -0.00645164]
Stock Position:  0.0012676855053341967
Bond Position:  [1.16530255]


portfolio before change:  [1.30037951]
curr_Stock_Price:  106.32416093499756
curr_Factors:  [106.32416093  -0.55331174  -0.95234862]
mat_Sqrt:  [[23.59021934  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00432976 -0.15258122 -0.69310693]
Stock Position:  -0.004329763463723467
Bond Position:  [1.76073798]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [1.29938395]
Stock Price:  106.65577242427696
PL:  [-5.35638847]
Settle:  Tensor("sub_276:0", shape=(), dtype=float64)
PL:  Tensor("sub_277:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  139
output_Z_Vals[:, i, :]:  [[ 1.19271183e+02 -4.92738716e+01 -4.92570741e+01]
 [-5.12494959e-03 -5.75828220e-03 -6.22795753e-02]
 [-2.08768033e+00 -2.81235122e+00 -8.00379976e-01]
 [-2.72655789e-01 -1.23199915e-01  1.76618693e-01]
 [ 8.53600273e-01  5.47046036e-02 -5.60432034e-01]
 [ 7.91241936e-02  1.48711155e-01  1.23633553e-02]
 [ 1.52667393e-02  3.68956038e-02  1.08457698e-01]
 [ 4.38524652e-02  2.38664047e-01  2.25899227e-01]
 [-5.11268838e-03 -1.73095998e-01  1.85314128e-02]
 [-1.17868968e+00 -4.85492691e-01 -4.39798529e-02]
 [ 3.57540861e-01  9.78064667e-02  7.26456941e-02]
 [-1.10984071e-02 -6.81117127e-02  3.58597045e-02]
 [-7.45482606e-01 -9.96114712e-01  2.62130280e-01]
 [-7.51544650e-03  4.26841355e-03  1.61949180e-02]
 [-4.01626673e-02 -2.63194183e-02 -2.60940167e-02]
 [-1.18057444e-01  8.76083658e-02  1.30323224e-01]
 [-3.62384769e-02  1.04747271e-01  1.47105218e-01]
 [ 1.09849028e-01 -1.24247853e-02 -1.60989926e-02]
 [-7.87908046e-02 -3.90811022e-01  1.08743815e-01]
 [ 3.55435050e-02 -3.09921222e-01 -3.06655088e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.27118322 -49.27387164 -49.25707411]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [   7.3268874   -15.90307369 -140.51672192]
init_Out:  [2.48374395]
Stock Position:  7.326887399052493
Bond position:  [-730.20499595]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [11.66753839]
curr_Stock_Price:  101.27835573191459
curr_Factors:  [101.27835573  -1.0969095   -1.01787906]
mat_Sqrt:  [[12.22012473  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00155589 -0.00185848 -0.17766629]
Stock Position:  -0.0015558858449342377
Bond Position:  [11.82511595]


portfolio before change:  [11.67028741]
curr_Stock_Price:  101.41179891329476
curr_Factors:  [101.41179891  -1.09739078  -1.03692919]
mat_Sqrt:  [[11.99955386  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.23543592 -0.90768245 -2.28326129]
Stock Position:  -0.23543591982936388
Bond Position:  [35.54626757]


portfolio before change:  [11.44196636]
curr_Stock_Price:  102.41932883337924
curr_Factors:  [102.41932883  -1.27750392  -1.01596344]
mat_Sqrt:  [[10.33574311  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02532491 -0.0397626   0.50384397]
Stock Position:  -0.025324906410378857
Bond Position:  [14.03572627]


portfolio before change:  [11.44490639]
curr_Stock_Price:  102.44181017243847
curr_Factors:  [102.44181017  -0.91118082  -0.98565176]
mat_Sqrt:  [[15.37068848  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.04881818  0.01765583 -1.5987566 ]
Stock Position:  0.04881818369995065
Bond Position:  [6.44388328]


portfolio before change:  [11.41170607]
curr_Stock_Price:  101.72872568896807
curr_Factors:  [101.72872569  -0.49518191  -0.94549013]
mat_Sqrt:  [[24.08616664  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00465011 0.04799632 0.03526921]
Stock Position:  0.004650112736719116
Bond Position:  [10.93865603]


portfolio before change:  [11.41323614]
curr_Stock_Price:  101.46960533079096
curr_Factors:  [101.46960533  -0.5516979   -0.95255379]
mat_Sqrt:  [[22.5448714   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00199322 0.011908   0.30939962]
Stock Position:  0.0019932186318862718
Bond Position:  [11.21098503]


portfolio before change:  [11.41811358]
curr_Stock_Price:  102.51030885684469
curr_Factors:  [102.51030886  -0.57723355  -0.91434604]
mat_Sqrt:  [[23.06655612  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00601221 0.07702849 0.64442762]
Stock Position:  0.006012212910331158
Bond Position:  [10.80179978]


portfolio before change:  [11.42349989]
curr_Stock_Price:  102.95698526856314
curr_Factors:  [102.95698527  -0.52033125  -0.89109465]
mat_Sqrt:  [[25.10044012  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00146065 -0.05586649  0.05286496]
Stock Position:  -0.001460653758786961
Bond Position:  [11.57388439]


portfolio before change:  [11.42789909]
curr_Stock_Price:  101.9263733454851
curr_Factors:  [101.92637335  -0.66833916  -0.87360344]
mat_Sqrt:  [[21.80868161  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.05900255 -0.15669209 -0.12546228]
Stock Position:  -0.059002549121703385
Bond Position:  [17.44181494]


portfolio before change:  [11.3825188]
curr_Stock_Price:  102.76940952613947
curr_Factors:  [102.76940953  -0.80534582  -0.88253961]
mat_Sqrt:  [[19.0031035   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.0206458  0.0315669  0.20723794]
Stock Position:  0.02064579938256139
Bond Position:  [9.26076219]


portfolio before change:  [11.34340446]
curr_Stock_Price:  100.76271448271258
curr_Factors:  [100.76271448  -0.63170753  -0.85923472]
mat_Sqrt:  [[22.68777306  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00077935 -0.02198296  0.10229776]
Stock Position:  -0.0007793546173853346
Bond Position:  [11.42193434]


portfolio before change:  [11.34460131]
curr_Stock_Price:  102.8913800726352
curr_Factors:  [102.89138007  -0.73290213  -0.87507518]
mat_Sqrt:  [[20.60835469  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.04344386 -0.32149464  0.74778473]
Stock Position:  -0.043443863620462174
Bond Position:  [15.8146004]


portfolio before change:  [11.38909502]
curr_Stock_Price:  101.95823180301491
curr_Factors:  [101.9582318   -0.64890216  -0.87383971]
mat_Sqrt:  [[22.23841864  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00015012  0.00137762  0.04619959]
Stock Position:  -0.00015011797787247788
Bond Position:  [11.40440079]


portfolio before change:  [11.39222197]
curr_Stock_Price:  100.12309144166169
curr_Factors:  [ 1.00123091e+02 -5.51719083e-02 -8.91452170e-01]
mat_Sqrt:  [[38.85264919  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00130909 -0.00849456 -0.07443897]
Stock Position:  -0.0013090874353151902
Bond Position:  [11.52329185]


portfolio before change:  [11.39863386]
curr_Stock_Price:  97.4260158114086
curr_Factors:  [97.42601581 -0.12256909 -0.89535316]
mat_Sqrt:  [[35.20439837  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00208986  0.02827548  0.37177588]
Stock Position:  -0.002089862289994142
Bond Position:  [11.60224081]


portfolio before change:  [11.40985412]
curr_Stock_Price:  93.44520637948659
curr_Factors:  [93.44520638  0.18190321 -0.87101494]
mat_Sqrt:  [[46.91153104  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [3.23389511e-04 3.38070363e-02 4.19650241e-01]
Stock Position:  0.0003233895112508556
Bond Position:  [11.37963493]


portfolio before change:  [11.41230093]
curr_Stock_Price:  92.21306441358385
curr_Factors:  [ 9.22130644e+01 -6.23443894e-02 -8.52676245e-01]
mat_Sqrt:  [[36.93210336  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0028167  -0.00401008 -0.04592594]
Stock Position:  0.002816699488039334
Bond Position:  [11.15256444]


portfolio before change:  [11.41321424]
curr_Stock_Price:  91.54732962643746
curr_Factors:  [91.54732963 -0.48599651 -0.83199909]
mat_Sqrt:  [[24.50459149  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00556498 -0.12613372  0.31021584]
Stock Position:  -0.005564978800400244
Bond Position:  [11.92267319]


portfolio before change:  [11.43646922]
curr_Stock_Price:  87.90419979687319
curr_Factors:  [87.9041998  -0.45580965 -0.81801933]
mat_Sqrt:  [[24.59193645  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00367253 -0.10002664 -0.87480161]
Stock Position:  -0.003672529305988315
Bond Position:  [11.75929997]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [11.43721346]
Stock Price:  88.50213968984731
PL:  [11.43721346]
Settle:  Tensor("sub_278:0", shape=(), dtype=float64)
PL:  Tensor("sub_279:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  140
output_Z_Vals[:, i, :]:  [[ 1.19271183e+02 -4.92738716e+01 -4.92570741e+01]
 [ 3.55803302e-02  6.60566985e-02 -3.79350548e-02]
 [-2.58762205e+00 -3.47903637e+00 -9.93239648e-01]
 [-5.82740477e-02  1.41484171e-01  4.02753867e-02]
 [ 1.11265890e+00 -2.10793407e-01 -4.40165133e-01]
 [ 8.19197286e-02  1.74575304e-01  2.80391251e-02]
 [ 1.72257006e-02  3.89199187e-02  1.12901385e-01]
 [ 1.23286578e-01  3.87636883e-01  2.93657300e-01]
 [-1.86645017e-02 -2.07989305e-01  3.02841014e-02]
 [-1.11141772e+00 -4.56510367e-01 -4.05841053e-02]
 [ 3.58898011e-01  3.76183775e-02 -4.33851661e-02]
 [-8.68569174e-03 -5.17296557e-02  3.53575711e-02]
 [-6.45615777e-01 -1.22655746e+00  2.27774168e-01]
 [ 1.44565668e-02  3.06411789e-02  7.47014376e-02]
 [ 1.08915076e-01  1.20232910e-01 -1.04792539e-01]
 [ 3.91847568e-02  3.96861134e-02  7.56161781e-02]
 [ 1.25539909e-01  1.15578973e-01  1.03380930e-01]
 [ 1.00768730e-01 -1.51597375e-02  8.68390902e-03]
 [-4.76371820e-02 -9.92438110e-02 -8.11637911e-04]
 [ 5.10423928e-02 -4.53731571e-01 -4.03848839e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.27118322 -49.27387164 -49.25707411]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [   7.3268874   -15.90307369 -140.51672192]
init_Out:  [2.48374395]
Stock Position:  7.326887399052493
Bond position:  [-730.20499595]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-1.44596586]
curr_Stock_Price:  99.48857740849375
curr_Factors:  [99.48857741 -0.75341346 -0.9591208 ]
mat_Sqrt:  [[17.94853653  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00230217  0.02131971 -0.10821815]
Stock Position:  0.002302173029937816
Bond Position:  [-1.67500578]


portfolio before change:  [-1.4408784]
curr_Stock_Price:  101.88034462521635
curr_Factors:  [101.88034463  -0.273061    -0.97972136]
mat_Sqrt:  [[29.10810539  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.12025934 -1.12285416 -2.83343625]
Stock Position:  -0.12025934092200796
Bond Position:  [10.8111847]


portfolio before change:  [-1.425842]
curr_Stock_Price:  101.77778900237826
curr_Factors:  [101.777789    -0.25416969  -0.96867264]
mat_Sqrt:  [[29.96258886  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00070663  0.04566382  0.11489447]
Stock Position:  -0.0007066323098017468
Bond Position:  [-1.35392252]


portfolio before change:  [-1.42429053]
curr_Stock_Price:  99.1031479788796
curr_Factors:  [ 9.91031480e+01  5.39403038e-02 -9.65313820e-01]
mat_Sqrt:  [[39.83666382  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.024595   -0.06803328 -1.25566861]
Stock Position:  0.024594995038241387
Bond Position:  [-3.86173196]


portfolio before change:  [-1.37314055]
curr_Stock_Price:  101.22209686952353
curr_Factors:  [101.22209687  -0.25207287  -1.01527544]
mat_Sqrt:  [[28.5018435   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00432527 0.05634394 0.07998782]
Stock Position:  0.004325272007442391
Bond Position:  [-1.81095365]


portfolio before change:  [-1.37023767]
curr_Stock_Price:  101.99792570045413
curr_Factors:  [101.9979257   -0.19162954  -0.99921993]
mat_Sqrt:  [[31.00358986  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00155518 0.01256135 0.32207623]
Stock Position:  0.001555177793347056
Bond Position:  [-1.52886258]


portfolio before change:  [-1.37016614]
curr_Stock_Price:  102.28972117632703
curr_Factors:  [102.28972118  -0.33189052  -1.00440261]
mat_Sqrt:  [[26.88358983  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00975893 0.12510927 0.83772254]
Stock Position:  0.009758933688083815
Bond Position:  [-2.36840475]


portfolio before change:  [-1.35741215]
curr_Stock_Price:  103.65730602952284
curr_Factors:  [103.65730603  -0.49862085  -1.05465425]
mat_Sqrt:  [[21.92911546  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00250527 -0.06712826  0.08639211]
Stock Position:  -0.002505273163105468
Bond Position:  [-1.09772228]


portfolio before change:  [-1.34989683]
curr_Stock_Price:  100.54795140694787
curr_Factors:  [100.54795141  -0.60871521  -1.00796767]
mat_Sqrt:  [[19.96442331  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0607524  -0.14733809 -0.11577516]
Stock Position:  -0.0607524038865922
Bond Position:  [4.75863293]


portfolio before change:  [-1.35317926]
curr_Stock_Price:  100.62156566199852
curr_Factors:  [100.62156566  -0.73673755  -1.04996647]
mat_Sqrt:  [[16.85525679  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0212231   0.01214128 -0.1237658 ]
Stock Position:  0.021223104149299923
Bond Position:  [-3.48868123]


portfolio before change:  [-1.34207653]
curr_Stock_Price:  101.18581003381296
curr_Factors:  [101.18581003  -0.9933759   -1.0667565 ]
mat_Sqrt:  [[12.89482589  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00093275 -0.01669567  0.10086531]
Stock Position:  -0.0009327484998419371
Bond Position:  [-1.24769561]


portfolio before change:  [-1.34130135]
curr_Stock_Price:  100.02028959239246
curr_Factors:  [100.02028959  -1.23870927  -1.07874931]
mat_Sqrt:  [[ 9.85436478  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0862046  -0.39586972  0.6497763 ]
Stock Position:  -0.08620459871679563
Bond Position:  [7.28090758]


portfolio before change:  [-1.35149319]
curr_Stock_Price:  100.15963595038792
curr_Factors:  [100.15963595  -1.14764647  -1.0893242 ]
mat_Sqrt:  [[10.69519535  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00336221 0.0098894  0.21310241]
Stock Position:  0.0033622142631073468
Bond Position:  [-1.68825135]


portfolio before change:  [-1.35579765]
curr_Stock_Price:  99.00493994906587
curr_Factors:  [99.00493995 -1.04966969 -1.03024613]
mat_Sqrt:  [[12.36974937  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00905975  0.038805   -0.29894394]
Stock Position:  0.009059749362172407
Bond Position:  [-2.25275759]


portfolio before change:  [-1.34234504]
curr_Stock_Price:  100.55198751240775
curr_Factors:  [100.55198751  -1.37192737  -1.03518599]
mat_Sqrt:  [[ 9.05721361  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00692495 0.01280864 0.21571191]
Stock Position:  0.006924948578906073
Bond Position:  [-2.03866239]


portfolio before change:  [-1.34771746]
curr_Stock_Price:  99.84978924365372
curr_Factors:  [99.84978924 -1.11989772 -1.05393125]
mat_Sqrt:  [[11.35704179  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01498937 0.03730295 0.29491702]
Stock Position:  0.014989370966892516
Bond Position:  [-2.84440299]


portfolio before change:  [-1.34862522]
curr_Stock_Price:  99.83667534567621
curr_Factors:  [99.83667535 -0.68085188 -1.05005397]
mat_Sqrt:  [[17.68346036  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00562372 -0.00489278  0.02477278]
Stock Position:  0.005623721534964667
Bond Position:  [-1.91007888]


portfolio before change:  [-1.35205137]
curr_Stock_Price:  99.31236609279449
curr_Factors:  [99.31236609 -0.42708165 -1.02144942]
mat_Sqrt:  [[23.32997544  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00291732 -0.0320308  -0.00231538]
Stock Position:  -0.0029173161875338744
Bond Position:  [-1.06232579]


portfolio before change:  [-1.35764901]
curr_Stock_Price:  101.14008372319493
curr_Factors:  [101.14008372  -0.50562282  -0.99735857]
mat_Sqrt:  [[22.50022098  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00551152 -0.14644123 -1.15206833]
Stock Position:  -0.005511522556814215
Bond Position:  [-0.80021316]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-1.36878797]
Stock Price:  103.12481304026917
PL:  [-4.49360101]
Settle:  Tensor("sub_280:0", shape=(), dtype=float64)
PL:  Tensor("sub_281:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  141
output_Z_Vals[:, i, :]:  [[ 1.19271183e+02 -4.92738716e+01 -4.92570741e+01]
 [ 2.13642450e-02  4.32169579e-02 -4.45322333e-02]
 [-2.41838552e+00 -3.25335509e+00 -9.27954232e-01]
 [-7.32716082e-02  1.23643512e-01  4.97235733e-02]
 [ 6.65159270e-01  1.02031573e-01 -5.13882966e-01]
 [ 7.57175145e-02  1.17192732e-01 -6.73936232e-03]
 [ 1.35249337e-02  2.51728401e-02  1.01498185e-01]
 [ 1.17185339e-01  3.06124887e-01  1.70377312e-01]
 [ 1.01363476e-01  1.01059598e-01 -7.38090859e-02]
 [-1.24442237e+00 -5.11029274e-01 -4.73570513e-02]
 [ 4.47871066e-01  1.35421354e-01  6.34942757e-02]
 [-1.51171192e-01 -8.06626308e-03  2.95805972e-02]
 [-7.77525974e-01 -1.04478941e+00  2.75949908e-01]
 [-1.67445973e-02 -2.92413673e-02 -2.16004131e-02]
 [-2.02164913e-02  2.28313562e-02 -5.27181886e-02]
 [ 8.24292791e-02  2.80463220e-02  5.51416310e-02]
 [ 6.89654019e-02  5.63514156e-02  3.95663656e-02]
 [ 7.15100209e-02 -4.93596973e-02  2.48338429e-02]
 [-2.03585801e-02  6.14650102e-02 -4.46033190e-02]
 [ 5.05951743e-02 -4.60981620e-01 -3.97855523e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.27118322 -49.27387164 -49.25707411]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [   7.3268874   -15.90307369 -140.51672192]
init_Out:  [2.48374395]
Stock Position:  7.326887399052493
Bond position:  [-730.20499595]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [0.12029959]
curr_Stock_Price:  99.7023469621598
curr_Factors:  [99.70234696 -0.61566074 -1.00235358]
mat_Sqrt:  [[19.77018311  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00106705  0.01394821 -0.12703807]
Stock Position:  0.0010670495765128854
Bond Position:  [0.01391224]


portfolio before change:  [0.12040421]
curr_Stock_Price:  99.79713689090963
curr_Factors:  [99.79713689 -0.67002018 -0.99360022]
mat_Sqrt:  [[18.90675172  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.17305414 -1.05001584 -2.64719513]
Stock Position:  -0.17305414253552626
Bond Position:  [17.39071217]


portfolio before change:  [-0.20101882]
curr_Stock_Price:  101.67961857962408
curr_Factors:  [101.67961858  -0.85755702  -1.02433352]
mat_Sqrt:  [[15.48599919  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00244629  0.03990577  0.14184751]
Stock Position:  -0.0024462871055019185
Bond Position:  [0.04771872]


portfolio before change:  [-0.20180045]
curr_Stock_Price:  102.00401312556312
curr_Factors:  [102.00401313  -1.0877005   -1.01628384]
mat_Sqrt:  [[12.44137752  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.04670628  0.03293055 -1.46596506]
Stock Position:  0.04670627958180354
Bond Position:  [-4.96602841]


portfolio before change:  [-0.20332837]
curr_Stock_Price:  101.99788420002103
curr_Factors:  [101.9978842   -0.92111858  -1.01538827]
mat_Sqrt:  [[14.70878909  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00668061  0.03782379 -0.01922552]
Stock Position:  0.006680612086335047
Bond Position:  [-0.88473667]


portfolio before change:  [-0.21360998]
curr_Stock_Price:  100.49197492965872
curr_Factors:  [100.49197493  -0.69213965  -0.98528105]
mat_Sqrt:  [[18.77745925  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00209728 0.0081245  0.28954607]
Stock Position:  0.00209727779575668
Bond Position:  [-0.42436957]


portfolio before change:  [-0.2143531]
curr_Stock_Price:  100.18824199413629
curr_Factors:  [100.18824199  -0.65708304  -0.97249428]
mat_Sqrt:  [[19.63813846  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01092013 0.09880138 0.48603905]
Stock Position:  0.01092012585266845
Bond Position:  [-1.30842131]


portfolio before change:  [-0.21046334]
curr_Stock_Price:  100.57440104145279
curr_Factors:  [100.57440104  -0.74400771  -0.98555748]
mat_Sqrt:  [[17.83802784  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00599427  0.03261685 -0.21055678]
Stock Position:  0.00599427046615028
Bond Position:  [-0.8133335]


portfolio before change:  [-0.20001166]
curr_Stock_Price:  102.3519371683071
curr_Factors:  [102.35193717  -0.72222091  -0.98628996]
mat_Sqrt:  [[18.53955161  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.07327052 -0.16493399 -0.13509649]
Stock Position:  -0.0732705151474109
Bond Position:  [7.2993675]


portfolio before change:  [-0.17038329]
curr_Stock_Price:  101.97247616881118
curr_Factors:  [101.97247617  -1.15418156  -0.98530498]
mat_Sqrt:  [[12.00371751  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.04069361 0.04370705 0.1811315 ]
Stock Position:  0.04069360579760004
Bond Position:  [-4.32001104]


portfolio before change:  [-0.12909668]
curr_Stock_Price:  103.01359178162475
curr_Factors:  [103.01359178  -1.08975678  -0.97354743]
mat_Sqrt:  [[13.08618023  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01121638 -0.00260338  0.08438521]
Stock Position:  -0.011216382037842504
Bond Position:  [1.02634312]


portfolio before change:  [-0.13536086]
curr_Stock_Price:  103.59495569682055
curr_Factors:  [103.5949557   -0.94179319  -1.00490549]
mat_Sqrt:  [[14.78761422  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.06319239 -0.33720433  0.78720828]
Stock Position:  -0.06319238972328425
Bond Position:  [6.41105195]


portfolio before change:  [-0.15363979]
curr_Stock_Price:  103.90958047741027
curr_Factors:  [103.90958048  -0.99378991  -0.98029306]
mat_Sqrt:  [[14.43185819  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00187936 -0.00943761 -0.06161997]
Stock Position:  -0.0018793582855711486
Bond Position:  [0.04164354]


portfolio before change:  [-0.15238985]
curr_Stock_Price:  103.25003168787089
curr_Factors:  [103.25003169  -0.80508217  -0.98127282]
mat_Sqrt:  [[17.30159237  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00152108  0.00736879 -0.15039032]
Stock Position:  -0.0015210805402938701
Bond Position:  [0.00466176]


portfolio before change:  [-0.15303176]
curr_Stock_Price:  103.67280847365805
curr_Factors:  [103.67280847  -0.82287753  -0.97362133]
mat_Sqrt:  [[17.19710417  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00578062 0.00905191 0.15730372]
Stock Position:  0.005780621429331815
Bond Position:  [-0.75232502]


portfolio before change:  [-0.16106676]
curr_Stock_Price:  102.3153609540326
curr_Factors:  [102.31536095  -0.75702347  -0.94546187]
mat_Sqrt:  [[18.64493399  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00474899 0.01818734 0.11287183]
Stock Position:  0.0047489863495264
Bond Position:  [-0.64696101]


portfolio before change:  [-0.16160053]
curr_Stock_Price:  102.23702694357723
curr_Factors:  [102.23702694  -0.78191766  -0.93156394]
mat_Sqrt:  [[18.42691392  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00360905 -0.01593077  0.07084404]
Stock Position:  0.003609052612602949
Bond Position:  [-0.53057933]


portfolio before change:  [-0.16287676]
curr_Stock_Price:  101.92016373190653
curr_Factors:  [101.92016373  -0.52889194  -0.93665001]
mat_Sqrt:  [[23.53874634  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00071867  0.01983775 -0.12724085]
Stock Position:  -0.0007186747146385907
Bond Position:  [-0.08962932]


portfolio before change:  [-0.16254634]
curr_Stock_Price:  101.42921273886583
curr_Factors:  [101.42921274  -0.54077914  -0.93915357]
mat_Sqrt:  [[23.09066524  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00540107 -0.14878118 -1.13497107]
Stock Position:  -0.005401066715371588
Bond Position:  [0.38527961]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-0.17123112]
Stock Price:  103.05502362964607
PL:  [-3.22625475]
Settle:  Tensor("sub_282:0", shape=(), dtype=float64)
PL:  Tensor("sub_283:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  142
output_Z_Vals[:, i, :]:  [[ 1.19271183e+02 -4.92738716e+01 -4.92570741e+01]
 [ 1.22785503e-02  2.67436262e-02 -5.03432672e-02]
 [-2.56926356e+00 -3.54523563e+00 -1.01461833e+00]
 [-8.82937449e-03  7.17453392e-02 -1.13352122e-01]
 [ 8.23567927e-01 -1.40063925e-01 -3.77954539e-01]
 [-3.59331631e-02 -5.15115401e-02  1.61033642e-02]
 [-5.72715673e-03  3.09797572e-02  5.01929589e-02]
 [ 1.38829839e-01  3.85837321e-01  2.55172678e-01]
 [ 6.08550937e-02 -3.24167642e-03 -3.86785547e-02]
 [-1.49531393e+00 -5.91601564e-01 -5.94323332e-02]
 [ 3.13513072e-01  3.52185716e-02  5.35968918e-02]
 [-1.17522938e-01  1.83351456e-02  2.89294091e-02]
 [-8.88280468e-01 -1.16904697e+00  3.21608430e-01]
 [ 8.54751699e-03 -3.80678684e-02 -1.95051278e-02]
 [-6.20470798e-02 -2.65453128e-02 -2.86562195e-02]
 [ 1.03492308e-01  2.23769506e-02  4.51691316e-02]
 [-5.66517695e-02 -6.66670184e-02 -8.28400955e-02]
 [ 5.27706482e-02 -5.80159293e-02  7.71293130e-02]
 [ 1.10154898e-02 -3.78812059e-02  3.35137234e-02]
 [ 6.45944168e-02 -5.70131556e-01 -4.31256081e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.27118322 -49.27387164 -49.25707411]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [   7.3268874   -15.90307369 -140.51672192]
init_Out:  [2.48374395]
Stock Position:  7.326887399052493
Bond position:  [-730.20499595]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [4.49553534]
curr_Stock_Price:  100.29949490709447
curr_Factors:  [100.29949491  -0.78990697  -0.99111442]
mat_Sqrt:  [[16.89705371  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00044157  0.00863147 -0.14361533]
Stock Position:  0.00044157365216001215
Bond Position:  [4.45124573]


portfolio before change:  [4.49609117]
curr_Stock_Price:  99.03781099489233
curr_Factors:  [99.03781099 -0.30962706 -1.01233051]
mat_Sqrt:  [[26.40475569  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.13255339 -1.14421988 -2.89442369]
Stock Position:  -0.132553389055775
Bond Position:  [17.62388866]


portfolio before change:  [4.45072643]
curr_Stock_Price:  99.41329185722502
curr_Factors:  [99.41329186 -0.38568345 -0.98051605]
mat_Sqrt:  [[25.35779877  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00068312  0.02315571 -0.32336205]
Stock Position:  -0.0006831162130056989
Bond Position:  [4.51863726]


portfolio before change:  [4.45185509]
curr_Stock_Price:  99.41496018502787
curr_Factors:  [99.41496019 -0.47414168 -0.97826522]
mat_Sqrt:  [[23.26373494  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.03085609 -0.04520544 -1.0781991 ]
Stock Position:  0.030856087928939298
Bond Position:  [1.38429834]


portfolio before change:  [4.43652847]
curr_Stock_Price:  98.90703009436639
curr_Factors:  [98.90703009 -0.64493477 -0.97485   ]
mat_Sqrt:  [[19.57778597  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00220458 -0.01662528  0.04593842]
Stock Position:  -0.0022045815992527197
Bond Position:  [4.65457709]


portfolio before change:  [4.43977457]
curr_Stock_Price:  97.96249117494015
curr_Factors:  [97.96249117 -0.11475894 -0.98786891]
mat_Sqrt:  [[32.52330192  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00033337 0.00999867 0.14318654]
Stock Position:  0.00033336573780160233
Bond Position:  [4.40711724]


portfolio before change:  [4.44188384]
curr_Stock_Price:  100.98425576945934
curr_Factors:  [100.98425577  -0.4099818   -1.01067802]
mat_Sqrt:  [[24.39320973  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01105535 0.12452846 0.72793663]
Stock Position:  0.011055349446893561
Bond Position:  [3.32546761]


portfolio before change:  [4.44787394]
curr_Stock_Price:  101.45087337429236
curr_Factors:  [101.45087337  -0.66140604  -1.03410037]
mat_Sqrt:  [[18.61687194  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00280918 -0.00104625 -0.11033915]
Stock Position:  0.002809180968829719
Bond Position:  [4.16288007]


portfolio before change:  [4.45837791]
curr_Stock_Price:  104.81951519054819
curr_Factors:  [104.81951519  -0.97986598  -1.08059456]
mat_Sqrt:  [[13.35351221  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.12193089 -0.19093858 -0.1695439 ]
Stock Position:  -0.12193089298409082
Bond Position:  [17.239115]


portfolio before change:  [4.49196376]
curr_Stock_Price:  104.57941583568096
curr_Factors:  [104.57941584  -1.02432387  -1.10322995]
mat_Sqrt:  [[12.45837297  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.02662005 0.01136675 0.15289701]
Stock Position:  0.026620045321962996
Bond Position:  [1.70805497]


portfolio before change:  [4.53972025]
curr_Stock_Price:  106.35737785326447
curr_Factors:  [106.35737785  -1.36096092  -1.10101091]
mat_Sqrt:  [[ 9.06873772  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01189527  0.00591764  0.08252755]
Stock Position:  -0.011895271869014257
Bond Position:  [5.80487018]


portfolio before change:  [4.54510349]
curr_Stock_Price:  106.02684007338411
curr_Factors:  [106.02684007  -1.48275646  -1.10971382]
mat_Sqrt:  [[ 7.93451306  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.13375277 -0.37730829  0.91745933]
Stock Position:  -0.13375277449683187
Bond Position:  [18.72648752]


portfolio before change:  [4.51462361]
curr_Stock_Price:  106.2897287089417
curr_Factors:  [106.28972871  -1.4361167   -1.117132  ]
mat_Sqrt:  [[ 8.27236092  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00038738 -0.01228635 -0.0556427 ]
Stock Position:  -0.00038737691486543215
Bond Position:  [4.5557978]


portfolio before change:  [4.5156624]
curr_Stock_Price:  106.54867198763633
curr_Factors:  [106.54867199  -1.21776872  -1.09622562]
mat_Sqrt:  [[10.53399404  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00695985 -0.00856746 -0.08174822]
Stock Position:  -0.006959852558919016
Bond Position:  [5.25722544]


portfolio before change:  [4.51773173]
curr_Stock_Price:  106.44021209729209
curr_Factors:  [106.4402121   -0.55677448  -1.15368519]
mat_Sqrt:  [[19.2425461   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00609483 0.00722213 0.12885496]
Stock Position:  0.0060948324306593785
Bond Position:  [3.86899647]


portfolio before change:  [4.51549455]
curr_Stock_Price:  105.91443024509309
curr_Factors:  [105.91443025  -0.55250204  -1.14222425]
mat_Sqrt:  [[19.45113115  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00448148 -0.02151669 -0.23631973]
Stock Position:  -0.0044814761992108335
Bond Position:  [4.99014755]


portfolio before change:  [4.53091801]
curr_Stock_Price:  102.75123937754461
curr_Factors:  [102.75123938  -1.263896    -1.11846885]
mat_Sqrt:  [[ 9.48722409  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00597352 -0.01872456  0.22002846]
Stock Position:  0.00597352299961579
Bond Position:  [3.91713111]


portfolio before change:  [4.53431822]
curr_Stock_Price:  103.15649631350965
curr_Factors:  [103.15649631  -1.1283392   -1.1216119 ]
mat_Sqrt:  [[10.87314644  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0009311  -0.01222611  0.09560532]
Stock Position:  0.0009310994965889642
Bond Position:  [4.43826926]


portfolio before change:  [4.53496831]
curr_Stock_Price:  102.66286596301836
curr_Factors:  [102.66286596  -0.81097395  -1.09032123]
mat_Sqrt:  [[15.33526843  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00911709 -0.18400917 -1.23025356]
Stock Position:  -0.009117087150174612
Bond Position:  [5.47095461]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [4.54579044]
Stock Price:  101.6258876729462
PL:  [2.91990277]
Settle:  Tensor("sub_284:0", shape=(), dtype=float64)
PL:  Tensor("sub_285:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  143
output_Z_Vals[:, i, :]:  [[ 1.19271183e+02 -4.92738716e+01 -4.92570741e+01]
 [ 1.89782906e-01  2.96054707e-01 -4.69902400e-02]
 [-2.61450402e+00 -2.69361764e+00 -8.44627530e-01]
 [ 3.93099841e-02  1.18198270e-01 -7.60885320e-02]
 [ 6.15852828e-01 -9.88149700e-02 -3.17735086e-01]
 [-8.03932918e-02 -5.65279545e-02  1.42902553e-02]
 [-2.11635535e-03  2.79732270e-02  3.49456625e-02]
 [ 7.93676361e-02  1.40536733e-01  1.38195381e-02]
 [ 2.63078492e-02 -9.21941709e-02 -8.71776668e-03]
 [-8.70191681e-01 -3.53876523e-01 -2.83800558e-02]
 [ 2.53909212e-01  1.37201480e-03 -1.05758918e-01]
 [ 3.63862934e-02 -6.72101131e-02  3.72434512e-02]
 [-6.52018187e-01 -1.30959871e+00  2.28097898e-01]
 [ 4.09254612e-02  5.37146597e-02  1.25470875e-01]
 [ 9.59867000e-02  1.25244358e-01 -1.03434406e-01]
 [-1.62137964e-01  9.79402441e-02  1.40206184e-01]
 [ 3.38019540e-02  1.15221699e-01  1.29843484e-01]
 [ 1.13508843e-01 -1.13396185e-02 -2.68148251e-02]
 [-7.02710995e-02 -3.46214143e-01  9.23102566e-02]
 [ 5.10728908e-02 -3.88761202e-01 -4.16381024e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.27118322 -49.27387164 -49.25707411]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [   7.3268874   -15.90307369 -140.51672192]
init_Out:  [2.48374395]
Stock Position:  7.326887399052493
Bond position:  [-730.20499595]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-15.11359916]
curr_Stock_Price:  97.62316955500803
curr_Factors:  [97.62316956 -1.0950075  -0.98812856]
mat_Sqrt:  [[12.15789551  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0197915   0.09555125 -0.13405008]
Stock Position:  0.019791499052730258
Bond Position:  [-17.04570802]


portfolio before change:  [-15.11214369]
curr_Stock_Price:  97.9120522303155
curr_Factors:  [97.91205223 -1.11045895 -0.9511092 ]
mat_Sqrt:  [[12.45972564  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.26780247 -0.86936135 -2.40948725]
Stock Position:  -0.26780246929298096
Bond Position:  [11.10894567]


portfolio before change:  [-15.40679301]
curr_Stock_Price:  99.02267266694157
curr_Factors:  [99.02267267 -1.14748756 -0.91426062]
mat_Sqrt:  [[12.5987885   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0038024   0.03814833 -0.2170594 ]
Stock Position:  0.0038023972191488296
Bond Position:  [-15.78331654]


portfolio before change:  [-15.40950513]
curr_Stock_Price:  99.34725712807409
curr_Factors:  [99.34725713 -1.22912999 -0.88678432]
mat_Sqrt:  [[11.97363379  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.04433282 -0.03189239 -0.90640976]
Stock Position:  0.04433281604167451
Bond Position:  [-19.8138488]


portfolio before change:  [-15.3833096]
curr_Stock_Price:  100.04988818732986
curr_Factors:  [100.04988819  -1.21077327  -0.88039551]
mat_Sqrt:  [[12.36042908  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00720161 -0.01824432  0.04076612]
Stock Position:  -0.007201612948631471
Bond Position:  [-14.66278903]


portfolio before change:  [-15.38449318]
curr_Stock_Price:  99.70516357138959
curr_Factors:  [99.70516357 -1.15828208 -0.8847205 ]
mat_Sqrt:  [[12.92566529  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00082989 0.00902832 0.09969025]
Stock Position:  0.0008298922289262484
Bond Position:  [-15.46723772]


portfolio before change:  [-15.38852394]
curr_Stock_Price:  99.50818797225364
curr_Factors:  [99.50818797 -1.14250687 -0.9235003 ]
mat_Sqrt:  [[12.60675467  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00879493 0.04535804 0.0394233 ]
Stock Position:  0.008794926274641153
Bond Position:  [-16.26369112]


portfolio before change:  [-15.39617881]
curr_Stock_Price:  99.10017577275391
curr_Factors:  [99.10017577 -1.31041307 -0.93104062]
mat_Sqrt:  [[10.53473121  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00054195 -0.02975554 -0.02486936]
Stock Position:  0.0005419489219911961
Bond Position:  [-15.44988604]


portfolio before change:  [-15.40028923]
curr_Stock_Price:  98.6435477704321
curr_Factors:  [98.64354777 -1.28548922 -0.96216378]
mat_Sqrt:  [[10.42138381  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.09098787 -0.11421316 -0.0809604 ]
Stock Position:  -0.09098786647477303
Bond Position:  [-6.42492328]


portfolio before change:  [-15.50333655]
curr_Stock_Price:  99.75843143934891
curr_Factors:  [99.75843144 -1.3348643  -0.92517533]
mat_Sqrt:  [[10.40942815  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.02234525  0.00044282 -0.30170075]
Stock Position:  0.022345254820499292
Bond Position:  [-17.73246412]


portfolio before change:  [-15.50903165]
curr_Stock_Price:  99.70197974872222
curr_Factors:  [99.70197975 -1.35457202 -0.86851266]
mat_Sqrt:  [[10.79519203  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00280397 -0.02169197  0.1062452 ]
Stock Position:  0.0028039681010820815
Bond Position:  [-15.78859282]


portfolio before change:  [-15.51559596]
curr_Stock_Price:  98.76877771525959
curr_Factors:  [98.76877772 -1.42474607 -0.84642125]
mat_Sqrt:  [[10.19211342  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.08563274 -0.42267117  0.65069981]
Stock Position:  -0.08563274166376889
Bond Position:  [-7.05775473]


portfolio before change:  [-15.45448347]
curr_Stock_Price:  98.03451243017456
curr_Factors:  [98.03451243 -1.1198539  -0.84170679]
mat_Sqrt:  [[13.78745194  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00562117 0.01733633 0.35793348]
Stock Position:  0.0056211659488937735
Bond Position:  [-16.00555173]


portfolio before change:  [-15.46576596]
curr_Stock_Price:  96.73930073639974
curr_Factors:  [96.73930074 -0.80527327 -0.85570619]
mat_Sqrt:  [[18.37590474  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00546578  0.04042244 -0.29506957]
Stock Position:  0.00546577920553721
Bond Position:  [-15.99452161]


portfolio before change:  [-15.4668351]
curr_Stock_Price:  97.27536027244618
curr_Factors:  [97.27536027 -0.88573386 -0.87255935]
mat_Sqrt:  [[16.76431478  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00677192  0.03161008  0.39996922]
Stock Position:  -0.006771915763408134
Bond Position:  [-14.80809456]


portfolio before change:  [-15.46149899]
curr_Stock_Price:  95.940642025882
curr_Factors:  [95.94064203 -0.82969685 -0.84383633]
mat_Sqrt:  [[17.99684577  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.0046578  0.03718764 0.37040732]
Stock Position:  0.004657798164082398
Bond Position:  [-15.90837114]


portfolio before change:  [-15.47146114]
curr_Stock_Price:  94.65579441273447
curr_Factors:  [94.65579441 -0.63579563 -0.81935942]
mat_Sqrt:  [[22.08927151  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00478606 -0.00365985 -0.07649523]
Stock Position:  0.004786060930073833
Bond Position:  [-15.92448954]


portfolio before change:  [-15.48594746]
curr_Stock_Price:  92.46094221825233
curr_Factors:  [92.46094222 -0.47662806 -0.80625147]
mat_Sqrt:  [[25.63367148  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00476323 -0.11174013  0.26333547]
Stock Position:  -0.004763227668782957
Bond Position:  [-15.04553494]


portfolio before change:  [-15.50019083]
curr_Stock_Price:  94.66145032894393
curr_Factors:  [94.66145033 -0.5396683  -0.77986892]
mat_Sqrt:  [[25.29912029  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00447747 -0.12547214 -1.18781916]
Stock Position:  -0.004477471024565233
Bond Position:  [-15.07634693]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-15.4981675]
Stock Price:  93.36766304107314
PL:  [-15.4981675]
Settle:  Tensor("sub_286:0", shape=(), dtype=float64)
PL:  Tensor("sub_287:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  144
output_Z_Vals[:, i, :]:  [[ 1.19271183e+02 -4.92738716e+01 -4.92570741e+01]
 [ 1.44493281e-01  2.33163490e-01 -4.04797412e-02]
 [-3.03664734e+00 -3.01998405e+00 -9.72246700e-01]
 [-5.60826927e-02  3.85903114e-02 -1.41479246e-01]
 [ 3.74855814e-01  7.94053895e-03 -6.88441250e-02]
 [-1.45517333e-01 -2.54160481e-01  4.00663988e-02]
 [-6.64565641e-02  1.17062707e-01 -1.18104267e-01]
 [ 9.76747207e-02  2.41308085e-01  1.09192831e-01]
 [ 4.03803317e-02  1.79254000e-01 -8.70695858e-02]
 [-7.96497624e-01 -3.27657084e-01 -2.45425890e-02]
 [ 9.42644149e-02 -3.16628765e-02 -2.14067254e-01]
 [ 6.96471571e-03 -6.41439878e-02  3.45310392e-02]
 [-6.07486110e-01 -1.29584167e+00  2.15415381e-01]
 [ 1.24466589e-02  2.88061622e-02  7.07228589e-02]
 [ 1.04518270e-01  1.20027723e-01 -1.04006828e-01]
 [-3.81967946e-02  6.05143031e-02  1.12253240e-01]
 [ 1.22779038e-01  1.15152375e-01  1.02008993e-01]
 [ 8.99745244e-02 -1.84055195e-02  3.83731282e-02]
 [-3.55437356e-02  2.76726636e-02 -5.47538756e-02]
 [ 7.01158449e-02 -5.93435857e-01 -4.88560087e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.27118322 -49.27387164 -49.25707411]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [   7.3268874   -15.90307369 -140.51672192]
init_Out:  [2.48374395]
Stock Position:  7.326887399052493
Bond position:  [-730.20499595]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-12.41656687]
curr_Stock_Price:  97.99127024185017
curr_Factors:  [97.99127024 -0.77226221 -0.96451886]
mat_Sqrt:  [[17.25492019  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01065346  0.07525319 -0.11547743]
Stock Position:  0.01065346488561865
Bond Position:  [-13.46051343]


portfolio before change:  [-12.43337782]
curr_Stock_Price:  96.7292015437134
curr_Factors:  [96.72920154 -0.55934176 -0.95169112]
mat_Sqrt:  [[21.34638602  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.18043139 -0.97469566 -2.77354921]
Stock Position:  -0.18043138691269248
Bond Position:  [5.01960616]


portfolio before change:  [-12.30814925]
curr_Stock_Price:  96.04210647616436
curr_Factors:  [96.04210648 -0.55612065 -0.95146419]
mat_Sqrt:  [[21.26796322  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00362446  0.01245497 -0.40360091]
Stock Position:  -0.0036244565495128734
Bond Position:  [-11.96004881]


portfolio before change:  [-12.30832972]
curr_Stock_Price:  95.26684213314459
curr_Factors:  [95.26684213 -0.72364851 -0.95195798]
mat_Sqrt:  [[17.83343955  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.02032272  0.0025628  -0.19639313]
Stock Position:  0.020322715663512396
Bond Position:  [-14.24441067]


portfolio before change:  [-12.28046683]
curr_Stock_Price:  96.81311416556817
curr_Factors:  [96.81311417 -0.79982132 -0.96618885]
mat_Sqrt:  [[16.55639271  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01142876 -0.08202994  0.11429828]
Stock Position:  -0.011428763953699994
Bond Position:  [-11.1740126]


portfolio before change:  [-12.27517059]
curr_Stock_Price:  96.10524305282173
curr_Factors:  [96.10524305 -0.70521012 -0.94049025]
mat_Sqrt:  [[18.53653224  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00359664  0.03778183 -0.3369186 ]
Stock Position:  -0.0035966366705608085
Bond Position:  [-11.92951494]


portfolio before change:  [-12.28531312]
curr_Stock_Price:  98.09593188579503
curr_Factors:  [98.09593189 -0.67221493 -0.94031925]
mat_Sqrt:  [[19.55853421  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.008652   0.07788185 0.31149675]
Stock Position:  0.008651999117523883
Bond Position:  [-13.13403904]


portfolio before change:  [-12.28850537]
curr_Stock_Price:  98.1065269218718
curr_Factors:  [98.10652692 -0.67212854 -0.94424653]
mat_Sqrt:  [[19.4856604   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.003038    0.05785398 -0.24838529]
Stock Position:  0.003037997954097428
Bond Position:  [-12.5865528]


portfolio before change:  [-12.29429799]
curr_Stock_Price:  97.23569521766463
curr_Factors:  [97.23569522 -0.64049115 -0.89888193]
mat_Sqrt:  [[20.85856787  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0416323  -0.10575087 -0.07001317]
Stock Position:  -0.0416322964697487
Bond Position:  [-8.2461527]


portfolio before change:  [-12.33545012]
curr_Stock_Price:  98.17463766312413
curr_Factors:  [98.17463766 -0.97620223 -0.89913881]
mat_Sqrt:  [[15.05043461  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00293048 -0.01021915 -0.61067429]
Stock Position:  0.002930477630007834
Bond Position:  [-12.6231487]


portfolio before change:  [-12.33705244]
curr_Stock_Price:  98.70487709591383
curr_Factors:  [98.7048771  -1.21209589 -0.93842667]
mat_Sqrt:  [[11.4915478   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 8.00586576e-05 -2.07023831e-02  9.85074434e-02]
Stock Position:  8.005865763441383e-05
Bond Position:  [-12.34495462]


portfolio before change:  [-12.34008933]
curr_Stock_Price:  99.32611726845664
curr_Factors:  [99.32611727 -1.0790515  -0.95232934]
mat_Sqrt:  [[13.02704671  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.06356216 -0.4182311   0.61452012]
Stock Position:  -0.06356215816840156
Bond Position:  [-6.02670696]


portfolio before change:  [-12.38768245]
curr_Stock_Price:  100.05117524107057
curr_Factors:  [100.05117524  -1.14639263  -0.93431153]
mat_Sqrt:  [[12.49061611  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.002623   0.00929715 0.20175263]
Stock Position:  0.002623003936311997
Bond Position:  [-12.65011707]


portfolio before change:  [-12.3951947]
curr_Stock_Price:  98.3930279056788
curr_Factors:  [98.39302791 -1.18827617 -0.90660776]
mat_Sqrt:  [[12.11065953  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0089003   0.03873878 -0.29670253]
Stock Position:  0.008900301497334626
Bond Position:  [-13.27092231]


portfolio before change:  [-12.39067203]
curr_Stock_Price:  99.27398809027663
curr_Factors:  [99.27398809 -1.09162337 -0.89615433]
mat_Sqrt:  [[13.60049077  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-2.15489845e-04  1.95309074e-02  3.20227247e-01]
Stock Position:  -0.00021548984517231963
Bond Position:  [-12.3692795]


portfolio before change:  [-12.39377561]
curr_Stock_Price:  99.32443670748945
curr_Factors:  [99.32443671 -1.06811412 -0.90463634]
mat_Sqrt:  [[13.81342808  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01209743 0.03716527 0.29100326]
Stock Position:  0.012097425485548293
Bond Position:  [-13.59534558]


portfolio before change:  [-12.3805332]
curr_Stock_Price:  100.70007449363942
curr_Factors:  [100.70007449  -1.0702066   -0.89099678]
mat_Sqrt:  [[14.16739439  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00663851 -0.00594036  0.10946785]
Stock Position:  0.006638510434724668
Bond Position:  [-13.04903169]


portfolio before change:  [-12.38146627]
curr_Stock_Price:  101.05099465170676
curr_Factors:  [101.05099465  -1.05219029  -0.91259167]
mat_Sqrt:  [[14.16598012  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00289932  0.00893131 -0.15619757]
Stock Position:  -0.0028993168461265927
Bond Position:  [-12.08848742]


portfolio before change:  [-12.3854491]
curr_Stock_Price:  101.38222105502564
curr_Factors:  [101.38222106  -0.9558154   -0.93040497]
mat_Sqrt:  [[15.37399382  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00980524 -0.1915306  -1.39372594]
Stock Position:  -0.009805236957049516
Bond Position:  [-11.3913724]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-12.39585645]
Stock Price:  102.15315032954884
PL:  [-14.54900678]
Settle:  Tensor("sub_288:0", shape=(), dtype=float64)
PL:  Tensor("sub_289:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  145
output_Z_Vals[:, i, :]:  [[ 1.19271183e+02 -4.92738716e+01 -4.92570741e+01]
 [ 9.48306006e-02  1.51097641e-01 -3.43400556e-02]
 [-2.72844869e+00 -2.73337717e+00 -8.72495251e-01]
 [-4.01073146e-02 -1.07861099e-02 -1.32558311e-01]
 [ 2.42874083e-01 -8.17269448e-02 -4.86891101e-02]
 [-1.38404645e-01 -2.17735969e-01 -3.59935639e-02]
 [-7.50914604e-02  1.19059799e-01 -1.61361054e-01]
 [-1.43115966e-02  2.66198005e-02 -2.69408131e-02]
 [-4.43088137e-02 -1.12048399e-01  7.97564998e-02]
 [-6.20458852e-01 -2.26849684e-01 -1.61872202e-02]
 [ 1.67392127e-02 -4.51819121e-02 -3.10797202e-01]
 [ 1.32065045e-01  4.24257969e-02  1.86983987e-02]
 [-6.20089469e-01 -1.13371334e+00  2.12756153e-01]
 [ 2.87005925e-02  4.30709775e-02  1.02041934e-01]
 [ 9.89049342e-02  1.31910807e-01 -1.04777399e-01]
 [ 4.75926240e-02  3.74230333e-02  7.16353902e-02]
 [ 5.15643794e-02  3.93103812e-02  2.26101043e-02]
 [ 8.49332534e-02 -2.12960860e-02  5.08068846e-02]
 [-4.35225243e-02 -2.60899376e-02 -3.75014866e-02]
 [ 1.05057811e-01 -8.22541728e-01 -6.03374553e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.27118322 -49.27387164 -49.25707411]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [   7.3268874   -15.90307369 -140.51672192]
init_Out:  [2.48374395]
Stock Position:  7.326887399052493
Bond position:  [-730.20499595]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-7.2475389]
curr_Stock_Price:  98.69675781036204
curr_Factors:  [98.69675781 -1.2009895  -1.02401553]
mat_Sqrt:  [[10.66585018  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01112557  0.04876655 -0.09796262]
Stock Position:  0.011125568141609424
Bond Position:  [-8.3455964]


portfolio before change:  [-7.2649212]
curr_Stock_Price:  97.3219385361809
curr_Factors:  [97.32193854 -0.95126449 -0.99687519]
mat_Sqrt:  [[13.87217112  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.2497442  -0.88219369 -2.4889861 ]
Stock Position:  -0.24974420290491217
Bond Position:  [17.04066876]


portfolio before change:  [-7.37630085]
curr_Stock_Price:  97.78497368735097
curr_Factors:  [97.78497369 -1.11563279 -0.96328504]
mat_Sqrt:  [[12.22952471  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00567212 -0.0034812  -0.37815196]
Stock Position:  -0.0056721232906096035
Bond Position:  [-6.82165242]


portfolio before change:  [-7.37614257]
curr_Stock_Price:  97.45636659872682
curr_Factors:  [97.4563666  -1.11795468 -0.97962267]
mat_Sqrt:  [[11.96310593  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01807666 -0.02637726 -0.13889648]
Stock Position:  0.018076661594708103
Bond Position:  [-9.13782833]


portfolio before change:  [-7.37767892]
curr_Stock_Price:  97.49776804068485
curr_Factors:  [97.49776804 -1.23558983 -0.98981434]
mat_Sqrt:  [[10.53207454  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01805883 -0.07027398 -0.10267962]
Stock Position:  -0.018058832413990256
Bond Position:  [-5.61698306]


portfolio before change:  [-7.35830732]
curr_Stock_Price:  96.34730524769041
curr_Factors:  [96.34730525 -1.16686122 -0.9632139 ]
mat_Sqrt:  [[11.4487929   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0073131   0.03842638 -0.46031817]
Stock Position:  -0.007313100054482974
Bond Position:  [-6.65370984]


portfolio before change:  [-7.35751688]
curr_Stock_Price:  96.01173226559756
curr_Factors:  [96.01173227 -1.54395418 -1.00209433]
mat_Sqrt:  [[ 7.52643795  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00191022  0.0085915  -0.07685464]
Stock Position:  -0.0019102161147688023
Bond Position:  [-7.17411372]


portfolio before change:  [-7.35979958]
curr_Stock_Price:  96.26769801655566
curr_Factors:  [96.26769802 -1.58449839 -0.98134871]
mat_Sqrt:  [[ 7.39856256  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00687976 -0.03616347  0.22752309]
Stock Position:  -0.006879764761650403
Bond Position:  [-6.69750046]


portfolio before change:  [-7.35204025]
curr_Stock_Price:  94.89644296944176
curr_Factors:  [94.89644297 -1.09020297 -0.91305281]
mat_Sqrt:  [[12.8010916   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.05234464 -0.07321542 -0.04617763]
Stock Position:  -0.05234464165852335
Bond Position:  [-2.38471995]


portfolio before change:  [-7.40659626]
curr_Stock_Price:  95.92729827937409
curr_Factors:  [95.92729828 -0.76638123 -0.94864267]
mat_Sqrt:  [[17.26302093  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00323957 -0.0145824  -0.88661791]
Stock Position:  -0.00323956738867415
Bond Position:  [-7.09583331]


portfolio before change:  [-7.40671591]
curr_Stock_Price:  95.41657244699304
curr_Factors:  [95.41657245 -0.58698587 -0.95623363]
mat_Sqrt:  [[20.3897593   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00708895 0.01369287 0.05334133]
Stock Position:  0.007088949258674391
Bond Position:  [-8.08311915]


portfolio before change:  [-7.40309722]
curr_Stock_Price:  96.21213782966419
curr_Factors:  [96.21213783 -0.37782579 -0.95915654]
mat_Sqrt:  [[25.26886985  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.03197923 -0.36590441  0.60693409]
Stock Position:  -0.0319792326645595
Bond Position:  [-4.32630688]


portfolio before change:  [-7.50583805]
curr_Stock_Price:  99.39104825523945
curr_Factors:  [99.39104826 -0.55772736 -1.01378357]
mat_Sqrt:  [[20.64660944  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00282476 0.0139011  0.29109724]
Stock Position:  0.0028247563740254316
Bond Position:  [-7.78659354]


portfolio before change:  [-7.50403019]
curr_Stock_Price:  100.72027799136173
curr_Factors:  [100.72027799  -0.65143118  -0.99734349]
mat_Sqrt:  [[19.36703662  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00539285  0.04257403 -0.29890075]
Stock Position:  0.005392849721052712
Bond Position:  [-8.04719951]


portfolio before change:  [-7.50491714]
curr_Stock_Price:  100.9289066503674
curr_Factors:  [100.92890665  -1.29352273  -0.98018705]
mat_Sqrt:  [[10.3885745   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00672413 0.01207823 0.20435583]
Stock Position:  0.006724125762235153
Bond Position:  [-8.1835758]


portfolio before change:  [-7.50056621]
curr_Stock_Price:  101.88026831140536
curr_Factors:  [101.88026831  -1.54195344  -0.99901771]
mat_Sqrt:  [[ 8.02713064  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00799836 0.01268737 0.06450033]
Stock Position:  0.007998355627939668
Bond Position:  [-8.31544083]


portfolio before change:  [-7.50516863]
curr_Stock_Price:  101.56479133701941
curr_Factors:  [101.56479134  -1.41642327  -1.01398751]
mat_Sqrt:  [[ 8.93777033  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01017671 -0.00687328  0.1449379 ]
Stock Position:  0.01017671260344738
Bond Position:  [-8.53876432]


portfolio before change:  [-7.51854618]
curr_Stock_Price:  100.46005416259662
curr_Factors:  [100.46005416  -1.42516642  -0.9950255 ]
mat_Sqrt:  [[ 8.93135624  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00632637 -0.00842049 -0.1069813 ]
Stock Position:  -0.00632637057748441
Bond Position:  [-6.88299865]


portfolio before change:  [-7.52413997]
curr_Stock_Price:  101.0722264953708
curr_Factors:  [101.0722265   -1.50520908  -0.9637901 ]
mat_Sqrt:  [[ 8.55774044  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02173543 -0.2654742  -1.72125965]
Stock Position:  -0.02173542564313614
Bond Position:  [-5.32729211]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-7.5273809]
Stock Price:  101.16005243641138
PL:  [-8.68743333]
Settle:  Tensor("sub_290:0", shape=(), dtype=float64)
PL:  Tensor("sub_291:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  146
output_Z_Vals[:, i, :]:  [[ 1.19271183e+02 -4.92738716e+01 -4.92570741e+01]
 [-5.82453484e-03 -5.15924147e-03 -6.11397053e-02]
 [-1.74208627e+00 -2.35149264e+00 -6.67062120e-01]
 [ 9.89512474e-02  2.78103301e-01 -4.72285373e-02]
 [ 4.24955728e-01  1.21462569e-01 -4.22011087e-01]
 [ 7.57175145e-02  1.17192732e-01 -6.73936232e-03]
 [ 7.69587892e-03  2.36858769e-02  7.92398887e-02]
 [ 8.70888757e-02  2.28455926e-01  1.08201441e-01]
 [ 8.15316304e-02  1.26410395e-01 -8.69170568e-02]
 [-1.35537301e+00 -5.49824667e-01 -5.31490224e-02]
 [ 3.29916197e-01  8.70485631e-02  6.84413625e-02]
 [-1.67729131e-01 -1.54381545e-03  2.88585129e-02]
 [-6.43806949e-01 -1.09279646e+00  2.27717248e-01]
 [-1.25162713e-02 -5.33933509e-03  4.33490722e-03]
 [-2.00327122e-02  3.71483325e-02 -6.26454025e-02]
 [ 9.49417042e-02  7.74072918e-03  2.05318964e-02]
 [-6.80599677e-02 -7.78392066e-02 -9.39567061e-02]
 [-2.06021068e-02 -1.22366309e-01  1.92629141e-01]
 [ 4.52316612e-02 -4.50351048e-02  6.35310682e-02]
 [ 1.00028451e-01 -8.50554029e-01 -3.64989416e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.27118322 -49.27387164 -49.25707411]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [   7.3268874   -15.90307369 -140.51672192]
init_Out:  [2.48374395]
Stock Position:  7.326887399052493
Bond position:  [-730.20499595]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [11.78860922]
curr_Stock_Price:  101.29487991531394
curr_Factors:  [101.29487992  -1.18921515  -1.02928709]
mat_Sqrt:  [[11.01803659  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00175691 -0.00166514 -0.17441456]
Stock Position:  -0.0017569147209368539
Bond Position:  [11.96657568]


portfolio before change:  [11.79152133]
curr_Stock_Price:  101.34035883332963
curr_Factors:  [101.34035883  -1.6830681   -1.04157427]
mat_Sqrt:  [[ 6.64485165  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.35489824 -0.75894098 -1.90294255]
Stock Position:  -0.3548982427559923
Bond Position:  [47.7570366]


portfolio before change:  [12.09461258]
curr_Stock_Price:  100.51998144069401
curr_Factors:  [100.51998144  -1.0789195   -1.03512009]
mat_Sqrt:  [[12.13770755  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01203509  0.08975745 -0.13472987]
Stock Position:  0.012035086573818974
Bond Position:  [10.8848459]


portfolio before change:  [12.10313629]
curr_Stock_Price:  101.00208543662619
curr_Factors:  [101.00208544  -1.25451183  -1.05037495]
mat_Sqrt:  [[10.07698782  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.03608286  0.03920188 -1.20388017]
Stock Position:  0.03608285777996348
Bond Position:  [8.45869241]


portfolio before change:  [12.10040149]
curr_Stock_Price:  100.86767986943494
curr_Factors:  [100.86767987  -0.98557628  -1.0508289 ]
mat_Sqrt:  [[13.16292787  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00746519  0.03782379 -0.01922552]
Stock Position:  0.007465186707671725
Bond Position:  [11.34740543]


portfolio before change:  [12.09734416]
curr_Stock_Price:  100.07807620449053
curr_Factors:  [100.0780762   -0.81919709  -1.03045104]
mat_Sqrt:  [[15.74153111  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00182355 0.00764458 0.22604935]
Stock Position:  0.0018235527821162402
Bond Position:  [11.91484651]


portfolio before change:  [12.10096605]
curr_Stock_Price:  100.43057721293673
curr_Factors:  [100.43057721  -0.96752346  -1.03703357]
mat_Sqrt:  [[13.53000333  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.0115158  0.07373383 0.30866859]
Stock Position:  0.011515797082001959
Bond Position:  [10.9444279]


portfolio before change:  [12.0876339]
curr_Stock_Price:  99.03522431150135
curr_Factors:  [99.03522431 -0.67726725 -1.03939749]
mat_Sqrt:  [[17.79310201  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00503528  0.04079878 -0.24795017]
Stock Position:  0.005035275705593966
Bond Position:  [11.58896424]


portfolio before change:  [12.11197165]
curr_Stock_Price:  103.29321366069517
curr_Factors:  [103.29321366  -0.68168755  -1.04019944]
mat_Sqrt:  [[18.46144833  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.08008334 -0.17745515 -0.15161937]
Stock Position:  -0.0800833430898863
Bond Position:  [20.38403752]


portfolio before change:  [12.14479999]
curr_Stock_Price:  102.94692822659732
curr_Factors:  [102.94692823  -0.7605977   -0.99956551]
mat_Sqrt:  [[17.7085998   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.02042259 0.0280948  0.19524416]
Stock Position:  0.020422588411971376
Bond Position:  [10.04235725]


portfolio before change:  [12.12997326]
curr_Stock_Price:  102.09798403920325
curr_Factors:  [102.09798404  -0.53581899  -0.94135758]
mat_Sqrt:  [[23.30706207  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00695727 -0.00049826  0.0823253 ]
Stock Position:  -0.006957270776188181
Bond Position:  [12.84029658]


portfolio before change:  [12.14046813]
curr_Stock_Price:  101.05096522524997
curr_Factors:  [101.05096523  -0.52479099  -0.88249549]
mat_Sqrt:  [[24.7379504   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.03316324 -0.35269854  0.64961392]
Stock Position:  -0.03316323669134594
Bond Position:  [15.4916452]


portfolio before change:  [12.09878804]
curr_Stock_Price:  102.42457910060826
curr_Factors:  [102.4245791   -0.87128777  -0.89101425]
mat_Sqrt:  [[17.58110405  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00072358 -0.00172326  0.01236628]
Stock Position:  -0.0007235779539881895
Bond Position:  [12.17290021]


portfolio before change:  [12.10065767]
curr_Stock_Price:  104.04704157272741
curr_Factors:  [104.04704157  -1.02706018  -0.87115732]
mat_Sqrt:  [[15.58993662  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00161882  0.01198957 -0.1787099 ]
Stock Position:  -0.0016188186290453214
Bond Position:  [12.26909096]


portfolio before change:  [12.10164064]
curr_Stock_Price:  105.33482511122041
curr_Factors:  [105.33482511  -1.41784644  -0.86776753]
mat_Sqrt:  [[10.71377307  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00940031 0.00249831 0.05857179]
Stock Position:  0.009400313881120363
Bond Position:  [11.11146022]


portfolio before change:  [12.1006077]
curr_Stock_Price:  104.92939770202119
curr_Factors:  [104.9293977   -1.74953786  -0.85256679]
mat_Sqrt:  [[ 7.77709652  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01326043 -0.0251225  -0.26803233]
Stock Position:  -0.013260432263275538
Bond Position:  [13.49201687]


portfolio before change:  [12.1043655]
curr_Stock_Price:  104.90041109742621
curr_Factors:  [104.9004111   -1.55964026  -0.85360784]
mat_Sqrt:  [[ 9.39110849  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00066656 -0.03949356  0.54951732]
Stock Position:  -0.0006665630802772011
Bond Position:  [12.17428825]


portfolio before change:  [12.10721695]
curr_Stock_Price:  105.18922308653985
curr_Factors:  [105.18922309  -1.32524096  -0.87280535]
mat_Sqrt:  [[11.67809117  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0041965  -0.01453502  0.18123645]
Stock Position:  0.004196502080593269
Bond Position:  [11.66579015]


portfolio before change:  [12.11302378]
curr_Stock_Price:  105.87789713358077
curr_Factors:  [105.87789713  -1.32862142  -0.8822702 ]
mat_Sqrt:  [[11.60452261  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01276169 -0.27451513 -1.04121321]
Stock Position:  -0.012761689635926447
Bond Position:  [13.46420464]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [12.11371672]
Stock Price:  106.08739345479478
PL:  [6.02632327]
Settle:  Tensor("sub_292:0", shape=(), dtype=float64)
PL:  Tensor("sub_293:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  147
output_Z_Vals[:, i, :]:  [[ 1.19271183e+02 -4.92738716e+01 -4.92570741e+01]
 [ 3.75362718e-02  6.91991386e-02 -3.70273720e-02]
 [-2.21854853e+00 -2.98686732e+00 -8.50864254e-01]
 [-1.65464639e-01  9.50585344e-03  1.08398467e-01]
 [ 6.98803938e-01  7.41778153e-02 -5.05337845e-01]
 [ 7.57175145e-02  1.17192732e-01 -6.73936232e-03]
 [ 1.40111420e-02  2.39842279e-02  1.02273864e-01]
 [ 1.32750666e-01  3.61539648e-01  2.28161303e-01]
 [ 1.01363476e-01  1.01059598e-01 -7.38090859e-02]
 [-1.24179618e+00 -5.04337860e-01 -4.73426763e-02]
 [ 3.26515937e-01  4.57921244e-02  5.72944901e-02]
 [-1.66972332e-01  1.53523430e-02  2.78157315e-02]
 [-8.43053560e-01 -1.10078288e+00  3.02550241e-01]
 [ 2.17878994e-02 -4.26885280e-02 -1.84082492e-02]
 [-1.39955651e-01 -1.61374625e-01  4.60175675e-02]
 [ 1.29151228e-01  1.54705389e-02  3.30206620e-02]
 [-1.43209885e-01 -1.51434441e-01 -1.67185831e-01]
 [-6.46852063e-02 -1.58658667e-01  2.68472061e-01]
 [ 5.96655693e-02 -8.97751483e-02  1.02130747e-01]
 [ 5.50300587e-02 -5.60811929e-01 -2.23866390e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.27118322 -49.27387164 -49.25707411]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [   7.3268874   -15.90307369 -140.51672192]
init_Out:  [2.48374395]
Stock Position:  7.326887399052493
Bond position:  [-730.20499595]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [3.08084028]
curr_Stock_Price:  100.10641222607649
curr_Factors:  [100.10641223  -1.27161793  -1.01270754]
mat_Sqrt:  [[10.19511078  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00432593  0.02233393 -0.10562879]
Stock Position:  0.004325927111663439
Bond Position:  [2.64778724]


portfolio before change:  [3.08566666]
curr_Stock_Price:  101.06906239943982
curr_Factors:  [101.0690624   -0.88952503  -1.04405842]
mat_Sqrt:  [[14.61751732  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.20536471 -0.96400728 -2.42727888]
Stock Position:  -0.20536470988216354
Bond Position:  [23.84168534]


portfolio before change:  [2.8931537]
curr_Stock_Price:  102.03550949624986
curr_Factors:  [102.0355095   -0.97519911  -1.05064221]
mat_Sqrt:  [[13.45673282  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01050757  0.003068    0.30923065]
Stock Position:  -0.010507566880986903
Bond Position:  [3.96529864]


portfolio before change:  [2.89530415]
curr_Stock_Price:  101.92520801944637
curr_Factors:  [101.92520802  -0.964388    -1.02581511]
mat_Sqrt:  [[13.92988018  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.04384774  0.02394079 -1.44158821]
Stock Position:  0.043847740049913465
Bond Position:  [-1.57388587]


portfolio before change:  [2.90410764]
curr_Stock_Price:  102.1349567054298
curr_Factors:  [102.13495671  -0.97171721  -1.01124065]
mat_Sqrt:  [[14.06004639  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00698886  0.03782379 -0.01922552]
Stock Position:  0.0069888613042433925
Bond Position:  [2.19030059]


portfolio before change:  [2.89361034]
curr_Stock_Price:  100.55459299174127
curr_Factors:  [100.55459299  -0.7487658   -1.02311018]
mat_Sqrt:  [[17.0956631   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00232711 0.00774088 0.29175887]
Stock Position:  0.0023271087368009116
Bond Position:  [2.65960887]


portfolio before change:  [2.89457489]
curr_Stock_Price:  100.68332187015777
curr_Factors:  [100.68332187  -0.48615396  -0.9981971 ]
mat_Sqrt:  [[22.81981188  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01109224 0.11668642 0.65088069]
Stock Position:  0.011092241701883705
Bond Position:  [1.77777115]


portfolio before change:  [2.88882938]
curr_Stock_Price:  100.12527351466089
curr_Factors:  [100.12527351  -0.68737281  -1.03980449]
mat_Sqrt:  [[17.80082557  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0060068   0.03261685 -0.21055678]
Stock Position:  0.0060067979996330425
Bond Position:  [2.28739709]


portfolio before change:  [2.90094694]
curr_Stock_Price:  102.04736846667468
curr_Factors:  [102.04736847  -0.8586065   -1.08188185]
mat_Sqrt:  [[14.65745016  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.09240403 -0.16277434 -0.13505548]
Stock Position:  -0.09240403233381868
Bond Position:  [12.33053527]


portfolio before change:  [2.69536161]
curr_Stock_Price:  104.30558536441953
curr_Factors:  [104.30558536  -1.00197884  -1.02453575]
mat_Sqrt:  [[13.74685849  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.02528275 0.01477934 0.16344523]
Stock Position:  0.02528275130059581
Bond Position:  [0.05822943]


portfolio before change:  [2.71714446]
curr_Stock_Price:  105.1665793242513
curr_Factors:  [105.16657932  -1.06489155  -1.04063994]
mat_Sqrt:  [[12.80728395  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01234928  0.00495495  0.07935054]
Stock Position:  -0.012349276137466303
Bond Position:  [4.01587559]


portfolio before change:  [2.71937709]
curr_Stock_Price:  105.06709758721622
curr_Factors:  [105.06709759  -1.17781591  -1.0252897 ]
mat_Sqrt:  [[11.6056676   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.08668111 -0.35527615  0.86309162]
Stock Position:  -0.08668110709209309
Bond Position:  [11.82670942]


portfolio before change:  [2.53812858]
curr_Stock_Price:  107.19219223078419
curr_Factors:  [107.19219223  -1.28868818  -0.98061648]
mat_Sqrt:  [[11.08196219  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0008407  -0.01377766 -0.05251361]
Stock Position:  0.000840696966724265
Bond Position:  [2.44801243]


portfolio before change:  [2.53986179]
curr_Stock_Price:  108.525769257423
curr_Factors:  [108.52576926  -1.15696347  -0.97144677]
mat_Sqrt:  [[12.91742809  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01265754 -0.05208344  0.13127531]
Stock Position:  -0.012657536078895816
Bond Position:  [3.91353063]


portfolio before change:  [2.55593806]
curr_Stock_Price:  107.33298087403276
curr_Factors:  [107.33298087  -0.77864329  -0.97100086]
mat_Sqrt:  [[18.65831364  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00745241 0.00499309 0.09419876]
Stock Position:  0.007452412648683011
Bond Position:  [1.75604839]


portfolio before change:  [2.5624921]
curr_Stock_Price:  108.15351747228807
curr_Factors:  [108.15351747  -0.68371205  -0.99011143]
mat_Sqrt:  [[20.28188656  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01026768 -0.04887526 -0.47693464]
Stock Position:  -0.010267682712344194
Bond Position:  [3.6729781]


portfolio before change:  [2.58322803]
curr_Stock_Price:  106.22342544549349
curr_Factors:  [106.22342545  -0.89220951  -0.94983764]
mat_Sqrt:  [[16.8356307   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00251073 -0.05120686  0.76587606]
Stock Position:  -0.0025107251351630874
Bond Position:  [2.84992586]


portfolio before change:  [2.58232447]
curr_Stock_Price:  106.86711621309823
curr_Factors:  [106.86711621  -0.76838266  -0.88971131]
mat_Sqrt:  [[20.35837119  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00305465 -0.0289748   0.29135059]
Stock Position:  0.003054647388556162
Bond Position:  [2.25588312]


portfolio before change:  [2.58491768]
curr_Stock_Price:  107.53140360110079
curr_Factors:  [107.5314036   -0.79095869  -0.85498215]
mat_Sqrt:  [[20.73539391  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00507064 -0.18100127 -0.6386285 ]
Stock Position:  -0.005070640713127876
Bond Position:  [3.13017079]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [2.59021443]
Stock Price:  106.64115799809119
PL:  [-4.05094356]
Settle:  Tensor("sub_294:0", shape=(), dtype=float64)
PL:  Tensor("sub_295:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  148
output_Z_Vals[:, i, :]:  [[ 1.19271183e+02 -4.92738716e+01 -4.92570741e+01]
 [ 3.08651889e-02  5.84812933e-02 -4.01231838e-02]
 [-2.79323587e+00 -2.93974597e+00 -9.22130660e-01]
 [-5.71669855e-02  1.55452805e-03 -1.31973716e-01]
 [ 6.97749142e-01 -1.19673661e-01 -3.35696014e-01]
 [-9.60250916e-02 -1.78783305e-01  4.02573068e-02]
 [ 4.41066135e-03  2.41941465e-02  7.01648633e-02]
 [ 1.02696269e-01  2.56091769e-01  1.22992056e-01]
 [ 5.61702856e-02  1.31937018e-01 -7.65613296e-02]
 [-1.38271552e+00 -5.65017513e-01 -5.36870269e-02]
 [ 2.26586309e-01 -5.97041421e-02  3.08551072e-02]
 [-7.94371089e-02  1.01978568e-01  2.34867534e-02]
 [-1.01240746e+00 -1.32090699e+00  3.75907255e-01]
 [ 1.14581801e-02 -5.55526184e-02  6.71521716e-02]
 [-1.40588843e-01 -1.62470432e-01  4.66244689e-02]
 [-1.35044655e-02 -1.65044115e-02 -1.01054514e-01]
 [-3.54703057e-01 -3.58552294e-01 -3.73273346e-01]
 [-2.20612059e-01 -3.22118546e-01  4.35522552e-01]
 [ 9.10945889e-02 -3.17565803e-01  2.81312725e-01]
 [ 6.85182145e-02 -7.18838840e-01 -4.18743797e-03]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.27118322 -49.27387164 -49.25707411]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [   7.3268874   -15.90307369 -140.51672192]
init_Out:  [2.48374395]
Stock Position:  7.326887399052493
Bond position:  [-730.20499595]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-1.88600644]
curr_Stock_Price:  99.42851908341602
curr_Factors:  [99.42851908 -0.62754444 -0.98381787]
mat_Sqrt:  [[19.84747261  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00174393  0.01887476 -0.11446028]
Stock Position:  0.0017439259367721589
Bond Position:  [-2.05940242]


portfolio before change:  [-1.88994636]
curr_Stock_Price:  97.46456017284308
curr_Factors:  [97.46456017 -0.76039656 -0.96730054]
mat_Sqrt:  [[17.3187846   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.20680078 -0.94879893 -2.6305821 ]
Stock Position:  -0.20680077822518858
Bond Position:  [18.26580053]


portfolio before change:  [-2.03141079]
curr_Stock_Price:  98.17070574306372
curr_Factors:  [98.17070574 -0.69667048 -0.96146301]
mat_Sqrt:  [[18.70095072  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00448045  0.00050172 -0.37648428]
Stock Position:  -0.004480450859212707
Bond Position:  [-1.59156177]


portfolio before change:  [-2.03692592]
curr_Stock_Price:  99.31282059985834
curr_Factors:  [99.3128206  -0.62560344 -0.99445449]
mat_Sqrt:  [[19.65273947  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.03077419 -0.03862451 -0.95764729]
Stock Position:  0.0307741929564218
Bond Position:  [-5.09319783]


portfolio before change:  [-2.06351534]
curr_Stock_Price:  98.49018454431757
curr_Factors:  [98.49018454 -0.70908353 -0.94597371]
mat_Sqrt:  [[18.81961457  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0066049  -0.05770206  0.11484289]
Stock Position:  -0.006604895761983966
Bond Position:  [-1.41299794]


portfolio before change:  [-2.07178285]
curr_Stock_Price:  99.68841878151534
curr_Factors:  [99.68841878 -0.79634019 -0.92552651]
mat_Sqrt:  [[17.81752998  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00132856 0.00780863 0.20016082]
Stock Position:  0.0013285575271144397
Bond Position:  [-2.20422465]


portfolio before change:  [-2.07388523]
curr_Stock_Price:  98.5207892348329
curr_Factors:  [98.52078923 -0.6132469  -0.89900783]
mat_Sqrt:  [[21.71520819  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00829264 0.08265326 0.3508621 ]
Stock Position:  0.008292641207586755
Bond Position:  [-2.89088279]


portfolio before change:  [-2.06778232]
curr_Stock_Price:  99.34389499613812
curr_Factors:  [99.343895   -0.48318086 -0.91559972]
mat_Sqrt:  [[24.5277944   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00275091  0.04258249 -0.21840816]
Stock Position:  0.0027509118620076102
Bond Position:  [-2.34106862]


portfolio before change:  [-2.05495702]
curr_Stock_Price:  104.21887545373497
curr_Factors:  [104.21887545  -0.71186087  -0.89267978]
mat_Sqrt:  [[20.94610293  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.07204243 -0.18235862 -0.15315414]
Stock Position:  -0.07204242531896846
Bond Position:  [5.45322353]


portfolio before change:  [-2.2558749]
curr_Stock_Price:  107.02668420424861
curr_Factors:  [107.0266842   -1.01106984  -0.89476729]
mat_Sqrt:  [[15.91466574  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01386756 -0.01926943  0.08802103]
Stock Position:  0.013867556354595138
Bond Position:  [-3.74007347]


portfolio before change:  [-2.23856338]
curr_Stock_Price:  108.34246433409814
curr_Factors:  [108.34246433  -1.06887778  -0.86241836]
mat_Sqrt:  [[15.70534401  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00342728  0.03291344  0.06700117]
Stock Position:  -0.0034272797419519544
Bond Position:  [-1.86724345]


portfolio before change:  [-2.250071]
curr_Stock_Price:  111.56389803957049
curr_Factors:  [111.56389804  -1.27989453  -0.85313798]
mat_Sqrt:  [[13.21780773  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.09118795 -0.4263209   1.07235877]
Stock Position:  -0.09118794528643871
Bond Position:  [7.92321163]


portfolio before change:  [-2.24409007]
curr_Stock_Price:  111.52003391833527
curr_Factors:  [111.52003392  -1.21858759  -0.85379751]
mat_Sqrt:  [[14.03871899  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00098484 -0.01792953  0.19156645]
Stock Position:  0.0009848426364257288
Bond Position:  [-2.35391976]


portfolio before change:  [-2.24343384]
curr_Stock_Price:  112.7839749420132
curr_Factors:  [112.78397494  -1.47294834  -0.83343466]
mat_Sqrt:  [[11.23564445  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01461739 -0.05243711  0.13300663]
Stock Position:  -0.014617390400463313
Bond Position:  [-0.59482645]


portfolio before change:  [-2.2493919]
curr_Stock_Price:  113.18140095910053
curr_Factors:  [113.18140096  -1.81864963  -0.82980007]
mat_Sqrt:  [[ 8.00880972  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00468248 -0.00532678 -0.2882804 ]
Stock Position:  -0.004682478675536233
Bond Position:  [-1.7194224]


portfolio before change:  [-2.24764053]
curr_Stock_Price:  112.71556294124329
curr_Factors:  [112.71556294  -1.76237525  -0.80286582]
mat_Sqrt:  [[ 8.66789903  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.05815554 -0.11572226 -1.06484496]
Stock Position:  -0.05815553906052514
Bond Position:  [4.30739379]


portfolio before change:  [-2.25144156]
curr_Stock_Price:  112.79944160535717
curr_Factors:  [112.79944161  -1.55995404  -0.80028223]
mat_Sqrt:  [[10.64803229  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01854461 -0.10396331  1.24242462]
Stock Position:  -0.018544605980810966
Bond Position:  [-0.15962036]


portfolio before change:  [-2.25359423]
curr_Stock_Price:  112.91337033443936
curr_Factors:  [112.91337033  -1.39600871  -0.8196299 ]
mat_Sqrt:  [[12.31702293  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00679502 -0.10249392  0.8025069 ]
Stock Position:  0.006795023495505592
Bond Position:  [-3.02084324]


portfolio before change:  [-2.25354152]
curr_Stock_Price:  113.03228412598318
curr_Factors:  [113.03228413  -1.10317773  -0.81597612]
mat_Sqrt:  [[16.58534743  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0047674  -0.23200424 -0.01194559]
Stock Position:  -0.004767395249888763
Bond Position:  [-1.71467194]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-2.25438436]
Stock Price:  113.11914982366226
PL:  [-15.37353418]
Settle:  Tensor("sub_296:0", shape=(), dtype=float64)
PL:  Tensor("sub_297:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  149
output_Z_Vals[:, i, :]:  [[ 1.19271183e+02 -4.92738716e+01 -4.92570741e+01]
 [ 6.78084006e-02  1.18128175e-01 -2.39273830e-02]
 [-2.51923679e+00 -2.95323052e+00 -8.82753590e-01]
 [-5.06880807e-02 -1.09934508e-02 -1.30227644e-01]
 [ 6.73396316e-01 -1.68473044e-01 -2.50672907e-01]
 [-1.47712969e-01 -2.65014257e-01  6.90733664e-02]
 [-4.70001142e-02  9.22659454e-02 -5.78569271e-02]
 [ 9.76693794e-02  2.41292360e-01  1.09178153e-01]
 [-9.80531666e-02  3.03782087e-01 -7.73347882e-02]
 [-6.33287605e-01 -2.33845531e-01 -1.68035639e-02]
 [ 1.50891622e-02 -3.90228684e-02 -3.03487484e-01]
 [ 1.66780949e-03 -5.78381934e-02  3.29956723e-02]
 [-5.74553182e-01 -1.33758193e+00  2.05787710e-01]
 [ 1.52418662e-02  3.13530271e-02  7.62483076e-02]
 [ 1.02262904e-01  1.23265328e-01 -1.04779190e-01]
 [-1.76630547e-02  5.49873962e-02  1.02531337e-01]
 [ 7.54960363e-02  1.08029724e-01  8.44714754e-02]
 [ 8.71867130e-02 -2.58368478e-02  2.83350553e-02]
 [-2.61511404e-02  5.90756302e-02 -5.21533773e-02]
 [ 6.60517246e-02 -5.82765176e-01 -4.29361084e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.27118322 -49.27387164 -49.25707411]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [   7.3268874   -15.90307369 -140.51672192]
init_Out:  [2.48374395]
Stock Position:  7.326887399052493
Bond position:  [-730.20499595]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-6.0596617]
curr_Stock_Price:  98.85888357147124
curr_Factors:  [98.85888357 -0.92414021 -0.95016098]
mat_Sqrt:  [[15.17109881  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00573703  0.0381257  -0.06825816]
Stock Position:  0.005737030506624804
Bond Position:  [-6.62681813]


portfolio before change:  [-6.06227981]
curr_Stock_Price:  98.69134031500381
curr_Factors:  [98.69134032 -0.96275627 -0.92593206]
mat_Sqrt:  [[14.92904844  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.22119653 -0.95315105 -2.51825028]
Stock Position:  -0.22119653408296905
Bond Position:  [15.76790261]


portfolio before change:  [-5.90771866]
curr_Stock_Price:  98.01041335612976
curr_Factors:  [98.01041336 -0.8632472  -0.9104565 ]
mat_Sqrt:  [[16.63269006  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00478063 -0.00354812 -0.37150322]
Stock Position:  -0.0047806287269074495
Bond Position:  [-5.43916726]


portfolio before change:  [-5.90962084]
curr_Stock_Price:  98.12383389429392
curr_Factors:  [98.12383389 -0.73814654 -0.9340576 ]
mat_Sqrt:  [[18.43085479  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.03189426 -0.05437444 -0.71510003]
Stock Position:  0.03189426172936503
Bond Position:  [-9.03920808]


portfolio before change:  [-5.93506627]
curr_Stock_Price:  97.39688995361178
curr_Factors:  [97.39688995 -0.67050703 -0.90402774]
mat_Sqrt:  [[20.17127405  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00930577 -0.08553298  0.19704709]
Stock Position:  -0.00930576991901632
Bond Position:  [-5.02871322]


portfolio before change:  [-5.92890894]
curr_Stock_Price:  96.60010896875275
curr_Factors:  [96.60010897 -0.52501307 -0.86496842]
mat_Sqrt:  [[24.06114679  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00166145  0.02977871 -0.16504971]
Stock Position:  -0.001661450434895939
Bond Position:  [-5.76841265]


portfolio before change:  [-5.93024387]
curr_Stock_Price:  96.53549090189179
curr_Factors:  [96.5354909  -0.45328634 -0.85798884]
mat_Sqrt:  [[26.01401773  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00650453 0.07787677 0.31145488]
Stock Position:  0.006504526719734436
Bond Position:  [-6.55816155]


portfolio before change:  [-5.93732793]
curr_Stock_Price:  95.69848576508048
curr_Factors:  [95.69848577 -0.65501729 -0.83437138]
mat_Sqrt:  [[21.58101078  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00240164  0.09804525 -0.22061462]
Stock Position:  -0.002401639377705878
Bond Position:  [-5.70749468]


portfolio before change:  [-5.93655726]
curr_Stock_Price:  94.78339048530735
curr_Factors:  [94.78339049 -0.50833985 -0.77776632]
mat_Sqrt:  [[26.19289046  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02613118 -0.07547332 -0.04793589]
Stock Position:  -0.026131180084986976
Bond Position:  [-3.45975541]


portfolio before change:  [-5.96061709]
curr_Stock_Price:  95.67101922018985
curr_Factors:  [95.67101922 -0.54258889 -0.80448808]
mat_Sqrt:  [[24.87438247  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00220409 -0.01259458 -0.86576532]
Stock Position:  -0.002204093745838184
Bond Position:  [-5.7497492]


portfolio before change:  [-5.96870466]
curr_Stock_Price:  98.68811127189873
curr_Factors:  [98.68811127 -0.73945257 -0.79893742]
mat_Sqrt:  [[21.19095631  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00016059 -0.0186672   0.09412747]
Stock Position:  -0.00016059439921867067
Bond Position:  [-5.9528559]


portfolio before change:  [-5.97026225]
curr_Stock_Price:  99.11891328239695
curr_Factors:  [99.11891328 -0.87100287 -0.79879037]
mat_Sqrt:  [[18.66270298  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.04316522 -0.43170271  0.58705506]
Stock Position:  -0.043165221618998995
Bond Position:  [-1.69177239]


portfolio before change:  [-6.00653087]
curr_Stock_Price:  99.94934178968309
curr_Factors:  [99.94934179 -0.73398284 -0.86381374]
mat_Sqrt:  [[20.22393679  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.0018397  0.01011915 0.2175152 ]
Stock Position:  0.0018396960522743303
Bond Position:  [-6.19040728]


portfolio before change:  [-6.00853881]
curr_Stock_Price:  99.69922073293851
curr_Factors:  [99.69922073 -0.92500478 -0.85744177]
mat_Sqrt:  [[16.77200812  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00632222  0.03978371 -0.29890586]
Stock Position:  0.0063222227101352784
Bond Position:  [-6.63885949]


portfolio before change:  [-6.00853186]
curr_Stock_Price:  99.96287460622754
curr_Factors:  [99.96287461 -0.53435169 -0.86054211]
mat_Sqrt:  [[24.77673373  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00058484 0.01774711 0.29249337]
Stock Position:  0.0005848358486322347
Bond Position:  [-6.06699373]


portfolio before change:  [-6.01136029]
curr_Stock_Price:  97.72037919240836
curr_Factors:  [97.72037919 -0.3131818  -0.83777541]
mat_Sqrt:  [[30.91226157  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00371342 0.03486644 0.24097361]
Stock Position:  0.003713418990718198
Bond Position:  [-6.374237]


portfolio before change:  [-6.00072132]
curr_Stock_Price:  101.01457339865313
curr_Factors:  [101.0145734   -0.57606114  -0.82072688]
mat_Sqrt:  [[24.99002574  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00350927 -0.00833881  0.08083203]
Stock Position:  0.003509266391288525
Bond Position:  [-6.35520837]


portfolio before change:  [-6.00052469]
curr_Stock_Price:  101.52340625750986
curr_Factors:  [101.52340626  -0.61878903  -0.79391236]
mat_Sqrt:  [[24.71939075  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00100076  0.01906658 -0.14877907]
Stock Position:  -0.0010007585430510321
Bond Position:  [-5.89892428]


portfolio before change:  [-6.00344854]
curr_Stock_Price:  102.97123567012753
curr_Factors:  [102.97123567  -0.95261366  -0.81831531]
mat_Sqrt:  [[17.52311234  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0080207  -0.18808665 -1.22484766]
Stock Position:  -0.008020703184185985
Bond Position:  [-5.17754682]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-6.01443356]
Stock Price:  104.17941879774366
PL:  [-10.19385236]
Settle:  Tensor("sub_298:0", shape=(), dtype=float64)
PL:  Tensor("sub_299:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  150
output_Z_Vals[:, i, :]:  [[ 1.19271183e+02 -4.92738716e+01 -4.92570741e+01]
 [ 2.05459937e-02  4.10757373e-02 -4.56145568e-02]
 [-2.35723192e+00 -3.17180520e+00 -9.04363359e-01]
 [-3.34024159e-01 -1.99175745e-01  2.15675687e-01]
 [ 1.05212815e+00  1.01716138e-01 -6.88102000e-01]
 [ 6.57397320e-02  1.54811786e-01  9.41369797e-03]
 [ 1.47519930e-01 -3.19357304e-01 -3.76934252e-01]
 [-1.15815502e-01  1.41854351e-01  3.71523870e-01]
 [-1.13179362e-01 -4.48818768e-01  1.14272900e-01]
 [-2.30096360e+00 -7.65514795e-01 -1.02378485e-01]
 [ 1.66340732e-02 -2.54432531e-01 -2.09498350e-02]
 [ 9.37160972e-02  2.28574947e-01  1.59337331e-02]
 [-1.06158565e+00 -1.40793846e+00  3.98213094e-01]
 [ 3.10475569e-02 -4.84052068e-02  6.33412879e-02]
 [-1.13179668e-01 -1.15035855e-01  2.03533305e-02]
 [-6.16888791e-03 -1.49760603e-02 -5.74554354e-02]
 [-3.51858542e-01 -3.55766625e-01 -3.70501535e-01]
 [-1.88614804e-01 -2.93358151e-01  3.87447254e-01]
 [ 8.74915743e-02 -2.91451942e-01  2.60771350e-01]
 [ 1.17925831e-01 -1.03892467e+00 -1.48522367e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.27118322 -49.27387164 -49.25707411]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [   7.3268874   -15.90307369 -140.51672192]
init_Out:  [2.48374395]
Stock Position:  7.326887399052493
Bond position:  [-730.20499595]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [4.49998923]
curr_Stock_Price:  100.30010279035852
curr_Factors:  [100.30010279  -0.96669373  -0.96733993]
mat_Sqrt:  [[14.49977397  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00135309  0.01325714 -0.13012563]
Stock Position:  0.0013530908213959458
Bond Position:  [4.36427409]


portfolio before change:  [4.50310105]
curr_Stock_Price:  101.79343378918524
curr_Factors:  [101.79343379  -0.69274565  -0.95217574]
mat_Sqrt:  [[19.64895607  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.16231276 -1.02369573 -2.57989694]
Stock Position:  -0.1623127627820104
Bond Position:  [21.02547452]


portfolio before change:  [4.34607708]
curr_Stock_Price:  102.79323805709767
curr_Factors:  [102.79323806  -0.88207102  -0.95061165]
mat_Sqrt:  [[16.44525362  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02010648 -0.0642837   0.6152627 ]
Stock Position:  -0.020106477551906497
Bond Position:  [6.41288702]


portfolio before change:  [4.32567447]
curr_Stock_Price:  103.8877129853485
curr_Factors:  [103.88771299  -0.92907518  -0.94689673]
mat_Sqrt:  [[15.91622024  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0585838   0.03282874 -1.96296347]
Stock Position:  0.05858379849330242
Bond Position:  [-1.76046237]


portfolio before change:  [4.46963812]
curr_Stock_Price:  106.35262350061019
curr_Factors:  [106.3526235   -0.93123315  -0.93632197]
mat_Sqrt:  [[16.43158003  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00604094 0.04996529 0.02685466]
Stock Position:  0.006040935706304878
Bond Position:  [3.82716876]


portfolio before change:  [4.47810451]
curr_Stock_Price:  107.59572157646791
curr_Factors:  [107.59572158  -1.04208094  -0.95200067]
mat_Sqrt:  [[14.64793355  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 3.67970737e-04 -1.03072127e-01 -1.07528850e+00]
Stock Position:  0.00036797073723383395
Bond Position:  [4.43851243]


portfolio before change:  [4.47928768]
curr_Stock_Price:  107.79521633834312
curr_Factors:  [107.79521634  -0.85395942  -0.94576001]
mat_Sqrt:  [[17.82342946  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-6.18433818e-04  4.57832948e-02  1.05985419e+00]
Stock Position:  -0.0006184338175282843
Bond Position:  [4.54595189]


portfolio before change:  [4.47955417]
curr_Stock_Price:  109.20222766261222
curr_Factors:  [109.20222766  -0.70132438  -0.97910226]
mat_Sqrt:  [[20.34377213  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00892009 -0.14485563  0.32598878]
Stock Position:  -0.008920088680433645
Bond Position:  [5.45364773]


portfolio before change:  [4.46053389]
curr_Stock_Price:  111.48739178378779
curr_Factors:  [111.48739178  -1.30656513  -0.96544216]
mat_Sqrt:  [[11.4949087   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.21558428 -0.24706884 -0.29205732]
Stock Position:  -0.21558427634917868
Bond Position:  [28.49546257]


portfolio before change:  [4.37405649]
curr_Stock_Price:  111.92157072444665
curr_Factors:  [111.92157072  -0.99057452  -0.91576347]
mat_Sqrt:  [[16.63419256  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00237932 -0.08211775 -0.05976405]
Stock Position:  -0.0023793229932195146
Bond Position:  [4.64035406]


portfolio before change:  [4.37231185]
curr_Stock_Price:  113.14245385439527
curr_Factors:  [113.14245385  -1.26942262  -0.94300071]
mat_Sqrt:  [[12.38175909  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01159982 0.07377225 0.04545451]
Stock Position:  0.011599823700113301
Bond Position:  [3.05987933]


portfolio before change:  [4.37686554]
curr_Stock_Price:  113.4690643023809
curr_Factors:  [113.4690643   -1.39948803  -0.95011141]
mat_Sqrt:  [[10.82578508  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.11709959 -0.45441019  1.13599112]
Stock Position:  -0.11709958876551446
Bond Position:  [17.6640463]


portfolio before change:  [4.54182718]
curr_Stock_Price:  112.09805109436027
curr_Factors:  [112.09805109  -1.70417649  -0.9673257 ]
mat_Sqrt:  [[ 7.75138673  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00439874 -0.01562271  0.18069506]
Stock Position:  0.004398744748724076
Bond Position:  [4.04873647]


portfolio before change:  [4.54205034]
curr_Stock_Price:  111.9186469777084
curr_Factors:  [111.91864698  -1.89139758  -0.9196729 ]
mat_Sqrt:  [[ 6.73085219  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01968646 -0.03712766  0.05806239]
Stock Position:  -0.019686460814707686
Bond Position:  [6.7453324]


portfolio before change:  [4.54508348]
curr_Stock_Price:  111.85024490210441
curr_Factors:  [111.8502449   -1.83059231  -0.96060358]
mat_Sqrt:  [[ 6.86176694  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00305372 -0.0048335  -0.16390436]
Stock Position:  -0.0030537185613164234
Bond Position:  [4.88664265]


portfolio before change:  [4.54516384]
curr_Stock_Price:  112.22403760391612
curr_Factors:  [112.2240376   -2.09459727  -0.94970127]
mat_Sqrt:  [[ 5.34519842  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.09356199 -0.11482318 -1.05693775]
Stock Position:  -0.09356199158513477
Bond Position:  [15.0450683]


portfolio before change:  [4.58378277]
curr_Stock_Price:  111.85148035084335
curr_Factors:  [111.85148035  -1.89643325  -0.90759074]
mat_Sqrt:  [[ 6.77438057  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0250073  -0.09468094  1.10527917]
Stock Position:  -0.025007296848625193
Bond Position:  [7.38088594]


portfolio before change:  [4.5947019]
curr_Stock_Price:  111.48863903423592
curr_Factors:  [111.48863903  -1.81732477  -0.9095778 ]
mat_Sqrt:  [[ 7.29376687  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01113676 -0.09406571  0.74390808]
Stock Position:  0.011136759100982682
Bond Position:  [3.35307979]


portfolio before change:  [4.59265466]
curr_Stock_Price:  111.22953102568393
curr_Factors:  [111.22953103  -1.63408657  -0.87968766]
mat_Sqrt:  [[ 9.00537562  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01382072 -0.33531149 -0.42369297]
Stock Position:  -0.013820720517820245
Bond Position:  [6.12992692]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [4.5984871]
Stock Price:  110.91842020517473
PL:  [-6.3199331]
Settle:  Tensor("sub_300:0", shape=(), dtype=float64)
PL:  Tensor("sub_301:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  151
output_Z_Vals[:, i, :]:  [[ 1.19271183e+02 -4.92738716e+01 -4.92570741e+01]
 [ 5.17432173e-03 -1.25505770e-03 -7.68283368e-02]
 [-2.16065062e+00 -2.90965897e+00 -8.28529307e-01]
 [-1.91541470e-01 -2.27780232e-02  1.24994682e-01]
 [ 4.06797418e-01  1.81361255e-01 -4.61955037e-01]
 [-5.26788226e-02  5.16264122e-02 -1.22675691e-02]
 [ 4.15803602e-02 -2.57720429e-02  2.47131100e-02]
 [ 4.48210146e-02  8.61834183e-02  1.35482205e-02]
 [-7.21453671e-03 -1.78507852e-01  2.03542220e-02]
 [-1.18485608e+00 -4.61668528e-01 -4.48540250e-02]
 [ 4.48972202e-01  1.32876660e-01  5.18561242e-02]
 [-6.85079702e-05 -4.49701409e-02  3.53775553e-02]
 [-7.35647413e-01 -1.16860478e+00  2.61533921e-01]
 [-1.89732888e-02 -1.83957089e-03  5.05655043e-03]
 [ 1.03372296e-01  1.17217611e-01 -1.04519460e-01]
 [ 1.17016935e-01  1.42026066e-02  3.10869700e-02]
 [ 4.37248444e-02  3.16330286e-02  1.49709437e-02]
 [ 1.72729601e-02 -8.23988043e-02  1.52715866e-01]
 [ 3.70748993e-02 -2.38083242e-02  4.46778879e-02]
 [ 8.71672506e-02 -7.62361312e-01 -3.14481102e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.27118322 -49.27387164 -49.25707411]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [   7.3268874   -15.90307369 -140.51672192]
init_Out:  [2.48374395]
Stock Position:  7.326887399052493
Bond position:  [-730.20499595]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [16.45538087]
curr_Stock_Price:  101.9318177313396
curr_Factors:  [101.93181773  -1.09609711  -1.03066416]
mat_Sqrt:  [[12.15259679  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00088577 -0.00040507 -0.21916986]
Stock Position:  -0.000885768253430473
Bond Position:  [16.54566884]


portfolio before change:  [16.46037691]
curr_Stock_Price:  100.96192384213339
curr_Factors:  [100.96192384  -1.03738343  -0.99461309]
mat_Sqrt:  [[13.2334397   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.22093312 -0.93908839 -2.3635635 ]
Stock Position:  -0.220933118677648
Bond Position:  [38.76620961]


portfolio before change:  [16.22067585]
curr_Stock_Price:  102.0907443113648
curr_Factors:  [102.09074431  -1.20704214  -1.02966878]
mat_Sqrt:  [[10.90423397  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01565232 -0.00735158  0.35657503]
Stock Position:  -0.015652322055798862
Bond Position:  [17.81863306]


portfolio before change:  [16.23552845]
curr_Stock_Price:  101.42647289062458
curr_Factors:  [101.42647289  -1.29914655  -1.06812407]
mat_Sqrt:  [[ 9.50733412  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.03676335  0.05853409 -1.31782914]
Stock Position:  0.0367633500248215
Bond Position:  [12.50675153]


portfolio before change:  [16.21971576]
curr_Stock_Price:  100.91129208405867
curr_Factors:  [100.91129208  -1.43933063  -1.059267  ]
mat_Sqrt:  [[ 8.29492765  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00538217  0.01666235 -0.03499596]
Stock Position:  -0.005382172610911392
Bond Position:  [16.76283775]


portfolio before change:  [16.21481213]
curr_Stock_Price:  102.60110427305722
curr_Factors:  [102.60110427  -1.65279744  -1.06408232]
mat_Sqrt:  [[ 6.7799446   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00610097 -0.00831789  0.07049962]
Stock Position:  0.006100965246231266
Bond Position:  [15.58884636]


portfolio before change:  [16.21343958]
curr_Stock_Price:  101.73726492882287
curr_Factors:  [101.73726493  -1.38466087  -1.07577559]
mat_Sqrt:  [[ 8.68812534  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00750204 0.02781558 0.0386493 ]
Stock Position:  0.007502038417755097
Bond Position:  [15.45020271]


portfolio before change:  [16.2194476]
curr_Stock_Price:  102.02318578007906
curr_Factors:  [102.02318578  -1.41814284  -1.09435068]
mat_Sqrt:  [[ 8.27059603  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00477565 -0.05761316  0.05806493]
Stock Position:  -0.004775654763004856
Bond Position:  [16.70667511]


portfolio before change:  [16.22502895]
curr_Stock_Price:  101.72916089625782
curr_Factors:  [101.7291609   -1.44361905  -1.08456217]
mat_Sqrt:  [[ 8.11839741  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.15868274 -0.14900288 -0.12795605]
Stock Position:  -0.15868274261884346
Bond Position:  [32.36769121]


portfolio before change:  [16.20751213]
curr_Stock_Price:  101.89055059696273
curr_Factors:  [101.8905506   -1.67819888  -1.1301552 ]
mat_Sqrt:  [[ 6.14442474  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.07920687 0.04288576 0.14793109]
Stock Position:  0.07920686551073923
Bond Position:  [8.13708099]


portfolio before change:  [16.27145275]
curr_Stock_Price:  102.67212556346215
curr_Factors:  [102.67212556  -1.82546982  -1.11034065]
mat_Sqrt:  [[ 5.45062454  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00037181 -0.01451405  0.10092232]
Stock Position:  -0.0003718080920308618
Bond Position:  [16.30962708]


portfolio before change:  [16.27568452]
curr_Stock_Price:  102.25832593053687
curr_Factors:  [102.25832593  -1.58933526  -1.10667815]
mat_Sqrt:  [[ 6.89977504  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.13345399 -0.37716557  0.74608348]
Stock Position:  -0.13345398527922475
Bond Position:  [29.92246565]


portfolio before change:  [16.26646071]
curr_Stock_Price:  102.3835029122249
curr_Factors:  [102.38350291  -1.66512263  -1.14798932]
mat_Sqrt:  [[ 6.14484576  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00298081 -0.00059372  0.01442493]
Stock Position:  -0.002980811289194992
Bond Position:  [16.57164661]


portfolio before change:  [16.26982654]
curr_Stock_Price:  102.64437007894136
curr_Factors:  [102.64437008  -1.53825179  -1.16203495]
mat_Sqrt:  [[ 6.89628976  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01536541  0.03783182 -0.29816493]
Stock Position:  0.015365406478881793
Bond Position:  [14.69265407]


portfolio before change:  [16.2719169]
curr_Stock_Price:  102.54132887505199
curr_Factors:  [102.54132888  -1.6224786   -1.19468336]
mat_Sqrt:  [[ 6.12944352  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.0205992  0.00458387 0.08868247]
Stock Position:  0.02059919967549937
Bond Position:  [14.15964759]


portfolio before change:  [16.27246781]
curr_Stock_Price:  102.3962050106001
curr_Factors:  [102.39620501  -1.23565434  -1.1910894 ]
mat_Sqrt:  [[ 9.04403942  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00588651 0.01020952 0.04270794]
Stock Position:  0.005886511316714471
Bond Position:  [15.66971139]


portfolio before change:  [16.28303948]
curr_Stock_Price:  103.5265425208997
curr_Factors:  [103.52654252  -1.27922004  -1.15917091]
mat_Sqrt:  [[ 9.03799249  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00349927 -0.0265941   0.43565586]
Stock Position:  0.003499269373486035
Bond Position:  [15.92077222]


portfolio before change:  [16.29095515]
curr_Stock_Price:  104.65105943411926
curr_Factors:  [104.65105943  -0.92525888  -1.19540122]
mat_Sqrt:  [[12.55314798  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00329279 -0.0076841   0.12745358]
Stock Position:  0.0032927900774371655
Bond Position:  [15.94636118]


portfolio before change:  [16.29650439]
curr_Stock_Price:  105.12547416225833
curr_Factors:  [105.12547416  -0.90003631  -1.23548891]
mat_Sqrt:  [[12.42399158  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0106763  -0.24605106 -0.89712705]
Stock Position:  -0.010676302041166224
Bond Position:  [17.41885571]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [16.2935009]
Stock Price:  105.81473384790856
PL:  [10.47876706]
Settle:  Tensor("sub_302:0", shape=(), dtype=float64)
PL:  Tensor("sub_303:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  152
output_Z_Vals[:, i, :]:  [[ 1.19271183e+02 -4.92738716e+01 -4.92570741e+01]
 [-4.97334629e-03 -4.16987688e-03 -6.10661332e-02]
 [-2.20391376e+00 -2.96735149e+00 -8.45218686e-01]
 [-5.19249618e-02  5.34848588e-04 -1.32847400e-01]
 [ 7.01507701e-01  1.09238104e-02 -4.55594554e-01]
 [ 3.56027440e-02  5.65792784e-02  1.46775969e-03]
 [ 1.98393984e-02  2.41123669e-02  1.10606026e-01]
 [ 6.14994100e-02  1.07377487e-01  7.80083419e-03]
 [ 3.93275935e-02 -5.86708394e-02 -2.00090232e-02]
 [-1.03861111e+00 -4.23708980e-01 -3.69394752e-02]
 [ 2.88806449e-01  1.81678507e-02 -7.74361861e-02]
 [ 2.21860097e-02 -7.14065180e-02  3.69672414e-02]
 [-6.40835736e-01 -1.24081983e+00  2.26490716e-01]
 [ 1.45589179e-02  3.07346239e-02  7.49040398e-02]
 [ 1.02643911e-01  1.24889820e-01 -1.04597610e-01]
 [ 6.60733851e-02  3.24487107e-02  6.28854909e-02]
 [ 8.94721442e-02  1.10025253e-01  8.60813270e-02]
 [ 1.15216134e-01 -1.08333916e-02 -3.18137274e-02]
 [-5.29501978e-02 -1.60357982e-01  2.44066431e-02]
 [ 4.06041153e-02 -3.35613057e-01 -3.42411828e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.27118322 -49.27387164 -49.25707411]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [   7.3268874   -15.90307369 -140.51672192]
init_Out:  [2.48374395]
Stock Position:  7.326887399052493
Bond position:  [-730.20499595]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [8.99771288]
curr_Stock_Price:  100.913968324037
curr_Factors:  [100.91396832  -0.91518231  -1.00971624]
mat_Sqrt:  [[14.72239496  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0012423  -0.00134582 -0.17420468]
Stock Position:  -0.001242297271890205
Bond Position:  [9.12307803]


portfolio before change:  [9.00152233]
curr_Stock_Price:  99.68366561705469
curr_Factors:  [99.68366562 -1.00668361 -1.03159504]
mat_Sqrt:  [[12.98406942  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.22967771 -0.95770858 -2.41117365]
Stock Position:  -0.22967771481129814
Bond Position:  [31.89663886]


portfolio before change:  [9.24101026]
curr_Stock_Price:  98.67567592108861
curr_Factors:  [98.67567592 -0.86019052 -1.05402748]
mat_Sqrt:  [[14.55042902  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-5.42479870e-03  1.72621640e-04 -3.78976656e-01]
Stock Position:  -0.005424798695870642
Bond Position:  [9.77630594]


portfolio before change:  [9.23055107]
curr_Stock_Price:  101.05430284169067
curr_Factors:  [101.05430284  -0.71495021  -1.04977778]
mat_Sqrt:  [[17.30386757  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.03529498  0.00352564 -1.29968445]
Stock Position:  0.035294980322790666
Bond Position:  [5.66384144]


portfolio before change:  [9.18316739]
curr_Stock_Price:  99.6716750199013
curr_Factors:  [99.67167502 -0.84126686 -1.07389731]
mat_Sqrt:  [[14.6833965   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00323165 0.01826088 0.00418711]
Stock Position:  0.0032316464419769484
Bond Position:  [8.86106377]


portfolio before change:  [9.19125298]
curr_Stock_Price:  101.48810299984278
curr_Factors:  [101.488103    -1.16751555  -1.03006076]
mat_Sqrt:  [[11.27249026  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00419949 0.00778223 0.3155282 ]
Stock Position:  0.004199486892736865
Bond Position:  [8.76505502]


portfolio before change:  [9.18828527]
curr_Stock_Price:  100.2595608376414
curr_Factors:  [100.25956084  -1.32963165  -0.99988067]
mat_Sqrt:  [[ 9.75958722  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00871042 0.03465593 0.02225361]
Stock Position:  0.008710418207695823
Bond Position:  [8.31498257]


portfolio before change:  [9.18175405]
curr_Stock_Price:  99.27106301552678
curr_Factors:  [99.27106302 -1.26628568 -0.99033256]
mat_Sqrt:  [[10.39407448  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0022385  -0.01893593 -0.05708017]
Stock Position:  0.00223849981462583
Bond Position:  [8.95953579]


portfolio before change:  [9.18634834]
curr_Stock_Price:  100.32271879365743
curr_Factors:  [100.32271879  -1.13469237  -1.00276201]
mat_Sqrt:  [[11.8335391   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.09571444 -0.13675149 -0.10537804]
Stock Position:  -0.0957144413268761
Bond Position:  [18.78868133]


portfolio before change:  [9.21844523]
curr_Stock_Price:  100.036459707636
curr_Factors:  [100.03645971  -1.10893422  -1.02550841]
mat_Sqrt:  [[11.83536505  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.02337979  0.00586365 -0.22090388]
Stock Position:  0.02337979014175442
Bond Position:  [6.8796138]


portfolio before change:  [9.20147072]
curr_Stock_Price:  99.23685321445815
curr_Factors:  [99.23685321 -1.35611821 -1.03605951]
mat_Sqrt:  [[ 9.07326092  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00167042 -0.02304635  0.10545725]
Stock Position:  0.0016704161734543415
Bond Position:  [9.03570387]


portfolio before change:  [9.20498416]
curr_Stock_Price:  99.98770585839645
curr_Factors:  [99.98770586 -1.22861492 -1.02682051]
mat_Sqrt:  [[10.48150008  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.08089346 -0.40047288  0.64611497]
Stock Position:  -0.08089345914920681
Bond Position:  [17.29333556]


portfolio before change:  [9.20659919]
curr_Stock_Price:  100.02119246229262
curr_Factors:  [100.02119246  -1.18971005  -1.02014966]
mat_Sqrt:  [[10.97392912  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00329165 0.00991956 0.21368038]
Stock Position:  0.0032916487269732944
Bond Position:  [8.87736456]


portfolio before change:  [9.20710597]
curr_Stock_Price:  99.50083460087112
curr_Factors:  [99.5008346  -0.84691483 -1.02506107]
mat_Sqrt:  [[15.3051617   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00697713  0.04030802 -0.29838787]
Stock Position:  0.00697712595313382
Bond Position:  [8.51287612]


portfolio before change:  [9.22401974]
curr_Stock_Price:  101.6199420783986
curr_Factors:  [101.61994208  -0.73792429  -1.04804328]
mat_Sqrt:  [[17.03503692  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00502103 0.01047278 0.1793948 ]
Stock Position:  0.005021028009673968
Bond Position:  [8.71378316]


portfolio before change:  [9.21024824]
curr_Stock_Price:  98.4432591356054
curr_Factors:  [98.44325914 -0.46328776 -1.02471178]
mat_Sqrt:  [[22.23084622  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00582534 0.0355105  0.24556607]
Stock Position:  0.005825339749489488
Bond Position:  [8.63678281]


portfolio before change:  [9.21437481]
curr_Stock_Price:  98.78093883963223
curr_Factors:  [98.78093884 -0.45022013 -1.02930169]
mat_Sqrt:  [[22.49701971  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00473444 -0.00349646 -0.09075571]
Stock Position:  0.004734441672818409
Bond Position:  [8.74670221]


portfolio before change:  [9.21287338]
curr_Stock_Price:  98.00188697094949
curr_Factors:  [98.00188697 -0.20784902 -1.01666046]
mat_Sqrt:  [[28.80293407  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00280184 -0.05175532  0.06962536]
Stock Position:  -0.002801837771672688
Bond Position:  [9.48745877]


portfolio before change:  [9.22072271]
curr_Stock_Price:  96.047036525663
curr_Factors:  [96.04703653 -0.24428543 -0.98635872]
mat_Sqrt:  [[28.05575797  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00348581 -0.10831865 -0.97680564]
Stock Position:  -0.0034858133203819843
Bond Position:  [9.55552475]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [9.22602899]
Stock Price:  95.21018860795036
PL:  [9.22602899]
Settle:  Tensor("sub_304:0", shape=(), dtype=float64)
PL:  Tensor("sub_305:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  153
output_Z_Vals[:, i, :]:  [[ 1.19271183e+02 -4.92738716e+01 -4.92570741e+01]
 [-1.77015297e-03  2.57425853e-03 -5.82215051e-02]
 [-2.27857091e+00 -3.06690872e+00 -8.74018749e-01]
 [ 3.28526668e-02  1.22456751e-01 -8.55311368e-02]
 [ 5.02415714e-01 -1.07825153e-01 -1.61044643e-01]
 [-1.45862930e-01 -2.55868883e-01  4.46321440e-02]
 [-7.59452243e-02  1.33838498e-01 -1.39154324e-01]
 [ 8.36039435e-02  1.70595292e-01  4.11019770e-02]
 [-1.63521640e-01  3.94107544e-01 -9.34353021e-02]
 [-8.12944345e-01 -3.34094937e-01 -2.53865549e-02]
 [ 4.89431110e-02 -4.72998554e-02 -2.98498924e-01]
 [-3.35712742e-04 -5.54530654e-02  3.24149291e-02]
 [-6.32389132e-01 -1.19618258e+00  2.18553884e-01]
 [ 1.19820537e-01  7.18305519e-02  1.22506642e-01]
 [ 9.22779432e-02  1.25601698e-01 -1.03264106e-01]
 [-2.47909098e-01  1.33922624e-01  1.23003982e-01]
 [ 3.12807161e-02  1.13937799e-01  1.31155032e-01]
 [ 1.15216134e-01 -1.08333916e-02 -3.18137274e-02]
 [-4.93992752e-02 -8.99780961e-02 -1.20729859e-02]
 [ 7.06355829e-02 -5.49544360e-01 -5.52889109e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.27118322 -49.27387164 -49.25707411]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [   7.3268874   -15.90307369 -140.51672192]
init_Out:  [2.48374395]
Stock Position:  7.326887399052493
Bond position:  [-730.20499595]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [9.95847066]
curr_Stock_Price:  101.04509600901612
curr_Factors:  [101.04509601  -1.10516853  -1.0244965 ]
mat_Sqrt:  [[12.01194868  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.001093    0.00083084 -0.16608975]
Stock Position:  -0.0010930033050185945
Bond Position:  [10.06891328]


portfolio before change:  [9.96168347]
curr_Stock_Price:  100.40898588451361
curr_Factors:  [100.40898588  -0.84541391  -1.02266798]
mat_Sqrt:  [[15.50511259  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.19883824 -0.98984053 -2.49333221]
Stock Position:  -0.19883824415466536
Bond Position:  [29.92682993]


portfolio before change:  [10.1600589]
curr_Stock_Price:  99.44894528634386
curr_Factors:  [99.44894529 -0.91450936 -1.00447433]
mat_Sqrt:  [[14.59473297  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00276744  0.03952275 -0.24399653]
Stock Position:  0.0027674419435879897
Bond Position:  [9.88483972]


portfolio before change:  [10.15747959]
curr_Stock_Price:  97.62385393208854
curr_Factors:  [97.62385393 -0.55465045 -1.01757852]
mat_Sqrt:  [[20.26495203  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.02208408 -0.03480042 -0.45941554]
Stock Position:  0.022084083671665502
Bond Position:  [8.00154623]


portfolio before change:  [10.13301597]
curr_Stock_Price:  96.42551342964651
curr_Factors:  [96.42551343 -0.59604859 -1.00471116]
mat_Sqrt:  [[19.45319018  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00971468 -0.08258133  0.12732308]
Stock Position:  -0.009714676440908393
Bond Position:  [11.06975864]


portfolio before change:  [10.14365904]
curr_Stock_Price:  95.61485507188891
curr_Factors:  [95.61485507 -0.57695846 -0.99519177]
mat_Sqrt:  [[19.8494831   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00388072  0.04319619 -0.39696855]
Stock Position:  -0.0038807213484169253
Bond Position:  [10.51471365]


portfolio before change:  [10.15340955]
curr_Stock_Price:  93.77975864117096
curr_Factors:  [93.77975864 -0.56238243 -0.95948502]
mat_Sqrt:  [[20.47248102  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00619448 0.05505939 0.1172525 ]
Stock Position:  0.006194484560760413
Bond Position:  [9.57249228]


portfolio before change:  [10.16903907]
curr_Stock_Price:  95.91651454387866
curr_Factors:  [95.91651454 -0.40561844 -0.97869845]
mat_Sqrt:  [[24.02659338  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00425142  0.12719766 -0.26654491]
Stock Position:  -0.00425142149486256
Bond Position:  [10.5768206]


portfolio before change:  [10.16649008]
curr_Stock_Price:  97.13811328004036
curr_Factors:  [97.13811328 -0.57913623 -0.95776156]
mat_Sqrt:  [[20.88927816  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.04242958 -0.10782868 -0.07242077]
Stock Position:  -0.04242957512665741
Bond Position:  [14.28801895]


portfolio before change:  [10.19165102]
curr_Stock_Price:  96.62930569211798
curr_Factors:  [96.62930569 -0.74021043 -0.94095823]
mat_Sqrt:  [[17.98815353  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00120317 -0.01526596 -0.85153435]
Stock Position:  -0.001203167924305554
Bond Position:  [10.3079123]


portfolio before change:  [10.19188005]
curr_Stock_Price:  98.58103875303041
curr_Factors:  [98.58103875 -0.60963831 -0.93011189]
mat_Sqrt:  [[21.13919147  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00023834 -0.0178974   0.09247077]
Stock Position:  -0.0002383417843252185
Bond Position:  [10.21537604]


portfolio before change:  [10.1947804]
curr_Stock_Price:  97.12858265888693
curr_Factors:  [97.12858266 -0.74944795 -0.91634701]
mat_Sqrt:  [[18.36121811  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.04531    -0.38606627  0.6234734 ]
Stock Position:  -0.04530999790126615
Bond Position:  [14.59567628]


portfolio before change:  [10.25134019]
curr_Stock_Price:  95.96083997143104
curr_Factors:  [95.96083997 -0.46438323 -0.9255019 ]
mat_Sqrt:  [[23.90422112  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00667202 0.02318321 0.34947735]
Stock Position:  0.0066720203975094835
Bond Position:  [9.61108751]


portfolio before change:  [10.2567036]
curr_Stock_Price:  96.40453329391178
curr_Factors:  [96.40453329 -0.63849509 -0.92019556]
mat_Sqrt:  [[20.28461229  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00477394  0.04053777 -0.29458375]
Stock Position:  0.004773943108177356
Bond Position:  [9.79647384]


portfolio before change:  [10.25393631]
curr_Stock_Price:  95.31178727168583
curr_Factors:  [95.31178727 -0.77634272 -0.9706082 ]
mat_Sqrt:  [[16.61328308  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01176554  0.04322334  0.35089612]
Stock Position:  -0.011765535644196959
Bond Position:  [11.37533054]


portfolio before change:  [10.24972215]
curr_Stock_Price:  95.9117051959948
curr_Factors:  [95.9117052  -0.6466822  -0.92036543]
mat_Sqrt:  [[20.01296686  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00406287 0.03677327 0.3741488 ]
Stock Position:  0.004062869907204251
Bond Position:  [9.86004536]


portfolio before change:  [10.25311481]
curr_Stock_Price:  96.13995480336327
curr_Factors:  [96.1399548  -0.73700545 -0.95002661]
mat_Sqrt:  [[17.79242722  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0059863  -0.00349646 -0.09075571]
Stock Position:  0.005986301154842072
Bond Position:  [9.67759209]


portfolio before change:  [10.27196007]
curr_Stock_Price:  98.88381182213139
curr_Factors:  [98.88381182 -1.01828571 -0.95166463]
mat_Sqrt:  [[13.79071037  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00509259 -0.02904031 -0.03444087]
Stock Position:  -0.005092585021871275
Bond Position:  [10.77553429]


portfolio before change:  [10.2752707]
curr_Stock_Price:  98.7627707364884
curr_Factors:  [98.76277074 -0.82609618 -0.99802118]
mat_Sqrt:  [[15.93636115  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00968839 -0.17736468 -1.57723873]
Stock Position:  -0.009688391545485852
Bond Position:  [11.23212309]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [10.27956861]
Stock Price:  98.60902704264264
PL:  [10.27956861]
Settle:  Tensor("sub_306:0", shape=(), dtype=float64)
PL:  Tensor("sub_307:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  154
output_Z_Vals[:, i, :]:  [[ 1.19271183e+02 -4.92738716e+01 -4.92570741e+01]
 [ 2.50370942e-02  1.97295719e-02 -9.75388831e-02]
 [-2.17884602e+00 -2.93392302e+00 -8.35548447e-01]
 [ 5.56044920e-02  2.65323016e-01 -2.99174145e-02]
 [ 6.02979647e-01  7.76339654e-03 -4.10881720e-01]
 [ 7.57175145e-02  1.17192732e-01 -6.73936232e-03]
 [ 1.71076100e-02  3.88090690e-02  1.12643555e-01]
 [ 8.19195606e-02  2.91329161e-01  2.26293849e-01]
 [ 4.51355166e-02 -4.37165571e-02 -2.50458924e-02]
 [-1.21575423e+00 -5.00021385e-01 -4.58813951e-02]
 [ 2.36934820e-01  4.17584632e-02  5.62281975e-02]
 [-1.40476297e-01 -1.27000189e-02  3.00617441e-02]
 [-7.15684027e-01 -9.79845792e-01  2.50224441e-01]
 [-1.19718760e-02 -1.36177701e-02 -3.77454334e-03]
 [-1.36223545e-01 -1.54915807e-01  4.24404195e-02]
 [ 6.08084222e-02  3.38658397e-02  6.53782397e-02]
 [ 4.04953320e-02  2.84703276e-02  1.18239761e-02]
 [-8.46564098e-02 -1.69350531e-01  3.19416727e-01]
 [ 8.15487744e-02  1.17514848e-01  4.37494844e-02]
 [ 1.82999970e-02 -1.77339056e-01 -1.72980486e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.27118322 -49.27387164 -49.25707411]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [   7.3268874   -15.90307369 -140.51672192]
init_Out:  [2.48374395]
Stock Position:  7.326887399052493
Bond position:  [-730.20499595]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [21.16977521]
curr_Stock_Price:  102.57525526164828
curr_Factors:  [102.57525526  -1.13177238  -0.99297395]
mat_Sqrt:  [[12.25397518  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00074705  0.00636769 -0.27825128]
Stock Position:  0.0007470502372227762
Bond Position:  [21.09314634]


portfolio before change:  [21.1746051]
curr_Stock_Price:  101.98084095390797
curr_Factors:  [101.98084095  -0.94338525  -0.9983633 ]
mat_Sqrt:  [[14.629447    0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.20153094 -0.94691958 -2.38358715]
Stock Position:  -0.2015309372220305
Bond Position:  [41.72689955]


portfolio before change:  [21.3710042]
curr_Stock_Price:  101.05807408016722
curr_Factors:  [101.05807408  -0.8332048   -1.03101358]
mat_Sqrt:  [[15.66575254  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00661676  0.08563264 -0.08534606]
Stock Position:  0.006616755811662998
Bond Position:  [20.7023276]


portfolio before change:  [21.373146]
curr_Stock_Price:  100.59947642473507
curr_Factors:  [100.59947642  -0.93546359  -1.02405604]
mat_Sqrt:  [[14.17709198  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0367278   0.00250563 -1.17213118]
Stock Position:  0.03672780460546262
Bond Position:  [17.67834808]


portfolio before change:  [21.3986511]
curr_Stock_Price:  101.17356356999898
curr_Factors:  [101.17356357  -0.70407897  -1.03009091]
mat_Sqrt:  [[17.86185824  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00550132  0.03782379 -0.01922552]
Stock Position:  0.0055013153082450975
Bond Position:  [20.84206342]


portfolio before change:  [21.40825362]
curr_Stock_Price:  101.97180069996537
curr_Factors:  [101.9718007   -0.61986477  -1.01926446]
mat_Sqrt:  [[19.7977259   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00242567 0.01252557 0.32134071]
Stock Position:  0.002425669877405521
Bond Position:  [21.16090369]


portfolio before change:  [21.4146357]
curr_Stock_Price:  102.4216550408443
curr_Factors:  [102.42165504  -0.63860925  -1.03466009]
mat_Sqrt:  [[19.21764425  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00976077 0.09402608 0.64555336]
Stock Position:  0.009760765292543527
Bond Position:  [20.41492197]


portfolio before change:  [21.41551348]
curr_Stock_Price:  101.98863618085612
curr_Factors:  [101.98863618  -0.4810443   -1.02603495]
mat_Sqrt:  [[22.59620895  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00137631 -0.01410946 -0.07144896]
Stock Position:  0.0013763123014550983
Bond Position:  [21.27514526]


portfolio before change:  [21.42017599]
curr_Stock_Price:  101.5113184096879
curr_Factors:  [101.51131841  -0.4613991   -1.03655483]
mat_Sqrt:  [[22.69662816  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.05847504 -0.16138121 -0.13088685]
Stock Position:  -0.05847503675496485
Bond Position:  [27.35605407]


portfolio before change:  [21.29623685]
curr_Stock_Price:  103.74781146228665
curr_Factors:  [103.74781146  -0.50466193  -1.01300785]
mat_Sqrt:  [[22.74381603  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01129697 0.01347749 0.1604034 ]
Stock Position:  0.01129697244008412
Bond Position:  [20.12420068]


portfolio before change:  [21.28007797]
curr_Stock_Price:  101.87203872077937
curr_Factors:  [101.87203872  -0.54195702  -0.96353715]
mat_Sqrt:  [[22.60618009  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0060573  -0.00409891  0.08575779]
Stock Position:  -0.006057297118907499
Bond Position:  [21.89714718]


portfolio before change:  [21.28355192]
curr_Stock_Price:  102.2023879537462
curr_Factors:  [102.20238795  -0.67039721  -0.88176396]
mat_Sqrt:  [[21.64541964  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.03994459 -0.31624387  0.71382068]
Stock Position:  -0.039944587631485944
Bond Position:  [25.36598416]


portfolio before change:  [21.26369862]
curr_Stock_Price:  102.8581862408004
curr_Factors:  [102.85818624  -0.62278577  -0.84104235]
mat_Sqrt:  [[23.79613281  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00065229 -0.00439512 -0.01076772]
Stock Position:  -0.0006522936818459311
Bond Position:  [21.33079236]


portfolio before change:  [21.26777673]
curr_Stock_Price:  104.78255548666694
curr_Factors:  [104.78255549  -0.65348173  -0.82414056]
mat_Sqrt:  [[23.90924051  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00665778 -0.04999886  0.1210707 ]
Stock Position:  -0.006657781020009637
Bond Position:  [21.96539604]


portfolio before change:  [21.2858183]
curr_Stock_Price:  102.89761323918434
curr_Factors:  [102.89761324  -0.43980334  -0.80313878]
mat_Sqrt:  [[29.68946679  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00273048 0.01093015 0.18650592]
Stock Position:  0.002730481340845851
Bond Position:  [21.00485828]


portfolio before change:  [21.29334585]
curr_Stock_Price:  103.73105014802954
curr_Factors:  [103.73105015  -0.22317012  -0.80713822]
mat_Sqrt:  [[37.02129025  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00131601 0.00918876 0.03373051]
Stock Position:  0.0013160095720513613
Bond Position:  [21.1568348]


portfolio before change:  [21.30190006]
curr_Stock_Price:  106.21153369938811
curr_Factors:  [ 1.06211534e+02  3.40186233e-02 -7.72380428e-01]
mat_Sqrt:  [[50.7580843   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00106435 -0.05465765  0.91120701]
Stock Position:  -0.0010643482014326324
Bond Position:  [21.41494612]


portfolio before change:  [21.30640495]
curr_Stock_Price:  107.00969340537395
curr_Factors:  [ 1.07009693e+02  6.19603363e-02 -7.57448464e-01]
mat_Sqrt:  [[53.37974115  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00214439 0.03792775 0.1248051 ]
Stock Position:  0.002144385041463932
Bond Position:  [21.07693496]


portfolio before change:  [21.30370095]
curr_Stock_Price:  103.29119618562582
curr_Factors:  [103.29119619   0.20596962  -0.71527654]
mat_Sqrt:  [[62.0689106   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00085725 -0.05723593 -0.49346518]
Stock Position:  -0.0008572517146084835
Bond Position:  [21.3922475]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [21.31324846]
Stock Price:  98.39323752635609
PL:  [21.31324846]
Settle:  Tensor("sub_308:0", shape=(), dtype=float64)
PL:  Tensor("sub_309:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  155
output_Z_Vals[:, i, :]:  [[ 1.19271183e+02 -4.92738716e+01 -4.92570741e+01]
 [ 4.21951478e-02  7.66841471e-02 -3.48653537e-02]
 [-2.26045494e+00 -3.04275061e+00 -8.67030254e-01]
 [ 9.72394105e-02  2.57195732e-01 -4.83841322e-02]
 [ 4.89834406e-01 -6.46274214e-02 -2.92728668e-01]
 [-8.63048344e-02 -1.45403623e-01  3.17594670e-02]
 [ 1.98533682e-02  3.77625234e-02  1.15382466e-01]
 [-4.10772270e-03  7.90347047e-02  9.45062467e-02]
 [ 6.43680600e-03 -1.43358276e-01  8.51521739e-03]
 [-1.21690006e+00 -4.96043851e-01 -4.60342789e-02]
 [ 4.31308830e-01  9.60407288e-02  2.06203420e-02]
 [-1.38379975e-01 -9.97849078e-03  3.00288619e-02]
 [-7.09519740e-01 -1.13258061e+00  2.50135167e-01]
 [-1.41698145e-02  5.70628118e-04  9.57440881e-03]
 [ 1.26547018e-01  1.20063076e-01 -1.06623039e-01]
 [ 8.75986747e-02  2.66549161e-02  5.26941295e-02]
 [ 1.14417439e-01  1.00884698e-01  8.40446398e-02]
 [ 9.83705407e-02 -1.58778869e-02  1.54062922e-02]
 [-4.29456403e-02 -5.07393010e-03 -4.97950705e-02]
 [ 8.22301115e-02 -6.70946711e-01 -5.45030087e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.27118322 -49.27387164 -49.25707411]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [   7.3268874   -15.90307369 -140.51672192]
init_Out:  [2.48374395]
Stock Position:  7.326887399052493
Bond position:  [-730.20499595]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-3.68458275]
curr_Stock_Price:  99.18304290689755
curr_Factors:  [99.18304291 -0.69548677 -0.99167416]
mat_Sqrt:  [[18.35324022  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00276416  0.0247497  -0.09946115]
Stock Position:  0.0027641643976978867
Bond Position:  [-3.95874099]


portfolio before change:  [-3.68381575]
curr_Stock_Price:  99.81860721463246
curr_Factors:  [99.81860721 -0.93952121 -0.9899932 ]
mat_Sqrt:  [[14.49552817  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.21099856 -0.98204354 -2.47339598]
Stock Position:  -0.21099856322751692
Bond Position:  [17.37776695]


portfolio before change:  [-3.80305474]
curr_Stock_Price:  100.40431720828651
curr_Factors:  [100.40431721  -0.94114579  -1.0016851 ]
mat_Sqrt:  [[14.38770917  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.009721    0.08300957 -0.13802646]
Stock Position:  0.00972099854418414
Bond Position:  [-4.77908496]


portfolio before change:  [-3.81382509]
curr_Stock_Price:  99.41929129603331
curr_Factors:  [99.4192913  -1.12480086 -0.97370662]
mat_Sqrt:  [[12.19271555  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.03419168 -0.02085841 -0.83507341]
Stock Position:  0.03419167760982964
Bond Position:  [-7.21313745]


portfolio before change:  [-3.833211]
curr_Stock_Price:  98.90506101215014
curr_Factors:  [98.90506101 -0.85069709 -0.94981693]
mat_Sqrt:  [[16.34049511  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00670129 -0.04692882  0.09060092]
Stock Position:  -0.006701287191029624
Bond Position:  [-3.17041978]


portfolio before change:  [-3.85689805]
curr_Stock_Price:  102.32147147539521
curr_Factors:  [102.32147148  -0.82175217  -0.94124695]
mat_Sqrt:  [[17.55116659  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00291228 0.0121878  0.32915406]
Stock Position:  0.002912282664717747
Bond Position:  [-4.1548871]


portfolio before change:  [-3.85791469]
curr_Stock_Price:  102.32909682524065
curr_Factors:  [102.32909683  -1.0559127   -0.91603783]
mat_Sqrt:  [[14.24268636  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00219875 0.02550834 0.26960002]
Stock Position:  0.002198754846591502
Bond Position:  [-4.08291129]


portfolio before change:  [-3.85861542]
curr_Stock_Price:  102.4746923507068
curr_Factors:  [102.47469235  -0.54943928  -0.93597535]
mat_Sqrt:  [[23.20113592  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00090892 -0.04626868  0.02429155]
Stock Position:  -0.0009089174877876982
Bond Position:  [-3.76547438]


portfolio before change:  [-3.8594905]
curr_Stock_Price:  102.40162991377629
curr_Factors:  [102.40162991  -0.89710591  -0.92244059]
mat_Sqrt:  [[16.59922705  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.07997669 -0.16009746 -0.13132298]
Stock Position:  -0.07997669363412989
Bond Position:  [4.33025328]


portfolio before change:  [-3.77487582]
curr_Stock_Price:  101.35717587791264
curr_Factors:  [101.35717588  -1.04809726  -0.89952738]
mat_Sqrt:  [[14.45479262  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.0314859  0.03099701 0.0588241 ]
Stock Position:  0.03148590113009136
Bond Position:  [-6.96619784]


portfolio before change:  [-3.7276001]
curr_Stock_Price:  102.91398348291678
curr_Factors:  [102.91398348  -1.15749946  -0.92774214]
mat_Sqrt:  [[12.78985045  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01049951 -0.00322054  0.08566398]
Stock Position:  -0.010499513712877861
Bond Position:  [-2.64705332]


portfolio before change:  [-3.7154695]
curr_Stock_Price:  101.69559888845319
curr_Factors:  [101.69559889  -1.40446676  -0.90453844]
mat_Sqrt:  [[10.10447937  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.08804493 -0.36553882  0.71356601]
Stock Position:  -0.08804492839881546
Bond Position:  [5.23831223]


portfolio before change:  [-3.74322236]
curr_Stock_Price:  102.02568719096105
curr_Factors:  [102.02568719  -1.10843474  -0.87591713]
mat_Sqrt:  [[14.0254389   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00086264  0.00018417  0.02731312]
Stock Position:  -0.0008626444838135689
Bond Position:  [-3.65521046]


portfolio before change:  [-3.74369741]
curr_Stock_Price:  101.51694445080426
curr_Factors:  [101.51694445  -1.46874782  -0.87093726]
mat_Sqrt:  [[ 9.78196753  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01321722  0.03875019 -0.30416585]
Stock Position:  0.013217223812009482
Bond Position:  [-5.08546959]


portfolio before change:  [-3.74517383]
curr_Stock_Price:  101.5014425740671
curr_Factors:  [101.50144257  -1.40793769  -0.8796004 ]
mat_Sqrt:  [[10.30402834  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01007332 0.00860284 0.15032168]
Stock Position:  0.010073315729059357
Bond Position:  [-4.76762991]


portfolio before change:  [-3.75677055]
curr_Stock_Price:  100.46854839408607
curr_Factors:  [100.46854839  -1.3015906   -0.9051792 ]
mat_Sqrt:  [[11.05712404  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.0137618  0.0325604  0.23975596]
Stock Position:  0.01376180473283309
Bond Position:  [-5.1393991]


portfolio before change:  [-3.76402107]
curr_Stock_Price:  100.03506568017292
curr_Factors:  [100.03506568  -1.05820288  -0.90832898]
mat_Sqrt:  [[13.99904233  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00702007 -0.00512457  0.04394986]
Stock Position:  0.007020071412700431
Bond Position:  [-4.46627437]


portfolio before change:  [-3.76398195]
curr_Stock_Price:  100.19971149778787
curr_Factors:  [100.1997115   -0.98383045  -0.86849489]
mat_Sqrt:  [[15.7185252   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00344471 -0.0016376  -0.14205148]
Stock Position:  -0.0034447079169014033
Bond Position:  [-3.41882321]


portfolio before change:  [-3.7687769]
curr_Stock_Price:  101.34353390663489
curr_Factors:  [101.34353391  -1.22412419  -0.86038251]
mat_Sqrt:  [[12.6039388   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01316891 -0.21654712 -1.55481913]
Stock Position:  -0.013168908203366095
Bond Position:  [-2.4341932]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-3.77497451]
Stock Price:  101.76794200500497
PL:  [-5.54291652]
Settle:  Tensor("sub_310:0", shape=(), dtype=float64)
PL:  Tensor("sub_311:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  156
output_Z_Vals[:, i, :]:  [[ 1.19271183e+02 -4.92738716e+01 -4.92570741e+01]
 [ 8.24826434e-03  1.90709983e-02 -5.32314504e-02]
 [-2.06276531e+00 -2.77912640e+00 -7.90768650e-01]
 [ 1.07482897e-02  2.16543498e-01 -2.26881195e-03]
 [ 3.48901519e-01  2.27694596e-01 -4.74122146e-01]
 [-5.20143991e-02  1.12211143e-01 -2.33069068e-02]
 [ 1.99029474e-02  2.36675121e-02  1.01351683e-01]
 [-1.58487231e-02 -2.26103557e-02 -2.03346851e-02]
 [-5.17550421e-03 -1.73257737e-01  1.85858893e-02]
 [-1.18680439e+00 -4.85645072e-01 -4.44605425e-02]
 [ 3.34258605e-01  3.27269917e-02 -5.05016641e-02]
 [-6.83032206e-02 -2.42893276e-02  3.26190549e-02]
 [-6.96927786e-01 -1.02039779e+00  2.44364915e-01]
 [-1.29618430e-02  3.19003372e-03  1.27402986e-02]
 [ 1.01477807e-01  1.23699550e-01 -1.04715982e-01]
 [ 1.20421626e-01  1.67536497e-02  3.53474462e-02]
 [ 3.79775795e-02  2.60046617e-02  9.37057600e-03]
 [ 6.79751143e-02 -3.60245077e-02  7.81191163e-02]
 [ 1.46608918e-02 -3.01030474e-02  2.84053875e-02]
 [ 1.68433224e-01 -1.28229518e+00 -6.10727544e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.27118322 -49.27387164 -49.25707411]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [   7.3268874   -15.90307369 -140.51672192]
init_Out:  [2.48374395]
Stock Position:  7.326887399052493
Bond position:  [-730.20499595]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [6.96767036]
curr_Stock_Price:  100.6369008044623
curr_Factors:  [100.6369008   -0.93937872  -1.01390291]
mat_Sqrt:  [[14.27111223  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 8.93617273e-05  6.15513822e-03 -1.51854511e-01]
Stock Position:  8.936172728317219e-05
Bond Position:  [6.95867727]


portfolio before change:  [6.96945653]
curr_Stock_Price:  101.154837426717
curr_Factors:  [101.15483743  -1.20327762  -0.98167068]
mat_Sqrt:  [[11.37825511  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.24533349 -0.89695919 -2.25584285]
Stock Position:  -0.24533349431732238
Bond Position:  [31.78612626]


portfolio before change:  [6.99325593]
curr_Stock_Price:  101.09022386440321
curr_Factors:  [101.09022386  -1.58725146  -1.00616461]
mat_Sqrt:  [[ 7.55793008  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00720924  0.06988911 -0.00647229]
Stock Position:  0.007209239343752496
Bond Position:  [6.26447231]


portfolio before change:  [6.99838899]
curr_Stock_Price:  101.58497036356789
curr_Factors:  [101.58497036  -1.76141063  -1.02586745]
mat_Sqrt:  [[ 6.25647867  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.04772648  0.07348811 -1.35253851]
Stock Position:  0.0477264803655888
Bond Position:  [2.15009589]


portfolio before change:  [6.99529739]
curr_Stock_Price:  101.50892888633798
curr_Factors:  [101.50892889  -1.59633511  -1.04594327]
mat_Sqrt:  [[ 7.22732074  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00468595  0.03621599 -0.06648812]
Stock Position:  -0.004685954738437828
Bond Position:  [7.47096363]


portfolio before change:  [6.99545398]
curr_Stock_Price:  101.8741445178883
curr_Factors:  [101.87414452  -1.49134104  -1.10241719]
mat_Sqrt:  [[ 7.61393366  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00596569 0.00763866 0.28912814]
Stock Position:  0.005965692069964975
Bond Position:  [6.3877042]


portfolio before change:  [6.99713258]
curr_Stock_Price:  101.88780290040586
curr_Factors:  [101.8878029   -1.72770746  -1.08749209]
mat_Sqrt:  [[ 6.10234236  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00403367 -0.00729746 -0.0580092 ]
Stock Position:  -0.0040336712384712
Bond Position:  [7.40811448]


portfolio before change:  [6.99810891]
curr_Stock_Price:  102.10495878970484
curr_Factors:  [102.10495879  -1.28705973  -1.08881451]
mat_Sqrt:  [[ 9.48894135  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00387269 -0.05591869  0.05302037]
Stock Position:  -0.0038726936418124512
Bond Position:  [7.39353013]


portfolio before change:  [7.00318203]
curr_Stock_Price:  101.27233333534792
curr_Factors:  [101.27233334  -0.76787323  -1.10505081]
mat_Sqrt:  [[15.56288972  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.08321152 -0.15674127 -0.12683355]
Stock Position:  -0.0832115224726528
Bond Position:  [15.43020707]


portfolio before change:  [7.08088585]
curr_Stock_Price:  100.38488666382136
curr_Factors:  [100.38488666  -0.93102373  -1.06130809]
mat_Sqrt:  [[13.69019444  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.02415089  0.01056259 -0.14406719]
Stock Position:  0.024150888946098337
Bond Position:  [4.6565016]


portfolio before change:  [7.11794088]
curr_Stock_Price:  101.87099194107874
curr_Factors:  [101.87099194  -1.03190078  -1.04229397]
mat_Sqrt:  [[12.80086157  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.005203   -0.00783935  0.09305308]
Stock Position:  -0.005203003076953027
Bond Position:  [7.64797597]


portfolio before change:  [7.1204688]
curr_Stock_Price:  101.75265915166514
curr_Factors:  [101.75265915  -0.81159816  -1.02902936]
mat_Sqrt:  [[16.14995784  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.05296205 -0.32933197  0.69710509]
Stock Position:  -0.05296204742596563
Bond Position:  [12.50949796]


portfolio before change:  [7.1069642]
curr_Stock_Price:  102.06670232892475
curr_Factors:  [102.06670233  -1.17661724  -1.01450846]
mat_Sqrt:  [[11.41012179  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00085101  0.00102958  0.03634453]
Stock Position:  -0.0008510055963256672
Bond Position:  [7.19382353]


portfolio before change:  [7.1085947]
curr_Stock_Price:  102.26432374275815
curr_Factors:  [102.26432374  -1.22798506  -1.02031106]
mat_Sqrt:  [[10.79696151  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00975764  0.03992386 -0.29872555]
Stock Position:  0.009757635158399438
Bond Position:  [6.11073674]


portfolio before change:  [7.10668365]
curr_Stock_Price:  101.91188945759096
curr_Factors:  [101.91188946  -1.54846399  -0.99675431]
mat_Sqrt:  [[ 7.99559136  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01639112 0.00540722 0.10083643]
Stock Position:  0.016391122548685123
Bond Position:  [5.43623338]


portfolio before change:  [7.11242058]
curr_Stock_Price:  102.17896708399037
curr_Factors:  [102.17896708  -1.60314784  -1.00197286]
mat_Sqrt:  [[ 7.55043484  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00598621 0.00839297 0.02673165]
Stock Position:  0.005986214125155274
Bond Position:  [6.5007554]


portfolio before change:  [7.11387776]
curr_Stock_Price:  102.15086620432668
curr_Factors:  [102.1508662   -1.70260171  -1.01905261]
mat_Sqrt:  [[ 6.71804021  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01139732 -0.01162686  0.22285209]
Stock Position:  0.011397317962185603
Bond Position:  [5.94963185]


portfolio before change:  [7.12079424]
curr_Stock_Price:  102.62719652381749
curr_Factors:  [102.62719652  -1.9223159   -1.00618653]
mat_Sqrt:  [[ 5.48820114  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00260821 -0.00971572  0.08103266]
Stock Position:  0.0026082058704995884
Bond Position:  [6.85312138]


portfolio before change:  [7.12317512]
curr_Stock_Price:  102.88307531687141
curr_Factors:  [102.88307532  -2.26476128  -0.9650745 ]
mat_Sqrt:  [[ 4.0704655   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.05355123 -0.41385899 -1.74223569]
Stock Position:  -0.053551226803319446
Bond Position:  [12.63269002]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [7.10679558]
Stock Price:  103.24792412362667
PL:  [3.85887146]
Settle:  Tensor("sub_312:0", shape=(), dtype=float64)
PL:  Tensor("sub_313:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  157
output_Z_Vals[:, i, :]:  [[ 1.19271183e+02 -4.92738716e+01 -4.92570741e+01]
 [ 3.97115134e-02  7.26939091e-02 -3.60179199e-02]
 [-2.14778346e+00 -2.54497340e+00 -7.51806734e-01]
 [ 1.57672220e-02  8.97920402e-02 -9.26070701e-02]
 [ 2.89687379e-01 -5.12452887e-02 -2.01531981e-01]
 [-1.46501919e-01 -2.59027626e-01  5.30739570e-02]
 [-1.15208820e-02  2.98664086e-02  6.24701044e-03]
 [ 9.77429423e-02  2.41508933e-01  1.09380304e-01]
 [ 1.00798824e-01  9.96057285e-02 -7.33193966e-02]
 [-9.71788199e-01 -3.96797966e-01 -3.35264765e-02]
 [ 2.98706485e-01  1.62968298e-02 -7.65581960e-02]
 [ 4.18803384e-02 -6.55865373e-02  3.73503159e-02]
 [-6.71415533e-01 -1.29427026e+00  2.35147234e-01]
 [ 9.26995040e-03  2.59058735e-02  6.44346183e-02]
 [ 1.34918602e-01  1.18121372e-01 -1.06518200e-01]
 [ 3.31763328e-02  4.13033541e-02  7.84609259e-02]
 [ 8.08527263e-02  6.79928179e-02  5.11498561e-02]
 [ 8.92759234e-02 -1.86066221e-02  4.06745454e-02]
 [-4.54931290e-02 -4.20316360e-02 -3.26170375e-02]
 [ 1.00980567e-01 -7.79920825e-01 -6.53795656e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.27118322 -49.27387164 -49.25707411]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [   7.3268874   -15.90307369 -140.51672192]
init_Out:  [2.48374395]
Stock Position:  7.326887399052493
Bond position:  [-730.20499595]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [1.37948606]
curr_Stock_Price:  99.8742052694069
curr_Factors:  [99.87420527 -1.16067796 -1.01125074]
mat_Sqrt:  [[11.38142619  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00414693  0.02346186 -0.1027491 ]
Stock Position:  0.004146929177669855
Bond Position:  [0.9653148]


portfolio before change:  [1.37689037]
curr_Stock_Price:  99.19007446956186
curr_Factors:  [99.19007447 -1.45617971 -1.01054247]
mat_Sqrt:  [[ 8.41752443  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.33510279 -0.82138663 -2.14469535]
Stock Position:  -0.33510278530664517
Bond Position:  [34.6157606]


portfolio before change:  [1.42829344]
curr_Stock_Price:  99.06250751615795
curr_Factors:  [99.06250752 -1.10398995 -0.99918585]
mat_Sqrt:  [[12.0923768   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00125638  0.02898026 -0.26418219]
Stock Position:  0.0012563788452224919
Bond Position:  [1.3038334]


portfolio before change:  [1.42855633]
curr_Stock_Price:  99.01227649227627
curr_Factors:  [99.01227649 -1.29054346 -1.0061029 ]
mat_Sqrt:  [[ 9.96020341  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.02390407 -0.01653935 -0.57491465]
Stock Position:  0.02390407350939653
Bond Position:  [-0.93824041]


portfolio before change:  [1.41482896]
curr_Stock_Price:  98.44782143974616
curr_Factors:  [98.44782144 -1.15501421 -1.02022216]
mat_Sqrt:  [[11.18183186  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01686146 -0.08360081  0.15140523]
Stock Position:  -0.016861462232923535
Bond Position:  [3.07480318]


portfolio before change:  [1.41506339]
curr_Stock_Price:  98.47951338361021
curr_Factors:  [98.47951338 -0.74425427 -0.99169227]
mat_Sqrt:  [[17.35537056  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00023908  0.00963934  0.01782098]
Stock Position:  -0.00023907649503653624
Bond Position:  [1.43860752]


portfolio before change:  [1.41545087]
curr_Stock_Price:  98.36326715181784
curr_Factors:  [98.36326715 -0.72474046 -0.9703909 ]
mat_Sqrt:  [[18.05704791  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.0093796  0.07794667 0.31203156]
Stock Position:  0.009379601187775184
Bond Position:  [0.49284266]


portfolio before change:  [1.42965657]
curr_Stock_Price:  99.86466000162687
curr_Factors:  [99.86466    -0.80075562 -0.95190081]
mat_Sqrt:  [[17.30783771  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0061339   0.03214761 -0.20915983]
Stock Position:  0.006133897297395476
Bond Position:  [0.817097]


portfolio before change:  [1.4284533]
curr_Stock_Price:  99.63518729767165
curr_Factors:  [99.6351873  -1.09881864 -0.96206834]
mat_Sqrt:  [[12.6876415   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.08351653 -0.12806599 -0.09564171]
Stock Position:  -0.08351653121386804
Bond Position:  [9.74963853]


portfolio before change:  [1.39403647]
curr_Stock_Price:  100.07647177503195
curr_Factors:  [100.07647178  -1.23202265  -0.96704156]
mat_Sqrt:  [[11.09917089  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.02580424  0.00525978 -0.21839922]
Stock Position:  0.025804241416102925
Bond Position:  [-1.18836097]


portfolio before change:  [1.38560053]
curr_Stock_Price:  99.76106582280065
curr_Factors:  [99.76106582 -1.48656621 -0.94495219]
mat_Sqrt:  [[ 8.76932286  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00411852 -0.02116796  0.10655005]
Stock Position:  0.004118521398230795
Bond Position:  [0.97473245]


portfolio before change:  [1.38553451]
curr_Stock_Price:  99.68586092917074
curr_Factors:  [99.68586093 -1.67882169 -0.96844392]
mat_Sqrt:  [[ 7.06221145  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.12568416 -0.41772393  0.67080961]
Stock Position:  -0.12568416026041404
Bond Position:  [13.91446823]


portfolio before change:  [1.34603599]
curr_Stock_Price:  100.02780996163708
curr_Factors:  [100.02780996  -1.70627013  -0.95530306]
mat_Sqrt:  [[ 6.98576884  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00396673 0.00836108 0.18381403]
Stock Position:  0.0039667253108505475
Bond Position:  [0.94925314]


portfolio before change:  [1.34717666]
curr_Stock_Price:  100.25553625186659
curr_Factors:  [100.25553625  -1.64411166  -0.95022877]
mat_Sqrt:  [[ 7.48859994  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01833281  0.03812351 -0.30386677]
Stock Position:  0.018332811287274545
Bond Position:  [-0.49078917]


portfolio before change:  [1.34918518]
curr_Stock_Price:  100.3717887000497
curr_Factors:  [100.3717887   -1.54567937  -0.9264478 ]
mat_Sqrt:  [[ 8.47189324  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00680168 0.0133306  0.22382718]
Stock Position:  0.00680168085621183
Bond Position:  [0.6664883]


portfolio before change:  [1.35591454]
curr_Stock_Price:  101.33665578866783
curr_Factors:  [101.33665579  -1.32643614  -0.97213275]
mat_Sqrt:  [[10.17444623  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01033694 0.02194459 0.1459163 ]
Stock Position:  0.010336938285087973
Bond Position:  [0.30840378]


portfolio before change:  [1.35081246]
curr_Stock_Price:  100.83561857279759
curr_Factors:  [100.83561857  -1.19153877  -0.96190416]
mat_Sqrt:  [[11.70538181  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00801174 -0.00600526  0.11603316]
Stock Position:  0.008011743733480875
Bond Position:  [0.54294332]


portfolio before change:  [1.34390436]
curr_Stock_Price:  99.9564276289281
curr_Factors:  [99.95642763 -1.45820169 -0.97333458]
mat_Sqrt:  [[ 8.7863387   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00691195 -0.01356565 -0.09304733]
Stock Position:  -0.006911949076178844
Bond Position:  [2.0347981]


portfolio before change:  [1.3439248]
curr_Stock_Price:  100.02707673352134
curr_Factors:  [100.02707673  -1.50451891  -0.94671451]
mat_Sqrt:  [[ 8.62105528  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02223342 -0.25171836 -1.86509703]
Stock Position:  -0.022233424753760545
Bond Position:  [3.56786928]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [1.32837609]
Stock Price:  100.76653951447904
PL:  [0.56183657]
Settle:  Tensor("sub_314:0", shape=(), dtype=float64)
PL:  Tensor("sub_315:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  158
output_Z_Vals[:, i, :]:  [[ 1.19271183e+02 -4.92738716e+01 -4.92570741e+01]
 [ 1.99602684e-02  4.09613116e-02 -4.51837687e-02]
 [-2.22985095e+00 -2.95438902e+00 -8.50256709e-01]
 [ 3.94999690e-02  1.35519576e-01 -8.52242972e-02]
 [ 2.61246987e-01  7.57783457e-02 -3.10179888e-01]
 [-1.46930723e-01 -2.61147351e-01  5.87389705e-02]
 [-7.93283351e-03  3.18142604e-02  6.22342118e-04]
 [ 8.48700055e-02  1.83362223e-01  5.36628597e-02]
 [ 9.12958050e-02  1.21938537e-01 -7.31775356e-02]
 [-9.87068954e-01 -4.04474017e-01 -3.42745885e-02]
 [ 9.99865431e-03 -4.20427580e-02 -3.09833688e-01]
 [ 7.62269467e-02  1.64488328e-02  2.14614606e-02]
 [-6.73125206e-01 -1.14465848e+00  2.29076109e-01]
 [ 4.92708666e-02  6.09806554e-02  1.41464831e-01]
 [ 9.38977661e-02  1.23402257e-01 -1.03533820e-01]
 [-1.35457091e-01  9.27702366e-02  1.26923062e-01]
 [ 5.95982573e-03  1.15886289e-01  1.47200861e-01]
 [ 1.11758916e-01 -1.18584870e-02 -2.16910894e-02]
 [-9.44330158e-02 -4.86912809e-01  1.49914823e-01]
 [ 5.10677419e-02 -3.88735062e-01 -4.16344644e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.27118322 -49.27387164 -49.25707411]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [   7.3268874   -15.90307369 -140.51672192]
init_Out:  [2.48374395]
Stock Position:  7.326887399052493
Bond position:  [-730.20499595]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [5.33056115]
curr_Stock_Price:  100.41346223846436
curr_Factors:  [100.41346224  -1.09502016  -1.02786912]
mat_Sqrt:  [[12.0180178   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00158914  0.01322021 -0.12889672]
Stock Position:  0.0015891441751179941
Bond Position:  [5.17098968]


portfolio before change:  [5.32997397]
curr_Stock_Price:  99.23038388790052
curr_Factors:  [99.23038389 -1.00017462 -1.04053139]
mat_Sqrt:  [[12.89369251  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.23317378 -0.95352496 -2.42554572]
Stock Position:  -0.23317377873423167
Bond Position:  [28.46789755]


portfolio before change:  [5.21167812]
curr_Stock_Price:  99.76823902664489
curr_Factors:  [99.76823903 -1.04309593 -1.11825382]
mat_Sqrt:  [[11.49026485  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00433118  0.04373876 -0.2431212 ]
Stock Position:  0.004331183877502664
Bond Position:  [4.77956353]


portfolio before change:  [5.2136738]
curr_Stock_Price:  99.9530936099967
curr_Factors:  [99.95309361 -1.0285837  -1.13414908]
mat_Sqrt:  [[11.49564459  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01856355  0.02445736 -0.88485688]
Stock Position:  0.018563549971720137
Bond Position:  [3.35818955]


portfolio before change:  [5.21062298]
curr_Stock_Price:  99.743517747582
curr_Factors:  [99.74351775 -1.47328852 -1.13076371]
mat_Sqrt:  [[ 7.37834858  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02551345 -0.08428494  0.16756593]
Stock Position:  -0.025513454496055733
Bond Position:  [7.75542468]


portfolio before change:  [5.20725098]
curr_Stock_Price:  99.95168623083305
curr_Factors:  [99.95168623 -1.38863348 -1.10054703]
mat_Sqrt:  [[ 8.2937848   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00015816  0.01026801  0.00177537]
Stock Position:  -0.0001581593656908093
Bond Position:  [5.22305928]


portfolio before change:  [5.20866452]
curr_Stock_Price:  99.27132242968862
curr_Factors:  [99.27132243 -1.15510776 -1.11326557]
mat_Sqrt:  [[10.27263338  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01297161 0.0591799  0.1530852 ]
Stock Position:  0.012971605526041723
Bond Position:  [3.92095608]


portfolio before change:  [5.2050621]
curr_Stock_Price:  98.91802936516382
curr_Factors:  [98.91802937 -0.85087892 -1.08844679]
mat_Sqrt:  [[14.22449974  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00711794  0.03935549 -0.20875514]
Stock Position:  0.00711793767749682
Bond Position:  [4.50096973]


portfolio before change:  [5.20293687]
curr_Stock_Price:  98.46135075311675
curr_Factors:  [98.46135075 -0.48484572 -1.12915317]
mat_Sqrt:  [[19.6026588   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.05492256 -0.13054343 -0.09777586]
Stock Position:  -0.054922556634221555
Bond Position:  [10.61068599]


portfolio before change:  [5.35090591]
curr_Stock_Price:  95.81551565809676
curr_Factors:  [95.81551566 -0.69152494 -1.1423314 ]
mat_Sqrt:  [[15.31095048  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00403814 -0.01356924 -0.88386927]
Stock Position:  -0.004038144105427229
Bond Position:  [5.73782276]


portfolio before change:  [5.35129195]
curr_Stock_Price:  96.0751873895852
curr_Factors:  [96.07518739 -0.72598101 -1.12806649]
mat_Sqrt:  [[15.04556987  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00558074 0.00530884 0.06122357]
Stock Position:  0.005580735969561272
Bond Position:  [4.81512169]


portfolio before change:  [5.35642898]
curr_Stock_Price:  96.77995147184541
curr_Factors:  [96.77995147 -0.99920432 -1.10871836]
mat_Sqrt:  [[11.7578038   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.07314441 -0.36943694  0.65349038]
Stock Position:  -0.07314441454526002
Bond Position:  [12.43534187]


portfolio before change:  [5.27649448]
curr_Stock_Price:  97.91529079338162
curr_Factors:  [97.91529079 -1.14977843 -1.11959628]
mat_Sqrt:  [[10.12216945  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00895014 0.01968142 0.40355979]
Stock Position:  0.008950144432607922
Bond Position:  [4.40013848]


portfolio before change:  [5.28023886]
curr_Stock_Price:  98.2107284288864
curr_Factors:  [98.21072843 -0.73067336 -1.12003601]
mat_Sqrt:  [[15.43142615  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00634766  0.03982791 -0.29535317]
Stock Position:  0.006347656586648061
Bond Position:  [4.65683088]


portfolio before change:  [5.27201637]
curr_Stock_Price:  96.73193965699545
curr_Factors:  [96.73193966 -0.36580913 -1.12028794]
mat_Sqrt:  [[21.8859871   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0041402   0.02994147  0.36207617]
Stock Position:  -0.004140200948608059
Bond Position:  [5.67250604]


portfolio before change:  [5.2793693]
curr_Stock_Price:  95.29852454276973
curr_Factors:  [95.29852454 -0.44880599 -1.10906243]
mat_Sqrt:  [[20.06838925  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00297295 0.03740214 0.41992308]
Stock Position:  0.0029729473805975787
Bond Position:  [4.9960518]


portfolio before change:  [5.26967284]
curr_Stock_Price:  91.61678261895601
curr_Factors:  [91.61678262 -0.39081984 -1.1184244 ]
mat_Sqrt:  [[20.25436292  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00517966 -0.00382731 -0.06187864]
Stock Position:  0.005179656242722032
Bond Position:  [4.7951294]


portfolio before change:  [5.26747177]
curr_Stock_Price:  90.96036836385547
curr_Factors:  [90.96036836 -0.62803462 -1.09268468]
mat_Sqrt:  [[16.27621108  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01002828 -0.15715043  0.42766526]
Stock Position:  -0.010028282437400123
Bond Position:  [6.17964804]


portfolio before change:  [5.26641479]
curr_Stock_Price:  91.21984378187317
curr_Factors:  [91.21984378 -0.51942021 -1.09320322]
mat_Sqrt:  [[18.18594477  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00622835 -0.1254637  -1.18771538]
Stock Position:  -0.006228351978351564
Bond Position:  [5.83456408]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [5.27248836]
Stock Price:  90.47891814825954
PL:  [5.27248836]
Settle:  Tensor("sub_316:0", shape=(), dtype=float64)
PL:  Tensor("sub_317:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  159
output_Z_Vals[:, i, :]:  [[ 1.19271183e+02 -4.92738716e+01 -4.92570741e+01]
 [-2.77138845e-03 -8.82134416e-03 -6.76307458e-02]
 [-2.26809733e+00 -3.05294193e+00 -8.69978414e-01]
 [ 4.65656814e-02  1.43575948e-01 -8.00600500e-02]
 [ 6.48598348e-01 -1.40570115e-02 -4.14778662e-01]
 [ 7.57175145e-02  1.17192732e-01 -6.73936232e-03]
 [ 1.18702619e-02  2.38658844e-02  9.92180189e-02]
 [ 1.67910020e-01  4.52790904e-01  3.06607762e-01]
 [-9.95425872e-02  2.37038608e-01 -8.35926509e-02]
 [-9.09281331e-01 -3.76805193e-01 -3.02238077e-02]
 [ 1.13360345e-01  1.52992501e-03 -2.00914666e-01]
 [-3.13345458e-03 -7.62216347e-02  3.59893955e-02]
 [-6.50877498e-01 -9.84119810e-01  2.28537205e-01]
 [-2.90011656e-03  8.46355385e-03  2.24305222e-02]
 [ 1.06840902e-01  1.35184434e-01 -1.05213218e-01]
 [ 5.45741518e-02  3.55438698e-02  6.83299167e-02]
 [ 1.25624007e-01  1.13073617e-01  9.78291833e-02]
 [ 8.27434931e-02 -3.10403809e-02  3.15923557e-02]
 [-4.23087101e-02 -3.84264118e-02 -2.57879466e-02]
 [ 6.53057351e-02 -5.67876911e-01 -4.52439803e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.27118322 -49.27387164 -49.25707411]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [   7.3268874   -15.90307369 -140.51672192]
init_Out:  [2.48374395]
Stock Position:  7.326887399052493
Bond position:  [-730.20499595]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [12.63733739]
curr_Stock_Price:  101.41071739548818
curr_Factors:  [101.4107174   -0.74795924  -1.01110337]
mat_Sqrt:  [[17.46355554  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00105231 -0.00284708 -0.19293169]
Stock Position:  -0.0010523118224519557
Bond Position:  [12.74405309]


portfolio before change:  [12.64144055]
curr_Stock_Price:  100.5395444016385
curr_Factors:  [100.5395444   -0.86794724  -1.00849407]
mat_Sqrt:  [[15.39603203  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.19932799 -0.98533277 -2.48180626]
Stock Position:  -0.1993279881127574
Bond Position:  [32.68178566]


portfolio before change:  [12.81685947]
curr_Stock_Price:  99.70048787064515
curr_Factors:  [99.70048787 -0.88173752 -1.02167294]
mat_Sqrt:  [[14.86129399  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00400576  0.04633894 -0.22838904]
Stock Position:  0.004005762202067193
Bond Position:  [12.41748302]


portfolio before change:  [12.82283713]
curr_Stock_Price:  100.41768050337991
curr_Factors:  [100.4176805   -0.83439706  -1.02030706]
mat_Sqrt:  [[15.71529078  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0357017  -0.00453688 -1.18324807]
Stock Position:  0.03570170231565956
Bond Position:  [9.23775499]


portfolio before change:  [12.80254842]
curr_Stock_Price:  99.78470126337406
curr_Factors:  [99.78470126 -0.56958714 -0.99997943]
mat_Sqrt:  [[20.76872617  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00473133  0.03782379 -0.01922552]
Stock Position:  0.004731330817685699
Bond Position:  [12.33043399]


portfolio before change:  [12.80758565]
curr_Stock_Price:  100.1977431299675
curr_Factors:  [100.19774313  -0.61812152  -0.99253927]
mat_Sqrt:  [[20.01505769  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00184834 0.00770268 0.28304139]
Stock Position:  0.0018483413364795429
Bond Position:  [12.62238602]


portfolio before change:  [12.81020959]
curr_Stock_Price:  99.90988954273267
curr_Factors:  [99.90988954 -0.10125569 -0.99445848]
mat_Sqrt:  [[33.39995353  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00966833 0.14613764 0.8746666 ]
Stock Position:  0.009668325518256233
Bond Position:  [11.84424825]


portfolio before change:  [12.80807445]
curr_Stock_Price:  99.38274849120616
curr_Factors:  [ 9.93827485e+01  1.90331842e-02 -9.96663875e-01]
mat_Sqrt:  [[37.38792725  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00182467  0.07650388 -0.23846657]
Stock Position:  -0.0018246682141665337
Bond Position:  [12.98941499]


portfolio before change:  [12.81480641]
curr_Stock_Price:  97.47325014840212
curr_Factors:  [ 9.74732501e+01  2.72822942e-02 -9.83077339e-01]
mat_Sqrt:  [[37.47908101  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02647786 -0.12161335 -0.08622011]
Stock Position:  -0.026477857817227172
Bond Position:  [15.39568927]


portfolio before change:  [12.81109557]
curr_Stock_Price:  97.75878089945105
curr_Factors:  [ 9.77587809e+01  4.33288105e-02 -1.00381633e+00]
mat_Sqrt:  [[37.41289774  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 1.94214053e-03  4.93781175e-04 -5.73153619e-01]
Stock Position:  0.0019421405305418862
Bond Position:  [12.62123428]


portfolio before change:  [12.81834435]
curr_Stock_Price:  99.8662861393787
curr_Factors:  [99.86628614 -0.17950204 -1.03189398]
mat_Sqrt:  [[29.73831072  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00038152 -0.02460043  0.10266773]
Stock Position:  -0.0003815222097161854
Bond Position:  [12.85644555]


portfolio before change:  [12.82101421]
curr_Stock_Price:  101.29385806512063
curr_Factors:  [101.29385807  -0.18470213  -1.0590847 ]
mat_Sqrt:  [[29.20205113  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02757033 -0.3176233   0.65195303]
Stock Position:  -0.027570328801750404
Bond Position:  [15.61371918]


portfolio before change:  [12.803728]
curr_Stock_Price:  102.06244254775763
curr_Factors:  [102.06244255  -0.52922264  -1.07752711]
mat_Sqrt:  [[20.46743436  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00016642 0.0027316  0.06398804]
Stock Position:  0.00016641608552817665
Bond Position:  [12.78674317]


portfolio before change:  [12.80680014]
curr_Stock_Price:  101.31166883248888
curr_Factors:  [101.31166883  -0.75325328  -1.07694176]
mat_Sqrt:  [[16.24859668  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00695191  0.04363059 -0.30014402]
Stock Position:  0.006951908082861658
Bond Position:  [12.10249074]


portfolio before change:  [12.80763417]
curr_Stock_Price:  100.9963636232348
curr_Factors:  [100.99636362  -0.65831248  -1.05093524]
mat_Sqrt:  [[18.28053422  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00414525 0.01147173 0.19492623]
Stock Position:  0.004145245360451741
Bond Position:  [12.38897946]


portfolio before change:  [12.80947744]
curr_Stock_Price:  100.69375938680005
curr_Factors:  [100.69375939  -0.75716894  -1.06288358]
mat_Sqrt:  [[16.31412524  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01033916 0.03649435 0.27907943]
Stock Position:  0.01033916059782752
Bond Position:  [11.76838849]


portfolio before change:  [12.82206712]
curr_Stock_Price:  101.6268346631903
curr_Factors:  [101.62683466  -0.8296959   -1.03110126]
mat_Sqrt:  [[15.80791027  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00524144 -0.01001824  0.0901242 ]
Stock Position:  0.005241436921811221
Bond Position:  [12.28939647]


portfolio before change:  [12.82046021]
curr_Stock_Price:  100.73401830129735
curr_Factors:  [100.7340183   -0.84516433  -1.05221189]
mat_Sqrt:  [[15.10623156  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00366845 -0.01240207 -0.07356583]
Stock Position:  -0.00366844708113142
Bond Position:  [13.18999762]


portfolio before change:  [12.81947154]
curr_Stock_Price:  101.90251717584303
curr_Factors:  [101.90251718  -0.83606957  -1.02887496]
mat_Sqrt:  [[15.78518923  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00905694 -0.18328148 -1.29068482]
Stock Position:  -0.009056941921219306
Bond Position:  [13.74239672]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [12.83458297]
Stock Price:  100.6134065820032
PL:  [12.22117639]
Settle:  Tensor("sub_318:0", shape=(), dtype=float64)
PL:  Tensor("sub_319:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  160
output_Z_Vals[:, i, :]:  [[ 1.19271183e+02 -4.92738716e+01 -4.92570741e+01]
 [ 2.96256884e-02  5.64898963e-02 -4.06983918e-02]
 [-2.08080363e+00 -2.80318096e+00 -7.97727189e-01]
 [ 4.20764467e-02  2.50611750e-01 -2.15789568e-02]
 [ 6.10689977e-01  5.79303236e-03 -4.10360789e-01]
 [ 6.22122950e-02  9.67863333e-02 -3.97631562e-03]
 [-8.24790207e-04  2.62208127e-02  4.81505585e-02]
 [ 1.46457348e-01  3.90820291e-01  2.48767601e-01]
 [ 2.90381650e-02 -8.51641342e-02 -1.10856085e-02]
 [-1.39133685e+00 -5.58633633e-01 -5.51065077e-02]
 [ 2.06629046e-01  8.00265693e-02  5.48828802e-02]
 [-7.46101772e-02 -4.12653917e-02  3.30259303e-02]
 [-6.75324845e-01 -1.06191005e+00  2.37767427e-01]
 [ 2.70186110e-02  4.16065465e-02  9.88184196e-02]
 [ 9.16968482e-02  1.25425441e-01 -1.03769702e-01]
 [-1.33007377e-02  5.38132253e-02  1.00465955e-01]
 [ 1.21833235e-01  1.15006234e-01  1.01539003e-01]
 [ 1.15216134e-01 -1.08333916e-02 -3.18137274e-02]
 [-4.92753807e-02 -9.58432762e-02 -7.81679189e-03]
 [ 7.37607473e-02 -5.83138790e-01 -5.72989531e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.27118322 -49.27387164 -49.25707411]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [   7.3268874   -15.90307369 -140.51672192]
init_Out:  [2.48374395]
Stock Position:  7.326887399052493
Bond position:  [-730.20499595]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [3.7860641]
curr_Stock_Price:  100.20266371525459
curr_Factors:  [100.20266372  -1.16555537  -1.02188221]
mat_Sqrt:  [[11.24312906  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00292171  0.01823204 -0.11610118]
Stock Position:  0.002921705831948454
Bond Position:  [3.4933014]


portfolio before change:  [3.78771811]
curr_Stock_Price:  100.46982645081586
curr_Factors:  [100.46982645  -1.16938567  -1.0312495 ]
mat_Sqrt:  [[11.12530545  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.2531019  -0.90472276 -2.27569363]
Stock Position:  -0.2531018980359043
Bond Position:  [29.21682188]


portfolio before change:  [3.6324216]
curr_Stock_Price:  101.11226188303226
curr_Factors:  [101.11226188  -0.86767336  -1.0492878 ]
mat_Sqrt:  [[14.86887712  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00597406  0.08088459 -0.06155876]
Stock Position:  0.005974060384163337
Bond Position:  [3.02837084]


portfolio before change:  [3.63004903]
curr_Stock_Price:  100.58837124712534
curr_Factors:  [100.58837125  -0.75000241  -1.06521697]
mat_Sqrt:  [[16.37600702  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.03224888  0.00186969 -1.17064511]
Stock Position:  0.03224888271340025
Bond Position:  [0.38618645]


portfolio before change:  [3.59936125]
curr_Stock_Price:  99.63378480416202
curr_Factors:  [99.6337848  -0.70508026 -1.07126162]
mat_Sqrt:  [[16.86363343  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00481255  0.03123765 -0.01134332]
Stock Position:  0.0048125489014556894
Bond Position:  [3.11986878]


portfolio before change:  [3.59964621]
curr_Stock_Price:  99.53090756303571
curr_Factors:  [99.53090756 -0.74422551 -1.10087337]
mat_Sqrt:  [[15.72684848  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00091285 0.00846273 0.13736014]
Stock Position:  0.0009128467393518482
Bond Position:  [3.50878974]


portfolio before change:  [3.60105157]
curr_Stock_Price:  100.10937576813255
curr_Factors:  [100.10937577  -0.48005962  -1.12090119]
mat_Sqrt:  [[20.19232404  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01371871 0.12613671 0.70966472]
Stock Position:  0.013718712075361043
Bond Position:  [2.22767987]


portfolio before change:  [3.6240252]
curr_Stock_Price:  101.74339503511548
curr_Factors:  [101.74339504  -0.86913333  -1.12650259]
mat_Sqrt:  [[13.82969361  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00067907 -0.02748661 -0.03162416]
Stock Position:  0.000679065551265887
Bond Position:  [3.55493476]


portfolio before change:  [3.62609355]
curr_Stock_Price:  103.4803546977831
curr_Factors:  [103.4803547   -0.74673178  -1.09834168]
mat_Sqrt:  [[16.35131503  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.09275193 -0.18029823 -0.15720353]
Stock Position:  -0.09275193046740766
Bond Position:  [13.22409622]


portfolio before change:  [3.75526527]
curr_Stock_Price:  102.12334491289381
curr_Factors:  [102.12334491  -0.14604605  -1.09516604]
mat_Sqrt:  [[29.51708532  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00793328 0.02582846 0.15656558]
Stock Position:  0.007933280660642823
Bond Position:  [2.94509211]


portfolio before change:  [3.74929491]
curr_Stock_Price:  101.27795387566525
curr_Factors:  [101.27795388  -0.4926529   -1.04808648]
mat_Sqrt:  [[21.6960317   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00351641 -0.01331835  0.09421379]
Stock Position:  -0.003516405729655052
Bond Position:  [4.10542928]


portfolio before change:  [3.74997394]
curr_Stock_Price:  101.37676416966475
curr_Factors:  [101.37676417  -0.82036754  -1.06825075]
mat_Sqrt:  [[15.33634688  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.05500347 -0.34273     0.67828429]
Stock Position:  -0.05500346725555089
Bond Position:  [9.32604746]


portfolio before change:  [3.85169851]
curr_Stock_Price:  99.5697367523149
curr_Factors:  [99.56973675 -0.4029722  -1.00859385]
mat_Sqrt:  [[24.27124269  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00229419 0.01342846 0.28190145]
Stock Position:  0.002294185669158273
Bond Position:  [3.62326705]


portfolio before change:  [3.8511298]
curr_Stock_Price:  98.9269610619091
curr_Factors:  [98.92696106 -0.68655071 -0.98010105]
mat_Sqrt:  [[18.68516797  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00514404  0.04048089 -0.29602608]
Stock Position:  0.00514404298725111
Bond Position:  [3.34224526]


portfolio before change:  [3.85559213]
curr_Stock_Price:  99.6319849959721
curr_Factors:  [99.631985   -1.00458992 -0.96957322]
mat_Sqrt:  [[13.83663953  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00131472 0.01736814 0.28660141]
Stock Position:  0.0013147244375650757
Bond Position:  [3.72460353]


portfolio before change:  [3.85616346]
curr_Stock_Price:  99.35820355565137
curr_Factors:  [99.35820356 -1.02505109 -0.95655684]
mat_Sqrt:  [[13.69627101  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01212267 0.0371181  0.28966251]
Stock Position:  0.012122667981897123
Bond Position:  [2.65167694]


portfolio before change:  [3.83459499]
curr_Stock_Price:  97.52432754902733
curr_Factors:  [97.52432755 -0.99307136 -0.93969708]
mat_Sqrt:  [[14.11634604  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00754521 -0.00349646 -0.09075571]
Stock Position:  0.007545212286568886
Bond Position:  [3.09875323]


portfolio before change:  [3.84603895]
curr_Stock_Price:  98.93836032904676
curr_Factors:  [98.93836033 -0.90906323 -0.97450748]
mat_Sqrt:  [[15.04320393  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00468217 -0.03093328 -0.02229913]
Stock Position:  -0.004682174343182262
Bond Position:  [4.3092856]


portfolio before change:  [3.84807595]
curr_Stock_Price:  98.7334237424054
curr_Factors:  [98.73342374 -0.9253273  -0.98377852]
mat_Sqrt:  [[14.63356282  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01108636 -0.18820724 -1.63457964]
Stock Position:  -0.01108636085763161
Bond Position:  [4.94267032]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [3.8648835]
Stock Price:  97.32884000492122
PL:  [3.8648835]
Settle:  Tensor("sub_320:0", shape=(), dtype=float64)
PL:  Tensor("sub_321:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  161
output_Z_Vals[:, i, :]:  [[ 1.19271183e+02 -4.92738716e+01 -4.92570741e+01]
 [ 1.94488446e-02  3.81931517e-02 -4.70755933e-02]
 [-2.06507545e+00 -2.78220702e+00 -7.91659818e-01]
 [ 7.67911678e-02  1.80083280e-01 -5.62169255e-02]
 [ 6.54371164e-01 -1.28060754e-01 -3.01728984e-01]
 [-5.30394612e-02 -7.73591716e-02  1.96031593e-02]
 [-7.64982230e-02  1.34519096e-01 -1.41743398e-01]
 [ 5.09158683e-02  1.02595923e-01  1.95345400e-03]
 [-8.66017231e-02  3.22888824e-01 -8.45458338e-02]
 [-7.48185287e-01 -3.00661089e-01 -2.22352927e-02]
 [-1.20895526e-02 -3.51310682e-02 -3.11105260e-01]
 [ 2.67356880e-01  1.09086696e-01  1.14336966e-02]
 [-7.41234595e-01 -9.91996530e-01  2.41676801e-01]
 [ 1.88603027e-01  6.43410897e-02  1.10403656e-01]
 [ 1.31750262e-01  1.38604175e-01 -1.05337372e-01]
 [-2.63132391e-01  1.37387610e-01  1.26813042e-01]
 [ 2.62444096e-03  1.21249196e-01  1.51736348e-01]
 [ 1.14829055e-01 -1.09481640e-02 -3.06803703e-02]
 [-6.43079318e-02 -2.81254679e-01  7.18387444e-02]
 [ 7.31099854e-02 -5.55092477e-01 -5.76717438e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.27118322 -49.27387164 -49.25707411]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [   7.3268874   -15.90307369 -140.51672192]
init_Out:  [2.48374395]
Stock Position:  7.326887399052493
Bond position:  [-730.20499595]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [5.33920952]
curr_Stock_Price:  100.41464259897037
curr_Factors:  [100.4146426   -1.00864834  -0.95468476]
mat_Sqrt:  [[14.09718238  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00125101  0.01232679 -0.13429356]
Stock Position:  0.0012510105469860915
Bond Position:  [5.21358974]


portfolio before change:  [5.34042444]
curr_Stock_Price:  100.34378757754111
curr_Factors:  [100.34378758  -1.27497409  -0.94986995]
mat_Sqrt:  [[10.84558545  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.25767055 -0.89795346 -2.25838511]
Stock Position:  -0.25767054931015587
Bond Position:  [31.1960633]


portfolio before change:  [5.55135449]
curr_Stock_Price:  99.55545509545732
curr_Factors:  [99.5554551  -1.04793498 -0.91091438]
mat_Sqrt:  [[14.03936921  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00727065  0.05812163 -0.16037124]
Stock Position:  0.007270645849656561
Bond Position:  [4.82752203]


portfolio before change:  [5.54912069]
curr_Stock_Price:  99.08220478209019
curr_Factors:  [99.08220478 -0.94552828 -0.92547806]
mat_Sqrt:  [[15.25555229  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.03714324 -0.04133143 -0.86074881]
Stock Position:  0.037143243977251626
Bond Position:  [1.86888618]


portfolio before change:  [5.53087864]
curr_Stock_Price:  98.57849734996634
curr_Factors:  [98.57849735 -0.54166361 -0.96538149]
mat_Sqrt:  [[21.84141762  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00296816 -0.02496757  0.05592236]
Stock Position:  -0.0029681616342441767
Bond Position:  [5.82347555]


portfolio before change:  [5.54126167]
curr_Stock_Price:  95.57091658448272
curr_Factors:  [95.57091658 -0.59829967 -0.97590811]
mat_Sqrt:  [[19.799581    0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00393811  0.04341585 -0.40435446]
Stock Position:  -0.003938107459153667
Bond Position:  [5.91763021]


portfolio before change:  [5.5455383]
curr_Stock_Price:  94.8606675428944
curr_Factors:  [94.86066754 -0.90958504 -0.95295543]
mat_Sqrt:  [[14.72974166  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00490551 0.03311269 0.00557266]
Stock Position:  0.004905511734759785
Bond Position:  [5.08019819]


portfolio before change:  [5.55165364]
curr_Stock_Price:  95.84835751328154
curr_Factors:  [95.84835751 -0.68114711 -0.93156735]
mat_Sqrt:  [[19.10696381  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0019862   0.10421192 -0.24118573]
Stock Position:  -0.001986195420964041
Bond Position:  [5.74202721]


portfolio before change:  [5.55157546]
curr_Stock_Price:  96.61055222658109
curr_Factors:  [96.61055223 -0.8446918  -0.93482137]
mat_Sqrt:  [[16.30015802  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.04994407 -0.09703795 -0.0634311 ]
Stock Position:  -0.049944070083908464
Bond Position:  [10.37669965]


portfolio before change:  [5.63154299]
curr_Stock_Price:  95.06135851604168
curr_Factors:  [95.06135852 -0.4670301  -0.91929965]
mat_Sqrt:  [[23.76449855  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00348271 -0.0113385  -0.88749671]
Stock Position:  -0.0034827053832065876
Bond Position:  [5.9626137]


portfolio before change:  [5.63854713]
curr_Stock_Price:  93.47830878648813
curr_Factors:  [93.47830879 -0.98271054 -0.91307272]
mat_Sqrt:  [[14.04050209  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.02079399 0.03520758 0.03261715]
Stock Position:  0.020793985878469683
Bond Position:  [3.6947605]


portfolio before change:  [5.63353599]
curr_Stock_Price:  93.19289226473092
curr_Factors:  [93.19289226 -0.86182529 -0.92302492]
mat_Sqrt:  [[15.6398359   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.05718685 -0.3201655   0.68943664]
Stock Position:  -0.057186851170848194
Bond Position:  [10.96294405]


portfolio before change:  [5.59824123]
curr_Stock_Price:  93.8580072642984
curr_Factors:  [93.85800726 -1.13644419 -0.93524675]
mat_Sqrt:  [[11.82353621  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01896832 0.020766   0.3149509 ]
Stock Position:  0.018968322623436333
Bond Position:  [3.81791227]


portfolio before change:  [5.61723627]
curr_Stock_Price:  94.8090899257939
curr_Factors:  [94.80908993 -0.9130217  -0.94693529]
mat_Sqrt:  [[14.75981525  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00938635  0.04473431 -0.3004982 ]
Stock Position:  0.009386351890968269
Bond Position:  [4.72732479]


portfolio before change:  [5.62291191]
curr_Stock_Price:  95.28783311972734
curr_Factors:  [95.28783312 -1.04857917 -0.95439338]
mat_Sqrt:  [[12.85752942  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01627083  0.04434166  0.36176231]
Stock Position:  -0.016270828675158784
Bond Position:  [7.17332391]


portfolio before change:  [5.62654205]
curr_Stock_Price:  95.17495660980983
curr_Factors:  [95.17495661 -0.91019346 -1.00083939]
mat_Sqrt:  [[14.07899547  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00414429 0.03913301 0.43286157]
Stock Position:  0.004144285851567133
Bond Position:  [5.23210983]


portfolio before change:  [5.62843517]
curr_Stock_Price:  95.31609606280139
curr_Factors:  [95.31609606 -0.63408937 -1.02371865]
mat_Sqrt:  [[18.16307484  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00585428 -0.0035335  -0.08752256]
Stock Position:  0.005854276714032907
Bond Position:  [5.07042837]


portfolio before change:  [5.63194645]
curr_Stock_Price:  95.69932240641917
curr_Factors:  [95.69932241 -0.92414386 -1.09887943]
mat_Sqrt:  [[12.65671537  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00845834 -0.09077456  0.20493594]
Stock Position:  -0.008458338312126636
Bond Position:  [6.44140369]


portfolio before change:  [5.64066255]
curr_Stock_Price:  94.85925789049661
curr_Factors:  [94.85925789 -0.91950774 -1.08147032]
mat_Sqrt:  [[12.82525461  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01231319 -0.17915533 -1.64521432]
Stock Position:  -0.012313186058587852
Bond Position:  [6.80868224]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [5.64992176]
Stock Price:  94.24553933427808
PL:  [5.64992176]
Settle:  Tensor("sub_322:0", shape=(), dtype=float64)
PL:  Tensor("sub_323:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  162
output_Z_Vals[:, i, :]:  [[ 1.19271183e+02 -4.92738716e+01 -4.92570741e+01]
 [ 1.03003066e-01  1.58569310e-01 -5.44452223e-02]
 [-2.53133578e+00 -3.54105776e+00 -1.01332985e+00]
 [-3.13538619e-01 -1.73814050e-01  2.02637967e-01]
 [ 1.10648409e+00  1.26327219e-01 -7.25568093e-01]
 [ 8.65857362e-02  2.17744972e-01  5.42034408e-02]
 [ 1.88122865e-02  3.96114664e-02  1.15648666e-01]
 [ 2.09976834e-01  5.98760640e-01  4.51673548e-01]
 [-4.48646480e-02 -2.75449631e-01  5.30059434e-02]
 [-2.28468969e+00 -7.86486913e-01 -1.00984047e-01]
 [-6.81831010e-02 -2.99294839e-01 -3.45271835e-02]
 [ 5.76584443e-02  2.41519916e-01  1.43081041e-02]
 [-9.84478925e-01 -1.26696993e+00  3.67051462e-01]
 [-6.66502016e-03  1.74185935e-02  1.42221876e-01]
 [-2.20022684e-01 -2.99939389e-01  1.22760195e-01]
 [ 1.11692469e-01  2.01697770e-02  4.12866840e-02]
 [-2.76139496e-01 -2.81614037e-01 -2.96717829e-01]
 [-1.67326632e-01 -2.56072033e-01  4.07819049e-01]
 [ 5.88481487e-02 -7.93183083e-02  9.45756608e-02]
 [ 5.75190414e-02 -6.48592763e-01  5.38213756e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.27118322 -49.27387164 -49.25707411]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [   7.3268874   -15.90307369 -140.51672192]
init_Out:  [2.48374395]
Stock Position:  7.326887399052493
Bond position:  [-730.20499595]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-9.16642031]
curr_Stock_Price:  98.43486195891666
curr_Factors:  [98.43486196 -0.63599162 -1.01663664]
mat_Sqrt:  [[18.85478566  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00659023  0.05117802 -0.15531706]
Stock Position:  0.006590226383506249
Bond Position:  [-9.81512833]


portfolio before change:  [-9.165999]
curr_Stock_Price:  98.87117497756633
curr_Factors:  [98.87117498 -0.30318146 -1.02676874]
mat_Sqrt:  [[26.15047991  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.13234924 -1.14287148 -2.89074799]
Stock Position:  -0.13234924427010666
Bond Position:  [3.91952629]


portfolio before change:  [-9.69244607]
curr_Stock_Price:  102.85629084000004
curr_Factors:  [102.85629084  -0.22601121  -1.04534   ]
mat_Sqrt:  [[28.84629505  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01066532 -0.05609824  0.57806972]
Stock Position:  -0.010665319805440159
Bond Position:  [-8.59545083]


portfolio before change:  [-9.71043432]
curr_Stock_Price:  104.34139603139155
curr_Factors:  [104.34139603  -0.45032472  -1.05716943]
mat_Sqrt:  [[23.10788777  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.04258998  0.04077193 -2.06984381]
Stock Position:  0.042589983708060476
Bond Position:  [-14.15433268]


portfolio before change:  [-9.82052143]
curr_Stock_Price:  101.83967902549584
curr_Factors:  [ 1.01839679e+02 -3.65416827e-02 -1.02064853e+00]
mat_Sqrt:  [[35.3822256   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00401606 0.07027689 0.15462733]
Stock Position:  0.004016055269409837
Bond Position:  [-10.22951521]


portfolio before change:  [-9.82111015]
curr_Stock_Price:  102.32995549084409
curr_Factors:  [102.32995549   0.13939982  -1.03580077]
mat_Sqrt:  [[41.75426083  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00120957 0.01278455 0.32991345]
Stock Position:  0.001209568253218986
Bond Position:  [-9.94488522]


portfolio before change:  [-9.82446745]
curr_Stock_Price:  101.61005595127514
curr_Factors:  [101.61005595   0.25096614  -1.06750405]
mat_Sqrt:  [[44.90749009  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00945045 0.19324917 1.28849891]
Stock Position:  0.009450446094140483
Bond Position:  [-10.78472781]


portfolio before change:  [-9.779416]
curr_Stock_Price:  106.66251289678091
curr_Factors:  [ 1.06662513e+02 -8.40050077e-02 -1.07269627e+00]
mat_Sqrt:  [[33.54770608  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00269082 -0.08890099  0.1512112 ]
Stock Position:  -0.002690818124184146
Bond Position:  [-9.49240658]


portfolio before change:  [-9.79202813]
curr_Stock_Price:  110.46757742316578
curr_Factors:  [110.46757742  -0.45884536  -1.06133392]
mat_Sqrt:  [[24.15624122  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.10207896 -0.25383756 -0.28807938]
Stock Position:  -0.10207895848764968
Bond Position:  [1.48438712]


portfolio before change:  [-10.03029954]
curr_Stock_Price:  112.80540059173931
curr_Factors:  [112.80540059  -0.83436216  -1.06011512]
mat_Sqrt:  [[16.96558589  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00803534 -0.09659699 -0.09849644]
Stock Position:  -0.008035339112897008
Bond Position:  [-9.1238699]


portfolio before change:  [-10.03012451]
curr_Stock_Price:  112.49971449360525
curr_Factors:  [112.49971449  -0.73317246  -1.05639736]
mat_Sqrt:  [[18.79105329  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00584742 0.07795022 0.04081704]
Stock Position:  0.005847416779159235
Bond Position:  [-10.68795722]


portfolio before change:  [-10.03379924]
curr_Stock_Price:  112.32828641431318
curr_Factors:  [112.32828641  -0.61779281  -1.05651452]
mat_Sqrt:  [[21.05458579  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.05548312 -0.40891279  1.04709565]
Stock Position:  -0.05548311537613747
Bond Position:  [-3.80147596]


portfolio before change:  [-10.09044956]
curr_Stock_Price:  113.33219234016485
curr_Factors:  [ 1.13332192e+02 -1.12476193e-01 -1.04579306e+00]
mat_Sqrt:  [[35.58961957  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00072834 0.00562183 0.40571943]
Stock Position:  0.0007283431125714153
Bond Position:  [-10.17299428]


portfolio before change:  [-10.09608356]
curr_Stock_Price:  109.08908827712456
curr_Factors:  [109.08908828   0.16212864  -1.01463393]
mat_Sqrt:  [[46.50963921  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0055083  -0.09680502  0.35020067]
Stock Position:  -0.005508304073197351
Bond Position:  [-9.49518769]


portfolio before change:  [-10.10426174]
curr_Stock_Price:  110.1427866583504
curr_Factors:  [ 1.10142787e+02  8.21848973e-02 -9.97672973e-01]
mat_Sqrt:  [[44.09249159  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00281765 0.00650977 0.11777942]
Stock Position:  0.0028176501764158265
Bond Position:  [-10.41460559]


portfolio before change:  [-10.10008344]
curr_Stock_Price:  112.54985723052337
curr_Factors:  [ 1.12549857e+02  5.82791334e-03 -9.98101078e-01]
mat_Sqrt:  [[41.72594569  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00944714 -0.09089054 -0.84645338]
Stock Position:  -0.009447143436589535
Bond Position:  [-9.03680879]


portfolio before change:  [-10.07862963]
curr_Stock_Price:  110.03975537825606
curr_Factors:  [110.03975538  -0.46873402  -1.03181055]
mat_Sqrt:  [[24.53982111  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00555633 -0.08264689  1.16339423]
Stock Position:  -0.0055563323572075714
Bond Position:  [-9.46721218]


portfolio before change:  [-10.08786414]
curr_Stock_Price:  111.27571672159783
curr_Factors:  [111.27571672  -0.54610376  -1.04868341]
mat_Sqrt:  [[22.58359801  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0027437  -0.02559987  0.26979804]
Stock Position:  0.00274369667537126
Bond Position:  [-10.39317095]


portfolio before change:  [-10.08596199]
curr_Stock_Price:  112.91612011250851
curr_Factors:  [112.91612011  -0.77534439  -1.06231218]
mat_Sqrt:  [[17.97512164  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00355425 -0.20933241  0.1535374 ]
Stock Position:  -0.003554254650646291
Bond Position:  [-9.68462934]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-10.08544045]
Stock Price:  112.08809764516229
PL:  [-22.17353809]
Settle:  Tensor("sub_324:0", shape=(), dtype=float64)
PL:  Tensor("sub_325:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  163
output_Z_Vals[:, i, :]:  [[ 1.19271183e+02 -4.92738716e+01 -4.92570741e+01]
 [ 2.30313024e-02  4.58952732e-02 -4.37586113e-02]
 [-1.85977883e+00 -2.50843869e+00 -7.12463709e-01]
 [ 9.52181721e-02  2.90871004e-01 -4.95348089e-02]
 [ 3.89254100e-01  1.05078757e-01 -3.95995989e-01]
 [-4.21747550e-02  1.18854541e-01 -2.70395923e-02]
 [ 1.28778992e-02  2.47421249e-02  8.20219256e-02]
 [ 5.96867344e-02  1.05478648e-01  8.89679193e-03]
 [-3.61585479e-02 -2.53033101e-01  4.54556562e-02]
 [-1.29696546e+00 -5.06102387e-01 -5.05952404e-02]
 [ 4.11779731e-01  9.55228063e-02  6.98816859e-02]
 [-1.56733531e-01 -5.94785558e-03  2.93405732e-02]
 [-7.76037334e-01 -1.08420221e+00  2.76242021e-01]
 [-1.40858769e-02 -2.96446938e-02 -2.08513492e-02]
 [ 1.69803493e-02  4.12589288e-02 -5.86543797e-02]
 [ 6.57586083e-02  3.25334367e-02  6.30345251e-02]
 [ 7.49462197e-02  6.22085037e-02  4.53943167e-02]
 [ 5.04810340e-02 -6.39587437e-02  6.88877445e-02]
 [ 2.19836403e-02  9.73167621e-02 -1.62647627e-02]
 [ 3.78651738e-02 -3.21707930e-01 -3.23059297e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.27118322 -49.27387164 -49.25707411]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [   7.3268874   -15.90307369 -140.51672192]
init_Out:  [2.48374395]
Stock Position:  7.326887399052493
Bond position:  [-730.20499595]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [6.61228858]
curr_Stock_Price:  100.58839701818232
curr_Factors:  [100.58839702  -1.27190168  -1.01367317]
mat_Sqrt:  [[10.23140654  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00229367  0.01481264 -0.12483114]
Stock Position:  0.0022936676959078124
Bond Position:  [6.38157222]


portfolio before change:  [6.61300277]
curr_Stock_Price:  100.20412063146536
curr_Factors:  [100.20412063  -1.5307738   -1.06392459]
mat_Sqrt:  [[ 7.48208069  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.3364362  -0.80959511 -2.03246065]
Stock Position:  -0.3364361975281383
Bond Position:  [40.32529609]


portfolio before change:  [6.50019342]
curr_Stock_Price:  100.56939624295984
curr_Factors:  [100.56939624  -1.45849639  -1.03401334]
mat_Sqrt:  [[ 8.31730491  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0173711   0.09387821 -0.14130902]
Stock Position:  0.017371097742422632
Bond Position:  [4.7531926]


portfolio before change:  [6.50362015]
curr_Stock_Price:  100.69824749812686
curr_Factors:  [100.6982475   -1.48363714  -0.99848746]
mat_Sqrt:  [[ 8.4148987   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.03920081  0.03391402 -1.12966633]
Stock Position:  0.039200812808399065
Bond Position:  [2.556167]


portfolio before change:  [6.52643726]
curr_Stock_Price:  101.26400073973981
curr_Factors:  [101.26400074  -1.47740147  -1.00889841]
mat_Sqrt:  [[ 8.42691785  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00278074  0.03836014 -0.07713643]
Stock Position:  -0.002780744688988081
Bond Position:  [6.80802659]


portfolio before change:  [6.52860155]
curr_Stock_Price:  101.09783385023229
curr_Factors:  [101.09783385  -1.3392381   -1.01740991]
mat_Sqrt:  [[ 9.57773074  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00361996 0.00798549 0.23398572]
Stock Position:  0.0036199618331638206
Bond Position:  [6.16263125]


portfolio before change:  [6.52992807]
curr_Stock_Price:  101.03862680552731
curr_Factors:  [101.03862681  -1.34175481  -1.05329574]
mat_Sqrt:  [[ 9.21149663  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00901412 0.03404309 0.02538007]
Stock Position:  0.00901411862655398
Bond Position:  [5.6191539]


portfolio before change:  [6.54857062]
curr_Stock_Price:  102.95091482791747
curr_Factors:  [102.95091483  -1.60435912  -1.06010225]
mat_Sqrt:  [[ 7.16917761  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01095385 -0.08166608  0.12967233]
Stock Position:  -0.01095385283100607
Bond Position:  [7.67627979]


portfolio before change:  [6.55147788]
curr_Stock_Price:  102.86072344926596
curr_Factors:  [102.86072345  -1.27389797  -1.07043085]
mat_Sqrt:  [[ 9.86553179  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.14298275 -0.16334384 -0.14433414]
Stock Position:  -0.14298275187580642
Bond Position:  [21.25878718]


portfolio before change:  [6.49183415]
curr_Stock_Price:  103.31503758883142
curr_Factors:  [103.31503759  -1.21544477  -1.07991844]
mat_Sqrt:  [[10.40638679  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.04281436 0.03082985 0.199353  ]
Stock Position:  0.042814359163189895
Bond Position:  [2.06846703]


portfolio before change:  [6.47561169]
curr_Stock_Price:  102.9240556379535
curr_Factors:  [102.92405564  -0.93317655  -1.07290789]
mat_Sqrt:  [[13.84476181  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01097588 -0.00191966  0.08370049]
Stock Position:  -0.010975884917617685
Bond Position:  [7.60529428]


portfolio before change:  [6.47142021]
curr_Stock_Price:  103.4791858147891
curr_Factors:  [103.47918581  -1.13331639  -1.08689371]
mat_Sqrt:  [[11.23642113  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0837421  -0.34992476  0.78804159]
Stock Position:  -0.08374210137026401
Bond Position:  [15.13698468]


portfolio before change:  [6.42840229]
curr_Stock_Price:  104.03807597809843
curr_Factors:  [104.03807598  -0.6738871   -1.08802741]
mat_Sqrt:  [[17.86498117  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00136543 -0.00956778 -0.0594831 ]
Stock Position:  -0.0013654276089188262
Bond Position:  [6.57045875]


portfolio before change:  [6.43272901]
curr_Stock_Price:  102.07246911025342
curr_Factors:  [102.07246911  -0.58757312  -1.09290669]
mat_Sqrt:  [[19.01452623  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00070628  0.01331626 -0.16732462]
Stock Position:  0.0007062767485668445
Bond Position:  [6.36063759]


portfolio before change:  [6.43376]
curr_Stock_Price:  101.28048272270217
curr_Factors:  [101.28048272  -0.75742868  -1.10806062]
mat_Sqrt:  [[15.68028865  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.0054378  0.01050012 0.17981995]
Stock Position:  0.005437804029618724
Bond Position:  [5.88301659]


portfolio before change:  [6.44208144]
curr_Stock_Price:  102.54027375337346
curr_Factors:  [102.54027375  -0.38612342  -1.09255861]
mat_Sqrt:  [[23.37281527  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00414629 0.02007771 0.12949735]
Stock Position:  0.004146293558136495
Bond Position:  [6.01691936]


portfolio before change:  [6.44483368]
curr_Stock_Price:  102.8412221979972
curr_Factors:  [102.8412222   -0.32988271  -1.09050672]
mat_Sqrt:  [[24.8484863   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00207204 -0.0206426   0.19651756]
Stock Position:  0.002072044205636806
Bond Position:  [6.23174212]


portfolio before change:  [6.44477784]
curr_Stock_Price:  102.06229961747708
curr_Factors:  [ 1.02062300e+02  5.86285492e-02 -1.06415862e+00]
mat_Sqrt:  [[37.3395592   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00103184  0.03140885 -0.04639884]
Stock Position:  0.00103183624182794
Bond Position:  [6.33946626]


portfolio before change:  [6.44009087]
curr_Stock_Price:  95.98377801268198
curr_Factors:  [95.98377801 -0.17604354 -1.04873206]
mat_Sqrt:  [[28.2023018   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0033241  -0.10383079 -0.92159825]
Stock Position:  -0.003324104032065092
Bond Position:  [6.75915093]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [6.44618674]
Stock Price:  94.65834621821418
PL:  [6.44618674]
Settle:  Tensor("sub_326:0", shape=(), dtype=float64)
PL:  Tensor("sub_327:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  164
output_Z_Vals[:, i, :]:  [[ 1.19271183e+02 -4.92738716e+01 -4.92570741e+01]
 [ 1.53598140e-02  3.21740724e-02 -4.85053291e-02]
 [-1.91319455e+00 -2.57966993e+00 -7.33069588e-01]
 [-1.17113741e-01  6.93656736e-02  7.76262519e-02]
 [ 5.12187418e-01  1.01594916e-01 -4.47210684e-01]
 [ 6.53088943e-02  1.02864921e-01 -5.01853540e-03]
 [ 2.42461989e-02  2.83008399e-02  1.12767707e-01]
 [-2.93776768e-02  4.70261888e-02  1.03334586e-01]
 [-3.12829994e-02 -2.40479504e-01  4.12273805e-02]
 [-1.36089797e+00 -5.45478777e-01 -5.35708895e-02]
 [ 3.49965010e-01  5.40424013e-02  5.94951929e-02]
 [-1.77653954e-01  1.67750008e-03  2.81513762e-02]
 [-8.72092996e-01 -1.10571566e+00  3.14347182e-01]
 [-8.37143050e-03 -3.21634546e-02 -2.09067513e-02]
 [-7.04632933e-02 -4.11104917e-02 -2.05894494e-02]
 [ 1.29151228e-01  1.54705389e-02  3.30206620e-02]
 [-5.16680229e-02 -6.17863744e-02 -7.79837310e-02]
 [ 2.20244154e-02 -8.17192023e-02  1.35063187e-01]
 [ 8.08835573e-03 -1.57767814e-04  7.61761413e-03]
 [ 7.46845454e-02 -6.35924977e-01 -4.71780887e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.27118322 -49.27387164 -49.25707411]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [   7.3268874   -15.90307369 -140.51672192]
init_Out:  [2.48374395]
Stock Position:  7.326887399052493
Bond position:  [-730.20499595]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [7.549389]
curr_Stock_Price:  100.71629586152322
curr_Factors:  [100.71629586  -1.16200036  -1.00217893]
mat_Sqrt:  [[11.5666774   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00103973  0.01038414 -0.1383722 ]
Stock Position:  0.001039729021095072
Bond Position:  [7.44467135]


portfolio before change:  [7.55273052]
curr_Stock_Price:  102.13985870842427
curr_Factors:  [102.13985871  -1.36275224  -1.02270858]
mat_Sqrt:  [[ 9.40162186  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.27542106 -0.83258489 -2.09124349]
Stock Position:  -0.2754210614194407
Bond Position:  [35.68419882]


portfolio before change:  [7.6788613]
curr_Stock_Price:  101.71429715737429
curr_Factors:  [101.71429716  -1.45037199  -1.02179104]
mat_Sqrt:  [[ 8.58489994  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01014679  0.02238767  0.22144609]
Stock Position:  -0.010146785718612324
Bond Position:  [8.71093448]


portfolio before change:  [7.68561724]
curr_Stock_Price:  101.26312645026363
curr_Factors:  [101.26312645  -1.33337326  -0.99926113]
mat_Sqrt:  [[ 9.82655047  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.04494343  0.03278962 -1.2757676 ]
Stock Position:  0.044943431206629386
Bond Position:  [3.13450488]


portfolio before change:  [7.6806386]
curr_Stock_Price:  101.13491265266218
curr_Factors:  [101.13491265  -1.1777614   -1.02302754]
mat_Sqrt:  [[11.19723033  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00761632  0.03319951 -0.01431648]
Stock Position:  0.007616321331931667
Bond Position:  [6.9103626]


portfolio before change:  [7.69197771]
curr_Stock_Price:  102.39684785585285
curr_Factors:  [102.39684786  -0.8761376   -1.04288421]
mat_Sqrt:  [[15.02678272  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00352981 0.00913406 0.32169488]
Stock Position:  0.00352981050087235
Bond Position:  [7.33053624]


portfolio before change:  [7.69680504]
curr_Stock_Price:  103.24518533337633
curr_Factors:  [103.24518533  -1.205746    -1.04223583]
mat_Sqrt:  [[10.90394639  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [1.20560742e-04 1.51776372e-02 2.94784811e-01]
Stock Position:  0.00012056074184871454
Bond Position:  [7.68435773]


portfolio before change:  [7.69876716]
curr_Stock_Price:  103.58350248359379
curr_Factors:  [103.58350248  -0.94378962  -1.02936496]
mat_Sqrt:  [[14.39993228  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00499691 -0.07761443  0.11761024]
Stock Position:  -0.004996910221690439
Bond Position:  [8.21636462]


portfolio before change:  [7.70137838]
curr_Stock_Price:  103.47205981457266
curr_Factors:  [103.47205981  -0.83803166  -1.02770696]
mat_Sqrt:  [[16.0155961   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.09260838 -0.17605252 -0.15282284]
Stock Position:  -0.09260838369290042
Bond Position:  [17.28375859]


portfolio before change:  [7.6373055]
curr_Stock_Price:  104.21059288358086
curr_Factors:  [104.21059288  -1.08743489  -1.02507464]
mat_Sqrt:  [[12.60261405  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.0296082  0.01744211 0.16972323]
Stock Position:  0.02960820451295517
Bond Position:  [4.55181696]


portfolio before change:  [7.65052698]
curr_Stock_Price:  104.61870202894683
curr_Factors:  [104.61870203  -1.15547179  -1.0293376 ]
mat_Sqrt:  [[11.76951759  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01457708  0.00054141  0.08030804]
Stock Position:  -0.014577076682610586
Bond Position:  [9.17556182]


portfolio before change:  [7.63301849]
curr_Stock_Price:  105.97718182303676
curr_Factors:  [105.97718182  -1.11852632  -1.02156628]
mat_Sqrt:  [[12.46757418  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0829055  -0.3568682   0.89674501]
Stock Position:  -0.08290549509885671
Bond Position:  [16.41910922]


portfolio before change:  [7.73467553]
curr_Stock_Price:  104.80051982193316
curr_Factors:  [104.80051982  -1.35252737  -1.03487105]
mat_Sqrt:  [[ 9.62785358  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00199466 -0.01038071 -0.05964114]
Stock Position:  -0.0019946648296210075
Bond Position:  [7.94371744]


portfolio before change:  [7.73621799]
curr_Stock_Price:  105.02297170068678
curr_Factors:  [105.0229717   -0.92963153  -1.05981441]
mat_Sqrt:  [[14.3641163   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00578231 -0.01326835 -0.05873597]
Stock Position:  -0.005782307753943745
Bond Position:  [8.34349313]


portfolio before change:  [7.73843941]
curr_Stock_Price:  104.9995750020165
curr_Factors:  [104.999575    -1.07695666  -1.04167261]
mat_Sqrt:  [[12.62055753  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01101769 0.00499309 0.09419876]
Stock Position:  0.011017694924128924
Bond Position:  [6.58158612]


portfolio before change:  [7.74135552]
curr_Stock_Price:  105.11489058080761
curr_Factors:  [105.11489058  -1.15978521  -1.02480951]
mat_Sqrt:  [[11.82787724  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00678046 -0.01994147 -0.22246588]
Stock Position:  -0.0067804623396619445
Bond Position:  [8.45408308]


portfolio before change:  [7.75520731]
curr_Stock_Price:  103.38374023742962
curr_Factors:  [103.38374024  -1.23108853  -0.97340026]
mat_Sqrt:  [[11.40394003  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00288613 -0.02637476  0.38529768]
Stock Position:  0.0028861262471398057
Bond Position:  [7.45682878]


portfolio before change:  [7.75605314]
curr_Stock_Price:  103.03080937661994
curr_Factors:  [103.03080938  -1.2704116   -0.99543355]
mat_Sqrt:  [[10.68865516  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 8.99186132e-04 -5.09193432e-05  2.17309328e-02]
Stock Position:  0.0008991861321299546
Bond Position:  [7.66340927]


portfolio before change:  [7.75766847]
curr_Stock_Price:  102.69632408226423
curr_Factors:  [102.69632408  -1.04760895  -0.96506026]
mat_Sqrt:  [[13.72346466  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01103402 -0.2052439  -1.34585955]
Stock Position:  -0.011034018820866522
Bond Position:  [8.89082164]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [7.77597881]
Stock Price:  101.23834653116276
PL:  [6.53763228]
Settle:  Tensor("sub_328:0", shape=(), dtype=float64)
PL:  Tensor("sub_329:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  165
output_Z_Vals[:, i, :]:  [[ 1.19271183e+02 -4.92738716e+01 -4.92570741e+01]
 [ 1.02385888e-02  2.17383072e-02 -5.27586181e-02]
 [-2.37392287e+00 -3.00950837e+00 -8.77898173e-01]
 [-1.67571397e-02  5.26766175e-02 -1.10821515e-01]
 [ 6.80574331e-01 -6.65052361e-02 -3.93322481e-01]
 [-1.43102481e-01 -2.42223047e-01  8.16332980e-03]
 [-1.23556568e-02  3.08208948e-02 -1.18189852e-03]
 [ 5.50372930e-02  1.07396506e-01  3.77915039e-03]
 [ 1.42652766e-03 -1.56258777e-01  1.28603364e-02]
 [-9.85929482e-01 -4.02083426e-01 -3.42574521e-02]
 [ 8.70262115e-02 -3.12321936e-02 -2.34477971e-01]
 [ 3.80042745e-02  1.62215715e-03  2.29000968e-02]
 [-7.22453243e-01 -1.12570812e+00  2.43276732e-01]
 [ 7.16931047e-02  7.97822428e-02  1.63047349e-01]
 [ 8.70186031e-02  1.22159392e-01 -1.02961331e-01]
 [-1.00024981e-01  7.84208222e-02  1.28610972e-01]
 [ 5.54468652e-02  1.17950829e-01  1.28394249e-01]
 [ 1.15216134e-01 -1.08333916e-02 -3.18137274e-02]
 [-5.72213802e-02 -1.82726199e-01  2.68970240e-02]
 [ 7.86356581e-02 -6.13772415e-01 -6.17998983e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.27118322 -49.27387164 -49.25707411]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [   7.3268874   -15.90307369 -140.51672192]
init_Out:  [2.48374395]
Stock Position:  7.326887399052493
Bond position:  [-730.20499595]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [5.39989031]
curr_Stock_Price:  100.42292453247296
curr_Factors:  [100.42292453  -0.81202829  -0.99118381]
mat_Sqrt:  [[16.54656309  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0002361   0.00701601 -0.15050565]
Stock Position:  0.00023609702710852075
Bond Position:  [5.37618076]


portfolio before change:  [5.4009057]
curr_Stock_Price:  99.03018134398896
curr_Factors:  [99.03018134 -0.93164244 -0.9830216 ]
mat_Sqrt:  [[14.59619127  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.21700431 -0.97131465 -2.50439913]
Stock Position:  -0.21700430924287467
Bond Position:  [26.8908818]


portfolio before change:  [5.43695341]
curr_Stock_Price:  98.89504968313742
curr_Factors:  [98.89504968 -0.69247374 -0.94547476]
mat_Sqrt:  [[19.22306162  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00148914  0.01700131 -0.31614294]
Stock Position:  -0.001489144536162158
Bond Position:  [5.58422244]


portfolio before change:  [5.4367843]
curr_Stock_Price:  99.94621904637138
curr_Factors:  [99.94621905 -0.93886796 -0.95629067]
mat_Sqrt:  [[15.0213661   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.03905852 -0.02146447 -1.12203956]
Stock Position:  0.039058524215715144
Bond Position:  [1.53303248]


portfolio before change:  [5.39965734]
curr_Stock_Price:  98.98585851590909
curr_Factors:  [98.98585852 -1.38098814 -0.95586059]
mat_Sqrt:  [[ 9.56516896  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01995571 -0.07817715  0.02328771]
Stock Position:  -0.019955708237901777
Bond Position:  [7.37499025]


portfolio before change:  [5.40136174]
curr_Stock_Price:  98.99285295791007
curr_Factors:  [98.99285296 -1.03573235 -0.96181096]
mat_Sqrt:  [[13.43017904  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00046951  0.0099474  -0.00337163]
Stock Position:  -0.0004695113918018751
Bond Position:  [5.44784001]


portfolio before change:  [5.40294756]
curr_Stock_Price:  98.51642773971939
curr_Factors:  [98.51642774 -1.24282528 -0.97969481]
mat_Sqrt:  [[10.67285098  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00728305 0.03466207 0.01078086]
Stock Position:  0.007283052023658538
Bond Position:  [4.68544729]


portfolio before change:  [5.41097045]
curr_Stock_Price:  99.45715706626524
curr_Factors:  [99.45715707 -1.55188085 -0.98657101]
mat_Sqrt:  [[ 7.85598063  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00354438 -0.0504323   0.03668696]
Stock Position:  -0.003544376931614818
Bond Position:  [5.7634841]


portfolio before change:  [5.41204371]
curr_Stock_Price:  99.56092507408286
curr_Factors:  [99.56092507 -1.07712102 -1.0199455 ]
mat_Sqrt:  [[12.22769238  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.08791497 -0.12977187 -0.09772698]
Stock Position:  -0.087914968573131
Bond Position:  [14.1649393]


portfolio before change:  [5.56157634]
curr_Stock_Price:  97.90033238367543
curr_Factors:  [97.90033238 -0.89083945 -1.03769949]
mat_Sqrt:  [[14.2308338   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00230404 -0.01008015 -0.66890039]
Stock Position:  0.002304035851911659
Bond Position:  [5.33601046]


portfolio before change:  [5.55940767]
curr_Stock_Price:  96.38002696878497
curr_Factors:  [96.38002697 -1.03361728 -1.0228134 ]
mat_Sqrt:  [[12.32794106  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00348881 0.00052355 0.0653276 ]
Stock Position:  0.0034888111845903266
Bond Position:  [5.22315595]


portfolio before change:  [5.56077257]
curr_Stock_Price:  96.39692290869284
curr_Factors:  [96.39692291 -1.32001907 -1.04236812]
mat_Sqrt:  [[ 9.08011709  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.09940167 -0.36332073  0.6940008 ]
Stock Position:  -0.09940166929969373
Bond Position:  [15.14278762]


portfolio before change:  [5.51224042]
curr_Stock_Price:  96.92325531345402
curr_Factors:  [96.92325531 -0.87396657 -1.03194923]
mat_Sqrt:  [[14.41117118  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00841434 0.02574961 0.4651287 ]
Stock Position:  0.0084143395467139
Bond Position:  [4.69669524]


portfolio before change:  [5.51471447]
curr_Stock_Price:  97.07772169722085
curr_Factors:  [97.0777217  -0.62772245 -1.03329629]
mat_Sqrt:  [[18.4394644   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00493167  0.03942677 -0.29372002]
Stock Position:  0.0049316720338288276
Bond Position:  [5.03595899]


portfolio before change:  [5.51968252]
curr_Stock_Price:  97.82977902677912
curr_Factors:  [97.82977903 -0.89405087 -1.05130869]
mat_Sqrt:  [[13.98337959  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00413096  0.02531021  0.3668913 ]
Stock Position:  -0.004130960798908383
Bond Position:  [5.9238135]


portfolio before change:  [5.52495354]
curr_Stock_Price:  96.91234568483608
curr_Factors:  [96.91234568 -0.87274379 -1.03988271]
mat_Sqrt:  [[14.31317463  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00738703 0.03806847 0.36627306]
Stock Position:  0.007387029539114652
Bond Position:  [4.80905918]


portfolio before change:  [5.52784543]
curr_Stock_Price:  97.14105438831712
curr_Factors:  [97.14105439 -1.00015081 -0.98837597]
mat_Sqrt:  [[13.29831457  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00800935 -0.00349646 -0.09075571]
Stock Position:  0.008009347879415008
Bond Position:  [4.74980893]


portfolio before change:  [5.52815283]
curr_Stock_Price:  97.03115776628404
curr_Factors:  [97.03115777 -0.78340042 -0.96889559]
mat_Sqrt:  [[16.82281716  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00529221 -0.05897463  0.07672972]
Stock Position:  -0.005292209771421635
Bond Position:  [6.04166207]


portfolio before change:  [5.52835674]
curr_Stock_Price:  97.27806663268774
curr_Factors:  [97.27806663 -1.06691308 -0.94529456]
mat_Sqrt:  [[13.00541621  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01328667 -0.1980942  -1.76297908]
Stock Position:  -0.013286666335041412
Bond Position:  [6.82085795]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [5.51686898]
Stock Price:  98.27103107672626
PL:  [5.51686898]
Settle:  Tensor("sub_330:0", shape=(), dtype=float64)
PL:  Tensor("sub_331:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  166
output_Z_Vals[:, i, :]:  [[ 1.19271183e+02 -4.92738716e+01 -4.92570741e+01]
 [ 1.03963383e-02  2.21280112e-02 -5.25695921e-02]
 [-2.01061337e+00 -2.70958044e+00 -7.70650293e-01]
 [ 1.01236592e-01  2.70287064e-01 -4.58166652e-02]
 [ 4.79346407e-01  1.52923346e-01 -4.75863589e-01]
 [-7.04210183e-02  8.27018077e-02 -1.32601718e-02]
 [ 1.19805767e-02  2.55337634e-02  7.54911159e-02]
 [ 6.58081408e-03  3.85495902e-02 -1.57804047e-02]
 [ 6.54910745e-02  8.69508038e-03 -4.26990675e-02]
 [-8.85716977e-01 -3.60030244e-01 -2.91751115e-02]
 [ 9.40784189e-02 -4.49223392e-02 -2.02441673e-01]
 [ 3.05085087e-02 -6.89470900e-02  3.71291224e-02]
 [-6.36397436e-01 -1.30399664e+00  2.24472917e-01]
 [ 1.05115257e-02  2.70394137e-02  6.68922955e-02]
 [ 1.04904510e-01  1.24052895e-01 -1.05075145e-01]
 [-1.88434975e-02  5.53051268e-02  1.03090229e-01]
 [ 1.14317777e-01  1.00786798e-01  8.39449152e-02]
 [ 8.93215018e-02 -1.85935016e-02  4.05243953e-02]
 [-4.49142699e-02 -1.79249920e-04 -5.87502530e-02]
 [ 9.27796658e-02 -7.23972126e-01 -6.32205650e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.27118322 -49.27387164 -49.25707411]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [   7.3268874   -15.90307369 -140.51672192]
init_Out:  [2.48374395]
Stock Position:  7.326887399052493
Bond position:  [-730.20499595]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [5.80581789]
curr_Stock_Price:  100.47832699186037
curr_Factors:  [100.47832699  -0.85787242  -0.99421874]
mat_Sqrt:  [[15.76592388  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00026529  0.00714178 -0.14996641]
Stock Position:  0.00026528585433585936
Bond Position:  [5.77916241]


portfolio before change:  [5.80738595]
curr_Stock_Price:  100.94229357695707
curr_Factors:  [100.94229358  -1.29267251  -0.99470668]
mat_Sqrt:  [[10.24889414  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.26549328 -0.87451333 -2.19845078]
Stock Position:  -0.26549327759180924
Bond Position:  [32.60688632]


portfolio before change:  [5.96081534]
curr_Stock_Price:  100.39509833558927
curr_Factors:  [100.39509834  -1.25113216  -0.9887939 ]
mat_Sqrt:  [[10.68870227  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01375812  0.08723477 -0.13070219]
Stock Position:  0.013758117355507249
Bond Position:  [4.5795678]


portfolio before change:  [5.9778457]
curr_Stock_Price:  101.54971287671347
curr_Factors:  [101.54971288  -1.53201504  -0.98050153]
mat_Sqrt:  [[ 8.23202384  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.05022173  0.0493558  -1.35750636]
Stock Position:  0.050221733340785155
Bond Position:  [0.8778431]


portfolio before change:  [5.97435974]
curr_Stock_Price:  101.47593104378917
curr_Factors:  [101.47593104  -1.6139841   -0.96968284]
mat_Sqrt:  [[ 7.66109328  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00734181  0.02669189 -0.03782758]
Stock Position:  -0.00734181163170652
Bond Position:  [6.71937691]


portfolio before change:  [5.9783941]
curr_Stock_Price:  101.1552598431114
curr_Factors:  [101.15525984  -1.4669344   -0.97590202]
mat_Sqrt:  [[ 8.79180588  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00370825 0.00824099 0.21535514]
Stock Position:  0.00370824768914476
Bond Position:  [5.60328534]


portfolio before change:  [5.97615095]
curr_Stock_Price:  100.17254639986504
curr_Factors:  [100.1725464   -1.51858814  -0.97091143]
mat_Sqrt:  [[ 8.30945974  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0013513   0.01244183 -0.0450171 ]
Stock Position:  0.0013512977960891098
Bond Position:  [5.84078801]


portfolio before change:  [5.97777557]
curr_Stock_Price:  100.29408997573863
curr_Factors:  [100.29408998  -1.09954475  -0.97829351]
mat_Sqrt:  [[12.55687737  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00466279  0.00280633 -0.12180855]
Stock Position:  0.00466278661058823
Bond Position:  [5.51012563]


portfolio before change:  [5.97297361]
curr_Stock_Price:  98.96877352661467
curr_Factors:  [98.96877353 -1.36111063 -0.9488191 ]
mat_Sqrt:  [[ 9.82445473  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.09824089 -0.11619926 -0.08322847]
Stock Position:  -0.09824089114997867
Bond Position:  [15.69575412]


portfolio before change:  [6.00405248]
curr_Stock_Price:  98.69236685093344
curr_Factors:  [98.69236685 -1.52052231 -0.90121509]
mat_Sqrt:  [[ 8.76065094  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00497514 -0.01449862 -0.57750974]
Stock Position:  0.0049751384554455385
Bond Position:  [5.51304429]


portfolio before change:  [6.00905133]
curr_Stock_Price:  99.42006857444484
curr_Factors:  [99.42006857 -1.59232355 -0.89272334]
mat_Sqrt:  [[ 8.28384391  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00289886 -0.02225258  0.10591905]
Stock Position:  0.0028988587391168023
Bond Position:  [5.72084659]


portfolio before change:  [6.01068253]
curr_Stock_Price:  99.48934222258524
curr_Factors:  [99.48934222 -1.37179801 -0.92666169]
mat_Sqrt:  [[ 9.99006225  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.08576066 -0.42086311  0.64035875]
Stock Position:  -0.08576065615563556
Bond Position:  [14.5429538]


portfolio before change:  [5.96039216]
curr_Stock_Price:  100.11814535143391
curr_Factors:  [100.11814535  -1.24912018  -0.92432584]
mat_Sqrt:  [[11.3919267   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00260582 0.00872693 0.1908251 ]
Stock Position:  0.002605815178026832
Bond Position:  [5.69950277]


portfolio before change:  [5.96170234]
curr_Stock_Price:  100.07406175318856
curr_Factors:  [100.07406175  -0.94526486  -0.85393766]
mat_Sqrt:  [[16.55532841  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00657059  0.0400379  -0.29975014]
Stock Position:  0.006570593120905252
Bond Position:  [5.30415639]


portfolio before change:  [5.96159829]
curr_Stock_Price:  99.85638770065255
curr_Factors:  [99.8563877  -1.11520134 -0.84878384]
mat_Sqrt:  [[14.00967065  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00096282 0.01784965 0.29408773]
Stock Position:  0.0009628220043413961
Bond Position:  [5.86545437]


portfolio before change:  [5.96367279]
curr_Stock_Price:  100.48781298413431
curr_Factors:  [100.48781298  -1.30031621  -0.84260329]
mat_Sqrt:  [[11.78841131  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01289622 0.0325288  0.23947148]
Stock Position:  0.012896222929117107
Bond Position:  [4.66775955]


portfolio before change:  [5.96656587]
curr_Stock_Price:  100.6216502711633
curr_Factors:  [100.62165027  -1.19640058  -0.82128994]
mat_Sqrt:  [[13.37887437  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00701091 -0.00600103  0.11560482]
Stock Position:  0.007010913185906292
Bond Position:  [5.26111622]


portfolio before change:  [5.96193557]
curr_Stock_Price:  99.77358105401524
curr_Factors:  [99.77358105 -1.62619287 -0.8155742 ]
mat_Sqrt:  [[ 8.6809968   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-6.55952371e-03 -5.78526630e-05 -1.67598119e-01]
Stock Position:  -0.006559523707134545
Bond Position:  [6.61640275]


portfolio before change:  [5.96296359]
curr_Stock_Price:  99.86905972413278
curr_Factors:  [99.86905972 -1.41340034 -0.82199051]
mat_Sqrt:  [[10.68102785  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01723139 -0.233661   -1.80350675]
Stock Position:  -0.017231390657091446
Bond Position:  [7.68384637]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [5.97969146]
Stock Price:  99.00977528157239
PL:  [5.97969146]
Settle:  Tensor("sub_332:0", shape=(), dtype=float64)
PL:  Tensor("sub_333:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  167
output_Z_Vals[:, i, :]:  [[ 1.19271183e+02 -4.92738716e+01 -4.92570741e+01]
 [-3.66221618e-03 -7.01079130e-03 -6.46628815e-02]
 [-2.52115122e+00 -3.39039581e+00 -9.67597574e-01]
 [ 8.21433481e-03  2.13787912e-01 -7.06925086e-04]
 [ 7.87356115e-01  1.39299141e-02 -4.98009458e-01]
 [ 7.57175145e-02  1.17192732e-01 -6.73936232e-03]
 [ 1.09654470e-02  2.49131081e-02  7.75142713e-02]
 [ 3.88028471e-02  1.20953466e-01  6.50310320e-02]
 [-8.25172563e-04 -1.62056471e-01  1.48131032e-02]
 [-1.30824342e+00 -5.16866922e-01 -5.10389899e-02]
 [ 4.56616392e-01  1.30015404e-01  7.92811149e-02]
 [-8.88059450e-02 -1.57438881e-02  3.17085033e-02]
 [-7.36984533e-01 -1.06773657e+00  2.60810884e-01]
 [-9.85736632e-03 -4.39265588e-03  6.44508940e-03]
 [ 8.42929545e-02  1.18654561e-01 -1.03271589e-01]
 [ 1.07638548e-01  2.12609393e-02  4.32060529e-02]
 [ 5.09434965e-02  3.87023430e-02  2.20050908e-02]
 [ 7.82944080e-02 -3.86799574e-02  2.78099157e-02]
 [ 7.16178300e-03 -5.22090891e-02  3.92011152e-02]
 [ 7.10026349e-02 -6.02460976e-01 -4.83096493e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.27118322 -49.27387164 -49.25707411]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [   7.3268874   -15.90307369 -140.51672192]
init_Out:  [2.48374395]
Stock Position:  7.326887399052493
Bond position:  [-730.20499595]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [7.10384507]
curr_Stock_Price:  100.65548641959283
curr_Factors:  [100.65548642  -0.50423912  -1.01299758]
mat_Sqrt:  [[22.07546823  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00082864 -0.00226272 -0.1844652 ]
Stock Position:  -0.0008286367106384163
Bond Position:  [7.1872519]


portfolio before change:  [7.10522451]
curr_Stock_Price:  101.15944857081445
curr_Factors:  [101.15944857  -0.42318876  -0.98524839]
mat_Sqrt:  [[24.73602829  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.13788482 -1.09424554 -2.76028655]
Stock Position:  -0.13788482359318016
Bond Position:  [21.05357723]


portfolio before change:  [7.08723257]
curr_Stock_Price:  101.3281109720783
curr_Factors:  [101.32811097  -0.70336943  -1.01046052]
mat_Sqrt:  [[18.25673267  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00283234  0.06899975 -0.00201666]
Stock Position:  0.002832341916622856
Bond Position:  [6.80023672]


portfolio before change:  [7.08932756]
curr_Stock_Price:  101.46747011608196
curr_Factors:  [101.46747012  -0.75056579  -1.01736234]
mat_Sqrt:  [[17.31910322  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.03975632  0.00449586 -1.42068236]
Stock Position:  0.03975631899015301
Bond Position:  [3.05535445]


portfolio before change:  [7.04404528]
curr_Stock_Price:  100.30925902577611
curr_Factors:  [100.30925903  -0.6777076   -0.96066861]
mat_Sqrt:  [[19.48961577  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00504185  0.03782379 -0.01922552]
Stock Position:  0.005041849737745123
Bond Position:  [6.53830107]


portfolio before change:  [7.04837019]
curr_Stock_Price:  100.84281954099808
curr_Factors:  [100.84281954  -1.29498447  -0.96613871]
mat_Sqrt:  [[10.51118456  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00303233 0.00804067 0.22112664]
Stock Position:  0.003032326957604556
Bond Position:  [6.74258179]


portfolio before change:  [7.05241598]
curr_Stock_Price:  101.62107820382086
curr_Factors:  [101.6210782   -1.11049617  -0.95244239]
mat_Sqrt:  [[12.91400541  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00594446 0.03903756 0.18551543]
Stock Position:  0.005944458853068306
Bond Position:  [6.44833367]


portfolio before change:  [7.05591636]
curr_Stock_Price:  101.93869993737965
curr_Factors:  [101.93869994  -1.19605408  -0.93828329]
mat_Sqrt:  [[12.06168962  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00256026 -0.0523035   0.04225766]
Stock Position:  -0.0025602631297943677
Bond Position:  [7.31690625]


portfolio before change:  [7.05503462]
curr_Stock_Price:  102.99765042228955
curr_Factors:  [102.99765042  -1.10721423  -1.04348434]
mat_Sqrt:  [[11.98921629  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.11878731 -0.16681808 -0.14560003]
Stock Position:  -0.11878730795109128
Bond Position:  [19.28984824]


portfolio before change:  [7.11873789]
curr_Stock_Price:  102.50197287544077
curr_Factors:  [102.50197288  -1.25536413  -1.05760441]
mat_Sqrt:  [[10.14431554  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.04922351 0.04196229 0.22616695]
Stock Position:  0.04922351465228451
Bond Position:  [2.07323052]


portfolio before change:  [7.10792322]
curr_Stock_Price:  102.27173651279591
curr_Factors:  [102.27173651  -1.05888721  -1.06154516]
mat_Sqrt:  [[12.2705366   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00697176 -0.00508132  0.09045553]
Stock Position:  -0.006971755540577612
Bond Position:  [7.82093676]


portfolio before change:  [7.1077889]
curr_Stock_Price:  102.5714876968571
curr_Factors:  [102.5714877   -1.07307812  -1.12008879]
mat_Sqrt:  [[11.44317046  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.07879788 -0.3446105   0.74402086]
Stock Position:  -0.07879787795120158
Bond Position:  [15.19020447]


portfolio before change:  [7.1025351]
curr_Stock_Price:  102.68636173518546
curr_Factors:  [102.68636174  -0.85199364  -1.10541801]
mat_Sqrt:  [[14.50172576  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00065085 -0.00141772  0.01838605]
Stock Position:  -0.0006508477157447552
Bond Position:  [7.16936828]


portfolio before change:  [7.10419591]
curr_Stock_Price:  102.88880198946727
curr_Factors:  [102.88880199  -1.3560155   -1.11908305]
mat_Sqrt:  [[ 8.65857588  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01009785  0.03829559 -0.2946051 ]
Stock Position:  0.010097848838685976
Bond Position:  [6.06524034]


portfolio before change:  [7.11044835]
curr_Stock_Price:  103.35780726506184
curr_Factors:  [103.35780727  -1.30402661  -1.13814459]
mat_Sqrt:  [[ 8.98921586  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01343808 0.00686194 0.12325484]
Stock Position:  0.013438081805077683
Bond Position:  [5.72151768]


portfolio before change:  [7.09833145]
curr_Stock_Price:  102.34966808690275
curr_Factors:  [102.34966809  -1.11694923  -1.13197547]
mat_Sqrt:  [[10.7991818   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00586483 0.01249113 0.0627744 ]
Stock Position:  0.0058648285286993455
Bond Position:  [6.4980682]


portfolio before change:  [7.09831876]
curr_Stock_Price:  102.07047620673553
curr_Factors:  [102.07047621  -0.83369937  -1.14159352]
mat_Sqrt:  [[14.15928551  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00537284 -0.0124839   0.07933395]
Stock Position:  0.005372839604670224
Bond Position:  [6.54991046]


portfolio before change:  [7.10470615]
curr_Stock_Price:  102.95449766895966
curr_Factors:  [102.95449767  -1.06675508  -1.16794721]
mat_Sqrt:  [[11.01860083  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00040899 -0.01685041  0.11182987]
Stock Position:  0.00040899398298919635
Bond Position:  [7.06259838]


portfolio before change:  [7.1059729]
curr_Stock_Price:  101.7341442382203
curr_Factors:  [101.73414424  -0.90003003  -1.13042531]
mat_Sqrt:  [[13.35522427  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01127543 -0.19444344 -1.37813983]
Stock Position:  -0.011275426939065638
Bond Position:  [8.25306881]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [7.1197255]
Stock Price:  100.69745817646103
PL:  [6.42226733]
Settle:  Tensor("sub_334:0", shape=(), dtype=float64)
PL:  Tensor("sub_335:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  168
output_Z_Vals[:, i, :]:  [[ 1.19271183e+02 -4.92738716e+01 -4.92570741e+01]
 [ 4.01127613e-02  7.33385590e-02 -3.58317151e-02]
 [-2.21623377e+00 -2.98378053e+00 -8.49971302e-01]
 [ 8.67290669e-02  1.98831286e-01 -4.95498835e-02]
 [ 3.52421649e-01  7.05277674e-02 -3.51904763e-01]
 [-1.42876239e-01 -2.41104654e-01  5.17440018e-03]
 [-2.32750544e-02  3.65445317e-02 -5.63864808e-02]
 [ 3.83024396e-02  8.79039616e-02 -3.63400487e-03]
 [ 4.91700659e-02 -2.05998412e-02 -1.83661881e-02]
 [-9.86366190e-01 -4.02175439e-01 -3.42815396e-02]
 [ 1.48327905e-01 -1.12012633e-02 -1.50203819e-01]
 [ 2.32382461e-02 -7.10955658e-02  3.69877085e-02]
 [-6.08622855e-01 -1.23592762e+00  2.16112092e-01]
 [ 2.28249919e-02  3.79553376e-02  9.07813555e-02]
 [ 1.04215993e-01  1.27167897e-01 -1.04903178e-01]
 [ 2.44689745e-02  4.36470459e-02  8.25835109e-02]
 [ 1.25539909e-01  1.15578973e-01  1.03380930e-01]
 [ 1.10440411e-01 -1.22635054e-02 -1.84268574e-02]
 [-5.24382053e-02 -1.36628789e-01  1.01222237e-02]
 [ 5.11461686e-02 -3.89133221e-01 -4.16898784e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.27118322 -49.27387164 -49.25707411]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [   7.3268874   -15.90307369 -140.51672192]
init_Out:  [2.48374395]
Stock Position:  7.326887399052493
Bond position:  [-730.20499595]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-1.31975666]
curr_Stock_Price:  99.50580289458742
curr_Factors:  [99.50580289 -0.90735577 -1.00067844]
mat_Sqrt:  [[14.76385186  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00323553  0.02366992 -0.10221791]
Stock Position:  0.003235525134848883
Bond Position:  [-1.64171019]


portfolio before change:  [-1.31789653]
curr_Stock_Price:  100.20757841219108
curr_Factors:  [100.20757841  -0.98778206  -0.99432746]
mat_Sqrt:  [[13.80642832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.21720281 -0.96301102 -2.42473154]
Stock Position:  -0.21720281390799664
Bond Position:  [20.44747148]


portfolio before change:  [-1.20754069]
curr_Stock_Price:  99.72303894475574
curr_Factors:  [99.72303894 -1.32730347 -1.00457725]
mat_Sqrt:  [[ 9.68439676  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01210205  0.06417252 -0.14135203]
Stock Position:  0.01210204501674403
Bond Position:  [-2.41439339]


portfolio before change:  [-1.20150311]
curr_Stock_Price:  100.27181009011844
curr_Factors:  [100.27181009  -1.4386856   -1.00656213]
mat_Sqrt:  [[ 8.69403249  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.03392969  0.02276274 -1.00388634]
Stock Position:  0.03392968808836146
Bond Position:  [-4.60369435]


portfolio before change:  [-1.23068002]
curr_Stock_Price:  99.44581245507416
curr_Factors:  [99.44581246 -1.4988912  -0.97489603]
mat_Sqrt:  [[ 8.37981357  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02279708 -0.07781619  0.01476112]
Stock Position:  -0.02279708241626748
Bond Position:  [1.03639437]


portfolio before change:  [-1.21803187]
curr_Stock_Price:  98.90236497299249
curr_Factors:  [98.90236497 -1.46514595 -0.97893119]
mat_Sqrt:  [[ 8.58533924  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00318278  0.0117947  -0.16085493]
Stock Position:  -0.003182783407342833
Bond Position:  [-0.90324706]


portfolio before change:  [-1.21882639]
curr_Stock_Price:  99.08103947104249
curr_Factors:  [99.08103947 -1.3706621  -0.99390232]
mat_Sqrt:  [[ 9.31264985  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00596006  0.02837088 -0.0103668 ]
Stock Position:  0.0059600622206508694
Bond Position:  [-1.80935555]


portfolio before change:  [-1.22097563]
curr_Stock_Price:  98.7963376403607
curr_Factors:  [98.79633764 -1.19581826 -1.02129729]
mat_Sqrt:  [[10.76117747  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00383008 -0.00664857 -0.05239362]
Stock Position:  0.003830078869430043
Bond Position:  [-1.59937339]


portfolio before change:  [-1.2185726]
curr_Stock_Price:  99.52815638586603
curr_Factors:  [99.52815639 -1.07399137 -1.02907128]
mat_Sqrt:  [[12.15059252  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.08851071 -0.12980156 -0.09779569]
Stock Position:  -0.08851071218818396
Bond Position:  [7.59073541]


portfolio before change:  [-1.17617824]
curr_Stock_Price:  99.0706248743061
curr_Factors:  [99.07062487 -0.90194027 -1.03590497]
mat_Sqrt:  [[14.26755008  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00808697 -0.00361519 -0.42848969]
Stock Position:  0.008086968679154804
Bond Position:  [-1.97735928]


portfolio before change:  [-1.17343682]
curr_Stock_Price:  99.47075269123275
curr_Factors:  [99.47075269 -0.89596431 -1.05013156]
mat_Sqrt:  [[14.20746869  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0011456  -0.022946    0.10551564]
Stock Position:  0.0011455952644333618
Bond Position:  [-1.28739004]


portfolio before change:  [-1.17349407]
curr_Stock_Price:  99.70175248513003
curr_Factors:  [99.70175249 -0.91957077 -1.06943433]
mat_Sqrt:  [[13.64233942  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.05987183 -0.39889392  0.61650764]
Stock Position:  -0.05987183012121615
Bond Position:  [4.79583232]


portfolio before change:  [-1.17232004]
curr_Stock_Price:  99.70217136024979
curr_Factors:  [99.70217136 -0.76196699 -1.02974162]
mat_Sqrt:  [[16.61787362  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00295485 0.01225003 0.25897394]
Stock Position:  0.002954846117624547
Bond Position:  [-1.46692462]


portfolio before change:  [-1.17154341]
curr_Stock_Price:  100.08913130615066
curr_Factors:  [100.08913131  -0.81460098  -1.0248955 ]
mat_Sqrt:  [[15.90390416  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00683862  0.04104326 -0.29925957]
Stock Position:  0.006838620135615405
Bond Position:  [-1.85601496]


portfolio before change:  [-1.17023032]
curr_Stock_Price:  100.34900128634226
curr_Factors:  [100.34900129  -0.96837116  -1.01840968]
mat_Sqrt:  [[13.76147856  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00365046 0.01408702 0.23558777]
Stock Position:  0.0036504565129498825
Bond Position:  [-1.53654999]


portfolio before change:  [-1.17207692]
curr_Stock_Price:  99.94839083214752
curr_Factors:  [99.94839083 -0.76299043 -1.05389214]
mat_Sqrt:  [[16.24477629  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01047936 0.03730295 0.29491702]
Stock Position:  0.01047936330238996
Bond Position:  [-2.21947242]


portfolio before change:  [-1.17882094]
curr_Stock_Price:  99.35779309955191
curr_Factors:  [99.3577931  -0.98216605 -1.00682966]
mat_Sqrt:  [[13.59540258  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00766257 -0.00395803 -0.0525667 ]
Stock Position:  0.007662573126555892
Bond Position:  [-1.9401573]


portfolio before change:  [-1.18784832]
curr_Stock_Price:  98.24298818502147
curr_Factors:  [98.24298819 -0.84605206 -1.0016463 ]
mat_Sqrt:  [[15.48304445  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00505464 -0.04409675  0.02887589]
Stock Position:  -0.005054642200557983
Bond Position:  [-0.69126516]


portfolio before change:  [-1.18403802]
curr_Stock_Price:  97.45497191532291
curr_Factors:  [97.45497192 -0.38592613 -0.97739578]
mat_Sqrt:  [[24.92991604  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00454813 -0.12559221 -1.18929619]
Stock Position:  -0.004548127046301896
Bond Position:  [-0.74080042]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-1.18414385]
Stock Price:  97.43751689792519
PL:  [-1.18414385]
Settle:  Tensor("sub_336:0", shape=(), dtype=float64)
PL:  Tensor("sub_337:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  169
output_Z_Vals[:, i, :]:  [[ 1.19271183e+02 -4.92738716e+01 -4.92570741e+01]
 [-3.92050606e-03 -7.99025129e-03 -6.59796801e-02]
 [-2.19364267e+00 -2.95365472e+00 -8.41256464e-01]
 [-7.61041255e-01 -7.45939584e-01  5.36500460e-01]
 [ 9.28938448e-01  2.38653019e-01 -7.42279675e-01]
 [ 7.91943271e-02  1.49360027e-01  1.27566244e-02]
 [ 1.00325916e-01 -1.69586866e-01 -1.02303386e-01]
 [-9.93178520e-02  1.20966425e-01  3.20759086e-01]
 [-9.54848025e-02 -3.97283210e-01  1.03705865e-01]
 [-1.64309137e+00 -6.44833008e-01 -6.67243056e-02]
 [ 3.90910045e-02 -1.24865474e-01  1.29761017e-02]
 [-1.69439550e-01  1.07149290e-01  2.16375345e-02]
 [-7.70250670e-01 -9.05467756e-01  2.71518819e-01]
 [-4.43086008e-02 -6.48344697e-02  6.11595477e-02]
 [-2.10274170e-01 -2.83068519e-01  1.13416443e-01]
 [ 1.29151228e-01  1.54705389e-02  3.30206620e-02]
 [-4.27919466e-01 -4.30254019e-01 -4.44618381e-01]
 [-2.96837624e-01 -3.70225037e-01  6.08915959e-01]
 [ 4.76330182e-02  8.58554396e-03  3.68230887e-02]
 [-3.77768018e-05 -2.76752539e-01  2.22463405e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.27118322 -49.27387164 -49.25707411]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [   7.3268874   -15.90307369 -140.51672192]
init_Out:  [2.48374395]
Stock Position:  7.326887399052493
Bond position:  [-730.20499595]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [13.9083876]
curr_Stock_Price:  101.58419490919117
curr_Factors:  [101.58419491  -1.19647969  -0.98905647]
mat_Sqrt:  [[11.41983549  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00166548 -0.00257884 -0.18822166]
Stock Position:  -0.0016654841552095874
Bond Position:  [14.07757447]


portfolio before change:  [13.90975392]
curr_Stock_Price:  102.87721884358537
curr_Factors:  [102.87721884  -0.85902657  -1.00589018]
mat_Sqrt:  [[15.93661802  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.18625506 -0.95328796 -2.39987053]
Stock Position:  -0.18625505535939085
Bond Position:  [33.07115601]


portfolio before change:  [13.60368401]
curr_Stock_Price:  104.56489777861063
curr_Factors:  [104.56489778  -1.20323845  -1.03562911]
mat_Sqrt:  [[11.14443581  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.07212504 -0.24075097  1.53048648]
Stock Position:  -0.07212503627440789
Bond Position:  [21.14543106]


portfolio before change:  [13.6166272]
curr_Stock_Price:  104.45874649434126
curr_Factors:  [104.45874649  -1.04282128  -1.00735744]
mat_Sqrt:  [[13.44508363  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.06144522  0.07702493 -2.1175173 ]
Stock Position:  0.061445217457578076
Bond Position:  [7.1981368]


portfolio before change:  [13.61249062]
curr_Stock_Price:  104.3621347307974
curr_Factors:  [104.36213473  -0.82398957  -1.00138222]
mat_Sqrt:  [[16.81876333  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00667625 0.04820574 0.0363911 ]
Stock Position:  0.006676248889285369
Bond Position:  [12.91574304]


portfolio before change:  [13.6222985]
curr_Stock_Price:  105.34749929193771
curr_Factors:  [105.34749929  -0.71719832  -0.98652941]
mat_Sqrt:  [[19.17364496  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00233793 -0.05473393 -0.29184308]
Stock Position:  0.0023379253410102377
Bond Position:  [13.37600391]


portfolio before change:  [13.62814345]
curr_Stock_Price:  106.41704812391802
curr_Factors:  [106.41704812  -0.82578842  -0.97856019]
mat_Sqrt:  [[17.514291    0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-5.22488155e-04  3.90417458e-02  9.15036390e-01]
Stock Position:  -0.0005224881553271409
Bond Position:  [13.68374509]


portfolio before change:  [13.6315408]
curr_Stock_Price:  106.46300120024806
curr_Factors:  [106.4630012   -0.72475071  -0.98146064]
mat_Sqrt:  [[19.32860579  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00804047 -0.1282226   0.29584397]
Stock Position:  -0.008040467518774887
Bond Position:  [14.4875531]


portfolio before change:  [13.63864386]
curr_Stock_Price:  106.03010067967391
curr_Factors:  [106.03010068  -0.45287495  -0.9607318 ]
mat_Sqrt:  [[25.79333893  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0693333  -0.20811896 -0.19034587]
Stock Position:  -0.06933330365108073
Bond Position:  [20.99006103]


portfolio before change:  [13.52320974]
curr_Stock_Price:  107.77071150537735
curr_Factors:  [107.77071151  -0.34122261  -0.93395605]
mat_Sqrt:  [[30.10909452  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00053976 -0.04030016  0.03701721]
Stock Position:  0.0005397599062570388
Bond Position:  [13.46503943]


portfolio before change:  [13.52591578]
curr_Stock_Price:  106.54676736355056
curr_Factors:  [106.54676736  -0.19834065  -0.92192866]
mat_Sqrt:  [[34.75469648  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0041189   0.03458228  0.06172586]
Stock Position:  -0.004118897977187054
Bond Position:  [13.96477105]


portfolio before change:  [13.53913979]
curr_Stock_Price:  104.18390657115462
curr_Factors:  [104.18390657  -0.11913415  -0.91194938]
mat_Sqrt:  [[37.15410022  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02421415 -0.29223846  0.77456761]
Stock Position:  -0.024214149974156295
Bond Position:  [16.06186453]


portfolio before change:  [13.40266698]
curr_Stock_Price:  109.98583572486861
curr_Factors:  [109.98583572  -0.30880913  -0.95239171]
mat_Sqrt:  [[31.16048381  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00144602 -0.02092524  0.17447117]
Stock Position:  -0.0014460218698010862
Bond Position:  [13.5617089]


portfolio before change:  [13.40209067]
curr_Stock_Price:  112.72933575029667
curr_Factors:  [112.72933575  -0.30163833  -0.9681883 ]
mat_Sqrt:  [[31.66345128  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0077346  -0.09135997  0.32354554]
Stock Position:  -0.007734603948479046
Bond Position:  [14.27400743]


portfolio before change:  [13.41270501]
curr_Stock_Price:  111.81844329934363
curr_Factors:  [111.8184433    0.24733425  -0.922141  ]
mat_Sqrt:  [[56.94408191  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00244186 0.00499309 0.09419876]
Stock Position:  0.0024418595915796275
Bond Position:  [13.13966007]


portfolio before change:  [13.42832106]
curr_Stock_Price:  116.86817277222748
curr_Factors:  [116.86817277   0.16817851  -0.96098023]
mat_Sqrt:  [[52.89161686  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01146688 -0.13886389 -1.26837248]
Stock Position:  -0.011466884219414258
Bond Position:  [14.76843487]


portfolio before change:  [13.4478734]
curr_Stock_Price:  115.48508014265435
curr_Factors:  [ 1.15485080e+02  9.00158330e-02 -9.86215178e-01]
mat_Sqrt:  [[47.13152039  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00526431 -0.11948962  1.73706774]
Stock Position:  -0.005264312316941971
Bond Position:  [14.05582293]


portfolio before change:  [13.46525315]
curr_Stock_Price:  112.85124045790319
curr_Factors:  [112.85124046  -0.14511898  -0.96295613]
mat_Sqrt:  [[37.26279547  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00152705 0.00277097 0.10504602]
Stock Position:  0.0015270463702802219
Bond Position:  [13.29292407]


portfolio before change:  [13.47215524]
curr_Stock_Price:  115.19462070989196
curr_Factors:  [115.19462071  -0.19102467  -0.94820087]
mat_Sqrt:  [[36.86997414  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-3.01586865e-04 -8.93214978e-02  6.34626171e-01]
Stock Position:  -0.00030158686487048465
Bond Position:  [13.50689643]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [13.47606852]
Stock Price:  113.41694028698278
PL:  [0.05912823]
Settle:  Tensor("sub_338:0", shape=(), dtype=float64)
PL:  Tensor("sub_339:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  170
output_Z_Vals[:, i, :]:  [[ 1.19271183e+02 -4.92738716e+01 -4.92570741e+01]
 [ 1.24832145e-02  2.89485831e-02 -4.86536030e-02]
 [-2.34685935e+00 -2.99394270e+00 -8.78433390e-01]
 [ 2.10267476e-02  1.10780912e-01 -9.56754178e-02]
 [ 4.11289488e-01 -1.36495909e-01 -1.35187614e-01]
 [-1.38214864e-01 -2.13669890e-01  5.81014901e-03]
 [-6.28583107e-02  1.03222645e-01 -1.25563478e-01]
 [ 8.36927494e-02  1.71490807e-01  4.19830394e-02]
 [-2.07155344e-03  1.59718575e-01 -4.98897582e-02]
 [-8.47266460e-01 -3.44871248e-01 -2.72043142e-02]
 [ 4.05433927e-02 -5.56131627e-02 -3.13340800e-01]
 [ 7.92683269e-02  1.93395039e-02  2.10848713e-02]
 [-6.66285858e-01 -1.12430251e+00  2.26335233e-01]
 [ 1.62334288e-01  7.56154473e-02  1.16608046e-01]
 [ 1.31804136e-01  1.43500295e-01 -1.05415898e-01]
 [-2.88922259e-01  1.50647773e-01  1.12784814e-01]
 [-4.05994915e-02  1.25026358e-01  1.73948202e-01]
 [ 1.15216134e-01 -1.08333916e-02 -3.18137274e-02]
 [-7.16872034e-02 -3.67268076e-01  1.05591751e-01]
 [ 8.20258056e-02 -6.34648349e-01 -6.35942403e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.27118322 -49.27387164 -49.25707411]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [   7.3268874   -15.90307369 -140.51672192]
init_Out:  [2.48374395]
Stock Position:  7.326887399052493
Bond position:  [-730.20499595]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [4.55781508]
curr_Stock_Price:  100.30799507043093
curr_Factors:  [100.30799507  -0.85991131  -1.03639281]
mat_Sqrt:  [[15.05847988  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00056187  0.00934312 -0.13879519]
Stock Position:  0.0005618723944385352
Bond Position:  [4.50145479]


portfolio before change:  [4.55800003]
curr_Stock_Price:  98.6340273424783
curr_Factors:  [98.63402734 -0.84068154 -1.08514958]
mat_Sqrt:  [[14.37635995  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.21822665 -0.96629085 -2.50592595]
Stock Position:  -0.2182266456274666
Bond Position:  [26.08257296]


portfolio before change:  [4.35392319]
curr_Stock_Price:  99.59907128494308
curr_Factors:  [99.59907128 -0.8585991  -1.07733187]
mat_Sqrt:  [[14.37113778  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00167768  0.03575439 -0.27293534]
Stock Position:  0.0016776781426923117
Bond Position:  [4.186828]


portfolio before change:  [4.35211933]
curr_Stock_Price:  97.89988232029445
curr_Factors:  [97.89988232 -0.64629966 -1.05305837]
mat_Sqrt:  [[17.89618053  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01988314 -0.04405387 -0.38565263]
Stock Position:  0.019883143245652154
Bond Position:  [2.40556195]


portfolio before change:  [4.30788143]
curr_Stock_Price:  95.64473763324277
curr_Factors:  [95.64473763 -0.71340455 -1.04557388]
mat_Sqrt:  [[16.47200461  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01096673 -0.06896166  0.01657474]
Stock Position:  -0.010966731756437814
Bond Position:  [5.35679161]


portfolio before change:  [4.29858462]
curr_Stock_Price:  96.61459605353762
curr_Factors:  [96.61459605 -0.89521637 -1.04053749]
mat_Sqrt:  [[13.94297733  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00483531  0.03331497 -0.35819765]
Stock Position:  -0.0048353097427644666
Bond Position:  [4.76574612]


portfolio before change:  [4.29553547]
curr_Stock_Price:  97.49163021796141
curr_Factors:  [97.49163022 -0.99848269 -1.07253214]
mat_Sqrt:  [[12.2895794   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01035576 0.05534842 0.11976593]
Stock Position:  0.010355758461820545
Bond Position:  [3.2859357]


portfolio before change:  [4.28873067]
curr_Stock_Price:  96.75519036117022
curr_Factors:  [96.75519036 -1.01855027 -1.07724637]
mat_Sqrt:  [[11.89820255  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0017101   0.05154895 -0.14232159]
Stock Position:  0.0017101036826522372
Bond Position:  [4.12326926]


portfolio before change:  [4.29104482]
curr_Stock_Price:  97.505559444487
curr_Factors:  [97.50555944 -0.94089486 -1.08339642]
mat_Sqrt:  [[12.87925799  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0716824  -0.11130672 -0.07760634]
Stock Position:  -0.07168239556944057
Bond Position:  [11.28047691]


portfolio before change:  [4.35038173]
curr_Stock_Price:  96.71713100471617
curr_Factors:  [96.717131   -1.06914578 -1.05494096]
mat_Sqrt:  [[11.56176815  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00300724 -0.01794907 -0.89387409]
Stock Position:  -0.0030072406916296754
Bond Position:  [4.64123343]


portfolio before change:  [4.35422622]
curr_Stock_Price:  95.82460679209159
curr_Factors:  [95.82460679 -1.09309153 -1.051539  ]
mat_Sqrt:  [[11.22214404  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00779886 0.0062418  0.06014927]
Stock Position:  0.007798858899989071
Bond Position:  [3.60690364]


portfolio before change:  [4.35903452]
curr_Stock_Price:  96.325508740463
curr_Factors:  [96.32550874 -0.81031894 -1.05281369]
mat_Sqrt:  [[14.94834428  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.05683457 -0.36286708  0.64567142]
Stock Position:  -0.056834566114209145
Bond Position:  [9.83365302]


portfolio before change:  [4.43409706]
curr_Stock_Price:  95.04804994713251
curr_Factors:  [95.04804995 -0.55698818 -1.09669216]
mat_Sqrt:  [[18.18691184  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01108334 0.02440478 0.3326503 ]
Stock Position:  0.01108334093869559
Bond Position:  [3.38064712]


portfolio before change:  [4.41681779]
curr_Stock_Price:  93.41275393013
curr_Factors:  [93.41275393 -0.54141423 -1.07243439]
mat_Sqrt:  [[18.60032901  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00750407  0.04631452 -0.30072222]
Stock Position:  0.007504065164490546
Bond Position:  [3.71584239]


portfolio before change:  [4.4230397]
curr_Stock_Price:  94.11808275318405
curr_Factors:  [94.11808275 -0.81552585 -1.07043023]
mat_Sqrt:  [[14.2762043   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01647142  0.04862136  0.32174368]
Stock Position:  -0.016471416483620435
Bond Position:  [5.97329784]


portfolio before change:  [4.42865388]
curr_Stock_Price:  93.86791157761387
curr_Factors:  [93.86791158 -0.90444435 -1.06127788]
mat_Sqrt:  [[13.14664204  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00155389 0.04035208 0.4962258 ]
Stock Position:  0.0015538899539448462
Bond Position:  [4.28279348]


portfolio before change:  [4.42968558]
curr_Stock_Price:  93.8427251800591
curr_Factors:  [93.84272518 -1.14815989 -1.04787984]
mat_Sqrt:  [[10.43933117  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01020284 -0.00349646 -0.09075571]
Stock Position:  0.010202840194624595
Bond Position:  [3.47222325]


portfolio before change:  [4.42737896]
curr_Stock_Price:  93.5315590633377
curr_Factors:  [93.53155906 -0.94110221 -1.05608257]
mat_Sqrt:  [[12.69380565  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00985533 -0.11853526  0.30122387]
Stock Position:  -0.00985533125545674
Bond Position:  [5.34916346]


portfolio before change:  [4.42798391]
curr_Stock_Price:  93.6058852237145
curr_Factors:  [93.60588522 -1.18308652 -1.09222324]
mat_Sqrt:  [[ 9.61941548  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01843485 -0.20483187 -1.81416666]
Stock Position:  -0.018434846261646085
Bond Position:  [6.15359401]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [4.42904388]
Stock Price:  93.63184799088116
PL:  [4.42904388]
Settle:  Tensor("sub_340:0", shape=(), dtype=float64)
PL:  Tensor("sub_341:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  171
output_Z_Vals[:, i, :]:  [[ 1.19271183e+02 -4.92738716e+01 -4.92570741e+01]
 [ 9.69023250e-02  1.55098092e-01 -4.27112634e-02]
 [-2.41721088e+00 -3.25976413e+00 -9.30135643e-01]
 [ 9.27999563e-02  2.24250172e-01 -5.13031010e-02]
 [ 9.55057532e-01 -1.95669145e-01 -3.78966254e-01]
 [-1.45656304e-01 -2.54847461e-01  4.19023695e-02]
 [-5.60152765e-02  1.06163339e-01 -8.23362446e-02]
 [ 8.64846256e-02  1.99644004e-01  6.96818652e-02]
 [-5.67265431e-02  3.07271702e-01 -8.66778169e-02]
 [-9.27894787e-01 -3.80095641e-01 -3.12638936e-02]
 [ 9.11092557e-02 -2.25132242e-02 -2.33588237e-01]
 [ 8.16270978e-02  2.07286679e-02  2.09234437e-02]
 [-7.07838458e-01 -1.10226971e+00  2.38093593e-01]
 [ 1.40803399e-01  7.44478375e-02  1.16710065e-01]
 [ 1.24522689e-01  1.30920640e-01 -1.04875466e-01]
 [-2.35705786e-01  1.24600264e-01  1.33931956e-01]
 [ 4.41597824e-02  1.17380644e-01  1.30674894e-01]
 [ 1.14906247e-01 -1.09252759e-02 -3.09063853e-02]
 [-6.44720096e-02 -2.65068569e-01  6.06080967e-02]
 [ 5.32530316e-02 -3.99829397e-01 -4.31785240e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.27118322 -49.27387164 -49.25707411]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [   7.3268874   -15.90307369 -140.51672192]
init_Out:  [2.48374395]
Stock Position:  7.326887399052493
Bond position:  [-730.20499595]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-8.47418769]
curr_Stock_Price:  98.52934036244594
curr_Factors:  [98.52934036 -0.77435615 -1.00161426]
mat_Sqrt:  [[16.68289538  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0071836   0.05005769 -0.12184335]
Stock Position:  0.0071835965816301394
Bond Position:  [-9.18198272]


portfolio before change:  [-8.46903389]
curr_Stock_Price:  99.5663659023975
curr_Factors:  [99.5663659  -0.69007202 -0.9748403 ]
mat_Sqrt:  [[18.83867785  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.1737102  -1.05208435 -2.65341809]
Stock Position:  -0.17371020467347803
Bond Position:  [8.8266599]


portfolio before change:  [-8.58693707]
curr_Stock_Price:  100.25780552400794
curr_Factors:  [100.25780552  -0.67915176  -0.91787478]
mat_Sqrt:  [[20.30197934  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00630986  0.07237643 -0.14635347]
Stock Position:  0.00630985911953194
Bond Position:  [-9.2195497]


portfolio before change:  [-8.59665815]
curr_Stock_Price:  99.08251699599468
curr_Factors:  [99.082517   -0.30958667 -0.94189886]
mat_Sqrt:  [[28.34547719  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.02955535 -0.06315194 -1.08108524]
Stock Position:  0.02955535256815411
Bond Position:  [-11.52507688]


portfolio before change:  [-8.68354041]
curr_Stock_Price:  96.24037086232339
curr_Factors:  [96.24037086 -0.49710911 -0.97239174]
mat_Sqrt:  [[22.13916205  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00854249 -0.08225166  0.1195358 ]
Stock Position:  -0.008542488555340413
Bond Position:  [-7.86140815]


portfolio before change:  [-8.68527647]
curr_Stock_Price:  96.21350009956736
curr_Factors:  [96.2135001  -0.40516406 -0.97794617]
mat_Sqrt:  [[24.13008602  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00211983  0.03426407 -0.23488239]
Stock Position:  -0.0021198263088642233
Bond Position:  [-8.48132056]


portfolio before change:  [-8.68617359]
curr_Stock_Price:  95.63634192381046
curr_Factors:  [95.63634192 -0.67613506 -1.00948118]
mat_Sqrt:  [[17.72430132  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00798116 0.06443483 0.19878297]
Stock Position:  0.00798116302718791
Bond Position:  [-9.44946282]


portfolio before change:  [-8.68416693]
curr_Stock_Price:  96.18379561263107
curr_Factors:  [96.18379561 -0.75280031 -1.03061396]
mat_Sqrt:  [[16.16497132  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00072366  0.09917152 -0.24726769]
Stock Position:  -0.0007236638150125144
Bond Position:  [-8.6145622]


portfolio before change:  [-8.68791261]
curr_Stock_Price:  98.38339616022101
curr_Factors:  [98.38339616 -0.69462401 -1.028101  ]
mat_Sqrt:  [[17.56919426  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.05759303 -0.12267534 -0.08918719]
Stock Position:  -0.05759303385719708
Bond Position:  [-3.02171435]


portfolio before change:  [-8.64826941]
curr_Stock_Price:  97.68194456930752
curr_Factors:  [97.68194457 -0.57360796 -0.98941283]
mat_Sqrt:  [[20.46458737  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00189756 -0.00726611 -0.66636222]
Stock Position:  0.0018975590982967202
Bond Position:  [-8.83362667]


portfolio before change:  [-8.65372416]
curr_Stock_Price:  95.97128874998258
curr_Factors:  [95.97128875 -0.75038379 -0.96347729]
mat_Sqrt:  [[17.29103218  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00521249 0.00669015 0.05968876]
Stock Position:  0.005212488099875092
Bond Position:  [-9.15397336]


portfolio before change:  [-8.65658249]
curr_Stock_Price:  95.8620236747473
curr_Factors:  [95.86202367 -1.04054956 -0.97660945]
mat_Sqrt:  [[12.75280049  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.06933674 -0.35575602  0.67921475]
Stock Position:  -0.0693367444158615
Bond Position:  [-2.00982185]


portfolio before change:  [-8.61874072]
curr_Stock_Price:  95.30900835856018
curr_Factors:  [95.30900836 -0.86465864 -0.98092014]
mat_Sqrt:  [[15.0525219   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01194639 0.02402794 0.33294133]
Stock Position:  0.011946393042899845
Bond Position:  [-9.7573396]


portfolio before change:  [-8.60800611]
curr_Stock_Price:  96.4117889396312
curr_Factors:  [96.41178894 -1.1409017  -0.96748581]
mat_Sqrt:  [[11.70763249  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01109013  0.04225445 -0.29918051]
Stock Position:  0.01109012758512443
Bond Position:  [-9.67722515]


portfolio before change:  [-8.61601732]
curr_Stock_Price:  95.90759253062012
curr_Factors:  [95.90759253 -1.2261724  -0.97310446]
mat_Sqrt:  [[10.63455162  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01720177  0.04021456  0.38207059]
Stock Position:  -0.017201770632602136
Bond Position:  [-6.96623691]


portfolio before change:  [-8.62712009]
curr_Stock_Price:  96.45178030368936
curr_Factors:  [96.4517803  -0.87168801 -0.96734086]
mat_Sqrt:  [[15.33310682  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.0061823  0.03788444 0.3727791 ]
Stock Position:  0.006182302663538868
Bond Position:  [-9.22341419]


portfolio before change:  [-8.63672782]
curr_Stock_Price:  95.27073412270815
curr_Factors:  [95.27073412 -0.69912032 -0.99330289]
mat_Sqrt:  [[17.53676369  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00606539 -0.00352612 -0.08816731]
Stock Position:  0.006065394764508711
Bond Position:  [-9.21458243]


portfolio before change:  [-8.63898613]
curr_Stock_Price:  95.2782565524693
curr_Factors:  [95.27825655 -0.57661539 -0.96807675]
mat_Sqrt:  [[20.3302411   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00522411 -0.08555051  0.17289803]
Stock Position:  -0.0052241057152719855
Bond Position:  [-8.14124244]


portfolio before change:  [-8.64567209]
curr_Stock_Price:  96.1684370035667
curr_Factors:  [96.168437   -0.46965152 -0.94798973]
mat_Sqrt:  [[23.30015383  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00499995 -0.12904438 -1.2317631 ]
Stock Position:  -0.004999949614666046
Bond Position:  [-8.16483475]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-8.64074734]
Stock Price:  94.7751798989813
PL:  [-8.64074734]
Settle:  Tensor("sub_342:0", shape=(), dtype=float64)
PL:  Tensor("sub_343:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  172
output_Z_Vals[:, i, :]:  [[ 1.19271183e+02 -4.92738716e+01 -4.92570741e+01]
 [ 4.74739826e-02  8.51651893e-02 -3.24156346e-02]
 [-2.45564031e+00 -2.74012118e+00 -8.33161646e-01]
 [-3.82914981e-02 -2.64402101e-02 -1.29030333e-01]
 [ 4.90055306e-01 -4.09431691e-02 -3.22647643e-01]
 [-1.24375086e-01 -1.82387273e-01  4.82248805e-02]
 [-6.59962558e-03  2.87287478e-02  2.21769662e-02]
 [ 9.30561755e-02  2.27710861e-01  9.65010589e-02]
 [ 5.08835480e-04 -1.58621658e-01  1.36561967e-02]
 [-1.15253348e+00 -4.72469473e-01 -4.26968386e-02]
 [ 3.62969361e-01  3.93922556e-02 -4.26648508e-02]
 [ 1.67135733e-02 -7.30237081e-02  3.68607970e-02]
 [-6.10871154e-01 -1.16795987e+00  2.17826905e-01]
 [ 1.13808200e-02  2.78330667e-02  6.86130488e-02]
 [-1.49930657e-01 -1.78637463e-01  5.55784081e-02]
 [ 8.91544427e-02  2.62361621e-02  5.19575357e-02]
 [ 1.10729800e-02 -3.43342019e-04 -1.68463558e-02]
 [-9.07110254e-02 -1.79916077e-01  3.13735466e-01]
 [ 4.94201076e-02  3.67441118e-02  3.35627540e-02]
 [ 2.79962362e-02 -3.56312794e-01 -2.07235143e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.27118322 -49.27387164 -49.25707411]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [   7.3268874   -15.90307369 -140.51672192]
init_Out:  [2.48374395]
Stock Position:  7.326887399052493
Bond position:  [-730.20499595]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-3.05221147]
curr_Stock_Price:  99.26935121878331
curr_Factors:  [99.26935122 -0.92864016 -1.0172161 ]
mat_Sqrt:  [[14.18210007  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00410669  0.02748695 -0.09247278]
Stock Position:  0.0041066866052747895
Bond Position:  [-3.45987958]


portfolio before change:  [-3.05641343]
curr_Stock_Price:  98.45680306997572
curr_Factors:  [98.45680307 -1.13882584 -0.97248766]
mat_Sqrt:  [[11.92103399  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.26717763 -0.88437031 -2.37677827]
Stock Position:  -0.26717763061637256
Bond Position:  [23.24904194]


portfolio before change:  [-2.97848754]
curr_Stock_Price:  98.18689688374978
curr_Factors:  [98.18689688 -1.20215618 -0.92499853]
mat_Sqrt:  [[11.70151204  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00598442 -0.00853354 -0.36808763]
Stock Position:  -0.0059844223213089305
Bond Position:  [-2.39089569]


portfolio before change:  [-2.98828677]
curr_Stock_Price:  99.72446083582581
curr_Factors:  [99.72446084 -1.2940798  -0.94693435]
mat_Sqrt:  [[10.6057556   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.03920868 -0.01321435 -0.92042392]
Stock Position:  0.039208676697825275
Bond Position:  [-6.89835092]


portfolio before change:  [-2.98044429]
curr_Stock_Price:  99.96847029199193
curr_Factors:  [99.96847029 -1.38168729 -0.97220775]
mat_Sqrt:  [[ 9.4968465   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01598013 -0.05886524  0.13757216]
Stock Position:  -0.015980132911162705
Bond Position:  [-1.38293485]


portfolio before change:  [-2.96951153]
curr_Stock_Price:  99.26268520028846
curr_Factors:  [99.2626852  -1.01601688 -0.91129108]
mat_Sqrt:  [[14.44663861  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00026245 0.00927216 0.06326471]
Stock Position:  0.00026244580968886856
Bond Position:  [-2.9955626]


portfolio before change:  [-2.97025519]
curr_Stock_Price:  99.28294862258703
curr_Factors:  [99.28294862 -0.83377662 -0.94600388]
mat_Sqrt:  [[16.74656806  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00950855 0.07349336 0.27529066]
Stock Position:  0.009508554594462919
Bond Position:  [-3.91429253]


portfolio before change:  [-2.94344587]
curr_Stock_Price:  102.20537179734566
curr_Factors:  [102.2053718   -0.95209027  -0.94677745]
mat_Sqrt:  [[15.30403502  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00190029 -0.05119492  0.03895733]
Stock Position:  -0.0019002906955269336
Bond Position:  [-2.74922595]


portfolio before change:  [-2.94290669]
curr_Stock_Price:  101.55990684259088
curr_Factors:  [101.55990684  -0.89780148  -0.96058418]
mat_Sqrt:  [[15.83564131  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.07942156 -0.15248887 -0.1218022 ]
Stock Position:  -0.0794215615110612
Bond Position:  [5.1231397]


portfolio before change:  [-2.86732379]
curr_Stock_Price:  100.62436807766231
curr_Factors:  [100.62436808  -0.57833159  -0.9839398 ]
mat_Sqrt:  [[21.09683587  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01717326  0.0127138  -0.12171094]
Stock Position:  0.01717325514385356
Bond Position:  [-4.59537174]


portfolio before change:  [-2.88074581]
curr_Stock_Price:  99.90970847493989
curr_Factors:  [99.90970847 -0.63638756 -0.95221406]
mat_Sqrt:  [[20.40265925  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00045738 -0.0235683   0.10515359]
Stock Position:  0.00045738400355090525
Bond Position:  [-2.92644292]


portfolio before change:  [-2.88123626]
curr_Stock_Price:  100.43718281498111
curr_Factors:  [100.43718281  -0.6084841   -0.96060191]
mat_Sqrt:  [[20.91457901  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.03848111 -0.37695743  0.62139953]
Stock Position:  -0.038481110864307375
Bond Position:  [0.98369811]


portfolio before change:  [-2.8864016]
curr_Stock_Price:  100.57780504264447
curr_Factors:  [100.57780504  -0.3927795   -0.9850309 ]
mat_Sqrt:  [[25.35868336  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00122513 0.00898308 0.19573393]
Stock Position:  0.0012251346181835895
Bond Position:  [-3.00962295]


portfolio before change:  [-2.88237624]
curr_Stock_Price:  104.47766757612911
curr_Factors:  [104.47766758  -0.48933882  -0.97608668]
mat_Sqrt:  [[24.13221914  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00725379 -0.05765499  0.15854973]
Stock Position:  -0.007253787163074355
Bond Position:  [-2.12451748]


portfolio before change:  [-2.88596034]
curr_Stock_Price:  104.89853725093077
curr_Factors:  [104.89853725  -0.69291806  -0.98137547]
mat_Sqrt:  [[19.66224002  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00534607 0.00846768 0.14822039]
Stock Position:  0.005346067607582064
Bond Position:  [-3.44675501]


portfolio before change:  [-2.88982003]
curr_Stock_Price:  104.3377700436169
curr_Factors:  [104.33777004  -0.35818788  -0.96800647]
mat_Sqrt:  [[27.7001845   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00027307 -0.00011081 -0.04805796]
Stock Position:  0.00027307210170533883
Bond Position:  [-2.91831177]


portfolio before change:  [-2.88983065]
curr_Stock_Price:  106.9709788273156
curr_Factors:  [106.97097883  -0.47323289  -0.98454149]
mat_Sqrt:  [[24.89789325  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00254621 -0.05806766  0.89499996]
Stock Position:  -0.0025462096845794147
Bond Position:  [-2.61746011]


portfolio before change:  [-2.88504721]
curr_Stock_Price:  104.83530237301062
curr_Factors:  [104.83530237  -0.29518083  -0.95293839]
mat_Sqrt:  [[30.09236084  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00211919 0.01185911 0.09574519]
Stock Position:  0.002119190210761265
Bond Position:  [-3.10721316]


portfolio before change:  [-2.88580496]
curr_Stock_Price:  104.84434263732437
curr_Factors:  [104.84434264  -0.18544517  -0.94219171]
mat_Sqrt:  [[33.94833892  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00256382 -0.11499946 -0.59118418]
Stock Position:  -0.0025638221913475696
Bond Position:  [-2.6170027]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-2.88533793]
Stock Price:  104.40696503432713
PL:  [-7.29230297]
Settle:  Tensor("sub_344:0", shape=(), dtype=float64)
PL:  Tensor("sub_345:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  173
output_Z_Vals[:, i, :]:  [[ 1.19271183e+02 -4.92738716e+01 -4.92570741e+01]
 [ 1.92564649e-02  3.98305720e-02 -4.55103789e-02]
 [-2.13178524e+00 -2.87116625e+00 -8.17394075e-01]
 [-1.00375680e-01  9.00878816e-02  6.69735596e-02]
 [ 8.66548358e-01  1.51357081e-01 -6.43249152e-01]
 [ 7.68125429e-02  1.27323879e-01 -5.99066188e-04]
 [ 1.31673884e-01 -2.70696408e-01 -2.89262774e-01]
 [-9.39957549e-02  1.11463731e-01  2.96307638e-01]
 [-1.26214932e-01 -4.64974365e-01  1.39498932e-01]
 [-1.86233610e+00 -6.57353230e-01 -7.92688443e-02]
 [ 3.00692885e-01 -7.66920302e-02  2.51545812e-02]
 [-6.48470168e-02  6.58690402e-02  2.66565738e-02]
 [-9.46038549e-01 -1.24143184e+00  3.45868042e-01]
 [ 3.08068861e-02 -4.60647779e-02 -1.22287410e-02]
 [-7.45540805e-02 -4.81900467e-02 -1.66685127e-02]
 [ 6.91723108e-02  1.91800830e-03  1.11243432e-02]
 [-1.45091735e-01 -1.53277360e-01 -1.69019582e-01]
 [-8.61894182e-02 -1.83465902e-01  2.84979611e-01]
 [ 6.65186907e-02 -1.39445072e-01  1.41201512e-01]
 [ 1.01402906e-01 -8.81348928e-01 -2.74607414e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.27118322 -49.27387164 -49.25707411]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [   7.3268874   -15.90307369 -140.51672192]
init_Out:  [2.48374395]
Stock Position:  7.326887399052493
Bond position:  [-730.20499595]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [3.95431943]
curr_Stock_Price:  100.22562780838318
curr_Factors:  [100.22562781  -0.93146345  -1.00779308]
mat_Sqrt:  [[14.41353059  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00125556  0.01285526 -0.12982844]
Stock Position:  0.001255561852524018
Bond Position:  [3.82847995]


portfolio before change:  [3.95672925]
curr_Stock_Price:  101.3825441602799
curr_Factors:  [101.38254416  -1.03473294  -1.02515117]
mat_Sqrt:  [[12.92310536  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.22322107 -0.92666492 -2.33179778]
Stock Position:  -0.2232210741340753
Bond Position:  [26.58744965]


portfolio before change:  [3.87892609]
curr_Stock_Price:  101.76087246858123
curr_Factors:  [101.76087247  -0.98975313  -1.0235937 ]
mat_Sqrt:  [[13.58924736  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00502718  0.02907574  0.19105692]
Stock Position:  -0.005027184020811541
Bond Position:  [4.39049672]


portfolio before change:  [3.87176022]
curr_Stock_Price:  103.40466093119412
curr_Factors:  [103.40466093  -0.96190261  -1.01003517]
mat_Sqrt:  [[14.39257228  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.05323172  0.04885029 -1.83501078]
Stock Position:  0.05323171526278034
Bond Position:  [-1.63264724]


portfolio before change:  [3.94430417]
curr_Stock_Price:  104.77512510025068
curr_Factors:  [104.7751251   -1.02701016  -0.99030331]
mat_Sqrt:  [[13.93638313  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00736778  0.04109361 -0.00170897]
Stock Position:  0.007367775136775498
Bond Position:  [3.17234461]


portfolio before change:  [3.96022784]
curr_Stock_Price:  106.82872842426583
curr_Factors:  [106.82872842  -1.02675739  -1.04535726]
mat_Sqrt:  [[13.4517907   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00129148 -0.08736689 -0.82518618]
Stock Position:  0.0012914781805043955
Bond Position:  [3.82226087]


portfolio before change:  [3.96152443]
curr_Stock_Price:  107.09269277254131
curr_Factors:  [107.09269277  -1.07552727  -1.02964262]
mat_Sqrt:  [[13.04656472  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-8.24720748e-04  3.59747646e-02  8.45283216e-01]
Stock Position:  -0.0008247207479922154
Bond Position:  [4.049846]


portfolio before change:  [3.96267165]
curr_Stock_Price:  106.92944556357341
curr_Factors:  [106.92944556  -1.35444739  -1.03398187]
mat_Sqrt:  [[ 9.8133133   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01963173 -0.15006983  0.39795163]
Stock Position:  -0.019631730956680922
Bond Position:  [6.06188176]


portfolio before change:  [3.94305284]
curr_Stock_Price:  108.00599223803016
curr_Factors:  [108.00599224  -1.48926425  -1.0428319 ]
mat_Sqrt:  [[ 8.58563589  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.23442625 -0.21215984 -0.22613195]
Stock Position:  -0.23442625335076944
Bond Position:  [29.26249294]


portfolio before change:  [3.90592053]
curr_Stock_Price:  108.19559920300375
curr_Factors:  [108.1955992   -1.59160787  -1.01275263]
mat_Sqrt:  [[ 8.0011093   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.03626658 -0.02475225  0.07175902]
Stock Position:  0.03626657707166802
Bond Position:  [-0.01796351]


portfolio before change:  [3.90567902]
curr_Stock_Price:  108.18906387295864
curr_Factors:  [108.18906387  -1.36765484  -1.0380707 ]
mat_Sqrt:  [[ 9.75865666  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0047097   0.02125914  0.07604379]
Stock Position:  -0.00470969587034158
Bond Position:  [4.41521661]


portfolio before change:  [3.90869206]
curr_Stock_Price:  107.78370828668046
curr_Factors:  [107.78370829  -1.64796366  -1.05154347]
mat_Sqrt:  [[ 7.24723039  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.15576223 -0.4006704   0.98666525]
Stock Position:  -0.15576222686278002
Bond Position:  [20.69732249]


portfolio before change:  [3.8319699]
curr_Stock_Price:  108.30949137175118
curr_Factors:  [108.30949137  -1.66627954  -1.04719515]
mat_Sqrt:  [[ 7.18157056  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00263282 -0.01486734 -0.03488519]
Stock Position:  0.002632818440020736
Bond Position:  [3.54681067]


portfolio before change:  [3.83313402]
curr_Stock_Price:  108.41481861033465
curr_Factors:  [108.41481861  -1.49940084  -1.02484471]
mat_Sqrt:  [[ 8.68605819  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01010738 -0.01555327 -0.04755063]
Stock Position:  -0.010107378590404373
Bond Position:  [4.92892363]


portfolio before change:  [3.83975267]
curr_Stock_Price:  107.88191396145491
curr_Factors:  [107.88191396  -1.42251334  -0.98233025]
mat_Sqrt:  [[ 9.73953766  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00737556 0.00061903 0.03173465]
Stock Position:  0.007375562594727944
Bond Position:  [3.04406286]


portfolio before change:  [3.8382375]
curr_Stock_Price:  107.57328962494562
curr_Factors:  [107.57328962  -1.24642148  -0.94759375]
mat_Sqrt:  [[11.99100941  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01758654 -0.04947006 -0.48216582]
Stock Position:  -0.017586536378245234
Bond Position:  [5.73007908]


portfolio before change:  [3.84415523]
curr_Stock_Price:  107.31826321548758
curr_Factors:  [107.31826322  -1.2075498   -0.9633409 ]
mat_Sqrt:  [[12.24243437  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00534763 -0.05921337  0.81296751]
Stock Position:  -0.005347630801513786
Bond Position:  [4.41805368]


portfolio before change:  [3.8434408]
curr_Stock_Price:  107.65843063099234
curr_Factors:  [107.65843063  -1.21271497  -0.96619095]
mat_Sqrt:  [[12.18319588  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0054893  -0.0450057   0.40280861]
Stock Position:  0.005489300443138459
Bond Position:  [3.25247133]


portfolio before change:  [3.84199536]
curr_Stock_Price:  107.2469658223052
curr_Factors:  [107.24696582  -1.23194577  -1.02805253]
mat_Sqrt:  [[11.19129197  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01202325 -0.28445414 -0.78337852]
Stock Position:  -0.012023249355091043
Bond Position:  [5.13145237]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [3.84286845]
Stock Price:  107.28106139192364
PL:  [-3.43819295]
Settle:  Tensor("sub_346:0", shape=(), dtype=float64)
PL:  Tensor("sub_347:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  174
output_Z_Vals[:, i, :]:  [[ 1.19271183e+02 -4.92738716e+01 -4.92570741e+01]
 [ 3.82502359e-02  7.03462023e-02 -3.66960468e-02]
 [-2.86059524e+00 -3.24499819e+00 -9.93322087e-01]
 [ 4.60391784e-02  1.43523948e-01 -8.08999996e-02]
 [ 6.54599834e-01 -8.82786187e-02 -3.51906652e-01]
 [-1.35100427e-01 -2.43972738e-01  6.20418580e-02]
 [-8.35737079e-03  2.98747287e-02  1.18961862e-02]
 [ 8.91563204e-02  2.16229496e-01  8.57842485e-02]
 [ 1.03389185e-02  1.84311169e-01 -8.83162939e-02]
 [-8.73012738e-01 -3.60799081e-01 -2.84011387e-02]
 [ 3.63794062e-01  7.01202123e-02  1.11722959e-02]
 [ 2.79263084e-02 -6.97101704e-02  3.70788960e-02]
 [-6.08259757e-01 -1.23939985e+00  2.12747695e-01]
 [ 2.14321851e-01  5.04797462e-02  1.02977564e-01]
 [ 1.25489024e-01  1.45678543e-01 -1.05150278e-01]
 [-3.90411901e-01  1.95447131e-01  9.17331673e-02]
 [-1.24452686e-01  1.18327951e-01  1.94135502e-01]
 [ 1.09062422e-01 -1.26580210e-02 -1.37958309e-02]
 [-6.46281128e-02 -3.18562200e-01  8.32782730e-02]
 [ 1.05418595e-02 -1.82992234e-01 -1.30001033e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.27118322 -49.27387164 -49.25707411]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [   7.3268874   -15.90307369 -140.51672192]
init_Out:  [2.48374395]
Stock Position:  7.326887399052493
Bond position:  [-730.20499595]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-4.19566958]
curr_Stock_Price:  99.11328793438652
curr_Factors:  [99.11328793 -0.51911049 -0.9869399 ]
mat_Sqrt:  [[21.98176247  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00205257  0.02270414 -0.10468361]
Stock Position:  0.0020525672206011284
Bond Position:  [-4.39910626]


portfolio before change:  [-4.19974019]
curr_Stock_Price:  97.66597857118138
curr_Factors:  [97.66597857 -0.4660049  -0.94816598]
mat_Sqrt:  [[23.74524726  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.15690461 -1.04731866 -2.83367143]
Stock Position:  -0.156904609094687
Bond Position:  [11.124502]


portfolio before change:  [-4.51914995]
curr_Stock_Price:  99.71939963071712
curr_Factors:  [99.71939963 -0.64594256 -0.95496931]
mat_Sqrt:  [[20.11464936  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00292435  0.04632216 -0.23078518]
Stock Position:  0.0029243481883152373
Bond Position:  [-4.81076419]


portfolio before change:  [-4.52072585]
curr_Stock_Price:  99.59182739229058
curr_Factors:  [99.59182739 -0.88853086 -0.96359814]
mat_Sqrt:  [[15.62623299  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.03614098 -0.0284918  -1.00389173]
Stock Position:  0.0361409811106933
Bond Position:  [-8.12007221]


portfolio before change:  [-4.52777624]
curr_Stock_Price:  99.45292364309408
curr_Factors:  [99.45292364 -1.25941944 -0.93850412]
mat_Sqrt:  [[11.04260359  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01559749 -0.07874186  0.17698815]
Stock Position:  -0.015597491232643283
Bond Position:  [-2.97656014]


portfolio before change:  [-4.52631303]
curr_Stock_Price:  99.31139771529075
curr_Factors:  [99.31139772 -1.11964944 -0.92562018]
mat_Sqrt:  [[12.84546364  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [1.31627407e-05 9.64202722e-03 3.39365080e-02]
Stock Position:  1.3162740656440188e-05
Bond Position:  [-4.52762024]


portfolio before change:  [-4.52744691]
curr_Stock_Price:  99.17185556634401
curr_Factors:  [99.17185557 -0.90186491 -0.98110469]
mat_Sqrt:  [[15.08777275  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00999515 0.06978777 0.24471858]
Stock Position:  0.009995154381554499
Bond Position:  [-5.51868492]


portfolio before change:  [-4.53577045]
curr_Stock_Price:  98.47714939380876
curr_Factors:  [98.47714939 -0.49665969 -0.93512607]
mat_Sqrt:  [[23.52441398  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00127246  0.05948617 -0.2519418 ]
Stock Position:  0.001272456364910038
Bond Position:  [-4.66107833]


portfolio before change:  [-4.5378867]
curr_Stock_Price:  97.72990706009864
curr_Factors:  [97.72990706 -0.32317441 -0.910213  ]
mat_Sqrt:  [[28.46912611  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.03345582 -0.1164474  -0.08102054]
Stock Position:  -0.033455817930629045
Bond Position:  [-1.26825272]


portfolio before change:  [-4.65679011]
curr_Stock_Price:  101.27447167237108
curr_Factors:  [101.27447167  -0.48052653  -0.91901233]
mat_Sqrt:  [[24.98549639  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01522435 0.0226312  0.03187145]
Stock Position:  0.015224345347805037
Bond Position:  [-6.19862764]


portfolio before change:  [-4.68261772]
curr_Stock_Price:  99.67980486444819
curr_Factors:  [99.67980486 -0.87908273 -0.88207482]
mat_Sqrt:  [[17.12955856  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00124145 -0.02249886  0.10577577]
Stock Position:  0.0012414492371694145
Bond Position:  [-4.80636514]


portfolio before change:  [-4.6864132]
curr_Stock_Price:  97.59052193795183
curr_Factors:  [97.59052194 -0.67437927 -0.82690397]
mat_Sqrt:  [[21.74746356  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0376055  -0.40001458  0.60690996]
Stock Position:  -0.037605500432930004
Bond Position:  [-1.01647278]


portfolio before change:  [-4.53105983]
curr_Stock_Price:  93.4526294715118
curr_Factors:  [93.45262947 -0.38010914 -0.83216238]
mat_Sqrt:  [[27.80409039  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00883489 0.01629227 0.29376633]
Stock Position:  0.008834894063398623
Bond Position:  [-5.35670391]


portfolio before change:  [-4.5367944]
curr_Stock_Price:  92.95514509940463
curr_Factors:  [92.9551451  -0.48332133 -0.77944971]
mat_Sqrt:  [[26.29413818  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00508713  0.04701755 -0.29996447]
Stock Position:  0.005087134653485552
Bond Position:  [-5.00966974]


portfolio before change:  [-4.54348166]
curr_Stock_Price:  91.88682396013037
curr_Factors:  [91.88682396 -0.57357399 -0.77228539]
mat_Sqrt:  [[23.91960152  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01387111  0.06308029  0.26168919]
Stock Position:  -0.013871111835644613
Bond Position:  [-3.26890925]


portfolio before change:  [-4.52751492]
curr_Stock_Price:  90.67682203147994
curr_Factors:  [90.67682203 -0.42511848 -0.79099079]
mat_Sqrt:  [[26.87489307  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00225755  0.03819018  0.55381455]
Stock Position:  -0.002257547620256327
Bond Position:  [-4.32280768]


portfolio before change:  [-4.52808282]
curr_Stock_Price:  90.44960945475425
curr_Factors:  [90.44960945 -0.23459836 -0.80893407]
mat_Sqrt:  [[31.85710591  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00325399 -0.00408536 -0.03935567]
Stock Position:  0.0032539852269203176
Bond Position:  [-4.82240451]


portfolio before change:  [-4.52064628]
curr_Stock_Price:  93.10551735885772
curr_Factors:  [ 9.31055174e+01 -3.97779646e-02 -7.83088603e-01]
mat_Sqrt:  [[40.88923715  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00275513 -0.10281551  0.23756973]
Stock Position:  -0.0027551319376826547
Bond Position:  [-4.2641283]


portfolio before change:  [-4.52279858]
curr_Stock_Price:  93.49973999396227
curr_Factors:  [93.49973999  0.12451112 -0.80837487]
mat_Sqrt:  [[47.18588982  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00113058 -0.05906049 -0.37085676]
Stock Position:  -0.001130584245956438
Bond Position:  [-4.41708925]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-4.52302164]
Stock Price:  92.72018754640415
PL:  [-4.52302164]
Settle:  Tensor("sub_348:0", shape=(), dtype=float64)
PL:  Tensor("sub_349:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  175
output_Z_Vals[:, i, :]:  [[ 1.19271183e+02 -4.92738716e+01 -4.92570741e+01]
 [-5.21090808e-03 -5.68467769e-03 -6.21395188e-02]
 [-2.46457275e+00 -2.91979025e+00 -8.73915135e-01]
 [-2.52074845e-02  4.13336088e-02 -1.15580158e-01]
 [ 4.74932656e-01 -6.37974397e-02 -2.85729378e-01]
 [-1.40195201e-01 -2.27851372e-01 -3.02453036e-02]
 [-2.64773657e-02  3.81893357e-02 -7.23666965e-02]
 [-1.43115966e-02  2.66198005e-02 -2.69408131e-02]
 [ 1.41853432e-02 -1.12667526e-01  1.03836395e-02]
 [-8.90090532e-01 -3.61231672e-01 -2.94103938e-02]
 [ 8.32252424e-02 -4.15529588e-02 -2.32693346e-01]
 [ 4.24689360e-02  5.05527959e-03  2.24714149e-02]
 [-7.02550773e-01 -1.08221732e+00  2.35829630e-01]
 [ 1.34604244e-01  7.12137771e-02  1.15352003e-01]
 [ 1.01259208e-01  1.28727114e-01 -1.03738433e-01]
 [-2.03936691e-01  1.17410079e-01  1.28134051e-01]
 [ 2.81750723e-02  1.18173665e-01  1.36747208e-01]
 [ 1.15216134e-01 -1.08333916e-02 -3.18137274e-02]
 [-5.82756107e-02 -1.75836816e-01  1.92652515e-02]
 [ 1.00824162e-01 -7.50405326e-01 -7.35438603e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.27118322 -49.27387164 -49.25707411]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [   7.3268874   -15.90307369 -140.51672192]
init_Out:  [2.48374395]
Stock Position:  7.326887399052493
Bond position:  [-730.20499595]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [9.8335144]
curr_Stock_Price:  101.02804152761225
curr_Factors:  [101.02804153  -0.93965311  -0.99474794]
mat_Sqrt:  [[14.59964291  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0013052  -0.00183472 -0.17726675]
Stock Position:  -0.0013052007037439907
Bond Position:  [9.96537627]


portfolio before change:  [9.83932356]
curr_Stock_Price:  98.48628152692679
curr_Factors:  [98.48628153 -0.93252956 -1.0046021 ]
mat_Sqrt:  [[14.19352106  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.22819987 -0.94235825 -2.49303663]
Stock Position:  -0.22819986731167874
Bond Position:  [32.31387993]


portfolio before change:  [9.76711049]
curr_Stock_Price:  98.83813337694961
curr_Factors:  [98.83813338 -0.75998948 -0.98038128]
mat_Sqrt:  [[17.34167786  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00232751  0.01334036 -0.32971802]
Stock Position:  -0.0023275139944398354
Bond Position:  [9.99715763]


portfolio before change:  [9.7683336]
curr_Stock_Price:  99.38656869581855
curr_Factors:  [99.3865687  -1.09860158 -0.98539322]
mat_Sqrt:  [[12.36688304  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0326344  -0.02059054 -0.81510638]
Stock Position:  0.03263439880174261
Bond Position:  [6.52491269]


portfolio before change:  [9.71992537]
curr_Stock_Price:  97.85322743203302
curr_Factors:  [97.85322743 -1.27488079 -0.96158716]
mat_Sqrt:  [[10.4541678   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01844996 -0.07353871 -0.08628143]
Stock Position:  -0.018449958772435986
Bond Position:  [11.52531338]


portfolio before change:  [9.70610487]
curr_Stock_Price:  98.75849679975977
curr_Factors:  [98.7584968  -1.58155179 -0.94468851]
mat_Sqrt:  [[ 7.89663831  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00423646  0.01232556 -0.20644204]
Stock Position:  -0.0042364597431434154
Bond Position:  [10.12449127]


portfolio before change:  [9.71025882]
curr_Stock_Price:  98.37551016065743
curr_Factors:  [98.37551016 -1.75171519 -0.9670273 ]
mat_Sqrt:  [[ 6.48861697  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00221575  0.0085915  -0.07685464]
Stock Position:  -0.002215745380196057
Bond Position:  [9.9282339]


portfolio before change:  [9.71178862]
curr_Stock_Price:  98.80541926298409
curr_Factors:  [98.80541926 -1.41656893 -0.96980415]
mat_Sqrt:  [[ 9.08640527  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00073662 -0.03636329  0.02962163]
Stock Position:  -0.0007366243764388758
Bond Position:  [9.7845711]


portfolio before change:  [9.71407717]
curr_Stock_Price:  99.0197755962493
curr_Factors:  [99.0197756  -1.42771697 -0.97019905]
mat_Sqrt:  [[ 9.00161103  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.1077396  -0.11658702 -0.08389967]
Stock Position:  -0.10773960424008457
Bond Position:  [20.3824286]


portfolio before change:  [9.81854687]
curr_Stock_Price:  98.09742716581773
curr_Factors:  [98.09742717 -1.22364455 -0.95498962]
mat_Sqrt:  [[11.10423946  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00245356 -0.01341116 -0.66380935]
Stock Position:  0.00245356288843004
Bond Position:  [9.57785866]


portfolio before change:  [9.81641408]
curr_Stock_Price:  96.25212944377125
curr_Factors:  [96.25212944 -1.13561855 -0.90936734]
mat_Sqrt:  [[12.45329454  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00386145 0.00163158 0.06410469]
Stock Position:  0.003861451990158608
Bond Position:  [9.4447411]


portfolio before change:  [9.81535743]
curr_Stock_Price:  95.36693713031558
curr_Factors:  [95.36693713 -0.85400164 -0.89892238]
mat_Sqrt:  [[16.5239017   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0529729  -0.34928414  0.67275629]
Stock Position:  -0.052972896578068245
Bond Position:  [14.86722033]


portfolio before change:  [9.82369615]
curr_Stock_Price:  95.27969536389848
curr_Factors:  [95.27969536 -1.01897239 -0.890626  ]
mat_Sqrt:  [[14.11472162  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01223452 0.02298415 0.32906716]
Stock Position:  0.012234518588881868
Bond Position:  [8.65799494]


portfolio before change:  [9.83515935]
curr_Stock_Price:  96.03971177616805
curr_Factors:  [96.03971178 -0.71650337 -0.89431755]
mat_Sqrt:  [[19.18139587  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00554496  0.0415465  -0.29593687]
Stock Position:  0.0055449562502973984
Bond Position:  [9.30262335]


portfolio before change:  [9.83835192]
curr_Stock_Price:  96.19600137994026
curr_Factors:  [96.19600138 -0.63026692 -0.90277896]
mat_Sqrt:  [[20.76651678  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00740689  0.03789394  0.36553078]
Stock Position:  -0.007406885201556275
Bond Position:  [10.55086466]


portfolio before change:  [9.8432919]
curr_Stock_Price:  95.88521761991097
curr_Factors:  [95.88521762 -0.91134586 -0.91944135]
mat_Sqrt:  [[15.36918636  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00521892 0.03814039 0.39010172]
Stock Position:  0.005218921524550197
Bond Position:  [9.34287448]


portfolio before change:  [9.85286076]
curr_Stock_Price:  97.2711061022582
curr_Factors:  [97.2711061  -1.02853658 -0.93195693]
mat_Sqrt:  [[13.69469433  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00777753 -0.00349646 -0.09075571]
Stock Position:  0.007777525005350594
Bond Position:  [9.0963323]


portfolio before change:  [9.85151973]
curr_Stock_Price:  96.80625473498701
curr_Factors:  [96.80625473 -1.22804192 -0.93125989]
mat_Sqrt:  [[11.17199046  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00807695 -0.05675109  0.0549584 ]
Stock Position:  -0.00807695349843495
Bond Position:  [10.63341935]


portfolio before change:  [9.8537135]
curr_Stock_Price:  96.86381599912302
curr_Factors:  [96.863816   -1.513986   -0.94752109]
mat_Sqrt:  [[ 8.26309273  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02450323 -0.24219228 -2.09800163]
Stock Position:  -0.02450322981596585
Bond Position:  [12.22718984]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [9.84423707]
Stock Price:  97.37532455483746
PL:  [9.84423707]
Settle:  Tensor("sub_350:0", shape=(), dtype=float64)
PL:  Tensor("sub_351:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  176
output_Z_Vals[:, i, :]:  [[ 1.19271183e+02 -4.92738716e+01 -4.92570741e+01]
 [ 8.57306918e-02  1.41717207e-01 -3.09812396e-02]
 [-2.46830538e+00 -2.77157393e+00 -8.43545806e-01]
 [-4.30654518e-04  7.90851358e-02 -1.05357208e-01]
 [ 4.76206645e-01  6.00413751e-02 -3.95893332e-01]
 [-4.28576026e-02 -6.19743744e-02  1.75200424e-02]
 [-9.09971604e-03  2.85190874e-02  1.89730516e-02]
 [ 8.63619807e-02  1.98407256e-01  6.84650774e-02]
 [ 1.89055879e-02  2.08713147e-01 -8.47851393e-02]
 [-7.07943375e-01 -2.76232512e-01 -2.03547083e-02]
 [-2.28767387e-03 -4.71176930e-02 -3.22245658e-01]
 [ 8.74900544e-02  2.34757892e-02  2.06303277e-02]
 [-6.34300155e-01 -1.13584397e+00  2.17102072e-01]
 [ 4.75513275e-02  5.94835245e-02  1.38169337e-01]
 [ 9.21900824e-02  1.20646732e-01 -1.03480181e-01]
 [-6.09468363e-02  6.66377547e-02  1.23024472e-01]
 [ 1.25539909e-01  1.15578973e-01  1.03380930e-01]
 [ 1.02545072e-01 -1.46954321e-02  8.38396603e-04]
 [ 6.50632008e-03  4.59115778e-02 -7.25487025e-03]
 [ 4.45821076e-02 -4.51624501e-01 -3.12929178e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.27118322 -49.27387164 -49.25707411]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [   7.3268874   -15.90307369 -140.51672192]
init_Out:  [2.48374395]
Stock Position:  7.326887399052493
Bond position:  [-730.20499595]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-7.05343916]
curr_Stock_Price:  98.72324924244026
curr_Factors:  [98.72324924 -1.02431739 -1.001621  ]
mat_Sqrt:  [[13.01863885  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0083215   0.04573903 -0.08838085]
Stock Position:  0.008321497951028801
Bond Position:  [-7.87496447]


portfolio before change:  [-7.05879696]
curr_Stock_Price:  98.31601293744022
curr_Factors:  [98.31601294 -1.06941865 -1.00048069]
mat_Sqrt:  [[12.40733177  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.25841484 -0.89452164 -2.40640139]
Stock Position:  -0.2584148359572216
Bond Position:  [18.3475194]


portfolio before change:  [-7.30167781]
curr_Stock_Price:  99.27365264149128
curr_Factors:  [99.27365264 -0.76874866 -1.02703645]
mat_Sqrt:  [[16.47913603  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00035156  0.02552462 -0.30055479]
Stock Position:  -0.0003515608395731481
Bond Position:  [-7.26677708]


portfolio before change:  [-7.30400546]
curr_Stock_Price:  100.72639856940131
curr_Factors:  [100.72639857  -1.20432006  -1.02416956]
mat_Sqrt:  [[10.84732269  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.03758081  0.01937827 -1.12937348]
Stock Position:  0.03758080798802857
Bond Position:  [-11.08938491]


portfolio before change:  [-7.35311128]
curr_Stock_Price:  99.49350537883895
curr_Factors:  [99.49350538 -0.99879861 -0.99933316]
mat_Sqrt:  [[13.49016098  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00384961 -0.02000214  0.0499798 ]
Stock Position:  -0.003849606034627275
Bond Position:  [-6.97010048]


portfolio before change:  [-7.35034133]
curr_Stock_Price:  98.32125742113985
curr_Factors:  [98.32125742 -0.57168738 -0.99717059]
mat_Sqrt:  [[20.47863774  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [2.90339743e-05 9.20449589e-03 5.41248351e-02]
Stock Position:  2.9033974286906782e-05
Bond Position:  [-7.35319598]


portfolio before change:  [-7.35220304]
curr_Stock_Price:  97.5228417079759
curr_Factors:  [97.52284171 -0.82004484 -0.98234237]
mat_Sqrt:  [[16.08198034  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00875745 0.06403567 0.19531181]
Stock Position:  0.008757445576518015
Bond Position:  [-8.20625402]


portfolio before change:  [-7.3548875]
curr_Stock_Price:  97.45060144138878
curr_Factors:  [97.45060144 -0.74115939 -0.96360226]
mat_Sqrt:  [[17.71805097  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00249476  0.06736188 -0.2418684 ]
Stock Position:  0.002494760095700436
Bond Position:  [-7.59800337]


portfolio before change:  [-7.36029994]
curr_Stock_Price:  96.04256718283374
curr_Factors:  [96.04256718 -1.05716342 -0.97916824]
mat_Sqrt:  [[12.5341866   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.06131104 -0.08915366 -0.05806632]
Stock Position:  -0.061311037759461784
Bond Position:  [-1.47183048]


portfolio before change:  [-7.33196361]
curr_Stock_Price:  95.57439156444636
curr_Factors:  [95.57439156 -0.89231275 -0.92506483]
mat_Sqrt:  [[15.5261753   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0050034  -0.01520717 -0.91927717]
Stock Position:  -0.005003399133679798
Bond Position:  [-6.85376679]


portfolio before change:  [-7.33514041]
curr_Stock_Price:  95.86682056788281
curr_Factors:  [95.86682057 -0.80225105 -0.9546493 ]
mat_Sqrt:  [[16.54459713  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00583231 0.00757678 0.05885258]
Stock Position:  0.0058323074919204776
Bond Position:  [-7.89426519]


portfolio before change:  [-7.33522442]
curr_Stock_Price:  96.19084414238806
curr_Factors:  [96.19084414 -0.49620263 -0.92548412]
mat_Sqrt:  [[23.21149039  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0354065  -0.36659207  0.61933178]
Stock Position:  -0.03540649678780771
Bond Position:  [-3.9294436]


portfolio before change:  [-7.39692377]
curr_Stock_Price:  97.90569534763257
curr_Factors:  [97.90569535 -0.83528795 -0.94581944]
mat_Sqrt:  [[16.49236148  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00532956 0.01919822 0.39415866]
Stock Position:  0.00532956114559375
Bond Position:  [-7.91871816]


portfolio before change:  [-7.39831885]
curr_Stock_Price:  98.01543270095715
curr_Factors:  [98.0154327  -0.81213195 -0.97041473]
mat_Sqrt:  [[16.48710014  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00580419  0.03893857 -0.29520015]
Stock Position:  0.005804185641399044
Bond Position:  [-7.96721862]


portfolio before change:  [-7.39580394]
curr_Stock_Price:  98.79193550463317
curr_Factors:  [98.7919355  -0.34847888 -0.93244818]
mat_Sqrt:  [[27.44239032  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00081014  0.02150724  0.35095458]
Stock Position:  -0.0008101406670290801
Bond Position:  [-7.31576857]


portfolio before change:  [-7.39926823]
curr_Stock_Price:  100.81025905446619
curr_Factors:  [100.81025905  -0.14442066  -0.94514076]
mat_Sqrt:  [[33.90894037  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00502035 0.03730295 0.29491702]
Stock Position:  0.005020354827872151
Bond Position:  [-7.9053715]


portfolio before change:  [-7.40900906]
curr_Stock_Price:  99.26370792845246
curr_Factors:  [99.26370793 -0.25246824 -0.91822543]
mat_Sqrt:  [[30.78680993  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00323894 -0.00474293  0.00239171]
Stock Position:  0.0032389362987316163
Bond Position:  [-7.73051789]


portfolio before change:  [-7.39776507]
curr_Stock_Price:  103.33197652358913
curr_Factors:  [103.33197652  -0.59264292  -0.92787633]
mat_Sqrt:  [[22.5881996   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00063737  0.0148179  -0.02069613]
Stock Position:  0.0006373720664811091
Bond Position:  [-7.46362598]


portfolio before change:  [-7.39941309]
curr_Stock_Price:  103.6741959118679
curr_Factors:  [103.67419591  -0.49680827  -0.92905043]
mat_Sqrt:  [[24.9131195   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00447482 -0.14576118 -0.89269984]
Stock Position:  -0.004474821333297122
Bond Position:  [-6.93548958]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-7.39973892]
Stock Price:  103.35948927459351
PL:  [-10.75922819]
Settle:  Tensor("sub_352:0", shape=(), dtype=float64)
PL:  Tensor("sub_353:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  177
output_Z_Vals[:, i, :]:  [[ 1.19271183e+02 -4.92738716e+01 -4.92570741e+01]
 [ 3.80542266e-02  7.00312914e-02 -3.67870077e-02]
 [-1.89937473e+00 -2.56124085e+00 -7.27738396e-01]
 [-5.20129924e-03  1.99198889e-01  7.56224430e-03]
 [ 3.91152589e-01  1.55774290e-01 -4.38641248e-01]
 [-1.03873443e-01 -1.08532238e-01  2.96823461e-02]
 [ 6.59379427e-03  2.80462426e-02  5.01886108e-02]
 [-4.66212006e-02 -4.47847688e-02 -3.60658257e-02]
 [-6.03961162e-03 -1.75482647e-01  1.93352787e-02]
 [-1.11264772e+00 -4.19747219e-01 -4.14389354e-02]
 [ 4.64940105e-01  1.36194151e-01  5.87137271e-02]
 [ 2.59924125e-02 -4.25170813e-02  3.60683748e-02]
 [-7.38936660e-01 -1.16787918e+00  2.62850777e-01]
 [-1.83693560e-02 -1.21932973e-02 -5.11927136e-03]
 [ 8.92522772e-02  1.21421443e-01 -1.03759103e-01]
 [ 1.12472717e-01  1.99597638e-02  4.09172680e-02]
 [ 4.13541698e-02  2.93113979e-02  1.26608624e-02]
 [ 4.42224419e-02 -6.58251440e-02  8.96624811e-02]
 [ 6.33621594e-03 -4.54763334e-02  3.32432665e-02]
 [ 9.06085158e-02 -7.54187245e-01 -4.50944365e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.27118322 -49.27387164 -49.25707411]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [   7.3268874   -15.90307369 -140.51672192]
init_Out:  [2.48374395]
Stock Position:  7.326887399052493
Bond position:  [-730.20499595]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [1.22170861]
curr_Stock_Price:  99.8526712353297
curr_Factors:  [99.85267124 -1.08810382 -0.98977961]
mat_Sqrt:  [[12.50104677  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00358691  0.0226025  -0.10494309]
Stock Position:  0.003586914637706492
Bond Position:  [0.8635456]


portfolio before change:  [1.2297708]
curr_Stock_Price:  102.0401428054565
curr_Factors:  [102.04014281  -1.41157476  -1.00047055]
mat_Sqrt:  [[ 9.14603991  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.28107627 -0.82663693 -2.07603508]
Stock Position:  -0.28107627292153936
Bond Position:  [29.91083383]


portfolio before change:  [1.47838744]
curr_Stock_Price:  101.18223331615302
curr_Factors:  [101.18223332  -1.57690411  -0.94839284]
mat_Sqrt:  [[ 8.0980738   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00456944 0.06429117 0.02157298]
Stock Position:  0.004569437295935382
Bond Position:  [1.01604157]


portfolio before change:  [1.47847138]
curr_Stock_Price:  101.14500718150404
curr_Factors:  [101.14500718  -1.587244    -0.99279357]
mat_Sqrt:  [[ 7.66387424  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.04350445  0.05027594 -1.25132139]
Stock Position:  0.04350444722709569
Bond Position:  [-2.92178624]


portfolio before change:  [1.43963872]
curr_Stock_Price:  100.26918578963473
curr_Factors:  [100.26918579  -1.39738809  -0.97719978]
mat_Sqrt:  [[ 9.33033162  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01285791 -0.03502863  0.08467547]
Stock Position:  -0.012857914881660456
Bond Position:  [2.72889138]


portfolio before change:  [1.43047765]
curr_Stock_Price:  101.03473572906533
curr_Factors:  [101.03473573  -1.61123591  -0.99558865]
mat_Sqrt:  [[ 7.45317273  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00302736 0.00905189 0.14317414]
Stock Position:  0.0030273572970912896
Bond Position:  [1.12460941]


portfolio before change:  [1.43133796]
curr_Stock_Price:  101.22603141903572
curr_Factors:  [101.22603142  -1.84145093  -1.01064382]
mat_Sqrt:  [[ 5.84309839  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0108033  -0.01445422 -0.10288576]
Stock Position:  -0.01080330244665355
Bond Position:  [2.52491339]


portfolio before change:  [1.43032942]
curr_Stock_Price:  101.37782247724695
curr_Factors:  [101.37782248  -1.85365321  -1.0464532 ]
mat_Sqrt:  [[ 5.57754068  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00679745 -0.05663678  0.05515817]
Stock Position:  -0.006797451027677138
Bond Position:  [2.11944021]


portfolio before change:  [1.43125486]
curr_Stock_Price:  101.31963758327784
curr_Factors:  [101.31963758  -1.8925457   -1.05173843]
mat_Sqrt:  [[ 5.33343831  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.2262681  -0.13547283 -0.11821375]
Stock Position:  -0.22626810003173484
Bond Position:  [24.35665675]


portfolio before change:  [1.29206536]
curr_Stock_Price:  101.96170522527561
curr_Factors:  [101.96170523  -1.67241758  -1.09704968]
mat_Sqrt:  [[ 6.3925295   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.07895552 0.04395647 0.16749392]
Stock Position:  0.07895552273734636
Bond Position:  [-6.75837438]


portfolio before change:  [1.28901072]
curr_Stock_Price:  101.94441912718825
curr_Factors:  [101.94441913  -1.63701862  -1.09136988]
mat_Sqrt:  [[ 6.65946564  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00370541 -0.01372233  0.10289303]
Stock Position:  0.0037054137894262907
Bond Position:  [0.91126446]


portfolio before change:  [1.29071928]
curr_Stock_Price:  102.3440286560369
curr_Factors:  [102.34402866  -1.58240744  -1.11385806]
mat_Sqrt:  [[ 6.90381715  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.1337919  -0.37693138  0.7498401 ]
Stock Position:  -0.13379189929019397
Bond Position:  [14.98352126]


portfolio before change:  [1.21024855]
curr_Stock_Price:  102.9734919120452
curr_Factors:  [102.97349191  -1.39397643  -1.12673474]
mat_Sqrt:  [[ 8.27931654  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00264554 -0.00393537 -0.01460386]
Stock Position:  -0.002645540754953244
Bond Position:  [1.48266912]


portfolio before change:  [1.21153272]
curr_Stock_Price:  102.62821147433786
curr_Factors:  [102.62821147  -1.25845062  -1.05933498]
mat_Sqrt:  [[10.10800066  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00918654  0.0391886  -0.29599584]
Stock Position:  0.009186543445530305
Bond Position:  [0.26873419]


portfolio before change:  [1.21210253]
curr_Stock_Price:  102.68292435793205
curr_Factors:  [102.68292436  -1.42984281  -1.10301026]
mat_Sqrt:  [[ 8.15631738  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01531318 0.00644199 0.11672558]
Stock Position:  0.01531318402417487
Bond Position:  [-0.36029999]


portfolio before change:  [1.206698]
curr_Stock_Price:  102.33587396422817
curr_Factors:  [102.33587396  -1.36527633  -1.09553729]
mat_Sqrt:  [[ 8.73594975  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00571452 0.00946021 0.03611792]
Stock Position:  0.005714515644308104
Bond Position:  [0.62189804]


portfolio before change:  [1.2104292]
curr_Stock_Price:  102.96159863030955
curr_Factors:  [102.96159863  -1.10485656  -1.10689147]
mat_Sqrt:  [[11.2752274   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00435363 -0.02124497  0.2557821 ]
Stock Position:  0.004353634406564972
Bond Position:  [0.76217205]


portfolio before change:  [1.20934393]
curr_Stock_Price:  102.6685478335369
curr_Factors:  [102.66854783  -1.36146667  -1.10856077]
mat_Sqrt:  [[ 8.6839663   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0004421  -0.01467742  0.09483379]
Stock Position:  0.00044209655851982127
Bond Position:  [1.16395452]


portfolio before change:  [1.20979838]
curr_Stock_Price:  103.03818533841826
curr_Factors:  [103.03818534  -1.12303506  -1.1118399 ]
mat_Sqrt:  [[11.02565342  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01409331 -0.24341289 -1.28641876]
Stock Position:  -0.014093309324487126
Bond Position:  [2.66194739]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [1.20757702]
Stock Price:  103.24302919726095
PL:  [-2.03545218]
Settle:  Tensor("sub_354:0", shape=(), dtype=float64)
PL:  Tensor("sub_355:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  178
output_Z_Vals[:, i, :]:  [[ 1.19271183e+02 -4.92738716e+01 -4.92570741e+01]
 [ 5.73764278e-02  9.94573940e-02 -2.98176156e-02]
 [-2.42955942e+00 -3.29537642e+00 -9.49824786e-01]
 [-7.29408641e-02  1.66484998e-02 -1.31106807e-01]
 [ 4.47394047e-01  6.85875536e-03 -9.80142042e-02]
 [-1.30801938e-01 -1.71903073e-01 -1.95612206e-02]
 [-7.99028332e-02  1.34801699e-01 -1.59026619e-01]
 [ 9.89673954e-02  2.45113783e-01  1.12745104e-01]
 [-1.83921630e-01  4.35198010e-01 -1.00393130e-01]
 [-8.87913242e-01 -3.62879178e-01 -2.92455278e-02]
 [ 2.16554496e-01  4.51787655e-03 -1.13292924e-01]
 [-5.06534531e-03 -4.99495620e-02  3.10670980e-02]
 [-5.68260477e-01 -1.30550808e+00  2.02624942e-01]
 [ 3.09295399e-02  4.50116289e-02  1.06313709e-01]
 [ 8.89245429e-02  1.25123215e-01 -1.03540428e-01]
 [-3.46758875e-02  5.95666080e-02  1.10586231e-01]
 [ 1.25539909e-01  1.15578973e-01  1.03380930e-01]
 [ 1.15216134e-01 -1.08333916e-02 -3.18137274e-02]
 [-4.47240281e-02 -5.96530769e-02 -1.86799984e-02]
 [ 7.34709510e-02 -6.01213936e-01 -5.40138243e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.27118322 -49.27387164 -49.25707411]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [   7.3268874   -15.90307369 -140.51672192]
init_Out:  [2.48374395]
Stock Position:  7.326887399052493
Bond position:  [-730.20499595]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-4.66360421]
curr_Stock_Price:  99.04942252982934
curr_Factors:  [99.04942253 -0.953522   -1.00917782]
mat_Sqrt:  [[13.91432822  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00514517  0.03209974 -0.08506136]
Stock Position:  0.005145170281008854
Bond Position:  [-5.17323035]


portfolio before change:  [-4.66592694]
curr_Stock_Price:  98.8493768741086
curr_Factors:  [98.84937687 -0.5596315  -1.04990996]
mat_Sqrt:  [[19.76782839  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.166741   -1.06357817 -2.70958573]
Stock Position:  -0.1667410008575604
Bond Position:  [11.81631709]


portfolio before change:  [-4.45736032]
curr_Stock_Price:  97.61625380778621
curr_Factors:  [97.61625381 -0.45272326 -1.03461096]
mat_Sqrt:  [[22.05875988  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00436582  0.00537328 -0.37401123]
Stock Position:  -0.004365819684853793
Bond Position:  [-4.03118536]


portfolio before change:  [-4.44526507]
curr_Stock_Price:  94.61494499109801
curr_Factors:  [94.61494499 -0.23215252 -1.03814957]
mat_Sqrt:  [[26.5628429   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01614236  0.00221365 -0.27960724]
Stock Position:  0.016142361732403167
Bond Position:  [-5.97257374]


portfolio before change:  [-4.44697717]
curr_Stock_Price:  94.60139222122837
curr_Factors:  [94.60139222 -0.47091564 -1.03130956]
mat_Sqrt:  [[21.06150561  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00806611 -0.05548148 -0.05580272]
Stock Position:  -0.008066110120373038
Bond Position:  [-3.68391193]


portfolio before change:  [-4.45691213]
curr_Stock_Price:  95.71889003912088
curr_Factors:  [95.71889004 -0.76390193 -1.02329824]
mat_Sqrt:  [[16.02604956  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00529436  0.04350706 -0.45365868]
Stock Position:  -0.0052943630175284065
Bond Position:  [-3.95014158]


portfolio before change:  [-4.45172171]
curr_Stock_Price:  94.55197447466567
curr_Factors:  [94.55197447 -0.39013681 -0.98587992]
mat_Sqrt:  [[23.882189    0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00720265 0.07911013 0.3216304 ]
Stock Position:  0.007202649425489272
Bond Position:  [-5.13274644]


portfolio before change:  [-4.44709614]
curr_Stock_Price:  95.3723564758922
curr_Factors:  [95.37235648 -0.32191428 -0.96208367]
mat_Sqrt:  [[26.4112703   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00437616  0.14045955 -0.28639366]
Stock Position:  -0.004376157179429698
Bond Position:  [-4.02973171]


portfolio before change:  [-4.45998477]
curr_Stock_Price:  98.08731347558052
curr_Factors:  [98.08731348 -0.83629943 -1.02462841]
mat_Sqrt:  [[15.25534903  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.06345023 -0.11711875 -0.08342935]
Stock Position:  -0.06345022721291747
Bond Position:  [1.76367755]


portfolio before change:  [-4.55018047]
curr_Stock_Price:  99.51578234709746
curr_Factors:  [99.51578235 -0.9440742  -1.01007776]
mat_Sqrt:  [[14.0998518   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0137839   0.00145814 -0.32319318]
Stock Position:  0.013783895416285361
Bond Position:  [-5.92189561]


portfolio before change:  [-4.56847184]
curr_Stock_Price:  98.29619197021592
curr_Factors:  [98.29619197 -0.60533538 -1.00942911]
mat_Sqrt:  [[19.5548004   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00045614 -0.01612115  0.08862578]
Stock Position:  -0.0004561392573487664
Bond Position:  [-4.52363509]


portfolio before change:  [-4.56986146]
curr_Stock_Price:  98.8630600832127
curr_Factors:  [98.86306008 -0.74835262 -0.97899859]
mat_Sqrt:  [[17.57336576  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.04514705 -0.42135092  0.57803256]
Stock Position:  -0.04514704613598453
Bond Position:  [-0.10648632]


portfolio before change:  [-4.57728616]
curr_Stock_Price:  99.0269262516316
curr_Factors:  [99.02692625 -0.80770356 -0.95489313]
mat_Sqrt:  [[16.99289139  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00363792 0.01452744 0.30328342]
Stock Position:  0.003637915033863339
Bond Position:  [-4.9375377]


portfolio before change:  [-4.57966312]
curr_Stock_Price:  98.71289455324046
curr_Factors:  [98.71289455 -0.65822642 -0.96238086]
mat_Sqrt:  [[19.52329377  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00478045  0.04038334 -0.29537202]
Stock Position:  0.004780449028186154
Bond Position:  [-5.05155508]


portfolio before change:  [-4.5795205]
curr_Stock_Price:  99.00693975190842
curr_Factors:  [99.00693975 -0.74536799 -1.03107   ]
mat_Sqrt:  [[16.75592555  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [3.36688807e-06 1.92250401e-02 3.15471736e-01]
Stock Position:  3.36688806518474e-06
Bond Position:  [-4.57985384]


portfolio before change:  [-4.5806623]
curr_Stock_Price:  99.9885870329342
curr_Factors:  [99.98858703 -0.77767494 -1.05254398]
mat_Sqrt:  [[16.03601487  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01061579 0.03730295 0.29491702]
Stock Position:  0.01061578664396619
Bond Position:  [-5.6421198]


portfolio before change:  [-4.59446664]
curr_Stock_Price:  98.82111508184825
curr_Factors:  [98.82111508 -1.0125709  -1.03151863]
mat_Sqrt:  [[12.79714073  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00832302 -0.00349646 -0.09075571]
Stock Position:  0.008323017604836691
Bond Position:  [-5.41695652]


portfolio before change:  [-4.58484788]
curr_Stock_Price:  100.13952742170862
curr_Factors:  [100.13952742  -0.89270043  -1.03487571]
mat_Sqrt:  [[14.57034576  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00416694 -0.01925295 -0.05328884]
Stock Position:  -0.0041669361254468885
Bond Position:  [-4.16757286]


portfolio before change:  [-4.58506894]
curr_Stock_Price:  99.94250999891905
curr_Factors:  [99.94251    -0.94038334 -1.06732921]
mat_Sqrt:  [[13.42183114  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01188412 -0.19404096 -1.54086406]
Stock Position:  -0.011884115148276473
Bond Position:  [-3.39734064]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-4.60063872]
Stock Price:  101.18116637529862
PL:  [-5.78180509]
Settle:  Tensor("sub_356:0", shape=(), dtype=float64)
PL:  Tensor("sub_357:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  179
output_Z_Vals[:, i, :]:  [[ 1.19271183e+02 -4.92738716e+01 -4.92570741e+01]
 [ 3.36840326e-02  6.30100829e-02 -3.88150589e-02]
 [-2.23889308e+00 -3.05173574e+00 -8.71178655e-01]
 [ 2.60198119e-03  7.09496042e-02 -1.01577952e-01]
 [ 5.02836525e-01 -9.37830595e-02 -2.63062993e-01]
 [-7.11969067e-02 -1.04795088e-01  2.33180097e-02]
 [ 6.72119831e-03  2.87413911e-02  9.15216192e-02]
 [ 1.65664916e-01  4.47616300e-01  3.01782298e-01]
 [ 8.46165243e-02  1.08105859e-01 -6.64516778e-02]
 [-1.14022528e+00 -4.73417016e-01 -4.19426853e-02]
 [-2.24836916e-02 -2.62965801e-02 -3.04378569e-01]
 [-1.49373672e-01 -3.67401852e-02  3.05696384e-02]
 [-6.45206577e-01 -9.33845631e-01  2.25939012e-01]
 [ 1.28169748e-02  1.49063824e-03 -6.26928280e-02]
 [-2.00559006e-01 -2.66255365e-01  1.04104655e-01]
 [ 1.16833290e-01  1.87860623e-02  3.88527115e-02]
 [-8.14051049e-02 -9.09082628e-02 -1.06960748e-01]
 [-1.97602862e-01 -2.71751901e-01  4.86576559e-01]
 [ 1.30437856e-01  1.98753324e-01  7.57482053e-02]
 [-7.14266124e-03 -1.40212987e-01  3.32488528e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.27118322 -49.27387164 -49.25707411]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [   7.3268874   -15.90307369 -140.51672192]
init_Out:  [2.48374395]
Stock Position:  7.326887399052493
Bond position:  [-730.20499595]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [3.10193214]
curr_Stock_Price:  100.10929091910268
curr_Factors:  [100.10929092  -1.19937418  -1.02747208]
mat_Sqrt:  [[10.79859721  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00357665  0.02033642 -0.11072856]
Stock Position:  0.0035766517096431547
Bond Position:  [2.74387607]


portfolio before change:  [3.09997397]
curr_Stock_Price:  99.3699897175221
curr_Factors:  [99.36998972 -0.92630886 -1.01203923]
mat_Sqrt:  [[14.30346853  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.21251171 -0.98494347 -2.48523021]
Stock Position:  -0.21251171477957198
Bond Position:  [24.21726088]


portfolio before change:  [3.17882334]
curr_Stock_Price:  99.02744720562158
curr_Factors:  [99.02744721 -1.08785116 -1.02820106]
mat_Sqrt:  [[11.93344345  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00030586  0.02289889 -0.28977362]
Stock Position:  -0.00030586343767616855
Bond Position:  [3.20911222]


portfolio before change:  [3.17960912]
curr_Stock_Price:  99.08172203733858
curr_Factors:  [99.08172204 -0.87075772 -1.01349177]
mat_Sqrt:  [[15.05477915  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.02856207 -0.03026835 -0.7504455 ]
Stock Position:  0.028562068232197358
Bond Position:  [0.34963021]


portfolio before change:  [3.14887917]
curr_Stock_Price:  98.00276057180363
curr_Factors:  [98.00276057 -0.39016457 -1.01595268]
mat_Sqrt:  [[24.01979796  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0036565  -0.03382247  0.06651979]
Stock Position:  -0.003656498102377652
Bond Position:  [3.50722607]


portfolio before change:  [3.14422434]
curr_Stock_Price:  99.51561300113009
curr_Factors:  [ 9.95156130e+01 -2.51276738e-02 -1.01491140e+00]
mat_Sqrt:  [[35.17288504  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00088903 0.00927624 0.2610857 ]
Stock Position:  0.0008890309236358625
Bond Position:  [3.05575188]


portfolio before change:  [3.14548961]
curr_Stock_Price:  100.0794160996276
curr_Factors:  [100.0794161   -0.12687885  -0.98185264]
mat_Sqrt:  [[33.0239331   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00964862 0.14446754 0.8609009 ]
Stock Position:  0.009648616468199535
Bond Position:  [2.17986171]


portfolio before change:  [3.15189548]
curr_Stock_Price:  100.68684352099753
curr_Factors:  [100.68684352  -0.11336483  -0.95981848]
mat_Sqrt:  [[34.42667962  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00270485  0.03489102 -0.18956814]
Stock Position:  0.0027048541855024355
Bond Position:  [2.87955225]


portfolio before change:  [3.15114789]
curr_Stock_Price:  100.14427713671245
curr_Factors:  [100.14427714   0.20360645  -0.95024528]
mat_Sqrt:  [[47.46407418  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02623927 -0.15279469 -0.11965081]
Stock Position:  -0.026239269603975317
Bond Position:  [5.77886058]


portfolio before change:  [3.30678789]
curr_Stock_Price:  94.26777600223758
curr_Factors:  [94.267776    0.34955996 -0.96133989]
mat_Sqrt:  [[51.12938988  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0017599  -0.00848718 -0.86830734]
Stock Position:  -0.0017598972737669504
Bond Position:  [3.47268949]


portfolio before change:  [3.29549867]
curr_Stock_Price:  101.17584821612378
curr_Factors:  [101.17584822   0.26057609  -0.96104305]
mat_Sqrt:  [[50.21898332  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00299953 -0.01185784  0.08720667]
Stock Position:  -0.0029995276648426463
Bond Position:  [3.59897843]


portfolio before change:  [3.29571811]
curr_Stock_Price:  101.40268866596442
curr_Factors:  [101.40268867   0.17293873  -0.97854268]
mat_Sqrt:  [[45.30854552  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01742955 -0.30139738  0.64454111]
Stock Position:  -0.017429546710969072
Bond Position:  [5.06312101]


portfolio before change:  [3.20607142]
curr_Stock_Price:  106.61869545116782
curr_Factors:  [ 1.06618695e+02 -5.82339592e-02 -9.50461300e-01]
mat_Sqrt:  [[38.88325195  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 8.33598280e-06  4.81101422e-04 -1.78845188e-01]
Stock Position:  8.335982795926542e-06
Bond Position:  [3.20518265]


portfolio before change:  [3.20689078]
curr_Stock_Price:  108.77400360552872
curr_Factors:  [108.77400361  -0.12883996  -0.94134906]
mat_Sqrt:  [[37.30335813  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00626372 -0.08593355  0.2969816 ]
Stock Position:  -0.006263722439622174
Bond Position:  [3.88822095]


portfolio before change:  [3.20270541]
curr_Stock_Price:  109.59740341643455
curr_Factors:  [ 1.09597403e+02 -5.15354453e-02 -9.31933589e-01]
mat_Sqrt:  [[40.99067691  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00313727 0.00606318 0.11083597]
Stock Position:  0.0031372683996204877
Bond Position:  [2.85886894]


portfolio before change:  [3.19770431]
curr_Stock_Price:  107.77546703172936
curr_Factors:  [107.77546703   0.43567171  -0.88654866]
mat_Sqrt:  [[68.6604336   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00177387 -0.02934052 -0.30512924]
Stock Position:  -0.001773873849473979
Bond Position:  [3.3888844]


portfolio before change:  [3.19287389]
curr_Stock_Price:  110.97622989171649
curr_Factors:  [110.97622989   0.39728435  -0.88511061]
mat_Sqrt:  [[68.13491435  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00225658 -0.08770755  1.38806749]
Stock Position:  -0.0022565811408258997
Bond Position:  [3.44330076]


portfolio before change:  [3.20480506]
curr_Stock_Price:  106.07047271104739
curr_Factors:  [106.07047271   0.52899579  -0.8862721 ]
mat_Sqrt:  [[ 7.42046933e+01  0.00000000e+00  0.00000000e+00]
 [-6.32455532e-01  3.09838668e+00  0.00000000e+00]
 [-7.15541753e-02  0.00000000e+00  3.50542437e-01]]
grads:  [0.00251292 0.06414736 0.21608855]
Stock Position:  0.0025129171456827904
Bond Position:  [2.93825875]


portfolio before change:  [3.21003526]
curr_Stock_Price:  107.85944772751479
curr_Factors:  [107.85944773   0.33750728  -0.91035735]
mat_Sqrt:  [[60.82366224  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0004764  -0.04525355  0.09484972]
Stock Position:  -0.0004764037976798993
Bond Position:  [3.26141992]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [3.21167896]
Stock Price:  106.12093535435122
PL:  [-2.9092564]
Settle:  Tensor("sub_358:0", shape=(), dtype=float64)
PL:  Tensor("sub_359:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  180
output_Z_Vals[:, i, :]:  [[ 1.19271183e+02 -4.92738716e+01 -4.92570741e+01]
 [ 1.07795192e-02  2.62114049e-02 -4.94442273e-02]
 [-2.30298781e+00 -3.09946928e+00 -8.83437917e-01]
 [ 3.04927894e-02  1.24208168e-01 -9.09431577e-02]
 [ 4.04814442e-01  1.31538195e-02 -7.88581782e-02]
 [-1.44898910e-01 -2.51103408e-01  3.18963014e-02]
 [-4.24349329e-02  7.64986511e-02 -6.44806528e-02]
 [ 7.85494093e-02  1.39018295e-01  1.35439279e-02]
 [-4.82591452e-03  1.64741527e-02  6.88625980e-03]
 [-7.54259228e-01 -3.04587483e-01 -2.25140543e-02]
 [ 7.87983829e-02 -4.13082920e-02 -2.45154256e-01]
 [-1.58783389e-02 -3.82244656e-02  2.81416325e-02]
 [-6.16531112e-01 -1.25778641e+00  2.17877984e-01]
 [ 1.89892909e-02  3.46157531e-02  8.34302408e-02]
 [ 1.33412006e-01  1.18999444e-01 -1.06074547e-01]
 [ 6.32229220e-03  4.85314471e-02  9.11752372e-02]
 [ 1.07630364e-01  9.42176579e-02  7.72532921e-02]
 [ 9.19836611e-02 -1.78271601e-02  3.17543838e-02]
 [-3.40191453e-02 -2.55825321e-02 -2.35965415e-02]
 [ 6.54601602e-02 -5.50680989e-01 -5.00899307e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.27118322 -49.27387164 -49.25707411]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [   7.3268874   -15.90307369 -140.51672192]
init_Out:  [2.48374395]
Stock Position:  7.326887399052493
Bond position:  [-730.20499595]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [4.76893448]
curr_Stock_Price:  100.33680940632665
curr_Factors:  [100.33680941  -0.82648116  -1.02102317]
mat_Sqrt:  [[15.81609803  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00038171  0.00845969 -0.14105062]
Stock Position:  0.00038170850578500413
Bond Position:  [4.73063506]


portfolio before change:  [4.77023022]
curr_Stock_Price:  100.63267408122391
curr_Factors:  [100.63267408  -0.78934538  -1.02443516]
mat_Sqrt:  [[16.40680944  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.18992086 -1.00034941 -2.52020248]
Stock Position:  -0.18992085893846078
Bond Position:  [23.88247412]


portfolio before change:  [4.90786397]
curr_Stock_Price:  99.93942539772614
curr_Factors:  [99.9394254  -0.56435958 -1.0399999 ]
mat_Sqrt:  [[20.08965029  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00185583  0.04008801 -0.25943552]
Stock Position:  0.0018558302722203072
Bond Position:  [4.72239336]


portfolio before change:  [4.90154072]
curr_Stock_Price:  95.89595362506002
curr_Factors:  [95.89595363 -0.34978008 -1.02970882]
mat_Sqrt:  [[24.13769877  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01621541  0.00424538 -0.22496043]
Stock Position:  0.016215406422812523
Bond Position:  [3.34654885]


portfolio before change:  [4.89982125]
curr_Stock_Price:  95.7383128872377
curr_Factors:  [95.73831289 -0.44531008 -1.04007936]
mat_Sqrt:  [[21.67650866  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00874884 -0.08104328  0.09099127]
Stock Position:  -0.008748843121317375
Bond Position:  [5.73742073]


portfolio before change:  [4.88900096]
curr_Stock_Price:  97.1390496875882
curr_Factors:  [97.13904969 -0.64399453 -1.02826019]
mat_Sqrt:  [[18.2449574   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00219139  0.02468983 -0.18394535]
Stock Position:  -0.0021913873708183378
Bond Position:  [5.10187024]


portfolio before change:  [4.88801875]
curr_Stock_Price:  98.16936968023161
curr_Factors:  [98.16936968 -1.10844178 -1.00258013]
mat_Sqrt:  [[11.88969834  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00922572 0.04486796 0.03863706]
Stock Position:  0.009225721264521664
Bond Position:  [3.98233551]


portfolio before change:  [4.87741745]
curr_Stock_Price:  96.91233891487076
curr_Factors:  [96.91233891 -1.22450963 -0.97771908]
mat_Sqrt:  [[10.71428747  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-5.36575985e-06  5.31700991e-03  1.96445824e-02]
Stock Position:  -5.365759849356195e-06
Bond Position:  [4.87793746]


portfolio before change:  [4.87863761]
curr_Stock_Price:  96.81491257232264
curr_Factors:  [96.81491257 -1.03340928 -0.98156657]
mat_Sqrt:  [[12.90771488  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.06360758 -0.09830519 -0.06422633]
Stock Position:  -0.06360758334273471
Bond Position:  [11.03680023]


portfolio before change:  [4.8144604]
curr_Stock_Price:  97.86725176542062
curr_Factors:  [97.86725177 -1.13841975 -0.96207035]
mat_Sqrt:  [[11.9786019   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00169673 -0.01333219 -0.69935685]
Stock Position:  0.0016967305843096562
Bond Position:  [4.64840604]


portfolio before change:  [4.81506405]
curr_Stock_Price:  97.53803099968647
curr_Factors:  [97.538031   -1.13302867 -0.99434894]
mat_Sqrt:  [[11.621592    0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00154338 -0.01233689  0.08028024]
Stock Position:  -0.0015433762060253497
Bond Position:  [4.96560192]


portfolio before change:  [4.8133592]
curr_Stock_Price:  99.44709642206755
curr_Factors:  [99.44709642 -1.06730291 -1.07470968]
mat_Sqrt:  [[11.67690811  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.07097782 -0.40594882  0.62154524]
Stock Position:  -0.07097782425291466
Bond Position:  [11.87189773]


portfolio before change:  [4.78788146]
curr_Stock_Price:  99.84787056617563
curr_Factors:  [99.84787057 -1.18060449 -1.09231123]
mat_Sqrt:  [[10.28546784  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00418895 0.01117219 0.23800325]
Stock Position:  0.004188951744704049
Bond Position:  [4.36962355]


portfolio before change:  [4.7887697]
curr_Stock_Price:  99.79909717931896
curr_Factors:  [99.79909718 -1.61712479 -1.05471461]
mat_Sqrt:  [[ 6.8986086   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01972141  0.03840691 -0.30260116]
Stock Position:  0.019721410100124476
Bond Position:  [2.82059077]


portfolio before change:  [4.78567964]
curr_Stock_Price:  99.60665157123846
curr_Factors:  [99.60665157 -1.54359109 -1.08780942]
mat_Sqrt:  [[ 7.1694463   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00485948 0.01566346 0.26009757]
Stock Position:  0.004859482626936406
Bond Position:  [4.30164284]


portfolio before change:  [4.79154363]
curr_Stock_Price:  100.592034328204
curr_Factors:  [100.59203433  -1.31306457  -1.10570335]
mat_Sqrt:  [[ 8.95583389  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01592612 0.03040862 0.22038214]
Stock Position:  0.01592612443742852
Bond Position:  [3.18950237]


portfolio before change:  [4.79417886]
curr_Stock_Price:  100.70742705644109
curr_Factors:  [100.70742706  -0.85811689  -1.08603328]
mat_Sqrt:  [[14.41211806  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00657964 -0.00575369  0.09058642]
Stock Position:  0.006579639672674297
Bond Position:  [4.13156028]


portfolio before change:  [4.79908053]
curr_Stock_Price:  101.2953994949274
curr_Factors:  [101.29539949  -1.19917545  -1.06664705]
mat_Sqrt:  [[10.50885773  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00419244 -0.00825673 -0.06731436]
Stock Position:  -0.004192442495408879
Bond Position:  [5.22375567]


portfolio before change:  [4.80545413]
curr_Stock_Price:  100.08667785306473
curr_Factors:  [100.08667785  -0.78655791  -1.04969087]
mat_Sqrt:  [[15.95524802  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0093507  -0.17773153 -1.4289263 ]
Stock Position:  -0.009350701955132355
Bond Position:  [5.74133482]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [4.78562809]
Stock Price:  102.36047021986732
PL:  [2.42515787]
Settle:  Tensor("sub_360:0", shape=(), dtype=float64)
PL:  Tensor("sub_361:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  181
output_Z_Vals[:, i, :]:  [[ 1.19271183e+02 -4.92738716e+01 -4.92570741e+01]
 [ 9.87129593e-03  2.47522421e-02 -4.98657013e-02]
 [-2.49856083e+00 -3.36027094e+00 -9.58883008e-01]
 [-3.12031657e-01 -1.71948386e-01  2.01678883e-01]
 [ 9.93618563e-01 -3.85083031e-02 -5.46650903e-01]
 [ 8.72132438e-02  2.23151135e-01  5.59772336e-02]
 [ 7.86577033e-02 -9.98724112e-02  2.64401199e-02]
 [ 1.22468568e-01  3.66364988e-01  2.59303505e-01]
 [ 9.50488314e-02  1.03716478e-01 -7.10348846e-02]
 [-1.74059615e+00 -6.68981429e-01 -7.21153428e-02]
 [ 1.04009714e-01 -6.63973149e-02  2.67565881e-02]
 [-1.05547103e-01  9.41440908e-02  2.37098445e-02]
 [-8.67657796e-01 -1.07844813e+00  3.15376719e-01]
 [-6.06753069e-02 -8.50652872e-02  5.89624485e-02]
 [-1.94617651e-01 -2.55973198e-01  9.84099858e-02]
 [ 1.29151228e-01  1.54705389e-02  3.30206620e-02]
 [-1.94772926e-01 -2.01930758e-01 -2.17430946e-01]
 [-1.27530802e-01 -2.16934590e-01  3.57739557e-01]
 [ 4.92705128e-02 -2.34586389e-02  4.86308803e-02]
 [ 4.16648025e-02 -5.27380877e-01  3.89429612e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.27118322 -49.27387164 -49.25707411]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [   7.3268874   -15.90307369 -140.51672192]
init_Out:  [2.48374395]
Stock Position:  7.326887399052493
Bond position:  [-730.20499595]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [4.26660018]
curr_Stock_Price:  100.26824901103284
curr_Factors:  [100.26824901  -0.7703263   -1.03349499]
mat_Sqrt:  [[16.51101604  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00028739  0.00798875 -0.14225297]
Stock Position:  0.0002873858593634368
Bond Position:  [4.2377845]


portfolio before change:  [4.26804283]
curr_Stock_Price:  101.60121567701408
curr_Factors:  [101.60121568  -0.41748147  -1.00575477]
mat_Sqrt:  [[24.47908943  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.13808538 -1.08452278 -2.73542632]
Stock Position:  -0.13808538307799964
Bond Position:  [18.29768562]


portfolio before change:  [4.10355527]
curr_Stock_Price:  102.82554918683618
curr_Factors:  [102.82554919  -0.3194655   -1.04759573]
mat_Sqrt:  [[26.20558692  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01167549 -0.0554961   0.57533372]
Stock Position:  -0.011675485296752967
Bond Position:  [5.30409345]


portfolio before change:  [4.12134552]
curr_Stock_Price:  101.41540924615053
curr_Factors:  [101.41540925  -0.12882352  -1.07078851]
mat_Sqrt:  [[30.55758744  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.02860741 -0.0124285  -1.55944287]
Stock Position:  0.02860741027157127
Bond Position:  [1.2201133]


portfolio before change:  [4.20940119]
curr_Stock_Price:  104.48281739332302
curr_Factors:  [104.48281739  -0.3384747   -1.04416076]
mat_Sqrt:  [[26.21645269  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00549998 0.07202172 0.15968747]
Stock Position:  0.005499984501332019
Bond Position:  [3.63474732]


portfolio before change:  [4.20965118]
curr_Stock_Price:  104.36303351574219
curr_Factors:  [104.36303352  -0.48343673  -1.05006878]
mat_Sqrt:  [[22.51923933  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00282729 -0.03223368  0.0754263 ]
Stock Position:  0.0028272890850826794
Bond Position:  [3.91458672]


portfolio before change:  [4.20404086]
curr_Stock_Price:  102.03249933408205
curr_Factors:  [102.03249933  -0.44108476  -1.00796954]
mat_Sqrt:  [[23.95643771  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01044323 0.11824379 0.73972072]
Stock Position:  0.010443231065684637
Bond Position:  [3.13849189]


portfolio before change:  [4.18956586]
curr_Stock_Price:  100.57129279717034
curr_Factors:  [100.5712928   -0.34109581  -1.05482357]
mat_Sqrt:  [[24.90198396  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00408481  0.03347435 -0.20264275]
Stock Position:  0.004084812434495755
Bond Position:  [3.778751]


portfolio before change:  [4.21446047]
curr_Stock_Price:  106.43442643660518
curr_Factors:  [106.43442644  -0.43619133  -1.06803469]
mat_Sqrt:  [[23.64857994  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.07999939 -0.21591283 -0.205725  ]
Stock Position:  -0.07999938691803778
Bond Position:  [12.72914933]


portfolio before change:  [4.22387615]
curr_Stock_Price:  106.35651344505706
curr_Factors:  [106.35651345  -0.42410357  -1.08387036]
mat_Sqrt:  [[23.54286646  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00407419 -0.02142964  0.0763291 ]
Stock Position:  0.004074188881004274
Bond Position:  [3.79055962]


portfolio before change:  [4.23006686]
curr_Stock_Price:  107.64338382213458
curr_Factors:  [107.64338382  -0.71882943  -1.07576145]
mat_Sqrt:  [[17.88983864  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00455511  0.03038487  0.06763759]
Stock Position:  -0.004555114846414897
Bond Position:  [4.72039483]


portfolio before change:  [4.23056147]
curr_Stock_Price:  107.7939042094394
curr_Factors:  [107.79390421  -0.40944161  -1.0839429 ]
mat_Sqrt:  [[24.2117149   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.04226958 -0.34806764  0.89968199]
Stock Position:  -0.042269583059582005
Bond Position:  [8.78696485]


portfolio before change:  [4.17772089]
curr_Stock_Price:  109.09596566017542
curr_Factors:  [109.09596566  -0.28931056  -1.08111024]
mat_Sqrt:  [[27.71038112  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00238191 -0.0274547   0.16820345]
Stock Position:  -0.0023819061275363856
Bond Position:  [4.43757724]


portfolio before change:  [4.17904818]
curr_Stock_Price:  109.00454152189927
curr_Factors:  [109.00454152  -0.27127625  -1.03053836]
mat_Sqrt:  [[29.65334526  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00764771 -0.08261499  0.2807363 ]
Stock Position:  -0.007647707348371677
Bond Position:  [5.01268302]


portfolio before change:  [4.18454884]
curr_Stock_Price:  108.44916938321408
curr_Factors:  [108.44916938  -0.47369297  -1.03873108]
mat_Sqrt:  [[23.89949968  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00581809 0.00499309 0.09419876]
Stock Position:  0.005818090523284029
Bond Position:  [3.55358175]


portfolio before change:  [4.19010521]
curr_Stock_Price:  109.25147226609124
curr_Factors:  [109.25147227  -0.93396961  -1.06385923]
mat_Sqrt:  [[14.81771572  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01892159 -0.06517287 -0.62026997]
Stock Position:  -0.018921592281942675
Bond Position:  [6.25731703]


portfolio before change:  [4.20459719]
curr_Stock_Price:  108.56826086707517
curr_Factors:  [108.56826087  -0.54967037  -1.10148532]
mat_Sqrt:  [[20.82644187  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00474345 -0.07001534  1.02053138]
Stock Position:  -0.0047434462917325905
Bond Position:  [4.7195849]


portfolio before change:  [4.1998265]
curr_Stock_Price:  109.82277765781458
curr_Factors:  [109.82277766  -0.36775759  -1.09081333]
mat_Sqrt:  [[25.54130717  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00213023 -0.00757124  0.13873037]
Stock Position:  0.0021302267204232244
Bond Position:  [3.96587908]


portfolio before change:  [4.20491063]
curr_Stock_Price:  111.74395167748268
curr_Factors:  [111.74395168  -0.49750392  -1.135109  ]
mat_Sqrt:  [[21.83681241  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00265777 -0.17021145  0.11109343]
Stock Position:  -0.0026577674619643506
Bond Position:  [4.50190006]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [4.19865301]
Stock Price:  114.52193551441395
PL:  [-10.32328251]
Settle:  Tensor("sub_362:0", shape=(), dtype=float64)
PL:  Tensor("sub_363:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  182
output_Z_Vals[:, i, :]:  [[ 1.19271183e+02 -4.92738716e+01 -4.92570741e+01]
 [ 1.72705542e-02  3.66399830e-02 -4.64319693e-02]
 [-2.55653710e+00 -3.43758379e+00 -9.81248183e-01]
 [-6.10681639e-02  2.62296686e-02 -1.37311015e-01]
 [ 6.60602844e-01  1.30682739e-02 -1.80379709e-01]
 [-1.40765072e-01 -2.44219803e-01  6.35490121e-02]
 [-5.07771156e-02  1.10320254e-01 -5.24437259e-02]
 [ 1.27781312e-01  3.38309180e-01  2.07760371e-01]
 [-4.38301531e-01  6.56406332e-01 -9.74507617e-02]
 [-2.08527866e-01 -5.52955845e-02  4.73193821e-03]
 [-9.33381533e-02 -3.11926211e-02 -3.43976840e-01]
 [ 4.99446589e-01  2.52593148e-01 -5.49479546e-03]
 [-6.87750426e-01 -9.25222374e-01  2.24945767e-01]
 [ 2.42717623e-01  4.74696079e-02  1.06179938e-01]
 [ 1.47244329e-01  1.57405581e-01 -1.06363732e-01]
 [-3.18495478e-01  1.70305267e-01  9.23663197e-02]
 [ 1.18690300e-02  1.09468155e-01  1.33253033e-01]
 [ 1.12979362e-01 -1.14966140e-02 -2.52645223e-02]
 [-6.27046583e-02 -2.72289586e-01  6.21963771e-02]
 [ 4.46016839e-02 -3.55908015e-01 -3.70657437e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.27118322 -49.27387164 -49.25707411]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [   7.3268874   -15.90307369 -140.51672192]
init_Out:  [2.48374395]
Stock Position:  7.326887399052493
Bond position:  [-730.20499595]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [2.60724427]
curr_Stock_Price:  100.04177413505073
curr_Factors:  [100.04177414  -0.75001411  -0.9970165 ]
mat_Sqrt:  [[17.4363521   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00087586  0.0118255  -0.13245748]
Stock Position:  0.0008758582809017342
Bond Position:  [2.51962185]


portfolio before change:  [2.60789663]
curr_Stock_Price:  100.06733020653222
curr_Factors:  [100.06733021  -0.43126319  -0.98085978]
mat_Sqrt:  [[24.37895593  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.14186528 -1.1094754  -2.79922794]
Stock Position:  -0.14186527957712716
Bond Position:  [16.80397641]


portfolio before change:  [2.85025868]
curr_Stock_Price:  98.38855066276219
curr_Factors:  [98.38855066 -0.22633068 -0.99735114]
mat_Sqrt:  [[28.94051785  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00289361  0.00846559 -0.39171011]
Stock Position:  -0.00289360920338799
Bond Position:  [3.1349567]


portfolio before change:  [2.86097263]
curr_Stock_Price:  94.95681056643923
curr_Factors:  [94.95681057 -0.10792704 -0.96835759]
mat_Sqrt:  [[32.36694003  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01935464  0.00421777 -0.5145731 ]
Stock Position:  0.0193546421064978
Bond Position:  [1.02311755]


portfolio before change:  [2.88982444]
curr_Stock_Price:  96.43428540475254
curr_Factors:  [ 9.64342854e+01  8.64347717e-02 -9.72710742e-01]
mat_Sqrt:  [[39.7490454   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00446915 -0.0788216   0.18128764]
Stock Position:  -0.00446914738492734
Bond Position:  [3.32080348]


portfolio before change:  [2.89454466]
curr_Stock_Price:  95.56389210276748
curr_Factors:  [95.5638921   0.16045759 -0.95535154]
mat_Sqrt:  [[43.15943739  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00090277  0.03560571 -0.14960735]
Stock Position:  -0.0009027717033935057
Bond Position:  [2.98081704]


portfolio before change:  [2.9009587]
curr_Stock_Price:  89.28463322007134
curr_Factors:  [89.28463322  0.49882453 -0.93653009]
mat_Sqrt:  [[57.63464308  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.0041511  0.10918882 0.59268251]
Stock Position:  0.00415110217440155
Bond Position:  [2.53032906]


portfolio before change:  [2.89934905]
curr_Stock_Price:  88.74446256222912
curr_Factors:  [88.74446256  0.37990842 -0.93088669]
mat_Sqrt:  [[51.15103675  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00633819  0.21185423 -0.2779999 ]
Stock Position:  -0.0063381941657353336
Bond Position:  [3.46182869]


portfolio before change:  [2.91444128]
curr_Stock_Price:  86.49987033881294
curr_Factors:  [86.49987034  0.44933953 -0.89042366]
mat_Sqrt:  [[55.64870363  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00393269 -0.01784657  0.0134989 ]
Stock Position:  -0.003932690486796559
Bond Position:  [3.2546185]


portfolio before change:  [2.89101464]
curr_Stock_Price:  92.66369097566215
curr_Factors:  [92.66369098  0.29322772 -0.88602984]
mat_Sqrt:  [[51.22227978  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00331729 -0.01006738 -0.98127018]
Stock Position:  -0.0033172927777447266
Bond Position:  [3.19840723]


portfolio before change:  [2.89682247]
curr_Stock_Price:  91.15398628740535
curr_Factors:  [ 9.11539863e+01  4.30559070e-02 -9.03510939e-01]
mat_Sqrt:  [[38.55536274  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01426223  0.08152409 -0.01567512]
Stock Position:  0.01426222682471411
Bond Position:  [1.59676364]


portfolio before change:  [2.91576437]
curr_Stock_Price:  92.45410961929227
curr_Factors:  [ 9.24541096e+01 -1.27586669e-02 -8.79347811e-01]
mat_Sqrt:  [[37.8869199   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02192561 -0.29861424  0.64170766]
Stock Position:  -0.02192560893301852
Bond Position:  [4.94287702]


portfolio before change:  [2.90936964]
curr_Stock_Price:  92.80213203286742
curr_Factors:  [92.80213203 -0.2153085  -0.8827614 ]
mat_Sqrt:  [[30.95082676  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00885538 0.01532075 0.30290181]
Stock Position:  0.008855375892415161
Bond Position:  [2.08757188]


portfolio before change:  [2.89227745]
curr_Stock_Price:  90.81304105930175
curr_Factors:  [90.81304106 -0.31187676 -0.87941211]
mat_Sqrt:  [[27.59167312  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00571416  0.05080243 -0.30342612]
Stock Position:  0.005714158848288533
Bond Position:  [2.37335731]


portfolio before change:  [2.9052558]
curr_Stock_Price:  92.98045273097303
curr_Factors:  [ 9.29804527e+01 -5.21360059e-02 -8.63076337e-01]
mat_Sqrt:  [[37.23231038  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00711419  0.05496579  0.2634954 ]
Stock Position:  -0.00711419360205455
Bond Position:  [3.56673674]


portfolio before change:  [2.89077846]
curr_Stock_Price:  95.14079989500176
curr_Factors:  [95.1407999  -0.32087668 -0.87868504]
mat_Sqrt:  [[28.66842012  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00214223 0.0353307  0.38013381]
Stock Position:  0.0021422277436724596
Bond Position:  [2.6869652]


portfolio before change:  [2.88741657]
curr_Stock_Price:  93.2578457708715
curr_Factors:  [93.25784577 -0.71111986 -0.85973231]
mat_Sqrt:  [[19.38531897  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.005441   -0.00371052 -0.07207265]
Stock Position:  0.005441000328021845
Bond Position:  [2.3800006]


portfolio before change:  [2.89496408]
curr_Stock_Price:  94.53563116149351
curr_Factors:  [94.53563116 -0.94168407 -0.88737937]
mat_Sqrt:  [[15.17900725  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0069563  -0.08788109  0.17742895]
Stock Position:  -0.0069563017626533006
Bond Position:  [3.55258246]


portfolio before change:  [2.90756748]
curr_Stock_Price:  92.85152604963783
curr_Factors:  [92.85152605 -0.45222686 -0.85816591]
mat_Sqrt:  [[25.04336573  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00414113 -0.11486882 -1.0573825 ]
Stock Position:  -0.004141131388247227
Bond Position:  [3.29207785]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [2.92987104]
Stock Price:  87.66443218259938
PL:  [2.92987104]
Settle:  Tensor("sub_364:0", shape=(), dtype=float64)
PL:  Tensor("sub_365:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  183
output_Z_Vals[:, i, :]:  [[ 1.19271183e+02 -4.92738716e+01 -4.92570741e+01]
 [ 1.33817853e-02  3.03922383e-02 -4.82366083e-02]
 [-2.27248258e+00 -3.05878978e+00 -8.71670089e-01]
 [-5.55634396e-02  1.44431860e-01  3.86046138e-02]
 [ 6.62280361e-01  1.45365156e-02 -4.45507744e-01]
 [ 7.57175145e-02  1.17192732e-01 -6.73936232e-03]
 [ 1.90213175e-02  3.67075288e-02  1.13319684e-01]
 [ 6.88346397e-02  1.70850374e-01  6.83500786e-02]
 [ 2.51314361e-02 -9.52232080e-02 -7.69753293e-03]
 [-1.09010931e+00 -4.46909480e-01 -3.95174448e-02]
 [ 4.05929950e-01  8.51807732e-02  9.50805238e-03]
 [ 6.58713600e-02 -5.84968169e-02  3.78169653e-02]
 [-6.88554862e-01 -1.26615962e+00  2.41894951e-01]
 [ 1.36392805e-02  2.98950083e-02  7.30836331e-02]
 [ 1.45840495e-01  1.18977241e-01 -1.06784554e-01]
 [ 1.85919404e-02  4.52289215e-02  8.53660509e-02]
 [ 1.24778760e-01  1.15461364e-01  1.03002699e-01]
 [ 9.68981984e-02 -1.63187870e-02  1.95334270e-02]
 [-4.45675293e-02 -4.05283888e-02 -3.09346189e-02]
 [ 6.71254701e-02 -5.06328701e-01 -5.30401179e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.27118322 -49.27387164 -49.25707411]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [   7.3268874   -15.90307369 -140.51672192]
init_Out:  [2.48374395]
Stock Position:  7.326887399052493
Bond position:  [-730.20499595]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [2.81980575]
curr_Stock_Price:  100.07078529291289
curr_Factors:  [100.07078529  -0.67777068  -0.99340833]
mat_Sqrt:  [[18.81583457  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00051761  0.00980905 -0.13760562]
Stock Position:  0.0005176128924756333
Bond Position:  [2.76800782]


portfolio before change:  [2.82102212]
curr_Stock_Price:  101.08365508312181
curr_Factors:  [101.08365508  -0.86826609  -0.96330516]
mat_Sqrt:  [[16.18973162  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.18992188 -0.98722016 -2.48663214]
Stock Position:  -0.18992188491234102
Bond Position:  [22.01902042]


portfolio before change:  [2.74361219]
curr_Stock_Price:  101.5202312357398
curr_Factors:  [101.52023124  -1.21999803  -0.95293736]
mat_Sqrt:  [[11.55736285  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00157486  0.04661518  0.11012822]
Stock Position:  -0.0015748640926086094
Bond Position:  [2.90349276]


portfolio before change:  [2.74520234]
curr_Stock_Price:  100.9714929404241
curr_Factors:  [100.97149294  -1.09465294  -0.97227466]
mat_Sqrt:  [[12.78037294  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.04493677  0.00469164 -1.27090959]
Stock Position:  0.04493677378462916
Bond Position:  [-1.79213079]


portfolio before change:  [2.78081938]
curr_Stock_Price:  101.77406766782366
curr_Factors:  [101.77406767  -1.02522022  -0.9526342 ]
mat_Sqrt:  [[14.08204975  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00697794  0.03782379 -0.01922552]
Stock Position:  0.006977941131427943
Bond Position:  [2.07064592]


portfolio before change:  [2.78295581]
curr_Stock_Price:  102.006042141511
curr_Factors:  [102.00604214  -0.8429441   -0.91727916]
mat_Sqrt:  [[17.54569802  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.0028295  0.0118473  0.32326952]
Stock Position:  0.002829496668627606
Bond Position:  [2.49433005]


portfolio before change:  [2.78055953]
curr_Stock_Price:  100.93873767331615
curr_Factors:  [100.93873767  -0.99125214  -0.89676252]
mat_Sqrt:  [[15.27930234  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00770069 0.05514172 0.19498375]
Stock Position:  0.007700693719539326
Bond Position:  [2.00326123]


portfolio before change:  [2.78279813]
curr_Stock_Price:  101.16439595575827
curr_Factors:  [101.16439596  -0.98953834  -0.89466014]
mat_Sqrt:  [[15.37201125  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0002682  -0.03073316 -0.02195892]
Stock Position:  0.0002682035392491288
Bond Position:  [2.75566549]


portfolio before change:  [2.78345798]
curr_Stock_Price:  101.05568820097854
curr_Factors:  [101.0556882   -0.95799704  -0.91542898]
mat_Sqrt:  [[15.52180346  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.07662774 -0.14423941 -0.11273227]
Stock Position:  -0.07662774483772322
Bond Position:  [10.52712747]


portfolio before change:  [2.78097851]
curr_Stock_Price:  101.12239483068186
curr_Factors:  [101.12239483  -1.3352817   -0.96254384]
mat_Sqrt:  [[10.16048388  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.04185413 0.02749198 0.02712383]
Stock Position:  0.04185413120041048
Bond Position:  [-1.45141147]


portfolio before change:  [2.75625769]
curr_Stock_Price:  100.54042305488635
curr_Factors:  [100.54042305  -1.67753238  -0.92565114]
mat_Sqrt:  [[ 7.44376184  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00828212 -0.01887977  0.10788128]
Stock Position:  0.008282116524800513
Bond Position:  [1.92357019]


portfolio before change:  [2.75507651]
curr_Stock_Price:  100.33973303637792
curr_Factors:  [100.33973304  -1.7351608   -0.91705772]
mat_Sqrt:  [[ 7.07341388  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.12690223 -0.40865126  0.69005897]
Stock Position:  -0.1269022324011038
Bond Position:  [15.48841263]


portfolio before change:  [2.84307902]
curr_Stock_Price:  99.67678230764844
curr_Factors:  [99.67678231 -1.74994575 -0.93795751]
mat_Sqrt:  [[ 6.78035536  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00511178 0.00964857 0.20848726]
Stock Position:  0.005111783347808886
Bond Position:  [2.33355291]


portfolio before change:  [2.84774415]
curr_Stock_Price:  100.47526441584324
curr_Factors:  [100.47526442  -1.96698378  -0.96442215]
mat_Sqrt:  [[ 5.35754386  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.02768607  0.03839974 -0.30462661]
Stock Position:  0.027686066838277255
Bond Position:  [0.06597926]


portfolio before change:  [2.84386711]
curr_Stock_Price:  100.33463286201254
curr_Factors:  [100.33463286  -1.38694941  -0.95261705]
mat_Sqrt:  [[ 9.66918928  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00467976 0.01459757 0.24352558]
Stock Position:  0.004679764369019156
Bond Position:  [2.37432467]


portfolio before change:  [2.83992757]
curr_Stock_Price:  99.36595252796569
curr_Factors:  [99.36595253 -1.24335343 -0.93457332]
mat_Sqrt:  [[11.25579124  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01504759 0.03726499 0.29383803]
Stock Position:  0.015047591650955325
Bond Position:  [1.34470929]


portfolio before change:  [2.8527681]
curr_Stock_Price:  100.19693645108478
curr_Factors:  [100.19693645  -1.11797115  -0.93929703]
mat_Sqrt:  [[12.80543166  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0076182  -0.00526687  0.05572343]
Stock Position:  0.0076182034792795505
Bond Position:  [2.08944745]


portfolio before change:  [2.85152427]
curr_Stock_Price:  99.9650892752056
curr_Factors:  [99.96508928 -0.86756337 -0.9448962 ]
mat_Sqrt:  [[16.31951209  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00362479 -0.01308048 -0.08824786]
Stock Position:  -0.003624793089388794
Bond Position:  [3.21387703]


portfolio before change:  [2.85666013]
curr_Stock_Price:  98.76990679435879
curr_Factors:  [98.76990679 -0.72579606 -0.94485794]
mat_Sqrt:  [[18.58098923  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00777656 -0.16341689 -1.51308693]
Stock Position:  -0.007776557461649863
Bond Position:  [3.62474998]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [2.85541764]
Stock Price:  99.04622323009956
PL:  [2.85541764]
Settle:  Tensor("sub_366:0", shape=(), dtype=float64)
PL:  Tensor("sub_367:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  184
output_Z_Vals[:, i, :]:  [[ 1.19271183e+02 -4.92738716e+01 -4.92570741e+01]
 [ 7.51406997e-04  5.80157104e-03 -5.77516033e-02]
 [-2.53277996e+00 -3.45281308e+00 -9.87579402e-01]
 [ 2.44066113e-02  1.16565016e-01 -9.48074088e-02]
 [ 8.76392412e-01 -7.90266102e-02 -4.68782228e-01]
 [ 8.22201608e-02  1.77354888e-01  2.97237780e-02]
 [ 1.16820765e-02  2.55596553e-02  9.88348935e-02]
 [ 8.23493401e-02  2.05883984e-01  8.44963801e-02]
 [ 7.52990177e-02  3.39486433e-02 -5.12049183e-02]
 [-1.06925177e+00 -4.38027990e-01 -3.84623798e-02]
 [ 3.44426997e-01  3.25823343e-02 -4.65441199e-02]
 [ 3.66641113e-02 -6.71280136e-02  3.72488550e-02]
 [-6.50077722e-01 -1.24435382e+00  2.30271419e-01]
 [-5.83892562e-03  1.21116894e-02  3.45268540e-02]
 [ 1.06365724e-01  1.30262059e-01 -1.05325427e-01]
 [ 7.59763231e-02  2.97832139e-02  5.81968469e-02]
 [ 6.53222058e-02  5.27835890e-02  3.60162877e-02]
 [ 8.36325260e-02 -2.84533248e-02  3.54233436e-02]
 [-4.41321708e-02 -2.21053541e-02 -4.19151986e-02]
 [ 9.03065533e-02 -7.02889308e-01 -6.34484377e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.27118322 -49.27387164 -49.25707411]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [   7.3268874   -15.90307369 -140.51672192]
init_Out:  [2.48374395]
Stock Position:  7.326887399052493
Bond position:  [-730.20499595]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [7.99532868]
curr_Stock_Price:  100.77715931601186
curr_Factors:  [100.77715932  -0.9085532   -1.01127142]
mat_Sqrt:  [[14.77722463  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00066676  0.00187245 -0.16474925]
Stock Position:  -0.0006667590960217518
Bond Position:  [8.06252277]


portfolio before change:  [7.99836041]
curr_Stock_Price:  99.25359843603341
curr_Factors:  [99.25359844 -0.44529353 -0.9848677 ]
mat_Sqrt:  [[23.7484424   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.14481671 -1.11439063 -2.81728915]
Stock Position:  -0.14481670919661468
Bond Position:  [22.37193991]


portfolio before change:  [7.93738742]
curr_Stock_Price:  99.7132600243418
curr_Factors:  [99.71326002 -0.47100658 -0.97523314]
mat_Sqrt:  [[23.4778857   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00122872  0.0376212  -0.27045915]
Stock Position:  0.001228724962602273
Bond Position:  [7.81486725]


portfolio before change:  [7.94003122]
curr_Stock_Price:  100.27469111015006
curr_Factors:  [100.27469111  -0.51796921  -0.9855109 ]
mat_Sqrt:  [[22.29657815  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.03429097 -0.02550573 -1.33730521]
Stock Position:  0.03429097487291894
Bond Position:  [4.50151431]


portfolio before change:  [8.00429787]
curr_Stock_Price:  102.11602477371538
curr_Factors:  [102.11602477  -0.34848813  -0.97207494]
mat_Sqrt:  [[27.26343962  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00456619 0.05724104 0.08479367]
Stock Position:  0.004566185275866822
Bond Position:  [7.53801718]


portfolio before change:  [7.99739252]
curr_Stock_Price:  100.19098570280495
curr_Factors:  [100.1909857   -0.57089631  -0.9437133 ]
mat_Sqrt:  [[22.03139785  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00168278 0.00824934 0.28194844]
Stock Position:  0.001682780533001588
Bond Position:  [7.82879308]


portfolio before change:  [7.99944655]
curr_Stock_Price:  100.24838049175132
curr_Factors:  [100.24838049  -0.93911249  -0.92851655]
mat_Sqrt:  [[15.4873238   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00914445 0.06644877 0.24104465]
Stock Position:  0.009144445192697567
Bond Position:  [7.08273073]


portfolio before change:  [8.00805673]
curr_Stock_Price:  100.99629605243997
curr_Factors:  [100.99629605  -0.70356032  -0.94658819]
mat_Sqrt:  [[19.39344912  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00370107  0.01095688 -0.14607338]
Stock Position:  0.0037010742577148295
Bond Position:  [7.63426193]


portfolio before change:  [8.00844821]
curr_Stock_Price:  100.58632983001964
curr_Factors:  [100.58632983  -0.91361842  -0.96008271]
mat_Sqrt:  [[15.44546181  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.07552477 -0.14137293 -0.10972246]
Stock Position:  -0.07552477060067098
Bond Position:  [15.6052077]


portfolio before change:  [8.02917051]
curr_Stock_Price:  100.36361479385724
curr_Factors:  [100.36361479  -1.02672692  -0.9543978 ]
mat_Sqrt:  [[13.84155116  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.02467766  0.0105159  -0.13277742]
Stock Position:  0.02467765751927646
Bond Position:  [5.55243159]


portfolio before change:  [8.0153685]
curr_Stock_Price:  99.7480667753423
curr_Factors:  [99.74806678 -1.23611452 -0.905767  ]
mat_Sqrt:  [[11.71378269  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00260932 -0.02166547  0.10626062]
Stock Position:  0.0026093239408819624
Bond Position:  [7.75509349]


portfolio before change:  [8.01874657]
curr_Stock_Price:  100.29956841123324
curr_Factors:  [100.29956841  -1.30713127  -0.94150427]
mat_Sqrt:  [[10.58593088  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.08096373 -0.40161347  0.65690026]
Stock Position:  -0.08096372772127852
Bond Position:  [16.13937351]


portfolio before change:  [7.94227574]
curr_Stock_Price:  101.2939170765868
curr_Factors:  [101.29391708  -1.19391901  -0.93646042]
mat_Sqrt:  [[12.03292842  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00030592 0.00390903 0.0984955 ]
Stock Position:  0.00030592113951869246
Bond Position:  [7.91128779]


portfolio before change:  [7.94434311]
curr_Stock_Price:  101.58582724773291
curr_Factors:  [101.58582725  -0.94763844  -0.916967  ]
mat_Sqrt:  [[15.74146939  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0070804   0.0420419  -0.30046413]
Stock Position:  0.007080399511944311
Bond Position:  [7.22507487]


portfolio before change:  [7.9508097]
curr_Stock_Price:  102.24399626644409
curr_Factors:  [102.24399627  -1.06926874  -0.93054861]
mat_Sqrt:  [[13.8397478   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00678735 0.00961249 0.16601941]
Stock Position:  0.006787347511545895
Bond Position:  [7.25684417]


portfolio before change:  [7.95316225]
curr_Stock_Price:  102.32327679414281
curr_Factors:  [102.32327679  -0.83322456  -0.96283893]
mat_Sqrt:  [[16.98063706  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00491433 0.01703583 0.10274444]
Stock Position:  0.004914327088021864
Bond Position:  [7.4503122]


portfolio before change:  [7.95064907]
curr_Stock_Price:  101.43282182167142
curr_Factors:  [101.43282182  -0.91941427  -0.90886336]
mat_Sqrt:  [[16.29925016  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00521836 -0.00918327  0.10105294]
Stock Position:  0.005218355094047952
Bond Position:  [7.42133659]


portfolio before change:  [7.94566278]
curr_Stock_Price:  100.12170884330365
curr_Factors:  [100.12170884  -1.27743534  -0.92506636]
mat_Sqrt:  [[11.06608284  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00516898 -0.00713447 -0.11957239]
Stock Position:  -0.005168975534945196
Bond Position:  [8.46318945]


portfolio before change:  [7.95188912]
curr_Stock_Price:  99.32652817556854
curr_Factors:  [99.32652818 -1.3210165  -0.90477333]
mat_Sqrt:  [[10.72548682  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01703267 -0.22685655 -1.81000732]
Stock Position:  -0.017032672742584694
Bond Position:  [9.64368536]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [7.95904408]
Stock Price:  99.04801985119163
PL:  [7.95904408]
Settle:  Tensor("sub_368:0", shape=(), dtype=float64)
PL:  Tensor("sub_369:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  185
output_Z_Vals[:, i, :]:  [[ 1.19271183e+02 -4.92738716e+01 -4.92570741e+01]
 [ 2.32653313e-02  4.62712670e-02 -4.36500069e-02]
 [-2.17856559e+00 -2.93354905e+00 -8.35440266e-01]
 [ 5.37113320e-02  1.51082449e-01 -7.43053020e-02]
 [ 5.57558804e-01 -6.62383230e-02 -3.27257702e-01]
 [-2.41908552e-02 -3.12280258e-02  1.29590697e-02]
 [ 3.60160344e-03  2.77023250e-02  4.69312534e-02]
 [-3.91858411e-02 -2.83402707e-02 -3.39677860e-02]
 [ 1.38830614e-02 -1.24185604e-01  2.05751917e-03]
 [-1.02513417e+00 -4.10699960e-01 -3.64122990e-02]
 [ 3.92276982e-01  6.91964061e-02 -6.52511928e-03]
 [ 3.86180567e-02 -6.65505923e-02  3.72868612e-02]
 [-6.16305036e-01 -1.26379424e+00  2.19114493e-01]
 [-8.42190662e-03  9.75346528e-03  2.94138868e-02]
 [ 1.38731569e-01  1.17726196e-01 -1.06898367e-01]
 [ 8.45133749e-02  2.74853622e-02  5.41548952e-02]
 [ 1.12275203e-01  9.87803488e-02  8.19010550e-02]
 [ 9.41519927e-02 -1.71411518e-02  2.72313384e-02]
 [-3.78361520e-02 -2.60226321e-02 -3.10213797e-02]
 [ 1.12743788e-01 -8.77537584e-01 -6.02287538e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.27118322 -49.27387164 -49.25707411]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [   7.3268874   -15.90307369 -140.51672192]
init_Out:  [2.48374395]
Stock Position:  7.326887399052493
Bond position:  [-730.20499595]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [4.0913055]
curr_Stock_Price:  100.24432416151959
curr_Factors:  [100.24432416  -1.0200088   -0.99080232]
mat_Sqrt:  [[13.42071388  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00177341  0.01493399 -0.12452132]
Stock Position:  0.0017734074325939052
Bond Position:  [3.91353147]


portfolio before change:  [4.09165961]
curr_Stock_Price:  99.89223508375444
curr_Factors:  [99.89223508 -1.07032593 -0.99411073]
mat_Sqrt:  [[12.67530107  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.23257099 -0.94679889 -2.38327854]
Stock Position:  -0.23257098985229813
Bond Position:  [27.3236956]


portfolio before change:  [4.15811186]
curr_Stock_Price:  99.63588121267206
curr_Factors:  [99.63588121 -0.92187243 -0.98778675]
mat_Sqrt:  [[14.75914914  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00470104  0.04876165 -0.21197234]
Stock Position:  0.0047010434609422915
Bond Position:  [3.68971925]


portfolio before change:  [4.15883458]
curr_Stock_Price:  99.593373917991
curr_Factors:  [99.59337392 -0.93589333 -0.99684353]
mat_Sqrt:  [[14.41628943  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.03310399 -0.02137833 -0.93357513]
Stock Position:  0.03310399435175943
Bond Position:  [0.86189609]


portfolio before change:  [4.17968533]
curr_Stock_Price:  100.21672030010606
curr_Factors:  [100.2167203   -1.19350933  -0.99248566]
mat_Sqrt:  [[11.26093946  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00247937 -0.0100788   0.03696862]
Stock Position:  -0.0024793659853996654
Bond Position:  [4.42815926]


portfolio before change:  [4.18000552]
curr_Stock_Price:  100.53413799836343
curr_Factors:  [100.534138    -1.32949589  -1.04765639]
mat_Sqrt:  [[ 9.33102693  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00201865 0.00894089 0.1338818 ]
Stock Position:  0.0020186544278208173
Bond Position:  [3.97706183]


portfolio before change:  [4.18138476]
curr_Stock_Price:  100.72478657813149
curr_Factors:  [100.72478658  -1.93663958  -1.01027853]
mat_Sqrt:  [[ 5.28817821  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00981518 -0.00914678 -0.09690064]
Stock Position:  -0.009815179795308068
Bond Position:  [5.17001665]


portfolio before change:  [4.18239666]
curr_Stock_Price:  100.75339139909379
curr_Factors:  [100.7533914   -1.67221751  -0.99132839]
mat_Sqrt:  [[ 7.02257503  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00157296 -0.04008073  0.00586953]
Stock Position:  -0.0015729599971139052
Bond Position:  [4.34087772]


portfolio before change:  [4.18376008]
curr_Stock_Price:  100.57661604007684
curr_Factors:  [100.57661604  -1.41860508  -0.94676736]
mat_Sqrt:  [[ 9.44558413  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.11819286 -0.13255284 -0.10387415]
Stock Position:  -0.11819285767163047
Bond Position:  [16.07119775]


portfolio before change:  [4.1470635]
curr_Stock_Price:  100.92109443629286
curr_Factors:  [100.92109444  -1.20226254  -0.94643475]
mat_Sqrt:  [[11.77103297  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.03441242  0.02233304 -0.01861435]
Stock Position:  0.03441241780262488
Bond Position:  [0.67412463]


portfolio before change:  [4.13123128]
curr_Stock_Price:  100.45612366448196
curr_Factors:  [100.45612366  -1.14821914  -0.93907413]
mat_Sqrt:  [[12.4588073   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0026202  -0.02147911  0.10636904]
Stock Position:  0.0026202044684706842
Bond Position:  [3.8680157]


portfolio before change:  [4.13050122]
curr_Stock_Price:  99.8083940041469
curr_Factors:  [99.808394   -1.05558829 -0.94957152]
mat_Sqrt:  [[13.43808016  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.06173124 -0.40788784  0.62507266]
Stock Position:  -0.061731243314317404
Bond Position:  [10.29179748]


portfolio before change:  [4.04378244]
curr_Stock_Price:  101.2548584239964
curr_Factors:  [101.25485842  -1.75136004  -0.97252656]
mat_Sqrt:  [[ 6.64426506  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-6.42515524e-05  3.14791738e-03  8.39096319e-02]
Stock Position:  -6.425155238938107e-05
Bond Position:  [4.05028823]


portfolio before change:  [4.044843]
curr_Stock_Price:  100.51005749015177
curr_Factors:  [100.51005749  -1.66968363  -0.97534324]
mat_Sqrt:  [[ 7.13656045  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01974926  0.03799597 -0.30495129]
Stock Position:  0.01974926041041366
Bond Position:  [2.0598437]


portfolio before change:  [4.05341919]
curr_Stock_Price:  100.91823323541021
curr_Factors:  [100.91823324  -1.67844901  -0.98323737]
mat_Sqrt:  [[ 7.04715678  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.0143573  0.00887086 0.15448884]
Stock Position:  0.014357296968095342
Bond Position:  [2.60450615]


portfolio before change:  [4.04563181]
curr_Stock_Price:  100.33047705799146
curr_Factors:  [100.33047706  -1.46509256  -0.94669667]
mat_Sqrt:  [[ 8.99510265  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01658198 0.03188122 0.23364091]
Stock Position:  0.01658198306896762
Bond Position:  [2.38195354]


portfolio before change:  [4.05163966]
curr_Stock_Price:  100.65687255486762
curr_Factors:  [100.65687255  -1.60417386  -0.94916238]
mat_Sqrt:  [[ 7.83327899  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01228242 -0.00553228  0.07768343]
Stock Position:  0.012282422666202305
Bond Position:  [2.8153294]


portfolio before change:  [4.05382716]
curr_Stock_Price:  100.777661219155
curr_Factors:  [100.77766122  -1.63942192  -1.01967778]
mat_Sqrt:  [[ 7.05556747  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00701293 -0.00839877 -0.08849536]
Stock Position:  -0.007012931611678128
Bond Position:  [4.760574]


portfolio before change:  [4.05268556]
curr_Stock_Price:  101.11017418426235
curr_Factors:  [101.11017418  -1.55663289  -1.02199189]
mat_Sqrt:  [[ 7.67206629  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02467709 -0.28322404 -1.7181587 ]
Stock Position:  -0.02467708735490862
Bond Position:  [6.54779016]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [4.04834385]
Stock Price:  101.35245789862657
PL:  [2.69588595]
Settle:  Tensor("sub_370:0", shape=(), dtype=float64)
PL:  Tensor("sub_371:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  186
output_Z_Vals[:, i, :]:  [[ 1.19271183e+02 -4.92738716e+01 -4.92570741e+01]
 [ 1.65558765e-02  3.54917729e-02 -4.67636257e-02]
 [-2.29382966e+00 -3.08725666e+00 -8.79905030e-01]
 [-2.66233996e-02  1.75903120e-01  2.07664638e-02]
 [ 7.46165406e-01  8.25817760e-03 -4.71871041e-01]
 [ 7.57175145e-02  1.17192732e-01 -6.73936232e-03]
 [-4.03570535e-03  2.83119958e-02  2.93841149e-02]
 [ 8.70126005e-02  2.04968087e-01  7.49200216e-02]
 [ 9.06705847e-02  7.62950489e-02 -6.23226164e-02]
 [-1.01448576e+00 -4.15778558e-01 -3.56693143e-02]
 [ 2.80724787e-01  2.90579470e-02 -6.92466554e-02]
 [ 4.51661081e-03 -6.12295986e-02  3.38214289e-02]
 [-5.44290989e-01 -1.26515881e+00  1.95676936e-01]
 [ 4.92893297e-02  6.09967305e-02  1.41500216e-01]
 [ 8.51509713e-02  1.24599035e-01 -1.02910636e-01]
 [-2.09790420e-01  1.18358488e-01  1.26115466e-01]
 [ 5.21878695e-02  1.19696866e-01  1.33469337e-01]
 [ 1.15216134e-01 -1.08333916e-02 -3.18137274e-02]
 [-5.54224503e-02 -1.84782229e-01  3.34743911e-02]
 [ 8.46189831e-02 -6.61643821e-01 -6.20717297e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.27118322 -49.27387164 -49.25707411]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [   7.3268874   -15.90307369 -140.51672192]
init_Out:  [2.48374395]
Stock Position:  7.326887399052493
Bond position:  [-730.20499595]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [3.40776362]
curr_Stock_Price:  100.15103190116082
curr_Factors:  [100.1510319   -0.80408789  -0.99213653]
mat_Sqrt:  [[16.61747647  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00085783  0.01145492 -0.13340361]
Stock Position:  0.0008578329681674903
Bond Position:  [3.32185076]


portfolio before change:  [3.40967859]
curr_Stock_Price:  101.41515633030548
curr_Factors:  [101.41515633  -0.77075538  -1.01092922]
mat_Sqrt:  [[17.07367746  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.18177825 -0.9964078  -2.51012413]
Stock Position:  -0.18177824652182667
Bond Position:  [21.84474788]


portfolio before change:  [3.40666975]
curr_Stock_Price:  101.46175547473393
curr_Factors:  [101.46175547  -0.83606148  -1.02939996]
mat_Sqrt:  [[15.70879104  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00086077 0.05677249 0.05924094]
Stock Position:  0.0008607671423922665
Bond Position:  [3.3193348]


portfolio before change:  [3.40726354]
curr_Stock_Price:  101.187413907528
curr_Factors:  [101.18741391  -0.54341141  -1.07601089]
mat_Sqrt:  [[20.03642923  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.03251731  0.00266532 -1.34611674]
Stock Position:  0.03251731229421718
Bond Position:  [0.1169208]


portfolio before change:  [3.40863937]
curr_Stock_Price:  101.22882559140155
curr_Factors:  [101.22882559  -0.80981637  -1.09218224]
mat_Sqrt:  [[15.11042571  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00650304  0.03782379 -0.01922552]
Stock Position:  0.006503040751117303
Bond Position:  [2.75034419]


portfolio before change:  [3.39857142]
curr_Stock_Price:  99.57488759080186
curr_Factors:  [99.57488759 -1.00768663 -1.02403243]
mat_Sqrt:  [[13.05525767  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00059298 0.00913766 0.0838247 ]
Stock Position:  0.0005929767233180466
Bond Position:  [3.33952583]


portfolio before change:  [3.39866384]
curr_Stock_Price:  98.32262418391431
curr_Factors:  [98.32262418 -0.94317944 -1.05832221]
mat_Sqrt:  [[13.28655345  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.0108489  0.06615317 0.21372597]
Stock Position:  0.010848902382621645
Bond Position:  [2.33197129]


portfolio before change:  [3.40798879]
curr_Stock_Price:  99.12840963570503
curr_Factors:  [99.12840964 -0.91313004 -1.03458886]
mat_Sqrt:  [[14.13561044  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00661611  0.02462412 -0.17778908]
Stock Position:  0.0066161058930520045
Bond Position:  [2.75214474]


portfolio before change:  [3.4109502]
curr_Stock_Price:  99.47200740379384
curr_Factors:  [99.4720074  -0.71829029 -1.02097102]
mat_Sqrt:  [[17.47226837  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.06333678 -0.13419195 -0.10175463]
Stock Position:  -0.0633367772827622
Bond Position:  [9.71118657]


portfolio before change:  [3.38441656]
curr_Stock_Price:  99.92927314266474
curr_Factors:  [99.92927314 -0.6142006  -1.01692082]
mat_Sqrt:  [[19.55715582  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01393461  0.00937841 -0.19754143]
Stock Position:  0.01393460807582638
Bond Position:  [1.9919413]


portfolio before change:  [3.37100845]
curr_Stock_Price:  98.93131495594743
curr_Factors:  [98.93131496 -0.33631037 -1.03108455]
mat_Sqrt:  [[25.20471047  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-4.27721005e-05 -1.97617680e-02  9.64831226e-02]
Stock Position:  -4.277210049257577e-05
Bond Position:  [3.37523995]


portfolio before change:  [3.37184753]
curr_Stock_Price:  99.04428953451105
curr_Factors:  [99.04428953 -0.40291667 -1.03474144]
mat_Sqrt:  [[23.52136138  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.03242151 -0.40832825  0.55821183]
Stock Position:  -0.03242151039261954
Bond Position:  [6.58301299]


portfolio before change:  [3.3992204]
curr_Stock_Price:  98.25077590833472
curr_Factors:  [98.25077591 -0.35082547 -1.08357752]
mat_Sqrt:  [[23.40899045  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00387133 0.01968661 0.40366073]
Stock Position:  0.003871326530578121
Bond Position:  [3.01885957]


portfolio before change:  [3.39747609]
curr_Stock_Price:  97.60522910151704
curr_Factors:  [97.6052291  -0.55732172 -1.08026975]
mat_Sqrt:  [[18.97912326  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00471982  0.04021417 -0.2935754 ]
Stock Position:  0.004719822722619889
Bond Position:  [2.93679671]


portfolio before change:  [3.38947905]
curr_Stock_Price:  95.75530248839667
curr_Factors:  [95.75530249 -0.81955008 -1.0963271 ]
mat_Sqrt:  [[14.09639119  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01134243  0.03820004  0.35977232]
Stock Position:  -0.011342433762332392
Bond Position:  [4.47557723]


portfolio before change:  [3.3772704]
curr_Stock_Price:  96.93033180137932
curr_Factors:  [96.9303318  -0.86673533 -1.1318175 ]
mat_Sqrt:  [[13.13709183  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00790626 0.038632   0.38075087]
Stock Position:  0.00790625548256388
Bond Position:  [2.61091443]


portfolio before change:  [3.38219559]
curr_Stock_Price:  97.47071260910967
curr_Factors:  [97.47071261 -0.94591269 -1.13524036]
mat_Sqrt:  [[12.16300411  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00875695 -0.00349646 -0.09075571]
Stock Position:  0.008756950721560157
Bond Position:  [2.52864937]


portfolio before change:  [3.38639136]
curr_Stock_Price:  97.87764943105418
curr_Factors:  [97.87764943 -1.13828132 -1.11732204]
mat_Sqrt:  [[10.25858444  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00841325 -0.05963821  0.09549312]
Stock Position:  -0.008413249792490892
Bond Position:  [4.20986047]


portfolio before change:  [3.37994936]
curr_Stock_Price:  98.76845794446722
curr_Factors:  [98.76845794 -1.1154174  -1.12856709]
mat_Sqrt:  [[10.47292983  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01691426 -0.21354463 -1.77073367]
Stock Position:  -0.01691426247214492
Bond Position:  [5.05054499]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [3.3834815]
Stock Price:  98.6342903563891
PL:  [3.3834815]
Settle:  Tensor("sub_372:0", shape=(), dtype=float64)
PL:  Tensor("sub_373:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  187
output_Z_Vals[:, i, :]:  [[ 1.19271183e+02 -4.92738716e+01 -4.92570741e+01]
 [ 3.63225384e-02  6.72491394e-02 -3.75906224e-02]
 [-2.20934100e+00 -2.97458886e+00 -8.47312321e-01]
 [-4.89568555e-02 -1.37225488e-02 -1.29917257e-01]
 [ 3.02674904e-01 -1.33864225e-02 -4.78659589e-02]
 [-1.39119814e-01 -2.19284120e-01  1.60542736e-03]
 [-7.47854246e-02  1.27951860e-01 -1.41845237e-01]
 [ 7.99362722e-02  1.41591988e-01  1.40110765e-02]
 [ 5.66202029e-02  5.17676858e-02 -4.67348187e-02]
 [-7.62780557e-01 -3.12168133e-01 -2.28610894e-02]
 [ 4.45832643e-03 -3.75305900e-02 -3.06506488e-01]
 [-2.13350972e-03 -1.43189645e-02  2.44677400e-02]
 [-5.70946631e-01 -1.31480154e+00  2.05212996e-01]
 [-1.84901073e-02 -3.87711337e-03  3.21238521e-03]
 [ 1.22387183e-01  1.23272315e-01 -1.06521808e-01]
 [ 1.15592052e-01  1.24067766e-02  2.80706553e-02]
 [-7.71315711e-03 -1.87408361e-02 -3.51523289e-02]
 [ 7.35272286e-03 -9.52001168e-02  1.56509728e-01]
 [ 2.37758883e-02  6.84417387e-04  1.99882699e-02]
 [ 6.79145209e-02 -6.27011001e-01 -3.41010824e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.27118322 -49.27387164 -49.25707411]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [   7.3268874   -15.90307369 -140.51672192]
init_Out:  [2.48374395]
Stock Position:  7.326887399052493
Bond position:  [-730.20499595]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-0.4172783]
curr_Stock_Price:  99.62897639373487
curr_Factors:  [99.62897639 -0.86142972 -0.95351401]
mat_Sqrt:  [[16.22428704  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00261192  0.02170457 -0.10723558]
Stock Position:  0.0026119211124626496
Bond Position:  [-0.67750133]


portfolio before change:  [-0.41688757]
curr_Stock_Price:  99.84342603852393
curr_Factors:  [99.84342604 -1.0356074  -0.97754858]
mat_Sqrt:  [[13.33573456  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.22417088 -0.96004443 -2.41714621]
Stock Position:  -0.2241708772660345
Bond Position:  [21.96510083]


portfolio before change:  [-0.04678034]
curr_Stock_Price:  98.21692003869833
curr_Factors:  [98.21692004 -0.92217971 -0.93053323]
mat_Sqrt:  [[15.40151018  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00508244 -0.00442893 -0.37061777]
Stock Position:  -0.005082437190481194
Bond Position:  [0.45240099]


portfolio before change:  [-0.03951893]
curr_Stock_Price:  96.81045158489523
curr_Factors:  [96.81045158 -1.12383919 -0.90666439]
mat_Sqrt:  [[12.7082499   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.02283334 -0.00432045 -0.13654826]
Stock Position:  0.02283334179205531
Bond Position:  [-2.25002506]


portfolio before change:  [-0.05330451]
curr_Stock_Price:  96.23134226940527
curr_Factors:  [96.23134227 -0.74366319 -0.87940055]
mat_Sqrt:  [[18.98580062  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00966792 -0.07077365  0.00457984]
Stock Position:  -0.00966792471112787
Bond Position:  [0.87705286]


portfolio before change:  [-0.05019996]
curr_Stock_Price:  95.93290545855729
curr_Factors:  [95.93290546 -0.93078692 -0.85451248]
mat_Sqrt:  [[16.09244074  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00482347  0.04129629 -0.40464498]
Stock Position:  -0.004823469576637232
Bond Position:  [0.41252949]


portfolio before change:  [-0.05112996]
curr_Stock_Price:  96.14709731857717
curr_Factors:  [96.14709732 -0.71097291 -0.79448267]
mat_Sqrt:  [[21.33659566  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00523507 0.04569862 0.0399697 ]
Stock Position:  0.005235072010872485
Bond Position:  [-0.55446694]


portfolio before change:  [-0.04079293]
curr_Stock_Price:  98.14815253128458
curr_Factors:  [98.14815253 -0.84021662 -0.79780215]
mat_Sqrt:  [[19.07654034  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00302191  0.01670795 -0.13332143]
Stock Position:  0.003021907094998429
Bond Position:  [-0.33738752]


portfolio before change:  [-0.04481109]
curr_Stock_Price:  96.84638796941796
curr_Factors:  [96.84638797 -0.38982198 -0.7844447 ]
mat_Sqrt:  [[29.92994297  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02777045 -0.10075183 -0.06521632]
Stock Position:  -0.02777045421798611
Bond Position:  [2.64465709]


portfolio before change:  [-0.00445089]
curr_Stock_Price:  95.41684872631397
curr_Factors:  [95.41684873 -0.52268309 -0.80048286]
mat_Sqrt:  [[25.40863865  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00258841 -0.01211295 -0.8743777 ]
Stock Position:  -0.0025884089669298083
Bond Position:  [0.24252693]


portfolio before change:  [-0.0087819]
curr_Stock_Price:  97.11350576290077
curr_Factors:  [97.11350576 -0.58179824 -0.81737712]
mat_Sqrt:  [[23.96765232  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-2.58263107e-06 -4.62142592e-03  6.97996517e-02]
Stock Position:  -2.582631073189388e-06
Bond Position:  [-0.00853109]


portfolio before change:  [-0.00878983]
curr_Stock_Price:  99.36071447909717
curr_Factors:  [99.36071448 -0.76411731 -0.80813357]
mat_Sqrt:  [[20.62504125  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0386637  -0.42435037  0.58541556]
Stock Position:  -0.038663701775526076
Bond Position:  [3.8328632]


portfolio before change:  [-0.11383987]
curr_Stock_Price:  102.10252064924651
curr_Factors:  [102.10252065  -1.30784071  -0.80553008]
mat_Sqrt:  [[12.33704623  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00150975 -0.00125133  0.00916404]
Stock Position:  -0.0015097450410616767
Bond Position:  [0.0403089]


portfolio before change:  [-0.11269097]
curr_Stock_Price:  101.34820718069041
curr_Factors:  [101.34820718  -1.29006532  -0.78201557]
mat_Sqrt:  [[12.76211861  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0098578   0.03978597 -0.30387707]
Stock Position:  0.009857796358466718
Bond Position:  [-1.11176096]


portfolio before change:  [-0.10976483]
curr_Stock_Price:  101.67324143638969
curr_Factors:  [101.67324144  -1.68154773  -0.76482477]
mat_Sqrt:  [[ 8.80563324  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01406537 0.00400427 0.08007777]
Stock Position:  0.01406536811757969
Bond Position:  [-1.5398364]


portfolio before change:  [-0.08846044]
curr_Stock_Price:  103.21528367681134
curr_Factors:  [103.21528368  -1.84032492  -0.7316131 ]
mat_Sqrt:  [[ 7.88434315  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00237357 -0.00604858 -0.10027981]
Stock Position:  -0.0023735716442125064
Bond Position:  [0.15652843]


portfolio before change:  [-0.0896418]
curr_Stock_Price:  103.72948478195562
curr_Factors:  [103.72948478  -1.57887746  -0.7426876 ]
mat_Sqrt:  [[10.17792693  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00195202 -0.03072571  0.44647869]
Stock Position:  0.0019520178388942034
Bond Position:  [-0.2921236]


portfolio before change:  [-0.08847784]
curr_Stock_Price:  104.36318738337461
curr_Factors:  [104.36318738  -1.25186014  -0.7454242 ]
mat_Sqrt:  [[14.16242964  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00197676 0.00022089 0.05702097]
Stock Position:  0.001976757072240877
Bond Position:  [-0.29477851]


portfolio before change:  [-0.08520361]
curr_Stock_Price:  106.05683783271627
curr_Factors:  [106.05683783  -1.05415871  -0.6968092 ]
mat_Sqrt:  [[18.41208507  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00704331 -0.20236693 -0.97280896]
Stock Position:  -0.007043314556578236
Bond Position:  [0.66178806]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-0.07496234]
Stock Price:  104.6262895250864
PL:  [-4.70125186]
Settle:  Tensor("sub_374:0", shape=(), dtype=float64)
PL:  Tensor("sub_375:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  188
output_Z_Vals[:, i, :]:  [[ 1.19271183e+02 -4.92738716e+01 -4.92570741e+01]
 [ 6.05216023e-02  1.06127658e-01 -2.63606994e-02]
 [-2.18621866e+00 -2.95048727e+00 -8.40616554e-01]
 [ 9.80173354e-02  2.62280073e-01 -4.78751645e-02]
 [ 6.66827075e-01 -5.13261883e-02 -3.99536330e-01]
 [-3.73035239e-02 -5.35821566e-02  1.63837278e-02]
 [ 7.47096897e-03  2.53837948e-02  6.82954283e-02]
 [ 2.29627518e-02  4.90484637e-02 -7.20524193e-03]
 [ 6.31245366e-03 -1.43678460e-01  8.62306085e-03]
 [-8.51396657e-01 -3.45422451e-01 -2.74389055e-02]
 [ 2.28002480e-01 -3.09210408e-03 -1.18151733e-01]
 [ 4.56130683e-02 -6.44834575e-02  3.74229212e-02]
 [-6.25852490e-01 -1.22588155e+00  2.23626195e-01]
 [ 4.42437028e-02  5.66037140e-02  1.31830280e-01]
 [ 8.07796203e-02  1.27368876e-01 -1.03201623e-01]
 [ 6.54351247e-02  3.26205062e-02  6.31876816e-02]
 [ 2.87292521e-02  1.69476615e-02  3.58631084e-04]
 [ 2.54851396e-03 -9.63883599e-02  1.72607245e-01]
 [ 6.41725851e-03  2.05277868e-02 -3.37428852e-03]
 [ 8.04811881e-02 -6.83455860e-01 -4.56304755e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.27118322 -49.27387164 -49.25707411]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [   7.3268874   -15.90307369 -140.51672192]
init_Out:  [2.48374395]
Stock Position:  7.326887399052493
Bond position:  [-730.20499595]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-1.59610314]
curr_Stock_Price:  99.4680861318312
curr_Factors:  [99.46808613 -1.32802471 -0.97980376]
mat_Sqrt:  [[ 9.89479018  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00776206  0.03425255 -0.07519974]
Stock Position:  0.007762060967012318
Bond Position:  [-2.36818049]


portfolio before change:  [-1.5954976]
curr_Stock_Price:  99.62238266193837
curr_Factors:  [99.62238266 -1.08889127 -0.96476357]
mat_Sqrt:  [[12.7780905   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.23165233 -0.95226567 -2.39804505]
Stock Position:  -0.23165233357980913
Bond Position:  [21.48225982]


portfolio before change:  [-1.78588012]
curr_Stock_Price:  100.46741521965673
curr_Factors:  [100.46741522  -0.84474494  -0.9807308 ]
mat_Sqrt:  [[16.18941607  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00875773  0.08465053 -0.13657452]
Stock Position:  0.008757731196271091
Bond Position:  [-2.66574674]


portfolio before change:  [-1.79000214]
curr_Stock_Price:  100.0728495124551
curr_Factors:  [100.07284951  -0.99531745  -0.95537282]
mat_Sqrt:  [[14.22794729  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.04039902 -0.01656546 -1.13976594]
Stock Position:  0.040399021532411934
Bond Position:  [-5.83284735]


portfolio before change:  [-1.80301393]
curr_Stock_Price:  99.78686766967269
curr_Factors:  [99.78686767 -0.98342639 -0.88267838]
mat_Sqrt:  [[15.43954105  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0029079  -0.01729357  0.04673821]
Stock Position:  -0.002907898705525985
Bond Position:  [-1.51284382]


portfolio before change:  [-1.80526289]
curr_Stock_Price:  100.43018774185174
curr_Factors:  [100.43018774  -1.2237473   -0.90090042]
mat_Sqrt:  [[11.99890155  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.0022163  0.00819258 0.19482785]
Stock Position:  0.0022162995675248437
Bond Position:  [-2.02784627]


portfolio before change:  [-1.80505005]
curr_Stock_Price:  100.75499467240068
curr_Factors:  [100.75499467  -1.42263379  -0.92184605]
mat_Sqrt:  [[ 9.6621089   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00326057  0.01583032 -0.02055455]
Stock Position:  0.003260568055642952
Bond Position:  [-2.13356857]


portfolio before change:  [-1.80698715]
curr_Stock_Price:  100.32450365683823
curr_Factors:  [100.32450366  -1.55450627  -0.91160853]
mat_Sqrt:  [[ 8.51896769  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00249509 -0.04637202  0.02459919]
Stock Position:  -0.002495092715081232
Bond Position:  [-1.55666821]


portfolio before change:  [-1.80406953]
curr_Stock_Price:  98.99916693188236
curr_Factors:  [98.99916693 -1.56058563 -0.89467339]
mat_Sqrt:  [[ 8.49818337  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.10914176 -0.11148462 -0.07827556]
Stock Position:  -0.10914175686262582
Bond Position:  [9.00087348]


portfolio before change:  [-1.86283915]
curr_Stock_Price:  99.55825746084643
curr_Factors:  [99.55825746 -1.25506328 -0.90563157]
mat_Sqrt:  [[11.47359287  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01771491 -0.00099797 -0.33705401]
Stock Position:  0.017714911715939016
Bond Position:  [-3.62650489]


portfolio before change:  [-1.85334938]
curr_Stock_Price:  100.14513660335601
curr_Factors:  [100.1451366   -1.24448409  -0.90273193]
mat_Sqrt:  [[11.6978432   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00342707 -0.02081195  0.10675718]
Stock Position:  0.0034270727301604254
Bond Position:  [-2.19655405]


portfolio before change:  [-1.85263529]
curr_Stock_Price:  100.51375851799287
curr_Factors:  [100.51375852  -0.99193979  -0.88268172]
mat_Sqrt:  [[15.42011934  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.05385412 -0.39565157  0.63794329]
Stock Position:  -0.05385412319196466
Bond Position:  [3.56044504]


portfolio before change:  [-1.71673717]
curr_Stock_Price:  98.0068398632575
curr_Factors:  [98.00683986 -0.74115231 -0.84399014]
mat_Sqrt:  [[20.08342428  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.0041182  0.01826877 0.37607509]
Stock Position:  0.004118203627970039
Bond Position:  [-2.12034929]


portfolio before change:  [-1.71358077]
curr_Stock_Price:  98.90202307536713
curr_Factors:  [98.90202308 -0.51279852 -0.85821796]
mat_Sqrt:  [[25.10615953  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00341401  0.04110813 -0.2944055 ]
Stock Position:  0.0034140124042328587
Bond Position:  [-2.05123351]


portfolio before change:  [-1.70158923]
curr_Stock_Price:  102.56469844880101
curr_Factors:  [102.56469845  -0.67927226  -0.83695615]
mat_Sqrt:  [[22.51688311  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00377458 0.01052822 0.18025687]
Stock Position:  0.003774584997075902
Bond Position:  [-2.0887284]


portfolio before change:  [-1.69938494]
curr_Stock_Price:  103.2870390661083
curr_Factors:  [103.28703907  -0.88510204  -0.84431699]
mat_Sqrt:  [[18.32182297  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00176084 0.00546983 0.00102307]
Stock Position:  0.00176084466722661
Bond Position:  [-1.88125737]


portfolio before change:  [-1.69901381]
curr_Stock_Price:  103.76493573278516
curr_Factors:  [103.76493573  -0.97279915  -0.87600472]
mat_Sqrt:  [[16.33523186  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00110844 -0.03110921  0.49240042]
Stock Position:  0.0011084402625322945
Bond Position:  [-1.81403104]


portfolio before change:  [-1.70007801]
curr_Stock_Price:  103.21403516923202
curr_Factors:  [103.21403517  -1.15674706  -0.90295503]
mat_Sqrt:  [[13.15895824  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00075376  0.00662531 -0.00962591]
Stock Position:  0.0007537604046272121
Bond Position:  [-1.77787667]


portfolio before change:  [-1.70039232]
curr_Stock_Price:  103.38678733623156
curr_Factors:  [103.38678734  -1.14282548  -0.90991629]
mat_Sqrt:  [[13.27304658  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0114647  -0.22058443 -1.30171046]
Stock Position:  -0.011464698194574572
Bond Position:  [-0.51509401]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-1.68601755]
Stock Price:  102.12172446008877
PL:  [-3.80774201]
Settle:  Tensor("sub_376:0", shape=(), dtype=float64)
PL:  Tensor("sub_377:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  189
output_Z_Vals[:, i, :]:  [[ 1.19271183e+02 -4.92738716e+01 -4.92570741e+01]
 [ 3.81563784e-02  7.01954097e-02 -3.67396026e-02]
 [-2.54241113e+00 -3.12484853e+00 -9.22868630e-01]
 [-2.65619012e-03  2.01966605e-01  5.99348219e-03]
 [ 5.38597350e-01  1.52425985e-02 -3.89475645e-01]
 [-5.71704434e-02  1.77048661e-02 -4.81990149e-03]
 [-8.30496757e-03  3.15363621e-02  1.67668108e-03]
 [ 5.82013971e-02  1.11082015e-01  5.18077575e-03]
 [ 3.73677457e-02 -4.20268895e-02 -9.64362909e-04]
 [-7.29384671e-01 -2.95411453e-01 -2.12256919e-02]
 [ 1.02145046e-01 -2.19905443e-02 -2.03866885e-01]
 [ 1.25921583e-02 -7.08432751e-02  3.61622159e-02]
 [-5.68124243e-01 -1.31097358e+00  2.03277582e-01]
 [ 4.10032628e-02  5.37823983e-02  1.25619982e-01]
 [ 8.13960474e-02  1.24604402e-01 -1.02918297e-01]
 [-8.81292545e-02  7.39542346e-02  1.35894257e-01]
 [ 6.21217964e-02  1.06692492e-01  1.07423959e-01]
 [ 9.71508284e-02 -1.63397152e-02  1.47320679e-02]
 [ 3.64641724e-02  1.07018564e-01 -4.02598274e-03]
 [ 3.19840280e-02 -3.55657012e-01 -2.60947834e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.27118322 -49.27387164 -49.25707411]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [   7.3268874   -15.90307369 -140.51672192]
init_Out:  [2.48374395]
Stock Position:  7.326887399052493
Bond position:  [-730.20499595]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-0.1335422]
curr_Stock_Price:  99.66770171997729
curr_Factors:  [99.66770172 -0.93828312 -0.96257558]
mat_Sqrt:  [[14.89436527  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0030203   0.02265547 -0.10480786]
Stock Position:  0.0030203043660072273
Bond Position:  [-0.43456899]


portfolio before change:  [-0.13650793]
curr_Stock_Price:  98.72174534209162
curr_Factors:  [98.72174534 -0.77123521 -0.94451848]
mat_Sqrt:  [[17.75294733  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.18975147 -1.00854053 -2.63268732]
Stock Position:  -0.1897514748994177
Bond Position:  [18.59608885]


portfolio before change:  [-0.61633557]
curr_Stock_Price:  101.27496525917898
curr_Factors:  [101.27496526  -1.13799279  -0.98581148]
mat_Sqrt:  [[12.11004138  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00328599 0.06518444 0.01709774]
Stock Position:  0.0032859908257124185
Bond Position:  [-0.94912418]


portfolio before change:  [-0.61922893]
curr_Stock_Price:  100.46667272642482
curr_Factors:  [100.46667273  -1.14330319  -0.99817209]
mat_Sqrt:  [[11.80296503  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.03916027  0.00491953 -1.11106561]
Stock Position:  0.03916027435259459
Bond Position:  [-4.55353139]


portfolio before change:  [-0.61485479]
curr_Stock_Price:  100.60744445990018
curr_Factors:  [100.60744446  -1.3570541   -1.02893455]
mat_Sqrt:  [[ 9.25568172  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00589263  0.00571422 -0.01374984]
Stock Position:  -0.005892630343245488
Bond Position:  [-0.02201231]


portfolio before change:  [-0.61009704]
curr_Stock_Price:  99.79910429165302
curr_Factors:  [99.79910429 -1.35789731 -1.03906547]
mat_Sqrt:  [[ 9.0811099   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00016797  0.01017832  0.0047831 ]
Stock Position:  -0.00016797324672191094
Bond Position:  [-0.59333346]


portfolio before change:  [-0.61007047]
curr_Stock_Price:  98.75773305612816
curr_Factors:  [98.75773306 -1.27999683 -1.0080291 ]
mat_Sqrt:  [[10.02060811  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00817649 0.03585157 0.01477931]
Stock Position:  0.008176493775148395
Bond Position:  [-1.41756246]


portfolio before change:  [-0.61344242]
curr_Stock_Price:  98.38868638127482
curr_Factors:  [98.38868638 -1.23216457 -0.97847092]
mat_Sqrt:  [[10.78644588  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00265075 -0.01356412 -0.00275106]
Stock Position:  0.0026507520083966507
Bond Position:  [-0.87424642]


portfolio before change:  [-0.61659221]
curr_Stock_Price:  97.28288345169585
curr_Factors:  [97.28288345 -1.43534312 -0.92423335]
mat_Sqrt:  [[ 9.18936266  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.08640621 -0.09534364 -0.06055099]
Stock Position:  -0.08640620537772586
Bond Position:  [7.78925259]


portfolio before change:  [-0.69208339]
curr_Stock_Price:  98.179100741126
curr_Factors:  [98.17910074 -0.72412041 -0.93931478]
mat_Sqrt:  [[18.60365708  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00301242 -0.00709742 -0.58157548]
Stock Position:  0.0030124233656893197
Bond Position:  [-0.98784041]


portfolio before change:  [-0.68944249]
curr_Stock_Price:  99.13776100066055
curr_Factors:  [99.137761   -0.95305507 -0.93057473]
mat_Sqrt:  [[15.0726313   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00036576 -0.02286457  0.10316074]
Stock Position:  0.00036575675764645427
Bond Position:  [-0.7257028]


portfolio before change:  [-0.68965786]
curr_Stock_Price:  99.0450192623351
curr_Factors:  [99.04501926 -0.74816181 -0.9069089 ]
mat_Sqrt:  [[18.92537821  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.04196649 -0.4231149   0.57989436]
Stock Position:  -0.041966492430912064
Bond Position:  [3.46691419]


portfolio before change:  [-0.65663209]
curr_Stock_Price:  98.27871899921868
curr_Factors:  [98.278719   -0.80403863 -0.90015442]
mat_Sqrt:  [[17.87877866  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00434166 0.01735819 0.35835884]
Stock Position:  0.0043416623600082286
Bond Position:  [-1.08332511]


portfolio before change:  [-0.65743096]
curr_Stock_Price:  98.15710555836135
curr_Factors:  [98.15710556 -0.57111243 -0.92515804]
mat_Sqrt:  [[21.9836468   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00390393  0.0402159  -0.29359725]
Stock Position:  0.003903933954816184
Bond Position:  [-1.04062982]


portfolio before change:  [-0.65756451]
curr_Stock_Price:  98.18954429417104
curr_Factors:  [98.18954429 -0.2495028  -0.90868044]
mat_Sqrt:  [[30.83703803  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00146882  0.02386863  0.38766849]
Stock Position:  -0.0014688216971793962
Bond Position:  [-0.51334158]


portfolio before change:  [-0.6559049]
curr_Stock_Price:  96.97226486241276
curr_Factors:  [96.97226486 -0.17530449 -0.96636307]
mat_Sqrt:  [[30.96190098  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00341801 0.03443485 0.30645065]
Stock Position:  0.0034180115154514423
Bond Position:  [-0.98735722]


portfolio before change:  [-0.64492603]
curr_Stock_Price:  100.25655409778955
curr_Factors:  [ 1.00256554e+02 -4.78525226e-02 -1.02932398e+00]
mat_Sqrt:  [[34.14294363  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0028358  -0.00527362  0.04202649]
Stock Position:  0.0028358031985662494
Bond Position:  [-0.92923389]


portfolio before change:  [-0.6396988]
curr_Stock_Price:  102.18178309794467
curr_Factors:  [102.1817831    0.12139995  -1.06418054]
mat_Sqrt:  [[39.80421567  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00144426  0.03454009 -0.01148501]
Stock Position:  0.0014442551894988216
Bond Position:  [-0.78727537]


portfolio before change:  [-0.63831819]
curr_Stock_Price:  103.27400420811833
curr_Factors:  [103.27400421  -0.15344933  -1.0799475 ]
mat_Sqrt:  [[30.08386124  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00312061 -0.11478781 -0.74441154]
Stock Position:  -0.003120607043714809
Bond Position:  [-0.31604061]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-0.61753078]
Stock Price:  96.58734528601639
PL:  [-0.61753078]
Settle:  Tensor("sub_378:0", shape=(), dtype=float64)
PL:  Tensor("sub_379:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  190
output_Z_Vals[:, i, :]:  [[ 1.19271183e+02 -4.92738716e+01 -4.92570741e+01]
 [ 1.80032784e-02  3.78171869e-02 -4.60919381e-02]
 [-2.38180964e+00 -3.21583972e+00 -9.23923963e-01]
 [-6.54814211e-03  6.93809592e-02 -1.07563225e-01]
 [ 1.33354486e-01  8.57177160e-03  2.72046646e-02]
 [-1.42932383e-01 -2.41382192e-01  5.91612651e-03]
 [-1.86898729e-02  3.42289524e-02 -3.37506826e-02]
 [ 8.11750937e-02  1.46102843e-01  1.70048174e-02]
 [ 2.93059799e-02 -6.05679396e-02  7.79955554e-03]
 [-8.30058888e-01 -3.35539917e-01 -2.63764811e-02]
 [ 8.87775311e-02 -4.27565879e-02 -2.16001468e-01]
 [ 6.37519672e-04 -5.66116669e-02  3.26970313e-02]
 [-6.88893501e-01 -1.20338115e+00  2.35791314e-01]
 [ 5.39881799e-02  6.50878229e-02  1.50505554e-01]
 [ 1.05147158e-01  1.22392040e-01 -1.03824474e-01]
 [-1.71320607e-01  1.00102879e-01  1.37469162e-01]
 [ 4.64670818e-02  1.15265753e-01  1.28923467e-01]
 [ 1.14222763e-01 -1.11279349e-02 -2.89051631e-02]
 [-6.92346369e-02 -3.40202235e-01  9.40053788e-02]
 [ 1.23968094e-02 -1.92409491e-01 -1.43107547e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.27118322 -49.27387164 -49.25707411]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [   7.3268874   -15.90307369 -140.51672192]
init_Out:  [2.48374395]
Stock Position:  7.326887399052493
Bond position:  [-730.20499595]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [5.4538563]
curr_Stock_Price:  100.43029000510697
curr_Factors:  [100.43029001  -1.07466935  -1.04161939]
mat_Sqrt:  [[12.09963286  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00134832  0.01220544 -0.13148747]
Stock Position:  0.0013483220555000485
Bond Position:  [5.31844392]


portfolio before change:  [5.45339284]
curr_Stock_Price:  99.1003130598639
curr_Factors:  [99.10031306 -0.70313965 -1.01403315]
mat_Sqrt:  [[17.79575245  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.18132615 -1.03790781 -2.6356979 ]
Stock Position:  -0.18132615471278318
Bond Position:  [23.42287154]


portfolio before change:  [5.4516031]
curr_Stock_Price:  99.14248122265056
curr_Factors:  [99.14248122 -0.7371321  -0.9988444 ]
mat_Sqrt:  [[17.47168412  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00082087  0.02239261 -0.30684794]
Stock Position:  -0.0008208747541237019
Bond Position:  [5.53298666]


portfolio before change:  [5.45539145]
curr_Stock_Price:  96.21275953134393
curr_Factors:  [96.21275953 -0.87659192 -1.02838769]
mat_Sqrt:  [[14.31892913  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00982317 0.00276653 0.07760734]
Stock Position:  0.009823173194474951
Bond Position:  [4.51027685]


portfolio before change:  [5.47524107]
curr_Stock_Price:  98.1186520117176
curr_Factors:  [98.11865201 -1.2627982  -1.05256011]
mat_Sqrt:  [[ 9.68733308  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01971613 -0.07790577  0.01687706]
Stock Position:  -0.019716127310892218
Bond Position:  [7.40976091]


portfolio before change:  [5.45969369]
curr_Stock_Price:  99.0011810313726
curr_Factors:  [99.00118103 -1.23777992 -1.05990447]
mat_Sqrt:  [[ 9.94875472  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0018688   0.01104735 -0.0962813 ]
Stock Position:  -0.0018688013719374281
Bond Position:  [5.64470723]


portfolio before change:  [5.46231397]
curr_Stock_Price:  98.3542814425637
curr_Factors:  [98.35428144 -1.1494747  -1.06033565]
mat_Sqrt:  [[10.79157489  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01060728 0.04715449 0.04851001]
Stock Position:  0.010607284544234777
Bond Position:  [4.41904212]


portfolio before change:  [5.46486505]
curr_Stock_Price:  98.49061974642328
curr_Factors:  [98.49061975 -1.35401752 -1.05372374]
mat_Sqrt:  [[ 8.86596731  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00209054 -0.01954822  0.02224996]
Stock Position:  0.0020905421727890868
Bond Position:  [5.25896625]


portfolio before change:  [5.46494784]
curr_Stock_Price:  97.90124635731212
curr_Factors:  [97.90124636 -1.39344048 -1.06638297]
mat_Sqrt:  [[ 8.36566498  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.10805295 -0.10829504 -0.07524476]
Stock Position:  -0.108052947998983
Bond Position:  [16.04346613]


portfolio before change:  [5.40077014]
curr_Stock_Price:  98.53231722375001
curr_Factors:  [98.53231722 -1.42529338 -1.07680338]
mat_Sqrt:  [[ 8.07108422  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00445526 -0.01379963 -0.61619206]
Stock Position:  0.004455258210530704
Bond Position:  [4.96178323]


portfolio before change:  [5.40083591]
curr_Stock_Price:  98.26862143170756
curr_Factors:  [98.26862143 -1.27625659 -1.07305851]
mat_Sqrt:  [[ 9.37821708  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00045254 -0.01827134  0.09327553]
Stock Position:  -0.000452541760736594
Bond Position:  [5.44530657]


portfolio before change:  [5.40256007]
curr_Stock_Price:  97.46723351325855
curr_Factors:  [97.46723351 -1.33702133 -0.98605366]
mat_Sqrt:  [[ 9.5490461   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.09282623 -0.3883896   0.67264699]
Stock Position:  -0.09282622992184054
Bond Position:  [14.4500759]


portfolio before change:  [5.41740084]
curr_Stock_Price:  97.3462784815024
curr_Factors:  [97.34627848 -1.28737237 -1.00022828]
mat_Sqrt:  [[ 9.88159418  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00991702 0.021007   0.42935045]
Stock Position:  0.009917022697131865
Bond Position:  [4.45201559]


portfolio before change:  [5.42099365]
curr_Stock_Price:  97.59632006484777
curr_Factors:  [97.59632006 -1.03923666 -1.06658547]
mat_Sqrt:  [[11.88191687  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00916832  0.03950186 -0.29618232]
Stock Position:  0.009168322607181296
Bond Position:  [4.5261991]


portfolio before change:  [5.41415433]
curr_Stock_Price:  96.72691150310065
curr_Factors:  [96.7269115  -1.09402587 -1.09012137]
mat_Sqrt:  [[10.8889055   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01127996  0.03230807  0.39216125]
Stock Position:  -0.01127995985179225
Bond Position:  [6.50523]


portfolio before change:  [5.41773308]
curr_Stock_Price:  96.55384000007875
curr_Factors:  [96.55384    -0.67104114 -1.02981291]
mat_Sqrt:  [[17.62373771  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.0054649  0.03720186 0.36778277]
Stock Position:  0.005464901895615083
Bond Position:  [4.89007581]


portfolio before change:  [5.41442478]
curr_Stock_Price:  95.72473724586447
curr_Factors:  [95.72473725 -0.3876466  -1.02588783]
mat_Sqrt:  [[23.28809578  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00455387 -0.00359153 -0.08245838]
Stock Position:  0.004553873433954951
Bond Position:  [4.97850644]


portfolio before change:  [5.40678867]
curr_Stock_Price:  93.77455302990512
curr_Factors:  [93.77455303 -0.33763298 -0.97676307]
mat_Sqrt:  [[25.19126932  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00474328 -0.1097998   0.26817118]
Stock Position:  -0.0047432845954552385
Bond Position:  [5.85158807]


portfolio before change:  [5.43185519]
curr_Stock_Price:  88.79837251259991
curr_Factors:  [ 8.87983725e+01  1.72015056e-02 -9.63665348e-01]
mat_Sqrt:  [[34.46362705  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00162752 -0.0620999  -0.408246  ]
Stock Position:  -0.0016275222322942413
Bond Position:  [5.57637652]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [5.43327732]
Stock Price:  88.78125686662725
PL:  [5.43327732]
Settle:  Tensor("sub_380:0", shape=(), dtype=float64)
PL:  Tensor("sub_381:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  191
output_Z_Vals[:, i, :]:  [[ 1.19271183e+02 -4.92738716e+01 -4.92570741e+01]
 [ 2.17174963e-02  4.37844959e-02 -4.43683019e-02]
 [-2.10877895e+00 -2.84048677e+00 -8.08519069e-01]
 [ 1.23643909e-02  9.02756723e-02 -9.31845722e-02]
 [ 6.14498799e-01 -1.63563794e-01 -2.35536666e-01]
 [-1.42069445e-01 -2.37116396e-01 -5.48431405e-03]
 [-3.85006976e-02  5.15839252e-02 -8.94365194e-02]
 [ 1.48628774e-02  6.06018573e-02 -1.40171920e-02]
 [-4.48497551e-02  2.04405438e-01 -5.77004709e-02]
 [-7.39696302e-01 -2.90344113e-01 -2.19483530e-02]
 [ 3.72045108e-03 -4.43748098e-02 -3.15833338e-01]
 [ 2.93448756e-01  1.25726400e-01  9.45297379e-03]
 [-7.19888165e-01 -9.69906955e-01  2.36475631e-01]
 [ 1.39206572e-01  7.40854055e-02  1.16585568e-01]
 [ 1.14327398e-01  1.36465172e-01 -1.04478108e-01]
 [-2.67030474e-01  1.47597050e-01  1.04732928e-01]
 [-1.14164507e-01  1.21631142e-01  1.98287624e-01]
 [ 1.13105080e-01 -1.14593376e-02 -2.56326201e-02]
 [-6.01571280e-02 -2.51541869e-01  6.41193147e-02]
 [ 2.60391041e-02 -2.61669039e-01 -2.39499870e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.27118322 -49.27387164 -49.25707411]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [   7.3268874   -15.90307369 -140.51672192]
init_Out:  [2.48374395]
Stock Position:  7.326887399052493
Bond position:  [-730.20499595]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [4.82398468]
curr_Stock_Price:  100.34432285580219
curr_Factors:  [100.34432286  -1.06525388  -1.00370955]
mat_Sqrt:  [[12.67515877  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00170399  0.01413139 -0.12657042]
Stock Position:  0.0017039887075020125
Bond Position:  [4.65299908]


portfolio before change:  [4.8246943]
curr_Stock_Price:  100.07802655731415
curr_Factors:  [100.07802656  -1.14990864  -1.02567384]
mat_Sqrt:  [[11.36305909  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.25113212 -0.91676316 -2.30647986]
Stock Position:  -0.25113212241019195
Bond Position:  [29.95750152]


portfolio before change:  [5.09243188]
curr_Stock_Price:  99.04173035318672
curr_Factors:  [99.04173035 -1.0336703  -0.99119468]
mat_Sqrt:  [[13.07466381  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00090026  0.02913635 -0.26582965]
Stock Position:  0.0009002613264472656
Bond Position:  [5.00326844]


portfolio before change:  [5.093206]
curr_Stock_Price:  98.51204151714899
curr_Factors:  [98.51204152 -0.9319965  -0.91991673]
mat_Sqrt:  [[15.46014711  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.03447786 -0.05278999 -0.67192055]
Stock Position:  0.03447785810998937
Bond Position:  [1.69672181]


portfolio before change:  [5.07939621]
curr_Stock_Price:  98.0991964075768
curr_Factors:  [98.09919641 -1.23301354 -0.94349148]
mat_Sqrt:  [[11.12810793  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01721677 -0.07652899 -0.01564522]
Stock Position:  -0.017216772923568362
Bond Position:  [6.7683478]


portfolio before change:  [5.07783247]
curr_Stock_Price:  98.2883166306637
curr_Factors:  [98.28831663 -1.52913882 -0.94442513]
mat_Sqrt:  [[ 8.2841265   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00558023  0.01664864 -0.2551375 ]
Stock Position:  -0.005580229375660487
Bond Position:  [5.62630382]


portfolio before change:  [5.08569311]
curr_Stock_Price:  97.13175345235146
curr_Factors:  [97.13175345 -1.2660621  -0.97140863]
mat_Sqrt:  [[10.36668818  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00235099  0.01955917 -0.03998715]
Stock Position:  0.0023509853884795084
Bond Position:  [4.85733778]


portfolio before change:  [5.08406237]
curr_Stock_Price:  95.92152340448341
curr_Factors:  [95.9215234  -0.91797066 -0.96148006]
mat_Sqrt:  [[14.64471722  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00101769  0.06597157 -0.16460338]
Stock Position:  -0.0010176863641022825
Bond Position:  [5.18168039]


portfolio before change:  [5.08523179]
curr_Stock_Price:  96.04549366735688
curr_Factors:  [96.04549367 -0.77543295 -0.98722268]
mat_Sqrt:  [[16.4803101   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.04875168 -0.09370816 -0.06261254]
Stock Position:  -0.04875167580604099
Bond Position:  [9.76761056]


portfolio before change:  [5.1064039]
curr_Stock_Price:  95.66130361737757
curr_Factors:  [95.66130362 -0.78118706 -0.98372668]
mat_Sqrt:  [[16.37736384  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00426239 -0.01432191 -0.9009846 ]
Stock Position:  -0.004262391063706195
Bond Position:  [5.51414979]


portfolio before change:  [5.11763815]
curr_Stock_Price:  93.34909436410422
curr_Factors:  [93.34909436 -0.6517172  -0.99205335]
mat_Sqrt:  [[18.0397132   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01779641 0.04057802 0.0269667 ]
Stock Position:  0.017796409867012322
Bond Position:  [3.45635941]


portfolio before change:  [5.12249165]
curr_Stock_Price:  93.57325738375803
curr_Factors:  [93.57325738 -0.57251587 -0.99712114]
mat_Sqrt:  [[19.47453304  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.04465315 -0.31303612  0.67459915]
Stock Position:  -0.04465314805306486
Bond Position:  [9.30083216]


portfolio before change:  [5.03267011]
curr_Stock_Price:  95.63687528842344
curr_Factors:  [95.63687529 -0.38077147 -1.0077477 ]
mat_Sqrt:  [[23.8560845   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00746674 0.02391096 0.33258617]
Stock Position:  0.007466737509452226
Bond Position:  [4.31857467]


portfolio before change:  [5.02553715]
curr_Stock_Price:  94.5369649571512
curr_Factors:  [94.53696496 -0.54968834 -0.9862233 ]
mat_Sqrt:  [[20.34996695  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00593892  0.04404394 -0.29804696]
Stock Position:  0.005938915309479204
Bond Position:  [4.46409012]


portfolio before change:  [5.02441076]
curr_Stock_Price:  94.15936277756452
curr_Factors:  [94.15936278 -0.21370479 -0.99760007]
mat_Sqrt:  [[28.04145194  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0076859   0.04763674  0.29877389]
Stock Position:  -0.0076859013224246445
Bond Position:  [5.74811033]


portfolio before change:  [5.04777176]
curr_Stock_Price:  91.30689474459714
curr_Factors:  [91.30689474 -0.42865739 -1.01214253]
mat_Sqrt:  [[21.61584023  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00226044  0.03925628  0.5656594 ]
Stock Position:  -0.00226044243530712
Bond Position:  [5.25416574]


portfolio before change:  [5.04214139]
curr_Stock_Price:  94.37889089545101
curr_Factors:  [94.3788909  -0.28237287 -1.07464005]
mat_Sqrt:  [[24.29582474  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0043437  -0.00369849 -0.07312273]
Stock Position:  0.004343697613225887
Bond Position:  [4.63218803]


portfolio before change:  [5.05161312]
curr_Stock_Price:  96.2928216786451
curr_Factors:  [96.29282168  0.13918953 -1.04555053]
mat_Sqrt:  [[38.90149853  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00252984 -0.08118479  0.18291456]
Stock Position:  -0.0025298407622091636
Bond Position:  [5.29521862]


portfolio before change:  [5.05671531]
curr_Stock_Price:  94.79936155143733
curr_Factors:  [ 9.47993616e+01 -2.56641559e-02 -1.00647664e+00]
mat_Sqrt:  [[33.77165632  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00225815 -0.08445332 -0.68322646]
Stock Position:  -0.0022581531175667625
Bond Position:  [5.27078678]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [5.06529107]
Stock Price:  91.58527442346582
PL:  [5.06529107]
Settle:  Tensor("sub_382:0", shape=(), dtype=float64)
PL:  Tensor("sub_383:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  192
output_Z_Vals[:, i, :]:  [[ 1.19271183e+02 -4.92738716e+01 -4.92570741e+01]
 [ 2.71613450e-02  5.25306514e-02 -4.18420058e-02]
 [-2.08324861e+00 -2.80644140e+00 -7.98670376e-01]
 [ 8.41954576e-02  1.94804906e-01 -5.48508717e-02]
 [ 5.81246949e-01 -3.38473460e-02 -3.70378580e-01]
 [ 7.57175145e-02  1.17192732e-01 -6.73936232e-03]
 [-1.60757966e-02  3.39499690e-02 -9.71783205e-03]
 [ 9.70878086e-02  2.39580187e-01  1.07579995e-01]
 [-1.57335749e-01  3.56641250e-01 -9.38162334e-02]
 [-9.81585355e-01 -4.06428242e-01 -3.39060277e-02]
 [ 1.02638480e-01 -8.47671053e-03 -2.18530210e-01]
 [-7.85581744e-03 -4.69801232e-02  3.03223995e-02]
 [-5.15385327e-01 -1.30409927e+00  1.86676618e-01]
 [ 2.83013261e-02  4.27233529e-02  1.01276741e-01]
 [ 7.68778053e-02  1.26449134e-01 -1.02547086e-01]
 [-1.73528127e-01  1.07206950e-01  1.27837580e-01]
 [ 8.58341077e-02  1.09605301e-01  8.88847578e-02]
 [ 1.15216134e-01 -1.08333916e-02 -3.18137274e-02]
 [-5.84668341e-02 -1.77576262e-01  1.89743765e-02]
 [ 7.27193601e-02 -5.50643628e-01 -5.73652387e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.27118322 -49.27387164 -49.25707411]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [   7.3268874   -15.90307369 -140.51672192]
init_Out:  [2.48374395]
Stock Position:  7.326887399052493
Bond position:  [-730.20499595]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [4.22675585]
curr_Stock_Price:  100.26281091305978
curr_Factors:  [100.26281091  -1.11410504  -0.98270488]
mat_Sqrt:  [[12.31705546  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00238232  0.01695419 -0.1193636 ]
Stock Position:  0.0023823190312059284
Bond Position:  [3.98789785]


portfolio before change:  [4.22756622]
curr_Stock_Price:  100.18443193822004
curr_Factors:  [100.18443194  -1.20179681  -1.00874233]
mat_Sqrt:  [[10.98437344  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.25664996 -0.90577507 -2.27838428]
Stock Position:  -0.2566499569030018
Bond Position:  [29.93989636]


portfolio before change:  [4.32249211]
curr_Stock_Price:  99.84373454216727
curr_Factors:  [99.84373454 -1.21864031 -1.02512784]
mat_Sqrt:  [[10.58923752  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01064887  0.06287301 -0.15647427]
Stock Position:  0.010648873919994884
Bond Position:  [3.25926877]


portfolio before change:  [4.32520462]
curr_Stock_Price:  100.02193162114008
curr_Factors:  [100.02193162  -0.83642961  -1.03149679]
mat_Sqrt:  [[15.44774561  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.03228527 -0.01092418 -1.056587  ]
Stock Position:  0.03228527252825654
Bond Position:  [1.0959693]


portfolio before change:  [4.34052376]
curr_Stock_Price:  100.48793711467167
curr_Factors:  [100.48793711  -0.76613216  -1.03441592]
mat_Sqrt:  [[16.60144282  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00591899  0.03782379 -0.01922552]
Stock Position:  0.0059189863938173895
Bond Position:  [3.74573703]


portfolio before change:  [4.32846773]
curr_Stock_Price:  98.29286843901968
curr_Factors:  [98.29286844 -0.78518038 -1.01088261]
mat_Sqrt:  [[16.31179535  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00068229  0.01095731 -0.02772227]
Stock Position:  -0.0006822935250163705
Bond Position:  [4.39553232]


portfolio before change:  [4.33047582]
curr_Stock_Price:  96.96050087272081
curr_Factors:  [96.96050087 -0.63845694 -1.00101697]
mat_Sqrt:  [[18.8182995   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00892491 0.07732417 0.30689578]
Stock Position:  0.008924907594668184
Bond Position:  [3.46511231]


portfolio before change:  [4.33026634]
curr_Stock_Price:  96.83995471240976
curr_Factors:  [96.83995471 -0.25520351 -0.98364672]
mat_Sqrt:  [[28.05619411  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00369568  0.11510547 -0.2676316 ]
Stock Position:  -0.0036956836197588354
Bond Position:  [4.68815618]


portfolio before change:  [4.32641651]
curr_Stock_Price:  98.19884123498142
curr_Factors:  [ 9.81988412e+01  5.07853699e-02 -1.01228946e+00]
mat_Sqrt:  [[37.5431271   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02853966 -0.13117415 -0.09672446]
Stock Position:  -0.028539663430890504
Bond Position:  [7.12897839]


portfolio before change:  [4.34406071]
curr_Stock_Price:  97.64306278423636
curr_Factors:  [97.64306278 -0.18264997 -0.98621877]
mat_Sqrt:  [[30.33948138  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0018557  -0.00273585 -0.62340586]
Stock Position:  0.0018556970503252107
Bond Position:  [4.16286477]


portfolio before change:  [4.34628328]
curr_Stock_Price:  98.27986940066059
curr_Factors:  [98.2798694  -0.40288604 -0.95722039]
mat_Sqrt:  [[25.22190314  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00044628 -0.01516277  0.08650137]
Stock Position:  -0.0004462811941313149
Bond Position:  [4.39014374]


portfolio before change:  [4.34722202]
curr_Stock_Price:  98.63598629536688
curr_Factors:  [98.6359863  -0.22108027 -0.9198616 ]
mat_Sqrt:  [[31.51596698  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02359053 -0.42089623  0.53253643]
Stock Position:  -0.02359052705831374
Bond Position:  [6.67409693]


portfolio before change:  [4.3314647]
curr_Stock_Price:  99.3746749774971
curr_Factors:  [99.37467498 -0.34902119 -0.92271274]
mat_Sqrt:  [[27.85920322  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00207096 0.0137889  0.28891435]
Stock Position:  0.0020709573674008524
Bond Position:  [4.12566398]


portfolio before change:  [4.32697348]
curr_Stock_Price:  96.7079055201684
curr_Factors:  [96.70790552 -0.33166173 -0.91979595]
mat_Sqrt:  [[27.66692011  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00295504  0.04081128 -0.29253829]
Stock Position:  0.0029550376502350934
Bond Position:  [4.04119798]


portfolio before change:  [4.32756327]
curr_Stock_Price:  96.56555882241376
curr_Factors:  [96.56555882 -0.41828799 -0.91587227]
mat_Sqrt:  [[25.43336468  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00493642  0.03460089  0.36468503]
Stock Position:  -0.004936423646088455
Bond Position:  [4.80425177]


portfolio before change:  [4.32140023]
curr_Stock_Price:  98.05737793506482
curr_Factors:  [98.05737794 -0.60789304 -0.89423301]
mat_Sqrt:  [[21.83309094  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00578712 0.03537496 0.25356347]
Stock Position:  0.005787120183796376
Bond Position:  [3.7539304]


portfolio before change:  [4.32036162]
curr_Stock_Price:  97.71572129515737
curr_Factors:  [97.7157213  -0.49426771 -0.84749127]
mat_Sqrt:  [[25.54147189  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00417011 -0.00349646 -0.09075571]
Stock Position:  0.004170113142033593
Bond Position:  [3.91287601]


portfolio before change:  [4.31557135]
curr_Stock_Price:  96.33239959186763
curr_Factors:  [96.33239959 -0.742947   -0.84472405]
mat_Sqrt:  [[19.69044837  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00461347 -0.05731249  0.05412861]
Stock Position:  -0.0046134707897695065
Bond Position:  [4.75999806]


portfolio before change:  [4.30986077]
curr_Stock_Price:  97.82817824234037
curr_Factors:  [97.82817824 -0.91925554 -0.8251032 ]
mat_Sqrt:  [[17.09616065  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00917028 -0.17771947 -1.63647059]
Stock Position:  -0.009170281347449417
Bond Position:  [5.20697269]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [4.29656221]
Stock Price:  99.42032864532511
PL:  [4.29656221]
Settle:  Tensor("sub_384:0", shape=(), dtype=float64)
PL:  Tensor("sub_385:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  193
output_Z_Vals[:, i, :]:  [[ 1.19271183e+02 -4.92738716e+01 -4.92570741e+01]
 [ 5.72128413e-02  1.00811762e-01 -2.78961775e-02]
 [-2.63510228e+00 -3.29923879e+00 -9.72044237e-01]
 [ 3.69447293e-03  8.57807023e-02 -1.03995716e-01]
 [ 8.82892559e-01 -1.90336814e-01 -3.41650429e-01]
 [ 8.75396427e-02  2.25566091e-01  5.51656143e-02]
 [ 2.22070517e-02  4.05938137e-02  1.21080098e-01]
 [ 1.16038506e-01  4.85681868e-01  4.77719219e-01]
 [-2.70683786e-02 -2.29627668e-01  3.75722883e-02]
 [-1.43156288e+00 -5.93103296e-01 -5.65161904e-02]
 [ 1.54004475e-01 -1.79810765e-02  4.08371821e-02]
 [-2.21108439e-01  6.22790788e-02  2.43769943e-02]
 [-8.16802605e-01 -9.81989682e-01  2.92610708e-01]
 [-7.36826782e-04  2.32425369e-03  1.29546935e-03]
 [-1.76320365e-01 -2.24160451e-01  8.08093859e-02]
 [ 5.42877019e-02  3.56209712e-02  6.84655393e-02]
 [ 2.55624256e-02  1.38463495e-02 -2.72725296e-03]
 [-1.12672711e-01 -1.97549824e-01  3.52807952e-01]
 [ 5.97908957e-02  4.55622978e-02  4.09505721e-02]
 [ 4.78926966e-02 -4.41720851e-01 -3.78541790e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.27118322 -49.27387164 -49.25707411]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [   7.3268874   -15.90307369 -140.51672192]
init_Out:  [2.48374395]
Stock Position:  7.326887399052493
Bond position:  [-730.20499595]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-3.21269954]
curr_Stock_Price:  99.24744722824164
curr_Factors:  [99.24744723 -1.09340465 -0.97145532]
mat_Sqrt:  [[12.58815419  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00572734  0.03253686 -0.07958003]
Stock Position:  0.0057273426603071465
Bond Position:  [-3.78112368]


portfolio before change:  [-3.21742736]
curr_Stock_Price:  98.58703308672548
curr_Factors:  [98.58703309 -0.5579993  -0.94395746]
mat_Sqrt:  [[21.95473829  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.15973656 -1.06482474 -2.77297164]
Stock Position:  -0.1597365557077297
Bond Position:  [12.53052575]


portfolio before change:  [-3.33732104]
curr_Stock_Price:  99.35721814706785
curr_Factors:  [99.35721815 -0.57097634 -0.97526382]
mat_Sqrt:  [[21.16780628  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-1.11731379e-06  2.76856026e-02 -2.96670830e-01]
Stock Position:  -1.1173137929515286e-06
Bond Position:  [-3.33721003]


portfolio before change:  [-3.33815481]
curr_Stock_Price:  98.78659217056976
curr_Factors:  [98.78659217 -0.17363953 -0.99730803]
mat_Sqrt:  [[30.63105401  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0252783  -0.06143094 -0.97463358]
Stock Position:  0.025278304758865736
Bond Position:  [-5.83531239]


portfolio before change:  [-3.30342392]
curr_Stock_Price:  100.21825071569157
curr_Factors:  [100.21825072   0.21479574  -1.00733092]
mat_Sqrt:  [[45.36836875  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00319262 0.07280114 0.15737214]
Stock Position:  0.0031926156051204544
Bond Position:  [-3.62338227]


portfolio before change:  [-3.2955559]
curr_Stock_Price:  102.96646037334438
curr_Factors:  [102.96646037   0.19784916  -1.03348497]
mat_Sqrt:  [[44.64612399  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00123658 0.0131016  0.34540782]
Stock Position:  0.0012365821666308662
Bond Position:  [-3.42288239]


portfolio before change:  [-3.29514727]
curr_Stock_Price:  103.98900334299167
curr_Factors:  [103.98900334   0.18659972  -1.02930932]
mat_Sqrt:  [[44.77166933  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00698415 0.15675315 1.36279996]
Stock Position:  0.006984147209424187
Bond Position:  [-4.02142178]


portfolio before change:  [-3.27894163]
curr_Stock_Price:  106.45331670501187
curr_Factors:  [ 1.06453317e+02  8.78464780e-02 -1.02683529e+00]
mat_Sqrt:  [[41.62569867  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00159208 -0.07411201  0.10718328]
Stock Position:  -0.0015920818347965532
Bond Position:  [-3.10945923]


portfolio before change:  [-3.27528269]
curr_Stock_Price:  103.66678068702667
curr_Factors:  [ 1.03666781e+02 -2.67420683e-02 -1.01596474e+00]
mat_Sqrt:  [[36.5424617   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.04280406 -0.19142327 -0.16122496]
Stock Position:  -0.042804064869268875
Bond Position:  [1.16207691]


portfolio before change:  [-3.33611252]
curr_Stock_Price:  105.09469139729553
curr_Factors:  [105.0946914   -0.37185039  -0.97285767]
mat_Sqrt:  [[27.38933505  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00579313 -0.00580337  0.11649711]
Stock Position:  0.005793129238169228
Bond Position:  [-3.94493965]


portfolio before change:  [-3.33778968]
curr_Stock_Price:  104.97544714543999
curr_Factors:  [104.97544715  -0.12932972  -0.98493925]
mat_Sqrt:  [[34.44822643  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00590509  0.02010049  0.06954078]
Stock Position:  -0.005905088972900334
Bond Position:  [-2.71790032]


portfolio before change:  [-3.34551249]
curr_Stock_Price:  106.1681901576987
curr_Factors:  [106.16819016  -0.15241556  -0.95191727]
mat_Sqrt:  [[35.1875284   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02721196 -0.31693581  0.8347369 ]
Stock Position:  -0.027211956695388236
Bond Position:  [-0.4564683]


portfolio before change:  [-3.23403137]
curr_Stock_Price:  102.06722625016064
curr_Factors:  [102.06722625  -0.17067518  -0.92640515]
mat_Sqrt:  [[34.07456951  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [6.00474110e-08 7.50149654e-04 3.69561346e-03]
Stock Position:  6.004741103666879e-08
Bond Position:  [-3.2340375]


portfolio before change:  [-3.23483992]
curr_Stock_Price:  103.13843279717113
curr_Factors:  [ 1.03138433e+02 -7.12584348e-02 -9.45840664e-01]
mat_Sqrt:  [[37.29924164  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00551169 -0.07234747  0.23052668]
Stock Position:  -0.005511687899700601
Bond Position:  [-2.66637306]


portfolio before change:  [-3.23478904]
curr_Stock_Price:  103.0082450823674
curr_Factors:  [ 1.03008245e+02  2.26693554e-02 -9.48427399e-01]
mat_Sqrt:  [[40.81505427  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00185065 0.01149662 0.19531313]
Stock Position:  0.0018506473463684482
Bond Position:  [-3.42542097]


portfolio before change:  [-3.23300164]
curr_Stock_Price:  104.43685653839775
curr_Factors:  [ 1.04436857e+02  6.65002248e-02 -9.32530860e-01]
mat_Sqrt:  [[43.9280035   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00063358  0.00446889 -0.00778009]
Stock Position:  0.0006335844895851185
Bond Position:  [-3.29917122]


portfolio before change:  [-3.23189456]
curr_Stock_Price:  107.48614318302502
curr_Factors:  [ 1.07486143e+02 -5.13056084e-02 -9.18589693e-01]
mat_Sqrt:  [[40.75044001  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00198724 -0.06375893  1.00646289]
Stock Position:  -0.0019872368982282733
Bond Position:  [-3.01829413]


portfolio before change:  [-3.22774108]
curr_Stock_Price:  105.01630668582379
curr_Factors:  [105.01630669  -0.23920591  -0.93357568]
mat_Sqrt:  [[32.50305406  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00238286 0.01470517 0.11682058]
Stock Position:  0.002382861045066004
Bond Position:  [-3.47798034]


portfolio before change:  [-3.23665787]
curr_Stock_Price:  101.63919289621529
curr_Factors:  [101.6391929   -0.47990587  -0.94605893]
mat_Sqrt:  [[24.42151293  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00489498 -0.14256479 -1.07987436]
Stock Position:  -0.004894975761118775
Bond Position:  [-2.73913649]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-3.23497974]
Stock Price:  101.15645210519666
PL:  [-4.39143184]
Settle:  Tensor("sub_386:0", shape=(), dtype=float64)
PL:  Tensor("sub_387:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  194
output_Z_Vals[:, i, :]:  [[ 1.19271183e+02 -4.92738716e+01 -4.92570741e+01]
 [ 5.26955415e-02  9.24983989e-02 -3.12965058e-02]
 [-2.41771887e+00 -3.26044252e+00 -9.30331927e-01]
 [ 5.89094302e-02  1.64514182e-01 -7.28838720e-02]
 [ 7.14627792e-01  3.61072986e-02 -4.83776454e-01]
 [ 7.57175145e-02  1.17192732e-01 -6.73936232e-03]
 [ 7.70532124e-02 -1.15264585e-01 -4.88268806e-02]
 [-1.35456386e-02 -5.87469699e-04  1.89829496e-02]
 [-8.50985704e-02 -3.74404815e-01  9.16084514e-02]
 [-1.41119150e+00 -5.39295206e-01 -5.64386254e-02]
 [ 4.56739287e-01  1.12343485e-01  7.52254888e-02]
 [-9.49533153e-02 -1.95332378e-02  3.16580569e-02]
 [-7.27704436e-01 -1.07581561e+00  2.56856555e-01]
 [-2.11782505e-02 -2.75523491e-02 -2.18248022e-02]
 [ 4.99961877e-02  1.17228551e-01 -1.01129468e-01]
 [ 7.69810209e-02  2.95127873e-02  5.77211628e-02]
 [ 3.31788958e-03 -7.93799700e-03 -2.44032301e-02]
 [ 2.36772943e-02 -7.99726839e-02  1.33307272e-01]
 [-7.40799202e-03  1.85736215e-02 -1.20870577e-02]
 [ 6.50412552e-02 -5.73651853e-01 -4.31602876e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.27118322 -49.27387164 -49.25707411]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [   7.3268874   -15.90307369 -140.51672192]
init_Out:  [2.48374395]
Stock Position:  7.326887399052493
Bond position:  [-730.20499595]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-4.96720254]
curr_Stock_Price:  99.00798633483389
curr_Factors:  [99.00798633 -0.78292948 -0.99826944]
mat_Sqrt:  [[16.67651757  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00390899  0.02985373 -0.08928022]
Stock Position:  0.003908989114771268
Bond Position:  [-5.35422368]


portfolio before change:  [-4.96637315]
curr_Stock_Price:  99.56263554024437
curr_Factors:  [99.56263554 -0.67785887 -0.98800312]
mat_Sqrt:  [[18.8200909   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.17391824 -1.0523033  -2.65397803]
Stock Position:  -0.17391824185569899
Bond Position:  [12.34938538]


portfolio before change:  [-5.06006993]
curr_Stock_Price:  100.11912986886742
curr_Factors:  [100.11912987  -0.60285547  -0.99255105]
mat_Sqrt:  [[20.30676867  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00382205  0.05309672 -0.2079174 ]
Stock Position:  0.003822045254431688
Bond Position:  [-5.44272977]


portfolio before change:  [-5.05596591]
curr_Stock_Price:  101.54895981497123
curr_Factors:  [101.54895981  -0.98746898  -0.99669646]
mat_Sqrt:  [[13.96250618  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.04463724  0.01165358 -1.38007957]
Stock Position:  0.04463723776453572
Bond Position:  [-9.58883097]


portfolio before change:  [-5.00111579]
curr_Stock_Price:  102.83146800692245
curr_Factors:  [102.83146801  -1.08343519  -0.98420957]
mat_Sqrt:  [[13.0064665   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00755499  0.03782379 -0.01922552]
Stock Position:  0.007554989219589647
Bond Position:  [-5.77800642]


portfolio before change:  [-4.99374726]
curr_Stock_Price:  103.99800997541738
curr_Factors:  [103.99800998  -1.55001082  -1.02063556]
mat_Sqrt:  [[ 7.95440117  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00547599 -0.03720148 -0.1392895 ]
Stock Position:  0.0054759851007167475
Bond Position:  [-5.56323882]


portfolio before change:  [-4.99093439]
curr_Stock_Price:  104.76569904639098
curr_Factors:  [104.76569905  -1.81130884  -1.02338727]
mat_Sqrt:  [[ 6.15355716  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00159106 -0.00018961  0.05415307]
Stock Position:  -0.001591059731120061
Bond Position:  [-4.82424591]


portfolio before change:  [-4.99260226]
curr_Stock_Price:  105.05585284952251
curr_Factors:  [105.05585285  -1.52485053  -1.05186596]
mat_Sqrt:  [[ 7.98668393  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01788278 -0.12083863  0.26133341]
Stock Position:  -0.017882783093340467
Bond Position:  [-3.11391123]


portfolio before change:  [-4.98020028]
curr_Stock_Price:  104.31880055519574
curr_Factors:  [104.31880056  -1.4563935   -1.02720482]
mat_Sqrt:  [[ 8.70461447  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.17608995 -0.17405678 -0.16100369]
Stock Position:  -0.1760899539202829
Bond Position:  [13.3892925]


portfolio before change:  [-4.75863229]
curr_Stock_Price:  103.07954611583244
curr_Factors:  [103.07954612  -1.34130307  -1.00529902]
mat_Sqrt:  [[ 9.86407024  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.05018483 0.0362587  0.21459738]
Stock Position:  0.05018482549423675
Bond Position:  [-9.93166132]


portfolio before change:  [-4.77951729]
curr_Stock_Price:  102.71286589219827
curr_Factors:  [102.71286589  -1.27787412  -1.01845191]
mat_Sqrt:  [[10.33577686  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0089474  -0.00630433  0.09031162]
Stock Position:  -0.008947401646147523
Bond Position:  [-3.86050403]


portfolio before change:  [-4.77668493]
curr_Stock_Price:  102.28842837206514
curr_Factors:  [102.28842837  -1.13219935  -1.02881673]
mat_Sqrt:  [[11.78444538  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.07593686 -0.347218    0.73274026]
Stock Position:  -0.07593685785856251
Bond Position:  [2.99077692]


portfolio before change:  [-4.88238273]
curr_Stock_Price:  103.69019277507948
curr_Factors:  [103.69019278  -1.23668266  -1.03260108]
mat_Sqrt:  [[10.72013556  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00291576 -0.00889248 -0.06226009]
Stock Position:  -0.002915757835742602
Bond Position:  [-4.58004723]


portfolio before change:  [-4.88288922]
curr_Stock_Price:  103.47115367640819
curr_Factors:  [103.47115368  -1.10418053  -1.03600159]
mat_Sqrt:  [[12.17166536  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00437758  0.03783535 -0.28849422]
Stock Position:  0.004377576735933436
Bond Position:  [-5.33584213]


portfolio before change:  [-4.88832775]
curr_Stock_Price:  102.53355590825139
curr_Factors:  [102.53355591  -0.89431204  -1.03203014]
mat_Sqrt:  [[14.93709848  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00634578 0.00952521 0.16466241]
Stock Position:  0.006345782378653786
Bond Position:  [-5.53898338]


portfolio before change:  [-4.88303132]
curr_Stock_Price:  103.58643603294509
curr_Factors:  [103.58643603  -1.17639903  -1.08866948]
mat_Sqrt:  [[10.75464646  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00030533 -0.00256198 -0.06961562]
Stock Position:  -0.0003053318179999091
Bond Position:  [-4.85140308]


portfolio before change:  [-4.88417684]
curr_Stock_Price:  103.36541683789325
curr_Factors:  [103.36541684  -1.19284225  -1.03468162]
mat_Sqrt:  [[11.14227654  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00310207 -0.02581107  0.38028854]
Stock Position:  0.0031020744720724604
Bond Position:  [-5.20482406]


portfolio before change:  [-4.88815615]
curr_Stock_Price:  102.50214282391877
curr_Factors:  [102.50214282  -0.78809243  -1.02604823]
mat_Sqrt:  [[16.7055841   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00036419  0.00599461 -0.03448101]
Stock Position:  -0.0003641852751396642
Bond Position:  [-4.85082638]


portfolio before change:  [-4.8894439]
curr_Stock_Price:  102.70779718190721
curr_Factors:  [102.70779718  -0.85385697  -1.00810734]
mat_Sqrt:  [[15.9574169   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00878309 -0.18514534 -1.23124287]
Stock Position:  -0.008783094909588339
Bond Position:  [-3.98735157]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-4.86855159]
Stock Price:  100.21559223001697
PL:  [-5.08414382]
Settle:  Tensor("sub_388:0", shape=(), dtype=float64)
PL:  Tensor("sub_389:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  195
output_Z_Vals[:, i, :]:  [[ 1.19271183e+02 -4.92738716e+01 -4.92570741e+01]
 [ 3.95976539e-02  7.25109809e-02 -3.60707581e-02]
 [-2.06547262e+00 -2.78273666e+00 -7.91813033e-01]
 [ 1.00375220e-01  2.68094493e-01 -4.63676385e-02]
 [ 6.75213540e-01 -5.23136273e-02 -3.98254104e-01]
 [ 7.57175145e-02  1.17192732e-01 -6.73936232e-03]
 [ 1.83161181e-02  3.93952007e-02  1.14789517e-01]
 [ 1.11183099e-01  2.81077414e-01  1.46313883e-01]
 [ 2.72243961e-02  1.40076214e-01 -5.77858009e-02]
 [-7.35422942e-01 -2.84291653e-01 -2.18221648e-02]
 [-3.23746048e-02 -3.81091063e-02 -3.24510487e-01]
 [ 1.64591564e-02 -9.19107318e-03  2.40872578e-02]
 [-6.81412741e-01 -1.11160176e+00  2.30458582e-01]
 [ 6.61979479e-02  7.64608347e-02  1.61836016e-01]
 [ 1.09443511e-01  1.20659486e-01 -1.04033126e-01]
 [-6.71589950e-02  6.87629499e-02  1.21338365e-01]
 [ 1.24953035e-01  1.15488292e-01  1.03089300e-01]
 [ 8.87716277e-02 -1.90158778e-02  4.15700678e-02]
 [-2.80461715e-02 -2.39780473e-02 -1.79328874e-02]
 [ 9.17909202e-02 -7.54885879e-01 -4.85242992e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.27118322 -49.27387164 -49.25707411]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [   7.3268874   -15.90307369 -140.51672192]
init_Out:  [2.48374395]
Stock Position:  7.326887399052493
Bond position:  [-730.20499595]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [1.28977236]
curr_Stock_Price:  99.8619608202525
curr_Factors:  [99.86196082 -1.14012164 -1.00097206]
mat_Sqrt:  [[11.7364001   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0040077   0.02340282 -0.10289983]
Stock Position:  0.004007701065087288
Bond Position:  [0.88955547]


portfolio before change:  [1.29010153]
curr_Stock_Price:  99.88859935358755
curr_Factors:  [99.88859935 -1.22553634 -1.03577602]
mat_Sqrt:  [[10.40975341  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.26851016 -0.8981244  -2.25882218]
Stock Position:  -0.2685101567641111
Bond Position:  [28.111205]


portfolio before change:  [1.14937977]
curr_Stock_Price:  100.43885952507374
curr_Factors:  [100.43885953  -1.02105073  -1.01941981]
mat_Sqrt:  [[13.05379161  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01115653  0.08652713 -0.13227397]
Stock Position:  0.011156530559214391
Bond Position:  [0.02883056]


portfolio before change:  [1.14514381]
curr_Stock_Price:  100.05852964901405
curr_Factors:  [100.05852965  -0.69097987  -1.02535604]
mat_Sqrt:  [[17.98286578  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.03243319 -0.01688415 -1.13610811]
Stock Position:  0.03243319470700506
Bond Position:  [-2.10007396]


portfolio before change:  [1.1410652]
curr_Stock_Price:  99.94896496441109
curr_Factors:  [99.94896496 -0.51491292 -1.00323161]
mat_Sqrt:  [[21.90062482  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0044868   0.03782379 -0.01922552]
Stock Position:  0.00448679957755888
Bond Position:  [0.69261422]


portfolio before change:  [1.15137693]
curr_Stock_Price:  102.20860645911488
curr_Factors:  [102.20860646  -0.60849073  -1.001878  ]
mat_Sqrt:  [[20.42270261  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00243792 0.01271475 0.32746254]
Stock Position:  0.0024379213055007636
Bond Position:  [0.90220039]


portfolio before change:  [1.1409687]
curr_Stock_Price:  97.84677212095302
curr_Factors:  [97.84677212 -0.54681082 -0.98725291]
mat_Sqrt:  [[21.10139115  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00940336 0.09071735 0.41739278]
Stock Position:  0.009403360206922012
Bond Position:  [0.22088026]


portfolio before change:  [1.13696067]
curr_Stock_Price:  97.41466549383695
curr_Factors:  [97.41466549 -0.93037392 -1.01626256]
mat_Sqrt:  [[13.90627659  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00316561  0.0452094  -0.16484681]
Stock Position:  0.003165610586321755
Bond Position:  [0.82858378]


portfolio before change:  [1.13179778]
curr_Stock_Price:  95.71829178577568
curr_Factors:  [95.71829179 -0.7904328  -1.03846888]
mat_Sqrt:  [[15.37138614  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.05190867 -0.09175474 -0.06225256]
Stock Position:  -0.0519086669478399
Bond Position:  [6.10040671]


portfolio before change:  [1.18505746]
curr_Stock_Price:  94.72164931741221
curr_Factors:  [94.72164932 -0.53375965 -1.08213633]
mat_Sqrt:  [[18.82238038  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00565253 -0.01229966 -0.92573809]
Stock Position:  -0.005652527325603265
Bond Position:  [1.72047417]


portfolio before change:  [1.17409283]
curr_Stock_Price:  96.73752587623405
curr_Factors:  [96.73752588 -0.90857812 -1.12867233]
mat_Sqrt:  [[12.61328896  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00154597 -0.00296641  0.06871424]
Stock Position:  0.0015459748363804377
Bond Position:  [1.02453905]


portfolio before change:  [1.17376911]
curr_Stock_Price:  96.36242976408042
curr_Factors:  [96.36242976 -0.9502091  -1.15363966]
mat_Sqrt:  [[11.75487019  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.07326966 -0.35876792  0.65743419]
Stock Position:  -0.07326965966995233
Bond Position:  [8.23421155]


portfolio before change:  [1.11512875]
curr_Stock_Price:  97.19086499133867
curr_Factors:  [97.19086499 -1.07188481 -1.15352057]
mat_Sqrt:  [[10.4989089   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01093829 0.02467763 0.46167311]
Stock Position:  0.010938287975760875
Bond Position:  [0.05202708]


portfolio before change:  [1.12590375]
curr_Stock_Price:  98.1747469448458
curr_Factors:  [98.17474694 -1.2046656  -1.1073871 ]
mat_Sqrt:  [[ 9.72496529  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01160285  0.03894268 -0.29677755]
Stock Position:  0.01160285400966863
Bond Position:  [-0.01320351]


portfolio before change:  [1.12681277]
curr_Stock_Price:  98.25337663909553
curr_Factors:  [98.25337664 -0.87043008 -1.0742425 ]
mat_Sqrt:  [[14.0535783   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00201762  0.02219315  0.34614458]
Stock Position:  -0.0020176161539915893
Bond Position:  [1.32505037]


portfolio before change:  [1.1243434]
curr_Stock_Price:  99.64148876293928
curr_Factors:  [99.64148876 -0.81382838 -1.05117413]
mat_Sqrt:  [[15.43405023  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01098675 0.03727369 0.29408508]
Stock Position:  0.010986746620841426
Bond Position:  [0.02960761]


portfolio before change:  [1.14246326]
curr_Stock_Price:  101.29006192509101
curr_Factors:  [101.29006193  -1.01179517  -1.06882425]
mat_Sqrt:  [[12.64635311  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00738359 -0.00613735  0.11858783]
Stock Position:  0.007383589688278011
Bond Position:  [0.394579]


portfolio before change:  [1.14407102]
curr_Stock_Price:  101.49444756986989
curr_Factors:  [101.49444757  -1.24050038  -1.05924301]
mat_Sqrt:  [[10.17832746  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00359599 -0.00773888 -0.05115754]
Stock Position:  -0.0035959940716781226
Bond Position:  [1.50904445]


portfolio before change:  [1.14047663]
curr_Stock_Price:  102.59892523828229
curr_Factors:  [102.59892524  -1.1963324   -1.06085544]
mat_Sqrt:  [[10.73639759  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01502826 -0.24363837 -1.38426319]
Stock Position:  -0.01502825543710596
Bond Position:  [2.68235949]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [1.15852261]
Stock Price:  101.44274944145862
PL:  [-0.28422683]
Settle:  Tensor("sub_390:0", shape=(), dtype=float64)
PL:  Tensor("sub_391:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  196
output_Z_Vals[:, i, :]:  [[ 1.19271183e+02 -4.92738716e+01 -4.92570741e+01]
 [ 3.12749673e-02  5.91396485e-02 -3.99330203e-02]
 [-2.44724505e+00 -3.31637506e+00 -9.47191911e-01]
 [-6.09186804e-02  2.85786343e-02 -1.37931279e-01]
 [ 4.94234260e-01 -1.51846315e-01 -1.85364005e-01]
 [-5.55275024e-02 -8.11186041e-02  2.01121902e-02]
 [-8.93927397e-03  2.84298052e-02  1.98163612e-02]
 [ 1.38409001e-01  3.61231808e-01  2.21130721e-01]
 [-1.36796668e-04  2.17691997e-01 -8.95212968e-02]
 [-8.59193519e-01 -3.50512635e-01 -2.77956763e-02]
 [ 8.00845318e-02 -3.31763695e-02 -2.51258179e-01]
 [-7.19280857e-03 -4.77183360e-02  3.05052852e-02]
 [-6.34789427e-01 -1.15686137e+00  2.17955158e-01]
 [ 6.38343971e-02  7.42249633e-02  1.60200233e-01]
 [ 1.20091916e-01  1.29152797e-01 -1.04637958e-01]
 [-1.63444202e-01  9.74503676e-02  1.38626773e-01]
 [ 1.06266497e-01  1.12637456e-01  9.49822112e-02]
 [ 1.15216134e-01 -1.08333916e-02 -3.18137274e-02]
 [-3.66100900e-02 -3.53196731e-02 -2.22416274e-02]
 [ 8.74731876e-02 -7.11256297e-01 -5.31529070e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.27118322 -49.27387164 -49.25707411]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [   7.3268874   -15.90307369 -140.51672192]
init_Out:  [2.48374395]
Stock Position:  7.326887399052493
Bond position:  [-730.20499595]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [0.02521235]
curr_Stock_Price:  99.68936911294858
curr_Factors:  [99.68936911 -0.83142666 -1.00062978]
mat_Sqrt:  [[15.9586756   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00220542  0.01908724 -0.11391779]
Stock Position:  0.0022054150832139276
Bond Position:  [-0.19464409]


portfolio before change:  [0.02459154]
curr_Stock_Price:  99.42994342668003
curr_Factors:  [99.42994343 -0.59608764 -1.00466881]
mat_Sqrt:  [[20.05937984  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.16538607 -1.07035545 -2.70207487]
Stock Position:  -0.16538607099607697
Bond Position:  [16.46891922]


portfolio before change:  [0.31002002]
curr_Stock_Price:  97.72900975582334
curr_Factors:  [97.72900976 -0.54702796 -1.0530568 ]
mat_Sqrt:  [[19.72947461  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00421908  0.00922371 -0.39347955]
Stock Position:  -0.004219078165601014
Bond Position:  [0.72234635]


portfolio before change:  [0.30774702]
curr_Stock_Price:  98.31056050882019
curr_Factors:  [98.31056051 -0.49872087 -1.07127289]
mat_Sqrt:  [[20.45316618  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.02079881 -0.04900819 -0.52879191]
Stock Position:  0.02079880872850186
Bond Position:  [-1.73699552]


portfolio before change:  [0.30533437]
curr_Stock_Price:  98.21544188191737
curr_Factors:  [98.21544188 -0.4898473  -1.06610793]
mat_Sqrt:  [[20.72225464  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00328055 -0.02618092  0.05737448]
Stock Position:  -0.0032805496167356858
Bond Position:  [0.627535]


portfolio before change:  [0.30424092]
curr_Stock_Price:  98.59658115414327
curr_Factors:  [98.59658115 -0.57599517 -1.09214721]
mat_Sqrt:  [[18.5950276   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [4.88804602e-05 9.17568018e-03 5.65305626e-02]
Stock Position:  4.888046015662147e-05
Bond Position:  [0.29942148]


portfolio before change:  [0.30431099]
curr_Stock_Price:  98.49839769889489
curr_Factors:  [98.4983977  -0.37359563 -1.05928034]
mat_Sqrt:  [[23.50385163  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01094643 0.11658706 0.6308244 ]
Stock Position:  0.010946429471774469
Bond Position:  [-0.77389477]


portfolio before change:  [0.29919649]
curr_Stock_Price:  98.04884479785966
curr_Factors:  [98.0488448  -0.59727765 -1.06807329]
mat_Sqrt:  [[18.54341676  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00140351  0.07025979 -0.25537934]
Stock Position:  0.0014035136234167545
Bond Position:  [0.1615836]


portfolio before change:  [0.29850241]
curr_Stock_Price:  97.52552680240427
curr_Factors:  [97.5255268  -0.81919706 -1.0775241 ]
mat_Sqrt:  [[14.63466452  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.06398612 -0.11312747 -0.07929333]
Stock Position:  -0.06398611860855023
Bond Position:  [6.53878233]


portfolio before change:  [0.29125583]
curr_Stock_Price:  97.66433003581832
curr_Factors:  [97.66433004 -0.86708344 -1.07544445]
mat_Sqrt:  [[13.99931639  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00157326 -0.01070763 -0.71676965]
Stock Position:  0.0015732605866666063
Bond Position:  [0.13760439]


portfolio before change:  [0.29190064]
curr_Stock_Price:  98.05232065398707
curr_Factors:  [98.05232065 -0.88991076 -1.04598969]
mat_Sqrt:  [[14.14838895  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00075672 -0.01540103  0.08702309]
Stock Position:  -0.0007567227534945863
Bond Position:  [0.36609907]


portfolio before change:  [0.29296146]
curr_Stock_Price:  96.77142561065885
curr_Factors:  [96.77142561 -0.66473418 -1.03817992]
mat_Sqrt:  [[17.62710296  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.04688478 -0.3733754   0.6217654 ]
Stock Position:  -0.04688478056210979
Bond Position:  [4.83006852]


portfolio before change:  [0.27501856]
curr_Stock_Price:  97.17988583318862
curr_Factors:  [97.17988583 -0.76684681 -0.99970411]
mat_Sqrt:  [[16.61013133  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00672398 0.023956   0.45700667]
Stock Position:  0.006723982951843761
Bond Position:  [-0.37841733]


portfolio before change:  [0.27097872]
curr_Stock_Price:  96.59314550463087
curr_Factors:  [96.5931455  -1.0807177  -1.02436294]
mat_Sqrt:  [[11.7685079   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01062972  0.04168389 -0.29850297]
Stock Position:  0.010629723642051614
Bond Position:  [-0.75577973]


portfolio before change:  [0.27546222]
curr_Stock_Price:  97.03271192583979
curr_Factors:  [97.03271193 -1.08232352 -1.01633188]
mat_Sqrt:  [[11.89826706  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00968672  0.03145197  0.3954636 ]
Stock Position:  -0.009686718010530872
Bond Position:  [1.21539073]


portfolio before change:  [0.25882363]
curr_Stock_Price:  98.78175329302063
curr_Factors:  [98.78175329 -1.14122556 -1.0022153 ]
mat_Sqrt:  [[11.58223018  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01283403 0.03635358 0.27095781]
Stock Position:  0.012834029551333616
Bond Position:  [-1.00894431]


portfolio before change:  [0.25464044]
curr_Stock_Price:  98.47546447932727
curr_Factors:  [98.47546448 -1.14687561 -1.00680406]
mat_Sqrt:  [[11.42870021  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00931959 -0.00349646 -0.09075571]
Stock Position:  0.009319592398874008
Bond Position:  [-0.66311075]


portfolio before change:  [0.27813537]
curr_Stock_Price:  101.01427962276959
curr_Factors:  [101.01427962  -1.38256602  -1.07183352]
mat_Sqrt:  [[ 8.67861844  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00557229 -0.01139938 -0.06344917]
Stock Position:  -0.005572285680213808
Bond Position:  [0.84101579]


portfolio before change:  [0.27526294]
curr_Stock_Price:  101.5675017497387
curr_Factors:  [101.56750175  -1.17918517  -1.05946638]
mat_Sqrt:  [[10.82731454  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01535093 -0.22955698 -1.51630449]
Stock Position:  -0.015350926822145203
Bond Position:  [1.83441822]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [0.28082895]
Stock Price:  101.23479509624498
PL:  [-0.95396614]
Settle:  Tensor("sub_392:0", shape=(), dtype=float64)
PL:  Tensor("sub_393:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  197
output_Z_Vals[:, i, :]:  [[ 1.19271183e+02 -4.92738716e+01 -4.92570741e+01]
 [-1.33699093e-03  2.36099157e-03 -5.87932861e-02]
 [-2.24362017e+00 -3.02030100e+00 -8.60535999e-01]
 [-2.60421801e-02  3.77404847e-02 -1.13997737e-01]
 [ 4.14819047e-01 -6.81524799e-02 -2.47802051e-01]
 [-6.68719655e-02 -9.82600977e-02  2.24331655e-02]
 [-2.62082069e-02  4.51615208e-02 -3.37703562e-02]
 [ 1.06839063e-01  2.68288359e-01  1.34376464e-01]
 [-1.69529907e-01  3.69729077e-01 -9.37816455e-02]
 [-1.00211410e+00 -4.11132923e-01 -3.50302711e-02]
 [ 2.34907488e-01  7.61870671e-03 -1.04580045e-01]
 [ 2.21155513e-02 -7.14273395e-02  3.69658709e-02]
 [-5.56847627e-01 -1.31935135e+00  1.99569683e-01]
 [ 3.52995734e-02  4.88164343e-02  1.14688871e-01]
 [ 8.72108488e-02  1.23681252e-01 -1.03337708e-01]
 [-2.29043957e-01  1.19817978e-01  1.40519331e-01]
 [ 4.43186513e-02  1.23855854e-01  1.36238186e-01]
 [ 1.15216134e-01 -1.08333916e-02 -3.18137274e-02]
 [-4.86823163e-02 -8.68645919e-02 -1.20649457e-02]
 [ 5.00712698e-02 -3.72878458e-01 -4.07776775e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.27118322 -49.27387164 -49.25707411]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [   7.3268874   -15.90307369 -140.51672192]
init_Out:  [2.48374395]
Stock Position:  7.326887399052493
Bond position:  [-730.20499595]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [8.42770363]
curr_Stock_Price:  100.83617140706858
curr_Factors:  [100.83617141  -0.921857    -1.01932041]
mat_Sqrt:  [[14.47350479  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00088826  0.00076201 -0.16772088]
Stock Position:  -0.0008882565070211112
Bond Position:  [8.51727201]


portfolio before change:  [8.43075451]
curr_Stock_Price:  99.7989718920793
curr_Factors:  [99.79897189 -0.98726252 -0.96944352]
mat_Sqrt:  [[14.10390688  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.21524481 -0.97479796 -2.45486968]
Stock Position:  -0.21524480612613908
Bond Position:  [29.91196487]


portfolio before change:  [8.67568259]
curr_Stock_Price:  98.69581334207895
curr_Factors:  [98.69581334 -0.83318474 -0.96229299]
mat_Sqrt:  [[16.3882529   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0025389   0.01218069 -0.32520381]
Stock Position:  -0.002538899466498712
Bond Position:  [8.92626133]


portfolio before change:  [8.67674286]
curr_Stock_Price:  99.15726260205385
curr_Factors:  [99.1572626  -1.17083554 -0.98453967]
mat_Sqrt:  [[11.48833171  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.03049399 -0.02199612 -0.70691028]
Stock Position:  0.030493992298612934
Bond Position:  [5.65304205]


portfolio before change:  [8.67844913]
curr_Stock_Price:  99.16686560715766
curr_Factors:  [99.16686561 -0.92973048 -0.99293285]
mat_Sqrt:  [[14.49988351  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00567936 -0.03171331  0.06399558]
Stock Position:  -0.005679361019595535
Bond Position:  [9.24165356]


portfolio before change:  [8.68682938]
curr_Stock_Price:  98.09816234424
curr_Factors:  [98.09816234 -0.94585704 -0.95205341]
mat_Sqrt:  [[14.70309753  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00162435  0.01457582 -0.09633743]
Stock Position:  -0.0016243512715780628
Bond Position:  [8.84617526]


portfolio before change:  [8.68907878]
curr_Stock_Price:  98.07502857645915
curr_Factors:  [98.07502858 -0.55884719 -0.93026714]
mat_Sqrt:  [[22.1230148   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00854462 0.0865897  0.38333865]
Stock Position:  0.008544616428978946
Bond Position:  [7.85106528]


portfolio before change:  [8.67849016]
curr_Stock_Price:  96.60607718743502
curr_Factors:  [96.60607719 -0.24052465 -0.94258338]
mat_Sqrt:  [[29.59287495  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00382533  0.11932955 -0.26753293]
Stock Position:  -0.003825325309650796
Bond Position:  [9.04803984]


portfolio before change:  [8.66883406]
curr_Stock_Price:  99.72173340988583
curr_Factors:  [99.72173341 -0.80255511 -0.94177211]
mat_Sqrt:  [[17.42762201  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.06272725 -0.13269258 -0.09993161]
Stock Position:  -0.06272724854230151
Bond Position:  [14.92410402]


portfolio before change:  [8.68307726]
curr_Stock_Price:  99.55415541603858
curr_Factors:  [99.55415542 -0.94724483 -0.89653853]
mat_Sqrt:  [[15.75122923  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01365705  0.00245893 -0.29833776]
Stock Position:  0.013657050774524622
Bond Position:  [7.3234611]


portfolio before change:  [8.6972411]
curr_Stock_Price:  100.45718713040266
curr_Factors:  [100.45718713  -0.85902403  -0.90994935]
mat_Sqrt:  [[17.12874862  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00088046 -0.02305307  0.10545334]
Stock Position:  0.0008804574005321301
Bond Position:  [8.60879283]


portfolio before change:  [8.6979921]
curr_Stock_Price:  98.86543253511448
curr_Factors:  [98.86543254 -0.66508119 -0.89856544]
mat_Sqrt:  [[20.6995722   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.03794388 -0.42581882  0.56931675]
Stock Position:  -0.03794388094240432
Bond Position:  [12.4493303]


portfolio before change:  [8.70277424]
curr_Stock_Price:  98.82143550612531
curr_Factors:  [98.82143551 -0.50086657 -0.91141155]
mat_Sqrt:  [[24.07168904  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00285293 0.01575544 0.32717542]
Stock Position:  0.0028529345768265888
Bond Position:  [8.42084315]


portfolio before change:  [8.70360753]
curr_Stock_Price:  98.37551626322488
curr_Factors:  [98.37551626 -0.67530621 -0.93566805]
mat_Sqrt:  [[19.64489861  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00465075  0.03991795 -0.29479372]
Stock Position:  0.0046507472036809204
Bond Position:  [8.24608787]


portfolio before change:  [8.69622083]
curr_Stock_Price:  96.34391131665696
curr_Factors:  [96.34391132 -1.42694042 -0.91548424]
mat_Sqrt:  [[ 9.25810638  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01899987  0.03867109  0.40086254]
Stock Position:  -0.018999870901838526
Bond Position:  [10.52674271]


portfolio before change:  [8.6954252]
curr_Stock_Price:  96.52431468088504
curr_Factors:  [96.52431468 -1.3536101  -0.91696811]
mat_Sqrt:  [[ 9.96637309  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00977388 0.0399743  0.38864962]
Stock Position:  0.00977387902662639
Bond Position:  [7.75200823]


portfolio before change:  [8.71077117]
curr_Stock_Price:  97.89610580068567
curr_Factors:  [97.8961058  -1.33051164 -0.92776382]
mat_Sqrt:  [[10.23313835  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01040842 -0.00349646 -0.09075571]
Stock Position:  0.010408422513898294
Bond Position:  [7.69182714]


portfolio before change:  [8.72372175]
curr_Stock_Price:  98.95557288292282
curr_Factors:  [98.95557288 -0.73026852 -0.94009503]
mat_Sqrt:  [[18.62132536  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00369878 -0.02803543 -0.03441793]
Stock Position:  -0.003698782030035502
Bond Position:  [9.08973684]


portfolio before change:  [8.72715845]
curr_Stock_Price:  98.64087896029814
curr_Factors:  [98.64087896 -0.34656756 -0.91192318]
mat_Sqrt:  [[28.02214342  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00389975 -0.120346   -1.16327364]
Stock Position:  -0.003899748517837461
Bond Position:  [9.11183307]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [8.73265138]
Stock Price:  97.81654794562988
PL:  [8.73265138]
Settle:  Tensor("sub_394:0", shape=(), dtype=float64)
PL:  Tensor("sub_395:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  198
output_Z_Vals[:, i, :]:  [[ 1.19271183e+02 -4.92738716e+01 -4.92570741e+01]
 [ 1.74419933e-02  3.69154192e-02 -4.63524105e-02]
 [-2.31160275e+00 -3.11095752e+00 -8.86761252e-01]
 [-1.34568546e-01  4.77561166e-02  8.87351049e-02]
 [ 7.60406033e-01  1.31336705e-01 -5.82375690e-01]
 [ 7.57175145e-02  1.17192732e-01 -6.73936232e-03]
 [ 2.21771604e-02  2.95092719e-02  1.13588928e-01]
 [-6.72583779e-03  4.88795469e-02  6.41584157e-02]
 [ 9.03343493e-03 -1.36672458e-01  6.26331424e-03]
 [-1.09641851e+00 -4.50192852e-01 -3.98239047e-02]
 [ 2.20326218e-01  7.52317784e-03 -1.08948345e-01]
 [ 1.17110779e-02 -6.97943776e-02  3.59068249e-02]
 [-6.41840227e-01 -1.25973764e+00  2.23531280e-01]
 [ 5.26914961e-02  6.39588545e-02  1.48020462e-01]
 [ 9.33046035e-02  1.19264249e-01 -1.03684444e-01]
 [-1.94816203e-01  1.08348218e-01  1.42473498e-01]
 [ 5.30918806e-02  1.17534276e-01  1.24378231e-01]
 [ 1.15216134e-01 -1.08333916e-02 -3.18137274e-02]
 [-6.08037415e-02 -2.40433022e-01  4.75474470e-02]
 [ 5.70140036e-02 -4.18923194e-01 -4.58359128e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.27118322 -49.27387164 -49.25707411]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [   7.3268874   -15.90307369 -140.51672192]
init_Out:  [2.48374395]
Stock Position:  7.326887399052493
Bond position:  [-730.20499595]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [2.38970794]
curr_Stock_Price:  100.01208399280404
curr_Factors:  [100.01208399  -0.72407209  -0.98680767]
mat_Sqrt:  [[18.07285799  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00085851  0.0119144  -0.13223053]
Stock Position:  0.0008585070210911435
Bond Position:  [2.30384686]


portfolio before change:  [2.39034514]
curr_Stock_Price:  100.08333687885018
curr_Factors:  [100.08333688  -0.88215081  -0.93897154]
mat_Sqrt:  [[16.19788791  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.19308898 -1.00405722 -2.52968303]
Stock Position:  -0.19308898131162447
Bond Position:  [21.71533471]


portfolio before change:  [2.05021709]
curr_Stock_Price:  101.87296548336201
curr_Factors:  [101.87296548  -1.17623042  -0.94565133]
mat_Sqrt:  [[12.20498965  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00874293  0.01541322  0.25313656]
Stock Position:  -0.00874293179949317
Bond Position:  [2.94088548]


portfolio before change:  [2.04349676]
curr_Stock_Price:  102.72572725892589
curr_Factors:  [102.72572726  -1.20538231  -0.97284002]
mat_Sqrt:  [[11.63293459  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.05745223  0.04238874 -1.66135574]
Stock Position:  0.05745223448216317
Bond Position:  [-3.85832581]


portfolio before change:  [1.98956907]
curr_Stock_Price:  101.80386591912735
curr_Factors:  [101.80386592  -0.99172691  -0.98199306]
mat_Sqrt:  [[14.14453186  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00694712  0.03782379 -0.01922552]
Stock Position:  0.0069471167493074856
Bond Position:  [1.28232573]


portfolio before change:  [1.99100078]
curr_Stock_Price:  101.96380111339138
curr_Factors:  [101.96380111  -1.1829779   -0.94391995]
mat_Sqrt:  [[12.15474959  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00422773 0.00952408 0.3240376 ]
Stock Position:  0.004227726606758676
Bond Position:  [1.5599257]


portfolio before change:  [1.99303955]
curr_Stock_Price:  102.35378395978174
curr_Factors:  [102.35378396  -1.18555657  -0.94885048]
mat_Sqrt:  [[12.10995972  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00134996 0.01577581 0.1830261 ]
Stock Position:  0.0013499582233548195
Bond Position:  [1.85486622]


portfolio before change:  [1.99260741]
curr_Stock_Price:  101.69012257477385
curr_Factors:  [101.69012257  -1.06239857  -0.91623454]
mat_Sqrt:  [[14.05948226  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00125084 -0.04411085  0.01786749]
Stock Position:  -0.0012508440682823683
Bond Position:  [2.1198059]


portfolio before change:  [1.99407202]
curr_Stock_Price:  100.94295601319259
curr_Factors:  [100.94295601  -0.81841218  -0.92138046]
mat_Sqrt:  [[17.72122228  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.06751469 -0.14529912 -0.11360652]
Stock Position:  -0.0675146861129007
Bond Position:  [8.80920401]


portfolio before change:  [2.09604129]
curr_Stock_Price:  99.46525234100343
curr_Factors:  [99.46525234 -0.83928622 -0.92899985]
mat_Sqrt:  [[16.97127647  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0117624  0.0024281 -0.3107993]
Stock Position:  0.011762397084375525
Bond Position:  [0.9260915]


portfolio before change:  [2.09051534]
curr_Stock_Price:  98.9757682827075
curr_Factors:  [98.97576828 -1.25030601 -0.87694355]
mat_Sqrt:  [[11.7944077   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00040645 -0.02252604  0.10243218]
Stock Position:  0.00040644772900527064
Bond Position:  [2.05028686]


portfolio before change:  [2.09066308]
curr_Stock_Price:  98.07800522839881
curr_Factors:  [98.07800523 -1.10554637 -0.88241525]
mat_Sqrt:  [[13.43417077  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.06352122 -0.40657857  0.63767252]
Stock Position:  -0.06352122349592308
Bond Position:  [8.32069797]


portfolio before change:  [2.1299899]
curr_Stock_Price:  97.49164395077709
curr_Factors:  [97.49164395 -0.80786414 -0.88981899]
mat_Sqrt:  [[17.85142872  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00537557 0.02064263 0.42226118]
Stock Position:  0.005375569337602209
Bond Position:  [1.60591681]


portfolio before change:  [2.13407595]
curr_Stock_Price:  98.1770630796773
curr_Factors:  [98.17706308 -0.89589814 -0.85766109]
mat_Sqrt:  [[17.00000072  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00567558  0.03849237 -0.29578286]
Stock Position:  0.005675577272098307
Bond Position:  [1.57686444]


portfolio before change:  [2.12784293]
curr_Stock_Price:  97.00937945900193
curr_Factors:  [97.00937946 -1.16234815 -0.82223146]
mat_Sqrt:  [[13.332812    0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01077173  0.03496924  0.40643723]
Stock Position:  -0.01077172876325613
Bond Position:  [3.17280166]


portfolio before change:  [2.13291897]
curr_Stock_Price:  96.61178907017768
curr_Factors:  [96.61178907 -1.07724527 -0.83088324]
mat_Sqrt:  [[14.33311015  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00714933 0.03793402 0.35481647]
Stock Position:  0.00714932512213075
Bond Position:  [1.44220988]


portfolio before change:  [2.13054488]
curr_Stock_Price:  96.22927861353654
curr_Factors:  [96.22927861 -0.99915663 -0.82241948]
mat_Sqrt:  [[15.56706635  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00684206 -0.00349646 -0.09075571]
Stock Position:  0.006842061647705023
Bond Position:  [1.47213822]


portfolio before change:  [2.12246694]
curr_Stock_Price:  94.9948525971973
curr_Factors:  [94.9948526  -0.83404139 -0.84806345]
mat_Sqrt:  [[17.66734237  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00567014 -0.07759942  0.13563963]
Stock Position:  -0.005670142261344235
Bond Position:  [2.66110127]


portfolio before change:  [2.12193902]
curr_Stock_Price:  95.20530069638701
curr_Factors:  [95.2053007  -0.59668703 -0.85382489]
mat_Sqrt:  [[22.32090547  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00546844 -0.13520688 -1.30757101]
Stock Position:  -0.005468438583262306
Bond Position:  [2.64256336]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [2.1279357]
Stock Price:  94.22952905617383
PL:  [2.1279357]
Settle:  Tensor("sub_396:0", shape=(), dtype=float64)
PL:  Tensor("sub_397:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  199
output_Z_Vals[:, i, :]:  [[ 1.19271183e+02 -4.92738716e+01 -4.92570741e+01]
 [ 1.18247632e-02  2.73240127e-02 -4.94408471e-02]
 [-1.91893228e+00 -2.58732135e+00 -7.35283002e-01]
 [ 3.39775266e-02  2.41804463e-01 -1.65869198e-02]
 [ 6.13007811e-01  1.18549841e-01 -5.02792250e-01]
 [ 7.42147648e-02  1.15124147e-01 -6.49091708e-03]
 [ 4.64737367e-02 -2.21482634e-02  9.72250532e-02]
 [ 1.21997627e-01  3.69099560e-01  2.65020578e-01]
 [ 3.68179559e-02  1.62815964e-01 -8.88913033e-02]
 [-9.52379956e-01 -3.89803558e-01 -3.25177281e-02]
 [ 1.28929547e-01  9.14523254e-04 -1.57380361e-01]
 [ 2.06826081e-02 -7.18507966e-02  3.69379987e-02]
 [-5.52260236e-01 -1.20506113e+00  1.94750548e-01]
 [ 4.48126368e-02  5.70990610e-02  1.32920641e-01]
 [ 6.88930905e-02  1.25397386e-01 -1.02152185e-01]
 [-2.43185725e-03  5.08877334e-02  9.53199759e-02]
 [ 1.25539909e-01  1.15578973e-01  1.03380930e-01]
 [ 9.78583544e-02 -1.61360435e-02  1.24012492e-02]
 [-4.60759063e-02 -1.08920850e-01  1.01412942e-02]
 [ 6.40080565e-02 -5.41800519e-01 -4.93052580e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.27118322 -49.27387164 -49.25707411]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [   7.3268874   -15.90307369 -140.51672192]
init_Out:  [2.48374395]
Stock Position:  7.326887399052493
Bond position:  [-730.20499595]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [8.40089533]
curr_Stock_Price:  100.83251251464496
curr_Factors:  [100.83251251  -1.193618    -1.02995358]
mat_Sqrt:  [[10.91228552  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0006699   0.00881879 -0.14104098]
Stock Position:  0.0006699039652625569
Bond Position:  [8.33334723]


portfolio before change:  [8.40375339]
curr_Stock_Price:  101.98858883932196
curr_Factors:  [101.98858884  -1.32742598  -1.06194969]
mat_Sqrt:  [[ 9.35101844  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.27774045 -0.83505438 -2.09755774]
Stock Position:  -0.27774044861703445
Bond Position:  [36.73010981]


portfolio before change:  [8.66662402]
curr_Stock_Price:  101.07519307276053
curr_Factors:  [101.07519307  -1.1740461   -1.04111644]
mat_Sqrt:  [[11.03091936  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0072478   0.07804205 -0.04731787]
Stock Position:  0.007247797087245664
Bond Position:  [7.93405153]


portfolio before change:  [8.67450232]
curr_Stock_Price:  101.88848042383619
curr_Factors:  [101.88848042  -1.06046746  -1.04384778]
mat_Sqrt:  [[12.42317453  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.04303044  0.0382618  -1.43432634]
Stock Position:  0.043030439341999176
Bond Position:  [4.29019624]


portfolio before change:  [8.71264315]
curr_Stock_Price:  102.7499205487085
curr_Factors:  [102.74992055  -1.22097421  -1.03572241]
mat_Sqrt:  [[10.75748138  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00896022  0.03715616 -0.01851678]
Stock Position:  0.008960222810358942
Bond Position:  [7.79198097]


portfolio before change:  [8.71492319]
curr_Stock_Price:  102.78695074630282
curr_Factors:  [102.78695075  -1.1599022   -1.05464808]
mat_Sqrt:  [[11.22460377  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00550565 -0.00714832  0.27735601]
Stock Position:  0.00550564844113815
Bond Position:  [8.14901437]


portfolio before change:  [8.71357821]
curr_Stock_Price:  102.17258436862154
curr_Factors:  [102.17258437  -0.44992518  -1.03186728]
mat_Sqrt:  [[23.21667859  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01083001 0.11912637 0.75602994]
Stock Position:  0.010830009868499657
Bond Position:  [7.60704811]


portfolio before change:  [8.68047699]
curr_Stock_Price:  98.9405263436138
curr_Factors:  [98.94052634 -0.56394079 -1.08883282]
mat_Sqrt:  [[18.94888933  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00273936  0.05254863 -0.25358215]
Stock Position:  0.002739356543337896
Bond Position:  [8.40944361]


portfolio before change:  [8.68033411]
curr_Stock_Price:  98.12080612374976
curr_Factors:  [98.12080612 -0.54962748 -1.13003826]
mat_Sqrt:  [[18.29327851  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.05677418 -0.12580856 -0.09276403]
Stock Position:  -0.056774182222646255
Bond Position:  [14.25106263]


portfolio before change:  [8.65107839]
curr_Stock_Price:  98.69886687443993
curr_Factors:  [98.69886687 -0.32166479 -1.15259386]
mat_Sqrt:  [[22.59694712  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 4.29222103e-03  2.95161111e-04 -4.48962364e-01]
Stock Position:  0.004292221034916105
Bond Position:  [8.22744104]


portfolio before change:  [8.65681672]
curr_Stock_Price:  99.556514003121
curr_Factors:  [99.556514   -0.52997264 -1.15051194]
mat_Sqrt:  [[18.54575429  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00073095 -0.02318974  0.10537383]
Stock Position:  0.0007309523716936817
Bond Position:  [8.58404565]


portfolio before change:  [8.65758819]
curr_Stock_Price:  97.67566644296943
curr_Factors:  [97.67566644 -0.20372601 -1.14962556]
mat_Sqrt:  [[25.23674051  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.03005495 -0.38893181  0.55556911]
Stock Position:  -0.030054951766860457
Bond Position:  [11.59322563]


portfolio before change:  [8.62773555]
curr_Stock_Price:  98.76538086685827
curr_Factors:  [98.76538087 -0.11681486 -1.14906077]
mat_Sqrt:  [[27.85107383  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00300169 0.01842864 0.37918559]
Stock Position:  0.0030016884277486236
Bond Position:  [8.33127264]


portfolio before change:  [8.62539477]
curr_Stock_Price:  97.29159362132819
curr_Factors:  [ 9.72915936e+01 -7.67930917e-02 -1.14677918e+00]
mat_Sqrt:  [[28.62098873  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00257287  0.04047183 -0.29141175]
Stock Position:  0.0025728669944399696
Bond Position:  [8.37507644]


portfolio before change:  [8.6334235]
curr_Stock_Price:  99.59823955920695
curr_Factors:  [ 9.95982396e+01  8.20906798e-02 -1.13100189e+00]
mat_Sqrt:  [[34.89115236  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00078566 0.01642395 0.27192136]
Stock Position:  0.0007856623983620942
Bond Position:  [8.55517291]


portfolio before change:  [8.63678005]
curr_Stock_Price:  101.14787275180748
curr_Factors:  [ 1.01147873e+02  8.69682581e-02 -1.14072767e+00]
mat_Sqrt:  [[35.26264249  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00482763 0.03730295 0.29491702]
Stock Position:  0.004827627779964006
Bond Position:  [8.14847577]


portfolio before change:  [8.63454619]
curr_Stock_Price:  100.26312564212539
curr_Factors:  [ 1.00263126e+02 -5.18576144e-02 -1.16691751e+00]
mat_Sqrt:  [[29.6369788   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00327618 -0.00520789  0.03537731]
Stock Position:  0.003276177147570756
Bond Position:  [8.30606643]


portfolio before change:  [8.63607455]
curr_Stock_Price:  100.09573131676682
curr_Factors:  [100.09573132  -0.65548379  -1.1801362 ]
mat_Sqrt:  [[15.96672798  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00414858 -0.03515405  0.02893029]
Stock Position:  -0.004148576885437981
Bond Position:  [9.05132939]


portfolio before change:  [8.6385477]
curr_Stock_Price:  100.04510450703683
curr_Factors:  [100.04510451  -0.70724194  -1.19702704]
mat_Sqrt:  [[14.89986499  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00988133 -0.17486537 -1.40654177]
Stock Position:  -0.009881327645858558
Bond Position:  [9.62712615]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [8.62398431]
Stock Price:  101.76253219937107
PL:  [6.86145212]
Settle:  Tensor("sub_398:0", shape=(), dtype=float64)
PL:  Tensor("sub_399:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


FINAL AVERAGE P&L:  -0.7418420653303716
FINAL STD P&L:  7.246742637361657
